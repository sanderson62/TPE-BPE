* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    42* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    45* 121417  IR2017121200001  PEMA  Correct assignment of ben period
    46* 011118  CR2016052500002  TANA  Add Message for pre-existing
    47* 052918  CR2018031500002  TANA  Add Message for filing time limit
    48* 061418  IR2018053000003  TANA  Fix Causal state / filing limit
    49* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    50* 071720  CR2019112600001  TANA  Remove filing time limit error
    51* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    52******************************************************************
    53
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page   3
* EL130.cbl
    55 ENVIRONMENT DIVISION.
    56 DATA DIVISION.
    57 WORKING-STORAGE SECTION.
    58 01  DFH-START PIC X(04).
    59 77  FILLER  PIC X(32)  VALUE '********************************'.
    60 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    61 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    62 77  A1                          PIC S999 COMP-3 VALUE +0.
    63 77  E1                          PIC S999 COMP-3 VALUE +0.
    64 77  s1                          pic s999 comp-3 value +0.
    65 77  s2                          pic s999 comp-3 value +0.
    66 77  P1                          PIC S999 COMP-3 VALUE +0.
    67 77  P2                          PIC S999 COMP-3 VALUE +0.
    68 77  WS-CRIT-PER-RECURRENT       PIC 99    VALUE zeros.
    69 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    70 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    71 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    72 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    73 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    74 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    75 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    76     88  ERPDEF-FOUND                 VALUE 'Y'.
    77 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    78 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    79 77  ws-dcc-product-code         pic xxx value spaces.
    80 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    81 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    82 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    83 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    84 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    85 77  ws-zero-bens-avail          pic x value ' '.
    86 77  WS-PRE-EXISTING-PER         PIC 99    VALUE ZEROS.
    87*    COPY ELCSCTM.
    88******************************************************************
    89*                                                                *
    90*                                                                *
    91*                            ELCSCTM                             *
    92*                            VMOD=2.001                          *
    93*                                                                *
    94*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    95*                                                                *
    96******************************************************************
    97 01  SECURITY-MESSAGE.
    98     12  FILLER                          PIC X(30)
    99            VALUE '** LOGIC SECURITY VIOLATION -'.
   100     12  SM-READ                         PIC X(6).
   101     12  FILLER                          PIC X(5)
   102            VALUE ' PGM='.
   103     12  SM-PGM                          PIC X(6).
   104     12  FILLER                          PIC X(5)
   105            VALUE ' OPR='.
   106     12  SM-PROCESSOR-ID                 PIC X(4).
   107     12  FILLER                          PIC X(6)
   108            VALUE ' TERM='.
   109     12  SM-TERMID                       PIC X(4).
   110     12  FILLER                          PIC XX   VALUE SPACE.
   111     12  SM-JUL-DATE                     PIC 9(5).
   112     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page   4
* EL130.cbl
   113     12  SM-TIME                         PIC 99.99.
   114
   115
   116*    COPY ELCSCRTY.
   117******************************************************************
   118*                                                                *
   119*                                                                *
   120*                            ELCSCRTY                            *
   121*                            VMOD=2.001                          *
   122*                                                                *
   123*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   124*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   125*        SAVED IN PI-SECURITY-ADDRESS.                           *
   126*                                                                *
   127******************************************************************
   128 01  SECURITY-CONTROL.
   129     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   130     12  FILLER                       PIC XX    VALUE 'SC'.
   131     12  SC-CREDIT-CODES.
   132         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   133             20  SC-CREDIT-DISPLAY    PIC X.
   134             20  SC-CREDIT-UPDATE     PIC X.
   135     12  SC-CLAIMS-CODES.
   136         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   137             20  SC-CLAIMS-DISPLAY    PIC X.
   138             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page   5
* EL130.cbl
   140 01  WS-DATE-AREA.
   141     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   142     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   143     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   144
   145 01  ws-dcc-error-line.
   146     05  filler occurs 15.
   147         10  ws-error-no        pic x(4).
   148 01  WS-CRI-SSN-WORK-AREA.
   149     05  WS-CRI-SOC-SEC-NO.
   150         10  WS-SS-REPT-CD       PIC X(5).
   151         10  WS-SS-LAST-NAME     PIC X(5).
   152         10  WS-SS-INITIAL       PIC X.
   153
   154     05  WS-CRI-REPORT-CODE.
   155         10  FILLER              PIC X(5).
   156         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   157
   158     05  WS-CRI-LAST-NAME.
   159         10  WS-CRI-NAME-MOVE    PIC X(5).
   160         10  FILLER              PIC X(10).
   161
   162 01  STANDARD-AREAS.
   163     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   164     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   165     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   166     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   167     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   168     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   169     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   170     12  PGM-NAME            PIC X(8).
   171     12  TIME-IN             PIC S9(7).
   172     12  TIME-OUT-R  REDEFINES TIME-IN.
   173         16  FILLER          PIC X.
   174         16  TIME-OUT        PIC 99V99.
   175         16  FILLER          PIC X(2).
   176     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   177     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   178     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   179     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   180     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   181     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   182     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   183     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   184     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   185     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   186     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   187     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   188     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   189     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   190     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   191     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   192     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   193     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   194     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   195     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   196     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   197     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page   6
* EL130.cbl
   198     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   199     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   200     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   201     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   202     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   203     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   204     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   205     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   206     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   207     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   208     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   209     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   210     12  FILE-ID             PIC X(8).
   211     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   212     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   213     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   214     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   215     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   216     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   217     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   218     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   219     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   220
   221 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   222     12  M                   PIC S9(7)V99           VALUE ZEROS.
   223     12  L                   PIC S9(7)V99           VALUE ZEROS.
   224     12  N                   PIC S9(3)              VALUE ZEROS.
   225     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   226     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   227     12  I                   PIC S99V9(5)           VALUE ZEROS.
   228     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   229     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   230     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   231     12  R                   PIC S9(3)              VALUE ZEROS.
   232     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   233     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   234     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   235     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   236     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   237     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   238     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   239     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   240     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   241
   242 01  TERM-CALC-WORK-AREA.
   243     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   244     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   245     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   246     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   247     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   248     12  V-EXPONENTS.
   249        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   250     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   251
   252 01  MISC-WORK-AREAS.
   253     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   254     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   255     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page   7
* EL130.cbl
   256     12  QID.
   257         16  QID-TERM        PIC X(4).
   258         16  FILLER          PIC X(4)    VALUE '130A'.
   259     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   260     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   261     12  WS-GROUP-NO.
   262         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   263         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   264
   265     12  WS-RESPONSE         PIC S9(8)   COMP.
   266         88  WS-RESP-NORMAL              VALUE +00.
   267         88  WS-RESP-ERROR               VALUE +01.
   268         88  WS-RESP-NOTFND              VALUE +13.
   269         88  WS-RESP-DUPKEY              VALUE +15.
   270         88  WS-RESP-NOTOPEN             VALUE +19.
   271         88  WS-RESP-ENDFILE             VALUE +20.
   272
   273***************************************************************
   274*                                                             *
   275*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   276*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   277*    CHANGES WITH IN MAP EL130A.                              *
   278*                                                             *
   279***************************************************************
   280
   281     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   282     12  WS-SAVE-CLAIM-MASTER.
   283         16  FILLER                    PIC XX.
   284         16  WS-SAVE-CLAIM-KEY.
   285             20  WS-SAVE-COMPANY-CD    PIC X.
   286             20  WS-SAVE-CARRIER       PIC X.
   287             20  WS-SAVE-CLAIM-NO      PIC X(7).
   288             20  WS-SAVE-CERT-NO       PIC X(11).
   289         16  FILLER                    PIC X(328).
   290     12  SAVE-CURRENT-DATE         PIC XX.
   291     12  SAVE-CONTROL              PIC X(39).
   292     12  SAVE-ERACCT-KEY           PIC X(26).
   293     12  SAVE-COUNTER              PIC S9(8)   COMP.
   294     12  SAVE-METHOD               PIC X.
   295     12  SAVE-COMPANY-ID           PIC XXX.
   296     12  SAVE-COMPANY-CD           PIC X.
   297     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   298     12  SAVE-CREDIT-USER          PIC X.
   299     12  SAVE-CLAIM-USER           PIC X.
   300     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   301     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   302     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   303     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   304     12  SAVE-AH-OVERRIDE-L1       PIC X.
   305     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   306     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   307     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   308     12  FILLER                    PIC X.
   309*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   310     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   311     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   312     12  SAVE-EL127-TO-EL130-CNTRL.
   313         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page   8
* EL130.cbl
   314         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   315         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   316             20  SAVE-EL127-CARRIER  PIC X.
   317             20  SAVE-EL127-GROUPING PIC X(6).
   318             20  SAVE-EL127-STATE    PIC X(2).
   319             20  SAVE-EL127-ACCOUNT  PIC X(10).
   320             20  SAVE-EL127-CERT-NO  PIC X(11).
   321             20  SAVE-EL127-EFF-DT   PIC XX.
   322     12  SAVE-EL659-TO-EL130-CNTRL.
   323         16  SAVE-EL659-CARRIER    PIC X.
   324         16  SAVE-EL659-GROUPING   PIC X(6).
   325         16  SAVE-EL659-STATE      PIC XX.
   326         16  SAVE-EL659-ACCOUNT    PIC X(10).
   327     12  DIVIDE-QUOT               PIC 999.
   328     12  DIVIDE-REM                PIC 999.
   329     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   330     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   331     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   332     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   333     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   334     12  WS-RESERVE-CONTROLS       PIC X(9).
   335     12  WS-EXPENSE-CONTROLS       PIC X(7).
   336     12  WS-REIN-TABLE.
   337         16  WS-REIN-1             PIC X            VALUE SPACE.
   338         16  WS-REIN-2             PIC X            VALUE SPACE.
   339         16  WS-REIN-3             PIC X            VALUE SPACE.
   340     12  WS-BENE-CALC-METHOD       PIC X.
   341     12  ws-lf-joint-indicator     pic x.
   342     12  ws-ah-joint-indicator     pic x.
   343     12  WS-EARNINGS-CALC          PIC X.
   344     12  WS-LF-EARNINGS-CALC       PIC X.
   345         88 TEX-REG                VALUE '4'.
   346         88 NET-PAY                VALUE '5'.
   347     12  WS-AH-EARNINGS-CALC       PIC X.
   348     12  WS-SPECIAL-CALC-CD        PIC X(01).
   349     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   350     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   351     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   352     12  WS-ICD-CODE-1             PIC X(8).
   353     12  WS-ICD-CODE-2             PIC X(8).
   354     12  WS-CLAIM-NUMBER.
   355         16  WS-CN-PREFIX.
   356             20  WS-CN-PRF-A PIC X.
   357             20  WS-CN-PRF-B PIC X.
   358         16  WS-CN-NUMBER    PIC 9(5).
   359     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   360     12  WS-CLAIM-SEQU.
   361         16  FILLER          PIC X    VALUE '('.
   362         16  WS-CURRENT-SEQU PIC Z9.
   363         16  FILLER          PIC X(4) VALUE ' OF '.
   364         16  WS-OF-SEQU      PIC Z9.
   365         16  FILLER          PIC X    VALUE ')'.
   366     12  DATE-WORK.
   367       14  FILLER                PIC XX.
   368       14  DATE-MM               PIC XX.
   369       14  DATE-DD               PIC XX.
   370       14  DATE-YY               PIC XX.
   371     12  CURR-DATE REDEFINES DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page   9
* EL130.cbl
   372         16  CURR-MM.
   373           18  CURR-M1           PIC 9.
   374           18  CURR-M2           PIC 9.
   375         16  FILLER              PIC X(5).
   376         16  CURR-YEAR           PIC 9.
   377     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   378     12  SUB                     PIC 99.
   379     12  MY-DATE.
   380         16  MY-MM               PIC XX.
   381         16  FILLER              PIC X VALUE '/'.
   382         16  MY-YY               PIC XX.
   383
   384     12  WS-EDIT-BEN-CODE        PIC XX.
   385         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   386                                          '90' THRU '99'.
   387
   388     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   389     12  WS-BEN-HOLD             PIC XX.
   390     12  WS-BEN-ALPHA-HOLD.
   391         15  WS-BEN-ALPHA-2      PIC XX.
   392         15  WS-BEN-ALPHA-1      PIC X.
   393     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   394     12  WS-REC-TYPE             PIC X.
   395     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   396     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   397     12  ARCH-NUMBER             PIC S9(8)   COMP.
   398     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   399         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   400         88  REIN-REC-FOUND                  VALUE 'Y'.
   401
   402     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   403     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   404
   405
   406 01  CSO-WORK-FIELDS.
   407     12  WS-BLANK            PIC X       VALUE ' '.
   408
   409     12  WS-MA-CONTROL-PRIMARY.
   410         16  WS-MA-COMPANY-CD        PIC  X.
   411         16  WS-MA-CARRIER           PIC  X.
   412         16  WS-MA-GROUPING          PIC  X(6).
   413         16  WS-MA-STATE             PIC  XX.
   414         16  WS-MA-ACCOUNT           PIC  X(10).
   415         16  WS-MA-CERT-EFF-DT       PIC  XX.
   416         16  WS-MA-CERT-NO.
   417             20  WS-MA-CERT-PRIME    PIC  X(10).
   418             20  WS-MA-CERT-SFX      PIC  X.
   419
   420     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   421     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   422     12  WS-SOC-SEC-NUMBER.
   423         16  WS-SOC-SEC-NO       PIC 9(9).
   424         16  WS-SOC-SEC-BLANK    PIC X(2).
   425     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   426         16  WS-SSN-1-3          PIC 9(3).
   427         16  WS-SSN-DASH1        PIC X(1).
   428         16  WS-SSN-4-5          PIC 9(2).
   429         16  WS-SSN-DASH2        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  10
* EL130.cbl
   430         16  WS-SSN-6-9          PIC 9(4).
   431
   432     12  WS-DIAG-VIN-MSG.
   433         16  FILLER          PIC X(11)
   434             VALUE 'VIN NUMBER '.
   435         16  WS-DIAG-VIN     PIC X(17).
   436
   437     12  WS-VERIFY-NOTE      PIC X(34)
   438         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   439
   440     12  WS-CAUSAL-NOTE      PIC X(40)
   441         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   442
   443     12  WS-VFY-SSN-NOTE     PIC X(25)
   444         VALUE 'SSN VERIFICATION REQUIRED'.
   445
   446     12  WS-FILING-NOTE     PIC X(30)
   447         VALUE 'FILING TIME LIMIT EXCEEDED'.
   448
   449 01  MAP-DATE-AREAS.
   450     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   451     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   452     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   453     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   454     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   455     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   456     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   457     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   458     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   459     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   460     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   461     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   462     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   463     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   464     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   465     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   466     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   467     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   468     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   469         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   470     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   471     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   472     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   473     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   474
   475 01  ACCESS-KEYS.
   476     12  ELACTQ-KEY.
   477         16  ELACTQ-COMPANY-CD       PIC X.
   478         16  ELACTQ-CARRIER          PIC X.
   479         16  ELACTQ-CLAIM-NO         PIC X(7).
   480         16  ELACTQ-CERT-NO          PIC X(11).
   481     12  ELMSTR-KEY.
   482         16  MSTR-COMP-CD            PIC X.
   483         16  MSTR-CARRIER            PIC X.
   484         16  MSTR-CLAIM-NO           PIC X(7).
   485         16  MSTR-CERT-NO.
   486             20  MSTR-CERT-NO-PRIME  PIC X(10).
   487             20  MSTR-CERT-NO-SUFX   PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  11
* EL130.cbl
   488     12  SAVE-ELMSTR-KEY.
   489         16  SAVE-COMP-CD            PIC X.
   490         16  SAVE-CARRIER            PIC X.
   491         16  SAVE-CLAIM-NO           PIC X(7).
   492         16  SAVE-CERT-NO.
   493             20  SAVE-CERT-NO-PRIME  PIC X(10).
   494             20  SAVE-CERT-NO-SUFX   PIC X.
   495     12  ELMSTR5-KEY.
   496         16  MSTR5-COMP-CD           PIC X.
   497         16  MSTR5-CERT-NO.
   498             20  MSTR5-CERT-NO-PRIME PIC X(10).
   499             20  MSTR5-CERT-NO-SUFX  PIC X.
   500     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   501         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   502         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   503         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   504     12  ELCNTL-KEY.
   505         16  CNTL-COMP-ID    PIC X(3).
   506         16  CNTL-REC-TYPE   PIC X.
   507         16  CNTL-ACCESS.
   508             20  FILLER      PIC XX.
   509             20  CNTL-BENEFIT.
   510                 24  FILLER  PIC X.
   511                 24  CNTL-CARRIER PIC X.
   512         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   513     12  ELCERT-KEY.
   514         16  CERT-COMP-CD    PIC X.
   515         16  CERT-CARRIER    PIC X.
   516         16  CERT-GROUPING   PIC X(6).
   517         16  CERT-STATE      PIC X(2).
   518         16  CERT-ACCOUNT.
   519             20  CERT-ACCOUNT-PREFIX PIC X(4).
   520             20  CERT-ACCOUNT-PRIME  PIC X(6).
   521         16  CERT-EFF-DT     PIC XX.
   522         16  CERT-CERT-NO.
   523             20  CERT-CERT-NO-PRIME  PIC X(10).
   524             20  CERT-CERT-NO-SUFX   PIC X.
   525     12  ELCERT-KEY-5.
   526         16  CERT-COMP-CD-5      PIC X.
   527         16  CERT-CERT-5.
   528             20  CERT-CERT-5-PRIME   PIC X(10).
   529             20  CERT-CERT-5-SUFX    PIC X.
   530     12  ERACCT-KEY.
   531         16  ACCT-COMP-CD    PIC X.
   532         16  ACCT-CARRIER    PIC X.
   533         16  ACCT-GROUPING   PIC X(6).
   534         16  ACCT-STATE      PIC X(2).
   535         16  ACCT-ACCOUNT    PIC X(10).
   536         16  ACCT-EXP-DT     PIC XX.
   537     12  ELTRLR-KEY.
   538         16  TRLR-COMP-CD    PIC X.
   539         16  TRLR-CARRIER    PIC X.
   540         16  TRLR-CLAIM-NO   PIC X(7).
   541         16  TRLR-CERT-NO.
   542             20  TRLR-CERT-NO-PRIME  PIC X(10).
   543             20  TRLR-CERT-NO-SUFX   PIC X.
   544         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   545         16  TRLR-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  12
* EL130.cbl
   546     12  ELBENE-KEY.
   547         16  BENE-COMP-CD    PIC X.
   548         16  BENE-RCD-TYPE   PIC X.
   549         16  BENE-CODE       PIC X(10).
   550     12  ERREIN-KEY.
   551         16  REIN-COMP-CD        PIC X(01).
   552         16  REIN-TYPE           PIC X(01).
   553         16  REIN-TABLE-CO.
   554             20  REIN-CODE-1     PIC X(01).
   555             20  REIN-CODE-2     PIC X(01).
   556             20  REIN-CODE-3     PIC X(01).
   557         16  FILLER              PIC X(03).
   558     12  ELCRTT-KEY.
   559         16  CTRLR-COMP-CD       PIC X.
   560         16  CTRLR-CARRIER       PIC X.
   561         16  CTRLR-GROUPING      PIC X(6).
   562         16  CTRLR-STATE         PIC X(2).
   563         16  CTRLR-ACCOUNT       PIC X(10).
   564         16  CTRLR-EFF-DT        PIC XX.
   565         16  CTRLR-CERT-NO       PIC X(11).
   566         16  CTRLR-REC-TYPE      PIC X.
   567 01  ws-acct-found-sw            pic x value ' '.
   568     88  acct-found                value 'Y'.
   569 01  ERPDEF-KEY-SAVE             PIC X(18).
   570 01  ERPDEF-KEY.
   571     12  ERPDEF-COMPANY-CD       PIC X.
   572     12  ERPDEF-STATE            PIC XX.
   573     12  ERPDEF-PROD-CD          PIC XXX.
   574     12  F                       PIC X(7).
   575     12  ERPDEF-BEN-TYPE         PIC X.
   576     12  ERPDEF-BEN-CODE         PIC XX.
   577     12  ERPDEF-EXP-DT           PIC XX.
   578 01  ERROR-MESSAGES.
   579     12  ER-0000                 PIC X(4)  VALUE '0000'.
   580     12  ER-0004                 PIC X(4)  VALUE '0004'.
   581     12  ER-0019                 PIC X(4)  VALUE '0019'.
   582     12  ER-0023                 PIC X(4)  VALUE '0023'.
   583     12  ER-0029                 PIC X(4)  VALUE '0029'.
   584     12  ER-0033                 PIC X(4)  VALUE '0033'.
   585     12  ER-0068                 PIC X(4)  VALUE '0068'.
   586     12  ER-0070                 PIC X(4)  VALUE '0070'.
   587     12  ER-0194                 PIC X(4)  VALUE '0194'.
   588     12  ER-0202                 PIC X(4)  VALUE '0202'.
   589     12  ER-0203                 PIC X(4)  VALUE '0203'.
   590     12  ER-0204                 PIC X(4)  VALUE '0204'.
   591     12  ER-0205                 PIC X(4)  VALUE '0205'.
   592     12  ER-0206                 PIC X(4)  VALUE '0206'.
   593     12  ER-0207                 PIC X(4)  VALUE '0207'.
   594     12  ER-0213                 PIC X(4)  VALUE '0213'.
   595     12  ER-0214                 PIC X(4)  VALUE '0214'.
   596     12  ER-0217                 PIC X(4)  VALUE '0217'.
   597     12  ER-0219                 PIC X(4)  VALUE '0219'.
   598     12  ER-0220                 PIC X(4)  VALUE '0220'.
   599     12  ER-0221                 PIC X(4)  VALUE '0221'.
   600     12  ER-0222                 PIC X(4)  VALUE '0222'.
   601     12  ER-0223                 PIC X(4)  VALUE '0223'.
   602     12  ER-0224                 PIC X(4)  VALUE '0224'.
   603     12  ER-0225                 PIC X(4)  VALUE '0225'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  13
* EL130.cbl
   604     12  ER-0226                 PIC X(4)  VALUE '0226'.
   605     12  ER-0227                 PIC X(4)  VALUE '0227'.
   606     12  ER-0229                 PIC X(4)  VALUE '0229'.
   607     12  ER-0230                 PIC X(4)  VALUE '0230'.
   608     12  ER-0231                 PIC X(4)  VALUE '0231'.
   609     12  ER-0232                 PIC X(4)  VALUE '0232'.
   610     12  ER-0233                 PIC X(4)  VALUE '0233'.
   611     12  ER-0234                 PIC X(4)  VALUE '0234'.
   612     12  ER-0235                 PIC X(4)  VALUE '0235'.
   613     12  ER-0236                 PIC X(4)  VALUE '0236'.
   614     12  ER-0237                 PIC X(4)  VALUE '0237'.
   615     12  ER-0238                 PIC X(4)  VALUE '0238'.
   616     12  ER-0239                 PIC X(4)  VALUE '0239'.
   617     12  ER-0240                 PIC X(4)  VALUE '0240'.
   618     12  ER-0241                 PIC X(4)  VALUE '0241'.
   619     12  ER-0243                 PIC X(4)  VALUE '0243'.
   620     12  ER-0244                 PIC X(4)  VALUE '0244'.
   621     12  ER-0245                 PIC X(4)  VALUE '0245'.
   622     12  ER-0246                 PIC X(4)  VALUE '0246'.
   623     12  ER-0247                 PIC X(4)  VALUE '0247'.
   624     12  ER-0248                 PIC X(4)  VALUE '0248'.
   625     12  ER-0250                 PIC X(4)  VALUE '0250'.
   626     12  ER-0251                 PIC X(4)  VALUE '0251'.
   627     12  ER-0252                 PIC X(4)  VALUE '0252'.
   628     12  ER-0253                 PIC X(4)  VALUE '0253'.
   629     12  ER-0254                 PIC X(4)  VALUE '0254'.
   630     12  ER-0257                 PIC X(4)  VALUE '0257'.
   631     12  ER-0258                 PIC X(4)  VALUE '0258'.
   632     12  ER-0260                 PIC X(4)  VALUE '0260'.
   633     12  ER-0261                 PIC X(4)  VALUE '0261'.
   634     12  ER-0263                 PIC X(4)  VALUE '0263'.
   635     12  ER-0264                 PIC X(4)  VALUE '0264'.
   636     12  ER-0265                 PIC X(4)  VALUE '0265'.
   637     12  ER-0266                 PIC X(4)  VALUE '0266'.
   638     12  ER-0267                 PIC X(4)  VALUE '0267'.
   639     12  ER-0334                 PIC X(4)  VALUE '0334'.
   640     12  ER-0337                 PIC X(4)  VALUE '0337'.
   641     12  ER-0412                 PIC X(4)  VALUE '0412'.
   642     12  ER-0413                 PIC X(4)  VALUE '0413'.
   643     12  ER-0428                 PIC X(4)  VALUE '0428'.
   644     12  ER-0429                 PIC X(4)  VALUE '0429'.
   645     12  ER-0430                 PIC X(4)  VALUE '0430'.
   646     12  ER-0433                 PIC X(4)  VALUE '0433'.
   647     12  ER-0434                 PIC X(4)  VALUE '0434'.
   648     12  ER-0458                 PIC X(4)  VALUE '0458'.
   649     12  ER-0489                 PIC X(4)  VALUE '0489'.
   650     12  ER-0509                 PIC X(4)  VALUE '0509'.
   651     12  ER-0510                 PIC X(4)  VALUE '0510'.
   652     12  ER-0511                 PIC X(4)  VALUE '0511'.
   653     12  ER-0512                 PIC X(4)  VALUE '0512'.
   654     12  ER-0516                 PIC X(4)  VALUE '0516'.
   655     12  ER-0517                 PIC X(4)  VALUE '0517'.
   656     12  ER-0518                 PIC X(4)  VALUE '0518'.
   657     12  ER-0519                 PIC X(4)  VALUE '0519'.
   658     12  ER-0520                 PIC X(4)  VALUE '0520'.
   659     12  ER-0521                 PIC X(4)  VALUE '0521'.
   660     12  ER-0522                 PIC X(4)  VALUE '0522'.
   661     12  ER-0523                 PIC X(4)  VALUE '0523'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  14
* EL130.cbl
   662     12  ER-0544                 PIC X(4)  VALUE '0544'.
   663     12  ER-0546                 PIC X(4)  VALUE '0546'.
   664     12  ER-0558                 PIC X(4)  VALUE '0558'.
   665     12  ER-0560                 PIC X(4)  VALUE '0560'.
   666     12  ER-0562                 PIC X(4)  VALUE '0562'.
   667     12  ER-0565                 PIC X(4)  VALUE '0565'.
   668     12  ER-0569                 PIC X(4)  VALUE '0569'.
   669     12  ER-0693                 PIC X(4)  VALUE '0693'.
   670     12  ER-0715                 PIC X(4)  VALUE '0715'.
   671     12  ER-0840                 PIC X(4)  VALUE '0840'.
   672     12  ER-0841                 PIC X(4)  VALUE '0841'.
   673     12  ER-0842                 PIC X(4)  VALUE '0842'.
   674     12  ER-0843                 PIC X(4)  VALUE '0843'.
   675     12  ER-0878                 PIC X(4)  VALUE '0878'.
   676     12  ER-0887                 PIC X(4)  VALUE '0887'.
   677     12  ER-0992                 PIC X(4)  VALUE '0992'.
   678     12  ER-1651                 PIC X(4)  VALUE '1651'.
   679     12  ER-1652                 PIC X(4)  VALUE '1652'.
   680     12  ER-1653                 PIC X(4)  VALUE '1653'.
   681     12  ER-1654                 PIC X(4)  VALUE '1654'.
   682     12  ER-1655                 PIC X(4)  VALUE '1655'.
   683     12  er-1659                 pic x(4)  value '1659'.
   684     12  er-1660                 pic x(4)  value '1660'.
   685     12  er-1661                 pic x(4)  value '1661'.
   686     12  er-1671                 pic x(4)  value '1671'.
   687     12  er-1672                 pic x(4)  value '1672'.
   688     12  er-1673                 pic x(4)  value '1673'.
   689     12  er-1675                 pic x(4)  value '1675'.
   690     12  er-1676                 pic x(4)  value '1676'.
   691     12  ER-1677                 PIC X(4)  VALUE '1677'.
   692     12  ER-1679                 PIC X(4)  VALUE '1679'.
   693     12  ER-2280                 PIC X(4)  VALUE '2280'.
   694     12  ER-2370                 PIC X(4)  VALUE '2370'.
   695     12  ER-2371                 PIC X(4)  VALUE '2371'.
   696     12  ER-2378                 PIC X(4)  VALUE '2378'.
   697     12  ER-2380                 PIC X(4)  VALUE '2380'.
   698     12  ER-2566                 PIC X(4)  VALUE '2566'.
   699     12  ER-2848                 PIC X(4)  VALUE '2848'.
   700     12  ER-3548                 PIC X(4)  VALUE '3548'.
   701     12  ER-7008                 PIC X(4)  VALUE '7008'.
   702     12  ER-7319                 PIC X(4)  VALUE '7319'.
   703     12  ER-7321                 PIC X(4)  VALUE '7321'.
   704     12  ER-7352                 PIC X(4)  VALUE '7352'.
   705     12  ER-7353                 PIC X(4)  VALUE '7353'.
   706     12  ER-7572                 PIC X(4)  VALUE '7572'.
   707     12  ER-7575                 PIC X(4)  VALUE '7575'.
   708     12  ER-7577                 PIC X(4)  VALUE '7577'.
   709     12  ER-7582                 PIC X(4)  VALUE '7582'.
   710     12  ER-7634                 PIC X(4)  VALUE '7634'.
   711     12  ER-7635                 PIC X(4)  VALUE '7635'.
   712     12  ER-7636                 PIC X(4)  VALUE '7636'.
   713     12  ER-7637                 PIC X(4)  VALUE '7637'.
   714     12  ER-7638                 PIC X(4)  VALUE '7638'.
   715     12  ER-7639                 PIC X(4)  VALUE '7639'.
   716     12  ER-7640                 PIC X(4)  VALUE '7640'.
   717     12  ER-7641                 PIC X(4)  VALUE '7641'.
   718     12  ER-7642                 PIC X(4)  VALUE '7642'.
   719     12  ER-7643                 PIC X(4)  VALUE '7643'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  15
* EL130.cbl
   720     12  ER-7646                 PIC X(4)  VALUE '7646'.
   721     12  ER-7647                 PIC X(4)  VALUE '7647'.
   722     12  ER-7648                 PIC X(4)  VALUE '7648'.
   723     12  ER-7649                 PIC X(4)  VALUE '7649'.
   724     12  ER-7651                 PIC X(4)  VALUE '7651'.
   725     12  ER-7670                 PIC X(4)  VALUE '7670'.
   726     12  ER-7671                 PIC X(4)  VALUE '7671'.
   727     12  ER-7686                 PIC X(4)  VALUE '7686'.
   728     12  ER-7688                 PIC X(4)  VALUE '7688'.
   729     12  ER-7689                 PIC X(4)  VALUE '7689'.
   730     12  ER-7691                 PIC X(4)  VALUE '7691'.
   731*    COPY ERCPDEF.
   732******************************************************************
   733*                                                                *
   734*                                                                *
   735*                            ERCPDEF.                            *
   736*                                                                *
   737*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   738*                                                                *
   739*    FILE TYPE = VSAM,KSDS                                       *
   740*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   741*                                                                *
   742*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   743*                                                                *
   744*    LOG = YES                                                   *
   745*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   746******************************************************************
   747*                   C H A N G E   L O G
   748*
   749* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   750*-----------------------------------------------------------------
   751*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   752* EFFECTIVE    NUMBER
   753*-----------------------------------------------------------------
   754* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   755* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   756* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   757* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   758******************************************************************
   759 01  PRODUCT-MASTER.
   760    12  PD-RECORD-ID                 PIC X(02).
   761        88  VALID-PD-ID                  VALUE 'PD'.
   762    12  PD-CONTROL-PRIMARY.
   763        16  PD-COMPANY-CD            PIC X.
   764        16  PD-STATE                 PIC XX.
   765        16  PD-PRODUCT-CD            PIC XXX.
   766        16  PD-FILLER                PIC X(7).
   767        16  PD-BEN-TYPE              PIC X.
   768        16  PD-BEN-CODE              PIC XX.
   769        16  PD-PROD-EXP-DT           PIC XX.
   770    12  FILLER                       PIC X(50).
   771    12  PD-PRODUCT-DATA OCCURS 8.
   772        16  PD-PROD-CODE             PIC X.
   773            88  PD-PROD-LIFE           VALUE 'L'.
   774            88  PD-PROD-PROP           VALUE 'P'.
   775            88  PD-PROD-AH             VALUE 'A'.
   776            88  PD-PROD-IU             VALUE 'I'.
   777            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  16
* EL130.cbl
   778            88  PD-PROD-FAML           VALUE 'F'.
   779            88  PD-PROD-OTH            VALUE 'O'.
   780        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   781        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   782        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   783        16  PD-MAX-TERM              PIC S999        COMP-3.
   784        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   785        16  FILLER                   PIC X.
   786        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   787        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   788        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   789        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   790        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   791        16  PD-REC-CRIT-PERIOD       PIC 99.
   792        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   793            20  PD-RECURRING-YN      PIC X.
   794            20  FILLER               PIC X.
   795        16  PD-RTW-MOS               PIC 99.
   796        16  PD-MAX-EXTENSION         PIC 99.
   797        16  pd-ben-pct               pic sv999 comp-3.
   798*       16  FILLER                   PIC XX.
   799    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   800    12  PD-TERM-LIMITS OCCURS 15.
   801        16  PD-LOW-TERM              PIC S999        COMP-3.
   802        16  PD-HI-TERM               PIC S999        COMP-3.
   803*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   804    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   805        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   806        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   807    12  PD-EARN-FACTORS.
   808        16  FILLER OCCURS 15.
   809            20  FILLER OCCURS 15.
   810                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   811    12  PD-PRODUCT-DESC              PIC X(80).
   812    12  PD-TRUNCATED                 PIC X.
   813    12  FILLER                       PIC X(59).
   814    12  PD-MAINT-INFORMATION.
   815        16  PD-LAST-MAINT-DT         PIC X(02).
   816        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   817        16  PD-LAST-MAINT-BY         PIC X(04).
   818*    COPY ELCLNKLT.
   819******************************************************************
   820*                                                                *
   821*                                                                *
   822*                           ELCLNKLT                             *
   823*                            VMOD=2.003                          *
   824*                                                                *
   825*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   826*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   827*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   828*                                                                *
   829*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   830*   COMPLETING THE REQUIRED FIELDS.                              *
   831*                                                                *
   832*   THE CALLING PROGRAM SHOULD CHECK:                            *
   833*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   834*                              9999 INDICATES AN UNKNOWN ABEND   *
   835*                                   WAS DETECTED.                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  17
* EL130.cbl
   836*                              ALL OTHER VALUES ARE NORMAL ERROR *
   837*                              CODES FOUND IN THE ERROR FILE.    *
   838******************************************************************
   839 01  W-1523-LINKDATA.
   840     12  W-1523-COMMON-PI-DATA.
   841         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   842         16  FILLER              PIC  X(67).
   843         16  W-1523-COMPANY-CD   PIC  X(01).
   844         16  FILLER              PIC  X(10).
   845         16  W-1523-CONTROL-IN-PROGRESS.
   846             20  W-1523-CARRIER  PIC  X(01).
   847             20  W-1523-GROUPING PIC  X(06).
   848             20  W-1523-STATE    PIC  X(02).
   849             20  W-1523-ACCOUNT  PIC  X(10).
   850             20  W-1523-CLAIM-CERT-GRP.
   851                 24  W-1523-CLAIM-NO
   852                                 PIC  X(07).
   853                 24  W-1523-CERT-NO.
   854                     28  W-1523-CERT-PRIME
   855                                 PIC  X(10).
   856                     28  W-1523-CERT-SFX
   857                                 PIC  X(01).
   858                 24  W-1523-CERT-EFF-DT
   859                                 PIC  X(02).
   860         16  FILLER              PIC X(265).
   861
   862     12  W-1523-WORK-AREA.
   863         16  W-1523-FORM-NUMBER  PIC  X(04).
   864         16  W-1523-NUMBER-COPIES
   865                                 PIC  9(01).
   866         16  W-1523-ADDR-TYPE    PIC  X(02).
   867         16  W-1523-FOLLOW-UP-DATE
   868                                 PIC  X(02).
   869         16  W-1523-RESEND-DATE  PIC  X(02).
   870         16  W-1523-ERROR-CODE   PIC  9(04).
   871             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   872             88  W-1523-FATAL-ERROR
   873                                    VALUES  0006 0013 0042
   874                                            0154 0168 0169
   875                                            0176 9999 0172
   876                                            0179 0186 0281
   877                                            0332 2055 3697
   878                                            3698 3699 3770
   879                                            3771 3772 7675
   880                                            9106 9808 9883
   881                                            9887.
   882             88  W-1523-STOP-ERRORS
   883                                    VALUES  0013 0042 0154
   884                                            0168 0169 0172
   885                                            0281 0332 2055
   886                                            3698 3699 7675
   887                                            9106 9808 9883
   888                                            9999.
   889         16  W-1523-REASON       PIC  X(70).
   890         16  W-1523-ARCHIVE-NUMBER
   891                                 PIC  9(08).
   892     12  W-1523-POINTER-AREA.
   893         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  18
* EL130.cbl
   894         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   895         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   896         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   897         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  19
* EL130.cbl
   899*    COPY ELCINTF.
   900******************************************************************
   901*                                                                *
   902*                                                                *
   903*                            ELCINTF.                            *
   904*                            VMOD=2.017                          *
   905*                                                                *
   906*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   907*                                                                *
   908*       LENGTH = 1024                                            *
   909*                                                                *
   910******************************************************************
   911*                   C H A N G E   L O G
   912*
   913* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   914*-----------------------------------------------------------------
   915*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   916* EFFECTIVE    NUMBER
   917*-----------------------------------------------------------------
   918* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   919******************************************************************
   920 01  PROGRAM-INTERFACE-BLOCK.
   921     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   922     12  PI-CALLING-PROGRAM              PIC X(8).
   923     12  PI-SAVED-PROGRAM-1              PIC X(8).
   924     12  PI-SAVED-PROGRAM-2              PIC X(8).
   925     12  PI-SAVED-PROGRAM-3              PIC X(8).
   926     12  PI-SAVED-PROGRAM-4              PIC X(8).
   927     12  PI-SAVED-PROGRAM-5              PIC X(8).
   928     12  PI-SAVED-PROGRAM-6              PIC X(8).
   929     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   930     12  PI-COMPANY-ID                   PIC XXX.
   931     12  PI-COMPANY-CD                   PIC X.
   932
   933     12  PI-COMPANY-PASSWORD             PIC X(8).
   934
   935     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   936
   937     12  PI-CONTROL-IN-PROGRESS.
   938         16  PI-CARRIER                  PIC X.
   939         16  PI-GROUPING                 PIC X(6).
   940         16  PI-STATE                    PIC XX.
   941         16  PI-ACCOUNT                  PIC X(10).
   942         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   943                                         PIC X(10).
   944         16  PI-CLAIM-CERT-GRP.
   945             20  PI-CLAIM-NO             PIC X(7).
   946             20  PI-CERT-NO.
   947                 25  PI-CERT-PRIME       PIC X(10).
   948                 25  PI-CERT-SFX         PIC X.
   949             20  PI-CERT-EFF-DT          PIC XX.
   950         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   951             20  PI-PLAN-CODE            PIC X(2).
   952             20  PI-REVISION-NUMBER      PIC X(3).
   953             20  PI-PLAN-EFF-DT          PIC X(2).
   954             20  PI-PLAN-EXP-DT          PIC X(2).
   955             20  FILLER                  PIC X(11).
   956         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  20
* EL130.cbl
   957             20  PI-OE-REFERENCE-1.
   958                 25  PI-OE-REF-1-PRIME   PIC X(18).
   959                 25  PI-OE-REF-1-SUFF    PIC XX.
   960
   961     12  PI-SESSION-IN-PROGRESS          PIC X.
   962         88  CLAIM-SESSION                   VALUE '1'.
   963         88  CREDIT-SESSION                  VALUE '2'.
   964         88  WARRANTY-SESSION                VALUE '3'.
   965         88  MORTGAGE-SESSION                VALUE '4'.
   966         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   967
   968
   969*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   970
   971     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   972     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   973
   974     12  PI-CREDIT-USER                  PIC X.
   975         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   976         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   977
   978     12  PI-CLAIM-USER                   PIC X.
   979         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   980         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   981
   982     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   983         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   984         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   985         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   986         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   987         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   988
   989     12  PI-PROCESSOR-ID                 PIC X(4).
   990
   991     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   992
   993     12  PI-MEMBER-CAPTION               PIC X(10).
   994
   995     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   996         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   997
   998     12  PI-LIFE-OVERRIDE-L1             PIC X.
   999     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1000     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1001     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1002
  1003     12  PI-AH-OVERRIDE-L1               PIC X.
  1004     12  PI-AH-OVERRIDE-L2               PIC XX.
  1005     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1006     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1007
  1008     12  PI-NEW-SYSTEM                   PIC X(2).
  1009
  1010     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1011     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1012         88  PI-USES-PAID-TO                 VALUE '1'.
  1013     12  PI-CRDTCRD-SYSTEM.
  1014         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  21
* EL130.cbl
  1015             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1016             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1017         16  PI-CC-MONTH-END-DT          PIC XX.
  1018     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1019
  1020     12  PI-OE-REFERENCE-2.
  1021         16  PI-OE-REF-2-PRIME           PIC X(10).
  1022         16  PI-OE-REF-2-SUFF            PIC X.
  1023
  1024     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1025
  1026     12  PI-LANGUAGE-TYPE                PIC X.
  1027             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1028             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1029             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1030
  1031     12  PI-POLICY-LINKAGE-IND           PIC X.
  1032         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1033         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1034                                                   LOW-VALUES.
  1035
  1036     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1037     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1038         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1039         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1040
  1041     12  PI-PROCESSOR-CSR-IND            PIC X.
  1042         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1043         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1044
  1045     12  FILLER                          PIC X(3).
  1046
  1047     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1048
  1049     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1050         PI-SYSTEM-LEVEL.
  1051
  1052         16  PI-ENTRY-CODES.
  1053             20  PI-ENTRY-CD-1           PIC X.
  1054             20  PI-ENTRY-CD-2           PIC X.
  1055
  1056         16  PI-RETURN-CODES.
  1057             20  PI-RETURN-CD-1          PIC X.
  1058             20  PI-RETURN-CD-2          PIC X.
  1059
  1060         16  PI-UPDATE-STATUS-SAVE.
  1061             20  PI-UPDATE-BY            PIC X(4).
  1062             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1063
  1064         16  PI-LOWER-CASE-LETTERS       PIC X.
  1065             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1066
  1067*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1068*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1069*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1070
  1071         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1072             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  22
* EL130.cbl
  1073             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1074             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1075             88  ACCNT-CNTL                  VALUE '3'.
  1076             88  CARR-ACCNT-CNTL             VALUE '4'.
  1077
  1078         16  PI-PROCESSOR-CAP-LIST.
  1079             20  PI-SYSTEM-CONTROLS.
  1080                24 PI-SYSTEM-DISPLAY     PIC X.
  1081                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1082                24 PI-SYSTEM-MODIFY      PIC X.
  1083                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1084             20  FILLER                  PIC XX.
  1085             20  PI-DISPLAY-CAP          PIC X.
  1086                 88  DISPLAY-CAP             VALUE 'Y'.
  1087             20  PI-MODIFY-CAP           PIC X.
  1088                 88  MODIFY-CAP              VALUE 'Y'.
  1089             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1090                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1091             20  PI-FORCE-CAP            PIC X.
  1092                 88  FORCE-CAP               VALUE 'Y'.
  1093
  1094         16  PI-PROGRAM-CONTROLS.
  1095             20  PI-PGM-PRINT-OPT        PIC X.
  1096             20  PI-PGM-FORMAT-OPT       PIC X.
  1097             20  PI-PGM-PROCESS-OPT      PIC X.
  1098             20  PI-PGM-TOTALS-OPT       PIC X.
  1099
  1100         16  PI-HELP-INTERFACE.
  1101             20  PI-LAST-ERROR-NO        PIC X(4).
  1102             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1103
  1104         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1105             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1106
  1107         16  PI-CR-CONTROL-IN-PROGRESS.
  1108             20  PI-CR-CARRIER           PIC X.
  1109             20  PI-CR-GROUPING          PIC X(6).
  1110             20  PI-CR-STATE             PIC XX.
  1111             20  PI-CR-ACCOUNT           PIC X(10).
  1112             20  PI-CR-FIN-RESP          PIC X(10).
  1113             20  PI-CR-TYPE              PIC X.
  1114
  1115         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1116
  1117         16  PI-CR-MONTH-END-DT          PIC XX.
  1118
  1119         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1120             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1121             88  PI-ZERO-CARRIER             VALUE '1'.
  1122             88  PI-ZERO-GROUPING            VALUE '2'.
  1123             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1124
  1125         16  PI-CARRIER-SECURITY         PIC X.
  1126             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1127
  1128         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1129             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1130             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  23
* EL130.cbl
  1131
  1132         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1133             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1134                                         INDEXED BY PI-ACCESS-NDX
  1135                                         PIC X.
  1136
  1137         16  PI-GA-BILLING-CONTROL       PIC X.
  1138             88  PI-GA-BILLING               VALUE '1'.
  1139
  1140         16  PI-MAIL-PROCESSING          PIC X.
  1141             88  PI-MAIL-YES                 VALUE 'Y'.
  1142
  1143         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1144
  1145         16  PI-AR-SYSTEM.
  1146             20  PI-AR-PROCESSING-CNTL   PIC X.
  1147                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1148             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1149             20  PI-AR-MONTH-END-DT      PIC XX.
  1150
  1151         16  PI-MP-SYSTEM.
  1152             20  PI-MORTGAGE-USER            PIC X.
  1153                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1154                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1155             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1156                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1157                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1158                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1159                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1160                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1161             20  PI-MP-MONTH-END-DT          PIC XX.
  1162             20  PI-MP-REFERENCE-NO.
  1163                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1164                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1165
  1166         16  PI-LABEL-CONTROL            PIC X(01).
  1167             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1168             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1169
  1170         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1171             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1172
  1173         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1174             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1175             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1176
  1177         16  FILLER                      PIC X(14).
  1178
  1179     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1180******************************************************************
  1181     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1182         16  PI-MSTR-DT               PIC XX.
  1183         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1184         16  PI-TRLR-DT               PIC XX.
  1185         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1186         16  PI-LAST-CLAIM            PIC X(7).
  1187         16  PI-LAST-CARR             PIC X.
  1188         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  24
* EL130.cbl
  1189             20  PI-LAST-CERT-PRIME   PIC X(10).
  1190             20  PI-LAST-CERT-SUFX    PIC X.
  1191         16  PI-LAST-CLAIM-TYPE       PIC X.
  1192         16  PI-CURSOR                PIC S9(4)   COMP.
  1193         16  PI-SAVE-CERT.
  1194             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1195             20  PI-SAVE-CERT-SUFX    PIC X.
  1196         16  PI-SAVE-EFFDT            PIC X(2).
  1197         16  PI-SAVE-ACCOUNT          PIC X(10).
  1198         16  PI-INCURR-SW             PIC X.
  1199         16  PI-PRT-OPT               PIC X.
  1200         16  PI-ALT-PRT               PIC X(4).
  1201         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1202             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1203         16  FILLER                   PIC X(272).
  1204         16  PI-EL127-TO-EL130-CNTRL.
  1205             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1206             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1207             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1208                 24  PI-EL127-CARRIER        PIC X.
  1209                 24  PI-EL127-GROUPING       PIC X(6).
  1210                 24  PI-EL127-STATE          PIC X(2).
  1211                 24  PI-EL127-ACCOUNT        PIC X(10).
  1212                 24  PI-EL127-CERT-NO.
  1213                     28  PI-EL127-CERT-PRIME PIC X(10).
  1214                     28  PI-EL127-CERT-SUFX  PIC X.
  1215                 24  PI-EL127-EFF-DT         PIC XX.
  1216*        16  FILLER                          PIC X(50).
  1217         16  FILLER                          PIC X(31).
  1218         16  PI-EL659-TO-EL130-CNTRL.
  1219             20  PI-EL659-CARRIER            PIC X.
  1220             20  PI-EL659-GROUPING           PIC X(6).
  1221             20  PI-EL659-STATE              PIC XX.
  1222             20  PI-EL659-ACCOUNT            PIC X(10).
  1223
  1224         16  FILLER                          PIC X(19).
  1225
  1226         16  PI-SAVE-INCUR-DT                PIC X(02).
  1227         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1228*         16  FILLER                          PIC X(65).
  1229         16  PI-ST-VFY-2ND-BENE              PIC X.
  1230         16  PI-ST-CAUSAL-STATE              PIC X.
  1231         16  pi-dcc-max-benefits             pic s999 comp-3.
  1232         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1233         16  pi-emi-sub                      pic 99.
  1234         16  FILLER                          PIC X(53).
  1235
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  25
* EL130.cbl
  1237*    COPY EL130S.
  1238 01  EL130AI.
  1239     05  FILLER            PIC  X(0012).
  1240*    -------------------------------
  1241     05  RUNDTEL PIC S9(0004) COMP.
  1242     05  RUNDTEF PIC  X(0001).
  1243     05  FILLER REDEFINES RUNDTEF.
  1244         10  RUNDTEA PIC  X(0001).
  1245     05  RUNDTEI PIC  X(0008).
  1246*    -------------------------------
  1247     05  RUNTIMEL PIC S9(0004) COMP.
  1248     05  RUNTIMEF PIC  X(0001).
  1249     05  FILLER REDEFINES RUNTIMEF.
  1250         10  RUNTIMEA PIC  X(0001).
  1251     05  RUNTIMEI PIC  X(0005).
  1252*    -------------------------------
  1253     05  COMPL PIC S9(0004) COMP.
  1254     05  COMPF PIC  X(0001).
  1255     05  FILLER REDEFINES COMPF.
  1256         10  COMPA PIC  X(0001).
  1257     05  COMPI PIC  X(0003).
  1258*    -------------------------------
  1259     05  SEQUL PIC S9(0004) COMP.
  1260     05  SEQUF PIC  X(0001).
  1261     05  FILLER REDEFINES SEQUF.
  1262         10  SEQUA PIC  X(0001).
  1263     05  SEQUI PIC  X(0010).
  1264*    -------------------------------
  1265     05  MAINTL PIC S9(0004) COMP.
  1266     05  MAINTF PIC  X(0001).
  1267     05  FILLER REDEFINES MAINTF.
  1268         10  MAINTA PIC  X(0001).
  1269     05  MAINTI PIC  X(0001).
  1270*    -------------------------------
  1271     05  CLMNOL PIC S9(0004) COMP.
  1272     05  CLMNOF PIC  X(0001).
  1273     05  FILLER REDEFINES CLMNOF.
  1274         10  CLMNOA PIC  X(0001).
  1275     05  CLMNOI PIC  X(0007).
  1276*    -------------------------------
  1277     05  CLMCARRL PIC S9(0004) COMP.
  1278     05  CLMCARRF PIC  X(0001).
  1279     05  FILLER REDEFINES CLMCARRF.
  1280         10  CLMCARRA PIC  X(0001).
  1281     05  CLMCARRI PIC  X(0001).
  1282*    -------------------------------
  1283     05  CLMTYPEL PIC S9(0004) COMP.
  1284     05  CLMTYPEF PIC  X(0001).
  1285     05  FILLER REDEFINES CLMTYPEF.
  1286         10  CLMTYPEA PIC  X(0001).
  1287     05  CLMTYPEI PIC  X(0001).
  1288*    -------------------------------
  1289     05  CERTNOL PIC S9(0004) COMP.
  1290     05  CERTNOF PIC  X(0001).
  1291     05  FILLER REDEFINES CERTNOF.
  1292         10  CERTNOA PIC  X(0001).
  1293     05  CERTNOI PIC  X(0010).
  1294*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  26
* EL130.cbl
  1295     05  SUFXL PIC S9(0004) COMP.
  1296     05  SUFXF PIC  X(0001).
  1297     05  FILLER REDEFINES SUFXF.
  1298         10  SUFXA PIC  X(0001).
  1299     05  SUFXI PIC  X(0001).
  1300*    -------------------------------
  1301     05  PCERTNOL PIC S9(0004) COMP.
  1302     05  PCERTNOF PIC  X(0001).
  1303     05  FILLER REDEFINES PCERTNOF.
  1304         10  PCERTNOA PIC  X(0001).
  1305     05  PCERTNOI PIC  X(0010).
  1306*    -------------------------------
  1307     05  PSUFXL PIC S9(0004) COMP.
  1308     05  PSUFXF PIC  X(0001).
  1309     05  FILLER REDEFINES PSUFXF.
  1310         10  PSUFXA PIC  X(0001).
  1311     05  PSUFXI PIC  X(0001).
  1312*    -------------------------------
  1313     05  INCURL PIC S9(0004) COMP.
  1314     05  INCURF PIC  X(0001).
  1315     05  FILLER REDEFINES INCURF.
  1316         10  INCURA PIC  X(0001).
  1317     05  INCURI PIC  X(0008).
  1318*    -------------------------------
  1319     05  REPORTL PIC S9(0004) COMP.
  1320     05  REPORTF PIC  X(0001).
  1321     05  FILLER REDEFINES REPORTF.
  1322         10  REPORTA PIC  X(0001).
  1323     05  REPORTI PIC  X(0008).
  1324*    -------------------------------
  1325     05  ICD1L PIC S9(0004) COMP.
  1326     05  ICD1F PIC  X(0001).
  1327     05  FILLER REDEFINES ICD1F.
  1328         10  ICD1A PIC  X(0001).
  1329     05  ICD1I PIC  X(0008).
  1330*    -------------------------------
  1331     05  ICD2L PIC S9(0004) COMP.
  1332     05  ICD2F PIC  X(0001).
  1333     05  FILLER REDEFINES ICD2F.
  1334         10  ICD2A PIC  X(0001).
  1335     05  ICD2I PIC  X(0008).
  1336*    -------------------------------
  1337     05  DIAGL PIC S9(0004) COMP.
  1338     05  DIAGF PIC  X(0001).
  1339     05  FILLER REDEFINES DIAGF.
  1340         10  DIAGA PIC  X(0001).
  1341     05  DIAGI PIC  X(0060).
  1342*    -------------------------------
  1343     05  BENECDL PIC S9(0004) COMP.
  1344     05  BENECDF PIC  X(0001).
  1345     05  FILLER REDEFINES BENECDF.
  1346         10  BENECDA PIC  X(0001).
  1347     05  BENECDI PIC  X(0010).
  1348*    -------------------------------
  1349     05  BIRTHDTL PIC S9(0004) COMP.
  1350     05  BIRTHDTF PIC  X(0001).
  1351     05  FILLER REDEFINES BIRTHDTF.
  1352         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  27
* EL130.cbl
  1353     05  BIRTHDTI PIC  X(0008).
  1354*    -------------------------------
  1355     05  SSNL PIC S9(0004) COMP.
  1356     05  SSNF PIC  X(0001).
  1357     05  FILLER REDEFINES SSNF.
  1358         10  SSNA PIC  X(0001).
  1359     05  SSNI PIC  X(0011).
  1360*    -------------------------------
  1361     05  SEXL PIC S9(0004) COMP.
  1362     05  SEXF PIC  X(0001).
  1363     05  FILLER REDEFINES SEXF.
  1364         10  SEXA PIC  X(0001).
  1365     05  SEXI PIC  X(0001).
  1366*    -------------------------------
  1367     05  INSTYPEL PIC S9(0004) COMP.
  1368     05  INSTYPEF PIC  X(0001).
  1369     05  FILLER REDEFINES INSTYPEF.
  1370         10  INSTYPEA PIC  X(0001).
  1371     05  INSTYPEI PIC  X(0001).
  1372*    -------------------------------
  1373     05  LSTNMEL PIC S9(0004) COMP.
  1374     05  LSTNMEF PIC  X(0001).
  1375     05  FILLER REDEFINES LSTNMEF.
  1376         10  LSTNMEA PIC  X(0001).
  1377     05  LSTNMEI PIC  X(0015).
  1378*    -------------------------------
  1379     05  FSTNMEL PIC S9(0004) COMP.
  1380     05  FSTNMEF PIC  X(0001).
  1381     05  FILLER REDEFINES FSTNMEF.
  1382         10  FSTNMEA PIC  X(0001).
  1383     05  FSTNMEI PIC  X(0012).
  1384*    -------------------------------
  1385     05  INITL PIC S9(0004) COMP.
  1386     05  INITF PIC  X(0001).
  1387     05  FILLER REDEFINES INITF.
  1388         10  INITA PIC  X(0001).
  1389     05  INITI PIC  X(0001).
  1390*    -------------------------------
  1391     05  LOANNOL PIC S9(0004) COMP.
  1392     05  LOANNOF PIC  X(0001).
  1393     05  FILLER REDEFINES LOANNOF.
  1394         10  LOANNOA PIC  X(0001).
  1395     05  LOANNOI PIC  X(0008).
  1396*    -------------------------------
  1397     05  CRTLNMEL PIC S9(0004) COMP.
  1398     05  CRTLNMEF PIC  X(0001).
  1399     05  FILLER REDEFINES CRTLNMEF.
  1400         10  CRTLNMEA PIC  X(0001).
  1401     05  CRTLNMEI PIC  X(0015).
  1402*    -------------------------------
  1403     05  CRTFNMEL PIC S9(0004) COMP.
  1404     05  CRTFNMEF PIC  X(0001).
  1405     05  FILLER REDEFINES CRTFNMEF.
  1406         10  CRTFNMEA PIC  X(0001).
  1407     05  CRTFNMEI PIC  X(0012).
  1408*    -------------------------------
  1409     05  CRTINITL PIC S9(0004) COMP.
  1410     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  28
* EL130.cbl
  1411     05  FILLER REDEFINES CRTINITF.
  1412         10  CRTINITA PIC  X(0001).
  1413     05  CRTINITI PIC  X(0001).
  1414*    -------------------------------
  1415     05  LOANBALL PIC S9(0004) COMP.
  1416     05  LOANBALF PIC  X(0001).
  1417     05  FILLER REDEFINES LOANBALF.
  1418         10  LOANBALA PIC  X(0001).
  1419     05  LOANBALI PIC  9(7)V99.
  1420*    -------------------------------
  1421     05  MANRSVL PIC S9(0004) COMP.
  1422     05  MANRSVF PIC  X(0001).
  1423     05  FILLER REDEFINES MANRSVF.
  1424         10  MANRSVA PIC  X(0001).
  1425     05  MANRSVI PIC  9(7)V99.
  1426*    -------------------------------
  1427     05  SUPVL PIC S9(0004) COMP.
  1428     05  SUPVF PIC  X(0001).
  1429     05  FILLER REDEFINES SUPVF.
  1430         10  SUPVA PIC  X(0001).
  1431     05  SUPVI PIC  X(0001).
  1432*    -------------------------------
  1433     05  PRICDL PIC S9(0004) COMP.
  1434     05  PRICDF PIC  X(0001).
  1435     05  FILLER REDEFINES PRICDF.
  1436         10  PRICDA PIC  X(0001).
  1437     05  PRICDI PIC  X(0001).
  1438*    -------------------------------
  1439     05  PRODL PIC S9(0004) COMP.
  1440     05  PRODF PIC  X(0001).
  1441     05  FILLER REDEFINES PRODF.
  1442         10  PRODA PIC  X(0001).
  1443     05  PRODI PIC  X(0008).
  1444*    -------------------------------
  1445     05  PRODCDL PIC S9(0004) COMP.
  1446     05  PRODCDF PIC  X(0001).
  1447     05  FILLER REDEFINES PRODCDF.
  1448         10  PRODCDA PIC  X(0001).
  1449     05  PRODCDI PIC  X(0001).
  1450*    -------------------------------
  1451     05  FILETOL PIC S9(0004) COMP.
  1452     05  FILETOF PIC  X(0001).
  1453     05  FILLER REDEFINES FILETOF.
  1454         10  FILETOA PIC  X(0001).
  1455     05  FILETOI PIC  X(0004).
  1456*    -------------------------------
  1457     05  PROCCDL PIC S9(0004) COMP.
  1458     05  PROCCDF PIC  X(0001).
  1459     05  FILLER REDEFINES PROCCDF.
  1460         10  PROCCDA PIC  X(0001).
  1461     05  PROCCDI PIC  X(0004).
  1462*    -------------------------------
  1463     05  RELCLML PIC S9(0004) COMP.
  1464     05  RELCLMF PIC  X(0001).
  1465     05  FILLER REDEFINES RELCLMF.
  1466         10  RELCLMA PIC  X(0001).
  1467     05  RELCLMI PIC  X(0007).
  1468*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  29
* EL130.cbl
  1469     05  PRTOPTL PIC S9(0004) COMP.
  1470     05  PRTOPTF PIC  X(0001).
  1471     05  FILLER REDEFINES PRTOPTF.
  1472         10  PRTOPTA PIC  X(0001).
  1473     05  PRTOPTI PIC  X(0001).
  1474*    -------------------------------
  1475     05  ALTPRTL PIC S9(0004) COMP.
  1476     05  ALTPRTF PIC  X(0001).
  1477     05  FILLER REDEFINES ALTPRTF.
  1478         10  ALTPRTA PIC  X(0001).
  1479     05  ALTPRTI PIC  X(0004).
  1480*    -------------------------------
  1481     05  CERTMTL PIC S9(0004) COMP.
  1482     05  CERTMTF PIC  X(0001).
  1483     05  FILLER REDEFINES CERTMTF.
  1484         10  CERTMTA PIC  X(0001).
  1485     05  CERTMTI PIC  X(0001).
  1486*    -------------------------------
  1487     05  CRTCARRL PIC S9(0004) COMP.
  1488     05  CRTCARRF PIC  X(0001).
  1489     05  FILLER REDEFINES CRTCARRF.
  1490         10  CRTCARRA PIC  X(0001).
  1491     05  CRTCARRI PIC  X(0001).
  1492*    -------------------------------
  1493     05  GROUPL PIC S9(0004) COMP.
  1494     05  GROUPF PIC  X(0001).
  1495     05  FILLER REDEFINES GROUPF.
  1496         10  GROUPA PIC  X(0001).
  1497     05  GROUPI PIC  X(0006).
  1498*    -------------------------------
  1499     05  STATEL PIC S9(0004) COMP.
  1500     05  STATEF PIC  X(0001).
  1501     05  FILLER REDEFINES STATEF.
  1502         10  STATEA PIC  X(0001).
  1503     05  STATEI PIC  X(0002).
  1504*    -------------------------------
  1505     05  ACCOUNTL PIC S9(0004) COMP.
  1506     05  ACCOUNTF PIC  X(0001).
  1507     05  FILLER REDEFINES ACCOUNTF.
  1508         10  ACCOUNTA PIC  X(0001).
  1509     05  ACCOUNTI PIC  X(0010).
  1510*    -------------------------------
  1511     05  EFFDTL PIC S9(0004) COMP.
  1512     05  EFFDTF PIC  X(0001).
  1513     05  FILLER REDEFINES EFFDTF.
  1514         10  EFFDTA PIC  X(0001).
  1515     05  EFFDTI PIC  X(0008).
  1516*    -------------------------------
  1517     05  CRTSSNL PIC S9(0004) COMP.
  1518     05  CRTSSNF PIC  X(0001).
  1519     05  FILLER REDEFINES CRTSSNF.
  1520         10  CRTSSNA PIC  X(0001).
  1521     05  CRTSSNI PIC  X(0011).
  1522*    -------------------------------
  1523     05  MEMCAPL PIC S9(0004) COMP.
  1524     05  MEMCAPF PIC  X(0001).
  1525     05  FILLER REDEFINES MEMCAPF.
  1526         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  30
* EL130.cbl
  1527     05  MEMCAPI PIC  X(0010).
  1528*    -------------------------------
  1529     05  MEMBERL PIC S9(0004) COMP.
  1530     05  MEMBERF PIC  X(0001).
  1531     05  FILLER REDEFINES MEMBERF.
  1532         10  MEMBERA PIC  X(0001).
  1533     05  MEMBERI PIC  X(0012).
  1534*    -------------------------------
  1535     05  REINCDL PIC S9(0004) COMP.
  1536     05  REINCDF PIC  X(0001).
  1537     05  FILLER REDEFINES REINCDF.
  1538         10  REINCDA PIC  X(0001).
  1539     05  REINCDI PIC  X(0001).
  1540*    -------------------------------
  1541     05  ISSAGEL PIC S9(0004) COMP.
  1542     05  ISSAGEF PIC  X(0001).
  1543     05  FILLER REDEFINES ISSAGEF.
  1544         10  ISSAGEA PIC  X(0001).
  1545     05  ISSAGEI PIC  X(0002).
  1546*    -------------------------------
  1547     05  APRL PIC S9(0004) COMP.
  1548     05  APRF PIC  X(0001).
  1549     05  FILLER REDEFINES APRF.
  1550         10  APRA PIC  X(0001).
  1551     05  APRI PIC  9(4)V9(4).
  1552*    -------------------------------
  1553     05  PMTFREQL PIC S9(0004) COMP.
  1554     05  PMTFREQF PIC  X(0001).
  1555     05  FILLER REDEFINES PMTFREQF.
  1556         10  PMTFREQA PIC  X(0001).
  1557     05  PMTFREQI PIC  99.
  1558*    -------------------------------
  1559     05  INDGRPL PIC S9(0004) COMP.
  1560     05  INDGRPF PIC  X(0001).
  1561     05  FILLER REDEFINES INDGRPF.
  1562         10  INDGRPA PIC  X(0001).
  1563     05  INDGRPI PIC  X(0001).
  1564*    -------------------------------
  1565     05  PREMTYPL PIC S9(0004) COMP.
  1566     05  PREMTYPF PIC  X(0001).
  1567     05  FILLER REDEFINES PREMTYPF.
  1568         10  PREMTYPA PIC  X(0001).
  1569     05  PREMTYPI PIC  X(0001).
  1570*    -------------------------------
  1571     05  ADDONDTL PIC S9(0004) COMP.
  1572     05  ADDONDTF PIC  X(0001).
  1573     05  FILLER REDEFINES ADDONDTF.
  1574         10  ADDONDTA PIC  X(0001).
  1575     05  ADDONDTI PIC  X(0008).
  1576*    -------------------------------
  1577     05  JNTLNMEL PIC S9(0004) COMP.
  1578     05  JNTLNMEF PIC  X(0001).
  1579     05  FILLER REDEFINES JNTLNMEF.
  1580         10  JNTLNMEA PIC  X(0001).
  1581     05  JNTLNMEI PIC  X(0015).
  1582*    -------------------------------
  1583     05  JNTFNMEL PIC S9(0004) COMP.
  1584     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  31
* EL130.cbl
  1585     05  FILLER REDEFINES JNTFNMEF.
  1586         10  JNTFNMEA PIC  X(0001).
  1587     05  JNTFNMEI PIC  X(0002).
  1588*    -------------------------------
  1589     05  JNTINITL PIC S9(0004) COMP.
  1590     05  JNTINITF PIC  X(0001).
  1591     05  FILLER REDEFINES JNTINITF.
  1592         10  JNTINITA PIC  X(0001).
  1593     05  JNTINITI PIC  X(0001).
  1594*    -------------------------------
  1595     05  JNTAGEL PIC S9(0004) COMP.
  1596     05  JNTAGEF PIC  X(0001).
  1597     05  FILLER REDEFINES JNTAGEF.
  1598         10  JNTAGEA PIC  X(0001).
  1599     05  JNTAGEI PIC  X(0002).
  1600*    -------------------------------
  1601     05  LCVDSCRL PIC S9(0004) COMP.
  1602     05  LCVDSCRF PIC  X(0001).
  1603     05  FILLER REDEFINES LCVDSCRF.
  1604         10  LCVDSCRA PIC  X(0001).
  1605     05  LCVDSCRI PIC  X(0006).
  1606*    -------------------------------
  1607     05  LCVKINDL PIC S9(0004) COMP.
  1608     05  LCVKINDF PIC  X(0001).
  1609     05  FILLER REDEFINES LCVKINDF.
  1610         10  LCVKINDA PIC  X(0001).
  1611     05  LCVKINDI PIC  X(0003).
  1612*    -------------------------------
  1613     05  LCVCDL PIC S9(0004) COMP.
  1614     05  LCVCDF PIC  X(0001).
  1615     05  FILLER REDEFINES LCVCDF.
  1616         10  LCVCDA PIC  X(0001).
  1617     05  LCVCDI PIC  X(0002).
  1618*    -------------------------------
  1619     05  LCVOTRML PIC S9(0004) COMP.
  1620     05  LCVOTRMF PIC  X(0001).
  1621     05  FILLER REDEFINES LCVOTRMF.
  1622         10  LCVOTRMA PIC  X(0001).
  1623     05  LCVOTRMI PIC  999.
  1624*    -------------------------------
  1625     05  LCVRTRML PIC S9(0004) COMP.
  1626     05  LCVRTRMF PIC  X(0001).
  1627     05  FILLER REDEFINES LCVRTRMF.
  1628         10  LCVRTRMA PIC  X(0001).
  1629     05  LCVRTRMI PIC  X(0003).
  1630*    -------------------------------
  1631     05  LCVRATEL PIC S9(0004) COMP.
  1632     05  LCVRATEF PIC  X(0001).
  1633     05  FILLER REDEFINES LCVRATEF.
  1634         10  LCVRATEA PIC  X(0001).
  1635     05  LCVRATEI PIC  9999V99.
  1636*    -------------------------------
  1637     05  LCVBENEL PIC S9(0004) COMP.
  1638     05  LCVBENEF PIC  X(0001).
  1639     05  FILLER REDEFINES LCVBENEF.
  1640         10  LCVBENEA PIC  X(0001).
  1641     05  LCVBENEI PIC  9(9)V99.
  1642*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  32
* EL130.cbl
  1643     05  LCVFORML PIC S9(0004) COMP.
  1644     05  LCVFORMF PIC  X(0001).
  1645     05  FILLER REDEFINES LCVFORMF.
  1646         10  LCVFORMA PIC  X(0001).
  1647     05  LCVFORMI PIC  X(0012).
  1648*    -------------------------------
  1649     05  LCVCNDTL PIC S9(0004) COMP.
  1650     05  LCVCNDTF PIC  X(0001).
  1651     05  FILLER REDEFINES LCVCNDTF.
  1652         10  LCVCNDTA PIC  X(0001).
  1653     05  LCVCNDTI PIC  X(0008).
  1654*    -------------------------------
  1655     05  LCVEXITL PIC S9(0004) COMP.
  1656     05  LCVEXITF PIC  X(0001).
  1657     05  FILLER REDEFINES LCVEXITF.
  1658         10  LCVEXITA PIC  X(0001).
  1659     05  LCVEXITI PIC  X(0008).
  1660*    -------------------------------
  1661     05  LCVSTATL PIC S9(0004) COMP.
  1662     05  LCVSTATF PIC  X(0001).
  1663     05  FILLER REDEFINES LCVSTATF.
  1664         10  LCVSTATA PIC  X(0001).
  1665     05  LCVSTATI PIC  X(0006).
  1666*    -------------------------------
  1667     05  ACVDSCRL PIC S9(0004) COMP.
  1668     05  ACVDSCRF PIC  X(0001).
  1669     05  FILLER REDEFINES ACVDSCRF.
  1670         10  ACVDSCRA PIC  X(0001).
  1671     05  ACVDSCRI PIC  X(0006).
  1672*    -------------------------------
  1673     05  ACVKINDL PIC S9(0004) COMP.
  1674     05  ACVKINDF PIC  X(0001).
  1675     05  FILLER REDEFINES ACVKINDF.
  1676         10  ACVKINDA PIC  X(0001).
  1677     05  ACVKINDI PIC  X(0003).
  1678*    -------------------------------
  1679     05  ACVCDL PIC S9(0004) COMP.
  1680     05  ACVCDF PIC  X(0001).
  1681     05  FILLER REDEFINES ACVCDF.
  1682         10  ACVCDA PIC  X(0001).
  1683     05  ACVCDI PIC  X(0002).
  1684*    -------------------------------
  1685     05  ACVOTRML PIC S9(0004) COMP.
  1686     05  ACVOTRMF PIC  X(0001).
  1687     05  FILLER REDEFINES ACVOTRMF.
  1688         10  ACVOTRMA PIC  X(0001).
  1689     05  ACVOTRMI PIC  999.
  1690*    -------------------------------
  1691     05  ACVRTRML PIC S9(0004) COMP.
  1692     05  ACVRTRMF PIC  X(0001).
  1693     05  FILLER REDEFINES ACVRTRMF.
  1694         10  ACVRTRMA PIC  X(0001).
  1695     05  ACVRTRMI PIC  X(0003).
  1696*    -------------------------------
  1697     05  ACVRATEL PIC S9(0004) COMP.
  1698     05  ACVRATEF PIC  X(0001).
  1699     05  FILLER REDEFINES ACVRATEF.
  1700         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  33
* EL130.cbl
  1701     05  ACVRATEI PIC  9999V99.
  1702*    -------------------------------
  1703     05  ACVBENEL PIC S9(0004) COMP.
  1704     05  ACVBENEF PIC  X(0001).
  1705     05  FILLER REDEFINES ACVBENEF.
  1706         10  ACVBENEA PIC  X(0001).
  1707     05  ACVBENEI PIC  9(9)V99.
  1708*    -------------------------------
  1709     05  ACVFORML PIC S9(0004) COMP.
  1710     05  ACVFORMF PIC  X(0001).
  1711     05  FILLER REDEFINES ACVFORMF.
  1712         10  ACVFORMA PIC  X(0001).
  1713     05  ACVFORMI PIC  X(0012).
  1714*    -------------------------------
  1715     05  ACVCNDTL PIC S9(0004) COMP.
  1716     05  ACVCNDTF PIC  X(0001).
  1717     05  FILLER REDEFINES ACVCNDTF.
  1718         10  ACVCNDTA PIC  X(0001).
  1719     05  ACVCNDTI PIC  X(0008).
  1720*    -------------------------------
  1721     05  ACVEXITL PIC S9(0004) COMP.
  1722     05  ACVEXITF PIC  X(0001).
  1723     05  FILLER REDEFINES ACVEXITF.
  1724         10  ACVEXITA PIC  X(0001).
  1725     05  ACVEXITI PIC  X(0008).
  1726*    -------------------------------
  1727     05  ACVSTATL PIC S9(0004) COMP.
  1728     05  ACVSTATF PIC  X(0001).
  1729     05  FILLER REDEFINES ACVSTATF.
  1730         10  ACVSTATA PIC  X(0001).
  1731     05  ACVSTATI PIC  X(0006).
  1732*    -------------------------------
  1733     05  ERRMSG1L PIC S9(0004) COMP.
  1734     05  ERRMSG1F PIC  X(0001).
  1735     05  FILLER REDEFINES ERRMSG1F.
  1736         10  ERRMSG1A PIC  X(0001).
  1737     05  ERRMSG1I PIC  X(0072).
  1738*    -------------------------------
  1739     05  ERRMSG2L PIC S9(0004) COMP.
  1740     05  ERRMSG2F PIC  X(0001).
  1741     05  FILLER REDEFINES ERRMSG2F.
  1742         10  ERRMSG2A PIC  X(0001).
  1743     05  ERRMSG2I PIC  X(0072).
  1744*    -------------------------------
  1745     05  BCERT1L PIC S9(0004) COMP.
  1746     05  BCERT1F PIC  X(0001).
  1747     05  FILLER REDEFINES BCERT1F.
  1748         10  BCERT1A PIC  X(0001).
  1749     05  BCERT1I PIC  X(0010).
  1750*    -------------------------------
  1751     05  BSUFX1L PIC S9(0004) COMP.
  1752     05  BSUFX1F PIC  X(0001).
  1753     05  FILLER REDEFINES BSUFX1F.
  1754         10  BSUFX1A PIC  X(0001).
  1755     05  BSUFX1I PIC  X(0001).
  1756*    -------------------------------
  1757     05  BCERT2L PIC S9(0004) COMP.
  1758     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  34
* EL130.cbl
  1759     05  FILLER REDEFINES BCERT2F.
  1760         10  BCERT2A PIC  X(0001).
  1761     05  BCERT2I PIC  X(0010).
  1762*    -------------------------------
  1763     05  BSUFX2L PIC S9(0004) COMP.
  1764     05  BSUFX2F PIC  X(0001).
  1765     05  FILLER REDEFINES BSUFX2F.
  1766         10  BSUFX2A PIC  X(0001).
  1767     05  BSUFX2I PIC  X(0001).
  1768*    -------------------------------
  1769     05  BCERT3L PIC S9(0004) COMP.
  1770     05  BCERT3F PIC  X(0001).
  1771     05  FILLER REDEFINES BCERT3F.
  1772         10  BCERT3A PIC  X(0001).
  1773     05  BCERT3I PIC  X(0010).
  1774*    -------------------------------
  1775     05  BSUFX3L PIC S9(0004) COMP.
  1776     05  BSUFX3F PIC  X(0001).
  1777     05  FILLER REDEFINES BSUFX3F.
  1778         10  BSUFX3A PIC  X(0001).
  1779     05  BSUFX3I PIC  X(0001).
  1780*    -------------------------------
  1781     05  BCERT4L PIC S9(0004) COMP.
  1782     05  BCERT4F PIC  X(0001).
  1783     05  FILLER REDEFINES BCERT4F.
  1784         10  BCERT4A PIC  X(0001).
  1785     05  BCERT4I PIC  X(0010).
  1786*    -------------------------------
  1787     05  BSUFX4L PIC S9(0004) COMP.
  1788     05  BSUFX4F PIC  X(0001).
  1789     05  FILLER REDEFINES BSUFX4F.
  1790         10  BSUFX4A PIC  X(0001).
  1791     05  BSUFX4I PIC  X(0001).
  1792*    -------------------------------
  1793     05  BCERT5L PIC S9(0004) COMP.
  1794     05  BCERT5F PIC  X(0001).
  1795     05  FILLER REDEFINES BCERT5F.
  1796         10  BCERT5A PIC  X(0001).
  1797     05  BCERT5I PIC  X(0010).
  1798*    -------------------------------
  1799     05  BSUFX5L PIC S9(0004) COMP.
  1800     05  BSUFX5F PIC  X(0001).
  1801     05  FILLER REDEFINES BSUFX5F.
  1802         10  BSUFX5A PIC  X(0001).
  1803     05  BSUFX5I PIC  X(0001).
  1804*    -------------------------------
  1805     05  ENTERPFL PIC S9(0004) COMP.
  1806     05  ENTERPFF PIC  X(0001).
  1807     05  FILLER REDEFINES ENTERPFF.
  1808         10  ENTERPFA PIC  X(0001).
  1809     05  ENTERPFI PIC  99.
  1810*    -------------------------------
  1811     05  PF5L PIC S9(0004) COMP.
  1812     05  PF5F PIC  X(0001).
  1813     05  FILLER REDEFINES PF5F.
  1814         10  PF5A PIC  X(0001).
  1815     05  PF5I PIC  X(0013).
  1816 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  35
* EL130.cbl
  1817     05  FILLER            PIC  X(0012).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  RUNDTEO PIC  X(0008).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  RUNTIMEO PIC  99.99.
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  COMPO PIC  X(0003).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  SEQUO PIC  X(0010).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  MAINTO PIC  X(0001).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  CLMNOO PIC  X(0007).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  CLMCARRO PIC  X(0001).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  CLMTYPEO PIC  X(0001).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  CERTNOO PIC  X(0010).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  SUFXO PIC  X(0001).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  PCERTNOO PIC  X(0010).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  PSUFXO PIC  X(0001).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  INCURO PIC  X(0008).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  REPORTO PIC  X(0008).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  ICD1O PIC  X(0008).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  ICD2O PIC  X(0008).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  DIAGO PIC  X(0060).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  BENECDO PIC  X(0010).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  36
* EL130.cbl
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  SSNO PIC  X(0011).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  SEXO PIC  X(0001).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  INSTYPEO PIC  X(0001).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  LSTNMEO PIC  X(0015).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  FSTNMEO PIC  X(0012).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  INITO PIC  X(0001).
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  LOANNOO PIC  X(0008).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  CRTLNMEO PIC  X(0015).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  CRTFNMEO PIC  X(0012).
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  CRTINITO PIC  X(0001).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  LOANBALO PIC  ZZZZZ9.99.
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  MANRSVO PIC  Z(5)9.99.
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  SUPVO PIC  X(0001).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  PRICDO PIC  X(0001).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  PRODO PIC  X(0008).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  PRODCDO PIC  X(0001).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  FILETOO PIC  X(0004).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  PROCCDO PIC  X(0004).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  RELCLMO PIC  X(0007).
  1932*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  37
* EL130.cbl
  1933     05  FILLER            PIC  X(0003).
  1934     05  PRTOPTO PIC  X(0001).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  ALTPRTO PIC  X(0004).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  CERTMTO PIC  X(0001).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  CRTCARRO PIC  X(0001).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  GROUPO PIC  X(0006).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  STATEO PIC  X(0002).
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  ACCOUNTO PIC  X(0010).
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  EFFDTO PIC  X(0008).
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  CRTSSNO PIC  X(0011).
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  MEMCAPO PIC  X(0010).
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  MEMBERO PIC  X(0012).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  REINCDO PIC  X(0001).
  1968*    -------------------------------
  1969     05  FILLER            PIC  X(0003).
  1970     05  ISSAGEO PIC  X(0002).
  1971*    -------------------------------
  1972     05  FILLER            PIC  X(0003).
  1973     05  APRO PIC  9(3).9(4).
  1974*    -------------------------------
  1975     05  FILLER            PIC  X(0003).
  1976     05  PMTFREQO PIC  99.
  1977*    -------------------------------
  1978     05  FILLER            PIC  X(0003).
  1979     05  INDGRPO PIC  X(0001).
  1980*    -------------------------------
  1981     05  FILLER            PIC  X(0003).
  1982     05  PREMTYPO PIC  X(0001).
  1983*    -------------------------------
  1984     05  FILLER            PIC  X(0003).
  1985     05  ADDONDTO PIC  X(0008).
  1986*    -------------------------------
  1987     05  FILLER            PIC  X(0003).
  1988     05  JNTLNMEO PIC  X(0015).
  1989*    -------------------------------
  1990     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  38
* EL130.cbl
  1991     05  JNTFNMEO PIC  X(0002).
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  JNTINITO PIC  X(0001).
  1995*    -------------------------------
  1996     05  FILLER            PIC  X(0003).
  1997     05  JNTAGEO PIC  X(0002).
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
  2000     05  LCVDSCRO PIC  X(0006).
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  LCVKINDO PIC  X(0003).
  2004*    -------------------------------
  2005     05  FILLER            PIC  X(0003).
  2006     05  LCVCDO PIC  X(0002).
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  LCVOTRMO PIC  999.
  2010*    -------------------------------
  2011     05  FILLER            PIC  X(0003).
  2012     05  LCVRTRMO PIC  ZZZ.
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  LCVRATEO PIC  ZZZ.ZZ.
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  LCVFORMO PIC  X(0012).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  LCVCNDTO PIC  X(0008).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  LCVEXITO PIC  X(0008).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  LCVSTATO PIC  X(0006).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  ACVDSCRO PIC  X(0006).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  ACVKINDO PIC  X(0003).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  ACVCDO PIC  X(0002).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  ACVOTRMO PIC  999.
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  ACVRTRMO PIC  ZZZ.
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  39
* EL130.cbl
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  ACVFORMO PIC  X(0012).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  ACVCNDTO PIC  X(0008).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  ACVEXITO PIC  X(0008).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  ACVSTATO PIC  X(0006).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  ERRMSG1O PIC  X(0072).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  ERRMSG2O PIC  X(0072).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  BCERT1O PIC  X(0010).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  BSUFX1O PIC  X(0001).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  BCERT2O PIC  X(0010).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  BSUFX2O PIC  X(0001).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  BCERT3O PIC  X(0010).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  BSUFX3O PIC  X(0001).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  BCERT4O PIC  X(0010).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  BSUFX4O PIC  X(0001).
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  BCERT5O PIC  X(0010).
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  BSUFX5O PIC  X(0001).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  ENTERPFO PIC  X(0002).
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  PF5O PIC  X(0013).
  2106*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  40
* EL130.cbl
  2108*    COPY ELCDATE.
  2109******************************************************************
  2110*                                                                *
  2111*                                                                *
  2112*                            ELCDATE.                            *
  2113*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2114*                            VMOD=2.003
  2115*                                                                *
  2116*                                                                *
  2117*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2118*                 LENGTH = 200                                   *
  2119******************************************************************
  2120
  2121 01  DATE-CONVERSION-DATA.
  2122     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2123     12  DC-OPTION-CODE                PIC X.
  2124         88  BIN-TO-GREG                VALUE ' '.
  2125         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2126         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2127         88  YMD-GREG-TO-BIN            VALUE '3'.
  2128         88  MDY-GREG-TO-BIN            VALUE '4'.
  2129         88  JULIAN-TO-BIN              VALUE '5'.
  2130         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2131         88  FIND-CENTURY               VALUE '7'.
  2132         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2133         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2134         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2135         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2136         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2137         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2138         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2139         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2140         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2141         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2142         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2143         88  BIN-3-TO-GREG              VALUE 'I'.
  2144         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2145         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2146         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2147         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2148         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2149         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2150         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2151         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2152         88  THREE-CHARACTER-BIN
  2153                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2154         88  GREGORIAN-TO-BIN
  2155                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2156         88  BIN-TO-GREGORIAN
  2157                  VALUES ' ' '1' 'I' '8' 'G'.
  2158         88  JULIAN-TO-BINARY
  2159                  VALUES '5' 'C' 'E' 'F'.
  2160     12  DC-ERROR-CODE                 PIC X.
  2161         88  NO-CONVERSION-ERROR        VALUE ' '.
  2162         88  DATE-CONVERSION-ERROR
  2163                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2164         88  DATE-IS-ZERO               VALUE '1'.
  2165         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  41
* EL130.cbl
  2166         88  DATE-IS-INVALID            VALUE '3'.
  2167         88  DATE1-GREATER-DATE2        VALUE '4'.
  2168         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2169         88  DATE-INVALID-OPTION        VALUE '9'.
  2170         88  INVALID-CENTURY            VALUE 'A'.
  2171         88  ONLY-CENTURY               VALUE 'B'.
  2172         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2173         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2174     12  DC-END-OF-MONTH               PIC X.
  2175         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2176     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2177         88  USE-NORMAL-PROCESS         VALUE ' '.
  2178         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2179         88  ADJUST-UP-100-YRS          VALUE '2'.
  2180     12  FILLER                        PIC X.
  2181     12  DC-CONVERSION-DATES.
  2182         16  DC-BIN-DATE-1             PIC XX.
  2183         16  DC-BIN-DATE-2             PIC XX.
  2184         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2185         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2186                       DC-GREG-DATE-1-EDIT.
  2187             20  DC-EDIT1-MONTH        PIC 99.
  2188             20  SLASH1-1              PIC X.
  2189             20  DC-EDIT1-DAY          PIC 99.
  2190             20  SLASH1-2              PIC X.
  2191             20  DC-EDIT1-YEAR         PIC 99.
  2192         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2193         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2194                     DC-GREG-DATE-2-EDIT.
  2195             20  DC-EDIT2-MONTH        PIC 99.
  2196             20  SLASH2-1              PIC X.
  2197             20  DC-EDIT2-DAY          PIC 99.
  2198             20  SLASH2-2              PIC X.
  2199             20  DC-EDIT2-YEAR         PIC 99.
  2200         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2201         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2202                     DC-GREG-DATE-1-YMD.
  2203             20  DC-YMD-YEAR           PIC 99.
  2204             20  DC-YMD-MONTH          PIC 99.
  2205             20  DC-YMD-DAY            PIC 99.
  2206         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2207         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2208                      DC-GREG-DATE-1-MDY.
  2209             20  DC-MDY-MONTH          PIC 99.
  2210             20  DC-MDY-DAY            PIC 99.
  2211             20  DC-MDY-YEAR           PIC 99.
  2212         16  DC-GREG-DATE-1-ALPHA.
  2213             20  DC-ALPHA-MONTH        PIC X(10).
  2214             20  DC-ALPHA-DAY          PIC 99.
  2215             20  FILLER                PIC XX.
  2216             20  DC-ALPHA-CENTURY.
  2217                 24 DC-ALPHA-CEN-N     PIC 99.
  2218             20  DC-ALPHA-YEAR         PIC 99.
  2219         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2220         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2221         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2222         16  DC-JULIAN-DATE            PIC 9(05).
  2223         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  42
* EL130.cbl
  2224                                       PIC 9(05).
  2225         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2226             20  DC-JULIAN-YEAR        PIC 99.
  2227             20  DC-JULIAN-DAYS        PIC 999.
  2228         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2229         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2230         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2231     12  DATE-CONVERSION-VARIBLES.
  2232         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2233         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2234             20  FILLER                PIC 9(3).
  2235             20  HOLD-CEN-1-CCYY.
  2236                 24  HOLD-CEN-1-CC     PIC 99.
  2237                 24  HOLD-CEN-1-YY     PIC 99.
  2238             20  HOLD-CEN-1-MO         PIC 99.
  2239             20  HOLD-CEN-1-DA         PIC 99.
  2240         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2241             20  HOLD-CEN-1-R-MO       PIC 99.
  2242             20  HOLD-CEN-1-R-DA       PIC 99.
  2243             20  HOLD-CEN-1-R-CCYY.
  2244                 24  HOLD-CEN-1-R-CC   PIC 99.
  2245                 24  HOLD-CEN-1-R-YY   PIC 99.
  2246             20  FILLER                PIC 9(3).
  2247         16  HOLD-CENTURY-1-X.
  2248             20  FILLER                PIC X(3)  VALUE SPACES.
  2249             20  HOLD-CEN-1-X-CCYY.
  2250                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2251                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2252             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2253             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2254         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2255             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2256             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2257             20  HOLD-CEN-1-R-X-CCYY.
  2258                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2259                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2260             20  FILLER                PIC XXX.
  2261         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2262         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2263         16  DC-JULIAN-DATE-1          PIC 9(07).
  2264         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2265             20  DC-JULIAN-1-CCYY.
  2266                 24  DC-JULIAN-1-CC    PIC 99.
  2267                 24  DC-JULIAN-1-YR    PIC 99.
  2268             20  DC-JULIAN-DA-1        PIC 999.
  2269         16  DC-JULIAN-DATE-2          PIC 9(07).
  2270         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2271             20  DC-JULIAN-2-CCYY.
  2272                 24  DC-JULIAN-2-CC    PIC 99.
  2273                 24  DC-JULIAN-2-YR    PIC 99.
  2274             20  DC-JULIAN-DA-2        PIC 999.
  2275         16  DC-GREG-DATE-A-EDIT.
  2276             20  DC-EDITA-MONTH        PIC 99.
  2277             20  SLASHA-1              PIC X VALUE '/'.
  2278             20  DC-EDITA-DAY          PIC 99.
  2279             20  SLASHA-2              PIC X VALUE '/'.
  2280             20  DC-EDITA-CCYY.
  2281                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  43
* EL130.cbl
  2282                 24  DC-EDITA-YEAR     PIC 99.
  2283         16  DC-GREG-DATE-B-EDIT.
  2284             20  DC-EDITB-MONTH        PIC 99.
  2285             20  SLASHB-1              PIC X VALUE '/'.
  2286             20  DC-EDITB-DAY          PIC 99.
  2287             20  SLASHB-2              PIC X VALUE '/'.
  2288             20  DC-EDITB-CCYY.
  2289                 24  DC-EDITB-CENT     PIC 99.
  2290                 24  DC-EDITB-YEAR     PIC 99.
  2291         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2292         16  DC-GREG-DATE-CYMD-R REDEFINES
  2293                              DC-GREG-DATE-CYMD.
  2294             20  DC-CYMD-CEN           PIC 99.
  2295             20  DC-CYMD-YEAR          PIC 99.
  2296             20  DC-CYMD-MONTH         PIC 99.
  2297             20  DC-CYMD-DAY           PIC 99.
  2298         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2299         16  DC-GREG-DATE-MDCY-R REDEFINES
  2300                              DC-GREG-DATE-MDCY.
  2301             20  DC-MDCY-MONTH         PIC 99.
  2302             20  DC-MDCY-DAY           PIC 99.
  2303             20  DC-MDCY-CEN           PIC 99.
  2304             20  DC-MDCY-YEAR          PIC 99.
  2305    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2306        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2307    12  DC-EL310-DATE                  PIC X(21).
  2308    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  44
* EL130.cbl
  2310*    COPY ELCCALC.
  2311******************************************************************
  2312*                                                                *
  2313*                           ELCCALC.                            *
  2314*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2315*                            VMOD=2.025                          *
  2316*                                                                *
  2317*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2318*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2319*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2320*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2321*                                                                *
  2322*  PASSED TO ELRTRM                                              *
  2323*  -----------------                                             *
  2324*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2325*  ORIGINAL TERM                                                 *
  2326*  BEGINNING DATE                                                *
  2327*  ENDING DATE                                                   *
  2328*  COMPANY I.D.                                                  *
  2329*  ACCOUNT MASTER USER FIELD                                     *
  2330*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2331*  FREE LOOK DAYS                                                *
  2332*                                                                *
  2333*  RETURNED FROM ELRTRM                                          *
  2334*  ---------------------                                         *
  2335*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2336*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2337*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2338*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2339*----------------------------------------------------------------*
  2340*  PASSED TO ELRAMT                                              *
  2341*  ----------------                                              *
  2342*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2343*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2344*  ORIGINAL AMOUNT                                               *
  2345*  ALTERNATE BENEFIT (BALLON)                                    *
  2346*  A.P.R. - NET PAY ONLY                                         *
  2347*  METHOD
  2348*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2349*  COMPANY I.D.                                                  *
  2350*  BENEFIT TYPE                                                  *
  2351*                                                                *
  2352*  RETURNED FROM ELRAMT                                          *
  2353*  --------------------                                          *
  2354*  REMAINING AMOUNT 1 - CURRENT                                  *
  2355*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2356*  REMAINING AMOUNT FACTOR
  2357*----------------------------------------------------------------*
  2358*  PASSED TO ELRESV                                              *
  2359*  -----------------                                             *
  2360*  CERTIFICATE EFFECTIVE DATE                                    *
  2361*  VALUATION DATE                                                *
  2362*  PAID THRU DATE                                                *
  2363*  BENEFIT                                                       *
  2364*  INCURRED DATE                                                 *
  2365*  REPORTED DATE                                                 *
  2366*  ISSUE AGE                                                     *
  2367*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  45
* EL130.cbl
  2368*  CDT PERCENT                                                   *
  2369*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2370* *CLAIM TYPE (LIFE, A/H)                                        *
  2371* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2372* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2373*                                                                *
  2374*  RETURNED FROM ELRESV                                          *
  2375*  --------------------                                          *
  2376*  CDT TABLE USED                                                *
  2377*  CDT FACTOR USED                                               *
  2378*  PAY TO CURRENT RESERVE                                        *
  2379*  I.B.N.R. - A/H ONLY                                           *
  2380*  FUTURE (ACCRUED) AH ONLY                                      *
  2381*----------------------------------------------------------------*
  2382*  PASSED TO ELRATE                                              *
  2383*  ----------------                                              *
  2384*  CERT ISSUE DATE                                               *
  2385*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2386*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2387*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2388*  STATE CODE (CLIENT DEFINED)                                   *
  2389*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2390*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2391*  DEVIATION CODE                                                *
  2392*  ISSUE AGE                                                     *
  2393*  ORIGINAL BENEFIT AMOUNT                                       *
  2394*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2395*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2396*  BENEFIT KIND (LIFE OR A/H)                                    *
  2397*  A.P.R.                                                        *
  2398*  METHOD
  2399*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2400*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2401*  COMPANY I.D. (3 CHARACTER)                                    *
  2402*  BENEFIT CODE                                                  *
  2403*  BENEFIT OVERRIDE CODE                                         *
  2404*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2405*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2406*  JOINT INDICATOR (CSL ONLY)                                    *
  2407*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2408*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2409*                                                                *
  2410*  RETURNED FROM ELRATE                                          *
  2411*  --------------------                                          *
  2412*  CALCULATED PREMIUM                                            *
  2413*  PREMIUM RATE                                                  *
  2414*  MORTALITY CODE                                                *
  2415*  MAX ATTAINED AGE                                              *
  2416*  MAX AGE                                                       *
  2417*  MAX TERM                                                      *
  2418*  MAX MONTHLY BENEFIT                                           *
  2419*  MAX TOTAL BENIFIT                                             *
  2420*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2421*----------------------------------------------------------------*
  2422*  PASSED TO ELRFND                                              *
  2423*  ----------------                                              *
  2424*  CERT ISSUE DATE                                               *
  2425*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  46
* EL130.cbl
  2426*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2427*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2428*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2429*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2430*  STATE CODE (CLIENT DEFINED)                                   *
  2431*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2432*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2433*  DEVIATION CODE                                                *
  2434*  ISSUE AGE                                                     *
  2435*  ORIGINAL BENEFIT AMOUNT                                       *
  2436*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2437*  PROCESS TYPE (CANCEL)                                         *
  2438*  BENEFIT KIND (LIFE OR A/H)                                    *
  2439*  A.P.R.                                                        *
  2440*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2441*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2442*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2443*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2444*  COMPANY I.D. (3 CHARACTER)                                    *
  2445*  BENEFIT CODE                                                  *
  2446*  BENEFIT OVERRIDE CODE                                         *
  2447*                                                                *
  2448*  RETURNED FROM ELRFND                                          *
  2449*  --------------------                                          *
  2450*  CALCULATED REFUND                                             *
  2451*----------------------------------------------------------------*
  2452*  PASSED TO ELEARN                                              *
  2453*  ----------------                                              *
  2454*  CERT ISSUE DATE                                               *
  2455*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2456*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2457*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2458*  STATE CODE (CLIENT DEFINED)                                   *
  2459*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2460*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2461*  DEVIATION CODE                                                *
  2462*  ISSUE AGE                                                     *
  2463*  ORIGINAL BENEFIT AMOUNT                                       *
  2464*  BENEFIT KIND (LIFE OR A/H)                                    *
  2465*  A.P.R.                                                        *
  2466*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2467*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2468*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2469*  COMPANY I.D. (3 CHARACTER)                                    *
  2470*  BENEFIT CODE                                                  *
  2471*  BENEFIT OVERRIDE CODE                                         *
  2472*                                                                *
  2473*  RETURNED FROM ELEARN                                          *
  2474*  --------------------                                          *
  2475*  INDICATED  EARNINGS                                           *
  2476*----------------------------------------------------------------*
  2477*                 LENGTH = 450                                   *
  2478*                                                                *
  2479******************************************************************
  2480******************************************************************
  2481*                   C H A N G E   L O G
  2482*
  2483* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  47
* EL130.cbl
  2484*-----------------------------------------------------------------
  2485*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2486* EFFECTIVE    NUMBER
  2487*-----------------------------------------------------------------
  2488* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2489* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2490* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2491* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2492* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2493* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2494* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2495* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2496* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2497* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2498* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2499* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
  2500******************************************************************
  2501
  2502 01  CALCULATION-PASS-AREA.
  2503     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2504                                     COMP.
  2505
  2506     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2507       88  NO-CP-ERROR                             VALUE ZERO.
  2508       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2509                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
  2510       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2511       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2512       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2513       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2514       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2515       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2516       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2517       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2518       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2519       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2520       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2521       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2522       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2523       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2524       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2525       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2526       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2527       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
  2528
  2529     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2530       88  NO-CP-ERROR-2                           VALUE ZERO.
  2531***********************  INPUT AREAS ****************************
  2532
  2533     12  CP-CALCULATION-AREA.
  2534         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2535         16  CP-CERT-EFF-DT        PIC XX.
  2536         16  CP-VALUATION-DT       PIC XX.
  2537         16  CP-PAID-THRU-DT       PIC XX.
  2538         16  CP-BENEFIT-TYPE       PIC X.
  2539           88  CP-AH                               VALUE 'A' 'D'
  2540                                                   'I' 'U'.
  2541           88  CP-REDUCING-LIFE                    VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  48
* EL130.cbl
  2542           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2543         16  CP-INCURRED-DT        PIC XX.
  2544         16  CP-REPORTED-DT        PIC XX.
  2545         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2546         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2547         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2548                                     COMP-3.
  2549         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2550                                     COMP-3.
  2551         16  CP-CDT-METHOD         PIC X.
  2552           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2553           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2554           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2555         16  CP-CLAIM-TYPE         PIC X.
  2556           88  CP-AH-CLAIM                         VALUE 'A'.
  2557           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2558         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2559                                     COMP-3.
  2560         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2561                                     COMP-3.
  2562         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2563                                     COMP-3.
  2564         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2565                                     COMP-3.
  2566         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2567                                     COMP-3.
  2568         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2569                                     COMP-3.
  2570         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2571                                     COMP-3.
  2572         16  CP-REM-TERM-METHOD    PIC X.
  2573           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2574           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2575           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2576           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2577           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2578           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2579           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2580         16  CP-EARNING-METHOD     PIC X.
  2581           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2582           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2583           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2584           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2585           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2586           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2587           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2588           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2589           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2590           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2591           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2592           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2593           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2594           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2595         16  CP-PROCESS-TYPE       PIC X.
  2596           88  CP-CLAIM                            VALUE '1'.
  2597           88  CP-CANCEL                           VALUE '2'.
  2598           88  CP-ISSUE                            VALUE '3'.
  2599         16  CP-SPECIAL-CALC-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  49
* EL130.cbl
  2600           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2601           88  CP-1-MTH-INTEREST               VALUE ' '.
  2602           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2603           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2604           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2605           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2606           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2607           88  CP-FARM-PLAN                    VALUE 'F'.
  2608           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2609           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2610           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2611           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2612           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2613           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2614           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2615           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2616           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2617           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2618                                                     'W' 'X'.
  2619           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2620           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2621           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2622           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2623           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2624           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2625           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2626           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2627           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2628           88  CP-CSL-METH-1                   VALUE '5'.
  2629           88  CP-CSL-METH-2                   VALUE '6'.
  2630           88  CP-CSL-METH-3                   VALUE '7'.
  2631           88  CP-CSL-METH-4                   VALUE '8'.
  2632
  2633         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2634                                     COMP-3.
  2635         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2636         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2637         16  CP-STATE              PIC XX          VALUE SPACE.
  2638         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2639         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2640           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2641               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2642         16  CP-R78-OPTION         PIC X.
  2643           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2644           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2645
  2646         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2647         16  CP-IBNR-RESERVE-SW    PIC X.
  2648         16  CP-CLAIM-STATUS       PIC X.
  2649         16  CP-RATE-FILE          PIC X.
  2650         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2651                                     COMP-3.
  2652
  2653         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2654         16  CP-AH-OVERRIDE-CODE   PIC X.
  2655
  2656         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2657                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  50
* EL130.cbl
  2658         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2659                                   PIC S9(5)V99 COMP-3.
  2660         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2661                                     COMP-3.
  2662         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2663                                     COMP-3.
  2664         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2665                                     COMP-3.
  2666         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2667                                  PIC S9(7)V99 COMP-3.
  2668
  2669         16  CP-PAID-FROM-DATE     PIC X(02).
  2670         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2671         16  CP-EXT-DAYS-CALC      PIC X.
  2672           88  CP-EXT-NO-CHG                   VALUE ' '.
  2673           88  CP-EXT-CHG-LF                   VALUE '1'.
  2674           88  CP-EXT-CHG-AH                   VALUE '2'.
  2675           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2676         16  CP-DOMICILE-STATE     PIC XX.
  2677         16  CP-CARRIER            PIC X.
  2678         16  CP-REIN-FLAG          PIC X.
  2679         16  CP-REM-TRM-CALC-OPTION PIC X.
  2680           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2681                      '2' '3' '4' '5'.
  2682           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2683           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2684           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2685           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2686           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2687           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2688           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2689           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2690         16  CP-SIG-SWITCH         PIC X.
  2691         16  CP-RATING-METHOD      PIC X.
  2692           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2693           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2694           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2695           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2696           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2697           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2698           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2699           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2700           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2701         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2702                                     COMP-3.
  2703         16  CP-BEN-CATEGORY       PIC X.
  2704         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2705         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2706                                   PIC S99V9(5) COMP-3.
  2707         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2708         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2709                                   PIC S99V9(5) COMP-3.
  2710         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2711         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2712         16  CP-EXPIRE-DT          PIC XX.
  2713         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2714         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2715         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  51
* EL130.cbl
  2716         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2717         16  CP-DDF-SPEC-CALC      PIC X.
  2718             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2719             88  CP-CALC-CLP              VALUE 'C'.
  2720         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2721         16  CP-CANCEL-REASON      PIC X.
  2722         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2723         16  CP-PMT-MODE           PIC X.
  2724         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2725         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2726         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2727         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2728         16  FILLER                PIC X.
  2729
  2730***************    OUTPUT FROM ELRESV   ************************
  2731
  2732         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2733
  2734         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2735                                     COMP-3.
  2736         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2737                                     COMP-3.
  2738         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2739                                     COMP-3.
  2740         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2741                                     COMP-3.
  2742         16  FILLER                PIC X(09).
  2743***************    OUTPUT FROM ELRTRM   *************************
  2744
  2745         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2746                                     COMP-3.
  2747         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2748                                     COMP-3.
  2749         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2750                                     COMP-3.
  2751         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2752                                     COMP-3.
  2753         16  FILLER                PIC X(12).
  2754
  2755***************    OUTPUT FROM ELRAMT   *************************
  2756
  2757         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2758                                     COMP-3.
  2759         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2760                                     COMP-3.
  2761         16  FILLER                PIC X(12).
  2762
  2763***************    OUTPUT FROM ELRATE   *************************
  2764
  2765         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2766                                     COMP-3.
  2767         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2768                                     COMP-3.
  2769         16  CP-MORTALITY-CODE     PIC X(4).
  2770         16  CP-RATE-EDIT-FLAG     PIC X.
  2771             88  CP-RATES-NEED-APR                  VALUE '1'.
  2772         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2773                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  52
* EL130.cbl
  2774         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2775         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2776         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2777                                   PIC S9(7)V99 COMP-3.
  2778         16  FILLER                PIC X(07).
  2779
  2780***************    OUTPUT FROM ELRFND   *************************
  2781
  2782         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2783                                     COMP-3.
  2784         16  CP-REFUND-TYPE-USED   PIC X.
  2785           88  CP-R-AS-R78                         VALUE '1'.
  2786           88  CP-R-AS-PRORATA                     VALUE '2'.
  2787           88  CP-R-AS-CALIF                       VALUE '3'.
  2788           88  CP-R-AS-TEXAS                       VALUE '4'.
  2789           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2790           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2791           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2792           88  CP-R-AS-MEAN                        VALUE '8'.
  2793           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2794           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2795           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2796           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2797           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2798           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2799         16  FILLER                PIC X(12).
  2800
  2801***************    OUTPUT FROM ELEARN   *************************
  2802
  2803         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2804                                     COMP-3.
  2805         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2806                                     COMP-3.
  2807         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2808                                     COMP-3.
  2809         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2810                                     COMP-3.
  2811         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2812                                     COMP-3.
  2813         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2814                                     COMP-3.
  2815         16  CP-EARNING-TYPE-USED  PIC X.
  2816           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2817           88  CP-E-AS-R78                         VALUE '1'.
  2818           88  CP-E-AS-PRORATA                     VALUE '2'.
  2819           88  CP-E-AS-TEXAS                       VALUE '4'.
  2820           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2821           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2822           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2823           88  CP-E-AS-MEAN                        VALUE '8'.
  2824           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2825         16  FILLER                PIC X(12).
  2826
  2827***************    OUTPUT FROM ELPMNT   *************************
  2828
  2829         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2830                                     COMP-3.
  2831         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  53
* EL130.cbl
  2832                                     COMP-3.
  2833         16  FILLER                PIC X(12).
  2834
  2835***************   MISC WORK AREAS    *****************************
  2836         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2837                                     COMP-3.
  2838         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2839                                     COMP-3.
  2840         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2841                                     COMP-3.
  2842         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2843                                     COMP-3.
  2844         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2845                                     COMP-3.
  2846         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2847                                     COMP-3.
  2848         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2849             88  OPEN-RATE-FILE                   VALUE 'O'.
  2850             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2851             88  IO-ERROR                         VALUE 'E'.
  2852
  2853         16  CP-FIRST-PAY-DATE     PIC XX.
  2854
  2855         16  CP-JOINT-INDICATOR    PIC X.
  2856
  2857         16  CP-RESERVE-REMAINING-TERM
  2858                                   PIC S9(4)V9    VALUE ZERO
  2859                                     COMP-3.
  2860
  2861         16  CP-INSURED-BIRTH-DT   PIC XX.
  2862
  2863         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2864                                     COMP-3.
  2865
  2866         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2867                                     COMP-3.
  2868
  2869         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2870                                     COMP-3.
  2871
  2872         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2873                                     COMP-3.
  2874
  2875         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2876                                     COMP-3.
  2877
  2878         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2879                                     COMP-3.
  2880
  2881         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2882                                     COMP-3.
  2883
  2884         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2885             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2886
  2887         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2888                                     COMP-3.
  2889         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  54
* EL130.cbl
  2890                                     COMP-3.
  2891         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2892         16  cp-extra-periods      pic 9 value zeros.
  2893         16  cp-net-only-state     pic x value spaces.
  2894         16  FILLER                PIC X(13).
  2895******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  55
* EL130.cbl
  2897*    COPY ELCLOGOF.
  2898******************************************************************
  2899*                                                                *
  2900*                                                                *
  2901*                            ELCLOGOF.                           *
  2902*                            VMOD=2.001                          *
  2903*                                                                *
  2904*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2905*                                                                *
  2906******************************************************************
  2907 01  CLASIC-LOGOFF.
  2908     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2909     12  LOGOFF-TEXT.
  2910         16  FILLER          PIC X(5)    VALUE SPACES.
  2911         16  LOGOFF-MSG.
  2912             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2913             20  FILLER      PIC X       VALUE SPACES.
  2914             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2915         16  FILLER          PIC X(80)
  2916           VALUE '* YOU ARE NOW LOGGED OFF'.
  2917         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2918         16  FILLER          PIC X       VALUE QUOTE.
  2919         16  LOGOFF-SYS-MSG  PIC X(17)
  2920           VALUE 'S CLAS-IC SYSTEM '.
  2921     12  TEXT-MESSAGES.
  2922         16  UNACCESS-MSG    PIC X(29)
  2923             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2924         16  PGMIDERR-MSG    PIC X(17)
  2925             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  56
* EL130.cbl
  2927*    COPY ELCATTR.
  2928******************************************************************
  2929*                                                                *
  2930*                            ELCATTR.                            *
  2931*                            VMOD=2.001                          *
  2932*                                                                *
  2933*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2934*                                                                *
  2935*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2936*                                                                *
  2937*                   POS 1   P=PROTECTED                          *
  2938*                           U=UNPROTECTED                        *
  2939*                           S=ASKIP                              *
  2940*                   POS 2   A=ALPHA/NUMERIC                      *
  2941*                           N=NUMERIC                            *
  2942*                   POS 3   N=NORMAL                             *
  2943*                           B=BRIGHT                             *
  2944*                           D=DARK                               *
  2945*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2946*                           OF=MODIFIED DATA TAG OFF             *
  2947*                                                                *
  2948*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2949******************************************************************
  2950 01  ATTRIBUTE-LIST.
  2951     12  AL-PABOF            PIC X       VALUE 'Y'.
  2952     12  AL-PABON            PIC X       VALUE 'Z'.
  2953     12  AL-PADOF            PIC X       VALUE '%'.
  2954     12  AL-PADON            PIC X       VALUE '_'.
  2955     12  AL-PANOF            PIC X       VALUE '-'.
  2956     12  AL-PANON            PIC X       VALUE '/'.
  2957     12  AL-SABOF            PIC X       VALUE '8'.
  2958     12  AL-SABON            PIC X       VALUE '9'.
  2959     12  AL-SADOF            PIC X       VALUE '@'.
  2960     12  AL-SADON            PIC X       VALUE QUOTE.
  2961     12  AL-SANOF            PIC X       VALUE '0'.
  2962     12  AL-SANON            PIC X       VALUE '1'.
  2963     12  AL-UABOF            PIC X       VALUE 'H'.
  2964     12  AL-UABON            PIC X       VALUE 'I'.
  2965     12  AL-UADOF            PIC X       VALUE '<'.
  2966     12  AL-UADON            PIC X       VALUE '('.
  2967     12  AL-UANOF            PIC X       VALUE ' '.
  2968     12  AL-UANON            PIC X       VALUE 'A'.
  2969     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2970     12  AL-UNBON            PIC X       VALUE 'R'.
  2971     12  AL-UNDOF            PIC X       VALUE '*'.
  2972     12  AL-UNDON            PIC X       VALUE ')'.
  2973     12  AL-UNNOF            PIC X       VALUE '&'.
  2974     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  57
* EL130.cbl
  2976*    COPY ELCEMIB.
  2977******************************************************************
  2978*                                                                *
  2979*                                                                *
  2980*                            ELCEMIB.                            *
  2981*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2982*                            VMOD=2.005                          *
  2983*                                                                *
  2984*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2985*                                                                *
  2986******************************************************************
  2987 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2988     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2989     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2990     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2991     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2992     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2993     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2994     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2995     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2996     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2997         88  EMI-NO-ERRORS                    VALUE '1'.
  2998         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2999         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3000     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3001         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3002     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3003         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3004         88  EMI-AREA1-FULL                   VALUE '2'.
  3005     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3006         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3007         88  EMI-AREA2-FULL                   VALUE '2'.
  3008     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3009         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3010         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3011         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3012         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3013         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3014     12  EMI-ERROR-LINES.
  3015         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3016         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3017         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3018         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3019             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3020                 24  EMI-ERR-NUM         PIC X(4).
  3021                 24  EMI-FILLER          PIC X.
  3022                 24  EMI-SEV             PIC X.
  3023                 24  FILLER              PIC X.
  3024             20  FILLER                  PIC X(02).
  3025     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3026         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3027             20  EMI-ERROR-NUMBER    PIC X(4).
  3028             20  EMI-FILL            PIC X.
  3029             20  EMI-SEVERITY        PIC X.
  3030             20  FILLER              PIC X.
  3031             20  EMI-ERROR-TEXT.
  3032                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3033                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  58
* EL130.cbl
  3034     12  EMI-SEVERITY-SAVE           PIC X.
  3035         88  EMI-NOTE                    VALUE 'N'.
  3036         88  EMI-WARNING                 VALUE 'W'.
  3037         88  EMI-FORCABLE                VALUE 'F'.
  3038         88  EMI-FATAL                   VALUE 'X'.
  3039     12  EMI-MESSAGE-FLAG            PIC X.
  3040         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3041         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3042     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3043     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3044         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3045         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3046         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3047     12  emi-claim-no                pic x(7).
  3048     12  emi-claim-type              pic x(6).
  3049     12  FILLER                      PIC X(124)  VALUE SPACES.
  3050     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3051     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3052     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3053     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  59
* EL130.cbl
  3055*    COPY ELCJPFX.
  3056******************************************************************
  3057*                                                                *
  3058*                                                                *
  3059*                            ELCJPFX.                            *
  3060*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3061*                            VMOD=2.002                          *
  3062*                                                                *
  3063*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3064*                                                                *
  3065*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3066*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3067*        ELCNTL - CONTROL FILE                                   *
  3068*        ELMSTR - CLAIM MASTERS                                  *
  3069*        ELTRLR - ACTIVITY TRAILERS                              *
  3070*        ELCHKQ - CHECK QUE                                      *
  3071******************************************************************
  3072 01  JOURNAL-RECORD.
  3073     12  jp-date                     pic s9(5) comp-3.
  3074     12  jp-time                     pic s9(7) comp-3.
  3075     12  JP-USER-ID                  PIC X(4).
  3076     12  JP-FILE-ID                  PIC X(8).
  3077     12  JP-PROGRAM-ID               PIC X(8).
  3078     12  JP-RECORD-TYPE              PIC X.
  3079         88 JP-ADD              VALUE 'A'.
  3080         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3081         88 JP-AFTER-CHANGE     VALUE 'C'.
  3082         88 JP-DELETE           VALUE 'D'.
  3083         88 JP-GENERIC-DELETE   VALUE 'G'.
  3084         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3085         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3086     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3087     12  JP-RECORD-AREA
  3088
  3089
  3090         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  60
* EL130.cbl
  3092*    COPY ELCAID.
  3093******************************************************************
  3094*                                                                *
  3095*                            ELCAID.                             *
  3096*                            VMOD=2.001                          *
  3097*                                                                *
  3098*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3099*                                                                *
  3100*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3101*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3102******************************************************************
  3103
  3104 01  DFHAID.
  3105   02  DFHNULL   PIC  X  VALUE  ' '.
  3106   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3107   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3108   02  DFHPEN    PIC  X  VALUE  '='.
  3109   02  DFHOPID   PIC  X  VALUE  'W'.
  3110   02  DFHPA1    PIC  X  VALUE  '%'.
  3111   02  DFHPA2    PIC  X  VALUE  '>'.
  3112   02  DFHPA3    PIC  X  VALUE  ','.
  3113   02  DFHPF1    PIC  X  VALUE  '1'.
  3114   02  DFHPF2    PIC  X  VALUE  '2'.
  3115   02  DFHPF3    PIC  X  VALUE  '3'.
  3116   02  DFHPF4    PIC  X  VALUE  '4'.
  3117   02  DFHPF5    PIC  X  VALUE  '5'.
  3118   02  DFHPF6    PIC  X  VALUE  '6'.
  3119   02  DFHPF7    PIC  X  VALUE  '7'.
  3120   02  DFHPF8    PIC  X  VALUE  '8'.
  3121   02  DFHPF9    PIC  X  VALUE  '9'.
  3122   02  DFHPF10   PIC  X  VALUE  ':'.
  3123   02  DFHPF11   PIC  X  VALUE  '#'.
  3124   02  DFHPF12   PIC  X  VALUE  '@'.
  3125   02  DFHPF13   PIC  X  VALUE  'A'.
  3126   02  DFHPF14   PIC  X  VALUE  'B'.
  3127   02  DFHPF15   PIC  X  VALUE  'C'.
  3128   02  DFHPF16   PIC  X  VALUE  'D'.
  3129   02  DFHPF17   PIC  X  VALUE  'E'.
  3130   02  DFHPF18   PIC  X  VALUE  'F'.
  3131   02  DFHPF19   PIC  X  VALUE  'G'.
  3132   02  DFHPF20   PIC  X  VALUE  'H'.
  3133   02  DFHPF21   PIC  X  VALUE  'I'.
  3134*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3135   02  DFHPF22   PIC  X  VALUE  '['.
  3136   02  DFHPF23   PIC  X  VALUE  '.'.
  3137   02  DFHPF24   PIC  X  VALUE  '<'.
  3138   02  DFHMSRE   PIC  X  VALUE  'X'.
  3139   02  DFHSTRF   PIC  X  VALUE  'h'.
  3140   02  DFHTRIG   PIC  X  VALUE  '"'.
  3141
  3142 01  FILLER    REDEFINES DFHAID.
  3143     12  FILLER              PIC X(8).
  3144     12  PF-VALUES           PIC X       OCCURS 12.
  3145
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  61
* EL130.cbl
  3147****************************************************************
  3148*
  3149* Copyright (c) 2007-2013 Dell Inc.
  3150* All rights reserved.
  3151*
  3152****************************************************************
  3153 01  DFHEIV.
  3154   02  DFHEIV0               PIC X(35).
  3155   02  DFHEIV1               PIC X(08).
  3156   02  DFHEIV2               PIC X(08).
  3157   02  DFHEIV3               PIC X(08).
  3158   02  DFHEIV4               PIC X(06).
  3159   02  DFHEIV5               PIC X(04).
  3160   02  DFHEIV6               PIC X(04).
  3161   02  DFHEIV7               PIC X(02).
  3162   02  DFHEIV8               PIC X(02).
  3163   02  DFHEIV9               PIC X(01).
  3164   02  DFHEIV10              PIC S9(7) COMP-3.
  3165   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3166   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3167   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3168   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3169   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3170   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3171   02  DFHEIV17              PIC X(04).
  3172   02  DFHEIV18              PIC X(04).
  3173   02  DFHEIV19              PIC X(04).
  3174   02  DFHEIV20              USAGE IS POINTER.
  3175   02  DFHEIV21              USAGE IS POINTER.
  3176   02  DFHEIV22              USAGE IS POINTER.
  3177   02  DFHEIV23              USAGE IS POINTER.
  3178   02  DFHEIV24              USAGE IS POINTER.
  3179   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3180   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3181   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3182   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3183   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3184   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3185   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3186   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3187   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3188   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3189   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3190   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3191   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3192   02  FILLER                PIC X(02).
  3193   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3194   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3195   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3196   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3197   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3198   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3199   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3200 LINKAGE  SECTION.
  3201*****************************************************************
  3202*                                                               *
  3203* Copyright (c) 2007-2013 Dell Inc.                             *
  3204* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  62
* EL130.cbl
  3205*                                                               *
  3206*****************************************************************
  3207 01  dfheiblk.
  3208     02  eibtime          pic s9(7) comp-3.
  3209     02  eibdate          pic s9(7) comp-3.
  3210     02  eibtrnid         pic x(4).
  3211     02  eibtaskn         pic s9(7) comp-3.
  3212     02  eibtrmid         pic x(4).
  3213     02  dfheigdi         pic s9(4) comp.
  3214     02  eibcposn         pic s9(4) comp.
  3215     02  eibcalen         pic s9(4) comp.
  3216     02  eibaid           pic x(1).
  3217     02  eibfiller1       pic x(1).
  3218     02  eibfn            pic x(2).
  3219     02  eibfiller2       pic x(2).
  3220     02  eibrcode         pic x(6).
  3221     02  eibfiller3       pic x(2).
  3222     02  eibds            pic x(8).
  3223     02  eibreqid         pic x(8).
  3224     02  eibrsrce         pic x(8).
  3225     02  eibsync          pic x(1).
  3226     02  eibfree          pic x(1).
  3227     02  eibrecv          pic x(1).
  3228     02  eibsend          pic x(1).
  3229     02  eibatt           pic x(1).
  3230     02  eibeoc           pic x(1).
  3231     02  eibfmh           pic x(1).
  3232     02  eibcompl         pic x(1).
  3233     02  eibsig           pic x(1).
  3234     02  eibconf          pic x(1).
  3235     02  eiberr           pic x(1).
  3236     02  eibrldbk         pic x(1).
  3237     02  eiberrcd         pic x(4).
  3238     02  eibsynrb         pic x(1).
  3239     02  eibnodat         pic x(1).
  3240     02  eibfiller5       pic x(2).
  3241     02  eibresp          pic s9(8) comp.
  3242     02  eibresp2         pic s9(8) comp.
  3243     02  dfheigdj         pic s9(4) comp.
  3244     02  dfheigdk         pic s9(4) comp.
  3245
  3246 01  DFHCOMMAREA             PIC X(1024).
  3247
  3248*01 PARMLIST .
  3249*    02  FILLER              PIC S9(8)   COMP.
  3250*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3251*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3252*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3253*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3254*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3255*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3256*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3257*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3258*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  63
* EL130.cbl
  3260*    COPY ELCMSTR.
  3261******************************************************************
  3262*                                                                *
  3263*                            ELCMSTR.                            *
  3264*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3265*                            VMOD=2.012                          *
  3266*                                                                *
  3267*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3268*                                                                *
  3269*   FILE TYPE = VSAM,KSDS                                        *
  3270*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3271*                                                                *
  3272*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3273*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3274*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3275*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3276*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3277*                                                 RKP=75,LEN=21  *
  3278*                                                                *
  3279*   **** NOTE ****                                               *
  3280*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3281*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3282*                                                                *
  3283*   LOG = YES                                                    *
  3284*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3285******************************************************************
  3286*                   C H A N G E   L O G
  3287*
  3288* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3289*-----------------------------------------------------------------
  3290*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3291* EFFECTIVE    NUMBER
  3292*-----------------------------------------------------------------
  3293* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3294* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3295* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3296* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3297* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3298* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3299* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3300******************************************************************
  3301 01  CLAIM-MASTER.
  3302     12  CL-RECORD-ID                PIC XX.
  3303         88  VALID-CL-ID         VALUE 'CL'.
  3304
  3305     12  CL-CONTROL-PRIMARY.
  3306         16  CL-COMPANY-CD           PIC X.
  3307         16  CL-CARRIER              PIC X.
  3308         16  CL-CLAIM-NO             PIC X(7).
  3309         16  CL-CERT-NO.
  3310             20  CL-CERT-PRIME       PIC X(10).
  3311             20  CL-CERT-SFX         PIC X.
  3312
  3313     12  CL-CONTROL-BY-NAME.
  3314         16  CL-COMPANY-CD-A1        PIC X.
  3315         16  CL-INSURED-LAST-NAME    PIC X(15).
  3316         16  CL-INSURED-NAME.
  3317             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  64
* EL130.cbl
  3318             20  CL-INSURED-MID-INIT PIC X.
  3319
  3320     12  CL-CONTROL-BY-SSN.
  3321         16  CL-COMPANY-CD-A2        PIC X.
  3322         16  CL-SOC-SEC-NO.
  3323             20  CL-SSN-STATE        PIC XX.
  3324             20  CL-SSN-ACCOUNT      PIC X(6).
  3325             20  CL-SSN-LN3          PIC X(3).
  3326
  3327     12  CL-CONTROL-BY-CERT-NO.
  3328         16  CL-COMPANY-CD-A4        PIC X.
  3329         16  CL-CERT-NO-A4.
  3330             20  CL-CERT-A4-PRIME    PIC X(10).
  3331             20  CL-CERT-A4-SFX      PIC X.
  3332
  3333     12  CL-CONTROL-BY-CCN.
  3334         16  CL-COMPANY-CD-A5        PIC X.
  3335         16  CL-CCN-A5.
  3336             20  CL-CCN.
  3337                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3338                 24  CL-CCN-PRIME-A5 PIC X(12).
  3339             20  CL-CCN-FILLER-A5    PIC X(4).
  3340
  3341     12  CL-INSURED-PROFILE-DATA.
  3342         16  CL-INSURED-BIRTH-DT     PIC XX.
  3343         16  CL-INSURED-SEX-CD       PIC X.
  3344             88  INSURED-IS-MALE        VALUE 'M'.
  3345             88  INSURED-IS-FEMALE      VALUE 'F'.
  3346             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3347         16  CL-INSURED-OCC-CD       PIC X(6).
  3348         16  FILLER                  PIC X(5).
  3349
  3350     12  CL-PROCESSING-INFO.
  3351         16  CL-PROCESSOR-ID         PIC X(4).
  3352         16  CL-CLAIM-STATUS         PIC X.
  3353             88  CLAIM-IS-OPEN          VALUE 'O'.
  3354             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3355         16  CL-CLAIM-TYPE           PIC X.
  3356*            88  AH-CLAIM               VALUE 'A'.
  3357*            88  LIFE-CLAIM             VALUE 'L'.
  3358*            88  PROPERTY-CLAIM         VALUE 'P'.
  3359*            88  IUI-CLAIM              VALUE 'I'.
  3360*            88  GAP-CLAIM              VALUE 'G'.
  3361*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3362*            88  OTHER-CLAIM            VALUE 'O'.
  3363         16  CL-CLAIM-PREM-TYPE      PIC X.
  3364             88  SINGLE-PREMIUM         VALUE '1'.
  3365             88  O-B-COVERAGE           VALUE '2'.
  3366             88  OPEN-END-COVERAGE      VALUE '3'.
  3367         16  CL-INCURRED-DT          PIC XX.
  3368         16  CL-REPORTED-DT          PIC XX.
  3369         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3370         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3371         16  CL-LAST-PMT-DT          PIC XX.
  3372         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3373         16  CL-PAID-THRU-DT         PIC XX.
  3374         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3375         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  65
* EL130.cbl
  3376         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3377         16  CL-PMT-CALC-METHOD      PIC X.
  3378             88  CL-360-DAY-YR          VALUE '1'.
  3379             88  CL-365-DAY-YR          VALUE '2'.
  3380             88  CL-FULL-MONTHS         VALUE '3'.
  3381         16  CL-CAUSE-CD             PIC X(6).
  3382
  3383         16  CL-PRIME-CERT-NO.
  3384             20  CL-PRIME-CERT-PRIME PIC X(10).
  3385             20  CL-PRIME-CERT-SFX   PIC X.
  3386
  3387         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3388             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3389             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3390
  3391         16  CL-MICROFILM-NO         PIC X(10).
  3392         16  FILLER REDEFINES CL-MICROFILM-NO.
  3393             20  CL-BENEFIT-PERIOD   PIC 99.
  3394             20  FILLER              PIC X(8).
  3395         16  CL-PROG-FORM-TYPE       PIC X.
  3396         16  CL-LAST-ADD-ON-DT       PIC XX.
  3397
  3398         16  CL-LAST-REOPEN-DT       PIC XX.
  3399         16  CL-LAST-CLOSE-DT        PIC XX.
  3400         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3401             88  FINAL-PAID             VALUE '1'.
  3402             88  CLAIM-DENIED           VALUE '2'.
  3403             88  AUTO-CLOSE             VALUE '3'.
  3404             88  MANUAL-CLOSE           VALUE '4'.
  3405             88  BENEFITS-CHANGED       VALUE 'C'.
  3406             88  SETUP-ERRORS           VALUE 'E'.
  3407         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3408         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3409         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3410             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3411         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3412         16  FILLER                  PIC X.
  3413
  3414     12  CL-CERTIFICATE-DATA.
  3415         16  CL-CERT-ORIGIN          PIC X.
  3416             88  CERT-WAS-ONLINE        VALUE '1'.
  3417             88  CERT-WAS-CREATED       VALUE '2'.
  3418             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3419         16  CL-CERT-KEY-DATA.
  3420             20  CL-CERT-CARRIER     PIC X.
  3421             20  CL-CERT-GROUPING    PIC X(6).
  3422             20  CL-CERT-STATE       PIC XX.
  3423             20  CL-CERT-ACCOUNT.
  3424                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3425                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3426             20  CL-CERT-EFF-DT      PIC XX.
  3427
  3428     12  CL-STATUS-CONTROLS.
  3429         16  CL-PRIORITY-CD          PIC X.
  3430             88  CONFIDENTIAL-DATA      VALUE '8'.
  3431             88  HIGHEST-PRIORITY       VALUE '9'.
  3432         16  CL-SUPV-ATTN-CD         PIC X.
  3433             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  66
* EL130.cbl
  3434             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3435         16  CL-PURGED-DT            PIC XX.
  3436         16  CL-RESTORED-DT          PIC XX.
  3437         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3438         16  CL-NEXT-RESEND-DT       PIC XX.
  3439         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3440         16  CL-CRITICAL-PERIOD      PIC 99.
  3441*        16  FILLER                  PIC XX.
  3442         16  CL-LAST-MAINT-DT        PIC XX.
  3443         16  CL-LAST-MAINT-USER      PIC X(4).
  3444         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3445         16  CL-LAST-MAINT-TYPE      PIC X.
  3446             88  CLAIM-SET-UP           VALUE ' '.
  3447             88  PAYMENT-MADE           VALUE '1'.
  3448             88  LETTER-SENT            VALUE '2'.
  3449             88  MASTER-WAS-ALTERED     VALUE '3'.
  3450             88  MASTER-WAS-RESTORED    VALUE '4'.
  3451             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3452             88  FILE-CONVERTED         VALUE '6'.
  3453             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3454             88  ERROR-CORRECTION       VALUE 'E'.
  3455         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3456         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3457         16  CL-BENEFICIARY          PIC X(10).
  3458         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3459         16  CL-DENIAL-TYPE          PIC X.
  3460             88  CL-TYPE-DENIAL          VALUE '1'.
  3461             88  CL-TYPE-RESCISSION      VALUE '2'.
  3462             88  CL-TYPE-REFORMATION     VALUE '3'.
  3463             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3464             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3465         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3466         16  filler                  pic x(3).
  3467*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3468*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3469*        16  CL-RTW-DT               PIC XX.
  3470
  3471     12  CL-TRAILER-CONTROLS.
  3472         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3473             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3474             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3475             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3476         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3477         16  FILLER                  PIC XX.
  3478         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3479         16  CL-ADDRESS-TRAILER-CNT.
  3480             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3481                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3482             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3483                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3484             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3485                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3486             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3487                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3488             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3489                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3490             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3491                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  67
* EL130.cbl
  3492             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3493                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3494
  3495     12  CL-CV-REFERENCE-NO.
  3496         16  CL-CV-REFNO-PRIME       PIC X(18).
  3497         16  CL-CV-REFNO-SFX         PIC XX.
  3498
  3499     12  CL-FILE-LOCATION            PIC X(4).
  3500
  3501     12  CL-PROCESS-ERRORS.
  3502         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3503             88  NO-FATAL-ERRORS        VALUE ZERO.
  3504         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3505             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3506
  3507     12  CL-PRODUCT-CD               PIC X.
  3508
  3509     12  CL-CURRENT-KEY-DATA.
  3510         16  CL-CURRENT-CARRIER      PIC X.
  3511         16  CL-CURRENT-GROUPING     PIC X(6).
  3512         16  CL-CURRENT-STATE        PIC XX.
  3513         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3514
  3515     12  CL-ASSOCIATES               PIC X.
  3516         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3517         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3518         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3519         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3520
  3521     12  CL-ACTIVITY-CODE            PIC 99.
  3522     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3523     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3524
  3525     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3526     12  CL-LAG-REPORT-CODE          PIC 9.
  3527     12  CL-LOAN-TYPE                PIC XX.
  3528     12  CL-LEGAL-STATE              PIC XX.
  3529
  3530     12  CL-YESNOSW                  PIC X.
  3531     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3532         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3533         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3534         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3535     12  cl-insured-type             pic x.
  3536         88  cl-claim-on-primary         value 'P'.
  3537         88  cl-claim-on-co-borrower     value 'C'.
  3538     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  68
* EL130.cbl
  3540*    COPY ELCCNTL.
  3541******************************************************************
  3542*                                                                *
  3543*                                                                *
  3544*                            ELCCNTL.                            *
  3545*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3546*                            VMOD=2.059                          *
  3547*                                                                *
  3548*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3549*                                                                *
  3550*   FILE TYPE = VSAM,KSDS                                        *
  3551*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3552*                                                                *
  3553*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3554*       ALTERNATE INDEX = NONE                                   *
  3555*                                                                *
  3556*   LOG = YES                                                    *
  3557*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3558******************************************************************
  3559*                   C H A N G E   L O G
  3560*
  3561* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3562*-----------------------------------------------------------------
  3563*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3564* EFFECTIVE    NUMBER
  3565*-----------------------------------------------------------------
  3566* 082503                   PEMA  ADD BENEFIT GROUP
  3567* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3568* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3569* 092705    2005050300006  PEMA  ADD SPP LEASES
  3570* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3571* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3572* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3573* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3574* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3575* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3576* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3577* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3578* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3579* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3580* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  3581******************************************************************
  3582*
  3583 01  CONTROL-FILE.
  3584     12  CF-RECORD-ID                       PIC XX.
  3585         88  VALID-CF-ID                        VALUE 'CF'.
  3586
  3587     12  CF-CONTROL-PRIMARY.
  3588         16  CF-COMPANY-ID                  PIC XXX.
  3589         16  CF-RECORD-TYPE                 PIC X.
  3590             88  CF-COMPANY-MASTER              VALUE '1'.
  3591             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3592             88  CF-STATE-MASTER                VALUE '3'.
  3593             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3594             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3595             88  CF-CARRIER-MASTER              VALUE '6'.
  3596             88  CF-MORTALITY-MASTER            VALUE '7'.
  3597             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  69
* EL130.cbl
  3598             88  CF-TERMINAL-MASTER             VALUE '9'.
  3599             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3600             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3601             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3602             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3603             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3604             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3605             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3606             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3607             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3608         16  CF-ACCESS-CD-GENL              PIC X(4).
  3609         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3610             20  CF-PROCESSOR               PIC X(4).
  3611         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3612             20  CF-STATE-CODE              PIC XX.
  3613             20  FILLER                     PIC XX.
  3614         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3615             20  FILLER                     PIC XX.
  3616             20  CF-HI-BEN-IN-REC           PIC XX.
  3617         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3618             20  FILLER                     PIC XXX.
  3619             20  CF-CARRIER-CNTL            PIC X.
  3620         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3621             20  FILLER                     PIC XX.
  3622             20  CF-HI-TYPE-IN-REC          PIC 99.
  3623         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3624             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3625                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3626             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3627             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3628         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3629             20  FILLER                     PIC X.
  3630             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3631         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3632             20  FILLER                     PIC XX.
  3633             20  CF-MORTGAGE-PLAN           PIC XX.
  3634         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3635
  3636     12  CF-LAST-MAINT-DT                   PIC XX.
  3637     12  CF-LAST-MAINT-BY                   PIC X(4).
  3638     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3639
  3640     12  CF-RECORD-BODY                     PIC X(728).
  3641
  3642
  3643****************************************************************
  3644*             COMPANY MASTER RECORD                            *
  3645****************************************************************
  3646
  3647     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3648         16  CF-COMPANY-ADDRESS.
  3649             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3650             20  CF-CL-IN-CARE-OF           PIC X(30).
  3651             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3652             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3653             20  CF-CL-CITY-STATE           PIC X(30).
  3654             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3655             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  70
* EL130.cbl
  3656         16  CF-COMPANY-CD                  PIC X.
  3657         16  CF-COMPANY-PASSWORD            PIC X(8).
  3658         16  CF-SECURITY-OPTION             PIC X.
  3659             88  ALL-SECURITY                   VALUE '1'.
  3660             88  COMPANY-VERIFY                 VALUE '2'.
  3661             88  PROCESSOR-VERIFY               VALUE '3'.
  3662             88  NO-SECURITY                    VALUE '4'.
  3663             88  ALL-BUT-TERM                   VALUE '5'.
  3664         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3665             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3666         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3667             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3668         16  CF-INFORCE-LOCATION            PIC X.
  3669             88  CERTS-ARE-ONLINE               VALUE '1'.
  3670             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3671             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3672         16  CF-LOWER-CASE-LETTERS          PIC X.
  3673         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3674             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3675             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3676             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3677             88  CF-ACCNT-CNTL                  VALUE '3'.
  3678             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3679
  3680         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3681         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3682
  3683         16  CF-LGX-CREDIT-USER             PIC X.
  3684             88  CO-IS-NOT-USER                 VALUE 'N'.
  3685             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3686
  3687         16 CF-CREDIT-CALC-CODES.
  3688             20  CF-CR-REM-TERM-CALC PIC X.
  3689               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3690               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3691               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3692               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3693               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3694               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3695               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3696             20  CF-CR-R78-METHOD           PIC X.
  3697               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3698               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3699
  3700         16  CF-CLAIM-CONTROL-COUNTS.
  3701             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3702                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3703
  3704             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3705                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3706
  3707             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3708                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3709
  3710             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3711                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3712
  3713         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  71
* EL130.cbl
  3714
  3715         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3716             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3717             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3718             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3719             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3720                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3721                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3722             20  CF-CO-PREM-REJECT-SW       PIC X.
  3723                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3724                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3725             20  CF-CO-REF-REJECT-SW        PIC X.
  3726                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3727                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3728
  3729         16  CF-CO-REPORTING-DT             PIC XX.
  3730         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3731         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3732           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3733           88  CF-CO-MONTH-END                  VALUE '1'.
  3734
  3735         16  CF-LGX-CLAIM-USER              PIC X.
  3736             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3737             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3738
  3739         16  CF-CREDIT-EDIT-CONTROLS.
  3740             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3741             20  CF-MIN-AGE                 PIC 99.
  3742             20  CF-DEFAULT-AGE             PIC 99.
  3743             20  CF-MIN-TERM                PIC S999      COMP-3.
  3744             20  CF-MAX-TERM                PIC S999      COMP-3.
  3745             20  CF-DEFAULT-SEX             PIC X.
  3746             20  CF-JOINT-AGE-INPUT         PIC X.
  3747                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3748             20  CF-BIRTH-DATE-INPUT        PIC X.
  3749                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3750             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3751                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3752                 88  CF-ZERO-CARRIER            VALUE '1'.
  3753                 88  CF-ZERO-GROUPING           VALUE '2'.
  3754                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3755             20  CF-EDIT-SW                 PIC X.
  3756                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3757             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3758             20  CF-CR-PR-METHOD            PIC X.
  3759               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3760               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3761             20  FILLER                     PIC X.
  3762
  3763         16  CF-CREDIT-MISC-CONTROLS.
  3764             20  CF-REIN-TABLE-SW           PIC X.
  3765                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3766             20  CF-COMP-TABLE-SW           PIC X.
  3767                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3768             20  CF-EXPERIENCE-RETENTION-AGE
  3769                                            PIC S9        COMP-3.
  3770             20  CF-CONVERSION-DT           PIC XX.
  3771             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  72
* EL130.cbl
  3772             20  CF-RUN-FREQUENCY-SW        PIC X.
  3773                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3774                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3775
  3776             20  CF-CR-CHECK-NO-CONTROL.
  3777                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3778                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3779                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3780                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3781                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3782                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3783
  3784                 24  CF-CR-CHECK-COUNT       REDEFINES
  3785                     CF-CR-CHECK-COUNTER      PIC X(4).
  3786
  3787                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3788                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3789
  3790                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3791                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3792                 24  CF-MAIL-PROCESSING       PIC X.
  3793                     88  MAIL-PROCESSING          VALUE 'Y'.
  3794
  3795         16  CF-MISC-SYSTEM-CONTROL.
  3796             20  CF-SYSTEM-C                 PIC X.
  3797                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3798             20  CF-SYSTEM-D                 PIC X.
  3799                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3800             20  CF-SOC-SEC-NO-SW            PIC X.
  3801                 88  SOC-SEC-NO-USED             VALUE '1'.
  3802             20  CF-MEMBER-NO-SW             PIC X.
  3803                 88  MEMBER-NO-USED              VALUE '1'.
  3804             20  CF-TAX-ID-NUMBER            PIC X(11).
  3805             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3806             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3807                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3808                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3809                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3810                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3811             20  CF-SYSTEM-E                 PIC X.
  3812                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3813
  3814         16  CF-LGX-LIFE-USER               PIC X.
  3815             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3816             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3817
  3818         16  CF-CR-MONTH-END-DT             PIC XX.
  3819
  3820         16  CF-FILE-MAINT-DATES.
  3821             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3822                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3823             20  CF-LAST-BATCH       REDEFINES
  3824                 CF-LAST-BATCH-NO               PIC X(4).
  3825             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3826             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3827             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3828             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3829             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  73
* EL130.cbl
  3830             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3831             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3832             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3833             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3834             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3835
  3836         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3837         16  FILLER                         PIC X.
  3838
  3839         16  CF-ALT-MORT-CODE               PIC X(4).
  3840         16  CF-MEMBER-CAPTION              PIC X(10).
  3841
  3842         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3843             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3844             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3845             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3846             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3847             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3848
  3849         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3850
  3851         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3852         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3853         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3854         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3855
  3856         16  CF-AH-OVERRIDE-L1              PIC X.
  3857         16  CF-AH-OVERRIDE-L2              PIC XX.
  3858         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3859         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3860
  3861         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3862         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3863
  3864         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3865         16  CF-AR-LAST-EL860-DT            PIC XX.
  3866         16  CF-MP-MONTH-END-DT             PIC XX.
  3867
  3868         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3869         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3870             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3871
  3872         16  CF-AR-MONTH-END-DT             PIC XX.
  3873
  3874         16  CF-CRDTCRD-USER                PIC X.
  3875             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3876             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3877
  3878         16  CF-CC-MONTH-END-DT             PIC XX.
  3879
  3880         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3881
  3882         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3883             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3884             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3885             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3886         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3887         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  74
* EL130.cbl
  3888         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3889         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3890             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3891             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3892         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3893         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3894         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3895             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3896         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3897
  3898         16  CF-CL-ZIP-CODE.
  3899             20  CF-CL-ZIP-PRIME.
  3900                 24  CF-CL-ZIP-1ST          PIC X.
  3901                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3902                 24  FILLER                 PIC X(4).
  3903             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3904         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3905             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3906             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3907             20  FILLER                     PIC XXX.
  3908
  3909         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3910         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3911         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3912         16  CF-CO-OPTION-START-DATE        PIC XX.
  3913         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3914           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3915                                                      '3' '4'.
  3916           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3917           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3918           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3919           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3920           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3921           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3922
  3923         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3924
  3925         16  CF-PAYMENT-APPROVAL-LEVELS.
  3926             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3927             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3928             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3929             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3930             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3931             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3932
  3933         16  CF-END-USER-REPORTING-USER     PIC X.
  3934             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3935             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3936
  3937         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3938             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3939             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3940
  3941         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3942
  3943         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3944         16  FILLER                         PIC X.
  3945
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  75
* EL130.cbl
  3946         16  CF-CREDIT-ARCHIVE-CNTL.
  3947             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3948             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3949             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3950
  3951         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3952
  3953         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3954             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3955             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3956
  3957         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3958             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3959             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3960
  3961         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3962
  3963         16  CF-CO-ACH-ID-CODE              PIC  X.
  3964             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3965             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3966             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3967         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3968         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3969         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3970         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3971         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3972         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3973         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3974         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3975         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3976                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3977         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3978                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3979
  3980         16  CF-CO-OVER-SHORT.
  3981             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3982             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3983
  3984*         16  FILLER                         PIC X(102).
  3985         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3986             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3987             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3988
  3989         16  CF-AH-APPROVAL-DAYS.
  3990             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3991             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3992             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3993             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3994
  3995         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3996
  3997         16  CF-APPROV-LEV-5.
  3998             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3999             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4000             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4001
  4002         16  FILLER                         PIC X(68).
  4003****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  76
* EL130.cbl
  4004*             PROCESSOR/USER RECORD                            *
  4005****************************************************************
  4006
  4007     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4008         16  CF-PROCESSOR-NAME              PIC X(30).
  4009         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4010         16  CF-PROCESSOR-TITLE             PIC X(26).
  4011         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4012                 88  MESSAGE-YES                VALUE 'Y'.
  4013                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4014
  4015*****************************************************
  4016****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4017****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4018****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4019****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4020*****************************************************
  4021
  4022         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4023             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4024             20  CF-APPLICATION-FORCE       PIC X.
  4025             20  CF-INDIVIDUAL-APP.
  4026                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4027                     28  CF-BROWSE-APP      PIC X.
  4028                     28  CF-UPDATE-APP      PIC X.
  4029
  4030         16  CF-CURRENT-TERM-ON             PIC X(4).
  4031         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4032             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4033             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4034             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4035             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4036             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4037             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4038             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4039         16  CF-PROCESSOR-CARRIER           PIC X.
  4040             88  NO-CARRIER-SECURITY            VALUE ' '.
  4041         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4042             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4043         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4044             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4045         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4046             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4047
  4048         16  CF-PROC-SYS-ACCESS-SW.
  4049             20  CF-PROC-CREDIT-CLAIMS-SW.
  4050                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4051                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4052                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4053                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4054             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4055                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4056                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4057             20  CF-PROC-LIFE-GNRLDGR-SW.
  4058                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4059                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4060                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4061                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  77
* EL130.cbl
  4062             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4063                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4064                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4065         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4066             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4067             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4068         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4069
  4070         16  CF-APPROVAL-LEVEL                  PIC X.
  4071             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4072             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4073             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4074             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4075             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4076
  4077         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4078
  4079         16  CF-LANGUAGE-TYPE                   PIC X.
  4080             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4081             88  CF-LANG-IS-FR                      VALUE 'F'.
  4082
  4083         16  CF-CSR-IND                         PIC X.
  4084         16  FILLER                             PIC X(239).
  4085
  4086****************************************************************
  4087*             PROCESSOR/REMINDERS RECORD                       *
  4088****************************************************************
  4089
  4090     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4091         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4092             20  CF-START-REMIND-DT         PIC XX.
  4093             20  CF-END-REMIND-DT           PIC XX.
  4094             20  CF-REMINDER-TEXT           PIC X(50).
  4095         16  FILLER                         PIC X(296).
  4096
  4097
  4098****************************************************************
  4099*             STATE MASTER RECORD                              *
  4100****************************************************************
  4101
  4102     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4103         16  CF-STATE-ABBREVIATION          PIC XX.
  4104         16  CF-STATE-NAME                  PIC X(25).
  4105         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4106         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4107             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4108             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4109             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4110             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4111                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4112                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4113             20  CF-ST-PREM-REJECT-SW       PIC X.
  4114                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4115                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4116             20  CF-ST-REF-REJECT-SW        PIC X.
  4117                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4118                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4119         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  78
* EL130.cbl
  4120         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4121         16  CF-ST-REFUND-RULES.
  4122             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4123             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4124             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4125         16  CF-ST-FST-PMT-EXTENSION.
  4126             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4127             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4128                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4129                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4130                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4131                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4132         16  CF-ST-STATE-CALL.
  4133             20  CF-ST-CALL-UNEARNED        PIC X.
  4134             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4135             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4136         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4137             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4138             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4139         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4140         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4141         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4142         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4143         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4144         16  FILLER                         PIC X.
  4145         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4146             20  CF-ST-BENEFIT-CD           PIC XX.
  4147             20  CF-ST-BENEFIT-KIND         PIC X.
  4148                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4149                 88  CF-ST-AH-KIND              VALUE 'A'.
  4150             20  CF-ST-REM-TERM-CALC        PIC X.
  4151                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4152                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4153                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4154                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4155                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4156                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4157                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4158                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4159
  4160             20  CF-ST-REFUND-CALC          PIC X.
  4161                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4162                 88  ST-REFD-BY-R78             VALUE '1'.
  4163                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4164                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4165                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4166                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4167                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4168                 88  ST-REFD-UTAH               VALUE '7'.
  4169                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4170                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4171                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4172
  4173             20  CF-ST-EARNING-CALC         PIC X.
  4174                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4175                 88  ST-EARN-BY-R78             VALUE '1'.
  4176                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4177                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  79
* EL130.cbl
  4178                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4179                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4180                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4181                 88  ST-EARN-MEAN               VALUE '8'.
  4182                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4183
  4184             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4185                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4186                 88  ST-OVRD-BY-R78             VALUE '1'.
  4187                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4188                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4189                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4190                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4191                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4192                 88  ST-OVRD-MEAN               VALUE '8'.
  4193                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4194             20  cf-st-extra-periods        pic 9.
  4195*            20  FILLER                     PIC X.
  4196
  4197         16  CF-ST-COMMISSION-CAPS.
  4198             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4199             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4200             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4201             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4202         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4203                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4204                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4205                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4206
  4207         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4208
  4209         16  CF-ST-STATUTORY-INTEREST.
  4210             20  CF-ST-STAT-DATE-FROM       PIC X.
  4211                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4212                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4213             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4214             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4215             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4216             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4217             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4218
  4219         16  CF-ST-OVER-SHORT.
  4220             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4221             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4222
  4223         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4224
  4225         16  CF-ST-RT-CALC                  PIC X.
  4226
  4227         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4228         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4229         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4230         16  CF-ST-RF-LR-CALC               PIC X.
  4231         16  CF-ST-RF-LL-CALC               PIC X.
  4232         16  CF-ST-RF-LN-CALC               PIC X.
  4233         16  CF-ST-RF-AH-CALC               PIC X.
  4234         16  CF-ST-RF-CP-CALC               PIC X.
  4235*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  80
* EL130.cbl
  4236*CIDMOD         16  FILLER                         PIC X(192).
  4237         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4238             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4239         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4240         16  CF-ST-VFY-2ND-BENE             PIC X.
  4241         16  CF-ST-CAUSAL-STATE             PIC X.
  4242         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4243         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4244         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4245             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4246         16  CF-ST-NET-ONLY-STATE           PIC X.
  4247             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4248         16  cf-commission-cap-required     pic x.
  4249         16  CF-ST-GA-COMMISSION-CAPS.
  4250             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4251             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4252             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4253             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4254         16  CF-ST-TOT-COMMISSION-CAPS.
  4255             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4256             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4257             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4258             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4259         16  FILLER                         PIC X(156).
  4260
  4261****************************************************************
  4262*             BENEFIT MASTER RECORD                            *
  4263****************************************************************
  4264
  4265     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4266         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4267             20  CF-BENEFIT-CODE            PIC XX.
  4268             20  CF-BENEFIT-NUMERIC  REDEFINES
  4269                 CF-BENEFIT-CODE            PIC XX.
  4270             20  CF-BENEFIT-ALPHA           PIC XXX.
  4271             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4272             20  CF-BENEFIT-COMMENT         PIC X(10).
  4273
  4274             20  CF-LF-COVERAGE-TYPE        PIC X.
  4275                 88  CF-REDUCING                VALUE 'R'.
  4276                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4277
  4278             20  CF-SPECIAL-CALC-CD         PIC X.
  4279                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4280                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4281                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4282                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4283                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4284                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4285                 88  CF-FARM-PLAN               VALUE 'F'.
  4286                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4287                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4288                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4289                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4290                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4291                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4292                 88  CF-PRUDENTIAL              VALUE 'P'.
  4293                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  81
* EL130.cbl
  4294                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4295                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4296                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4297                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4298                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4299
  4300             20  CF-JOINT-INDICATOR         PIC X.
  4301                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4302
  4303*            20  FILLER                     PIC X(12).
  4304             20  cf-maximum-benefits        pic s999 comp-3.
  4305             20  FILLER                     PIC X(09).
  4306             20  CF-BENEFIT-CATEGORY        PIC X.
  4307             20  CF-LOAN-TYPE               PIC X(8).
  4308
  4309             20  CF-CO-REM-TERM-CALC        PIC X.
  4310                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4311                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4312                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4313                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4314                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4315
  4316             20  CF-CO-EARNINGS-CALC        PIC X.
  4317                 88  CO-EARN-BY-R78             VALUE '1'.
  4318                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4319                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4320                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4321                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4322                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4323                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4324                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4325
  4326             20  CF-CO-REFUND-CALC          PIC X.
  4327                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4328                 88  CO-REFD-BY-R78             VALUE '1'.
  4329                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4330                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4331                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4332                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4333                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4334                 88  CO-REFD-MEAN               VALUE '8'.
  4335                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4336                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4337                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4338
  4339             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4340                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4341                 88  CO-OVRD-BY-R78             VALUE '1'.
  4342                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4343                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4344                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4345                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4346                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4347                 88  CO-OVRD-MEAN               VALUE '8'.
  4348                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4349
  4350             20  CF-CO-BEN-I-G-CD           PIC X.
  4351                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  82
* EL130.cbl
  4352                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4353                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4354
  4355         16  FILLER                         PIC X(304).
  4356
  4357
  4358****************************************************************
  4359*             CARRIER MASTER RECORD                            *
  4360****************************************************************
  4361
  4362     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4363         16  CF-ADDRESS-DATA.
  4364             20  CF-MAIL-TO-NAME            PIC X(30).
  4365             20  CF-IN-CARE-OF              PIC X(30).
  4366             20  CF-ADDRESS-LINE-1          PIC X(30).
  4367             20  CF-ADDRESS-LINE-2          PIC X(30).
  4368             20  CF-CITY-STATE              PIC X(30).
  4369             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4370             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4371
  4372         16  CF-CLAIM-NO-CONTROL.
  4373             20  CF-CLAIM-NO-METHOD         PIC X.
  4374                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4375                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4376                 88  CLAIM-NO-SEQ               VALUE '3'.
  4377                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4378             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4379                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4380                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4381                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4382
  4383         16  CF-CHECK-NO-CONTROL.
  4384             20  CF-CHECK-NO-METHOD         PIC X.
  4385                 88  CHECK-NO-MANUAL            VALUE '1'.
  4386                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4387                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4388                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4389             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4390                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4391
  4392         16  CF-DOMICILE-STATE              PIC XX.
  4393
  4394         16  CF-EXPENSE-CONTROLS.
  4395             20  CF-EXPENSE-METHOD          PIC X.
  4396                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4397                 88  DOLLARS-PER-PMT            VALUE '2'.
  4398                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4399                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4400             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4401             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4402
  4403         16  CF-CORRESPONDENCE-CONTROL.
  4404             20  CF-LETTER-RESEND-OPT       PIC X.
  4405                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4406                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4407             20  FILLER                     PIC X(4).
  4408
  4409         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  83
* EL130.cbl
  4410             20  CF-MANUAL-SW               PIC X.
  4411                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4412             20  CF-FUTURE-SW               PIC X.
  4413                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4414             20  CF-PTC-SW                  PIC X.
  4415                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4416             20  CF-IBNR-SW                 PIC X.
  4417                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4418             20  CF-PTC-LF-SW               PIC X.
  4419                 88  CF-LF-PTC-USED             VALUE '1'.
  4420             20  CF-CDT-ACCESS-METHOD       PIC X.
  4421                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4422                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4423                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4424             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4425
  4426         16  CF-CLAIM-CALC-METHOD           PIC X.
  4427             88  360-PLUS-MONTHS                VALUE '1'.
  4428             88  365-PLUS-MONTHS                VALUE '2'.
  4429             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4430             88  360-DAILY                      VALUE '4'.
  4431             88  365-DAILY                      VALUE '5'.
  4432
  4433         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4434         16  FILLER                         PIC X(11).
  4435
  4436         16  CF-LIMIT-AMOUNTS.
  4437             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4438             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4439             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4440             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4441             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4442             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4443             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4444             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4445             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4446             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4447
  4448         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4449         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4450         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4451
  4452         16  CF-ZIP-CODE.
  4453             20  CF-ZIP-PRIME.
  4454                 24  CF-ZIP-1ST             PIC X.
  4455                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4456                 24  FILLER                 PIC X(4).
  4457             20  CF-ZIP-PLUS4               PIC X(4).
  4458         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4459             20  CF-CAN-POSTAL-1            PIC XXX.
  4460             20  CF-CAN-POSTAL-2            PIC XXX.
  4461             20  FILLER                     PIC XXX.
  4462
  4463         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4464         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4465         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4466
  4467         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  84
* EL130.cbl
  4468             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4469             88  CF-NO-RATING                   VALUE 'N'.
  4470
  4471         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4472
  4473         16  CF-CARRIER-OVER-SHORT.
  4474             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4475             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4476
  4477         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4478         16  CF-SECPAY-SWITCH               PIC X.
  4479             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4480             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4481         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4482         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4483         16  FILLER                         PIC X(444).
  4484*        16  FILLER                         PIC X(452).
  4485
  4486
  4487****************************************************************
  4488*             MORTALITY MASTER RECORD                          *
  4489****************************************************************
  4490
  4491     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4492         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4493                                INDEXED BY CF-MORT-NDX.
  4494             20  CF-MORT-TABLE              PIC X(5).
  4495             20  CF-MORT-TABLE-TYPE         PIC X.
  4496                 88  CF-MORT-JOINT              VALUE 'J'.
  4497                 88  CF-MORT-SINGLE             VALUE 'S'.
  4498                 88  CF-MORT-COMBINED           VALUE 'C'.
  4499                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4500                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4501             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4502             20  CF-MORT-AGE-METHOD         PIC XX.
  4503                 88  CF-AGE-LAST                VALUE 'AL'.
  4504                 88  CF-AGE-NEAR                VALUE 'AN'.
  4505             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4506             20  CF-MORT-ADJUSTMENT-DIRECTION
  4507                                            PIC X.
  4508                 88  CF-MINUS                   VALUE '-'.
  4509                 88  CF-PLUS                    VALUE '+'.
  4510             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4511             20  CF-MORT-JOINT-CODE         PIC X.
  4512                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4513             20  CF-MORT-PC-Q               PIC X.
  4514                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4515             20  CF-MORT-TABLE-CODE         PIC X(4).
  4516             20  CF-MORT-COMMENTS           PIC X(15).
  4517             20  FILLER                     PIC X(14).
  4518
  4519         16  FILLER                         PIC X(251).
  4520
  4521
  4522****************************************************************
  4523*             BUSSINESS TYPE MASTER RECORD                     *
  4524****************************************************************
  4525
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  85
* EL130.cbl
  4526     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4527* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4528* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4529* AND RECORD 05 IS TYPES 81-99
  4530         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4531             20  CF-BUSINESS-TITLE          PIC  X(19).
  4532             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4533                                            PIC S9V9(4) COMP-3.
  4534             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4535             20  FILLER                     PIC  X.
  4536         16  FILLER                         PIC  X(248).
  4537
  4538
  4539****************************************************************
  4540*             TERMINAL MASTER RECORD                           *
  4541****************************************************************
  4542
  4543     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4544
  4545         16  CF-COMPANY-TERMINALS.
  4546             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4547                                  PIC X(4).
  4548         16  FILLER               PIC X(248).
  4549
  4550
  4551****************************************************************
  4552*             LIFE EDIT MASTER RECORD                          *
  4553****************************************************************
  4554
  4555     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4556         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4557             20  CF-LIFE-CODE-IN            PIC XX.
  4558             20  CF-LIFE-CODE-OUT           PIC XX.
  4559         16  FILLER                         PIC X(248).
  4560
  4561
  4562****************************************************************
  4563*             AH EDIT MASTER RECORD                            *
  4564****************************************************************
  4565
  4566     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4567         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4568             20  CF-AH-CODE-IN              PIC XXX.
  4569             20  CF-AH-CODE-OUT             PIC XX.
  4570         16  FILLER                         PIC X(248).
  4571
  4572
  4573****************************************************************
  4574*             CREDIBILITY TABLES                               *
  4575****************************************************************
  4576
  4577     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4578         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4579                             INDEXED BY CF-CRDB-NDX.
  4580             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4581             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4582             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4583         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  86
* EL130.cbl
  4584
  4585
  4586****************************************************************
  4587*             REPORT CUSTOMIZATION RECORD                      *
  4588****************************************************************
  4589
  4590     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4591         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4592             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4593             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4594             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4595**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4596****       A T-TRANSFER.                                   ****
  4597             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4598
  4599         16  FILLER                         PIC XX.
  4600
  4601         16  CF-CARRIER-CNTL-OPT.
  4602             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4603                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4604                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4605             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4606                                            PIC X.
  4607         16  CF-GROUP-CNTL-OPT.
  4608             20  CF-GROUP-OPT-SEQ           PIC 9.
  4609                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4610                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4611             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4612                                            PIC X(6).
  4613         16  CF-STATE-CNTL-OPT.
  4614             20  CF-STATE-OPT-SEQ           PIC 9.
  4615                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4616                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4617             20  CF-STATE-SELECT OCCURS 3 TIMES
  4618                                            PIC XX.
  4619         16  CF-ACCOUNT-CNTL-OPT.
  4620             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4621                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4622                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4623             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4624                                            PIC X(10).
  4625         16  CF-BUS-TYP-CNTL-OPT.
  4626             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4627                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4628                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4629             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4630                                            PIC XX.
  4631         16  CF-LF-TYP-CNTL-OPT.
  4632             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4633                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4634                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4635             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4636                                            PIC XX.
  4637         16  CF-AH-TYP-CNTL-OPT.
  4638             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4639                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4640                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4641             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  87
* EL130.cbl
  4642                                            PIC XX.
  4643         16  CF-REPTCD1-CNTL-OPT.
  4644             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4645                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4646                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4647             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4648                                            PIC X(10).
  4649         16  CF-REPTCD2-CNTL-OPT.
  4650             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4651                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4652                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4653             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4654                                            PIC X(10).
  4655         16  CF-USER1-CNTL-OPT.
  4656             20  CF-USER1-OPT-SEQ           PIC 9.
  4657                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4658                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4659             20  CF-USER1-SELECT OCCURS 3 TIMES
  4660                                            PIC X(10).
  4661         16  CF-USER2-CNTL-OPT.
  4662             20  CF-USER2-OPT-SEQ           PIC 9.
  4663                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4664                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4665             20  CF-USER2-SELECT OCCURS 3 TIMES
  4666                                            PIC X(10).
  4667         16  CF-USER3-CNTL-OPT.
  4668             20  CF-USER3-OPT-SEQ           PIC 9.
  4669                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4670                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4671             20  CF-USER3-SELECT OCCURS 3 TIMES
  4672                                            PIC X(10).
  4673         16  CF-USER4-CNTL-OPT.
  4674             20  CF-USER4-OPT-SEQ           PIC 9.
  4675                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4676                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4677             20  CF-USER4-SELECT OCCURS 3 TIMES
  4678                                            PIC X(10).
  4679         16  CF-USER5-CNTL-OPT.
  4680             20  CF-USER5-OPT-SEQ           PIC 9.
  4681                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4682                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4683             20  CF-USER5-SELECT OCCURS 3 TIMES
  4684                                            PIC X(10).
  4685         16  CF-REINS-CNTL-OPT.
  4686             20  CF-REINS-OPT-SEQ           PIC 9.
  4687                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4688                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4689             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4690                 24  CF-REINS-PRIME         PIC XXX.
  4691                 24  CF-REINS-SUB           PIC XXX.
  4692
  4693         16  CF-AGENT-CNTL-OPT.
  4694             20  CF-AGENT-OPT-SEQ           PIC 9.
  4695                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4696                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4697             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4698                                            PIC X(10).
  4699
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  88
* EL130.cbl
  4700         16  FILLER                         PIC X(43).
  4701
  4702         16  CF-LOSS-RATIO-SELECT.
  4703             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4704             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4705         16  CF-ENTRY-DATE-SELECT.
  4706             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4707             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4708         16  CF-EFFECTIVE-DATE-SELECT.
  4709             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4710             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4711
  4712         16  CF-EXCEPTION-LIST-IND          PIC X.
  4713             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4714
  4715         16  FILLER                         PIC X(318).
  4716
  4717****************************************************************
  4718*                  EXCEPTION REPORTING RECORD                  *
  4719****************************************************************
  4720
  4721     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4722         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4723             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4724
  4725         16  CF-COMBINED-LIFE-AH-OPT.
  4726             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4727             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4728             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4729             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4730
  4731         16  CF-LIFE-OPT.
  4732             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4733             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4734             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4735             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4736             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4737             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4738             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4739             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4740             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4741             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4742
  4743         16  CF-AH-OPT.
  4744             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4745             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4746             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4747             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4748             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4749             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4750             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4751             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4752             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4753             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4754
  4755         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4756             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4757             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  89
* EL130.cbl
  4758             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4759
  4760         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4761
  4762         16  FILLER                         PIC X(673).
  4763
  4764
  4765****************************************************************
  4766*             MORTGAGE SYSTEM PLAN RECORD                      *
  4767****************************************************************
  4768
  4769     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4770         16  CF-PLAN-TYPE                   PIC X.
  4771             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4772             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4773             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4774         16  CF-PLAN-ABBREV                 PIC XXX.
  4775         16  CF-PLAN-DESCRIPT               PIC X(10).
  4776         16  CF-PLAN-NOTES                  PIC X(20).
  4777         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4778         16  CF-PLAN-UNDERWRITING.
  4779             20  CF-PLAN-TERM-DATA.
  4780                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4781                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4782             20  CF-PLAN-AGE-DATA.
  4783                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4784                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4785                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4786             20  CF-PLAN-BENEFIT-DATA.
  4787                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4788                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4789                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4790                                            PIC S9(7)V99  COMP-3.
  4791         16  CF-PLAN-POLICY-FORMS.
  4792             20  CF-POLICY-FORM             PIC X(12).
  4793             20  CF-MASTER-APPLICATION      PIC X(12).
  4794             20  CF-MASTER-POLICY           PIC X(12).
  4795         16  CF-PLAN-RATING.
  4796             20  CF-RATE-CODE               PIC X(5).
  4797             20  CF-SEX-RATING              PIC X.
  4798                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4799                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4800             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4801             20  CF-SUB-STD-TYPE            PIC X.
  4802                 88  CF-PCT-OF-PREM            VALUE '1'.
  4803                 88  CF-PCT-OF-BENE            VALUE '2'.
  4804         16  CF-PLAN-PREM-TOLERANCES.
  4805             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4806             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4807         16  CF-PLAN-PYMT-TOLERANCES.
  4808             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4809             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4810         16  CF-PLAN-MISC-DATA.
  4811             20  FILLER                     PIC X.
  4812             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4813             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4814         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4815         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  90
* EL130.cbl
  4816             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4817                                                     '1'.
  4818             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4819                                                     '2'.
  4820         16  CF-MIB-SEARCH-SW               PIC X.
  4821             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4822             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4823             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4824             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4825         16  CF-ALPHA-SEARCH-SW             PIC X.
  4826             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4827             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4828             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4829             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4830             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4831             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4832             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4833             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4834             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4835             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4836                                                     'A' 'B' 'C'
  4837                                                     'X' 'Y' 'Z'.
  4838         16  CF-EFF-DT-RULE-SW              PIC X.
  4839             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4840             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4841             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4842             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4843             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4844         16  FILLER                         PIC X(4).
  4845         16  CF-HEALTH-QUESTIONS            PIC X.
  4846             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4847         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4848         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4849         16  CF-PLAN-SNGL-JNT               PIC X.
  4850             88  CF-COMBINED-PLAN              VALUE 'C'.
  4851             88  CF-JNT-PLAN                   VALUE 'J'.
  4852             88  CF-SNGL-PLAN                  VALUE 'S'.
  4853         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4854         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4855         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4856         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4857         16  CF-RERATE-CNTL                 PIC  X.
  4858             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4859             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4860             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4861             88  CF-AUTO-RECALC                 VALUE '4'.
  4862         16  CF-BENEFIT-TYPE                PIC  X.
  4863             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4864             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4865         16  CF-POLICY-FEE                  PIC S999V99
  4866                                                    COMP-3.
  4867         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4868         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4869         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4870         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4871         16  FILLER                         PIC  X(32).
  4872         16  CF-TERMINATION-FORM            PIC  X(04).
  4873         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  91
* EL130.cbl
  4874         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4875                                                       COMP-3.
  4876         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4877         16  CF-ISSUE-LETTER                PIC  X(4).
  4878         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4879         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4880             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4881             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4882         16  CF-MP-REFUND-CALC              PIC X.
  4883             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4884             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4885             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4886             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4887             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4888             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4889             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4890             88  CF-MP-REFD-MEAN                VALUE '8'.
  4891         16  CF-ALT-RATE-CODE               PIC  X(5).
  4892
  4893
  4894         16  FILLER                         PIC X(498).
  4895****************************************************************
  4896*             MORTGAGE COMPANY MASTER RECORD                   *
  4897****************************************************************
  4898
  4899     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4900         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4901         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4902             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4903             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4904             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4905             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4906             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4907
  4908         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4909         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4910         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4911         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4912         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4913
  4914         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4915             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4916         16  CF-MP-RECON-USE-IND            PIC X(1).
  4917             88  CF-MP-USE-RECON             VALUE 'Y'.
  4918         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4919             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4920         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4921             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4922             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4923         16  FILLER                         PIC X(1).
  4924         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4925             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4926         16  CF-MORTG-MIB-VERSION           PIC X.
  4927             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4928             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4929             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4930         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4931             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  92
* EL130.cbl
  4932                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4933             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4934                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4935             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4936                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4937             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4938                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4939             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4940                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4941             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4942                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4943         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4944         16  FILLER                         PIC X(7).
  4945         16  CF-MORTG-DESTINATION-SYMBOL.
  4946             20  CF-MORTG-MIB-COMM          PIC X(5).
  4947             20  CF-MORTG-MIB-TERM          PIC X(5).
  4948         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4949             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4950         16  FILLER                         PIC X(03).
  4951         16  CF-MP-CHECK-NO-CONTROL.
  4952             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4953                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4954                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4955                                                ' ' LOW-VALUES.
  4956                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4957                                               VALUE '3'.
  4958         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4959         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4960         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4961             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4962                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4963             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4964                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4965             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4966                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4967             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4968                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4969             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4970                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4971             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4972                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4973         16  CF-MORTG-BILLING-AREA.
  4974             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4975                                            PIC X.
  4976         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4977         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4978         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4979         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4980             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4981             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4982         16  FILLER                         PIC X.
  4983         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4984             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4985             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4986         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4987         16  FILLER                         PIC X(8).
  4988         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4989         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  93
* EL130.cbl
  4990         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4991         16  CF-ACH-COMPANY-ID.
  4992             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4993                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4994                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4995                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4996             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4997         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4998             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4999         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5000             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5001             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5002         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5003         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5004         16  FILLER                         PIC X(536).
  5005
  5006****************************************************************
  5007*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5008****************************************************************
  5009
  5010     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5011         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5012             20  CF-FEMALE-HEIGHT.
  5013                 24  CF-FEMALE-FT           PIC 99.
  5014                 24  CF-FEMALE-IN           PIC 99.
  5015             20  CF-FEMALE-MIN-WT           PIC 999.
  5016             20  CF-FEMALE-MAX-WT           PIC 999.
  5017         16  FILLER                         PIC X(428).
  5018
  5019     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5020         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5021             20  CF-MALE-HEIGHT.
  5022                 24  CF-MALE-FT             PIC 99.
  5023                 24  CF-MALE-IN             PIC 99.
  5024             20  CF-MALE-MIN-WT             PIC 999.
  5025             20  CF-MALE-MAX-WT             PIC 999.
  5026         16  FILLER                         PIC X(428).
  5027******************************************************************
  5028*             AUTOMATIC ACTIVITY RECORD                          *
  5029******************************************************************
  5030     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5031         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5032             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5033             20  CF-SYS-LETTER-ID           PIC X(04).
  5034             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5035             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5036             20  CF-SYS-RESET-SW            PIC X(01).
  5037             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5038             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5039
  5040         16  FILLER                         PIC X(50).
  5041
  5042         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5043             20  CF-USER-ACTIVE-SW          PIC X(01).
  5044             20  CF-USER-LETTER-ID          PIC X(04).
  5045             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5046             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5047             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  94
* EL130.cbl
  5048             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5049             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5050             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5051
  5052         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  95
* EL130.cbl
  5054*    COPY ELCCERT.
  5055******************************************************************
  5056*                                                                *
  5057*                            ELCCERT.                            *
  5058*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5059*                            VMOD=2.013                          *
  5060*                                                                *
  5061*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5062*                                                                *
  5063*   FILE TYPE = VSAM,KSDS                                        *
  5064*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5065*                                                                *
  5066*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5067*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5068*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5069*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5070*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5071*                                                                *
  5072*   LOG = YES                                                    *
  5073*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5074******************************************************************
  5075*                   C H A N G E   L O G
  5076*
  5077* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5078*-----------------------------------------------------------------
  5079*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5080* EFFECTIVE    NUMBER
  5081*-----------------------------------------------------------------
  5082* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5083* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5084* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5085* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5086* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5087* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5088* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5089* 032612  CR2011110200001  PEMA  AHL CHANGES
  5090* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5091* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5092* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5093******************************************************************
  5094
  5095 01  CERTIFICATE-MASTER.
  5096     12  CM-RECORD-ID                      PIC XX.
  5097         88  VALID-CM-ID                      VALUE 'CM'.
  5098
  5099     12  CM-CONTROL-PRIMARY.
  5100         16  CM-COMPANY-CD                 PIC X.
  5101         16  CM-CARRIER                    PIC X.
  5102         16  CM-GROUPING.
  5103             20  CM-GROUPING-PREFIX        PIC X(3).
  5104             20  CM-GROUPING-PRIME         PIC X(3).
  5105         16  CM-STATE                      PIC XX.
  5106         16  CM-ACCOUNT.
  5107             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5108             20  CM-ACCOUNT-PRIME          PIC X(6).
  5109         16  CM-CERT-EFF-DT                PIC XX.
  5110         16  CM-CERT-NO.
  5111             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  96
* EL130.cbl
  5112             20  CM-CERT-SFX               PIC X.
  5113
  5114     12  CM-CONTROL-BY-NAME.
  5115         16  CM-COMPANY-CD-A1              PIC X.
  5116         16  CM-INSURED-LAST-NAME          PIC X(15).
  5117         16  CM-INSURED-INITIALS.
  5118             20  CM-INSURED-INITIAL1       PIC X.
  5119             20  CM-INSURED-INITIAL2       PIC X.
  5120
  5121     12  CM-CONTROL-BY-SSN.
  5122         16  CM-COMPANY-CD-A2              PIC X.
  5123         16  CM-SOC-SEC-NO.
  5124             20  CM-SSN-STATE              PIC XX.
  5125             20  CM-SSN-ACCOUNT            PIC X(6).
  5126             20  CM-SSN-LN3.
  5127                 25  CM-INSURED-INITIALS-A2.
  5128                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5129                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5130                 25 CM-PART-LAST-NAME-A2         PIC X.
  5131
  5132     12  CM-CONTROL-BY-CERT-NO.
  5133         16  CM-COMPANY-CD-A4              PIC X.
  5134         16  CM-CERT-NO-A4                 PIC X(11).
  5135
  5136     12  CM-CONTROL-BY-MEMB.
  5137         16  CM-COMPANY-CD-A5              PIC X.
  5138         16  CM-MEMBER-NO.
  5139             20  CM-MEMB-STATE             PIC XX.
  5140             20  CM-MEMB-ACCOUNT           PIC X(6).
  5141             20  CM-MEMB-LN4.
  5142                 25  CM-INSURED-INITIALS-A5.
  5143                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5144                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5145                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5146
  5147     12  CM-INSURED-PROFILE-DATA.
  5148         16  CM-INSURED-FIRST-NAME.
  5149             20  CM-INSURED-1ST-INIT       PIC X.
  5150             20  FILLER                    PIC X(9).
  5151         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5152         16  CM-INSURED-SEX                PIC X.
  5153             88  CM-SEX-MALE                  VALUE 'M'.
  5154             88  CM-SEX-FEMAL                 VALUE 'F'.
  5155         16  CM-INSURED-JOINT-AGE          PIC 99.
  5156         16  CM-JOINT-INSURED-NAME.
  5157             20  CM-JT-LAST-NAME           PIC X(15).
  5158             20  CM-JT-FIRST-NAME.
  5159                 24  CM-JT-1ST-INIT        PIC X.
  5160                 24  FILLER                PIC X(9).
  5161             20  CM-JT-INITIAL             PIC X.
  5162
  5163     12  CM-LIFE-DATA.
  5164         16  CM-LF-BENEFIT-CD              PIC XX.
  5165         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5166         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5167         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5168         16  CM-LF-DEV-CODE                PIC XXX.
  5169         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  97
* EL130.cbl
  5170         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5171         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5172         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5173         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5174         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5175         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5176         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5177         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5178         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5179         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5180         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5181         16  cm-temp-epiq                  pic xx.
  5182             88  EPIQ-CLASS                  value 'EQ'.
  5183*        16  FILLER                        PIC XX.
  5184
  5185     12  CM-AH-DATA.
  5186         16  CM-AH-BENEFIT-CD              PIC XX.
  5187         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5188         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5189         16  CM-AH-DEV-CODE                PIC XXX.
  5190         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5191         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5192         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5193         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5194         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5195         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5196         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5197         16  CM-AH-PAID-THRU-DT            PIC XX.
  5198             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5199         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5200         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5201         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5202         16  FILLER                        PIC X.
  5203
  5204     12  CM-LOAN-INFORMATION.
  5205         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5206         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5207                                           PIC S9(5)V99  COMP-3.
  5208         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5209         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5210         16  CM-PAY-FREQUENCY              PIC S99.
  5211         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5212         16  CM-RATE-CLASS                 PIC XX.
  5213         16  CM-BENEFICIARY                PIC X(25).
  5214         16  CM-POLICY-FORM-NO             PIC X(12).
  5215         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5216         16  CM-LAST-ADD-ON-DT             PIC XX.
  5217         16  CM-DEDUCTIBLE-AMOUNTS.
  5218             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5219             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5220         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5221             20  CM-RESIDENT-STATE         PIC XX.
  5222             20  CM-RATE-CODE              PIC X(4).
  5223             20  FILLER                    PIC XX.
  5224         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5225             20  CM-LOAN-OFFICER           PIC X(5).
  5226             20  FILLER                    PIC XXX.
  5227         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  98
* EL130.cbl
  5228         16  CM-UNDERWRITING-CODE          PIC X.
  5229             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5230         16  CM-POST-CARD-IND              PIC X.
  5231         16  CM-REF-INTERFACE-SW           PIC X.
  5232         16  CM-PREMIUM-TYPE               PIC X.
  5233             88  CM-SING-PRM                  VALUE '1'.
  5234             88  CM-O-B-COVERAGE              VALUE '2'.
  5235             88  CM-OPEN-END                  VALUE '3'.
  5236         16  CM-IND-GRP-TYPE               PIC X.
  5237             88  CM-INDIVIDUAL                VALUE 'I'.
  5238             88  CM-GROUP                     VALUE 'G'.
  5239         16  CM-SKIP-CODE                  PIC X.
  5240             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5241             88  SKIP-JULY                    VALUE '1'.
  5242             88  SKIP-AUGUST                  VALUE '2'.
  5243             88  SKIP-SEPTEMBER               VALUE '3'.
  5244             88  SKIP-JULY-AUG                VALUE '4'.
  5245             88  SKIP-AUG-SEPT                VALUE '5'.
  5246             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5247             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5248             88  SKIP-JUNE                    VALUE '8'.
  5249             88  SKIP-JUNE-JULY               VALUE '9'.
  5250             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5251             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5252         16  CM-PAYMENT-MODE               PIC X.
  5253             88  PAY-MONTHLY                  VALUE SPACE.
  5254             88  PAY-WEEKLY                   VALUE '1'.
  5255             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5256             88  PAY-BI-WEEKLY                VALUE '3'.
  5257             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5258         16  CM-LOAN-NUMBER                PIC X(8).
  5259         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5260         16  CM-OLD-LOF                    PIC XXX.
  5261*        16  CM-LOAN-OFFICER               PIC XXX.
  5262         16  CM-REIN-TABLE                 PIC XXX.
  5263         16  CM-SPECIAL-REIN-CODE          PIC X.
  5264         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5265         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5266         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5267
  5268     12  CM-STATUS-DATA.
  5269         16  CM-ENTRY-STATUS               PIC X.
  5270         16  CM-ENTRY-DT                   PIC XX.
  5271
  5272         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5273         16  CM-LF-CANCEL-DT               PIC XX.
  5274         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5275
  5276         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5277         16  CM-LF-DEATH-DT                PIC XX.
  5278         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5279
  5280         16  CM-LF-CURRENT-STATUS          PIC X.
  5281             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5282                                                'M' '4' '5' '9'.
  5283             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5284             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5285             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page  99
* EL130.cbl
  5286             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5287             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5288             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5289             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5290             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5291             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5292             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5293             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5294             88  CM-LF-DECLINED               VALUE 'D'.
  5295             88  CM-LF-VOIDED                 VALUE 'V'.
  5296
  5297         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5298         16  CM-AH-CANCEL-DT               PIC XX.
  5299         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5300
  5301         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5302         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5303         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5304
  5305         16  CM-AH-CURRENT-STATUS          PIC X.
  5306             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5307                                                'M' '4' '5' '9'.
  5308             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5309             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5310             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5311             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5312             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5313             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5314             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5315             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5316             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5317             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5318             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5319             88  CM-AH-DECLINED               VALUE 'D'.
  5320             88  CM-AH-VOIDED                 VALUE 'V'.
  5321
  5322         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5323             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5324             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5325             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5326         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5327
  5328         16  CM-ENTRY-BATCH                PIC X(6).
  5329         16  CM-LF-EXIT-BATCH              PIC X(6).
  5330         16  CM-AH-EXIT-BATCH              PIC X(6).
  5331         16  CM-LAST-MONTH-END             PIC XX.
  5332
  5333     12  CM-NOTE-SW                        PIC X.
  5334         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5335         88  CERT-NOTES-PRESENT               VALUE '1'.
  5336         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5337         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5338         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5339         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5340         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5341         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5342     12  CM-COMP-EXCP-SW                   PIC X.
  5343         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 100
* EL130.cbl
  5344         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5345     12  CM-INSURED-ADDRESS-SW             PIC X.
  5346         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5347         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5348
  5349*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5350     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5351     12  FILLER                            PIC X.
  5352
  5353*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5354     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5355     12  FILLER                            PIC X.
  5356*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5357     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5358
  5359     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5360         88  CERT-ADDED-BATCH                 VALUE ' '.
  5361         88  CERT-ADDED-ONLINE                VALUE '1'.
  5362         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5363         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5364         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5365     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5366         88  CERT-AS-LOADED                   VALUE ' '.
  5367         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5368         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5369         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5370         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5371         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5372         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5373         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5374
  5375     12  CM-ACCOUNT-COMM-PCTS.
  5376         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5377         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5378
  5379     12  CM-USER-FIELD                     PIC X.
  5380     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5381     12  CM-CLP-STATE                      PIC XX.
  5382     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5383     12  CM-USER-RESERVED                  PIC XXX.
  5384     12  FILLER REDEFINES CM-USER-RESERVED.
  5385         16  CM-AH-CLASS-CD                PIC XX.
  5386         16  F                             PIC X.
  5387******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 101
* EL130.cbl
  5389*    COPY ERCACCT.
  5390******************************************************************
  5391*                                                                *
  5392*                                                                *
  5393*                            ERCACCT                             *
  5394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5395*                            VMOD=2.031                          *
  5396*                                                                *
  5397*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5398*                                                                *
  5399*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5400*   VSAM ACCOUNT MASTER FILES.                                   *
  5401*                                                                *
  5402*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5403*                                                                *
  5404*   FILE TYPE = VSAM,KSDS                                        *
  5405*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5406*                                                                *
  5407*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5408*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5409*                                                                *
  5410*   LOG = NO                                                     *
  5411*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5412*                                                                *
  5413*                                                                *
  5414******************************************************************
  5415*                   C H A N G E   L O G
  5416*
  5417* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5418*-----------------------------------------------------------------
  5419*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5420* EFFECTIVE    NUMBER
  5421*-----------------------------------------------------------------
  5422* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5423* 092705    2005050300006  PEMA  ADD SPP LEASES
  5424* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5425* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5426* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5427* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5428* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5429* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  5430******************************************************************
  5431
  5432 01  ACCOUNT-MASTER.
  5433     12  AM-RECORD-ID                      PIC XX.
  5434         88  VALID-AM-ID                      VALUE 'AM'.
  5435
  5436     12  AM-CONTROL-PRIMARY.
  5437         16  AM-COMPANY-CD                 PIC X.
  5438         16  AM-MSTR-CNTRL.
  5439             20  AM-CONTROL-A.
  5440                 24  AM-CARRIER            PIC X.
  5441                 24  AM-GROUPING.
  5442                     28 AM-GROUPING-PREFIX PIC XXX.
  5443                     28 AM-GROUPING-PRIME  PIC XXX.
  5444                 24  AM-STATE              PIC XX.
  5445                 24  AM-ACCOUNT.
  5446                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 102
* EL130.cbl
  5447                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5448             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5449                                           PIC X(19).
  5450             20  AM-CNTRL-B.
  5451                 24  AM-EXPIRATION-DT      PIC XX.
  5452                 24  FILLER                PIC X(4).
  5453             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5454                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5455
  5456     12  AM-CONTROL-BY-VAR-GRP.
  5457         16  AM-COMPANY-CD-A1              PIC X.
  5458         16  AM-VG-CARRIER                 PIC X.
  5459         16  AM-VG-GROUPING                PIC X(6).
  5460         16  AM-VG-STATE                   PIC XX.
  5461         16  AM-VG-ACCOUNT                 PIC X(10).
  5462         16  AM-VG-DATE.
  5463             20  AM-VG-EXPIRATION-DT       PIC XX.
  5464             20  FILLER                    PIC X(4).
  5465         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5466                                           PIC 9(11)      COMP-3.
  5467     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5468         16  FILLER                        PIC X(10).
  5469         16  AM-VG-KEY3.
  5470             20  AM-VG3-ACCOUNT            PIC X(10).
  5471             20  AM-VG3-EXP-DT             PIC XX.
  5472         16  FILLER                        PIC X(4).
  5473     12  AM-MAINT-INFORMATION.
  5474         16  AM-LAST-MAINT-DT              PIC XX.
  5475         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5476         16  AM-LAST-MAINT-USER            PIC X(4).
  5477         16  FILLER                        PIC XX.
  5478
  5479     12  AM-EFFECTIVE-DT                   PIC XX.
  5480     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5481
  5482     12  AM-PREV-DATES  COMP-3.
  5483         16  AM-PREV-EXP-DT                PIC 9(11).
  5484         16  AM-PREV-EFF-DT                PIC 9(11).
  5485
  5486     12  AM-REPORT-CODE-1                  PIC X(10).
  5487     12  AM-REPORT-CODE-2                  PIC X(10).
  5488
  5489     12  AM-CITY-CODE                      PIC X(4).
  5490     12  AM-COUNTY-PARISH                  PIC X(6).
  5491
  5492     12  AM-NAME                           PIC X(30).
  5493     12  AM-PERSON                         PIC X(30).
  5494     12  AM-ADDRS                          PIC X(30).
  5495     12  AM-CITY.
  5496         16  AM-ADDR-CITY                  PIC X(28).
  5497         16  AM-ADDR-STATE                 PIC XX.
  5498     12  AM-ZIP.
  5499         16  AM-ZIP-PRIME.
  5500             20  AM-ZIP-PRI-1ST            PIC X.
  5501                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5502             20  FILLER                    PIC X(4).
  5503         16  AM-ZIP-PLUS4                  PIC X(4).
  5504     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 103
* EL130.cbl
  5505         16  AM-CAN-POSTAL-1               PIC XXX.
  5506         16  AM-CAN-POSTAL-2               PIC XXX.
  5507         16  FILLER                        PIC XXX.
  5508     12  AM-TEL-NO.
  5509         16  AM-AREA-CODE                  PIC 999.
  5510         16  AM-TEL-PRE                    PIC 999.
  5511         16  AM-TEL-NBR                    PIC 9(4).
  5512     12  AM-TEL-LOC                        PIC X.
  5513         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5514         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5515
  5516     12  AM-COMM-STRUCTURE.
  5517         16  AM-DEFN-1.
  5518             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5519                 24  AM-AGT.
  5520                     28  AM-AGT-PREFIX     PIC X(4).
  5521                     28  AM-AGT-PRIME      PIC X(6).
  5522                 24  AM-COM-TYP            PIC X.
  5523                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5524                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5525                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5526                 24  AM-RECALC-LV-INDIC    PIC X.
  5527                 24  AM-RETRO-LV-INDIC     PIC X.
  5528                 24  AM-GL-CODES           PIC X.
  5529                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5530                 24  FILLER                PIC X(01).
  5531         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5532             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5533                 24  FILLER                PIC X(11).
  5534                 24  AM-L-COMA             PIC XXX.
  5535                 24  AM-J-COMA             PIC XXX.
  5536                 24  AM-A-COMA             PIC XXX.
  5537                 24  FILLER                PIC X(6).
  5538
  5539     12  AM-COMM-CHANGE-STATUS             PIC X.
  5540         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5541
  5542     12  AM-CSR-CODE                       PIC X(4).
  5543
  5544     12  AM-BILLING-STATUS                 PIC X.
  5545         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5546         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5547     12  AM-AUTO-REFUND-SW                 PIC X.
  5548         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5549         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5550     12  AM-GPCD                           PIC 99.
  5551     12  AM-IG                             PIC X.
  5552         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5553         88  AM-HAS-GROUP                     VALUE '2'.
  5554     12  AM-STATUS                         PIC X.
  5555         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5556         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5557         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5558         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5559         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5560         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5561         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  5562         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 104
* EL130.cbl
  5563         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  5564         88  AM-ACCOUNT-PENDING               VALUE '9'.
  5565     12  AM-REMIT-TO                       PIC 99.
  5566     12  AM-ID-NO                          PIC X(11).
  5567
  5568     12  AM-CAL-TABLE                      PIC XX.
  5569     12  AM-LF-DEVIATION                   PIC XXX.
  5570     12  AM-AH-DEVIATION                   PIC XXX.
  5571     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5572     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5573     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5574     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5575     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5576     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5577
  5578     12  AM-USER-FIELDS.
  5579         16  AM-FLD-1                      PIC XX.
  5580         16  AM-FLD-2                      PIC XX.
  5581         16  AM-FLD-3                      PIC XX.
  5582         16  AM-FLD-4                      PIC XX.
  5583         16  AM-FLD-5                      PIC XX.
  5584
  5585     12  AM-1ST-PROD-DATE.
  5586         16  AM-1ST-PROD-YR                PIC XX.
  5587         16  AM-1ST-PROD-MO                PIC XX.
  5588         16  AM-1ST-PROD-DA                PIC XX.
  5589     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5590     12  AM-CERTS-PURGED-DATE.
  5591         16  AM-PUR-YR                     PIC XX.
  5592         16  AM-PUR-MO                     PIC XX.
  5593         16  AM-PUR-DA                     PIC XX.
  5594     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5595     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5596     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5597     12  AM-INACTIVE-DATE.
  5598         16  AM-INA-MO                     PIC 99.
  5599         16  AM-INA-DA                     PIC 99.
  5600         16  AM-INA-YR                     PIC 99.
  5601     12  AM-AR-HI-CERT-DATE                PIC XX.
  5602
  5603     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5604     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5605
  5606     12  AM-OB-PAYMENT-MODE                PIC X.
  5607         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5608         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5609         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5610         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5611
  5612     12  AM-AH-ONLY-INDICATOR              PIC X.
  5613         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5614         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5615
  5616     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5617
  5618     12  AM-OVER-SHORT.
  5619         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5620         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 105
* EL130.cbl
  5621
  5622     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5623     12  AM-DCC-CLP-STATE                  PIC XX.
  5624
  5625     12  AM-RECALC-COMM                    PIC X.
  5626     12  AM-RECALC-REIN                    PIC X.
  5627
  5628     12  AM-REI-TABLE                      PIC XXX.
  5629     12  AM-REI-ET-LF                      PIC X.
  5630     12  AM-REI-ET-AH                      PIC X.
  5631     12  AM-REI-PE-LF                      PIC X.
  5632     12  AM-REI-PE-AH                      PIC X.
  5633     12  AM-REI-PRT-ST                     PIC X.
  5634     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5635     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5636     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5637     12  AM-REI-GROUP-A                    PIC X(6).
  5638     12  AM-REI-MORT                       PIC X(4).
  5639     12  AM-REI-PRT-OW                     PIC X.
  5640     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5641     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5642     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5643     12  AM-REI-GROUP-B                    PIC X(6).
  5644
  5645     12  AM-TRUST-TYPE                     PIC X(2).
  5646
  5647     12  AM-EMPLOYER-STMT-USED             PIC X.
  5648     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5649
  5650     12  AM-STD-AH-TYPE                    PIC XX.
  5651     12  AM-EARN-METHODS.
  5652         16  AM-EARN-METHOD-R              PIC X.
  5653             88 AM-REF-RL-R78                 VALUE 'R'.
  5654             88 AM-REF-RL-PR                  VALUE 'P'.
  5655             88 AM-REF-RL-MEAN                VALUE 'M'.
  5656             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5657         16  AM-EARN-METHOD-L              PIC X.
  5658             88 AM-REF-LL-R78                 VALUE 'R'.
  5659             88 AM-REF-LL-PR                  VALUE 'P'.
  5660             88 AM-REF-LL-MEAN                VALUE 'M'.
  5661             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5662         16  AM-EARN-METHOD-A              PIC X.
  5663             88 AM-REF-AH-R78                 VALUE 'R'.
  5664             88 AM-REF-AH-PR                  VALUE 'P'.
  5665             88 AM-REF-AH-MEAN                VALUE 'M'.
  5666             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5667             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5668             88 AM-REF-AH-NET                 VALUE 'N'.
  5669
  5670     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5671     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5672     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5673
  5674     12  AM-RET-Y-N                        PIC X.
  5675     12  AM-RET-P-E                        PIC X.
  5676     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5677     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5678     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 106
* EL130.cbl
  5679     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5680         16  AM-POOL-PRIME                 PIC XXX.
  5681         16  AM-POOL-SUB                   PIC XXX.
  5682     12  AM-RETRO-EARNINGS.
  5683         16  AM-RET-EARN-R                 PIC X.
  5684         16  AM-RET-EARN-L                 PIC X.
  5685         16  AM-RET-EARN-A                 PIC X.
  5686     12  AM-RET-ST-TAX-USE                 PIC X.
  5687         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5688         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5689     12  AM-RETRO-BEG-EARNINGS.
  5690         16  AM-RET-BEG-EARN-R             PIC X.
  5691         16  AM-RET-BEG-EARN-L             PIC X.
  5692         16  AM-RET-BEG-EARN-A             PIC X.
  5693     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5694     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5695
  5696     12  AM-USER-SELECT-OPTIONS.
  5697         16  AM-USER-SELECT-1              PIC X(10).
  5698         16  AM-USER-SELECT-2              PIC X(10).
  5699         16  AM-USER-SELECT-3              PIC X(10).
  5700         16  AM-USER-SELECT-4              PIC X(10).
  5701         16  AM-USER-SELECT-5              PIC X(10).
  5702
  5703     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5704
  5705     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5706
  5707     12  AM-RPT045A-SWITCH                 PIC X.
  5708         88  RPT045A-OFF                   VALUE 'N'.
  5709
  5710     12  AM-INSURANCE-LIMITS.
  5711         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5712         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5713
  5714     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5715         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5716
  5717     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5718         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5719         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5720
  5721     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5722
  5723     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5724     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5725     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5726     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5727     12  AM-DCC-UEF-STATE                  PIC XX.
  5728     12  FILLER                            PIC XXX.
  5729     12  AM-REPORT-CODE-3                  PIC X(10).
  5730*    12  FILLER                            PIC X(22).
  5731
  5732     12  AM-RESERVE-DATE.
  5733         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5734         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5735         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5736
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 107
* EL130.cbl
  5737     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5738     12  AM-NOTIFICATION-TYPES.
  5739         16  AM-NOTIF-OF-LETTERS           PIC X.
  5740         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5741         16  AM-NOTIF-OF-REPORTS           PIC X.
  5742         16  AM-NOTIF-OF-STATUS            PIC X.
  5743
  5744     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5745         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5746         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5747         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5748         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5749
  5750     12  AM-BENEFIT-CONTROLS.
  5751         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5752             20  AM-BENEFIT-CODE           PIC XX.
  5753             20  AM-BENEFIT-TYPE           PIC X.
  5754             20  AM-BENEFIT-REVISION       PIC XXX.
  5755             20  AM-BENEFIT-REM-TERM       PIC X.
  5756             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5757             20  FILLER                    PIC XX.
  5758         16  FILLER                        PIC X(80).
  5759
  5760     12  AM-TRANSFER-DATA.
  5761         16  AM-TRANSFERRED-FROM.
  5762             20  AM-TRNFROM-CARRIER        PIC X.
  5763             20  AM-TRNFROM-GROUPING.
  5764                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5765                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5766             20  AM-TRNFROM-STATE          PIC XX.
  5767             20  AM-TRNFROM-ACCOUNT.
  5768                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5769                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5770             20  AM-TRNFROM-DTE            PIC XX.
  5771         16  AM-TRANSFERRED-TO.
  5772             20  AM-TRNTO-CARRIER          PIC X.
  5773             20  AM-TRNTO-GROUPING.
  5774                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5775                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5776             20  AM-TRNTO-STATE            PIC XX.
  5777             20  AM-TRNTO-ACCOUNT.
  5778                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5779                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5780             20  AM-TRNTO-DTE              PIC XX.
  5781         16  FILLER                        PIC X(10).
  5782
  5783     12  AM-SAVED-REMIT-TO                 PIC 99.
  5784
  5785     12  AM-COMM-STRUCTURE-SAVED.
  5786         16  AM-DEFN-1-SAVED.
  5787             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5788                 24  AM-AGT-SV             PIC X(10).
  5789                 24  AM-COM-TYP-SV         PIC X.
  5790                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5791                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5792                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5793                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5794                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 108
* EL130.cbl
  5795                 24  AM-GL-CODES-SV        PIC X.
  5796                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5797                 24  FILLER                PIC X.
  5798         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5799             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5800                 24  FILLER                PIC X(11).
  5801                 24  AM-L-COMA-SV          PIC XXX.
  5802                 24  AM-J-COMA-SV          PIC XXX.
  5803                 24  AM-A-COMA-SV          PIC XXX.
  5804                 24  FILLER                PIC X(6).
  5805
  5806     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5807         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5808            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5809            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5810            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5811
  5812     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5813     12  FILLER                            PIC X(120).
  5814
  5815     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5816         16  AM-CONTROL-NAME               PIC X(30).
  5817         16  AM-EXECUTIVE-ONE.
  5818             20  AM-EXEC1-NAME             PIC X(15).
  5819             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5820                                                          COMP-3.
  5821             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5822                                                          COMP-3.
  5823         16  AM-EXECUTIVE-TWO.
  5824             20  AM-EXEC2-NAME             PIC X(15).
  5825             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5826                                                          COMP-3.
  5827             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5828                                                          COMP-3.
  5829
  5830     12  AM-RETRO-ADDITIONAL-DATA.
  5831         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5832         16  AM-RETRO-PREM-P-E             PIC X.
  5833         16  AM-RETRO-CLMS-P-I             PIC X.
  5834         16  AM-RETRO-RET-BRACKET-LF.
  5835             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5836                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5837                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5838             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5839                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5840                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5841             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5842                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5843                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5844         16  AM-RETRO-RET-BRACKET-AH.
  5845             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5846                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5847                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5848                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5849             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5850                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5851                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5852             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 109
* EL130.cbl
  5853                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5854                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5855
  5856     12  AM-COMMENTS.
  5857         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5858
  5859     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5860         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5861         16  AM-FLI-BILLING-CODE           PIC X.
  5862         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5863         16  AM-FLI-UNITED-IDENT           PIC X.
  5864         16  AM-FLI-INTEREST-LOST-DATA.
  5865             20  AM-FLI-BANK-NO            PIC X(5).
  5866             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5867             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5868             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5869         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5870             20  AM-FLI-AGT                PIC X(9).
  5871             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5872             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5873         16  FILLER                        PIC X(102).
  5874
  5875     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5876         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5877             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5878             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5879             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5880             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5881             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5882         16  FILLER                          PIC X(10).
  5883******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 110
* EL130.cbl
  5885*    COPY ELCTRLR.
  5886******************************************************************
  5887*                                                                *
  5888*                            ELCTRLR.                            *
  5889*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5890*                            VMOD=2.014                          *
  5891*                                                                *
  5892*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5893*                                                                *
  5894*   FILE TYPE = VSAM,KSDS                                        *
  5895*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5896*                                                                *
  5897*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5898*       ALTERNATE INDEX = NONE                                   *
  5899*                                                                *
  5900*   LOG = YES                                                    *
  5901*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5902******************************************************************
  5903*                   C H A N G E   L O G
  5904*
  5905* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5906*-----------------------------------------------------------------
  5907*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5908* EFFECTIVE    NUMBER
  5909*-----------------------------------------------------------------
  5910* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5911* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5912* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5913* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5914* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5915* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5916* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5917* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5918* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5919* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5920* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5921* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5922* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5923* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5924* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5925* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5926* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5927* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5928* 040814    2014030500002  AJRA  ADD ICD CODES
  5929* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5930* 013017  CR2016053100001  PEMA  ACH PROCESSING
  5931* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  5932* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  5933* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  5934******************************************************************
  5935 01  ACTIVITY-TRAILERS.
  5936     12  AT-RECORD-ID                    PIC XX.
  5937         88  VALID-AT-ID                       VALUE 'AT'.
  5938
  5939     12  AT-CONTROL-PRIMARY.
  5940         16  AT-COMPANY-CD               PIC X.
  5941         16  AT-CARRIER                  PIC X.
  5942         16  AT-CLAIM-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 111
* EL130.cbl
  5943         16  AT-CERT-NO.
  5944             20  AT-CERT-PRIME           PIC X(10).
  5945             20  AT-CERT-SFX             PIC X.
  5946         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5947             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5948             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5949             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5950             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5951             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5952             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5953             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5954             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5955             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5956             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5957             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5958             88  AT-BENEFICIARY-TRL           VALUE +91.
  5959             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5960             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5961             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5962             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5963
  5964     12  AT-TRAILER-TYPE                 PIC X.
  5965         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5966         88  PAYMENT-TR                       VALUE '2'.
  5967         88  AUTO-PAY-TR                      VALUE '3'.
  5968         88  CORRESPONDENCE-TR                VALUE '4'.
  5969         88  ADDRESS-TR                       VALUE '5'.
  5970         88  GENERAL-INFO-TR                  VALUE '6'.
  5971         88  AUTO-PROMPT-TR                   VALUE '7'.
  5972         88  DENIAL-TR                        VALUE '8'.
  5973         88  INCURRED-CHG-TR                  VALUE '9'.
  5974         88  FORM-CONTROL-TR                  VALUE 'A'.
  5975
  5976     12  AT-RECORDED-DT                  PIC XX.
  5977     12  AT-RECORDED-BY                  PIC X(4).
  5978     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5979
  5980     12  AT-TRAILER-BODY                 PIC X(165).
  5981
  5982     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5983         16  AT-RESERVE-CONTROLS.
  5984             20  AT-MANUAL-SW            PIC X.
  5985                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5986             20  AT-FUTURE-SW            PIC X.
  5987                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5988             20  AT-PTC-SW               PIC X.
  5989                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5990             20  AT-IBNR-SW              PIC X.
  5991                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5992             20  AT-PTC-LF-SW            PIC X.
  5993                 88  AT-LF-PTC-USED          VALUE '1'.
  5994             20  AT-CDT-ACCESS-METHOD    PIC X.
  5995                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5996                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5997                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5998             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5999         16  AT-LAST-COMPUTED-DT         PIC XX.
  6000         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 112
* EL130.cbl
  6001         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6002         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6003         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6004         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6005         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6006         16  AT-EXPENSE-CONTROLS.
  6007             20  AT-EXPENSE-METHOD       PIC X.
  6008                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6009                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6010                 88  PERCENT-OF-PMT           VALUE '3'.
  6011                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6012             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6013             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6014         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6015         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6016
  6017         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6018         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6019
  6020*        16  FILLER                      PIC X(53).
  6021         16  FILLER                      PIC X(47).
  6022
  6023         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6024         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6025
  6026         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6027             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6028             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6029*                    C = CLOSED
  6030*                    O = OPEN
  6031             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6032*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6033
  6034     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6035         16  AT-PAYMENT-TYPE             PIC X.
  6036             88  PARTIAL-PAYMENT                VALUE '1'.
  6037             88  FINAL-PAYMENT                  VALUE '2'.
  6038             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6039             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6040             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6041             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6042             88  VOIDED-PAYMENT                 VALUE '9'.
  6043             88  TRANSFER                       VALUE 'T'.
  6044             88  LIFE-INTEREST                  VALUE 'I'.
  6045
  6046         16  AT-CLAIM-TYPE               PIC X.
  6047             88  PAID-FOR-AH                    VALUE 'A'.
  6048             88  PAID-FOR-LIFE                  VALUE 'L'.
  6049             88  PAID-FOR-IUI                   VALUE 'I'.
  6050             88  PAID-FOR-GAP                   VALUE 'G'.
  6051             88  PAID-FOR-FAM                   VALUE 'F'.
  6052             88  PAID-FOR-OTH                   VALUE 'O'.
  6053         16  AT-CLAIM-PREM-TYPE          PIC X.
  6054             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6055             88  AT-O-B-COVERAGE                VALUE '2'.
  6056             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6057         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6058         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 113
* EL130.cbl
  6059         16  AT-PAID-FROM-DT             PIC XX.
  6060         16  AT-PAID-THRU-DT             PIC XX.
  6061         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6062         16  AT-ACH-PAYMENT              PIC X.
  6063*        16  FILLER                      PIC X.
  6064         16  AT-PAYEES-NAME              PIC X(30).
  6065         16  AT-PAYMENT-ORIGIN           PIC X.
  6066             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6067             88  ONLINE-AUTO-PMT                VALUE '2'.
  6068             88  OFFLINE-PMT                    VALUE '3'.
  6069         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6070         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6071         16  AT-VOID-DATA.
  6072             20  AT-VOID-DT              PIC XX.
  6073*00144       20  AT-VOID-REASON          PIC X(30).
  6074             20  AT-VOID-REASON          PIC X(26).
  6075         16  AT-PMT-APPROVED-BY          PIC X(04).
  6076         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6077         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6078         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6079                                         PIC S99V9(5)  COMP-3.
  6080         16  AT-CREDIT-INTERFACE.
  6081             20  AT-PMT-SELECT-DT        PIC XX.
  6082                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6083             20  AT-PMT-ACCEPT-DT        PIC XX.
  6084                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6085             20  AT-VOID-SELECT-DT       PIC XX.
  6086                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6087             20  AT-VOID-ACCEPT-DT       PIC XX.
  6088                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6089
  6090         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6091                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6092                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6093         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6094
  6095         16  AT-FORCE-CONTROL            PIC X.
  6096             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6097         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6098         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6099         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6100         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6101         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6102         16  AT-BENEFIT-TYPE             PIC X.
  6103
  6104         16  AT-EXPENSE-TYPE             PIC X.
  6105         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6106
  6107         16  AT-PAYEE-TYPE-CD.
  6108             20  AT-PAYEE-TYPE           PIC X.
  6109                 88  INSURED-PAID           VALUE 'I'.
  6110                 88  BENEFICIARY-PAID       VALUE 'B'.
  6111                 88  ACCOUNT-PAID           VALUE 'A'.
  6112                 88  OTHER-1-PAID           VALUE 'O'.
  6113                 88  OTHER-2-PAID           VALUE 'Q'.
  6114                 88  DOCTOR-PAID            VALUE 'P'.
  6115                 88  EMPLOYER-PAID          VALUE 'E'.
  6116             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 114
* EL130.cbl
  6117
  6118         16  AT-CASH-PAYMENT             PIC X.
  6119         16  AT-GROUPED-PAYMENT          PIC X.
  6120         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6121         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6122         16  AT-APPROVED-LEVEL           PIC X.
  6123         16  AT-VOID-TYPE                PIC X.
  6124             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6125             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6126         16  AT-AIG-UNEMP-IND            PIC X.
  6127             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6128         16  AT-ASSOCIATES               PIC X.
  6129             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6130             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6131
  6132         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6133         16  AT-CV-PMT-CODE              PIC X.
  6134             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6135             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6136             88  FULL-ADD-PAYMENT           VALUE '3'.
  6137             88  HALF-ADD-PAYMENT           VALUE '4'.
  6138             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6139             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6140             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6141             88  ADDL-PAYMENT               VALUE '8'.
  6142
  6143         16  AT-EOB-CODE1                PIC XXX.
  6144         16  AT-EOB-CODE2                PIC XXX.
  6145         16  AT-EOB-CODE3                PIC XXX.
  6146         16  FILLER REDEFINES AT-EOB-CODE3.
  6147             20  AT-PRINT-CLM-FORM       PIC X.
  6148             20  AT-PRINT-SURVEY         PIC X.
  6149             20  AT-SPECIAL-RELEASE      PIC X.
  6150         16  AT-EOB-CODE4                PIC XXX.
  6151         16  FILLER REDEFINES AT-EOB-CODE4.
  6152             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6153             20  FILLER                  PIC X.
  6154         16  AT-EOB-CODE5                PIC XXX.
  6155         16  FILLER REDEFINES AT-EOB-CODE5.
  6156             20  AT-PMT-PROOF-DT         PIC XX.
  6157             20  FILLER                  PIC X.
  6158
  6159         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6160             88  AT-PRINT-EOB            VALUE 'Y'.
  6161
  6162         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6163         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6164
  6165     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6166         16  AT-SCHEDULE-START-DT        PIC XX.
  6167         16  AT-SCHEDULE-END-DT          PIC XX.
  6168         16  AT-TERMINATED-DT            PIC XX.
  6169         16  AT-LAST-PMT-TYPE            PIC X.
  6170             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6171             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6172         16  AT-FIRST-PMT-DATA.
  6173             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6174             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 115
* EL130.cbl
  6175             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6176         16  AT-REGULAR-PMT-DATA.
  6177             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6178             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6179             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6180         16  AT-AUTO-PAYEE-CD.
  6181             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6182                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6183                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6184                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6185                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6186                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6187             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6188         16  AT-AUTO-PAY-DAY             PIC 99.
  6189         16  AT-AUTO-CASH                PIC X.
  6190             88  AT-CASH                      VALUE 'Y'.
  6191             88  AT-NON-CASH                  VALUE 'N'.
  6192*        16  FILLER                      PIC X(129).
  6193         16  AT-AUTO-END-LETTER          PIC X(4).
  6194         16  FILLER                      PIC X(125).
  6195
  6196         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6197         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6198
  6199     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6200         16  AT-LETTER-SENT-DT           PIC XX.
  6201         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6202         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6203         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6204         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6205         16  AT-LETTER-ORIGIN            PIC X.
  6206             88  ONLINE-CREATION              VALUE '1' '3'.
  6207             88  OFFLINE-CREATION             VALUE '2' '4'.
  6208             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6209             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6210         16  AT-STD-LETTER-FORM          PIC X(4).
  6211         16  AT-REASON-TEXT              PIC X(70).
  6212         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6213         16  AT-ADDRESEE-TYPE            PIC X.
  6214              88  INSURED-ADDRESEE            VALUE 'I'.
  6215              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6216              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6217              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6218              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6219              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6220              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6221         16  AT-ADDRESSEE-NAME           PIC X(30).
  6222         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6223         16  AT-RESEND-PRINT-DATE        PIC XX.
  6224         16  AT-CORR-SOL-UNSOL           PIC X.
  6225         16  AT-LETTER-PURGED-DT         PIC XX.
  6226*
  6227*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6228*
  6229         16  AT-CSO-REDEFINITION.
  6230             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6231             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6232             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 116
* EL130.cbl
  6233             20  AT-STOP-LETTER-DT       PIC X(2).
  6234             20  AT-AUTH-RCVD            PIC X(1).
  6235             20  FILLER                  PIC X(18).
  6236*             20  FILLER                  PIC X(27).
  6237             20  AT-CSO-LETTER-STATUS    PIC X.
  6238                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6239                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6240                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6241             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6242             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6243*
  6244*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6245*
  6246*        16  FILLER                      PIC X(26).
  6247*
  6248*        16  AT-DMD-BSR-CODE             PIC X.
  6249*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6250*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6251*
  6252*        16  AT-DMD-LETTER-STATUS        PIC X.
  6253*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6254*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6255*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6256*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6257*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6258
  6259         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6260         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6261
  6262     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6263         16  AT-ADDRESS-TYPE             PIC X.
  6264             88  INSURED-ADDRESS               VALUE 'I'.
  6265             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6266             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6267             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6268             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6269             88  OTHER-ADDRESS-1               VALUE 'O'.
  6270             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6271         16  AT-MAIL-TO-NAME             PIC X(30).
  6272         16  AT-ADDRESS-LINE-1           PIC X(30).
  6273         16  AT-ADDRESS-LINE-2           PIC X(30).
  6274         16  AT-CITY-STATE.
  6275             20  AT-CITY                 PIC X(28).
  6276             20  AT-STATE                PIC XX.
  6277         16  AT-ZIP.
  6278             20  AT-ZIP-CODE.
  6279                 24  AT-ZIP-1ST          PIC X.
  6280                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6281                 24  FILLER              PIC X(4).
  6282             20  AT-ZIP-PLUS4            PIC X(4).
  6283         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6284             20  AT-CAN-POSTAL-1         PIC XXX.
  6285             20  AT-CAN-POSTAL-2         PIC XXX.
  6286             20  FILLER                  PIC XXX.
  6287         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6288*         16  FILLER                      PIC X(23).
  6289         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6290         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 117
* EL130.cbl
  6291         16  FILLER                      PIC X(13).
  6292         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6293         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6294
  6295     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6296         16  AT-INFO-LINE-1              PIC X(60).
  6297         16  FILLER REDEFINES AT-INFO-LINE-1.
  6298             20  AT-NOTE-ERROR-NO OCCURS 15
  6299                                         PIC X(4).
  6300         16  AT-INFO-LINE-2              PIC X(60).
  6301         16  FILLER REDEFINES AT-INFO-LINE-2.
  6302             20  AT-ICD-CODE-1           PIC X(8).
  6303             20  AT-ICD-CODE-2           PIC X(8).
  6304             20  FILLER                  PIC X(44).
  6305         16  AT-INFO-TRAILER-TYPE        PIC X.
  6306             88  AT-ERRORS-NOTE          VALUE 'E'.
  6307             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6308             88  AT-CALL-NOTE            VALUE 'C'.
  6309             88  AT-MAINT-NOTE           VALUE 'M'.
  6310             88  AT-CERT-CHANGE          VALUE 'X'.
  6311             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6312             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6313             88  AT-CERT-CANCELLED       VALUE 'T'.
  6314         16  AT-CALL-TYPE                PIC X.
  6315             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6316             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  6317             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6318         16  AT-NOTE-CONTINUATION        PIC X.
  6319             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6320         16  AT-EOB-CODES-EXIST          PIC X.
  6321             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6322         16  FILLER                      PIC X(35).
  6323         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6324         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6325
  6326     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6327         16  AT-PROMPT-LINE-1            PIC X(60).
  6328         16  AT-PROMPT-LINE-2            PIC X(60).
  6329         16  AT-PROMPT-START-DT          PIC XX.
  6330         16  AT-PROMPT-END-DT            PIC XX.
  6331         16  FILLER                      PIC X(35).
  6332         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6333         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6334
  6335     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6336         16  AT-DENIAL-INFO-1            PIC X(60).
  6337         16  AT-DENIAL-INFO-2            PIC X(60).
  6338         16  AT-DENIAL-DT                PIC XX.
  6339         16  AT-RETRACTION-DT            PIC XX.
  6340         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6341*         16  FILLER                      PIC X(31).
  6342         16  AT-DENIAL-PROOF-DT          PIC XX.
  6343         16  FILLER                      PIC X(29).
  6344         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6345         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6346
  6347     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6348         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 118
* EL130.cbl
  6349         16  AT-OLD-REPORTED-DT          PIC XX.
  6350         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6351         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6352         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6353         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6354         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6355         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6356         16  FILLER                      PIC X(26).
  6357         16  AT-OLD-DIAG-CODE            PIC X(6).
  6358         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6359         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6360         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6361         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6362         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6363         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6364         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6365         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6366         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6367         16  FILLER                      PIC X(9).
  6368         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6369
  6370     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6371         16  AT-FORM-SEND-ON-DT          PIC XX.
  6372         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6373         16  AT-FORM-RE-SEND-DT          PIC XX.
  6374         16  AT-FORM-ANSWERED-DT         PIC XX.
  6375         16  AT-FORM-PRINTED-DT          PIC XX.
  6376         16  AT-FORM-REPRINT-DT          PIC XX.
  6377         16  AT-FORM-TYPE                PIC X.
  6378             88  INITIAL-FORM                  VALUE '1'.
  6379             88  PROGRESS-FORM                 VALUE '2'.
  6380         16  AT-INSTRUCT-LN-1            PIC X(28).
  6381         16  AT-INSTRUCT-LN-2            PIC X(28).
  6382         16  AT-INSTRUCT-LN-3            PIC X(28).
  6383         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6384         16  AT-FORM-ADDRESS             PIC X.
  6385             88  FORM-TO-INSURED              VALUE 'I'.
  6386             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6387             88  FORM-TO-OTHER-1              VALUE 'O'.
  6388             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6389         16  AT-RELATED-1.
  6390             20 AT-REL-CARR-1            PIC X.
  6391             20 AT-REL-CLAIM-1           PIC X(7).
  6392             20 AT-REL-CERT-1            PIC X(11).
  6393         16  AT-RELATED-2.
  6394             20 AT-REL-CARR-2            PIC X.
  6395             20 AT-REL-CLAIM-2           PIC X(7).
  6396             20 AT-REL-CERT-2            PIC X(11).
  6397         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6398         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6399         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6400         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6401         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6402         16  AT-STOP-FORM-DT             PIC X(2).
  6403
  6404         16  FILLER                      PIC X(09).
  6405         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6406         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 119
* EL130.cbl
  6407******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 120
* EL130.cbl
  6409*    COPY ELCBENE.
  6410******************************************************************
  6411*                                                                *
  6412*                            ELCBENE.                            *
  6413*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6414*                            VMOD=2.006                          *
  6415*                                                                *
  6416*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6417*                                                                *
  6418*   FILE TYPE = VSAM,KSDS                                        *
  6419*   RECORD SIZE = 500   RECFORM = FIX                            *
  6420*                                                                *
  6421*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6422*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6423*                                                                *
  6424*   LOG = YES                                                    *
  6425*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6426*                                                                *
  6427*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6428******************************************************************
  6429*                   C H A N G E   L O G
  6430*
  6431* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6432*-----------------------------------------------------------------
  6433*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6434* EFFECTIVE    NUMBER
  6435*-----------------------------------------------------------------
  6436* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6437* 082317  CR2017082100003  PEMA  Add sub type
  6438* 032019  CR2019011400002  PEMA  Add email address for ach report
  6439******************************************************************
  6440
  6441 01  BENEFICIARY-MASTER.
  6442     12  BE-RECORD-ID                PIC XX.
  6443         88  VALID-BE-ID                VALUE 'BE'.
  6444
  6445     12  BE-CONTROL-PRIMARY.
  6446         16  BE-COMPANY-CD           PIC X.
  6447         16  BE-RECORD-TYPE          PIC X.
  6448             88  BENEFICIARY-RECORD  VALUE 'B'.
  6449             88  ADJUSTOR-RECORD     VALUE 'A'.
  6450         16  BE-BENEFICIARY          PIC X(10).
  6451     12  BE-CONTROL-BY-NAME.
  6452         16  BE-COMPANY-CD-A1        PIC X.
  6453         16  BE-RECORD-TYPE-A1       PIC X.
  6454         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6455         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6456
  6457     12  BE-LAST-MAINT-DT            PIC XX.
  6458     12  BE-LAST-MAINT-BY            PIC X(4).
  6459     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6460
  6461     12  BE-ADDRESS-DATA.
  6462         16  BE-MAIL-TO-NAME         PIC X(30).
  6463         16  BE-ADDRESS-LINE-1       PIC X(30).
  6464         16  BE-ADDRESS-LINE-2       PIC X(30).
  6465         16  BE-ADDRESS-LINE-3       PIC X(30).
  6466         16  BE-CITY-STATE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 121
* EL130.cbl
  6467             20  BE-CITY             PIC X(28).
  6468             20  BE-STATE            PIC XX.
  6469         16  BE-ZIP-CODE.
  6470             20  BE-ZIP-PRIME.
  6471                 24  BE-ZIP-1ST      PIC X.
  6472                     88  BE-CANADIAN-POST-CODE
  6473                                         VALUE 'A' THRU 'Z'.
  6474                 24  FILLER          PIC X(4).
  6475             20  BE-ZIP-PLUS4        PIC X(4).
  6476         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6477             20  BE-CAN-POSTAL-1     PIC XXX.
  6478             20  BE-CAN-POSTAL-2     PIC XXX.
  6479             20  FILLER              PIC XXX.
  6480         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6481         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6482
  6483******************************************************************
  6484*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6485*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6486******************************************************************
  6487     12  BE-CARRIER                  PIC X.
  6488
  6489     12  BE-ADDRESS-DATA2.
  6490         16  BE-MAIL-TO-NAME2        PIC X(30).
  6491         16  BE-ADDRESS-LINE-12      PIC X(30).
  6492         16  BE-ADDRESS-LINE-22      PIC X(30).
  6493         16  BE-ADDRESS-LINE-32      PIC X(30).
  6494         16  BE-CITY-STATE2.
  6495             20  BE-CITY2            PIC X(28).
  6496             20  BE-STATE2           PIC XX.
  6497         16  BE-ZIP-CODE2.
  6498             20  BE-ZIP-PRIME2.
  6499                 24  BE-ZIP-1ST2     PIC X.
  6500                     88  BE-CANADIAN-POST-CODE2
  6501                                         VALUE 'A' THRU 'Z'.
  6502                 24  FILLER          PIC X(4).
  6503             20  BE-ZIP-PLUS42       PIC X(4).
  6504         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6505             20  BE-CAN-POSTAL-12    PIC XXX.
  6506             20  BE-CAN-POSTAL-22    PIC XXX.
  6507             20  FILLER              PIC XXX.
  6508         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6509         16  BE-ACH-DATA.
  6510             20  BE-ACH-YES-OR-NO    PIC X.
  6511                 88  BE-ON-ACH       VALUE 'Y'.
  6512                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  6513             20  BE-ACH-ABA-ROUTING-NUMBER
  6514                                     PIC X(15).
  6515             20  BE-ACH-BANK-ACCOUNT-NUMBER
  6516                                     PIC X(20).
  6517             20  BE-ACH-SUB-TYPE     PIC XX.
  6518             20  BE-ACH-EMAIL-YN     PIC X.
  6519                 88  BE-EMAIL-ACH-RPT  VALUE 'Y'.
  6520             20  be-ach-email-addr   PIC X(40).
  6521         16  BE-BILLING-STMT-DATA.
  6522*            20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6523             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6524             20  BE-OUTPUT-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 122
* EL130.cbl
  6525                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6526                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6527
  6528     12  filler                      PIC X(16).
  6529******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 123
* EL130.cbl
  6531*    COPY ELCDAR.
  6532******************************************************************
  6533*                                                                *
  6534*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6535*   FILE TYPE = VSAM,KSDS                                        *
  6536*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6537*   BASE CLUSTER = DLYACTV                                       *
  6538*   LOG = YES                                                    *
  6539*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6540*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6541*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6542*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6543*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6544*               BY PROGRAM "LGINFCE".                            *
  6545*                                                                *
  6546******************************************************************
  6547 01  DAILY-ACTIVITY-RECORD.
  6548     05  DA-KEY.
  6549         10  DA-COMP-CD          PIC X.
  6550         10  DA-CARRIER          PIC X.
  6551         10  DA-CLAIM-NO         PIC X(7).
  6552         10  DA-CERT-NO.
  6553             15  DA-CERT-PRIME   PIC X(10).
  6554             15  DA-CERT-SFX     PIC X.
  6555     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6556     05  DA-RECORD-TYPE          PIC X.
  6557     05  FILLER                  PIC X(2).
  6558******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 124
* EL130.cbl
  6560*    COPY ELCACTQ.
  6561******************************************************************
  6562*                                                                *
  6563*                            ELCACTQ.                            *
  6564*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6565*                            VMOD=2.004                          *
  6566*                                                                *
  6567*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6568*                                                                *
  6569*   FILE TYPE = VSAM,KSDS                                        *
  6570*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6571*                                                                *
  6572*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6573*       ALTERNATE INDEX = NONE                                   *
  6574*                                                                *
  6575*   LOG = YES                                                    *
  6576*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6577*                                                                *
  6578*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6579******************************************************************
  6580
  6581 01  ACTIVITY-QUE.
  6582     12  AQ-RECORD-ID                PIC XX.
  6583         88  VALID-AQ-ID                VALUE 'AQ'.
  6584
  6585     12  AQ-CONTROL-PRIMARY.
  6586         16  AQ-COMPANY-CD           PIC X.
  6587         16  AQ-CARRIER              PIC X.
  6588         16  AQ-CLAIM-NO             PIC X(7).
  6589         16  AQ-CERT-NO.
  6590             20  AQ-CERT-PRIME       PIC X(10).
  6591             20  AQ-CERT-SFX         PIC X.
  6592
  6593     12  AQ-PENDING-ACTIVITY-FLAGS.
  6594         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6595         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6596             88  PENDING-PAYMENTS       VALUE '1'.
  6597         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6598             88  PENDING-FULL-PRINT     VALUE '1'.
  6599             88  PENDING-PART-PRINT     VALUE '2'.
  6600         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6601             88  PENDING-LETTERS        VALUE '1'.
  6602         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6603             88  PENDING-RESTORE        VALUE 'C'.
  6604             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6605
  6606     12  FILLER                      PIC X(20).
  6607
  6608     12  AQ-RESEND-DATE              PIC XX.
  6609     12  AQ-FOLLOWUP-DATE            PIC XX.
  6610     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6611     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6612     12  AQ-AUTO-LETTER              PIC X(4).
  6613     12  FILLER                      PIC XX.
  6614     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6615*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 125
* EL130.cbl
  6617*    COPY ELCARCH.
  6618******************************************************************
  6619*                                                                *
  6620*                            ELCARCH.                            *
  6621*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6622*                            VMOD=2.007                          *
  6623*                                                                *
  6624*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6625*                                                                *
  6626*   FILE TYPE = VSAM,KSDS                                        *
  6627*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6628*                                                                *
  6629*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6630*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6631*                                                                *
  6632*   LOG = NO                                                     *
  6633*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6634*                                                                *
  6635*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6636******************************************************************
  6637 01  LETTER-ARCHIVE.
  6638     12  LA-RECORD-ID                PIC XX.
  6639         88  VALID-LA-ID                VALUE 'LA'.
  6640
  6641     12  LA-CONTROL-PRIMARY.
  6642         16  LA-COMPANY-CD           PIC X.
  6643         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6644         16  LA-RECORD-TYPE          PIC X.
  6645             88  LA-HEADER-DATA         VALUE '1'.
  6646             88  LA-ADDRESS-DATA        VALUE '2'.
  6647             88  LA-TEXT-DATA           VALUE '3'.
  6648             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6649         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6650
  6651     12  LA-CONTROL-BY-TYPE.
  6652         16  LA-COMPANY-CD-A1        PIC X.
  6653         16  LA-RECORD-TYPE-A1       PIC X.
  6654         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6655         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6656
  6657     12  LA-TEXT-RECORD.
  6658         16  LA-SKIP-CONTROL         PIC XX.
  6659             88  NO-LINES-SKIPPED       VALUE SPACES.
  6660             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6661         16  LA-TEXT-LINE            PIC X(70).
  6662
  6663     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6664         16  FILLER                  PIC XX.
  6665         16  LA-ADDRESS-LINE         PIC X(30).
  6666         16  FILLER                  PIC X(40).
  6667
  6668     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6669         16  FILLER                  PIC XX.
  6670         16  LA-CARRIER              PIC X.
  6671         16  LA-CLAIM-NO             PIC X(7).
  6672         16  LA-CERT-NO.
  6673             20  LA-CERT-PRIME       PIC X(10).
  6674             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 126
* EL130.cbl
  6675         16  LA-NO-OF-COPIES         PIC S9.
  6676         16  LA-RESEND-DATE          PIC XX.
  6677         16  LA-PROCESSOR-CD         PIC X(4).
  6678         16  LA-CREATION-DT          PIC XX.
  6679         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6680         16  LA-RESEND-PRINT-DATE    PIC XX.
  6681         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6682         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6683*
  6684* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6685*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6686*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6687*   I        20  LA-DMD-RES-ST           PIC XX.
  6688*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6689*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6690*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6691*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6692*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6693*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6694*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6695*   I        20  LA-DMD-UND-CODE         PIC XX.
  6696*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6697*   V    16  FILLER                  PIC X(15).
  6698* -----
  6699*
  6700* REINSERTED  CSO  MODS
  6701*
  6702         16  FILLER.
  6703             20  FILLER                  PIC X(29).
  6704             20  LA-CSO-LETTER-STATUS    PIC X.
  6705                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6706                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6707                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6708             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6709             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6710*
  6711
  6712     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6713         16  FILLER                  PIC XX.
  6714         16  LA4-CARRIER             PIC X.
  6715         16  LA4-CLAIM-NO            PIC X(7).
  6716         16  LA4-CERT-NO.
  6717             20  LA4-CERT-PRIME      PIC X(10).
  6718             20  LA4-CERT-SFX        PIC X.
  6719         16  LA4-NO-OF-COPIES        PIC S9.
  6720         16  LA4-RESEND-DATE         PIC XX.
  6721         16  LA4-PROCESSOR-CD        PIC X(4).
  6722         16  LA4-CREATION-DT         PIC XX.
  6723         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6724         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6725         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6726         16  LA4-FORM-TYPE           PIC X.
  6727             88  LA4-INITIAL-FORM    VALUE '1'.
  6728             88  LA4-PROGRESS-FORM   VALUE '2'.
  6729         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6730         16  LA4-STATE               PIC X(02).
  6731         16  FILLER                  PIC X(31).
  6732******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 127
* EL130.cbl
  6734*    COPY ERCREIN.
  6735******************************************************************
  6736*                                                                *
  6737*                            ERCREIN                             *
  6738*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6739*                            VMOD=2.010                          *
  6740*                                                                *
  6741*   ONLINE CREDIT SYSTEM                                         *
  6742*                                                                *
  6743*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6744*                                                                *
  6745*   FILE TYPE = VSAM,KSDS                                        *
  6746*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6747*                                                                *
  6748*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6749*       ALTERNATE PATH = NONE                                    *
  6750*                                                                *
  6751*   LOG = NO                                                     *
  6752*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6753*                                                                *
  6754******************************************************************
  6755*                   C H A N G E   L O G
  6756*
  6757* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6758*-----------------------------------------------------------------
  6759*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6760* EFFECTIVE    NUMBER
  6761*-----------------------------------------------------------------
  6762* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6763* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6764******************************************************************
  6765 01  REINSURANCE-RECORD.
  6766     12  RE-RECORD-ID                      PIC XX.
  6767         88  VALID-RE-ID                      VALUE 'RE'.
  6768
  6769     12  RE-CONTROL-PRIMARY.
  6770         16  RE-COMPANY-CD                 PIC X.
  6771         16  RE-KEY.
  6772             20  RE-CODE                   PIC X.
  6773                 88  RE-TABLE-RECORD          VALUE 'A'.
  6774                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6775             20  RE-TABLE                  PIC XXX.
  6776             20  FILLER                    PIC XXX.
  6777         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6778             20  FILLER                    PIC X.
  6779             20  RE-COMPANY.
  6780                 24  RE-COMP-PRIME         PIC XXX.
  6781                 24  RE-COMP-SUB           PIC XXX.
  6782
  6783     12  RE-MAINT-INFORMATION.
  6784         16  RE-LAST-MAINT-DT              PIC XX.
  6785         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6786         16  RE-LAST-MAINT-USER            PIC X(4).
  6787         16  FILLER                        PIC X(10).
  6788
  6789     12  RE-TABLE-DATA.
  6790         16  RE-100-COMP                   PIC 99.
  6791
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 128
* EL130.cbl
  6792         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6793             20  RE-REI-COMP-NO.
  6794                 24  RE-REI-COMP           PIC XXX.
  6795                 24  RE-REI-COMP-SUB       PIC XXX.
  6796             20  RE-LF-QC                  PIC X.
  6797             20  RE-AH-QC                  PIC X.
  6798             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6799             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6800             20  RE-LFAGE-LO               PIC 99.
  6801             20  RE-LFAGE-HI               PIC 99.
  6802             20  RE-AHAGE-LO               PIC 99.
  6803             20  RE-AHAGE-HI               PIC 99.
  6804             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6805             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6806             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6807             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6808             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6809             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6810             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6811             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6812             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6813             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6814             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6815             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6816             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6817             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6818             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6819             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6820             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6821             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6822             20  RE-LF-BEN-CODE            PIC X.
  6823             20  RE-AH-BEN-CODE            PIC X.
  6824             20  RE-INTERACTIVE            PIC X.
  6825             20  RE-REMAINING              PIC X.
  6826             20  RE-LF-RUNOFF-SW           PIC X.
  6827             20  RE-AH-RUNOFF-SW           PIC X.
  6828             20  FILLER                    PIC X(19).
  6829
  6830         16  RE-COMP-INFO-END              PIC X(6).
  6831         16  RE-NSP-ST-CD-LF               PIC XX.
  6832         16  RE-NSP-ST-CD-AH               PIC XX.
  6833         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6834             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6835
  6836         16  FILLER                        PIC X(27).
  6837
  6838     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6839         16  RE-NAME                       PIC X(30).
  6840         16  RE-LF-PE                      PIC X.
  6841         16  RE-AH-PE                      PIC X.
  6842         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6843         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6844         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6845         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6846         16  RE-PRT-ST                     PIC X.
  6847         16  RE-PRT-OW                     PIC X.
  6848         16  RE-MORT-CODE                  PIC X(4).
  6849         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 129
* EL130.cbl
  6850         16  RE-ZERO-LF-FEE                PIC X.
  6851         16  RE-ZERO-AH-FEE                PIC X.
  6852         16  RE-CEDE-NAME                  PIC X(30).
  6853         16  RE-LF-COMM                    PIC X.
  6854         16  RE-AH-COMM                    PIC X.
  6855         16  RE-LF-TAX                     PIC X.
  6856         16  RE-AH-TAX                     PIC X.
  6857         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6858         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6859         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6860
  6861         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6862             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6863
  6864         16  RE-LF-CEDING-FEE-BRACKETS.
  6865             20  RE-LF-FEE-METHOD          PIC X.
  6866                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6867                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6868                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6869                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6870             20  RE-LF-FEE-BASIS           PIC X.
  6871                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6872                 88  RE-LF-NET-CEDED               VALUE '2'.
  6873                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6874                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6875                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6876                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6877                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6878                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6879             20  FILLER                    PIC XXX.
  6880             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6881                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6882                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6883
  6884         16  RE-AH-CEDING-FEE-BRACKETS.
  6885             20  RE-AH-FEE-METHOD          PIC X.
  6886                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6887                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6888                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6889                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6890             20  RE-AH-FEE-BASIS           PIC X.
  6891                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6892                 88  RE-AH-NET-CEDED               VALUE '2'.
  6893                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6894                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6895                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6896                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6897                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6898                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6899             20  FILLER                    PIC XXX.
  6900             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6901                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6902                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6903
  6904         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6905
  6906         16  RE-OLD-CEDING-STMT            PIC X.
  6907
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 130
* EL130.cbl
  6908         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6909         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6910         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6911         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6912         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6913         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6914         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6915         16  RE-MORT-SW                    PIC X.
  6916         16  RE-CEDING-TYPE-FLAG           PIC X.
  6917             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6918             88  RE-CEDED                          VALUE 'C'.
  6919             88  RE-ASSUMED                        VALUE 'A'.
  6920             88  RE-PHANTOM                        VALUE 'P'.
  6921
  6922         16  RE-CEDING-STMT-OPT-A          PIC X.
  6923             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6924         16  RE-CEDING-STMT-OPT-B          PIC X.
  6925             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6926         16  RE-CEDING-STMT-OPT-C          PIC X.
  6927             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6928         16  RE-CEDING-STMT-OPT-D          PIC X.
  6929             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6930         16  RE-CEDING-STMT-OPT-E          PIC X.
  6931             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6932
  6933         16  RE-PRT-CRSV                   PIC X.
  6934
  6935         16  RE-GL-CENTER                  PIC X(4).
  6936
  6937         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6938
  6939         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6940
  6941         16  RE-EARN-STOP-CODE             PIC X.
  6942             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6943             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6944
  6945         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6946             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6947
  6948         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6949         16  FILLER                        PIC X(2281).
  6950
  6951         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6952
  6953******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 131
* EL130.cbl
  6955*    COPY ERCMAIL.
  6956******************************************************************
  6957*                                                                *
  6958*                                                                *
  6959*                            ERCMAIL                             *
  6960*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6961*                            VMOD=2.003                          *
  6962*                                                                *
  6963*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6964*                                                                *
  6965*   FILE TYPE = VSAM,KSDS                                        *
  6966*   RECORD SIZE = 374   RECFORM = FIX                            *
  6967*                                                                *
  6968*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6969*   ALTERNATE PATH    = NOT USED                                 *
  6970*                                                                *
  6971*   LOG = YES                                                    *
  6972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6973******************************************************************
  6974*                   C H A N G E   L O G
  6975*
  6976* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6977*-----------------------------------------------------------------
  6978*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6979* EFFECTIVE    NUMBER
  6980*-----------------------------------------------------------------
  6981* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6982* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6983* 111108                   PEMA  ADD CRED BENE ADDR2
  6984******************************************************************
  6985
  6986 01  MAILING-DATA.
  6987     12  MA-RECORD-ID                      PIC XX.
  6988         88  VALID-MA-ID                       VALUE 'MA'.
  6989
  6990     12  MA-CONTROL-PRIMARY.
  6991         16  MA-COMPANY-CD                 PIC X.
  6992         16  MA-CARRIER                    PIC X.
  6993         16  MA-GROUPING.
  6994             20  MA-GROUPING-PREFIX        PIC XXX.
  6995             20  MA-GROUPING-PRIME         PIC XXX.
  6996         16  MA-STATE                      PIC XX.
  6997         16  MA-ACCOUNT.
  6998             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6999             20  MA-ACCOUNT-PRIME          PIC X(6).
  7000         16  MA-CERT-EFF-DT                PIC XX.
  7001         16  MA-CERT-NO.
  7002             20  MA-CERT-PRIME             PIC X(10).
  7003             20  MA-CERT-SFX               PIC X.
  7004
  7005     12  FILLER                            PIC XX.
  7006
  7007     12  MA-ACCESS-CONTROL.
  7008         16  MA-SOURCE-SYSTEM              PIC XX.
  7009             88  MA-FROM-CREDIT                VALUE 'CR'.
  7010             88  MA-FROM-VSI                   VALUE 'VS'.
  7011             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7012             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 132
* EL130.cbl
  7013         16  MA-RECORD-ADD-DT              PIC XX.
  7014         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7015         16  MA-LAST-MAINT-DT              PIC XX.
  7016         16  MA-LAST-MAINT-BY              PIC XXXX.
  7017         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7018
  7019     12  MA-PROFILE-INFO.
  7020         16  MA-QUALIFY-CODE-1             PIC XX.
  7021         16  MA-QUALIFY-CODE-2             PIC XX.
  7022         16  MA-QUALIFY-CODE-3             PIC XX.
  7023         16  MA-QUALIFY-CODE-4             PIC XX.
  7024         16  MA-QUALIFY-CODE-5             PIC XX.
  7025
  7026         16  MA-INSURED-LAST-NAME          PIC X(15).
  7027         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7028         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7029         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7030         16  MA-INSURED-BIRTH-DT           PIC XX.
  7031         16  MA-INSURED-SEX                PIC X.
  7032             88  MA-SEX-MALE                   VALUE 'M'.
  7033             88  MA-SEX-FEMALE                 VALUE 'F'.
  7034         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7035
  7036         16  MA-ADDRESS-CORRECTED          PIC X.
  7037         16  MA-JOINT-BIRTH-DT             PIC XX.
  7038*        16  FILLER                        PIC X(12).
  7039
  7040         16  MA-ADDRESS-LINE-1             PIC X(30).
  7041         16  MA-ADDRESS-LINE-2             PIC X(30).
  7042         16  MA-CITY-STATE.
  7043             20  MA-CITY                   PIC X(28).
  7044             20  MA-ADDR-STATE             PIC XX.
  7045         16  MA-ZIP.
  7046             20  MA-ZIP-CODE.
  7047                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7048                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7049                 24  FILLER                PIC X(4).
  7050             20  MA-ZIP-PLUS4              PIC X(4).
  7051         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7052             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7053             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7054             20  FILLER                    PIC X(3).
  7055
  7056         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7057
  7058         16  FILLER                        PIC XXX.
  7059*        16  FILLER                        PIC X(10).
  7060
  7061     12  MA-CRED-BENE-INFO.
  7062         16  MA-CRED-BENE-NAME                 PIC X(25).
  7063         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7064         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7065         16  MA-CRED-BENE-CTYST.
  7066             20  MA-CRED-BENE-CITY             PIC X(28).
  7067             20  MA-CRED-BENE-STATE            PIC XX.
  7068         16  MA-CRED-BENE-ZIP.
  7069             20  MA-CB-ZIP-CODE.
  7070                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 133
* EL130.cbl
  7071                     88  MA-CB-CANADIAN-POST-CODE
  7072                                           VALUE 'A' THRU 'Z'.
  7073                 24  FILLER                    PIC X(4).
  7074             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7075         16  MA-CB-CANADIAN-POSTAL-CODE
  7076                            REDEFINES MA-CRED-BENE-ZIP.
  7077             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7078             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7079             20  FILLER                        PIC X(3).
  7080     12  MA-POST-CARD-MAIL-DATA.
  7081         16  MA-MAIL-DATA OCCURS 7.
  7082             20  MA-MAIL-TYPE              PIC X.
  7083                 88  MA-12MO-MAILING           VALUE '1'.
  7084                 88  MA-EXP-MAILING            VALUE '2'.
  7085             20  MA-MAIL-STATUS            PIC X.
  7086                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7087                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7088                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7089             20  MA-MAIL-DATE              PIC XX.
  7090     12  FILLER                            PIC XX.
  7091     12  FILLER                            PIC XX.
  7092*    12  FILLER                            PIC X(30).
  7093******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 134
* EL130.cbl
  7095*    COPY ELCCRTT.
  7096******************************************************************
  7097*                                                                *
  7098*                            ELCCRTT.                            *
  7099*                                                                *
  7100*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7101*                                                                *
  7102*   FILE TYPE = VSAM,KSDS                                        *
  7103*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7104*                                                                *
  7105*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7106*                                                                *
  7107*   LOG = YES                                                    *
  7108*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7109******************************************************************
  7110*                   C H A N G E   L O G
  7111*
  7112* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7113*-----------------------------------------------------------------
  7114*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7115* EFFECTIVE    NUMBER
  7116*-----------------------------------------------------------------
  7117* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7118* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7119* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7120* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7121* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7122* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7123* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7124* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7125* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7126* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7127* 091318  CR2018073000001  PEMA  ADD Refund methods
  7128* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7129******************************************************************
  7130
  7131 01  CERTIFICATE-TRAILERS.
  7132     12  CS-RECORD-ID                      PIC XX.
  7133         88  VALID-CS-ID                      VALUE 'CS'.
  7134
  7135     12  CS-CONTROL-PRIMARY.
  7136         16  CS-COMPANY-CD                 PIC X.
  7137         16  CS-CARRIER                    PIC X.
  7138         16  CS-GROUPING                   PIC X(6).
  7139         16  CS-STATE                      PIC XX.
  7140         16  CS-ACCOUNT                    PIC X(10).
  7141         16  CS-CERT-EFF-DT                PIC XX.
  7142         16  CS-CERT-NO.
  7143             20  CS-CERT-PRIME             PIC X(10).
  7144             20  CS-CERT-SFX               PIC X.
  7145         16  CS-TRAILER-TYPE               PIC X.
  7146             88  COMM-TRLR           VALUE 'A'.
  7147             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7148             88  CERT-DATA-TRLR      VALUE 'C'.
  7149
  7150     12  CS-DATA-AREA                      PIC X(516).
  7151
  7152     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 135
* EL130.cbl
  7153         16  CS-BANK-COMMISSION-AREA.
  7154             20  CS-BANK-COMMS       OCCURS 10.
  7155                 24  CS-AGT                PIC X(10).
  7156                 24  CS-COM-TYP            PIC X.
  7157                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7158                 24  CS-RECALC-LV-INDIC    PIC X.
  7159                 24  FILLER                PIC X(10).
  7160         16  FILLER                        PIC X(256).
  7161
  7162     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7163****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7164         16  CS-MB-CLAIM-DATA OCCURS 24.
  7165             20  CS-CLAIM-NO               PIC X(7).
  7166             20  CS-CLAIM-TYPE             PIC X.
  7167                 88  CS-AH-CLM               VALUE 'A'.
  7168                 88  CS-IU-CLM               VALUE 'I'.
  7169                 88  CS-GP-CLM               VALUE 'G'.
  7170                 88  CS-LF-CLM               VALUE 'L'.
  7171                 88  CS-PR-CLM               VALUE 'P'.
  7172                 88  CS-FL-CLM               VALUE 'F'.
  7173                 88  CS-OT-CLM               VALUE 'O'.
  7174             20  CS-INSURED-TYPE           PIC X.
  7175                 88  CS-PRIM-INSURED          VALUE 'P'.
  7176                 88  CS-CO-BORROWER           VALUE 'C'.
  7177             20  CS-BENEFIT-PERIOD         PIC 99.
  7178             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7179             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7180             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7181         16  FILLER                        PIC X(12).
  7182     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7183         16  CS-VIN-NUMBER                 PIC X(17).
  7184         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7185         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7186         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7187         16  cs-agent-name.
  7188             20  cs-agent-fname            pic x(20).
  7189             20  cs-agent-mi               pic x.
  7190             20  cs-agent-lname            pic x(25).
  7191         16  cs-license-no                 pic x(15).
  7192         16  cs-npn-number                 pic x(10).
  7193         16  cs-agent-edit-status          pic x.
  7194             88  cs-ae-refer-to-manager      value 'M'.
  7195             88  cs-ae-cover-sheet           value 'C'.
  7196             88  cs-ae-sig-form              value 'S'.
  7197             88  cs-ae-verified              value 'V'.
  7198             88  cs-unidentified-signature   value 'U'.
  7199             88  cs-cert-returned            value 'R'.
  7200             88  cs-accept-no-commission     value 'N'.
  7201         16  cs-year                       pic 9999.
  7202         16  cs-make                       pic x(20).
  7203         16  cs-model                      pic x(20).
  7204         16  cs-future                     pic x(20).
  7205         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7206         16  cs-claim-verification-status  pic x.
  7207             88  cs-clm-ver-eligible         value 'A'.
  7208             88  cs-clm-ver-partial-elig     value 'B'.
  7209             88  cs-clm-ver-not-eligible     value 'C'.
  7210             88  cs-clm-ver-not-elig-opn-clm value 'D'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 136
* EL130.cbl
  7211             88  cs-clm-ver-not-part-elig-rw value 'E'.
  7212             88  cs-clm-ver-ND-CERT          value 'F'.
  7213             88  cs-clm-ver-spec-other       value 'G'.
  7214             88  cs-clam-ver-pratial-corrected
  7215                                             value 'H'.
  7216             88  cs-clm-ver-no-matches       value 'I'.
  7217             88  cs-clm-ver-not-elig-corrected
  7218                                             value 'J'.
  7219             88  cs-clm-ver-needs-review     value 'R'.
  7220             88  cs-clm-ver-sent-to-claims   value 'W'.
  7221         16  CS-LF-REFUND-METHOD           PIC X.
  7222         16  CS-AH-REFUND-METHOD           PIC X.
  7223         16  FILLER                        PIC X(353). *> was 420
  7224*        16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 137
* EL130.cbl
  7226
  7227 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7228                          CONTROL-FILE CERTIFICATE-MASTER
  7229                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7230                          BENEFICIARY-MASTER
  7231                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7232                          LETTER-ARCHIVE REINSURANCE-RECORD
  7233                          MAILING-DATA CERTIFICATE-TRAILERS.
  7234 0000-DFHEXIT SECTION.
  7235     MOVE '9#                    $   ' TO DFHEIV0.
  7236     MOVE 'EL130' TO DFHEIV1.
  7237     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7238     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7239     MOVE '5'                    TO DC-OPTION-CODE.
  7240     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7241     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7242     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7243
  7244     IF EIBCALEN = ZERO
  7245         GO TO 8800-UNAUTHORIZED-ACCESS
  7246     END-IF.
  7247
  7248     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7249     MOVE EIBTRMID               TO QID-TERM.
  7250     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7251     move spaces                 to emi-error-lines
  7252     MOVE '2'                    TO EMI-SWITCH2.
  7253     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7254     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7255
  7256
  7257* EXEC CICS HANDLE CONDITION
  7258*        QIDERR     (0100-TEST-ENTRY)
  7259*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7260*        PGMIDERR   (9600-PGMID-ERROR)
  7261*        TERMIDERR  (8820-TERM-ERROR)
  7262*        TRANSIDERR (8830-TRAN-ERROR)
  7263*        ERROR      (9990-ABEND)
  7264*    END-EXEC.
  7265*    MOVE '"$N?L[\.              ! " #00007252' TO DFHEIV0
  7266     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7267     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7268     MOVE X'2220233030303037323532' TO DFHEIV0(25:11)
  7269     CALL 'kxdfhei1' USING DFHEIV0
  7270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7271
  7272
  7273     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7274        PI-CALLING-PROGRAM   = XCTL-6592
  7275         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7276     ELSE
  7277         MOVE SPACES             TO RETURNED-FROM
  7278     END-IF.
  7279
  7280     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7281         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7282             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7283             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 138
* EL130.cbl
  7284             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7285             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7286             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7287             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7288             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7289             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7290         ELSE
  7291             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7292             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7293             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7294             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7295             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7296             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7297             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7298             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7299         END-IF
  7300     END-IF.
  7301
  7302     IF EIBTRNID = TRANS-ID
  7303         IF EIBAID = DFHCLEAR
  7304             GO TO 9400-CLEAR
  7305         ELSE
  7306             GO TO 0200-RECEIVE
  7307         END-IF
  7308     END-IF.
  7309
  7310     IF RETURNED-FROM NOT = SPACES
  7311         GO TO 0600-RECOVER-TEMP-STORAGE
  7312     END-IF.
  7313
  7314     MOVE LOW-VALUES TO EL130AO.
  7315     move zeros to pi-dcc-max-amt
  7316                   pi-dcc-max-benefits
  7317
  7318
  7319
  7320* EXEC CICS DELETEQ TS
  7321*         QUEUE   (QID)
  7322*    END-EXEC.
  7323*    MOVE '*&                    #   #00007307' TO DFHEIV0
  7324     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7325     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7326     MOVE X'2020233030303037333037' TO DFHEIV0(25:11)
  7327     CALL 'kxdfhei1' USING DFHEIV0,
  7328           QID,
  7329           DFHEIV99
  7330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7331
  7332
  7333 0100-TEST-ENTRY.
  7334     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7335         GO TO 0650-FROM-EL127
  7336     ELSE
  7337         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7338                                    PI-CERT-PROCESSED
  7339                                    PI-LETTER-ERROR-CODE
  7340     END-IF.
  7341
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 139
* EL130.cbl
  7342     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7343         GO TO 0640-FROM-EL132
  7344     END-IF.
  7345
  7346     GO TO 8100-SEND-INITIAL-MAP.
  7347
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 140
* EL130.cbl
  7349 0200-RECEIVE.
  7350     MOVE LOW-VALUES             TO EL130AI.
  7351
  7352     IF PI-PROCESSOR-ID = 'LGXX'
  7353*        NEXT SENTENCE
  7354         CONTINUE
  7355     ELSE
  7356
  7357* EXEC CICS READQ TS
  7358*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7359*            INTO    (SECURITY-CONTROL)
  7360*            LENGTH  (SC-COMM-LENGTH)
  7361*            ITEM    (SC-ITEM)
  7362*        END-EXEC
  7363*    MOVE '*$II   L              ''   #00007334' TO DFHEIV0
  7364     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7365     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7366     MOVE X'2020233030303037333334' TO DFHEIV0(25:11)
  7367     CALL 'kxdfhei1' USING DFHEIV0,
  7368           PI-SECURITY-TEMP-STORE-ID,
  7369           SECURITY-CONTROL,
  7370           SC-COMM-LENGTH,
  7371           SC-ITEM,
  7372           DFHEIV99,
  7373           DFHEIV99
  7374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7375         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7376         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7377         IF NOT DISPLAY-CAP
  7378             MOVE 'READ'              TO  SM-READ
  7379             PERFORM 9995-SECURITY-VIOLATION
  7380             MOVE ER-0070             TO  EMI-ERROR
  7381             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7382             GO TO 8100-SEND-INITIAL-MAP
  7383         END-IF
  7384     END-IF.
  7385
  7386     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7387         MOVE ER-7008 TO EMI-ERROR
  7388         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7389         MOVE -1 TO MAINTL
  7390         GO TO 8200-SEND-DATAONLY
  7391     END-IF.
  7392
  7393
  7394
  7395* EXEC CICS RECEIVE
  7396*         MAP     (MAP-NAME)
  7397*         MAPSET  (MAPSET-NAME)
  7398*         INTO    (EL130AI)
  7399*    END-EXEC.
  7400     MOVE LENGTH OF
  7401      EL130AI
  7402       TO DFHEIV11
  7403*    MOVE '8"T I  L              ''   #00007359' TO DFHEIV0
  7404     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7405     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7406     MOVE X'2020233030303037333539' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 141
* EL130.cbl
  7407     CALL 'kxdfhei1' USING DFHEIV0,
  7408           MAP-NAME,
  7409           EL130AI,
  7410           DFHEIV11,
  7411           MAPSET-NAME,
  7412           DFHEIV99,
  7413           DFHEIV99
  7414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7415
  7416
  7417     IF NOT PI-NO-CARRIER-SECURITY
  7418        MOVE +1                  TO CLMCARRL
  7419        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7420     END-IF.
  7421
  7422     IF ENTERPFL = ZERO
  7423         GO TO 0300-CHECK-PFKEYS
  7424     END-IF.
  7425
  7426     IF EIBAID NOT = DFHENTER
  7427         MOVE ER-0004            TO EMI-ERROR
  7428         GO TO 0320-INPUT-ERROR
  7429     END-IF.
  7430
  7431     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7432         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7433     ELSE
  7434         MOVE ER-0029            TO EMI-ERROR
  7435         GO TO 0320-INPUT-ERROR
  7436     END-IF.
  7437
  7438 0300-CHECK-PFKEYS.
  7439     IF EIBAID = DFHPF23
  7440         GO TO 8810-PF23
  7441     END-IF.
  7442
  7443     IF EIBAID = DFHPF24
  7444         GO TO 9200-RETURN-MAIN-MENU
  7445     END-IF.
  7446
  7447     IF EIBAID = DFHPF12
  7448         GO TO 9500-PF12
  7449     END-IF.
  7450
  7451     IF EIBAID = DFHPF3
  7452         MOVE SPACES              TO MAINTI
  7453         MOVE ZEROS               TO MAINTL
  7454         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7455         MOVE XCTL-127            TO PGM-NAME
  7456         GO TO 9300-XCTL
  7457     END-IF.
  7458
  7459     IF EIBAID = DFHPF4
  7460         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7461         MOVE XCTL-132            TO PGM-NAME
  7462         GO TO 9300-XCTL
  7463     END-IF.
  7464
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 142
* EL130.cbl
  7465     IF EIBAID = DFHPF13
  7466         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7467             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7468             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7469             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7470             MOVE PI-STATE            TO  PI-CR-STATE
  7471             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7472             MOVE XCTL-650            TO  PGM-NAME
  7473             GO TO 9300-XCTL
  7474         ELSE
  7475             MOVE -1                  TO  ENTERPFL
  7476             MOVE ER-2566             TO  EMI-ERROR
  7477             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7478             GO TO 8100-SEND-INITIAL-MAP
  7479         END-IF
  7480     END-IF.
  7481
  7482     IF EIBAID = DFHPF5
  7483         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7484             ADD +1 TO PI-CERT-PROCESSED
  7485             GO TO 0650-FROM-EL127
  7486         ELSE
  7487             MOVE ER-7686         TO EMI-ERROR
  7488             GO TO 0320-INPUT-ERROR
  7489         END-IF
  7490     END-IF.
  7491
  7492     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7493         GO TO 0800-TEST-PREVIOUS-CONTROL
  7494     END-IF.
  7495
  7496     IF PI-HAS-CLAS-IC-CRDTCRD
  7497         IF EIBAID = DFHPF10
  7498             MOVE XCTL-725          TO PGM-NAME
  7499             GO TO 9300-XCTL
  7500         END-IF
  7501     END-IF.
  7502
  7503     IF EIBAID = DFHPF14
  7504         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7505         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7506         MOVE XCTL-659            TO PGM-NAME
  7507         GO TO 9300-XCTL
  7508     END-IF.
  7509
  7510     IF EIBAID = DFHPF15
  7511         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7512         MOVE XCTL-114            TO PGM-NAME
  7513         GO TO 9300-XCTL
  7514     END-IF.
  7515
  7516*    IF EIBAID = DFHPF11
  7517*       GO TO 0600-RECOVER-TEMP-STORAGE
  7518*    END-IF
  7519     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7520         GO TO 0330-EDIT-DATA
  7521     END-IF.
  7522
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 143
* EL130.cbl
  7523     MOVE ER-0029                TO EMI-ERROR.
  7524
  7525 0320-INPUT-ERROR.
  7526     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7527
  7528     MOVE AL-UNBON               TO ENTERPFA.
  7529
  7530     IF ENTERPFL = ZERO
  7531         MOVE -1                 TO MAINTL
  7532     ELSE
  7533         MOVE -1                 TO ENTERPFL
  7534     END-IF.
  7535
  7536     GO TO 8200-SEND-DATAONLY.
  7537
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 144
* EL130.cbl
  7539 0330-EDIT-DATA.
  7540
  7541     IF MAINTI = 'S'
  7542         IF PRTOPTL GREATER THAN 0
  7543             IF PRTOPTI NOT = 'N' AND 'L'
  7544                 MOVE AL-UABON   TO  PRTOPTA
  7545                 MOVE -1         TO  PRTOPTL
  7546                 MOVE ER-0334    TO  EMI-ERROR
  7547                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7548                 GO TO 8200-SEND-DATAONLY
  7549             ELSE
  7550                 IF PRTOPTI = 'L'
  7551                     GO TO 0400-CREATE-ELACTQ
  7552                 ELSE
  7553                     GO TO 0480-PRINT-NOW
  7554                 END-IF
  7555             END-IF
  7556         ELSE
  7557             GO TO 1000-SHOW-CLAIM
  7558         END-IF
  7559     END-IF.
  7560
  7561     IF NOT MODIFY-CAP
  7562         MOVE 'UPDATE'       TO  SM-READ
  7563         PERFORM 9995-SECURITY-VIOLATION
  7564         MOVE ER-0070        TO  EMI-ERROR
  7565         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7566         GO TO 8100-SEND-INITIAL-MAP
  7567     END-IF.
  7568
  7569     IF MAINTI = 'D'
  7570         GO TO 2000-DELETE-CLAIM
  7571     END-IF.
  7572
  7573     IF MAINTI = 'A'
  7574         GO TO 3000-ADD-CLAIM
  7575     END-IF.
  7576
  7577     IF MAINTI = 'I'
  7578         GO TO 5000-INCURRED-CHANGE
  7579     END-IF.
  7580
  7581     MOVE ER-0023                TO EMI-ERROR.
  7582     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7583     MOVE -1                     TO MAINTL.
  7584     MOVE AL-UABON               TO MAINTA.
  7585
  7586     GO TO 8200-SEND-DATAONLY.
  7587
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 145
* EL130.cbl
  7589 0400-CREATE-ELACTQ.
  7590     IF CLMNOI   = PI-LAST-CLAIM      AND
  7591        CLMCARRI = PI-LAST-CARR       AND
  7592        CERTNOI  = PI-LAST-CERT-PRIME AND
  7593        SUFXI    = PI-LAST-CERT-SUFX
  7594         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7595         MOVE PI-LAST-CARR       TO PI-CARRIER
  7596         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7597     ELSE
  7598         MOVE ER-0207            TO EMI-ERROR
  7599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7600         MOVE -1                 TO MAINTL
  7601         GO TO 8200-SEND-DATAONLY
  7602     END-IF.
  7603
  7604     IF (NOT PI-NO-CARRIER-SECURITY OR
  7605         NOT PI-NO-ACCOUNT-SECURITY)
  7606         MOVE AL-UABON      TO  PRTOPTA
  7607         MOVE -1            TO  PRTOPTL
  7608         MOVE ER-2378       TO  EMI-ERROR
  7609         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7610         GO TO 8200-SEND-DATAONLY
  7611     END-IF.
  7612
  7613     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7614     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7615     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7616     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7617
  7618
  7619
  7620* EXEC CICS HANDLE CONDITION
  7621*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7622*    END-EXEC.
  7623*    MOVE '"$I                   ! # #00007567' TO DFHEIV0
  7624     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7626     MOVE X'2320233030303037353637' TO DFHEIV0(25:11)
  7627     CALL 'kxdfhei1' USING DFHEIV0
  7628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7629
  7630
  7631
  7632
  7633* EXEC CICS READ
  7634*         UPDATE
  7635*         DATASET    (ELACTQ-DSID)
  7636*         SET        (ADDRESS OF ACTIVITY-QUE)
  7637*         RIDFLD     (ELACTQ-KEY)
  7638*    END-EXEC.
  7639*    MOVE '&"S        EU         (   #00007572' TO DFHEIV0
  7640     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7641     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7642     MOVE X'2020233030303037353732' TO DFHEIV0(25:11)
  7643     CALL 'kxdfhei1' USING DFHEIV0,
  7644           ELACTQ-DSID,
  7645           DFHEIV20,
  7646           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 146
* EL130.cbl
  7647           ELACTQ-KEY,
  7648           DFHEIV99,
  7649           DFHEIV99,
  7650           DFHEIV99
  7651     SET ADDRESS OF ACTIVITY-QUE TO
  7652         DFHEIV20
  7653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7654
  7655
  7656     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7657     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7658
  7659
  7660
  7661* EXEC CICS REWRITE
  7662*         DATASET     (ELACTQ-DSID)
  7663*         FROM        (ACTIVITY-QUE)
  7664*    END-EXEC.
  7665     MOVE LENGTH OF
  7666      ACTIVITY-QUE
  7667       TO DFHEIV11
  7668*    MOVE '&& L                  %   #00007583' TO DFHEIV0
  7669     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7670     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7671     MOVE X'2020233030303037353833' TO DFHEIV0(25:11)
  7672     CALL 'kxdfhei1' USING DFHEIV0,
  7673           ELACTQ-DSID,
  7674           ACTIVITY-QUE,
  7675           DFHEIV11,
  7676           DFHEIV99
  7677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7678
  7679
  7680     GO TO 0470-STATUS-FINISH.
  7681
  7682 0450-ADD-ELACTQ-RECORD.
  7683
  7684
  7685* EXEC CICS GETMAIN
  7686*        SET     (ADDRESS OF ACTIVITY-QUE)
  7687*        LENGTH  (ELACTQ-LENGTH)
  7688*        INITIMG (GETMAIN-SPACE)
  7689*    END-EXEC.
  7690*    MOVE ',"IL                  $   #00007592' TO DFHEIV0
  7691     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7692     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7693     MOVE X'2020233030303037353932' TO DFHEIV0(25:11)
  7694     CALL 'kxdfhei1' USING DFHEIV0,
  7695           DFHEIV20,
  7696           ELACTQ-LENGTH,
  7697           GETMAIN-SPACE
  7698     SET ADDRESS OF ACTIVITY-QUE TO
  7699         DFHEIV20
  7700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7701
  7702
  7703     MOVE 'AQ'              TO AQ-RECORD-ID.
  7704     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 147
* EL130.cbl
  7705     MOVE +0                TO AQ-PAYMENT-COUNTER
  7706                               AQ-PMT-UNAPPROVED-COUNT.
  7707     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7708                               AQ-FOLLOWUP-DATE.
  7709     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7710     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7711
  7712
  7713
  7714* EXEC CICS WRITE
  7715*         DATASET     (ELACTQ-DSID)
  7716*         FROM        (ACTIVITY-QUE)
  7717*         RIDFLD      (ELACTQ-KEY)
  7718*    END-EXEC.
  7719     MOVE LENGTH OF
  7720      ACTIVITY-QUE
  7721       TO DFHEIV11
  7722*    MOVE '&$ L                  ''   #00007608' TO DFHEIV0
  7723     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7724     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7725     MOVE X'2020233030303037363038' TO DFHEIV0(25:11)
  7726     CALL 'kxdfhei1' USING DFHEIV0,
  7727           ELACTQ-DSID,
  7728           ACTIVITY-QUE,
  7729           DFHEIV11,
  7730           ELACTQ-KEY,
  7731           DFHEIV99,
  7732           DFHEIV99
  7733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7734
  7735
  7736 0470-STATUS-FINISH.
  7737     MOVE AL-UANOF               TO  PRTOPTA
  7738                                     ALTPRTA.
  7739
  7740     MOVE SPACES                 TO  PRTOPTO
  7741                                     ALTPRTO.
  7742
  7743     MOVE ER-0000                TO EMI-ERROR.
  7744     MOVE -1                     TO MAINTL.
  7745     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7746     GO TO 8100-SEND-INITIAL-MAP.
  7747
  7748 0480-PRINT-NOW.
  7749
  7750
  7751* EXEC CICS HANDLE CONDITION
  7752*        TERMIDERR   (8820-TERM-ERROR)
  7753*        TRANSIDERR  (8830-TRAN-ERROR)
  7754*    END-EXEC.
  7755*    MOVE '"$[\                  ! $ #00007628' TO DFHEIV0
  7756     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7758     MOVE X'2420233030303037363238' TO DFHEIV0(25:11)
  7759     CALL 'kxdfhei1' USING DFHEIV0
  7760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7761
  7762
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 148
* EL130.cbl
  7763     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7764     MOVE '1'                    TO  CNTL-REC-TYPE.
  7765     MOVE SPACES                 TO  CNTL-ACCESS.
  7766     MOVE +0                     TO  CNTL-SEQ-NO.
  7767     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7768
  7769     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7770
  7771     IF CF-FORMS-PRINTER-ID = SPACES
  7772         IF ALTPRTL NOT GREATER THAN 0
  7773             MOVE ER-0337        TO  EMI-ERROR
  7774             MOVE -1             TO  ALTPRTL
  7775             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7776             GO TO 8200-SEND-DATAONLY
  7777         END-IF
  7778     END-IF.
  7779
  7780     IF ALTPRTL GREATER THAN 0
  7781         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7782     END-IF.
  7783
  7784     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7785     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7786     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7787
  7788
  7789
  7790* EXEC CICS START
  7791*        TRANSID   (START-TRANS-ID)
  7792*        TERMID    (CF-FORMS-PRINTER-ID)
  7793*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7794*        LENGTH    (PI-COMM-LENGTH)
  7795*    END-EXEC.
  7796*    MOVE '0( LFT                1   #00007659' TO DFHEIV0
  7797     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7798     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7799     MOVE X'2020233030303037363539' TO DFHEIV0(25:11)
  7800     CALL 'kxdfhei1' USING DFHEIV0,
  7801           DFHEIV99,
  7802           START-TRANS-ID,
  7803           DFHEIV99,
  7804           PROGRAM-INTERFACE-BLOCK,
  7805           PI-COMM-LENGTH,
  7806           CF-FORMS-PRINTER-ID,
  7807           DFHEIV99,
  7808           DFHEIV99,
  7809           DFHEIV99,
  7810           DFHEIV99,
  7811           DFHEIV99,
  7812           DFHEIV99,
  7813           DFHEIV99,
  7814           DFHEIV99,
  7815           DFHEIV99,
  7816           DFHEIV99
  7817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7818
  7819
  7820     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 149
* EL130.cbl
  7821                                     ALTPRTA.
  7822
  7823     MOVE SPACES                 TO  PRTOPTO
  7824                                     ALTPRTO.
  7825
  7826     MOVE ER-0000                TO  EMI-ERROR.
  7827     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7828     MOVE -1                     TO  MAINTL.
  7829     GO TO 8100-SEND-INITIAL-MAP.
  7830
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 150
* EL130.cbl
  7832 0500-CREATE-TEMP-STORAGE.
  7833     MOVE EIBCPOSN               TO PI-CURSOR.
  7834
  7835    move emi-line1               to errmsg1o
  7836    move emi-line2               to errmsg2o
  7837    move emi-sub                 to pi-emi-sub
  7838
  7839
  7840* EXEC CICS WRITEQ TS
  7841*        QUEUE   (QID)
  7842*        FROM    (EL130AI)
  7843*        LENGTH  (QID-MAP-LENGTH)
  7844*    END-EXEC.
  7845*    MOVE '*"     L              ''   #00007685' TO DFHEIV0
  7846     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7847     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7848     MOVE X'2020233030303037363835' TO DFHEIV0(25:11)
  7849     CALL 'kxdfhei1' USING DFHEIV0,
  7850           QID,
  7851           EL130AI,
  7852           QID-MAP-LENGTH,
  7853           DFHEIV99,
  7854           DFHEIV99,
  7855           DFHEIV99
  7856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7857
  7858
  7859
  7860
  7861* EXEC CICS WRITEQ TS
  7862*        QUEUE    (QID)
  7863*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7864*        LENGTH   (PI-COMM-LENGTH)
  7865*    END-EXEC.
  7866*    MOVE '*"     L              ''   #00007692' TO DFHEIV0
  7867     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7868     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7869     MOVE X'2020233030303037363932' TO DFHEIV0(25:11)
  7870     CALL 'kxdfhei1' USING DFHEIV0,
  7871           QID,
  7872           PROGRAM-INTERFACE-BLOCK,
  7873           PI-COMM-LENGTH,
  7874           DFHEIV99,
  7875           DFHEIV99,
  7876           DFHEIV99
  7877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7878
  7879
  7880 0599-EXIT.
  7881      EXIT.
  7882
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 151
* EL130.cbl
  7884 0600-RECOVER-TEMP-STORAGE.
  7885     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7886     MOVE PI-EL127-TO-EL130-CNTRL
  7887                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7888     MOVE PI-EL659-TO-EL130-CNTRL
  7889                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7890     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7891     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7892     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7893     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7894     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7895     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7896     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7897     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7898     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7899     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7900     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7901     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7902     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7903     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7904     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7905     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7906                                 TO SAVE-BENEFICIARY
  7907
  7908
  7909
  7910* EXEC CICS HANDLE CONDITION
  7911*        NOTFND  (0660-NOT-FOUND)
  7912*        QIDERR  (0670-QIDERR)
  7913*    END-EXEC.
  7914*    MOVE '"$IN                  ! % #00007727' TO DFHEIV0
  7915     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7916     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7917     MOVE X'2520233030303037373237' TO DFHEIV0(25:11)
  7918     CALL 'kxdfhei1' USING DFHEIV0
  7919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7920
  7921
  7922
  7923
  7924* EXEC CICS READQ TS
  7925*        QUEUE    (QID)
  7926*        INTO     (EL130AI)
  7927*        LENGTH   (QID-MAP-LENGTH)
  7928*    END-EXEC.
  7929*    MOVE '*$I    L              ''   #00007733' TO DFHEIV0
  7930     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7932     MOVE X'2020233030303037373333' TO DFHEIV0(25:11)
  7933     CALL 'kxdfhei1' USING DFHEIV0,
  7934           QID,
  7935           EL130AI,
  7936           QID-MAP-LENGTH,
  7937           DFHEIV99,
  7938           DFHEIV99,
  7939           DFHEIV99
  7940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7941
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 152
* EL130.cbl
  7942
  7943     IF RETURNED-FROM = XCTL-131
  7944        IF CLAIM-DELETED-BY-EL131
  7945            MOVE LOW-VALUES      TO CERTNOI
  7946                                    SUFXI
  7947            MOVE ZEROS           TO CERTNOL
  7948                                    SUFXL
  7949         END-IF
  7950     END-IF.
  7951
  7952     IF RETURNED-FROM = XCTL-131
  7953         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7954         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7955                                    PI-CERT-PROCESSED
  7956     ELSE
  7957
  7958
  7959* EXEC CICS READQ TS
  7960*             QUEUE   (QID)
  7961*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7962*             LENGTH  (PI-COMM-LENGTH)
  7963*        END-EXEC
  7964*    MOVE '*$I    L              ''   #00007754' TO DFHEIV0
  7965     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7966     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7967     MOVE X'2020233030303037373534' TO DFHEIV0(25:11)
  7968     CALL 'kxdfhei1' USING DFHEIV0,
  7969           QID,
  7970           PROGRAM-INTERFACE-BLOCK,
  7971           PI-COMM-LENGTH,
  7972           DFHEIV99,
  7973           DFHEIV99,
  7974           DFHEIV99
  7975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7976     END-IF.
  7977
  7978
  7979* EXEC CICS DELETEQ TS
  7980*        QUEUE   (QID)
  7981*    END-EXEC.
  7982*    MOVE '*&                    #   #00007761' TO DFHEIV0
  7983     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7984     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7985     MOVE X'2020233030303037373631' TO DFHEIV0(25:11)
  7986     CALL 'kxdfhei1' USING DFHEIV0,
  7987           QID,
  7988           DFHEIV99
  7989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7990
  7991
  7992     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7993
  7994     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7995         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7996         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7997         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7998         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7999         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 153
* EL130.cbl
  8000         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  8001         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  8002         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  8003         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  8004         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  8005         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  8006         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  8007         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  8008         MOVE SAVE-CERT-ACCESS-CONTROL
  8009                                    TO PI-CERT-ACCESS-CONTROL
  8010         MOVE SAVE-CARRIER-CONTROL-LEVEL
  8011                                    TO PI-CARRIER-CONTROL-LEVEL
  8012     END-IF.
  8013
  8014*    IF EIBAID = DFHPF11
  8015*       move errmsg1i            to emi-line1
  8016*       move errmsg2i            to emi-line2
  8017*       move pi-emi-sub          to emi-sub
  8018*       go to 8200-SEND-DATAONLY
  8019*    end-if
  8020     IF RETURNED-FROM = XCTL-127
  8021         MOVE SAVE-EL127-TO-EL130-CNTRL
  8022                                 TO PI-EL127-TO-EL130-CNTRL
  8023     END-IF.
  8024
  8025     IF RETURNED-FROM = XCTL-6592
  8026        MOVE SAVE-EL659-TO-EL130-CNTRL
  8027                                 TO PI-EL659-TO-EL130-CNTRL
  8028     END-IF.
  8029
  8030     IF RETURNED-FROM = XCTL-114
  8031        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  8032           MOVE SAVE-BENEFICIARY TO BENECDI
  8033           MOVE +10              TO BENECDL
  8034           MOVE -1               TO BIRTHDTL
  8035        END-IF
  8036     END-IF.
  8037     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  8038
  8039     IF MAINTL NOT = ZERO
  8040         MOVE AL-UANON           TO MAINTA
  8041     END-IF.
  8042
  8043     IF ENTERPFL NOT = ZERO
  8044         MOVE AL-UNNON           TO ENTERPFA
  8045     END-IF.
  8046
  8047     IF RETURNED-FROM = XCTL-127
  8048         GO TO 0650-FROM-EL127
  8049     END-IF.
  8050
  8051     IF RETURNED-FROM = XCTL-132
  8052         GO TO 0640-FROM-EL132
  8053     END-IF.
  8054
  8055     IF RETURNED-FROM = XCTL-650
  8056         MOVE AL-SABON           TO PF5A
  8057         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 154
* EL130.cbl
  8058     END-IF.
  8059
  8060     IF RETURNED-FROM = XCTL-6592
  8061         GO TO 0630-FROM-EL6592
  8062     END-IF.
  8063
  8064     IF MAINTI = 'S' OR 'I'
  8065        GO TO 1000-SHOW-CLAIM
  8066     END-IF.
  8067
  8068     GO TO 8100-SEND-INITIAL-MAP.
  8069
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 155
* EL130.cbl
  8071 0630-FROM-EL6592.
  8072     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  8073     MOVE PI-EL659-GROUPING      TO GROUPO.
  8074     MOVE PI-EL659-STATE         TO STATEO.
  8075     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  8076
  8077     MOVE AL-UANON               TO CRTCARRA
  8078                                    GROUPA
  8079                                    STATEA
  8080                                    ACCOUNTA.
  8081     GO TO 8100-SEND-INITIAL-MAP.
  8082
  8083 0640-FROM-EL132.
  8084     IF PI-CLAIM-NO = SPACES
  8085         GO TO 0645-NO-CLAIM-SELECTED
  8086     END-IF.
  8087
  8088     MOVE LOW-VALUES             TO EL130AI.
  8089     MOVE 'MSTR'                 TO FILE-SWITCH.
  8090     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8091     MOVE PI-CARRIER             TO MSTR-CARRIER.
  8092     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  8093                                    CLMNOO.
  8094     MOVE AL-UANON               TO CLMNOA.
  8095     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  8096
  8097
  8098
  8099* EXEC CICS HANDLE CONDITION
  8100*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8101*    END-EXEC.
  8102*    MOVE '"$I                   ! & #00007871' TO DFHEIV0
  8103     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8105     MOVE X'2620233030303037383731' TO DFHEIV0(25:11)
  8106     CALL 'kxdfhei1' USING DFHEIV0
  8107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8108
  8109
  8110     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8111     MOVE 'X'                    TO CLAIM-SWITCH.
  8112     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8113     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8114     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8115     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8116     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8117     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8118
  8119     MOVE ER-0213                TO EMI-ERROR.
  8120     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8121     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  8122     GO TO 8100-SEND-INITIAL-MAP.
  8123
  8124 0645-NO-CLAIM-SELECTED.
  8125
  8126     IF MAINTI = 'S' OR 'I'
  8127        GO TO 1000-SHOW-CLAIM
  8128     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 156
* EL130.cbl
  8129
  8130     GO TO 8100-SEND-INITIAL-MAP.
  8131
  8132 0650-FROM-EL127.
  8133
  8134     IF PI-CERT-SELECT-CNT GREATER THAN +6
  8135         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  8136                                    PI-CERT-PROCESSED
  8137     END-IF.
  8138
  8139     IF PI-RETURN-TO-PROGRAM = XCTL-727
  8140         MOVE +1                 TO PI-CERT-SELECT-CNT
  8141                                    PI-CERT-PROCESSED
  8142         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  8143         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  8144         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  8145         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  8146         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  8147         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  8148     END-IF.
  8149
  8150     IF PI-CERT-SELECT-CNT = ZERO
  8151         IF CERTNOI NOT = SPACES AND LOW-VALUES
  8152             MOVE CERTNOI        TO PI-CERT-NO
  8153             MOVE SUFXI          TO PI-CERT-SFX
  8154             GO TO 3000-READ-CERT
  8155         ELSE
  8156             GO TO 8100-SEND-INITIAL-MAP
  8157         END-IF
  8158     END-IF.
  8159
  8160     MOVE AL-SABON               TO PF5A.
  8161
  8162     IF PI-CERT-PROCESSED = 1
  8163         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  8164     END-IF.
  8165
  8166     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  8167     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  8168
  8169     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  8170     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  8171                                 TO CERT-CARRIER
  8172                                    PI-CARRIER.
  8173     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  8174                                 TO CERT-GROUPING
  8175                                    PI-GROUPING.
  8176     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  8177                                 TO CERT-STATE
  8178                                    PI-STATE.
  8179     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8180                                 TO CERT-ACCOUNT
  8181                                    PI-ACCOUNT.
  8182     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8183                                 TO CERT-EFF-DT
  8184                                    PI-CERT-EFF-DT.
  8185     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8186                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 157
* EL130.cbl
  8187                                    PI-CERT-NO.
  8188
  8189     MOVE 'CERT'                 TO FILE-SWITCH.
  8190     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8191
  8192     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8193     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8194     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8195
  8196     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8197         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8198         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8199         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8200         IF INCURRED-DATE-MATCH
  8201             MOVE ER-7352        TO EMI-ERROR
  8202             MOVE -1             TO CERTNOL
  8203             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8204         ELSE
  8205             IF NO-CLAIMS-FOR-CERT
  8206                 MOVE ER-7353    TO EMI-ERROR
  8207                 MOVE -1         TO CERTNOL
  8208                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8209             ELSE
  8210                 MOVE ER-0558    TO EMI-ERROR
  8211                 MOVE -1         TO CERTNOL
  8212                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8213             END-IF
  8214         END-IF
  8215     END-IF.
  8216
  8217     MOVE SPACES                 TO PI-PRT-OPT
  8218                                    PI-ALT-PRT.
  8219
  8220     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8221
  8222     if (ws-lf-joint-indicator not = 'J')
  8223        and (ws-ah-joint-indicator not = 'J')
  8224        move 'P'                 to INSTYPEO
  8225        MOVE AL-UANON            TO INSTYPEA
  8226     end-if
  8227     IF LSTNMEL NOT GREATER ZERO
  8228        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8229         MOVE CRTLNMEI           TO  LSTNMEO
  8230         MOVE CRTFNMEI           TO  FSTNMEO
  8231         MOVE CRTINITI           TO  INITO
  8232         MOVE AL-UANON           TO  LSTNMEA
  8233                                     FSTNMEA
  8234                                     INITA
  8235     END-IF.
  8236
  8237     IF SSNL GREATER ZERO
  8238         GO TO 0655-SKIP-SOCIAL-SECURITY
  8239     END-IF.
  8240
  8241     IF CRTSSNI = SPACES OR LOW-VALUES
  8242         GO TO 0655-SKIP-SOCIAL-SECURITY
  8243     END-IF.
  8244
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 158
* EL130.cbl
  8245     IF CM-SSN-STATE   = CM-STATE AND
  8246        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8247            GO TO 0655-SKIP-SOCIAL-SECURITY
  8248     END-IF.
  8249
  8250     MOVE CRTSSNI                TO SSNO
  8251     MOVE AL-UANON               TO SSNA.
  8252
  8253 0655-SKIP-SOCIAL-SECURITY.
  8254
  8255     IF CLMCARRL NOT = ZERO  AND
  8256        CLMCARRI NOT = CRTCARRI
  8257        MOVE ER-0562             TO EMI-ERROR
  8258        MOVE AL-UABON            TO CLMCARRA
  8259        MOVE -1                  TO CLMCARRL
  8260        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8261     END-IF.
  8262
  8263     IF CLMCARRL = ZERO
  8264        MOVE AL-UANON            TO CLMCARRA
  8265        MOVE CRTCARRI            TO CLMCARRI
  8266     END-IF.
  8267
  8268     MOVE 'A'                    TO MAINTO.
  8269     MOVE AL-UANON               TO MAINTA.
  8270
  8271     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8272        GO TO 8100-SEND-INITIAL-MAP
  8273     ELSE
  8274        GO TO 8150-SEND-MAP-CURSOR
  8275     END-IF.
  8276
  8277 0660-NOT-FOUND.
  8278     MOVE ER-0214                TO EMI-ERROR.
  8279     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8280     GO TO 8100-SEND-INITIAL-MAP.
  8281
  8282 0670-QIDERR.
  8283     MOVE ER-0033                TO EMI-ERROR.
  8284     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8285     GO TO 8100-SEND-INITIAL-MAP.
  8286
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 159
* EL130.cbl
  8288 0680-PLUG-SELECTED-CERTS.
  8289
  8290     MOVE AL-SANON               TO BCERT1A
  8291                                    BSUFX1A
  8292                                    BCERT2A
  8293                                    BSUFX2A
  8294                                    BCERT3A
  8295                                    BSUFX3A
  8296                                    BCERT4A
  8297                                    BSUFX4A
  8298                                    BCERT5A
  8299                                    BSUFX5A.
  8300
  8301     IF PCERTNOO = SPACES OR LOW-VALUES
  8302         MOVE PI-EL127-CERT-PRIME (1)
  8303                                 TO PCERTNOO
  8304         MOVE PI-EL127-CERT-SUFX  (1)
  8305                                 TO PSUFXO
  8306     END-IF.
  8307
  8308     MOVE PI-EL127-CERT-PRIME (1)
  8309                                 TO BCERT1O.
  8310     MOVE PI-EL127-CERT-SUFX  (1)
  8311                                 TO BSUFX1O.
  8312
  8313     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8314         MOVE PI-EL127-CERT-PRIME (2)
  8315                                 TO BCERT2O
  8316         MOVE PI-EL127-CERT-SUFX  (2)
  8317                                 TO BSUFX2O
  8318     ELSE
  8319         MOVE LOW-VALUES         TO BCERT2O
  8320                                    BSUFX2O
  8321     END-IF.
  8322
  8323     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8324         MOVE PI-EL127-CERT-PRIME (3)
  8325                                 TO BCERT3O
  8326         MOVE PI-EL127-CERT-SUFX  (3)
  8327                                 TO BSUFX3O
  8328     ELSE
  8329         MOVE LOW-VALUES         TO BCERT3O
  8330                                    BSUFX3O
  8331     END-IF.
  8332
  8333     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8334         MOVE PI-EL127-CERT-PRIME (4)
  8335                                 TO BCERT4O
  8336         MOVE PI-EL127-CERT-SUFX  (4)
  8337                                 TO BSUFX4O
  8338     ELSE
  8339         MOVE LOW-VALUES         TO BCERT4O
  8340                                    BSUFX4O
  8341     END-IF.
  8342
  8343     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8344         MOVE PI-EL127-CERT-PRIME (5)
  8345                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 160
* EL130.cbl
  8346         MOVE PI-EL127-CERT-SUFX  (5)
  8347                                 TO BSUFX5O
  8348     ELSE
  8349         MOVE LOW-VALUES         TO BCERT5O
  8350                                    BSUFX5O
  8351     END-IF.
  8352
  8353 0680-EXIT.
  8354     EXIT.
  8355
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 161
* EL130.cbl
  8357 0690-HIGHLIGHT-CERTS.
  8358
  8359     MOVE AL-UANON               TO PCERTNOA
  8360                                    PSUFXA.
  8361
  8362     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8363        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8364            MOVE AL-SABON        TO BCERT1A
  8365                                    BSUFX1A
  8366     ELSE
  8367         MOVE AL-SANON           TO BCERT1A
  8368                                    BSUFX1A
  8369     END-IF.
  8370
  8371     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8372        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8373            MOVE AL-SABON        TO BCERT2A
  8374                                    BSUFX2A
  8375     ELSE
  8376         MOVE AL-SANON           TO BCERT2A
  8377                                    BSUFX2A
  8378     END-IF.
  8379
  8380     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8381        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8382            MOVE AL-SABON        TO BCERT3A
  8383                                    BSUFX3A
  8384     ELSE
  8385         MOVE AL-SANON           TO BCERT3A
  8386                                    BSUFX3A
  8387     END-IF.
  8388
  8389     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8390        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8391            MOVE AL-SABON        TO BCERT4A
  8392                                    BSUFX4A
  8393     ELSE
  8394         MOVE AL-SANON           TO BCERT4A
  8395                                    BSUFX4A
  8396     END-IF.
  8397
  8398     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8399        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8400            MOVE AL-SABON        TO BCERT5A
  8401                                    BSUFX5A
  8402     ELSE
  8403         MOVE AL-SANON           TO BCERT5A
  8404                                    BSUFX5A
  8405     END-IF.
  8406
  8407 0690-EXIT.
  8408     EXIT.
  8409
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 162
* EL130.cbl
  8411 0800-TEST-PREVIOUS-CONTROL.
  8412     IF CLMNOI   = PI-LAST-CLAIM       AND
  8413        CLMCARRI = PI-LAST-CARR        AND
  8414        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8415        SUFXI    = PI-LAST-CERT-SUFX
  8416*        NEXT SENTENCE
  8417         CONTINUE
  8418     ELSE
  8419         MOVE ER-0207            TO EMI-ERROR
  8420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8421         MOVE -1                 TO MAINTL
  8422         GO TO 8200-SEND-DATAONLY
  8423     END-IF.
  8424
  8425     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8426
  8427     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8428     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8429     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8430
  8431     IF EIBAID = DFHPF7
  8432         MOVE XCTL-157           TO PGM-NAME
  8433     END-IF.
  8434
  8435     IF EIBAID = DFHPF8
  8436         MOVE XCTL-141           TO PGM-NAME
  8437     END-IF.
  8438
  8439     IF EIBAID = DFHPF9
  8440        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8441                                    PI-SAVED-PROGRAM-2
  8442                                    PI-SAVED-PROGRAM-3
  8443                                    PI-SAVED-PROGRAM-4
  8444                                    PI-SAVED-PROGRAM-5
  8445                                    PI-SAVED-PROGRAM-6
  8446        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8447        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8448        MOVE XCTL-150            TO PGM-NAME
  8449     END-IF.
  8450
  8451     GO TO 9300-XCTL.
  8452
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 163
* EL130.cbl
  8454 1000-SHOW-CLAIM.
  8455
  8456     IF CLMNOL = ZERO
  8457         MOVE -1                 TO CLMNOL
  8458         MOVE AL-UABON           TO CLMNOA
  8459         MOVE ER-0202            TO EMI-ERROR
  8460         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8461     ELSE
  8462         MOVE AL-UANON           TO CLMNOA
  8463     END-IF.
  8464
  8465     IF PI-NO-CARRIER-SECURITY
  8466        IF CLMCARRL = ZERO
  8467             MOVE -1             TO CLMCARRL
  8468             MOVE AL-UABON       TO CLMCARRA
  8469             MOVE ER-0194        TO EMI-ERROR
  8470             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8471         ELSE
  8472             MOVE AL-UANON       TO CLMCARRA
  8473         END-IF
  8474     END-IF.
  8475
  8476     IF SUFXL = ZERO
  8477         MOVE SPACES             TO SUFXI
  8478         MOVE AL-UANON           TO SUFXA
  8479     ELSE
  8480         MOVE AL-UANON           TO SUFXA
  8481     END-IF.
  8482
  8483     IF NOT EMI-NO-ERRORS
  8484         GO TO 1050-SEND-CHECK
  8485     END-IF.
  8486
  8487
  8488
  8489* EXEC CICS HANDLE CONDITION
  8490*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8491*    END-EXEC.
  8492*    MOVE '"$I                   ! '' #00008253' TO DFHEIV0
  8493     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8494     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8495     MOVE X'2720233030303038323533' TO DFHEIV0(25:11)
  8496     CALL 'kxdfhei1' USING DFHEIV0
  8497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8498
  8499
  8500     MOVE 'MSTR'                 TO FILE-SWITCH
  8501     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8502
  8503     MOVE CLMCARRI               TO MSTR-CARRIER.
  8504     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8505
  8506     IF CERTNOL = ZERO     OR
  8507        CERTNOI = SPACES   OR
  8508        CERTNOI = LOW-VALUES
  8509         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8510         MOVE AL-SANON        TO CERTNOA
  8511                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 164
* EL130.cbl
  8512     ELSE
  8513         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8514     END-IF.
  8515
  8516     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8517     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8518
  8519
  8520
  8521* EXEC CICS HANDLE CONDITION
  8522*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8523*    END-EXEC.
  8524*    MOVE '"$I                   ! ( #00008277' TO DFHEIV0
  8525     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8527     MOVE X'2820233030303038323737' TO DFHEIV0(25:11)
  8528     CALL 'kxdfhei1' USING DFHEIV0
  8529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8530
  8531
  8532     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8533
  8534     IF NOT PI-NO-ACCOUNT-SECURITY
  8535         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8536           MOVE ER-2371          TO EMI-ERROR
  8537           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8538           MOVE -1               TO MAINTL
  8539           GO TO 8200-SEND-DATAONLY
  8540         END-IF
  8541     END-IF.
  8542
  8543
  8544
  8545* EXEC CICS HANDLE CONDITION
  8546*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8547*    END-EXEC.
  8548*    MOVE '"$I                   ! ) #00008293' TO DFHEIV0
  8549     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8551     MOVE X'2920233030303038323933' TO DFHEIV0(25:11)
  8552     CALL 'kxdfhei1' USING DFHEIV0
  8553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8554
  8555
  8556     MOVE 'Y'                    TO CLAIM-SWITCH.
  8557     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8558     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8559     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8560     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8561     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8562
  8563 1000-SHOW-END-OF-PERFORM.
  8564
  8565     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8566     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8567     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8568     MOVE CL-CERT-STATE          TO CERT-STATE.
  8569     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 165
* EL130.cbl
  8570     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8571     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8572
  8573     MOVE 'CERT'                 TO FILE-SWITCH.
  8574
  8575     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8576
  8577     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8578     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8579     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8580     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8581     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8582     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8583     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8584     MOVE CLMCARRI               TO PI-LAST-CARR.
  8585
  8586     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8587
  8588     IF MAINTI = 'I'
  8589         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8590                 BIRTHDTA  LSTNMEA   RELCLMA
  8591                 LOANNOA   LOANBALA  BENECDA
  8592         MOVE AL-SANON TO  SSNA
  8593         MOVE SPACES   TO  INCURI    REPORTI
  8594         MOVE 'Y'      TO PI-INCURR-SW
  8595         MOVE ER-0522  TO EMI-ERROR
  8596         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8597     ELSE
  8598         MOVE ' '      TO PI-INCURR-SW
  8599     END-IF.
  8600
  8601     MOVE -1                     TO MAINTL.
  8602     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8603     MOVE CERT-GROUPING          TO PI-GROUPING.
  8604     MOVE CERT-STATE             TO PI-STATE.
  8605     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8606     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8607     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8608     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8609
  8610     IF RETURNED-FROM NOT = SPACES
  8611         GO TO 8100-SEND-INITIAL-MAP
  8612     ELSE
  8613         GO TO 8200-SEND-DATAONLY
  8614     END-IF.
  8615
  8616 1025-SHOW-RECORD-NOT-FOUND.
  8617
  8618     IF FILE-SWITCH = 'MSTR'
  8619         MOVE ER-0204            TO EMI-ERROR
  8620     ELSE
  8621         IF FILE-SWITCH = 'TRLR'
  8622             MOVE ER-0205        TO EMI-ERROR
  8623         ELSE
  8624             MOVE ER-0206        TO EMI-ERROR
  8625         END-IF
  8626     END-IF.
  8627
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 166
* EL130.cbl
  8628     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8629
  8630 1050-SEND-CHECK.
  8631
  8632     IF RETURNED-FROM NOT = SPACES
  8633         GO TO 8100-SEND-INITIAL-MAP
  8634     ELSE
  8635         MOVE -1                 TO MAINTL
  8636         GO TO 8200-SEND-DATAONLY
  8637     END-IF.
  8638
  8639 2000-DELETE-CLAIM.
  8640     IF NOT MODIFY-CAP
  8641         MOVE ER-0070            TO EMI-ERROR
  8642         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8643         MOVE -1                 TO MAINTL
  8644         GO TO 8200-SEND-DATAONLY
  8645     END-IF.
  8646
  8647     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8648        CLMCARRI NOT = PI-LAST-CARR        OR
  8649        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8650        SUFXI    NOT = PI-LAST-CERT-SUFX
  8651         MOVE ER-0207            TO EMI-ERROR
  8652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8653         MOVE -1                 TO MAINTL
  8654         GO TO 8200-SEND-DATAONLY
  8655     END-IF.
  8656
  8657
  8658
  8659* EXEC CICS HANDLE CONDITION
  8660*        NOTFND   (2050-DELETE-NOT-FOUND)
  8661*    END-EXEC.
  8662*    MOVE '"$I                   ! * #00008399' TO DFHEIV0
  8663     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8665     MOVE X'2A20233030303038333939' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0
  8667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8668
  8669
  8670     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8671
  8672     MOVE CLMCARRI               TO MSTR-CARRIER.
  8673     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8674     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8675     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8676
  8677     MOVE 'MSTR'                 TO FILE-SWITCH.
  8678     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8679
  8680     MOVE 'Y'                    TO CLAIM-SWITCH.
  8681
  8682     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8683        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8684         MOVE ER-0068        TO EMI-ERROR
  8685         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 167
* EL130.cbl
  8686         MOVE -1             TO MAINTL
  8687         GO TO 8200-SEND-DATAONLY
  8688     END-IF.
  8689
  8690     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8691         MOVE ER-0569            TO EMI-ERROR
  8692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8693         MOVE -1                 TO MAINTL
  8694         GO TO 8200-SEND-DATAONLY
  8695     END-IF.
  8696
  8697     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8698         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8699     END-IF.
  8700
  8701     IF CL-PURGED-DT NOT = LOW-VALUES
  8702         MOVE ER-7691            TO EMI-ERROR
  8703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8704         MOVE -1                 TO MAINTL
  8705         GO TO 8200-SEND-DATAONLY
  8706     END-IF.
  8707
  8708     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8709     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8710     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8711     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8712     MOVE +0                     TO TRLR-SEQ-NO.
  8713     MOVE '1'                    TO TRLR-TYPE.
  8714
  8715     MOVE 'TRLR'                 TO FILE-SWITCH.
  8716
  8717
  8718
  8719* EXEC CICS READ
  8720*        UPDATE
  8721*        DATASET  (ELTRLR-DSID)
  8722*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8723*        RIDFLD   (ELTRLR-KEY)
  8724*    END-EXEC.
  8725*    MOVE '&"S        EU         (   #00008451' TO DFHEIV0
  8726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8727     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8728     MOVE X'2020233030303038343531' TO DFHEIV0(25:11)
  8729     CALL 'kxdfhei1' USING DFHEIV0,
  8730           ELTRLR-DSID,
  8731           DFHEIV20,
  8732           DFHEIV99,
  8733           ELTRLR-KEY,
  8734           DFHEIV99,
  8735           DFHEIV99,
  8736           DFHEIV99
  8737     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8738         DFHEIV20
  8739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8740
  8741
  8742     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8743        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 168
* EL130.cbl
  8744         MOVE ER-0068        TO EMI-ERROR
  8745         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8746         MOVE -1             TO MAINTL
  8747         GO TO 8200-SEND-DATAONLY
  8748     END-IF.
  8749
  8750
  8751
  8752* EXEC CICS DELETE
  8753*        DATASET   (ELTRLR-DSID)
  8754*    END-EXEC.
  8755*    MOVE '&(                    &   #00008467' TO DFHEIV0
  8756     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8757     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8758     MOVE X'2020233030303038343637' TO DFHEIV0(25:11)
  8759     CALL 'kxdfhei1' USING DFHEIV0,
  8760           ELTRLR-DSID,
  8761           DFHEIV99,
  8762           DFHEIV99,
  8763           DFHEIV99,
  8764           DFHEIV99
  8765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8766
  8767
  8768     MOVE +90                    TO TRLR-SEQ-NO.
  8769     MOVE '6'                    TO TRLR-TYPE.
  8770
  8771
  8772
  8773* EXEC CICS READ
  8774*        UPDATE
  8775*        DATASET  (ELTRLR-DSID)
  8776*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8777*        RIDFLD   (ELTRLR-KEY)
  8778*    END-EXEC.
  8779*    MOVE '&"S        EU         (   #00008475' TO DFHEIV0
  8780     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8781     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8782     MOVE X'2020233030303038343735' TO DFHEIV0(25:11)
  8783     CALL 'kxdfhei1' USING DFHEIV0,
  8784           ELTRLR-DSID,
  8785           DFHEIV20,
  8786           DFHEIV99,
  8787           ELTRLR-KEY,
  8788           DFHEIV99,
  8789           DFHEIV99,
  8790           DFHEIV99
  8791     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8792         DFHEIV20
  8793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8794
  8795
  8796
  8797
  8798* EXEC CICS DELETE
  8799*        DATASET   (ELTRLR-DSID)
  8800*    END-EXEC.
  8801*    MOVE '&(                    &   #00008483' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 169
* EL130.cbl
  8802     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8803     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8804     MOVE X'2020233030303038343833' TO DFHEIV0(25:11)
  8805     CALL 'kxdfhei1' USING DFHEIV0,
  8806           ELTRLR-DSID,
  8807           DFHEIV99,
  8808           DFHEIV99,
  8809           DFHEIV99,
  8810           DFHEIV99
  8811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8812
  8813
  8814     MOVE +91                    TO TRLR-SEQ-NO.
  8815     MOVE '6'                    TO TRLR-TYPE.
  8816
  8817
  8818
  8819* EXEC CICS READ
  8820*        UPDATE
  8821*        DATASET  (ELTRLR-DSID)
  8822*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8823*        RIDFLD   (ELTRLR-KEY)
  8824*        RESP     (WS-RESPONSE)
  8825*    END-EXEC
  8826*    MOVE '&"S        EU         (  N#00008491' TO DFHEIV0
  8827     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8828     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8829     MOVE X'204E233030303038343931' TO DFHEIV0(25:11)
  8830     CALL 'kxdfhei1' USING DFHEIV0,
  8831           ELTRLR-DSID,
  8832           DFHEIV20,
  8833           DFHEIV99,
  8834           ELTRLR-KEY,
  8835           DFHEIV99,
  8836           DFHEIV99,
  8837           DFHEIV99
  8838     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8839         DFHEIV20
  8840     MOVE EIBRESP  TO WS-RESPONSE
  8841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8842
  8843     IF WS-RESP-NORMAL
  8844
  8845* EXEC CICS DELETE
  8846*          DATASET   (ELTRLR-DSID)
  8847*       END-EXEC
  8848*    MOVE '&(                    &   #00008500' TO DFHEIV0
  8849     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8850     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8851     MOVE X'2020233030303038353030' TO DFHEIV0(25:11)
  8852     CALL 'kxdfhei1' USING DFHEIV0,
  8853           ELTRLR-DSID,
  8854           DFHEIV99,
  8855           DFHEIV99,
  8856           DFHEIV99,
  8857           DFHEIV99
  8858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8859     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 170
* EL130.cbl
  8860
  8861     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8862     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8863     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8864     MOVE CL-CERT-STATE          TO CERT-STATE.
  8865     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8866     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8867     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8868
  8869     MOVE 'CERT'                 TO FILE-SWITCH.
  8870
  8871     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8872
  8873     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8874
  8875     IF WS-NUM-HOLD NOT = +0
  8876         GO TO 2005-REWRITE-CERT
  8877     END-IF.
  8878
  8879     IF NOT CERT-WAS-CREATED
  8880         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8881         GO TO 2005-REWRITE-CERT
  8882     END-IF.
  8883
  8884
  8885
  8886* EXEC CICS DELETE
  8887*        DATASET   (ELCERT-DSID)
  8888*    END-EXEC.
  8889*    MOVE '&(                    &   #00008529' TO DFHEIV0
  8890     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8891     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8892     MOVE X'2020233030303038353239' TO DFHEIV0(25:11)
  8893     CALL 'kxdfhei1' USING DFHEIV0,
  8894           ELCERT-DSID,
  8895           DFHEIV99,
  8896           DFHEIV99,
  8897           DFHEIV99,
  8898           DFHEIV99
  8899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8900
  8901
  8902     GO TO 2010-DELETE-CL.
  8903
  8904 2005-REWRITE-CERT.
  8905
  8906     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8907
  8908
  8909
  8910* EXEC CICS HANDLE CONDITION
  8911*         DUPKEY   (2010-DELETE-CL)
  8912*    END-EXEC.
  8913*    MOVE '"$$                   ! + #00008540' TO DFHEIV0
  8914     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8915     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8916     MOVE X'2B20233030303038353430' TO DFHEIV0(25:11)
  8917     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 171
* EL130.cbl
  8918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8919
  8920
  8921
  8922
  8923* EXEC CICS REWRITE
  8924*        DATASET  (ELCERT-DSID)
  8925*        FROM     (CERTIFICATE-MASTER)
  8926*    END-EXEC.
  8927     MOVE LENGTH OF
  8928      CERTIFICATE-MASTER
  8929       TO DFHEIV11
  8930*    MOVE '&& L                  %   #00008545' TO DFHEIV0
  8931     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8932     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8933     MOVE X'2020233030303038353435' TO DFHEIV0(25:11)
  8934     CALL 'kxdfhei1' USING DFHEIV0,
  8935           ELCERT-DSID,
  8936           CERTIFICATE-MASTER,
  8937           DFHEIV11,
  8938           DFHEIV99
  8939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8940
  8941
  8942 2010-DELETE-CL.
  8943
  8944
  8945
  8946* EXEC CICS DELETE
  8947*        DATASET  (ELMSTR-DSID)
  8948*    END-EXEC.
  8949*    MOVE '&(                    &   #00008553' TO DFHEIV0
  8950     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8951     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8952     MOVE X'2020233030303038353533' TO DFHEIV0(25:11)
  8953     CALL 'kxdfhei1' USING DFHEIV0,
  8954           ELMSTR-DSID,
  8955           DFHEIV99,
  8956           DFHEIV99,
  8957           DFHEIV99,
  8958           DFHEIV99
  8959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8960
  8961
  8962     MOVE -1                     TO ONE-OR-MIN1.
  8963     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8964
  8965     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8966         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8967                                    WS-SAVE-CLAIM-KEY
  8968         MOVE +1                 TO ONE-OR-MIN1
  8969         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8970     END-IF.
  8971
  8972     MOVE ER-0000                TO EMI-ERROR.
  8973     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8974     MOVE LOW-VALUES             TO EL130AO.
  8975     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 172
* EL130.cbl
  8976     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8977     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8978                                    PI-CERT-PROCESSED
  8979                                    PI-LETTER-ERROR-CODE.
  8980     GO TO 8100-SEND-INITIAL-MAP.
  8981
  8982 2050-DELETE-NOT-FOUND.
  8983     IF FILE-SWITCH = 'MSTR'
  8984         MOVE -1                 TO CLMNOL
  8985         MOVE ER-0204            TO EMI-ERROR
  8986     ELSE
  8987         IF FILE-SWITCH = 'TRLR'
  8988             MOVE -1             TO MAINTL
  8989             MOVE ER-0205        TO EMI-ERROR
  8990         ELSE
  8991             MOVE -1             TO CERTNOL
  8992             MOVE ER-0206        TO EMI-ERROR
  8993         END-IF
  8994     END-IF.
  8995
  8996     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8997     GO TO 8200-SEND-DATAONLY.
  8998
  8999 3000-ADD-CLAIM.
  9000     IF NOT MODIFY-CAP
  9001         MOVE ER-0070            TO EMI-ERROR
  9002         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9003         MOVE -1                 TO MAINTL
  9004         GO TO 8200-SEND-DATAONLY
  9005     END-IF.
  9006
  9007     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  9008
  9009     IF CERTMTI = 'S'
  9010         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  9011            SUFXI    = PI-SAVE-CERT-SUFX   AND
  9012            WS-EFFDT = PI-SAVE-EFFDT       AND
  9013            ACCOUNTI = PI-SAVE-ACCOUNT
  9014             IF EMI-ERROR = 0
  9015                 GO TO 3010-TEST-FOR-ERRORS
  9016             ELSE
  9017                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  9018                 MOVE PI-CARRIER       TO  CERT-CARRIER
  9019                 MOVE PI-GROUPING      TO  CERT-GROUPING
  9020                 MOVE PI-STATE         TO  CERT-STATE
  9021                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  9022                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  9023                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  9024
  9025
  9026* EXEC CICS HANDLE CONDITION
  9027*                    NOTFND   (3010-TEST-FOR-ERRORS)
  9028*                END-EXEC
  9029*    MOVE '"$I                   ! , #00008620' TO DFHEIV0
  9030     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9031     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9032     MOVE X'2C20233030303038363230' TO DFHEIV0(25:11)
  9033     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 173
* EL130.cbl
  9034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9035                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  9036                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  9037                 GO TO 3010-TEST-FOR-ERRORS
  9038             END-IF
  9039         END-IF
  9040     END-IF.
  9041
  9042     IF CERTMTI = 'A'
  9043         IF NOT PI-NO-CARRIER-SECURITY OR
  9044             NOT PI-NO-ACCOUNT-SECURITY
  9045             MOVE ER-2370          TO EMI-ERROR
  9046             MOVE -1               TO MAINTL
  9047             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9048             GO TO 8200-SEND-DATAONLY
  9049         ELSE
  9050             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  9051             GO TO 3010-TEST-FOR-ERRORS
  9052         END-IF
  9053     END-IF.
  9054
  9055     IF CERTNOL = ZEROS
  9056        GO TO 3010-TEST-FOR-ERRORS
  9057     END-IF.
  9058
  9059 3000-READ-CERT.
  9060
  9061     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  9062                                    MSTR5-COMP-CD.
  9063     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  9064                                    MSTR5-CERT-NO-PRIME.
  9065     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  9066                                    MSTR5-CERT-NO-SUFX.
  9067
  9068
  9069
  9070* EXEC CICS HANDLE CONDITION
  9071*         DUPKEY   (3008-DUP-ERROR)
  9072*         NOTFND   (3009-NOT-FOUND)
  9073*    END-EXEC
  9074*    MOVE '"$$I                  ! - #00008657' TO DFHEIV0
  9075     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  9076     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9077     MOVE X'2D20233030303038363537' TO DFHEIV0(25:11)
  9078     CALL 'kxdfhei1' USING DFHEIV0
  9079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9080
  9081     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  9082
  9083     IF NOT PI-NO-ACCOUNT-SECURITY
  9084         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  9085             MOVE ER-2371          TO EMI-ERROR
  9086             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9087             MOVE -1               TO MAINTL
  9088             GO TO 8200-SEND-DATAONLY
  9089         END-IF
  9090     END-IF.
  9091
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 174
* EL130.cbl
  9092     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  9093     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  9094     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  9095     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  9096     MOVE CM-CARRIER             TO PI-CARRIER.
  9097     MOVE CM-GROUPING            TO PI-GROUPING.
  9098     MOVE CM-STATE               TO PI-STATE.
  9099     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  9100     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  9101     MOVE CM-CERT-NO             TO PI-CERT-NO.
  9102     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  9103
  9104     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  9105         IF LSTNMEO = SPACES OR LOW-VALUES
  9106             MOVE CRTLNMEI       TO  LSTNMEO
  9107             MOVE AL-UANON       TO  LSTNMEA
  9108         END-IF
  9109     END-IF.
  9110
  9111     MOVE 'S'                    TO CERTMTO.
  9112*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  9113     MOVE AL-SANON               TO CERTNOA.
  9114     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  9115                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  9116     IF EMI-NO-ERRORS
  9117         MOVE -1                  TO MAINTL
  9118     END-IF.
  9119
  9120     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9121         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9122         IF INCURRED-DATE-MATCH
  9123             MOVE ER-7352         TO EMI-ERROR
  9124             MOVE -1              TO CERTNOL
  9125             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9126         ELSE
  9127             IF NO-CLAIMS-FOR-CERT
  9128                 MOVE ER-7353     TO EMI-ERROR
  9129                 MOVE -1          TO CERTNOL
  9130                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9131             ELSE
  9132                 MOVE ER-0558     TO EMI-ERROR
  9133                 MOVE -1          TO CERTNOL
  9134                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9135                 GO TO 3010-TEST-FOR-ERRORS
  9136             END-IF
  9137         END-IF
  9138     END-IF.
  9139
  9140 3007-SEND-SCREEN.
  9141     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9142         GO TO 8150-SEND-MAP-CURSOR
  9143     ELSE
  9144         GO TO 8200-SEND-DATAONLY
  9145     END-IF.
  9146
  9147 3008-DUP-ERROR.
  9148     MOVE ER-0560                TO EMI-ERROR.
  9149     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 175
* EL130.cbl
  9150     MOVE -1                     TO CERTNOL.
  9151     GO TO 3007-SEND-SCREEN.
  9152
  9153 3009-NOT-FOUND.
  9154     MOVE ER-0214                TO EMI-ERROR.
  9155     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9156     MOVE -1                     TO CERTNOL.
  9157     GO TO 3007-SEND-SCREEN.
  9158
  9159 3010-TEST-FOR-ERRORS.
  9160
  9161     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  9162     perform 6500-get-acct    thru 6500-exit
  9163     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  9164*     perform 6500-get-acct    thru 6500-exit
  9165
  9166     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  9167     move +0                     to e1
  9168     move spaces                 to ws-dcc-error-line
  9169     move ' '                    to ws-zero-bens-avail
  9170
  9171     if ws-dcc-product-code not = spaces
  9172        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  9173        IF ERPDEF-FOUND
  9174           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9175           MOVE WS-INCUR         TO DC-BIN-DATE-2
  9176           MOVE '1'              TO DC-OPTION-CODE
  9177           MOVE +0               TO DC-ELAPSED-MONTHS
  9178                                    DC-ELAPSED-DAYS
  9179           PERFORM 9700-LINK-DATE-CONVERT
  9180                                 THRU 9700-EXIT
  9181           IF NO-CONVERSION-ERROR
  9182              MOVE DC-ELAPSED-MONTHS
  9183                                 TO WS-MONTHS-BETWEEN
  9184              IF DC-ELAPSED-DAYS > 1
  9185                 ADD 1 TO WS-MONTHS-BETWEEN
  9186              END-IF
  9187           ELSE
  9188              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9189           END-IF
  9190
  9191           evaluate true
  9192              when (ws-excl-period not = zeros)
  9193                 and (ws-months-between <= ws-excl-period)
  9194                 MOVE -1         TO MAINTL
  9195                 add +1          to e1
  9196                 move 'Y'        to ws-zero-bens-avail
  9197                 MOVE ER-1651    TO EMI-ERROR
  9198                                    ws-error-no (e1)
  9199                 PERFORM 9900-ERROR-FORMAT
  9200                                 THRU 9900-EXIT
  9201              when (ws-cov-ends not = zeros)
  9202                 and (ws-months-between > ws-cov-ends)
  9203                 MOVE -1         TO MAINTL
  9204                 add +1          to e1
  9205                 move 'Y'        to ws-zero-bens-avail
  9206                 MOVE ER-1653    TO EMI-ERROR
  9207                                    ws-error-no (e1)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 176
* EL130.cbl
  9208                 evaluate true
  9209                    when clmtypei = 'L'
  9210                       move '  LF  ' to emi-claim-type
  9211                    when clmtypei = 'I'
  9212                       move '  IU  ' to emi-claim-type
  9213                    when clmtypei = 'F'
  9214                       move '  FL  ' to emi-claim-type
  9215                    when other
  9216                       move '  AH  ' to emi-claim-type
  9217                 end-evaluate
  9218                 PERFORM 9900-ERROR-FORMAT
  9219                                 THRU 9900-EXIT
  9220              when (ws-acc-period not = zeros)
  9221                 and (ws-months-between <= ws-acc-period)
  9222                 MOVE -1         TO MAINTL
  9223                 add +1          to e1
  9224                 MOVE ER-1652    TO EMI-ERROR
  9225                                    ws-error-no (e1)
  9226                 PERFORM 9900-ERROR-FORMAT
  9227                                 THRU 9900-EXIT
  9228                 add +1          to e1
  9229                 move er-1655    to emi-error
  9230                                    ws-error-no (e1)
  9231                 PERFORM 9900-ERROR-FORMAT
  9232                                 THRU 9900-EXIT
  9233              when clmtypei = 'I'
  9234                 add +1          to e1
  9235                 move er-1661    to emi-error
  9236                                    ws-error-no (e1)
  9237                 PERFORM 9900-ERROR-FORMAT
  9238                                 THRU 9900-EXIT
  9239           end-evaluate
  9240           IF (WS-PRE-EXISTING-PER NOT = ZEROS)
  9241              AND (WS-MONTHS-BETWEEN <= WS-PRE-EXISTING-PER)
  9242              MOVE -1         TO MAINTL
  9243              ADD +1          TO E1
  9244              MOVE ER-1677    TO EMI-ERROR
  9245                                 WS-ERROR-NO (E1)
  9246              PERFORM 9900-ERROR-FORMAT
  9247                              THRU 9900-EXIT
  9248           END-IF
  9249        END-IF
  9250*       perform 3996-read-cert-claim-trailer
  9251*                                thru 3996-exit
  9252     END-IF
  9253     perform 3996-read-cert-claim-trailer
  9254                                 thru 3996-exit
  9255     IF CERTMTI NOT = 'A'
  9256         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9257             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9258             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9259             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9260             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9261             IF INCURRED-DATE-MATCH
  9262                 MOVE ER-7352         TO EMI-ERROR
  9263                 MOVE -1              TO CERTNOL
  9264                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9265             ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 177
* EL130.cbl
  9266                 IF NO-CLAIMS-FOR-CERT
  9267                     MOVE ER-7353     TO EMI-ERROR
  9268                     MOVE -1          TO CERTNOL
  9269                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9270                 ELSE
  9271                     MOVE ER-0558     TO EMI-ERROR
  9272                     MOVE -1          TO CERTNOL
  9273                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9274                 END-IF
  9275             END-IF
  9276         END-IF
  9277     END-IF.
  9278
  9279     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9280         MOVE ER-0433             TO EMI-ERROR
  9281         MOVE -1                  TO MAINTL
  9282         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9283         GO TO 8200-SEND-DATAONLY
  9284     END-IF.
  9285
  9286     IF (EMI-NO-ERRORS)
  9287        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9288         GO TO 3015-TRY-TO-BUILD
  9289     END-IF.
  9290
  9291     IF EIBAID = DFHPF6
  9292         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9293             MOVE ER-0434         TO EMI-ERROR
  9294             MOVE -1              TO MAINTL
  9295             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9296             GO TO 8200-SEND-DATAONLY
  9297         ELSE
  9298             MOVE +1              TO INCURL
  9299             GO TO 3015-TRY-TO-BUILD
  9300         END-IF
  9301     END-IF.
  9302
  9303     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9304         GO TO 8150-SEND-MAP-CURSOR
  9305     ELSE
  9306         GO TO 8200-SEND-DATAONLY
  9307     END-IF.
  9308
  9309 3015-TRY-TO-BUILD.
  9310     IF CLMNOL EQUAL ZERO
  9311         GO TO 3030-BUILD-CONT
  9312     END-IF.
  9313
  9314
  9315
  9316* EXEC CICS HANDLE CONDITION
  9317*        NOTFND   (3030-BUILD-CONT)
  9318*    END-EXEC.
  9319*    MOVE '"$I                   ! . #00008896' TO DFHEIV0
  9320     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9322     MOVE X'2E20233030303038383936' TO DFHEIV0(25:11)
  9323     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 178
* EL130.cbl
  9324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9325
  9326
  9327     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9328
  9329     MOVE CLMCARRI               TO MSTR-CARRIER.
  9330     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9331     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9332     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9333
  9334     MOVE 'MSTR'                 TO FILE-SWITCH.
  9335
  9336     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9337
  9338     MOVE ER-0221                TO EMI-ERROR.
  9339
  9340     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9341     MOVE -1                     TO MAINTL.
  9342     GO TO 8200-SEND-DATAONLY.
  9343
  9344 3030-BUILD-CONT.
  9345     IF (CERTMTI NOT = 'A')
  9346        and (pi-company-id not = 'DCC' and 'VPP')
  9347         GO TO 3060-BUILD-CONT
  9348     END-IF.
  9349
  9350
  9351
  9352* EXEC CICS HANDLE CONDITION
  9353*        NOTFND   (3033-ACCT-NOT-FOUND)
  9354*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9355*    END-EXEC.
  9356*    MOVE '"$I''                  ! / #00008924' TO DFHEIV0
  9357     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9359     MOVE X'2F20233030303038393234' TO DFHEIV0(25:11)
  9360     CALL 'kxdfhei1' USING DFHEIV0
  9361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9362
  9363
  9364     MOVE SPACES                 TO ERACCT-KEY.
  9365
  9366     IF CARR-GROUP-ST-ACCNT-CNTL
  9367         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9368         MOVE CRTCARRI           TO ACCT-CARRIER
  9369         MOVE GROUPI             TO ACCT-GROUPING
  9370         MOVE STATEI             TO ACCT-STATE
  9371         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9372         GO TO 3031-MOVE-ACCT-KEY
  9373     END-IF.
  9374
  9375     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9376     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9377
  9378     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9379         MOVE STATEI             TO ACCT-STATE
  9380     END-IF.
  9381
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 179
* EL130.cbl
  9382     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9383         MOVE CRTCARRI           TO ACCT-CARRIER
  9384     END-IF.
  9385
  9386 3031-MOVE-ACCT-KEY.
  9387     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9388
  9389
  9390
  9391* EXEC CICS STARTBR
  9392*        DATASET     (ERACCT2-DSID)
  9393*        RIDFLD      (SAVE-ERACCT-KEY)
  9394*        GENERIC
  9395*        KEYLENGTH   (20)
  9396*    END-EXEC.
  9397     MOVE 20
  9398       TO DFHEIV11
  9399     MOVE 0
  9400       TO DFHEIV12
  9401*    MOVE '&,   KG    G          &   #00008955' TO DFHEIV0
  9402     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9403     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9404     MOVE X'2020233030303038393535' TO DFHEIV0(25:11)
  9405     CALL 'kxdfhei1' USING DFHEIV0,
  9406           ERACCT2-DSID,
  9407           SAVE-ERACCT-KEY,
  9408           DFHEIV11,
  9409           DFHEIV12,
  9410           DFHEIV99
  9411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9412
  9413
  9414
  9415
  9416* EXEC CICS HANDLE CONDITION
  9417*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9418*    END-EXEC.
  9419*    MOVE '"$''                   ! 0 #00008963' TO DFHEIV0
  9420     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9422     MOVE X'3020233030303038393633' TO DFHEIV0(25:11)
  9423     CALL 'kxdfhei1' USING DFHEIV0
  9424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9425
  9426
  9427 3031-READ-ACCT-LOOP.
  9428
  9429
  9430* EXEC CICS READNEXT
  9431*        DATASET   (ERACCT2-DSID)
  9432*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9433*        RIDFLD    (SAVE-ERACCT-KEY)
  9434*    END-EXEC.
  9435     MOVE 0
  9436       TO DFHEIV11
  9437*    MOVE '&.S                   )   #00008969' TO DFHEIV0
  9438     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9439     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 180
* EL130.cbl
  9440     MOVE X'2020233030303038393639' TO DFHEIV0(25:11)
  9441     CALL 'kxdfhei1' USING DFHEIV0,
  9442           ERACCT2-DSID,
  9443           DFHEIV20,
  9444           DFHEIV99,
  9445           SAVE-ERACCT-KEY,
  9446           DFHEIV99,
  9447           DFHEIV11,
  9448           DFHEIV99,
  9449           DFHEIV99
  9450     SET ADDRESS OF ACCOUNT-MASTER TO
  9451         DFHEIV20
  9452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9453
  9454
  9455     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9456        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9457        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9458        ACCT-STATE    NOT = AM-VG-STATE       OR
  9459        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9460         GO TO 3033-ACCT-NOT-FOUND
  9461     END-IF.
  9462
  9463     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9464        WS-EFFDT LESS AM-EXPIRATION-DT
  9465         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9466         MOVE AM-CARRIER       TO CERT-CARRIER
  9467         MOVE AM-GROUPING      TO CERT-GROUPING
  9468         MOVE AM-STATE         TO CERT-STATE
  9469         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9470         MOVE WS-EFFDT         TO CERT-EFF-DT
  9471         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9472         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9473         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9474         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9475     END-IF.
  9476
  9477     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9478         GO TO 3031-READ-ACCT-LOOP
  9479     END-IF.
  9480
  9481 3032-NOT-IN-DT-RANGE.
  9482     MOVE ER-0226                TO EMI-ERROR.
  9483     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9484     MOVE -1                     TO EFFDTL.
  9485     GO TO 8200-SEND-DATAONLY.
  9486
  9487 3033-ACCT-NOT-FOUND.
  9488     MOVE ER-0226 TO EMI-ERROR.
  9489     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9490     MOVE -1                     TO ACCOUNTL.
  9491     GO TO 8200-SEND-DATAONLY.
  9492
  9493 3034-CHECK-EMPLOYER-STATEMENT.
  9494
  9495     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9496*        NEXT SENTENCE
  9497         CONTINUE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 181
* EL130.cbl
  9498     ELSE
  9499         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9500     END-IF.
  9501
  9502     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9503     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9504     MOVE '1'                    TO  DC-OPTION-CODE.
  9505     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9506                                     DC-ELAPSED-DAYS.
  9507     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9508
  9509     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9510         DC-ELAPSED-DAYS LESS THAN +31)
  9511                      OR
  9512        (AM-EMPLOYER-STMT-USED = '2' AND
  9513         DC-ELAPSED-DAYS LESS THAN +61)
  9514                      OR
  9515        (AM-EMPLOYER-STMT-USED = '3' AND
  9516         DC-ELAPSED-DAYS LESS THAN +91)
  9517            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9518     END-IF.
  9519
  9520 3034-CHECK-ACCOUNT-LIMITS.
  9521
  9522     IF CERTMTI NOT = 'A'
  9523         GO TO 3060-BUILD-CONT
  9524     END-IF.
  9525
  9526     IF AM-STATUS NOT = '0'
  9527         MOVE ER-0225                TO EMI-ERROR
  9528         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9529         MOVE -1                     TO ACCOUNTL
  9530     END-IF.
  9531
  9532     IF EIBAID = DFHPF6
  9533         IF EMI-FATAL-CTR NOT = ZERO
  9534             MOVE ER-0434         TO EMI-ERROR
  9535             MOVE -1              TO MAINTL
  9536             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9537             GO TO 8200-SEND-DATAONLY
  9538         END-IF
  9539     END-IF.
  9540
  9541*    IF PI-COMPANY-ID NOT = 'CRI'
  9542*        GO TO 3035-END-BROWSE
  9543*    END-IF.
  9544
  9545 3035-END-BROWSE.
  9546
  9547
  9548* EXEC CICS ENDBR
  9549*        DATASET    (ERACCT2-DSID)
  9550*    END-EXEC.
  9551     MOVE 0
  9552       TO DFHEIV11
  9553*    MOVE '&2                    $   #00009067' TO DFHEIV0
  9554     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9555     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 182
* EL130.cbl
  9556     MOVE X'2020233030303039303637' TO DFHEIV0(25:11)
  9557     CALL 'kxdfhei1' USING DFHEIV0,
  9558           ERACCT2-DSID,
  9559           DFHEIV11,
  9560           DFHEIV99
  9561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9562
  9563
  9564 3040-CHECK-CERT-ALREADY-ON.
  9565
  9566
  9567* EXEC CICS HANDLE CONDITION
  9568*        NOTFND   (3070-BUILD-CONT)
  9569*    END-EXEC.
  9570*    MOVE '"$I                   ! 1 #00009073' TO DFHEIV0
  9571     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9573     MOVE X'3120233030303039303733' TO DFHEIV0(25:11)
  9574     CALL 'kxdfhei1' USING DFHEIV0
  9575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9576
  9577
  9578     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9579
  9580     MOVE ER-0229                TO EMI-ERROR.
  9581     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9582     MOVE -1                     TO MAINTL.
  9583     GO TO 8200-SEND-DATAONLY.
  9584
  9585 3060-BUILD-CONT.
  9586     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9587     MOVE CRTCARRI               TO CERT-CARRIER.
  9588     MOVE GROUPI                 TO CERT-GROUPING.
  9589     MOVE STATEI                 TO CERT-STATE.
  9590     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9591     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9592     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9593     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9594
  9595
  9596
  9597* EXEC CICS HANDLE CONDITION
  9598*        NOTFND  (3065-CERT-NOT-FOUND)
  9599*    END-EXEC.
  9600*    MOVE '"$I                   ! 2 #00009095' TO DFHEIV0
  9601     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9603     MOVE X'3220233030303039303935' TO DFHEIV0(25:11)
  9604     CALL 'kxdfhei1' USING DFHEIV0
  9605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9606
  9607
  9608     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9609
  9610     GO TO 3070-BUILD-CONT.
  9611
  9612 3065-CERT-NOT-FOUND.
  9613     MOVE ER-0244                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 183
* EL130.cbl
  9614     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9615     MOVE -1                     TO CERTNOL.
  9616     GO TO 8200-SEND-DATAONLY.
  9617
  9618 3070-BUILD-CONT.
  9619     IF CLMNOL NOT = ZERO
  9620         GO TO 3200-BUILD-ZERO-TRAILER
  9621     END-IF.
  9622
  9623     MOVE SPACES                 TO ELCNTL-KEY.
  9624
  9625     IF CONTROL-IS-ACTUAL-CARRIER
  9626         MOVE PI-CARRIER         TO CNTL-CARRIER
  9627     ELSE
  9628         MOVE PI-CARRIER-CONTROL-LEVEL
  9629                                 TO CNTL-CARRIER
  9630     END-IF.
  9631
  9632     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9633     MOVE '6'                    TO CNTL-REC-TYPE.
  9634     MOVE +0                     TO CNTL-SEQ-NO.
  9635
  9636
  9637
  9638* EXEC CICS HANDLE CONDITION
  9639*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9640*    END-EXEC.
  9641*    MOVE '"$I                   ! 3 #00009128' TO DFHEIV0
  9642     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9643     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9644     MOVE X'3320233030303039313238' TO DFHEIV0(25:11)
  9645     CALL 'kxdfhei1' USING DFHEIV0
  9646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9647
  9648
  9649
  9650
  9651* EXEC CICS READ
  9652*        UPDATE
  9653*        DATASET   (ELCNTL-DSID)
  9654*        SET       (ADDRESS OF CONTROL-FILE)
  9655*        RIDFLD    (ELCNTL-KEY)
  9656*    END-EXEC.
  9657*    MOVE '&"S        EU         (   #00009133' TO DFHEIV0
  9658     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9659     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9660     MOVE X'2020233030303039313333' TO DFHEIV0(25:11)
  9661     CALL 'kxdfhei1' USING DFHEIV0,
  9662           ELCNTL-DSID,
  9663           DFHEIV20,
  9664           DFHEIV99,
  9665           ELCNTL-KEY,
  9666           DFHEIV99,
  9667           DFHEIV99,
  9668           DFHEIV99
  9669     SET ADDRESS OF CONTROL-FILE TO
  9670         DFHEIV20
  9671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 184
* EL130.cbl
  9672
  9673
  9674     IF CLAIM-NO-MANUAL
  9675         GO TO 3120-CLAIM-MUST-BE-INPUT
  9676     END-IF.
  9677
  9678     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9679     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9680
  9681     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' OR 'VPP'
  9682           or 'FNL'
  9683         CONTINUE
  9684     ELSE
  9685         GO TO 3080-ASSIGN-LOOP
  9686     END-IF.
  9687
  9688
  9689
  9690* EXEC CICS UNLOCK
  9691*        DATASET   (ELCNTL-DSID)
  9692*    END-EXEC.
  9693*    MOVE '&*                    #   #00009155' TO DFHEIV0
  9694     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9695     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9696     MOVE X'2020233030303039313535' TO DFHEIV0(25:11)
  9697     CALL 'kxdfhei1' USING DFHEIV0,
  9698           ELCNTL-DSID,
  9699           DFHEIV99
  9700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9701
  9702
  9703     MOVE '1'                    TO CNTL-REC-TYPE.
  9704     MOVE SPACES                 TO CNTL-ACCESS.
  9705
  9706     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9707
  9708
  9709
  9710* EXEC CICS HANDLE CONDITION
  9711*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9712*    END-EXEC.
  9713*    MOVE '"$I                   ! 4 #00009165' TO DFHEIV0
  9714     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9715     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9716     MOVE X'3420233030303039313635' TO DFHEIV0(25:11)
  9717     CALL 'kxdfhei1' USING DFHEIV0
  9718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9719
  9720
  9721     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9722
  9723     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9724
  9725 3080-ASSIGN-LOOP.
  9726     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9727        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9728         MOVE +0                 TO SAVE-COUNTER
  9729     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 185
* EL130.cbl
  9730
  9731     ADD +1 TO SAVE-COUNTER.
  9732
  9733     IF SAVE-METHOD  = '3'
  9734         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9735         GO TO 3090-SET-COMP
  9736     END-IF.
  9737
  9738     IF SAVE-METHOD  = '4'
  9739         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9740         MOVE CLMCARRI           TO WS-CN-PRF-A
  9741         GO TO 3090-SET-COMP
  9742     END-IF.
  9743
  9744     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9745     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9746     MOVE SAVE-DATE              TO CURR-DATE.
  9747
  9748     IF CURR-MM LESS '10'
  9749         MOVE CURR-M2             TO WS-CN-PRF-B
  9750     END-IF.
  9751
  9752     IF CURR-MM = '10'
  9753        MOVE 'A'                 TO WS-CN-PRF-B
  9754     END-IF.
  9755     IF CURR-MM = '11'
  9756        MOVE 'B'                 TO WS-CN-PRF-B
  9757     END-IF.
  9758     IF CURR-MM = '12'
  9759        MOVE 'C'                 TO WS-CN-PRF-B
  9760     END-IF.
  9761
  9762     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9763
  9764 3090-SET-COMP.
  9765
  9766     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9767     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9768                                    CLMNOO.
  9769     MOVE AL-UANON               TO CLMNOA.
  9770     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9771     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9772     MOVE CLMCARRI               TO MSTR-CARRIER.
  9773
  9774
  9775
  9776* EXEC CICS HANDLE CONDITION
  9777*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9778*    END-EXEC.
  9779*    MOVE '"$I                   ! 5 #00009223' TO DFHEIV0
  9780     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9782     MOVE X'3520233030303039323233' TO DFHEIV0(25:11)
  9783     CALL 'kxdfhei1' USING DFHEIV0
  9784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9785
  9786
  9787     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 186
* EL130.cbl
  9788
  9789     GO TO 3080-ASSIGN-LOOP.
  9790
  9791 3100-CARRIER-NOT-FOUND.
  9792     MOVE ER-0252                TO EMI-ERROR.
  9793     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9794     MOVE -1                     TO CLMCARRL.
  9795     GO TO 8200-SEND-DATAONLY.
  9796
  9797 3110-COMPANY-NOT-FOUND.
  9798     MOVE ER-0254                TO EMI-ERROR.
  9799     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9800     MOVE -1                     TO MAINTL.
  9801     GO TO 8200-SEND-DATAONLY.
  9802
  9803 3120-CLAIM-MUST-BE-INPUT.
  9804     MOVE ER-0264                TO EMI-ERROR.
  9805     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9806     MOVE -1                     TO CLMNOL.
  9807     GO TO 8200-SEND-DATAONLY.
  9808
  9809 3200-BUILD-ZERO-TRAILER.
  9810
  9811
  9812* EXEC CICS HANDLE CONDITION
  9813*        NOTFND
  9814*    END-EXEC.
  9815*    MOVE '"$                   ! 6 #00009251' TO DFHEIV0
  9816     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9818     MOVE X'3620233030303039323531' TO DFHEIV0(25:11)
  9819     CALL 'kxdfhei1' USING DFHEIV0
  9820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9821
  9822
  9823
  9824
  9825* EXEC CICS GETMAIN
  9826*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9827*        LENGTH  (ELTRLR-LENGTH)
  9828*    END-EXEC.
  9829*    MOVE '," L                  $   #00009256' TO DFHEIV0
  9830     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9831     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9832     MOVE X'2020233030303039323536' TO DFHEIV0(25:11)
  9833     CALL 'kxdfhei1' USING DFHEIV0,
  9834           DFHEIV20,
  9835           ELTRLR-LENGTH,
  9836           DFHEIV99
  9837     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9838         DFHEIV20
  9839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9840
  9841
  9842     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9843     MOVE 'AT'                   TO AT-RECORD-ID.
  9844
  9845     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 187
* EL130.cbl
  9846     MOVE CLMCARRI               TO AT-CARRIER.
  9847     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9848     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9849     MOVE +0                     TO AT-SEQUENCE-NO.
  9850     MOVE '1'                    TO AT-TRAILER-TYPE.
  9851
  9852     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9853     MOVE '5'                    TO DC-OPTION-CODE.
  9854     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9855     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9856                                    AT-RESERVES-LAST-MAINT-DT.
  9857
  9858     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9859                                    AT-RESERVES-LAST-UPDATED-BY.
  9860
  9861     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9862
  9863     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9864
  9865     MOVE +0                     TO AT-FUTURE-RESERVE
  9866                                    AT-IBNR-RESERVE
  9867                                    AT-PAY-CURRENT-RESERVE
  9868                                    AT-INITIAL-MANUAL-RESERVE
  9869                                    AT-CURRENT-MANUAL-RESERVE
  9870                                    AT-ITD-LIFE-REFUNDS
  9871                                    AT-ITD-AH-REFUNDS
  9872                                    AT-ITD-ADDITIONAL-RESERVE.
  9873
  9874     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9875
  9876     IF MANRSVL NOT = ZERO
  9877         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9878                                    AT-CURRENT-MANUAL-RESERVE
  9879     END-IF.
  9880
  9881     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9882
  9883     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9884                                    AT-ITD-CHARGEABLE-EXPENSE.
  9885
  9886     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9887     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9888     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9889
  9890
  9891
  9892* EXEC CICS WRITE
  9893*        DATASET   (ELTRLR-DSID)
  9894*        FROM      (ACTIVITY-TRAILERS)
  9895*        RIDFLD    (AT-CONTROL-PRIMARY)
  9896*    END-EXEC.
  9897     MOVE LENGTH OF
  9898      ACTIVITY-TRAILERS
  9899       TO DFHEIV11
  9900*    MOVE '&$ L                  ''   #00009310' TO DFHEIV0
  9901     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9902     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9903     MOVE X'2020233030303039333130' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 188
* EL130.cbl
  9904     CALL 'kxdfhei1' USING DFHEIV0,
  9905           ELTRLR-DSID,
  9906           ACTIVITY-TRAILERS,
  9907           DFHEIV11,
  9908           AT-CONTROL-PRIMARY,
  9909           DFHEIV99,
  9910           DFHEIV99
  9911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9912
  9913
  9914     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9915
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 189
* EL130.cbl
  9917
  9918 3250-BUILD-I1-ADDRESS-TRAILER.
  9919
  9920     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9921     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9922     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9923     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9924     MOVE GROUPI                 TO WS-MA-GROUPING.
  9925     MOVE STATEI                 TO WS-MA-STATE.
  9926     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9927     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9928     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9929     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9930
  9931
  9932* EXEC CICS HANDLE CONDITION
  9933*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9934*    END-EXEC.
  9935*    MOVE '"$I                   ! 7 #00009333' TO DFHEIV0
  9936     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9938     MOVE X'3720233030303039333333' TO DFHEIV0(25:11)
  9939     CALL 'kxdfhei1' USING DFHEIV0
  9940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9941
  9942
  9943
  9944* EXEC CICS READ
  9945*        EQUAL
  9946*        DATASET   (ERMAIL-DSID)
  9947*        SET       (ADDRESS OF MAILING-DATA)
  9948*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9949*    END-EXEC.
  9950*    MOVE '&"S        E          (   #00009337' TO DFHEIV0
  9951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9953     MOVE X'2020233030303039333337' TO DFHEIV0(25:11)
  9954     CALL 'kxdfhei1' USING DFHEIV0,
  9955           ERMAIL-DSID,
  9956           DFHEIV20,
  9957           DFHEIV99,
  9958           WS-MA-CONTROL-PRIMARY,
  9959           DFHEIV99,
  9960           DFHEIV99,
  9961           DFHEIV99
  9962     SET ADDRESS OF MAILING-DATA TO
  9963         DFHEIV20
  9964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9965
  9966
  9967     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9968         GO TO 3290-NO-INSURED-ADDRESS
  9969     END-IF.
  9970
  9971     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9972     MOVE 'AT'                   TO AT-RECORD-ID.
  9973
  9974     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 190
* EL130.cbl
  9975     MOVE CLMCARRI               TO AT-CARRIER.
  9976     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9977     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9978     MOVE +1                     TO AT-SEQUENCE-NO.
  9979     MOVE '5'                    TO AT-TRAILER-TYPE.
  9980
  9981     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9982     IF MA-INSURED-MIDDLE-INIT > SPACES
  9983        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9984               ' ' DELIMITED BY SIZE
  9985               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9986               ' ' DELIMITED BY SIZE
  9987               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9988        INTO AT-MAIL-TO-NAME
  9989     ELSE
  9990        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9991               ' ' DELIMITED BY SIZE
  9992               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9993        INTO AT-MAIL-TO-NAME
  9994     END-IF.
  9995     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9996     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9997*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9998     MOVE MA-CITY                TO AT-CITY
  9999     MOVE MA-ADDR-STATE          TO AT-STATE
 10000     MOVE MA-ZIP                 TO AT-ZIP
 10001     MOVE MA-PHONE-NO            TO AT-PHONE-NO
 10002
 10003     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10004                                    AT-ADDRESS-LAST-MAINT-DT.
 10005
 10006     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10007                                    AT-ADDRESS-LAST-UPDATED-BY.
 10008
 10009     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10010
 10011
 10012* EXEC CICS WRITE
 10013*        DATASET   (ELTRLR-DSID)
 10014*        FROM      (ACTIVITY-TRAILERS)
 10015*        RIDFLD    (AT-CONTROL-PRIMARY)
 10016*    END-EXEC.
 10017     MOVE LENGTH OF
 10018      ACTIVITY-TRAILERS
 10019       TO DFHEIV11
 10020*    MOVE '&$ L                  ''   #00009388' TO DFHEIV0
 10021     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10022     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10023     MOVE X'2020233030303039333838' TO DFHEIV0(25:11)
 10024     CALL 'kxdfhei1' USING DFHEIV0,
 10025           ELTRLR-DSID,
 10026           ACTIVITY-TRAILERS,
 10027           DFHEIV11,
 10028           AT-CONTROL-PRIMARY,
 10029           DFHEIV99,
 10030           DFHEIV99
 10031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10032
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 191
* EL130.cbl
 10033
 10034     ADD +1                      TO WS-INSURED-ADDR-CNT.
 10035     GO TO 3300-BUILD-NINETY-TRAILER.
 10036
 10037 3290-NO-INSURED-ADDRESS.
 10038      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
 10039
 10040 3300-BUILD-NINETY-TRAILER.
 10041
 10042     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10043     MOVE 'AT'                   TO AT-RECORD-ID.
 10044
 10045     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10046     MOVE CLMCARRI               TO AT-CARRIER.
 10047
 10048     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10049     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10050     MOVE +90                    TO AT-SEQUENCE-NO.
 10051     MOVE '6'                    TO AT-TRAILER-TYPE.
 10052
 10053     IF DIAGL NOT = ZERO
 10054         MOVE DIAGI              TO AT-INFO-LINE-1
 10055     END-IF.
 10056
 10057     IF ICD1L NOT = ZERO
 10058         MOVE ICD1I              TO AT-ICD-CODE-1
 10059     END-IF.
 10060
 10061     IF ICD2L NOT = ZERO
 10062         MOVE ICD2I              TO AT-ICD-CODE-2
 10063     END-IF.
 10064
 10065     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10066                                    AT-GEN-INFO-LAST-MAINT-DT.
 10067
 10068     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10069                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10070     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10071
 10072
 10073
 10074* EXEC CICS WRITE
 10075*        DATASET   (ELTRLR-DSID)
 10076*        FROM      (ACTIVITY-TRAILERS)
 10077*        RIDFLD    (AT-CONTROL-PRIMARY)
 10078*    END-EXEC.
 10079     MOVE LENGTH OF
 10080      ACTIVITY-TRAILERS
 10081       TO DFHEIV11
 10082*    MOVE '&$ L                  ''   #00009433' TO DFHEIV0
 10083     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10084     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10085     MOVE X'2020233030303039343333' TO DFHEIV0(25:11)
 10086     CALL 'kxdfhei1' USING DFHEIV0,
 10087           ELTRLR-DSID,
 10088           ACTIVITY-TRAILERS,
 10089           DFHEIV11,
 10090           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 192
* EL130.cbl
 10091           DFHEIV99,
 10092           DFHEIV99
 10093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10094
 10095
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 193
* EL130.cbl
 10097 3400-CHECK-CERT-MAINT.
 10098
 10099     IF CERTMTI = 'A'
 10100         GO TO 3600-BUILD-NEW-CERT
 10101     END-IF.
 10102
 10103     IF NO-CLAIM-ATTACHED
 10104         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
 10105     END-IF.
 10106
 10107     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
 10108
 10109     IF CM-LF-CURRENT-STATUS = '2' OR
 10110        CM-AH-CURRENT-STATUS = '2'
 10111         GO TO 3400-REWRITE-CERT
 10112     END-IF.
 10113
 10114     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10115
 10116 3400-REWRITE-CERT.
 10117
 10118
 10119
 10120* EXEC CICS HANDLE CONDITION
 10121*        DUPKEY (3410-DUP-KEY)
 10122*    END-EXEC.
 10123*    MOVE '"$$                   ! 8 #00009462' TO DFHEIV0
 10124     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10126     MOVE X'3820233030303039343632' TO DFHEIV0(25:11)
 10127     CALL 'kxdfhei1' USING DFHEIV0
 10128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10129
 10130
 10131
 10132
 10133* EXEC CICS REWRITE
 10134*        DATASET   (ELCERT-DSID)
 10135*        FROM      (CERTIFICATE-MASTER)
 10136*    END-EXEC.
 10137     MOVE LENGTH OF
 10138      CERTIFICATE-MASTER
 10139       TO DFHEIV11
 10140*    MOVE '&& L                  %   #00009467' TO DFHEIV0
 10141     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10142     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10143     MOVE X'2020233030303039343637' TO DFHEIV0(25:11)
 10144     CALL 'kxdfhei1' USING DFHEIV0,
 10145           ELCERT-DSID,
 10146           CERTIFICATE-MASTER,
 10147           DFHEIV11,
 10148           DFHEIV99
 10149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10150
 10151
 10152 3410-DUP-KEY.
 10153     GO TO 3800-BUILD-NEW-CLAIM.
 10154
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 194
* EL130.cbl
 10155 3600-BUILD-NEW-CERT.
 10156
 10157
 10158* EXEC CICS GETMAIN
 10159*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 10160*        LENGTH   (ELCERT-LENGTH)
 10161*    END-EXEC.
 10162*    MOVE '," L                  $   #00009477' TO DFHEIV0
 10163     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10164     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10165     MOVE X'2020233030303039343737' TO DFHEIV0(25:11)
 10166     CALL 'kxdfhei1' USING DFHEIV0,
 10167           DFHEIV20,
 10168           ELCERT-LENGTH,
 10169           DFHEIV99
 10170     SET ADDRESS OF CERTIFICATE-MASTER TO
 10171         DFHEIV20
 10172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10173
 10174
 10175     MOVE SPACES                 TO CERTIFICATE-MASTER.
 10176
 10177     MOVE 'CM'                   TO CM-RECORD-ID.
 10178
 10179     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
 10180                                    CM-COMPANY-CD-A1
 10181                                    CM-COMPANY-CD-A2
 10182                                    CM-COMPANY-CD-A4
 10183                                    CM-COMPANY-CD-A5.
 10184
 10185     MOVE CERT-CARRIER           TO CM-CARRIER.
 10186     MOVE CERT-GROUPING          TO CM-GROUPING.
 10187     MOVE CERT-STATE             TO CM-STATE.
 10188     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
 10189     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
 10190     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
 10191
 10192     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
 10193                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
 10194                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
 10195                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
 10196                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
 10197                       CM-LIVES              CM-LOAN-TERM
 10198                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
 10199                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10200                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10201                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10202                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10203                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10204                       CM-LF-ALT-PREMIUM-RATE
 10205                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10206                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10207                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10208                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10209                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10210
 10211     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10212                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 195
* EL130.cbl
 10213                                    CM-AH-SETTLEMENT-DT
 10214                                    CM-AH-CANCEL-EXIT-DT
 10215                                    CM-AH-SETTLEMENT-EXIT-DT
 10216                                    CM-LF-LOAN-EXPIRE-DT
 10217                                    CM-LF-CANCEL-DT
 10218                                    CM-LF-DEATH-DT
 10219                                    CM-LF-CANCEL-EXIT-DT
 10220                                    CM-LF-DEATH-EXIT-DT
 10221                                    CM-LAST-ADD-ON-DT
 10222                                    CM-ENTRY-DT.
 10223
 10224     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10225     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10226     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10227
 10228     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10229                                    CM-PART-LAST-NAME-A2
 10230                                    CM-PART-LAST-NAME-A5.
 10231
 10232     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10233                                    CM-INSURED-INITIAL1-A2
 10234                                    CM-INSURED-INITIAL1-A5
 10235                                    CM-INSURED-FIRST-NAME.
 10236
 10237     IF CRTINITL GREATER ZERO
 10238         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10239                                    CM-INSURED-INITIAL2-A2
 10240                                    CM-INSURED-INITIAL2-A5
 10241     ELSE
 10242         MOVE SPACES             TO CM-INSURED-INITIAL2
 10243                                    CM-INSURED-INITIAL2-A2
 10244                                    CM-INSURED-INITIAL2-A5
 10245     END-IF.
 10246
 10247     IF CM-INSURED-INITIALS = SPACES
 10248         MOVE '**'               TO CM-INSURED-INITIALS
 10249     END-IF.
 10250
 10251     IF MEMBERL GREATER ZERO
 10252         MOVE MEMBERI              TO CM-MEMBER-NO
 10253     ELSE
 10254         MOVE CERT-STATE           TO CM-MEMB-STATE
 10255         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10256         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10257         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10258     END-IF.
 10259
 10260     IF JNTLNMEL GREATER ZERO
 10261         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10262     END-IF.
 10263
 10264     IF JNTFNMEL GREATER ZERO
 10265         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10266     END-IF.
 10267
 10268     IF JNTINITL GREATER ZERO
 10269         MOVE JNTINITI           TO CM-JT-INITIAL
 10270     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 196
* EL130.cbl
 10271
 10272     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10273
 10274
 10275
 10276* EXEC CICS HANDLE CONDITION
 10277*        DUPKEY   (3690-CERT-WRITTEN)
 10278*    END-EXEC.
 10279*    MOVE '"$$                   ! 9 #00009582' TO DFHEIV0
 10280     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10282     MOVE X'3920233030303039353832' TO DFHEIV0(25:11)
 10283     CALL 'kxdfhei1' USING DFHEIV0
 10284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10285
 10286
 10287
 10288
 10289* EXEC CICS WRITE
 10290*        DATASET   (ELCERT-DSID)
 10291*        FROM      (CERTIFICATE-MASTER)
 10292*        RIDFLD    (CM-CONTROL-PRIMARY)
 10293*    END-EXEC.
 10294     MOVE LENGTH OF
 10295      CERTIFICATE-MASTER
 10296       TO DFHEIV11
 10297*    MOVE '&$ L                  ''   #00009587' TO DFHEIV0
 10298     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10299     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10300     MOVE X'2020233030303039353837' TO DFHEIV0(25:11)
 10301     CALL 'kxdfhei1' USING DFHEIV0,
 10302           ELCERT-DSID,
 10303           CERTIFICATE-MASTER,
 10304           DFHEIV11,
 10305           CM-CONTROL-PRIMARY,
 10306           DFHEIV99,
 10307           DFHEIV99
 10308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10309
 10310
 10311 3690-CERT-WRITTEN.
 10312
 10313     GO TO 3800-BUILD-NEW-CLAIM.
 10314
 10315 3690-EXIT.
 10316      EXIT.
 10317
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 197
* EL130.cbl
 10319 3700-BUILD-CERT.
 10320
 10321     IF CERTMTI NOT = 'A'
 10322         GO TO 3700-FINISH-CERT-BUILD
 10323     END-IF.
 10324
 10325     IF CERTMTI = 'A'
 10326         IF LCVCDL = ZEROS
 10327             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10328                                    CM-LF-ORIG-TERM
 10329                                    CM-LF-BENEFIT-AMT
 10330                                    CM-LF-PREMIUM-RATE
 10331             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10332         END-IF
 10333     END-IF.
 10334
 10335     IF LCVCDL GREATER ZERO
 10336         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10337     END-IF.
 10338
 10339     IF LCVOTRML GREATER ZERO
 10340         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10341     END-IF.
 10342
 10343     IF LCVBENEL GREATER ZERO
 10344         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10345     END-IF.
 10346
 10347     IF LCVRATEL GREATER ZERO
 10348         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10349     END-IF.
 10350
 10351     IF WS-EXPIRE NOT = LOW-VALUES
 10352         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10353     END-IF.
 10354
 10355     IF LCVFORML GREATER ZERO
 10356         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10357     END-IF.
 10358
 10359     IF LCVCNDTL = ZERO
 10360        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10361     END-IF.
 10362
 10363     IF WS-LCVCNDT NOT = LOW-VALUES
 10364        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10365        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10366        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10367     END-IF.
 10368
 10369     IF CM-LF-CURRENT-STATUS = '7'
 10370        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10371        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10372        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10373                                    CM-LF-DEATH-DT
 10374        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10375     END-IF.
 10376
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 198
* EL130.cbl
 10377     IF CM-LF-CURRENT-STATUS = '8'
 10378        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10379        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10380     END-IF.
 10381
 10382 3700-BUILD-AH-COVERAGE-SIDE.
 10383
 10384     IF CERTMTI = 'A'
 10385         IF ACVCDL = ZEROS
 10386             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10387                                    CM-AH-ORIG-TERM
 10388                                    CM-AH-BENEFIT-AMT
 10389                                    CM-AH-PREMIUM-RATE
 10390             GO TO 3700-COVERAGE-BUILT
 10391         END-IF
 10392     END-IF.
 10393
 10394     IF ACVCDL GREATER ZERO
 10395         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10396     END-IF.
 10397
 10398     IF ACVOTRML GREATER ZERO
 10399         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10400     END-IF.
 10401
 10402     IF ACVBENEL GREATER ZERO
 10403         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10404     END-IF.
 10405
 10406     IF ACVRATEL GREATER ZERO
 10407         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10408     END-IF.
 10409
 10410     IF WS-EXPIRE NOT = LOW-VALUES
 10411         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10412     END-IF.
 10413
 10414     IF ACVFORML GREATER ZERO
 10415         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10416     END-IF.
 10417
 10418     IF ACVCNDTL = ZERO
 10419        GO TO 3700-COVERAGE-BUILT
 10420     END-IF.
 10421
 10422     IF WS-ACVCNDT NOT = LOW-VALUES
 10423        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10424        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10425        GO TO 3700-COVERAGE-BUILT
 10426     END-IF.
 10427
 10428     IF CM-AH-CURRENT-STATUS = '6'
 10429        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10430        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10431        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10432        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10433        GO TO 3700-COVERAGE-BUILT
 10434     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 199
* EL130.cbl
 10435
 10436     IF CM-AH-CURRENT-STATUS = '8'
 10437        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10438        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10439     END-IF.
 10440
 10441 3700-COVERAGE-BUILT.
 10442     IF ISSAGEL GREATER ZERO
 10443         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10444     END-IF.
 10445
 10446     IF JNTAGEL GREATER ZERO
 10447         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10448     END-IF.
 10449
 10450     IF SEXL GREATER ZERO
 10451         MOVE SEXI               TO CM-INSURED-SEX
 10452     END-IF.
 10453
 10454     IF APRL GREATER ZERO
 10455         MOVE WS-APR             TO CM-LOAN-APR
 10456     END-IF.
 10457
 10458     IF PMTFREQL GREATER ZERO
 10459         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10460     END-IF.
 10461
 10462     IF INDGRPL GREATER ZERO
 10463         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10464     END-IF.
 10465
 10466     IF CERTMTI = 'A'
 10467         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10468     END-IF.
 10469
 10470     IF REINCDL GREATER ZERO
 10471         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10472                                    WS-REIN-1
 10473                                    WS-REIN-2
 10474                                    WS-REIN-3
 10475         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10476     END-IF.
 10477
 10478     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10479         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10480     END-IF.
 10481
 10482     IF CRTSSNL GREATER ZERO
 10483         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10484     ELSE
 10485         IF SSNL GREATER ZERO
 10486             MOVE SSNI           TO CM-SOC-SEC-NO
 10487         END-IF
 10488     END-IF.
 10489
 10490     IF CRTSSNL = ZERO AND
 10491        SSNL    = ZERO
 10492         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 200
* EL130.cbl
 10493         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10494         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10495         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10496     END-IF.
 10497
 10498     IF CM-LF-CURRENT-STATUS = SPACES
 10499         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10500     END-IF.
 10501
 10502     IF CM-AH-CURRENT-STATUS = SPACES
 10503         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10504     END-IF.
 10505
 10506     IF CERTMTI = 'A'
 10507         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10508     END-IF.
 10509
 10510 3700-FINISH-CERT-BUILD.
 10511
 10512     IF LOANNOL GREATER ZERO
 10513         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10514     END-IF.
 10515
 10516     IF LOANBALL GREATER ZERO
 10517         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10518     END-IF.
 10519
 10520     IF PREMTYPL GREATER ZERO
 10521         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10522     END-IF.
 10523
 10524 3700-EXIT.
 10525      EXIT.
 10526
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 201
* EL130.cbl
 10528 3800-BUILD-NEW-CLAIM.
 10529
 10530*************************************************************
 10531*****           START OF ACTIVITY FILE PROCESSING          **
 10532*************************************************************
 10533     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL' OR 'FNL'
 10534         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10535                 6700-EXIT
 10536     END-IF.
 10537*************************************************************
 10538*****            END OF ACTIVITY FILE PROCESSING           **
 10539*************************************************************
 10540
 10541
 10542
 10543
 10544* EXEC CICS GETMAIN
 10545*        SET     (ADDRESS OF CLAIM-MASTER)
 10546*        LENGTH  (ELMSTR-LENGTH)
 10547*    END-EXEC.
 10548*    MOVE '," L                  $   #00009825' TO DFHEIV0
 10549     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10550     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10551     MOVE X'2020233030303039383235' TO DFHEIV0(25:11)
 10552     CALL 'kxdfhei1' USING DFHEIV0,
 10553           DFHEIV20,
 10554           ELMSTR-LENGTH,
 10555           DFHEIV99
 10556     SET ADDRESS OF CLAIM-MASTER TO
 10557         DFHEIV20
 10558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10559
 10560
 10561     MOVE SPACES TO CLAIM-MASTER.
 10562
 10563     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10564         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10565         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10566         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10567         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10568         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10569         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10570         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10571
 10572     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10573             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10574             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10575             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10576             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10577             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10578             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10579             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10580             CL-FORCEABLE-ERROR-CNT.
 10581
 10582     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10583
 10584     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10585                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 202
* EL130.cbl
 10586                                    CL-LAG-REPORT-CODE
 10587                                    CL-CRITICAL-PERIOD
 10588*                                   CL-CRIT-PER-RTW-MOS
 10589     move 01                     to cl-benefit-period
 10590
 10591     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10592     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10593
 10594     IF BENECDL NOT = ZEROS
 10595        MOVE BENECDI             TO CL-BENEFICIARY
 10596     END-IF.
 10597
 10598     MOVE 'CL'                   TO CL-RECORD-ID.
 10599     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10600
 10601     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10602                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10603                             CL-COMPANY-CD-A5.
 10604
 10605     MOVE CLMCARRI               TO CL-CARRIER.
 10606
 10607     IF CLMNOL = ZERO
 10608         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10609     ELSE
 10610         MOVE CLMNOI             TO CL-CLAIM-NO
 10611     END-IF.
 10612
 10613     MOVE CERTNOI                TO CL-CERT-PRIME
 10614                                    CL-CERT-A4-PRIME.
 10615
 10616     MOVE SUFXI                  TO CL-CERT-SFX
 10617                                    CL-CERT-A4-SFX.
 10618
 10619     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10620
 10621     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10622
 10623     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10624
 10625     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10626
 10627     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10628     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10629
 10630     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10631
 10632     IF CERTMTI = 'A'
 10633         MOVE '2'                TO CL-CERT-ORIGIN
 10634     ELSE
 10635         MOVE '1'                TO CL-CERT-ORIGIN
 10636     END-IF.
 10637
 10638     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10639     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10640     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10641     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10642     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10643
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 203
* EL130.cbl
 10644 3820-REWRITE-CONTROL-FILE.
 10645
 10646     IF CLMNOL GREATER ZERO
 10647         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10648     END-IF.
 10649
 10650     IF CF-RECORD-TYPE = '6'
 10651         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10652     ELSE
 10653         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10654     END-IF.
 10655
 10656
 10657
 10658* EXEC CICS REWRITE
 10659*        DATASET   (ELCNTL-DSID)
 10660*        FROM      (CONTROL-FILE)
 10661*    END-EXEC.
 10662     MOVE LENGTH OF
 10663      CONTROL-FILE
 10664       TO DFHEIV11
 10665*    MOVE '&& L                  %   #00009926' TO DFHEIV0
 10666     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10667     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10668     MOVE X'2020233030303039393236' TO DFHEIV0(25:11)
 10669     CALL 'kxdfhei1' USING DFHEIV0,
 10670           ELCNTL-DSID,
 10671           CONTROL-FILE,
 10672           DFHEIV11,
 10673           DFHEIV99
 10674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10675
 10676
 10677 3830-SEQUENCE-CLAIM-RECORDS.
 10678
 10679     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10680     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10681     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10682
 10683     IF WS-ASSOC-CERT-TOTAL = ZERO
 10684         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10685                                    CL-ASSOC-CERT-TOTAL
 10686         GO TO 3840-WRITE-CLAIM-MASTER
 10687     END-IF.
 10688
 10689     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10690         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10691     ELSE
 10692         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10693     END-IF.
 10694
 10695     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10696     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10697     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10698
 10699 3840-WRITE-CLAIM-MASTER.
 10700
 10701     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 204
* EL130.cbl
 10702     IF WS-REC-FOUND-SW = 'Y'
 10703         MOVE 01                 TO  CL-ACTIVITY-CODE
 10704         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10705         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10706     END-IF.
 10707
 10708
 10709
 10710* EXEC CICS HANDLE CONDITION
 10711*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10712*    END-EXEC.
 10713*    MOVE '"$$                   ! : #00009963' TO DFHEIV0
 10714     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10715     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10716     MOVE X'3A20233030303039393633' TO DFHEIV0(25:11)
 10717     CALL 'kxdfhei1' USING DFHEIV0
 10718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10719
 10720
 10721** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10722     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10723
 10724
 10725*       CL-CERT-NO
 10726*    IF CL-COMPANY-CD = X'04'
 10727*    ELSE
 10728*       IF CL-COMPANY-CD = X'05'
 10729*       ELSE
 10730*       END-IF
 10731*    END-IF
 10732
 10733* EXEC CICS WRITE
 10734*        DATASET   (ELMSTR-DSID)
 10735*        FROM      (CLAIM-MASTER)
 10736*        RIDFLD    (CL-CONTROL-PRIMARY)
 10737*    END-EXEC.
 10738     MOVE LENGTH OF
 10739      CLAIM-MASTER
 10740       TO DFHEIV11
 10741*    MOVE '&$ L                  ''   #00009983' TO DFHEIV0
 10742     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10743     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10744     MOVE X'2020233030303039393833' TO DFHEIV0(25:11)
 10745     CALL 'kxdfhei1' USING DFHEIV0,
 10746           ELMSTR-DSID,
 10747           CLAIM-MASTER,
 10748           DFHEIV11,
 10749           CL-CONTROL-PRIMARY,
 10750           DFHEIV99,
 10751           DFHEIV99
 10752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10753
 10754
 10755 3850-CLAIM-MSTR-WRITTEN.
 10756
 10757     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10758         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10759     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 205
* EL130.cbl
 10760
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 206
* EL130.cbl
 10762 3990-ADD-DONE.
 10763*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10764*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10765*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10766*                                  EMI-ERROR-LINES.
 10767
 10768     IF CLMNOL = ZERO
 10769         move spaces             to emi-claim-no
 10770         MOVE ER-0265            TO EMI-ERROR
 10771         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10772         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10773                                    PI-LAST-CLAIM
 10774     ELSE
 10775         MOVE CLMNOI             TO PI-LAST-CLAIM
 10776                                    MSTR-CLAIM-NO
 10777         MOVE ER-0000            TO EMI-ERROR
 10778         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10779     END-IF.
 10780
 10781     IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O')
 10782       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10783         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10784         MOVE ER-7575            TO EMI-ERROR
 10785         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10786     END-IF.
 10787
 10788     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 10789       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10790         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10791         MOVE ER-7582            TO EMI-ERROR
 10792         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10793     END-IF.
 10794
 10795     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 10796        PERFORM 3991-CHECK-2-YEAR-CONTESTABLE THRU 3991-EXIT
 10797     END-IF.
 10798     IF WS-NO-INSURED-ADDRESS = 'Y'
 10799         MOVE ER-3548            TO EMI-ERROR
 10800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10801     END-IF.
 10802
 10803     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10804       (PI-ST-CAUSAL-STATE = 'L' AND
 10805             (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'))   OR
 10806       (PI-ST-CAUSAL-STATE = 'A' AND
 10807              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10808         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10809         MOVE ER-7577            TO EMI-ERROR
 10810         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10811     END-IF.
 10812     if pi-company-id = 'DCC' OR 'VPP'
 10813        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10814                                 THRU 3994C-EXIT
 10815     end-if
 10816*052918IF CLMTYPEI = PI-AH-OVERRIDE-L1
 10817*052918  AND PI-COMPANY-ID = 'CID'
 10818*052918   SET ELAPSED-BETWEEN-BIN TO TRUE
 10819*052918   MOVE ZERO               TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 207
* EL130.cbl
 10820*052918                              DC-ELAPSED-DAYS
 10821*052918
 10822*052918   MOVE CL-INCURRED-DT  TO DC-BIN-DATE-1
 10823*052918   MOVE WS-TODAY-DT TO DC-BIN-DATE-2
 10824*052918   PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10825*052918   IF DC-ODD-DAYS-OVER > ZERO
 10826*052918      ADD 1 TO DC-ELAPSED-MONTHS
 10827*052918   END-IF
 10828*052918
 10829*052918   IF PI-STATE = 'HI'
 10830*052918     AND DC-ELAPSED-MONTHS <= 18
 10831*052918      CONTINUE
 10832*052918   ELSE
 10833*052918      IF DC-ELAPSED-MONTHS > 15
 10834*052918         MOVE ER-7572            TO EMI-ERROR
 10835*052918         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10836*052918         PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10837*052918      END-IF
 10838*052918   END-IF
 10839*052918
 10840*052918END-IF.
 10841     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10842     MOVE CLMCARRI                   TO  PI-CARRIER.
 10843     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10844     MOVE SUFXI                      TO  PI-CERT-SFX.
 10845
 10846     IF WS-LETTER-SW = 'Y'
 10847         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10848         IF W-1523-ERROR-CODE NOT = ZEROS
 10849             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10850             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10851         END-IF
 10852     END-IF.
 10853
 10854     perform 3998-update-cert-claim-trailer
 10855                                 thru 3998-exit
 10856     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10857     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10858     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10859     MOVE CLMCARRI               TO PI-LAST-CARR.
 10860
 10861     IF PRTOPTL GREATER THAN 0
 10862         MOVE PRTOPTI            TO PI-PRT-OPT
 10863     END-IF.
 10864     IF ALTPRTL GREATER THAN 0
 10865         MOVE ALTPRTI            TO PI-ALT-PRT
 10866     END-IF.
 10867
 10868     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10869         MOVE LOW-VALUES         TO EL130AI
 10870         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10871         MOVE AL-SANON           TO CERTNOA
 10872         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10873         MOVE AL-SANON           TO SUFXA
 10874         MOVE PI-LAST-CARR       TO CLMCARRO
 10875         MOVE AL-UANON           TO CLMCARRA
 10876         MOVE PI-LAST-CLAIM      TO CLMNOO
 10877         MOVE AL-UANON           TO CLMNOA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 208
* EL130.cbl
 10878         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10879         MOVE AL-UANON           TO CLMTYPEA
 10880     ELSE
 10881         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10882         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10883     END-IF.
 10884
 10885     IF PI-PRT-OPT = 'N' OR 'L'
 10886         MOVE PI-PRT-OPT         TO PRTOPTO
 10887         MOVE 1                  TO PRTOPTL
 10888     END-IF.
 10889
 10890     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10891         MOVE PI-ALT-PRT         TO ALTPRTO
 10892         MOVE 4                  TO ALTPRTL
 10893     END-IF.
 10894
 10895     IF PRTOPTL GREATER THAN 0
 10896         IF PRTOPTI = 'L'
 10897             GO TO 0400-CREATE-ELACTQ
 10898         ELSE
 10899             GO TO 0480-PRINT-NOW
 10900         END-IF
 10901     END-IF.
 10902     move 'S'                    to mainti
 10903     PERFORM 0500-CREATE-TEMP-STORAGE
 10904                                 THRU 0599-EXIT
 10905     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10906         GO TO 8100-SEND-INITIAL-MAP
 10907     ELSE
 10908         MOVE LOW-VALUES         TO MAINTO
 10909         MOVE -1                 TO MAINTL
 10910         GO TO 8200-SEND-DATAONLY
 10911     END-IF.
 10912
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 209
* EL130.cbl
 10914 3991-CHECK-2-YEAR-CONTESTABLE.
 10915     SET ELAPSED-BETWEEN-BIN TO TRUE
 10916     MOVE ZERO               TO DC-ELAPSED-MONTHS
 10917                                DC-ELAPSED-DAYS
 10918
 10919     MOVE PI-SAVE-EFFDT  TO DC-BIN-DATE-1.
 10920     MOVE CL-INCURRED-DT TO DC-BIN-DATE-2.
 10921     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10922     IF DC-ODD-DAYS-OVER > ZERO
 10923        ADD 1 TO DC-ELAPSED-MONTHS
 10924     END-IF
 10925
 10926     IF DC-ELAPSED-MONTHS <= 24
 10927        MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
 10928        MOVE ZERO           TO DC-ELAPSED-MONTHS
 10929                               DC-ELAPSED-DAYS
 10930        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10931        IF DC-ODD-DAYS-OVER > ZERO
 10932           ADD 1 TO DC-ELAPSED-MONTHS
 10933        END-IF
 10934        IF DC-ELAPSED-MONTHS > 24
 10935           MOVE ER-1679            TO EMI-ERROR
 10936           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10937           PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10938        END-IF
 10939     END-IF.
 10940
 10941 3991-EXIT.
 10942     EXIT.
 10943 3992-BUILD-TRAILER.
 10944
 10945     MOVE SPACES             TO AT-GENERAL-INFO-TR
 10946     INITIALIZE AT-GENERAL-INFO-TR
 10947     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 10948     MOVE 'AT'               TO AT-RECORD-ID
 10949     IF EMI-ERROR = ER-7572
 10950        MOVE +97             TO AT-SEQUENCE-NO
 10951     ELSE
 10952        MOVE +96             TO AT-SEQUENCE-NO
 10953     END-IF
 10954     MOVE '6'                TO AT-TRAILER-TYPE
 10955     MOVE WS-TODAY-DT        TO AT-RECORDED-DT
 10956                                AT-GEN-INFO-LAST-MAINT-DT
 10957     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 10958                                AT-GEN-INFO-LAST-UPDATED-BY
 10959     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 10960
 10961     IF EMI-ERROR = ER-7572
 10962        MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 10963     ELSE
 10964        MOVE EMI-LINE2 TO AT-INFO-LINE-1
 10965     END-IF
 10966     MOVE SPACES             TO AT-INFO-LINE-2.
 10967
 10968 3992-WRITE.
 10969
 10970
 10971* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 210
* EL130.cbl
 10972*        DUPREC    (3992-DUPREC)
 10973*    END-EXEC.
 10974*    MOVE '"$%                   ! ; #00010204' TO DFHEIV0
 10975     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10976     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10977     MOVE X'3B20233030303130323034' TO DFHEIV0(25:11)
 10978     CALL 'kxdfhei1' USING DFHEIV0
 10979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10980
 10981
 10982
 10983* EXEC CICS WRITE
 10984*         DATASET     ('ELTRLR')
 10985*         FROM        (ACTIVITY-TRAILERS)
 10986*         RIDFLD      (AT-CONTROL-PRIMARY)
 10987*     END-EXEC.
 10988     MOVE LENGTH OF
 10989      ACTIVITY-TRAILERS
 10990       TO DFHEIV11
 10991     MOVE 'ELTRLR' TO DFHEIV1
 10992*    MOVE '&$ L                  ''   #00010208' TO DFHEIV0
 10993     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10994     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10995     MOVE X'2020233030303130323038' TO DFHEIV0(25:11)
 10996     CALL 'kxdfhei1' USING DFHEIV0,
 10997           DFHEIV1,
 10998           ACTIVITY-TRAILERS,
 10999           DFHEIV11,
 11000           AT-CONTROL-PRIMARY,
 11001           DFHEIV99,
 11002           DFHEIV99
 11003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11004
 11005
 11006     GO TO 3992-EXIT.
 11007
 11008 3992-DUPREC.
 11009     SUBTRACT +1 FROM AT-SEQUENCE-NO.
 11010     GO TO 3992-WRITE.
 11011
 11012 3992-EXIT.
 11013     EXIT.
 11014 3993-MODIFY-SCREEN-ATTRB.
 11015
 11016     IF CERTMTL GREATER ZERO
 11017         MOVE AL-UANON           TO CERTMTA
 11018     END-IF.
 11019
 11020     IF EFFDTL GREATER ZERO
 11021         MOVE AL-UANON           TO EFFDTA
 11022     END-IF.
 11023
 11024     IF ACCOUNTL GREATER ZERO
 11025         MOVE AL-UANON           TO ACCOUNTA
 11026     END-IF.
 11027
 11028     IF STATEL GREATER ZERO
 11029         MOVE AL-UANON           TO STATEA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 211
* EL130.cbl
 11030     END-IF.
 11031
 11032     IF CRTCARRL GREATER ZERO
 11033         MOVE AL-UANON           TO CRTCARRA
 11034     END-IF.
 11035
 11036     IF GROUPL GREATER ZERO
 11037         MOVE AL-UANON           TO GROUPA
 11038     END-IF.
 11039
 11040     IF CRTLNMEL GREATER ZERO
 11041         MOVE AL-UANON           TO CRTLNMEA
 11042     END-IF.
 11043
 11044     IF CRTFNMEL GREATER ZERO
 11045         MOVE AL-UANON           TO CRTFNMEA
 11046     END-IF.
 11047
 11048     IF CRTINITL GREATER ZERO
 11049         MOVE AL-UANON           TO CRTINITA
 11050     END-IF.
 11051
 11052     IF ISSAGEL GREATER ZERO
 11053         MOVE AL-UNNON           TO ISSAGEA
 11054     END-IF.
 11055
 11056     IF JNTLNMEL GREATER ZERO
 11057         MOVE AL-UANON           TO JNTLNMEA
 11058     END-IF.
 11059
 11060     IF JNTFNMEL GREATER ZERO
 11061         MOVE AL-UANON           TO JNTFNMEA
 11062     END-IF.
 11063
 11064     IF JNTINITL GREATER ZERO
 11065         MOVE AL-UANON           TO JNTINITA
 11066     END-IF.
 11067
 11068     IF JNTAGEL GREATER ZERO
 11069         MOVE AL-UNNON           TO JNTAGEA
 11070     END-IF.
 11071
 11072     IF CRTSSNL GREATER ZERO
 11073         MOVE AL-UANON           TO CRTSSNA
 11074     END-IF.
 11075
 11076     IF ACVDSCRL GREATER ZERO
 11077         MOVE AL-SANON           TO ACVDSCRA
 11078     END-IF.
 11079
 11080     IF ACVKINDL GREATER ZERO
 11081         MOVE AL-SANON           TO ACVKINDA
 11082     END-IF.
 11083
 11084     IF ACVCDL GREATER ZERO
 11085         MOVE AL-UANON           TO ACVCDA
 11086     END-IF.
 11087
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 212
* EL130.cbl
 11088     IF ACVOTRML GREATER ZERO
 11089         MOVE AL-UNNON           TO ACVOTRMA
 11090     END-IF.
 11091
 11092     IF ACVRTRML GREATER ZERO
 11093         MOVE AL-UNNON           TO ACVRTRMA
 11094     END-IF.
 11095
 11096     IF ACVRATEL GREATER ZERO
 11097         MOVE AL-UNNON           TO ACVRATEA
 11098     END-IF.
 11099
 11100     IF ACVBENEL GREATER ZERO
 11101         MOVE AL-UNNON           TO ACVBENEA
 11102     END-IF.
 11103
 11104     IF ACVFORML GREATER ZERO
 11105         MOVE AL-UANON           TO ACVFORMA
 11106     END-IF.
 11107
 11108     IF ACVCNDTL GREATER ZERO
 11109         MOVE AL-UANON           TO ACVCNDTA
 11110     END-IF.
 11111
 11112     IF ACVEXITL GREATER ZERO
 11113         MOVE AL-UANON           TO ACVEXITA
 11114     END-IF.
 11115
 11116     IF ACVSTATL GREATER ZERO
 11117         MOVE AL-UANON           TO ACVSTATA
 11118     END-IF.
 11119
 11120     IF LCVDSCRL GREATER ZERO
 11121         MOVE AL-SANON           TO LCVDSCRA
 11122     END-IF.
 11123
 11124     IF LCVKINDL GREATER ZERO
 11125         MOVE AL-SANON           TO LCVKINDA
 11126     END-IF.
 11127
 11128     IF LCVCDL GREATER ZERO
 11129         MOVE AL-UANON           TO LCVCDA
 11130     END-IF.
 11131
 11132     IF LCVOTRML GREATER ZERO
 11133         MOVE AL-UNNON           TO LCVOTRMA
 11134     END-IF.
 11135
 11136     IF LCVRTRML GREATER ZERO
 11137         MOVE AL-UNNON           TO LCVRTRMA
 11138     END-IF.
 11139
 11140     IF LCVRATEL GREATER ZERO
 11141         MOVE AL-UNNON           TO LCVRATEA
 11142     END-IF.
 11143
 11144     IF LCVBENEL GREATER ZERO
 11145         MOVE AL-UNNON           TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 213
* EL130.cbl
 11146     END-IF.
 11147
 11148     IF LCVFORML GREATER ZERO
 11149         MOVE AL-UANON           TO LCVFORMA
 11150     END-IF.
 11151
 11152     IF LCVCNDTL GREATER ZERO
 11153         MOVE AL-UANON           TO LCVCNDTA
 11154     END-IF.
 11155
 11156     IF LCVEXITL GREATER ZERO
 11157         MOVE AL-UANON           TO LCVEXITA
 11158     END-IF.
 11159
 11160     IF LCVSTATL GREATER ZERO
 11161         MOVE AL-UANON           TO LCVSTATA
 11162     END-IF.
 11163
 11164     IF MEMCAPL GREATER ZERO
 11165         MOVE AL-UANON           TO MEMCAPA
 11166     END-IF.
 11167
 11168     IF APRL GREATER ZERO
 11169         MOVE AL-UNNON           TO APRA
 11170     END-IF.
 11171
 11172     IF PMTFREQL GREATER ZERO
 11173         MOVE AL-UNNON           TO PMTFREQA
 11174     END-IF.
 11175
 11176     IF INDGRPL GREATER ZERO
 11177         MOVE AL-UANON           TO INDGRPA
 11178     END-IF.
 11179
 11180     IF PREMTYPL GREATER ZERO
 11181         MOVE AL-UANON           TO PREMTYPA
 11182     END-IF.
 11183
 11184     IF REINCDL GREATER ZERO
 11185         MOVE AL-UANON           TO REINCDA
 11186     END-IF.
 11187
 11188     IF ADDONDTL GREATER ZERO
 11189         MOVE AL-UANON           TO ADDONDTA
 11190     END-IF.
 11191
 11192     IF MEMBERL GREATER ZERO
 11193         MOVE AL-UANON           TO MEMBERA
 11194     END-IF.
 11195
 11196     IF BCERT1L GREATER ZERO
 11197         MOVE AL-SANON           TO BCERT1A
 11198                                    BSUFX1A
 11199     END-IF.
 11200
 11201     IF BCERT2L GREATER ZERO
 11202         MOVE AL-SANON           TO BCERT2A
 11203                                    BSUFX2A
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 214
* EL130.cbl
 11204     END-IF.
 11205
 11206     IF BCERT3L GREATER ZERO
 11207         MOVE AL-SANON           TO BCERT3A
 11208                                    BSUFX3A
 11209     END-IF.
 11210
 11211     IF BCERT4L GREATER ZERO
 11212         MOVE AL-SANON           TO BCERT4A
 11213                                    BSUFX4A
 11214     END-IF.
 11215
 11216     IF BCERT5L GREATER ZERO
 11217         MOVE AL-SANON           TO BCERT5A
 11218                                    BSUFX5A
 11219     END-IF.
 11220
 11221 3993-MODIFY-CLAIM-ATTRB.
 11222
 11223     IF PCERTNOL GREATER ZERO
 11224         MOVE AL-UANON           TO PCERTNOA
 11225     END-IF.
 11226
 11227     IF PSUFXL GREATER ZERO
 11228         MOVE AL-UANON           TO PSUFXA
 11229     END-IF.
 11230
 11231     IF LSTNMEL GREATER ZERO
 11232         MOVE AL-UANON           TO LSTNMEA
 11233     END-IF.
 11234
 11235     IF FSTNMEL GREATER ZERO
 11236         MOVE AL-UANON           TO FSTNMEA
 11237     END-IF.
 11238
 11239     IF INITL GREATER ZERO
 11240         MOVE AL-UANON           TO INITA
 11241     END-IF.
 11242
 11243     IF SEXL GREATER ZERO
 11244         MOVE AL-UANON           TO SEXA
 11245     END-IF.
 11246
 11247     IF BIRTHDTL GREATER ZERO
 11248         MOVE AL-UANON           TO BIRTHDTA
 11249     END-IF.
 11250
 11251     IF SSNL GREATER ZERO
 11252         MOVE AL-UANON           TO SSNA
 11253     END-IF.
 11254
 11255     IF INCURL GREATER ZERO
 11256         MOVE AL-UANON           TO INCURA
 11257     END-IF.
 11258
 11259     IF REPORTL GREATER ZERO
 11260         MOVE AL-UANON           TO REPORTA
 11261     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 215
* EL130.cbl
 11262
 11263*    IF ESTENDL GREATER ZERO
 11264*        MOVE AL-UANON           TO ESTENDA
 11265*    END-IF.
 11266
 11267     IF DIAGL GREATER ZERO
 11268         MOVE AL-UANON           TO DIAGA
 11269     END-IF.
 11270*
 11271     IF ICD1L GREATER ZERO
 11272         MOVE AL-UANON           TO ICD1A
 11273     END-IF.
 11274
 11275     IF ICD2L GREATER ZERO
 11276         MOVE AL-UANON           TO ICD2A
 11277     END-IF.
 11278
 11279*    IF CAUSEL GREATER ZERO
 11280*        MOVE AL-UANON           TO CAUSEA
 11281*    END-IF.
 11282
 11283     IF MANRSVL GREATER ZERO
 11284         MOVE AL-UNNON           TO MANRSVA
 11285     END-IF.
 11286
 11287     IF RELCLML GREATER ZERO
 11288         MOVE AL-UANON           TO RELCLMA
 11289     END-IF.
 11290
 11291     IF LOANNOL GREATER ZERO
 11292         MOVE AL-UANON           TO LOANNOA
 11293     END-IF.
 11294
 11295     IF LOANBALL GREATER ZERO
 11296         MOVE AL-UNNON           TO LOANBALA
 11297     END-IF.
 11298
 11299     IF PROCCDL GREATER ZERO
 11300         MOVE AL-UANON           TO PROCCDA
 11301     END-IF.
 11302
 11303     IF BENECDL GREATER THAN ZERO
 11304         MOVE AL-UANON           TO  BENECDA
 11305     END-IF.
 11306
 11307     IF PRICDL GREATER ZERO
 11308         MOVE AL-UANON           TO PRICDA
 11309     END-IF.
 11310
 11311     IF SUPVL GREATER ZERO
 11312         MOVE AL-UANON           TO SUPVA
 11313     END-IF.
 11314
 11315     IF FILETOL GREATER ZERO
 11316         MOVE AL-UANON           TO FILETOA
 11317     END-IF.
 11318
 11319
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 216
* EL130.cbl
 11320 3993-MODIFY-CLAIM-KEY-ATTRB.
 11321
 11322     IF CLMNOL GREATER ZERO
 11323         MOVE AL-UANON           TO CLMNOA
 11324     END-IF.
 11325
 11326     IF CLMCARRL GREATER ZERO
 11327         MOVE AL-UANON           TO CLMCARRA
 11328     END-IF.
 11329
 11330     IF CLMTYPEL GREATER ZERO
 11331         MOVE AL-UANON           TO CLMTYPEA
 11332     END-IF.
 11333
 11334     IF CERTNOL GREATER ZERO
 11335         MOVE AL-SANON           TO CERTNOA
 11336     END-IF.
 11337
 11338     IF SUFXL GREATER ZERO
 11339         MOVE AL-SANON           TO SUFXA
 11340     END-IF.
 11341
 11342 3993-EXIT.
 11343     EXIT.
 11344
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 217
* EL130.cbl
 11346 3994-BUILD-NINETY-THREE-TRAILER.
 11347
 11348     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11349     MOVE 'AT'                   TO AT-RECORD-ID.
 11350
 11351     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11352     MOVE CLMCARRI               TO AT-CARRIER.
 11353
 11354     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11355     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11356     MOVE +93                    TO AT-SEQUENCE-NO.
 11357     MOVE '6'                    TO AT-TRAILER-TYPE.
 11358     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11359
 11360     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'
 11361         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11362     ELSE
 11363         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11364     END-IF
 11365
 11366     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11367                                    AT-GEN-INFO-LAST-MAINT-DT.
 11368
 11369     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11370                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11371     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11372
 11373
 11374
 11375* EXEC CICS WRITE
 11376*        DATASET   (ELTRLR-DSID)
 11377*        FROM      (ACTIVITY-TRAILERS)
 11378*        RIDFLD    (AT-CONTROL-PRIMARY)
 11379*    END-EXEC.
 11380     MOVE LENGTH OF
 11381      ACTIVITY-TRAILERS
 11382       TO DFHEIV11
 11383*    MOVE '&$ L                  ''   #00010582' TO DFHEIV0
 11384     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11385     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11386     MOVE X'2020233030303130353832' TO DFHEIV0(25:11)
 11387     CALL 'kxdfhei1' USING DFHEIV0,
 11388           ELTRLR-DSID,
 11389           ACTIVITY-TRAILERS,
 11390           DFHEIV11,
 11391           AT-CONTROL-PRIMARY,
 11392           DFHEIV99,
 11393           DFHEIV99
 11394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11395
 11396
 11397 3994-EXIT.
 11398     EXIT.
 11399
 11400 3994B-BUILD-NINETY-FOUR-TRAILER.
 11401
 11402     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11403     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 218
* EL130.cbl
 11404
 11405     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11406     MOVE CLMCARRI               TO AT-CARRIER.
 11407
 11408     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11409     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11410     MOVE +94                    TO AT-SEQUENCE-NO.
 11411     MOVE '6'                    TO AT-TRAILER-TYPE.
 11412     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11413
 11414     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11415
 11416     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11417                                    AT-GEN-INFO-LAST-MAINT-DT.
 11418
 11419     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11420                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11421     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11422
 11423
 11424
 11425* EXEC CICS WRITE
 11426*        DATASET   (ELTRLR-DSID)
 11427*        FROM      (ACTIVITY-TRAILERS)
 11428*        RIDFLD    (AT-CONTROL-PRIMARY)
 11429*    END-EXEC.
 11430     MOVE LENGTH OF
 11431      ACTIVITY-TRAILERS
 11432       TO DFHEIV11
 11433*    MOVE '&$ L                  ''   #00010615' TO DFHEIV0
 11434     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11435     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11436     MOVE X'2020233030303130363135' TO DFHEIV0(25:11)
 11437     CALL 'kxdfhei1' USING DFHEIV0,
 11438           ELTRLR-DSID,
 11439           ACTIVITY-TRAILERS,
 11440           DFHEIV11,
 11441           AT-CONTROL-PRIMARY,
 11442           DFHEIV99,
 11443           DFHEIV99
 11444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11445
 11446
 11447 3994B-EXIT.
 11448     EXIT.
 11449 3994C-BUILD-NINETY-FIVE-TRAILER.
 11450
 11451     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11452     MOVE 'AT'                   TO AT-RECORD-ID
 11453
 11454     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11455     MOVE CLMCARRI               TO AT-CARRIER
 11456
 11457     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11458     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11459     MOVE +95                    TO AT-SEQUENCE-NO
 11460     MOVE '6'                    TO AT-TRAILER-TYPE
 11461     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 219
* EL130.cbl
 11462
 11463     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11464                                    AT-GEN-INFO-LAST-MAINT-DT
 11465
 11466     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11467                                    AT-GEN-INFO-LAST-UPDATED-BY
 11468     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11469
 11470     perform varying e1 from +1 by +1 until
 11471        ws-error-no (e1) = spaces
 11472        move ws-error-no (e1)    to at-note-error-no (e1)
 11473     end-perform
 11474
 11475     if at-info-line-1 not = spaces
 11476
 11477* EXEC CICS WRITE
 11478*          DATASET  (ELTRLR-DSID)
 11479*          FROM     (ACTIVITY-TRAILERS)
 11480*          RIDFLD   (AT-CONTROL-PRIMARY)
 11481*       END-EXEC
 11482     MOVE LENGTH OF
 11483      ACTIVITY-TRAILERS
 11484       TO DFHEIV11
 11485*    MOVE '&$ L                  ''   #00010650' TO DFHEIV0
 11486     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11487     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11488     MOVE X'2020233030303130363530' TO DFHEIV0(25:11)
 11489     CALL 'kxdfhei1' USING DFHEIV0,
 11490           ELTRLR-DSID,
 11491           ACTIVITY-TRAILERS,
 11492           DFHEIV11,
 11493           AT-CONTROL-PRIMARY,
 11494           DFHEIV99,
 11495           DFHEIV99
 11496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11497     end-if
 11498
 11499     .
 11500 3994C-EXIT.
 11501     EXIT.
 11502 3995-BUILD-CLAIM-RECORD.
 11503     IF PROCCDL GREATER ZERO
 11504         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11505     ELSE
 11506         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11507     END-IF.
 11508
 11509     IF FSTNMEL GREATER ZERO
 11510         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11511     END-IF.
 11512
 11513     IF INITL GREATER ZERO
 11514         MOVE INITI              TO CL-INSURED-MID-INIT
 11515     END-IF.
 11516
 11517     IF BIRTHDTL GREATER ZERO
 11518         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11519     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 220
* EL130.cbl
 11520
 11521     IF SEXL GREATER ZERO
 11522         MOVE SEXI               TO CL-INSURED-SEX-CD
 11523     END-IF.
 11524
 11525     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11526
 11527*    IF CLMTYPEL GREATER ZERO
 11528     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11529*    END-IF.
 11530
 11531     IF PREMTYPL GREATER ZERO
 11532         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11533     END-IF.
 11534
 11535     IF INCURL GREATER ZERO
 11536         MOVE WS-INCUR           TO CL-INCURRED-DT
 11537     END-IF.
 11538
 11539     IF (PI-COMPANY-ID = 'DCC' OR 'VPP')
 11540        AND (ERPDEF-FOUND)
 11541        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11542*       MOVE WS-CRIT-PER-RECURRENT
 11543*                                TO CL-CRIT-PER-RECURRENT
 11544*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11545        if ws-crit-per-recurrent > 01
 11546           move zeros            to cl-benefit-period
 11547        end-if
 11548     ELSE
 11549        IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
 11550           MOVE CM-LF-CRITICAL-PERIOD
 11551                                 TO CL-CRITICAL-PERIOD
 11552        ELSE
 11553           MOVE CM-AH-CRITICAL-PERIOD
 11554                                 TO CL-CRITICAL-PERIOD
 11555        END-IF
 11556     END-IF
 11557
 11558     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11559        COMPUTE DC-ELAPSED-MONTHS =
 11560           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11561        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11562        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11563        MOVE '6'                 TO DC-OPTION-CODE
 11564        PERFORM 9700-LINK-DATE-CONVERT
 11565                                 THRU 9700-EXIT
 11566        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11567     END-IF
 11568
 11569     if instypel > zero
 11570        move instypei            to cl-insured-type
 11571     end-if
 11572     IF REPORTL GREATER ZERO
 11573         MOVE WS-REPORT          TO CL-REPORTED-DT
 11574     END-IF.
 11575
 11576     IF EIBAID = DFHPF6
 11577         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 221
* EL130.cbl
 11578             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11579                 IF EMI-FORCABLE-CTR = +1
 11580                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11581                 END-IF
 11582         END-IF
 11583     END-IF.
 11584
 11585*    IF ESTENDL GREATER ZERO
 11586*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11587*    END-IF.
 11588
 11589     IF ADDONDTL GREATER ZERO
 11590         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11591     END-IF.
 11592
 11593*    IF CAUSEL GREATER ZERO
 11594*        MOVE CAUSEI             TO CL-CAUSE-CD
 11595*    END-IF.
 11596
 11597     IF SSNL GREATER ZERO
 11598         MOVE SSNI               TO CL-SOC-SEC-NO
 11599     ELSE
 11600         MOVE CERT-STATE         TO CL-SSN-STATE
 11601         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11602         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11603     END-IF.
 11604
 11605     IF PRICDL GREATER ZERO
 11606         MOVE PRICDI             TO CL-PRIORITY-CD
 11607     END-IF.
 11608
 11609     IF SUPVL GREATER ZERO
 11610         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11611     END-IF.
 11612
 11613     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11614     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11615     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11616
 11617     IF RELCLML GREATER ZERO
 11618         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11619     END-IF.
 11620
 11621     IF FILETOL GREATER ZERO
 11622         MOVE FILETOI            TO CL-FILE-LOCATION
 11623     END-IF.
 11624
 11625 3995-EXIT.
 11626      EXIT.
 11627 3996-read-cert-claim-trailer.
 11628
 11629     move cm-ah-benefit-amt      to ws-monthly-benefit
 11630     if (pi-dcc-max-amt < ws-monthly-benefit)
 11631        and (pi-dcc-max-amt not = zeros)
 11632        move pi-dcc-max-amt      to ws-monthly-benefit
 11633     end-if
 11634
 11635     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 222
* EL130.cbl
 11636     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11637     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11638     MOVE CM-STATE               TO CTRLR-STATE
 11639     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11640     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11641     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11642     MOVE 'B'                    TO CTRLR-REC-TYPE
 11643
 11644* EXEC CICS READ
 11645*       DATASET  (ELCRTT-DSID)
 11646*       set     (address of CERTIFICATE-TRAILERS)
 11647*       RIDFLD   (ELCRTT-KEY)
 11648*       RESP     (WS-RESPONSE)
 11649*    END-EXEC
 11650*    MOVE '&"S        E          (  N#00010801' TO DFHEIV0
 11651     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11652     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11653     MOVE X'204E233030303130383031' TO DFHEIV0(25:11)
 11654     CALL 'kxdfhei1' USING DFHEIV0,
 11655           ELCRTT-DSID,
 11656           DFHEIV20,
 11657           DFHEIV99,
 11658           ELCRTT-KEY,
 11659           DFHEIV99,
 11660           DFHEIV99,
 11661           DFHEIV99
 11662     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11663         DFHEIV20
 11664     MOVE EIBRESP  TO WS-RESPONSE
 11665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11666***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11667***                                                            ***
 11668***  This may need some work here. I think I should accumulate ***
 11669***  all the claims with the same claim type?????????          ***
 11670***                                                            ***
 11671***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11672     IF WS-RESP-NORMAL
 11673        move zeros to ws-tot-days-paid ws-tot-amt-paid
 11674        perform varying s1 from +1 by +1 until
 11675           (s1 > +24)
 11676           or (cs-claim-no (s1) = spaces)
 11677           if cs-claim-type (s1) = clmtypei
 11678              move er-1659       to ws-error-no (e1)
 11679              compute ws-tot-days-paid =
 11680                 ws-tot-days-paid + cs-days-paid (s1)
 11681              compute ws-tot-amt-paid =
 11682                 ws-tot-amt-paid + cs-total-paid (s1)
 11683           end-if
 11684        end-perform
 11685*        compute ws-pd-bens rounded = ws-tot-days-paid / 30
 11686*        if (ws-pd-bens >= pi-dcc-max-benefits)
 11687*           and (pi-dcc-max-benefits not = zeros)
 11688*           add +1                to e1
 11689*           MOVE ER-1660          TO EMI-ERROR
 11690*                                    ws-error-no (e1)
 11691*           PERFORM 9900-ERROR-FORMAT
 11692*                                 THRU 9900-EXIT
 11693*        end-if
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 223
* EL130.cbl
 11694     end-if
 11695**       if instypei = 'P'
 11696**          move +1 to s1
 11697**       else
 11698**          MOVE +2 to s1
 11699**       end-if
 11700*
 11701*        move +1 to s1
 11702*        evaluate clmtypei
 11703*           when 'A'
 11704*              move +1 to s2
 11705*           when 'I'
 11706*              move +2 to s2
 11707*           when 'G'
 11708*              move +3 to s2
 11709*           when 'L'
 11710*              move +4 to s2
 11711*           when 'P'
 11712*              move +5 to s2
 11713*        end-evaluate
 11714*        if cs-claim-type (s1 s2) = clmtypei
 11715*           if cs-no-of-claims (s1 s2) > zeros
 11716*              move er-1659       to ws-error-no (e1)
 11717*           end-if
 11718*           compute WS-BENEFITS-PREV-PAID =
 11719*              cs-total-paid (s1 s2) / ws-monthly-benefit
 11720*           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11721*              and (pi-dcc-max-benefits not = zeros)
 11722*              add +1             to e1
 11723*              MOVE ER-1660       TO EMI-ERROR
 11724*                                    ws-error-no (e1)
 11725*              PERFORM 9900-ERROR-FORMAT
 11726*                                 THRU 9900-EXIT
 11727*           end-if
 11728*        end-if
 11729*     end-if
 11730
 11731     .
 11732 3996-exit.
 11733     exit.
 11734
 11735 3997-GET-ERPDEF.
 11736
 11737     if cm-clp-state = spaces or low-values or zeros
 11738        move cm-state            to cm-clp-state
 11739     end-if
 11740     MOVE SPACES                 TO WS-ERPDEF-SW
 11741     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11742                                    WS-CRIT-PER-RTW-MOS
 11743                                    WS-CRIT-PER-RECURRENT
 11744
 11745     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11746     MOVE CM-clp-state        TO ERPDEF-STATE
 11747     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11748***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11749***                                                            ***
 11750***  If they set up a claim where there is no coverage on the  ***
 11751***  addendum with the intention of denying.  We need to do    ***
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 224
* EL130.cbl
 11752***  some funky stuff here.                                    ***
 11753***                                                            ***
 11754***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11755
 11756     evaluate true
 11757        when (clmtypei = 'L' or 'P')
 11758           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 11759              and 'CU')
 11760           move 'L'              to erpdef-ben-type
 11761           move cm-lf-benefit-cd to erpdef-ben-code
 11762        when (clmtypei not = 'L' and 'P')
 11763           and (cm-ah-benefit-cd not = '00' and '  ')
 11764           move 'A'              to erpdef-ben-type
 11765           move cm-ah-benefit-cd to erpdef-ben-code
 11766        when (clmtypei not = 'L' and 'P')
 11767           and (cm-ah-benefit-cd = '00' or '  ')
 11768           move 'L'              to erpdef-ben-type
 11769           move cm-lf-benefit-cd to erpdef-ben-code
 11770        when (clmtypei = 'L' or 'P')
 11771           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 11772           move 'A'              to erpdef-ben-type
 11773           move cm-ah-benefit-cd to erpdef-ben-code
 11774        when other
 11775           move 'A'              to erpdef-ben-type
 11776           move cm-ah-benefit-cd to erpdef-ben-code
 11777     end-evaluate
 11778*    MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11779*    MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11780     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11781     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11782
 11783
 11784* EXEC CICS STARTBR
 11785*        DATASET  ('ERPDEF')
 11786*        RIDFLD   (ERPDEF-KEY)
 11787*        GTEQ
 11788*        RESP     (WS-RESPONSE)
 11789*    END-EXEC
 11790     MOVE 'ERPDEF' TO DFHEIV1
 11791     MOVE 0
 11792       TO DFHEIV11
 11793*    MOVE '&,         G          &  N#00010924' TO DFHEIV0
 11794     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11795     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11796     MOVE X'204E233030303130393234' TO DFHEIV0(25:11)
 11797     CALL 'kxdfhei1' USING DFHEIV0,
 11798           DFHEIV1,
 11799           ERPDEF-KEY,
 11800           DFHEIV99,
 11801           DFHEIV11,
 11802           DFHEIV99
 11803     MOVE EIBRESP  TO WS-RESPONSE
 11804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11805
 11806     IF WS-RESP-NORMAL
 11807
 11808* EXEC CICS READNEXT
 11809*          DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 225
* EL130.cbl
 11810*          INTO     (PRODUCT-MASTER)
 11811*          RIDFLD   (ERPDEF-KEY)
 11812*          RESP     (WS-RESPONSE)
 11813*       END-EXEC
 11814     MOVE LENGTH OF
 11815      PRODUCT-MASTER
 11816       TO DFHEIV12
 11817     MOVE 'ERPDEF' TO DFHEIV1
 11818     MOVE 0
 11819       TO DFHEIV11
 11820*    MOVE '&.IL                  )  N#00010932' TO DFHEIV0
 11821     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11822     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11823     MOVE X'204E233030303130393332' TO DFHEIV0(25:11)
 11824     CALL 'kxdfhei1' USING DFHEIV0,
 11825           DFHEIV1,
 11826           PRODUCT-MASTER,
 11827           DFHEIV12,
 11828           ERPDEF-KEY,
 11829           DFHEIV99,
 11830           DFHEIV11,
 11831           DFHEIV99,
 11832           DFHEIV99
 11833     MOVE EIBRESP  TO WS-RESPONSE
 11834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11835
 11836        IF WS-RESP-NORMAL
 11837           IF (ERPDEF-KEY-SAVE (1:16) =
 11838              PD-CONTROL-PRIMARY (1:16))
 11839              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11840
 11841              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11842                 (A1 > +8)
 11843                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11844              END-PERFORM
 11845              IF A1 < +9
 11846                 SET ERPDEF-FOUND TO TRUE
 11847                 move pd-max-amt (a1)
 11848                              to pi-dcc-max-amt
 11849                 MOVE PD-CRIT-PERIOD (A1)
 11850                              TO WS-MAX-BENEFITS
 11851                                 pi-dcc-max-benefits
 11852                 if pd-rec-crit-period (a1) not numeric
 11853                    move 01      to pd-rec-crit-period (a1)
 11854                 end-if
 11855                 MOVE PD-REC-CRIT-PERIOD (A1)
 11856                              TO WS-CRIT-PER-RECURRENT
 11857                 IF PD-RTW-MOS (A1) NUMERIC
 11858                    MOVE PD-RTW-MOS (A1)
 11859                              TO WS-CRIT-PER-RTW-MOS
 11860                 ELSE
 11861                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11862                 END-IF
 11863                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11864                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11865                                 TO WS-EXCL-PERIOD
 11866                 END-IF
 11867                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 226
* EL130.cbl
 11868                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11869                                 TO WS-COV-ENDS
 11870                 END-IF
 11871                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11872                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11873                                 TO WS-ACC-PERIOD
 11874                 END-IF
 11875                 IF PD-PRE-EXIST-EXCL-TYPE (A1) NUMERIC
 11876                    MOVE PD-PRE-EXIST-EXCL-TYPE (A1)
 11877                                 TO WS-PRE-EXISTING-PER
 11878                 END-IF
 11879              else
 11880                 MOVE -1         TO MAINTL
 11881                 move er-1673    to emi-error
 11882                 PERFORM 9900-ERROR-FORMAT
 11883                                 THRU 9900-EXIT
 11884              END-IF
 11885           else
 11886              MOVE -1            TO MAINTL
 11887              move er-1671       to emi-error
 11888              PERFORM 9900-ERROR-FORMAT
 11889                                 THRU 9900-EXIT
 11890           END-IF
 11891        END-IF
 11892     END-IF
 11893
 11894     .
 11895 3997-EXIT.
 11896     EXIT.
 11897
 11898 3998-update-cert-claim-trailer.
 11899
 11900
 11901* EXEC CICS GETMAIN
 11902*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11903*       LENGTH   (ELCRTT-LENGTH)
 11904*       INITIMG  (GETMAIN-SPACE)
 11905*    END-EXEC
 11906*    MOVE ',"IL                  $   #00011003' TO DFHEIV0
 11907     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11908     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11909     MOVE X'2020233030303131303033' TO DFHEIV0(25:11)
 11910     CALL 'kxdfhei1' USING DFHEIV0,
 11911           DFHEIV20,
 11912           ELCRTT-LENGTH,
 11913           GETMAIN-SPACE
 11914     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11915         DFHEIV20
 11916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11917
 11918     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11919     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11920     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11921     MOVE CM-STATE         TO CTRLR-STATE
 11922     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11923     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11924     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11925     MOVE 'B'              TO CTRLR-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 227
* EL130.cbl
 11926
 11927* EXEC CICS READ
 11928*       UPDATE
 11929*       DATASET  (ELCRTT-DSID)
 11930*       into     (CERTIFICATE-TRAILERS)
 11931*       RIDFLD   (ELCRTT-KEY)
 11932*       RESP     (WS-RESPONSE)
 11933*    END-EXEC
 11934     MOVE LENGTH OF
 11935      CERTIFICATE-TRAILERS
 11936       TO DFHEIV11
 11937*    MOVE '&"IL       EU         (  N#00011017' TO DFHEIV0
 11938     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11939     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11940     MOVE X'204E233030303131303137' TO DFHEIV0(25:11)
 11941     CALL 'kxdfhei1' USING DFHEIV0,
 11942           ELCRTT-DSID,
 11943           CERTIFICATE-TRAILERS,
 11944           DFHEIV11,
 11945           ELCRTT-KEY,
 11946           DFHEIV99,
 11947           DFHEIV99,
 11948           DFHEIV99
 11949     MOVE EIBRESP  TO WS-RESPONSE
 11950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11951     IF WS-RESP-NORMAL
 11952        perform varying s1 from +1 by +1 until
 11953           (s1 > +24)
 11954           or (cs-claim-no (s1) = spaces)
 11955        end-perform
 11956        if s1 < +25
 11957           perform 3999-upd-crt-trlr thru 3999-exit
 11958
 11959* EXEC CICS REWRITE
 11960*             DATASET  (ELCRTT-DSID)
 11961*             from     (CERTIFICATE-TRAILERS)
 11962*             RESP     (WS-RESPONSE)
 11963*          END-EXEC
 11964     MOVE LENGTH OF
 11965      CERTIFICATE-TRAILERS
 11966       TO DFHEIV11
 11967*    MOVE '&& L                  %  N#00011031' TO DFHEIV0
 11968     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11969     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11970     MOVE X'204E233030303131303331' TO DFHEIV0(25:11)
 11971     CALL 'kxdfhei1' USING DFHEIV0,
 11972           ELCRTT-DSID,
 11973           CERTIFICATE-TRAILERS,
 11974           DFHEIV11,
 11975           DFHEIV99
 11976     MOVE EIBRESP  TO WS-RESPONSE
 11977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11978        end-if
 11979     else
 11980        if ws-resp-notfnd
 11981           move 'CS'             to certificate-trailers
 11982           move cm-control-primary to cs-control-primary
 11983           move 'B'              to cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 228
* EL130.cbl
 11984           perform varying s1 from +1 by +1 until s1 > +24
 11985              move zeros         to cs-days-paid (s1)
 11986                                    cs-total-paid (s1)
 11987                                    cs-benefit-period (s1)
 11988                                    cs-remaining-bens (s1)
 11989           end-perform
 11990           move +1               to s1
 11991           perform 3999-upd-crt-trlr
 11992                                 thru 3999-exit
 11993
 11994* EXEC CICS WRITE
 11995*             DATASET  (ELCRTT-DSID)
 11996*             from     (CERTIFICATE-TRAILERS)
 11997*             RIDFLD   (cs-control-primary)
 11998*             RESP     (WS-RESPONSE)
 11999*          END-EXEC
 12000     MOVE LENGTH OF
 12001      CERTIFICATE-TRAILERS
 12002       TO DFHEIV11
 12003*    MOVE '&$ L                  ''  N#00011051' TO DFHEIV0
 12004     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12005     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12006     MOVE X'204E233030303131303531' TO DFHEIV0(25:11)
 12007     CALL 'kxdfhei1' USING DFHEIV0,
 12008           ELCRTT-DSID,
 12009           CERTIFICATE-TRAILERS,
 12010           DFHEIV11,
 12011           cs-control-primary,
 12012           DFHEIV99,
 12013           DFHEIV99
 12014     MOVE EIBRESP  TO WS-RESPONSE
 12015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12016        end-if
 12017     END-IF
 12018
 12019     .
 12020 3998-exit.
 12021     exit.
 12022
 12023 3999-upd-crt-trlr.
 12024     move clmnoi                 to cs-claim-no       (s1)
 12025     move clmtypei               to cs-claim-type     (s1)
 12026     move instypei               to cs-insured-type   (s1)
 12027     if ws-crit-per-recurrent > 01
 12028        move zeros               to cs-benefit-period(s1)
 12029     else
 12030        move 01                  to cs-benefit-period(s1)
 12031     end-if
 12032*    move cl-benefit-period      to cs-benefit-period (s1)
 12033*    move cl-critical-period     to cs-remaining-bens (s1)
 12034     move zeros                  to cs-remaining-bens (s1)
 12035     .
 12036 3999-exit.
 12037     exit.
 12038 4000-CALCULATE-CERT-TERM.
 12039
 12040     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 12041
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 229
* EL130.cbl
 12042     MOVE N                      TO WS-TERM.
 12043
 12044     IF WS-TERM GREATER 120
 12045         MOVE 120                TO WS-TERM
 12046     END-IF.
 12047
 12048 4000-CALC-TERM-EXIT.
 12049      EXIT.
 12050
 12051 4100-CALC-GROSS-TERM.
 12052     MOVE HOLD-LOAN-BAL           TO L.
 12053     MOVE WS-ACVBENE              TO M.
 12054     COMPUTE N = L / M.
 12055     IF N LESS 1
 12056         MOVE 1  TO N
 12057     END-IF.
 12058
 12059     IF LCVCDL GREATER ZERO
 12060         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 12061     ELSE
 12062         MOVE ZEROS               TO WS-LF-RATE
 12063     END-IF.
 12064
 12065     IF ACVCDL GREATER ZERO
 12066         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 12067     ELSE
 12068         MOVE ZEROS               TO WS-AH-RATE
 12069     END-IF.
 12070
 12071     COMPUTE I = WS-APR / +1200.
 12072
 12073 4105-LOOP.
 12074     IF N GREATER 240
 12075         GO TO 4200-EXIT
 12076     END-IF.
 12077
 12078     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 12079
 12080     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 12081         ADD 1 TO N
 12082         GO TO 4105-LOOP
 12083     END-IF.
 12084
 12085 4200-EXIT.
 12086      EXIT.
 12087
 12088 4210-CALC-LEFT-RIGHTONE.
 12089      MOVE L         TO LEFT-TOT-1.
 12090      SUBTRACT 1 FROM N.
 12091      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12092      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 12093      ADD 1 TO N.
 12094
 12095 4211-CALC-TERM1.
 12096      MOVE N         TO TERM1.
 12097      MULTIPLY M BY TERM1.
 12098
 12099 4212-LOOP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 230
* EL130.cbl
 12100      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 12101      ADD 1 TO A-N.
 12102      MULTIPLY A-N BY TERM1.
 12103      SUBTRACT 1 FROM A-N.
 12104      ADD TERM1 TO LEFT-TOT-1.
 12105
 12106 4213-CALC-TERM2.
 12107      MOVE M         TO TERM2.
 12108      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 12109      MULTIPLY IA-N BY TERM2.
 12110      SUBTRACT TERM2 FROM LEFT-TOT-1.
 12111
 12112 4215-CALC-RIGHTONE.
 12113      MOVE M         TO RIGHT-TOT-1.
 12114      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12115      MULTIPLY A-N BY RIGHT-TOT-1.
 12116
 12117 4220-EXIT.
 12118      EXIT.
 12119
 12120 4300-CALC-A-N.
 12121     IF N LESS 1
 12122         MOVE 0     TO A-N
 12123         GO TO 4300-EXIT
 12124     END-IF.
 12125
 12126     IF I = 0
 12127         MOVE .00001 TO I
 12128     END-IF.
 12129
 12130     ADD 1 TO I.
 12131     DIVIDE I INTO 1 GIVING V.
 12132     SUBTRACT 1 FROM I.
 12133     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12134     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 12135     DIVIDE I INTO TERM3 GIVING A-N.
 12136
 12137 4300-EXIT.
 12138      EXIT.
 12139
 12140 4350-CALC-IA-N.
 12141     IF N LESS 1
 12142         MOVE 0      TO IA-N
 12143         GO TO 4400-EXIT
 12144     END-IF.
 12145
 12146     ADD 1 TO N.
 12147     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12148     SUBTRACT 1 FROM N.
 12149     MULTIPLY N BY V-EX-N GIVING TERM3.
 12150     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 12151     SUBTRACT V FROM 1 GIVING TERM4.
 12152     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 12153
 12154 4400-EXIT.
 12155      EXIT.
 12156
 12157 4450-CALC-V-EX-N.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 231
* EL130.cbl
 12158     IF N LESS 1
 12159         MOVE 1    TO V-EX-N
 12160         GO TO 4490-EXIT
 12161     END-IF.
 12162
 12163     MOVE N        TO NV-STORE.
 12164
 12165     IF V-EX-ONETIME = 1  OR
 12166        V NOT = V-EXPONENT (1)
 12167          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 12168     END-IF.
 12169
 12170 4460-LOOP.
 12171     IF N GREATER 248
 12172         MOVE 248 TO N
 12173     END-IF.
 12174
 12175     IF N = 1
 12176         MOVE V               TO V-EX-N
 12177     ELSE
 12178         MOVE V-EXPONENT (N)  TO V-EX-N
 12179     END-IF.
 12180
 12181     GO TO 4490-EXIT.
 12182
 12183 4470-BUILD-V-EX-TABLE.
 12184     MOVE 2      TO N.
 12185     MOVE V      TO V-EXPONENT (1)
 12186                    V-EX-N.
 12187
 12188 4471-LOOP.
 12189     MULTIPLY V BY V-EX-N.
 12190     MOVE V-EX-N   TO V-EXPONENT (N).
 12191
 12192     ADD 1 TO N.
 12193     IF N LESS 248
 12194         GO TO 4471-LOOP
 12195     END-IF.
 12196
 12197     MOVE NV-STORE     TO N.
 12198     MOVE ZERO         TO V-EX-ONETIME.
 12199
 12200 4480-EXIT.
 12201      EXIT.
 12202
 12203 4490-EXIT.
 12204      EXIT.
 12205
 12206 4500-CALC-NET-TERM.
 12207     MOVE HOLD-LOAN-BAL           TO L.
 12208     MOVE WS-ACVBENE              TO M.
 12209     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 12210
 12211     IF WS-REMAIN GREATER ZERO
 12212         ADD 1 TO N
 12213     END-IF.
 12214
 12215     IF N = 0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 232
* EL130.cbl
 12216         MOVE 1 TO N
 12217     END-IF.
 12218
 12219 4700-EXIT.
 12220      EXIT.
 12221
 12222 4999-CALC-TERM-EXIT.
 12223     EXIT.
 12224
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 233
* EL130.cbl
 12226 5000-INCURRED-CHANGE.
 12227     IF NOT MODIFY-CAP
 12228         MOVE ER-0070            TO EMI-ERROR
 12229         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12230         MOVE -1                 TO MAINTL
 12231         GO TO 8200-SEND-DATAONLY
 12232     END-IF.
 12233
 12234     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 12235        CLMCARRI     NOT = PI-LAST-CARR        OR
 12236        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 12237        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 12238        PI-INCURR-SW NOT = 'Y'
 12239          GO TO 1000-SHOW-CLAIM
 12240     END-IF.
 12241
 12242     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 12243     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 12244     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 12245
 12246     IF EMI-NO-ERRORS
 12247         GO TO 5000-TRY-TO-BUILD
 12248     END-IF.
 12249
 12250     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 12251        MOVE ER-0433             TO EMI-ERROR
 12252        MOVE -1                  TO MAINTL
 12253        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12254        GO TO 8200-SEND-DATAONLY
 12255     END-IF.
 12256
 12257     IF EIBAID = DFHPF6
 12258         IF EMI-FATAL-CTR NOT EQUAL ZERO
 12259            MOVE ER-0434         TO EMI-ERROR
 12260            MOVE -1              TO MAINTL
 12261            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12262            GO TO 8200-SEND-DATAONLY
 12263         ELSE
 12264            MOVE +1              TO INCURL
 12265            GO TO 5000-TRY-TO-BUILD
 12266         END-IF
 12267     END-IF.
 12268
 12269     GO TO 8200-SEND-DATAONLY.
 12270
 12271 5000-TRY-TO-BUILD.
 12272
 12273     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 12274
 12275     MOVE CLMCARRI               TO MSTR-CARRIER.
 12276
 12277     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 12278     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 12279     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 12280
 12281     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 12282
 12283     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 234
* EL130.cbl
 12284         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 12285     END-IF.
 12286
 12287     IF CL-PURGED-DT NOT = LOW-VALUES
 12288
 12289
 12290* EXEC CICS UNLOCK
 12291*            DATASET   (ELMSTR-DSID)
 12292*        END-EXEC
 12293*    MOVE '&*                    #   #00011330' TO DFHEIV0
 12294     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12295     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12296     MOVE X'2020233030303131333330' TO DFHEIV0(25:11)
 12297     CALL 'kxdfhei1' USING DFHEIV0,
 12298           ELMSTR-DSID,
 12299           DFHEIV99
 12300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12301         MOVE ER-7691            TO EMI-ERROR
 12302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12303         MOVE -1                 TO MAINTL
 12304         GO TO 8200-SEND-DATAONLY
 12305     END-IF.
 12306
 12307     IF CL-AUTO-PAY-SEQ NOT = ZERO
 12308
 12309
 12310* EXEC CICS UNLOCK
 12311*            DATASET   (ELMSTR-DSID)
 12312*       END-EXEC
 12313*    MOVE '&*                    #   #00011341' TO DFHEIV0
 12314     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12315     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12316     MOVE X'2020233030303131333431' TO DFHEIV0(25:11)
 12317     CALL 'kxdfhei1' USING DFHEIV0,
 12318           ELMSTR-DSID,
 12319           DFHEIV99
 12320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12321         MOVE ER-0523             TO EMI-ERROR
 12322         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12323         MOVE -1                  TO MAINTL
 12324         GO TO 8200-SEND-DATAONLY
 12325     END-IF.
 12326
 12327     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 12328
 12329     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 12330     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 12331     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 12332     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 12333     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 12334
 12335     IF MANRSVL GREATER ZERO
 12336        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 12337                                    AT-CURRENT-MANUAL-RESERVE
 12338     END-IF.
 12339     MOVE 1                      TO SUB.
 12340
 12341 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 235
* EL130.cbl
 12342     IF SUB = 1
 12343        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 12344        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 12345        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 12346     ELSE
 12347        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 12348        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 12349                                    AT-OPEN-CLOSE-REASON (SUB)
 12350     END-IF.
 12351
 12352     IF SUB NOT = 6
 12353        ADD 1                    TO SUB
 12354        GO TO 5010-LOOP
 12355     END-IF.
 12356
 12357 5020-UPDATE.
 12358
 12359     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12360
 12361     IF DIAGL = ZERO
 12362       AND ICD1L = ZERO
 12363       AND ICD2L = ZERO
 12364         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 12365         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 12366         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 12367         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 12368         GO TO 5025-BYPASS-UPDATE
 12369     END-IF.
 12370
 12371     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 12372
 12373     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 12374     IF DIAGL NOT = ZERO
 12375         MOVE DIAGI              TO AT-INFO-LINE-1
 12376     END-IF.
 12377
 12378     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 12379     IF ICD1L NOT = ZERO
 12380         MOVE ICD1I              TO AT-ICD-CODE-1
 12381     END-IF.
 12382
 12383     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 12384     IF ICD2L NOT = ZERO
 12385         MOVE ICD2I              TO AT-ICD-CODE-2
 12386     END-IF.
 12387
 12388     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12389
 12390 5025-BYPASS-UPDATE.
 12391
 12392
 12393
 12394* EXEC CICS GETMAIN
 12395*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12396*        LENGTH   (ELTRLR-LENGTH)
 12397*    END-EXEC.
 12398*    MOVE '," L                  $   #00011416' TO DFHEIV0
 12399     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 236
* EL130.cbl
 12400     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12401     MOVE X'2020233030303131343136' TO DFHEIV0(25:11)
 12402     CALL 'kxdfhei1' USING DFHEIV0,
 12403           DFHEIV20,
 12404           ELTRLR-LENGTH,
 12405           DFHEIV99
 12406     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12407         DFHEIV20
 12408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12409
 12410
 12411     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12412     MOVE 'AT'                   TO AT-RECORD-ID.
 12413
 12414     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12415     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12416     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12417     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12418     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12419     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12420     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12421     MOVE '9'                    TO AT-TRAILER-TYPE.
 12422     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12423     MOVE '5'                    TO DC-OPTION-CODE.
 12424     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12425     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12426
 12427     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12428     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12429
 12430     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12431     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12432     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12433     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12434     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12435     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12436     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12437     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12438     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12439     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12440     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12441     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12442
 12443     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12444     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12445     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12446     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12447     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12448
 12449
 12450
 12451* EXEC CICS WRITE
 12452*        DATASET   (ELTRLR-DSID)
 12453*        FROM      (ACTIVITY-TRAILERS)
 12454*        RIDFLD    (AT-CONTROL-PRIMARY)
 12455*    END-EXEC.
 12456     MOVE LENGTH OF
 12457      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 237
* EL130.cbl
 12458       TO DFHEIV11
 12459*    MOVE '&$ L                  ''   #00011460' TO DFHEIV0
 12460     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12461     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12462     MOVE X'2020233030303131343630' TO DFHEIV0(25:11)
 12463     CALL 'kxdfhei1' USING DFHEIV0,
 12464           ELTRLR-DSID,
 12465           ACTIVITY-TRAILERS,
 12466           DFHEIV11,
 12467           AT-CONTROL-PRIMARY,
 12468           DFHEIV99,
 12469           DFHEIV99
 12470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12471
 12472
 12473     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12474     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12475     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12476     MOVE CL-CERT-STATE          TO CERT-STATE.
 12477     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12478     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12479     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12480
 12481
 12482
 12483* EXEC CICS HANDLE CONDITION
 12484*        NOTFND   (5050-CERT-NOT-FOUND)
 12485*    END-EXEC.
 12486*    MOVE '"$I                   ! < #00011475' TO DFHEIV0
 12487     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12489     MOVE X'3C20233030303131343735' TO DFHEIV0(25:11)
 12490     CALL 'kxdfhei1' USING DFHEIV0
 12491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12492
 12493
 12494     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12495
 12496     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12497
 12498
 12499
 12500* EXEC CICS HANDLE CONDITION
 12501*         DUPKEY   (5030-CERT-WRITTEN)
 12502*    END-EXEC.
 12503*    MOVE '"$$                   ! = #00011484' TO DFHEIV0
 12504     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12505     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12506     MOVE X'3D20233030303131343834' TO DFHEIV0(25:11)
 12507     CALL 'kxdfhei1' USING DFHEIV0
 12508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12509
 12510
 12511
 12512
 12513* EXEC CICS REWRITE
 12514*        DATASET  (ELCERT-DSID)
 12515*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 238
* EL130.cbl
 12516*    END-EXEC.
 12517     MOVE LENGTH OF
 12518      CERTIFICATE-MASTER
 12519       TO DFHEIV11
 12520*    MOVE '&& L                  %   #00011489' TO DFHEIV0
 12521     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12522     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12523     MOVE X'2020233030303131343839' TO DFHEIV0(25:11)
 12524     CALL 'kxdfhei1' USING DFHEIV0,
 12525           ELCERT-DSID,
 12526           CERTIFICATE-MASTER,
 12527           DFHEIV11,
 12528           DFHEIV99
 12529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12530
 12531
 12532 5030-CERT-WRITTEN.
 12533
 12534     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12535                                    CL-INCURRED-DT
 12536                                    CL-REPORTED-DT
 12537                                    CL-EST-END-OF-DISAB-DT
 12538                                    CL-PAID-THRU-DT.
 12539
 12540     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12541                                    CL-NO-OF-PMTS-MADE
 12542                                    CL-NO-OF-DAYS-PAID.
 12543
 12544     IF CLAIM-IS-CLOSED
 12545        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12546        MOVE 'O'                 TO CL-CLAIM-STATUS
 12547     END-IF.
 12548
 12549     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12550     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12551     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12552
 12553
 12554
 12555* EXEC CICS HANDLE CONDITION
 12556*         DUPKEY   (5035-CLAIM-WRITTEN)
 12557*    END-EXEC.
 12558*    MOVE '"$$                   ! > #00011516' TO DFHEIV0
 12559     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12561     MOVE X'3E20233030303131353136' TO DFHEIV0(25:11)
 12562     CALL 'kxdfhei1' USING DFHEIV0
 12563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12564
 12565
 12566
 12567
 12568* EXEC CICS REWRITE
 12569*        DATASET   (ELMSTR-DSID)
 12570*        FROM      (CLAIM-MASTER)
 12571*    END-EXEC.
 12572     MOVE LENGTH OF
 12573      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 239
* EL130.cbl
 12574       TO DFHEIV11
 12575*    MOVE '&& L                  %   #00011521' TO DFHEIV0
 12576     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12577     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12578     MOVE X'2020233030303131353231' TO DFHEIV0(25:11)
 12579     CALL 'kxdfhei1' USING DFHEIV0,
 12580           ELMSTR-DSID,
 12581           CLAIM-MASTER,
 12582           DFHEIV11,
 12583           DFHEIV99
 12584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12585
 12586
 12587 5035-CLAIM-WRITTEN.
 12588
 12589     MOVE ER-0000                TO EMI-ERROR.
 12590     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12591
 12592     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12593     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12594     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12595     MOVE CLMCARRI               TO PI-LAST-CARR.
 12596
 12597     IF PRTOPTL GREATER ZERO
 12598         MOVE PRTOPTI            TO PI-PRT-OPT
 12599     END-IF.
 12600
 12601     IF ALTPRTL GREATER ZERO
 12602         MOVE ALTPRTI            TO PI-ALT-PRT
 12603     END-IF.
 12604
 12605     MOVE LOW-VALUES             TO EL130AI.
 12606
 12607     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12608     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12609     MOVE PI-LAST-CARR           TO CLMCARRO.
 12610     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12611
 12612     IF PI-PRT-OPT = 'N' OR 'L'
 12613         MOVE PI-PRT-OPT         TO PRTOPTO
 12614         MOVE 1                  TO PRTOPTL
 12615     END-IF.
 12616
 12617     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12618         MOVE PI-ALT-PRT         TO ALTPRTO
 12619         MOVE 4                  TO ALTPRTL
 12620     END-IF.
 12621
 12622     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12623     MOVE AL-SANON               TO CERTNOA SUFXA.
 12624
 12625     MOVE SPACES                 TO PI-INCURR-SW.
 12626
 12627     IF PRTOPTL GREATER ZERO
 12628         IF PRTOPTI = 'L'
 12629             GO TO 0400-CREATE-ELACTQ
 12630         ELSE
 12631             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 240
* EL130.cbl
 12632         END-IF
 12633     END-IF.
 12634
 12635     GO TO 8100-SEND-INITIAL-MAP.
 12636
 12637 5050-CERT-NOT-FOUND.
 12638
 12639     MOVE ER-0244                TO EMI-ERROR.
 12640     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12641     MOVE -1                     TO CERTNOL.
 12642     GO TO 8200-SEND-DATAONLY.
 12643
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 241
* EL130.cbl
 12645 5500-BUILD-FORM-TRAILER.
 12646*************************************************************
 12647*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12648*************************************************************
 12649
 12650     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12651
 12652     IF  WS-BEN-ALPHA-2 = '30'
 12653         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12654         MOVE '6'                TO DC-OPTION-CODE
 12655         IF CL-CARRIER = 'C'
 12656             MOVE +14            TO DC-ELAPSED-DAYS
 12657             MOVE +0             TO DC-ELAPSED-MONTHS
 12658             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12659             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12660         ELSE
 12661             MOVE +21            TO DC-ELAPSED-DAYS
 12662             MOVE +0             TO DC-ELAPSED-MONTHS
 12663             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12664             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12665         END-IF
 12666     END-IF.
 12667
 12668
 12669
 12670* EXEC CICS GETMAIN
 12671*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12672*         LENGTH   (ELTRLR-LENGTH)
 12673*         INITIMG  (GETMAIN-SPACE)
 12674*    END-EXEC.
 12675*    MOVE ',"IL                  $   #00011608' TO DFHEIV0
 12676     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12677     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12678     MOVE X'2020233030303131363038' TO DFHEIV0(25:11)
 12679     CALL 'kxdfhei1' USING DFHEIV0,
 12680           DFHEIV20,
 12681           ELTRLR-LENGTH,
 12682           GETMAIN-SPACE
 12683     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12684         DFHEIV20
 12685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12686
 12687
 12688     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12689     MOVE 'AT'                   TO AT-RECORD-ID.
 12690
 12691     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12692     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12693     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12694     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12695                                    AT-FORM-LAST-MAINT-DT.
 12696     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12697                                    AT-FORM-LAST-UPDATED-BY.
 12698     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12699     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12700     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12701                                    AT-FORM-RE-SEND-DT
 12702                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 242
* EL130.cbl
 12703                                    AT-EMP-FORM-ANSWERED-DT
 12704                                    AT-PHY-FORM-ANSWERED-DT
 12705                                    AT-EMP-FORM-SEND-ON-DT
 12706                                    AT-FORM-PRINTED-DT
 12707                                    AT-FORM-REPRINT-DT.
 12708     MOVE '1'                    TO AT-FORM-TYPE.
 12709
 12710     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12711                                    AT-INSTRUCT-LN-2
 12712                                    AT-INSTRUCT-LN-3.
 12713
 12714     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12715     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12716
 12717     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12718
 12719     IF AM-EMPLOYER-STMT-USED = 'Y'
 12720        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12721     END-IF.
 12722
 12723
 12724
 12725* EXEC CICS WRITE
 12726*         DATASET  (ELTRLR-DSID)
 12727*         FROM     (ACTIVITY-TRAILERS)
 12728*         RIDFLD   (AT-CONTROL-PRIMARY)
 12729*    END-EXEC.
 12730     MOVE LENGTH OF
 12731      ACTIVITY-TRAILERS
 12732       TO DFHEIV11
 12733*    MOVE '&$ L                  ''   #00011650' TO DFHEIV0
 12734     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12735     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12736     MOVE X'2020233030303131363530' TO DFHEIV0(25:11)
 12737     CALL 'kxdfhei1' USING DFHEIV0,
 12738           ELTRLR-DSID,
 12739           ACTIVITY-TRAILERS,
 12740           DFHEIV11,
 12741           AT-CONTROL-PRIMARY,
 12742           DFHEIV99,
 12743           DFHEIV99
 12744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12745
 12746
 12747 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 243
* EL130.cbl
 12749*************************************************************
 12750*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12751*************************************************************
 12752
 12753 5700-BUILD-ARCHIVE-HEADER.
 12754
 12755     MOVE '1'                    TO CNTL-REC-TYPE.
 12756     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12757     MOVE SPACES                 TO CNTL-ACCESS.
 12758
 12759
 12760
 12761* EXEC CICS READ
 12762*         DATASET  (ELCNTL-DSID)
 12763*         SET      (ADDRESS OF CONTROL-FILE)
 12764*         RIDFLD   (ELCNTL-KEY)
 12765*         UPDATE
 12766*    END-EXEC.
 12767*    MOVE '&"S        EU         (   #00011669' TO DFHEIV0
 12768     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12769     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12770     MOVE X'2020233030303131363639' TO DFHEIV0(25:11)
 12771     CALL 'kxdfhei1' USING DFHEIV0,
 12772           ELCNTL-DSID,
 12773           DFHEIV20,
 12774           DFHEIV99,
 12775           ELCNTL-KEY,
 12776           DFHEIV99,
 12777           DFHEIV99,
 12778           DFHEIV99
 12779     SET ADDRESS OF CONTROL-FILE TO
 12780         DFHEIV20
 12781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12782
 12783
 12784     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12785
 12786     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12787
 12788
 12789
 12790* EXEC CICS REWRITE
 12791*         FROM     (CONTROL-FILE)
 12792*         DATASET  (ELCNTL-DSID)
 12793*    END-EXEC.
 12794     MOVE LENGTH OF
 12795      CONTROL-FILE
 12796       TO DFHEIV11
 12797*    MOVE '&& L                  %   #00011681' TO DFHEIV0
 12798     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12799     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12800     MOVE X'2020233030303131363831' TO DFHEIV0(25:11)
 12801     CALL 'kxdfhei1' USING DFHEIV0,
 12802           ELCNTL-DSID,
 12803           CONTROL-FILE,
 12804           DFHEIV11,
 12805           DFHEIV99
 12806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 244
* EL130.cbl
 12807
 12808
 12809
 12810
 12811* EXEC CICS HANDLE CONDITION
 12812*         NOTOPEN  (9990-ABEND)
 12813*         DUPKEY   (5799-EXIT)
 12814*    END-EXEC.
 12815*    MOVE '"$J$                  ! ? #00011687' TO DFHEIV0
 12816     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12818     MOVE X'3F20233030303131363837' TO DFHEIV0(25:11)
 12819     CALL 'kxdfhei1' USING DFHEIV0
 12820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12821
 12822
 12823
 12824
 12825* EXEC CICS GETMAIN
 12826*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12827*         LENGTH  (ELARCH-LENGTH)
 12828*    END-EXEC.
 12829*    MOVE '," L                  $   #00011693' TO DFHEIV0
 12830     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12831     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12832     MOVE X'2020233030303131363933' TO DFHEIV0(25:11)
 12833     CALL 'kxdfhei1' USING DFHEIV0,
 12834           DFHEIV20,
 12835           ELARCH-LENGTH,
 12836           DFHEIV99
 12837     SET ADDRESS OF LETTER-ARCHIVE TO
 12838         DFHEIV20
 12839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12840
 12841
 12842     MOVE SPACES                 TO LETTER-ARCHIVE.
 12843     MOVE 'LA'                   TO LA-RECORD-ID.
 12844     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12845                                    LA-ARCHIVE-NO-A1.
 12846     MOVE '4'                    TO LA-RECORD-TYPE
 12847                                    LA-RECORD-TYPE-A1.
 12848     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12849                                    LA-LINE-SEQ-NO-A1.
 12850     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12851                                    LA-COMPANY-CD-A1.
 12852     MOVE CL-CARRIER             TO LA4-CARRIER.
 12853     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12854     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12855     MOVE CL-CERT-STATE          TO LA4-STATE.
 12856     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12857     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12858     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12859     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12860                                    LA4-RESEND-PRINT-DATE
 12861                                    LA4-FORM-REM-PRINT-DT
 12862                                    LA4-RESEND-DATE.
 12863     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12864     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 245
* EL130.cbl
 12865
 12866
 12867
 12868* EXEC CICS WRITE
 12869*         DATASET  (ELARCH-DSID)
 12870*         FROM     (LETTER-ARCHIVE)
 12871*         RIDFLD   (LA-CONTROL-PRIMARY)
 12872*    END-EXEC.
 12873     MOVE LENGTH OF
 12874      LETTER-ARCHIVE
 12875       TO DFHEIV11
 12876*    MOVE '&$ L                  ''   #00011723' TO DFHEIV0
 12877     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12878     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12879     MOVE X'2020233030303131373233' TO DFHEIV0(25:11)
 12880     CALL 'kxdfhei1' USING DFHEIV0,
 12881           ELARCH-DSID,
 12882           LETTER-ARCHIVE,
 12883           DFHEIV11,
 12884           LA-CONTROL-PRIMARY,
 12885           DFHEIV99,
 12886           DFHEIV99
 12887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12888
 12889
 12890 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 246
* EL130.cbl
 12892 6000-EDIT-CLAIM-DATA.
 12893
 12894     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12895     MOVE '2'                    TO DC-OPTION-CODE.
 12896     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12897     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12898
 12899     IF MAINTL NOT = ZERO
 12900         MOVE AL-UANON           TO MAINTA
 12901     END-IF
 12902
 12903     IF CLMNOL GREATER ZERO
 12904         IF CLMNOI = SPACES OR LOW-VALUES
 12905             MOVE -1             TO CLMNOL
 12906             MOVE AL-UABON       TO CLMNOA
 12907             MOVE ER-7688        TO EMI-ERROR
 12908             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12909         ELSE
 12910             MOVE AL-UANON       TO CLMNOA
 12911         END-IF
 12912     END-IF.
 12913
 12914     IF CERTNOL = ZERO
 12915         MOVE -1                 TO CERTNOL
 12916         MOVE AL-SABON           TO CERTNOA
 12917         MOVE ER-0203            TO EMI-ERROR
 12918         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12919     ELSE
 12920         MOVE AL-SANON           TO CERTNOA
 12921     END-IF.
 12922
 12923     IF SUFXL = ZERO
 12924         MOVE SPACES             TO SUFXI
 12925         MOVE AL-SANON           TO SUFXA
 12926     ELSE
 12927         MOVE AL-SANON           TO SUFXA
 12928     END-IF.
 12929
 12930     IF CLMCARRL = ZERO
 12931         MOVE -1                 TO CLMCARRL
 12932         MOVE ER-0194            TO EMI-ERROR
 12933         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12934     ELSE
 12935         MOVE CLMCARRI           TO PI-CARRIER
 12936         IF PI-NO-CARRIER-SECURITY
 12937             MOVE AL-UANON       TO CLMCARRA
 12938         END-IF
 12939     END-IF.
 12940
 12941     IF CLMTYPEL > ZERO
 12942        IF ((PI-COMPANY-ID = 'DCC' OR 'VPP')
 12943           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 12944              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G' AND 'F'))
 12945                        OR
 12946           ((PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL')
 12947           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 12948              AND PI-AH-OVERRIDE-L1))
 12949              MOVE -1             TO CLMTYPEL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 247
* EL130.cbl
 12950              MOVE AL-UABON       TO CLMTYPEA
 12951              MOVE ER-7634        TO EMI-ERROR
 12952              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12953        ELSE
 12954           MOVE AL-UANON       TO CLMTYPEA
 12955        END-IF
 12956     ELSE
 12957        IF MAINTI = 'A'
 12958           MOVE -1             TO CLMTYPEL
 12959           MOVE AL-UABON       TO CLMTYPEA
 12960           MOVE ER-0546        TO EMI-ERROR
 12961           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12962        END-IF
 12963     END-IF
 12964     if instypel > ZERO
 12965        if instypei = 'P' OR 'C'
 12966           move al-uanon         to instypea
 12967        else
 12968           MOVE -1               TO INSTYPEL
 12969           MOVE AL-UABON         TO INSTYPEA
 12970           MOVE ER-1654          TO EMI-ERROR
 12971           PERFORM 9900-ERROR-FORMAT
 12972                                 THRU 9900-EXIT
 12973        END-IF
 12974     ELSE
 12975        IF MAINTI = 'A'
 12976           MOVE -1               TO INSTYPEL
 12977           MOVE AL-UABON         TO INSTYPEA
 12978           MOVE ER-1654          TO EMI-ERROR
 12979           PERFORM 9900-ERROR-FORMAT
 12980                                 THRU 9900-EXIT
 12981        END-IF
 12982     END-IF
 12983     if (instypel <> zeros)
 12984        and (emi-error not = er-1654)
 12985        and (instypei = 'C')
 12986        and (crtfnmei = fstnmei)
 12987        move er-1675             to emi-error
 12988        MOVE -1                  TO INSTYPEL
 12989        MOVE AL-UABON            TO INSTYPEA
 12990        PERFORM 9900-ERROR-FORMAT
 12991                                 THRU 9900-EXIT
 12992    end-if
 12993     if (instypel <> zeros)
 12994        and (emi-error not = er-1654)
 12995        and (instypei = 'P')
 12996        and (crtfnmei <> fstnmei)
 12997        move er-1676             to emi-error
 12998        MOVE -1                  TO INSTYPEL
 12999        MOVE AL-UABON            TO INSTYPEA
 13000        PERFORM 9900-ERROR-FORMAT
 13001                                 THRU 9900-EXIT
 13002    end-if
 13003     IF PCERTNOL = ZERO
 13004        MOVE CERTNOI             TO PCERTNOI
 13005        MOVE CERTNOL             TO PCERTNOL
 13006        MOVE AL-UANON            TO PCERTNOA
 13007     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 248
* EL130.cbl
 13008        MOVE AL-UANON            TO PCERTNOA
 13009     END-IF.
 13010
 13011     IF PSUFXL = ZERO
 13012        MOVE SUFXI               TO PSUFXI
 13013        MOVE SUFXL               TO PSUFXL
 13014        MOVE AL-UANON            TO PSUFXA
 13015     ELSE
 13016        MOVE AL-UANON            TO PSUFXA
 13017     END-IF.
 13018
 13019     IF MAINTI = 'I'
 13020         GO TO 6020-EDIT
 13021     END-IF.
 13022
 13023     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 13024         MOVE -1                 TO LSTNMEL
 13025         MOVE ER-0236            TO EMI-ERROR
 13026         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13027     ELSE
 13028         MOVE AL-UANON           TO LSTNMEA
 13029     END-IF.
 13030     if fstnmel not = zeros
 13031        move al-uanon            to fstnmea
 13032     end-if
 13033     IF SEXL > ZEROS
 13034        IF SEXI = 'M' OR 'F'
 13035           move al-uanon         to sexa
 13036           CONTINUE
 13037        ELSE
 13038           MOVE -1               TO SEXL
 13039           MOVE AL-UABON         TO SEXA
 13040           MOVE ER-0219          TO EMI-ERROR
 13041           PERFORM 9900-ERROR-FORMAT
 13042                                 THRU 9900-EXIT
 13043        END-IF
 13044     ELSE
 13045        IF MAINTI = 'A'
 13046           MOVE -1               TO SEXL
 13047           MOVE AL-UABON         TO SEXA
 13048           MOVE ER-0219          TO EMI-ERROR
 13049           PERFORM 9900-ERROR-FORMAT
 13050                                 THRU 9900-EXIT
 13051        END-IF
 13052     END-IF
 13053     IF SSNL GREATER THAN ZERO
 13054         MOVE SSNI TO WS-SOC-SEC-NUMBER
 13055         IF WS-SOC-SEC-NO NUMERIC AND
 13056           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 13057             NEXT SENTENCE
 13058         ELSE
 13059            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 13060               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 13061               WS-SSN-DASH2 = '-'
 13062                 NEXT SENTENCE
 13063            ELSE
 13064                 MOVE ER-0887        TO  EMI-ERROR
 13065                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 249
* EL130.cbl
 13066                 MOVE AL-UABON       TO  SSNA
 13067                 MOVE -1             TO  SSNL
 13068            END-IF
 13069        END-IF
 13070     END-IF.
 13071
 13072     IF BIRTHDTL = ZERO
 13073         GO TO 6020-EDIT
 13074     END-IF.
 13075
 13076     IF BIRTHDTL GREATER ZERO
 13077         MOVE BIRTHDTI           TO DATE-WORK
 13078         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13079         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13080         MOVE '4'                TO DC-OPTION-CODE
 13081         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13082         IF DATE-CONVERSION-ERROR
 13083             MOVE AL-UABON       TO BIRTHDTA
 13084             MOVE -1             TO BIRTHDTL
 13085             MOVE ER-0220        TO EMI-ERROR
 13086             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13087             GO TO 6020-EDIT
 13088         END-IF
 13089     END-IF.
 13090
 13091******************************************************************
 13092**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 13093**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 13094**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 13095******************************************************************
 13096
 13097     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 13098         MOVE BIRTHDTI           TO  DATE-WORK
 13099         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13100         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 13101         MOVE '4'                TO  DC-OPTION-CODE
 13102         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 13103         MOVE +0                 TO  DC-ELAPSED-MONTHS
 13104                                     DC-ELAPSED-DAYS
 13105         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13106         IF DATE-CONVERSION-ERROR
 13107             MOVE AL-UABON       TO  BIRTHDTA
 13108             MOVE -1             TO  BIRTHDTL
 13109             MOVE ER-0220        TO  EMI-ERROR
 13110             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13111             GO TO 6020-EDIT
 13112         END-IF
 13113     END-IF.
 13114
 13115     MOVE AL-UANON               TO  BIRTHDTA.
 13116     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 13117     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 13118     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 13119
 13120 6020-EDIT.
 13121     IF INCURL GREATER ZERO
 13122         MOVE INCURI             TO DATE-WORK
 13123         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 250
* EL130.cbl
 13124         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13125         MOVE '4'                TO DC-OPTION-CODE
 13126         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13127         IF DATE-CONVERSION-ERROR
 13128             MOVE AL-UABON       TO INCURA
 13129             MOVE -1             TO INCURL
 13130             MOVE ER-0222        TO EMI-ERROR
 13131             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13132         ELSE
 13133             MOVE AL-UANON       TO INCURA
 13134             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 13135             MOVE DC-BIN-DATE-1  TO WS-INCUR
 13136                                    PI-SAVE-INCUR-DT
 13137             IF WS-INCUR GREATER THAN WS-TODAY-DT
 13138                 MOVE ER-0511     TO EMI-ERROR
 13139                 MOVE -1          TO INCURL
 13140                 MOVE AL-UABON    TO INCURA
 13141                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13142             ELSE
 13143*                NEXT SENTENCE
 13144                 CONTINUE
 13145             END-IF
 13146         END-IF
 13147     ELSE
 13148         MOVE ER-0516         TO EMI-ERROR
 13149         MOVE AL-UABON        TO INCURA
 13150         MOVE -1              TO INCURL
 13151         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13152     END-IF.
 13153
 13154     IF REPORTL GREATER ZERO
 13155         MOVE REPORTI            TO DATE-WORK
 13156         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13157         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13158         MOVE '4'                TO DC-OPTION-CODE
 13159         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13160         IF DATE-CONVERSION-ERROR
 13161             MOVE AL-UABON       TO REPORTA
 13162             MOVE -1             TO REPORTL
 13163             MOVE ER-0223        TO EMI-ERROR
 13164             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13165         ELSE
 13166             MOVE AL-UANON       TO REPORTA
 13167             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 13168             MOVE DC-BIN-DATE-1  TO WS-REPORT
 13169             IF WS-REPORT GREATER THAN WS-TODAY-DT
 13170                 MOVE ER-0512     TO EMI-ERROR
 13171                 MOVE -1          TO REPORTL
 13172                 MOVE AL-UABON    TO REPORTA
 13173                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13174             ELSE
 13175*                NEXT SENTENCE
 13176                 CONTINUE
 13177             END-IF
 13178         END-IF
 13179     ELSE
 13180         MOVE ER-0517         TO EMI-ERROR
 13181         MOVE -1              TO REPORTL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 251
* EL130.cbl
 13182         MOVE AL-UABON        TO REPORTA
 13183         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13184     END-IF.
 13185
 13186     IF WS-REPORT NOT = LOW-VALUES
 13187         IF WS-INCUR GREATER THAN WS-REPORT
 13188             MOVE AL-UABON       TO REPORTA
 13189             MOVE -1             TO REPORTL
 13190             MOVE ER-0509        TO EMI-ERROR
 13191             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13192         END-IF
 13193     END-IF.
 13194
 13195     IF ICD1L GREATER THAN ZERO
 13196         IF (ICD1I GREATER THAN SPACES) AND
 13197            (ICD1I(4:1) NOT = '.')
 13198             IF ICD1I(4:1) = ' '
 13199                 MOVE '.' TO ICD1I(4:1)
 13200             ELSE
 13201                 IF ICD1I(8:1) = ' '
 13202                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 13203                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 13204                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 13205                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 13206                     MOVE '.'        TO ICD1I(4:1)
 13207                 END-IF
 13208             END-IF
 13209         END-IF
 13210         IF (ICD1I GREATER THAN SPACES) AND
 13211            (ICD1I(1:1) NOT > ' ' OR
 13212             ICD1I(2:1) NOT > ' ' OR
 13213             ICD1I(3:1) NOT > ' ' OR
 13214             ICD1I(4:1) NOT = '.')
 13215              MOVE ER-0992        TO  EMI-ERROR
 13216              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13217              MOVE AL-UABON       TO ICD1A
 13218              MOVE -1             TO ICD1L
 13219         END-IF
 13220     END-IF.
 13221
 13222     IF ICD2L GREATER THAN ZERO
 13223         IF (ICD2I GREATER THAN SPACES) AND
 13224            (ICD2I(4:1) NOT = '.')
 13225             IF ICD2I(4:1) = ' '
 13226                 MOVE '.' TO ICD2I(4:1)
 13227             ELSE
 13228                 IF ICD2I(8:1) = ' '
 13229                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 13230                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 13231                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 13232                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 13233                     MOVE '.'        TO ICD2I(4:1)
 13234                 END-IF
 13235             END-IF
 13236         END-IF
 13237         IF (ICD2I GREATER THAN SPACES) AND
 13238            (ICD2I(1:1) NOT > ' ' OR
 13239             ICD2I(2:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 252
* EL130.cbl
 13240             ICD2I(3:1) NOT > ' ' OR
 13241             ICD2I(4:1) NOT = '.')
 13242              MOVE ER-0992        TO  EMI-ERROR
 13243              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13244              MOVE AL-UABON       TO ICD2A
 13245              MOVE -1             TO ICD2L
 13246         END-IF
 13247     END-IF
 13248
 13249*    IF ESTENDL GREATER ZERO
 13250*        MOVE ESTENDI            TO DATE-WORK
 13251*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13252*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13253*        MOVE '4'                TO DC-OPTION-CODE
 13254*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13255*        IF DATE-CONVERSION-ERROR
 13256*            MOVE AL-UABON       TO ESTENDA
 13257*            MOVE -1             TO ESTENDL
 13258*            MOVE ER-0224        TO EMI-ERROR
 13259*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13260*        ELSE
 13261*            MOVE AL-UANON       TO ESTENDA
 13262*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 13263*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 13264*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13265*               MOVE AL-UABON    TO ESTENDA
 13266*               MOVE -1          TO ESTENDL
 13267*               MOVE ER-0544     TO EMI-ERROR
 13268*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13269*            END-IF
 13270*        END-IF
 13271*    END-IF.
 13272*
 13273*    IF WS-ESTEND NOT = LOW-VALUES
 13274*        IF WS-INCUR GREATER THAN WS-ESTEND
 13275*            MOVE AL-UABON       TO ESTENDA
 13276*            MOVE -1             TO ESTENDL
 13277*            MOVE ER-0510        TO EMI-ERROR
 13278*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13279*        END-IF
 13280*    END-IF.
 13281
 13282     IF PRTOPTL GREATER ZERO
 13283         IF PRTOPTI NOT = 'N' AND 'L'
 13284             MOVE AL-UABON       TO PRTOPTA
 13285             MOVE -1             TO PRTOPTL
 13286             MOVE ER-0334        TO EMI-ERROR
 13287             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13288         END-IF
 13289     END-IF.
 13290
 13291     IF MANRSVL GREATER ZERO
 13292
 13293* EXEC CICS BIF DEEDIT
 13294*            FIELD   (MANRSVI)
 13295*            LENGTH  (9)
 13296*        END-EXEC
 13297     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 253
* EL130.cbl
 13298       TO DFHEIV11
 13299*    MOVE '@"L                   #   #00012131' TO DFHEIV0
 13300     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13301     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13302     MOVE X'2020233030303132313331' TO DFHEIV0(25:11)
 13303     CALL 'kxdfhei1' USING DFHEIV0,
 13304           MANRSVI,
 13305           DFHEIV11
 13306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13307         IF MANRSVI NOT NUMERIC
 13308             MOVE AL-UNBON       TO MANRSVA
 13309             MOVE -1             TO MANRSVL
 13310             MOVE ER-0489        TO EMI-ERROR
 13311             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13312         ELSE
 13313             MOVE AL-UNNON       TO MANRSVA
 13314             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 13315         END-IF
 13316     END-IF.
 13317
 13318     MOVE SPACES                 TO ELCNTL-KEY.
 13319
 13320     IF CONTROL-IS-ACTUAL-CARRIER
 13321         MOVE PI-CARRIER         TO CNTL-CARRIER
 13322     ELSE
 13323         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 13324     END-IF.
 13325
 13326     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13327     MOVE '6'                    TO CNTL-REC-TYPE.
 13328     MOVE +0                     TO CNTL-SEQ-NO.
 13329
 13330
 13331
 13332* EXEC CICS HANDLE CONDITION
 13333*        NOTFND   (3100-CARRIER-NOT-FOUND)
 13334*    END-EXEC.
 13335*    MOVE '"$I                   ! @ #00012159' TO DFHEIV0
 13336     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13337     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13338     MOVE X'4020233030303132313539' TO DFHEIV0(25:11)
 13339     CALL 'kxdfhei1' USING DFHEIV0
 13340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13341
 13342
 13343     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13344
 13345     IF NOT CF-MANUAL-RESERVES-USED AND
 13346           WS-MANRSV GREATER ZERO
 13347         MOVE ER-0518             TO EMI-ERROR
 13348         MOVE -1                  TO MANRSVL
 13349         MOVE AL-UNBON            TO MANRSVA
 13350         MOVE ZEROS               TO WS-MANRSV
 13351         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13352     END-IF.
 13353
 13354     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 13355     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 254
* EL130.cbl
 13356
 13357     IF SUPVL GREATER ZERO
 13358         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 13359             MOVE -1             TO SUPVL
 13360             MOVE AL-UABON       TO SUPVA
 13361             MOVE ER-0230        TO EMI-ERROR
 13362             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13363         ELSE
 13364             MOVE AL-UANON       TO SUPVA
 13365         END-IF
 13366     END-IF.
 13367
 13368     IF PROCCDL = ZERO
 13369        GO TO 6050-CONTINUE-EDITS
 13370     END-IF.
 13371
 13372     MOVE SPACES                 TO ELCNTL-KEY.
 13373     MOVE PROCCDI                TO CNTL-ACCESS.
 13374
 13375     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13376     MOVE '2'                    TO CNTL-REC-TYPE.
 13377     MOVE +0                     TO CNTL-SEQ-NO.
 13378
 13379
 13380
 13381* EXEC CICS HANDLE CONDITION
 13382*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 13383*    END-EXEC.
 13384*    MOVE '"$I                   ! A #00012200' TO DFHEIV0
 13385     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13387     MOVE X'4120233030303132323030' TO DFHEIV0(25:11)
 13388     CALL 'kxdfhei1' USING DFHEIV0
 13389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13390
 13391
 13392     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13393
 13394     GO TO 6050-CONTINUE-EDITS.
 13395
 13396 6040-NO-PROCESSOR-RECORD.
 13397     MOVE ER-0019                TO EMI-ERROR.
 13398     MOVE -1                     TO PROCCDL.
 13399     MOVE AL-UABON               TO PROCCDA.
 13400     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13401
 13402 6050-CONTINUE-EDITS.
 13403     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 13404           GO TO 6070-CONTINUE-EDITS
 13405     END-IF.
 13406
 13407     MOVE BENECDI                TO BENE-CODE.
 13408     MOVE 'B'                    TO BENE-RCD-TYPE.
 13409     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 13410
 13411
 13412
 13413* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 255
* EL130.cbl
 13414*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 13415*    END-EXEC.
 13416*    MOVE '"$I                   ! B #00012224' TO DFHEIV0
 13417     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13419     MOVE X'4220233030303132323234' TO DFHEIV0(25:11)
 13420     CALL 'kxdfhei1' USING DFHEIV0
 13421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13422
 13423
 13424
 13425* EXEC CICS READ
 13426*         DATASET   (ELBENE-DSID)
 13427*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13428*         RIDFLD    (ELBENE-KEY)
 13429*    END-EXEC.
 13430*    MOVE '&"S        E          (   #00012228' TO DFHEIV0
 13431     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13432     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13433     MOVE X'2020233030303132323238' TO DFHEIV0(25:11)
 13434     CALL 'kxdfhei1' USING DFHEIV0,
 13435           ELBENE-DSID,
 13436           DFHEIV20,
 13437           DFHEIV99,
 13438           ELBENE-KEY,
 13439           DFHEIV99,
 13440           DFHEIV99,
 13441           DFHEIV99
 13442     SET ADDRESS OF BENEFICIARY-MASTER TO
 13443         DFHEIV20
 13444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13445
 13446
 13447     GO TO 6070-CONTINUE-EDITS.
 13448
 13449 6060-NO-BENEFICIARY-RECORD.
 13450     MOVE ER-0565                TO EMI-ERROR.
 13451     MOVE -1                     TO BENECDL.
 13452     MOVE AL-UABON               TO BENECDA.
 13453     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13454
 13455
 13456 6070-CONTINUE-EDITS.
 13457     IF CERTMTL GREATER ZERO
 13458         IF CERTMTI NOT = 'A' AND 'S'
 13459             MOVE -1             TO CERTMTL
 13460             MOVE AL-UABON       TO CERTMTA
 13461             MOVE ER-0267        TO EMI-ERROR
 13462             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13463         ELSE
 13464             MOVE AL-UANON       TO CERTMTA
 13465         END-IF
 13466     ELSE
 13467         GO TO 6000-EXIT
 13468     END-IF.
 13469
 13470     IF EFFDTL GREATER ZERO
 13471         MOVE EFFDTI             TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 256
* EL130.cbl
 13472         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13473         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13474         MOVE '4'                TO DC-OPTION-CODE
 13475         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13476         IF DATE-CONVERSION-ERROR
 13477             MOVE AL-UABON       TO EFFDTA
 13478             MOVE -1             TO EFFDTL
 13479             MOVE ER-0231        TO EMI-ERROR
 13480             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13481         ELSE
 13482             MOVE AL-UANON       TO EFFDTA
 13483             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13484             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13485         END-IF
 13486     ELSE
 13487         MOVE ER-0231            TO EMI-ERROR
 13488         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13489         MOVE -1                 TO EFFDTL
 13490         MOVE AL-UABON           TO EFFDTA
 13491     END-IF.
 13492
 13493     IF ACCOUNTL = ZERO
 13494         MOVE ER-0232            TO EMI-ERROR
 13495         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13496         MOVE AL-UABON           TO ACCOUNTA
 13497         MOVE -1                 TO ACCOUNTL
 13498     ELSE
 13499         MOVE AL-UANON           TO ACCOUNTA
 13500     END-IF.
 13501
 13502     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13503        (STATEL = ZERO)
 13504         MOVE ER-0233        TO EMI-ERROR
 13505         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13506         MOVE AL-UABON       TO STATEA
 13507         MOVE -1             TO STATEL
 13508     ELSE
 13509         MOVE AL-UANON       TO STATEA
 13510     END-IF.
 13511
 13512     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13513        (CRTCARRL = ZERO)
 13514         MOVE ER-0234        TO EMI-ERROR
 13515         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13516         MOVE AL-UABON       TO CRTCARRA
 13517         MOVE -1             TO CRTCARRL
 13518     ELSE
 13519         MOVE AL-UANON       TO CRTCARRA
 13520     END-IF.
 13521
 13522     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13523        GROUPL = ZERO
 13524         MOVE ER-0235            TO EMI-ERROR
 13525         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13526         MOVE AL-UABON           TO GROUPA
 13527         MOVE -1                 TO GROUPL
 13528     ELSE
 13529         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 257
* EL130.cbl
 13530     END-IF.
 13531
 13532     IF CRTLNMEL = ZERO
 13533         IF LSTNMEI = SPACES OR LOW-VALUES
 13534             MOVE ER-0236            TO  EMI-ERROR
 13535             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13536             MOVE AL-UABON           TO  CRTLNMEA
 13537             MOVE -1                 TO  CRTLNMEL
 13538         ELSE
 13539             MOVE LSTNMEI            TO  CRTLNMEI
 13540             MOVE AL-UANON           TO  CRTLNMEA
 13541         END-IF
 13542     ELSE
 13543         MOVE AL-UANON               TO  CRTLNMEA
 13544     END-IF.
 13545
 13546     IF CRTFNMEL = ZERO
 13547         IF FSTNMEI = SPACES OR LOW-VALUES
 13548*            NEXT SENTENCE
 13549             CONTINUE
 13550         ELSE
 13551             MOVE FSTNMEI            TO  CRTFNMEI
 13552             MOVE AL-UANON           TO  CRTFNMEA
 13553         END-IF
 13554     END-IF.
 13555
 13556     IF CRTINITL = ZERO
 13557         IF INITI = SPACES OR LOW-VALUES
 13558*            NEXT SENTENCE
 13559             CONTINUE
 13560         ELSE
 13561             MOVE INITI              TO  CRTINITI
 13562             MOVE AL-UANON           TO  CRTINITA
 13563         END-IF
 13564     END-IF.
 13565
 13566 6000-EXIT.
 13567     EXIT.
 13568
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 258
* EL130.cbl
 13570 6200-EDIT-CERT-DATA.
 13571     IF ISSAGEL GREATER ZERO
 13572         IF ISSAGEI NOT NUMERIC
 13573             MOVE ER-0237        TO EMI-ERROR
 13574             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13575             MOVE -1             TO ISSAGEL
 13576             MOVE AL-UNBON       TO ISSAGEA
 13577         ELSE
 13578             MOVE AL-UNNON       TO ISSAGEA
 13579         END-IF
 13580     END-IF.
 13581
 13582     IF JNTAGEL GREATER ZERO
 13583         IF JNTAGEI NOT NUMERIC
 13584             MOVE ER-0238        TO EMI-ERROR
 13585             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13586             MOVE -1             TO JNTAGEL
 13587             MOVE AL-UNBON       TO JNTAGEA
 13588         ELSE
 13589             MOVE AL-UNNON       TO JNTAGEA
 13590         END-IF
 13591     END-IF.
 13592
 13593     IF LCVCDL GREATER ZERO
 13594         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13595         IF INVALID-BENEFIT-CODE
 13596             MOVE ER-7635        TO EMI-ERROR
 13597             MOVE -1             TO LCVCDL
 13598             MOVE AL-UABON       TO LCVCDA
 13599             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13600         ELSE
 13601             MOVE LCVCDI         TO WS-BEN-HOLD
 13602             MOVE '4'            TO WS-REC-TYPE
 13603             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13604             IF WS-BEN-ALPHA-HOLD = SPACES
 13605                MOVE ER-7635     TO EMI-ERROR
 13606                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13607                MOVE -1          TO LCVCDL
 13608                MOVE AL-UABON    TO LCVCDA
 13609             ELSE
 13610                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13611                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13612                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13613                MOVE AL-UANON           TO LCVCDA
 13614             END-IF
 13615         END-IF
 13616     END-IF.
 13617
 13618     IF ACVCDL GREATER ZERO
 13619         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13620         IF INVALID-BENEFIT-CODE
 13621             MOVE ER-7635        TO EMI-ERROR
 13622             MOVE -1             TO ACVCDL
 13623             MOVE AL-UABON       TO ACVCDA
 13624             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13625         ELSE
 13626             MOVE ACVCDI         TO WS-BEN-HOLD
 13627             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 259
* EL130.cbl
 13628             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13629             IF WS-BEN-ALPHA-HOLD = SPACES
 13630                MOVE ER-7635     TO EMI-ERROR
 13631                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13632                MOVE -1          TO ACVCDL
 13633                MOVE AL-UABON    TO ACVCDA
 13634             ELSE
 13635                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13636                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13637                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13638                MOVE AL-UANON           TO ACVCDA
 13639             END-IF
 13640         END-IF
 13641     END-IF.
 13642
 13643     IF LCVOTRML GREATER ZERO
 13644         IF LCVOTRMI NOT NUMERIC
 13645             MOVE ER-7636        TO EMI-ERROR
 13646             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13647             MOVE -1             TO LCVOTRML
 13648             MOVE AL-UNBON       TO LCVOTRMA
 13649         ELSE
 13650             MOVE AL-UNNON       TO LCVOTRMA
 13651         END-IF
 13652     END-IF.
 13653
 13654     IF ACVOTRML GREATER ZERO
 13655         IF ACVOTRMI NOT NUMERIC
 13656             MOVE ER-7636        TO EMI-ERROR
 13657             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13658             MOVE -1             TO ACVOTRML
 13659             MOVE AL-UNBON       TO ACVOTRMA
 13660         ELSE
 13661             MOVE AL-UNNON       TO ACVOTRMA
 13662         END-IF
 13663     END-IF.
 13664
 13665     IF LCVRATEL GREATER ZERO
 13666
 13667* EXEC CICS BIF DEEDIT
 13668*            FIELD    (LCVRATEI)
 13669*            LENGTH   (06)
 13670*        END-EXEC
 13671     MOVE 06
 13672       TO DFHEIV11
 13673*    MOVE '@"L                   #   #00012453' TO DFHEIV0
 13674     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13675     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13676     MOVE X'2020233030303132343533' TO DFHEIV0(25:11)
 13677     CALL 'kxdfhei1' USING DFHEIV0,
 13678           LCVRATEI,
 13679           DFHEIV11
 13680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13681         IF LCVRATEI NOT NUMERIC
 13682             MOVE AL-UNBON       TO LCVRATEA
 13683             MOVE -1             TO LCVRATEL
 13684             MOVE ER-2280        TO EMI-ERROR
 13685             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 260
* EL130.cbl
 13686         ELSE
 13687             MOVE AL-UNNON       TO LCVRATEA
 13688             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13689         END-IF
 13690     END-IF.
 13691
 13692     IF ACVRATEL GREATER ZERO
 13693
 13694* EXEC CICS BIF DEEDIT
 13695*            FIELD    (ACVRATEI)
 13696*            LENGTH   (06)
 13697*        END-EXEC
 13698     MOVE 06
 13699       TO DFHEIV11
 13700*    MOVE '@"L                   #   #00012469' TO DFHEIV0
 13701     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13702     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13703     MOVE X'2020233030303132343639' TO DFHEIV0(25:11)
 13704     CALL 'kxdfhei1' USING DFHEIV0,
 13705           ACVRATEI,
 13706           DFHEIV11
 13707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13708         IF ACVRATEI NOT NUMERIC
 13709             MOVE AL-UNBON       TO ACVRATEA
 13710             MOVE -1             TO ACVRATEL
 13711             MOVE ER-2280        TO EMI-ERROR
 13712             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13713         ELSE
 13714             MOVE AL-UNNON       TO ACVRATEA
 13715             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13716         END-IF
 13717     END-IF.
 13718
 13719     IF LCVBENEL GREATER ZERO
 13720
 13721* EXEC CICS BIF DEEDIT
 13722*            FIELD    (LCVBENEI)
 13723*            LENGTH   (11)
 13724*        END-EXEC
 13725     MOVE 11
 13726       TO DFHEIV11
 13727*    MOVE '@"L                   #   #00012485' TO DFHEIV0
 13728     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13729     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13730     MOVE X'2020233030303132343835' TO DFHEIV0(25:11)
 13731     CALL 'kxdfhei1' USING DFHEIV0,
 13732           LCVBENEI,
 13733           DFHEIV11
 13734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13735         IF LCVBENEI NOT NUMERIC
 13736             MOVE AL-UNBON       TO LCVBENEA
 13737             MOVE -1             TO LCVBENEL
 13738             MOVE ER-7637        TO EMI-ERROR
 13739             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13740         ELSE
 13741             MOVE AL-UNNON       TO LCVBENEA
 13742             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13743         END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 261
* EL130.cbl
 13744     END-IF.
 13745
 13746     IF ACVBENEL GREATER ZERO
 13747
 13748* EXEC CICS BIF DEEDIT
 13749*            FIELD    (ACVBENEI)
 13750*            LENGTH   (11)
 13751*        END-EXEC
 13752     MOVE 11
 13753       TO DFHEIV11
 13754*    MOVE '@"L                   #   #00012501' TO DFHEIV0
 13755     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13756     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13757     MOVE X'2020233030303132353031' TO DFHEIV0(25:11)
 13758     CALL 'kxdfhei1' USING DFHEIV0,
 13759           ACVBENEI,
 13760           DFHEIV11
 13761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13762         IF ACVBENEI NOT NUMERIC
 13763             MOVE AL-UNBON       TO ACVBENEA
 13764             MOVE -1             TO ACVBENEL
 13765             MOVE ER-7637        TO EMI-ERROR
 13766             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13767         ELSE
 13768             MOVE AL-UNNON       TO ACVBENEA
 13769             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13770         END-IF
 13771     END-IF.
 13772
 13773     IF LCVCNDTL GREATER ZERO
 13774         IF LCVCNDTI NOT = SPACES
 13775             MOVE LCVCNDTI        TO DATE-WORK
 13776             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13777             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13778             MOVE '4'             TO DC-OPTION-CODE
 13779             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13780             IF DATE-CONVERSION-ERROR
 13781                 MOVE AL-UABON    TO LCVCNDTA
 13782                 MOVE -1          TO LCVCNDTL
 13783                 MOVE ER-7638     TO EMI-ERROR
 13784                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13785             ELSE
 13786                 MOVE AL-UANON    TO LCVCNDTA
 13787                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13788                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13789             END-IF
 13790         END-IF
 13791     END-IF.
 13792
 13793     IF ACVCNDTL GREATER ZERO
 13794         IF ACVCNDTI NOT = SPACES
 13795             MOVE ACVCNDTI        TO DATE-WORK
 13796             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13797             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13798             MOVE '4'             TO DC-OPTION-CODE
 13799             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13800             IF DATE-CONVERSION-ERROR
 13801                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 262
* EL130.cbl
 13802                 MOVE -1          TO ACVCNDTL
 13803                 MOVE ER-7638     TO EMI-ERROR
 13804                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13805             ELSE
 13806                 MOVE AL-UANON    TO ACVCNDTA
 13807                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13808                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13809             END-IF
 13810         END-IF
 13811     END-IF.
 13812
 13813     IF ADDONDTL GREATER ZERO
 13814         MOVE ADDONDTI        TO DATE-WORK
 13815         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13816         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13817         MOVE '4'             TO DC-OPTION-CODE
 13818         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13819         IF DATE-CONVERSION-ERROR
 13820             MOVE AL-UABON    TO ADDONDTA
 13821             MOVE -1          TO ADDONDTL
 13822             MOVE ER-7651     TO EMI-ERROR
 13823             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13824         ELSE
 13825             MOVE AL-UANON    TO ADDONDTA
 13826             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13827             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13828         END-IF
 13829     END-IF.
 13830
 13831     IF APRL GREATER ZERO
 13832
 13833* EXEC CICS BIF DEEDIT
 13834*            FIELD    (APRI)
 13835*            LENGTH   (8)
 13836*        END-EXEC
 13837     MOVE 8
 13838       TO DFHEIV11
 13839*    MOVE '@"L                   #   #00012575' TO DFHEIV0
 13840     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13841     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13842     MOVE X'2020233030303132353735' TO DFHEIV0(25:11)
 13843     CALL 'kxdfhei1' USING DFHEIV0,
 13844           APRI,
 13845           DFHEIV11
 13846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13847         IF APRI NOT NUMERIC
 13848             MOVE AL-UNBON       TO APRA
 13849             MOVE -1             TO APRL
 13850             MOVE ER-0248        TO EMI-ERROR
 13851             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13852         ELSE
 13853             MOVE AL-UNNON       TO APRA
 13854             MOVE APRI           TO WS-APR APRO
 13855         END-IF
 13856     END-IF.
 13857
 13858     IF PMTFREQL GREATER ZERO
 13859
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 263
* EL130.cbl
 13860* EXEC CICS BIF DEEDIT
 13861*            FIELD   (PMTFREQI)
 13862*            LENGTH  (2)
 13863*        END-EXEC
 13864     MOVE 2
 13865       TO DFHEIV11
 13866*    MOVE '@"L                   #   #00012591' TO DFHEIV0
 13867     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13868     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13869     MOVE X'2020233030303132353931' TO DFHEIV0(25:11)
 13870     CALL 'kxdfhei1' USING DFHEIV0,
 13871           PMTFREQI,
 13872           DFHEIV11
 13873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13874         IF PMTFREQI NOT NUMERIC
 13875             MOVE -1             TO PMTFREQL
 13876             MOVE AL-UNBON       TO PMTFREQA
 13877             MOVE ER-0258        TO EMI-ERROR
 13878             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13879         ELSE
 13880             MOVE AL-UNNON       TO PMTFREQA
 13881             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13882         END-IF
 13883     END-IF.
 13884
 13885     IF INDGRPL GREATER ZERO
 13886         IF INDGRPI = 'I' OR 'G'
 13887             MOVE AL-UANON       TO INDGRPA
 13888         ELSE
 13889             MOVE -1 TO INDGRPL
 13890             MOVE AL-UABON       TO INDGRPA
 13891             MOVE ER-0260        TO EMI-ERROR
 13892             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13893         END-IF
 13894     END-IF.
 13895
 13896     IF LOANBALL GREATER ZERO
 13897         MOVE LOANBALI           TO DEEDIT-FIELD
 13898
 13899* EXEC CICS BIF DEEDIT
 13900*            FIELD   (DEEDIT-FIELD)
 13901*            LENGTH  (12)
 13902*        END-EXEC
 13903     MOVE 12
 13904       TO DFHEIV11
 13905*    MOVE '@"L                   #   #00012619' TO DFHEIV0
 13906     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13907     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13908     MOVE X'2020233030303132363139' TO DFHEIV0(25:11)
 13909     CALL 'kxdfhei1' USING DFHEIV0,
 13910           DEEDIT-FIELD,
 13911           DFHEIV11
 13912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13913         IF DEEDIT-FIELD NOT NUMERIC
 13914             MOVE AL-UNBON       TO LOANBALA
 13915             MOVE -1             TO LOANBALL
 13916             MOVE ER-0247        TO EMI-ERROR
 13917             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 264
* EL130.cbl
 13918         ELSE
 13919             MOVE AL-UNNON       TO LOANBALA
 13920             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13921         END-IF
 13922     END-IF.
 13923
 13924     IF PREMTYPL GREATER ZERO
 13925         IF (PREMTYPI = '1' OR '2' OR '3')
 13926             MOVE AL-UANON       TO PREMTYPA
 13927         ELSE
 13928             MOVE -1             TO PREMTYPL
 13929             MOVE AL-UABON       TO PREMTYPA
 13930             MOVE ER-0227        TO EMI-ERROR
 13931             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13932         END-IF
 13933     END-IF.
 13934
 13935     IF REINCDL GREATER ZERO
 13936         MOVE LOW-VALUES         TO  ERREIN-KEY
 13937         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13938         MOVE REINCDI            TO  REIN-CODE-1
 13939                                     REIN-CODE-2
 13940                                     REIN-CODE-3
 13941         MOVE 'A'                TO  REIN-TYPE
 13942         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13943         IF REIN-REC-NOT-FOUND
 13944             MOVE ER-0266        TO  EMI-ERROR
 13945             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13946             MOVE -1             TO  REINCDL
 13947             MOVE AL-UABON       TO  REINCDA
 13948         ELSE
 13949             MOVE AL-UANON       TO  REINCDA
 13950         END-IF
 13951     END-IF.
 13952
 13953     IF CERTMTI NOT = 'A'
 13954        GO TO 6200-EXIT
 13955     END-IF.
 13956
 13957     IF PREMTYPI = '1'
 13958         IF LCVCDL GREATER ZERO
 13959             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13960                 MOVE ER-0841        TO  EMI-ERROR
 13961                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13962                 MOVE -1             TO  PREMTYPL
 13963                 MOVE AL-UABON       TO  PREMTYPA
 13964             END-IF
 13965         END-IF
 13966     END-IF.
 13967
 13968     IF PREMTYPI = '1'
 13969         IF ACVCDL GREATER ZERO
 13970             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13971                 MOVE ER-0841        TO  EMI-ERROR
 13972                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13973                 MOVE -1             TO  PREMTYPL
 13974                 MOVE AL-UABON       TO  PREMTYPA
 13975             END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 265
* EL130.cbl
 13976         END-IF
 13977     END-IF.
 13978
 13979     IF PREMTYPI = '2'
 13980         IF LCVCDL GREATER ZERO
 13981             IF (PI-COMPANY-ID = 'HAN') AND
 13982                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13983                        OR
 13984                 WS-LF-SPECIAL-CALC-CD = 'O'
 13985*                NEXT SENTENCE
 13986                 CONTINUE
 13987             ELSE
 13988                 MOVE ER-0840        TO  EMI-ERROR
 13989                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13990                 MOVE -1             TO  PREMTYPL
 13991                 MOVE AL-UABON       TO  PREMTYPA
 13992             END-IF
 13993         END-IF
 13994     END-IF.
 13995
 13996     IF PREMTYPI = '2'
 13997         IF ACVCDL GREATER ZERO
 13998             IF (PI-COMPANY-ID = 'HAN')  AND
 13999                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 14000                        OR
 14001                 WS-AH-SPECIAL-CALC-CD = 'O'
 14002*                NEXT SENTENCE
 14003                 CONTINUE
 14004             ELSE
 14005                 MOVE ER-0840        TO  EMI-ERROR
 14006                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14007                 MOVE -1             TO  PREMTYPL
 14008                 MOVE AL-UABON       TO  PREMTYPA
 14009             END-IF
 14010         END-IF
 14011     END-IF.
 14012
 14013     IF LCVCDL = ZEROS
 14014        GO TO 6200-EXIT
 14015     END-IF.
 14016
 14017     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 14018         IF PMTFREQI NOT = ZEROS
 14019             MOVE ER-0428        TO EMI-ERROR
 14020             MOVE -1             TO PMTFREQL
 14021             MOVE AL-UNBON       TO PMTFREQA
 14022             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14023             GO TO 6200-CHECK-APR
 14024         END-IF
 14025     END-IF.
 14026
 14027     IF PMTFREQL = ZEROS AND TEX-REG
 14028         MOVE ER-0429            TO EMI-ERROR
 14029         MOVE -1                 TO PMTFREQL
 14030         MOVE AL-UNBON           TO PMTFREQA
 14031         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14032         GO TO 6200-CHECK-APR
 14033     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 266
* EL130.cbl
 14034
 14035     IF LCVOTRMI NOT NUMERIC
 14036         GO TO 6200-CHECK-APR
 14037     END-IF.
 14038
 14039     IF WS-PMTFREQ NOT = ZERO
 14040         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 14041         GIVING DIVIDE-QUOT
 14042         REMAINDER DIVIDE-REM
 14043         IF DIVIDE-REM GREATER ZERO
 14044             MOVE ER-0430            TO EMI-ERROR
 14045             MOVE -1                 TO PMTFREQL
 14046             MOVE AL-UNBON           TO PMTFREQA
 14047             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14048         END-IF
 14049     END-IF.
 14050
 14051 6200-CHECK-APR.
 14052     IF NET-PAY AND APRL = ZEROS
 14053        MOVE ER-0257             TO EMI-ERROR
 14054        MOVE -1                  TO APRL
 14055        MOVE AL-UABON            TO APRA
 14056        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14057     END-IF.
 14058
 14059 6200-EXIT.
 14060     EXIT.
 14061
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 267
* EL130.cbl
 14063 6300-REQUIRED-CERT-EDIT.
 14064
 14065     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14066        GO TO 6300-REQUIRED-AH-EDIT
 14067     END-IF
 14068
 14069     IF LCVCDL = ZERO
 14070        MOVE ER-7639             TO EMI-ERROR
 14071        MOVE -1                  TO LCVCDL
 14072        MOVE AL-UABON            TO LCVCDA
 14073        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14074     END-IF.
 14075
 14076     IF LCVOTRML = ZERO
 14077        MOVE ER-7670             TO EMI-ERROR
 14078        MOVE -1                  TO LCVOTRML
 14079        MOVE AL-UNBON            TO LCVOTRMA
 14080        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14081     END-IF.
 14082
 14083     IF LCVBENEL = ZERO
 14084        MOVE ER-7671             TO EMI-ERROR
 14085        MOVE -1                  TO LCVBENEL
 14086        MOVE AL-UNBON            TO LCVBENEA
 14087        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14088     END-IF.
 14089
 14090     GO TO 6399-EXIT.
 14091
 14092 6300-REQUIRED-AH-EDIT.
 14093
 14094     IF ACVCDL = ZERO
 14095        MOVE ER-7639             TO EMI-ERROR
 14096        MOVE -1                  TO ACVCDL
 14097        MOVE AL-UABON            TO ACVCDA
 14098        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14099     END-IF.
 14100
 14101     IF ACVOTRML = ZERO
 14102         MOVE ER-7670             TO EMI-ERROR
 14103         MOVE -1                  TO ACVOTRML
 14104         MOVE AL-UNBON            TO ACVOTRMA
 14105         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14106     END-IF.
 14107
 14108     IF ACVBENEL = ZERO
 14109        MOVE ER-7671             TO EMI-ERROR
 14110        MOVE -1                  TO ACVBENEL
 14111        MOVE AL-UNBON            TO ACVBENEA
 14112        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14113     END-IF.
 14114
 14115 6399-EXIT.
 14116      EXIT.
 14117
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 268
* EL130.cbl
 14119 6400-TEST-CLAIM-REASONABILITY.
 14120
 14121     IF WS-INCUR = LOW-VALUES
 14122        GO TO 6499-EXIT
 14123     END-IF.
 14124
 14125     IF WS-EFFDT NOT = LOW-VALUES
 14126         IF WS-INCUR LESS WS-EFFDT
 14127             MOVE ER-0458          TO EMI-ERROR
 14128             MOVE -1               TO INCURL
 14129             MOVE AL-UABON         TO INCURA
 14130             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14131         END-IF
 14132     END-IF.
 14133
 14134     IF CERTMTI = 'A'
 14135        GO TO 6460-TEST-NEW-CERT
 14136     END-IF.
 14137
 14138     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 14139     MOVE CRTCARRI               TO CERT-CARRIER.
 14140     MOVE GROUPI                 TO CERT-GROUPING.
 14141     MOVE STATEI                 TO CERT-STATE.
 14142     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 14143     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 14144     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 14145
 14146
 14147
 14148* EXEC CICS HANDLE CONDITION
 14149*         DUPKEY   (6499-EXIT)
 14150*         NOTFND   (6499-EXIT)
 14151*    END-EXEC.
 14152*    MOVE '"$$I                  ! C #00012857' TO DFHEIV0
 14153     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 14154     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14155     MOVE X'4320233030303132383537' TO DFHEIV0(25:11)
 14156     CALL 'kxdfhei1' USING DFHEIV0
 14157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14158
 14159
 14160     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 14161
 14162     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 14163        'I' OR 'G' OR 'F')
 14164        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14165     ELSE
 14166        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14167     END-IF.
 14168
 14169     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14170     MOVE '6'                    TO DC-OPTION-CODE.
 14171     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14172
 14173     IF (WS-INCUR GREATER THAN DC-BIN-DATE-2)
 14174        and (dc-elapsed-months > zeros)
 14175        MOVE ER-0519             TO EMI-ERROR
 14176        MOVE -1                  TO INCURL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 269
* EL130.cbl
 14177        MOVE AL-UABON            TO INCURA
 14178        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14179     END-IF.
 14180
 14181     IF CLMCARRI NOT = CRTCARRI
 14182        MOVE ER-0562             TO EMI-ERROR
 14183        MOVE AL-UABON            TO CLMCARRA
 14184        MOVE -1                  TO CLMCARRL
 14185        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14186     END-IF.
 14187
 14188     if (pi-company-id = 'DCC' OR 'VPP')
 14189        and (ws-dcc-product-code <> spaces)
 14190        continue
 14191     else
 14192      IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F') AND
 14193        CM-AH-BENEFIT-CD = '00')
 14194                  OR
 14195        ((CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O') AND
 14196        CM-LF-BENEFIT-CD = '00')
 14197         MOVE ER-0521         TO EMI-ERROR
 14198         MOVE AL-UABON        TO CLMTYPEA
 14199         MOVE -1              TO CLMTYPEL
 14200         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14201      END-IF
 14202     end-if
 14203*    IF CLMTYPEI = 'I' AND
 14204*       CM-AH-CRITICAL-PERIOD = +0
 14205*        MOVE ER-0521         TO EMI-ERROR
 14206*        MOVE AL-UABON        TO CLMTYPEA
 14207*        MOVE -1              TO CLMTYPEL
 14208*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14209*    END-IF
 14210
 14211*    IF PI-COMPANY-ID = 'CRI'
 14212*        IF MAINTI = 'A'
 14213*            IF CERT-PEND-ISSUE-ERROR  OR
 14214*               CERT-PEND-ISSUE-RETURNED
 14215*                MOVE -1                 TO CERTNOL
 14216*                MOVE AL-UABON           TO CERTNOA
 14217*                MOVE ER-7640            TO EMI-ERROR
 14218*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14219*            END-IF
 14220*        END-IF
 14221*    END-IF.
 14222
 14223     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 14224         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 14225         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 14226             GO TO 6450-DATE-ERROR
 14227         END-IF
 14228     END-IF.
 14229
 14230     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 14231         (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'))
 14232         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 14233             GO TO 6450-DATE-ERROR
 14234         END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 270
* EL130.cbl
 14235     END-IF.
 14236
 14237     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14238         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 14239             GO TO 6450-DATE-ERROR
 14240         END-IF
 14241     END-IF.
 14242
 14243     GO TO 6499-EXIT.
 14244
 14245 6450-DATE-ERROR.
 14246     MOVE ER-0520                TO EMI-ERROR.
 14247     MOVE -1                     TO INCURL.
 14248     MOVE AL-UABON               TO INCURA.
 14249     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14250
 14251*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 14252*       (EMI-SEVERITY-SAVE = 'X')
 14253*        ADD 1                TO EMI-FORCABLE-CTR
 14254*        SUBTRACT 1 FROM EMI-FATAL-CTR
 14255*    END-IF.
 14256
 14257     GO TO 6499-EXIT.
 14258
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 271
* EL130.cbl
 14260 6460-TEST-NEW-CERT.
 14261
 14262     IF NOT EMI-NO-ERRORS
 14263        GO TO 6499-EXIT
 14264     END-IF.
 14265
 14266     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 14267
 14268     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14269          OR 'F') AND
 14270         ACVOTRML GREATER ZERO)
 14271        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 14272     END-IF.
 14273
 14274     IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O') AND
 14275         LCVOTRML GREATER ZERO
 14276        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 14277     END-IF.
 14278
 14279     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 14280
 14281*    IF PI-COMPANY-ID = 'HAN'
 14282*        IF ADDONDTL GREATER ZERO
 14283*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 14284*            IF CLMTYPEI = 'A'
 14285*                IF ACVOTRMI NOT = ZEROS
 14286*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 14287*                ELSE
 14288*                    NEXT SENTENCE
 14289*                    CONTINUE
 14290*                END-IF
 14291*            ELSE
 14292*                IF LCVOTRMI NOT = ZEROS
 14293*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 14294*                END-IF
 14295*            END-IF
 14296*        END-IF
 14297*    END-IF.
 14298
 14299     MOVE '6'                    TO DC-OPTION-CODE.
 14300     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14301
 14302     IF NO-CONVERSION-ERROR
 14303         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 14304     END-IF.
 14305
 14306     IF WS-INCUR GREATER THAN WS-EXPIRE
 14307        MOVE ER-0519             TO EMI-ERROR
 14308        MOVE -1                  TO INCURL
 14309        MOVE AL-UABON            TO INCURA
 14310        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14311     END-IF.
 14312
 14313     IF CLMCARRI NOT = CRTCARRI
 14314        MOVE ER-0562             TO EMI-ERROR
 14315        MOVE AL-UABON            TO CLMCARRA
 14316        MOVE -1                  TO CLMCARRL
 14317        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 272
* EL130.cbl
 14318     END-IF.
 14319
 14320     if (pi-company-id = 'DCC' OR 'VPP')
 14321        and (ws-dcc-product-code <> spaces)
 14322        continue
 14323     else
 14324        IF (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 14325           and (ACVCDL = ZEROS)
 14326           MOVE ER-0521          TO EMI-ERROR
 14327           MOVE AL-UABON         TO CLMTYPEA
 14328           MOVE -1               TO CLMTYPEL
 14329           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14330        END-IF
 14331     end-if
 14332
 14333     if (pi-company-id = 'DCC' OR 'VPP')
 14334        and (ws-dcc-product-code <> spaces)
 14335        continue
 14336     else
 14337        IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O')
 14338           and (LCVCDL = ZEROS)
 14339           MOVE ER-0521          TO EMI-ERROR
 14340           MOVE AL-UABON         TO CLMTYPEA
 14341           MOVE -1               TO CLMTYPEL
 14342           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14343        END-IF
 14344     end-if
 14345
 14346     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'
 14347         IF LCVCNDTL GREATER ZERO
 14348             IF WS-INCUR GREATER THAN WS-LCVCNDT
 14349                 GO TO 6450-DATE-ERROR
 14350             END-IF
 14351         END-IF
 14352     END-IF.
 14353
 14354     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14355         IF ACVCNDTL GREATER ZERO
 14356             IF WS-INCUR GREATER THAN WS-ACVCNDT
 14357                 GO TO 6450-DATE-ERROR
 14358             END-IF
 14359         END-IF
 14360     END-IF.
 14361
 14362 6499-EXIT.
 14363     EXIT.
 14364 6500-get-acct.
 14365
 14366     MOVE SPACES                 TO ERACCT-KEY
 14367                                    ws-dcc-product-code
 14368                                    ws-acct-found-sw
 14369
 14370     IF CARR-GROUP-ST-ACCNT-CNTL
 14371        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 14372        MOVE CRTCARRI            TO ACCT-CARRIER
 14373        MOVE GROUPI              TO ACCT-GROUPING
 14374        MOVE STATEI              TO ACCT-STATE
 14375        MOVE ACCOUNTI            TO ACCT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 273
* EL130.cbl
 14376        GO TO 6500-startbr
 14377     END-IF
 14378
 14379     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 14380     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 14381
 14382     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 14383        MOVE STATEI             TO ACCT-STATE
 14384     END-IF
 14385
 14386     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 14387        MOVE CRTCARRI           TO ACCT-CARRIER
 14388     END-IF
 14389
 14390     .
 14391 6500-startbr.
 14392
 14393     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 14394
 14395
 14396* EXEC CICS STARTBR
 14397*       DATASET     (ERACCT2-DSID)
 14398*       RIDFLD      (SAVE-ERACCT-KEY)
 14399*       GENERIC
 14400*       KEYLENGTH   (20)
 14401*       resp        (ws-response)
 14402*    END-EXEC
 14403     MOVE 20
 14404       TO DFHEIV11
 14405     MOVE 0
 14406       TO DFHEIV12
 14407*    MOVE '&,   KG    G          &  N#00013097' TO DFHEIV0
 14408     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 14409     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14410     MOVE X'204E233030303133303937' TO DFHEIV0(25:11)
 14411     CALL 'kxdfhei1' USING DFHEIV0,
 14412           ERACCT2-DSID,
 14413           SAVE-ERACCT-KEY,
 14414           DFHEIV11,
 14415           DFHEIV12,
 14416           DFHEIV99
 14417     MOVE EIBRESP  TO ws-response
 14418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14419
 14420     if not ws-resp-normal
 14421        go to 6500-exit
 14422     end-if
 14423
 14424     .
 14425 6500-readnext.
 14426
 14427
 14428* EXEC CICS READNEXT
 14429*       DATASET   (ERACCT2-DSID)
 14430*       SET       (ADDRESS OF ACCOUNT-MASTER)
 14431*       RIDFLD    (SAVE-ERACCT-KEY)
 14432*    END-EXEC
 14433     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 274
* EL130.cbl
 14434       TO DFHEIV11
 14435*    MOVE '&.S                   )   #00013112' TO DFHEIV0
 14436     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14437     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14438     MOVE X'2020233030303133313132' TO DFHEIV0(25:11)
 14439     CALL 'kxdfhei1' USING DFHEIV0,
 14440           ERACCT2-DSID,
 14441           DFHEIV20,
 14442           DFHEIV99,
 14443           SAVE-ERACCT-KEY,
 14444           DFHEIV99,
 14445           DFHEIV11,
 14446           DFHEIV99,
 14447           DFHEIV99
 14448     SET ADDRESS OF ACCOUNT-MASTER TO
 14449         DFHEIV20
 14450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14451
 14452     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14453        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14454        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14455        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14456        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14457        go to 6500-endbr
 14458     END-IF
 14459
 14460     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14461        and (WS-EFFDT < AM-EXPIRATION-DT)
 14462        set acct-found to true
 14463        MOVE AM-dcc-product-code to ws-dcc-product-code
 14464        GO TO 6500-endbr
 14465     END-IF
 14466
 14467     IF WS-EFFDT >= AM-EXPIRATION-DT
 14468         GO TO 6500-readnext
 14469     END-IF
 14470
 14471     .
 14472 6500-endbr.
 14473
 14474
 14475* EXEC CICS ENDBR
 14476*        DATASET    (ERACCT2-DSID)
 14477*    END-EXEC
 14478     MOVE 0
 14479       TO DFHEIV11
 14480*    MOVE '&2                    $   #00013140' TO DFHEIV0
 14481     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14482     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14483     MOVE X'2020233030303133313430' TO DFHEIV0(25:11)
 14484     CALL 'kxdfhei1' USING DFHEIV0,
 14485           ERACCT2-DSID,
 14486           DFHEIV11,
 14487           DFHEIV99
 14488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14489
 14490     .
 14491 6500-exit.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 275
* EL130.cbl
 14492     exit.
 14493 6600-CHECK-AUTO-ACTIVITY.
 14494
 14495
 14496* EXEC CICS HANDLE CONDITION
 14497*        NOTFND   (6600-NOT-FOUND)
 14498*    END-EXEC.
 14499*    MOVE '"$I                   ! D #00013149' TO DFHEIV0
 14500     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14502     MOVE X'4420233030303133313439' TO DFHEIV0(25:11)
 14503     CALL 'kxdfhei1' USING DFHEIV0
 14504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14505
 14506
 14507     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14508     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14509     MOVE SPACES                     TO  CNTL-ACCESS.
 14510     MOVE +0                         TO  CNTL-SEQ-NO.
 14511
 14512     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14513
 14514     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14515         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14516                                         WS-LETTER-SW
 14517         GO TO 6600-EXIT
 14518     END-IF.
 14519
 14520     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14521         MOVE 'N'                     TO  WS-LETTER-SW
 14522     ELSE
 14523         MOVE 'Y'                     TO  WS-LETTER-SW
 14524     END-IF.
 14525
 14526     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14527     GO TO 6600-EXIT.
 14528
 14529 6600-START-AUTO-LETTER-WRITER.
 14530
 14531     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14532     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14533
 14534     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14535
 14536     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14537         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14538         MOVE '6'                     TO  DC-OPTION-CODE
 14539         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14540         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14541         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14542         IF NO-CONVERSION-ERROR
 14543             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14544         ELSE
 14545             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14546         END-IF
 14547     END-IF.
 14548
 14549     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 276
* EL130.cbl
 14550         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14551         MOVE '6'                     TO  DC-OPTION-CODE
 14552         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14553         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14554         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14555         IF NO-CONVERSION-ERROR
 14556             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14557         ELSE
 14558             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14559         END-IF
 14560     END-IF.
 14561
 14562
 14563
 14564* EXEC CICS LINK
 14565*        PROGRAM    (LINK-1523)
 14566*        COMMAREA   (W-1523-LINKDATA)
 14567*        LENGTH     (W-1523-COMM-LENGTH)
 14568*    END-EXEC.
 14569*    MOVE '."C                   (   #00013209' TO DFHEIV0
 14570     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14571     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14572     MOVE X'2020233030303133323039' TO DFHEIV0(25:11)
 14573     CALL 'kxdfhei1' USING DFHEIV0,
 14574           LINK-1523,
 14575           W-1523-LINKDATA,
 14576           W-1523-COMM-LENGTH,
 14577           DFHEIV99,
 14578           DFHEIV99,
 14579           DFHEIV99,
 14580           DFHEIV99
 14581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14582
 14583
 14584     GO TO 6600-EXIT.
 14585
 14586 6600-NOT-FOUND.
 14587     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14588
 14589 6600-EXIT.
 14590     EXIT.
 14591
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 277
* EL130.cbl
 14592/
 14593*************************************************************
 14594*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14595*************************************************************
 14596
 14597 6700-OUTPUT-ACTIVITY-RECORD.
 14598
 14599
 14600
 14601* EXEC CICS GETMAIN
 14602*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14603*        LENGTH (DLYACTV-LENGTH)
 14604*        INITIMG (WS-BLANK)
 14605*    END-EXEC.
 14606*    MOVE ',"IL                  $   #00013231' TO DFHEIV0
 14607     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14608     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14609     MOVE X'2020233030303133323331' TO DFHEIV0(25:11)
 14610     CALL 'kxdfhei1' USING DFHEIV0,
 14611           DFHEIV20,
 14612           DLYACTV-LENGTH,
 14613           WS-BLANK
 14614     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14615         DFHEIV20
 14616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14617
 14618
 14619     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14620     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14621     MOVE CLMCARRI               TO DA-CARRIER.
 14622     IF CLMNOL EQUAL ZERO
 14623         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14624     ELSE
 14625         MOVE CLMNOI             TO DA-CLAIM-NO
 14626     END-IF.
 14627     MOVE CERTNOI                TO DA-CERT-PRIME.
 14628     MOVE SUFXI                  TO DA-CERT-SFX.
 14629     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14630     MOVE 'A'                    TO DA-RECORD-TYPE.
 14631
 14632
 14633* EXEC CICS HANDLE CONDITION
 14634*        NOTOPEN (6700-NOTOPEN-ERROR)
 14635*        DUPREC (6700-EXIT)
 14636*    END-EXEC.
 14637*    MOVE '"$J%                  ! E #00013250' TO DFHEIV0
 14638     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14639     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14640     MOVE X'4520233030303133323530' TO DFHEIV0(25:11)
 14641     CALL 'kxdfhei1' USING DFHEIV0
 14642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14643
 14644
 14645
 14646* EXEC CICS WRITE
 14647*        DATASET (DLYACTV-DSID)
 14648*        RIDFLD (DA-KEY)
 14649*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 278
* EL130.cbl
 14650*        LENGTH (DLYACTV-LENGTH)
 14651*    END-EXEC.
 14652*    MOVE '&$ L                  ''   #00013255' TO DFHEIV0
 14653     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14654     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14655     MOVE X'2020233030303133323535' TO DFHEIV0(25:11)
 14656     CALL 'kxdfhei1' USING DFHEIV0,
 14657           DLYACTV-DSID,
 14658           DAILY-ACTIVITY-RECORD,
 14659           DLYACTV-LENGTH,
 14660           DA-KEY,
 14661           DFHEIV99,
 14662           DFHEIV99
 14663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14664
 14665     GO TO 6700-EXIT.
 14666
 14667 6700-NOTOPEN-ERROR.
 14668     MOVE '2955'                 TO EMI-ERROR.
 14669     MOVE -1                     TO MAINTL.
 14670     MOVE AL-UANON               TO MAINTA.
 14671     PERFORM 9900-ERROR-FORMAT THRU
 14672             9900-EXIT.
 14673     GO TO 8200-SEND-DATAONLY.
 14674
 14675 6700-EXIT.
 14676     EXIT.
 14677
 14678*************************************************************
 14679*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14680*************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 279
* EL130.cbl
 14681/
 14682 6990-DEEDIT-DATE.
 14683
 14684
 14685* EXEC CICS BIF DEEDIT
 14686*        FIELD   (DATE-WORK)
 14687*        LENGTH  (8)
 14688*    END-EXEC.
 14689     MOVE 8
 14690       TO DFHEIV11
 14691*    MOVE '@"L                   #   #00013280' TO DFHEIV0
 14692     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14693     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14694     MOVE X'2020233030303133323830' TO DFHEIV0(25:11)
 14695     CALL 'kxdfhei1' USING DFHEIV0,
 14696           DATE-WORK,
 14697           DFHEIV11
 14698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14699
 14700 6990-EXIT.
 14701     EXIT.
 14702
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 280
* EL130.cbl
 14704 7000-BUILD-OUTPUT-MAP.
 14705
 14706     IF CLAIM-SWITCH = 'N'
 14707         GO TO 7050-BUILD-MAP-CERT-DATA
 14708     END-IF.
 14709
 14710     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14711         MOVE SPACES                 TO SEQUO
 14712         MOVE AL-SABOF               TO SEQUA
 14713     ELSE
 14714         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14715         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14716         MOVE WS-CLAIM-SEQU          TO SEQUO
 14717         MOVE AL-SABON               TO SEQUA
 14718     END-IF.
 14719
 14720     MOVE CL-CARRIER             TO CLMCARRO.
 14721     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14722     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14723     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14724     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14725     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14726     MOVE CL-INSURED-MID-INIT    TO INITO.
 14727     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14728     move cl-insured-type        to instypeo
 14729*    MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14730
 14731     MOVE AL-UANON               TO CLMCARRA
 14732                                    CLMTYPEA
 14733                                    PCERTNOA
 14734                                    PSUFXA
 14735                                    LSTNMEA
 14736                                    FSTNMEA
 14737                                    INITA
 14738                                    SEXA
 14739
 14740     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14741
 14742     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14743         MOVE ' '                 TO DC-OPTION-CODE
 14744         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14745         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14746         IF NOT DATE-CONVERSION-ERROR
 14747             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14748             MOVE AL-UANON            TO BIRTHDTA
 14749         END-IF
 14750     END-IF.
 14751
 14752     MOVE CL-SOC-SEC-NO          TO SSNO.
 14753     MOVE AL-UANON               TO SSNA.
 14754
 14755     IF CL-INCURRED-DT NOT = LOW-VALUES
 14756         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14757         MOVE ' '                TO DC-OPTION-CODE
 14758         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14759         IF NOT DATE-CONVERSION-ERROR
 14760             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14761             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 281
* EL130.cbl
 14762         END-IF
 14763     END-IF.
 14764
 14765     IF CL-REPORTED-DT NOT = LOW-VALUES
 14766         MOVE ' '                TO DC-OPTION-CODE
 14767         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14768         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14769         IF NOT DATE-CONVERSION-ERROR
 14770             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14771             MOVE AL-UANON            TO REPORTA
 14772         END-IF
 14773     END-IF.
 14774
 14775*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14776*        MOVE ' '                 TO DC-OPTION-CODE
 14777*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14778*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14779*        IF NOT DATE-CONVERSION-ERROR
 14780*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14781*            MOVE AL-UANON            TO ESTENDA
 14782*        END-IF
 14783*    END-IF.
 14784
 14785     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14786     MOVE WS-ICD-CODE-1          TO ICD1O.
 14787     MOVE WS-ICD-CODE-2          TO ICD2O.
 14788*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14789     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14790     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14791     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14792     MOVE CL-PRIORITY-CD         TO PRICDO.
 14793     MOVE AL-UANON               TO DIAGA
 14794                                    ICD1A
 14795                                    ICD2A
 14796*                                   CAUSEA
 14797                                    RELCLMA
 14798                                    PROCCDA
 14799                                    PRICDA.
 14800     MOVE AL-UNNON               TO MANRSVA.
 14801
 14802*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14803*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14804*        MOVE AL-UANON               TO PRODCDA
 14805*    END-IF.
 14806
 14807     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14808     MOVE CL-FILE-LOCATION       TO FILETOO.
 14809     MOVE CL-BENEFICIARY         TO BENECDO.
 14810     MOVE AL-UANON               TO SUPVA
 14811                                    FILETOA
 14812                                    BENECDA.
 14813
 14814     IF CLAIM-SWITCH = 'X'
 14815         GO TO 7099-EXIT
 14816     END-IF.
 14817
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 282
* EL130.cbl
 14819 7050-BUILD-MAP-CERT-DATA.
 14820     MOVE CM-CERT-PRIME          TO CERTNOO.
 14821     MOVE CM-CERT-SFX            TO SUFXO.
 14822     MOVE AL-SANON               TO CERTNOA
 14823                                    SUFXA.
 14824
 14825     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14826         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14827         MOVE ' '                TO DC-OPTION-CODE
 14828         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14829         IF NOT DATE-CONVERSION-ERROR
 14830             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14831         END-IF
 14832     END-IF.
 14833
 14834     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14835     MOVE CM-STATE               TO STATEO.
 14836     MOVE CM-CARRIER             TO CRTCARRO.
 14837     MOVE CM-GROUPING            TO GROUPO.
 14838     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14839     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14840     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14841     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14842     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14843     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14844     MOVE CM-JT-INITIAL          TO JNTINITO.
 14845     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14846     MOVE AL-UANON               TO ACCOUNTA
 14847                                    STATEA
 14848                                    CRTCARRA
 14849                                    GROUPA
 14850                                    CRTLNMEA
 14851                                    CRTFNMEA
 14852                                    CRTINITA
 14853                                    JNTLNMEA
 14854                                    JNTFNMEA
 14855                                    JNTINITA.
 14856     MOVE AL-UNNON               TO ISSAGEA
 14857                                    JNTAGEA.
 14858
 14859     IF CM-SSN-STATE   = CM-STATE AND
 14860        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14861*        NEXT SENTENCE
 14862         CONTINUE
 14863     ELSE
 14864         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14865     END-IF.
 14866
 14867     MOVE AL-UANON               TO CRTSSNA.
 14868
 14869     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14870     MOVE '2'                    TO DC-OPTION-CODE.
 14871     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14872     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14873
 14874*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14875     MOVE SPACES                 TO ELCNTL-KEY.
 14876     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 283
* EL130.cbl
 14877     MOVE '3'                    TO CNTL-REC-TYPE.
 14878     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14879     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14880
 14881
 14882
 14883* EXEC CICS READ
 14884*        DATASET  (ELCNTL-DSID)
 14885*        SET      (ADDRESS OF CONTROL-FILE)
 14886*        RIDFLD   (ELCNTL-KEY)
 14887*        RESP     (WS-RESPONSE)
 14888*    END-EXEC.
 14889*    MOVE '&"S        E          (  N#00013466' TO DFHEIV0
 14890     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14891     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14892     MOVE X'204E233030303133343636' TO DFHEIV0(25:11)
 14893     CALL 'kxdfhei1' USING DFHEIV0,
 14894           ELCNTL-DSID,
 14895           DFHEIV20,
 14896           DFHEIV99,
 14897           ELCNTL-KEY,
 14898           DFHEIV99,
 14899           DFHEIV99,
 14900           DFHEIV99
 14901     SET ADDRESS OF CONTROL-FILE TO
 14902         DFHEIV20
 14903     MOVE EIBRESP  TO WS-RESPONSE
 14904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14905
 14906
 14907     IF WS-RESP-NOTFND
 14908          MOVE ER-2848           TO EMI-ERROR
 14909          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14910          GO TO 8100-SEND-INITIAL-MAP
 14911     END-IF.
 14912
 14913     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14914     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14915     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 284
* EL130.cbl
 14917     IF CM-LF-BENEFIT-CD = '00'
 14918         MOVE ZEROS              TO LCVOTRMO
 14919                                    LCVRTRMO
 14920                                    LCVRATEO
 14921                                    LCVBENEO
 14922         MOVE SPACES             TO LCVDSCRO
 14923                                    LCVCDO
 14924                                    LCVKINDO
 14925                                    LCVFORMO
 14926                                    LCVCNDTO
 14927                                    LCVEXITO
 14928                                    LCVSTATO
 14929         IF CLMTYPEL GREATER THAN ZERO AND
 14930            CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'
 14931                MOVE ER-0521     TO EMI-ERROR
 14932                MOVE AL-UABON    TO CLMTYPEA
 14933                MOVE -1          TO CLMTYPEL
 14934                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14935                GO TO 7060-FILL-AH-COVERAGE
 14936         ELSE
 14937             GO TO 7060-FILL-AH-COVERAGE
 14938         END-IF
 14939     END-IF.
 14940
 14941     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14942     MOVE AL-UANON               TO LCVDSCRA.
 14943     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14944     MOVE '4'                    TO WS-REC-TYPE.
 14945     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14946     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14947     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14948     MOVE AL-UANON               TO LCVCDA.
 14949     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14950                                    CP-ORIGINAL-TERM.
 14951     MOVE AL-UNNON               TO LCVOTRMA.
 14952     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14953     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14954     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14955     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14956     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14957     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14958
 14959     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14960     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14961
 14962     IF CM-LF-PREMIUM-RATE NUMERIC
 14963         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14964     ELSE
 14965         MOVE ZEROS              TO LCVRATEO
 14966     END-IF.
 14967
 14968     MOVE AL-UNNON               TO LCVRATEA.
 14969
 14970     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14971         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14972     END-IF.
 14973
 14974     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 285
* EL130.cbl
 14975
 14976     MOVE AL-UNNON               TO LCVBENEA.
 14977
 14978     IF CM-POLICY-FORM-NO NOT = SPACES
 14979         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14980     ELSE
 14981         MOVE WS-FORM-HOLD       TO LCVFORMO
 14982     END-IF.
 14983
 14984     MOVE SPACES                 TO WS-FORM-HOLD.
 14985     MOVE 'L'                    TO WS-REC-TYPE.
 14986     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14987
 14988     IF WS-FORM-HOLD NOT = SPACES
 14989         MOVE WS-FORM-HOLD       TO LCVFORMO
 14990         MOVE AL-UANON           TO LCVFORMA
 14991     END-IF.
 14992
 14993     IF CM-LF-CURRENT-STATUS = '8'
 14994         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14995             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14996             MOVE ' '             TO DC-OPTION-CODE
 14997             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14998             IF NOT DATE-CONVERSION-ERROR
 14999                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 15000                 MOVE AL-UANON            TO LCVCNDTA
 15001             END-IF
 15002         END-IF
 15003     END-IF.
 15004
 15005     IF CM-LF-CURRENT-STATUS = '7'
 15006         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15007             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 15008             MOVE ' '            TO DC-OPTION-CODE
 15009             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15010             IF NOT DATE-CONVERSION-ERROR
 15011                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 15012                 MOVE AL-UANON   TO LCVCNDTA
 15013             END-IF
 15014         END-IF
 15015     END-IF.
 15016
 15017     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15018         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 15019             MOVE ' '            TO DC-OPTION-CODE
 15020             MOVE CM-LF-DEATH-EXIT-DT
 15021                                 TO DC-BIN-DATE-1
 15022             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15023             IF NOT DATE-CONVERSION-ERROR
 15024                 MOVE DC-GREG-DATE-1-EDIT
 15025                                 TO LCVEXITO
 15026             END-IF
 15027         END-IF
 15028     END-IF.
 15029
 15030     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15031         IF CP-REMAINING-TERM-3 = ZEROS
 15032             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 286
* EL130.cbl
 15033         ELSE
 15034             MOVE 'ACTIVE'       TO LCVSTATO
 15035         END-IF
 15036     END-IF.
 15037
 15038     IF CM-LF-CURRENT-STATUS = '2'
 15039        MOVE 'PEND  '            TO LCVSTATO
 15040     END-IF.
 15041     IF CM-LF-CURRENT-STATUS = '3'
 15042        MOVE 'RESTORE'           TO LCVSTATO
 15043     END-IF.
 15044     IF CM-LF-CURRENT-STATUS = '5'
 15045        MOVE 'REISSUE'           TO LCVSTATO
 15046     END-IF.
 15047     IF CM-LF-CURRENT-STATUS = '6'
 15048        MOVE 'LMP DIS'           TO LCVSTATO
 15049     END-IF.
 15050     IF CM-LF-CURRENT-STATUS = '7'
 15051        MOVE 'DEATH  '           TO LCVSTATO
 15052     END-IF.
 15053     IF CM-LF-CURRENT-STATUS = '8'
 15054        MOVE 'CANCEL '           TO LCVSTATO
 15055     END-IF.
 15056     IF CM-LF-CURRENT-STATUS = '9'
 15057        MOVE 'RE-ONLY'           TO LCVSTATO
 15058     END-IF.
 15059     IF CM-LF-CURRENT-STATUS = 'V'
 15060        MOVE 'VOID   '           TO LCVSTATO
 15061     END-IF.
 15062     IF CM-LF-CURRENT-STATUS = 'D'
 15063        MOVE 'DECLINE'           TO LCVSTATO
 15064     END-IF.
 15065
 15066     IF PI-COMPANY-ID = 'CID'
 15067         IF CM-LF-BENEFIT-CD >= '2O' AND
 15068            CM-LF-BENEFIT-CD <= '2V'
 15069             MOVE ER-0878       TO EMI-ERROR
 15070             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15071         END-IF
 15072     END-IF.
 15073
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 287
* EL130.cbl
 15075 7060-FILL-AH-COVERAGE.
 15076
 15077     IF CM-AH-BENEFIT-CD = '00'
 15078         MOVE ZEROS              TO ACVOTRMO
 15079                                    ACVRTRMO
 15080                                    ACVRATEO
 15081                                    ACVBENEO
 15082         MOVE SPACES             TO ACVDSCRO
 15083                                    ACVCDO
 15084                                    ACVKINDO
 15085                                    ACVFORMO
 15086                                    ACVCNDTO
 15087                                    ACVEXITO
 15088                                    ACVSTATO
 15089         IF (CLMTYPEL GREATER THAN ZERO AND
 15090             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 15091             MOVE ER-0521     TO EMI-ERROR
 15092             MOVE AL-UABON    TO CLMTYPEA
 15093             MOVE -1          TO CLMTYPEL
 15094             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15095             GO TO 7070-BUILD-MAP-FINISH
 15096         ELSE
 15097             GO TO 7070-BUILD-MAP-FINISH
 15098         END-IF
 15099     END-IF.
 15100
 15101     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15102     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 15103     MOVE AL-UANON               TO ACVDSCRA
 15104                                    ACVCDA.
 15105     MOVE '5'                    TO WS-REC-TYPE.
 15106     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 15107     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 15108
 15109     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 15110                                    CP-ORIGINAL-TERM.
 15111     MOVE AL-UNNON               TO ACVOTRMA.
 15112
 15113     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15114     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15115     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 15116     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15117     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15118     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15119
 15120     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 15121     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15122
 15123     IF CM-AH-PREMIUM-RATE NUMERIC
 15124         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15125     ELSE
 15126         MOVE ZEROS              TO ACVRATEO
 15127     END-IF.
 15128
 15129     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 15130     MOVE AL-UNNON               TO ACVRATEA
 15131                                    ACVBENEA.
 15132
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 288
* EL130.cbl
 15133     IF CM-POLICY-FORM-NO NOT = SPACES
 15134         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 15135     ELSE
 15136         MOVE WS-FORM-HOLD       TO ACVFORMO
 15137         MOVE SPACES TO WS-FORM-HOLD
 15138         MOVE 'A'                TO WS-REC-TYPE
 15139         PERFORM 7400-READ-STATE THRU 7499-EXIT
 15140         IF WS-FORM-HOLD NOT = SPACES
 15141             MOVE WS-FORM-HOLD   TO ACVFORMO
 15142         END-IF
 15143     END-IF.
 15144
 15145     MOVE AL-UANON               TO ACVFORMA.
 15146
 15147     IF CM-AH-CURRENT-STATUS = '8'
 15148         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 15149             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15150             MOVE ' '             TO DC-OPTION-CODE
 15151             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15152             IF NOT DATE-CONVERSION-ERROR
 15153                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15154                MOVE AL-UANON    TO ACVCNDTA
 15155             END-IF
 15156         END-IF
 15157     END-IF.
 15158
 15159     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15160         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15161             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 15162             MOVE ' '             TO DC-OPTION-CODE
 15163             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15164             IF NOT DATE-CONVERSION-ERROR
 15165                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15166                MOVE AL-UANON            TO ACVCNDTA
 15167             END-IF
 15168         END-IF
 15169     END-IF.
 15170
 15171     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15172         MOVE ' '                TO DC-OPTION-CODE
 15173         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15174         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15175         IF NOT DATE-CONVERSION-ERROR
 15176             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 15177         END-IF
 15178     END-IF.
 15179
 15180     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15181         IF CP-REMAINING-TERM-3 = ZEROS
 15182             MOVE 'EXPIRED'      TO ACVSTATO
 15183         ELSE
 15184             MOVE 'ACTIVE'       TO ACVSTATO
 15185         END-IF
 15186     END-IF.
 15187
 15188     IF CM-AH-CURRENT-STATUS = '2'
 15189         MOVE 'PEND  '           TO ACVSTATO
 15190     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 289
* EL130.cbl
 15191     IF CM-AH-CURRENT-STATUS = '3'
 15192         MOVE 'RESTORE'          TO ACVSTATO
 15193     END-IF.
 15194     IF CM-AH-CURRENT-STATUS = '5'
 15195         MOVE 'REISSUE'          TO ACVSTATO
 15196     END-IF.
 15197     IF CM-AH-CURRENT-STATUS = '6'
 15198         MOVE 'LMP DIS'          TO ACVSTATO
 15199     END-IF.
 15200     IF CM-AH-CURRENT-STATUS = '7'
 15201         MOVE 'DEATH  '          TO ACVSTATO
 15202     END-IF.
 15203     IF CM-AH-CURRENT-STATUS = '8'
 15204         MOVE 'CANCEL '          TO ACVSTATO
 15205     END-IF.
 15206     IF CM-AH-CURRENT-STATUS = '9'
 15207         MOVE 'RE-ONLY'          TO ACVSTATO
 15208     END-IF.
 15209     IF CM-AH-CURRENT-STATUS = 'V'
 15210         MOVE 'VOID   '          TO ACVSTATO
 15211     END-IF.
 15212     IF CM-AH-CURRENT-STATUS = 'D'
 15213         MOVE 'DECLINE'          TO ACVSTATO
 15214     END-IF.
 15215
 15216     IF PI-COMPANY-ID = 'DCC' OR 'VPP'
 15217        IF CM-ACCOUNT (9:2) = 'BI'
 15218           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 15219           MOVE CM-CARRIER       TO CTRLR-CARRIER
 15220           MOVE CM-GROUPING      TO CTRLR-GROUPING
 15221           MOVE CM-STATE         TO CTRLR-STATE
 15222           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 15223           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 15224           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 15225           MOVE 'C'              TO CTRLR-REC-TYPE
 15226
 15227* EXEC CICS READ
 15228*            DATASET  (ELCRTT-DSID)
 15229*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 15230*            RIDFLD   (ELCRTT-KEY)
 15231*            RESP     (WS-RESPONSE)
 15232*          END-EXEC
 15233*    MOVE '&"S        E          (  N#00013792' TO DFHEIV0
 15234     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15235     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15236     MOVE X'204E233030303133373932' TO DFHEIV0(25:11)
 15237     CALL 'kxdfhei1' USING DFHEIV0,
 15238           ELCRTT-DSID,
 15239           DFHEIV20,
 15240           DFHEIV99,
 15241           ELCRTT-KEY,
 15242           DFHEIV99,
 15243           DFHEIV99,
 15244           DFHEIV99
 15245     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 15246         DFHEIV20
 15247     MOVE EIBRESP  TO WS-RESPONSE
 15248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 290
* EL130.cbl
 15249           IF WS-RESP-NORMAL
 15250               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 15251               MOVE WS-DIAG-VIN-MSG TO DIAGO
 15252               MOVE AL-UANON        TO DIAGA
 15253           END-IF
 15254        END-IF
 15255     END-IF.
 15256
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 291
* EL130.cbl
 15258 7070-BUILD-MAP-FINISH.
 15259     MOVE CM-LOAN-APR            TO APRO.
 15260     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15261     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15262     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 15263     MOVE AL-UNNON               TO APRA
 15264                                    PMTFREQA.
 15265     MOVE AL-UANON               TO INDGRPA
 15266                                    PREMTYPA.
 15267
 15268     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 15269         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 15270         MOVE AL-UANON               TO REINCDA
 15271     END-IF.
 15272
 15273     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 15274*        NEXT SENTENCE
 15275         CONTINUE
 15276     ELSE
 15277         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15278         MOVE ' '                TO DC-OPTION-CODE
 15279         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15280         IF NOT DATE-CONVERSION-ERROR
 15281             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 15282             MOVE AL-UANON            TO ADDONDTA
 15283         END-IF
 15284     END-IF.
 15285
 15286     IF CLAIM-SWITCH = 'N'
 15287         IF SEXL = ZEROS
 15288             MOVE CM-INSURED-SEX TO SEXO
 15289*            MOVE AL-UANON       TO SEXA
 15290         END-IF
 15291     END-IF.
 15292
 15293     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 15294         MOVE CM-MEMBER-NO       TO MEMBERO
 15295         MOVE AL-UANON           TO MEMBERA
 15296     END-IF.
 15297
 15298     IF MAINTI = 'A'
 15299         IF (LOANNOL = ZEROS OR
 15300             EIBAID = DFHPF5)
 15301             MOVE CM-LOAN-NUMBER TO LOANNOO
 15302             MOVE AL-UANON       TO LOANNOA
 15303         ELSE
 15304*            NEXT SENTENCE
 15305             CONTINUE
 15306         END-IF
 15307     ELSE
 15308         MOVE CM-LOAN-NUMBER     TO LOANNOO
 15309         MOVE AL-UANON           TO LOANNOA
 15310     END-IF.
 15311
 15312     IF MAINTI = 'A'
 15313         IF (LOANBALL = ZEROS OR
 15314             EIBAID = DFHPF5)
 15315             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 292
* EL130.cbl
 15316             MOVE AL-UNNON       TO LOANBALA
 15317         ELSE
 15318*            NEXT SENTENCE
 15319             CONTINUE
 15320         END-IF
 15321     ELSE
 15322         MOVE CM-LOAN-BALANCE    TO LOANBALO
 15323         MOVE AL-UNNON           TO LOANBALA
 15324     END-IF.
 15325
 15326     IF CM-PREMIUM-TYPE NOT = '3'
 15327         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15328             PERFORM 7200-PROTECT-CERT-FIELDS
 15329         ELSE
 15330             PERFORM 7300-RESET-KEY-ATTRBS
 15331         END-IF
 15332     ELSE
 15333         PERFORM 7300-RESET-KEY-ATTRBS
 15334     END-IF.
 15335
 15336*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15337*        NEXT SENTENCE
 15338*        CONTINUE
 15339*    ELSE
 15340         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15341*    END-IF.
 15342
 15343 7099-EXIT.
 15344     EXIT.
 15345
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 293
* EL130.cbl
 15347 7100-READ-BENEFIT.
 15348
 15349
 15350* EXEC CICS HANDLE CONDITION
 15351*         NOTFND   (7120-NOT-FOUND)
 15352*    END-EXEC.
 15353*    MOVE '"$I                   ! F #00013898' TO DFHEIV0
 15354     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15355     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15356     MOVE X'4620233030303133383938' TO DFHEIV0(25:11)
 15357     CALL 'kxdfhei1' USING DFHEIV0
 15358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15359
 15360
 15361     MOVE SPACES                 TO ELCNTL-KEY.
 15362     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 15363     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 15364     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15365     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15366
 15367 7105-READ-FILE.
 15368     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 15369
 15370     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 15371        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 15372          GO TO 7120-NOT-FOUND
 15373     END-IF.
 15374
 15375     MOVE 1                      TO SUB.
 15376 7110-LOOP.
 15377     IF SUB = 9
 15378         GO TO 7120-NOT-FOUND
 15379     END-IF.
 15380
 15381     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 15382         ADD 1                   TO SUB
 15383         GO TO 7110-LOOP
 15384     END-IF.
 15385
 15386     if ws-rec-type = '4'
 15387        move cf-joint-indicator (sub)
 15388                                 to ws-lf-joint-indicator
 15389     else
 15390        move cf-joint-indicator (sub)
 15391                                 to ws-ah-joint-indicator
 15392     end-if
 15393     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 15394     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 15395     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 15396
 15397     GO TO 7199-EXIT.
 15398
 15399 7120-NOT-FOUND.
 15400     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 15401                                    WS-FORM-HOLD.
 15402
 15403 7199-EXIT.
 15404      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 294
* EL130.cbl
 15405
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 295
* EL130.cbl
 15407 7200-PROTECT-CERT-FIELDS.
 15408     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15409                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15410                                LCVFORMA ACVFORMA JNTLNMEA
 15411                                JNTFNMEA JNTINITA.
 15412
 15413     IF CM-LF-CURRENT-STATUS = '2' OR
 15414        CM-AH-CURRENT-STATUS = '2'
 15415         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 15416     END-IF.
 15417
 15418     MOVE AL-SANOF TO
 15419            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 15420            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 15421            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 15422            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 15423            LCVRATEA   ACVRATEA.
 15424
 15425     MOVE 'S'                    TO CERTMTI.
 15426
 15427 7300-RESET-KEY-ATTRBS.
 15428     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15429                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15430                                LCVFORMA ACVFORMA JNTLNMEA
 15431                                JNTFNMEA JNTINITA.
 15432
 15433     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15434         MOVE AL-SANOF           TO REINCDA
 15435     END-IF.
 15436
 15437     MOVE 'S'                    TO CERTMTI.
 15438
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 296
* EL130.cbl
 15440 7400-READ-STATE.
 15441
 15442
 15443* EXEC CICS HANDLE CONDITION
 15444*         NOTFND   (7499-EXIT)
 15445*    END-EXEC.
 15446*    MOVE '"$I                   ! G #00013983' TO DFHEIV0
 15447     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15449     MOVE X'4720233030303133393833' TO DFHEIV0(25:11)
 15450     CALL 'kxdfhei1' USING DFHEIV0
 15451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15452
 15453
 15454     MOVE SPACES                 TO ELCNTL-KEY.
 15455     MOVE CM-STATE               TO CNTL-ACCESS.
 15456     MOVE '3'                    TO CNTL-REC-TYPE.
 15457     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15458     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15459
 15460     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15461
 15462     MOVE 1                      TO SUB.
 15463
 15464 7410-LOOP.
 15465     IF SUB = 21
 15466        GO TO 7499-EXIT
 15467     END-IF.
 15468
 15469*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15470*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15471*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15472*        GO TO 7499-EXIT.
 15473
 15474     ADD 1                       TO SUB.
 15475     GO TO 7410-LOOP.
 15476
 15477 7499-EXIT.
 15478      EXIT.
 15479
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 297
* EL130.cbl
 15481 7500-BROWSE-FOR-DUPLICATE.
 15482
 15483     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15484
 15485
 15486
 15487* EXEC CICS HANDLE CONDITION
 15488*        NOTFND   (7500-EXIT)
 15489*        DUPKEY   (7500-DUPLICATE-KEY)
 15490*        ENDFILE  (7500-EXIT)
 15491*    END-EXEC.
 15492*    MOVE '"$I$''                 ! H #00014019' TO DFHEIV0
 15493     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15494     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15495     MOVE X'4820233030303134303139' TO DFHEIV0(25:11)
 15496     CALL 'kxdfhei1' USING DFHEIV0
 15497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15498
 15499
 15500
 15501
 15502* EXEC CICS STARTBR
 15503*        DATASET    (ELMSTR5-DSID)
 15504*        RIDFLD     (ELMSTR5-KEY)
 15505*    END-EXEC.
 15506     MOVE 0
 15507       TO DFHEIV11
 15508*    MOVE '&,         G          &   #00014026' TO DFHEIV0
 15509     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15510     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15511     MOVE X'2020233030303134303236' TO DFHEIV0(25:11)
 15512     CALL 'kxdfhei1' USING DFHEIV0,
 15513           ELMSTR5-DSID,
 15514           ELMSTR5-KEY,
 15515           DFHEIV99,
 15516           DFHEIV11,
 15517           DFHEIV99
 15518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15519
 15520
 15521
 15522
 15523* EXEC CICS HANDLE CONDITION
 15524*        ENDFILE  (7500-END-BROWSE)
 15525*    END-EXEC.
 15526*    MOVE '"$''                   ! I #00014032' TO DFHEIV0
 15527     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15528     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15529     MOVE X'4920233030303134303332' TO DFHEIV0(25:11)
 15530     CALL 'kxdfhei1' USING DFHEIV0
 15531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15532
 15533
 15534 7500-READ-CLAIM-LOOP.
 15535
 15536
 15537
 15538* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 298
* EL130.cbl
 15539*        DATASET   (ELMSTR5-DSID)
 15540*        SET       (ADDRESS OF CLAIM-MASTER)
 15541*        RIDFLD    (ELMSTR5-KEY)
 15542*    END-EXEC.
 15543     MOVE 0
 15544       TO DFHEIV11
 15545*    MOVE '&.S                   )   #00014039' TO DFHEIV0
 15546     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15547     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15548     MOVE X'2020233030303134303339' TO DFHEIV0(25:11)
 15549     CALL 'kxdfhei1' USING DFHEIV0,
 15550           ELMSTR5-DSID,
 15551           DFHEIV20,
 15552           DFHEIV99,
 15553           ELMSTR5-KEY,
 15554           DFHEIV99,
 15555           DFHEIV11,
 15556           DFHEIV99,
 15557           DFHEIV99
 15558     SET ADDRESS OF CLAIM-MASTER TO
 15559         DFHEIV20
 15560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15561
 15562
 15563 7500-DUPLICATE-KEY.
 15564
 15565     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15566        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15567        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15568        CL-CERT-STATE     NOT = CM-STATE       OR
 15569        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15570        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15571        CL-CERT-NO        NOT = CM-CERT-NO
 15572           GO TO 7500-CHECK-MATCH-COUNT
 15573     END-IF.
 15574
 15575     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15576
 15577     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15578        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15579        GO TO 7500-END-BROWSE
 15580     ELSE
 15581        GO TO 7500-READ-CLAIM-LOOP
 15582     END-IF.
 15583
 15584 7500-CHECK-MATCH-COUNT.
 15585
 15586     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15587        CL-CERT-NO    = CM-CERT-NO
 15588          GO TO 7500-READ-CLAIM-LOOP
 15589     END-IF.
 15590
 15591 7500-END-BROWSE.
 15592
 15593
 15594
 15595* EXEC CICS ENDBR
 15596*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 299
* EL130.cbl
 15597*    END-EXEC.
 15598     MOVE 0
 15599       TO DFHEIV11
 15600*    MOVE '&2                    $   #00014076' TO DFHEIV0
 15601     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15602     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15603     MOVE X'2020233030303134303736' TO DFHEIV0(25:11)
 15604     CALL 'kxdfhei1' USING DFHEIV0,
 15605           ELMSTR5-DSID,
 15606           DFHEIV11,
 15607           DFHEIV99
 15608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15609
 15610
 15611 7500-EXIT.
 15612     EXIT.
 15613
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 300
* EL130.cbl
 15615 7550-FALL-THRU-PARA.
 15616
 15617
 15618
 15619* EXEC CICS DUMP
 15620*         DUMPCODE ('E130')
 15621*         TASK
 15622*    END-EXEC.
 15623     MOVE 'E130' TO DFHEIV5
 15624*    MOVE '<"   T                $   #00014087' TO DFHEIV0
 15625     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15626     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15627     MOVE X'2020233030303134303837' TO DFHEIV0(25:11)
 15628     CALL 'kxdfhei1' USING DFHEIV0,
 15629           DFHEIV5,
 15630           DFHEIV99,
 15631           DFHEIV99
 15632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15633
 15634
 15635
 15636
 15637* EXEC CICS RETURN
 15638*    END-EXEC.
 15639*    MOVE '.(                    ''   #00014093' TO DFHEIV0
 15640     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15641     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15642     MOVE X'2020233030303134303933' TO DFHEIV0(25:11)
 15643     CALL 'kxdfhei1' USING DFHEIV0,
 15644           DFHEIV99,
 15645           DFHEIV99,
 15646           DFHEIV99,
 15647           DFHEIV99,
 15648           DFHEIV99,
 15649           DFHEIV99
 15650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15651
 15652
 15653 7600-BROWSE-CLAIM.
 15654
 15655
 15656
 15657* EXEC CICS READ
 15658*        DATASET(ELMSTR-DSID)
 15659*        SET    (ADDRESS OF CLAIM-MASTER)
 15660*        RIDFLD (ELMSTR-KEY)
 15661*        GENERIC
 15662*        EQUAL
 15663*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15664*    END-EXEC.
 15665*    MOVE '&"S  KG    E          (   #00014099' TO DFHEIV0
 15666     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15667     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15668     MOVE X'2020233030303134303939' TO DFHEIV0(25:11)
 15669     CALL 'kxdfhei1' USING DFHEIV0,
 15670           ELMSTR-DSID,
 15671           DFHEIV20,
 15672           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 301
* EL130.cbl
 15673           ELMSTR-KEY,
 15674           ELMSTR-GENERIC-LENGTH,
 15675           DFHEIV99,
 15676           DFHEIV99
 15677     SET ADDRESS OF CLAIM-MASTER TO
 15678         DFHEIV20
 15679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15680
 15681
 15682     MOVE CL-CERT-PRIME          TO CERTNOI.
 15683     MOVE CL-CERT-SFX            TO SUFXI.
 15684
 15685 7610-BROWSE-CLAIM-LOOP.
 15686
 15687     MOVE LOW-VALUES             TO BCERT1O
 15688                                    BSUFX1O
 15689                                    BCERT2O
 15690                                    BSUFX2O
 15691                                    BCERT3O
 15692                                    BSUFX3O
 15693                                    BCERT4O
 15694                                    BSUFX4O
 15695                                    BCERT5O
 15696                                    BSUFX5O.
 15697
 15698     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15699
 15700
 15701
 15702* EXEC CICS HANDLE CONDITION
 15703*        ENDFILE  (7630-END-BROWSE)
 15704*    END-EXEC.
 15705*    MOVE '"$''                   ! J #00014127' TO DFHEIV0
 15706     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15708     MOVE X'4A20233030303134313237' TO DFHEIV0(25:11)
 15709     CALL 'kxdfhei1' USING DFHEIV0
 15710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15711
 15712
 15713
 15714
 15715* EXEC CICS STARTBR
 15716*        DATASET    (ELMSTR-DSID)
 15717*        RIDFLD     (ELMSTR-KEY)
 15718*    END-EXEC.
 15719     MOVE 0
 15720       TO DFHEIV11
 15721*    MOVE '&,         G          &   #00014132' TO DFHEIV0
 15722     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15723     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15724     MOVE X'2020233030303134313332' TO DFHEIV0(25:11)
 15725     CALL 'kxdfhei1' USING DFHEIV0,
 15726           ELMSTR-DSID,
 15727           ELMSTR-KEY,
 15728           DFHEIV99,
 15729           DFHEIV11,
 15730           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 302
* EL130.cbl
 15731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15732
 15733
 15734     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15735
 15736 7620-READ-CLAIM-LOOP.
 15737
 15738
 15739
 15740* EXEC CICS READNEXT
 15741*        DATASET   (ELMSTR-DSID)
 15742*        SET       (ADDRESS OF CLAIM-MASTER)
 15743*        RIDFLD    (ELMSTR-KEY)
 15744*    END-EXEC.
 15745     MOVE 0
 15746       TO DFHEIV11
 15747*    MOVE '&.S                   )   #00014142' TO DFHEIV0
 15748     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15749     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15750     MOVE X'2020233030303134313432' TO DFHEIV0(25:11)
 15751     CALL 'kxdfhei1' USING DFHEIV0,
 15752           ELMSTR-DSID,
 15753           DFHEIV20,
 15754           DFHEIV99,
 15755           ELMSTR-KEY,
 15756           DFHEIV99,
 15757           DFHEIV11,
 15758           DFHEIV99,
 15759           DFHEIV99
 15760     SET ADDRESS OF CLAIM-MASTER TO
 15761         DFHEIV20
 15762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15763
 15764
 15765     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15766        CL-CARRIER     NOT = CLMCARRI       OR
 15767        CL-CLAIM-NO    NOT = CLMNOI
 15768          GO TO 7630-END-BROWSE
 15769     END-IF.
 15770
 15771     IF WS-ASSOCIATED-CERTS = 1
 15772         MOVE CL-CERT-PRIME      TO BCERT1O
 15773         MOVE CL-CERT-SFX        TO BSUFX1O
 15774     END-IF.
 15775
 15776     IF WS-ASSOCIATED-CERTS = 2
 15777         MOVE CL-CERT-PRIME      TO BCERT2O
 15778         MOVE CL-CERT-SFX        TO BSUFX2O
 15779     END-IF.
 15780
 15781     IF WS-ASSOCIATED-CERTS = 3
 15782         MOVE CL-CERT-PRIME      TO BCERT3O
 15783         MOVE CL-CERT-SFX        TO BSUFX3O
 15784     END-IF.
 15785
 15786     IF WS-ASSOCIATED-CERTS = 4
 15787         MOVE CL-CERT-PRIME      TO BCERT4O
 15788         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 303
* EL130.cbl
 15789     END-IF.
 15790
 15791     IF WS-ASSOCIATED-CERTS = 5
 15792         MOVE CL-CERT-PRIME      TO BCERT5O
 15793         MOVE CL-CERT-SFX        TO BSUFX5O
 15794     ELSE
 15795         ADD +1                  TO WS-ASSOCIATED-CERTS
 15796         GO TO 7620-READ-CLAIM-LOOP
 15797     END-IF.
 15798
 15799 7630-END-BROWSE.
 15800
 15801
 15802
 15803* EXEC CICS ENDBR
 15804*        DATASET   (ELMSTR-DSID)
 15805*    END-EXEC.
 15806     MOVE 0
 15807       TO DFHEIV11
 15808*    MOVE '&2                    $   #00014185' TO DFHEIV0
 15809     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15810     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15811     MOVE X'2020233030303134313835' TO DFHEIV0(25:11)
 15812     CALL 'kxdfhei1' USING DFHEIV0,
 15813           ELMSTR-DSID,
 15814           DFHEIV11,
 15815           DFHEIV99
 15816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15817
 15818
 15819 7640-HIGHLIGHT-CERT-DISPLAYED.
 15820
 15821     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15822     MOVE AL-SANON               TO BCERT1A
 15823                                    BSUFX1A
 15824                                    BCERT2A
 15825                                    BSUFX2A
 15826                                    BCERT3A
 15827                                    BSUFX3A
 15828                                    BCERT4A
 15829                                    BSUFX4A
 15830                                    BCERT5A
 15831                                    BSUFX5A.
 15832
 15833     IF BCERT1O = CERTNOI AND
 15834        BSUFX1O = SUFXI
 15835            MOVE AL-SABON        TO BCERT1A
 15836                                    BSUFX1A
 15837     END-IF.
 15838
 15839     IF BCERT2O = CERTNOI AND
 15840        BSUFX2O = SUFXI
 15841            MOVE AL-SABON        TO BCERT2A
 15842                                    BSUFX2A
 15843     END-IF.
 15844
 15845     IF BCERT3O = CERTNOI AND
 15846        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 304
* EL130.cbl
 15847            MOVE AL-SABON        TO BCERT3A
 15848                                    BSUFX3A
 15849     END-IF.
 15850
 15851     IF BCERT4O = CERTNOI AND
 15852        BSUFX4O = SUFXI
 15853            MOVE AL-SABON        TO BCERT4A
 15854                                    BSUFX4A
 15855     END-IF.
 15856
 15857     IF BCERT5O = CERTNOI AND
 15858        BSUFX5O = SUFXI
 15859            MOVE AL-SABON        TO BCERT5A
 15860                                    BSUFX5A
 15861     END-IF.
 15862
 15863 7699-EXIT.
 15864     EXIT.
 15865
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 305
* EL130.cbl
 15867 7700-CHECK-SEQUENCE.
 15868
 15869
 15870
 15871* EXEC CICS HANDLE CONDITION
 15872*        ENDFILE  (7799-EXIT)
 15873*        NOTFND   (7799-EXIT)
 15874*    END-EXEC.
 15875*    MOVE '"$''I                  ! K #00014240' TO DFHEIV0
 15876     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15878     MOVE X'4B20233030303134323430' TO DFHEIV0(25:11)
 15879     CALL 'kxdfhei1' USING DFHEIV0
 15880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15881
 15882
 15883
 15884
 15885* EXEC CICS READ
 15886*        DATASET(ELMSTR-DSID)
 15887*        SET    (ADDRESS OF CLAIM-MASTER)
 15888*        RIDFLD (ELMSTR-KEY)
 15889*        GENERIC
 15890*        EQUAL
 15891*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15892*    END-EXEC.
 15893*    MOVE '&"S  KG    E          (   #00014246' TO DFHEIV0
 15894     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15895     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15896     MOVE X'2020233030303134323436' TO DFHEIV0(25:11)
 15897     CALL 'kxdfhei1' USING DFHEIV0,
 15898           ELMSTR-DSID,
 15899           DFHEIV20,
 15900           DFHEIV99,
 15901           ELMSTR-KEY,
 15902           ELMSTR-GENERIC-LENGTH,
 15903           DFHEIV99,
 15904           DFHEIV99
 15905     SET ADDRESS OF CLAIM-MASTER TO
 15906         DFHEIV20
 15907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15908
 15909
 15910     COMPUTE WS-ASSOC-CERT-TOTAL =
 15911             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15912
 15913     GO TO 7799-EXIT.
 15914
 15915 7710-RESEQUENCE-CLAIMS.
 15916
 15917
 15918
 15919* EXEC CICS HANDLE CONDITION
 15920*        ENDFILE  (7790-END-BROWSE)
 15921*    END-EXEC.
 15922*    MOVE '"$''                   ! L #00014263' TO DFHEIV0
 15923     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15924     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 306
* EL130.cbl
 15925     MOVE X'4C20233030303134323633' TO DFHEIV0(25:11)
 15926     CALL 'kxdfhei1' USING DFHEIV0
 15927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15928
 15929
 15930
 15931
 15932* EXEC CICS STARTBR
 15933*        DATASET    (ELMSTR-DSID)
 15934*        RIDFLD     (ELMSTR-KEY)
 15935*    END-EXEC.
 15936     MOVE 0
 15937       TO DFHEIV11
 15938*    MOVE '&,         G          &   #00014268' TO DFHEIV0
 15939     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15940     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15941     MOVE X'2020233030303134323638' TO DFHEIV0(25:11)
 15942     CALL 'kxdfhei1' USING DFHEIV0,
 15943           ELMSTR-DSID,
 15944           ELMSTR-KEY,
 15945           DFHEIV99,
 15946           DFHEIV11,
 15947           DFHEIV99
 15948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15949
 15950
 15951     ADD +1 TO WS-ASSOC-CERT-SEQU
 15952               WS-READNEXT-SWITCH.
 15953
 15954 7720-READ-CLAIM-LOOP.
 15955
 15956
 15957
 15958* EXEC CICS READNEXT
 15959*        DATASET   (ELMSTR-DSID)
 15960*        SET       (ADDRESS OF CLAIM-MASTER)
 15961*        RIDFLD    (ELMSTR-KEY)
 15962*    END-EXEC.
 15963     MOVE 0
 15964       TO DFHEIV11
 15965*    MOVE '&.S                   )   #00014279' TO DFHEIV0
 15966     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15967     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15968     MOVE X'2020233030303134323739' TO DFHEIV0(25:11)
 15969     CALL 'kxdfhei1' USING DFHEIV0,
 15970           ELMSTR-DSID,
 15971           DFHEIV20,
 15972           DFHEIV99,
 15973           ELMSTR-KEY,
 15974           DFHEIV99,
 15975           DFHEIV11,
 15976           DFHEIV99,
 15977           DFHEIV99
 15978     SET ADDRESS OF CLAIM-MASTER TO
 15979         DFHEIV20
 15980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15981
 15982
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 307
* EL130.cbl
 15983     IF WS-READNEXT-SWITCH = 1
 15984         ADD 1 TO WS-READNEXT-SWITCH
 15985         GO TO 7720-READ-CLAIM-LOOP
 15986     END-IF.
 15987
 15988 7730-END-BROWSE.
 15989
 15990
 15991
 15992* EXEC CICS ENDBR
 15993*        DATASET   (ELMSTR-DSID)
 15994*    END-EXEC.
 15995     MOVE 0
 15996       TO DFHEIV11
 15997*    MOVE '&2                    $   #00014293' TO DFHEIV0
 15998     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15999     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16000     MOVE X'2020233030303134323933' TO DFHEIV0(25:11)
 16001     CALL 'kxdfhei1' USING DFHEIV0,
 16002           ELMSTR-DSID,
 16003           DFHEIV11,
 16004           DFHEIV99
 16005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16006
 16007
 16008 7740-READ-CLAIM-UPDATE.
 16009
 16010     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 16011        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 16012        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 16013          GO TO 7799-EXIT
 16014     ELSE
 16015          MOVE ZERO              TO WS-READNEXT-SWITCH
 16016     END-IF.
 16017
 16018
 16019
 16020* EXEC CICS READ
 16021*        DATASET(ELMSTR-DSID)
 16022*        SET    (ADDRESS OF CLAIM-MASTER)
 16023*        RIDFLD (ELMSTR-KEY)
 16024*        UPDATE
 16025*    END-EXEC.
 16026*    MOVE '&"S        EU         (   #00014308' TO DFHEIV0
 16027     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16028     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16029     MOVE X'2020233030303134333038' TO DFHEIV0(25:11)
 16030     CALL 'kxdfhei1' USING DFHEIV0,
 16031           ELMSTR-DSID,
 16032           DFHEIV20,
 16033           DFHEIV99,
 16034           ELMSTR-KEY,
 16035           DFHEIV99,
 16036           DFHEIV99,
 16037           DFHEIV99
 16038     SET ADDRESS OF CLAIM-MASTER TO
 16039         DFHEIV20
 16040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 308
* EL130.cbl
 16041
 16042
 16043     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16044     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16045
 16046
 16047
 16048* EXEC CICS REWRITE
 16049*         DATASET     (ELMSTR-DSID)
 16050*         FROM        (CLAIM-MASTER)
 16051*    END-EXEC.
 16052     MOVE LENGTH OF
 16053      CLAIM-MASTER
 16054       TO DFHEIV11
 16055*    MOVE '&& L                  %   #00014319' TO DFHEIV0
 16056     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16057     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16058     MOVE X'2020233030303134333139' TO DFHEIV0(25:11)
 16059     CALL 'kxdfhei1' USING DFHEIV0,
 16060           ELMSTR-DSID,
 16061           CLAIM-MASTER,
 16062           DFHEIV11,
 16063           DFHEIV99
 16064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16065
 16066
 16067     GO TO 7710-RESEQUENCE-CLAIMS.
 16068
 16069 7790-END-BROWSE.
 16070
 16071
 16072
 16073* EXEC CICS ENDBR
 16074*        DATASET   (ELMSTR-DSID)
 16075*    END-EXEC.
 16076     MOVE 0
 16077       TO DFHEIV11
 16078*    MOVE '&2                    $   #00014329' TO DFHEIV0
 16079     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16080     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16081     MOVE X'2020233030303134333239' TO DFHEIV0(25:11)
 16082     CALL 'kxdfhei1' USING DFHEIV0,
 16083           ELMSTR-DSID,
 16084           DFHEIV11,
 16085           DFHEIV99
 16086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16087
 16088
 16089 7799-EXIT.
 16090     EXIT.
 16091
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 309
* EL130.cbl
 16093************************************************
 16094*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 16095************************************************
 16096
 16097 7900-READ-ACTV-UPDATE.
 16098     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16099     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16100     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16101     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16102     MOVE +0                     TO TRLR-SEQ-NO.
 16103     MOVE '1'                    TO TRLR-TYPE.
 16104     GO TO 7900-READ-TRAILER-UPDATE.
 16105
 16106 7900-READ-NINETY-UPDATE.
 16107     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16108     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16109     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16110     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16111     MOVE +90                    TO TRLR-SEQ-NO.
 16112     MOVE '6'                    TO TRLR-TYPE.
 16113
 16114 7900-READ-TRAILER-UPDATE.
 16115
 16116
 16117* EXEC CICS READ  UPDATE
 16118*        DATASET    (ELTRLR-DSID)
 16119*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 16120*        RIDFLD     (ELTRLR-KEY)
 16121*    END-EXEC.
 16122*    MOVE '&"S        EU         (   #00014360' TO DFHEIV0
 16123     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16124     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16125     MOVE X'2020233030303134333630' TO DFHEIV0(25:11)
 16126     CALL 'kxdfhei1' USING DFHEIV0,
 16127           ELTRLR-DSID,
 16128           DFHEIV20,
 16129           DFHEIV99,
 16130           ELTRLR-KEY,
 16131           DFHEIV99,
 16132           DFHEIV99,
 16133           DFHEIV99
 16134     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16135         DFHEIV20
 16136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16137
 16138
 16139 7900-EXIT.
 16140      EXIT.
 16141
 16142 7910-READ-ACTV.
 16143     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16144     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16145     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16146     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16147     MOVE +0                     TO TRLR-SEQ-NO.
 16148     MOVE '1'                    TO TRLR-TYPE.
 16149     GO TO 7910-READ-TRAILER.
 16150
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 310
* EL130.cbl
 16151 7910-READ-NINETY.
 16152     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16153     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16154     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16155     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16156     MOVE +90                    TO TRLR-SEQ-NO.
 16157     MOVE '6'                    TO TRLR-TYPE.
 16158
 16159 7910-READ-TRAILER.
 16160     MOVE 'TRLR'                 TO FILE-SWITCH.
 16161
 16162
 16163
 16164* EXEC CICS READ
 16165*        DATASET   (ELTRLR-DSID)
 16166*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16167*        RIDFLD    (ELTRLR-KEY)
 16168*    END-EXEC.
 16169*    MOVE '&"S        E          (   #00014390' TO DFHEIV0
 16170     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16172     MOVE X'2020233030303134333930' TO DFHEIV0(25:11)
 16173     CALL 'kxdfhei1' USING DFHEIV0,
 16174           ELTRLR-DSID,
 16175           DFHEIV20,
 16176           DFHEIV99,
 16177           ELTRLR-KEY,
 16178           DFHEIV99,
 16179           DFHEIV99,
 16180           DFHEIV99
 16181     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16182         DFHEIV20
 16183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16184
 16185
 16186 7910-EXIT.
 16187      EXIT.
 16188
 16189 7915-REWRITE-TRAILER.
 16190
 16191
 16192* EXEC CICS REWRITE
 16193*        DATASET   (ELTRLR-DSID)
 16194*        FROM      (ACTIVITY-TRAILERS)
 16195*    END-EXEC.
 16196     MOVE LENGTH OF
 16197      ACTIVITY-TRAILERS
 16198       TO DFHEIV11
 16199*    MOVE '&& L                  %   #00014401' TO DFHEIV0
 16200     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16201     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16202     MOVE X'2020233030303134343031' TO DFHEIV0(25:11)
 16203     CALL 'kxdfhei1' USING DFHEIV0,
 16204           ELTRLR-DSID,
 16205           ACTIVITY-TRAILERS,
 16206           DFHEIV11,
 16207           DFHEIV99
 16208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 311
* EL130.cbl
 16209
 16210
 16211 7915-EXIT.
 16212      EXIT.
 16213
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 312
* EL130.cbl
 16215********************************************
 16216*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 16217********************************************
 16218
 16219 7920-READ-CLAIM-UPDATE.
 16220
 16221
 16222
 16223* EXEC CICS READ
 16224*        UPDATE
 16225*        DATASET   (ELMSTR-DSID)
 16226*        SET       (ADDRESS OF CLAIM-MASTER)
 16227*        RIDFLD    (ELMSTR-KEY)
 16228*    END-EXEC.
 16229*    MOVE '&"S        EU         (   #00014417' TO DFHEIV0
 16230     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16231     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16232     MOVE X'2020233030303134343137' TO DFHEIV0(25:11)
 16233     CALL 'kxdfhei1' USING DFHEIV0,
 16234           ELMSTR-DSID,
 16235           DFHEIV20,
 16236           DFHEIV99,
 16237           ELMSTR-KEY,
 16238           DFHEIV99,
 16239           DFHEIV99,
 16240           DFHEIV99
 16241     SET ADDRESS OF CLAIM-MASTER TO
 16242         DFHEIV20
 16243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16244
 16245
 16246 7920-EXIT.
 16247      EXIT.
 16248
 16249 7950-READ-CLAIM.
 16250
 16251
 16252* EXEC CICS READ
 16253*        DATASET   (ELMSTR-DSID)
 16254*        SET       (ADDRESS OF CLAIM-MASTER)
 16255*        RIDFLD    (ELMSTR-KEY)
 16256*    END-EXEC.
 16257*    MOVE '&"S        E          (   #00014429' TO DFHEIV0
 16258     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16259     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16260     MOVE X'2020233030303134343239' TO DFHEIV0(25:11)
 16261     CALL 'kxdfhei1' USING DFHEIV0,
 16262           ELMSTR-DSID,
 16263           DFHEIV20,
 16264           DFHEIV99,
 16265           ELMSTR-KEY,
 16266           DFHEIV99,
 16267           DFHEIV99,
 16268           DFHEIV99
 16269     SET ADDRESS OF CLAIM-MASTER TO
 16270         DFHEIV20
 16271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16272
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 313
* EL130.cbl
 16273
 16274 7950-EXIT.
 16275      EXIT.
 16276
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 314
* EL130.cbl
 16278***************************************
 16279*  I/O REQUESTS AGAINST CONTROL FILE  *
 16280***************************************
 16281
 16282 7960-READ-CNTL-UPDATE.
 16283
 16284
 16285* EXEC CICS READ
 16286*        UPDATE
 16287*        DATASET  (ELCNTL-DSID)
 16288*        SET      (ADDRESS OF CONTROL-FILE)
 16289*        RIDFLD   (ELCNTL-KEY)
 16290*    END-EXEC.
 16291*    MOVE '&"S        EU         (   #00014445' TO DFHEIV0
 16292     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16293     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16294     MOVE X'2020233030303134343435' TO DFHEIV0(25:11)
 16295     CALL 'kxdfhei1' USING DFHEIV0,
 16296           ELCNTL-DSID,
 16297           DFHEIV20,
 16298           DFHEIV99,
 16299           ELCNTL-KEY,
 16300           DFHEIV99,
 16301           DFHEIV99,
 16302           DFHEIV99
 16303     SET ADDRESS OF CONTROL-FILE TO
 16304         DFHEIV20
 16305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16306
 16307
 16308 7960-EXIT.
 16309      EXIT.
 16310
 16311 7970-READ-CNTL.
 16312
 16313
 16314* EXEC CICS READ
 16315*        DATASET  (ELCNTL-DSID)
 16316*        SET      (ADDRESS OF CONTROL-FILE)
 16317*        RIDFLD   (ELCNTL-KEY)
 16318*    END-EXEC.
 16319*    MOVE '&"S        E          (   #00014457' TO DFHEIV0
 16320     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16321     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16322     MOVE X'2020233030303134343537' TO DFHEIV0(25:11)
 16323     CALL 'kxdfhei1' USING DFHEIV0,
 16324           ELCNTL-DSID,
 16325           DFHEIV20,
 16326           DFHEIV99,
 16327           ELCNTL-KEY,
 16328           DFHEIV99,
 16329           DFHEIV99,
 16330           DFHEIV99
 16331     SET ADDRESS OF CONTROL-FILE TO
 16332         DFHEIV20
 16333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16334
 16335
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 315
* EL130.cbl
 16336 7970-EXIT.
 16337      EXIT.
 16338
 16339 7975-READ-CNTL-GTEQ.
 16340
 16341
 16342* EXEC CICS READ
 16343*         DATASET   (ELCNTL-DSID)
 16344*         SET       (ADDRESS OF CONTROL-FILE)
 16345*         RIDFLD    (ELCNTL-KEY)
 16346*         GTEQ
 16347*     END-EXEC.
 16348*    MOVE '&"S        G          (   #00014468' TO DFHEIV0
 16349     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16350     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16351     MOVE X'2020233030303134343638' TO DFHEIV0(25:11)
 16352     CALL 'kxdfhei1' USING DFHEIV0,
 16353           ELCNTL-DSID,
 16354           DFHEIV20,
 16355           DFHEIV99,
 16356           ELCNTL-KEY,
 16357           DFHEIV99,
 16358           DFHEIV99,
 16359           DFHEIV99
 16360     SET ADDRESS OF CONTROL-FILE TO
 16361         DFHEIV20
 16362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16363
 16364
 16365 7975-EXIT.
 16366      EXIT.
 16367
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 316
* EL130.cbl
 16369**************************************************
 16370*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 16371**************************************************
 16372
 16373 7980-READ-CERT5.
 16374
 16375
 16376* EXEC CICS READ
 16377*         DATASET  (ELCERT5-DSID)
 16378*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 16379*         RIDFLD   (ELCERT-KEY-5)
 16380*     END-EXEC.
 16381*    MOVE '&"S        E          (   #00014485' TO DFHEIV0
 16382     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16383     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16384     MOVE X'2020233030303134343835' TO DFHEIV0(25:11)
 16385     CALL 'kxdfhei1' USING DFHEIV0,
 16386           ELCERT5-DSID,
 16387           DFHEIV20,
 16388           DFHEIV99,
 16389           ELCERT-KEY-5,
 16390           DFHEIV99,
 16391           DFHEIV99,
 16392           DFHEIV99
 16393     SET ADDRESS OF CERTIFICATE-MASTER TO
 16394         DFHEIV20
 16395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16396
 16397
 16398 7980-EXIT.
 16399      EXIT.
 16400
 16401 7930-READ-CERT-UPDATE.
 16402
 16403
 16404* EXEC CICS READ
 16405*        DATASET  (ELCERT-DSID)
 16406*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16407*        RIDFLD   (ELCERT-KEY)
 16408*        UPDATE
 16409*    END-EXEC.
 16410*    MOVE '&"S        EU         (   #00014496' TO DFHEIV0
 16411     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16412     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16413     MOVE X'2020233030303134343936' TO DFHEIV0(25:11)
 16414     CALL 'kxdfhei1' USING DFHEIV0,
 16415           ELCERT-DSID,
 16416           DFHEIV20,
 16417           DFHEIV99,
 16418           ELCERT-KEY,
 16419           DFHEIV99,
 16420           DFHEIV99,
 16421           DFHEIV99
 16422     SET ADDRESS OF CERTIFICATE-MASTER TO
 16423         DFHEIV20
 16424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16425
 16426
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 317
* EL130.cbl
 16427 7930-EXIT.
 16428      EXIT.
 16429
 16430 7940-READ-CERT.
 16431
 16432
 16433* EXEC CICS READ
 16434*        DATASET  (ELCERT-DSID)
 16435*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16436*        RIDFLD   (ELCERT-KEY)
 16437*    END-EXEC.
 16438*    MOVE '&"S        E          (   #00014508' TO DFHEIV0
 16439     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16440     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16441     MOVE X'2020233030303134353038' TO DFHEIV0(25:11)
 16442     CALL 'kxdfhei1' USING DFHEIV0,
 16443           ELCERT-DSID,
 16444           DFHEIV20,
 16445           DFHEIV99,
 16446           ELCERT-KEY,
 16447           DFHEIV99,
 16448           DFHEIV99,
 16449           DFHEIV99
 16450     SET ADDRESS OF CERTIFICATE-MASTER TO
 16451         DFHEIV20
 16452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16453
 16454
 16455 7940-EXIT.
 16456      EXIT.
 16457
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 318
* EL130.cbl
 16459**************************************************
 16460*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16461**************************************************
 16462
 16463 7991-READ-BENE.
 16464
 16465
 16466* EXEC CICS READ
 16467*         DATASET   (ELBENE-DSID)
 16468*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16469*         RIDFLD    (ELBENE-KEY)
 16470*     END-EXEC.
 16471*    MOVE '&"S        E          (   #00014524' TO DFHEIV0
 16472     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16473     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16474     MOVE X'2020233030303134353234' TO DFHEIV0(25:11)
 16475     CALL 'kxdfhei1' USING DFHEIV0,
 16476           ELBENE-DSID,
 16477           DFHEIV20,
 16478           DFHEIV99,
 16479           ELBENE-KEY,
 16480           DFHEIV99,
 16481           DFHEIV99,
 16482           DFHEIV99
 16483     SET ADDRESS OF BENEFICIARY-MASTER TO
 16484         DFHEIV20
 16485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16486
 16487
 16488 7991-EXIT.
 16489      EXIT.
 16490
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 319
* EL130.cbl
 16492**************************************************
 16493*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16494**************************************************
 16495
 16496 7992-READ-REIN.
 16497
 16498
 16499
 16500* EXEC CICS HANDLE CONDITION
 16501*        NOTFND   (7992-NOT-FOUND)
 16502*    END-EXEC.
 16503*    MOVE '"$I                   ! M #00014541' TO DFHEIV0
 16504     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16505     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16506     MOVE X'4D20233030303134353431' TO DFHEIV0(25:11)
 16507     CALL 'kxdfhei1' USING DFHEIV0
 16508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16509
 16510
 16511
 16512
 16513* EXEC CICS READ
 16514*        DATASET   (ERREIN-DSID)
 16515*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16516*        RIDFLD    (ERREIN-KEY)
 16517*    END-EXEC.
 16518*    MOVE '&"S        E          (   #00014546' TO DFHEIV0
 16519     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16520     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16521     MOVE X'2020233030303134353436' TO DFHEIV0(25:11)
 16522     CALL 'kxdfhei1' USING DFHEIV0,
 16523           ERREIN-DSID,
 16524           DFHEIV20,
 16525           DFHEIV99,
 16526           ERREIN-KEY,
 16527           DFHEIV99,
 16528           DFHEIV99,
 16529           DFHEIV99
 16530     SET ADDRESS OF REINSURANCE-RECORD TO
 16531         DFHEIV20
 16532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16533
 16534
 16535     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16536
 16537     GO TO 7992-EXIT.
 16538
 16539 7992-NOT-FOUND.
 16540     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16541
 16542 7992-EXIT.
 16543     EXIT.
 16544
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 320
* EL130.cbl
 16546 8000-LOAD-ERROR-MESSAGES.
 16547     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16548
 16549     IF EMI-NO-ERRORS
 16550         GO TO 8000-EXIT
 16551     END-IF.
 16552
 16553     perform varying e1 from +1 by +1 until e1 > +3
 16554        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16555                                or '1655' or '1660'
 16556           move 'W'              to emi-severity (e1)
 16557        end-if
 16558     end-perform
 16559     IF EMI-NUMBER-OF-LINES = 1
 16560         MOVE EMI-LINE1          TO ERRMSG1O
 16561         GO TO 8000-EXIT
 16562     END-IF.
 16563
 16564     IF EMI-NUMBER-OF-LINES = 2
 16565          MOVE EMI-LINE1         TO ERRMSG1O
 16566          MOVE EMI-LINE2         TO ERRMSG2O
 16567          GO TO 8000-EXIT
 16568     END-IF.
 16569
 16570     MOVE EMI-LINE1              TO ERRMSG1O.
 16571
 16572 8000-EXIT.
 16573     EXIT.
 16574
 16575 8100-SEND-INITIAL-MAP.
 16576     MOVE SAVE-DATE              TO RUNDTEO.
 16577     MOVE EIBTIME                TO TIME-IN.
 16578     MOVE TIME-OUT               TO RUNTIMEO.
 16579     IF EIBAID = DFHPF11
 16580        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16582     end-if
 16583     IF RETURNED-FROM = XCTL-114
 16584        CONTINUE
 16585     ELSE
 16586        MOVE -1                  TO MAINTL
 16587     END-IF.
 16588
 16589*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16590         MOVE SPACES             TO PRODO.
 16591         MOVE AL-SANOF           TO PRODCDA.
 16592*    END-IF.
 16593
 16594     MOVE PI-COMPANY-ID          TO COMPO.
 16595     MOVE AL-PABOF               TO COMPA.
 16596     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16597     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16598     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16599
 16600     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16601
 16602     IF NOT PI-NO-CARRIER-SECURITY
 16603        MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 321
* EL130.cbl
 16604        MOVE AL-SABOF            TO CLMCARRA
 16605     END-IF.
 16606
 16607     IF PI-PROCESSOR-ID = 'PEMA'
 16608        MOVE AL-UANON            TO CERTNOA
 16609                                    SUFXA
 16610     END-IF.
 16611*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16612*        NEXT SENTENCE
 16613*        CONTINUE
 16614*    ELSE
 16615         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16616*    END-IF.
 16617
 16618
 16619
 16620* EXEC CICS SEND
 16621*        MAP     (MAP-NAME)
 16622*        MAPSET  (MAPSET-NAME)
 16623*        FROM    (EL130AO)
 16624*        ERASE
 16625*        CURSOR
 16626*    END-EXEC.
 16627     MOVE LENGTH OF
 16628      EL130AO
 16629       TO DFHEIV12
 16630     MOVE -1
 16631       TO DFHEIV11
 16632*    MOVE '8$     CT  E    H L F ,   #00014636' TO DFHEIV0
 16633     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16634     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16635     MOVE X'2020233030303134363336' TO DFHEIV0(25:11)
 16636     CALL 'kxdfhei1' USING DFHEIV0,
 16637           MAP-NAME,
 16638           EL130AO,
 16639           DFHEIV12,
 16640           MAPSET-NAME,
 16641           DFHEIV99,
 16642           DFHEIV99,
 16643           DFHEIV99,
 16644           DFHEIV11,
 16645           DFHEIV99,
 16646           DFHEIV99,
 16647           DFHEIV99
 16648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16649
 16650
 16651     GO TO 9100-RETURN-TRAN.
 16652
 16653 8150-SEND-MAP-CURSOR.
 16654     MOVE SAVE-DATE              TO RUNDTEO.
 16655     MOVE EIBTIME                TO TIME-IN.
 16656     MOVE TIME-OUT               TO RUNTIMEO.
 16657     IF EIBAID = DFHPF11
 16658        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16659        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16660     end-if
 16661     MOVE PI-COMPANY-ID          TO COMPO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 322
* EL130.cbl
 16662     MOVE AL-PABOF               TO COMPA
 16663     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16664     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16665     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16666
 16667*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16668         MOVE SPACES             TO PRODO.
 16669         MOVE AL-SANOF           TO PRODCDA.
 16670*    END-IF.
 16671
 16672     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16673
 16674     IF NOT PI-NO-CARRIER-SECURITY
 16675         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16676         MOVE AL-SABOF            TO CLMCARRA
 16677     END-IF.
 16678
 16679     IF PI-PROCESSOR-ID = 'PEMA'
 16680        MOVE AL-UANON            TO CERTNOA
 16681                                    SUFXA
 16682     END-IF.
 16683*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16684*        NEXT SENTENCE
 16685*        CONTINUE
 16686*    ELSE
 16687         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16688*    END-IF.
 16689
 16690
 16691
 16692* EXEC CICS SEND
 16693*        MAP      (MAP-NAME)
 16694*        MAPSET   (MAPSET-NAME)
 16695*        FROM     (EL130AO)
 16696*        CURSOR   (PI-CURSOR)
 16697*        ERASE
 16698*    END-EXEC.
 16699     MOVE LENGTH OF
 16700      EL130AO
 16701       TO DFHEIV11
 16702*    MOVE '8$     CT  E    H L F ,   #00014684' TO DFHEIV0
 16703     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16704     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16705     MOVE X'2020233030303134363834' TO DFHEIV0(25:11)
 16706     CALL 'kxdfhei1' USING DFHEIV0,
 16707           MAP-NAME,
 16708           EL130AO,
 16709           DFHEIV11,
 16710           MAPSET-NAME,
 16711           DFHEIV99,
 16712           DFHEIV99,
 16713           DFHEIV99,
 16714           PI-CURSOR,
 16715           DFHEIV99,
 16716           DFHEIV99,
 16717           DFHEIV99
 16718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16719
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 323
* EL130.cbl
 16720
 16721     GO TO 9100-RETURN-TRAN.
 16722
 16723 8200-SEND-DATAONLY.
 16724     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16725
 16726     IF EIBAID = DFHPF11
 16727        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16728        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16729        go to 8100-send-initial-map
 16730     end-if
 16731*    IF EIBAID = DFHPF11
 16732*       MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16733*       move pi-last-claim       to emi-claim-no
 16734*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16735*       go to 8100-send-initial-map
 16736*    END-IF.
 16737     .
 16738 8200-BYPASS-ERROR.
 16739     MOVE SAVE-DATE              TO RUNDTEO.
 16740     MOVE EIBTIME                TO TIME-IN.
 16741     MOVE TIME-OUT               TO RUNTIMEO.
 16742     MOVE PI-COMPANY-ID          TO COMPO.
 16743     MOVE AL-PABOF               TO COMPA
 16744     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16745
 16746*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16747         MOVE SPACES             TO PRODO.
 16748         MOVE AL-SANOF           TO PRODCDA.
 16749*    END-IF.
 16750
 16751     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16752     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16753
 16754     IF PI-PROCESSOR-ID = 'PEMA'
 16755        MOVE AL-UANON            TO CERTNOA
 16756                                    SUFXA
 16757     END-IF.
 16758     IF NOT PI-NO-CARRIER-SECURITY
 16759        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16760        MOVE AL-SABOF            TO CLMCARRA
 16761     END-IF.
 16762
 16763*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16764*        NEXT SENTENCE
 16765*        CONTINUE
 16766*    ELSE
 16767         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16768*    END-IF.
 16769
 16770*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16771         MOVE AL-SANOF           TO PRODCDA.
 16772*    END-IF.
 16773
 16774
 16775
 16776* EXEC CICS SEND
 16777*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 324
* EL130.cbl
 16778*        MAPSET   (MAPSET-NAME)
 16779*        FROM     (EL130AO)
 16780*        DATAONLY
 16781*        CURSOR
 16782*    END-EXEC.
 16783     MOVE LENGTH OF
 16784      EL130AO
 16785       TO DFHEIV12
 16786     MOVE -1
 16787       TO DFHEIV11
 16788*    MOVE '8$D    CT       H L F ,   #00014746' TO DFHEIV0
 16789     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16790     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16791     MOVE X'2020233030303134373436' TO DFHEIV0(25:11)
 16792     CALL 'kxdfhei1' USING DFHEIV0,
 16793           MAP-NAME,
 16794           EL130AO,
 16795           DFHEIV12,
 16796           MAPSET-NAME,
 16797           DFHEIV99,
 16798           DFHEIV99,
 16799           DFHEIV99,
 16800           DFHEIV11,
 16801           DFHEIV99,
 16802           DFHEIV99,
 16803           DFHEIV99
 16804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16805
 16806
 16807     GO TO 9100-RETURN-TRAN.
 16808
 16809 8300-SEND-TEXT.
 16810
 16811
 16812* EXEC CICS SEND TEXT
 16813*        FROM     (LOGOFF-TEXT)
 16814*        LENGTH   (LOGOFF-LENGTH)
 16815*        ERASE
 16816*        FREEKB
 16817*    END-EXEC.
 16818*    MOVE '8&      T  E F  H   F -   #00014758' TO DFHEIV0
 16819     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16820     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16821     MOVE X'2020233030303134373538' TO DFHEIV0(25:11)
 16822     CALL 'kxdfhei1' USING DFHEIV0,
 16823           LOGOFF-TEXT,
 16824           LOGOFF-LENGTH,
 16825           DFHEIV99,
 16826           DFHEIV99,
 16827           DFHEIV99,
 16828           DFHEIV99,
 16829           DFHEIV99,
 16830           DFHEIV99,
 16831           DFHEIV99,
 16832           DFHEIV99,
 16833           DFHEIV99,
 16834           DFHEIV99
 16835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 325
* EL130.cbl
 16836
 16837
 16838
 16839
 16840* EXEC CICS RETURN
 16841*    END-EXEC.
 16842*    MOVE '.(                    ''   #00014766' TO DFHEIV0
 16843     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16844     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16845     MOVE X'2020233030303134373636' TO DFHEIV0(25:11)
 16846     CALL 'kxdfhei1' USING DFHEIV0,
 16847           DFHEIV99,
 16848           DFHEIV99,
 16849           DFHEIV99,
 16850           DFHEIV99,
 16851           DFHEIV99,
 16852           DFHEIV99
 16853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16854
 16855
 16856 8800-UNAUTHORIZED-ACCESS.
 16857     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16858     GO TO 8300-SEND-TEXT.
 16859
 16860 8810-PF23.
 16861     MOVE EIBAID TO PI-ENTRY-CD-1.
 16862     MOVE XCTL-005               TO PGM-NAME.
 16863     GO TO 9300-XCTL.
 16864
 16865 8820-TERM-ERROR.
 16866     MOVE ER-0412                TO EMI-ERROR.
 16867     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16868     MOVE -1                     TO MAINTL.
 16869     GO TO 8200-SEND-DATAONLY.
 16870
 16871 8830-TRAN-ERROR.
 16872     MOVE ER-0413                TO EMI-ERROR.
 16873     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16874     MOVE -1                     TO MAINTL.
 16875     GO TO 8200-SEND-DATAONLY.
 16876
 16877 9000-RETURN-CICS.
 16878
 16879
 16880* EXEC CICS RETURN
 16881*    END-EXEC.
 16882*    MOVE '.(                    ''   #00014792' TO DFHEIV0
 16883     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16884     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16885     MOVE X'2020233030303134373932' TO DFHEIV0(25:11)
 16886     CALL 'kxdfhei1' USING DFHEIV0,
 16887           DFHEIV99,
 16888           DFHEIV99,
 16889           DFHEIV99,
 16890           DFHEIV99,
 16891           DFHEIV99,
 16892           DFHEIV99
 16893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 326
* EL130.cbl
 16894
 16895
 16896 9100-RETURN-TRAN.
 16897     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16898     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16899
 16900
 16901
 16902* EXEC CICS RETURN
 16903*        TRANSID   (TRANS-ID)
 16904*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16905*        LENGTH    (PI-COMM-LENGTH)
 16906*    END-EXEC.
 16907*    MOVE '.(CT                  ''   #00014800' TO DFHEIV0
 16908     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16909     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16910     MOVE X'2020233030303134383030' TO DFHEIV0(25:11)
 16911     CALL 'kxdfhei1' USING DFHEIV0,
 16912           TRANS-ID,
 16913           PROGRAM-INTERFACE-BLOCK,
 16914           PI-COMM-LENGTH,
 16915           DFHEIV99,
 16916           DFHEIV99,
 16917           DFHEIV99
 16918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16919
 16920
 16921 9200-RETURN-MAIN-MENU.
 16922     MOVE XCTL-126               TO PGM-NAME.
 16923     GO TO 9300-XCTL.
 16924
 16925 9300-XCTL.
 16926
 16927
 16928* EXEC CICS XCTL
 16929*        PROGRAM   (PGM-NAME)
 16930*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16931*        LENGTH    (PI-COMM-LENGTH)
 16932*    END-EXEC.
 16933*    MOVE '.$C                   %   #00014812' TO DFHEIV0
 16934     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16935     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16936     MOVE X'2020233030303134383132' TO DFHEIV0(25:11)
 16937     CALL 'kxdfhei1' USING DFHEIV0,
 16938           PGM-NAME,
 16939           PROGRAM-INTERFACE-BLOCK,
 16940           PI-COMM-LENGTH,
 16941           DFHEIV99
 16942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16943
 16944
 16945 9400-CLEAR.
 16946     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16947     GO TO 9300-XCTL.
 16948
 16949 9500-PF12.
 16950     MOVE XCTL-010               TO PGM-NAME.
 16951     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 327
* EL130.cbl
 16952
 16953 9600-PGMID-ERROR.
 16954
 16955
 16956* EXEC CICS HANDLE CONDITION
 16957*        PGMIDERR  (8300-SEND-TEXT)
 16958*    END-EXEC.
 16959*    MOVE '"$L                   ! N #00014828' TO DFHEIV0
 16960     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16961     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16962     MOVE X'4E20233030303134383238' TO DFHEIV0(25:11)
 16963     CALL 'kxdfhei1' USING DFHEIV0
 16964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16965
 16966
 16967     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16968     MOVE ' '                    TO PI-ENTRY-CD-1.
 16969     MOVE XCTL-005               TO PGM-NAME.
 16970     MOVE PGM-NAME               TO LOGOFF-PGM.
 16971     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16972     GO TO 9300-XCTL.
 16973
 16974 9700-LINK-DATE-CONVERT.
 16975     MOVE LINK-ELDATCV           TO PGM-NAME.
 16976
 16977
 16978* EXEC CICS LINK
 16979*        PROGRAM    (PGM-NAME)
 16980*        COMMAREA   (DATE-CONVERSION-DATA)
 16981*        LENGTH     (DC-COMM-LENGTH)
 16982*    END-EXEC.
 16983*    MOVE '."C                   (   #00014842' TO DFHEIV0
 16984     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16985     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16986     MOVE X'2020233030303134383432' TO DFHEIV0(25:11)
 16987     CALL 'kxdfhei1' USING DFHEIV0,
 16988           PGM-NAME,
 16989           DATE-CONVERSION-DATA,
 16990           DC-COMM-LENGTH,
 16991           DFHEIV99,
 16992           DFHEIV99,
 16993           DFHEIV99,
 16994           DFHEIV99
 16995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16996
 16997
 16998 9700-EXIT.
 16999     EXIT.
 17000
 17001 9800-LINK-REM-TERM.
 17002     MOVE LINK-ELRTRM            TO PGM-NAME.
 17003
 17004
 17005* EXEC CICS LINK
 17006*        PROGRAM    (PGM-NAME)
 17007*        COMMAREA   (CALCULATION-PASS-AREA)
 17008*        LENGTH     (CP-COMM-LENGTH)
 17009*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 328
* EL130.cbl
 17010*    MOVE '."C                   (   #00014854' TO DFHEIV0
 17011     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17012     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17013     MOVE X'2020233030303134383534' TO DFHEIV0(25:11)
 17014     CALL 'kxdfhei1' USING DFHEIV0,
 17015           PGM-NAME,
 17016           CALCULATION-PASS-AREA,
 17017           CP-COMM-LENGTH,
 17018           DFHEIV99,
 17019           DFHEIV99,
 17020           DFHEIV99,
 17021           DFHEIV99
 17022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17023
 17024
 17025 9800-EXIT.
 17026     EXIT.
 17027
 17028 9900-ERROR-FORMAT.
 17029*    if emi-error = 1651 or 1652 or 1653 or 1655
 17030*       display ' 9900 error ' emi-error
 17031*       display emi-message-area (1)
 17032*       display emi-message-area (2)
 17033*       display emi-message-area (3)
 17034*    end-if
 17035     IF NOT EMI-ERRORS-COMPLETE
 17036         MOVE LINK-001           TO PGM-NAME
 17037
 17038* EXEC CICS LINK
 17039*            PROGRAM   (PGM-NAME)
 17040*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 17041*            LENGTH    (EMI-COMM-LENGTH)
 17042*        END-EXEC
 17043*    MOVE '."C                   (   #00014872' TO DFHEIV0
 17044     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17046     MOVE X'2020233030303134383732' TO DFHEIV0(25:11)
 17047     CALL 'kxdfhei1' USING DFHEIV0,
 17048           PGM-NAME,
 17049           ERROR-MESSAGE-INTERFACE-BLOCK,
 17050           EMI-COMM-LENGTH,
 17051           DFHEIV99,
 17052           DFHEIV99,
 17053           DFHEIV99,
 17054           DFHEIV99
 17055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17056         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 17057            subtract 1 from emi-fatal-ctr
 17058         end-if
 17059     END-IF.
 17060
 17061     .
 17062 9900-EXIT.
 17063     EXIT.
 17064
 17065 9990-ABEND.
 17066     MOVE -1                     TO MAINTL.
 17067     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 329
* EL130.cbl
 17068     MOVE DFHEIBLK               TO EMI-LINE1.
 17069
 17070
 17071* EXEC CICS LINK
 17072*        PROGRAM   (PGM-NAME)
 17073*        COMMAREA  (EMI-LINE1)
 17074*        LENGTH    (72)
 17075*    END-EXEC.
 17076     MOVE 72
 17077       TO DFHEIV11
 17078*    MOVE '."C                   (   #00014891' TO DFHEIV0
 17079     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17081     MOVE X'2020233030303134383931' TO DFHEIV0(25:11)
 17082     CALL 'kxdfhei1' USING DFHEIV0,
 17083           PGM-NAME,
 17084           EMI-LINE1,
 17085           DFHEIV11,
 17086           DFHEIV99,
 17087           DFHEIV99,
 17088           DFHEIV99,
 17089           DFHEIV99
 17090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17091
 17092
 17093     MOVE EMI-LINE1              TO ERRMSG2O.
 17094
 17095     GO TO 8200-BYPASS-ERROR.
 17096
 17097
 17098
 17099* GOBACK.
 17100     MOVE '9%                    "   ' TO DFHEIV0
 17101     MOVE 'EL130' TO DFHEIV1
 17102     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17103     GOBACK.
 17104
 17105 9995-SECURITY-VIOLATION.
 17106*             COPY ELCSCTP.
 17107******************************************************************
 17108*                                                                *
 17109*                            ELCSCTP                             *
 17110*                            VMOD=2.001                          *
 17111*                                                                *
 17112*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17113******************************************************************
 17114
 17115
 17116     MOVE EIBDATE          TO SM-JUL-DATE.
 17117     MOVE EIBTRMID         TO SM-TERMID.
 17118     MOVE THIS-PGM         TO SM-PGM.
 17119     MOVE EIBTIME          TO TIME-IN.
 17120     MOVE TIME-OUT         TO SM-TIME.
 17121     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17122
 17123
 17124* EXEC CICS LINK
 17125*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 330
* EL130.cbl
 17126*         COMMAREA (SECURITY-MESSAGE)
 17127*         LENGTH   (80)
 17128*    END-EXEC.
 17129     MOVE 'EL003' TO DFHEIV1
 17130     MOVE 80
 17131       TO DFHEIV11
 17132*    MOVE '."C                   (   #00014922' TO DFHEIV0
 17133     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17134     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17135     MOVE X'2020233030303134393232' TO DFHEIV0(25:11)
 17136     CALL 'kxdfhei1' USING DFHEIV0,
 17137           DFHEIV1,
 17138           SECURITY-MESSAGE,
 17139           DFHEIV11,
 17140           DFHEIV99,
 17141           DFHEIV99,
 17142           DFHEIV99,
 17143           DFHEIV99
 17144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17145
 17146
 17147******************************************************************
 17148
 17149
 17150 9995-EXIT.
 17151     EXIT.
 17152
 17153
 17154 9999-DFHBACK SECTION.
 17155     MOVE '9%                    "   ' TO DFHEIV0
 17156     MOVE 'EL130' TO DFHEIV1
 17157     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17158     GOBACK.
 17159 9999-DFHEXIT.
 17160     IF DFHEIGDJ EQUAL 0001
 17161         NEXT SENTENCE
 17162     ELSE IF DFHEIGDJ EQUAL 2
 17163         GO TO 0100-TEST-ENTRY,
 17164               8100-SEND-INITIAL-MAP,
 17165               9600-PGMID-ERROR,
 17166               8820-TERM-ERROR,
 17167               8830-TRAN-ERROR,
 17168               9990-ABEND
 17169         DEPENDING ON DFHEIGDI
 17170     ELSE IF DFHEIGDJ EQUAL 3
 17171         GO TO 0450-ADD-ELACTQ-RECORD
 17172         DEPENDING ON DFHEIGDI
 17173     ELSE IF DFHEIGDJ EQUAL 4
 17174         GO TO 8820-TERM-ERROR,
 17175               8830-TRAN-ERROR
 17176         DEPENDING ON DFHEIGDI
 17177     ELSE IF DFHEIGDJ EQUAL 5
 17178         GO TO 0660-NOT-FOUND,
 17179               0670-QIDERR
 17180         DEPENDING ON DFHEIGDI
 17181     ELSE IF DFHEIGDJ EQUAL 6
 17182         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17183         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 331
* EL130.cbl
 17184     ELSE IF DFHEIGDJ EQUAL 7
 17185         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17186         DEPENDING ON DFHEIGDI
 17187     ELSE IF DFHEIGDJ EQUAL 8
 17188         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17189         DEPENDING ON DFHEIGDI
 17190     ELSE IF DFHEIGDJ EQUAL 9
 17191         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17192         DEPENDING ON DFHEIGDI
 17193     ELSE IF DFHEIGDJ EQUAL 10
 17194         GO TO 2050-DELETE-NOT-FOUND
 17195         DEPENDING ON DFHEIGDI
 17196     ELSE IF DFHEIGDJ EQUAL 11
 17197         GO TO 2010-DELETE-CL
 17198         DEPENDING ON DFHEIGDI
 17199     ELSE IF DFHEIGDJ EQUAL 12
 17200         GO TO 3010-TEST-FOR-ERRORS
 17201         DEPENDING ON DFHEIGDI
 17202     ELSE IF DFHEIGDJ EQUAL 13
 17203         GO TO 3008-DUP-ERROR,
 17204               3009-NOT-FOUND
 17205         DEPENDING ON DFHEIGDI
 17206     ELSE IF DFHEIGDJ EQUAL 14
 17207         GO TO 3030-BUILD-CONT
 17208         DEPENDING ON DFHEIGDI
 17209     ELSE IF DFHEIGDJ EQUAL 15
 17210         GO TO 3033-ACCT-NOT-FOUND,
 17211               3033-ACCT-NOT-FOUND
 17212         DEPENDING ON DFHEIGDI
 17213     ELSE IF DFHEIGDJ EQUAL 16
 17214         GO TO 3032-NOT-IN-DT-RANGE
 17215         DEPENDING ON DFHEIGDI
 17216     ELSE IF DFHEIGDJ EQUAL 17
 17217         GO TO 3070-BUILD-CONT
 17218         DEPENDING ON DFHEIGDI
 17219     ELSE IF DFHEIGDJ EQUAL 18
 17220         GO TO 3065-CERT-NOT-FOUND
 17221         DEPENDING ON DFHEIGDI
 17222     ELSE IF DFHEIGDJ EQUAL 19
 17223         GO TO 3100-CARRIER-NOT-FOUND
 17224         DEPENDING ON DFHEIGDI
 17225     ELSE IF DFHEIGDJ EQUAL 20
 17226         GO TO 3110-COMPANY-NOT-FOUND
 17227         DEPENDING ON DFHEIGDI
 17228     ELSE IF DFHEIGDJ EQUAL 21
 17229         GO TO 3200-BUILD-ZERO-TRAILER
 17230         DEPENDING ON DFHEIGDI
 17231     ELSE IF DFHEIGDJ EQUAL 22
 17232         GO TO 9999-DFHBACK
 17233         DEPENDING ON DFHEIGDI
 17234     ELSE IF DFHEIGDJ EQUAL 23
 17235         GO TO 3290-NO-INSURED-ADDRESS
 17236         DEPENDING ON DFHEIGDI
 17237     ELSE IF DFHEIGDJ EQUAL 24
 17238         GO TO 3410-DUP-KEY
 17239         DEPENDING ON DFHEIGDI
 17240     ELSE IF DFHEIGDJ EQUAL 25
 17241         GO TO 3690-CERT-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 332
* EL130.cbl
 17242         DEPENDING ON DFHEIGDI
 17243     ELSE IF DFHEIGDJ EQUAL 26
 17244         GO TO 3850-CLAIM-MSTR-WRITTEN
 17245         DEPENDING ON DFHEIGDI
 17246     ELSE IF DFHEIGDJ EQUAL 27
 17247         GO TO 3992-DUPREC
 17248         DEPENDING ON DFHEIGDI
 17249     ELSE IF DFHEIGDJ EQUAL 28
 17250         GO TO 5050-CERT-NOT-FOUND
 17251         DEPENDING ON DFHEIGDI
 17252     ELSE IF DFHEIGDJ EQUAL 29
 17253         GO TO 5030-CERT-WRITTEN
 17254         DEPENDING ON DFHEIGDI
 17255     ELSE IF DFHEIGDJ EQUAL 30
 17256         GO TO 5035-CLAIM-WRITTEN
 17257         DEPENDING ON DFHEIGDI
 17258     ELSE IF DFHEIGDJ EQUAL 31
 17259         GO TO 9990-ABEND,
 17260               5799-EXIT
 17261         DEPENDING ON DFHEIGDI
 17262     ELSE IF DFHEIGDJ EQUAL 32
 17263         GO TO 3100-CARRIER-NOT-FOUND
 17264         DEPENDING ON DFHEIGDI
 17265     ELSE IF DFHEIGDJ EQUAL 33
 17266         GO TO 6040-NO-PROCESSOR-RECORD
 17267         DEPENDING ON DFHEIGDI
 17268     ELSE IF DFHEIGDJ EQUAL 34
 17269         GO TO 6060-NO-BENEFICIARY-RECORD
 17270         DEPENDING ON DFHEIGDI
 17271     ELSE IF DFHEIGDJ EQUAL 35
 17272         GO TO 6499-EXIT,
 17273               6499-EXIT
 17274         DEPENDING ON DFHEIGDI
 17275     ELSE IF DFHEIGDJ EQUAL 36
 17276         GO TO 6600-NOT-FOUND
 17277         DEPENDING ON DFHEIGDI
 17278     ELSE IF DFHEIGDJ EQUAL 37
 17279         GO TO 6700-NOTOPEN-ERROR,
 17280               6700-EXIT
 17281         DEPENDING ON DFHEIGDI
 17282     ELSE IF DFHEIGDJ EQUAL 38
 17283         GO TO 7120-NOT-FOUND
 17284         DEPENDING ON DFHEIGDI
 17285     ELSE IF DFHEIGDJ EQUAL 39
 17286         GO TO 7499-EXIT
 17287         DEPENDING ON DFHEIGDI
 17288     ELSE IF DFHEIGDJ EQUAL 40
 17289         GO TO 7500-EXIT,
 17290               7500-DUPLICATE-KEY,
 17291               7500-EXIT
 17292         DEPENDING ON DFHEIGDI
 17293     ELSE IF DFHEIGDJ EQUAL 41
 17294         GO TO 7500-END-BROWSE
 17295         DEPENDING ON DFHEIGDI
 17296     ELSE IF DFHEIGDJ EQUAL 42
 17297         GO TO 7630-END-BROWSE
 17298         DEPENDING ON DFHEIGDI
 17299     ELSE IF DFHEIGDJ EQUAL 43
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:11 Page 333
* EL130.cbl
 17300         GO TO 7799-EXIT,
 17301               7799-EXIT
 17302         DEPENDING ON DFHEIGDI
 17303     ELSE IF DFHEIGDJ EQUAL 44
 17304         GO TO 7790-END-BROWSE
 17305         DEPENDING ON DFHEIGDI
 17306     ELSE IF DFHEIGDJ EQUAL 45
 17307         GO TO 7992-NOT-FOUND
 17308         DEPENDING ON DFHEIGDI
 17309     ELSE IF DFHEIGDJ EQUAL 46
 17310         GO TO 8300-SEND-TEXT
 17311         DEPENDING ON DFHEIGDI.
 17312     MOVE '9%                    "   ' TO DFHEIV0
 17313     MOVE 'EL130' TO DFHEIV1
 17314     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17315     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12864     Code:       55032
