* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    42* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    45* 121417  IR2017121200001  PEMA  Correct assignment of ben period
    46* 011118  CR2016052500002  TANA  Add Message for pre-existing
    47******************************************************************
    48
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page   3
* EL130.cbl
    50 ENVIRONMENT DIVISION.
    51 DATA DIVISION.
    52 WORKING-STORAGE SECTION.
    53 01  DFH-START PIC X(04).
    54 77  FILLER  PIC X(32)  VALUE '********************************'.
    55 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    56 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    57 77  A1                          PIC S999 COMP-3 VALUE +0.
    58 77  E1                          PIC S999 COMP-3 VALUE +0.
    59 77  s1                          pic s999 comp-3 value +0.
    60 77  s2                          pic s999 comp-3 value +0.
    61 77  P1                          PIC S999 COMP-3 VALUE +0.
    62 77  P2                          PIC S999 COMP-3 VALUE +0.
    63 77  WS-CRIT-PER-RECURRENT       PIC 99    VALUE zeros.
    64 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    65 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    66 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    67 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    68 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    69 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    70 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    71     88  ERPDEF-FOUND                 VALUE 'Y'.
    72 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    73 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    74 77  ws-dcc-product-code         pic xxx value spaces.
    75 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    76 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    77 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    78 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    79 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    80 77  ws-zero-bens-avail          pic x value ' '.
    81 77  WS-PRE-EXISTING-PER         PIC 99    VALUE ZEROS.
    82*    COPY ELCSCTM.
    83******************************************************************
    84*                                                                *
    85*                                                                *
    86*                            ELCSCTM                             *
    87*                            VMOD=2.001                          *
    88*                                                                *
    89*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    90*                                                                *
    91******************************************************************
    92 01  SECURITY-MESSAGE.
    93     12  FILLER                          PIC X(30)
    94            VALUE '** LOGIC SECURITY VIOLATION -'.
    95     12  SM-READ                         PIC X(6).
    96     12  FILLER                          PIC X(5)
    97            VALUE ' PGM='.
    98     12  SM-PGM                          PIC X(6).
    99     12  FILLER                          PIC X(5)
   100            VALUE ' OPR='.
   101     12  SM-PROCESSOR-ID                 PIC X(4).
   102     12  FILLER                          PIC X(6)
   103            VALUE ' TERM='.
   104     12  SM-TERMID                       PIC X(4).
   105     12  FILLER                          PIC XX   VALUE SPACE.
   106     12  SM-JUL-DATE                     PIC 9(5).
   107     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page   4
* EL130.cbl
   108     12  SM-TIME                         PIC 99.99.
   109
   110
   111*    COPY ELCSCRTY.
   112******************************************************************
   113*                                                                *
   114*                                                                *
   115*                            ELCSCRTY                            *
   116*                            VMOD=2.001                          *
   117*                                                                *
   118*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   119*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   120*        SAVED IN PI-SECURITY-ADDRESS.                           *
   121*                                                                *
   122******************************************************************
   123 01  SECURITY-CONTROL.
   124     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   125     12  FILLER                       PIC XX    VALUE 'SC'.
   126     12  SC-CREDIT-CODES.
   127         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   128             20  SC-CREDIT-DISPLAY    PIC X.
   129             20  SC-CREDIT-UPDATE     PIC X.
   130     12  SC-CLAIMS-CODES.
   131         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   132             20  SC-CLAIMS-DISPLAY    PIC X.
   133             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page   5
* EL130.cbl
   135 01  WS-DATE-AREA.
   136     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   137     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   138     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   139
   140 01  ws-dcc-error-line.
   141     05  filler occurs 15.
   142         10  ws-error-no        pic x(4).
   143 01  WS-CRI-SSN-WORK-AREA.
   144     05  WS-CRI-SOC-SEC-NO.
   145         10  WS-SS-REPT-CD       PIC X(5).
   146         10  WS-SS-LAST-NAME     PIC X(5).
   147         10  WS-SS-INITIAL       PIC X.
   148
   149     05  WS-CRI-REPORT-CODE.
   150         10  FILLER              PIC X(5).
   151         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   152
   153     05  WS-CRI-LAST-NAME.
   154         10  WS-CRI-NAME-MOVE    PIC X(5).
   155         10  FILLER              PIC X(10).
   156
   157 01  STANDARD-AREAS.
   158     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   159     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   160     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   161     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   162     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   163     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   164     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   165     12  PGM-NAME            PIC X(8).
   166     12  TIME-IN             PIC S9(7).
   167     12  TIME-OUT-R  REDEFINES TIME-IN.
   168         16  FILLER          PIC X.
   169         16  TIME-OUT        PIC 99V99.
   170         16  FILLER          PIC X(2).
   171     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   172     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   173     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   174     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   175     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   176     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   177     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   178     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   179     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   180     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   181     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   182     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   183     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   184     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   185     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   186     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   187     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   188     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   189     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   190     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   191     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   192     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page   6
* EL130.cbl
   193     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   194     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   195     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   196     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   197     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   198     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   199     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   200     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   201     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   202     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   203     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   204     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   205     12  FILE-ID             PIC X(8).
   206     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   207     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   208     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   209     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   210     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   211     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   212     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   213     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   214     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   215
   216 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   217     12  M                   PIC S9(7)V99           VALUE ZEROS.
   218     12  L                   PIC S9(7)V99           VALUE ZEROS.
   219     12  N                   PIC S9(3)              VALUE ZEROS.
   220     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   221     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   222     12  I                   PIC S99V9(5)           VALUE ZEROS.
   223     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   224     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   225     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   226     12  R                   PIC S9(3)              VALUE ZEROS.
   227     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   228     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   229     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   230     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   231     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   232     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   233     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   234     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   235     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   236
   237 01  TERM-CALC-WORK-AREA.
   238     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   239     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   240     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   241     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   242     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   243     12  V-EXPONENTS.
   244        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   245     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   246
   247 01  MISC-WORK-AREAS.
   248     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   249     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   250     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page   7
* EL130.cbl
   251     12  QID.
   252         16  QID-TERM        PIC X(4).
   253         16  FILLER          PIC X(4)    VALUE '130A'.
   254     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   255     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   256     12  WS-GROUP-NO.
   257         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   258         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   259
   260     12  WS-RESPONSE         PIC S9(8)   COMP.
   261         88  WS-RESP-NORMAL              VALUE +00.
   262         88  WS-RESP-ERROR               VALUE +01.
   263         88  WS-RESP-NOTFND              VALUE +13.
   264         88  WS-RESP-DUPKEY              VALUE +15.
   265         88  WS-RESP-NOTOPEN             VALUE +19.
   266         88  WS-RESP-ENDFILE             VALUE +20.
   267
   268***************************************************************
   269*                                                             *
   270*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   271*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   272*    CHANGES WITH IN MAP EL130A.                              *
   273*                                                             *
   274***************************************************************
   275
   276     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   277     12  WS-SAVE-CLAIM-MASTER.
   278         16  FILLER                    PIC XX.
   279         16  WS-SAVE-CLAIM-KEY.
   280             20  WS-SAVE-COMPANY-CD    PIC X.
   281             20  WS-SAVE-CARRIER       PIC X.
   282             20  WS-SAVE-CLAIM-NO      PIC X(7).
   283             20  WS-SAVE-CERT-NO       PIC X(11).
   284         16  FILLER                    PIC X(328).
   285     12  SAVE-CURRENT-DATE         PIC XX.
   286     12  SAVE-CONTROL              PIC X(39).
   287     12  SAVE-ERACCT-KEY           PIC X(26).
   288     12  SAVE-COUNTER              PIC S9(8)   COMP.
   289     12  SAVE-METHOD               PIC X.
   290     12  SAVE-COMPANY-ID           PIC XXX.
   291     12  SAVE-COMPANY-CD           PIC X.
   292     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   293     12  SAVE-CREDIT-USER          PIC X.
   294     12  SAVE-CLAIM-USER           PIC X.
   295     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   296     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   297     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   298     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   299     12  SAVE-AH-OVERRIDE-L1       PIC X.
   300     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   301     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   302     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   303     12  FILLER                    PIC X.
   304*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   305     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   306     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   307     12  SAVE-EL127-TO-EL130-CNTRL.
   308         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page   8
* EL130.cbl
   309         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   310         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   311             20  SAVE-EL127-CARRIER  PIC X.
   312             20  SAVE-EL127-GROUPING PIC X(6).
   313             20  SAVE-EL127-STATE    PIC X(2).
   314             20  SAVE-EL127-ACCOUNT  PIC X(10).
   315             20  SAVE-EL127-CERT-NO  PIC X(11).
   316             20  SAVE-EL127-EFF-DT   PIC XX.
   317     12  SAVE-EL659-TO-EL130-CNTRL.
   318         16  SAVE-EL659-CARRIER    PIC X.
   319         16  SAVE-EL659-GROUPING   PIC X(6).
   320         16  SAVE-EL659-STATE      PIC XX.
   321         16  SAVE-EL659-ACCOUNT    PIC X(10).
   322     12  DIVIDE-QUOT               PIC 999.
   323     12  DIVIDE-REM                PIC 999.
   324     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   325     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   326     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   327     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   328     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   329     12  WS-RESERVE-CONTROLS       PIC X(9).
   330     12  WS-EXPENSE-CONTROLS       PIC X(7).
   331     12  WS-REIN-TABLE.
   332         16  WS-REIN-1             PIC X            VALUE SPACE.
   333         16  WS-REIN-2             PIC X            VALUE SPACE.
   334         16  WS-REIN-3             PIC X            VALUE SPACE.
   335     12  WS-BENE-CALC-METHOD       PIC X.
   336     12  ws-lf-joint-indicator     pic x.
   337     12  ws-ah-joint-indicator     pic x.
   338     12  WS-EARNINGS-CALC          PIC X.
   339     12  WS-LF-EARNINGS-CALC       PIC X.
   340         88 TEX-REG                VALUE '4'.
   341         88 NET-PAY                VALUE '5'.
   342     12  WS-AH-EARNINGS-CALC       PIC X.
   343     12  WS-SPECIAL-CALC-CD        PIC X(01).
   344     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   345     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   346     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   347     12  WS-ICD-CODE-1             PIC X(8).
   348     12  WS-ICD-CODE-2             PIC X(8).
   349     12  WS-CLAIM-NUMBER.
   350         16  WS-CN-PREFIX.
   351             20  WS-CN-PRF-A PIC X.
   352             20  WS-CN-PRF-B PIC X.
   353         16  WS-CN-NUMBER    PIC 9(5).
   354     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   355     12  WS-CLAIM-SEQU.
   356         16  FILLER          PIC X    VALUE '('.
   357         16  WS-CURRENT-SEQU PIC Z9.
   358         16  FILLER          PIC X(4) VALUE ' OF '.
   359         16  WS-OF-SEQU      PIC Z9.
   360         16  FILLER          PIC X    VALUE ')'.
   361     12  DATE-WORK.
   362       14  FILLER                PIC XX.
   363       14  DATE-MM               PIC XX.
   364       14  DATE-DD               PIC XX.
   365       14  DATE-YY               PIC XX.
   366     12  CURR-DATE REDEFINES DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page   9
* EL130.cbl
   367         16  CURR-MM.
   368           18  CURR-M1           PIC 9.
   369           18  CURR-M2           PIC 9.
   370         16  FILLER              PIC X(5).
   371         16  CURR-YEAR           PIC 9.
   372     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   373     12  SUB                     PIC 99.
   374     12  MY-DATE.
   375         16  MY-MM               PIC XX.
   376         16  FILLER              PIC X VALUE '/'.
   377         16  MY-YY               PIC XX.
   378
   379     12  WS-EDIT-BEN-CODE        PIC XX.
   380         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   381                                          '90' THRU '99'.
   382
   383     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   384     12  WS-BEN-HOLD             PIC XX.
   385     12  WS-BEN-ALPHA-HOLD.
   386         15  WS-BEN-ALPHA-2      PIC XX.
   387         15  WS-BEN-ALPHA-1      PIC X.
   388     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   389     12  WS-REC-TYPE             PIC X.
   390     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   391     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   392     12  ARCH-NUMBER             PIC S9(8)   COMP.
   393     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   394         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   395         88  REIN-REC-FOUND                  VALUE 'Y'.
   396
   397     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   398     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   399
   400
   401 01  CSO-WORK-FIELDS.
   402     12  WS-BLANK            PIC X       VALUE ' '.
   403
   404     12  WS-MA-CONTROL-PRIMARY.
   405         16  WS-MA-COMPANY-CD        PIC  X.
   406         16  WS-MA-CARRIER           PIC  X.
   407         16  WS-MA-GROUPING          PIC  X(6).
   408         16  WS-MA-STATE             PIC  XX.
   409         16  WS-MA-ACCOUNT           PIC  X(10).
   410         16  WS-MA-CERT-EFF-DT       PIC  XX.
   411         16  WS-MA-CERT-NO.
   412             20  WS-MA-CERT-PRIME    PIC  X(10).
   413             20  WS-MA-CERT-SFX      PIC  X.
   414
   415     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   416     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   417     12  WS-SOC-SEC-NUMBER.
   418         16  WS-SOC-SEC-NO       PIC 9(9).
   419         16  WS-SOC-SEC-BLANK    PIC X(2).
   420     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   421         16  WS-SSN-1-3          PIC 9(3).
   422         16  WS-SSN-DASH1        PIC X(1).
   423         16  WS-SSN-4-5          PIC 9(2).
   424         16  WS-SSN-DASH2        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  10
* EL130.cbl
   425         16  WS-SSN-6-9          PIC 9(4).
   426
   427     12  WS-DIAG-VIN-MSG.
   428         16  FILLER          PIC X(11)
   429             VALUE 'VIN NUMBER '.
   430         16  WS-DIAG-VIN     PIC X(17).
   431
   432     12  WS-VERIFY-NOTE      PIC X(34)
   433         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   434
   435     12  WS-CAUSAL-NOTE      PIC X(40)
   436         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   437
   438     12  WS-VFY-SSN-NOTE     PIC X(25)
   439         VALUE 'SSN VERIFICATION REQUIRED'.
   440
   441 01  MAP-DATE-AREAS.
   442     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   443     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   444     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   445     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   446     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   447     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   448     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   449     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   450     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   451     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   452     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   453     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   454     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   455     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   456     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   457     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   458     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   459     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   460     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   461         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   462     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   463     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   464     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   465     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   466
   467 01  ACCESS-KEYS.
   468     12  ELACTQ-KEY.
   469         16  ELACTQ-COMPANY-CD       PIC X.
   470         16  ELACTQ-CARRIER          PIC X.
   471         16  ELACTQ-CLAIM-NO         PIC X(7).
   472         16  ELACTQ-CERT-NO          PIC X(11).
   473     12  ELMSTR-KEY.
   474         16  MSTR-COMP-CD            PIC X.
   475         16  MSTR-CARRIER            PIC X.
   476         16  MSTR-CLAIM-NO           PIC X(7).
   477         16  MSTR-CERT-NO.
   478             20  MSTR-CERT-NO-PRIME  PIC X(10).
   479             20  MSTR-CERT-NO-SUFX   PIC X.
   480     12  SAVE-ELMSTR-KEY.
   481         16  SAVE-COMP-CD            PIC X.
   482         16  SAVE-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  11
* EL130.cbl
   483         16  SAVE-CLAIM-NO           PIC X(7).
   484         16  SAVE-CERT-NO.
   485             20  SAVE-CERT-NO-PRIME  PIC X(10).
   486             20  SAVE-CERT-NO-SUFX   PIC X.
   487     12  ELMSTR5-KEY.
   488         16  MSTR5-COMP-CD           PIC X.
   489         16  MSTR5-CERT-NO.
   490             20  MSTR5-CERT-NO-PRIME PIC X(10).
   491             20  MSTR5-CERT-NO-SUFX  PIC X.
   492     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   493         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   494         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   495         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   496     12  ELCNTL-KEY.
   497         16  CNTL-COMP-ID    PIC X(3).
   498         16  CNTL-REC-TYPE   PIC X.
   499         16  CNTL-ACCESS.
   500             20  FILLER      PIC XX.
   501             20  CNTL-BENEFIT.
   502                 24  FILLER  PIC X.
   503                 24  CNTL-CARRIER PIC X.
   504         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   505     12  ELCERT-KEY.
   506         16  CERT-COMP-CD    PIC X.
   507         16  CERT-CARRIER    PIC X.
   508         16  CERT-GROUPING   PIC X(6).
   509         16  CERT-STATE      PIC X(2).
   510         16  CERT-ACCOUNT.
   511             20  CERT-ACCOUNT-PREFIX PIC X(4).
   512             20  CERT-ACCOUNT-PRIME  PIC X(6).
   513         16  CERT-EFF-DT     PIC XX.
   514         16  CERT-CERT-NO.
   515             20  CERT-CERT-NO-PRIME  PIC X(10).
   516             20  CERT-CERT-NO-SUFX   PIC X.
   517     12  ELCERT-KEY-5.
   518         16  CERT-COMP-CD-5      PIC X.
   519         16  CERT-CERT-5.
   520             20  CERT-CERT-5-PRIME   PIC X(10).
   521             20  CERT-CERT-5-SUFX    PIC X.
   522     12  ERACCT-KEY.
   523         16  ACCT-COMP-CD    PIC X.
   524         16  ACCT-CARRIER    PIC X.
   525         16  ACCT-GROUPING   PIC X(6).
   526         16  ACCT-STATE      PIC X(2).
   527         16  ACCT-ACCOUNT    PIC X(10).
   528         16  ACCT-EXP-DT     PIC XX.
   529     12  ELTRLR-KEY.
   530         16  TRLR-COMP-CD    PIC X.
   531         16  TRLR-CARRIER    PIC X.
   532         16  TRLR-CLAIM-NO   PIC X(7).
   533         16  TRLR-CERT-NO.
   534             20  TRLR-CERT-NO-PRIME  PIC X(10).
   535             20  TRLR-CERT-NO-SUFX   PIC X.
   536         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   537         16  TRLR-TYPE       PIC X.
   538     12  ELBENE-KEY.
   539         16  BENE-COMP-CD    PIC X.
   540         16  BENE-RCD-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  12
* EL130.cbl
   541         16  BENE-CODE       PIC X(10).
   542     12  ERREIN-KEY.
   543         16  REIN-COMP-CD        PIC X(01).
   544         16  REIN-TYPE           PIC X(01).
   545         16  REIN-TABLE-CO.
   546             20  REIN-CODE-1     PIC X(01).
   547             20  REIN-CODE-2     PIC X(01).
   548             20  REIN-CODE-3     PIC X(01).
   549         16  FILLER              PIC X(03).
   550     12  ELCRTT-KEY.
   551         16  CTRLR-COMP-CD       PIC X.
   552         16  CTRLR-CARRIER       PIC X.
   553         16  CTRLR-GROUPING      PIC X(6).
   554         16  CTRLR-STATE         PIC X(2).
   555         16  CTRLR-ACCOUNT       PIC X(10).
   556         16  CTRLR-EFF-DT        PIC XX.
   557         16  CTRLR-CERT-NO       PIC X(11).
   558         16  CTRLR-REC-TYPE      PIC X.
   559 01  ws-acct-found-sw            pic x value ' '.
   560     88  acct-found                value 'Y'.
   561 01  ERPDEF-KEY-SAVE             PIC X(18).
   562 01  ERPDEF-KEY.
   563     12  ERPDEF-COMPANY-CD       PIC X.
   564     12  ERPDEF-STATE            PIC XX.
   565     12  ERPDEF-PROD-CD          PIC XXX.
   566     12  F                       PIC X(7).
   567     12  ERPDEF-BEN-TYPE         PIC X.
   568     12  ERPDEF-BEN-CODE         PIC XX.
   569     12  ERPDEF-EXP-DT           PIC XX.
   570 01  ERROR-MESSAGES.
   571     12  ER-0000                 PIC X(4)  VALUE '0000'.
   572     12  ER-0004                 PIC X(4)  VALUE '0004'.
   573     12  ER-0019                 PIC X(4)  VALUE '0019'.
   574     12  ER-0023                 PIC X(4)  VALUE '0023'.
   575     12  ER-0029                 PIC X(4)  VALUE '0029'.
   576     12  ER-0033                 PIC X(4)  VALUE '0033'.
   577     12  ER-0068                 PIC X(4)  VALUE '0068'.
   578     12  ER-0070                 PIC X(4)  VALUE '0070'.
   579     12  ER-0194                 PIC X(4)  VALUE '0194'.
   580     12  ER-0202                 PIC X(4)  VALUE '0202'.
   581     12  ER-0203                 PIC X(4)  VALUE '0203'.
   582     12  ER-0204                 PIC X(4)  VALUE '0204'.
   583     12  ER-0205                 PIC X(4)  VALUE '0205'.
   584     12  ER-0206                 PIC X(4)  VALUE '0206'.
   585     12  ER-0207                 PIC X(4)  VALUE '0207'.
   586     12  ER-0213                 PIC X(4)  VALUE '0213'.
   587     12  ER-0214                 PIC X(4)  VALUE '0214'.
   588     12  ER-0217                 PIC X(4)  VALUE '0217'.
   589     12  ER-0219                 PIC X(4)  VALUE '0219'.
   590     12  ER-0220                 PIC X(4)  VALUE '0220'.
   591     12  ER-0221                 PIC X(4)  VALUE '0221'.
   592     12  ER-0222                 PIC X(4)  VALUE '0222'.
   593     12  ER-0223                 PIC X(4)  VALUE '0223'.
   594     12  ER-0224                 PIC X(4)  VALUE '0224'.
   595     12  ER-0225                 PIC X(4)  VALUE '0225'.
   596     12  ER-0226                 PIC X(4)  VALUE '0226'.
   597     12  ER-0227                 PIC X(4)  VALUE '0227'.
   598     12  ER-0229                 PIC X(4)  VALUE '0229'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  13
* EL130.cbl
   599     12  ER-0230                 PIC X(4)  VALUE '0230'.
   600     12  ER-0231                 PIC X(4)  VALUE '0231'.
   601     12  ER-0232                 PIC X(4)  VALUE '0232'.
   602     12  ER-0233                 PIC X(4)  VALUE '0233'.
   603     12  ER-0234                 PIC X(4)  VALUE '0234'.
   604     12  ER-0235                 PIC X(4)  VALUE '0235'.
   605     12  ER-0236                 PIC X(4)  VALUE '0236'.
   606     12  ER-0237                 PIC X(4)  VALUE '0237'.
   607     12  ER-0238                 PIC X(4)  VALUE '0238'.
   608     12  ER-0239                 PIC X(4)  VALUE '0239'.
   609     12  ER-0240                 PIC X(4)  VALUE '0240'.
   610     12  ER-0241                 PIC X(4)  VALUE '0241'.
   611     12  ER-0243                 PIC X(4)  VALUE '0243'.
   612     12  ER-0244                 PIC X(4)  VALUE '0244'.
   613     12  ER-0245                 PIC X(4)  VALUE '0245'.
   614     12  ER-0246                 PIC X(4)  VALUE '0246'.
   615     12  ER-0247                 PIC X(4)  VALUE '0247'.
   616     12  ER-0248                 PIC X(4)  VALUE '0248'.
   617     12  ER-0250                 PIC X(4)  VALUE '0250'.
   618     12  ER-0251                 PIC X(4)  VALUE '0251'.
   619     12  ER-0252                 PIC X(4)  VALUE '0252'.
   620     12  ER-0253                 PIC X(4)  VALUE '0253'.
   621     12  ER-0254                 PIC X(4)  VALUE '0254'.
   622     12  ER-0257                 PIC X(4)  VALUE '0257'.
   623     12  ER-0258                 PIC X(4)  VALUE '0258'.
   624     12  ER-0260                 PIC X(4)  VALUE '0260'.
   625     12  ER-0261                 PIC X(4)  VALUE '0261'.
   626     12  ER-0263                 PIC X(4)  VALUE '0263'.
   627     12  ER-0264                 PIC X(4)  VALUE '0264'.
   628     12  ER-0265                 PIC X(4)  VALUE '0265'.
   629     12  ER-0266                 PIC X(4)  VALUE '0266'.
   630     12  ER-0267                 PIC X(4)  VALUE '0267'.
   631     12  ER-0334                 PIC X(4)  VALUE '0334'.
   632     12  ER-0337                 PIC X(4)  VALUE '0337'.
   633     12  ER-0412                 PIC X(4)  VALUE '0412'.
   634     12  ER-0413                 PIC X(4)  VALUE '0413'.
   635     12  ER-0428                 PIC X(4)  VALUE '0428'.
   636     12  ER-0429                 PIC X(4)  VALUE '0429'.
   637     12  ER-0430                 PIC X(4)  VALUE '0430'.
   638     12  ER-0433                 PIC X(4)  VALUE '0433'.
   639     12  ER-0434                 PIC X(4)  VALUE '0434'.
   640     12  ER-0458                 PIC X(4)  VALUE '0458'.
   641     12  ER-0489                 PIC X(4)  VALUE '0489'.
   642     12  ER-0509                 PIC X(4)  VALUE '0509'.
   643     12  ER-0510                 PIC X(4)  VALUE '0510'.
   644     12  ER-0511                 PIC X(4)  VALUE '0511'.
   645     12  ER-0512                 PIC X(4)  VALUE '0512'.
   646     12  ER-0516                 PIC X(4)  VALUE '0516'.
   647     12  ER-0517                 PIC X(4)  VALUE '0517'.
   648     12  ER-0518                 PIC X(4)  VALUE '0518'.
   649     12  ER-0519                 PIC X(4)  VALUE '0519'.
   650     12  ER-0520                 PIC X(4)  VALUE '0520'.
   651     12  ER-0521                 PIC X(4)  VALUE '0521'.
   652     12  ER-0522                 PIC X(4)  VALUE '0522'.
   653     12  ER-0523                 PIC X(4)  VALUE '0523'.
   654     12  ER-0544                 PIC X(4)  VALUE '0544'.
   655     12  ER-0546                 PIC X(4)  VALUE '0546'.
   656     12  ER-0558                 PIC X(4)  VALUE '0558'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  14
* EL130.cbl
   657     12  ER-0560                 PIC X(4)  VALUE '0560'.
   658     12  ER-0562                 PIC X(4)  VALUE '0562'.
   659     12  ER-0565                 PIC X(4)  VALUE '0565'.
   660     12  ER-0569                 PIC X(4)  VALUE '0569'.
   661     12  ER-0693                 PIC X(4)  VALUE '0693'.
   662     12  ER-0715                 PIC X(4)  VALUE '0715'.
   663     12  ER-0840                 PIC X(4)  VALUE '0840'.
   664     12  ER-0841                 PIC X(4)  VALUE '0841'.
   665     12  ER-0842                 PIC X(4)  VALUE '0842'.
   666     12  ER-0843                 PIC X(4)  VALUE '0843'.
   667     12  ER-0878                 PIC X(4)  VALUE '0878'.
   668     12  ER-0887                 PIC X(4)  VALUE '0887'.
   669     12  ER-0992                 PIC X(4)  VALUE '0992'.
   670     12  ER-1651                 PIC X(4)  VALUE '1651'.
   671     12  ER-1652                 PIC X(4)  VALUE '1652'.
   672     12  ER-1653                 PIC X(4)  VALUE '1653'.
   673     12  ER-1654                 PIC X(4)  VALUE '1654'.
   674     12  ER-1655                 PIC X(4)  VALUE '1655'.
   675     12  er-1659                 pic x(4)  value '1659'.
   676     12  er-1660                 pic x(4)  value '1660'.
   677     12  er-1661                 pic x(4)  value '1661'.
   678     12  er-1671                 pic x(4)  value '1671'.
   679     12  er-1672                 pic x(4)  value '1672'.
   680     12  er-1673                 pic x(4)  value '1673'.
   681     12  er-1675                 pic x(4)  value '1675'.
   682     12  er-1676                 pic x(4)  value '1676'.
   683     12  ER-1677                 PIC X(4)  VALUE '1677'.
   684     12  ER-1679                 PIC X(4)  VALUE '1679'.
   685     12  ER-2280                 PIC X(4)  VALUE '2280'.
   686     12  ER-2370                 PIC X(4)  VALUE '2370'.
   687     12  ER-2371                 PIC X(4)  VALUE '2371'.
   688     12  ER-2378                 PIC X(4)  VALUE '2378'.
   689     12  ER-2380                 PIC X(4)  VALUE '2380'.
   690     12  ER-2566                 PIC X(4)  VALUE '2566'.
   691     12  ER-2848                 PIC X(4)  VALUE '2848'.
   692     12  ER-3548                 PIC X(4)  VALUE '3548'.
   693     12  ER-7008                 PIC X(4)  VALUE '7008'.
   694     12  ER-7319                 PIC X(4)  VALUE '7319'.
   695     12  ER-7321                 PIC X(4)  VALUE '7321'.
   696     12  ER-7352                 PIC X(4)  VALUE '7352'.
   697     12  ER-7353                 PIC X(4)  VALUE '7353'.
   698     12  ER-7575                 PIC X(4)  VALUE '7575'.
   699     12  ER-7577                 PIC X(4)  VALUE '7577'.
   700     12  ER-7582                 PIC X(4)  VALUE '7582'.
   701     12  ER-7634                 PIC X(4)  VALUE '7634'.
   702     12  ER-7635                 PIC X(4)  VALUE '7635'.
   703     12  ER-7636                 PIC X(4)  VALUE '7636'.
   704     12  ER-7637                 PIC X(4)  VALUE '7637'.
   705     12  ER-7638                 PIC X(4)  VALUE '7638'.
   706     12  ER-7639                 PIC X(4)  VALUE '7639'.
   707     12  ER-7640                 PIC X(4)  VALUE '7640'.
   708     12  ER-7641                 PIC X(4)  VALUE '7641'.
   709     12  ER-7642                 PIC X(4)  VALUE '7642'.
   710     12  ER-7643                 PIC X(4)  VALUE '7643'.
   711     12  ER-7646                 PIC X(4)  VALUE '7646'.
   712     12  ER-7647                 PIC X(4)  VALUE '7647'.
   713     12  ER-7648                 PIC X(4)  VALUE '7648'.
   714     12  ER-7649                 PIC X(4)  VALUE '7649'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  15
* EL130.cbl
   715     12  ER-7651                 PIC X(4)  VALUE '7651'.
   716     12  ER-7670                 PIC X(4)  VALUE '7670'.
   717     12  ER-7671                 PIC X(4)  VALUE '7671'.
   718     12  ER-7686                 PIC X(4)  VALUE '7686'.
   719     12  ER-7688                 PIC X(4)  VALUE '7688'.
   720     12  ER-7689                 PIC X(4)  VALUE '7689'.
   721     12  ER-7691                 PIC X(4)  VALUE '7691'.
   722*    COPY ERCPDEF.
   723******************************************************************
   724*                                                                *
   725*                                                                *
   726*                            ERCPDEF.                            *
   727*                                                                *
   728*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   729*                                                                *
   730*    FILE TYPE = VSAM,KSDS                                       *
   731*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   732*                                                                *
   733*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   734*                                                                *
   735*    LOG = YES                                                   *
   736*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   737******************************************************************
   738*                   C H A N G E   L O G
   739*
   740* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   741*-----------------------------------------------------------------
   742*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   743* EFFECTIVE    NUMBER
   744*-----------------------------------------------------------------
   745* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   746* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   747* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   748******************************************************************
   749 01  PRODUCT-MASTER.
   750    12  PD-RECORD-ID                 PIC X(02).
   751        88  VALID-PD-ID                  VALUE 'PD'.
   752    12  PD-CONTROL-PRIMARY.
   753        16  PD-COMPANY-CD            PIC X.
   754        16  PD-STATE                 PIC XX.
   755        16  PD-PRODUCT-CD            PIC XXX.
   756        16  PD-FILLER                PIC X(7).
   757        16  PD-BEN-TYPE              PIC X.
   758        16  PD-BEN-CODE              PIC XX.
   759        16  PD-PROD-EXP-DT           PIC XX.
   760    12  FILLER                       PIC X(50).
   761    12  PD-PRODUCT-DATA OCCURS 8.
   762        16  PD-PROD-CODE             PIC X.
   763            88  PD-PROD-LIFE           VALUE 'L'.
   764            88  PD-PROD-PROP           VALUE 'P'.
   765            88  PD-PROD-AH             VALUE 'A'.
   766            88  PD-PROD-IU             VALUE 'I'.
   767            88  PD-PROD-GAP            VALUE 'G'.
   768            88  PD-PROD-FAML           VALUE 'F'.
   769        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   770        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   771        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   772        16  PD-MAX-TERM              PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  16
* EL130.cbl
   773        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   774        16  FILLER                   PIC X.
   775        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   776        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   777        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   778        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   779        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   780        16  PD-REC-CRIT-PERIOD       PIC 99.
   781        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   782            20  PD-RECURRING-YN      PIC X.
   783            20  FILLER               PIC X.
   784        16  PD-RTW-MOS               PIC 99.
   785        16  PD-MAX-EXTENSION         PIC 99.
   786        16  pd-ben-pct               pic sv999 comp-3.
   787*       16  FILLER                   PIC XX.
   788    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   789    12  PD-TERM-LIMITS OCCURS 15.
   790        16  PD-LOW-TERM              PIC S999        COMP-3.
   791        16  PD-HI-TERM               PIC S999        COMP-3.
   792*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   793    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   794        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   795        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   796    12  PD-EARN-FACTORS.
   797        16  FILLER OCCURS 15.
   798            20  FILLER OCCURS 15.
   799                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   800    12  PD-PRODUCT-DESC              PIC X(80).
   801    12  PD-TRUNCATED                 PIC X.
   802    12  FILLER                       PIC X(59).
   803    12  PD-MAINT-INFORMATION.
   804        16  PD-LAST-MAINT-DT         PIC X(02).
   805        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   806        16  PD-LAST-MAINT-BY         PIC X(04).
   807*    COPY ELCLNKLT.
   808******************************************************************
   809*                                                                *
   810*                                                                *
   811*                           ELCLNKLT                             *
   812*                            VMOD=2.003                          *
   813*                                                                *
   814*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   815*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   816*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   817*                                                                *
   818*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   819*   COMPLETING THE REQUIRED FIELDS.                              *
   820*                                                                *
   821*   THE CALLING PROGRAM SHOULD CHECK:                            *
   822*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   823*                              9999 INDICATES AN UNKNOWN ABEND   *
   824*                                   WAS DETECTED.                *
   825*                              ALL OTHER VALUES ARE NORMAL ERROR *
   826*                              CODES FOUND IN THE ERROR FILE.    *
   827******************************************************************
   828 01  W-1523-LINKDATA.
   829     12  W-1523-COMMON-PI-DATA.
   830         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  17
* EL130.cbl
   831         16  FILLER              PIC  X(67).
   832         16  W-1523-COMPANY-CD   PIC  X(01).
   833         16  FILLER              PIC  X(10).
   834         16  W-1523-CONTROL-IN-PROGRESS.
   835             20  W-1523-CARRIER  PIC  X(01).
   836             20  W-1523-GROUPING PIC  X(06).
   837             20  W-1523-STATE    PIC  X(02).
   838             20  W-1523-ACCOUNT  PIC  X(10).
   839             20  W-1523-CLAIM-CERT-GRP.
   840                 24  W-1523-CLAIM-NO
   841                                 PIC  X(07).
   842                 24  W-1523-CERT-NO.
   843                     28  W-1523-CERT-PRIME
   844                                 PIC  X(10).
   845                     28  W-1523-CERT-SFX
   846                                 PIC  X(01).
   847                 24  W-1523-CERT-EFF-DT
   848                                 PIC  X(02).
   849         16  FILLER              PIC X(265).
   850
   851     12  W-1523-WORK-AREA.
   852         16  W-1523-FORM-NUMBER  PIC  X(04).
   853         16  W-1523-NUMBER-COPIES
   854                                 PIC  9(01).
   855         16  W-1523-ADDR-TYPE    PIC  X(02).
   856         16  W-1523-FOLLOW-UP-DATE
   857                                 PIC  X(02).
   858         16  W-1523-RESEND-DATE  PIC  X(02).
   859         16  W-1523-ERROR-CODE   PIC  9(04).
   860             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   861             88  W-1523-FATAL-ERROR
   862                                    VALUES  0006 0013 0042
   863                                            0154 0168 0169
   864                                            0176 9999 0172
   865                                            0179 0186 0281
   866                                            0332 2055 3697
   867                                            3698 3699 3770
   868                                            3771 3772 7675
   869                                            9106 9808 9883
   870                                            9887.
   871             88  W-1523-STOP-ERRORS
   872                                    VALUES  0013 0042 0154
   873                                            0168 0169 0172
   874                                            0281 0332 2055
   875                                            3698 3699 7675
   876                                            9106 9808 9883
   877                                            9999.
   878         16  W-1523-REASON       PIC  X(70).
   879         16  W-1523-ARCHIVE-NUMBER
   880                                 PIC  9(08).
   881     12  W-1523-POINTER-AREA.
   882         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   883         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   884         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   885         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   886         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  18
* EL130.cbl
   888*    COPY ELCINTF.
   889******************************************************************
   890*                                                                *
   891*                                                                *
   892*                            ELCINTF.                            *
   893*                            VMOD=2.017                          *
   894*                                                                *
   895*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   896*                                                                *
   897*       LENGTH = 1024                                            *
   898*                                                                *
   899******************************************************************
   900*                   C H A N G E   L O G
   901*
   902* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   903*-----------------------------------------------------------------
   904*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   905* EFFECTIVE    NUMBER
   906*-----------------------------------------------------------------
   907* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   908******************************************************************
   909 01  PROGRAM-INTERFACE-BLOCK.
   910     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   911     12  PI-CALLING-PROGRAM              PIC X(8).
   912     12  PI-SAVED-PROGRAM-1              PIC X(8).
   913     12  PI-SAVED-PROGRAM-2              PIC X(8).
   914     12  PI-SAVED-PROGRAM-3              PIC X(8).
   915     12  PI-SAVED-PROGRAM-4              PIC X(8).
   916     12  PI-SAVED-PROGRAM-5              PIC X(8).
   917     12  PI-SAVED-PROGRAM-6              PIC X(8).
   918     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   919     12  PI-COMPANY-ID                   PIC XXX.
   920     12  PI-COMPANY-CD                   PIC X.
   921
   922     12  PI-COMPANY-PASSWORD             PIC X(8).
   923
   924     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   925
   926     12  PI-CONTROL-IN-PROGRESS.
   927         16  PI-CARRIER                  PIC X.
   928         16  PI-GROUPING                 PIC X(6).
   929         16  PI-STATE                    PIC XX.
   930         16  PI-ACCOUNT                  PIC X(10).
   931         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   932                                         PIC X(10).
   933         16  PI-CLAIM-CERT-GRP.
   934             20  PI-CLAIM-NO             PIC X(7).
   935             20  PI-CERT-NO.
   936                 25  PI-CERT-PRIME       PIC X(10).
   937                 25  PI-CERT-SFX         PIC X.
   938             20  PI-CERT-EFF-DT          PIC XX.
   939         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   940             20  PI-PLAN-CODE            PIC X(2).
   941             20  PI-REVISION-NUMBER      PIC X(3).
   942             20  PI-PLAN-EFF-DT          PIC X(2).
   943             20  PI-PLAN-EXP-DT          PIC X(2).
   944             20  FILLER                  PIC X(11).
   945         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  19
* EL130.cbl
   946             20  PI-OE-REFERENCE-1.
   947                 25  PI-OE-REF-1-PRIME   PIC X(18).
   948                 25  PI-OE-REF-1-SUFF    PIC XX.
   949
   950     12  PI-SESSION-IN-PROGRESS          PIC X.
   951         88  CLAIM-SESSION                   VALUE '1'.
   952         88  CREDIT-SESSION                  VALUE '2'.
   953         88  WARRANTY-SESSION                VALUE '3'.
   954         88  MORTGAGE-SESSION                VALUE '4'.
   955         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   956
   957
   958*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   959
   960     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   961     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   962
   963     12  PI-CREDIT-USER                  PIC X.
   964         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   965         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   966
   967     12  PI-CLAIM-USER                   PIC X.
   968         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   969         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   970
   971     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   972         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   973         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   974         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   975         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   976         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   977
   978     12  PI-PROCESSOR-ID                 PIC X(4).
   979
   980     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   981
   982     12  PI-MEMBER-CAPTION               PIC X(10).
   983
   984     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   985         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   986
   987     12  PI-LIFE-OVERRIDE-L1             PIC X.
   988     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   989     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   990     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   991
   992     12  PI-AH-OVERRIDE-L1               PIC X.
   993     12  PI-AH-OVERRIDE-L2               PIC XX.
   994     12  PI-AH-OVERRIDE-L6               PIC X(6).
   995     12  PI-AH-OVERRIDE-L12              PIC X(12).
   996
   997     12  PI-NEW-SYSTEM                   PIC X(2).
   998
   999     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1000     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1001         88  PI-USES-PAID-TO                 VALUE '1'.
  1002     12  PI-CRDTCRD-SYSTEM.
  1003         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  20
* EL130.cbl
  1004             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1005             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1006         16  PI-CC-MONTH-END-DT          PIC XX.
  1007     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1008
  1009     12  PI-OE-REFERENCE-2.
  1010         16  PI-OE-REF-2-PRIME           PIC X(10).
  1011         16  PI-OE-REF-2-SUFF            PIC X.
  1012
  1013     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1014
  1015     12  PI-LANGUAGE-TYPE                PIC X.
  1016             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1017             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1018             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1019
  1020     12  PI-POLICY-LINKAGE-IND           PIC X.
  1021         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1022         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1023                                                   LOW-VALUES.
  1024
  1025     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1026     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1027         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1028         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1029
  1030     12  PI-PROCESSOR-CSR-IND            PIC X.
  1031         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1032         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1033
  1034     12  FILLER                          PIC X(3).
  1035
  1036     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1037
  1038     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1039         PI-SYSTEM-LEVEL.
  1040
  1041         16  PI-ENTRY-CODES.
  1042             20  PI-ENTRY-CD-1           PIC X.
  1043             20  PI-ENTRY-CD-2           PIC X.
  1044
  1045         16  PI-RETURN-CODES.
  1046             20  PI-RETURN-CD-1          PIC X.
  1047             20  PI-RETURN-CD-2          PIC X.
  1048
  1049         16  PI-UPDATE-STATUS-SAVE.
  1050             20  PI-UPDATE-BY            PIC X(4).
  1051             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1052
  1053         16  PI-LOWER-CASE-LETTERS       PIC X.
  1054             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1055
  1056*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1057*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1058*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1059
  1060         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1061             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  21
* EL130.cbl
  1062             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1063             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1064             88  ACCNT-CNTL                  VALUE '3'.
  1065             88  CARR-ACCNT-CNTL             VALUE '4'.
  1066
  1067         16  PI-PROCESSOR-CAP-LIST.
  1068             20  PI-SYSTEM-CONTROLS.
  1069                24 PI-SYSTEM-DISPLAY     PIC X.
  1070                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1071                24 PI-SYSTEM-MODIFY      PIC X.
  1072                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1073             20  FILLER                  PIC XX.
  1074             20  PI-DISPLAY-CAP          PIC X.
  1075                 88  DISPLAY-CAP             VALUE 'Y'.
  1076             20  PI-MODIFY-CAP           PIC X.
  1077                 88  MODIFY-CAP              VALUE 'Y'.
  1078             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1079                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1080             20  PI-FORCE-CAP            PIC X.
  1081                 88  FORCE-CAP               VALUE 'Y'.
  1082
  1083         16  PI-PROGRAM-CONTROLS.
  1084             20  PI-PGM-PRINT-OPT        PIC X.
  1085             20  PI-PGM-FORMAT-OPT       PIC X.
  1086             20  PI-PGM-PROCESS-OPT      PIC X.
  1087             20  PI-PGM-TOTALS-OPT       PIC X.
  1088
  1089         16  PI-HELP-INTERFACE.
  1090             20  PI-LAST-ERROR-NO        PIC X(4).
  1091             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1092
  1093         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1094             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1095
  1096         16  PI-CR-CONTROL-IN-PROGRESS.
  1097             20  PI-CR-CARRIER           PIC X.
  1098             20  PI-CR-GROUPING          PIC X(6).
  1099             20  PI-CR-STATE             PIC XX.
  1100             20  PI-CR-ACCOUNT           PIC X(10).
  1101             20  PI-CR-FIN-RESP          PIC X(10).
  1102             20  PI-CR-TYPE              PIC X.
  1103
  1104         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1105
  1106         16  PI-CR-MONTH-END-DT          PIC XX.
  1107
  1108         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1109             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1110             88  PI-ZERO-CARRIER             VALUE '1'.
  1111             88  PI-ZERO-GROUPING            VALUE '2'.
  1112             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1113
  1114         16  PI-CARRIER-SECURITY         PIC X.
  1115             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1116
  1117         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1118             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1119             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  22
* EL130.cbl
  1120
  1121         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1122             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1123                                         INDEXED BY PI-ACCESS-NDX
  1124                                         PIC X.
  1125
  1126         16  PI-GA-BILLING-CONTROL       PIC X.
  1127             88  PI-GA-BILLING               VALUE '1'.
  1128
  1129         16  PI-MAIL-PROCESSING          PIC X.
  1130             88  PI-MAIL-YES                 VALUE 'Y'.
  1131
  1132         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1133
  1134         16  PI-AR-SYSTEM.
  1135             20  PI-AR-PROCESSING-CNTL   PIC X.
  1136                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1137             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1138             20  PI-AR-MONTH-END-DT      PIC XX.
  1139
  1140         16  PI-MP-SYSTEM.
  1141             20  PI-MORTGAGE-USER            PIC X.
  1142                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1143                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1144             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1145                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1146                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1147                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1148                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1149                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1150             20  PI-MP-MONTH-END-DT          PIC XX.
  1151             20  PI-MP-REFERENCE-NO.
  1152                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1153                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1154
  1155         16  PI-LABEL-CONTROL            PIC X(01).
  1156             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1157             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1158
  1159         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1160             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1161
  1162         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1163             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1164             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1165
  1166         16  FILLER                      PIC X(14).
  1167
  1168     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1169******************************************************************
  1170     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1171         16  PI-MSTR-DT               PIC XX.
  1172         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1173         16  PI-TRLR-DT               PIC XX.
  1174         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1175         16  PI-LAST-CLAIM            PIC X(7).
  1176         16  PI-LAST-CARR             PIC X.
  1177         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  23
* EL130.cbl
  1178             20  PI-LAST-CERT-PRIME   PIC X(10).
  1179             20  PI-LAST-CERT-SUFX    PIC X.
  1180         16  PI-LAST-CLAIM-TYPE       PIC X.
  1181         16  PI-CURSOR                PIC S9(4)   COMP.
  1182         16  PI-SAVE-CERT.
  1183             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1184             20  PI-SAVE-CERT-SUFX    PIC X.
  1185         16  PI-SAVE-EFFDT            PIC X(2).
  1186         16  PI-SAVE-ACCOUNT          PIC X(10).
  1187         16  PI-INCURR-SW             PIC X.
  1188         16  PI-PRT-OPT               PIC X.
  1189         16  PI-ALT-PRT               PIC X(4).
  1190         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1191             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1192         16  FILLER                   PIC X(272).
  1193         16  PI-EL127-TO-EL130-CNTRL.
  1194             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1195             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1196             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1197                 24  PI-EL127-CARRIER        PIC X.
  1198                 24  PI-EL127-GROUPING       PIC X(6).
  1199                 24  PI-EL127-STATE          PIC X(2).
  1200                 24  PI-EL127-ACCOUNT        PIC X(10).
  1201                 24  PI-EL127-CERT-NO.
  1202                     28  PI-EL127-CERT-PRIME PIC X(10).
  1203                     28  PI-EL127-CERT-SUFX  PIC X.
  1204                 24  PI-EL127-EFF-DT         PIC XX.
  1205*        16  FILLER                          PIC X(50).
  1206         16  FILLER                          PIC X(31).
  1207         16  PI-EL659-TO-EL130-CNTRL.
  1208             20  PI-EL659-CARRIER            PIC X.
  1209             20  PI-EL659-GROUPING           PIC X(6).
  1210             20  PI-EL659-STATE              PIC XX.
  1211             20  PI-EL659-ACCOUNT            PIC X(10).
  1212
  1213         16  FILLER                          PIC X(19).
  1214
  1215         16  PI-SAVE-INCUR-DT                PIC X(02).
  1216         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1217*         16  FILLER                          PIC X(65).
  1218         16  PI-ST-VFY-2ND-BENE              PIC X.
  1219         16  PI-ST-CAUSAL-STATE              PIC X.
  1220         16  pi-dcc-max-benefits             pic s999 comp-3.
  1221         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1222         16  pi-emi-sub                      pic 99.
  1223         16  FILLER                          PIC X(53).
  1224
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  24
* EL130.cbl
  1226*    COPY EL130S.
  1227 01  EL130AI.
  1228     05  FILLER            PIC  X(0012).
  1229*    -------------------------------
  1230     05  RUNDTEL PIC S9(0004) COMP.
  1231     05  RUNDTEF PIC  X(0001).
  1232     05  FILLER REDEFINES RUNDTEF.
  1233         10  RUNDTEA PIC  X(0001).
  1234     05  RUNDTEI PIC  X(0008).
  1235*    -------------------------------
  1236     05  RUNTIMEL PIC S9(0004) COMP.
  1237     05  RUNTIMEF PIC  X(0001).
  1238     05  FILLER REDEFINES RUNTIMEF.
  1239         10  RUNTIMEA PIC  X(0001).
  1240     05  RUNTIMEI PIC  X(0005).
  1241*    -------------------------------
  1242     05  COMPL PIC S9(0004) COMP.
  1243     05  COMPF PIC  X(0001).
  1244     05  FILLER REDEFINES COMPF.
  1245         10  COMPA PIC  X(0001).
  1246     05  COMPI PIC  X(0003).
  1247*    -------------------------------
  1248     05  SEQUL PIC S9(0004) COMP.
  1249     05  SEQUF PIC  X(0001).
  1250     05  FILLER REDEFINES SEQUF.
  1251         10  SEQUA PIC  X(0001).
  1252     05  SEQUI PIC  X(0010).
  1253*    -------------------------------
  1254     05  MAINTL PIC S9(0004) COMP.
  1255     05  MAINTF PIC  X(0001).
  1256     05  FILLER REDEFINES MAINTF.
  1257         10  MAINTA PIC  X(0001).
  1258     05  MAINTI PIC  X(0001).
  1259*    -------------------------------
  1260     05  CLMNOL PIC S9(0004) COMP.
  1261     05  CLMNOF PIC  X(0001).
  1262     05  FILLER REDEFINES CLMNOF.
  1263         10  CLMNOA PIC  X(0001).
  1264     05  CLMNOI PIC  X(0007).
  1265*    -------------------------------
  1266     05  CLMCARRL PIC S9(0004) COMP.
  1267     05  CLMCARRF PIC  X(0001).
  1268     05  FILLER REDEFINES CLMCARRF.
  1269         10  CLMCARRA PIC  X(0001).
  1270     05  CLMCARRI PIC  X(0001).
  1271*    -------------------------------
  1272     05  CLMTYPEL PIC S9(0004) COMP.
  1273     05  CLMTYPEF PIC  X(0001).
  1274     05  FILLER REDEFINES CLMTYPEF.
  1275         10  CLMTYPEA PIC  X(0001).
  1276     05  CLMTYPEI PIC  X(0001).
  1277*    -------------------------------
  1278     05  CERTNOL PIC S9(0004) COMP.
  1279     05  CERTNOF PIC  X(0001).
  1280     05  FILLER REDEFINES CERTNOF.
  1281         10  CERTNOA PIC  X(0001).
  1282     05  CERTNOI PIC  X(0010).
  1283*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  25
* EL130.cbl
  1284     05  SUFXL PIC S9(0004) COMP.
  1285     05  SUFXF PIC  X(0001).
  1286     05  FILLER REDEFINES SUFXF.
  1287         10  SUFXA PIC  X(0001).
  1288     05  SUFXI PIC  X(0001).
  1289*    -------------------------------
  1290     05  PCERTNOL PIC S9(0004) COMP.
  1291     05  PCERTNOF PIC  X(0001).
  1292     05  FILLER REDEFINES PCERTNOF.
  1293         10  PCERTNOA PIC  X(0001).
  1294     05  PCERTNOI PIC  X(0010).
  1295*    -------------------------------
  1296     05  PSUFXL PIC S9(0004) COMP.
  1297     05  PSUFXF PIC  X(0001).
  1298     05  FILLER REDEFINES PSUFXF.
  1299         10  PSUFXA PIC  X(0001).
  1300     05  PSUFXI PIC  X(0001).
  1301*    -------------------------------
  1302     05  INCURL PIC S9(0004) COMP.
  1303     05  INCURF PIC  X(0001).
  1304     05  FILLER REDEFINES INCURF.
  1305         10  INCURA PIC  X(0001).
  1306     05  INCURI PIC  X(0008).
  1307*    -------------------------------
  1308     05  REPORTL PIC S9(0004) COMP.
  1309     05  REPORTF PIC  X(0001).
  1310     05  FILLER REDEFINES REPORTF.
  1311         10  REPORTA PIC  X(0001).
  1312     05  REPORTI PIC  X(0008).
  1313*    -------------------------------
  1314     05  ICD1L PIC S9(0004) COMP.
  1315     05  ICD1F PIC  X(0001).
  1316     05  FILLER REDEFINES ICD1F.
  1317         10  ICD1A PIC  X(0001).
  1318     05  ICD1I PIC  X(0008).
  1319*    -------------------------------
  1320     05  ICD2L PIC S9(0004) COMP.
  1321     05  ICD2F PIC  X(0001).
  1322     05  FILLER REDEFINES ICD2F.
  1323         10  ICD2A PIC  X(0001).
  1324     05  ICD2I PIC  X(0008).
  1325*    -------------------------------
  1326     05  DIAGL PIC S9(0004) COMP.
  1327     05  DIAGF PIC  X(0001).
  1328     05  FILLER REDEFINES DIAGF.
  1329         10  DIAGA PIC  X(0001).
  1330     05  DIAGI PIC  X(0060).
  1331*    -------------------------------
  1332     05  BENECDL PIC S9(0004) COMP.
  1333     05  BENECDF PIC  X(0001).
  1334     05  FILLER REDEFINES BENECDF.
  1335         10  BENECDA PIC  X(0001).
  1336     05  BENECDI PIC  X(0010).
  1337*    -------------------------------
  1338     05  BIRTHDTL PIC S9(0004) COMP.
  1339     05  BIRTHDTF PIC  X(0001).
  1340     05  FILLER REDEFINES BIRTHDTF.
  1341         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  26
* EL130.cbl
  1342     05  BIRTHDTI PIC  X(0008).
  1343*    -------------------------------
  1344     05  SSNL PIC S9(0004) COMP.
  1345     05  SSNF PIC  X(0001).
  1346     05  FILLER REDEFINES SSNF.
  1347         10  SSNA PIC  X(0001).
  1348     05  SSNI PIC  X(0011).
  1349*    -------------------------------
  1350     05  SEXL PIC S9(0004) COMP.
  1351     05  SEXF PIC  X(0001).
  1352     05  FILLER REDEFINES SEXF.
  1353         10  SEXA PIC  X(0001).
  1354     05  SEXI PIC  X(0001).
  1355*    -------------------------------
  1356     05  INSTYPEL PIC S9(0004) COMP.
  1357     05  INSTYPEF PIC  X(0001).
  1358     05  FILLER REDEFINES INSTYPEF.
  1359         10  INSTYPEA PIC  X(0001).
  1360     05  INSTYPEI PIC  X(0001).
  1361*    -------------------------------
  1362     05  LSTNMEL PIC S9(0004) COMP.
  1363     05  LSTNMEF PIC  X(0001).
  1364     05  FILLER REDEFINES LSTNMEF.
  1365         10  LSTNMEA PIC  X(0001).
  1366     05  LSTNMEI PIC  X(0015).
  1367*    -------------------------------
  1368     05  FSTNMEL PIC S9(0004) COMP.
  1369     05  FSTNMEF PIC  X(0001).
  1370     05  FILLER REDEFINES FSTNMEF.
  1371         10  FSTNMEA PIC  X(0001).
  1372     05  FSTNMEI PIC  X(0012).
  1373*    -------------------------------
  1374     05  INITL PIC S9(0004) COMP.
  1375     05  INITF PIC  X(0001).
  1376     05  FILLER REDEFINES INITF.
  1377         10  INITA PIC  X(0001).
  1378     05  INITI PIC  X(0001).
  1379*    -------------------------------
  1380     05  LOANNOL PIC S9(0004) COMP.
  1381     05  LOANNOF PIC  X(0001).
  1382     05  FILLER REDEFINES LOANNOF.
  1383         10  LOANNOA PIC  X(0001).
  1384     05  LOANNOI PIC  X(0008).
  1385*    -------------------------------
  1386     05  CRTLNMEL PIC S9(0004) COMP.
  1387     05  CRTLNMEF PIC  X(0001).
  1388     05  FILLER REDEFINES CRTLNMEF.
  1389         10  CRTLNMEA PIC  X(0001).
  1390     05  CRTLNMEI PIC  X(0015).
  1391*    -------------------------------
  1392     05  CRTFNMEL PIC S9(0004) COMP.
  1393     05  CRTFNMEF PIC  X(0001).
  1394     05  FILLER REDEFINES CRTFNMEF.
  1395         10  CRTFNMEA PIC  X(0001).
  1396     05  CRTFNMEI PIC  X(0012).
  1397*    -------------------------------
  1398     05  CRTINITL PIC S9(0004) COMP.
  1399     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  27
* EL130.cbl
  1400     05  FILLER REDEFINES CRTINITF.
  1401         10  CRTINITA PIC  X(0001).
  1402     05  CRTINITI PIC  X(0001).
  1403*    -------------------------------
  1404     05  LOANBALL PIC S9(0004) COMP.
  1405     05  LOANBALF PIC  X(0001).
  1406     05  FILLER REDEFINES LOANBALF.
  1407         10  LOANBALA PIC  X(0001).
  1408     05  LOANBALI PIC  9(7)V99.
  1409*    -------------------------------
  1410     05  MANRSVL PIC S9(0004) COMP.
  1411     05  MANRSVF PIC  X(0001).
  1412     05  FILLER REDEFINES MANRSVF.
  1413         10  MANRSVA PIC  X(0001).
  1414     05  MANRSVI PIC  9(7)V99.
  1415*    -------------------------------
  1416     05  SUPVL PIC S9(0004) COMP.
  1417     05  SUPVF PIC  X(0001).
  1418     05  FILLER REDEFINES SUPVF.
  1419         10  SUPVA PIC  X(0001).
  1420     05  SUPVI PIC  X(0001).
  1421*    -------------------------------
  1422     05  PRICDL PIC S9(0004) COMP.
  1423     05  PRICDF PIC  X(0001).
  1424     05  FILLER REDEFINES PRICDF.
  1425         10  PRICDA PIC  X(0001).
  1426     05  PRICDI PIC  X(0001).
  1427*    -------------------------------
  1428     05  PRODL PIC S9(0004) COMP.
  1429     05  PRODF PIC  X(0001).
  1430     05  FILLER REDEFINES PRODF.
  1431         10  PRODA PIC  X(0001).
  1432     05  PRODI PIC  X(0008).
  1433*    -------------------------------
  1434     05  PRODCDL PIC S9(0004) COMP.
  1435     05  PRODCDF PIC  X(0001).
  1436     05  FILLER REDEFINES PRODCDF.
  1437         10  PRODCDA PIC  X(0001).
  1438     05  PRODCDI PIC  X(0001).
  1439*    -------------------------------
  1440     05  FILETOL PIC S9(0004) COMP.
  1441     05  FILETOF PIC  X(0001).
  1442     05  FILLER REDEFINES FILETOF.
  1443         10  FILETOA PIC  X(0001).
  1444     05  FILETOI PIC  X(0004).
  1445*    -------------------------------
  1446     05  PROCCDL PIC S9(0004) COMP.
  1447     05  PROCCDF PIC  X(0001).
  1448     05  FILLER REDEFINES PROCCDF.
  1449         10  PROCCDA PIC  X(0001).
  1450     05  PROCCDI PIC  X(0004).
  1451*    -------------------------------
  1452     05  RELCLML PIC S9(0004) COMP.
  1453     05  RELCLMF PIC  X(0001).
  1454     05  FILLER REDEFINES RELCLMF.
  1455         10  RELCLMA PIC  X(0001).
  1456     05  RELCLMI PIC  X(0007).
  1457*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  28
* EL130.cbl
  1458     05  PRTOPTL PIC S9(0004) COMP.
  1459     05  PRTOPTF PIC  X(0001).
  1460     05  FILLER REDEFINES PRTOPTF.
  1461         10  PRTOPTA PIC  X(0001).
  1462     05  PRTOPTI PIC  X(0001).
  1463*    -------------------------------
  1464     05  ALTPRTL PIC S9(0004) COMP.
  1465     05  ALTPRTF PIC  X(0001).
  1466     05  FILLER REDEFINES ALTPRTF.
  1467         10  ALTPRTA PIC  X(0001).
  1468     05  ALTPRTI PIC  X(0004).
  1469*    -------------------------------
  1470     05  CERTMTL PIC S9(0004) COMP.
  1471     05  CERTMTF PIC  X(0001).
  1472     05  FILLER REDEFINES CERTMTF.
  1473         10  CERTMTA PIC  X(0001).
  1474     05  CERTMTI PIC  X(0001).
  1475*    -------------------------------
  1476     05  CRTCARRL PIC S9(0004) COMP.
  1477     05  CRTCARRF PIC  X(0001).
  1478     05  FILLER REDEFINES CRTCARRF.
  1479         10  CRTCARRA PIC  X(0001).
  1480     05  CRTCARRI PIC  X(0001).
  1481*    -------------------------------
  1482     05  GROUPL PIC S9(0004) COMP.
  1483     05  GROUPF PIC  X(0001).
  1484     05  FILLER REDEFINES GROUPF.
  1485         10  GROUPA PIC  X(0001).
  1486     05  GROUPI PIC  X(0006).
  1487*    -------------------------------
  1488     05  STATEL PIC S9(0004) COMP.
  1489     05  STATEF PIC  X(0001).
  1490     05  FILLER REDEFINES STATEF.
  1491         10  STATEA PIC  X(0001).
  1492     05  STATEI PIC  X(0002).
  1493*    -------------------------------
  1494     05  ACCOUNTL PIC S9(0004) COMP.
  1495     05  ACCOUNTF PIC  X(0001).
  1496     05  FILLER REDEFINES ACCOUNTF.
  1497         10  ACCOUNTA PIC  X(0001).
  1498     05  ACCOUNTI PIC  X(0010).
  1499*    -------------------------------
  1500     05  EFFDTL PIC S9(0004) COMP.
  1501     05  EFFDTF PIC  X(0001).
  1502     05  FILLER REDEFINES EFFDTF.
  1503         10  EFFDTA PIC  X(0001).
  1504     05  EFFDTI PIC  X(0008).
  1505*    -------------------------------
  1506     05  CRTSSNL PIC S9(0004) COMP.
  1507     05  CRTSSNF PIC  X(0001).
  1508     05  FILLER REDEFINES CRTSSNF.
  1509         10  CRTSSNA PIC  X(0001).
  1510     05  CRTSSNI PIC  X(0011).
  1511*    -------------------------------
  1512     05  MEMCAPL PIC S9(0004) COMP.
  1513     05  MEMCAPF PIC  X(0001).
  1514     05  FILLER REDEFINES MEMCAPF.
  1515         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  29
* EL130.cbl
  1516     05  MEMCAPI PIC  X(0010).
  1517*    -------------------------------
  1518     05  MEMBERL PIC S9(0004) COMP.
  1519     05  MEMBERF PIC  X(0001).
  1520     05  FILLER REDEFINES MEMBERF.
  1521         10  MEMBERA PIC  X(0001).
  1522     05  MEMBERI PIC  X(0012).
  1523*    -------------------------------
  1524     05  REINCDL PIC S9(0004) COMP.
  1525     05  REINCDF PIC  X(0001).
  1526     05  FILLER REDEFINES REINCDF.
  1527         10  REINCDA PIC  X(0001).
  1528     05  REINCDI PIC  X(0001).
  1529*    -------------------------------
  1530     05  ISSAGEL PIC S9(0004) COMP.
  1531     05  ISSAGEF PIC  X(0001).
  1532     05  FILLER REDEFINES ISSAGEF.
  1533         10  ISSAGEA PIC  X(0001).
  1534     05  ISSAGEI PIC  X(0002).
  1535*    -------------------------------
  1536     05  APRL PIC S9(0004) COMP.
  1537     05  APRF PIC  X(0001).
  1538     05  FILLER REDEFINES APRF.
  1539         10  APRA PIC  X(0001).
  1540     05  APRI PIC  9(4)V9(4).
  1541*    -------------------------------
  1542     05  PMTFREQL PIC S9(0004) COMP.
  1543     05  PMTFREQF PIC  X(0001).
  1544     05  FILLER REDEFINES PMTFREQF.
  1545         10  PMTFREQA PIC  X(0001).
  1546     05  PMTFREQI PIC  99.
  1547*    -------------------------------
  1548     05  INDGRPL PIC S9(0004) COMP.
  1549     05  INDGRPF PIC  X(0001).
  1550     05  FILLER REDEFINES INDGRPF.
  1551         10  INDGRPA PIC  X(0001).
  1552     05  INDGRPI PIC  X(0001).
  1553*    -------------------------------
  1554     05  PREMTYPL PIC S9(0004) COMP.
  1555     05  PREMTYPF PIC  X(0001).
  1556     05  FILLER REDEFINES PREMTYPF.
  1557         10  PREMTYPA PIC  X(0001).
  1558     05  PREMTYPI PIC  X(0001).
  1559*    -------------------------------
  1560     05  ADDONDTL PIC S9(0004) COMP.
  1561     05  ADDONDTF PIC  X(0001).
  1562     05  FILLER REDEFINES ADDONDTF.
  1563         10  ADDONDTA PIC  X(0001).
  1564     05  ADDONDTI PIC  X(0008).
  1565*    -------------------------------
  1566     05  JNTLNMEL PIC S9(0004) COMP.
  1567     05  JNTLNMEF PIC  X(0001).
  1568     05  FILLER REDEFINES JNTLNMEF.
  1569         10  JNTLNMEA PIC  X(0001).
  1570     05  JNTLNMEI PIC  X(0015).
  1571*    -------------------------------
  1572     05  JNTFNMEL PIC S9(0004) COMP.
  1573     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  30
* EL130.cbl
  1574     05  FILLER REDEFINES JNTFNMEF.
  1575         10  JNTFNMEA PIC  X(0001).
  1576     05  JNTFNMEI PIC  X(0002).
  1577*    -------------------------------
  1578     05  JNTINITL PIC S9(0004) COMP.
  1579     05  JNTINITF PIC  X(0001).
  1580     05  FILLER REDEFINES JNTINITF.
  1581         10  JNTINITA PIC  X(0001).
  1582     05  JNTINITI PIC  X(0001).
  1583*    -------------------------------
  1584     05  JNTAGEL PIC S9(0004) COMP.
  1585     05  JNTAGEF PIC  X(0001).
  1586     05  FILLER REDEFINES JNTAGEF.
  1587         10  JNTAGEA PIC  X(0001).
  1588     05  JNTAGEI PIC  X(0002).
  1589*    -------------------------------
  1590     05  LCVDSCRL PIC S9(0004) COMP.
  1591     05  LCVDSCRF PIC  X(0001).
  1592     05  FILLER REDEFINES LCVDSCRF.
  1593         10  LCVDSCRA PIC  X(0001).
  1594     05  LCVDSCRI PIC  X(0006).
  1595*    -------------------------------
  1596     05  LCVKINDL PIC S9(0004) COMP.
  1597     05  LCVKINDF PIC  X(0001).
  1598     05  FILLER REDEFINES LCVKINDF.
  1599         10  LCVKINDA PIC  X(0001).
  1600     05  LCVKINDI PIC  X(0003).
  1601*    -------------------------------
  1602     05  LCVCDL PIC S9(0004) COMP.
  1603     05  LCVCDF PIC  X(0001).
  1604     05  FILLER REDEFINES LCVCDF.
  1605         10  LCVCDA PIC  X(0001).
  1606     05  LCVCDI PIC  X(0002).
  1607*    -------------------------------
  1608     05  LCVOTRML PIC S9(0004) COMP.
  1609     05  LCVOTRMF PIC  X(0001).
  1610     05  FILLER REDEFINES LCVOTRMF.
  1611         10  LCVOTRMA PIC  X(0001).
  1612     05  LCVOTRMI PIC  999.
  1613*    -------------------------------
  1614     05  LCVRTRML PIC S9(0004) COMP.
  1615     05  LCVRTRMF PIC  X(0001).
  1616     05  FILLER REDEFINES LCVRTRMF.
  1617         10  LCVRTRMA PIC  X(0001).
  1618     05  LCVRTRMI PIC  X(0003).
  1619*    -------------------------------
  1620     05  LCVRATEL PIC S9(0004) COMP.
  1621     05  LCVRATEF PIC  X(0001).
  1622     05  FILLER REDEFINES LCVRATEF.
  1623         10  LCVRATEA PIC  X(0001).
  1624     05  LCVRATEI PIC  9999V99.
  1625*    -------------------------------
  1626     05  LCVBENEL PIC S9(0004) COMP.
  1627     05  LCVBENEF PIC  X(0001).
  1628     05  FILLER REDEFINES LCVBENEF.
  1629         10  LCVBENEA PIC  X(0001).
  1630     05  LCVBENEI PIC  9(9)V99.
  1631*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  31
* EL130.cbl
  1632     05  LCVFORML PIC S9(0004) COMP.
  1633     05  LCVFORMF PIC  X(0001).
  1634     05  FILLER REDEFINES LCVFORMF.
  1635         10  LCVFORMA PIC  X(0001).
  1636     05  LCVFORMI PIC  X(0012).
  1637*    -------------------------------
  1638     05  LCVCNDTL PIC S9(0004) COMP.
  1639     05  LCVCNDTF PIC  X(0001).
  1640     05  FILLER REDEFINES LCVCNDTF.
  1641         10  LCVCNDTA PIC  X(0001).
  1642     05  LCVCNDTI PIC  X(0008).
  1643*    -------------------------------
  1644     05  LCVEXITL PIC S9(0004) COMP.
  1645     05  LCVEXITF PIC  X(0001).
  1646     05  FILLER REDEFINES LCVEXITF.
  1647         10  LCVEXITA PIC  X(0001).
  1648     05  LCVEXITI PIC  X(0008).
  1649*    -------------------------------
  1650     05  LCVSTATL PIC S9(0004) COMP.
  1651     05  LCVSTATF PIC  X(0001).
  1652     05  FILLER REDEFINES LCVSTATF.
  1653         10  LCVSTATA PIC  X(0001).
  1654     05  LCVSTATI PIC  X(0006).
  1655*    -------------------------------
  1656     05  ACVDSCRL PIC S9(0004) COMP.
  1657     05  ACVDSCRF PIC  X(0001).
  1658     05  FILLER REDEFINES ACVDSCRF.
  1659         10  ACVDSCRA PIC  X(0001).
  1660     05  ACVDSCRI PIC  X(0006).
  1661*    -------------------------------
  1662     05  ACVKINDL PIC S9(0004) COMP.
  1663     05  ACVKINDF PIC  X(0001).
  1664     05  FILLER REDEFINES ACVKINDF.
  1665         10  ACVKINDA PIC  X(0001).
  1666     05  ACVKINDI PIC  X(0003).
  1667*    -------------------------------
  1668     05  ACVCDL PIC S9(0004) COMP.
  1669     05  ACVCDF PIC  X(0001).
  1670     05  FILLER REDEFINES ACVCDF.
  1671         10  ACVCDA PIC  X(0001).
  1672     05  ACVCDI PIC  X(0002).
  1673*    -------------------------------
  1674     05  ACVOTRML PIC S9(0004) COMP.
  1675     05  ACVOTRMF PIC  X(0001).
  1676     05  FILLER REDEFINES ACVOTRMF.
  1677         10  ACVOTRMA PIC  X(0001).
  1678     05  ACVOTRMI PIC  999.
  1679*    -------------------------------
  1680     05  ACVRTRML PIC S9(0004) COMP.
  1681     05  ACVRTRMF PIC  X(0001).
  1682     05  FILLER REDEFINES ACVRTRMF.
  1683         10  ACVRTRMA PIC  X(0001).
  1684     05  ACVRTRMI PIC  X(0003).
  1685*    -------------------------------
  1686     05  ACVRATEL PIC S9(0004) COMP.
  1687     05  ACVRATEF PIC  X(0001).
  1688     05  FILLER REDEFINES ACVRATEF.
  1689         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  32
* EL130.cbl
  1690     05  ACVRATEI PIC  9999V99.
  1691*    -------------------------------
  1692     05  ACVBENEL PIC S9(0004) COMP.
  1693     05  ACVBENEF PIC  X(0001).
  1694     05  FILLER REDEFINES ACVBENEF.
  1695         10  ACVBENEA PIC  X(0001).
  1696     05  ACVBENEI PIC  9(9)V99.
  1697*    -------------------------------
  1698     05  ACVFORML PIC S9(0004) COMP.
  1699     05  ACVFORMF PIC  X(0001).
  1700     05  FILLER REDEFINES ACVFORMF.
  1701         10  ACVFORMA PIC  X(0001).
  1702     05  ACVFORMI PIC  X(0012).
  1703*    -------------------------------
  1704     05  ACVCNDTL PIC S9(0004) COMP.
  1705     05  ACVCNDTF PIC  X(0001).
  1706     05  FILLER REDEFINES ACVCNDTF.
  1707         10  ACVCNDTA PIC  X(0001).
  1708     05  ACVCNDTI PIC  X(0008).
  1709*    -------------------------------
  1710     05  ACVEXITL PIC S9(0004) COMP.
  1711     05  ACVEXITF PIC  X(0001).
  1712     05  FILLER REDEFINES ACVEXITF.
  1713         10  ACVEXITA PIC  X(0001).
  1714     05  ACVEXITI PIC  X(0008).
  1715*    -------------------------------
  1716     05  ACVSTATL PIC S9(0004) COMP.
  1717     05  ACVSTATF PIC  X(0001).
  1718     05  FILLER REDEFINES ACVSTATF.
  1719         10  ACVSTATA PIC  X(0001).
  1720     05  ACVSTATI PIC  X(0006).
  1721*    -------------------------------
  1722     05  ERRMSG1L PIC S9(0004) COMP.
  1723     05  ERRMSG1F PIC  X(0001).
  1724     05  FILLER REDEFINES ERRMSG1F.
  1725         10  ERRMSG1A PIC  X(0001).
  1726     05  ERRMSG1I PIC  X(0072).
  1727*    -------------------------------
  1728     05  ERRMSG2L PIC S9(0004) COMP.
  1729     05  ERRMSG2F PIC  X(0001).
  1730     05  FILLER REDEFINES ERRMSG2F.
  1731         10  ERRMSG2A PIC  X(0001).
  1732     05  ERRMSG2I PIC  X(0072).
  1733*    -------------------------------
  1734     05  BCERT1L PIC S9(0004) COMP.
  1735     05  BCERT1F PIC  X(0001).
  1736     05  FILLER REDEFINES BCERT1F.
  1737         10  BCERT1A PIC  X(0001).
  1738     05  BCERT1I PIC  X(0010).
  1739*    -------------------------------
  1740     05  BSUFX1L PIC S9(0004) COMP.
  1741     05  BSUFX1F PIC  X(0001).
  1742     05  FILLER REDEFINES BSUFX1F.
  1743         10  BSUFX1A PIC  X(0001).
  1744     05  BSUFX1I PIC  X(0001).
  1745*    -------------------------------
  1746     05  BCERT2L PIC S9(0004) COMP.
  1747     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  33
* EL130.cbl
  1748     05  FILLER REDEFINES BCERT2F.
  1749         10  BCERT2A PIC  X(0001).
  1750     05  BCERT2I PIC  X(0010).
  1751*    -------------------------------
  1752     05  BSUFX2L PIC S9(0004) COMP.
  1753     05  BSUFX2F PIC  X(0001).
  1754     05  FILLER REDEFINES BSUFX2F.
  1755         10  BSUFX2A PIC  X(0001).
  1756     05  BSUFX2I PIC  X(0001).
  1757*    -------------------------------
  1758     05  BCERT3L PIC S9(0004) COMP.
  1759     05  BCERT3F PIC  X(0001).
  1760     05  FILLER REDEFINES BCERT3F.
  1761         10  BCERT3A PIC  X(0001).
  1762     05  BCERT3I PIC  X(0010).
  1763*    -------------------------------
  1764     05  BSUFX3L PIC S9(0004) COMP.
  1765     05  BSUFX3F PIC  X(0001).
  1766     05  FILLER REDEFINES BSUFX3F.
  1767         10  BSUFX3A PIC  X(0001).
  1768     05  BSUFX3I PIC  X(0001).
  1769*    -------------------------------
  1770     05  BCERT4L PIC S9(0004) COMP.
  1771     05  BCERT4F PIC  X(0001).
  1772     05  FILLER REDEFINES BCERT4F.
  1773         10  BCERT4A PIC  X(0001).
  1774     05  BCERT4I PIC  X(0010).
  1775*    -------------------------------
  1776     05  BSUFX4L PIC S9(0004) COMP.
  1777     05  BSUFX4F PIC  X(0001).
  1778     05  FILLER REDEFINES BSUFX4F.
  1779         10  BSUFX4A PIC  X(0001).
  1780     05  BSUFX4I PIC  X(0001).
  1781*    -------------------------------
  1782     05  BCERT5L PIC S9(0004) COMP.
  1783     05  BCERT5F PIC  X(0001).
  1784     05  FILLER REDEFINES BCERT5F.
  1785         10  BCERT5A PIC  X(0001).
  1786     05  BCERT5I PIC  X(0010).
  1787*    -------------------------------
  1788     05  BSUFX5L PIC S9(0004) COMP.
  1789     05  BSUFX5F PIC  X(0001).
  1790     05  FILLER REDEFINES BSUFX5F.
  1791         10  BSUFX5A PIC  X(0001).
  1792     05  BSUFX5I PIC  X(0001).
  1793*    -------------------------------
  1794     05  ENTERPFL PIC S9(0004) COMP.
  1795     05  ENTERPFF PIC  X(0001).
  1796     05  FILLER REDEFINES ENTERPFF.
  1797         10  ENTERPFA PIC  X(0001).
  1798     05  ENTERPFI PIC  99.
  1799*    -------------------------------
  1800     05  PF5L PIC S9(0004) COMP.
  1801     05  PF5F PIC  X(0001).
  1802     05  FILLER REDEFINES PF5F.
  1803         10  PF5A PIC  X(0001).
  1804     05  PF5I PIC  X(0013).
  1805 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  34
* EL130.cbl
  1806     05  FILLER            PIC  X(0012).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  RUNDTEO PIC  X(0008).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  RUNTIMEO PIC  99.99.
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  COMPO PIC  X(0003).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  SEQUO PIC  X(0010).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  MAINTO PIC  X(0001).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  CLMNOO PIC  X(0007).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  CLMCARRO PIC  X(0001).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  CLMTYPEO PIC  X(0001).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  CERTNOO PIC  X(0010).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  SUFXO PIC  X(0001).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  PCERTNOO PIC  X(0010).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  PSUFXO PIC  X(0001).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  INCURO PIC  X(0008).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  REPORTO PIC  X(0008).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  ICD1O PIC  X(0008).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  ICD2O PIC  X(0008).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  DIAGO PIC  X(0060).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  BENECDO PIC  X(0010).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  35
* EL130.cbl
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  SSNO PIC  X(0011).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  SEXO PIC  X(0001).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  INSTYPEO PIC  X(0001).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  LSTNMEO PIC  X(0015).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  FSTNMEO PIC  X(0012).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  INITO PIC  X(0001).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  LOANNOO PIC  X(0008).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  CRTLNMEO PIC  X(0015).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  CRTFNMEO PIC  X(0012).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  CRTINITO PIC  X(0001).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  LOANBALO PIC  ZZZZZ9.99.
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  MANRSVO PIC  Z(5)9.99.
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  SUPVO PIC  X(0001).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  PRICDO PIC  X(0001).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  PRODO PIC  X(0008).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  PRODCDO PIC  X(0001).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  FILETOO PIC  X(0004).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  PROCCDO PIC  X(0004).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  RELCLMO PIC  X(0007).
  1921*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  36
* EL130.cbl
  1922     05  FILLER            PIC  X(0003).
  1923     05  PRTOPTO PIC  X(0001).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  ALTPRTO PIC  X(0004).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  CERTMTO PIC  X(0001).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  CRTCARRO PIC  X(0001).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  GROUPO PIC  X(0006).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  STATEO PIC  X(0002).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  ACCOUNTO PIC  X(0010).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  EFFDTO PIC  X(0008).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  CRTSSNO PIC  X(0011).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  MEMCAPO PIC  X(0010).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  MEMBERO PIC  X(0012).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  REINCDO PIC  X(0001).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  ISSAGEO PIC  X(0002).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  APRO PIC  9(3).9(4).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  PMTFREQO PIC  99.
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  INDGRPO PIC  X(0001).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  PREMTYPO PIC  X(0001).
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  ADDONDTO PIC  X(0008).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  JNTLNMEO PIC  X(0015).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  37
* EL130.cbl
  1980     05  JNTFNMEO PIC  X(0002).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  JNTINITO PIC  X(0001).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  JNTAGEO PIC  X(0002).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  LCVDSCRO PIC  X(0006).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  LCVKINDO PIC  X(0003).
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  LCVCDO PIC  X(0002).
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  LCVOTRMO PIC  999.
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  LCVRTRMO PIC  ZZZ.
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  LCVRATEO PIC  ZZZ.ZZ.
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  LCVFORMO PIC  X(0012).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  LCVCNDTO PIC  X(0008).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  LCVEXITO PIC  X(0008).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  LCVSTATO PIC  X(0006).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  ACVDSCRO PIC  X(0006).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  ACVKINDO PIC  X(0003).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  ACVCDO PIC  X(0002).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  ACVOTRMO PIC  999.
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  ACVRTRMO PIC  ZZZ.
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  38
* EL130.cbl
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  ACVFORMO PIC  X(0012).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  ACVCNDTO PIC  X(0008).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  ACVEXITO PIC  X(0008).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  ACVSTATO PIC  X(0006).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  ERRMSG1O PIC  X(0072).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  ERRMSG2O PIC  X(0072).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  BCERT1O PIC  X(0010).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  BSUFX1O PIC  X(0001).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  BCERT2O PIC  X(0010).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  BSUFX2O PIC  X(0001).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  BCERT3O PIC  X(0010).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  BSUFX3O PIC  X(0001).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  BCERT4O PIC  X(0010).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  BSUFX4O PIC  X(0001).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  BCERT5O PIC  X(0010).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  BSUFX5O PIC  X(0001).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  ENTERPFO PIC  X(0002).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  PF5O PIC  X(0013).
  2095*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  39
* EL130.cbl
  2097*    COPY ELCDATE.
  2098******************************************************************
  2099*                                                                *
  2100*                                                                *
  2101*                            ELCDATE.                            *
  2102*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2103*                            VMOD=2.003
  2104*                                                                *
  2105*                                                                *
  2106*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2107*                 LENGTH = 200                                   *
  2108******************************************************************
  2109
  2110 01  DATE-CONVERSION-DATA.
  2111     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2112     12  DC-OPTION-CODE                PIC X.
  2113         88  BIN-TO-GREG                VALUE ' '.
  2114         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2115         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2116         88  YMD-GREG-TO-BIN            VALUE '3'.
  2117         88  MDY-GREG-TO-BIN            VALUE '4'.
  2118         88  JULIAN-TO-BIN              VALUE '5'.
  2119         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2120         88  FIND-CENTURY               VALUE '7'.
  2121         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2122         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2123         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2124         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2125         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2126         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2127         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2128         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2129         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2130         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2131         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2132         88  BIN-3-TO-GREG              VALUE 'I'.
  2133         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2134         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2135         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2136         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2137         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2138         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2139         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2140         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2141         88  THREE-CHARACTER-BIN
  2142                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2143         88  GREGORIAN-TO-BIN
  2144                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2145         88  BIN-TO-GREGORIAN
  2146                  VALUES ' ' '1' 'I' '8' 'G'.
  2147         88  JULIAN-TO-BINARY
  2148                  VALUES '5' 'C' 'E' 'F'.
  2149     12  DC-ERROR-CODE                 PIC X.
  2150         88  NO-CONVERSION-ERROR        VALUE ' '.
  2151         88  DATE-CONVERSION-ERROR
  2152                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2153         88  DATE-IS-ZERO               VALUE '1'.
  2154         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  40
* EL130.cbl
  2155         88  DATE-IS-INVALID            VALUE '3'.
  2156         88  DATE1-GREATER-DATE2        VALUE '4'.
  2157         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2158         88  DATE-INVALID-OPTION        VALUE '9'.
  2159         88  INVALID-CENTURY            VALUE 'A'.
  2160         88  ONLY-CENTURY               VALUE 'B'.
  2161         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2162         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2163     12  DC-END-OF-MONTH               PIC X.
  2164         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2165     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2166         88  USE-NORMAL-PROCESS         VALUE ' '.
  2167         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2168         88  ADJUST-UP-100-YRS          VALUE '2'.
  2169     12  FILLER                        PIC X.
  2170     12  DC-CONVERSION-DATES.
  2171         16  DC-BIN-DATE-1             PIC XX.
  2172         16  DC-BIN-DATE-2             PIC XX.
  2173         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2174         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2175                       DC-GREG-DATE-1-EDIT.
  2176             20  DC-EDIT1-MONTH        PIC 99.
  2177             20  SLASH1-1              PIC X.
  2178             20  DC-EDIT1-DAY          PIC 99.
  2179             20  SLASH1-2              PIC X.
  2180             20  DC-EDIT1-YEAR         PIC 99.
  2181         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2182         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2183                     DC-GREG-DATE-2-EDIT.
  2184             20  DC-EDIT2-MONTH        PIC 99.
  2185             20  SLASH2-1              PIC X.
  2186             20  DC-EDIT2-DAY          PIC 99.
  2187             20  SLASH2-2              PIC X.
  2188             20  DC-EDIT2-YEAR         PIC 99.
  2189         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2190         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2191                     DC-GREG-DATE-1-YMD.
  2192             20  DC-YMD-YEAR           PIC 99.
  2193             20  DC-YMD-MONTH          PIC 99.
  2194             20  DC-YMD-DAY            PIC 99.
  2195         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2196         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2197                      DC-GREG-DATE-1-MDY.
  2198             20  DC-MDY-MONTH          PIC 99.
  2199             20  DC-MDY-DAY            PIC 99.
  2200             20  DC-MDY-YEAR           PIC 99.
  2201         16  DC-GREG-DATE-1-ALPHA.
  2202             20  DC-ALPHA-MONTH        PIC X(10).
  2203             20  DC-ALPHA-DAY          PIC 99.
  2204             20  FILLER                PIC XX.
  2205             20  DC-ALPHA-CENTURY.
  2206                 24 DC-ALPHA-CEN-N     PIC 99.
  2207             20  DC-ALPHA-YEAR         PIC 99.
  2208         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2209         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2210         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2211         16  DC-JULIAN-DATE            PIC 9(05).
  2212         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  41
* EL130.cbl
  2213                                       PIC 9(05).
  2214         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2215             20  DC-JULIAN-YEAR        PIC 99.
  2216             20  DC-JULIAN-DAYS        PIC 999.
  2217         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2218         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2219         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2220     12  DATE-CONVERSION-VARIBLES.
  2221         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2222         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2223             20  FILLER                PIC 9(3).
  2224             20  HOLD-CEN-1-CCYY.
  2225                 24  HOLD-CEN-1-CC     PIC 99.
  2226                 24  HOLD-CEN-1-YY     PIC 99.
  2227             20  HOLD-CEN-1-MO         PIC 99.
  2228             20  HOLD-CEN-1-DA         PIC 99.
  2229         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2230             20  HOLD-CEN-1-R-MO       PIC 99.
  2231             20  HOLD-CEN-1-R-DA       PIC 99.
  2232             20  HOLD-CEN-1-R-CCYY.
  2233                 24  HOLD-CEN-1-R-CC   PIC 99.
  2234                 24  HOLD-CEN-1-R-YY   PIC 99.
  2235             20  FILLER                PIC 9(3).
  2236         16  HOLD-CENTURY-1-X.
  2237             20  FILLER                PIC X(3)  VALUE SPACES.
  2238             20  HOLD-CEN-1-X-CCYY.
  2239                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2240                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2241             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2242             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2243         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2244             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2245             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2246             20  HOLD-CEN-1-R-X-CCYY.
  2247                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2248                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2249             20  FILLER                PIC XXX.
  2250         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2251         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2252         16  DC-JULIAN-DATE-1          PIC 9(07).
  2253         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2254             20  DC-JULIAN-1-CCYY.
  2255                 24  DC-JULIAN-1-CC    PIC 99.
  2256                 24  DC-JULIAN-1-YR    PIC 99.
  2257             20  DC-JULIAN-DA-1        PIC 999.
  2258         16  DC-JULIAN-DATE-2          PIC 9(07).
  2259         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2260             20  DC-JULIAN-2-CCYY.
  2261                 24  DC-JULIAN-2-CC    PIC 99.
  2262                 24  DC-JULIAN-2-YR    PIC 99.
  2263             20  DC-JULIAN-DA-2        PIC 999.
  2264         16  DC-GREG-DATE-A-EDIT.
  2265             20  DC-EDITA-MONTH        PIC 99.
  2266             20  SLASHA-1              PIC X VALUE '/'.
  2267             20  DC-EDITA-DAY          PIC 99.
  2268             20  SLASHA-2              PIC X VALUE '/'.
  2269             20  DC-EDITA-CCYY.
  2270                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  42
* EL130.cbl
  2271                 24  DC-EDITA-YEAR     PIC 99.
  2272         16  DC-GREG-DATE-B-EDIT.
  2273             20  DC-EDITB-MONTH        PIC 99.
  2274             20  SLASHB-1              PIC X VALUE '/'.
  2275             20  DC-EDITB-DAY          PIC 99.
  2276             20  SLASHB-2              PIC X VALUE '/'.
  2277             20  DC-EDITB-CCYY.
  2278                 24  DC-EDITB-CENT     PIC 99.
  2279                 24  DC-EDITB-YEAR     PIC 99.
  2280         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2281         16  DC-GREG-DATE-CYMD-R REDEFINES
  2282                              DC-GREG-DATE-CYMD.
  2283             20  DC-CYMD-CEN           PIC 99.
  2284             20  DC-CYMD-YEAR          PIC 99.
  2285             20  DC-CYMD-MONTH         PIC 99.
  2286             20  DC-CYMD-DAY           PIC 99.
  2287         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2288         16  DC-GREG-DATE-MDCY-R REDEFINES
  2289                              DC-GREG-DATE-MDCY.
  2290             20  DC-MDCY-MONTH         PIC 99.
  2291             20  DC-MDCY-DAY           PIC 99.
  2292             20  DC-MDCY-CEN           PIC 99.
  2293             20  DC-MDCY-YEAR          PIC 99.
  2294    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2295        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2296    12  DC-EL310-DATE                  PIC X(21).
  2297    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  43
* EL130.cbl
  2299*    COPY ELCCALC.
  2300******************************************************************
  2301*                                                                *
  2302*                           ELCCALC.                            *
  2303*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2304*                            VMOD=2.025                          *
  2305*                                                                *
  2306*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2307*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2308*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2309*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2310*                                                                *
  2311*  PASSED TO ELRTRM                                              *
  2312*  -----------------                                             *
  2313*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2314*  ORIGINAL TERM                                                 *
  2315*  BEGINNING DATE                                                *
  2316*  ENDING DATE                                                   *
  2317*  COMPANY I.D.                                                  *
  2318*  ACCOUNT MASTER USER FIELD                                     *
  2319*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2320*  FREE LOOK DAYS                                                *
  2321*                                                                *
  2322*  RETURNED FROM ELRTRM                                          *
  2323*  ---------------------                                         *
  2324*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2325*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2326*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2327*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2328*----------------------------------------------------------------*
  2329*  PASSED TO ELRAMT                                              *
  2330*  ----------------                                              *
  2331*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2332*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2333*  ORIGINAL AMOUNT                                               *
  2334*  ALTERNATE BENEFIT (BALLON)                                    *
  2335*  A.P.R. - NET PAY ONLY                                         *
  2336*  METHOD
  2337*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2338*  COMPANY I.D.                                                  *
  2339*  BENEFIT TYPE                                                  *
  2340*                                                                *
  2341*  RETURNED FROM ELRAMT                                          *
  2342*  --------------------                                          *
  2343*  REMAINING AMOUNT 1 - CURRENT                                  *
  2344*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2345*  REMAINING AMOUNT FACTOR
  2346*----------------------------------------------------------------*
  2347*  PASSED TO ELRESV                                              *
  2348*  -----------------                                             *
  2349*  CERTIFICATE EFFECTIVE DATE                                    *
  2350*  VALUATION DATE                                                *
  2351*  PAID THRU DATE                                                *
  2352*  BENEFIT                                                       *
  2353*  INCURRED DATE                                                 *
  2354*  REPORTED DATE                                                 *
  2355*  ISSUE AGE                                                     *
  2356*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  44
* EL130.cbl
  2357*  CDT PERCENT                                                   *
  2358*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2359* *CLAIM TYPE (LIFE, A/H)                                        *
  2360* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2361* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2362*                                                                *
  2363*  RETURNED FROM ELRESV                                          *
  2364*  --------------------                                          *
  2365*  CDT TABLE USED                                                *
  2366*  CDT FACTOR USED                                               *
  2367*  PAY TO CURRENT RESERVE                                        *
  2368*  I.B.N.R. - A/H ONLY                                           *
  2369*  FUTURE (ACCRUED) AH ONLY                                      *
  2370*----------------------------------------------------------------*
  2371*  PASSED TO ELRATE                                              *
  2372*  ----------------                                              *
  2373*  CERT ISSUE DATE                                               *
  2374*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2375*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2376*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2377*  STATE CODE (CLIENT DEFINED)                                   *
  2378*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2379*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2380*  DEVIATION CODE                                                *
  2381*  ISSUE AGE                                                     *
  2382*  ORIGINAL BENEFIT AMOUNT                                       *
  2383*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2384*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2385*  BENEFIT KIND (LIFE OR A/H)                                    *
  2386*  A.P.R.                                                        *
  2387*  METHOD
  2388*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2389*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2390*  COMPANY I.D. (3 CHARACTER)                                    *
  2391*  BENEFIT CODE                                                  *
  2392*  BENEFIT OVERRIDE CODE                                         *
  2393*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2394*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2395*  JOINT INDICATOR (CSL ONLY)                                    *
  2396*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2397*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2398*                                                                *
  2399*  RETURNED FROM ELRATE                                          *
  2400*  --------------------                                          *
  2401*  CALCULATED PREMIUM                                            *
  2402*  PREMIUM RATE                                                  *
  2403*  MORTALITY CODE                                                *
  2404*  MAX ATTAINED AGE                                              *
  2405*  MAX AGE                                                       *
  2406*  MAX TERM                                                      *
  2407*  MAX MONTHLY BENEFIT                                           *
  2408*  MAX TOTAL BENIFIT                                             *
  2409*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2410*----------------------------------------------------------------*
  2411*  PASSED TO ELRFND                                              *
  2412*  ----------------                                              *
  2413*  CERT ISSUE DATE                                               *
  2414*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  45
* EL130.cbl
  2415*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2416*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2417*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2418*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2419*  STATE CODE (CLIENT DEFINED)                                   *
  2420*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2421*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2422*  DEVIATION CODE                                                *
  2423*  ISSUE AGE                                                     *
  2424*  ORIGINAL BENEFIT AMOUNT                                       *
  2425*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2426*  PROCESS TYPE (CANCEL)                                         *
  2427*  BENEFIT KIND (LIFE OR A/H)                                    *
  2428*  A.P.R.                                                        *
  2429*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2430*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2431*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2432*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2433*  COMPANY I.D. (3 CHARACTER)                                    *
  2434*  BENEFIT CODE                                                  *
  2435*  BENEFIT OVERRIDE CODE                                         *
  2436*                                                                *
  2437*  RETURNED FROM ELRFND                                          *
  2438*  --------------------                                          *
  2439*  CALCULATED REFUND                                             *
  2440*----------------------------------------------------------------*
  2441*  PASSED TO ELEARN                                              *
  2442*  ----------------                                              *
  2443*  CERT ISSUE DATE                                               *
  2444*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2445*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2446*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2447*  STATE CODE (CLIENT DEFINED)                                   *
  2448*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2449*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2450*  DEVIATION CODE                                                *
  2451*  ISSUE AGE                                                     *
  2452*  ORIGINAL BENEFIT AMOUNT                                       *
  2453*  BENEFIT KIND (LIFE OR A/H)                                    *
  2454*  A.P.R.                                                        *
  2455*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2456*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2457*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2458*  COMPANY I.D. (3 CHARACTER)                                    *
  2459*  BENEFIT CODE                                                  *
  2460*  BENEFIT OVERRIDE CODE                                         *
  2461*                                                                *
  2462*  RETURNED FROM ELEARN                                          *
  2463*  --------------------                                          *
  2464*  INDICATED  EARNINGS                                           *
  2465*----------------------------------------------------------------*
  2466*                 LENGTH = 450                                   *
  2467*                                                                *
  2468******************************************************************
  2469******************************************************************
  2470*                   C H A N G E   L O G
  2471*
  2472* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  46
* EL130.cbl
  2473*-----------------------------------------------------------------
  2474*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2475* EFFECTIVE    NUMBER
  2476*-----------------------------------------------------------------
  2477* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2478* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2479* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2480* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2481* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2482* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2483* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2484* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2485* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2486* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2487* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2488******************************************************************
  2489
  2490 01  CALCULATION-PASS-AREA.
  2491     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2492                                     COMP.
  2493
  2494     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2495       88  NO-CP-ERROR                             VALUE ZERO.
  2496       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2497                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2498       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2499       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2500       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2501       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2502       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2503       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2504       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2505       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2506       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2507       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2508       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2509       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2510       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2511       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2512       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2513       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2514       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2515
  2516     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2517       88  NO-CP-ERROR-2                           VALUE ZERO.
  2518***********************  INPUT AREAS ****************************
  2519
  2520     12  CP-CALCULATION-AREA.
  2521         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2522         16  CP-CERT-EFF-DT        PIC XX.
  2523         16  CP-VALUATION-DT       PIC XX.
  2524         16  CP-PAID-THRU-DT       PIC XX.
  2525         16  CP-BENEFIT-TYPE       PIC X.
  2526           88  CP-AH                               VALUE 'A' 'D'
  2527                                                   'I' 'U'.
  2528           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2529           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2530         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  47
* EL130.cbl
  2531         16  CP-REPORTED-DT        PIC XX.
  2532         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2533         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2534         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2535                                     COMP-3.
  2536         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2537                                     COMP-3.
  2538         16  CP-CDT-METHOD         PIC X.
  2539           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2540           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2541           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2542         16  CP-CLAIM-TYPE         PIC X.
  2543           88  CP-AH-CLAIM                         VALUE 'A'.
  2544           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2545         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2546                                     COMP-3.
  2547         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2548                                     COMP-3.
  2549         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2550                                     COMP-3.
  2551         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2552                                     COMP-3.
  2553         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2554                                     COMP-3.
  2555         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2556                                     COMP-3.
  2557         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2558                                     COMP-3.
  2559         16  CP-REM-TERM-METHOD    PIC X.
  2560           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2561           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2562           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2563           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2564           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2565           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2566           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2567         16  CP-EARNING-METHOD     PIC X.
  2568           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2569           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2570           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2571           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2572           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2573           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2574           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2575           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2576           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2577           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2578           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2579           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2580           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2581           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2582         16  CP-PROCESS-TYPE       PIC X.
  2583           88  CP-CLAIM                            VALUE '1'.
  2584           88  CP-CANCEL                           VALUE '2'.
  2585           88  CP-ISSUE                            VALUE '3'.
  2586         16  CP-SPECIAL-CALC-CD    PIC X.
  2587           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2588           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  48
* EL130.cbl
  2589           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2590           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2591           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2592           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2593           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2594           88  CP-FARM-PLAN                    VALUE 'F'.
  2595           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2596           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2597           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2598           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2599           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2600           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2601           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2602           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2603           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2604           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2605                                                     'W' 'X'.
  2606           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2607           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2608           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2609           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2610           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2611           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2612           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2613           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2614           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2615           88  CP-CSL-METH-1                   VALUE '5'.
  2616           88  CP-CSL-METH-2                   VALUE '6'.
  2617           88  CP-CSL-METH-3                   VALUE '7'.
  2618           88  CP-CSL-METH-4                   VALUE '8'.
  2619
  2620         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2621                                     COMP-3.
  2622         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2623         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2624         16  CP-STATE              PIC XX          VALUE SPACE.
  2625         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2626         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2627           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2628               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2629         16  CP-R78-OPTION         PIC X.
  2630           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2631           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2632
  2633         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2634         16  CP-IBNR-RESERVE-SW    PIC X.
  2635         16  CP-CLAIM-STATUS       PIC X.
  2636         16  CP-RATE-FILE          PIC X.
  2637         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2638                                     COMP-3.
  2639
  2640         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2641         16  CP-AH-OVERRIDE-CODE   PIC X.
  2642
  2643         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2644                                     COMP-3.
  2645         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2646                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  49
* EL130.cbl
  2647         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2648                                     COMP-3.
  2649         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2650                                     COMP-3.
  2651         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2652                                     COMP-3.
  2653         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2654                                  PIC S9(7)V99 COMP-3.
  2655
  2656         16  CP-PAID-FROM-DATE     PIC X(02).
  2657         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2658         16  CP-EXT-DAYS-CALC      PIC X.
  2659           88  CP-EXT-NO-CHG                   VALUE ' '.
  2660           88  CP-EXT-CHG-LF                   VALUE '1'.
  2661           88  CP-EXT-CHG-AH                   VALUE '2'.
  2662           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2663         16  CP-DOMICILE-STATE     PIC XX.
  2664         16  CP-CARRIER            PIC X.
  2665         16  CP-REIN-FLAG          PIC X.
  2666         16  CP-REM-TRM-CALC-OPTION PIC X.
  2667           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2668                      '2' '3' '4' '5'.
  2669           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2670           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2671           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2672           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2673           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2674           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2675           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2676           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2677         16  CP-SIG-SWITCH         PIC X.
  2678         16  CP-RATING-METHOD      PIC X.
  2679           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2680           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2681           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2682           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2683           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2684           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2685           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2686           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2687           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2688         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2689                                     COMP-3.
  2690         16  CP-BEN-CATEGORY       PIC X.
  2691         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2692         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2693                                   PIC S99V9(5) COMP-3.
  2694         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2695         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2696                                   PIC S99V9(5) COMP-3.
  2697         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2698         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2699         16  CP-EXPIRE-DT          PIC XX.
  2700         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2701         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2702         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2703         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2704         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  50
* EL130.cbl
  2705             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2706             88  CP-CALC-CLP              VALUE 'C'.
  2707         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2708         16  CP-CANCEL-REASON      PIC X.
  2709         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2710         16  CP-PMT-MODE           PIC X.
  2711         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2712         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2713         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2714         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2715         16  FILLER                PIC X.
  2716
  2717***************    OUTPUT FROM ELRESV   ************************
  2718
  2719         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2720
  2721         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2722                                     COMP-3.
  2723         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2724                                     COMP-3.
  2725         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2726                                     COMP-3.
  2727         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2728                                     COMP-3.
  2729         16  FILLER                PIC X(09).
  2730***************    OUTPUT FROM ELRTRM   *************************
  2731
  2732         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2733                                     COMP-3.
  2734         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2735                                     COMP-3.
  2736         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2737                                     COMP-3.
  2738         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2739                                     COMP-3.
  2740         16  FILLER                PIC X(12).
  2741
  2742***************    OUTPUT FROM ELRAMT   *************************
  2743
  2744         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2745                                     COMP-3.
  2746         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2747                                     COMP-3.
  2748         16  FILLER                PIC X(12).
  2749
  2750***************    OUTPUT FROM ELRATE   *************************
  2751
  2752         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2753                                     COMP-3.
  2754         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2755                                     COMP-3.
  2756         16  CP-MORTALITY-CODE     PIC X(4).
  2757         16  CP-RATE-EDIT-FLAG     PIC X.
  2758             88  CP-RATES-NEED-APR                  VALUE '1'.
  2759         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2760                                     COMP-3.
  2761         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2762         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  51
* EL130.cbl
  2763         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2764                                   PIC S9(7)V99 COMP-3.
  2765         16  FILLER                PIC X(07).
  2766
  2767***************    OUTPUT FROM ELRFND   *************************
  2768
  2769         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2770                                     COMP-3.
  2771         16  CP-REFUND-TYPE-USED   PIC X.
  2772           88  CP-R-AS-R78                         VALUE '1'.
  2773           88  CP-R-AS-PRORATA                     VALUE '2'.
  2774           88  CP-R-AS-CALIF                       VALUE '3'.
  2775           88  CP-R-AS-TEXAS                       VALUE '4'.
  2776           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2777           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2778           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2779           88  CP-R-AS-MEAN                        VALUE '8'.
  2780           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2781           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2782           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2783           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2784           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2785           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2786         16  FILLER                PIC X(12).
  2787
  2788***************    OUTPUT FROM ELEARN   *************************
  2789
  2790         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2791                                     COMP-3.
  2792         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2793                                     COMP-3.
  2794         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2795                                     COMP-3.
  2796         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2797                                     COMP-3.
  2798         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2799                                     COMP-3.
  2800         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2801                                     COMP-3.
  2802         16  CP-EARNING-TYPE-USED  PIC X.
  2803           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2804           88  CP-E-AS-R78                         VALUE '1'.
  2805           88  CP-E-AS-PRORATA                     VALUE '2'.
  2806           88  CP-E-AS-TEXAS                       VALUE '4'.
  2807           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2808           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2809           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2810           88  CP-E-AS-MEAN                        VALUE '8'.
  2811           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2812         16  FILLER                PIC X(12).
  2813
  2814***************    OUTPUT FROM ELPMNT   *************************
  2815
  2816         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2817                                     COMP-3.
  2818         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2819                                     COMP-3.
  2820         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  52
* EL130.cbl
  2821
  2822***************   MISC WORK AREAS    *****************************
  2823         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2824                                     COMP-3.
  2825         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2826                                     COMP-3.
  2827         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2828                                     COMP-3.
  2829         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2830                                     COMP-3.
  2831         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2832                                     COMP-3.
  2833         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2834                                     COMP-3.
  2835         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2836             88  OPEN-RATE-FILE                   VALUE 'O'.
  2837             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2838             88  IO-ERROR                         VALUE 'E'.
  2839
  2840         16  CP-FIRST-PAY-DATE     PIC XX.
  2841
  2842         16  CP-JOINT-INDICATOR    PIC X.
  2843
  2844         16  CP-RESERVE-REMAINING-TERM
  2845                                   PIC S9(4)V9    VALUE ZERO
  2846                                     COMP-3.
  2847
  2848         16  CP-INSURED-BIRTH-DT   PIC XX.
  2849
  2850         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2851                                     COMP-3.
  2852
  2853         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2854                                     COMP-3.
  2855
  2856         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2857                                     COMP-3.
  2858
  2859         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2860                                     COMP-3.
  2861
  2862         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2863                                     COMP-3.
  2864
  2865         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2866                                     COMP-3.
  2867
  2868         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2869                                     COMP-3.
  2870
  2871         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2872             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2873
  2874         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2875                                     COMP-3.
  2876         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2877                                     COMP-3.
  2878         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  53
* EL130.cbl
  2879         16  cp-extra-periods      pic 9 value zeros.
  2880         16  cp-net-only-state     pic x value spaces.
  2881         16  FILLER                PIC X(13).
  2882******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  54
* EL130.cbl
  2884*    COPY ELCLOGOF.
  2885******************************************************************
  2886*                                                                *
  2887*                                                                *
  2888*                            ELCLOGOF.                           *
  2889*                            VMOD=2.001                          *
  2890*                                                                *
  2891*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2892*                                                                *
  2893******************************************************************
  2894 01  CLASIC-LOGOFF.
  2895     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2896     12  LOGOFF-TEXT.
  2897         16  FILLER          PIC X(5)    VALUE SPACES.
  2898         16  LOGOFF-MSG.
  2899             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2900             20  FILLER      PIC X       VALUE SPACES.
  2901             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2902         16  FILLER          PIC X(80)
  2903           VALUE '* YOU ARE NOW LOGGED OFF'.
  2904         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2905         16  FILLER          PIC X       VALUE QUOTE.
  2906         16  LOGOFF-SYS-MSG  PIC X(17)
  2907           VALUE 'S CLAS-IC SYSTEM '.
  2908     12  TEXT-MESSAGES.
  2909         16  UNACCESS-MSG    PIC X(29)
  2910             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2911         16  PGMIDERR-MSG    PIC X(17)
  2912             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  55
* EL130.cbl
  2914*    COPY ELCATTR.
  2915******************************************************************
  2916*                                                                *
  2917*                            ELCATTR.                            *
  2918*                            VMOD=2.001                          *
  2919*                                                                *
  2920*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2921*                                                                *
  2922*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2923*                                                                *
  2924*                   POS 1   P=PROTECTED                          *
  2925*                           U=UNPROTECTED                        *
  2926*                           S=ASKIP                              *
  2927*                   POS 2   A=ALPHA/NUMERIC                      *
  2928*                           N=NUMERIC                            *
  2929*                   POS 3   N=NORMAL                             *
  2930*                           B=BRIGHT                             *
  2931*                           D=DARK                               *
  2932*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2933*                           OF=MODIFIED DATA TAG OFF             *
  2934*                                                                *
  2935*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2936******************************************************************
  2937 01  ATTRIBUTE-LIST.
  2938     12  AL-PABOF            PIC X       VALUE 'Y'.
  2939     12  AL-PABON            PIC X       VALUE 'Z'.
  2940     12  AL-PADOF            PIC X       VALUE '%'.
  2941     12  AL-PADON            PIC X       VALUE '_'.
  2942     12  AL-PANOF            PIC X       VALUE '-'.
  2943     12  AL-PANON            PIC X       VALUE '/'.
  2944     12  AL-SABOF            PIC X       VALUE '8'.
  2945     12  AL-SABON            PIC X       VALUE '9'.
  2946     12  AL-SADOF            PIC X       VALUE '@'.
  2947     12  AL-SADON            PIC X       VALUE QUOTE.
  2948     12  AL-SANOF            PIC X       VALUE '0'.
  2949     12  AL-SANON            PIC X       VALUE '1'.
  2950     12  AL-UABOF            PIC X       VALUE 'H'.
  2951     12  AL-UABON            PIC X       VALUE 'I'.
  2952     12  AL-UADOF            PIC X       VALUE '<'.
  2953     12  AL-UADON            PIC X       VALUE '('.
  2954     12  AL-UANOF            PIC X       VALUE ' '.
  2955     12  AL-UANON            PIC X       VALUE 'A'.
  2956     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2957     12  AL-UNBON            PIC X       VALUE 'R'.
  2958     12  AL-UNDOF            PIC X       VALUE '*'.
  2959     12  AL-UNDON            PIC X       VALUE ')'.
  2960     12  AL-UNNOF            PIC X       VALUE '&'.
  2961     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  56
* EL130.cbl
  2963*    COPY ELCEMIB.
  2964******************************************************************
  2965*                                                                *
  2966*                                                                *
  2967*                            ELCEMIB.                            *
  2968*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2969*                            VMOD=2.005                          *
  2970*                                                                *
  2971*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2972*                                                                *
  2973******************************************************************
  2974 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2975     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2976     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2977     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2978     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2979     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2980     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2981     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2982     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2983     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2984         88  EMI-NO-ERRORS                    VALUE '1'.
  2985         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2986         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2987     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2988         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2989     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2990         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2991         88  EMI-AREA1-FULL                   VALUE '2'.
  2992     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2993         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2994         88  EMI-AREA2-FULL                   VALUE '2'.
  2995     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2996         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2997         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2998         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2999         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3000         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3001     12  EMI-ERROR-LINES.
  3002         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3003         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3004         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3005         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3006             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3007                 24  EMI-ERR-NUM         PIC X(4).
  3008                 24  EMI-FILLER          PIC X.
  3009                 24  EMI-SEV             PIC X.
  3010                 24  FILLER              PIC X.
  3011             20  FILLER                  PIC X(02).
  3012     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3013         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3014             20  EMI-ERROR-NUMBER    PIC X(4).
  3015             20  EMI-FILL            PIC X.
  3016             20  EMI-SEVERITY        PIC X.
  3017             20  FILLER              PIC X.
  3018             20  EMI-ERROR-TEXT.
  3019                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3020                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  57
* EL130.cbl
  3021     12  EMI-SEVERITY-SAVE           PIC X.
  3022         88  EMI-NOTE                    VALUE 'N'.
  3023         88  EMI-WARNING                 VALUE 'W'.
  3024         88  EMI-FORCABLE                VALUE 'F'.
  3025         88  EMI-FATAL                   VALUE 'X'.
  3026     12  EMI-MESSAGE-FLAG            PIC X.
  3027         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3028         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3029     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3030     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3031         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3032         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3033         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3034     12  emi-claim-no                pic x(7).
  3035     12  emi-claim-type              pic x(6).
  3036     12  FILLER                      PIC X(124)  VALUE SPACES.
  3037     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3038     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3039     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3040     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  58
* EL130.cbl
  3042*    COPY ELCJPFX.
  3043******************************************************************
  3044*                                                                *
  3045*                                                                *
  3046*                            ELCJPFX.                            *
  3047*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3048*                            VMOD=2.002                          *
  3049*                                                                *
  3050*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3051*                                                                *
  3052*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3053*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3054*        ELCNTL - CONTROL FILE                                   *
  3055*        ELMSTR - CLAIM MASTERS                                  *
  3056*        ELTRLR - ACTIVITY TRAILERS                              *
  3057*        ELCHKQ - CHECK QUE                                      *
  3058******************************************************************
  3059 01  JOURNAL-RECORD.
  3060     12  jp-date                     pic s9(5) comp-3.
  3061     12  jp-time                     pic s9(7) comp-3.
  3062     12  JP-USER-ID                  PIC X(4).
  3063     12  JP-FILE-ID                  PIC X(8).
  3064     12  JP-PROGRAM-ID               PIC X(8).
  3065     12  JP-RECORD-TYPE              PIC X.
  3066         88 JP-ADD              VALUE 'A'.
  3067         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3068         88 JP-AFTER-CHANGE     VALUE 'C'.
  3069         88 JP-DELETE           VALUE 'D'.
  3070         88 JP-GENERIC-DELETE   VALUE 'G'.
  3071         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3072         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3073     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3074     12  JP-RECORD-AREA
  3075
  3076
  3077         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  59
* EL130.cbl
  3079*    COPY ELCAID.
  3080******************************************************************
  3081*                                                                *
  3082*                            ELCAID.                             *
  3083*                            VMOD=2.001                          *
  3084*                                                                *
  3085*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3086*                                                                *
  3087*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3088*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3089******************************************************************
  3090
  3091 01  DFHAID.
  3092   02  DFHNULL   PIC  X  VALUE  ' '.
  3093   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3094   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3095   02  DFHPEN    PIC  X  VALUE  '='.
  3096   02  DFHOPID   PIC  X  VALUE  'W'.
  3097   02  DFHPA1    PIC  X  VALUE  '%'.
  3098   02  DFHPA2    PIC  X  VALUE  '>'.
  3099   02  DFHPA3    PIC  X  VALUE  ','.
  3100   02  DFHPF1    PIC  X  VALUE  '1'.
  3101   02  DFHPF2    PIC  X  VALUE  '2'.
  3102   02  DFHPF3    PIC  X  VALUE  '3'.
  3103   02  DFHPF4    PIC  X  VALUE  '4'.
  3104   02  DFHPF5    PIC  X  VALUE  '5'.
  3105   02  DFHPF6    PIC  X  VALUE  '6'.
  3106   02  DFHPF7    PIC  X  VALUE  '7'.
  3107   02  DFHPF8    PIC  X  VALUE  '8'.
  3108   02  DFHPF9    PIC  X  VALUE  '9'.
  3109   02  DFHPF10   PIC  X  VALUE  ':'.
  3110   02  DFHPF11   PIC  X  VALUE  '#'.
  3111   02  DFHPF12   PIC  X  VALUE  '@'.
  3112   02  DFHPF13   PIC  X  VALUE  'A'.
  3113   02  DFHPF14   PIC  X  VALUE  'B'.
  3114   02  DFHPF15   PIC  X  VALUE  'C'.
  3115   02  DFHPF16   PIC  X  VALUE  'D'.
  3116   02  DFHPF17   PIC  X  VALUE  'E'.
  3117   02  DFHPF18   PIC  X  VALUE  'F'.
  3118   02  DFHPF19   PIC  X  VALUE  'G'.
  3119   02  DFHPF20   PIC  X  VALUE  'H'.
  3120   02  DFHPF21   PIC  X  VALUE  'I'.
  3121*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3122   02  DFHPF22   PIC  X  VALUE  '['.
  3123   02  DFHPF23   PIC  X  VALUE  '.'.
  3124   02  DFHPF24   PIC  X  VALUE  '<'.
  3125   02  DFHMSRE   PIC  X  VALUE  'X'.
  3126   02  DFHSTRF   PIC  X  VALUE  'h'.
  3127   02  DFHTRIG   PIC  X  VALUE  '"'.
  3128
  3129 01  FILLER    REDEFINES DFHAID.
  3130     12  FILLER              PIC X(8).
  3131     12  PF-VALUES           PIC X       OCCURS 12.
  3132
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  60
* EL130.cbl
  3134****************************************************************
  3135*
  3136* Copyright (c) 2007-2013 Dell Inc.
  3137* All rights reserved.
  3138*
  3139****************************************************************
  3140 01  DFHEIV.
  3141   02  DFHEIV0               PIC X(35).
  3142   02  DFHEIV1               PIC X(08).
  3143   02  DFHEIV2               PIC X(08).
  3144   02  DFHEIV3               PIC X(08).
  3145   02  DFHEIV4               PIC X(06).
  3146   02  DFHEIV5               PIC X(04).
  3147   02  DFHEIV6               PIC X(04).
  3148   02  DFHEIV7               PIC X(02).
  3149   02  DFHEIV8               PIC X(02).
  3150   02  DFHEIV9               PIC X(01).
  3151   02  DFHEIV10              PIC S9(7) COMP-3.
  3152   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3153   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3154   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3155   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3156   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3157   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3158   02  DFHEIV17              PIC X(04).
  3159   02  DFHEIV18              PIC X(04).
  3160   02  DFHEIV19              PIC X(04).
  3161   02  DFHEIV20              USAGE IS POINTER.
  3162   02  DFHEIV21              USAGE IS POINTER.
  3163   02  DFHEIV22              USAGE IS POINTER.
  3164   02  DFHEIV23              USAGE IS POINTER.
  3165   02  DFHEIV24              USAGE IS POINTER.
  3166   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3167   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3168   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3169   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3170   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3171   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3172   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3173   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3174   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3175   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3176   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3177   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3178   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3179   02  FILLER                PIC X(02).
  3180   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3181   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3182   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3183   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3184   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3185   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3186   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3187 LINKAGE  SECTION.
  3188*****************************************************************
  3189*                                                               *
  3190* Copyright (c) 2007-2013 Dell Inc.                             *
  3191* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  61
* EL130.cbl
  3192*                                                               *
  3193*****************************************************************
  3194 01  dfheiblk.
  3195     02  eibtime          pic s9(7) comp-3.
  3196     02  eibdate          pic s9(7) comp-3.
  3197     02  eibtrnid         pic x(4).
  3198     02  eibtaskn         pic s9(7) comp-3.
  3199     02  eibtrmid         pic x(4).
  3200     02  dfheigdi         pic s9(4) comp.
  3201     02  eibcposn         pic s9(4) comp.
  3202     02  eibcalen         pic s9(4) comp.
  3203     02  eibaid           pic x(1).
  3204     02  eibfiller1       pic x(1).
  3205     02  eibfn            pic x(2).
  3206     02  eibfiller2       pic x(2).
  3207     02  eibrcode         pic x(6).
  3208     02  eibfiller3       pic x(2).
  3209     02  eibds            pic x(8).
  3210     02  eibreqid         pic x(8).
  3211     02  eibrsrce         pic x(8).
  3212     02  eibsync          pic x(1).
  3213     02  eibfree          pic x(1).
  3214     02  eibrecv          pic x(1).
  3215     02  eibsend          pic x(1).
  3216     02  eibatt           pic x(1).
  3217     02  eibeoc           pic x(1).
  3218     02  eibfmh           pic x(1).
  3219     02  eibcompl         pic x(1).
  3220     02  eibsig           pic x(1).
  3221     02  eibconf          pic x(1).
  3222     02  eiberr           pic x(1).
  3223     02  eibrldbk         pic x(1).
  3224     02  eiberrcd         pic x(4).
  3225     02  eibsynrb         pic x(1).
  3226     02  eibnodat         pic x(1).
  3227     02  eibfiller5       pic x(2).
  3228     02  eibresp          pic s9(8) comp.
  3229     02  eibresp2         pic s9(8) comp.
  3230     02  dfheigdj         pic s9(4) comp.
  3231     02  dfheigdk         pic s9(4) comp.
  3232
  3233 01  DFHCOMMAREA             PIC X(1024).
  3234
  3235*01 PARMLIST .
  3236*    02  FILLER              PIC S9(8)   COMP.
  3237*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3238*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3239*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3240*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3241*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3242*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3243*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3244*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3245*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  62
* EL130.cbl
  3247*    COPY ELCMSTR.
  3248******************************************************************
  3249*                                                                *
  3250*                            ELCMSTR.                            *
  3251*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3252*                            VMOD=2.012                          *
  3253*                                                                *
  3254*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3255*                                                                *
  3256*   FILE TYPE = VSAM,KSDS                                        *
  3257*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3258*                                                                *
  3259*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3260*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3261*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3262*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3263*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3264*                                                 RKP=75,LEN=21  *
  3265*                                                                *
  3266*   **** NOTE ****                                               *
  3267*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3268*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3269*                                                                *
  3270*   LOG = YES                                                    *
  3271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3272******************************************************************
  3273*                   C H A N G E   L O G
  3274*
  3275* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3276*-----------------------------------------------------------------
  3277*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3278* EFFECTIVE    NUMBER
  3279*-----------------------------------------------------------------
  3280* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3281* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3282* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3283* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3284* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3285* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3286******************************************************************
  3287 01  CLAIM-MASTER.
  3288     12  CL-RECORD-ID                PIC XX.
  3289         88  VALID-CL-ID         VALUE 'CL'.
  3290
  3291     12  CL-CONTROL-PRIMARY.
  3292         16  CL-COMPANY-CD           PIC X.
  3293         16  CL-CARRIER              PIC X.
  3294         16  CL-CLAIM-NO             PIC X(7).
  3295         16  CL-CERT-NO.
  3296             20  CL-CERT-PRIME       PIC X(10).
  3297             20  CL-CERT-SFX         PIC X.
  3298
  3299     12  CL-CONTROL-BY-NAME.
  3300         16  CL-COMPANY-CD-A1        PIC X.
  3301         16  CL-INSURED-LAST-NAME    PIC X(15).
  3302         16  CL-INSURED-NAME.
  3303             20  CL-INSURED-1ST-NAME PIC X(12).
  3304             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  63
* EL130.cbl
  3305
  3306     12  CL-CONTROL-BY-SSN.
  3307         16  CL-COMPANY-CD-A2        PIC X.
  3308         16  CL-SOC-SEC-NO.
  3309             20  CL-SSN-STATE        PIC XX.
  3310             20  CL-SSN-ACCOUNT      PIC X(6).
  3311             20  CL-SSN-LN3          PIC X(3).
  3312
  3313     12  CL-CONTROL-BY-CERT-NO.
  3314         16  CL-COMPANY-CD-A4        PIC X.
  3315         16  CL-CERT-NO-A4.
  3316             20  CL-CERT-A4-PRIME    PIC X(10).
  3317             20  CL-CERT-A4-SFX      PIC X.
  3318
  3319     12  CL-CONTROL-BY-CCN.
  3320         16  CL-COMPANY-CD-A5        PIC X.
  3321         16  CL-CCN-A5.
  3322             20  CL-CCN.
  3323                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3324                 24  CL-CCN-PRIME-A5 PIC X(12).
  3325             20  CL-CCN-FILLER-A5    PIC X(4).
  3326
  3327     12  CL-INSURED-PROFILE-DATA.
  3328         16  CL-INSURED-BIRTH-DT     PIC XX.
  3329         16  CL-INSURED-SEX-CD       PIC X.
  3330             88  INSURED-IS-MALE        VALUE 'M'.
  3331             88  INSURED-IS-FEMALE      VALUE 'F'.
  3332             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3333         16  CL-INSURED-OCC-CD       PIC X(6).
  3334         16  FILLER                  PIC X(5).
  3335
  3336     12  CL-PROCESSING-INFO.
  3337         16  CL-PROCESSOR-ID         PIC X(4).
  3338         16  CL-CLAIM-STATUS         PIC X.
  3339             88  CLAIM-IS-OPEN          VALUE 'O'.
  3340             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3341         16  CL-CLAIM-TYPE           PIC X.
  3342*            88  AH-CLAIM               VALUE 'A'.
  3343*            88  LIFE-CLAIM             VALUE 'L'.
  3344*            88  PROPERTY-CLAIM         VALUE 'P'.
  3345*            88  IUI-CLAIM              VALUE 'I'.
  3346*            88  GAP-CLAIM              VALUE 'G'.
  3347*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3348         16  CL-CLAIM-PREM-TYPE      PIC X.
  3349             88  SINGLE-PREMIUM         VALUE '1'.
  3350             88  O-B-COVERAGE           VALUE '2'.
  3351             88  OPEN-END-COVERAGE      VALUE '3'.
  3352         16  CL-INCURRED-DT          PIC XX.
  3353         16  CL-REPORTED-DT          PIC XX.
  3354         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3355         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3356         16  CL-LAST-PMT-DT          PIC XX.
  3357         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3358         16  CL-PAID-THRU-DT         PIC XX.
  3359         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3360         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3361         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3362         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  64
* EL130.cbl
  3363             88  CL-360-DAY-YR          VALUE '1'.
  3364             88  CL-365-DAY-YR          VALUE '2'.
  3365             88  CL-FULL-MONTHS         VALUE '3'.
  3366         16  CL-CAUSE-CD             PIC X(6).
  3367
  3368         16  CL-PRIME-CERT-NO.
  3369             20  CL-PRIME-CERT-PRIME PIC X(10).
  3370             20  CL-PRIME-CERT-SFX   PIC X.
  3371
  3372         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3373             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3374             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3375
  3376         16  CL-MICROFILM-NO         PIC X(10).
  3377         16  FILLER REDEFINES CL-MICROFILM-NO.
  3378             20  CL-BENEFIT-PERIOD   PIC 99.
  3379             20  FILLER              PIC X(8).
  3380         16  CL-PROG-FORM-TYPE       PIC X.
  3381         16  CL-LAST-ADD-ON-DT       PIC XX.
  3382
  3383         16  CL-LAST-REOPEN-DT       PIC XX.
  3384         16  CL-LAST-CLOSE-DT        PIC XX.
  3385         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3386             88  FINAL-PAID             VALUE '1'.
  3387             88  CLAIM-DENIED           VALUE '2'.
  3388             88  AUTO-CLOSE             VALUE '3'.
  3389             88  MANUAL-CLOSE           VALUE '4'.
  3390             88  BENEFITS-CHANGED       VALUE 'C'.
  3391             88  SETUP-ERRORS           VALUE 'E'.
  3392         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3393         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3394         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3395             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3396         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3397         16  FILLER                  PIC X.
  3398
  3399     12  CL-CERTIFICATE-DATA.
  3400         16  CL-CERT-ORIGIN          PIC X.
  3401             88  CERT-WAS-ONLINE        VALUE '1'.
  3402             88  CERT-WAS-CREATED       VALUE '2'.
  3403             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3404         16  CL-CERT-KEY-DATA.
  3405             20  CL-CERT-CARRIER     PIC X.
  3406             20  CL-CERT-GROUPING    PIC X(6).
  3407             20  CL-CERT-STATE       PIC XX.
  3408             20  CL-CERT-ACCOUNT.
  3409                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3410                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3411             20  CL-CERT-EFF-DT      PIC XX.
  3412
  3413     12  CL-STATUS-CONTROLS.
  3414         16  CL-PRIORITY-CD          PIC X.
  3415             88  CONFIDENTIAL-DATA      VALUE '8'.
  3416             88  HIGHEST-PRIORITY       VALUE '9'.
  3417         16  CL-SUPV-ATTN-CD         PIC X.
  3418             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3419             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3420         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  65
* EL130.cbl
  3421         16  CL-RESTORED-DT          PIC XX.
  3422         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3423         16  CL-NEXT-RESEND-DT       PIC XX.
  3424         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3425         16  CL-CRITICAL-PERIOD      PIC 99.
  3426*        16  FILLER                  PIC XX.
  3427         16  CL-LAST-MAINT-DT        PIC XX.
  3428         16  CL-LAST-MAINT-USER      PIC X(4).
  3429         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3430         16  CL-LAST-MAINT-TYPE      PIC X.
  3431             88  CLAIM-SET-UP           VALUE ' '.
  3432             88  PAYMENT-MADE           VALUE '1'.
  3433             88  LETTER-SENT            VALUE '2'.
  3434             88  MASTER-WAS-ALTERED     VALUE '3'.
  3435             88  MASTER-WAS-RESTORED    VALUE '4'.
  3436             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3437             88  FILE-CONVERTED         VALUE '6'.
  3438             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3439             88  ERROR-CORRECTION       VALUE 'E'.
  3440         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3441         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3442         16  CL-BENEFICIARY          PIC X(10).
  3443         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3444         16  CL-DENIAL-TYPE          PIC X.
  3445             88  CL-TYPE-DENIAL          VALUE '1'.
  3446             88  CL-TYPE-RESCISSION      VALUE '2'.
  3447             88  CL-TYPE-REFORMATION     VALUE '3'.
  3448             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3449             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3450         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3451         16  filler                  pic x(3).
  3452*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3453*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3454*        16  CL-RTW-DT               PIC XX.
  3455
  3456     12  CL-TRAILER-CONTROLS.
  3457         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3458             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3459             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3460             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3461         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3462         16  FILLER                  PIC XX.
  3463         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3464         16  CL-ADDRESS-TRAILER-CNT.
  3465             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3466                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3467             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3468                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3469             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3470                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3471             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3472                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3473             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3474                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3475             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3476                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3477             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3478                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  66
* EL130.cbl
  3479
  3480     12  CL-CV-REFERENCE-NO.
  3481         16  CL-CV-REFNO-PRIME       PIC X(18).
  3482         16  CL-CV-REFNO-SFX         PIC XX.
  3483
  3484     12  CL-FILE-LOCATION            PIC X(4).
  3485
  3486     12  CL-PROCESS-ERRORS.
  3487         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3488             88  NO-FATAL-ERRORS        VALUE ZERO.
  3489         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3490             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3491
  3492     12  CL-PRODUCT-CD               PIC X.
  3493
  3494     12  CL-CURRENT-KEY-DATA.
  3495         16  CL-CURRENT-CARRIER      PIC X.
  3496         16  CL-CURRENT-GROUPING     PIC X(6).
  3497         16  CL-CURRENT-STATE        PIC XX.
  3498         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3499
  3500     12  CL-ASSOCIATES               PIC X.
  3501         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3502         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3503         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3504         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3505
  3506     12  CL-ACTIVITY-CODE            PIC 99.
  3507     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3508     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3509
  3510     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3511     12  CL-LAG-REPORT-CODE          PIC 9.
  3512     12  CL-LOAN-TYPE                PIC XX.
  3513     12  CL-LEGAL-STATE              PIC XX.
  3514
  3515     12  CL-YESNOSW                  PIC X.
  3516     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3517         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3518         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3519         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3520     12  cl-insured-type             pic x.
  3521         88  cl-claim-on-primary         value 'P'.
  3522         88  cl-claim-on-co-borrower     value 'C'.
  3523     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  67
* EL130.cbl
  3525*    COPY ELCCNTL.
  3526******************************************************************
  3527*                                                                *
  3528*                                                                *
  3529*                            ELCCNTL.                            *
  3530*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3531*                            VMOD=2.059                          *
  3532*                                                                *
  3533*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3534*                                                                *
  3535*   FILE TYPE = VSAM,KSDS                                        *
  3536*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3537*                                                                *
  3538*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3539*       ALTERNATE INDEX = NONE                                   *
  3540*                                                                *
  3541*   LOG = YES                                                    *
  3542*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3543******************************************************************
  3544*                   C H A N G E   L O G
  3545*
  3546* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3547*-----------------------------------------------------------------
  3548*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3549* EFFECTIVE    NUMBER
  3550*-----------------------------------------------------------------
  3551* 082503                   PEMA  ADD BENEFIT GROUP
  3552* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3553* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3554* 092705    2005050300006  PEMA  ADD SPP LEASES
  3555* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3556* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3557* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3558* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3559* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3560* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3561* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3562* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3563* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3564* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3565* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  3566******************************************************************
  3567*
  3568 01  CONTROL-FILE.
  3569     12  CF-RECORD-ID                       PIC XX.
  3570         88  VALID-CF-ID                        VALUE 'CF'.
  3571
  3572     12  CF-CONTROL-PRIMARY.
  3573         16  CF-COMPANY-ID                  PIC XXX.
  3574         16  CF-RECORD-TYPE                 PIC X.
  3575             88  CF-COMPANY-MASTER              VALUE '1'.
  3576             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3577             88  CF-STATE-MASTER                VALUE '3'.
  3578             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3579             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3580             88  CF-CARRIER-MASTER              VALUE '6'.
  3581             88  CF-MORTALITY-MASTER            VALUE '7'.
  3582             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  68
* EL130.cbl
  3583             88  CF-TERMINAL-MASTER             VALUE '9'.
  3584             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3585             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3586             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3587             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3588             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3589             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3590             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3591             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3592             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3593         16  CF-ACCESS-CD-GENL              PIC X(4).
  3594         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3595             20  CF-PROCESSOR               PIC X(4).
  3596         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3597             20  CF-STATE-CODE              PIC XX.
  3598             20  FILLER                     PIC XX.
  3599         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3600             20  FILLER                     PIC XX.
  3601             20  CF-HI-BEN-IN-REC           PIC XX.
  3602         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3603             20  FILLER                     PIC XXX.
  3604             20  CF-CARRIER-CNTL            PIC X.
  3605         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3606             20  FILLER                     PIC XX.
  3607             20  CF-HI-TYPE-IN-REC          PIC 99.
  3608         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3609             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3610                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3611             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3612             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3613         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3614             20  FILLER                     PIC X.
  3615             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3616         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3617             20  FILLER                     PIC XX.
  3618             20  CF-MORTGAGE-PLAN           PIC XX.
  3619         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3620
  3621     12  CF-LAST-MAINT-DT                   PIC XX.
  3622     12  CF-LAST-MAINT-BY                   PIC X(4).
  3623     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3624
  3625     12  CF-RECORD-BODY                     PIC X(728).
  3626
  3627
  3628****************************************************************
  3629*             COMPANY MASTER RECORD                            *
  3630****************************************************************
  3631
  3632     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3633         16  CF-COMPANY-ADDRESS.
  3634             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3635             20  CF-CL-IN-CARE-OF           PIC X(30).
  3636             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3637             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3638             20  CF-CL-CITY-STATE           PIC X(30).
  3639             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3640             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  69
* EL130.cbl
  3641         16  CF-COMPANY-CD                  PIC X.
  3642         16  CF-COMPANY-PASSWORD            PIC X(8).
  3643         16  CF-SECURITY-OPTION             PIC X.
  3644             88  ALL-SECURITY                   VALUE '1'.
  3645             88  COMPANY-VERIFY                 VALUE '2'.
  3646             88  PROCESSOR-VERIFY               VALUE '3'.
  3647             88  NO-SECURITY                    VALUE '4'.
  3648             88  ALL-BUT-TERM                   VALUE '5'.
  3649         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3650             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3651         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3652             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3653         16  CF-INFORCE-LOCATION            PIC X.
  3654             88  CERTS-ARE-ONLINE               VALUE '1'.
  3655             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3656             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3657         16  CF-LOWER-CASE-LETTERS          PIC X.
  3658         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3659             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3660             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3661             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3662             88  CF-ACCNT-CNTL                  VALUE '3'.
  3663             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3664
  3665         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3666         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3667
  3668         16  CF-LGX-CREDIT-USER             PIC X.
  3669             88  CO-IS-NOT-USER                 VALUE 'N'.
  3670             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3671
  3672         16 CF-CREDIT-CALC-CODES.
  3673             20  CF-CR-REM-TERM-CALC PIC X.
  3674               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3675               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3676               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3677               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3678               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3679               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3680               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3681             20  CF-CR-R78-METHOD           PIC X.
  3682               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3683               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3684
  3685         16  CF-CLAIM-CONTROL-COUNTS.
  3686             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3687                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3688
  3689             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3690                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3691
  3692             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3693                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3694
  3695             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3696                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3697
  3698         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  70
* EL130.cbl
  3699
  3700         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3701             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3702             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3703             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3704             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3705                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3706                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3707             20  CF-CO-PREM-REJECT-SW       PIC X.
  3708                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3709                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3710             20  CF-CO-REF-REJECT-SW        PIC X.
  3711                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3712                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3713
  3714         16  CF-CO-REPORTING-DT             PIC XX.
  3715         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3716         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3717           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3718           88  CF-CO-MONTH-END                  VALUE '1'.
  3719
  3720         16  CF-LGX-CLAIM-USER              PIC X.
  3721             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3722             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3723
  3724         16  CF-CREDIT-EDIT-CONTROLS.
  3725             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3726             20  CF-MIN-AGE                 PIC 99.
  3727             20  CF-DEFAULT-AGE             PIC 99.
  3728             20  CF-MIN-TERM                PIC S999      COMP-3.
  3729             20  CF-MAX-TERM                PIC S999      COMP-3.
  3730             20  CF-DEFAULT-SEX             PIC X.
  3731             20  CF-JOINT-AGE-INPUT         PIC X.
  3732                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3733             20  CF-BIRTH-DATE-INPUT        PIC X.
  3734                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3735             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3736                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3737                 88  CF-ZERO-CARRIER            VALUE '1'.
  3738                 88  CF-ZERO-GROUPING           VALUE '2'.
  3739                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3740             20  CF-EDIT-SW                 PIC X.
  3741                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3742             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3743             20  CF-CR-PR-METHOD            PIC X.
  3744               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3745               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3746             20  FILLER                     PIC X.
  3747
  3748         16  CF-CREDIT-MISC-CONTROLS.
  3749             20  CF-REIN-TABLE-SW           PIC X.
  3750                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3751             20  CF-COMP-TABLE-SW           PIC X.
  3752                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3753             20  CF-EXPERIENCE-RETENTION-AGE
  3754                                            PIC S9        COMP-3.
  3755             20  CF-CONVERSION-DT           PIC XX.
  3756             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  71
* EL130.cbl
  3757             20  CF-RUN-FREQUENCY-SW        PIC X.
  3758                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3759                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3760
  3761             20  CF-CR-CHECK-NO-CONTROL.
  3762                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3763                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3764                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3765                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3766                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3767                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3768
  3769                 24  CF-CR-CHECK-COUNT       REDEFINES
  3770                     CF-CR-CHECK-COUNTER      PIC X(4).
  3771
  3772                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3773                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3774
  3775                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3776                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3777                 24  CF-MAIL-PROCESSING       PIC X.
  3778                     88  MAIL-PROCESSING          VALUE 'Y'.
  3779
  3780         16  CF-MISC-SYSTEM-CONTROL.
  3781             20  CF-SYSTEM-C                 PIC X.
  3782                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3783             20  CF-SYSTEM-D                 PIC X.
  3784                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3785             20  CF-SOC-SEC-NO-SW            PIC X.
  3786                 88  SOC-SEC-NO-USED             VALUE '1'.
  3787             20  CF-MEMBER-NO-SW             PIC X.
  3788                 88  MEMBER-NO-USED              VALUE '1'.
  3789             20  CF-TAX-ID-NUMBER            PIC X(11).
  3790             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3791             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3792                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3793                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3794                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3795                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3796             20  CF-SYSTEM-E                 PIC X.
  3797                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3798
  3799         16  CF-LGX-LIFE-USER               PIC X.
  3800             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3801             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3802
  3803         16  CF-CR-MONTH-END-DT             PIC XX.
  3804
  3805         16  CF-FILE-MAINT-DATES.
  3806             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3807                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3808             20  CF-LAST-BATCH       REDEFINES
  3809                 CF-LAST-BATCH-NO               PIC X(4).
  3810             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3811             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3812             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3813             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3814             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  72
* EL130.cbl
  3815             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3816             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3817             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3818             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3819             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3820
  3821         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3822         16  FILLER                         PIC X.
  3823
  3824         16  CF-ALT-MORT-CODE               PIC X(4).
  3825         16  CF-MEMBER-CAPTION              PIC X(10).
  3826
  3827         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3828             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3829             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3830             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3831             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3832             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3833
  3834         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3835
  3836         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3837         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3838         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3839         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3840
  3841         16  CF-AH-OVERRIDE-L1              PIC X.
  3842         16  CF-AH-OVERRIDE-L2              PIC XX.
  3843         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3844         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3845
  3846         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3847         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3848
  3849         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3850         16  CF-AR-LAST-EL860-DT            PIC XX.
  3851         16  CF-MP-MONTH-END-DT             PIC XX.
  3852
  3853         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3854         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3855             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3856
  3857         16  CF-AR-MONTH-END-DT             PIC XX.
  3858
  3859         16  CF-CRDTCRD-USER                PIC X.
  3860             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3861             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3862
  3863         16  CF-CC-MONTH-END-DT             PIC XX.
  3864
  3865         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3866
  3867         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3868             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3869             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3870             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3871         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3872         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  73
* EL130.cbl
  3873         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3874         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3875             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3876             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3877         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3878         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3879         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3880             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3881         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3882
  3883         16  CF-CL-ZIP-CODE.
  3884             20  CF-CL-ZIP-PRIME.
  3885                 24  CF-CL-ZIP-1ST          PIC X.
  3886                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3887                 24  FILLER                 PIC X(4).
  3888             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3889         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3890             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3891             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3892             20  FILLER                     PIC XXX.
  3893
  3894         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3895         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3896         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3897         16  CF-CO-OPTION-START-DATE        PIC XX.
  3898         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3899           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3900                                                      '3' '4'.
  3901           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3902           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3903           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3904           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3905           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3906           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3907
  3908         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3909
  3910         16  CF-PAYMENT-APPROVAL-LEVELS.
  3911             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3912             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3913             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3914             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3915             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3916             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3917
  3918         16  CF-END-USER-REPORTING-USER     PIC X.
  3919             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3920             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3921
  3922         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3923             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3924             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3925
  3926         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3927
  3928         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3929         16  FILLER                         PIC X.
  3930
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  74
* EL130.cbl
  3931         16  CF-CREDIT-ARCHIVE-CNTL.
  3932             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3933             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3934             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3935
  3936         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3937
  3938         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3939             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3940             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3941
  3942         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3943             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3944             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3945
  3946         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3947
  3948         16  CF-CO-ACH-ID-CODE              PIC  X.
  3949             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3950             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3951             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3952         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3953         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3954         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3955         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3956         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3957         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3958         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3959         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3960         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3961                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3962         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3963                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3964
  3965         16  CF-CO-OVER-SHORT.
  3966             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3967             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3968
  3969*         16  FILLER                         PIC X(102).
  3970         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3971             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3972             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3973
  3974         16  CF-AH-APPROVAL-DAYS.
  3975             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3976             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3977             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3978             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3979
  3980         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3981
  3982         16  CF-APPROV-LEV-5.
  3983             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3984             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3985             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3986
  3987         16  FILLER                         PIC X(68).
  3988****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  75
* EL130.cbl
  3989*             PROCESSOR/USER RECORD                            *
  3990****************************************************************
  3991
  3992     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3993         16  CF-PROCESSOR-NAME              PIC X(30).
  3994         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3995         16  CF-PROCESSOR-TITLE             PIC X(26).
  3996         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3997                 88  MESSAGE-YES                VALUE 'Y'.
  3998                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3999
  4000*****************************************************
  4001****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4002****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4003****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4004****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4005*****************************************************
  4006
  4007         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4008             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4009             20  CF-APPLICATION-FORCE       PIC X.
  4010             20  CF-INDIVIDUAL-APP.
  4011                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4012                     28  CF-BROWSE-APP      PIC X.
  4013                     28  CF-UPDATE-APP      PIC X.
  4014
  4015         16  CF-CURRENT-TERM-ON             PIC X(4).
  4016         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4017             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4018             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4019             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4020             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4021             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4022             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4023             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4024         16  CF-PROCESSOR-CARRIER           PIC X.
  4025             88  NO-CARRIER-SECURITY            VALUE ' '.
  4026         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4027             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4028         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4029             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4030         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4031             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4032
  4033         16  CF-PROC-SYS-ACCESS-SW.
  4034             20  CF-PROC-CREDIT-CLAIMS-SW.
  4035                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4036                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4037                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4038                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4039             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4040                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4041                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4042             20  CF-PROC-LIFE-GNRLDGR-SW.
  4043                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4044                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4045                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4046                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  76
* EL130.cbl
  4047             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4048                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4049                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4050         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4051             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4052             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4053         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4054
  4055         16  CF-APPROVAL-LEVEL                  PIC X.
  4056             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4057             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4058             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4059             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4060             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4061
  4062         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4063
  4064         16  CF-LANGUAGE-TYPE                   PIC X.
  4065             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4066             88  CF-LANG-IS-FR                      VALUE 'F'.
  4067
  4068         16  CF-CSR-IND                         PIC X.
  4069         16  FILLER                             PIC X(239).
  4070
  4071****************************************************************
  4072*             PROCESSOR/REMINDERS RECORD                       *
  4073****************************************************************
  4074
  4075     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4076         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4077             20  CF-START-REMIND-DT         PIC XX.
  4078             20  CF-END-REMIND-DT           PIC XX.
  4079             20  CF-REMINDER-TEXT           PIC X(50).
  4080         16  FILLER                         PIC X(296).
  4081
  4082
  4083****************************************************************
  4084*             STATE MASTER RECORD                              *
  4085****************************************************************
  4086
  4087     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4088         16  CF-STATE-ABBREVIATION          PIC XX.
  4089         16  CF-STATE-NAME                  PIC X(25).
  4090         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4091         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4092             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4093             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4094             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4095             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4096                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4097                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4098             20  CF-ST-PREM-REJECT-SW       PIC X.
  4099                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4100                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4101             20  CF-ST-REF-REJECT-SW        PIC X.
  4102                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4103                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4104         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  77
* EL130.cbl
  4105         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4106         16  CF-ST-REFUND-RULES.
  4107             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4108             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4109             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4110         16  CF-ST-FST-PMT-EXTENSION.
  4111             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4112             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4113                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4114                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4115                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4116                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4117         16  CF-ST-STATE-CALL.
  4118             20  CF-ST-CALL-UNEARNED        PIC X.
  4119             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4120             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4121         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4122             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4123             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4124         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4125         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4126         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4127         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4128         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4129         16  FILLER                         PIC X.
  4130         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4131             20  CF-ST-BENEFIT-CD           PIC XX.
  4132             20  CF-ST-BENEFIT-KIND         PIC X.
  4133                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4134                 88  CF-ST-AH-KIND              VALUE 'A'.
  4135             20  CF-ST-REM-TERM-CALC        PIC X.
  4136                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4137                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4138                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4139                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4140                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4141                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4142                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4143                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4144
  4145             20  CF-ST-REFUND-CALC          PIC X.
  4146                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4147                 88  ST-REFD-BY-R78             VALUE '1'.
  4148                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4149                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4150                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4151                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4152                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4153                 88  ST-REFD-UTAH               VALUE '7'.
  4154                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4155                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4156                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4157
  4158             20  CF-ST-EARNING-CALC         PIC X.
  4159                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4160                 88  ST-EARN-BY-R78             VALUE '1'.
  4161                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4162                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  78
* EL130.cbl
  4163                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4164                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4165                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4166                 88  ST-EARN-MEAN               VALUE '8'.
  4167                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4168
  4169             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4170                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4171                 88  ST-OVRD-BY-R78             VALUE '1'.
  4172                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4173                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4174                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4175                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4176                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4177                 88  ST-OVRD-MEAN               VALUE '8'.
  4178                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4179             20  cf-st-extra-periods        pic 9.
  4180*            20  FILLER                     PIC X.
  4181
  4182         16  CF-ST-COMMISSION-CAPS.
  4183             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4184             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4185             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4186             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4187         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4188                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4189                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4190                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4191
  4192         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4193
  4194         16  CF-ST-STATUTORY-INTEREST.
  4195             20  CF-ST-STAT-DATE-FROM       PIC X.
  4196                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4197                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4198             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4199             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4200             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4201             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4202             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4203
  4204         16  CF-ST-OVER-SHORT.
  4205             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4206             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4207
  4208         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4209
  4210         16  CF-ST-RT-CALC                  PIC X.
  4211
  4212         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4213         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4214         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4215         16  CF-ST-RF-LR-CALC               PIC X.
  4216         16  CF-ST-RF-LL-CALC               PIC X.
  4217         16  CF-ST-RF-LN-CALC               PIC X.
  4218         16  CF-ST-RF-AH-CALC               PIC X.
  4219         16  CF-ST-RF-CP-CALC               PIC X.
  4220*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  79
* EL130.cbl
  4221*CIDMOD         16  FILLER                         PIC X(192).
  4222         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4223             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4224         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4225         16  CF-ST-VFY-2ND-BENE             PIC X.
  4226         16  CF-ST-CAUSAL-STATE             PIC X.
  4227         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4228         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4229         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4230             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4231         16  CF-ST-NET-ONLY-STATE           PIC X.
  4232             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4233         16  cf-commission-cap-required     pic x.
  4234         16  CF-ST-GA-COMMISSION-CAPS.
  4235             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4236             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4237             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4238             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4239         16  CF-ST-TOT-COMMISSION-CAPS.
  4240             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4241             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4242             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4243             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4244         16  FILLER                         PIC X(156).
  4245
  4246****************************************************************
  4247*             BENEFIT MASTER RECORD                            *
  4248****************************************************************
  4249
  4250     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4251         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4252             20  CF-BENEFIT-CODE            PIC XX.
  4253             20  CF-BENEFIT-NUMERIC  REDEFINES
  4254                 CF-BENEFIT-CODE            PIC XX.
  4255             20  CF-BENEFIT-ALPHA           PIC XXX.
  4256             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4257             20  CF-BENEFIT-COMMENT         PIC X(10).
  4258
  4259             20  CF-LF-COVERAGE-TYPE        PIC X.
  4260                 88  CF-REDUCING                VALUE 'R'.
  4261                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4262
  4263             20  CF-SPECIAL-CALC-CD         PIC X.
  4264                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4265                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4266                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4267                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4268                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4269                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4270                 88  CF-FARM-PLAN               VALUE 'F'.
  4271                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4272                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4273                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4274                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4275                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4276                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4277                 88  CF-PRUDENTIAL              VALUE 'P'.
  4278                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  80
* EL130.cbl
  4279                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4280                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4281                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4282                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4283                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4284
  4285             20  CF-JOINT-INDICATOR         PIC X.
  4286                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4287
  4288*            20  FILLER                     PIC X(12).
  4289             20  cf-maximum-benefits        pic s999 comp-3.
  4290             20  FILLER                     PIC X(09).
  4291             20  CF-BENEFIT-CATEGORY        PIC X.
  4292             20  CF-LOAN-TYPE               PIC X(8).
  4293
  4294             20  CF-CO-REM-TERM-CALC        PIC X.
  4295                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4296                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4297                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4298                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4299                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4300
  4301             20  CF-CO-EARNINGS-CALC        PIC X.
  4302                 88  CO-EARN-BY-R78             VALUE '1'.
  4303                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4304                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4305                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4306                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4307                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4308                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4309                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4310
  4311             20  CF-CO-REFUND-CALC          PIC X.
  4312                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4313                 88  CO-REFD-BY-R78             VALUE '1'.
  4314                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4315                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4316                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4317                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4318                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4319                 88  CO-REFD-MEAN               VALUE '8'.
  4320                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4321                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4322                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4323
  4324             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4325                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4326                 88  CO-OVRD-BY-R78             VALUE '1'.
  4327                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4328                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4329                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4330                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4331                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4332                 88  CO-OVRD-MEAN               VALUE '8'.
  4333                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4334
  4335             20  CF-CO-BEN-I-G-CD           PIC X.
  4336                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  81
* EL130.cbl
  4337                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4338                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4339
  4340         16  FILLER                         PIC X(304).
  4341
  4342
  4343****************************************************************
  4344*             CARRIER MASTER RECORD                            *
  4345****************************************************************
  4346
  4347     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4348         16  CF-ADDRESS-DATA.
  4349             20  CF-MAIL-TO-NAME            PIC X(30).
  4350             20  CF-IN-CARE-OF              PIC X(30).
  4351             20  CF-ADDRESS-LINE-1          PIC X(30).
  4352             20  CF-ADDRESS-LINE-2          PIC X(30).
  4353             20  CF-CITY-STATE              PIC X(30).
  4354             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4355             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4356
  4357         16  CF-CLAIM-NO-CONTROL.
  4358             20  CF-CLAIM-NO-METHOD         PIC X.
  4359                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4360                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4361                 88  CLAIM-NO-SEQ               VALUE '3'.
  4362                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4363             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4364                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4365                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4366                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4367
  4368         16  CF-CHECK-NO-CONTROL.
  4369             20  CF-CHECK-NO-METHOD         PIC X.
  4370                 88  CHECK-NO-MANUAL            VALUE '1'.
  4371                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4372                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4373                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4374             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4375                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4376
  4377         16  CF-DOMICILE-STATE              PIC XX.
  4378
  4379         16  CF-EXPENSE-CONTROLS.
  4380             20  CF-EXPENSE-METHOD          PIC X.
  4381                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4382                 88  DOLLARS-PER-PMT            VALUE '2'.
  4383                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4384                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4385             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4386             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4387
  4388         16  CF-CORRESPONDENCE-CONTROL.
  4389             20  CF-LETTER-RESEND-OPT       PIC X.
  4390                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4391                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4392             20  FILLER                     PIC X(4).
  4393
  4394         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  82
* EL130.cbl
  4395             20  CF-MANUAL-SW               PIC X.
  4396                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4397             20  CF-FUTURE-SW               PIC X.
  4398                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4399             20  CF-PTC-SW                  PIC X.
  4400                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4401             20  CF-IBNR-SW                 PIC X.
  4402                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4403             20  CF-PTC-LF-SW               PIC X.
  4404                 88  CF-LF-PTC-USED             VALUE '1'.
  4405             20  CF-CDT-ACCESS-METHOD       PIC X.
  4406                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4407                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4408                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4409             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4410
  4411         16  CF-CLAIM-CALC-METHOD           PIC X.
  4412             88  360-PLUS-MONTHS                VALUE '1'.
  4413             88  365-PLUS-MONTHS                VALUE '2'.
  4414             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4415             88  360-DAILY                      VALUE '4'.
  4416             88  365-DAILY                      VALUE '5'.
  4417
  4418         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4419         16  FILLER                         PIC X(11).
  4420
  4421         16  CF-LIMIT-AMOUNTS.
  4422             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4423             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4424             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4425             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4426             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4427             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4428             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4429             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4430             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4431             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4432
  4433         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4434         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4435         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4436
  4437         16  CF-ZIP-CODE.
  4438             20  CF-ZIP-PRIME.
  4439                 24  CF-ZIP-1ST             PIC X.
  4440                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4441                 24  FILLER                 PIC X(4).
  4442             20  CF-ZIP-PLUS4               PIC X(4).
  4443         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4444             20  CF-CAN-POSTAL-1            PIC XXX.
  4445             20  CF-CAN-POSTAL-2            PIC XXX.
  4446             20  FILLER                     PIC XXX.
  4447
  4448         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4449         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4450         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4451
  4452         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  83
* EL130.cbl
  4453             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4454             88  CF-NO-RATING                   VALUE 'N'.
  4455
  4456         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4457
  4458         16  CF-CARRIER-OVER-SHORT.
  4459             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4460             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4461
  4462         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4463         16  CF-SECPAY-SWITCH               PIC X.
  4464             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4465             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4466         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4467         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4468         16  FILLER                         PIC X(444).
  4469*        16  FILLER                         PIC X(452).
  4470
  4471
  4472****************************************************************
  4473*             MORTALITY MASTER RECORD                          *
  4474****************************************************************
  4475
  4476     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4477         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4478                                INDEXED BY CF-MORT-NDX.
  4479             20  CF-MORT-TABLE              PIC X(5).
  4480             20  CF-MORT-TABLE-TYPE         PIC X.
  4481                 88  CF-MORT-JOINT              VALUE 'J'.
  4482                 88  CF-MORT-SINGLE             VALUE 'S'.
  4483                 88  CF-MORT-COMBINED           VALUE 'C'.
  4484                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4485                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4486             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4487             20  CF-MORT-AGE-METHOD         PIC XX.
  4488                 88  CF-AGE-LAST                VALUE 'AL'.
  4489                 88  CF-AGE-NEAR                VALUE 'AN'.
  4490             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4491             20  CF-MORT-ADJUSTMENT-DIRECTION
  4492                                            PIC X.
  4493                 88  CF-MINUS                   VALUE '-'.
  4494                 88  CF-PLUS                    VALUE '+'.
  4495             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4496             20  CF-MORT-JOINT-CODE         PIC X.
  4497                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4498             20  CF-MORT-PC-Q               PIC X.
  4499                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4500             20  CF-MORT-TABLE-CODE         PIC X(4).
  4501             20  CF-MORT-COMMENTS           PIC X(15).
  4502             20  FILLER                     PIC X(14).
  4503
  4504         16  FILLER                         PIC X(251).
  4505
  4506
  4507****************************************************************
  4508*             BUSSINESS TYPE MASTER RECORD                     *
  4509****************************************************************
  4510
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  84
* EL130.cbl
  4511     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4512* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4513* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4514* AND RECORD 05 IS TYPES 81-99
  4515         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4516             20  CF-BUSINESS-TITLE          PIC  X(19).
  4517             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4518                                            PIC S9V9(4) COMP-3.
  4519             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4520             20  FILLER                     PIC  X.
  4521         16  FILLER                         PIC  X(248).
  4522
  4523
  4524****************************************************************
  4525*             TERMINAL MASTER RECORD                           *
  4526****************************************************************
  4527
  4528     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4529
  4530         16  CF-COMPANY-TERMINALS.
  4531             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4532                                  PIC X(4).
  4533         16  FILLER               PIC X(248).
  4534
  4535
  4536****************************************************************
  4537*             LIFE EDIT MASTER RECORD                          *
  4538****************************************************************
  4539
  4540     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4541         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4542             20  CF-LIFE-CODE-IN            PIC XX.
  4543             20  CF-LIFE-CODE-OUT           PIC XX.
  4544         16  FILLER                         PIC X(248).
  4545
  4546
  4547****************************************************************
  4548*             AH EDIT MASTER RECORD                            *
  4549****************************************************************
  4550
  4551     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4552         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4553             20  CF-AH-CODE-IN              PIC XXX.
  4554             20  CF-AH-CODE-OUT             PIC XX.
  4555         16  FILLER                         PIC X(248).
  4556
  4557
  4558****************************************************************
  4559*             CREDIBILITY TABLES                               *
  4560****************************************************************
  4561
  4562     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4563         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4564                             INDEXED BY CF-CRDB-NDX.
  4565             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4566             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4567             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4568         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  85
* EL130.cbl
  4569
  4570
  4571****************************************************************
  4572*             REPORT CUSTOMIZATION RECORD                      *
  4573****************************************************************
  4574
  4575     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4576         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4577             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4578             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4579             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4580**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4581****       A T-TRANSFER.                                   ****
  4582             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4583
  4584         16  FILLER                         PIC XX.
  4585
  4586         16  CF-CARRIER-CNTL-OPT.
  4587             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4588                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4589                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4590             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4591                                            PIC X.
  4592         16  CF-GROUP-CNTL-OPT.
  4593             20  CF-GROUP-OPT-SEQ           PIC 9.
  4594                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4595                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4596             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4597                                            PIC X(6).
  4598         16  CF-STATE-CNTL-OPT.
  4599             20  CF-STATE-OPT-SEQ           PIC 9.
  4600                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4601                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4602             20  CF-STATE-SELECT OCCURS 3 TIMES
  4603                                            PIC XX.
  4604         16  CF-ACCOUNT-CNTL-OPT.
  4605             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4606                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4607                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4608             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4609                                            PIC X(10).
  4610         16  CF-BUS-TYP-CNTL-OPT.
  4611             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4612                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4613                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4614             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4615                                            PIC XX.
  4616         16  CF-LF-TYP-CNTL-OPT.
  4617             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4618                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4619                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4620             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4621                                            PIC XX.
  4622         16  CF-AH-TYP-CNTL-OPT.
  4623             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4624                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4625                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4626             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  86
* EL130.cbl
  4627                                            PIC XX.
  4628         16  CF-REPTCD1-CNTL-OPT.
  4629             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4630                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4631                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4632             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4633                                            PIC X(10).
  4634         16  CF-REPTCD2-CNTL-OPT.
  4635             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4636                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4637                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4638             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4639                                            PIC X(10).
  4640         16  CF-USER1-CNTL-OPT.
  4641             20  CF-USER1-OPT-SEQ           PIC 9.
  4642                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4643                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4644             20  CF-USER1-SELECT OCCURS 3 TIMES
  4645                                            PIC X(10).
  4646         16  CF-USER2-CNTL-OPT.
  4647             20  CF-USER2-OPT-SEQ           PIC 9.
  4648                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4649                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4650             20  CF-USER2-SELECT OCCURS 3 TIMES
  4651                                            PIC X(10).
  4652         16  CF-USER3-CNTL-OPT.
  4653             20  CF-USER3-OPT-SEQ           PIC 9.
  4654                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4655                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4656             20  CF-USER3-SELECT OCCURS 3 TIMES
  4657                                            PIC X(10).
  4658         16  CF-USER4-CNTL-OPT.
  4659             20  CF-USER4-OPT-SEQ           PIC 9.
  4660                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4661                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4662             20  CF-USER4-SELECT OCCURS 3 TIMES
  4663                                            PIC X(10).
  4664         16  CF-USER5-CNTL-OPT.
  4665             20  CF-USER5-OPT-SEQ           PIC 9.
  4666                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4667                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4668             20  CF-USER5-SELECT OCCURS 3 TIMES
  4669                                            PIC X(10).
  4670         16  CF-REINS-CNTL-OPT.
  4671             20  CF-REINS-OPT-SEQ           PIC 9.
  4672                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4673                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4674             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4675                 24  CF-REINS-PRIME         PIC XXX.
  4676                 24  CF-REINS-SUB           PIC XXX.
  4677
  4678         16  CF-AGENT-CNTL-OPT.
  4679             20  CF-AGENT-OPT-SEQ           PIC 9.
  4680                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4681                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4682             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4683                                            PIC X(10).
  4684
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  87
* EL130.cbl
  4685         16  FILLER                         PIC X(43).
  4686
  4687         16  CF-LOSS-RATIO-SELECT.
  4688             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4689             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4690         16  CF-ENTRY-DATE-SELECT.
  4691             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4692             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4693         16  CF-EFFECTIVE-DATE-SELECT.
  4694             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4695             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4696
  4697         16  CF-EXCEPTION-LIST-IND          PIC X.
  4698             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4699
  4700         16  FILLER                         PIC X(318).
  4701
  4702****************************************************************
  4703*                  EXCEPTION REPORTING RECORD                  *
  4704****************************************************************
  4705
  4706     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4707         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4708             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4709
  4710         16  CF-COMBINED-LIFE-AH-OPT.
  4711             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4712             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4713             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4714             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4715
  4716         16  CF-LIFE-OPT.
  4717             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4718             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4719             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4720             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4721             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4722             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4723             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4724             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4725             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4726             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4727
  4728         16  CF-AH-OPT.
  4729             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4730             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4731             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4732             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4733             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4734             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4735             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4736             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4737             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4738             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4739
  4740         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4741             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4742             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  88
* EL130.cbl
  4743             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4744
  4745         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4746
  4747         16  FILLER                         PIC X(673).
  4748
  4749
  4750****************************************************************
  4751*             MORTGAGE SYSTEM PLAN RECORD                      *
  4752****************************************************************
  4753
  4754     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4755         16  CF-PLAN-TYPE                   PIC X.
  4756             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4757             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4758             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4759         16  CF-PLAN-ABBREV                 PIC XXX.
  4760         16  CF-PLAN-DESCRIPT               PIC X(10).
  4761         16  CF-PLAN-NOTES                  PIC X(20).
  4762         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4763         16  CF-PLAN-UNDERWRITING.
  4764             20  CF-PLAN-TERM-DATA.
  4765                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4766                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4767             20  CF-PLAN-AGE-DATA.
  4768                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4769                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4770                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4771             20  CF-PLAN-BENEFIT-DATA.
  4772                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4773                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4774                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4775                                            PIC S9(7)V99  COMP-3.
  4776         16  CF-PLAN-POLICY-FORMS.
  4777             20  CF-POLICY-FORM             PIC X(12).
  4778             20  CF-MASTER-APPLICATION      PIC X(12).
  4779             20  CF-MASTER-POLICY           PIC X(12).
  4780         16  CF-PLAN-RATING.
  4781             20  CF-RATE-CODE               PIC X(5).
  4782             20  CF-SEX-RATING              PIC X.
  4783                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4784                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4785             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4786             20  CF-SUB-STD-TYPE            PIC X.
  4787                 88  CF-PCT-OF-PREM            VALUE '1'.
  4788                 88  CF-PCT-OF-BENE            VALUE '2'.
  4789         16  CF-PLAN-PREM-TOLERANCES.
  4790             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4791             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4792         16  CF-PLAN-PYMT-TOLERANCES.
  4793             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4794             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4795         16  CF-PLAN-MISC-DATA.
  4796             20  FILLER                     PIC X.
  4797             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4798             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4799         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4800         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  89
* EL130.cbl
  4801             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4802                                                     '1'.
  4803             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4804                                                     '2'.
  4805         16  CF-MIB-SEARCH-SW               PIC X.
  4806             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4807             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4808             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4809             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4810         16  CF-ALPHA-SEARCH-SW             PIC X.
  4811             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4812             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4813             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4814             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4815             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4816             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4817             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4818             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4819             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4820             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4821                                                     'A' 'B' 'C'
  4822                                                     'X' 'Y' 'Z'.
  4823         16  CF-EFF-DT-RULE-SW              PIC X.
  4824             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4825             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4826             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4827             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4828             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4829         16  FILLER                         PIC X(4).
  4830         16  CF-HEALTH-QUESTIONS            PIC X.
  4831             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4832         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4833         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4834         16  CF-PLAN-SNGL-JNT               PIC X.
  4835             88  CF-COMBINED-PLAN              VALUE 'C'.
  4836             88  CF-JNT-PLAN                   VALUE 'J'.
  4837             88  CF-SNGL-PLAN                  VALUE 'S'.
  4838         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4839         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4840         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4841         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4842         16  CF-RERATE-CNTL                 PIC  X.
  4843             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4844             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4845             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4846             88  CF-AUTO-RECALC                 VALUE '4'.
  4847         16  CF-BENEFIT-TYPE                PIC  X.
  4848             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4849             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4850         16  CF-POLICY-FEE                  PIC S999V99
  4851                                                    COMP-3.
  4852         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4853         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4854         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4855         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4856         16  FILLER                         PIC  X(32).
  4857         16  CF-TERMINATION-FORM            PIC  X(04).
  4858         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  90
* EL130.cbl
  4859         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4860                                                       COMP-3.
  4861         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4862         16  CF-ISSUE-LETTER                PIC  X(4).
  4863         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4864         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4865             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4866             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4867         16  CF-MP-REFUND-CALC              PIC X.
  4868             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4869             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4870             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4871             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4872             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4873             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4874             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4875             88  CF-MP-REFD-MEAN                VALUE '8'.
  4876         16  CF-ALT-RATE-CODE               PIC  X(5).
  4877
  4878
  4879         16  FILLER                         PIC X(498).
  4880****************************************************************
  4881*             MORTGAGE COMPANY MASTER RECORD                   *
  4882****************************************************************
  4883
  4884     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4885         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4886         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4887             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4888             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4889             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4890             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4891             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4892
  4893         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4894         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4895         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4896         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4897         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4898
  4899         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4900             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4901         16  CF-MP-RECON-USE-IND            PIC X(1).
  4902             88  CF-MP-USE-RECON             VALUE 'Y'.
  4903         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4904             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4905         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4906             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4907             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4908         16  FILLER                         PIC X(1).
  4909         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4910             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4911         16  CF-MORTG-MIB-VERSION           PIC X.
  4912             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4913             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4914             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4915         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4916             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  91
* EL130.cbl
  4917                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4918             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4919                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4920             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4921                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4922             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4923                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4924             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4925                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4926             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4927                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4928         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4929         16  FILLER                         PIC X(7).
  4930         16  CF-MORTG-DESTINATION-SYMBOL.
  4931             20  CF-MORTG-MIB-COMM          PIC X(5).
  4932             20  CF-MORTG-MIB-TERM          PIC X(5).
  4933         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4934             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4935         16  FILLER                         PIC X(03).
  4936         16  CF-MP-CHECK-NO-CONTROL.
  4937             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4938                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4939                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4940                                                ' ' LOW-VALUES.
  4941                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4942                                               VALUE '3'.
  4943         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4944         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4945         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4946             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4947                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4948             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4949                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4950             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4951                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4952             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4953                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4954             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4955                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4956             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4957                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4958         16  CF-MORTG-BILLING-AREA.
  4959             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4960                                            PIC X.
  4961         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4962         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4963         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4964         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4965             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4966             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4967         16  FILLER                         PIC X.
  4968         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4969             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4970             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4971         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4972         16  FILLER                         PIC X(8).
  4973         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4974         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  92
* EL130.cbl
  4975         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4976         16  CF-ACH-COMPANY-ID.
  4977             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4978                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4979                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4980                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4981             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4982         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4983             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4984         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4985             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4986             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4987         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4988         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4989         16  FILLER                         PIC X(536).
  4990
  4991****************************************************************
  4992*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4993****************************************************************
  4994
  4995     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4996         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4997             20  CF-FEMALE-HEIGHT.
  4998                 24  CF-FEMALE-FT           PIC 99.
  4999                 24  CF-FEMALE-IN           PIC 99.
  5000             20  CF-FEMALE-MIN-WT           PIC 999.
  5001             20  CF-FEMALE-MAX-WT           PIC 999.
  5002         16  FILLER                         PIC X(428).
  5003
  5004     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5005         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5006             20  CF-MALE-HEIGHT.
  5007                 24  CF-MALE-FT             PIC 99.
  5008                 24  CF-MALE-IN             PIC 99.
  5009             20  CF-MALE-MIN-WT             PIC 999.
  5010             20  CF-MALE-MAX-WT             PIC 999.
  5011         16  FILLER                         PIC X(428).
  5012******************************************************************
  5013*             AUTOMATIC ACTIVITY RECORD                          *
  5014******************************************************************
  5015     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5016         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5017             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5018             20  CF-SYS-LETTER-ID           PIC X(04).
  5019             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5020             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5021             20  CF-SYS-RESET-SW            PIC X(01).
  5022             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5023             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5024
  5025         16  FILLER                         PIC X(50).
  5026
  5027         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5028             20  CF-USER-ACTIVE-SW          PIC X(01).
  5029             20  CF-USER-LETTER-ID          PIC X(04).
  5030             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5031             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5032             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  93
* EL130.cbl
  5033             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5034             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5035             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5036
  5037         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  94
* EL130.cbl
  5039*    COPY ELCCERT.
  5040******************************************************************
  5041*                                                                *
  5042*                            ELCCERT.                            *
  5043*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5044*                            VMOD=2.013                          *
  5045*                                                                *
  5046*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5047*                                                                *
  5048*   FILE TYPE = VSAM,KSDS                                        *
  5049*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5050*                                                                *
  5051*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5052*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5053*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5054*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5055*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5056*                                                                *
  5057*   LOG = YES                                                    *
  5058*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5059******************************************************************
  5060*                   C H A N G E   L O G
  5061*
  5062* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5063*-----------------------------------------------------------------
  5064*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5065* EFFECTIVE    NUMBER
  5066*-----------------------------------------------------------------
  5067* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5068* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5069* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5070* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5071* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5072* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5073* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5074* 032612  CR2011110200001  PEMA  AHL CHANGES
  5075* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5076* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5077******************************************************************
  5078
  5079 01  CERTIFICATE-MASTER.
  5080     12  CM-RECORD-ID                      PIC XX.
  5081         88  VALID-CM-ID                      VALUE 'CM'.
  5082
  5083     12  CM-CONTROL-PRIMARY.
  5084         16  CM-COMPANY-CD                 PIC X.
  5085         16  CM-CARRIER                    PIC X.
  5086         16  CM-GROUPING.
  5087             20  CM-GROUPING-PREFIX        PIC X(3).
  5088             20  CM-GROUPING-PRIME         PIC X(3).
  5089         16  CM-STATE                      PIC XX.
  5090         16  CM-ACCOUNT.
  5091             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5092             20  CM-ACCOUNT-PRIME          PIC X(6).
  5093         16  CM-CERT-EFF-DT                PIC XX.
  5094         16  CM-CERT-NO.
  5095             20  CM-CERT-PRIME             PIC X(10).
  5096             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  95
* EL130.cbl
  5097
  5098     12  CM-CONTROL-BY-NAME.
  5099         16  CM-COMPANY-CD-A1              PIC X.
  5100         16  CM-INSURED-LAST-NAME          PIC X(15).
  5101         16  CM-INSURED-INITIALS.
  5102             20  CM-INSURED-INITIAL1       PIC X.
  5103             20  CM-INSURED-INITIAL2       PIC X.
  5104
  5105     12  CM-CONTROL-BY-SSN.
  5106         16  CM-COMPANY-CD-A2              PIC X.
  5107         16  CM-SOC-SEC-NO.
  5108             20  CM-SSN-STATE              PIC XX.
  5109             20  CM-SSN-ACCOUNT            PIC X(6).
  5110             20  CM-SSN-LN3.
  5111                 25  CM-INSURED-INITIALS-A2.
  5112                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5113                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5114                 25 CM-PART-LAST-NAME-A2         PIC X.
  5115
  5116     12  CM-CONTROL-BY-CERT-NO.
  5117         16  CM-COMPANY-CD-A4              PIC X.
  5118         16  CM-CERT-NO-A4                 PIC X(11).
  5119
  5120     12  CM-CONTROL-BY-MEMB.
  5121         16  CM-COMPANY-CD-A5              PIC X.
  5122         16  CM-MEMBER-NO.
  5123             20  CM-MEMB-STATE             PIC XX.
  5124             20  CM-MEMB-ACCOUNT           PIC X(6).
  5125             20  CM-MEMB-LN4.
  5126                 25  CM-INSURED-INITIALS-A5.
  5127                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5128                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5129                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5130
  5131     12  CM-INSURED-PROFILE-DATA.
  5132         16  CM-INSURED-FIRST-NAME.
  5133             20  CM-INSURED-1ST-INIT       PIC X.
  5134             20  FILLER                    PIC X(9).
  5135         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5136         16  CM-INSURED-SEX                PIC X.
  5137             88  CM-SEX-MALE                  VALUE 'M'.
  5138             88  CM-SEX-FEMAL                 VALUE 'F'.
  5139         16  CM-INSURED-JOINT-AGE          PIC 99.
  5140         16  CM-JOINT-INSURED-NAME.
  5141             20  CM-JT-LAST-NAME           PIC X(15).
  5142             20  CM-JT-FIRST-NAME.
  5143                 24  CM-JT-1ST-INIT        PIC X.
  5144                 24  FILLER                PIC X(9).
  5145             20  CM-JT-INITIAL             PIC X.
  5146
  5147     12  CM-LIFE-DATA.
  5148         16  CM-LF-BENEFIT-CD              PIC XX.
  5149         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5150         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5151         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5152         16  CM-LF-DEV-CODE                PIC XXX.
  5153         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5154         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  96
* EL130.cbl
  5155         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5156         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5157         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5158         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5159         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5160         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5161         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5162         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5163         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5164         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5165         16  cm-temp-epiq                  pic xx.
  5166             88  EPIQ-CLASS                  value 'EQ'.
  5167*        16  FILLER                        PIC XX.
  5168
  5169     12  CM-AH-DATA.
  5170         16  CM-AH-BENEFIT-CD              PIC XX.
  5171         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5172         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5173         16  CM-AH-DEV-CODE                PIC XXX.
  5174         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5175         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5176         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5177         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5178         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5179         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5180         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5181         16  CM-AH-PAID-THRU-DT            PIC XX.
  5182             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5183         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5184         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5185         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5186         16  FILLER                        PIC X.
  5187
  5188     12  CM-LOAN-INFORMATION.
  5189         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5190         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5191                                           PIC S9(5)V99  COMP-3.
  5192         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5193         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5194         16  CM-PAY-FREQUENCY              PIC S99.
  5195         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5196         16  CM-RATE-CLASS                 PIC XX.
  5197         16  CM-BENEFICIARY                PIC X(25).
  5198         16  CM-POLICY-FORM-NO             PIC X(12).
  5199         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5200         16  CM-LAST-ADD-ON-DT             PIC XX.
  5201         16  CM-DEDUCTIBLE-AMOUNTS.
  5202             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5203             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5204         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5205             20  CM-RESIDENT-STATE         PIC XX.
  5206             20  CM-RATE-CODE              PIC X(4).
  5207             20  FILLER                    PIC XX.
  5208         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5209             20  CM-LOAN-OFFICER           PIC X(5).
  5210             20  FILLER                    PIC XXX.
  5211         16  CM-CSR-CODE                   PIC XXX.
  5212         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  97
* EL130.cbl
  5213             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5214         16  CM-POST-CARD-IND              PIC X.
  5215         16  CM-NH-INTERFACE-SW            PIC X.
  5216         16  CM-PREMIUM-TYPE               PIC X.
  5217             88  CM-SING-PRM                  VALUE '1'.
  5218             88  CM-O-B-COVERAGE              VALUE '2'.
  5219             88  CM-OPEN-END                  VALUE '3'.
  5220         16  CM-IND-GRP-TYPE               PIC X.
  5221             88  CM-INDIVIDUAL                VALUE 'I'.
  5222             88  CM-GROUP                     VALUE 'G'.
  5223         16  CM-SKIP-CODE                  PIC X.
  5224             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5225             88  SKIP-JULY                    VALUE '1'.
  5226             88  SKIP-AUGUST                  VALUE '2'.
  5227             88  SKIP-SEPTEMBER               VALUE '3'.
  5228             88  SKIP-JULY-AUG                VALUE '4'.
  5229             88  SKIP-AUG-SEPT                VALUE '5'.
  5230             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5231             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5232             88  SKIP-JUNE                    VALUE '8'.
  5233             88  SKIP-JUNE-JULY               VALUE '9'.
  5234             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5235             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5236         16  CM-PAYMENT-MODE               PIC X.
  5237             88  PAY-MONTHLY                  VALUE SPACE.
  5238             88  PAY-WEEKLY                   VALUE '1'.
  5239             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5240             88  PAY-BI-WEEKLY                VALUE '3'.
  5241             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5242         16  CM-LOAN-NUMBER                PIC X(8).
  5243         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5244         16  CM-OLD-LOF                    PIC XXX.
  5245*        16  CM-LOAN-OFFICER               PIC XXX.
  5246         16  CM-REIN-TABLE                 PIC XXX.
  5247         16  CM-SPECIAL-REIN-CODE          PIC X.
  5248         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5249         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5250         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5251
  5252     12  CM-STATUS-DATA.
  5253         16  CM-ENTRY-STATUS               PIC X.
  5254         16  CM-ENTRY-DT                   PIC XX.
  5255
  5256         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5257         16  CM-LF-CANCEL-DT               PIC XX.
  5258         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5259
  5260         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5261         16  CM-LF-DEATH-DT                PIC XX.
  5262         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5263
  5264         16  CM-LF-CURRENT-STATUS          PIC X.
  5265             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5266                                                'M' '4' '5' '9'.
  5267             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5268             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5269             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5270             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  98
* EL130.cbl
  5271             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5272             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5273             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5274             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5275             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5276             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5277             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5278             88  CM-LF-DECLINED               VALUE 'D'.
  5279             88  CM-LF-VOIDED                 VALUE 'V'.
  5280
  5281         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5282         16  CM-AH-CANCEL-DT               PIC XX.
  5283         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5284
  5285         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5286         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5287         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5288
  5289         16  CM-AH-CURRENT-STATUS          PIC X.
  5290             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5291                                                'M' '4' '5' '9'.
  5292             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5293             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5294             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5295             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5296             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5297             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5298             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5299             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5300             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5301             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5302             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5303             88  CM-AH-DECLINED               VALUE 'D'.
  5304             88  CM-AH-VOIDED                 VALUE 'V'.
  5305
  5306         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5307             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5308             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5309             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5310         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5311
  5312         16  CM-ENTRY-BATCH                PIC X(6).
  5313         16  CM-LF-EXIT-BATCH              PIC X(6).
  5314         16  CM-AH-EXIT-BATCH              PIC X(6).
  5315         16  CM-LAST-MONTH-END             PIC XX.
  5316
  5317     12  CM-NOTE-SW                        PIC X.
  5318         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5319         88  CERT-NOTES-PRESENT               VALUE '1'.
  5320         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5321         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5322         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5323         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5324         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5325         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5326     12  CM-COMP-EXCP-SW                   PIC X.
  5327         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5328         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page  99
* EL130.cbl
  5329     12  CM-INSURED-ADDRESS-SW             PIC X.
  5330         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5331         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5332
  5333*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5334     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5335     12  FILLER                            PIC X.
  5336
  5337*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5338     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5339     12  FILLER                            PIC X.
  5340*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5341     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5342
  5343     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5344         88  CERT-ADDED-BATCH                 VALUE ' '.
  5345         88  CERT-ADDED-ONLINE                VALUE '1'.
  5346         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5347         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5348         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5349     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5350         88  CERT-AS-LOADED                   VALUE ' '.
  5351         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5352         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5353         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5354         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5355         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5356         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5357         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5358
  5359     12  CM-ACCOUNT-COMM-PCTS.
  5360         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5361         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5362
  5363     12  CM-USER-FIELD                     PIC X.
  5364     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5365     12  CM-CLP-STATE                      PIC XX.
  5366     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5367     12  CM-USER-RESERVED                  PIC XXX.
  5368     12  FILLER REDEFINES CM-USER-RESERVED.
  5369         16  CM-AH-CLASS-CD                PIC XX.
  5370         16  F                             PIC X.
  5371******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 100
* EL130.cbl
  5373*    COPY ERCACCT.
  5374******************************************************************
  5375*                                                                *
  5376*                                                                *
  5377*                            ERCACCT                             *
  5378*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5379*                            VMOD=2.031                          *
  5380*                                                                *
  5381*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5382*                                                                *
  5383*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5384*   VSAM ACCOUNT MASTER FILES.                                   *
  5385*                                                                *
  5386*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5387*                                                                *
  5388*   FILE TYPE = VSAM,KSDS                                        *
  5389*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5390*                                                                *
  5391*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5392*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5393*                                                                *
  5394*   LOG = NO                                                     *
  5395*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5396*                                                                *
  5397*                                                                *
  5398******************************************************************
  5399*                   C H A N G E   L O G
  5400*
  5401* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5402*-----------------------------------------------------------------
  5403*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5404* EFFECTIVE    NUMBER
  5405*-----------------------------------------------------------------
  5406* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5407* 092705    2005050300006  PEMA  ADD SPP LEASES
  5408* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5409* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5410* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5411* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5412* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5413* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  5414******************************************************************
  5415
  5416 01  ACCOUNT-MASTER.
  5417     12  AM-RECORD-ID                      PIC XX.
  5418         88  VALID-AM-ID                      VALUE 'AM'.
  5419
  5420     12  AM-CONTROL-PRIMARY.
  5421         16  AM-COMPANY-CD                 PIC X.
  5422         16  AM-MSTR-CNTRL.
  5423             20  AM-CONTROL-A.
  5424                 24  AM-CARRIER            PIC X.
  5425                 24  AM-GROUPING.
  5426                     28 AM-GROUPING-PREFIX PIC XXX.
  5427                     28 AM-GROUPING-PRIME  PIC XXX.
  5428                 24  AM-STATE              PIC XX.
  5429                 24  AM-ACCOUNT.
  5430                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 101
* EL130.cbl
  5431                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5432             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5433                                           PIC X(19).
  5434             20  AM-CNTRL-B.
  5435                 24  AM-EXPIRATION-DT      PIC XX.
  5436                 24  FILLER                PIC X(4).
  5437             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5438                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5439
  5440     12  AM-CONTROL-BY-VAR-GRP.
  5441         16  AM-COMPANY-CD-A1              PIC X.
  5442         16  AM-VG-CARRIER                 PIC X.
  5443         16  AM-VG-GROUPING                PIC X(6).
  5444         16  AM-VG-STATE                   PIC XX.
  5445         16  AM-VG-ACCOUNT                 PIC X(10).
  5446         16  AM-VG-DATE.
  5447             20  AM-VG-EXPIRATION-DT       PIC XX.
  5448             20  FILLER                    PIC X(4).
  5449         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5450                                           PIC 9(11)      COMP-3.
  5451     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5452         16  FILLER                        PIC X(10).
  5453         16  AM-VG-KEY3.
  5454             20  AM-VG3-ACCOUNT            PIC X(10).
  5455             20  AM-VG3-EXP-DT             PIC XX.
  5456         16  FILLER                        PIC X(4).
  5457     12  AM-MAINT-INFORMATION.
  5458         16  AM-LAST-MAINT-DT              PIC XX.
  5459         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5460         16  AM-LAST-MAINT-USER            PIC X(4).
  5461         16  FILLER                        PIC XX.
  5462
  5463     12  AM-EFFECTIVE-DT                   PIC XX.
  5464     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5465
  5466     12  AM-PREV-DATES  COMP-3.
  5467         16  AM-PREV-EXP-DT                PIC 9(11).
  5468         16  AM-PREV-EFF-DT                PIC 9(11).
  5469
  5470     12  AM-REPORT-CODE-1                  PIC X(10).
  5471     12  AM-REPORT-CODE-2                  PIC X(10).
  5472
  5473     12  AM-CITY-CODE                      PIC X(4).
  5474     12  AM-COUNTY-PARISH                  PIC X(6).
  5475
  5476     12  AM-NAME                           PIC X(30).
  5477     12  AM-PERSON                         PIC X(30).
  5478     12  AM-ADDRS                          PIC X(30).
  5479     12  AM-CITY.
  5480         16  AM-ADDR-CITY                  PIC X(28).
  5481         16  AM-ADDR-STATE                 PIC XX.
  5482     12  AM-ZIP.
  5483         16  AM-ZIP-PRIME.
  5484             20  AM-ZIP-PRI-1ST            PIC X.
  5485                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5486             20  FILLER                    PIC X(4).
  5487         16  AM-ZIP-PLUS4                  PIC X(4).
  5488     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 102
* EL130.cbl
  5489         16  AM-CAN-POSTAL-1               PIC XXX.
  5490         16  AM-CAN-POSTAL-2               PIC XXX.
  5491         16  FILLER                        PIC XXX.
  5492     12  AM-TEL-NO.
  5493         16  AM-AREA-CODE                  PIC 999.
  5494         16  AM-TEL-PRE                    PIC 999.
  5495         16  AM-TEL-NBR                    PIC 9(4).
  5496     12  AM-TEL-LOC                        PIC X.
  5497         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5498         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5499
  5500     12  AM-COMM-STRUCTURE.
  5501         16  AM-DEFN-1.
  5502             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5503                 24  AM-AGT.
  5504                     28  AM-AGT-PREFIX     PIC X(4).
  5505                     28  AM-AGT-PRIME      PIC X(6).
  5506                 24  AM-COM-TYP            PIC X.
  5507                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5508                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5509                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5510                 24  AM-RECALC-LV-INDIC    PIC X.
  5511                 24  AM-RETRO-LV-INDIC     PIC X.
  5512                 24  AM-GL-CODES           PIC X.
  5513                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5514                 24  FILLER                PIC X(01).
  5515         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5516             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5517                 24  FILLER                PIC X(11).
  5518                 24  AM-L-COMA             PIC XXX.
  5519                 24  AM-J-COMA             PIC XXX.
  5520                 24  AM-A-COMA             PIC XXX.
  5521                 24  FILLER                PIC X(6).
  5522
  5523     12  AM-COMM-CHANGE-STATUS             PIC X.
  5524         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5525
  5526     12  AM-CSR-CODE                       PIC X(4).
  5527
  5528     12  AM-BILLING-STATUS                 PIC X.
  5529         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5530         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5531     12  AM-AUTO-REFUND-SW                 PIC X.
  5532         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5533         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5534     12  AM-GPCD                           PIC 99.
  5535     12  AM-IG                             PIC X.
  5536         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5537         88  AM-HAS-GROUP                     VALUE '2'.
  5538     12  AM-STATUS                         PIC X.
  5539         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5540         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5541         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5542         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5543         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5544         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5545         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  5546         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 103
* EL130.cbl
  5547         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  5548         88  AM-ACCOUNT-PENDING               VALUE '9'.
  5549     12  AM-REMIT-TO                       PIC 99.
  5550     12  AM-ID-NO                          PIC X(11).
  5551
  5552     12  AM-CAL-TABLE                      PIC XX.
  5553     12  AM-LF-DEVIATION                   PIC XXX.
  5554     12  AM-AH-DEVIATION                   PIC XXX.
  5555     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5556     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5557     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5558     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5559     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5560     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5561
  5562     12  AM-USER-FIELDS.
  5563         16  AM-FLD-1                      PIC XX.
  5564         16  AM-FLD-2                      PIC XX.
  5565         16  AM-FLD-3                      PIC XX.
  5566         16  AM-FLD-4                      PIC XX.
  5567         16  AM-FLD-5                      PIC XX.
  5568
  5569     12  AM-1ST-PROD-DATE.
  5570         16  AM-1ST-PROD-YR                PIC XX.
  5571         16  AM-1ST-PROD-MO                PIC XX.
  5572         16  AM-1ST-PROD-DA                PIC XX.
  5573     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5574     12  AM-CERTS-PURGED-DATE.
  5575         16  AM-PUR-YR                     PIC XX.
  5576         16  AM-PUR-MO                     PIC XX.
  5577         16  AM-PUR-DA                     PIC XX.
  5578     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5579     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5580     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5581     12  AM-INACTIVE-DATE.
  5582         16  AM-INA-MO                     PIC 99.
  5583         16  AM-INA-DA                     PIC 99.
  5584         16  AM-INA-YR                     PIC 99.
  5585     12  AM-AR-HI-CERT-DATE                PIC XX.
  5586
  5587     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5588     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5589
  5590     12  AM-OB-PAYMENT-MODE                PIC X.
  5591         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5592         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5593         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5594         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5595
  5596     12  AM-AH-ONLY-INDICATOR              PIC X.
  5597         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5598         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5599
  5600     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5601
  5602     12  AM-OVER-SHORT.
  5603         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5604         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 104
* EL130.cbl
  5605
  5606     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5607     12  AM-DCC-CLP-STATE                  PIC XX.
  5608
  5609     12  AM-RECALC-COMM                    PIC X.
  5610     12  AM-RECALC-REIN                    PIC X.
  5611
  5612     12  AM-REI-TABLE                      PIC XXX.
  5613     12  AM-REI-ET-LF                      PIC X.
  5614     12  AM-REI-ET-AH                      PIC X.
  5615     12  AM-REI-PE-LF                      PIC X.
  5616     12  AM-REI-PE-AH                      PIC X.
  5617     12  AM-REI-PRT-ST                     PIC X.
  5618     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5619     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5620     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5621     12  AM-REI-GROUP-A                    PIC X(6).
  5622     12  AM-REI-MORT                       PIC X(4).
  5623     12  AM-REI-PRT-OW                     PIC X.
  5624     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5625     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5626     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5627     12  AM-REI-GROUP-B                    PIC X(6).
  5628
  5629     12  AM-TRUST-TYPE                     PIC X(2).
  5630
  5631     12  AM-EMPLOYER-STMT-USED             PIC X.
  5632     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5633
  5634     12  AM-STD-AH-TYPE                    PIC XX.
  5635     12  AM-EARN-METHODS.
  5636         16  AM-EARN-METHOD-R              PIC X.
  5637             88 AM-REF-RL-R78                 VALUE 'R'.
  5638             88 AM-REF-RL-PR                  VALUE 'P'.
  5639             88 AM-REF-RL-MEAN                VALUE 'M'.
  5640             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5641         16  AM-EARN-METHOD-L              PIC X.
  5642             88 AM-REF-LL-R78                 VALUE 'R'.
  5643             88 AM-REF-LL-PR                  VALUE 'P'.
  5644             88 AM-REF-LL-MEAN                VALUE 'M'.
  5645             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5646         16  AM-EARN-METHOD-A              PIC X.
  5647             88 AM-REF-AH-R78                 VALUE 'R'.
  5648             88 AM-REF-AH-PR                  VALUE 'P'.
  5649             88 AM-REF-AH-MEAN                VALUE 'M'.
  5650             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5651             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5652             88 AM-REF-AH-NET                 VALUE 'N'.
  5653
  5654     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5655     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5656     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5657
  5658     12  AM-RET-Y-N                        PIC X.
  5659     12  AM-RET-P-E                        PIC X.
  5660     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5661     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5662     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 105
* EL130.cbl
  5663     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5664         16  AM-POOL-PRIME                 PIC XXX.
  5665         16  AM-POOL-SUB                   PIC XXX.
  5666     12  AM-RETRO-EARNINGS.
  5667         16  AM-RET-EARN-R                 PIC X.
  5668         16  AM-RET-EARN-L                 PIC X.
  5669         16  AM-RET-EARN-A                 PIC X.
  5670     12  AM-RET-ST-TAX-USE                 PIC X.
  5671         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5672         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5673     12  AM-RETRO-BEG-EARNINGS.
  5674         16  AM-RET-BEG-EARN-R             PIC X.
  5675         16  AM-RET-BEG-EARN-L             PIC X.
  5676         16  AM-RET-BEG-EARN-A             PIC X.
  5677     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5678     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5679
  5680     12  AM-USER-SELECT-OPTIONS.
  5681         16  AM-USER-SELECT-1              PIC X(10).
  5682         16  AM-USER-SELECT-2              PIC X(10).
  5683         16  AM-USER-SELECT-3              PIC X(10).
  5684         16  AM-USER-SELECT-4              PIC X(10).
  5685         16  AM-USER-SELECT-5              PIC X(10).
  5686
  5687     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5688
  5689     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5690
  5691     12  AM-RPT045A-SWITCH                 PIC X.
  5692         88  RPT045A-OFF                   VALUE 'N'.
  5693
  5694     12  AM-INSURANCE-LIMITS.
  5695         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5696         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5697
  5698     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5699         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5700
  5701     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5702         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5703         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5704
  5705     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5706
  5707     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5708     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5709     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5710     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5711     12  AM-DCC-UEF-STATE                  PIC XX.
  5712     12  FILLER                            PIC XXX.
  5713     12  AM-REPORT-CODE-3                  PIC X(10).
  5714*    12  FILLER                            PIC X(22).
  5715
  5716     12  AM-RESERVE-DATE.
  5717         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5718         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5719         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5720
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 106
* EL130.cbl
  5721     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5722     12  AM-NOTIFICATION-TYPES.
  5723         16  AM-NOTIF-OF-LETTERS           PIC X.
  5724         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5725         16  AM-NOTIF-OF-REPORTS           PIC X.
  5726         16  AM-NOTIF-OF-STATUS            PIC X.
  5727
  5728     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5729         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5730         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5731         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5732         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5733
  5734     12  AM-BENEFIT-CONTROLS.
  5735         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5736             20  AM-BENEFIT-CODE           PIC XX.
  5737             20  AM-BENEFIT-TYPE           PIC X.
  5738             20  AM-BENEFIT-REVISION       PIC XXX.
  5739             20  AM-BENEFIT-REM-TERM       PIC X.
  5740             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5741             20  FILLER                    PIC XX.
  5742         16  FILLER                        PIC X(80).
  5743
  5744     12  AM-TRANSFER-DATA.
  5745         16  AM-TRANSFERRED-FROM.
  5746             20  AM-TRNFROM-CARRIER        PIC X.
  5747             20  AM-TRNFROM-GROUPING.
  5748                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5749                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5750             20  AM-TRNFROM-STATE          PIC XX.
  5751             20  AM-TRNFROM-ACCOUNT.
  5752                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5753                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5754             20  AM-TRNFROM-DTE            PIC XX.
  5755         16  AM-TRANSFERRED-TO.
  5756             20  AM-TRNTO-CARRIER          PIC X.
  5757             20  AM-TRNTO-GROUPING.
  5758                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5759                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5760             20  AM-TRNTO-STATE            PIC XX.
  5761             20  AM-TRNTO-ACCOUNT.
  5762                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5763                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5764             20  AM-TRNTO-DTE              PIC XX.
  5765         16  FILLER                        PIC X(10).
  5766
  5767     12  AM-SAVED-REMIT-TO                 PIC 99.
  5768
  5769     12  AM-COMM-STRUCTURE-SAVED.
  5770         16  AM-DEFN-1-SAVED.
  5771             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5772                 24  AM-AGT-SV             PIC X(10).
  5773                 24  AM-COM-TYP-SV         PIC X.
  5774                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5775                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5776                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5777                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5778                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 107
* EL130.cbl
  5779                 24  AM-GL-CODES-SV        PIC X.
  5780                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5781                 24  FILLER                PIC X.
  5782         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5783             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5784                 24  FILLER                PIC X(11).
  5785                 24  AM-L-COMA-SV          PIC XXX.
  5786                 24  AM-J-COMA-SV          PIC XXX.
  5787                 24  AM-A-COMA-SV          PIC XXX.
  5788                 24  FILLER                PIC X(6).
  5789
  5790     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5791         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5792            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5793            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5794            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5795
  5796     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5797     12  FILLER                            PIC X(120).
  5798
  5799     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5800         16  AM-CONTROL-NAME               PIC X(30).
  5801         16  AM-EXECUTIVE-ONE.
  5802             20  AM-EXEC1-NAME             PIC X(15).
  5803             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5804                                                          COMP-3.
  5805             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5806                                                          COMP-3.
  5807         16  AM-EXECUTIVE-TWO.
  5808             20  AM-EXEC2-NAME             PIC X(15).
  5809             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5810                                                          COMP-3.
  5811             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5812                                                          COMP-3.
  5813
  5814     12  AM-RETRO-ADDITIONAL-DATA.
  5815         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5816         16  AM-RETRO-PREM-P-E             PIC X.
  5817         16  AM-RETRO-CLMS-P-I             PIC X.
  5818         16  AM-RETRO-RET-BRACKET-LF.
  5819             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5820                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5821                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5822             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5823                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5824                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5825             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5826                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5827                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5828         16  AM-RETRO-RET-BRACKET-AH.
  5829             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5830                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5831                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5832                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5833             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5834                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5835                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5836             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 108
* EL130.cbl
  5837                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5838                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5839
  5840     12  AM-COMMENTS.
  5841         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5842
  5843     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5844         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5845         16  AM-FLI-BILLING-CODE           PIC X.
  5846         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5847         16  AM-FLI-UNITED-IDENT           PIC X.
  5848         16  AM-FLI-INTEREST-LOST-DATA.
  5849             20  AM-FLI-BANK-NO            PIC X(5).
  5850             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5851             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5852             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5853         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5854             20  AM-FLI-AGT                PIC X(9).
  5855             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5856             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5857         16  FILLER                        PIC X(102).
  5858
  5859     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5860         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5861             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5862             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5863             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5864             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5865             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5866         16  FILLER                          PIC X(10).
  5867******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 109
* EL130.cbl
  5869*    COPY ELCTRLR.
  5870******************************************************************
  5871*                                                                *
  5872*                            ELCTRLR.                            *
  5873*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5874*                            VMOD=2.014                          *
  5875*                                                                *
  5876*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5877*                                                                *
  5878*   FILE TYPE = VSAM,KSDS                                        *
  5879*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5880*                                                                *
  5881*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5882*       ALTERNATE INDEX = NONE                                   *
  5883*                                                                *
  5884*   LOG = YES                                                    *
  5885*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5886******************************************************************
  5887*                   C H A N G E   L O G
  5888*
  5889* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5890*-----------------------------------------------------------------
  5891*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5892* EFFECTIVE    NUMBER
  5893*-----------------------------------------------------------------
  5894* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5895* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5896* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5897* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5898* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5899* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5900* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5901* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5902* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5903* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5904* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5905* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5906* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5907* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5908* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5909* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5910* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5911* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5912* 040814    2014030500002  AJRA  ADD ICD CODES
  5913* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5914* 013017  CR2016053100001  PEMA  ACH PROCESSING
  5915* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  5916******************************************************************
  5917 01  ACTIVITY-TRAILERS.
  5918     12  AT-RECORD-ID                    PIC XX.
  5919         88  VALID-AT-ID                       VALUE 'AT'.
  5920
  5921     12  AT-CONTROL-PRIMARY.
  5922         16  AT-COMPANY-CD               PIC X.
  5923         16  AT-CARRIER                  PIC X.
  5924         16  AT-CLAIM-NO                 PIC X(7).
  5925         16  AT-CERT-NO.
  5926             20  AT-CERT-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 110
* EL130.cbl
  5927             20  AT-CERT-SFX             PIC X.
  5928         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5929             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5930             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5931             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5932             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5933             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5934             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5935             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5936             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5937             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5938             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5939             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5940             88  AT-BENEFICIARY-TRL           VALUE +91.
  5941             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5942             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5943             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5944             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5945
  5946     12  AT-TRAILER-TYPE                 PIC X.
  5947         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5948         88  PAYMENT-TR                       VALUE '2'.
  5949         88  AUTO-PAY-TR                      VALUE '3'.
  5950         88  CORRESPONDENCE-TR                VALUE '4'.
  5951         88  ADDRESS-TR                       VALUE '5'.
  5952         88  GENERAL-INFO-TR                  VALUE '6'.
  5953         88  AUTO-PROMPT-TR                   VALUE '7'.
  5954         88  DENIAL-TR                        VALUE '8'.
  5955         88  INCURRED-CHG-TR                  VALUE '9'.
  5956         88  FORM-CONTROL-TR                  VALUE 'A'.
  5957
  5958     12  AT-RECORDED-DT                  PIC XX.
  5959     12  AT-RECORDED-BY                  PIC X(4).
  5960     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5961
  5962     12  AT-TRAILER-BODY                 PIC X(165).
  5963
  5964     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5965         16  AT-RESERVE-CONTROLS.
  5966             20  AT-MANUAL-SW            PIC X.
  5967                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5968             20  AT-FUTURE-SW            PIC X.
  5969                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5970             20  AT-PTC-SW               PIC X.
  5971                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5972             20  AT-IBNR-SW              PIC X.
  5973                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5974             20  AT-PTC-LF-SW            PIC X.
  5975                 88  AT-LF-PTC-USED          VALUE '1'.
  5976             20  AT-CDT-ACCESS-METHOD    PIC X.
  5977                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5978                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5979                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5980             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5981         16  AT-LAST-COMPUTED-DT         PIC XX.
  5982         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5983         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5984         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 111
* EL130.cbl
  5985         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5986         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5987         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5988         16  AT-EXPENSE-CONTROLS.
  5989             20  AT-EXPENSE-METHOD       PIC X.
  5990                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5991                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5992                 88  PERCENT-OF-PMT           VALUE '3'.
  5993                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5994             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5995             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5996         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5997         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5998
  5999         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6000         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6001
  6002*        16  FILLER                      PIC X(53).
  6003         16  FILLER                      PIC X(47).
  6004
  6005         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6006         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6007
  6008         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6009             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6010             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6011*                    C = CLOSED
  6012*                    O = OPEN
  6013             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6014*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6015
  6016     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6017         16  AT-PAYMENT-TYPE             PIC X.
  6018             88  PARTIAL-PAYMENT                VALUE '1'.
  6019             88  FINAL-PAYMENT                  VALUE '2'.
  6020             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6021             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6022             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6023             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6024             88  VOIDED-PAYMENT                 VALUE '9'.
  6025             88  TRANSFER                       VALUE 'T'.
  6026             88  LIFE-INTEREST                  VALUE 'I'.
  6027
  6028         16  AT-CLAIM-TYPE               PIC X.
  6029             88  PAID-FOR-AH                    VALUE 'A'.
  6030             88  PAID-FOR-LIFE                  VALUE 'L'.
  6031             88  PAID-FOR-IUI                   VALUE 'I'.
  6032             88  PAID-FOR-GAP                   VALUE 'G'.
  6033             88  PAID-FOR-FAM                   VALUE 'F'.
  6034         16  AT-CLAIM-PREM-TYPE          PIC X.
  6035             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6036             88  AT-O-B-COVERAGE                VALUE '2'.
  6037             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6038         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6039         16  AT-CHECK-NO                 PIC X(7).
  6040         16  AT-PAID-FROM-DT             PIC XX.
  6041         16  AT-PAID-THRU-DT             PIC XX.
  6042         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 112
* EL130.cbl
  6043         16  AT-ACH-PAYMENT              PIC X.
  6044*        16  FILLER                      PIC X.
  6045         16  AT-PAYEES-NAME              PIC X(30).
  6046         16  AT-PAYMENT-ORIGIN           PIC X.
  6047             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6048             88  ONLINE-AUTO-PMT                VALUE '2'.
  6049             88  OFFLINE-PMT                    VALUE '3'.
  6050         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6051         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6052         16  AT-VOID-DATA.
  6053             20  AT-VOID-DT              PIC XX.
  6054*00144       20  AT-VOID-REASON          PIC X(30).
  6055             20  AT-VOID-REASON          PIC X(26).
  6056         16  AT-PMT-APPROVED-BY          PIC X(04).
  6057         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6058         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6059         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6060                                         PIC S99V9(5)  COMP-3.
  6061         16  AT-CREDIT-INTERFACE.
  6062             20  AT-PMT-SELECT-DT        PIC XX.
  6063                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6064             20  AT-PMT-ACCEPT-DT        PIC XX.
  6065                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6066             20  AT-VOID-SELECT-DT       PIC XX.
  6067                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6068             20  AT-VOID-ACCEPT-DT       PIC XX.
  6069                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6070
  6071         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6072                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6073                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6074         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6075
  6076         16  AT-FORCE-CONTROL            PIC X.
  6077             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6078         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6079         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6080         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6081         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6082         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6083         16  AT-BENEFIT-TYPE             PIC X.
  6084
  6085         16  AT-EXPENSE-TYPE             PIC X.
  6086         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6087
  6088         16  AT-PAYEE-TYPE-CD.
  6089             20  AT-PAYEE-TYPE           PIC X.
  6090                 88  INSURED-PAID           VALUE 'I'.
  6091                 88  BENEFICIARY-PAID       VALUE 'B'.
  6092                 88  ACCOUNT-PAID           VALUE 'A'.
  6093                 88  OTHER-1-PAID           VALUE 'O'.
  6094                 88  OTHER-2-PAID           VALUE 'Q'.
  6095                 88  DOCTOR-PAID            VALUE 'P'.
  6096                 88  EMPLOYER-PAID          VALUE 'E'.
  6097             20  AT-PAYEE-SEQ            PIC X.
  6098
  6099         16  AT-CASH-PAYMENT             PIC X.
  6100         16  AT-GROUPED-PAYMENT          PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 113
* EL130.cbl
  6101         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6102         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6103         16  AT-APPROVED-LEVEL           PIC X.
  6104         16  AT-VOID-TYPE                PIC X.
  6105             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6106             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6107         16  AT-AIG-UNEMP-IND            PIC X.
  6108             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6109         16  AT-ASSOCIATES               PIC X.
  6110             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6111             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6112
  6113         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6114         16  AT-CV-PMT-CODE              PIC X.
  6115             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6116             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6117             88  FULL-ADD-PAYMENT           VALUE '3'.
  6118             88  HALF-ADD-PAYMENT           VALUE '4'.
  6119             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6120             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6121             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6122             88  ADDL-PAYMENT               VALUE '8'.
  6123
  6124         16  AT-EOB-CODE1                PIC XXX.
  6125         16  AT-EOB-CODE2                PIC XXX.
  6126         16  AT-EOB-CODE3                PIC XXX.
  6127         16  FILLER REDEFINES AT-EOB-CODE3.
  6128             20  AT-PRINT-CLM-FORM       PIC X.
  6129             20  AT-PRINT-SURVEY         PIC X.
  6130             20  AT-SPECIAL-RELEASE      PIC X.
  6131         16  AT-EOB-CODE4                PIC XXX.
  6132         16  FILLER REDEFINES AT-EOB-CODE4.
  6133             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6134             20  FILLER                  PIC X.
  6135         16  AT-EOB-CODE5                PIC XXX.
  6136         16  FILLER REDEFINES AT-EOB-CODE5.
  6137             20  AT-PMT-PROOF-DT         PIC XX.
  6138             20  FILLER                  PIC X.
  6139
  6140         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6141             88  AT-PRINT-EOB            VALUE 'Y'.
  6142
  6143         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6144         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6145
  6146     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6147         16  AT-SCHEDULE-START-DT        PIC XX.
  6148         16  AT-SCHEDULE-END-DT          PIC XX.
  6149         16  AT-TERMINATED-DT            PIC XX.
  6150         16  AT-LAST-PMT-TYPE            PIC X.
  6151             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6152             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6153         16  AT-FIRST-PMT-DATA.
  6154             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6155             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6156             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6157         16  AT-REGULAR-PMT-DATA.
  6158             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 114
* EL130.cbl
  6159             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6160             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6161         16  AT-AUTO-PAYEE-CD.
  6162             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6163                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6164                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6165                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6166                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6167                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6168             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6169         16  AT-AUTO-PAY-DAY             PIC 99.
  6170         16  AT-AUTO-CASH                PIC X.
  6171             88  AT-CASH                      VALUE 'Y'.
  6172             88  AT-NON-CASH                  VALUE 'N'.
  6173*        16  FILLER                      PIC X(129).
  6174         16  AT-AUTO-END-LETTER          PIC X(4).
  6175         16  FILLER                      PIC X(125).
  6176
  6177         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6178         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6179
  6180     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6181         16  AT-LETTER-SENT-DT           PIC XX.
  6182         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6183         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6184         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6185         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6186         16  AT-LETTER-ORIGIN            PIC X.
  6187             88  ONLINE-CREATION              VALUE '1' '3'.
  6188             88  OFFLINE-CREATION             VALUE '2' '4'.
  6189             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6190             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6191         16  AT-STD-LETTER-FORM          PIC X(4).
  6192         16  AT-REASON-TEXT              PIC X(70).
  6193         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6194         16  AT-ADDRESEE-TYPE            PIC X.
  6195              88  INSURED-ADDRESEE            VALUE 'I'.
  6196              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6197              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6198              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6199              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6200              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6201              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6202         16  AT-ADDRESSEE-NAME           PIC X(30).
  6203         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6204         16  AT-RESEND-PRINT-DATE        PIC XX.
  6205         16  AT-CORR-SOL-UNSOL           PIC X.
  6206         16  AT-LETTER-PURGED-DT         PIC XX.
  6207*
  6208*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6209*
  6210         16  AT-CSO-REDEFINITION.
  6211             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6212             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6213             20  AT-LETTER-TO-BENE       PIC X(1).
  6214             20  AT-STOP-LETTER-DT       PIC X(2).
  6215             20  AT-AUTH-RCVD            PIC X(1).
  6216             20  FILLER                  PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 115
* EL130.cbl
  6217*             20  FILLER                  PIC X(27).
  6218             20  AT-CSO-LETTER-STATUS    PIC X.
  6219                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6220                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6221                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6222             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6223             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6224*
  6225*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6226*
  6227*        16  FILLER                      PIC X(26).
  6228*
  6229*        16  AT-DMD-BSR-CODE             PIC X.
  6230*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6231*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6232*
  6233*        16  AT-DMD-LETTER-STATUS        PIC X.
  6234*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6235*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6236*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6237*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6238*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6239
  6240         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6241         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6242
  6243     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6244         16  AT-ADDRESS-TYPE             PIC X.
  6245             88  INSURED-ADDRESS               VALUE 'I'.
  6246             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6247             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6248             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6249             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6250             88  OTHER-ADDRESS-1               VALUE 'O'.
  6251             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6252         16  AT-MAIL-TO-NAME             PIC X(30).
  6253         16  AT-ADDRESS-LINE-1           PIC X(30).
  6254         16  AT-ADDRESS-LINE-2           PIC X(30).
  6255         16  AT-CITY-STATE.
  6256             20  AT-CITY                 PIC X(28).
  6257             20  AT-STATE                PIC XX.
  6258         16  AT-ZIP.
  6259             20  AT-ZIP-CODE.
  6260                 24  AT-ZIP-1ST          PIC X.
  6261                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6262                 24  FILLER              PIC X(4).
  6263             20  AT-ZIP-PLUS4            PIC X(4).
  6264         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6265             20  AT-CAN-POSTAL-1         PIC XXX.
  6266             20  AT-CAN-POSTAL-2         PIC XXX.
  6267             20  FILLER                  PIC XXX.
  6268         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6269*         16  FILLER                      PIC X(23).
  6270         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6271         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6272         16  FILLER                      PIC X(13).
  6273         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6274         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 116
* EL130.cbl
  6275
  6276     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6277         16  AT-INFO-LINE-1              PIC X(60).
  6278         16  FILLER REDEFINES AT-INFO-LINE-1.
  6279             20  AT-NOTE-ERROR-NO OCCURS 15
  6280                                         PIC X(4).
  6281         16  AT-INFO-LINE-2              PIC X(60).
  6282         16  FILLER REDEFINES AT-INFO-LINE-2.
  6283             20  AT-ICD-CODE-1           PIC X(8).
  6284             20  AT-ICD-CODE-2           PIC X(8).
  6285             20  FILLER                  PIC X(44).
  6286         16  AT-INFO-TRAILER-TYPE        PIC X.
  6287             88  AT-ERRORS-NOTE          VALUE 'E'.
  6288             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6289             88  AT-CALL-NOTE            VALUE 'C'.
  6290             88  AT-MAINT-NOTE           VALUE 'M'.
  6291             88  AT-CERT-CHANGE          VALUE 'X'.
  6292             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6293             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6294             88  AT-CERT-CANCELLED       VALUE 'T'.
  6295         16  AT-CALL-TYPE                PIC X.
  6296             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6297             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6298         16  AT-NOTE-CONTINUATION        PIC X.
  6299             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6300         16  AT-EOB-CODES-EXIST          PIC X.
  6301             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6302         16  FILLER                      PIC X(35).
  6303         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6304         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6305
  6306     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6307         16  AT-PROMPT-LINE-1            PIC X(60).
  6308         16  AT-PROMPT-LINE-2            PIC X(60).
  6309         16  AT-PROMPT-START-DT          PIC XX.
  6310         16  AT-PROMPT-END-DT            PIC XX.
  6311         16  FILLER                      PIC X(35).
  6312         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6313         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6314
  6315     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6316         16  AT-DENIAL-INFO-1            PIC X(60).
  6317         16  AT-DENIAL-INFO-2            PIC X(60).
  6318         16  AT-DENIAL-DT                PIC XX.
  6319         16  AT-RETRACTION-DT            PIC XX.
  6320         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6321*         16  FILLER                      PIC X(31).
  6322         16  AT-DENIAL-PROOF-DT          PIC XX.
  6323         16  FILLER                      PIC X(29).
  6324         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6325         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6326
  6327     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6328         16  AT-OLD-INCURRED-DT          PIC XX.
  6329         16  AT-OLD-REPORTED-DT          PIC XX.
  6330         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6331         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6332         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 117
* EL130.cbl
  6333         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6334         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6335         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6336         16  FILLER                      PIC X(26).
  6337         16  AT-OLD-DIAG-CODE            PIC X(6).
  6338         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6339         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6340         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6341         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6342         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6343         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6344         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6345         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6346         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6347         16  FILLER                      PIC X(9).
  6348         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6349
  6350     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6351         16  AT-FORM-SEND-ON-DT          PIC XX.
  6352         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6353         16  AT-FORM-RE-SEND-DT          PIC XX.
  6354         16  AT-FORM-ANSWERED-DT         PIC XX.
  6355         16  AT-FORM-PRINTED-DT          PIC XX.
  6356         16  AT-FORM-REPRINT-DT          PIC XX.
  6357         16  AT-FORM-TYPE                PIC X.
  6358             88  INITIAL-FORM                  VALUE '1'.
  6359             88  PROGRESS-FORM                 VALUE '2'.
  6360         16  AT-INSTRUCT-LN-1            PIC X(28).
  6361         16  AT-INSTRUCT-LN-2            PIC X(28).
  6362         16  AT-INSTRUCT-LN-3            PIC X(28).
  6363         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6364         16  AT-FORM-ADDRESS             PIC X.
  6365             88  FORM-TO-INSURED              VALUE 'I'.
  6366             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6367             88  FORM-TO-OTHER-1              VALUE 'O'.
  6368             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6369         16  AT-RELATED-1.
  6370             20 AT-REL-CARR-1            PIC X.
  6371             20 AT-REL-CLAIM-1           PIC X(7).
  6372             20 AT-REL-CERT-1            PIC X(11).
  6373         16  AT-RELATED-2.
  6374             20 AT-REL-CARR-2            PIC X.
  6375             20 AT-REL-CLAIM-2           PIC X(7).
  6376             20 AT-REL-CERT-2            PIC X(11).
  6377         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6378         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6379         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6380         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6381         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6382         16  AT-STOP-FORM-DT             PIC X(2).
  6383
  6384         16  FILLER                      PIC X(09).
  6385         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6386         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6387******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 118
* EL130.cbl
  6389*    COPY ELCBENE.
  6390******************************************************************
  6391*                                                                *
  6392*                            ELCBENE.                            *
  6393*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6394*                            VMOD=2.006                          *
  6395*                                                                *
  6396*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6397*                                                                *
  6398*   FILE TYPE = VSAM,KSDS                                        *
  6399*   RECORD SIZE = 500   RECFORM = FIX                            *
  6400*                                                                *
  6401*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6402*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6403*                                                                *
  6404*   LOG = YES                                                    *
  6405*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6406*                                                                *
  6407*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6408******************************************************************
  6409*                   C H A N G E   L O G
  6410*
  6411* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6412*-----------------------------------------------------------------
  6413*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6414* EFFECTIVE    NUMBER
  6415*-----------------------------------------------------------------
  6416* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6417* 082317  CR2017082100003  PEMA  Add sub type
  6418******************************************************************
  6419
  6420 01  BENEFICIARY-MASTER.
  6421     12  BE-RECORD-ID                PIC XX.
  6422         88  VALID-BE-ID                VALUE 'BE'.
  6423
  6424     12  BE-CONTROL-PRIMARY.
  6425         16  BE-COMPANY-CD           PIC X.
  6426         16  BE-RECORD-TYPE          PIC X.
  6427             88  BENEFICIARY-RECORD  VALUE 'B'.
  6428             88  ADJUSTOR-RECORD     VALUE 'A'.
  6429         16  BE-BENEFICIARY          PIC X(10).
  6430     12  BE-CONTROL-BY-NAME.
  6431         16  BE-COMPANY-CD-A1        PIC X.
  6432         16  BE-RECORD-TYPE-A1       PIC X.
  6433         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6434         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6435
  6436     12  BE-LAST-MAINT-DT            PIC XX.
  6437     12  BE-LAST-MAINT-BY            PIC X(4).
  6438     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6439
  6440     12  BE-ADDRESS-DATA.
  6441         16  BE-MAIL-TO-NAME         PIC X(30).
  6442         16  BE-ADDRESS-LINE-1       PIC X(30).
  6443         16  BE-ADDRESS-LINE-2       PIC X(30).
  6444         16  BE-ADDRESS-LINE-3       PIC X(30).
  6445         16  BE-CITY-STATE.
  6446             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 119
* EL130.cbl
  6447             20  BE-STATE            PIC XX.
  6448         16  BE-ZIP-CODE.
  6449             20  BE-ZIP-PRIME.
  6450                 24  BE-ZIP-1ST      PIC X.
  6451                     88  BE-CANADIAN-POST-CODE
  6452                                         VALUE 'A' THRU 'Z'.
  6453                 24  FILLER          PIC X(4).
  6454             20  BE-ZIP-PLUS4        PIC X(4).
  6455         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6456             20  BE-CAN-POSTAL-1     PIC XXX.
  6457             20  BE-CAN-POSTAL-2     PIC XXX.
  6458             20  FILLER              PIC XXX.
  6459         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6460         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6461
  6462******************************************************************
  6463*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6464*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6465******************************************************************
  6466     12  BE-CARRIER                  PIC X.
  6467
  6468     12  BE-ADDRESS-DATA2.
  6469         16  BE-MAIL-TO-NAME2        PIC X(30).
  6470         16  BE-ADDRESS-LINE-12      PIC X(30).
  6471         16  BE-ADDRESS-LINE-22      PIC X(30).
  6472         16  BE-ADDRESS-LINE-32      PIC X(30).
  6473         16  BE-CITY-STATE2.
  6474             20  BE-CITY2            PIC X(28).
  6475             20  BE-STATE2           PIC XX.
  6476         16  BE-ZIP-CODE2.
  6477             20  BE-ZIP-PRIME2.
  6478                 24  BE-ZIP-1ST2     PIC X.
  6479                     88  BE-CANADIAN-POST-CODE2
  6480                                         VALUE 'A' THRU 'Z'.
  6481                 24  FILLER          PIC X(4).
  6482             20  BE-ZIP-PLUS42       PIC X(4).
  6483         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6484             20  BE-CAN-POSTAL-12    PIC XXX.
  6485             20  BE-CAN-POSTAL-22    PIC XXX.
  6486             20  FILLER              PIC XXX.
  6487         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6488         16  BE-ACH-DATA.
  6489             20  BE-ACH-YES-OR-NO    PIC X.
  6490                 88  BE-ON-ACH       VALUE 'Y'.
  6491                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  6492             20  BE-ACH-ABA-ROUTING-NUMBER
  6493                                     PIC X(15).
  6494             20  BE-ACH-BANK-ACCOUNT-NUMBER
  6495                                     PIC X(20).
  6496             20  BE-ACH-SUB-TYPE     PIC XX.
  6497             20  FILLER              PIC X(23).
  6498         16  BE-BILLING-STMT-DATA.
  6499*            20  BE-BSR              PIC X.
  6500*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  6501*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6502*            20  BE-BSR-FROM         PIC X(30).
  6503*            20  BE-BSR-DEPT         PIC X(30).
  6504             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 120
* EL130.cbl
  6505             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6506             20  BE-OUTPUT-TYPE      PIC X.
  6507                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6508                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6509
  6510     12  FILLER                      PIC X(28).
  6511******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 121
* EL130.cbl
  6513*    COPY ELCDAR.
  6514******************************************************************
  6515*                                                                *
  6516*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6517*   FILE TYPE = VSAM,KSDS                                        *
  6518*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6519*   BASE CLUSTER = DLYACTV                                       *
  6520*   LOG = YES                                                    *
  6521*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6522*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6523*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6524*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6525*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6526*               BY PROGRAM "LGINFCE".                            *
  6527*                                                                *
  6528******************************************************************
  6529 01  DAILY-ACTIVITY-RECORD.
  6530     05  DA-KEY.
  6531         10  DA-COMP-CD          PIC X.
  6532         10  DA-CARRIER          PIC X.
  6533         10  DA-CLAIM-NO         PIC X(7).
  6534         10  DA-CERT-NO.
  6535             15  DA-CERT-PRIME   PIC X(10).
  6536             15  DA-CERT-SFX     PIC X.
  6537     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6538     05  DA-RECORD-TYPE          PIC X.
  6539     05  FILLER                  PIC X(2).
  6540******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 122
* EL130.cbl
  6542*    COPY ELCACTQ.
  6543******************************************************************
  6544*                                                                *
  6545*                            ELCACTQ.                            *
  6546*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6547*                            VMOD=2.004                          *
  6548*                                                                *
  6549*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6550*                                                                *
  6551*   FILE TYPE = VSAM,KSDS                                        *
  6552*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6553*                                                                *
  6554*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6555*       ALTERNATE INDEX = NONE                                   *
  6556*                                                                *
  6557*   LOG = YES                                                    *
  6558*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6559*                                                                *
  6560*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6561******************************************************************
  6562
  6563 01  ACTIVITY-QUE.
  6564     12  AQ-RECORD-ID                PIC XX.
  6565         88  VALID-AQ-ID                VALUE 'AQ'.
  6566
  6567     12  AQ-CONTROL-PRIMARY.
  6568         16  AQ-COMPANY-CD           PIC X.
  6569         16  AQ-CARRIER              PIC X.
  6570         16  AQ-CLAIM-NO             PIC X(7).
  6571         16  AQ-CERT-NO.
  6572             20  AQ-CERT-PRIME       PIC X(10).
  6573             20  AQ-CERT-SFX         PIC X.
  6574
  6575     12  AQ-PENDING-ACTIVITY-FLAGS.
  6576         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6577         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6578             88  PENDING-PAYMENTS       VALUE '1'.
  6579         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6580             88  PENDING-FULL-PRINT     VALUE '1'.
  6581             88  PENDING-PART-PRINT     VALUE '2'.
  6582         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6583             88  PENDING-LETTERS        VALUE '1'.
  6584         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6585             88  PENDING-RESTORE        VALUE 'C'.
  6586             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6587
  6588     12  FILLER                      PIC X(20).
  6589
  6590     12  AQ-RESEND-DATE              PIC XX.
  6591     12  AQ-FOLLOWUP-DATE            PIC XX.
  6592     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6593     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6594     12  AQ-AUTO-LETTER              PIC X(4).
  6595     12  FILLER                      PIC XX.
  6596     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6597*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 123
* EL130.cbl
  6599*    COPY ELCARCH.
  6600******************************************************************
  6601*                                                                *
  6602*                            ELCARCH.                            *
  6603*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6604*                            VMOD=2.007                          *
  6605*                                                                *
  6606*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6607*                                                                *
  6608*   FILE TYPE = VSAM,KSDS                                        *
  6609*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6610*                                                                *
  6611*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6612*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6613*                                                                *
  6614*   LOG = NO                                                     *
  6615*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6616*                                                                *
  6617*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6618******************************************************************
  6619 01  LETTER-ARCHIVE.
  6620     12  LA-RECORD-ID                PIC XX.
  6621         88  VALID-LA-ID                VALUE 'LA'.
  6622
  6623     12  LA-CONTROL-PRIMARY.
  6624         16  LA-COMPANY-CD           PIC X.
  6625         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6626         16  LA-RECORD-TYPE          PIC X.
  6627             88  LA-HEADER-DATA         VALUE '1'.
  6628             88  LA-ADDRESS-DATA        VALUE '2'.
  6629             88  LA-TEXT-DATA           VALUE '3'.
  6630             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6631         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6632
  6633     12  LA-CONTROL-BY-TYPE.
  6634         16  LA-COMPANY-CD-A1        PIC X.
  6635         16  LA-RECORD-TYPE-A1       PIC X.
  6636         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6637         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6638
  6639     12  LA-TEXT-RECORD.
  6640         16  LA-SKIP-CONTROL         PIC XX.
  6641             88  NO-LINES-SKIPPED       VALUE SPACES.
  6642             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6643         16  LA-TEXT-LINE            PIC X(70).
  6644
  6645     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6646         16  FILLER                  PIC XX.
  6647         16  LA-ADDRESS-LINE         PIC X(30).
  6648         16  FILLER                  PIC X(40).
  6649
  6650     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6651         16  FILLER                  PIC XX.
  6652         16  LA-CARRIER              PIC X.
  6653         16  LA-CLAIM-NO             PIC X(7).
  6654         16  LA-CERT-NO.
  6655             20  LA-CERT-PRIME       PIC X(10).
  6656             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 124
* EL130.cbl
  6657         16  LA-NO-OF-COPIES         PIC S9.
  6658         16  LA-RESEND-DATE          PIC XX.
  6659         16  LA-PROCESSOR-CD         PIC X(4).
  6660         16  LA-CREATION-DT          PIC XX.
  6661         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6662         16  LA-RESEND-PRINT-DATE    PIC XX.
  6663         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6664         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6665*
  6666* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6667*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6668*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6669*   I        20  LA-DMD-RES-ST           PIC XX.
  6670*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6671*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6672*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6673*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6674*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6675*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6676*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6677*   I        20  LA-DMD-UND-CODE         PIC XX.
  6678*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6679*   V    16  FILLER                  PIC X(15).
  6680* -----
  6681*
  6682* REINSERTED  CSO  MODS
  6683*
  6684         16  FILLER.
  6685             20  FILLER                  PIC X(29).
  6686             20  LA-CSO-LETTER-STATUS    PIC X.
  6687                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6688                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6689                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6690             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6691             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6692*
  6693
  6694     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6695         16  FILLER                  PIC XX.
  6696         16  LA4-CARRIER             PIC X.
  6697         16  LA4-CLAIM-NO            PIC X(7).
  6698         16  LA4-CERT-NO.
  6699             20  LA4-CERT-PRIME      PIC X(10).
  6700             20  LA4-CERT-SFX        PIC X.
  6701         16  LA4-NO-OF-COPIES        PIC S9.
  6702         16  LA4-RESEND-DATE         PIC XX.
  6703         16  LA4-PROCESSOR-CD        PIC X(4).
  6704         16  LA4-CREATION-DT         PIC XX.
  6705         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6706         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6707         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6708         16  LA4-FORM-TYPE           PIC X.
  6709             88  LA4-INITIAL-FORM    VALUE '1'.
  6710             88  LA4-PROGRESS-FORM   VALUE '2'.
  6711         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6712         16  LA4-STATE               PIC X(02).
  6713         16  FILLER                  PIC X(31).
  6714******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 125
* EL130.cbl
  6716*    COPY ERCREIN.
  6717******************************************************************
  6718*                                                                *
  6719*                            ERCREIN                             *
  6720*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6721*                            VMOD=2.010                          *
  6722*                                                                *
  6723*   ONLINE CREDIT SYSTEM                                         *
  6724*                                                                *
  6725*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6726*                                                                *
  6727*   FILE TYPE = VSAM,KSDS                                        *
  6728*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6729*                                                                *
  6730*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6731*       ALTERNATE PATH = NONE                                    *
  6732*                                                                *
  6733*   LOG = NO                                                     *
  6734*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6735*                                                                *
  6736******************************************************************
  6737*                   C H A N G E   L O G
  6738*
  6739* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6740*-----------------------------------------------------------------
  6741*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6742* EFFECTIVE    NUMBER
  6743*-----------------------------------------------------------------
  6744* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6745* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6746******************************************************************
  6747 01  REINSURANCE-RECORD.
  6748     12  RE-RECORD-ID                      PIC XX.
  6749         88  VALID-RE-ID                      VALUE 'RE'.
  6750
  6751     12  RE-CONTROL-PRIMARY.
  6752         16  RE-COMPANY-CD                 PIC X.
  6753         16  RE-KEY.
  6754             20  RE-CODE                   PIC X.
  6755                 88  RE-TABLE-RECORD          VALUE 'A'.
  6756                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6757             20  RE-TABLE                  PIC XXX.
  6758             20  FILLER                    PIC XXX.
  6759         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6760             20  FILLER                    PIC X.
  6761             20  RE-COMPANY.
  6762                 24  RE-COMP-PRIME         PIC XXX.
  6763                 24  RE-COMP-SUB           PIC XXX.
  6764
  6765     12  RE-MAINT-INFORMATION.
  6766         16  RE-LAST-MAINT-DT              PIC XX.
  6767         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6768         16  RE-LAST-MAINT-USER            PIC X(4).
  6769         16  FILLER                        PIC X(10).
  6770
  6771     12  RE-TABLE-DATA.
  6772         16  RE-100-COMP                   PIC 99.
  6773
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 126
* EL130.cbl
  6774         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6775             20  RE-REI-COMP-NO.
  6776                 24  RE-REI-COMP           PIC XXX.
  6777                 24  RE-REI-COMP-SUB       PIC XXX.
  6778             20  RE-LF-QC                  PIC X.
  6779             20  RE-AH-QC                  PIC X.
  6780             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6781             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6782             20  RE-LFAGE-LO               PIC 99.
  6783             20  RE-LFAGE-HI               PIC 99.
  6784             20  RE-AHAGE-LO               PIC 99.
  6785             20  RE-AHAGE-HI               PIC 99.
  6786             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6787             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6788             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6789             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6790             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6791             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6792             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6793             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6794             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6795             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6796             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6797             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6798             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6799             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6800             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6801             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6802             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6803             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6804             20  RE-LF-BEN-CODE            PIC X.
  6805             20  RE-AH-BEN-CODE            PIC X.
  6806             20  RE-INTERACTIVE            PIC X.
  6807             20  RE-REMAINING              PIC X.
  6808             20  RE-LF-RUNOFF-SW           PIC X.
  6809             20  RE-AH-RUNOFF-SW           PIC X.
  6810             20  FILLER                    PIC X(19).
  6811
  6812         16  RE-COMP-INFO-END              PIC X(6).
  6813         16  RE-NSP-ST-CD-LF               PIC XX.
  6814         16  RE-NSP-ST-CD-AH               PIC XX.
  6815         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6816             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6817
  6818         16  FILLER                        PIC X(27).
  6819
  6820     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6821         16  RE-NAME                       PIC X(30).
  6822         16  RE-LF-PE                      PIC X.
  6823         16  RE-AH-PE                      PIC X.
  6824         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6825         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6826         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6827         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6828         16  RE-PRT-ST                     PIC X.
  6829         16  RE-PRT-OW                     PIC X.
  6830         16  RE-MORT-CODE                  PIC X(4).
  6831         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 127
* EL130.cbl
  6832         16  RE-ZERO-LF-FEE                PIC X.
  6833         16  RE-ZERO-AH-FEE                PIC X.
  6834         16  RE-CEDE-NAME                  PIC X(30).
  6835         16  RE-LF-COMM                    PIC X.
  6836         16  RE-AH-COMM                    PIC X.
  6837         16  RE-LF-TAX                     PIC X.
  6838         16  RE-AH-TAX                     PIC X.
  6839         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6840         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6841         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6842
  6843         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6844             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6845
  6846         16  RE-LF-CEDING-FEE-BRACKETS.
  6847             20  RE-LF-FEE-METHOD          PIC X.
  6848                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6849                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6850                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6851                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6852             20  RE-LF-FEE-BASIS           PIC X.
  6853                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6854                 88  RE-LF-NET-CEDED               VALUE '2'.
  6855                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6856                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6857                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6858                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6859                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6860                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6861             20  FILLER                    PIC XXX.
  6862             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6863                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6864                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6865
  6866         16  RE-AH-CEDING-FEE-BRACKETS.
  6867             20  RE-AH-FEE-METHOD          PIC X.
  6868                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6869                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6870                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6871                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6872             20  RE-AH-FEE-BASIS           PIC X.
  6873                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6874                 88  RE-AH-NET-CEDED               VALUE '2'.
  6875                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6876                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6877                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6878                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6879                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6880                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6881             20  FILLER                    PIC XXX.
  6882             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6883                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6884                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6885
  6886         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6887
  6888         16  RE-OLD-CEDING-STMT            PIC X.
  6889
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 128
* EL130.cbl
  6890         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6891         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6892         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6893         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6894         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6895         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6896         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6897         16  RE-MORT-SW                    PIC X.
  6898         16  RE-CEDING-TYPE-FLAG           PIC X.
  6899             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6900             88  RE-CEDED                          VALUE 'C'.
  6901             88  RE-ASSUMED                        VALUE 'A'.
  6902             88  RE-PHANTOM                        VALUE 'P'.
  6903
  6904         16  RE-CEDING-STMT-OPT-A          PIC X.
  6905             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6906         16  RE-CEDING-STMT-OPT-B          PIC X.
  6907             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6908         16  RE-CEDING-STMT-OPT-C          PIC X.
  6909             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6910         16  RE-CEDING-STMT-OPT-D          PIC X.
  6911             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6912         16  RE-CEDING-STMT-OPT-E          PIC X.
  6913             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6914
  6915         16  RE-PRT-CRSV                   PIC X.
  6916
  6917         16  RE-GL-CENTER                  PIC X(4).
  6918
  6919         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6920
  6921         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6922
  6923         16  RE-EARN-STOP-CODE             PIC X.
  6924             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6925             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6926
  6927         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6928             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6929
  6930         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6931         16  FILLER                        PIC X(2281).
  6932
  6933         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6934
  6935******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 129
* EL130.cbl
  6937*    COPY ERCMAIL.
  6938******************************************************************
  6939*                                                                *
  6940*                                                                *
  6941*                            ERCMAIL                             *
  6942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6943*                            VMOD=2.003                          *
  6944*                                                                *
  6945*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6946*                                                                *
  6947*   FILE TYPE = VSAM,KSDS                                        *
  6948*   RECORD SIZE = 374   RECFORM = FIX                            *
  6949*                                                                *
  6950*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6951*   ALTERNATE PATH    = NOT USED                                 *
  6952*                                                                *
  6953*   LOG = YES                                                    *
  6954*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6955******************************************************************
  6956*                   C H A N G E   L O G
  6957*
  6958* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6959*-----------------------------------------------------------------
  6960*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6961* EFFECTIVE    NUMBER
  6962*-----------------------------------------------------------------
  6963* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6964* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6965* 111108                   PEMA  ADD CRED BENE ADDR2
  6966******************************************************************
  6967
  6968 01  MAILING-DATA.
  6969     12  MA-RECORD-ID                      PIC XX.
  6970         88  VALID-MA-ID                       VALUE 'MA'.
  6971
  6972     12  MA-CONTROL-PRIMARY.
  6973         16  MA-COMPANY-CD                 PIC X.
  6974         16  MA-CARRIER                    PIC X.
  6975         16  MA-GROUPING.
  6976             20  MA-GROUPING-PREFIX        PIC XXX.
  6977             20  MA-GROUPING-PRIME         PIC XXX.
  6978         16  MA-STATE                      PIC XX.
  6979         16  MA-ACCOUNT.
  6980             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6981             20  MA-ACCOUNT-PRIME          PIC X(6).
  6982         16  MA-CERT-EFF-DT                PIC XX.
  6983         16  MA-CERT-NO.
  6984             20  MA-CERT-PRIME             PIC X(10).
  6985             20  MA-CERT-SFX               PIC X.
  6986
  6987     12  FILLER                            PIC XX.
  6988
  6989     12  MA-ACCESS-CONTROL.
  6990         16  MA-SOURCE-SYSTEM              PIC XX.
  6991             88  MA-FROM-CREDIT                VALUE 'CR'.
  6992             88  MA-FROM-VSI                   VALUE 'VS'.
  6993             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6994             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 130
* EL130.cbl
  6995         16  MA-RECORD-ADD-DT              PIC XX.
  6996         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6997         16  MA-LAST-MAINT-DT              PIC XX.
  6998         16  MA-LAST-MAINT-BY              PIC XXXX.
  6999         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7000
  7001     12  MA-PROFILE-INFO.
  7002         16  MA-QUALIFY-CODE-1             PIC XX.
  7003         16  MA-QUALIFY-CODE-2             PIC XX.
  7004         16  MA-QUALIFY-CODE-3             PIC XX.
  7005         16  MA-QUALIFY-CODE-4             PIC XX.
  7006         16  MA-QUALIFY-CODE-5             PIC XX.
  7007
  7008         16  MA-INSURED-LAST-NAME          PIC X(15).
  7009         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7010         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7011         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7012         16  MA-INSURED-BIRTH-DT           PIC XX.
  7013         16  MA-INSURED-SEX                PIC X.
  7014             88  MA-SEX-MALE                   VALUE 'M'.
  7015             88  MA-SEX-FEMALE                 VALUE 'F'.
  7016         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7017
  7018         16  MA-ADDRESS-CORRECTED          PIC X.
  7019         16  MA-JOINT-BIRTH-DT             PIC XX.
  7020*        16  FILLER                        PIC X(12).
  7021
  7022         16  MA-ADDRESS-LINE-1             PIC X(30).
  7023         16  MA-ADDRESS-LINE-2             PIC X(30).
  7024         16  MA-CITY-STATE.
  7025             20  MA-CITY                   PIC X(28).
  7026             20  MA-ADDR-STATE             PIC XX.
  7027         16  MA-ZIP.
  7028             20  MA-ZIP-CODE.
  7029                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7030                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7031                 24  FILLER                PIC X(4).
  7032             20  MA-ZIP-PLUS4              PIC X(4).
  7033         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7034             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7035             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7036             20  FILLER                    PIC X(3).
  7037
  7038         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7039
  7040         16  FILLER                        PIC XXX.
  7041*        16  FILLER                        PIC X(10).
  7042
  7043     12  MA-CRED-BENE-INFO.
  7044         16  MA-CRED-BENE-NAME                 PIC X(25).
  7045         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7046         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7047         16  MA-CRED-BENE-CTYST.
  7048             20  MA-CRED-BENE-CITY             PIC X(28).
  7049             20  MA-CRED-BENE-STATE            PIC XX.
  7050         16  MA-CRED-BENE-ZIP.
  7051             20  MA-CB-ZIP-CODE.
  7052                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 131
* EL130.cbl
  7053                     88  MA-CB-CANADIAN-POST-CODE
  7054                                           VALUE 'A' THRU 'Z'.
  7055                 24  FILLER                    PIC X(4).
  7056             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7057         16  MA-CB-CANADIAN-POSTAL-CODE
  7058                            REDEFINES MA-CRED-BENE-ZIP.
  7059             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7060             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7061             20  FILLER                        PIC X(3).
  7062     12  MA-POST-CARD-MAIL-DATA.
  7063         16  MA-MAIL-DATA OCCURS 7.
  7064             20  MA-MAIL-TYPE              PIC X.
  7065                 88  MA-12MO-MAILING           VALUE '1'.
  7066                 88  MA-EXP-MAILING            VALUE '2'.
  7067             20  MA-MAIL-STATUS            PIC X.
  7068                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7069                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7070                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7071             20  MA-MAIL-DATE              PIC XX.
  7072     12  FILLER                            PIC XX.
  7073     12  FILLER                            PIC XX.
  7074*    12  FILLER                            PIC X(30).
  7075******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 132
* EL130.cbl
  7077*    COPY ELCCRTT.
  7078******************************************************************
  7079*                                                                *
  7080*                            ELCCRTT.                            *
  7081*                                                                *
  7082*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7083*                                                                *
  7084*   FILE TYPE = VSAM,KSDS                                        *
  7085*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7086*                                                                *
  7087*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7088*                                                                *
  7089*   LOG = YES                                                    *
  7090*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7091******************************************************************
  7092*                   C H A N G E   L O G
  7093*
  7094* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7095*-----------------------------------------------------------------
  7096*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7097* EFFECTIVE    NUMBER
  7098*-----------------------------------------------------------------
  7099* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7100* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7101* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7102* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7103* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7104* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7105* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7106* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7107* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7108******************************************************************
  7109
  7110 01  CERTIFICATE-TRAILERS.
  7111     12  CS-RECORD-ID                      PIC XX.
  7112         88  VALID-CS-ID                      VALUE 'CS'.
  7113
  7114     12  CS-CONTROL-PRIMARY.
  7115         16  CS-COMPANY-CD                 PIC X.
  7116         16  CS-CARRIER                    PIC X.
  7117         16  CS-GROUPING                   PIC X(6).
  7118         16  CS-STATE                      PIC XX.
  7119         16  CS-ACCOUNT                    PIC X(10).
  7120         16  CS-CERT-EFF-DT                PIC XX.
  7121         16  CS-CERT-NO.
  7122             20  CS-CERT-PRIME             PIC X(10).
  7123             20  CS-CERT-SFX               PIC X.
  7124         16  CS-TRAILER-TYPE               PIC X.
  7125             88  COMM-TRLR           VALUE 'A'.
  7126             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7127             88  CERT-DATA-TRLR      VALUE 'C'.
  7128
  7129     12  CS-DATA-AREA                      PIC X(516).
  7130
  7131     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7132         16  CS-BANK-COMMISSION-AREA.
  7133             20  CS-BANK-COMMS       OCCURS 10.
  7134                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 133
* EL130.cbl
  7135                 24  CS-COM-TYP            PIC X.
  7136                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7137                 24  CS-RECALC-LV-INDIC    PIC X.
  7138                 24  FILLER                PIC X(10).
  7139         16  FILLER                        PIC X(256).
  7140
  7141     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7142****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7143         16  CS-MB-CLAIM-DATA OCCURS 24.
  7144             20  CS-CLAIM-NO               PIC X(7).
  7145             20  CS-CLAIM-TYPE             PIC X.
  7146                 88  CS-AH-CLM               VALUE 'A'.
  7147                 88  CS-IU-CLM               VALUE 'I'.
  7148                 88  CS-GP-CLM               VALUE 'G'.
  7149                 88  CS-LF-CLM               VALUE 'L'.
  7150                 88  CS-PR-CLM               VALUE 'P'.
  7151                 88  CS-FL-CLM               VALUE 'F'.
  7152             20  CS-INSURED-TYPE           PIC X.
  7153                 88  CS-PRIM-INSURED          VALUE 'P'.
  7154                 88  CS-CO-BORROWER           VALUE 'C'.
  7155             20  CS-BENEFIT-PERIOD         PIC 99.
  7156             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7157             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7158             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7159         16  FILLER                        PIC X(12).
  7160     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7161         16  CS-VIN-NUMBER                 PIC X(17).
  7162         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7163         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7164         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7165         16  cs-agent-name.
  7166             20  cs-agent-fname            pic x(20).
  7167             20  cs-agent-mi               pic x.
  7168             20  cs-agent-lname            pic x(25).
  7169         16  cs-license-no                 pic x(15).
  7170         16  cs-npn-number                 pic x(10).
  7171         16  cs-agent-edit-status          pic x.
  7172             88  cs-ae-refer-to-manager      value 'M'.
  7173             88  cs-ae-cover-sheet           value 'C'.
  7174             88  cs-ae-sig-form              value 'S'.
  7175             88  cs-ae-verified              value 'V'.
  7176             88  cs-unidentified-signature   value 'U'.
  7177             88  cs-cert-returned            value 'R'.
  7178             88  cs-accept-no-commission     value 'N'.
  7179         16  cs-year                       pic 9999.
  7180         16  cs-make                       pic x(20).
  7181         16  cs-model                      pic x(20).
  7182         16  cs-future                     pic x(20).
  7183         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7184         16  FILLER                        PIC X(356). *> was 420
  7185*        16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 134
* EL130.cbl
  7187
  7188 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7189                          CONTROL-FILE CERTIFICATE-MASTER
  7190                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7191                          BENEFICIARY-MASTER
  7192                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7193                          LETTER-ARCHIVE REINSURANCE-RECORD
  7194                          MAILING-DATA CERTIFICATE-TRAILERS.
  7195 0000-DFHEXIT SECTION.
  7196     MOVE '9#                    $   ' TO DFHEIV0.
  7197     MOVE 'EL130' TO DFHEIV1.
  7198     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7199     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7200     MOVE '5'                    TO DC-OPTION-CODE.
  7201     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7202     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7203     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7204
  7205     IF EIBCALEN = ZERO
  7206         GO TO 8800-UNAUTHORIZED-ACCESS
  7207     END-IF.
  7208
  7209     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7210     MOVE EIBTRMID               TO QID-TERM.
  7211     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7212     move spaces                 to emi-error-lines
  7213     MOVE '2'                    TO EMI-SWITCH2.
  7214     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7215     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7216
  7217
  7218* EXEC CICS HANDLE CONDITION
  7219*        QIDERR     (0100-TEST-ENTRY)
  7220*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7221*        PGMIDERR   (9600-PGMID-ERROR)
  7222*        TERMIDERR  (8820-TERM-ERROR)
  7223*        TRANSIDERR (8830-TRAN-ERROR)
  7224*        ERROR      (9990-ABEND)
  7225*    END-EXEC.
  7226*    MOVE '"$N?L[\.              ! " #00007213' TO DFHEIV0
  7227     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7229     MOVE X'2220233030303037323133' TO DFHEIV0(25:11)
  7230     CALL 'kxdfhei1' USING DFHEIV0
  7231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7232
  7233
  7234     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7235        PI-CALLING-PROGRAM   = XCTL-6592
  7236         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7237     ELSE
  7238         MOVE SPACES             TO RETURNED-FROM
  7239     END-IF.
  7240
  7241     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7242         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7243             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7244             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 135
* EL130.cbl
  7245             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7246             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7247             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7248             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7249             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7250             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7251         ELSE
  7252             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7253             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7254             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7255             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7256             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7257             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7258             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7259             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7260         END-IF
  7261     END-IF.
  7262
  7263     IF EIBTRNID = TRANS-ID
  7264         IF EIBAID = DFHCLEAR
  7265             GO TO 9400-CLEAR
  7266         ELSE
  7267             GO TO 0200-RECEIVE
  7268         END-IF
  7269     END-IF.
  7270
  7271     IF RETURNED-FROM NOT = SPACES
  7272         GO TO 0600-RECOVER-TEMP-STORAGE
  7273     END-IF.
  7274
  7275     MOVE LOW-VALUES TO EL130AO.
  7276     move zeros to pi-dcc-max-amt
  7277                   pi-dcc-max-benefits
  7278
  7279
  7280
  7281* EXEC CICS DELETEQ TS
  7282*         QUEUE   (QID)
  7283*    END-EXEC.
  7284*    MOVE '*&                    #   #00007268' TO DFHEIV0
  7285     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7286     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7287     MOVE X'2020233030303037323638' TO DFHEIV0(25:11)
  7288     CALL 'kxdfhei1' USING DFHEIV0,
  7289           QID,
  7290           DFHEIV99
  7291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7292
  7293
  7294 0100-TEST-ENTRY.
  7295     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7296         GO TO 0650-FROM-EL127
  7297     ELSE
  7298         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7299                                    PI-CERT-PROCESSED
  7300                                    PI-LETTER-ERROR-CODE
  7301     END-IF.
  7302
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 136
* EL130.cbl
  7303     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7304         GO TO 0640-FROM-EL132
  7305     END-IF.
  7306
  7307     GO TO 8100-SEND-INITIAL-MAP.
  7308
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 137
* EL130.cbl
  7310 0200-RECEIVE.
  7311     MOVE LOW-VALUES             TO EL130AI.
  7312
  7313     IF PI-PROCESSOR-ID = 'LGXX'
  7314*        NEXT SENTENCE
  7315         CONTINUE
  7316     ELSE
  7317
  7318* EXEC CICS READQ TS
  7319*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7320*            INTO    (SECURITY-CONTROL)
  7321*            LENGTH  (SC-COMM-LENGTH)
  7322*            ITEM    (SC-ITEM)
  7323*        END-EXEC
  7324*    MOVE '*$II   L              ''   #00007295' TO DFHEIV0
  7325     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7326     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7327     MOVE X'2020233030303037323935' TO DFHEIV0(25:11)
  7328     CALL 'kxdfhei1' USING DFHEIV0,
  7329           PI-SECURITY-TEMP-STORE-ID,
  7330           SECURITY-CONTROL,
  7331           SC-COMM-LENGTH,
  7332           SC-ITEM,
  7333           DFHEIV99,
  7334           DFHEIV99
  7335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7336         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7337         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7338         IF NOT DISPLAY-CAP
  7339             MOVE 'READ'              TO  SM-READ
  7340             PERFORM 9995-SECURITY-VIOLATION
  7341             MOVE ER-0070             TO  EMI-ERROR
  7342             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7343             GO TO 8100-SEND-INITIAL-MAP
  7344         END-IF
  7345     END-IF.
  7346
  7347     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7348         MOVE ER-7008 TO EMI-ERROR
  7349         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7350         MOVE -1 TO MAINTL
  7351         GO TO 8200-SEND-DATAONLY
  7352     END-IF.
  7353
  7354
  7355
  7356* EXEC CICS RECEIVE
  7357*         MAP     (MAP-NAME)
  7358*         MAPSET  (MAPSET-NAME)
  7359*         INTO    (EL130AI)
  7360*    END-EXEC.
  7361     MOVE LENGTH OF
  7362      EL130AI
  7363       TO DFHEIV11
  7364*    MOVE '8"T I  L              ''   #00007320' TO DFHEIV0
  7365     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7366     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7367     MOVE X'2020233030303037333230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 138
* EL130.cbl
  7368     CALL 'kxdfhei1' USING DFHEIV0,
  7369           MAP-NAME,
  7370           EL130AI,
  7371           DFHEIV11,
  7372           MAPSET-NAME,
  7373           DFHEIV99,
  7374           DFHEIV99
  7375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7376
  7377
  7378     IF NOT PI-NO-CARRIER-SECURITY
  7379        MOVE +1                  TO CLMCARRL
  7380        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7381     END-IF.
  7382
  7383     IF ENTERPFL = ZERO
  7384         GO TO 0300-CHECK-PFKEYS
  7385     END-IF.
  7386
  7387     IF EIBAID NOT = DFHENTER
  7388         MOVE ER-0004            TO EMI-ERROR
  7389         GO TO 0320-INPUT-ERROR
  7390     END-IF.
  7391
  7392     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7393         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7394     ELSE
  7395         MOVE ER-0029            TO EMI-ERROR
  7396         GO TO 0320-INPUT-ERROR
  7397     END-IF.
  7398
  7399 0300-CHECK-PFKEYS.
  7400     IF EIBAID = DFHPF23
  7401         GO TO 8810-PF23
  7402     END-IF.
  7403
  7404     IF EIBAID = DFHPF24
  7405         GO TO 9200-RETURN-MAIN-MENU
  7406     END-IF.
  7407
  7408     IF EIBAID = DFHPF12
  7409         GO TO 9500-PF12
  7410     END-IF.
  7411
  7412     IF EIBAID = DFHPF3
  7413         MOVE SPACES              TO MAINTI
  7414         MOVE ZEROS               TO MAINTL
  7415         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7416         MOVE XCTL-127            TO PGM-NAME
  7417         GO TO 9300-XCTL
  7418     END-IF.
  7419
  7420     IF EIBAID = DFHPF4
  7421         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7422         MOVE XCTL-132            TO PGM-NAME
  7423         GO TO 9300-XCTL
  7424     END-IF.
  7425
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 139
* EL130.cbl
  7426     IF EIBAID = DFHPF13
  7427         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7428             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7429             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7430             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7431             MOVE PI-STATE            TO  PI-CR-STATE
  7432             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7433             MOVE XCTL-650            TO  PGM-NAME
  7434             GO TO 9300-XCTL
  7435         ELSE
  7436             MOVE -1                  TO  ENTERPFL
  7437             MOVE ER-2566             TO  EMI-ERROR
  7438             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7439             GO TO 8100-SEND-INITIAL-MAP
  7440         END-IF
  7441     END-IF.
  7442
  7443     IF EIBAID = DFHPF5
  7444         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7445             ADD +1 TO PI-CERT-PROCESSED
  7446             GO TO 0650-FROM-EL127
  7447         ELSE
  7448             MOVE ER-7686         TO EMI-ERROR
  7449             GO TO 0320-INPUT-ERROR
  7450         END-IF
  7451     END-IF.
  7452
  7453     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7454         GO TO 0800-TEST-PREVIOUS-CONTROL
  7455     END-IF.
  7456
  7457     IF PI-HAS-CLAS-IC-CRDTCRD
  7458         IF EIBAID = DFHPF10
  7459             MOVE XCTL-725          TO PGM-NAME
  7460             GO TO 9300-XCTL
  7461         END-IF
  7462     END-IF.
  7463
  7464     IF EIBAID = DFHPF14
  7465         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7466         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7467         MOVE XCTL-659            TO PGM-NAME
  7468         GO TO 9300-XCTL
  7469     END-IF.
  7470
  7471     IF EIBAID = DFHPF15
  7472         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7473         MOVE XCTL-114            TO PGM-NAME
  7474         GO TO 9300-XCTL
  7475     END-IF.
  7476
  7477*    IF EIBAID = DFHPF11
  7478*       GO TO 0600-RECOVER-TEMP-STORAGE
  7479*    END-IF
  7480     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7481         GO TO 0330-EDIT-DATA
  7482     END-IF.
  7483
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 140
* EL130.cbl
  7484     MOVE ER-0029                TO EMI-ERROR.
  7485
  7486 0320-INPUT-ERROR.
  7487     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7488
  7489     MOVE AL-UNBON               TO ENTERPFA.
  7490
  7491     IF ENTERPFL = ZERO
  7492         MOVE -1                 TO MAINTL
  7493     ELSE
  7494         MOVE -1                 TO ENTERPFL
  7495     END-IF.
  7496
  7497     GO TO 8200-SEND-DATAONLY.
  7498
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 141
* EL130.cbl
  7500 0330-EDIT-DATA.
  7501
  7502     IF MAINTI = 'S'
  7503         IF PRTOPTL GREATER THAN 0
  7504             IF PRTOPTI NOT = 'N' AND 'L'
  7505                 MOVE AL-UABON   TO  PRTOPTA
  7506                 MOVE -1         TO  PRTOPTL
  7507                 MOVE ER-0334    TO  EMI-ERROR
  7508                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7509                 GO TO 8200-SEND-DATAONLY
  7510             ELSE
  7511                 IF PRTOPTI = 'L'
  7512                     GO TO 0400-CREATE-ELACTQ
  7513                 ELSE
  7514                     GO TO 0480-PRINT-NOW
  7515                 END-IF
  7516             END-IF
  7517         ELSE
  7518             GO TO 1000-SHOW-CLAIM
  7519         END-IF
  7520     END-IF.
  7521
  7522     IF NOT MODIFY-CAP
  7523         MOVE 'UPDATE'       TO  SM-READ
  7524         PERFORM 9995-SECURITY-VIOLATION
  7525         MOVE ER-0070        TO  EMI-ERROR
  7526         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7527         GO TO 8100-SEND-INITIAL-MAP
  7528     END-IF.
  7529
  7530     IF MAINTI = 'D'
  7531         GO TO 2000-DELETE-CLAIM
  7532     END-IF.
  7533
  7534     IF MAINTI = 'A'
  7535         GO TO 3000-ADD-CLAIM
  7536     END-IF.
  7537
  7538     IF MAINTI = 'I'
  7539         GO TO 5000-INCURRED-CHANGE
  7540     END-IF.
  7541
  7542     MOVE ER-0023                TO EMI-ERROR.
  7543     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7544     MOVE -1                     TO MAINTL.
  7545     MOVE AL-UABON               TO MAINTA.
  7546
  7547     GO TO 8200-SEND-DATAONLY.
  7548
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 142
* EL130.cbl
  7550 0400-CREATE-ELACTQ.
  7551     IF CLMNOI   = PI-LAST-CLAIM      AND
  7552        CLMCARRI = PI-LAST-CARR       AND
  7553        CERTNOI  = PI-LAST-CERT-PRIME AND
  7554        SUFXI    = PI-LAST-CERT-SUFX
  7555         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7556         MOVE PI-LAST-CARR       TO PI-CARRIER
  7557         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7558     ELSE
  7559         MOVE ER-0207            TO EMI-ERROR
  7560         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7561         MOVE -1                 TO MAINTL
  7562         GO TO 8200-SEND-DATAONLY
  7563     END-IF.
  7564
  7565     IF (NOT PI-NO-CARRIER-SECURITY OR
  7566         NOT PI-NO-ACCOUNT-SECURITY)
  7567         MOVE AL-UABON      TO  PRTOPTA
  7568         MOVE -1            TO  PRTOPTL
  7569         MOVE ER-2378       TO  EMI-ERROR
  7570         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7571         GO TO 8200-SEND-DATAONLY
  7572     END-IF.
  7573
  7574     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7575     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7576     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7577     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7578
  7579
  7580
  7581* EXEC CICS HANDLE CONDITION
  7582*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7583*    END-EXEC.
  7584*    MOVE '"$I                   ! # #00007528' TO DFHEIV0
  7585     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7586     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7587     MOVE X'2320233030303037353238' TO DFHEIV0(25:11)
  7588     CALL 'kxdfhei1' USING DFHEIV0
  7589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7590
  7591
  7592
  7593
  7594* EXEC CICS READ
  7595*         UPDATE
  7596*         DATASET    (ELACTQ-DSID)
  7597*         SET        (ADDRESS OF ACTIVITY-QUE)
  7598*         RIDFLD     (ELACTQ-KEY)
  7599*    END-EXEC.
  7600*    MOVE '&"S        EU         (   #00007533' TO DFHEIV0
  7601     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7602     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7603     MOVE X'2020233030303037353333' TO DFHEIV0(25:11)
  7604     CALL 'kxdfhei1' USING DFHEIV0,
  7605           ELACTQ-DSID,
  7606           DFHEIV20,
  7607           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 143
* EL130.cbl
  7608           ELACTQ-KEY,
  7609           DFHEIV99,
  7610           DFHEIV99,
  7611           DFHEIV99
  7612     SET ADDRESS OF ACTIVITY-QUE TO
  7613         DFHEIV20
  7614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7615
  7616
  7617     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7618     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7619
  7620
  7621
  7622* EXEC CICS REWRITE
  7623*         DATASET     (ELACTQ-DSID)
  7624*         FROM        (ACTIVITY-QUE)
  7625*    END-EXEC.
  7626     MOVE LENGTH OF
  7627      ACTIVITY-QUE
  7628       TO DFHEIV11
  7629*    MOVE '&& L                  %   #00007544' TO DFHEIV0
  7630     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7631     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7632     MOVE X'2020233030303037353434' TO DFHEIV0(25:11)
  7633     CALL 'kxdfhei1' USING DFHEIV0,
  7634           ELACTQ-DSID,
  7635           ACTIVITY-QUE,
  7636           DFHEIV11,
  7637           DFHEIV99
  7638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7639
  7640
  7641     GO TO 0470-STATUS-FINISH.
  7642
  7643 0450-ADD-ELACTQ-RECORD.
  7644
  7645
  7646* EXEC CICS GETMAIN
  7647*        SET     (ADDRESS OF ACTIVITY-QUE)
  7648*        LENGTH  (ELACTQ-LENGTH)
  7649*        INITIMG (GETMAIN-SPACE)
  7650*    END-EXEC.
  7651*    MOVE ',"IL                  $   #00007553' TO DFHEIV0
  7652     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7653     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7654     MOVE X'2020233030303037353533' TO DFHEIV0(25:11)
  7655     CALL 'kxdfhei1' USING DFHEIV0,
  7656           DFHEIV20,
  7657           ELACTQ-LENGTH,
  7658           GETMAIN-SPACE
  7659     SET ADDRESS OF ACTIVITY-QUE TO
  7660         DFHEIV20
  7661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7662
  7663
  7664     MOVE 'AQ'              TO AQ-RECORD-ID.
  7665     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 144
* EL130.cbl
  7666     MOVE +0                TO AQ-PAYMENT-COUNTER
  7667                               AQ-PMT-UNAPPROVED-COUNT.
  7668     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7669                               AQ-FOLLOWUP-DATE.
  7670     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7671     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7672
  7673
  7674
  7675* EXEC CICS WRITE
  7676*         DATASET     (ELACTQ-DSID)
  7677*         FROM        (ACTIVITY-QUE)
  7678*         RIDFLD      (ELACTQ-KEY)
  7679*    END-EXEC.
  7680     MOVE LENGTH OF
  7681      ACTIVITY-QUE
  7682       TO DFHEIV11
  7683*    MOVE '&$ L                  ''   #00007569' TO DFHEIV0
  7684     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7685     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7686     MOVE X'2020233030303037353639' TO DFHEIV0(25:11)
  7687     CALL 'kxdfhei1' USING DFHEIV0,
  7688           ELACTQ-DSID,
  7689           ACTIVITY-QUE,
  7690           DFHEIV11,
  7691           ELACTQ-KEY,
  7692           DFHEIV99,
  7693           DFHEIV99
  7694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7695
  7696
  7697 0470-STATUS-FINISH.
  7698     MOVE AL-UANOF               TO  PRTOPTA
  7699                                     ALTPRTA.
  7700
  7701     MOVE SPACES                 TO  PRTOPTO
  7702                                     ALTPRTO.
  7703
  7704     MOVE ER-0000                TO EMI-ERROR.
  7705     MOVE -1                     TO MAINTL.
  7706     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7707     GO TO 8100-SEND-INITIAL-MAP.
  7708
  7709 0480-PRINT-NOW.
  7710
  7711
  7712* EXEC CICS HANDLE CONDITION
  7713*        TERMIDERR   (8820-TERM-ERROR)
  7714*        TRANSIDERR  (8830-TRAN-ERROR)
  7715*    END-EXEC.
  7716*    MOVE '"$[\                  ! $ #00007589' TO DFHEIV0
  7717     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7718     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7719     MOVE X'2420233030303037353839' TO DFHEIV0(25:11)
  7720     CALL 'kxdfhei1' USING DFHEIV0
  7721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7722
  7723
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 145
* EL130.cbl
  7724     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7725     MOVE '1'                    TO  CNTL-REC-TYPE.
  7726     MOVE SPACES                 TO  CNTL-ACCESS.
  7727     MOVE +0                     TO  CNTL-SEQ-NO.
  7728     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7729
  7730     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7731
  7732     IF CF-FORMS-PRINTER-ID = SPACES
  7733         IF ALTPRTL NOT GREATER THAN 0
  7734             MOVE ER-0337        TO  EMI-ERROR
  7735             MOVE -1             TO  ALTPRTL
  7736             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7737             GO TO 8200-SEND-DATAONLY
  7738         END-IF
  7739     END-IF.
  7740
  7741     IF ALTPRTL GREATER THAN 0
  7742         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7743     END-IF.
  7744
  7745     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7746     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7747     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7748
  7749
  7750
  7751* EXEC CICS START
  7752*        TRANSID   (START-TRANS-ID)
  7753*        TERMID    (CF-FORMS-PRINTER-ID)
  7754*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7755*        LENGTH    (PI-COMM-LENGTH)
  7756*    END-EXEC.
  7757*    MOVE '0( LFT                1   #00007620' TO DFHEIV0
  7758     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7759     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7760     MOVE X'2020233030303037363230' TO DFHEIV0(25:11)
  7761     CALL 'kxdfhei1' USING DFHEIV0,
  7762           DFHEIV99,
  7763           START-TRANS-ID,
  7764           DFHEIV99,
  7765           PROGRAM-INTERFACE-BLOCK,
  7766           PI-COMM-LENGTH,
  7767           CF-FORMS-PRINTER-ID,
  7768           DFHEIV99,
  7769           DFHEIV99,
  7770           DFHEIV99,
  7771           DFHEIV99,
  7772           DFHEIV99,
  7773           DFHEIV99,
  7774           DFHEIV99,
  7775           DFHEIV99,
  7776           DFHEIV99,
  7777           DFHEIV99
  7778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7779
  7780
  7781     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 146
* EL130.cbl
  7782                                     ALTPRTA.
  7783
  7784     MOVE SPACES                 TO  PRTOPTO
  7785                                     ALTPRTO.
  7786
  7787     MOVE ER-0000                TO  EMI-ERROR.
  7788     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7789     MOVE -1                     TO  MAINTL.
  7790     GO TO 8100-SEND-INITIAL-MAP.
  7791
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 147
* EL130.cbl
  7793 0500-CREATE-TEMP-STORAGE.
  7794     MOVE EIBCPOSN               TO PI-CURSOR.
  7795
  7796    move emi-line1               to errmsg1o
  7797    move emi-line2               to errmsg2o
  7798    move emi-sub                 to pi-emi-sub
  7799
  7800
  7801* EXEC CICS WRITEQ TS
  7802*        QUEUE   (QID)
  7803*        FROM    (EL130AI)
  7804*        LENGTH  (QID-MAP-LENGTH)
  7805*    END-EXEC.
  7806*    MOVE '*"     L              ''   #00007646' TO DFHEIV0
  7807     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7808     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7809     MOVE X'2020233030303037363436' TO DFHEIV0(25:11)
  7810     CALL 'kxdfhei1' USING DFHEIV0,
  7811           QID,
  7812           EL130AI,
  7813           QID-MAP-LENGTH,
  7814           DFHEIV99,
  7815           DFHEIV99,
  7816           DFHEIV99
  7817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7818
  7819
  7820
  7821
  7822* EXEC CICS WRITEQ TS
  7823*        QUEUE    (QID)
  7824*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7825*        LENGTH   (PI-COMM-LENGTH)
  7826*    END-EXEC.
  7827*    MOVE '*"     L              ''   #00007653' TO DFHEIV0
  7828     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7829     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7830     MOVE X'2020233030303037363533' TO DFHEIV0(25:11)
  7831     CALL 'kxdfhei1' USING DFHEIV0,
  7832           QID,
  7833           PROGRAM-INTERFACE-BLOCK,
  7834           PI-COMM-LENGTH,
  7835           DFHEIV99,
  7836           DFHEIV99,
  7837           DFHEIV99
  7838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7839
  7840
  7841 0599-EXIT.
  7842      EXIT.
  7843
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 148
* EL130.cbl
  7845 0600-RECOVER-TEMP-STORAGE.
  7846     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7847     MOVE PI-EL127-TO-EL130-CNTRL
  7848                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7849     MOVE PI-EL659-TO-EL130-CNTRL
  7850                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7851     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7852     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7853     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7854     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7855     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7856     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7857     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7858     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7859     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7860     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7861     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7862     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7863     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7864     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7865     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7866     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7867                                 TO SAVE-BENEFICIARY
  7868
  7869
  7870
  7871* EXEC CICS HANDLE CONDITION
  7872*        NOTFND  (0660-NOT-FOUND)
  7873*        QIDERR  (0670-QIDERR)
  7874*    END-EXEC.
  7875*    MOVE '"$IN                  ! % #00007688' TO DFHEIV0
  7876     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7878     MOVE X'2520233030303037363838' TO DFHEIV0(25:11)
  7879     CALL 'kxdfhei1' USING DFHEIV0
  7880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7881
  7882
  7883
  7884
  7885* EXEC CICS READQ TS
  7886*        QUEUE    (QID)
  7887*        INTO     (EL130AI)
  7888*        LENGTH   (QID-MAP-LENGTH)
  7889*    END-EXEC.
  7890*    MOVE '*$I    L              ''   #00007694' TO DFHEIV0
  7891     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7892     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7893     MOVE X'2020233030303037363934' TO DFHEIV0(25:11)
  7894     CALL 'kxdfhei1' USING DFHEIV0,
  7895           QID,
  7896           EL130AI,
  7897           QID-MAP-LENGTH,
  7898           DFHEIV99,
  7899           DFHEIV99,
  7900           DFHEIV99
  7901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7902
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 149
* EL130.cbl
  7903
  7904     IF RETURNED-FROM = XCTL-131
  7905        IF CLAIM-DELETED-BY-EL131
  7906            MOVE LOW-VALUES      TO CERTNOI
  7907                                    SUFXI
  7908            MOVE ZEROS           TO CERTNOL
  7909                                    SUFXL
  7910         END-IF
  7911     END-IF.
  7912
  7913     IF RETURNED-FROM = XCTL-131
  7914         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7915         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7916                                    PI-CERT-PROCESSED
  7917     ELSE
  7918
  7919
  7920* EXEC CICS READQ TS
  7921*             QUEUE   (QID)
  7922*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7923*             LENGTH  (PI-COMM-LENGTH)
  7924*        END-EXEC
  7925*    MOVE '*$I    L              ''   #00007715' TO DFHEIV0
  7926     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7927     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7928     MOVE X'2020233030303037373135' TO DFHEIV0(25:11)
  7929     CALL 'kxdfhei1' USING DFHEIV0,
  7930           QID,
  7931           PROGRAM-INTERFACE-BLOCK,
  7932           PI-COMM-LENGTH,
  7933           DFHEIV99,
  7934           DFHEIV99,
  7935           DFHEIV99
  7936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7937     END-IF.
  7938
  7939
  7940* EXEC CICS DELETEQ TS
  7941*        QUEUE   (QID)
  7942*    END-EXEC.
  7943*    MOVE '*&                    #   #00007722' TO DFHEIV0
  7944     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7945     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7946     MOVE X'2020233030303037373232' TO DFHEIV0(25:11)
  7947     CALL 'kxdfhei1' USING DFHEIV0,
  7948           QID,
  7949           DFHEIV99
  7950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7951
  7952
  7953     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7954
  7955     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7956         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7957         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7958         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7959         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7960         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 150
* EL130.cbl
  7961         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7962         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7963         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7964         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7965         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7966         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7967         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7968         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7969         MOVE SAVE-CERT-ACCESS-CONTROL
  7970                                    TO PI-CERT-ACCESS-CONTROL
  7971         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7972                                    TO PI-CARRIER-CONTROL-LEVEL
  7973     END-IF.
  7974
  7975*    IF EIBAID = DFHPF11
  7976*       move errmsg1i            to emi-line1
  7977*       move errmsg2i            to emi-line2
  7978*       move pi-emi-sub          to emi-sub
  7979*       go to 8200-SEND-DATAONLY
  7980*    end-if
  7981     IF RETURNED-FROM = XCTL-127
  7982         MOVE SAVE-EL127-TO-EL130-CNTRL
  7983                                 TO PI-EL127-TO-EL130-CNTRL
  7984     END-IF.
  7985
  7986     IF RETURNED-FROM = XCTL-6592
  7987        MOVE SAVE-EL659-TO-EL130-CNTRL
  7988                                 TO PI-EL659-TO-EL130-CNTRL
  7989     END-IF.
  7990
  7991     IF RETURNED-FROM = XCTL-114
  7992        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7993           MOVE SAVE-BENEFICIARY TO BENECDI
  7994           MOVE +10              TO BENECDL
  7995           MOVE -1               TO BIRTHDTL
  7996        END-IF
  7997     END-IF.
  7998     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7999
  8000     IF MAINTL NOT = ZERO
  8001         MOVE AL-UANON           TO MAINTA
  8002     END-IF.
  8003
  8004     IF ENTERPFL NOT = ZERO
  8005         MOVE AL-UNNON           TO ENTERPFA
  8006     END-IF.
  8007
  8008     IF RETURNED-FROM = XCTL-127
  8009         GO TO 0650-FROM-EL127
  8010     END-IF.
  8011
  8012     IF RETURNED-FROM = XCTL-132
  8013         GO TO 0640-FROM-EL132
  8014     END-IF.
  8015
  8016     IF RETURNED-FROM = XCTL-650
  8017         MOVE AL-SABON           TO PF5A
  8018         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 151
* EL130.cbl
  8019     END-IF.
  8020
  8021     IF RETURNED-FROM = XCTL-6592
  8022         GO TO 0630-FROM-EL6592
  8023     END-IF.
  8024
  8025     IF MAINTI = 'S' OR 'I'
  8026        GO TO 1000-SHOW-CLAIM
  8027     END-IF.
  8028
  8029     GO TO 8100-SEND-INITIAL-MAP.
  8030
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 152
* EL130.cbl
  8032 0630-FROM-EL6592.
  8033     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  8034     MOVE PI-EL659-GROUPING      TO GROUPO.
  8035     MOVE PI-EL659-STATE         TO STATEO.
  8036     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  8037
  8038     MOVE AL-UANON               TO CRTCARRA
  8039                                    GROUPA
  8040                                    STATEA
  8041                                    ACCOUNTA.
  8042     GO TO 8100-SEND-INITIAL-MAP.
  8043
  8044 0640-FROM-EL132.
  8045     IF PI-CLAIM-NO = SPACES
  8046         GO TO 0645-NO-CLAIM-SELECTED
  8047     END-IF.
  8048
  8049     MOVE LOW-VALUES             TO EL130AI.
  8050     MOVE 'MSTR'                 TO FILE-SWITCH.
  8051     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8052     MOVE PI-CARRIER             TO MSTR-CARRIER.
  8053     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  8054                                    CLMNOO.
  8055     MOVE AL-UANON               TO CLMNOA.
  8056     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  8057
  8058
  8059
  8060* EXEC CICS HANDLE CONDITION
  8061*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8062*    END-EXEC.
  8063*    MOVE '"$I                   ! & #00007832' TO DFHEIV0
  8064     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8065     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8066     MOVE X'2620233030303037383332' TO DFHEIV0(25:11)
  8067     CALL 'kxdfhei1' USING DFHEIV0
  8068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8069
  8070
  8071     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8072     MOVE 'X'                    TO CLAIM-SWITCH.
  8073     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8074     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8075     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8076     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8077     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8078     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8079
  8080     MOVE ER-0213                TO EMI-ERROR.
  8081     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8082     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  8083     GO TO 8100-SEND-INITIAL-MAP.
  8084
  8085 0645-NO-CLAIM-SELECTED.
  8086
  8087     IF MAINTI = 'S' OR 'I'
  8088        GO TO 1000-SHOW-CLAIM
  8089     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 153
* EL130.cbl
  8090
  8091     GO TO 8100-SEND-INITIAL-MAP.
  8092
  8093 0650-FROM-EL127.
  8094
  8095     IF PI-CERT-SELECT-CNT GREATER THAN +6
  8096         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  8097                                    PI-CERT-PROCESSED
  8098     END-IF.
  8099
  8100     IF PI-RETURN-TO-PROGRAM = XCTL-727
  8101         MOVE +1                 TO PI-CERT-SELECT-CNT
  8102                                    PI-CERT-PROCESSED
  8103         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  8104         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  8105         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  8106         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  8107         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  8108         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  8109     END-IF.
  8110
  8111     IF PI-CERT-SELECT-CNT = ZERO
  8112         IF CERTNOI NOT = SPACES AND LOW-VALUES
  8113             MOVE CERTNOI        TO PI-CERT-NO
  8114             MOVE SUFXI          TO PI-CERT-SFX
  8115             GO TO 3000-READ-CERT
  8116         ELSE
  8117             GO TO 8100-SEND-INITIAL-MAP
  8118         END-IF
  8119     END-IF.
  8120
  8121     MOVE AL-SABON               TO PF5A.
  8122
  8123     IF PI-CERT-PROCESSED = 1
  8124         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  8125     END-IF.
  8126
  8127     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  8128     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  8129
  8130     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  8131     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  8132                                 TO CERT-CARRIER
  8133                                    PI-CARRIER.
  8134     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  8135                                 TO CERT-GROUPING
  8136                                    PI-GROUPING.
  8137     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  8138                                 TO CERT-STATE
  8139                                    PI-STATE.
  8140     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8141                                 TO CERT-ACCOUNT
  8142                                    PI-ACCOUNT.
  8143     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8144                                 TO CERT-EFF-DT
  8145                                    PI-CERT-EFF-DT.
  8146     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8147                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 154
* EL130.cbl
  8148                                    PI-CERT-NO.
  8149
  8150     MOVE 'CERT'                 TO FILE-SWITCH.
  8151     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8152
  8153     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8154     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8155     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8156
  8157     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8158         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8159         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8160         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8161         IF INCURRED-DATE-MATCH
  8162             MOVE ER-7352        TO EMI-ERROR
  8163             MOVE -1             TO CERTNOL
  8164             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8165         ELSE
  8166             IF NO-CLAIMS-FOR-CERT
  8167                 MOVE ER-7353    TO EMI-ERROR
  8168                 MOVE -1         TO CERTNOL
  8169                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8170             ELSE
  8171                 MOVE ER-0558    TO EMI-ERROR
  8172                 MOVE -1         TO CERTNOL
  8173                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8174             END-IF
  8175         END-IF
  8176     END-IF.
  8177
  8178     MOVE SPACES                 TO PI-PRT-OPT
  8179                                    PI-ALT-PRT.
  8180
  8181     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8182
  8183     if (ws-lf-joint-indicator not = 'J')
  8184        and (ws-ah-joint-indicator not = 'J')
  8185        move 'P'                 to INSTYPEO
  8186        MOVE AL-UANON            TO INSTYPEA
  8187     end-if
  8188     IF LSTNMEL NOT GREATER ZERO
  8189        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8190         MOVE CRTLNMEI           TO  LSTNMEO
  8191         MOVE CRTFNMEI           TO  FSTNMEO
  8192         MOVE CRTINITI           TO  INITO
  8193         MOVE AL-UANON           TO  LSTNMEA
  8194                                     FSTNMEA
  8195                                     INITA
  8196     END-IF.
  8197
  8198     IF SSNL GREATER ZERO
  8199         GO TO 0655-SKIP-SOCIAL-SECURITY
  8200     END-IF.
  8201
  8202     IF CRTSSNI = SPACES OR LOW-VALUES
  8203         GO TO 0655-SKIP-SOCIAL-SECURITY
  8204     END-IF.
  8205
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 155
* EL130.cbl
  8206     IF CM-SSN-STATE   = CM-STATE AND
  8207        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8208            GO TO 0655-SKIP-SOCIAL-SECURITY
  8209     END-IF.
  8210
  8211     MOVE CRTSSNI                TO SSNO
  8212     MOVE AL-UANON               TO SSNA.
  8213
  8214 0655-SKIP-SOCIAL-SECURITY.
  8215
  8216     IF CLMCARRL NOT = ZERO  AND
  8217        CLMCARRI NOT = CRTCARRI
  8218        MOVE ER-0562             TO EMI-ERROR
  8219        MOVE AL-UABON            TO CLMCARRA
  8220        MOVE -1                  TO CLMCARRL
  8221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8222     END-IF.
  8223
  8224     IF CLMCARRL = ZERO
  8225        MOVE AL-UANON            TO CLMCARRA
  8226        MOVE CRTCARRI            TO CLMCARRI
  8227     END-IF.
  8228
  8229     MOVE 'A'                    TO MAINTO.
  8230     MOVE AL-UANON               TO MAINTA.
  8231
  8232     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8233        GO TO 8100-SEND-INITIAL-MAP
  8234     ELSE
  8235        GO TO 8150-SEND-MAP-CURSOR
  8236     END-IF.
  8237
  8238 0660-NOT-FOUND.
  8239     MOVE ER-0214                TO EMI-ERROR.
  8240     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8241     GO TO 8100-SEND-INITIAL-MAP.
  8242
  8243 0670-QIDERR.
  8244     MOVE ER-0033                TO EMI-ERROR.
  8245     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8246     GO TO 8100-SEND-INITIAL-MAP.
  8247
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 156
* EL130.cbl
  8249 0680-PLUG-SELECTED-CERTS.
  8250
  8251     MOVE AL-SANON               TO BCERT1A
  8252                                    BSUFX1A
  8253                                    BCERT2A
  8254                                    BSUFX2A
  8255                                    BCERT3A
  8256                                    BSUFX3A
  8257                                    BCERT4A
  8258                                    BSUFX4A
  8259                                    BCERT5A
  8260                                    BSUFX5A.
  8261
  8262     IF PCERTNOO = SPACES OR LOW-VALUES
  8263         MOVE PI-EL127-CERT-PRIME (1)
  8264                                 TO PCERTNOO
  8265         MOVE PI-EL127-CERT-SUFX  (1)
  8266                                 TO PSUFXO
  8267     END-IF.
  8268
  8269     MOVE PI-EL127-CERT-PRIME (1)
  8270                                 TO BCERT1O.
  8271     MOVE PI-EL127-CERT-SUFX  (1)
  8272                                 TO BSUFX1O.
  8273
  8274     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8275         MOVE PI-EL127-CERT-PRIME (2)
  8276                                 TO BCERT2O
  8277         MOVE PI-EL127-CERT-SUFX  (2)
  8278                                 TO BSUFX2O
  8279     ELSE
  8280         MOVE LOW-VALUES         TO BCERT2O
  8281                                    BSUFX2O
  8282     END-IF.
  8283
  8284     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8285         MOVE PI-EL127-CERT-PRIME (3)
  8286                                 TO BCERT3O
  8287         MOVE PI-EL127-CERT-SUFX  (3)
  8288                                 TO BSUFX3O
  8289     ELSE
  8290         MOVE LOW-VALUES         TO BCERT3O
  8291                                    BSUFX3O
  8292     END-IF.
  8293
  8294     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8295         MOVE PI-EL127-CERT-PRIME (4)
  8296                                 TO BCERT4O
  8297         MOVE PI-EL127-CERT-SUFX  (4)
  8298                                 TO BSUFX4O
  8299     ELSE
  8300         MOVE LOW-VALUES         TO BCERT4O
  8301                                    BSUFX4O
  8302     END-IF.
  8303
  8304     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8305         MOVE PI-EL127-CERT-PRIME (5)
  8306                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 157
* EL130.cbl
  8307         MOVE PI-EL127-CERT-SUFX  (5)
  8308                                 TO BSUFX5O
  8309     ELSE
  8310         MOVE LOW-VALUES         TO BCERT5O
  8311                                    BSUFX5O
  8312     END-IF.
  8313
  8314 0680-EXIT.
  8315     EXIT.
  8316
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 158
* EL130.cbl
  8318 0690-HIGHLIGHT-CERTS.
  8319
  8320     MOVE AL-UANON               TO PCERTNOA
  8321                                    PSUFXA.
  8322
  8323     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8324        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8325            MOVE AL-SABON        TO BCERT1A
  8326                                    BSUFX1A
  8327     ELSE
  8328         MOVE AL-SANON           TO BCERT1A
  8329                                    BSUFX1A
  8330     END-IF.
  8331
  8332     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8333        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8334            MOVE AL-SABON        TO BCERT2A
  8335                                    BSUFX2A
  8336     ELSE
  8337         MOVE AL-SANON           TO BCERT2A
  8338                                    BSUFX2A
  8339     END-IF.
  8340
  8341     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8342        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8343            MOVE AL-SABON        TO BCERT3A
  8344                                    BSUFX3A
  8345     ELSE
  8346         MOVE AL-SANON           TO BCERT3A
  8347                                    BSUFX3A
  8348     END-IF.
  8349
  8350     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8351        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8352            MOVE AL-SABON        TO BCERT4A
  8353                                    BSUFX4A
  8354     ELSE
  8355         MOVE AL-SANON           TO BCERT4A
  8356                                    BSUFX4A
  8357     END-IF.
  8358
  8359     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8360        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8361            MOVE AL-SABON        TO BCERT5A
  8362                                    BSUFX5A
  8363     ELSE
  8364         MOVE AL-SANON           TO BCERT5A
  8365                                    BSUFX5A
  8366     END-IF.
  8367
  8368 0690-EXIT.
  8369     EXIT.
  8370
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 159
* EL130.cbl
  8372 0800-TEST-PREVIOUS-CONTROL.
  8373     IF CLMNOI   = PI-LAST-CLAIM       AND
  8374        CLMCARRI = PI-LAST-CARR        AND
  8375        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8376        SUFXI    = PI-LAST-CERT-SUFX
  8377*        NEXT SENTENCE
  8378         CONTINUE
  8379     ELSE
  8380         MOVE ER-0207            TO EMI-ERROR
  8381         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8382         MOVE -1                 TO MAINTL
  8383         GO TO 8200-SEND-DATAONLY
  8384     END-IF.
  8385
  8386     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8387
  8388     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8389     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8390     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8391
  8392     IF EIBAID = DFHPF7
  8393         MOVE XCTL-157           TO PGM-NAME
  8394     END-IF.
  8395
  8396     IF EIBAID = DFHPF8
  8397         MOVE XCTL-141           TO PGM-NAME
  8398     END-IF.
  8399
  8400     IF EIBAID = DFHPF9
  8401        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8402                                    PI-SAVED-PROGRAM-2
  8403                                    PI-SAVED-PROGRAM-3
  8404                                    PI-SAVED-PROGRAM-4
  8405                                    PI-SAVED-PROGRAM-5
  8406                                    PI-SAVED-PROGRAM-6
  8407        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8408        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8409        MOVE XCTL-150            TO PGM-NAME
  8410     END-IF.
  8411
  8412     GO TO 9300-XCTL.
  8413
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 160
* EL130.cbl
  8415 1000-SHOW-CLAIM.
  8416
  8417     IF CLMNOL = ZERO
  8418         MOVE -1                 TO CLMNOL
  8419         MOVE AL-UABON           TO CLMNOA
  8420         MOVE ER-0202            TO EMI-ERROR
  8421         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8422     ELSE
  8423         MOVE AL-UANON           TO CLMNOA
  8424     END-IF.
  8425
  8426     IF PI-NO-CARRIER-SECURITY
  8427        IF CLMCARRL = ZERO
  8428             MOVE -1             TO CLMCARRL
  8429             MOVE AL-UABON       TO CLMCARRA
  8430             MOVE ER-0194        TO EMI-ERROR
  8431             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8432         ELSE
  8433             MOVE AL-UANON       TO CLMCARRA
  8434         END-IF
  8435     END-IF.
  8436
  8437     IF SUFXL = ZERO
  8438         MOVE SPACES             TO SUFXI
  8439         MOVE AL-UANON           TO SUFXA
  8440     ELSE
  8441         MOVE AL-UANON           TO SUFXA
  8442     END-IF.
  8443
  8444     IF NOT EMI-NO-ERRORS
  8445         GO TO 1050-SEND-CHECK
  8446     END-IF.
  8447
  8448
  8449
  8450* EXEC CICS HANDLE CONDITION
  8451*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8452*    END-EXEC.
  8453*    MOVE '"$I                   ! '' #00008214' TO DFHEIV0
  8454     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8456     MOVE X'2720233030303038323134' TO DFHEIV0(25:11)
  8457     CALL 'kxdfhei1' USING DFHEIV0
  8458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8459
  8460
  8461     MOVE 'MSTR'                 TO FILE-SWITCH
  8462     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8463
  8464     MOVE CLMCARRI               TO MSTR-CARRIER.
  8465     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8466
  8467     IF CERTNOL = ZERO     OR
  8468        CERTNOI = SPACES   OR
  8469        CERTNOI = LOW-VALUES
  8470         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8471         MOVE AL-SANON        TO CERTNOA
  8472                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 161
* EL130.cbl
  8473     ELSE
  8474         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8475     END-IF.
  8476
  8477     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8478     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8479
  8480
  8481
  8482* EXEC CICS HANDLE CONDITION
  8483*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8484*    END-EXEC.
  8485*    MOVE '"$I                   ! ( #00008238' TO DFHEIV0
  8486     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8488     MOVE X'2820233030303038323338' TO DFHEIV0(25:11)
  8489     CALL 'kxdfhei1' USING DFHEIV0
  8490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8491
  8492
  8493     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8494
  8495     IF NOT PI-NO-ACCOUNT-SECURITY
  8496         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8497           MOVE ER-2371          TO EMI-ERROR
  8498           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8499           MOVE -1               TO MAINTL
  8500           GO TO 8200-SEND-DATAONLY
  8501         END-IF
  8502     END-IF.
  8503
  8504
  8505
  8506* EXEC CICS HANDLE CONDITION
  8507*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8508*    END-EXEC.
  8509*    MOVE '"$I                   ! ) #00008254' TO DFHEIV0
  8510     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8512     MOVE X'2920233030303038323534' TO DFHEIV0(25:11)
  8513     CALL 'kxdfhei1' USING DFHEIV0
  8514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8515
  8516
  8517     MOVE 'Y'                    TO CLAIM-SWITCH.
  8518     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8519     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8520     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8521     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8522     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8523
  8524 1000-SHOW-END-OF-PERFORM.
  8525
  8526     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8527     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8528     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8529     MOVE CL-CERT-STATE          TO CERT-STATE.
  8530     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 162
* EL130.cbl
  8531     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8532     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8533
  8534     MOVE 'CERT'                 TO FILE-SWITCH.
  8535
  8536     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8537
  8538     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8539     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8540     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8541     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8542     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8543     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8544     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8545     MOVE CLMCARRI               TO PI-LAST-CARR.
  8546
  8547     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8548
  8549     IF MAINTI = 'I'
  8550         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8551                 BIRTHDTA  LSTNMEA   RELCLMA
  8552                 LOANNOA   LOANBALA  BENECDA
  8553         MOVE AL-SANON TO  SSNA
  8554         MOVE SPACES   TO  INCURI    REPORTI
  8555         MOVE 'Y'      TO PI-INCURR-SW
  8556         MOVE ER-0522  TO EMI-ERROR
  8557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8558     ELSE
  8559         MOVE ' '      TO PI-INCURR-SW
  8560     END-IF.
  8561
  8562     MOVE -1                     TO MAINTL.
  8563     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8564     MOVE CERT-GROUPING          TO PI-GROUPING.
  8565     MOVE CERT-STATE             TO PI-STATE.
  8566     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8567     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8568     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8569     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8570
  8571     IF RETURNED-FROM NOT = SPACES
  8572         GO TO 8100-SEND-INITIAL-MAP
  8573     ELSE
  8574         GO TO 8200-SEND-DATAONLY
  8575     END-IF.
  8576
  8577 1025-SHOW-RECORD-NOT-FOUND.
  8578
  8579     IF FILE-SWITCH = 'MSTR'
  8580         MOVE ER-0204            TO EMI-ERROR
  8581     ELSE
  8582         IF FILE-SWITCH = 'TRLR'
  8583             MOVE ER-0205        TO EMI-ERROR
  8584         ELSE
  8585             MOVE ER-0206        TO EMI-ERROR
  8586         END-IF
  8587     END-IF.
  8588
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 163
* EL130.cbl
  8589     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8590
  8591 1050-SEND-CHECK.
  8592
  8593     IF RETURNED-FROM NOT = SPACES
  8594         GO TO 8100-SEND-INITIAL-MAP
  8595     ELSE
  8596         MOVE -1                 TO MAINTL
  8597         GO TO 8200-SEND-DATAONLY
  8598     END-IF.
  8599
  8600 2000-DELETE-CLAIM.
  8601     IF NOT MODIFY-CAP
  8602         MOVE ER-0070            TO EMI-ERROR
  8603         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8604         MOVE -1                 TO MAINTL
  8605         GO TO 8200-SEND-DATAONLY
  8606     END-IF.
  8607
  8608     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8609        CLMCARRI NOT = PI-LAST-CARR        OR
  8610        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8611        SUFXI    NOT = PI-LAST-CERT-SUFX
  8612         MOVE ER-0207            TO EMI-ERROR
  8613         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8614         MOVE -1                 TO MAINTL
  8615         GO TO 8200-SEND-DATAONLY
  8616     END-IF.
  8617
  8618
  8619
  8620* EXEC CICS HANDLE CONDITION
  8621*        NOTFND   (2050-DELETE-NOT-FOUND)
  8622*    END-EXEC.
  8623*    MOVE '"$I                   ! * #00008360' TO DFHEIV0
  8624     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8626     MOVE X'2A20233030303038333630' TO DFHEIV0(25:11)
  8627     CALL 'kxdfhei1' USING DFHEIV0
  8628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8629
  8630
  8631     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8632
  8633     MOVE CLMCARRI               TO MSTR-CARRIER.
  8634     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8635     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8636     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8637
  8638     MOVE 'MSTR'                 TO FILE-SWITCH.
  8639     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8640
  8641     MOVE 'Y'                    TO CLAIM-SWITCH.
  8642
  8643     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8644        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8645         MOVE ER-0068        TO EMI-ERROR
  8646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 164
* EL130.cbl
  8647         MOVE -1             TO MAINTL
  8648         GO TO 8200-SEND-DATAONLY
  8649     END-IF.
  8650
  8651     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8652         MOVE ER-0569            TO EMI-ERROR
  8653         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8654         MOVE -1                 TO MAINTL
  8655         GO TO 8200-SEND-DATAONLY
  8656     END-IF.
  8657
  8658     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8659         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8660     END-IF.
  8661
  8662     IF CL-PURGED-DT NOT = LOW-VALUES
  8663         MOVE ER-7691            TO EMI-ERROR
  8664         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8665         MOVE -1                 TO MAINTL
  8666         GO TO 8200-SEND-DATAONLY
  8667     END-IF.
  8668
  8669     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8670     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8671     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8672     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8673     MOVE +0                     TO TRLR-SEQ-NO.
  8674     MOVE '1'                    TO TRLR-TYPE.
  8675
  8676     MOVE 'TRLR'                 TO FILE-SWITCH.
  8677
  8678
  8679
  8680* EXEC CICS READ
  8681*        UPDATE
  8682*        DATASET  (ELTRLR-DSID)
  8683*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8684*        RIDFLD   (ELTRLR-KEY)
  8685*    END-EXEC.
  8686*    MOVE '&"S        EU         (   #00008412' TO DFHEIV0
  8687     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8688     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8689     MOVE X'2020233030303038343132' TO DFHEIV0(25:11)
  8690     CALL 'kxdfhei1' USING DFHEIV0,
  8691           ELTRLR-DSID,
  8692           DFHEIV20,
  8693           DFHEIV99,
  8694           ELTRLR-KEY,
  8695           DFHEIV99,
  8696           DFHEIV99,
  8697           DFHEIV99
  8698     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8699         DFHEIV20
  8700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8701
  8702
  8703     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8704        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 165
* EL130.cbl
  8705         MOVE ER-0068        TO EMI-ERROR
  8706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8707         MOVE -1             TO MAINTL
  8708         GO TO 8200-SEND-DATAONLY
  8709     END-IF.
  8710
  8711
  8712
  8713* EXEC CICS DELETE
  8714*        DATASET   (ELTRLR-DSID)
  8715*    END-EXEC.
  8716*    MOVE '&(                    &   #00008428' TO DFHEIV0
  8717     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8718     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8719     MOVE X'2020233030303038343238' TO DFHEIV0(25:11)
  8720     CALL 'kxdfhei1' USING DFHEIV0,
  8721           ELTRLR-DSID,
  8722           DFHEIV99,
  8723           DFHEIV99,
  8724           DFHEIV99,
  8725           DFHEIV99
  8726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8727
  8728
  8729     MOVE +90                    TO TRLR-SEQ-NO.
  8730     MOVE '6'                    TO TRLR-TYPE.
  8731
  8732
  8733
  8734* EXEC CICS READ
  8735*        UPDATE
  8736*        DATASET  (ELTRLR-DSID)
  8737*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8738*        RIDFLD   (ELTRLR-KEY)
  8739*    END-EXEC.
  8740*    MOVE '&"S        EU         (   #00008436' TO DFHEIV0
  8741     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8742     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8743     MOVE X'2020233030303038343336' TO DFHEIV0(25:11)
  8744     CALL 'kxdfhei1' USING DFHEIV0,
  8745           ELTRLR-DSID,
  8746           DFHEIV20,
  8747           DFHEIV99,
  8748           ELTRLR-KEY,
  8749           DFHEIV99,
  8750           DFHEIV99,
  8751           DFHEIV99
  8752     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8753         DFHEIV20
  8754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8755
  8756
  8757
  8758
  8759* EXEC CICS DELETE
  8760*        DATASET   (ELTRLR-DSID)
  8761*    END-EXEC.
  8762*    MOVE '&(                    &   #00008444' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 166
* EL130.cbl
  8763     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8764     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8765     MOVE X'2020233030303038343434' TO DFHEIV0(25:11)
  8766     CALL 'kxdfhei1' USING DFHEIV0,
  8767           ELTRLR-DSID,
  8768           DFHEIV99,
  8769           DFHEIV99,
  8770           DFHEIV99,
  8771           DFHEIV99
  8772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8773
  8774
  8775     MOVE +91                    TO TRLR-SEQ-NO.
  8776     MOVE '6'                    TO TRLR-TYPE.
  8777
  8778
  8779
  8780* EXEC CICS READ
  8781*        UPDATE
  8782*        DATASET  (ELTRLR-DSID)
  8783*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8784*        RIDFLD   (ELTRLR-KEY)
  8785*        RESP     (WS-RESPONSE)
  8786*    END-EXEC
  8787*    MOVE '&"S        EU         (  N#00008452' TO DFHEIV0
  8788     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8789     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8790     MOVE X'204E233030303038343532' TO DFHEIV0(25:11)
  8791     CALL 'kxdfhei1' USING DFHEIV0,
  8792           ELTRLR-DSID,
  8793           DFHEIV20,
  8794           DFHEIV99,
  8795           ELTRLR-KEY,
  8796           DFHEIV99,
  8797           DFHEIV99,
  8798           DFHEIV99
  8799     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8800         DFHEIV20
  8801     MOVE EIBRESP  TO WS-RESPONSE
  8802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8803
  8804     IF WS-RESP-NORMAL
  8805
  8806* EXEC CICS DELETE
  8807*          DATASET   (ELTRLR-DSID)
  8808*       END-EXEC
  8809*    MOVE '&(                    &   #00008461' TO DFHEIV0
  8810     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8811     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8812     MOVE X'2020233030303038343631' TO DFHEIV0(25:11)
  8813     CALL 'kxdfhei1' USING DFHEIV0,
  8814           ELTRLR-DSID,
  8815           DFHEIV99,
  8816           DFHEIV99,
  8817           DFHEIV99,
  8818           DFHEIV99
  8819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8820     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 167
* EL130.cbl
  8821
  8822     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8823     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8824     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8825     MOVE CL-CERT-STATE          TO CERT-STATE.
  8826     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8827     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8828     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8829
  8830     MOVE 'CERT'                 TO FILE-SWITCH.
  8831
  8832     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8833
  8834     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8835
  8836     IF WS-NUM-HOLD NOT = +0
  8837         GO TO 2005-REWRITE-CERT
  8838     END-IF.
  8839
  8840     IF NOT CERT-WAS-CREATED
  8841         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8842         GO TO 2005-REWRITE-CERT
  8843     END-IF.
  8844
  8845
  8846
  8847* EXEC CICS DELETE
  8848*        DATASET   (ELCERT-DSID)
  8849*    END-EXEC.
  8850*    MOVE '&(                    &   #00008490' TO DFHEIV0
  8851     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8852     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8853     MOVE X'2020233030303038343930' TO DFHEIV0(25:11)
  8854     CALL 'kxdfhei1' USING DFHEIV0,
  8855           ELCERT-DSID,
  8856           DFHEIV99,
  8857           DFHEIV99,
  8858           DFHEIV99,
  8859           DFHEIV99
  8860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8861
  8862
  8863     GO TO 2010-DELETE-CL.
  8864
  8865 2005-REWRITE-CERT.
  8866
  8867     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8868
  8869
  8870
  8871* EXEC CICS HANDLE CONDITION
  8872*         DUPKEY   (2010-DELETE-CL)
  8873*    END-EXEC.
  8874*    MOVE '"$$                   ! + #00008501' TO DFHEIV0
  8875     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8876     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8877     MOVE X'2B20233030303038353031' TO DFHEIV0(25:11)
  8878     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 168
* EL130.cbl
  8879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8880
  8881
  8882
  8883
  8884* EXEC CICS REWRITE
  8885*        DATASET  (ELCERT-DSID)
  8886*        FROM     (CERTIFICATE-MASTER)
  8887*    END-EXEC.
  8888     MOVE LENGTH OF
  8889      CERTIFICATE-MASTER
  8890       TO DFHEIV11
  8891*    MOVE '&& L                  %   #00008506' TO DFHEIV0
  8892     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8893     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8894     MOVE X'2020233030303038353036' TO DFHEIV0(25:11)
  8895     CALL 'kxdfhei1' USING DFHEIV0,
  8896           ELCERT-DSID,
  8897           CERTIFICATE-MASTER,
  8898           DFHEIV11,
  8899           DFHEIV99
  8900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8901
  8902
  8903 2010-DELETE-CL.
  8904
  8905
  8906
  8907* EXEC CICS DELETE
  8908*        DATASET  (ELMSTR-DSID)
  8909*    END-EXEC.
  8910*    MOVE '&(                    &   #00008514' TO DFHEIV0
  8911     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8912     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8913     MOVE X'2020233030303038353134' TO DFHEIV0(25:11)
  8914     CALL 'kxdfhei1' USING DFHEIV0,
  8915           ELMSTR-DSID,
  8916           DFHEIV99,
  8917           DFHEIV99,
  8918           DFHEIV99,
  8919           DFHEIV99
  8920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8921
  8922
  8923     MOVE -1                     TO ONE-OR-MIN1.
  8924     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8925
  8926     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8927         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8928                                    WS-SAVE-CLAIM-KEY
  8929         MOVE +1                 TO ONE-OR-MIN1
  8930         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8931     END-IF.
  8932
  8933     MOVE ER-0000                TO EMI-ERROR.
  8934     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8935     MOVE LOW-VALUES             TO EL130AO.
  8936     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 169
* EL130.cbl
  8937     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8938     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8939                                    PI-CERT-PROCESSED
  8940                                    PI-LETTER-ERROR-CODE.
  8941     GO TO 8100-SEND-INITIAL-MAP.
  8942
  8943 2050-DELETE-NOT-FOUND.
  8944     IF FILE-SWITCH = 'MSTR'
  8945         MOVE -1                 TO CLMNOL
  8946         MOVE ER-0204            TO EMI-ERROR
  8947     ELSE
  8948         IF FILE-SWITCH = 'TRLR'
  8949             MOVE -1             TO MAINTL
  8950             MOVE ER-0205        TO EMI-ERROR
  8951         ELSE
  8952             MOVE -1             TO CERTNOL
  8953             MOVE ER-0206        TO EMI-ERROR
  8954         END-IF
  8955     END-IF.
  8956
  8957     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8958     GO TO 8200-SEND-DATAONLY.
  8959
  8960 3000-ADD-CLAIM.
  8961     IF NOT MODIFY-CAP
  8962         MOVE ER-0070            TO EMI-ERROR
  8963         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8964         MOVE -1                 TO MAINTL
  8965         GO TO 8200-SEND-DATAONLY
  8966     END-IF.
  8967
  8968     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8969
  8970     IF CERTMTI = 'S'
  8971         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8972            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8973            WS-EFFDT = PI-SAVE-EFFDT       AND
  8974            ACCOUNTI = PI-SAVE-ACCOUNT
  8975             IF EMI-ERROR = 0
  8976                 GO TO 3010-TEST-FOR-ERRORS
  8977             ELSE
  8978                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8979                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8980                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8981                 MOVE PI-STATE         TO  CERT-STATE
  8982                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8983                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8984                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8985
  8986
  8987* EXEC CICS HANDLE CONDITION
  8988*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8989*                END-EXEC
  8990*    MOVE '"$I                   ! , #00008581' TO DFHEIV0
  8991     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8992     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8993     MOVE X'2C20233030303038353831' TO DFHEIV0(25:11)
  8994     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 170
* EL130.cbl
  8995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8996                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  8997                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8998                 GO TO 3010-TEST-FOR-ERRORS
  8999             END-IF
  9000         END-IF
  9001     END-IF.
  9002
  9003     IF CERTMTI = 'A'
  9004         IF NOT PI-NO-CARRIER-SECURITY OR
  9005             NOT PI-NO-ACCOUNT-SECURITY
  9006             MOVE ER-2370          TO EMI-ERROR
  9007             MOVE -1               TO MAINTL
  9008             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9009             GO TO 8200-SEND-DATAONLY
  9010         ELSE
  9011             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  9012             GO TO 3010-TEST-FOR-ERRORS
  9013         END-IF
  9014     END-IF.
  9015
  9016     IF CERTNOL = ZEROS
  9017        GO TO 3010-TEST-FOR-ERRORS
  9018     END-IF.
  9019
  9020 3000-READ-CERT.
  9021
  9022     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  9023                                    MSTR5-COMP-CD.
  9024     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  9025                                    MSTR5-CERT-NO-PRIME.
  9026     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  9027                                    MSTR5-CERT-NO-SUFX.
  9028
  9029
  9030
  9031* EXEC CICS HANDLE CONDITION
  9032*         DUPKEY   (3008-DUP-ERROR)
  9033*         NOTFND   (3009-NOT-FOUND)
  9034*    END-EXEC
  9035*    MOVE '"$$I                  ! - #00008618' TO DFHEIV0
  9036     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  9037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9038     MOVE X'2D20233030303038363138' TO DFHEIV0(25:11)
  9039     CALL 'kxdfhei1' USING DFHEIV0
  9040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9041
  9042     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  9043
  9044     IF NOT PI-NO-ACCOUNT-SECURITY
  9045         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  9046             MOVE ER-2371          TO EMI-ERROR
  9047             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9048             MOVE -1               TO MAINTL
  9049             GO TO 8200-SEND-DATAONLY
  9050         END-IF
  9051     END-IF.
  9052
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 171
* EL130.cbl
  9053     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  9054     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  9055     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  9056     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  9057     MOVE CM-CARRIER             TO PI-CARRIER.
  9058     MOVE CM-GROUPING            TO PI-GROUPING.
  9059     MOVE CM-STATE               TO PI-STATE.
  9060     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  9061     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  9062     MOVE CM-CERT-NO             TO PI-CERT-NO.
  9063     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  9064
  9065     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  9066         IF LSTNMEO = SPACES OR LOW-VALUES
  9067             MOVE CRTLNMEI       TO  LSTNMEO
  9068             MOVE AL-UANON       TO  LSTNMEA
  9069         END-IF
  9070     END-IF.
  9071
  9072     MOVE 'S'                    TO CERTMTO.
  9073*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  9074     MOVE AL-SANON               TO CERTNOA.
  9075     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  9076                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  9077     IF EMI-NO-ERRORS
  9078         MOVE -1                  TO MAINTL
  9079     END-IF.
  9080
  9081     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9082         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9083         IF INCURRED-DATE-MATCH
  9084             MOVE ER-7352         TO EMI-ERROR
  9085             MOVE -1              TO CERTNOL
  9086             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9087         ELSE
  9088             IF NO-CLAIMS-FOR-CERT
  9089                 MOVE ER-7353     TO EMI-ERROR
  9090                 MOVE -1          TO CERTNOL
  9091                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9092             ELSE
  9093                 MOVE ER-0558     TO EMI-ERROR
  9094                 MOVE -1          TO CERTNOL
  9095                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9096                 GO TO 3010-TEST-FOR-ERRORS
  9097             END-IF
  9098         END-IF
  9099     END-IF.
  9100
  9101 3007-SEND-SCREEN.
  9102     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9103         GO TO 8150-SEND-MAP-CURSOR
  9104     ELSE
  9105         GO TO 8200-SEND-DATAONLY
  9106     END-IF.
  9107
  9108 3008-DUP-ERROR.
  9109     MOVE ER-0560                TO EMI-ERROR.
  9110     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 172
* EL130.cbl
  9111     MOVE -1                     TO CERTNOL.
  9112     GO TO 3007-SEND-SCREEN.
  9113
  9114 3009-NOT-FOUND.
  9115     MOVE ER-0214                TO EMI-ERROR.
  9116     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9117     MOVE -1                     TO CERTNOL.
  9118     GO TO 3007-SEND-SCREEN.
  9119
  9120 3010-TEST-FOR-ERRORS.
  9121
  9122     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  9123     perform 6500-get-acct    thru 6500-exit
  9124     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  9125*     perform 6500-get-acct    thru 6500-exit
  9126
  9127     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  9128     move +0                     to e1
  9129     move spaces                 to ws-dcc-error-line
  9130     move ' '                    to ws-zero-bens-avail
  9131
  9132     if ws-dcc-product-code not = spaces
  9133        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  9134        IF ERPDEF-FOUND
  9135           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9136           MOVE WS-INCUR         TO DC-BIN-DATE-2
  9137           MOVE '1'              TO DC-OPTION-CODE
  9138           MOVE +0               TO DC-ELAPSED-MONTHS
  9139                                    DC-ELAPSED-DAYS
  9140           PERFORM 9700-LINK-DATE-CONVERT
  9141                                 THRU 9700-EXIT
  9142           IF NO-CONVERSION-ERROR
  9143              MOVE DC-ELAPSED-MONTHS
  9144                                 TO WS-MONTHS-BETWEEN
  9145              IF DC-ELAPSED-DAYS > 1
  9146                 ADD 1 TO WS-MONTHS-BETWEEN
  9147              END-IF
  9148           ELSE
  9149              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9150           END-IF
  9151
  9152           evaluate true
  9153              when (ws-excl-period not = zeros)
  9154                 and (ws-months-between <= ws-excl-period)
  9155                 MOVE -1         TO MAINTL
  9156                 add +1          to e1
  9157                 move 'Y'        to ws-zero-bens-avail
  9158                 MOVE ER-1651    TO EMI-ERROR
  9159                                    ws-error-no (e1)
  9160                 PERFORM 9900-ERROR-FORMAT
  9161                                 THRU 9900-EXIT
  9162              when (ws-cov-ends not = zeros)
  9163                 and (ws-months-between > ws-cov-ends)
  9164                 MOVE -1         TO MAINTL
  9165                 add +1          to e1
  9166                 move 'Y'        to ws-zero-bens-avail
  9167                 MOVE ER-1653    TO EMI-ERROR
  9168                                    ws-error-no (e1)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 173
* EL130.cbl
  9169                 evaluate true
  9170                    when clmtypei = 'L'
  9171                       move '  LF  ' to emi-claim-type
  9172                    when clmtypei = 'I'
  9173                       move '  IU  ' to emi-claim-type
  9174                    when clmtypei = 'F'
  9175                       move '  FL  ' to emi-claim-type
  9176                    when other
  9177                       move '  AH  ' to emi-claim-type
  9178                 end-evaluate
  9179                 PERFORM 9900-ERROR-FORMAT
  9180                                 THRU 9900-EXIT
  9181              when (ws-acc-period not = zeros)
  9182                 and (ws-months-between <= ws-acc-period)
  9183                 MOVE -1         TO MAINTL
  9184                 add +1          to e1
  9185                 MOVE ER-1652    TO EMI-ERROR
  9186                                    ws-error-no (e1)
  9187                 PERFORM 9900-ERROR-FORMAT
  9188                                 THRU 9900-EXIT
  9189                 add +1          to e1
  9190                 move er-1655    to emi-error
  9191                                    ws-error-no (e1)
  9192                 PERFORM 9900-ERROR-FORMAT
  9193                                 THRU 9900-EXIT
  9194              when clmtypei = 'I'
  9195                 add +1          to e1
  9196                 move er-1661    to emi-error
  9197                                    ws-error-no (e1)
  9198                 PERFORM 9900-ERROR-FORMAT
  9199                                 THRU 9900-EXIT
  9200           end-evaluate
  9201           IF (WS-PRE-EXISTING-PER NOT = ZEROS)
  9202              AND (WS-MONTHS-BETWEEN <= WS-PRE-EXISTING-PER)
  9203              MOVE -1         TO MAINTL
  9204              ADD +1          TO E1
  9205              MOVE ER-1677    TO EMI-ERROR
  9206                                 WS-ERROR-NO (E1)
  9207              PERFORM 9900-ERROR-FORMAT
  9208                              THRU 9900-EXIT
  9209           END-IF
  9210        END-IF
  9211*       perform 3996-read-cert-claim-trailer
  9212*                                thru 3996-exit
  9213     END-IF
  9214     perform 3996-read-cert-claim-trailer
  9215                                 thru 3996-exit
  9216     IF CERTMTI NOT = 'A'
  9217         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9218             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9219             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9220             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9221             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9222             IF INCURRED-DATE-MATCH
  9223                 MOVE ER-7352         TO EMI-ERROR
  9224                 MOVE -1              TO CERTNOL
  9225                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9226             ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 174
* EL130.cbl
  9227                 IF NO-CLAIMS-FOR-CERT
  9228                     MOVE ER-7353     TO EMI-ERROR
  9229                     MOVE -1          TO CERTNOL
  9230                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9231                 ELSE
  9232                     MOVE ER-0558     TO EMI-ERROR
  9233                     MOVE -1          TO CERTNOL
  9234                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9235                 END-IF
  9236             END-IF
  9237         END-IF
  9238     END-IF.
  9239
  9240     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9241         MOVE ER-0433             TO EMI-ERROR
  9242         MOVE -1                  TO MAINTL
  9243         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9244         GO TO 8200-SEND-DATAONLY
  9245     END-IF.
  9246
  9247     IF (EMI-NO-ERRORS)
  9248        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9249         GO TO 3015-TRY-TO-BUILD
  9250     END-IF.
  9251
  9252     IF EIBAID = DFHPF6
  9253         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9254             MOVE ER-0434         TO EMI-ERROR
  9255             MOVE -1              TO MAINTL
  9256             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9257             GO TO 8200-SEND-DATAONLY
  9258         ELSE
  9259             MOVE +1              TO INCURL
  9260             GO TO 3015-TRY-TO-BUILD
  9261         END-IF
  9262     END-IF.
  9263
  9264     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9265         GO TO 8150-SEND-MAP-CURSOR
  9266     ELSE
  9267         GO TO 8200-SEND-DATAONLY
  9268     END-IF.
  9269
  9270 3015-TRY-TO-BUILD.
  9271     IF CLMNOL EQUAL ZERO
  9272         GO TO 3030-BUILD-CONT
  9273     END-IF.
  9274
  9275
  9276
  9277* EXEC CICS HANDLE CONDITION
  9278*        NOTFND   (3030-BUILD-CONT)
  9279*    END-EXEC.
  9280*    MOVE '"$I                   ! . #00008857' TO DFHEIV0
  9281     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9283     MOVE X'2E20233030303038383537' TO DFHEIV0(25:11)
  9284     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 175
* EL130.cbl
  9285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9286
  9287
  9288     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9289
  9290     MOVE CLMCARRI               TO MSTR-CARRIER.
  9291     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9292     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9293     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9294
  9295     MOVE 'MSTR'                 TO FILE-SWITCH.
  9296
  9297     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9298
  9299     MOVE ER-0221                TO EMI-ERROR.
  9300
  9301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9302     MOVE -1                     TO MAINTL.
  9303     GO TO 8200-SEND-DATAONLY.
  9304
  9305 3030-BUILD-CONT.
  9306     IF (CERTMTI NOT = 'A')
  9307        and (pi-company-id not = 'DCC' and 'VPP')
  9308         GO TO 3060-BUILD-CONT
  9309     END-IF.
  9310
  9311
  9312
  9313* EXEC CICS HANDLE CONDITION
  9314*        NOTFND   (3033-ACCT-NOT-FOUND)
  9315*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9316*    END-EXEC.
  9317*    MOVE '"$I''                  ! / #00008885' TO DFHEIV0
  9318     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9319     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9320     MOVE X'2F20233030303038383835' TO DFHEIV0(25:11)
  9321     CALL 'kxdfhei1' USING DFHEIV0
  9322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9323
  9324
  9325     MOVE SPACES                 TO ERACCT-KEY.
  9326
  9327     IF CARR-GROUP-ST-ACCNT-CNTL
  9328         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9329         MOVE CRTCARRI           TO ACCT-CARRIER
  9330         MOVE GROUPI             TO ACCT-GROUPING
  9331         MOVE STATEI             TO ACCT-STATE
  9332         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9333         GO TO 3031-MOVE-ACCT-KEY
  9334     END-IF.
  9335
  9336     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9337     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9338
  9339     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9340         MOVE STATEI             TO ACCT-STATE
  9341     END-IF.
  9342
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 176
* EL130.cbl
  9343     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9344         MOVE CRTCARRI           TO ACCT-CARRIER
  9345     END-IF.
  9346
  9347 3031-MOVE-ACCT-KEY.
  9348     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9349
  9350
  9351
  9352* EXEC CICS STARTBR
  9353*        DATASET     (ERACCT2-DSID)
  9354*        RIDFLD      (SAVE-ERACCT-KEY)
  9355*        GENERIC
  9356*        KEYLENGTH   (20)
  9357*    END-EXEC.
  9358     MOVE 20
  9359       TO DFHEIV11
  9360     MOVE 0
  9361       TO DFHEIV12
  9362*    MOVE '&,   KG    G          &   #00008916' TO DFHEIV0
  9363     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9364     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9365     MOVE X'2020233030303038393136' TO DFHEIV0(25:11)
  9366     CALL 'kxdfhei1' USING DFHEIV0,
  9367           ERACCT2-DSID,
  9368           SAVE-ERACCT-KEY,
  9369           DFHEIV11,
  9370           DFHEIV12,
  9371           DFHEIV99
  9372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9373
  9374
  9375
  9376
  9377* EXEC CICS HANDLE CONDITION
  9378*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9379*    END-EXEC.
  9380*    MOVE '"$''                   ! 0 #00008924' TO DFHEIV0
  9381     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9383     MOVE X'3020233030303038393234' TO DFHEIV0(25:11)
  9384     CALL 'kxdfhei1' USING DFHEIV0
  9385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9386
  9387
  9388 3031-READ-ACCT-LOOP.
  9389
  9390
  9391* EXEC CICS READNEXT
  9392*        DATASET   (ERACCT2-DSID)
  9393*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9394*        RIDFLD    (SAVE-ERACCT-KEY)
  9395*    END-EXEC.
  9396     MOVE 0
  9397       TO DFHEIV11
  9398*    MOVE '&.S                   )   #00008930' TO DFHEIV0
  9399     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9400     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 177
* EL130.cbl
  9401     MOVE X'2020233030303038393330' TO DFHEIV0(25:11)
  9402     CALL 'kxdfhei1' USING DFHEIV0,
  9403           ERACCT2-DSID,
  9404           DFHEIV20,
  9405           DFHEIV99,
  9406           SAVE-ERACCT-KEY,
  9407           DFHEIV99,
  9408           DFHEIV11,
  9409           DFHEIV99,
  9410           DFHEIV99
  9411     SET ADDRESS OF ACCOUNT-MASTER TO
  9412         DFHEIV20
  9413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9414
  9415
  9416     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9417        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9418        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9419        ACCT-STATE    NOT = AM-VG-STATE       OR
  9420        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9421         GO TO 3033-ACCT-NOT-FOUND
  9422     END-IF.
  9423
  9424     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9425        WS-EFFDT LESS AM-EXPIRATION-DT
  9426         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9427         MOVE AM-CARRIER       TO CERT-CARRIER
  9428         MOVE AM-GROUPING      TO CERT-GROUPING
  9429         MOVE AM-STATE         TO CERT-STATE
  9430         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9431         MOVE WS-EFFDT         TO CERT-EFF-DT
  9432         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9433         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9434         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9435         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9436     END-IF.
  9437
  9438     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9439         GO TO 3031-READ-ACCT-LOOP
  9440     END-IF.
  9441
  9442 3032-NOT-IN-DT-RANGE.
  9443     MOVE ER-0226                TO EMI-ERROR.
  9444     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9445     MOVE -1                     TO EFFDTL.
  9446     GO TO 8200-SEND-DATAONLY.
  9447
  9448 3033-ACCT-NOT-FOUND.
  9449     MOVE ER-0226 TO EMI-ERROR.
  9450     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9451     MOVE -1                     TO ACCOUNTL.
  9452     GO TO 8200-SEND-DATAONLY.
  9453
  9454 3034-CHECK-EMPLOYER-STATEMENT.
  9455
  9456     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9457*        NEXT SENTENCE
  9458         CONTINUE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 178
* EL130.cbl
  9459     ELSE
  9460         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9461     END-IF.
  9462
  9463     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9464     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9465     MOVE '1'                    TO  DC-OPTION-CODE.
  9466     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9467                                     DC-ELAPSED-DAYS.
  9468     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9469
  9470     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9471         DC-ELAPSED-DAYS LESS THAN +31)
  9472                      OR
  9473        (AM-EMPLOYER-STMT-USED = '2' AND
  9474         DC-ELAPSED-DAYS LESS THAN +61)
  9475                      OR
  9476        (AM-EMPLOYER-STMT-USED = '3' AND
  9477         DC-ELAPSED-DAYS LESS THAN +91)
  9478            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9479     END-IF.
  9480
  9481 3034-CHECK-ACCOUNT-LIMITS.
  9482
  9483     IF CERTMTI NOT = 'A'
  9484         GO TO 3060-BUILD-CONT
  9485     END-IF.
  9486
  9487     IF AM-STATUS NOT = '0'
  9488         MOVE ER-0225                TO EMI-ERROR
  9489         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9490         MOVE -1                     TO ACCOUNTL
  9491     END-IF.
  9492
  9493     IF EIBAID = DFHPF6
  9494         IF EMI-FATAL-CTR NOT = ZERO
  9495             MOVE ER-0434         TO EMI-ERROR
  9496             MOVE -1              TO MAINTL
  9497             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9498             GO TO 8200-SEND-DATAONLY
  9499         END-IF
  9500     END-IF.
  9501
  9502*    IF PI-COMPANY-ID NOT = 'CRI'
  9503*        GO TO 3035-END-BROWSE
  9504*    END-IF.
  9505
  9506 3035-END-BROWSE.
  9507
  9508
  9509* EXEC CICS ENDBR
  9510*        DATASET    (ERACCT2-DSID)
  9511*    END-EXEC.
  9512     MOVE 0
  9513       TO DFHEIV11
  9514*    MOVE '&2                    $   #00009028' TO DFHEIV0
  9515     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9516     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 179
* EL130.cbl
  9517     MOVE X'2020233030303039303238' TO DFHEIV0(25:11)
  9518     CALL 'kxdfhei1' USING DFHEIV0,
  9519           ERACCT2-DSID,
  9520           DFHEIV11,
  9521           DFHEIV99
  9522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9523
  9524
  9525 3040-CHECK-CERT-ALREADY-ON.
  9526
  9527
  9528* EXEC CICS HANDLE CONDITION
  9529*        NOTFND   (3070-BUILD-CONT)
  9530*    END-EXEC.
  9531*    MOVE '"$I                   ! 1 #00009034' TO DFHEIV0
  9532     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9534     MOVE X'3120233030303039303334' TO DFHEIV0(25:11)
  9535     CALL 'kxdfhei1' USING DFHEIV0
  9536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9537
  9538
  9539     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9540
  9541     MOVE ER-0229                TO EMI-ERROR.
  9542     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9543     MOVE -1                     TO MAINTL.
  9544     GO TO 8200-SEND-DATAONLY.
  9545
  9546 3060-BUILD-CONT.
  9547     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9548     MOVE CRTCARRI               TO CERT-CARRIER.
  9549     MOVE GROUPI                 TO CERT-GROUPING.
  9550     MOVE STATEI                 TO CERT-STATE.
  9551     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9552     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9553     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9554     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9555
  9556
  9557
  9558* EXEC CICS HANDLE CONDITION
  9559*        NOTFND  (3065-CERT-NOT-FOUND)
  9560*    END-EXEC.
  9561*    MOVE '"$I                   ! 2 #00009056' TO DFHEIV0
  9562     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9564     MOVE X'3220233030303039303536' TO DFHEIV0(25:11)
  9565     CALL 'kxdfhei1' USING DFHEIV0
  9566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9567
  9568
  9569     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9570
  9571     GO TO 3070-BUILD-CONT.
  9572
  9573 3065-CERT-NOT-FOUND.
  9574     MOVE ER-0244                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 180
* EL130.cbl
  9575     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9576     MOVE -1                     TO CERTNOL.
  9577     GO TO 8200-SEND-DATAONLY.
  9578
  9579 3070-BUILD-CONT.
  9580     IF CLMNOL NOT = ZERO
  9581         GO TO 3200-BUILD-ZERO-TRAILER
  9582     END-IF.
  9583
  9584     MOVE SPACES                 TO ELCNTL-KEY.
  9585
  9586     IF CONTROL-IS-ACTUAL-CARRIER
  9587         MOVE PI-CARRIER         TO CNTL-CARRIER
  9588     ELSE
  9589         MOVE PI-CARRIER-CONTROL-LEVEL
  9590                                 TO CNTL-CARRIER
  9591     END-IF.
  9592
  9593     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9594     MOVE '6'                    TO CNTL-REC-TYPE.
  9595     MOVE +0                     TO CNTL-SEQ-NO.
  9596
  9597
  9598
  9599* EXEC CICS HANDLE CONDITION
  9600*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9601*    END-EXEC.
  9602*    MOVE '"$I                   ! 3 #00009089' TO DFHEIV0
  9603     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9605     MOVE X'3320233030303039303839' TO DFHEIV0(25:11)
  9606     CALL 'kxdfhei1' USING DFHEIV0
  9607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9608
  9609
  9610
  9611
  9612* EXEC CICS READ
  9613*        UPDATE
  9614*        DATASET   (ELCNTL-DSID)
  9615*        SET       (ADDRESS OF CONTROL-FILE)
  9616*        RIDFLD    (ELCNTL-KEY)
  9617*    END-EXEC.
  9618*    MOVE '&"S        EU         (   #00009094' TO DFHEIV0
  9619     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9620     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9621     MOVE X'2020233030303039303934' TO DFHEIV0(25:11)
  9622     CALL 'kxdfhei1' USING DFHEIV0,
  9623           ELCNTL-DSID,
  9624           DFHEIV20,
  9625           DFHEIV99,
  9626           ELCNTL-KEY,
  9627           DFHEIV99,
  9628           DFHEIV99,
  9629           DFHEIV99
  9630     SET ADDRESS OF CONTROL-FILE TO
  9631         DFHEIV20
  9632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 181
* EL130.cbl
  9633
  9634
  9635     IF CLAIM-NO-MANUAL
  9636         GO TO 3120-CLAIM-MUST-BE-INPUT
  9637     END-IF.
  9638
  9639     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9640     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9641
  9642     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' OR 'VPP'
  9643         CONTINUE
  9644     ELSE
  9645         GO TO 3080-ASSIGN-LOOP
  9646     END-IF.
  9647
  9648
  9649
  9650* EXEC CICS UNLOCK
  9651*        DATASET   (ELCNTL-DSID)
  9652*    END-EXEC.
  9653*    MOVE '&*                    #   #00009115' TO DFHEIV0
  9654     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9655     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9656     MOVE X'2020233030303039313135' TO DFHEIV0(25:11)
  9657     CALL 'kxdfhei1' USING DFHEIV0,
  9658           ELCNTL-DSID,
  9659           DFHEIV99
  9660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9661
  9662
  9663     MOVE '1'                    TO CNTL-REC-TYPE.
  9664     MOVE SPACES                 TO CNTL-ACCESS.
  9665
  9666     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9667
  9668
  9669
  9670* EXEC CICS HANDLE CONDITION
  9671*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9672*    END-EXEC.
  9673*    MOVE '"$I                   ! 4 #00009125' TO DFHEIV0
  9674     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9675     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9676     MOVE X'3420233030303039313235' TO DFHEIV0(25:11)
  9677     CALL 'kxdfhei1' USING DFHEIV0
  9678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9679
  9680
  9681     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9682
  9683     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9684
  9685 3080-ASSIGN-LOOP.
  9686     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9687        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9688         MOVE +0                 TO SAVE-COUNTER
  9689     END-IF.
  9690
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 182
* EL130.cbl
  9691     ADD +1 TO SAVE-COUNTER.
  9692
  9693     IF SAVE-METHOD  = '3'
  9694         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9695         GO TO 3090-SET-COMP
  9696     END-IF.
  9697
  9698     IF SAVE-METHOD  = '4'
  9699         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9700         MOVE CLMCARRI           TO WS-CN-PRF-A
  9701         GO TO 3090-SET-COMP
  9702     END-IF.
  9703
  9704     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9705     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9706     MOVE SAVE-DATE              TO CURR-DATE.
  9707
  9708     IF CURR-MM LESS '10'
  9709         MOVE CURR-M2             TO WS-CN-PRF-B
  9710     END-IF.
  9711
  9712     IF CURR-MM = '10'
  9713        MOVE 'A'                 TO WS-CN-PRF-B
  9714     END-IF.
  9715     IF CURR-MM = '11'
  9716        MOVE 'B'                 TO WS-CN-PRF-B
  9717     END-IF.
  9718     IF CURR-MM = '12'
  9719        MOVE 'C'                 TO WS-CN-PRF-B
  9720     END-IF.
  9721
  9722     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9723
  9724 3090-SET-COMP.
  9725
  9726     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9727     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9728                                    CLMNOO.
  9729     MOVE AL-UANON               TO CLMNOA.
  9730     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9731     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9732     MOVE CLMCARRI               TO MSTR-CARRIER.
  9733
  9734
  9735
  9736* EXEC CICS HANDLE CONDITION
  9737*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9738*    END-EXEC.
  9739*    MOVE '"$I                   ! 5 #00009183' TO DFHEIV0
  9740     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9742     MOVE X'3520233030303039313833' TO DFHEIV0(25:11)
  9743     CALL 'kxdfhei1' USING DFHEIV0
  9744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9745
  9746
  9747     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9748
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 183
* EL130.cbl
  9749     GO TO 3080-ASSIGN-LOOP.
  9750
  9751 3100-CARRIER-NOT-FOUND.
  9752     MOVE ER-0252                TO EMI-ERROR.
  9753     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9754     MOVE -1                     TO CLMCARRL.
  9755     GO TO 8200-SEND-DATAONLY.
  9756
  9757 3110-COMPANY-NOT-FOUND.
  9758     MOVE ER-0254                TO EMI-ERROR.
  9759     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9760     MOVE -1                     TO MAINTL.
  9761     GO TO 8200-SEND-DATAONLY.
  9762
  9763 3120-CLAIM-MUST-BE-INPUT.
  9764     MOVE ER-0264                TO EMI-ERROR.
  9765     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9766     MOVE -1                     TO CLMNOL.
  9767     GO TO 8200-SEND-DATAONLY.
  9768
  9769 3200-BUILD-ZERO-TRAILER.
  9770
  9771
  9772* EXEC CICS HANDLE CONDITION
  9773*        NOTFND
  9774*    END-EXEC.
  9775*    MOVE '"$                   ! 6 #00009211' TO DFHEIV0
  9776     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9777     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9778     MOVE X'3620233030303039323131' TO DFHEIV0(25:11)
  9779     CALL 'kxdfhei1' USING DFHEIV0
  9780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9781
  9782
  9783
  9784
  9785* EXEC CICS GETMAIN
  9786*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9787*        LENGTH  (ELTRLR-LENGTH)
  9788*    END-EXEC.
  9789*    MOVE '," L                  $   #00009216' TO DFHEIV0
  9790     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9791     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9792     MOVE X'2020233030303039323136' TO DFHEIV0(25:11)
  9793     CALL 'kxdfhei1' USING DFHEIV0,
  9794           DFHEIV20,
  9795           ELTRLR-LENGTH,
  9796           DFHEIV99
  9797     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9798         DFHEIV20
  9799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9800
  9801
  9802     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9803     MOVE 'AT'                   TO AT-RECORD-ID.
  9804
  9805     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9806     MOVE CLMCARRI               TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 184
* EL130.cbl
  9807     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9808     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9809     MOVE +0                     TO AT-SEQUENCE-NO.
  9810     MOVE '1'                    TO AT-TRAILER-TYPE.
  9811
  9812     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9813     MOVE '5'                    TO DC-OPTION-CODE.
  9814     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9815     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9816                                    AT-RESERVES-LAST-MAINT-DT.
  9817
  9818     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9819                                    AT-RESERVES-LAST-UPDATED-BY.
  9820
  9821     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9822
  9823     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9824
  9825     MOVE +0                     TO AT-FUTURE-RESERVE
  9826                                    AT-IBNR-RESERVE
  9827                                    AT-PAY-CURRENT-RESERVE
  9828                                    AT-INITIAL-MANUAL-RESERVE
  9829                                    AT-CURRENT-MANUAL-RESERVE
  9830                                    AT-ITD-LIFE-REFUNDS
  9831                                    AT-ITD-AH-REFUNDS
  9832                                    AT-ITD-ADDITIONAL-RESERVE.
  9833
  9834     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9835
  9836     IF MANRSVL NOT = ZERO
  9837         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9838                                    AT-CURRENT-MANUAL-RESERVE
  9839     END-IF.
  9840
  9841     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9842
  9843     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9844                                    AT-ITD-CHARGEABLE-EXPENSE.
  9845
  9846     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9847     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9848     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9849
  9850
  9851
  9852* EXEC CICS WRITE
  9853*        DATASET   (ELTRLR-DSID)
  9854*        FROM      (ACTIVITY-TRAILERS)
  9855*        RIDFLD    (AT-CONTROL-PRIMARY)
  9856*    END-EXEC.
  9857     MOVE LENGTH OF
  9858      ACTIVITY-TRAILERS
  9859       TO DFHEIV11
  9860*    MOVE '&$ L                  ''   #00009270' TO DFHEIV0
  9861     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9862     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9863     MOVE X'2020233030303039323730' TO DFHEIV0(25:11)
  9864     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 185
* EL130.cbl
  9865           ELTRLR-DSID,
  9866           ACTIVITY-TRAILERS,
  9867           DFHEIV11,
  9868           AT-CONTROL-PRIMARY,
  9869           DFHEIV99,
  9870           DFHEIV99
  9871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9872
  9873
  9874     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9875
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 186
* EL130.cbl
  9877
  9878 3250-BUILD-I1-ADDRESS-TRAILER.
  9879
  9880     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9881     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9882     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9883     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9884     MOVE GROUPI                 TO WS-MA-GROUPING.
  9885     MOVE STATEI                 TO WS-MA-STATE.
  9886     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9887     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9888     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9889     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9890
  9891
  9892* EXEC CICS HANDLE CONDITION
  9893*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9894*    END-EXEC.
  9895*    MOVE '"$I                   ! 7 #00009293' TO DFHEIV0
  9896     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9898     MOVE X'3720233030303039323933' TO DFHEIV0(25:11)
  9899     CALL 'kxdfhei1' USING DFHEIV0
  9900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9901
  9902
  9903
  9904* EXEC CICS READ
  9905*        EQUAL
  9906*        DATASET   (ERMAIL-DSID)
  9907*        SET       (ADDRESS OF MAILING-DATA)
  9908*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9909*    END-EXEC.
  9910*    MOVE '&"S        E          (   #00009297' TO DFHEIV0
  9911     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9912     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9913     MOVE X'2020233030303039323937' TO DFHEIV0(25:11)
  9914     CALL 'kxdfhei1' USING DFHEIV0,
  9915           ERMAIL-DSID,
  9916           DFHEIV20,
  9917           DFHEIV99,
  9918           WS-MA-CONTROL-PRIMARY,
  9919           DFHEIV99,
  9920           DFHEIV99,
  9921           DFHEIV99
  9922     SET ADDRESS OF MAILING-DATA TO
  9923         DFHEIV20
  9924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9925
  9926
  9927     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9928         GO TO 3290-NO-INSURED-ADDRESS
  9929     END-IF.
  9930
  9931     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9932     MOVE 'AT'                   TO AT-RECORD-ID.
  9933
  9934     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 187
* EL130.cbl
  9935     MOVE CLMCARRI               TO AT-CARRIER.
  9936     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9937     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9938     MOVE +1                     TO AT-SEQUENCE-NO.
  9939     MOVE '5'                    TO AT-TRAILER-TYPE.
  9940
  9941     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9942     IF MA-INSURED-MIDDLE-INIT > SPACES
  9943        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9944               ' ' DELIMITED BY SIZE
  9945               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9946               ' ' DELIMITED BY SIZE
  9947               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9948        INTO AT-MAIL-TO-NAME
  9949     ELSE
  9950        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9951               ' ' DELIMITED BY SIZE
  9952               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9953        INTO AT-MAIL-TO-NAME
  9954     END-IF.
  9955     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9956     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9957*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9958     MOVE MA-CITY                TO AT-CITY
  9959     MOVE MA-ADDR-STATE          TO AT-STATE
  9960     MOVE MA-ZIP                 TO AT-ZIP
  9961     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9962
  9963     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9964                                    AT-ADDRESS-LAST-MAINT-DT.
  9965
  9966     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9967                                    AT-ADDRESS-LAST-UPDATED-BY.
  9968
  9969     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9970
  9971
  9972* EXEC CICS WRITE
  9973*        DATASET   (ELTRLR-DSID)
  9974*        FROM      (ACTIVITY-TRAILERS)
  9975*        RIDFLD    (AT-CONTROL-PRIMARY)
  9976*    END-EXEC.
  9977     MOVE LENGTH OF
  9978      ACTIVITY-TRAILERS
  9979       TO DFHEIV11
  9980*    MOVE '&$ L                  ''   #00009348' TO DFHEIV0
  9981     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9982     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9983     MOVE X'2020233030303039333438' TO DFHEIV0(25:11)
  9984     CALL 'kxdfhei1' USING DFHEIV0,
  9985           ELTRLR-DSID,
  9986           ACTIVITY-TRAILERS,
  9987           DFHEIV11,
  9988           AT-CONTROL-PRIMARY,
  9989           DFHEIV99,
  9990           DFHEIV99
  9991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9992
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 188
* EL130.cbl
  9993
  9994     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9995     GO TO 3300-BUILD-NINETY-TRAILER.
  9996
  9997 3290-NO-INSURED-ADDRESS.
  9998      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9999
 10000 3300-BUILD-NINETY-TRAILER.
 10001
 10002     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10003     MOVE 'AT'                   TO AT-RECORD-ID.
 10004
 10005     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10006     MOVE CLMCARRI               TO AT-CARRIER.
 10007
 10008     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10009     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10010     MOVE +90                    TO AT-SEQUENCE-NO.
 10011     MOVE '6'                    TO AT-TRAILER-TYPE.
 10012
 10013     IF DIAGL NOT = ZERO
 10014         MOVE DIAGI              TO AT-INFO-LINE-1
 10015     END-IF.
 10016
 10017     IF ICD1L NOT = ZERO
 10018         MOVE ICD1I              TO AT-ICD-CODE-1
 10019     END-IF.
 10020
 10021     IF ICD2L NOT = ZERO
 10022         MOVE ICD2I              TO AT-ICD-CODE-2
 10023     END-IF.
 10024
 10025     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10026                                    AT-GEN-INFO-LAST-MAINT-DT.
 10027
 10028     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10029                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10030     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10031
 10032
 10033
 10034* EXEC CICS WRITE
 10035*        DATASET   (ELTRLR-DSID)
 10036*        FROM      (ACTIVITY-TRAILERS)
 10037*        RIDFLD    (AT-CONTROL-PRIMARY)
 10038*    END-EXEC.
 10039     MOVE LENGTH OF
 10040      ACTIVITY-TRAILERS
 10041       TO DFHEIV11
 10042*    MOVE '&$ L                  ''   #00009393' TO DFHEIV0
 10043     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10044     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10045     MOVE X'2020233030303039333933' TO DFHEIV0(25:11)
 10046     CALL 'kxdfhei1' USING DFHEIV0,
 10047           ELTRLR-DSID,
 10048           ACTIVITY-TRAILERS,
 10049           DFHEIV11,
 10050           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 189
* EL130.cbl
 10051           DFHEIV99,
 10052           DFHEIV99
 10053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10054
 10055
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 190
* EL130.cbl
 10057 3400-CHECK-CERT-MAINT.
 10058
 10059     IF CERTMTI = 'A'
 10060         GO TO 3600-BUILD-NEW-CERT
 10061     END-IF.
 10062
 10063     IF NO-CLAIM-ATTACHED
 10064         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
 10065     END-IF.
 10066
 10067     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
 10068
 10069     IF CM-LF-CURRENT-STATUS = '2' OR
 10070        CM-AH-CURRENT-STATUS = '2'
 10071         GO TO 3400-REWRITE-CERT
 10072     END-IF.
 10073
 10074     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10075
 10076 3400-REWRITE-CERT.
 10077
 10078
 10079
 10080* EXEC CICS HANDLE CONDITION
 10081*        DUPKEY (3410-DUP-KEY)
 10082*    END-EXEC.
 10083*    MOVE '"$$                   ! 8 #00009422' TO DFHEIV0
 10084     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10086     MOVE X'3820233030303039343232' TO DFHEIV0(25:11)
 10087     CALL 'kxdfhei1' USING DFHEIV0
 10088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10089
 10090
 10091
 10092
 10093* EXEC CICS REWRITE
 10094*        DATASET   (ELCERT-DSID)
 10095*        FROM      (CERTIFICATE-MASTER)
 10096*    END-EXEC.
 10097     MOVE LENGTH OF
 10098      CERTIFICATE-MASTER
 10099       TO DFHEIV11
 10100*    MOVE '&& L                  %   #00009427' TO DFHEIV0
 10101     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10102     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10103     MOVE X'2020233030303039343237' TO DFHEIV0(25:11)
 10104     CALL 'kxdfhei1' USING DFHEIV0,
 10105           ELCERT-DSID,
 10106           CERTIFICATE-MASTER,
 10107           DFHEIV11,
 10108           DFHEIV99
 10109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10110
 10111
 10112 3410-DUP-KEY.
 10113     GO TO 3800-BUILD-NEW-CLAIM.
 10114
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 191
* EL130.cbl
 10115 3600-BUILD-NEW-CERT.
 10116
 10117
 10118* EXEC CICS GETMAIN
 10119*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 10120*        LENGTH   (ELCERT-LENGTH)
 10121*    END-EXEC.
 10122*    MOVE '," L                  $   #00009437' TO DFHEIV0
 10123     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10124     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10125     MOVE X'2020233030303039343337' TO DFHEIV0(25:11)
 10126     CALL 'kxdfhei1' USING DFHEIV0,
 10127           DFHEIV20,
 10128           ELCERT-LENGTH,
 10129           DFHEIV99
 10130     SET ADDRESS OF CERTIFICATE-MASTER TO
 10131         DFHEIV20
 10132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10133
 10134
 10135     MOVE SPACES                 TO CERTIFICATE-MASTER.
 10136
 10137     MOVE 'CM'                   TO CM-RECORD-ID.
 10138
 10139     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
 10140                                    CM-COMPANY-CD-A1
 10141                                    CM-COMPANY-CD-A2
 10142                                    CM-COMPANY-CD-A4
 10143                                    CM-COMPANY-CD-A5.
 10144
 10145     MOVE CERT-CARRIER           TO CM-CARRIER.
 10146     MOVE CERT-GROUPING          TO CM-GROUPING.
 10147     MOVE CERT-STATE             TO CM-STATE.
 10148     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
 10149     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
 10150     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
 10151
 10152     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
 10153                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
 10154                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
 10155                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
 10156                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
 10157                       CM-LIVES              CM-LOAN-TERM
 10158                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
 10159                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10160                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10161                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10162                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10163                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10164                       CM-LF-ALT-PREMIUM-RATE
 10165                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10166                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10167                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10168                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10169                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10170
 10171     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10172                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 192
* EL130.cbl
 10173                                    CM-AH-SETTLEMENT-DT
 10174                                    CM-AH-CANCEL-EXIT-DT
 10175                                    CM-AH-SETTLEMENT-EXIT-DT
 10176                                    CM-LF-LOAN-EXPIRE-DT
 10177                                    CM-LF-CANCEL-DT
 10178                                    CM-LF-DEATH-DT
 10179                                    CM-LF-CANCEL-EXIT-DT
 10180                                    CM-LF-DEATH-EXIT-DT
 10181                                    CM-LAST-ADD-ON-DT
 10182                                    CM-ENTRY-DT.
 10183
 10184     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10185     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10186     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10187
 10188     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10189                                    CM-PART-LAST-NAME-A2
 10190                                    CM-PART-LAST-NAME-A5.
 10191
 10192     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10193                                    CM-INSURED-INITIAL1-A2
 10194                                    CM-INSURED-INITIAL1-A5
 10195                                    CM-INSURED-FIRST-NAME.
 10196
 10197     IF CRTINITL GREATER ZERO
 10198         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10199                                    CM-INSURED-INITIAL2-A2
 10200                                    CM-INSURED-INITIAL2-A5
 10201     ELSE
 10202         MOVE SPACES             TO CM-INSURED-INITIAL2
 10203                                    CM-INSURED-INITIAL2-A2
 10204                                    CM-INSURED-INITIAL2-A5
 10205     END-IF.
 10206
 10207     IF CM-INSURED-INITIALS = SPACES
 10208         MOVE '**'               TO CM-INSURED-INITIALS
 10209     END-IF.
 10210
 10211     IF MEMBERL GREATER ZERO
 10212         MOVE MEMBERI              TO CM-MEMBER-NO
 10213     ELSE
 10214         MOVE CERT-STATE           TO CM-MEMB-STATE
 10215         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10216         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10217         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10218     END-IF.
 10219
 10220     IF JNTLNMEL GREATER ZERO
 10221         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10222     END-IF.
 10223
 10224     IF JNTFNMEL GREATER ZERO
 10225         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10226     END-IF.
 10227
 10228     IF JNTINITL GREATER ZERO
 10229         MOVE JNTINITI           TO CM-JT-INITIAL
 10230     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 193
* EL130.cbl
 10231
 10232     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10233
 10234
 10235
 10236* EXEC CICS HANDLE CONDITION
 10237*        DUPKEY   (3690-CERT-WRITTEN)
 10238*    END-EXEC.
 10239*    MOVE '"$$                   ! 9 #00009542' TO DFHEIV0
 10240     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10242     MOVE X'3920233030303039353432' TO DFHEIV0(25:11)
 10243     CALL 'kxdfhei1' USING DFHEIV0
 10244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10245
 10246
 10247
 10248
 10249* EXEC CICS WRITE
 10250*        DATASET   (ELCERT-DSID)
 10251*        FROM      (CERTIFICATE-MASTER)
 10252*        RIDFLD    (CM-CONTROL-PRIMARY)
 10253*    END-EXEC.
 10254     MOVE LENGTH OF
 10255      CERTIFICATE-MASTER
 10256       TO DFHEIV11
 10257*    MOVE '&$ L                  ''   #00009547' TO DFHEIV0
 10258     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10259     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10260     MOVE X'2020233030303039353437' TO DFHEIV0(25:11)
 10261     CALL 'kxdfhei1' USING DFHEIV0,
 10262           ELCERT-DSID,
 10263           CERTIFICATE-MASTER,
 10264           DFHEIV11,
 10265           CM-CONTROL-PRIMARY,
 10266           DFHEIV99,
 10267           DFHEIV99
 10268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10269
 10270
 10271 3690-CERT-WRITTEN.
 10272
 10273     GO TO 3800-BUILD-NEW-CLAIM.
 10274
 10275 3690-EXIT.
 10276      EXIT.
 10277
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 194
* EL130.cbl
 10279 3700-BUILD-CERT.
 10280
 10281     IF CERTMTI NOT = 'A'
 10282         GO TO 3700-FINISH-CERT-BUILD
 10283     END-IF.
 10284
 10285     IF CERTMTI = 'A'
 10286         IF LCVCDL = ZEROS
 10287             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10288                                    CM-LF-ORIG-TERM
 10289                                    CM-LF-BENEFIT-AMT
 10290                                    CM-LF-PREMIUM-RATE
 10291             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10292         END-IF
 10293     END-IF.
 10294
 10295     IF LCVCDL GREATER ZERO
 10296         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10297     END-IF.
 10298
 10299     IF LCVOTRML GREATER ZERO
 10300         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10301     END-IF.
 10302
 10303     IF LCVBENEL GREATER ZERO
 10304         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10305     END-IF.
 10306
 10307     IF LCVRATEL GREATER ZERO
 10308         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10309     END-IF.
 10310
 10311     IF WS-EXPIRE NOT = LOW-VALUES
 10312         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10313     END-IF.
 10314
 10315     IF LCVFORML GREATER ZERO
 10316         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10317     END-IF.
 10318
 10319     IF LCVCNDTL = ZERO
 10320        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10321     END-IF.
 10322
 10323     IF WS-LCVCNDT NOT = LOW-VALUES
 10324        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10325        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10326        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10327     END-IF.
 10328
 10329     IF CM-LF-CURRENT-STATUS = '7'
 10330        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10331        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10332        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10333                                    CM-LF-DEATH-DT
 10334        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10335     END-IF.
 10336
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 195
* EL130.cbl
 10337     IF CM-LF-CURRENT-STATUS = '8'
 10338        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10339        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10340     END-IF.
 10341
 10342 3700-BUILD-AH-COVERAGE-SIDE.
 10343
 10344     IF CERTMTI = 'A'
 10345         IF ACVCDL = ZEROS
 10346             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10347                                    CM-AH-ORIG-TERM
 10348                                    CM-AH-BENEFIT-AMT
 10349                                    CM-AH-PREMIUM-RATE
 10350             GO TO 3700-COVERAGE-BUILT
 10351         END-IF
 10352     END-IF.
 10353
 10354     IF ACVCDL GREATER ZERO
 10355         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10356     END-IF.
 10357
 10358     IF ACVOTRML GREATER ZERO
 10359         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10360     END-IF.
 10361
 10362     IF ACVBENEL GREATER ZERO
 10363         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10364     END-IF.
 10365
 10366     IF ACVRATEL GREATER ZERO
 10367         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10368     END-IF.
 10369
 10370     IF WS-EXPIRE NOT = LOW-VALUES
 10371         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10372     END-IF.
 10373
 10374     IF ACVFORML GREATER ZERO
 10375         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10376     END-IF.
 10377
 10378     IF ACVCNDTL = ZERO
 10379        GO TO 3700-COVERAGE-BUILT
 10380     END-IF.
 10381
 10382     IF WS-ACVCNDT NOT = LOW-VALUES
 10383        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10384        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10385        GO TO 3700-COVERAGE-BUILT
 10386     END-IF.
 10387
 10388     IF CM-AH-CURRENT-STATUS = '6'
 10389        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10390        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10391        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10392        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10393        GO TO 3700-COVERAGE-BUILT
 10394     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 196
* EL130.cbl
 10395
 10396     IF CM-AH-CURRENT-STATUS = '8'
 10397        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10398        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10399     END-IF.
 10400
 10401 3700-COVERAGE-BUILT.
 10402     IF ISSAGEL GREATER ZERO
 10403         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10404     END-IF.
 10405
 10406     IF JNTAGEL GREATER ZERO
 10407         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10408     END-IF.
 10409
 10410     IF SEXL GREATER ZERO
 10411         MOVE SEXI               TO CM-INSURED-SEX
 10412     END-IF.
 10413
 10414     IF APRL GREATER ZERO
 10415         MOVE WS-APR             TO CM-LOAN-APR
 10416     END-IF.
 10417
 10418     IF PMTFREQL GREATER ZERO
 10419         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10420     END-IF.
 10421
 10422     IF INDGRPL GREATER ZERO
 10423         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10424     END-IF.
 10425
 10426     IF CERTMTI = 'A'
 10427         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10428     END-IF.
 10429
 10430     IF REINCDL GREATER ZERO
 10431         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10432                                    WS-REIN-1
 10433                                    WS-REIN-2
 10434                                    WS-REIN-3
 10435         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10436     END-IF.
 10437
 10438     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10439         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10440     END-IF.
 10441
 10442     IF CRTSSNL GREATER ZERO
 10443         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10444     ELSE
 10445         IF SSNL GREATER ZERO
 10446             MOVE SSNI           TO CM-SOC-SEC-NO
 10447         END-IF
 10448     END-IF.
 10449
 10450     IF CRTSSNL = ZERO AND
 10451        SSNL    = ZERO
 10452         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 197
* EL130.cbl
 10453         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10454         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10455         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10456     END-IF.
 10457
 10458     IF CM-LF-CURRENT-STATUS = SPACES
 10459         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10460     END-IF.
 10461
 10462     IF CM-AH-CURRENT-STATUS = SPACES
 10463         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10464     END-IF.
 10465
 10466     IF CERTMTI = 'A'
 10467         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10468     END-IF.
 10469
 10470 3700-FINISH-CERT-BUILD.
 10471
 10472     IF LOANNOL GREATER ZERO
 10473         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10474     END-IF.
 10475
 10476     IF LOANBALL GREATER ZERO
 10477         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10478     END-IF.
 10479
 10480     IF PREMTYPL GREATER ZERO
 10481         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10482     END-IF.
 10483
 10484 3700-EXIT.
 10485      EXIT.
 10486
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 198
* EL130.cbl
 10488 3800-BUILD-NEW-CLAIM.
 10489
 10490*************************************************************
 10491*****           START OF ACTIVITY FILE PROCESSING          **
 10492*************************************************************
 10493     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10494         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10495                 6700-EXIT
 10496     END-IF.
 10497*************************************************************
 10498*****            END OF ACTIVITY FILE PROCESSING           **
 10499*************************************************************
 10500
 10501
 10502
 10503
 10504* EXEC CICS GETMAIN
 10505*        SET     (ADDRESS OF CLAIM-MASTER)
 10506*        LENGTH  (ELMSTR-LENGTH)
 10507*    END-EXEC.
 10508*    MOVE '," L                  $   #00009785' TO DFHEIV0
 10509     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10510     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10511     MOVE X'2020233030303039373835' TO DFHEIV0(25:11)
 10512     CALL 'kxdfhei1' USING DFHEIV0,
 10513           DFHEIV20,
 10514           ELMSTR-LENGTH,
 10515           DFHEIV99
 10516     SET ADDRESS OF CLAIM-MASTER TO
 10517         DFHEIV20
 10518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10519
 10520
 10521     MOVE SPACES TO CLAIM-MASTER.
 10522
 10523     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10524         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10525         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10526         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10527         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10528         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10529         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10530         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10531
 10532     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10533             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10534             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10535             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10536             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10537             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10538             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10539             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10540             CL-FORCEABLE-ERROR-CNT.
 10541
 10542     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10543
 10544     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10545                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 199
* EL130.cbl
 10546                                    CL-LAG-REPORT-CODE
 10547                                    CL-CRITICAL-PERIOD
 10548*                                   CL-CRIT-PER-RTW-MOS
 10549     move 01                     to cl-benefit-period
 10550
 10551     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10552     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10553
 10554     IF BENECDL NOT = ZEROS
 10555        MOVE BENECDI             TO CL-BENEFICIARY
 10556     END-IF.
 10557
 10558     MOVE 'CL'                   TO CL-RECORD-ID.
 10559     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10560
 10561     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10562                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10563                             CL-COMPANY-CD-A5.
 10564
 10565     MOVE CLMCARRI               TO CL-CARRIER.
 10566
 10567     IF CLMNOL = ZERO
 10568         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10569     ELSE
 10570         MOVE CLMNOI             TO CL-CLAIM-NO
 10571     END-IF.
 10572
 10573     MOVE CERTNOI                TO CL-CERT-PRIME
 10574                                    CL-CERT-A4-PRIME.
 10575
 10576     MOVE SUFXI                  TO CL-CERT-SFX
 10577                                    CL-CERT-A4-SFX.
 10578
 10579     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10580
 10581     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10582
 10583     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10584
 10585     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10586
 10587     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10588     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10589
 10590     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10591
 10592     IF CERTMTI = 'A'
 10593         MOVE '2'                TO CL-CERT-ORIGIN
 10594     ELSE
 10595         MOVE '1'                TO CL-CERT-ORIGIN
 10596     END-IF.
 10597
 10598     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10599     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10600     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10601     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10602     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10603
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 200
* EL130.cbl
 10604 3820-REWRITE-CONTROL-FILE.
 10605
 10606     IF CLMNOL GREATER ZERO
 10607         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10608     END-IF.
 10609
 10610     IF CF-RECORD-TYPE = '6'
 10611         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10612     ELSE
 10613         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10614     END-IF.
 10615
 10616
 10617
 10618* EXEC CICS REWRITE
 10619*        DATASET   (ELCNTL-DSID)
 10620*        FROM      (CONTROL-FILE)
 10621*    END-EXEC.
 10622     MOVE LENGTH OF
 10623      CONTROL-FILE
 10624       TO DFHEIV11
 10625*    MOVE '&& L                  %   #00009886' TO DFHEIV0
 10626     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10627     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10628     MOVE X'2020233030303039383836' TO DFHEIV0(25:11)
 10629     CALL 'kxdfhei1' USING DFHEIV0,
 10630           ELCNTL-DSID,
 10631           CONTROL-FILE,
 10632           DFHEIV11,
 10633           DFHEIV99
 10634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10635
 10636
 10637 3830-SEQUENCE-CLAIM-RECORDS.
 10638
 10639     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10640     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10641     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10642
 10643     IF WS-ASSOC-CERT-TOTAL = ZERO
 10644         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10645                                    CL-ASSOC-CERT-TOTAL
 10646         GO TO 3840-WRITE-CLAIM-MASTER
 10647     END-IF.
 10648
 10649     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10650         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10651     ELSE
 10652         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10653     END-IF.
 10654
 10655     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10656     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10657     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10658
 10659 3840-WRITE-CLAIM-MASTER.
 10660
 10661     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 201
* EL130.cbl
 10662     IF WS-REC-FOUND-SW = 'Y'
 10663         MOVE 01                 TO  CL-ACTIVITY-CODE
 10664         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10665         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10666     END-IF.
 10667
 10668
 10669
 10670* EXEC CICS HANDLE CONDITION
 10671*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10672*    END-EXEC.
 10673*    MOVE '"$$                   ! : #00009923' TO DFHEIV0
 10674     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10675     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10676     MOVE X'3A20233030303039393233' TO DFHEIV0(25:11)
 10677     CALL 'kxdfhei1' USING DFHEIV0
 10678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10679
 10680
 10681** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10682     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10683
 10684
 10685*       CL-CERT-NO
 10686*    IF CL-COMPANY-CD = X'04'
 10687*    ELSE
 10688*       IF CL-COMPANY-CD = X'05'
 10689*       ELSE
 10690*       END-IF
 10691*    END-IF
 10692
 10693* EXEC CICS WRITE
 10694*        DATASET   (ELMSTR-DSID)
 10695*        FROM      (CLAIM-MASTER)
 10696*        RIDFLD    (CL-CONTROL-PRIMARY)
 10697*    END-EXEC.
 10698     MOVE LENGTH OF
 10699      CLAIM-MASTER
 10700       TO DFHEIV11
 10701*    MOVE '&$ L                  ''   #00009943' TO DFHEIV0
 10702     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10703     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10704     MOVE X'2020233030303039393433' TO DFHEIV0(25:11)
 10705     CALL 'kxdfhei1' USING DFHEIV0,
 10706           ELMSTR-DSID,
 10707           CLAIM-MASTER,
 10708           DFHEIV11,
 10709           CL-CONTROL-PRIMARY,
 10710           DFHEIV99,
 10711           DFHEIV99
 10712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10713
 10714
 10715 3850-CLAIM-MSTR-WRITTEN.
 10716
 10717     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10718         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10719     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 202
* EL130.cbl
 10720
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 203
* EL130.cbl
 10722 3990-ADD-DONE.
 10723*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10724*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10725*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10726*                                  EMI-ERROR-LINES.
 10727
 10728     IF CLMNOL = ZERO
 10729         move spaces             to emi-claim-no
 10730         MOVE ER-0265            TO EMI-ERROR
 10731         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10732         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10733                                    PI-LAST-CLAIM
 10734     ELSE
 10735         MOVE CLMNOI             TO PI-LAST-CLAIM
 10736                                    MSTR-CLAIM-NO
 10737         MOVE ER-0000            TO EMI-ERROR
 10738         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10739     END-IF.
 10740
 10741     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10742       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10743         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10744         MOVE ER-7575            TO EMI-ERROR
 10745         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10746     END-IF.
 10747
 10748     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 10749       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10750         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10751         MOVE ER-7582            TO EMI-ERROR
 10752         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10753     END-IF.
 10754
 10755     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 10756        PERFORM 3991-CHECK-2-YEAR-CONTESTABLE THRU 3991-EXIT
 10757     END-IF.
 10758     IF WS-NO-INSURED-ADDRESS = 'Y'
 10759         MOVE ER-3548            TO EMI-ERROR
 10760         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10761     END-IF.
 10762
 10763     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10764       (PI-ST-CAUSAL-STATE = 'L' AND
 10765              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10766       (PI-ST-CAUSAL-STATE = 'A' AND
 10767              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10768         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10769         MOVE ER-7577            TO EMI-ERROR
 10770         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10771     END-IF.
 10772     if pi-company-id = 'DCC' OR 'VPP'
 10773        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10774                                 THRU 3994C-EXIT
 10775     end-if
 10776     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10777     MOVE CLMCARRI                   TO  PI-CARRIER.
 10778     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10779     MOVE SUFXI                      TO  PI-CERT-SFX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 204
* EL130.cbl
 10780
 10781     IF WS-LETTER-SW = 'Y'
 10782         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10783         IF W-1523-ERROR-CODE NOT = ZEROS
 10784             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10785             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10786         END-IF
 10787     END-IF.
 10788
 10789     perform 3998-update-cert-claim-trailer
 10790                                 thru 3998-exit
 10791     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10792     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10793     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10794     MOVE CLMCARRI               TO PI-LAST-CARR.
 10795
 10796     IF PRTOPTL GREATER THAN 0
 10797         MOVE PRTOPTI            TO PI-PRT-OPT
 10798     END-IF.
 10799     IF ALTPRTL GREATER THAN 0
 10800         MOVE ALTPRTI            TO PI-ALT-PRT
 10801     END-IF.
 10802
 10803     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10804         MOVE LOW-VALUES         TO EL130AI
 10805         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10806         MOVE AL-SANON           TO CERTNOA
 10807         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10808         MOVE AL-SANON           TO SUFXA
 10809         MOVE PI-LAST-CARR       TO CLMCARRO
 10810         MOVE AL-UANON           TO CLMCARRA
 10811         MOVE PI-LAST-CLAIM      TO CLMNOO
 10812         MOVE AL-UANON           TO CLMNOA
 10813         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10814         MOVE AL-UANON           TO CLMTYPEA
 10815     ELSE
 10816         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10817         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10818     END-IF.
 10819
 10820     IF PI-PRT-OPT = 'N' OR 'L'
 10821         MOVE PI-PRT-OPT         TO PRTOPTO
 10822         MOVE 1                  TO PRTOPTL
 10823     END-IF.
 10824
 10825     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10826         MOVE PI-ALT-PRT         TO ALTPRTO
 10827         MOVE 4                  TO ALTPRTL
 10828     END-IF.
 10829
 10830     IF PRTOPTL GREATER THAN 0
 10831         IF PRTOPTI = 'L'
 10832             GO TO 0400-CREATE-ELACTQ
 10833         ELSE
 10834             GO TO 0480-PRINT-NOW
 10835         END-IF
 10836     END-IF.
 10837     move 'S'                    to mainti
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 205
* EL130.cbl
 10838     PERFORM 0500-CREATE-TEMP-STORAGE
 10839                                 THRU 0599-EXIT
 10840     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10841         GO TO 8100-SEND-INITIAL-MAP
 10842     ELSE
 10843         MOVE LOW-VALUES         TO MAINTO
 10844         MOVE -1                 TO MAINTL
 10845         GO TO 8200-SEND-DATAONLY
 10846     END-IF.
 10847
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 206
* EL130.cbl
 10849 3991-CHECK-2-YEAR-CONTESTABLE.
 10850     SET ELAPSED-BETWEEN-BIN TO TRUE
 10851     MOVE ZERO               TO DC-ELAPSED-MONTHS
 10852                                DC-ELAPSED-DAYS
 10853
 10854     MOVE PI-SAVE-EFFDT  TO DC-BIN-DATE-1.
 10855     MOVE CL-INCURRED-DT TO DC-BIN-DATE-2.
 10856     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10857     IF DC-ODD-DAYS-OVER > ZERO
 10858        ADD 1 TO DC-ELAPSED-MONTHS
 10859     END-IF
 10860
 10861     IF DC-ELAPSED-MONTHS <= 24
 10862        MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
 10863        MOVE ZERO           TO DC-ELAPSED-MONTHS
 10864                               DC-ELAPSED-DAYS
 10865        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10866        IF DC-ODD-DAYS-OVER > ZERO
 10867           ADD 1 TO DC-ELAPSED-MONTHS
 10868        END-IF
 10869        IF DC-ELAPSED-MONTHS > 24
 10870           MOVE ER-1679            TO EMI-ERROR
 10871           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10872           PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10873        END-IF
 10874     END-IF.
 10875
 10876 3991-EXIT.
 10877     EXIT.
 10878 3992-BUILD-TRAILER.
 10879
 10880     MOVE SPACES             TO AT-GENERAL-INFO-TR
 10881     INITIALIZE AT-GENERAL-INFO-TR
 10882     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 10883     MOVE 'AT'               TO AT-RECORD-ID
 10884     MOVE +96                TO AT-SEQUENCE-NO
 10885     MOVE '6'                TO AT-TRAILER-TYPE
 10886     MOVE WS-TODAY-DT        TO AT-RECORDED-DT
 10887                                AT-GEN-INFO-LAST-MAINT-DT
 10888     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 10889                                AT-GEN-INFO-LAST-UPDATED-BY
 10890     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 10891
 10892     MOVE EMI-LINE2 TO AT-INFO-LINE-1
 10893     MOVE SPACES             TO AT-INFO-LINE-2.
 10894
 10895 3992-WRITE.
 10896
 10897
 10898* EXEC CICS HANDLE CONDITION
 10899*        DUPREC    (3992-DUPREC)
 10900*    END-EXEC.
 10901*    MOVE '"$%                   ! ; #00010131' TO DFHEIV0
 10902     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10903     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10904     MOVE X'3B20233030303130313331' TO DFHEIV0(25:11)
 10905     CALL 'kxdfhei1' USING DFHEIV0
 10906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 207
* EL130.cbl
 10907
 10908
 10909
 10910* EXEC CICS WRITE
 10911*         DATASET     ('ELTRLR')
 10912*         FROM        (ACTIVITY-TRAILERS)
 10913*         RIDFLD      (AT-CONTROL-PRIMARY)
 10914*     END-EXEC.
 10915     MOVE LENGTH OF
 10916      ACTIVITY-TRAILERS
 10917       TO DFHEIV11
 10918     MOVE 'ELTRLR' TO DFHEIV1
 10919*    MOVE '&$ L                  ''   #00010135' TO DFHEIV0
 10920     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10921     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10922     MOVE X'2020233030303130313335' TO DFHEIV0(25:11)
 10923     CALL 'kxdfhei1' USING DFHEIV0,
 10924           DFHEIV1,
 10925           ACTIVITY-TRAILERS,
 10926           DFHEIV11,
 10927           AT-CONTROL-PRIMARY,
 10928           DFHEIV99,
 10929           DFHEIV99
 10930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10931
 10932
 10933     GO TO 3992-EXIT.
 10934
 10935 3992-DUPREC.
 10936     SUBTRACT +1 FROM AT-SEQUENCE-NO.
 10937     GO TO 3992-WRITE.
 10938
 10939 3992-EXIT.
 10940     EXIT.
 10941 3993-MODIFY-SCREEN-ATTRB.
 10942
 10943     IF CERTMTL GREATER ZERO
 10944         MOVE AL-UANON           TO CERTMTA
 10945     END-IF.
 10946
 10947     IF EFFDTL GREATER ZERO
 10948         MOVE AL-UANON           TO EFFDTA
 10949     END-IF.
 10950
 10951     IF ACCOUNTL GREATER ZERO
 10952         MOVE AL-UANON           TO ACCOUNTA
 10953     END-IF.
 10954
 10955     IF STATEL GREATER ZERO
 10956         MOVE AL-UANON           TO STATEA
 10957     END-IF.
 10958
 10959     IF CRTCARRL GREATER ZERO
 10960         MOVE AL-UANON           TO CRTCARRA
 10961     END-IF.
 10962
 10963     IF GROUPL GREATER ZERO
 10964         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 208
* EL130.cbl
 10965     END-IF.
 10966
 10967     IF CRTLNMEL GREATER ZERO
 10968         MOVE AL-UANON           TO CRTLNMEA
 10969     END-IF.
 10970
 10971     IF CRTFNMEL GREATER ZERO
 10972         MOVE AL-UANON           TO CRTFNMEA
 10973     END-IF.
 10974
 10975     IF CRTINITL GREATER ZERO
 10976         MOVE AL-UANON           TO CRTINITA
 10977     END-IF.
 10978
 10979     IF ISSAGEL GREATER ZERO
 10980         MOVE AL-UNNON           TO ISSAGEA
 10981     END-IF.
 10982
 10983     IF JNTLNMEL GREATER ZERO
 10984         MOVE AL-UANON           TO JNTLNMEA
 10985     END-IF.
 10986
 10987     IF JNTFNMEL GREATER ZERO
 10988         MOVE AL-UANON           TO JNTFNMEA
 10989     END-IF.
 10990
 10991     IF JNTINITL GREATER ZERO
 10992         MOVE AL-UANON           TO JNTINITA
 10993     END-IF.
 10994
 10995     IF JNTAGEL GREATER ZERO
 10996         MOVE AL-UNNON           TO JNTAGEA
 10997     END-IF.
 10998
 10999     IF CRTSSNL GREATER ZERO
 11000         MOVE AL-UANON           TO CRTSSNA
 11001     END-IF.
 11002
 11003     IF ACVDSCRL GREATER ZERO
 11004         MOVE AL-SANON           TO ACVDSCRA
 11005     END-IF.
 11006
 11007     IF ACVKINDL GREATER ZERO
 11008         MOVE AL-SANON           TO ACVKINDA
 11009     END-IF.
 11010
 11011     IF ACVCDL GREATER ZERO
 11012         MOVE AL-UANON           TO ACVCDA
 11013     END-IF.
 11014
 11015     IF ACVOTRML GREATER ZERO
 11016         MOVE AL-UNNON           TO ACVOTRMA
 11017     END-IF.
 11018
 11019     IF ACVRTRML GREATER ZERO
 11020         MOVE AL-UNNON           TO ACVRTRMA
 11021     END-IF.
 11022
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 209
* EL130.cbl
 11023     IF ACVRATEL GREATER ZERO
 11024         MOVE AL-UNNON           TO ACVRATEA
 11025     END-IF.
 11026
 11027     IF ACVBENEL GREATER ZERO
 11028         MOVE AL-UNNON           TO ACVBENEA
 11029     END-IF.
 11030
 11031     IF ACVFORML GREATER ZERO
 11032         MOVE AL-UANON           TO ACVFORMA
 11033     END-IF.
 11034
 11035     IF ACVCNDTL GREATER ZERO
 11036         MOVE AL-UANON           TO ACVCNDTA
 11037     END-IF.
 11038
 11039     IF ACVEXITL GREATER ZERO
 11040         MOVE AL-UANON           TO ACVEXITA
 11041     END-IF.
 11042
 11043     IF ACVSTATL GREATER ZERO
 11044         MOVE AL-UANON           TO ACVSTATA
 11045     END-IF.
 11046
 11047     IF LCVDSCRL GREATER ZERO
 11048         MOVE AL-SANON           TO LCVDSCRA
 11049     END-IF.
 11050
 11051     IF LCVKINDL GREATER ZERO
 11052         MOVE AL-SANON           TO LCVKINDA
 11053     END-IF.
 11054
 11055     IF LCVCDL GREATER ZERO
 11056         MOVE AL-UANON           TO LCVCDA
 11057     END-IF.
 11058
 11059     IF LCVOTRML GREATER ZERO
 11060         MOVE AL-UNNON           TO LCVOTRMA
 11061     END-IF.
 11062
 11063     IF LCVRTRML GREATER ZERO
 11064         MOVE AL-UNNON           TO LCVRTRMA
 11065     END-IF.
 11066
 11067     IF LCVRATEL GREATER ZERO
 11068         MOVE AL-UNNON           TO LCVRATEA
 11069     END-IF.
 11070
 11071     IF LCVBENEL GREATER ZERO
 11072         MOVE AL-UNNON           TO LCVBENEA
 11073     END-IF.
 11074
 11075     IF LCVFORML GREATER ZERO
 11076         MOVE AL-UANON           TO LCVFORMA
 11077     END-IF.
 11078
 11079     IF LCVCNDTL GREATER ZERO
 11080         MOVE AL-UANON           TO LCVCNDTA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 210
* EL130.cbl
 11081     END-IF.
 11082
 11083     IF LCVEXITL GREATER ZERO
 11084         MOVE AL-UANON           TO LCVEXITA
 11085     END-IF.
 11086
 11087     IF LCVSTATL GREATER ZERO
 11088         MOVE AL-UANON           TO LCVSTATA
 11089     END-IF.
 11090
 11091     IF MEMCAPL GREATER ZERO
 11092         MOVE AL-UANON           TO MEMCAPA
 11093     END-IF.
 11094
 11095     IF APRL GREATER ZERO
 11096         MOVE AL-UNNON           TO APRA
 11097     END-IF.
 11098
 11099     IF PMTFREQL GREATER ZERO
 11100         MOVE AL-UNNON           TO PMTFREQA
 11101     END-IF.
 11102
 11103     IF INDGRPL GREATER ZERO
 11104         MOVE AL-UANON           TO INDGRPA
 11105     END-IF.
 11106
 11107     IF PREMTYPL GREATER ZERO
 11108         MOVE AL-UANON           TO PREMTYPA
 11109     END-IF.
 11110
 11111     IF REINCDL GREATER ZERO
 11112         MOVE AL-UANON           TO REINCDA
 11113     END-IF.
 11114
 11115     IF ADDONDTL GREATER ZERO
 11116         MOVE AL-UANON           TO ADDONDTA
 11117     END-IF.
 11118
 11119     IF MEMBERL GREATER ZERO
 11120         MOVE AL-UANON           TO MEMBERA
 11121     END-IF.
 11122
 11123     IF BCERT1L GREATER ZERO
 11124         MOVE AL-SANON           TO BCERT1A
 11125                                    BSUFX1A
 11126     END-IF.
 11127
 11128     IF BCERT2L GREATER ZERO
 11129         MOVE AL-SANON           TO BCERT2A
 11130                                    BSUFX2A
 11131     END-IF.
 11132
 11133     IF BCERT3L GREATER ZERO
 11134         MOVE AL-SANON           TO BCERT3A
 11135                                    BSUFX3A
 11136     END-IF.
 11137
 11138     IF BCERT4L GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 211
* EL130.cbl
 11139         MOVE AL-SANON           TO BCERT4A
 11140                                    BSUFX4A
 11141     END-IF.
 11142
 11143     IF BCERT5L GREATER ZERO
 11144         MOVE AL-SANON           TO BCERT5A
 11145                                    BSUFX5A
 11146     END-IF.
 11147
 11148 3993-MODIFY-CLAIM-ATTRB.
 11149
 11150     IF PCERTNOL GREATER ZERO
 11151         MOVE AL-UANON           TO PCERTNOA
 11152     END-IF.
 11153
 11154     IF PSUFXL GREATER ZERO
 11155         MOVE AL-UANON           TO PSUFXA
 11156     END-IF.
 11157
 11158     IF LSTNMEL GREATER ZERO
 11159         MOVE AL-UANON           TO LSTNMEA
 11160     END-IF.
 11161
 11162     IF FSTNMEL GREATER ZERO
 11163         MOVE AL-UANON           TO FSTNMEA
 11164     END-IF.
 11165
 11166     IF INITL GREATER ZERO
 11167         MOVE AL-UANON           TO INITA
 11168     END-IF.
 11169
 11170     IF SEXL GREATER ZERO
 11171         MOVE AL-UANON           TO SEXA
 11172     END-IF.
 11173
 11174     IF BIRTHDTL GREATER ZERO
 11175         MOVE AL-UANON           TO BIRTHDTA
 11176     END-IF.
 11177
 11178     IF SSNL GREATER ZERO
 11179         MOVE AL-UANON           TO SSNA
 11180     END-IF.
 11181
 11182     IF INCURL GREATER ZERO
 11183         MOVE AL-UANON           TO INCURA
 11184     END-IF.
 11185
 11186     IF REPORTL GREATER ZERO
 11187         MOVE AL-UANON           TO REPORTA
 11188     END-IF.
 11189
 11190*    IF ESTENDL GREATER ZERO
 11191*        MOVE AL-UANON           TO ESTENDA
 11192*    END-IF.
 11193
 11194     IF DIAGL GREATER ZERO
 11195         MOVE AL-UANON           TO DIAGA
 11196     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 212
* EL130.cbl
 11197*
 11198     IF ICD1L GREATER ZERO
 11199         MOVE AL-UANON           TO ICD1A
 11200     END-IF.
 11201
 11202     IF ICD2L GREATER ZERO
 11203         MOVE AL-UANON           TO ICD2A
 11204     END-IF.
 11205
 11206*    IF CAUSEL GREATER ZERO
 11207*        MOVE AL-UANON           TO CAUSEA
 11208*    END-IF.
 11209
 11210     IF MANRSVL GREATER ZERO
 11211         MOVE AL-UNNON           TO MANRSVA
 11212     END-IF.
 11213
 11214     IF RELCLML GREATER ZERO
 11215         MOVE AL-UANON           TO RELCLMA
 11216     END-IF.
 11217
 11218     IF LOANNOL GREATER ZERO
 11219         MOVE AL-UANON           TO LOANNOA
 11220     END-IF.
 11221
 11222     IF LOANBALL GREATER ZERO
 11223         MOVE AL-UNNON           TO LOANBALA
 11224     END-IF.
 11225
 11226     IF PROCCDL GREATER ZERO
 11227         MOVE AL-UANON           TO PROCCDA
 11228     END-IF.
 11229
 11230     IF BENECDL GREATER THAN ZERO
 11231         MOVE AL-UANON           TO  BENECDA
 11232     END-IF.
 11233
 11234     IF PRICDL GREATER ZERO
 11235         MOVE AL-UANON           TO PRICDA
 11236     END-IF.
 11237
 11238     IF SUPVL GREATER ZERO
 11239         MOVE AL-UANON           TO SUPVA
 11240     END-IF.
 11241
 11242     IF FILETOL GREATER ZERO
 11243         MOVE AL-UANON           TO FILETOA
 11244     END-IF.
 11245
 11246
 11247 3993-MODIFY-CLAIM-KEY-ATTRB.
 11248
 11249     IF CLMNOL GREATER ZERO
 11250         MOVE AL-UANON           TO CLMNOA
 11251     END-IF.
 11252
 11253     IF CLMCARRL GREATER ZERO
 11254         MOVE AL-UANON           TO CLMCARRA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 213
* EL130.cbl
 11255     END-IF.
 11256
 11257     IF CLMTYPEL GREATER ZERO
 11258         MOVE AL-UANON           TO CLMTYPEA
 11259     END-IF.
 11260
 11261     IF CERTNOL GREATER ZERO
 11262         MOVE AL-SANON           TO CERTNOA
 11263     END-IF.
 11264
 11265     IF SUFXL GREATER ZERO
 11266         MOVE AL-SANON           TO SUFXA
 11267     END-IF.
 11268
 11269 3993-EXIT.
 11270     EXIT.
 11271
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 214
* EL130.cbl
 11273 3994-BUILD-NINETY-THREE-TRAILER.
 11274
 11275     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11276     MOVE 'AT'                   TO AT-RECORD-ID.
 11277
 11278     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11279     MOVE CLMCARRI               TO AT-CARRIER.
 11280
 11281     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11282     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11283     MOVE +93                    TO AT-SEQUENCE-NO.
 11284     MOVE '6'                    TO AT-TRAILER-TYPE.
 11285     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11286
 11287     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11288         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11289     ELSE
 11290         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11291     END-IF
 11292
 11293     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11294                                    AT-GEN-INFO-LAST-MAINT-DT.
 11295
 11296     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11297                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11298     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11299
 11300
 11301
 11302* EXEC CICS WRITE
 11303*        DATASET   (ELTRLR-DSID)
 11304*        FROM      (ACTIVITY-TRAILERS)
 11305*        RIDFLD    (AT-CONTROL-PRIMARY)
 11306*    END-EXEC.
 11307     MOVE LENGTH OF
 11308      ACTIVITY-TRAILERS
 11309       TO DFHEIV11
 11310*    MOVE '&$ L                  ''   #00010509' TO DFHEIV0
 11311     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11312     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11313     MOVE X'2020233030303130353039' TO DFHEIV0(25:11)
 11314     CALL 'kxdfhei1' USING DFHEIV0,
 11315           ELTRLR-DSID,
 11316           ACTIVITY-TRAILERS,
 11317           DFHEIV11,
 11318           AT-CONTROL-PRIMARY,
 11319           DFHEIV99,
 11320           DFHEIV99
 11321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11322
 11323
 11324 3994-EXIT.
 11325     EXIT.
 11326
 11327 3994B-BUILD-NINETY-FOUR-TRAILER.
 11328
 11329     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11330     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 215
* EL130.cbl
 11331
 11332     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11333     MOVE CLMCARRI               TO AT-CARRIER.
 11334
 11335     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11336     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11337     MOVE +94                    TO AT-SEQUENCE-NO.
 11338     MOVE '6'                    TO AT-TRAILER-TYPE.
 11339     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11340
 11341     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11342
 11343     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11344                                    AT-GEN-INFO-LAST-MAINT-DT.
 11345
 11346     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11347                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11348     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11349
 11350
 11351
 11352* EXEC CICS WRITE
 11353*        DATASET   (ELTRLR-DSID)
 11354*        FROM      (ACTIVITY-TRAILERS)
 11355*        RIDFLD    (AT-CONTROL-PRIMARY)
 11356*    END-EXEC.
 11357     MOVE LENGTH OF
 11358      ACTIVITY-TRAILERS
 11359       TO DFHEIV11
 11360*    MOVE '&$ L                  ''   #00010542' TO DFHEIV0
 11361     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11362     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11363     MOVE X'2020233030303130353432' TO DFHEIV0(25:11)
 11364     CALL 'kxdfhei1' USING DFHEIV0,
 11365           ELTRLR-DSID,
 11366           ACTIVITY-TRAILERS,
 11367           DFHEIV11,
 11368           AT-CONTROL-PRIMARY,
 11369           DFHEIV99,
 11370           DFHEIV99
 11371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11372
 11373
 11374 3994B-EXIT.
 11375     EXIT.
 11376 3994C-BUILD-NINETY-FIVE-TRAILER.
 11377
 11378     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11379     MOVE 'AT'                   TO AT-RECORD-ID
 11380
 11381     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11382     MOVE CLMCARRI               TO AT-CARRIER
 11383
 11384     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11385     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11386     MOVE +95                    TO AT-SEQUENCE-NO
 11387     MOVE '6'                    TO AT-TRAILER-TYPE
 11388     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 216
* EL130.cbl
 11389
 11390     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11391                                    AT-GEN-INFO-LAST-MAINT-DT
 11392
 11393     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11394                                    AT-GEN-INFO-LAST-UPDATED-BY
 11395     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11396
 11397     perform varying e1 from +1 by +1 until
 11398        ws-error-no (e1) = spaces
 11399        move ws-error-no (e1)    to at-note-error-no (e1)
 11400     end-perform
 11401
 11402     if at-info-line-1 not = spaces
 11403
 11404* EXEC CICS WRITE
 11405*          DATASET  (ELTRLR-DSID)
 11406*          FROM     (ACTIVITY-TRAILERS)
 11407*          RIDFLD   (AT-CONTROL-PRIMARY)
 11408*       END-EXEC
 11409     MOVE LENGTH OF
 11410      ACTIVITY-TRAILERS
 11411       TO DFHEIV11
 11412*    MOVE '&$ L                  ''   #00010577' TO DFHEIV0
 11413     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11414     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11415     MOVE X'2020233030303130353737' TO DFHEIV0(25:11)
 11416     CALL 'kxdfhei1' USING DFHEIV0,
 11417           ELTRLR-DSID,
 11418           ACTIVITY-TRAILERS,
 11419           DFHEIV11,
 11420           AT-CONTROL-PRIMARY,
 11421           DFHEIV99,
 11422           DFHEIV99
 11423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11424     end-if
 11425
 11426     .
 11427 3994C-EXIT.
 11428     EXIT.
 11429 3995-BUILD-CLAIM-RECORD.
 11430     IF PROCCDL GREATER ZERO
 11431         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11432     ELSE
 11433         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11434     END-IF.
 11435
 11436     IF FSTNMEL GREATER ZERO
 11437         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11438     END-IF.
 11439
 11440     IF INITL GREATER ZERO
 11441         MOVE INITI              TO CL-INSURED-MID-INIT
 11442     END-IF.
 11443
 11444     IF BIRTHDTL GREATER ZERO
 11445         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11446     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 217
* EL130.cbl
 11447
 11448     IF SEXL GREATER ZERO
 11449         MOVE SEXI               TO CL-INSURED-SEX-CD
 11450     END-IF.
 11451
 11452     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11453
 11454*    IF CLMTYPEL GREATER ZERO
 11455     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11456*    END-IF.
 11457
 11458     IF PREMTYPL GREATER ZERO
 11459         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11460     END-IF.
 11461
 11462     IF INCURL GREATER ZERO
 11463         MOVE WS-INCUR           TO CL-INCURRED-DT
 11464     END-IF.
 11465
 11466     IF (PI-COMPANY-ID = 'DCC' OR 'VPP')
 11467        AND (ERPDEF-FOUND)
 11468        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11469*       MOVE WS-CRIT-PER-RECURRENT
 11470*                                TO CL-CRIT-PER-RECURRENT
 11471*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11472        if ws-crit-per-recurrent > 01
 11473           move zeros            to cl-benefit-period
 11474        end-if
 11475     ELSE
 11476        IF CL-CLAIM-TYPE = 'L' OR 'P'
 11477           MOVE CM-LF-CRITICAL-PERIOD
 11478                                 TO CL-CRITICAL-PERIOD
 11479        ELSE
 11480           MOVE CM-AH-CRITICAL-PERIOD
 11481                                 TO CL-CRITICAL-PERIOD
 11482        END-IF
 11483     END-IF
 11484
 11485     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11486        COMPUTE DC-ELAPSED-MONTHS =
 11487           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11488        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11489        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11490        MOVE '6'                 TO DC-OPTION-CODE
 11491        PERFORM 9700-LINK-DATE-CONVERT
 11492                                 THRU 9700-EXIT
 11493        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11494     END-IF
 11495
 11496     if instypel > zero
 11497        move instypei            to cl-insured-type
 11498     end-if
 11499     IF REPORTL GREATER ZERO
 11500         MOVE WS-REPORT          TO CL-REPORTED-DT
 11501     END-IF.
 11502
 11503     IF EIBAID = DFHPF6
 11504         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 218
* EL130.cbl
 11505             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11506                 IF EMI-FORCABLE-CTR = +1
 11507                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11508                 END-IF
 11509         END-IF
 11510     END-IF.
 11511
 11512*    IF ESTENDL GREATER ZERO
 11513*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11514*    END-IF.
 11515
 11516     IF ADDONDTL GREATER ZERO
 11517         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11518     END-IF.
 11519
 11520*    IF CAUSEL GREATER ZERO
 11521*        MOVE CAUSEI             TO CL-CAUSE-CD
 11522*    END-IF.
 11523
 11524     IF SSNL GREATER ZERO
 11525         MOVE SSNI               TO CL-SOC-SEC-NO
 11526     ELSE
 11527         MOVE CERT-STATE         TO CL-SSN-STATE
 11528         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11529         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11530     END-IF.
 11531
 11532     IF PRICDL GREATER ZERO
 11533         MOVE PRICDI             TO CL-PRIORITY-CD
 11534     END-IF.
 11535
 11536     IF SUPVL GREATER ZERO
 11537         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11538     END-IF.
 11539
 11540     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11541     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11542     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11543
 11544     IF RELCLML GREATER ZERO
 11545         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11546     END-IF.
 11547
 11548     IF FILETOL GREATER ZERO
 11549         MOVE FILETOI            TO CL-FILE-LOCATION
 11550     END-IF.
 11551
 11552 3995-EXIT.
 11553      EXIT.
 11554 3996-read-cert-claim-trailer.
 11555
 11556     move cm-ah-benefit-amt      to ws-monthly-benefit
 11557     if (pi-dcc-max-amt < ws-monthly-benefit)
 11558        and (pi-dcc-max-amt not = zeros)
 11559        move pi-dcc-max-amt      to ws-monthly-benefit
 11560     end-if
 11561
 11562     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 219
* EL130.cbl
 11563     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11564     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11565     MOVE CM-STATE               TO CTRLR-STATE
 11566     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11567     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11568     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11569     MOVE 'B'                    TO CTRLR-REC-TYPE
 11570
 11571* EXEC CICS READ
 11572*       DATASET  (ELCRTT-DSID)
 11573*       set     (address of CERTIFICATE-TRAILERS)
 11574*       RIDFLD   (ELCRTT-KEY)
 11575*       RESP     (WS-RESPONSE)
 11576*    END-EXEC
 11577*    MOVE '&"S        E          (  N#00010728' TO DFHEIV0
 11578     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11579     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11580     MOVE X'204E233030303130373238' TO DFHEIV0(25:11)
 11581     CALL 'kxdfhei1' USING DFHEIV0,
 11582           ELCRTT-DSID,
 11583           DFHEIV20,
 11584           DFHEIV99,
 11585           ELCRTT-KEY,
 11586           DFHEIV99,
 11587           DFHEIV99,
 11588           DFHEIV99
 11589     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11590         DFHEIV20
 11591     MOVE EIBRESP  TO WS-RESPONSE
 11592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11593***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11594***                                                            ***
 11595***  This may need some work here. I think I should accumulate ***
 11596***  all the claims with the same claim type?????????          ***
 11597***                                                            ***
 11598***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11599     IF WS-RESP-NORMAL
 11600        move zeros to ws-tot-days-paid ws-tot-amt-paid
 11601        perform varying s1 from +1 by +1 until
 11602           (s1 > +24)
 11603           or (cs-claim-no (s1) = spaces)
 11604           if cs-claim-type (s1) = clmtypei
 11605              move er-1659       to ws-error-no (e1)
 11606              compute ws-tot-days-paid =
 11607                 ws-tot-days-paid + cs-days-paid (s1)
 11608              compute ws-tot-amt-paid =
 11609                 ws-tot-amt-paid + cs-total-paid (s1)
 11610           end-if
 11611        end-perform
 11612*        compute ws-pd-bens rounded = ws-tot-days-paid / 30
 11613*        if (ws-pd-bens >= pi-dcc-max-benefits)
 11614*           and (pi-dcc-max-benefits not = zeros)
 11615*           add +1                to e1
 11616*           MOVE ER-1660          TO EMI-ERROR
 11617*                                    ws-error-no (e1)
 11618*           PERFORM 9900-ERROR-FORMAT
 11619*                                 THRU 9900-EXIT
 11620*        end-if
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 220
* EL130.cbl
 11621     end-if
 11622**       if instypei = 'P'
 11623**          move +1 to s1
 11624**       else
 11625**          MOVE +2 to s1
 11626**       end-if
 11627*
 11628*        move +1 to s1
 11629*        evaluate clmtypei
 11630*           when 'A'
 11631*              move +1 to s2
 11632*           when 'I'
 11633*              move +2 to s2
 11634*           when 'G'
 11635*              move +3 to s2
 11636*           when 'L'
 11637*              move +4 to s2
 11638*           when 'P'
 11639*              move +5 to s2
 11640*        end-evaluate
 11641*        if cs-claim-type (s1 s2) = clmtypei
 11642*           if cs-no-of-claims (s1 s2) > zeros
 11643*              move er-1659       to ws-error-no (e1)
 11644*           end-if
 11645*           compute WS-BENEFITS-PREV-PAID =
 11646*              cs-total-paid (s1 s2) / ws-monthly-benefit
 11647*           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11648*              and (pi-dcc-max-benefits not = zeros)
 11649*              add +1             to e1
 11650*              MOVE ER-1660       TO EMI-ERROR
 11651*                                    ws-error-no (e1)
 11652*              PERFORM 9900-ERROR-FORMAT
 11653*                                 THRU 9900-EXIT
 11654*           end-if
 11655*        end-if
 11656*     end-if
 11657
 11658     .
 11659 3996-exit.
 11660     exit.
 11661
 11662 3997-GET-ERPDEF.
 11663
 11664     if cm-clp-state = spaces or low-values or zeros
 11665        move cm-state            to cm-clp-state
 11666     end-if
 11667     MOVE SPACES                 TO WS-ERPDEF-SW
 11668     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11669                                    WS-CRIT-PER-RTW-MOS
 11670                                    WS-CRIT-PER-RECURRENT
 11671
 11672     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11673     MOVE CM-clp-state        TO ERPDEF-STATE
 11674     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11675***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11676***                                                            ***
 11677***  If they set up a claim where there is no coverage on the  ***
 11678***  addendum with the intention of denying.  We need to do    ***
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 221
* EL130.cbl
 11679***  some funky stuff here.                                    ***
 11680***                                                            ***
 11681***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11682
 11683     evaluate true
 11684        when (clmtypei = 'L' or 'P')
 11685           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 11686              and 'CU')
 11687           move 'L'              to erpdef-ben-type
 11688           move cm-lf-benefit-cd to erpdef-ben-code
 11689        when (clmtypei not = 'L' and 'P')
 11690           and (cm-ah-benefit-cd not = '00' and '  ')
 11691           move 'A'              to erpdef-ben-type
 11692           move cm-ah-benefit-cd to erpdef-ben-code
 11693        when (clmtypei not = 'L' and 'P')
 11694           and (cm-ah-benefit-cd = '00' or '  ')
 11695           move 'L'              to erpdef-ben-type
 11696           move cm-lf-benefit-cd to erpdef-ben-code
 11697        when (clmtypei = 'L' or 'P')
 11698           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 11699           move 'A'              to erpdef-ben-type
 11700           move cm-ah-benefit-cd to erpdef-ben-code
 11701        when other
 11702           move 'A'              to erpdef-ben-type
 11703           move cm-ah-benefit-cd to erpdef-ben-code
 11704     end-evaluate
 11705*    MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11706*    MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11707     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11708     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11709
 11710
 11711* EXEC CICS STARTBR
 11712*        DATASET  ('ERPDEF')
 11713*        RIDFLD   (ERPDEF-KEY)
 11714*        GTEQ
 11715*        RESP     (WS-RESPONSE)
 11716*    END-EXEC
 11717     MOVE 'ERPDEF' TO DFHEIV1
 11718     MOVE 0
 11719       TO DFHEIV11
 11720*    MOVE '&,         G          &  N#00010851' TO DFHEIV0
 11721     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11722     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11723     MOVE X'204E233030303130383531' TO DFHEIV0(25:11)
 11724     CALL 'kxdfhei1' USING DFHEIV0,
 11725           DFHEIV1,
 11726           ERPDEF-KEY,
 11727           DFHEIV99,
 11728           DFHEIV11,
 11729           DFHEIV99
 11730     MOVE EIBRESP  TO WS-RESPONSE
 11731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11732
 11733     IF WS-RESP-NORMAL
 11734
 11735* EXEC CICS READNEXT
 11736*          DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 222
* EL130.cbl
 11737*          INTO     (PRODUCT-MASTER)
 11738*          RIDFLD   (ERPDEF-KEY)
 11739*          RESP     (WS-RESPONSE)
 11740*       END-EXEC
 11741     MOVE LENGTH OF
 11742      PRODUCT-MASTER
 11743       TO DFHEIV12
 11744     MOVE 'ERPDEF' TO DFHEIV1
 11745     MOVE 0
 11746       TO DFHEIV11
 11747*    MOVE '&.IL                  )  N#00010859' TO DFHEIV0
 11748     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11749     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11750     MOVE X'204E233030303130383539' TO DFHEIV0(25:11)
 11751     CALL 'kxdfhei1' USING DFHEIV0,
 11752           DFHEIV1,
 11753           PRODUCT-MASTER,
 11754           DFHEIV12,
 11755           ERPDEF-KEY,
 11756           DFHEIV99,
 11757           DFHEIV11,
 11758           DFHEIV99,
 11759           DFHEIV99
 11760     MOVE EIBRESP  TO WS-RESPONSE
 11761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11762
 11763        IF WS-RESP-NORMAL
 11764           IF (ERPDEF-KEY-SAVE (1:16) =
 11765              PD-CONTROL-PRIMARY (1:16))
 11766              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11767
 11768              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11769                 (A1 > +8)
 11770                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11771              END-PERFORM
 11772              IF A1 < +9
 11773                 SET ERPDEF-FOUND TO TRUE
 11774                 move pd-max-amt (a1)
 11775                              to pi-dcc-max-amt
 11776                 MOVE PD-CRIT-PERIOD (A1)
 11777                              TO WS-MAX-BENEFITS
 11778                                 pi-dcc-max-benefits
 11779                 if pd-rec-crit-period (a1) not numeric
 11780                    move 01      to pd-rec-crit-period (a1)
 11781                 end-if
 11782                 MOVE PD-REC-CRIT-PERIOD (A1)
 11783                              TO WS-CRIT-PER-RECURRENT
 11784                 IF PD-RTW-MOS (A1) NUMERIC
 11785                    MOVE PD-RTW-MOS (A1)
 11786                              TO WS-CRIT-PER-RTW-MOS
 11787                 ELSE
 11788                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11789                 END-IF
 11790                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11791                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11792                                 TO WS-EXCL-PERIOD
 11793                 END-IF
 11794                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 223
* EL130.cbl
 11795                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11796                                 TO WS-COV-ENDS
 11797                 END-IF
 11798                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11799                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11800                                 TO WS-ACC-PERIOD
 11801                 END-IF
 11802                 IF PD-PRE-EXIST-EXCL-TYPE (A1) NUMERIC
 11803                    MOVE PD-PRE-EXIST-EXCL-TYPE (A1)
 11804                                 TO WS-PRE-EXISTING-PER
 11805                 END-IF
 11806              else
 11807                 MOVE -1         TO MAINTL
 11808                 move er-1673    to emi-error
 11809                 PERFORM 9900-ERROR-FORMAT
 11810                                 THRU 9900-EXIT
 11811              END-IF
 11812           else
 11813              MOVE -1            TO MAINTL
 11814              move er-1671       to emi-error
 11815              PERFORM 9900-ERROR-FORMAT
 11816                                 THRU 9900-EXIT
 11817           END-IF
 11818        END-IF
 11819     END-IF
 11820
 11821     .
 11822 3997-EXIT.
 11823     EXIT.
 11824
 11825 3998-update-cert-claim-trailer.
 11826
 11827
 11828* EXEC CICS GETMAIN
 11829*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11830*       LENGTH   (ELCRTT-LENGTH)
 11831*       INITIMG  (GETMAIN-SPACE)
 11832*    END-EXEC
 11833*    MOVE ',"IL                  $   #00010930' TO DFHEIV0
 11834     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11835     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11836     MOVE X'2020233030303130393330' TO DFHEIV0(25:11)
 11837     CALL 'kxdfhei1' USING DFHEIV0,
 11838           DFHEIV20,
 11839           ELCRTT-LENGTH,
 11840           GETMAIN-SPACE
 11841     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11842         DFHEIV20
 11843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11844
 11845     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11846     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11847     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11848     MOVE CM-STATE         TO CTRLR-STATE
 11849     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11850     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11851     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11852     MOVE 'B'              TO CTRLR-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 224
* EL130.cbl
 11853
 11854* EXEC CICS READ
 11855*       UPDATE
 11856*       DATASET  (ELCRTT-DSID)
 11857*       into     (CERTIFICATE-TRAILERS)
 11858*       RIDFLD   (ELCRTT-KEY)
 11859*       RESP     (WS-RESPONSE)
 11860*    END-EXEC
 11861     MOVE LENGTH OF
 11862      CERTIFICATE-TRAILERS
 11863       TO DFHEIV11
 11864*    MOVE '&"IL       EU         (  N#00010944' TO DFHEIV0
 11865     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11866     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11867     MOVE X'204E233030303130393434' TO DFHEIV0(25:11)
 11868     CALL 'kxdfhei1' USING DFHEIV0,
 11869           ELCRTT-DSID,
 11870           CERTIFICATE-TRAILERS,
 11871           DFHEIV11,
 11872           ELCRTT-KEY,
 11873           DFHEIV99,
 11874           DFHEIV99,
 11875           DFHEIV99
 11876     MOVE EIBRESP  TO WS-RESPONSE
 11877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11878     IF WS-RESP-NORMAL
 11879        perform varying s1 from +1 by +1 until
 11880           (s1 > +24)
 11881           or (cs-claim-no (s1) = spaces)
 11882        end-perform
 11883        if s1 < +25
 11884           perform 3999-upd-crt-trlr thru 3999-exit
 11885
 11886* EXEC CICS REWRITE
 11887*             DATASET  (ELCRTT-DSID)
 11888*             from     (CERTIFICATE-TRAILERS)
 11889*             RESP     (WS-RESPONSE)
 11890*          END-EXEC
 11891     MOVE LENGTH OF
 11892      CERTIFICATE-TRAILERS
 11893       TO DFHEIV11
 11894*    MOVE '&& L                  %  N#00010958' TO DFHEIV0
 11895     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11896     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11897     MOVE X'204E233030303130393538' TO DFHEIV0(25:11)
 11898     CALL 'kxdfhei1' USING DFHEIV0,
 11899           ELCRTT-DSID,
 11900           CERTIFICATE-TRAILERS,
 11901           DFHEIV11,
 11902           DFHEIV99
 11903     MOVE EIBRESP  TO WS-RESPONSE
 11904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11905        end-if
 11906     else
 11907        if ws-resp-notfnd
 11908           move 'CS'             to certificate-trailers
 11909           move cm-control-primary to cs-control-primary
 11910           move 'B'              to cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 225
* EL130.cbl
 11911           perform varying s1 from +1 by +1 until s1 > +24
 11912              move zeros         to cs-days-paid (s1)
 11913                                    cs-total-paid (s1)
 11914                                    cs-benefit-period (s1)
 11915                                    cs-remaining-bens (s1)
 11916           end-perform
 11917           move +1               to s1
 11918           perform 3999-upd-crt-trlr
 11919                                 thru 3999-exit
 11920
 11921* EXEC CICS WRITE
 11922*             DATASET  (ELCRTT-DSID)
 11923*             from     (CERTIFICATE-TRAILERS)
 11924*             RIDFLD   (cs-control-primary)
 11925*             RESP     (WS-RESPONSE)
 11926*          END-EXEC
 11927     MOVE LENGTH OF
 11928      CERTIFICATE-TRAILERS
 11929       TO DFHEIV11
 11930*    MOVE '&$ L                  ''  N#00010978' TO DFHEIV0
 11931     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11932     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11933     MOVE X'204E233030303130393738' TO DFHEIV0(25:11)
 11934     CALL 'kxdfhei1' USING DFHEIV0,
 11935           ELCRTT-DSID,
 11936           CERTIFICATE-TRAILERS,
 11937           DFHEIV11,
 11938           cs-control-primary,
 11939           DFHEIV99,
 11940           DFHEIV99
 11941     MOVE EIBRESP  TO WS-RESPONSE
 11942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11943        end-if
 11944     END-IF
 11945
 11946     .
 11947 3998-exit.
 11948     exit.
 11949
 11950 3999-upd-crt-trlr.
 11951     move clmnoi                 to cs-claim-no       (s1)
 11952     move clmtypei               to cs-claim-type     (s1)
 11953     move instypei               to cs-insured-type   (s1)
 11954     if ws-crit-per-recurrent > 01
 11955        move zeros               to cs-benefit-period(s1)
 11956     else
 11957        move 01                  to cs-benefit-period(s1)
 11958     end-if
 11959*    move cl-benefit-period      to cs-benefit-period (s1)
 11960*    move cl-critical-period     to cs-remaining-bens (s1)
 11961     move zeros                  to cs-remaining-bens (s1)
 11962     .
 11963 3999-exit.
 11964     exit.
 11965 4000-CALCULATE-CERT-TERM.
 11966
 11967     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 11968
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 226
* EL130.cbl
 11969     MOVE N                      TO WS-TERM.
 11970
 11971     IF WS-TERM GREATER 120
 11972         MOVE 120                TO WS-TERM
 11973     END-IF.
 11974
 11975 4000-CALC-TERM-EXIT.
 11976      EXIT.
 11977
 11978 4100-CALC-GROSS-TERM.
 11979     MOVE HOLD-LOAN-BAL           TO L.
 11980     MOVE WS-ACVBENE              TO M.
 11981     COMPUTE N = L / M.
 11982     IF N LESS 1
 11983         MOVE 1  TO N
 11984     END-IF.
 11985
 11986     IF LCVCDL GREATER ZERO
 11987         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 11988     ELSE
 11989         MOVE ZEROS               TO WS-LF-RATE
 11990     END-IF.
 11991
 11992     IF ACVCDL GREATER ZERO
 11993         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 11994     ELSE
 11995         MOVE ZEROS               TO WS-AH-RATE
 11996     END-IF.
 11997
 11998     COMPUTE I = WS-APR / +1200.
 11999
 12000 4105-LOOP.
 12001     IF N GREATER 240
 12002         GO TO 4200-EXIT
 12003     END-IF.
 12004
 12005     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 12006
 12007     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 12008         ADD 1 TO N
 12009         GO TO 4105-LOOP
 12010     END-IF.
 12011
 12012 4200-EXIT.
 12013      EXIT.
 12014
 12015 4210-CALC-LEFT-RIGHTONE.
 12016      MOVE L         TO LEFT-TOT-1.
 12017      SUBTRACT 1 FROM N.
 12018      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12019      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 12020      ADD 1 TO N.
 12021
 12022 4211-CALC-TERM1.
 12023      MOVE N         TO TERM1.
 12024      MULTIPLY M BY TERM1.
 12025
 12026 4212-LOOP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 227
* EL130.cbl
 12027      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 12028      ADD 1 TO A-N.
 12029      MULTIPLY A-N BY TERM1.
 12030      SUBTRACT 1 FROM A-N.
 12031      ADD TERM1 TO LEFT-TOT-1.
 12032
 12033 4213-CALC-TERM2.
 12034      MOVE M         TO TERM2.
 12035      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 12036      MULTIPLY IA-N BY TERM2.
 12037      SUBTRACT TERM2 FROM LEFT-TOT-1.
 12038
 12039 4215-CALC-RIGHTONE.
 12040      MOVE M         TO RIGHT-TOT-1.
 12041      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12042      MULTIPLY A-N BY RIGHT-TOT-1.
 12043
 12044 4220-EXIT.
 12045      EXIT.
 12046
 12047 4300-CALC-A-N.
 12048     IF N LESS 1
 12049         MOVE 0     TO A-N
 12050         GO TO 4300-EXIT
 12051     END-IF.
 12052
 12053     IF I = 0
 12054         MOVE .00001 TO I
 12055     END-IF.
 12056
 12057     ADD 1 TO I.
 12058     DIVIDE I INTO 1 GIVING V.
 12059     SUBTRACT 1 FROM I.
 12060     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12061     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 12062     DIVIDE I INTO TERM3 GIVING A-N.
 12063
 12064 4300-EXIT.
 12065      EXIT.
 12066
 12067 4350-CALC-IA-N.
 12068     IF N LESS 1
 12069         MOVE 0      TO IA-N
 12070         GO TO 4400-EXIT
 12071     END-IF.
 12072
 12073     ADD 1 TO N.
 12074     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12075     SUBTRACT 1 FROM N.
 12076     MULTIPLY N BY V-EX-N GIVING TERM3.
 12077     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 12078     SUBTRACT V FROM 1 GIVING TERM4.
 12079     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 12080
 12081 4400-EXIT.
 12082      EXIT.
 12083
 12084 4450-CALC-V-EX-N.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 228
* EL130.cbl
 12085     IF N LESS 1
 12086         MOVE 1    TO V-EX-N
 12087         GO TO 4490-EXIT
 12088     END-IF.
 12089
 12090     MOVE N        TO NV-STORE.
 12091
 12092     IF V-EX-ONETIME = 1  OR
 12093        V NOT = V-EXPONENT (1)
 12094          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 12095     END-IF.
 12096
 12097 4460-LOOP.
 12098     IF N GREATER 248
 12099         MOVE 248 TO N
 12100     END-IF.
 12101
 12102     IF N = 1
 12103         MOVE V               TO V-EX-N
 12104     ELSE
 12105         MOVE V-EXPONENT (N)  TO V-EX-N
 12106     END-IF.
 12107
 12108     GO TO 4490-EXIT.
 12109
 12110 4470-BUILD-V-EX-TABLE.
 12111     MOVE 2      TO N.
 12112     MOVE V      TO V-EXPONENT (1)
 12113                    V-EX-N.
 12114
 12115 4471-LOOP.
 12116     MULTIPLY V BY V-EX-N.
 12117     MOVE V-EX-N   TO V-EXPONENT (N).
 12118
 12119     ADD 1 TO N.
 12120     IF N LESS 248
 12121         GO TO 4471-LOOP
 12122     END-IF.
 12123
 12124     MOVE NV-STORE     TO N.
 12125     MOVE ZERO         TO V-EX-ONETIME.
 12126
 12127 4480-EXIT.
 12128      EXIT.
 12129
 12130 4490-EXIT.
 12131      EXIT.
 12132
 12133 4500-CALC-NET-TERM.
 12134     MOVE HOLD-LOAN-BAL           TO L.
 12135     MOVE WS-ACVBENE              TO M.
 12136     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 12137
 12138     IF WS-REMAIN GREATER ZERO
 12139         ADD 1 TO N
 12140     END-IF.
 12141
 12142     IF N = 0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 229
* EL130.cbl
 12143         MOVE 1 TO N
 12144     END-IF.
 12145
 12146 4700-EXIT.
 12147      EXIT.
 12148
 12149 4999-CALC-TERM-EXIT.
 12150     EXIT.
 12151
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 230
* EL130.cbl
 12153 5000-INCURRED-CHANGE.
 12154     IF NOT MODIFY-CAP
 12155         MOVE ER-0070            TO EMI-ERROR
 12156         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12157         MOVE -1                 TO MAINTL
 12158         GO TO 8200-SEND-DATAONLY
 12159     END-IF.
 12160
 12161     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 12162        CLMCARRI     NOT = PI-LAST-CARR        OR
 12163        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 12164        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 12165        PI-INCURR-SW NOT = 'Y'
 12166          GO TO 1000-SHOW-CLAIM
 12167     END-IF.
 12168
 12169     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 12170     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 12171     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 12172
 12173     IF EMI-NO-ERRORS
 12174         GO TO 5000-TRY-TO-BUILD
 12175     END-IF.
 12176
 12177     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 12178        MOVE ER-0433             TO EMI-ERROR
 12179        MOVE -1                  TO MAINTL
 12180        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12181        GO TO 8200-SEND-DATAONLY
 12182     END-IF.
 12183
 12184     IF EIBAID = DFHPF6
 12185         IF EMI-FATAL-CTR NOT EQUAL ZERO
 12186            MOVE ER-0434         TO EMI-ERROR
 12187            MOVE -1              TO MAINTL
 12188            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12189            GO TO 8200-SEND-DATAONLY
 12190         ELSE
 12191            MOVE +1              TO INCURL
 12192            GO TO 5000-TRY-TO-BUILD
 12193         END-IF
 12194     END-IF.
 12195
 12196     GO TO 8200-SEND-DATAONLY.
 12197
 12198 5000-TRY-TO-BUILD.
 12199
 12200     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 12201
 12202     MOVE CLMCARRI               TO MSTR-CARRIER.
 12203
 12204     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 12205     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 12206     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 12207
 12208     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 12209
 12210     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 231
* EL130.cbl
 12211         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 12212     END-IF.
 12213
 12214     IF CL-PURGED-DT NOT = LOW-VALUES
 12215
 12216
 12217* EXEC CICS UNLOCK
 12218*            DATASET   (ELMSTR-DSID)
 12219*        END-EXEC
 12220*    MOVE '&*                    #   #00011257' TO DFHEIV0
 12221     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12222     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12223     MOVE X'2020233030303131323537' TO DFHEIV0(25:11)
 12224     CALL 'kxdfhei1' USING DFHEIV0,
 12225           ELMSTR-DSID,
 12226           DFHEIV99
 12227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12228         MOVE ER-7691            TO EMI-ERROR
 12229         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12230         MOVE -1                 TO MAINTL
 12231         GO TO 8200-SEND-DATAONLY
 12232     END-IF.
 12233
 12234     IF CL-AUTO-PAY-SEQ NOT = ZERO
 12235
 12236
 12237* EXEC CICS UNLOCK
 12238*            DATASET   (ELMSTR-DSID)
 12239*       END-EXEC
 12240*    MOVE '&*                    #   #00011268' TO DFHEIV0
 12241     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12242     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12243     MOVE X'2020233030303131323638' TO DFHEIV0(25:11)
 12244     CALL 'kxdfhei1' USING DFHEIV0,
 12245           ELMSTR-DSID,
 12246           DFHEIV99
 12247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12248         MOVE ER-0523             TO EMI-ERROR
 12249         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12250         MOVE -1                  TO MAINTL
 12251         GO TO 8200-SEND-DATAONLY
 12252     END-IF.
 12253
 12254     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 12255
 12256     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 12257     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 12258     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 12259     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 12260     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 12261
 12262     IF MANRSVL GREATER ZERO
 12263        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 12264                                    AT-CURRENT-MANUAL-RESERVE
 12265     END-IF.
 12266     MOVE 1                      TO SUB.
 12267
 12268 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 232
* EL130.cbl
 12269     IF SUB = 1
 12270        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 12271        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 12272        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 12273     ELSE
 12274        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 12275        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 12276                                    AT-OPEN-CLOSE-REASON (SUB)
 12277     END-IF.
 12278
 12279     IF SUB NOT = 6
 12280        ADD 1                    TO SUB
 12281        GO TO 5010-LOOP
 12282     END-IF.
 12283
 12284 5020-UPDATE.
 12285
 12286     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12287
 12288     IF DIAGL = ZERO
 12289       AND ICD1L = ZERO
 12290       AND ICD2L = ZERO
 12291         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 12292         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 12293         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 12294         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 12295         GO TO 5025-BYPASS-UPDATE
 12296     END-IF.
 12297
 12298     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 12299
 12300     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 12301     IF DIAGL NOT = ZERO
 12302         MOVE DIAGI              TO AT-INFO-LINE-1
 12303     END-IF.
 12304
 12305     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 12306     IF ICD1L NOT = ZERO
 12307         MOVE ICD1I              TO AT-ICD-CODE-1
 12308     END-IF.
 12309
 12310     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 12311     IF ICD2L NOT = ZERO
 12312         MOVE ICD2I              TO AT-ICD-CODE-2
 12313     END-IF.
 12314
 12315     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12316
 12317 5025-BYPASS-UPDATE.
 12318
 12319
 12320
 12321* EXEC CICS GETMAIN
 12322*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12323*        LENGTH   (ELTRLR-LENGTH)
 12324*    END-EXEC.
 12325*    MOVE '," L                  $   #00011343' TO DFHEIV0
 12326     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 233
* EL130.cbl
 12327     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12328     MOVE X'2020233030303131333433' TO DFHEIV0(25:11)
 12329     CALL 'kxdfhei1' USING DFHEIV0,
 12330           DFHEIV20,
 12331           ELTRLR-LENGTH,
 12332           DFHEIV99
 12333     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12334         DFHEIV20
 12335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12336
 12337
 12338     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12339     MOVE 'AT'                   TO AT-RECORD-ID.
 12340
 12341     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12342     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12343     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12344     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12345     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12346     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12347     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12348     MOVE '9'                    TO AT-TRAILER-TYPE.
 12349     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12350     MOVE '5'                    TO DC-OPTION-CODE.
 12351     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12352     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12353
 12354     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12355     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12356
 12357     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12358     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12359     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12360     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12361     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12362     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12363     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12364     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12365     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12366     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12367     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12368     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12369
 12370     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12371     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12372     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12373     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12374     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12375
 12376
 12377
 12378* EXEC CICS WRITE
 12379*        DATASET   (ELTRLR-DSID)
 12380*        FROM      (ACTIVITY-TRAILERS)
 12381*        RIDFLD    (AT-CONTROL-PRIMARY)
 12382*    END-EXEC.
 12383     MOVE LENGTH OF
 12384      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 234
* EL130.cbl
 12385       TO DFHEIV11
 12386*    MOVE '&$ L                  ''   #00011387' TO DFHEIV0
 12387     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12388     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12389     MOVE X'2020233030303131333837' TO DFHEIV0(25:11)
 12390     CALL 'kxdfhei1' USING DFHEIV0,
 12391           ELTRLR-DSID,
 12392           ACTIVITY-TRAILERS,
 12393           DFHEIV11,
 12394           AT-CONTROL-PRIMARY,
 12395           DFHEIV99,
 12396           DFHEIV99
 12397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12398
 12399
 12400     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12401     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12402     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12403     MOVE CL-CERT-STATE          TO CERT-STATE.
 12404     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12405     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12406     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12407
 12408
 12409
 12410* EXEC CICS HANDLE CONDITION
 12411*        NOTFND   (5050-CERT-NOT-FOUND)
 12412*    END-EXEC.
 12413*    MOVE '"$I                   ! < #00011402' TO DFHEIV0
 12414     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12415     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12416     MOVE X'3C20233030303131343032' TO DFHEIV0(25:11)
 12417     CALL 'kxdfhei1' USING DFHEIV0
 12418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12419
 12420
 12421     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12422
 12423     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12424
 12425
 12426
 12427* EXEC CICS HANDLE CONDITION
 12428*         DUPKEY   (5030-CERT-WRITTEN)
 12429*    END-EXEC.
 12430*    MOVE '"$$                   ! = #00011411' TO DFHEIV0
 12431     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12433     MOVE X'3D20233030303131343131' TO DFHEIV0(25:11)
 12434     CALL 'kxdfhei1' USING DFHEIV0
 12435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12436
 12437
 12438
 12439
 12440* EXEC CICS REWRITE
 12441*        DATASET  (ELCERT-DSID)
 12442*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 235
* EL130.cbl
 12443*    END-EXEC.
 12444     MOVE LENGTH OF
 12445      CERTIFICATE-MASTER
 12446       TO DFHEIV11
 12447*    MOVE '&& L                  %   #00011416' TO DFHEIV0
 12448     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12449     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12450     MOVE X'2020233030303131343136' TO DFHEIV0(25:11)
 12451     CALL 'kxdfhei1' USING DFHEIV0,
 12452           ELCERT-DSID,
 12453           CERTIFICATE-MASTER,
 12454           DFHEIV11,
 12455           DFHEIV99
 12456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12457
 12458
 12459 5030-CERT-WRITTEN.
 12460
 12461     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12462                                    CL-INCURRED-DT
 12463                                    CL-REPORTED-DT
 12464                                    CL-EST-END-OF-DISAB-DT
 12465                                    CL-PAID-THRU-DT.
 12466
 12467     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12468                                    CL-NO-OF-PMTS-MADE
 12469                                    CL-NO-OF-DAYS-PAID.
 12470
 12471     IF CLAIM-IS-CLOSED
 12472        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12473        MOVE 'O'                 TO CL-CLAIM-STATUS
 12474     END-IF.
 12475
 12476     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12477     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12478     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12479
 12480
 12481
 12482* EXEC CICS HANDLE CONDITION
 12483*         DUPKEY   (5035-CLAIM-WRITTEN)
 12484*    END-EXEC.
 12485*    MOVE '"$$                   ! > #00011443' TO DFHEIV0
 12486     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12488     MOVE X'3E20233030303131343433' TO DFHEIV0(25:11)
 12489     CALL 'kxdfhei1' USING DFHEIV0
 12490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12491
 12492
 12493
 12494
 12495* EXEC CICS REWRITE
 12496*        DATASET   (ELMSTR-DSID)
 12497*        FROM      (CLAIM-MASTER)
 12498*    END-EXEC.
 12499     MOVE LENGTH OF
 12500      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 236
* EL130.cbl
 12501       TO DFHEIV11
 12502*    MOVE '&& L                  %   #00011448' TO DFHEIV0
 12503     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12504     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12505     MOVE X'2020233030303131343438' TO DFHEIV0(25:11)
 12506     CALL 'kxdfhei1' USING DFHEIV0,
 12507           ELMSTR-DSID,
 12508           CLAIM-MASTER,
 12509           DFHEIV11,
 12510           DFHEIV99
 12511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12512
 12513
 12514 5035-CLAIM-WRITTEN.
 12515
 12516     MOVE ER-0000                TO EMI-ERROR.
 12517     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12518
 12519     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12520     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12521     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12522     MOVE CLMCARRI               TO PI-LAST-CARR.
 12523
 12524     IF PRTOPTL GREATER ZERO
 12525         MOVE PRTOPTI            TO PI-PRT-OPT
 12526     END-IF.
 12527
 12528     IF ALTPRTL GREATER ZERO
 12529         MOVE ALTPRTI            TO PI-ALT-PRT
 12530     END-IF.
 12531
 12532     MOVE LOW-VALUES             TO EL130AI.
 12533
 12534     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12535     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12536     MOVE PI-LAST-CARR           TO CLMCARRO.
 12537     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12538
 12539     IF PI-PRT-OPT = 'N' OR 'L'
 12540         MOVE PI-PRT-OPT         TO PRTOPTO
 12541         MOVE 1                  TO PRTOPTL
 12542     END-IF.
 12543
 12544     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12545         MOVE PI-ALT-PRT         TO ALTPRTO
 12546         MOVE 4                  TO ALTPRTL
 12547     END-IF.
 12548
 12549     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12550     MOVE AL-SANON               TO CERTNOA SUFXA.
 12551
 12552     MOVE SPACES                 TO PI-INCURR-SW.
 12553
 12554     IF PRTOPTL GREATER ZERO
 12555         IF PRTOPTI = 'L'
 12556             GO TO 0400-CREATE-ELACTQ
 12557         ELSE
 12558             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 237
* EL130.cbl
 12559         END-IF
 12560     END-IF.
 12561
 12562     GO TO 8100-SEND-INITIAL-MAP.
 12563
 12564 5050-CERT-NOT-FOUND.
 12565
 12566     MOVE ER-0244                TO EMI-ERROR.
 12567     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12568     MOVE -1                     TO CERTNOL.
 12569     GO TO 8200-SEND-DATAONLY.
 12570
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 238
* EL130.cbl
 12572 5500-BUILD-FORM-TRAILER.
 12573*************************************************************
 12574*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12575*************************************************************
 12576
 12577     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12578
 12579     IF  WS-BEN-ALPHA-2 = '30'
 12580         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12581         MOVE '6'                TO DC-OPTION-CODE
 12582         IF CL-CARRIER = 'C'
 12583             MOVE +14            TO DC-ELAPSED-DAYS
 12584             MOVE +0             TO DC-ELAPSED-MONTHS
 12585             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12586             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12587         ELSE
 12588             MOVE +21            TO DC-ELAPSED-DAYS
 12589             MOVE +0             TO DC-ELAPSED-MONTHS
 12590             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12591             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12592         END-IF
 12593     END-IF.
 12594
 12595
 12596
 12597* EXEC CICS GETMAIN
 12598*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12599*         LENGTH   (ELTRLR-LENGTH)
 12600*         INITIMG  (GETMAIN-SPACE)
 12601*    END-EXEC.
 12602*    MOVE ',"IL                  $   #00011535' TO DFHEIV0
 12603     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12604     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12605     MOVE X'2020233030303131353335' TO DFHEIV0(25:11)
 12606     CALL 'kxdfhei1' USING DFHEIV0,
 12607           DFHEIV20,
 12608           ELTRLR-LENGTH,
 12609           GETMAIN-SPACE
 12610     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12611         DFHEIV20
 12612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12613
 12614
 12615     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12616     MOVE 'AT'                   TO AT-RECORD-ID.
 12617
 12618     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12619     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12620     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12621     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12622                                    AT-FORM-LAST-MAINT-DT.
 12623     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12624                                    AT-FORM-LAST-UPDATED-BY.
 12625     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12626     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12627     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12628                                    AT-FORM-RE-SEND-DT
 12629                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 239
* EL130.cbl
 12630                                    AT-EMP-FORM-ANSWERED-DT
 12631                                    AT-PHY-FORM-ANSWERED-DT
 12632                                    AT-EMP-FORM-SEND-ON-DT
 12633                                    AT-FORM-PRINTED-DT
 12634                                    AT-FORM-REPRINT-DT.
 12635     MOVE '1'                    TO AT-FORM-TYPE.
 12636
 12637     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12638                                    AT-INSTRUCT-LN-2
 12639                                    AT-INSTRUCT-LN-3.
 12640
 12641     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12642     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12643
 12644     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12645
 12646     IF AM-EMPLOYER-STMT-USED = 'Y'
 12647        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12648     END-IF.
 12649
 12650
 12651
 12652* EXEC CICS WRITE
 12653*         DATASET  (ELTRLR-DSID)
 12654*         FROM     (ACTIVITY-TRAILERS)
 12655*         RIDFLD   (AT-CONTROL-PRIMARY)
 12656*    END-EXEC.
 12657     MOVE LENGTH OF
 12658      ACTIVITY-TRAILERS
 12659       TO DFHEIV11
 12660*    MOVE '&$ L                  ''   #00011577' TO DFHEIV0
 12661     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12662     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12663     MOVE X'2020233030303131353737' TO DFHEIV0(25:11)
 12664     CALL 'kxdfhei1' USING DFHEIV0,
 12665           ELTRLR-DSID,
 12666           ACTIVITY-TRAILERS,
 12667           DFHEIV11,
 12668           AT-CONTROL-PRIMARY,
 12669           DFHEIV99,
 12670           DFHEIV99
 12671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12672
 12673
 12674 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 240
* EL130.cbl
 12676*************************************************************
 12677*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12678*************************************************************
 12679
 12680 5700-BUILD-ARCHIVE-HEADER.
 12681
 12682     MOVE '1'                    TO CNTL-REC-TYPE.
 12683     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12684     MOVE SPACES                 TO CNTL-ACCESS.
 12685
 12686
 12687
 12688* EXEC CICS READ
 12689*         DATASET  (ELCNTL-DSID)
 12690*         SET      (ADDRESS OF CONTROL-FILE)
 12691*         RIDFLD   (ELCNTL-KEY)
 12692*         UPDATE
 12693*    END-EXEC.
 12694*    MOVE '&"S        EU         (   #00011596' TO DFHEIV0
 12695     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12696     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12697     MOVE X'2020233030303131353936' TO DFHEIV0(25:11)
 12698     CALL 'kxdfhei1' USING DFHEIV0,
 12699           ELCNTL-DSID,
 12700           DFHEIV20,
 12701           DFHEIV99,
 12702           ELCNTL-KEY,
 12703           DFHEIV99,
 12704           DFHEIV99,
 12705           DFHEIV99
 12706     SET ADDRESS OF CONTROL-FILE TO
 12707         DFHEIV20
 12708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12709
 12710
 12711     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12712
 12713     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12714
 12715
 12716
 12717* EXEC CICS REWRITE
 12718*         FROM     (CONTROL-FILE)
 12719*         DATASET  (ELCNTL-DSID)
 12720*    END-EXEC.
 12721     MOVE LENGTH OF
 12722      CONTROL-FILE
 12723       TO DFHEIV11
 12724*    MOVE '&& L                  %   #00011608' TO DFHEIV0
 12725     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12726     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12727     MOVE X'2020233030303131363038' TO DFHEIV0(25:11)
 12728     CALL 'kxdfhei1' USING DFHEIV0,
 12729           ELCNTL-DSID,
 12730           CONTROL-FILE,
 12731           DFHEIV11,
 12732           DFHEIV99
 12733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 241
* EL130.cbl
 12734
 12735
 12736
 12737
 12738* EXEC CICS HANDLE CONDITION
 12739*         NOTOPEN  (9990-ABEND)
 12740*         DUPKEY   (5799-EXIT)
 12741*    END-EXEC.
 12742*    MOVE '"$J$                  ! ? #00011614' TO DFHEIV0
 12743     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12745     MOVE X'3F20233030303131363134' TO DFHEIV0(25:11)
 12746     CALL 'kxdfhei1' USING DFHEIV0
 12747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12748
 12749
 12750
 12751
 12752* EXEC CICS GETMAIN
 12753*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12754*         LENGTH  (ELARCH-LENGTH)
 12755*    END-EXEC.
 12756*    MOVE '," L                  $   #00011620' TO DFHEIV0
 12757     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12758     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12759     MOVE X'2020233030303131363230' TO DFHEIV0(25:11)
 12760     CALL 'kxdfhei1' USING DFHEIV0,
 12761           DFHEIV20,
 12762           ELARCH-LENGTH,
 12763           DFHEIV99
 12764     SET ADDRESS OF LETTER-ARCHIVE TO
 12765         DFHEIV20
 12766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12767
 12768
 12769     MOVE SPACES                 TO LETTER-ARCHIVE.
 12770     MOVE 'LA'                   TO LA-RECORD-ID.
 12771     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12772                                    LA-ARCHIVE-NO-A1.
 12773     MOVE '4'                    TO LA-RECORD-TYPE
 12774                                    LA-RECORD-TYPE-A1.
 12775     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12776                                    LA-LINE-SEQ-NO-A1.
 12777     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12778                                    LA-COMPANY-CD-A1.
 12779     MOVE CL-CARRIER             TO LA4-CARRIER.
 12780     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12781     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12782     MOVE CL-CERT-STATE          TO LA4-STATE.
 12783     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12784     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12785     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12786     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12787                                    LA4-RESEND-PRINT-DATE
 12788                                    LA4-FORM-REM-PRINT-DT
 12789                                    LA4-RESEND-DATE.
 12790     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12791     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 242
* EL130.cbl
 12792
 12793
 12794
 12795* EXEC CICS WRITE
 12796*         DATASET  (ELARCH-DSID)
 12797*         FROM     (LETTER-ARCHIVE)
 12798*         RIDFLD   (LA-CONTROL-PRIMARY)
 12799*    END-EXEC.
 12800     MOVE LENGTH OF
 12801      LETTER-ARCHIVE
 12802       TO DFHEIV11
 12803*    MOVE '&$ L                  ''   #00011650' TO DFHEIV0
 12804     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12805     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12806     MOVE X'2020233030303131363530' TO DFHEIV0(25:11)
 12807     CALL 'kxdfhei1' USING DFHEIV0,
 12808           ELARCH-DSID,
 12809           LETTER-ARCHIVE,
 12810           DFHEIV11,
 12811           LA-CONTROL-PRIMARY,
 12812           DFHEIV99,
 12813           DFHEIV99
 12814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12815
 12816
 12817 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 243
* EL130.cbl
 12819 6000-EDIT-CLAIM-DATA.
 12820
 12821     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12822     MOVE '2'                    TO DC-OPTION-CODE.
 12823     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12824     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12825
 12826     IF MAINTL NOT = ZERO
 12827         MOVE AL-UANON           TO MAINTA
 12828     END-IF
 12829
 12830     IF CLMNOL GREATER ZERO
 12831         IF CLMNOI = SPACES OR LOW-VALUES
 12832             MOVE -1             TO CLMNOL
 12833             MOVE AL-UABON       TO CLMNOA
 12834             MOVE ER-7688        TO EMI-ERROR
 12835             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12836         ELSE
 12837             MOVE AL-UANON       TO CLMNOA
 12838         END-IF
 12839     END-IF.
 12840
 12841     IF CERTNOL = ZERO
 12842         MOVE -1                 TO CERTNOL
 12843         MOVE AL-SABON           TO CERTNOA
 12844         MOVE ER-0203            TO EMI-ERROR
 12845         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12846     ELSE
 12847         MOVE AL-SANON           TO CERTNOA
 12848     END-IF.
 12849
 12850     IF SUFXL = ZERO
 12851         MOVE SPACES             TO SUFXI
 12852         MOVE AL-SANON           TO SUFXA
 12853     ELSE
 12854         MOVE AL-SANON           TO SUFXA
 12855     END-IF.
 12856
 12857     IF CLMCARRL = ZERO
 12858         MOVE -1                 TO CLMCARRL
 12859         MOVE ER-0194            TO EMI-ERROR
 12860         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12861     ELSE
 12862         MOVE CLMCARRI           TO PI-CARRIER
 12863         IF PI-NO-CARRIER-SECURITY
 12864             MOVE AL-UANON       TO CLMCARRA
 12865         END-IF
 12866     END-IF.
 12867
 12868     IF CLMTYPEL > ZERO
 12869        IF ((PI-COMPANY-ID = 'DCC' OR 'VPP')
 12870           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12871              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G' AND 'F'))
 12872                        OR
 12873           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12874           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12875              AND PI-AH-OVERRIDE-L1))
 12876              MOVE -1             TO CLMTYPEL
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 244
* EL130.cbl
 12877              MOVE AL-UABON       TO CLMTYPEA
 12878              MOVE ER-7634        TO EMI-ERROR
 12879              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12880        ELSE
 12881           MOVE AL-UANON       TO CLMTYPEA
 12882        END-IF
 12883     ELSE
 12884        IF MAINTI = 'A'
 12885           MOVE -1             TO CLMTYPEL
 12886           MOVE AL-UABON       TO CLMTYPEA
 12887           MOVE ER-0546        TO EMI-ERROR
 12888           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12889        END-IF
 12890     END-IF
 12891     if instypel > ZERO
 12892        if instypei = 'P' OR 'C'
 12893           move al-uanon         to instypea
 12894        else
 12895           MOVE -1               TO INSTYPEL
 12896           MOVE AL-UABON         TO INSTYPEA
 12897           MOVE ER-1654          TO EMI-ERROR
 12898           PERFORM 9900-ERROR-FORMAT
 12899                                 THRU 9900-EXIT
 12900        END-IF
 12901     ELSE
 12902        IF MAINTI = 'A'
 12903           MOVE -1               TO INSTYPEL
 12904           MOVE AL-UABON         TO INSTYPEA
 12905           MOVE ER-1654          TO EMI-ERROR
 12906           PERFORM 9900-ERROR-FORMAT
 12907                                 THRU 9900-EXIT
 12908        END-IF
 12909     END-IF
 12910     if (instypel <> zeros)
 12911        and (emi-error not = er-1654)
 12912        and (instypei = 'C')
 12913        and (crtfnmei = fstnmei)
 12914        move er-1675             to emi-error
 12915        MOVE -1                  TO INSTYPEL
 12916        MOVE AL-UABON            TO INSTYPEA
 12917        PERFORM 9900-ERROR-FORMAT
 12918                                 THRU 9900-EXIT
 12919    end-if
 12920     if (instypel <> zeros)
 12921        and (emi-error not = er-1654)
 12922        and (instypei = 'P')
 12923        and (crtfnmei <> fstnmei)
 12924        move er-1676             to emi-error
 12925        MOVE -1                  TO INSTYPEL
 12926        MOVE AL-UABON            TO INSTYPEA
 12927        PERFORM 9900-ERROR-FORMAT
 12928                                 THRU 9900-EXIT
 12929    end-if
 12930     IF PCERTNOL = ZERO
 12931        MOVE CERTNOI             TO PCERTNOI
 12932        MOVE CERTNOL             TO PCERTNOL
 12933        MOVE AL-UANON            TO PCERTNOA
 12934     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 245
* EL130.cbl
 12935        MOVE AL-UANON            TO PCERTNOA
 12936     END-IF.
 12937
 12938     IF PSUFXL = ZERO
 12939        MOVE SUFXI               TO PSUFXI
 12940        MOVE SUFXL               TO PSUFXL
 12941        MOVE AL-UANON            TO PSUFXA
 12942     ELSE
 12943        MOVE AL-UANON            TO PSUFXA
 12944     END-IF.
 12945
 12946     IF MAINTI = 'I'
 12947         GO TO 6020-EDIT
 12948     END-IF.
 12949
 12950     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 12951         MOVE -1                 TO LSTNMEL
 12952         MOVE ER-0236            TO EMI-ERROR
 12953         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12954     ELSE
 12955         MOVE AL-UANON           TO LSTNMEA
 12956     END-IF.
 12957     if fstnmel not = zeros
 12958        move al-uanon            to fstnmea
 12959     end-if
 12960     IF SEXL > ZEROS
 12961        IF SEXI = 'M' OR 'F'
 12962           move al-uanon         to sexa
 12963           CONTINUE
 12964        ELSE
 12965           MOVE -1               TO SEXL
 12966           MOVE AL-UABON         TO SEXA
 12967           MOVE ER-0219          TO EMI-ERROR
 12968           PERFORM 9900-ERROR-FORMAT
 12969                                 THRU 9900-EXIT
 12970        END-IF
 12971     ELSE
 12972        IF MAINTI = 'A'
 12973           MOVE -1               TO SEXL
 12974           MOVE AL-UABON         TO SEXA
 12975           MOVE ER-0219          TO EMI-ERROR
 12976           PERFORM 9900-ERROR-FORMAT
 12977                                 THRU 9900-EXIT
 12978        END-IF
 12979     END-IF
 12980     IF SSNL GREATER THAN ZERO
 12981         MOVE SSNI TO WS-SOC-SEC-NUMBER
 12982         IF WS-SOC-SEC-NO NUMERIC AND
 12983           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 12984             NEXT SENTENCE
 12985         ELSE
 12986            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 12987               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 12988               WS-SSN-DASH2 = '-'
 12989                 NEXT SENTENCE
 12990            ELSE
 12991                 MOVE ER-0887        TO  EMI-ERROR
 12992                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 246
* EL130.cbl
 12993                 MOVE AL-UABON       TO  SSNA
 12994                 MOVE -1             TO  SSNL
 12995            END-IF
 12996        END-IF
 12997     END-IF.
 12998
 12999     IF BIRTHDTL = ZERO
 13000         GO TO 6020-EDIT
 13001     END-IF.
 13002
 13003     IF BIRTHDTL GREATER ZERO
 13004         MOVE BIRTHDTI           TO DATE-WORK
 13005         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13006         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13007         MOVE '4'                TO DC-OPTION-CODE
 13008         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13009         IF DATE-CONVERSION-ERROR
 13010             MOVE AL-UABON       TO BIRTHDTA
 13011             MOVE -1             TO BIRTHDTL
 13012             MOVE ER-0220        TO EMI-ERROR
 13013             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13014             GO TO 6020-EDIT
 13015         END-IF
 13016     END-IF.
 13017
 13018******************************************************************
 13019**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 13020**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 13021**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 13022******************************************************************
 13023
 13024     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 13025         MOVE BIRTHDTI           TO  DATE-WORK
 13026         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13027         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 13028         MOVE '4'                TO  DC-OPTION-CODE
 13029         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 13030         MOVE +0                 TO  DC-ELAPSED-MONTHS
 13031                                     DC-ELAPSED-DAYS
 13032         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13033         IF DATE-CONVERSION-ERROR
 13034             MOVE AL-UABON       TO  BIRTHDTA
 13035             MOVE -1             TO  BIRTHDTL
 13036             MOVE ER-0220        TO  EMI-ERROR
 13037             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13038             GO TO 6020-EDIT
 13039         END-IF
 13040     END-IF.
 13041
 13042     MOVE AL-UANON               TO  BIRTHDTA.
 13043     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 13044     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 13045     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 13046
 13047 6020-EDIT.
 13048     IF INCURL GREATER ZERO
 13049         MOVE INCURI             TO DATE-WORK
 13050         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 247
* EL130.cbl
 13051         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13052         MOVE '4'                TO DC-OPTION-CODE
 13053         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13054         IF DATE-CONVERSION-ERROR
 13055             MOVE AL-UABON       TO INCURA
 13056             MOVE -1             TO INCURL
 13057             MOVE ER-0222        TO EMI-ERROR
 13058             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13059         ELSE
 13060             MOVE AL-UANON       TO INCURA
 13061             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 13062             MOVE DC-BIN-DATE-1  TO WS-INCUR
 13063                                    PI-SAVE-INCUR-DT
 13064             IF WS-INCUR GREATER THAN WS-TODAY-DT
 13065                 MOVE ER-0511     TO EMI-ERROR
 13066                 MOVE -1          TO INCURL
 13067                 MOVE AL-UABON    TO INCURA
 13068                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13069             ELSE
 13070*                NEXT SENTENCE
 13071                 CONTINUE
 13072             END-IF
 13073         END-IF
 13074     ELSE
 13075         MOVE ER-0516         TO EMI-ERROR
 13076         MOVE AL-UABON        TO INCURA
 13077         MOVE -1              TO INCURL
 13078         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13079     END-IF.
 13080
 13081     IF REPORTL GREATER ZERO
 13082         MOVE REPORTI            TO DATE-WORK
 13083         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13084         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13085         MOVE '4'                TO DC-OPTION-CODE
 13086         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13087         IF DATE-CONVERSION-ERROR
 13088             MOVE AL-UABON       TO REPORTA
 13089             MOVE -1             TO REPORTL
 13090             MOVE ER-0223        TO EMI-ERROR
 13091             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13092         ELSE
 13093             MOVE AL-UANON       TO REPORTA
 13094             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 13095             MOVE DC-BIN-DATE-1  TO WS-REPORT
 13096             IF WS-REPORT GREATER THAN WS-TODAY-DT
 13097                 MOVE ER-0512     TO EMI-ERROR
 13098                 MOVE -1          TO REPORTL
 13099                 MOVE AL-UABON    TO REPORTA
 13100                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13101             ELSE
 13102*                NEXT SENTENCE
 13103                 CONTINUE
 13104             END-IF
 13105         END-IF
 13106     ELSE
 13107         MOVE ER-0517         TO EMI-ERROR
 13108         MOVE -1              TO REPORTL
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 248
* EL130.cbl
 13109         MOVE AL-UABON        TO REPORTA
 13110         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13111     END-IF.
 13112
 13113     IF WS-REPORT NOT = LOW-VALUES
 13114         IF WS-INCUR GREATER THAN WS-REPORT
 13115             MOVE AL-UABON       TO REPORTA
 13116             MOVE -1             TO REPORTL
 13117             MOVE ER-0509        TO EMI-ERROR
 13118             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13119         END-IF
 13120     END-IF.
 13121
 13122     IF ICD1L GREATER THAN ZERO
 13123         IF (ICD1I GREATER THAN SPACES) AND
 13124            (ICD1I(4:1) NOT = '.')
 13125             IF ICD1I(4:1) = ' '
 13126                 MOVE '.' TO ICD1I(4:1)
 13127             ELSE
 13128                 IF ICD1I(8:1) = ' '
 13129                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 13130                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 13131                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 13132                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 13133                     MOVE '.'        TO ICD1I(4:1)
 13134                 END-IF
 13135             END-IF
 13136         END-IF
 13137         IF (ICD1I GREATER THAN SPACES) AND
 13138            (ICD1I(1:1) NOT > ' ' OR
 13139             ICD1I(2:1) NOT > ' ' OR
 13140             ICD1I(3:1) NOT > ' ' OR
 13141             ICD1I(4:1) NOT = '.')
 13142              MOVE ER-0992        TO  EMI-ERROR
 13143              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13144              MOVE AL-UABON       TO ICD1A
 13145              MOVE -1             TO ICD1L
 13146         END-IF
 13147     END-IF.
 13148
 13149     IF ICD2L GREATER THAN ZERO
 13150         IF (ICD2I GREATER THAN SPACES) AND
 13151            (ICD2I(4:1) NOT = '.')
 13152             IF ICD2I(4:1) = ' '
 13153                 MOVE '.' TO ICD2I(4:1)
 13154             ELSE
 13155                 IF ICD2I(8:1) = ' '
 13156                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 13157                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 13158                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 13159                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 13160                     MOVE '.'        TO ICD2I(4:1)
 13161                 END-IF
 13162             END-IF
 13163         END-IF
 13164         IF (ICD2I GREATER THAN SPACES) AND
 13165            (ICD2I(1:1) NOT > ' ' OR
 13166             ICD2I(2:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 249
* EL130.cbl
 13167             ICD2I(3:1) NOT > ' ' OR
 13168             ICD2I(4:1) NOT = '.')
 13169              MOVE ER-0992        TO  EMI-ERROR
 13170              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13171              MOVE AL-UABON       TO ICD2A
 13172              MOVE -1             TO ICD2L
 13173         END-IF
 13174     END-IF
 13175
 13176*    IF ESTENDL GREATER ZERO
 13177*        MOVE ESTENDI            TO DATE-WORK
 13178*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13179*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13180*        MOVE '4'                TO DC-OPTION-CODE
 13181*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13182*        IF DATE-CONVERSION-ERROR
 13183*            MOVE AL-UABON       TO ESTENDA
 13184*            MOVE -1             TO ESTENDL
 13185*            MOVE ER-0224        TO EMI-ERROR
 13186*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13187*        ELSE
 13188*            MOVE AL-UANON       TO ESTENDA
 13189*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 13190*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 13191*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13192*               MOVE AL-UABON    TO ESTENDA
 13193*               MOVE -1          TO ESTENDL
 13194*               MOVE ER-0544     TO EMI-ERROR
 13195*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13196*            END-IF
 13197*        END-IF
 13198*    END-IF.
 13199*
 13200*    IF WS-ESTEND NOT = LOW-VALUES
 13201*        IF WS-INCUR GREATER THAN WS-ESTEND
 13202*            MOVE AL-UABON       TO ESTENDA
 13203*            MOVE -1             TO ESTENDL
 13204*            MOVE ER-0510        TO EMI-ERROR
 13205*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13206*        END-IF
 13207*    END-IF.
 13208
 13209     IF PRTOPTL GREATER ZERO
 13210         IF PRTOPTI NOT = 'N' AND 'L'
 13211             MOVE AL-UABON       TO PRTOPTA
 13212             MOVE -1             TO PRTOPTL
 13213             MOVE ER-0334        TO EMI-ERROR
 13214             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13215         END-IF
 13216     END-IF.
 13217
 13218     IF MANRSVL GREATER ZERO
 13219
 13220* EXEC CICS BIF DEEDIT
 13221*            FIELD   (MANRSVI)
 13222*            LENGTH  (9)
 13223*        END-EXEC
 13224     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 250
* EL130.cbl
 13225       TO DFHEIV11
 13226*    MOVE '@"L                   #   #00012058' TO DFHEIV0
 13227     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13228     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13229     MOVE X'2020233030303132303538' TO DFHEIV0(25:11)
 13230     CALL 'kxdfhei1' USING DFHEIV0,
 13231           MANRSVI,
 13232           DFHEIV11
 13233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13234         IF MANRSVI NOT NUMERIC
 13235             MOVE AL-UNBON       TO MANRSVA
 13236             MOVE -1             TO MANRSVL
 13237             MOVE ER-0489        TO EMI-ERROR
 13238             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13239         ELSE
 13240             MOVE AL-UNNON       TO MANRSVA
 13241             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 13242         END-IF
 13243     END-IF.
 13244
 13245     MOVE SPACES                 TO ELCNTL-KEY.
 13246
 13247     IF CONTROL-IS-ACTUAL-CARRIER
 13248         MOVE PI-CARRIER         TO CNTL-CARRIER
 13249     ELSE
 13250         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 13251     END-IF.
 13252
 13253     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13254     MOVE '6'                    TO CNTL-REC-TYPE.
 13255     MOVE +0                     TO CNTL-SEQ-NO.
 13256
 13257
 13258
 13259* EXEC CICS HANDLE CONDITION
 13260*        NOTFND   (3100-CARRIER-NOT-FOUND)
 13261*    END-EXEC.
 13262*    MOVE '"$I                   ! @ #00012086' TO DFHEIV0
 13263     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13265     MOVE X'4020233030303132303836' TO DFHEIV0(25:11)
 13266     CALL 'kxdfhei1' USING DFHEIV0
 13267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13268
 13269
 13270     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13271
 13272     IF NOT CF-MANUAL-RESERVES-USED AND
 13273           WS-MANRSV GREATER ZERO
 13274         MOVE ER-0518             TO EMI-ERROR
 13275         MOVE -1                  TO MANRSVL
 13276         MOVE AL-UNBON            TO MANRSVA
 13277         MOVE ZEROS               TO WS-MANRSV
 13278         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13279     END-IF.
 13280
 13281     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 13282     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 251
* EL130.cbl
 13283
 13284     IF SUPVL GREATER ZERO
 13285         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 13286             MOVE -1             TO SUPVL
 13287             MOVE AL-UABON       TO SUPVA
 13288             MOVE ER-0230        TO EMI-ERROR
 13289             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13290         ELSE
 13291             MOVE AL-UANON       TO SUPVA
 13292         END-IF
 13293     END-IF.
 13294
 13295     IF PROCCDL = ZERO
 13296        GO TO 6050-CONTINUE-EDITS
 13297     END-IF.
 13298
 13299     MOVE SPACES                 TO ELCNTL-KEY.
 13300     MOVE PROCCDI                TO CNTL-ACCESS.
 13301
 13302     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13303     MOVE '2'                    TO CNTL-REC-TYPE.
 13304     MOVE +0                     TO CNTL-SEQ-NO.
 13305
 13306
 13307
 13308* EXEC CICS HANDLE CONDITION
 13309*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 13310*    END-EXEC.
 13311*    MOVE '"$I                   ! A #00012127' TO DFHEIV0
 13312     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13313     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13314     MOVE X'4120233030303132313237' TO DFHEIV0(25:11)
 13315     CALL 'kxdfhei1' USING DFHEIV0
 13316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13317
 13318
 13319     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13320
 13321     GO TO 6050-CONTINUE-EDITS.
 13322
 13323 6040-NO-PROCESSOR-RECORD.
 13324     MOVE ER-0019                TO EMI-ERROR.
 13325     MOVE -1                     TO PROCCDL.
 13326     MOVE AL-UABON               TO PROCCDA.
 13327     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13328
 13329 6050-CONTINUE-EDITS.
 13330     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 13331           GO TO 6070-CONTINUE-EDITS
 13332     END-IF.
 13333
 13334     MOVE BENECDI                TO BENE-CODE.
 13335     MOVE 'B'                    TO BENE-RCD-TYPE.
 13336     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 13337
 13338
 13339
 13340* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 252
* EL130.cbl
 13341*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 13342*    END-EXEC.
 13343*    MOVE '"$I                   ! B #00012151' TO DFHEIV0
 13344     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13345     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13346     MOVE X'4220233030303132313531' TO DFHEIV0(25:11)
 13347     CALL 'kxdfhei1' USING DFHEIV0
 13348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13349
 13350
 13351
 13352* EXEC CICS READ
 13353*         DATASET   (ELBENE-DSID)
 13354*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13355*         RIDFLD    (ELBENE-KEY)
 13356*    END-EXEC.
 13357*    MOVE '&"S        E          (   #00012155' TO DFHEIV0
 13358     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13360     MOVE X'2020233030303132313535' TO DFHEIV0(25:11)
 13361     CALL 'kxdfhei1' USING DFHEIV0,
 13362           ELBENE-DSID,
 13363           DFHEIV20,
 13364           DFHEIV99,
 13365           ELBENE-KEY,
 13366           DFHEIV99,
 13367           DFHEIV99,
 13368           DFHEIV99
 13369     SET ADDRESS OF BENEFICIARY-MASTER TO
 13370         DFHEIV20
 13371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13372
 13373
 13374     GO TO 6070-CONTINUE-EDITS.
 13375
 13376 6060-NO-BENEFICIARY-RECORD.
 13377     MOVE ER-0565                TO EMI-ERROR.
 13378     MOVE -1                     TO BENECDL.
 13379     MOVE AL-UABON               TO BENECDA.
 13380     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13381
 13382
 13383 6070-CONTINUE-EDITS.
 13384     IF CERTMTL GREATER ZERO
 13385         IF CERTMTI NOT = 'A' AND 'S'
 13386             MOVE -1             TO CERTMTL
 13387             MOVE AL-UABON       TO CERTMTA
 13388             MOVE ER-0267        TO EMI-ERROR
 13389             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13390         ELSE
 13391             MOVE AL-UANON       TO CERTMTA
 13392         END-IF
 13393     ELSE
 13394         GO TO 6000-EXIT
 13395     END-IF.
 13396
 13397     IF EFFDTL GREATER ZERO
 13398         MOVE EFFDTI             TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 253
* EL130.cbl
 13399         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13400         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13401         MOVE '4'                TO DC-OPTION-CODE
 13402         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13403         IF DATE-CONVERSION-ERROR
 13404             MOVE AL-UABON       TO EFFDTA
 13405             MOVE -1             TO EFFDTL
 13406             MOVE ER-0231        TO EMI-ERROR
 13407             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13408         ELSE
 13409             MOVE AL-UANON       TO EFFDTA
 13410             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13411             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13412         END-IF
 13413     ELSE
 13414         MOVE ER-0231            TO EMI-ERROR
 13415         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13416         MOVE -1                 TO EFFDTL
 13417         MOVE AL-UABON           TO EFFDTA
 13418     END-IF.
 13419
 13420     IF ACCOUNTL = ZERO
 13421         MOVE ER-0232            TO EMI-ERROR
 13422         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13423         MOVE AL-UABON           TO ACCOUNTA
 13424         MOVE -1                 TO ACCOUNTL
 13425     ELSE
 13426         MOVE AL-UANON           TO ACCOUNTA
 13427     END-IF.
 13428
 13429     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13430        (STATEL = ZERO)
 13431         MOVE ER-0233        TO EMI-ERROR
 13432         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13433         MOVE AL-UABON       TO STATEA
 13434         MOVE -1             TO STATEL
 13435     ELSE
 13436         MOVE AL-UANON       TO STATEA
 13437     END-IF.
 13438
 13439     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13440        (CRTCARRL = ZERO)
 13441         MOVE ER-0234        TO EMI-ERROR
 13442         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13443         MOVE AL-UABON       TO CRTCARRA
 13444         MOVE -1             TO CRTCARRL
 13445     ELSE
 13446         MOVE AL-UANON       TO CRTCARRA
 13447     END-IF.
 13448
 13449     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13450        GROUPL = ZERO
 13451         MOVE ER-0235            TO EMI-ERROR
 13452         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13453         MOVE AL-UABON           TO GROUPA
 13454         MOVE -1                 TO GROUPL
 13455     ELSE
 13456         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 254
* EL130.cbl
 13457     END-IF.
 13458
 13459     IF CRTLNMEL = ZERO
 13460         IF LSTNMEI = SPACES OR LOW-VALUES
 13461             MOVE ER-0236            TO  EMI-ERROR
 13462             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13463             MOVE AL-UABON           TO  CRTLNMEA
 13464             MOVE -1                 TO  CRTLNMEL
 13465         ELSE
 13466             MOVE LSTNMEI            TO  CRTLNMEI
 13467             MOVE AL-UANON           TO  CRTLNMEA
 13468         END-IF
 13469     ELSE
 13470         MOVE AL-UANON               TO  CRTLNMEA
 13471     END-IF.
 13472
 13473     IF CRTFNMEL = ZERO
 13474         IF FSTNMEI = SPACES OR LOW-VALUES
 13475*            NEXT SENTENCE
 13476             CONTINUE
 13477         ELSE
 13478             MOVE FSTNMEI            TO  CRTFNMEI
 13479             MOVE AL-UANON           TO  CRTFNMEA
 13480         END-IF
 13481     END-IF.
 13482
 13483     IF CRTINITL = ZERO
 13484         IF INITI = SPACES OR LOW-VALUES
 13485*            NEXT SENTENCE
 13486             CONTINUE
 13487         ELSE
 13488             MOVE INITI              TO  CRTINITI
 13489             MOVE AL-UANON           TO  CRTINITA
 13490         END-IF
 13491     END-IF.
 13492
 13493 6000-EXIT.
 13494     EXIT.
 13495
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 255
* EL130.cbl
 13497 6200-EDIT-CERT-DATA.
 13498     IF ISSAGEL GREATER ZERO
 13499         IF ISSAGEI NOT NUMERIC
 13500             MOVE ER-0237        TO EMI-ERROR
 13501             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13502             MOVE -1             TO ISSAGEL
 13503             MOVE AL-UNBON       TO ISSAGEA
 13504         ELSE
 13505             MOVE AL-UNNON       TO ISSAGEA
 13506         END-IF
 13507     END-IF.
 13508
 13509     IF JNTAGEL GREATER ZERO
 13510         IF JNTAGEI NOT NUMERIC
 13511             MOVE ER-0238        TO EMI-ERROR
 13512             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13513             MOVE -1             TO JNTAGEL
 13514             MOVE AL-UNBON       TO JNTAGEA
 13515         ELSE
 13516             MOVE AL-UNNON       TO JNTAGEA
 13517         END-IF
 13518     END-IF.
 13519
 13520     IF LCVCDL GREATER ZERO
 13521         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13522         IF INVALID-BENEFIT-CODE
 13523             MOVE ER-7635        TO EMI-ERROR
 13524             MOVE -1             TO LCVCDL
 13525             MOVE AL-UABON       TO LCVCDA
 13526             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13527         ELSE
 13528             MOVE LCVCDI         TO WS-BEN-HOLD
 13529             MOVE '4'            TO WS-REC-TYPE
 13530             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13531             IF WS-BEN-ALPHA-HOLD = SPACES
 13532                MOVE ER-7635     TO EMI-ERROR
 13533                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13534                MOVE -1          TO LCVCDL
 13535                MOVE AL-UABON    TO LCVCDA
 13536             ELSE
 13537                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13538                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13539                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13540                MOVE AL-UANON           TO LCVCDA
 13541             END-IF
 13542         END-IF
 13543     END-IF.
 13544
 13545     IF ACVCDL GREATER ZERO
 13546         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13547         IF INVALID-BENEFIT-CODE
 13548             MOVE ER-7635        TO EMI-ERROR
 13549             MOVE -1             TO ACVCDL
 13550             MOVE AL-UABON       TO ACVCDA
 13551             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13552         ELSE
 13553             MOVE ACVCDI         TO WS-BEN-HOLD
 13554             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 256
* EL130.cbl
 13555             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13556             IF WS-BEN-ALPHA-HOLD = SPACES
 13557                MOVE ER-7635     TO EMI-ERROR
 13558                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13559                MOVE -1          TO ACVCDL
 13560                MOVE AL-UABON    TO ACVCDA
 13561             ELSE
 13562                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13563                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13564                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13565                MOVE AL-UANON           TO ACVCDA
 13566             END-IF
 13567         END-IF
 13568     END-IF.
 13569
 13570     IF LCVOTRML GREATER ZERO
 13571         IF LCVOTRMI NOT NUMERIC
 13572             MOVE ER-7636        TO EMI-ERROR
 13573             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13574             MOVE -1             TO LCVOTRML
 13575             MOVE AL-UNBON       TO LCVOTRMA
 13576         ELSE
 13577             MOVE AL-UNNON       TO LCVOTRMA
 13578         END-IF
 13579     END-IF.
 13580
 13581     IF ACVOTRML GREATER ZERO
 13582         IF ACVOTRMI NOT NUMERIC
 13583             MOVE ER-7636        TO EMI-ERROR
 13584             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13585             MOVE -1             TO ACVOTRML
 13586             MOVE AL-UNBON       TO ACVOTRMA
 13587         ELSE
 13588             MOVE AL-UNNON       TO ACVOTRMA
 13589         END-IF
 13590     END-IF.
 13591
 13592     IF LCVRATEL GREATER ZERO
 13593
 13594* EXEC CICS BIF DEEDIT
 13595*            FIELD    (LCVRATEI)
 13596*            LENGTH   (06)
 13597*        END-EXEC
 13598     MOVE 06
 13599       TO DFHEIV11
 13600*    MOVE '@"L                   #   #00012380' TO DFHEIV0
 13601     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13602     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13603     MOVE X'2020233030303132333830' TO DFHEIV0(25:11)
 13604     CALL 'kxdfhei1' USING DFHEIV0,
 13605           LCVRATEI,
 13606           DFHEIV11
 13607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13608         IF LCVRATEI NOT NUMERIC
 13609             MOVE AL-UNBON       TO LCVRATEA
 13610             MOVE -1             TO LCVRATEL
 13611             MOVE ER-2280        TO EMI-ERROR
 13612             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 257
* EL130.cbl
 13613         ELSE
 13614             MOVE AL-UNNON       TO LCVRATEA
 13615             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13616         END-IF
 13617     END-IF.
 13618
 13619     IF ACVRATEL GREATER ZERO
 13620
 13621* EXEC CICS BIF DEEDIT
 13622*            FIELD    (ACVRATEI)
 13623*            LENGTH   (06)
 13624*        END-EXEC
 13625     MOVE 06
 13626       TO DFHEIV11
 13627*    MOVE '@"L                   #   #00012396' TO DFHEIV0
 13628     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13629     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13630     MOVE X'2020233030303132333936' TO DFHEIV0(25:11)
 13631     CALL 'kxdfhei1' USING DFHEIV0,
 13632           ACVRATEI,
 13633           DFHEIV11
 13634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13635         IF ACVRATEI NOT NUMERIC
 13636             MOVE AL-UNBON       TO ACVRATEA
 13637             MOVE -1             TO ACVRATEL
 13638             MOVE ER-2280        TO EMI-ERROR
 13639             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13640         ELSE
 13641             MOVE AL-UNNON       TO ACVRATEA
 13642             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13643         END-IF
 13644     END-IF.
 13645
 13646     IF LCVBENEL GREATER ZERO
 13647
 13648* EXEC CICS BIF DEEDIT
 13649*            FIELD    (LCVBENEI)
 13650*            LENGTH   (11)
 13651*        END-EXEC
 13652     MOVE 11
 13653       TO DFHEIV11
 13654*    MOVE '@"L                   #   #00012412' TO DFHEIV0
 13655     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13656     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13657     MOVE X'2020233030303132343132' TO DFHEIV0(25:11)
 13658     CALL 'kxdfhei1' USING DFHEIV0,
 13659           LCVBENEI,
 13660           DFHEIV11
 13661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13662         IF LCVBENEI NOT NUMERIC
 13663             MOVE AL-UNBON       TO LCVBENEA
 13664             MOVE -1             TO LCVBENEL
 13665             MOVE ER-7637        TO EMI-ERROR
 13666             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13667         ELSE
 13668             MOVE AL-UNNON       TO LCVBENEA
 13669             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13670         END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 258
* EL130.cbl
 13671     END-IF.
 13672
 13673     IF ACVBENEL GREATER ZERO
 13674
 13675* EXEC CICS BIF DEEDIT
 13676*            FIELD    (ACVBENEI)
 13677*            LENGTH   (11)
 13678*        END-EXEC
 13679     MOVE 11
 13680       TO DFHEIV11
 13681*    MOVE '@"L                   #   #00012428' TO DFHEIV0
 13682     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13683     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13684     MOVE X'2020233030303132343238' TO DFHEIV0(25:11)
 13685     CALL 'kxdfhei1' USING DFHEIV0,
 13686           ACVBENEI,
 13687           DFHEIV11
 13688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13689         IF ACVBENEI NOT NUMERIC
 13690             MOVE AL-UNBON       TO ACVBENEA
 13691             MOVE -1             TO ACVBENEL
 13692             MOVE ER-7637        TO EMI-ERROR
 13693             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13694         ELSE
 13695             MOVE AL-UNNON       TO ACVBENEA
 13696             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13697         END-IF
 13698     END-IF.
 13699
 13700     IF LCVCNDTL GREATER ZERO
 13701         IF LCVCNDTI NOT = SPACES
 13702             MOVE LCVCNDTI        TO DATE-WORK
 13703             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13704             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13705             MOVE '4'             TO DC-OPTION-CODE
 13706             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13707             IF DATE-CONVERSION-ERROR
 13708                 MOVE AL-UABON    TO LCVCNDTA
 13709                 MOVE -1          TO LCVCNDTL
 13710                 MOVE ER-7638     TO EMI-ERROR
 13711                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13712             ELSE
 13713                 MOVE AL-UANON    TO LCVCNDTA
 13714                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13715                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13716             END-IF
 13717         END-IF
 13718     END-IF.
 13719
 13720     IF ACVCNDTL GREATER ZERO
 13721         IF ACVCNDTI NOT = SPACES
 13722             MOVE ACVCNDTI        TO DATE-WORK
 13723             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13724             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13725             MOVE '4'             TO DC-OPTION-CODE
 13726             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13727             IF DATE-CONVERSION-ERROR
 13728                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 259
* EL130.cbl
 13729                 MOVE -1          TO ACVCNDTL
 13730                 MOVE ER-7638     TO EMI-ERROR
 13731                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13732             ELSE
 13733                 MOVE AL-UANON    TO ACVCNDTA
 13734                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13735                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13736             END-IF
 13737         END-IF
 13738     END-IF.
 13739
 13740     IF ADDONDTL GREATER ZERO
 13741         MOVE ADDONDTI        TO DATE-WORK
 13742         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13743         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13744         MOVE '4'             TO DC-OPTION-CODE
 13745         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13746         IF DATE-CONVERSION-ERROR
 13747             MOVE AL-UABON    TO ADDONDTA
 13748             MOVE -1          TO ADDONDTL
 13749             MOVE ER-7651     TO EMI-ERROR
 13750             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13751         ELSE
 13752             MOVE AL-UANON    TO ADDONDTA
 13753             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13754             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13755         END-IF
 13756     END-IF.
 13757
 13758     IF APRL GREATER ZERO
 13759
 13760* EXEC CICS BIF DEEDIT
 13761*            FIELD    (APRI)
 13762*            LENGTH   (8)
 13763*        END-EXEC
 13764     MOVE 8
 13765       TO DFHEIV11
 13766*    MOVE '@"L                   #   #00012502' TO DFHEIV0
 13767     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13768     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13769     MOVE X'2020233030303132353032' TO DFHEIV0(25:11)
 13770     CALL 'kxdfhei1' USING DFHEIV0,
 13771           APRI,
 13772           DFHEIV11
 13773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13774         IF APRI NOT NUMERIC
 13775             MOVE AL-UNBON       TO APRA
 13776             MOVE -1             TO APRL
 13777             MOVE ER-0248        TO EMI-ERROR
 13778             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13779         ELSE
 13780             MOVE AL-UNNON       TO APRA
 13781             MOVE APRI           TO WS-APR APRO
 13782         END-IF
 13783     END-IF.
 13784
 13785     IF PMTFREQL GREATER ZERO
 13786
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 260
* EL130.cbl
 13787* EXEC CICS BIF DEEDIT
 13788*            FIELD   (PMTFREQI)
 13789*            LENGTH  (2)
 13790*        END-EXEC
 13791     MOVE 2
 13792       TO DFHEIV11
 13793*    MOVE '@"L                   #   #00012518' TO DFHEIV0
 13794     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13795     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13796     MOVE X'2020233030303132353138' TO DFHEIV0(25:11)
 13797     CALL 'kxdfhei1' USING DFHEIV0,
 13798           PMTFREQI,
 13799           DFHEIV11
 13800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13801         IF PMTFREQI NOT NUMERIC
 13802             MOVE -1             TO PMTFREQL
 13803             MOVE AL-UNBON       TO PMTFREQA
 13804             MOVE ER-0258        TO EMI-ERROR
 13805             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13806         ELSE
 13807             MOVE AL-UNNON       TO PMTFREQA
 13808             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13809         END-IF
 13810     END-IF.
 13811
 13812     IF INDGRPL GREATER ZERO
 13813         IF INDGRPI = 'I' OR 'G'
 13814             MOVE AL-UANON       TO INDGRPA
 13815         ELSE
 13816             MOVE -1 TO INDGRPL
 13817             MOVE AL-UABON       TO INDGRPA
 13818             MOVE ER-0260        TO EMI-ERROR
 13819             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13820         END-IF
 13821     END-IF.
 13822
 13823     IF LOANBALL GREATER ZERO
 13824         MOVE LOANBALI           TO DEEDIT-FIELD
 13825
 13826* EXEC CICS BIF DEEDIT
 13827*            FIELD   (DEEDIT-FIELD)
 13828*            LENGTH  (12)
 13829*        END-EXEC
 13830     MOVE 12
 13831       TO DFHEIV11
 13832*    MOVE '@"L                   #   #00012546' TO DFHEIV0
 13833     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13834     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13835     MOVE X'2020233030303132353436' TO DFHEIV0(25:11)
 13836     CALL 'kxdfhei1' USING DFHEIV0,
 13837           DEEDIT-FIELD,
 13838           DFHEIV11
 13839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13840         IF DEEDIT-FIELD NOT NUMERIC
 13841             MOVE AL-UNBON       TO LOANBALA
 13842             MOVE -1             TO LOANBALL
 13843             MOVE ER-0247        TO EMI-ERROR
 13844             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 261
* EL130.cbl
 13845         ELSE
 13846             MOVE AL-UNNON       TO LOANBALA
 13847             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13848         END-IF
 13849     END-IF.
 13850
 13851     IF PREMTYPL GREATER ZERO
 13852         IF (PREMTYPI = '1' OR '2' OR '3')
 13853             MOVE AL-UANON       TO PREMTYPA
 13854         ELSE
 13855             MOVE -1             TO PREMTYPL
 13856             MOVE AL-UABON       TO PREMTYPA
 13857             MOVE ER-0227        TO EMI-ERROR
 13858             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13859         END-IF
 13860     END-IF.
 13861
 13862     IF REINCDL GREATER ZERO
 13863         MOVE LOW-VALUES         TO  ERREIN-KEY
 13864         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13865         MOVE REINCDI            TO  REIN-CODE-1
 13866                                     REIN-CODE-2
 13867                                     REIN-CODE-3
 13868         MOVE 'A'                TO  REIN-TYPE
 13869         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13870         IF REIN-REC-NOT-FOUND
 13871             MOVE ER-0266        TO  EMI-ERROR
 13872             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13873             MOVE -1             TO  REINCDL
 13874             MOVE AL-UABON       TO  REINCDA
 13875         ELSE
 13876             MOVE AL-UANON       TO  REINCDA
 13877         END-IF
 13878     END-IF.
 13879
 13880     IF CERTMTI NOT = 'A'
 13881        GO TO 6200-EXIT
 13882     END-IF.
 13883
 13884     IF PREMTYPI = '1'
 13885         IF LCVCDL GREATER ZERO
 13886             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13887                 MOVE ER-0841        TO  EMI-ERROR
 13888                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13889                 MOVE -1             TO  PREMTYPL
 13890                 MOVE AL-UABON       TO  PREMTYPA
 13891             END-IF
 13892         END-IF
 13893     END-IF.
 13894
 13895     IF PREMTYPI = '1'
 13896         IF ACVCDL GREATER ZERO
 13897             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13898                 MOVE ER-0841        TO  EMI-ERROR
 13899                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13900                 MOVE -1             TO  PREMTYPL
 13901                 MOVE AL-UABON       TO  PREMTYPA
 13902             END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 262
* EL130.cbl
 13903         END-IF
 13904     END-IF.
 13905
 13906     IF PREMTYPI = '2'
 13907         IF LCVCDL GREATER ZERO
 13908             IF (PI-COMPANY-ID = 'HAN') AND
 13909                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13910                        OR
 13911                 WS-LF-SPECIAL-CALC-CD = 'O'
 13912*                NEXT SENTENCE
 13913                 CONTINUE
 13914             ELSE
 13915                 MOVE ER-0840        TO  EMI-ERROR
 13916                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13917                 MOVE -1             TO  PREMTYPL
 13918                 MOVE AL-UABON       TO  PREMTYPA
 13919             END-IF
 13920         END-IF
 13921     END-IF.
 13922
 13923     IF PREMTYPI = '2'
 13924         IF ACVCDL GREATER ZERO
 13925             IF (PI-COMPANY-ID = 'HAN')  AND
 13926                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13927                        OR
 13928                 WS-AH-SPECIAL-CALC-CD = 'O'
 13929*                NEXT SENTENCE
 13930                 CONTINUE
 13931             ELSE
 13932                 MOVE ER-0840        TO  EMI-ERROR
 13933                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13934                 MOVE -1             TO  PREMTYPL
 13935                 MOVE AL-UABON       TO  PREMTYPA
 13936             END-IF
 13937         END-IF
 13938     END-IF.
 13939
 13940     IF LCVCDL = ZEROS
 13941        GO TO 6200-EXIT
 13942     END-IF.
 13943
 13944     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 13945         IF PMTFREQI NOT = ZEROS
 13946             MOVE ER-0428        TO EMI-ERROR
 13947             MOVE -1             TO PMTFREQL
 13948             MOVE AL-UNBON       TO PMTFREQA
 13949             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13950             GO TO 6200-CHECK-APR
 13951         END-IF
 13952     END-IF.
 13953
 13954     IF PMTFREQL = ZEROS AND TEX-REG
 13955         MOVE ER-0429            TO EMI-ERROR
 13956         MOVE -1                 TO PMTFREQL
 13957         MOVE AL-UNBON           TO PMTFREQA
 13958         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13959         GO TO 6200-CHECK-APR
 13960     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 263
* EL130.cbl
 13961
 13962     IF LCVOTRMI NOT NUMERIC
 13963         GO TO 6200-CHECK-APR
 13964     END-IF.
 13965
 13966     IF WS-PMTFREQ NOT = ZERO
 13967         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 13968         GIVING DIVIDE-QUOT
 13969         REMAINDER DIVIDE-REM
 13970         IF DIVIDE-REM GREATER ZERO
 13971             MOVE ER-0430            TO EMI-ERROR
 13972             MOVE -1                 TO PMTFREQL
 13973             MOVE AL-UNBON           TO PMTFREQA
 13974             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13975         END-IF
 13976     END-IF.
 13977
 13978 6200-CHECK-APR.
 13979     IF NET-PAY AND APRL = ZEROS
 13980        MOVE ER-0257             TO EMI-ERROR
 13981        MOVE -1                  TO APRL
 13982        MOVE AL-UABON            TO APRA
 13983        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13984     END-IF.
 13985
 13986 6200-EXIT.
 13987     EXIT.
 13988
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 264
* EL130.cbl
 13990 6300-REQUIRED-CERT-EDIT.
 13991
 13992     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 13993        GO TO 6300-REQUIRED-AH-EDIT
 13994     END-IF
 13995
 13996     IF LCVCDL = ZERO
 13997        MOVE ER-7639             TO EMI-ERROR
 13998        MOVE -1                  TO LCVCDL
 13999        MOVE AL-UABON            TO LCVCDA
 14000        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14001     END-IF.
 14002
 14003     IF LCVOTRML = ZERO
 14004        MOVE ER-7670             TO EMI-ERROR
 14005        MOVE -1                  TO LCVOTRML
 14006        MOVE AL-UNBON            TO LCVOTRMA
 14007        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14008     END-IF.
 14009
 14010     IF LCVBENEL = ZERO
 14011        MOVE ER-7671             TO EMI-ERROR
 14012        MOVE -1                  TO LCVBENEL
 14013        MOVE AL-UNBON            TO LCVBENEA
 14014        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14015     END-IF.
 14016
 14017     GO TO 6399-EXIT.
 14018
 14019 6300-REQUIRED-AH-EDIT.
 14020
 14021     IF ACVCDL = ZERO
 14022        MOVE ER-7639             TO EMI-ERROR
 14023        MOVE -1                  TO ACVCDL
 14024        MOVE AL-UABON            TO ACVCDA
 14025        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14026     END-IF.
 14027
 14028     IF ACVOTRML = ZERO
 14029         MOVE ER-7670             TO EMI-ERROR
 14030         MOVE -1                  TO ACVOTRML
 14031         MOVE AL-UNBON            TO ACVOTRMA
 14032         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14033     END-IF.
 14034
 14035     IF ACVBENEL = ZERO
 14036        MOVE ER-7671             TO EMI-ERROR
 14037        MOVE -1                  TO ACVBENEL
 14038        MOVE AL-UNBON            TO ACVBENEA
 14039        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14040     END-IF.
 14041
 14042 6399-EXIT.
 14043      EXIT.
 14044
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 265
* EL130.cbl
 14046 6400-TEST-CLAIM-REASONABILITY.
 14047
 14048     IF WS-INCUR = LOW-VALUES
 14049        GO TO 6499-EXIT
 14050     END-IF.
 14051
 14052     IF WS-EFFDT NOT = LOW-VALUES
 14053         IF WS-INCUR LESS WS-EFFDT
 14054             MOVE ER-0458          TO EMI-ERROR
 14055             MOVE -1               TO INCURL
 14056             MOVE AL-UABON         TO INCURA
 14057             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14058         END-IF
 14059     END-IF.
 14060
 14061     IF CERTMTI = 'A'
 14062        GO TO 6460-TEST-NEW-CERT
 14063     END-IF.
 14064
 14065     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 14066     MOVE CRTCARRI               TO CERT-CARRIER.
 14067     MOVE GROUPI                 TO CERT-GROUPING.
 14068     MOVE STATEI                 TO CERT-STATE.
 14069     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 14070     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 14071     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 14072
 14073
 14074
 14075* EXEC CICS HANDLE CONDITION
 14076*         DUPKEY   (6499-EXIT)
 14077*         NOTFND   (6499-EXIT)
 14078*    END-EXEC.
 14079*    MOVE '"$$I                  ! C #00012784' TO DFHEIV0
 14080     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 14081     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14082     MOVE X'4320233030303132373834' TO DFHEIV0(25:11)
 14083     CALL 'kxdfhei1' USING DFHEIV0
 14084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14085
 14086
 14087     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 14088
 14089     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 14090        'I' OR 'G' OR 'F')
 14091        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14092     ELSE
 14093        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14094     END-IF.
 14095
 14096     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14097     MOVE '6'                    TO DC-OPTION-CODE.
 14098     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14099
 14100     IF (WS-INCUR GREATER THAN DC-BIN-DATE-2)
 14101        and (dc-elapsed-months > zeros)
 14102        MOVE ER-0519             TO EMI-ERROR
 14103        MOVE -1                  TO INCURL
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 266
* EL130.cbl
 14104        MOVE AL-UABON            TO INCURA
 14105        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14106     END-IF.
 14107
 14108     IF CLMCARRI NOT = CRTCARRI
 14109        MOVE ER-0562             TO EMI-ERROR
 14110        MOVE AL-UABON            TO CLMCARRA
 14111        MOVE -1                  TO CLMCARRL
 14112        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14113     END-IF.
 14114
 14115     if (pi-company-id = 'DCC' OR 'VPP')
 14116        and (ws-dcc-product-code <> spaces)
 14117        continue
 14118     else
 14119      IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F') AND
 14120        CM-AH-BENEFIT-CD = '00')
 14121                  OR
 14122        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14123        CM-LF-BENEFIT-CD = '00')
 14124         MOVE ER-0521         TO EMI-ERROR
 14125         MOVE AL-UABON        TO CLMTYPEA
 14126         MOVE -1              TO CLMTYPEL
 14127         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14128      END-IF
 14129     end-if
 14130*    IF CLMTYPEI = 'I' AND
 14131*       CM-AH-CRITICAL-PERIOD = +0
 14132*        MOVE ER-0521         TO EMI-ERROR
 14133*        MOVE AL-UABON        TO CLMTYPEA
 14134*        MOVE -1              TO CLMTYPEL
 14135*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14136*    END-IF
 14137
 14138*    IF PI-COMPANY-ID = 'CRI'
 14139*        IF MAINTI = 'A'
 14140*            IF CERT-PEND-ISSUE-ERROR  OR
 14141*               CERT-PEND-ISSUE-RETURNED
 14142*                MOVE -1                 TO CERTNOL
 14143*                MOVE AL-UABON           TO CERTNOA
 14144*                MOVE ER-7640            TO EMI-ERROR
 14145*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14146*            END-IF
 14147*        END-IF
 14148*    END-IF.
 14149
 14150     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 14151         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 14152         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 14153             GO TO 6450-DATE-ERROR
 14154         END-IF
 14155     END-IF.
 14156
 14157     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 14158         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 14159         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 14160             GO TO 6450-DATE-ERROR
 14161         END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 267
* EL130.cbl
 14162     END-IF.
 14163
 14164     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14165         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 14166             GO TO 6450-DATE-ERROR
 14167         END-IF
 14168     END-IF.
 14169
 14170     GO TO 6499-EXIT.
 14171
 14172 6450-DATE-ERROR.
 14173     MOVE ER-0520                TO EMI-ERROR.
 14174     MOVE -1                     TO INCURL.
 14175     MOVE AL-UABON               TO INCURA.
 14176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14177
 14178*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 14179*       (EMI-SEVERITY-SAVE = 'X')
 14180*        ADD 1                TO EMI-FORCABLE-CTR
 14181*        SUBTRACT 1 FROM EMI-FATAL-CTR
 14182*    END-IF.
 14183
 14184     GO TO 6499-EXIT.
 14185
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 268
* EL130.cbl
 14187 6460-TEST-NEW-CERT.
 14188
 14189     IF NOT EMI-NO-ERRORS
 14190        GO TO 6499-EXIT
 14191     END-IF.
 14192
 14193     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 14194
 14195     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14196          OR 'F') AND
 14197         ACVOTRML GREATER ZERO)
 14198        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 14199     END-IF.
 14200
 14201     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14202         LCVOTRML GREATER ZERO
 14203        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 14204     END-IF.
 14205
 14206     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 14207
 14208*    IF PI-COMPANY-ID = 'HAN'
 14209*        IF ADDONDTL GREATER ZERO
 14210*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 14211*            IF CLMTYPEI = 'A'
 14212*                IF ACVOTRMI NOT = ZEROS
 14213*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 14214*                ELSE
 14215*                    NEXT SENTENCE
 14216*                    CONTINUE
 14217*                END-IF
 14218*            ELSE
 14219*                IF LCVOTRMI NOT = ZEROS
 14220*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 14221*                END-IF
 14222*            END-IF
 14223*        END-IF
 14224*    END-IF.
 14225
 14226     MOVE '6'                    TO DC-OPTION-CODE.
 14227     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14228
 14229     IF NO-CONVERSION-ERROR
 14230         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 14231     END-IF.
 14232
 14233     IF WS-INCUR GREATER THAN WS-EXPIRE
 14234        MOVE ER-0519             TO EMI-ERROR
 14235        MOVE -1                  TO INCURL
 14236        MOVE AL-UABON            TO INCURA
 14237        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14238     END-IF.
 14239
 14240     IF CLMCARRI NOT = CRTCARRI
 14241        MOVE ER-0562             TO EMI-ERROR
 14242        MOVE AL-UABON            TO CLMCARRA
 14243        MOVE -1                  TO CLMCARRL
 14244        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 269
* EL130.cbl
 14245     END-IF.
 14246
 14247     if (pi-company-id = 'DCC' OR 'VPP')
 14248        and (ws-dcc-product-code <> spaces)
 14249        continue
 14250     else
 14251        IF (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 14252           and (ACVCDL = ZEROS)
 14253           MOVE ER-0521          TO EMI-ERROR
 14254           MOVE AL-UABON         TO CLMTYPEA
 14255           MOVE -1               TO CLMTYPEL
 14256           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14257        END-IF
 14258     end-if
 14259
 14260     if (pi-company-id = 'DCC' OR 'VPP')
 14261        and (ws-dcc-product-code <> spaces)
 14262        continue
 14263     else
 14264        IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 14265           and (LCVCDL = ZEROS)
 14266           MOVE ER-0521          TO EMI-ERROR
 14267           MOVE AL-UABON         TO CLMTYPEA
 14268           MOVE -1               TO CLMTYPEL
 14269           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14270        END-IF
 14271     end-if
 14272
 14273     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14274         IF LCVCNDTL GREATER ZERO
 14275             IF WS-INCUR GREATER THAN WS-LCVCNDT
 14276                 GO TO 6450-DATE-ERROR
 14277             END-IF
 14278         END-IF
 14279     END-IF.
 14280
 14281     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14282         IF ACVCNDTL GREATER ZERO
 14283             IF WS-INCUR GREATER THAN WS-ACVCNDT
 14284                 GO TO 6450-DATE-ERROR
 14285             END-IF
 14286         END-IF
 14287     END-IF.
 14288
 14289 6499-EXIT.
 14290     EXIT.
 14291 6500-get-acct.
 14292
 14293     MOVE SPACES                 TO ERACCT-KEY
 14294                                    ws-dcc-product-code
 14295                                    ws-acct-found-sw
 14296
 14297     IF CARR-GROUP-ST-ACCNT-CNTL
 14298        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 14299        MOVE CRTCARRI            TO ACCT-CARRIER
 14300        MOVE GROUPI              TO ACCT-GROUPING
 14301        MOVE STATEI              TO ACCT-STATE
 14302        MOVE ACCOUNTI            TO ACCT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 270
* EL130.cbl
 14303        GO TO 6500-startbr
 14304     END-IF
 14305
 14306     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 14307     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 14308
 14309     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 14310        MOVE STATEI             TO ACCT-STATE
 14311     END-IF
 14312
 14313     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 14314        MOVE CRTCARRI           TO ACCT-CARRIER
 14315     END-IF
 14316
 14317     .
 14318 6500-startbr.
 14319
 14320     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 14321
 14322
 14323* EXEC CICS STARTBR
 14324*       DATASET     (ERACCT2-DSID)
 14325*       RIDFLD      (SAVE-ERACCT-KEY)
 14326*       GENERIC
 14327*       KEYLENGTH   (20)
 14328*       resp        (ws-response)
 14329*    END-EXEC
 14330     MOVE 20
 14331       TO DFHEIV11
 14332     MOVE 0
 14333       TO DFHEIV12
 14334*    MOVE '&,   KG    G          &  N#00013024' TO DFHEIV0
 14335     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 14336     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14337     MOVE X'204E233030303133303234' TO DFHEIV0(25:11)
 14338     CALL 'kxdfhei1' USING DFHEIV0,
 14339           ERACCT2-DSID,
 14340           SAVE-ERACCT-KEY,
 14341           DFHEIV11,
 14342           DFHEIV12,
 14343           DFHEIV99
 14344     MOVE EIBRESP  TO ws-response
 14345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14346
 14347     if not ws-resp-normal
 14348        go to 6500-exit
 14349     end-if
 14350
 14351     .
 14352 6500-readnext.
 14353
 14354
 14355* EXEC CICS READNEXT
 14356*       DATASET   (ERACCT2-DSID)
 14357*       SET       (ADDRESS OF ACCOUNT-MASTER)
 14358*       RIDFLD    (SAVE-ERACCT-KEY)
 14359*    END-EXEC
 14360     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 271
* EL130.cbl
 14361       TO DFHEIV11
 14362*    MOVE '&.S                   )   #00013039' TO DFHEIV0
 14363     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14364     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14365     MOVE X'2020233030303133303339' TO DFHEIV0(25:11)
 14366     CALL 'kxdfhei1' USING DFHEIV0,
 14367           ERACCT2-DSID,
 14368           DFHEIV20,
 14369           DFHEIV99,
 14370           SAVE-ERACCT-KEY,
 14371           DFHEIV99,
 14372           DFHEIV11,
 14373           DFHEIV99,
 14374           DFHEIV99
 14375     SET ADDRESS OF ACCOUNT-MASTER TO
 14376         DFHEIV20
 14377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14378
 14379     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14380        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14381        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14382        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14383        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14384        go to 6500-endbr
 14385     END-IF
 14386
 14387     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14388        and (WS-EFFDT < AM-EXPIRATION-DT)
 14389        set acct-found to true
 14390        MOVE AM-dcc-product-code to ws-dcc-product-code
 14391        GO TO 6500-endbr
 14392     END-IF
 14393
 14394     IF WS-EFFDT >= AM-EXPIRATION-DT
 14395         GO TO 6500-readnext
 14396     END-IF
 14397
 14398     .
 14399 6500-endbr.
 14400
 14401
 14402* EXEC CICS ENDBR
 14403*        DATASET    (ERACCT2-DSID)
 14404*    END-EXEC
 14405     MOVE 0
 14406       TO DFHEIV11
 14407*    MOVE '&2                    $   #00013067' TO DFHEIV0
 14408     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14409     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14410     MOVE X'2020233030303133303637' TO DFHEIV0(25:11)
 14411     CALL 'kxdfhei1' USING DFHEIV0,
 14412           ERACCT2-DSID,
 14413           DFHEIV11,
 14414           DFHEIV99
 14415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14416
 14417     .
 14418 6500-exit.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 272
* EL130.cbl
 14419     exit.
 14420 6600-CHECK-AUTO-ACTIVITY.
 14421
 14422
 14423* EXEC CICS HANDLE CONDITION
 14424*        NOTFND   (6600-NOT-FOUND)
 14425*    END-EXEC.
 14426*    MOVE '"$I                   ! D #00013076' TO DFHEIV0
 14427     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14428     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14429     MOVE X'4420233030303133303736' TO DFHEIV0(25:11)
 14430     CALL 'kxdfhei1' USING DFHEIV0
 14431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14432
 14433
 14434     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14435     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14436     MOVE SPACES                     TO  CNTL-ACCESS.
 14437     MOVE +0                         TO  CNTL-SEQ-NO.
 14438
 14439     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14440
 14441     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14442         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14443                                         WS-LETTER-SW
 14444         GO TO 6600-EXIT
 14445     END-IF.
 14446
 14447     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14448         MOVE 'N'                     TO  WS-LETTER-SW
 14449     ELSE
 14450         MOVE 'Y'                     TO  WS-LETTER-SW
 14451     END-IF.
 14452
 14453     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14454     GO TO 6600-EXIT.
 14455
 14456 6600-START-AUTO-LETTER-WRITER.
 14457
 14458     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14459     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14460
 14461     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14462
 14463     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14464         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14465         MOVE '6'                     TO  DC-OPTION-CODE
 14466         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14467         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14468         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14469         IF NO-CONVERSION-ERROR
 14470             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14471         ELSE
 14472             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14473         END-IF
 14474     END-IF.
 14475
 14476     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 273
* EL130.cbl
 14477         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14478         MOVE '6'                     TO  DC-OPTION-CODE
 14479         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14480         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14481         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14482         IF NO-CONVERSION-ERROR
 14483             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14484         ELSE
 14485             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14486         END-IF
 14487     END-IF.
 14488
 14489
 14490
 14491* EXEC CICS LINK
 14492*        PROGRAM    (LINK-1523)
 14493*        COMMAREA   (W-1523-LINKDATA)
 14494*        LENGTH     (W-1523-COMM-LENGTH)
 14495*    END-EXEC.
 14496*    MOVE '."C                   (   #00013136' TO DFHEIV0
 14497     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14498     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14499     MOVE X'2020233030303133313336' TO DFHEIV0(25:11)
 14500     CALL 'kxdfhei1' USING DFHEIV0,
 14501           LINK-1523,
 14502           W-1523-LINKDATA,
 14503           W-1523-COMM-LENGTH,
 14504           DFHEIV99,
 14505           DFHEIV99,
 14506           DFHEIV99,
 14507           DFHEIV99
 14508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14509
 14510
 14511     GO TO 6600-EXIT.
 14512
 14513 6600-NOT-FOUND.
 14514     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14515
 14516 6600-EXIT.
 14517     EXIT.
 14518
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 274
* EL130.cbl
 14519/
 14520*************************************************************
 14521*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14522*************************************************************
 14523
 14524 6700-OUTPUT-ACTIVITY-RECORD.
 14525
 14526
 14527
 14528* EXEC CICS GETMAIN
 14529*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14530*        LENGTH (DLYACTV-LENGTH)
 14531*        INITIMG (WS-BLANK)
 14532*    END-EXEC.
 14533*    MOVE ',"IL                  $   #00013158' TO DFHEIV0
 14534     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14535     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14536     MOVE X'2020233030303133313538' TO DFHEIV0(25:11)
 14537     CALL 'kxdfhei1' USING DFHEIV0,
 14538           DFHEIV20,
 14539           DLYACTV-LENGTH,
 14540           WS-BLANK
 14541     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14542         DFHEIV20
 14543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14544
 14545
 14546     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14547     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14548     MOVE CLMCARRI               TO DA-CARRIER.
 14549     IF CLMNOL EQUAL ZERO
 14550         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14551     ELSE
 14552         MOVE CLMNOI             TO DA-CLAIM-NO
 14553     END-IF.
 14554     MOVE CERTNOI                TO DA-CERT-PRIME.
 14555     MOVE SUFXI                  TO DA-CERT-SFX.
 14556     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14557     MOVE 'A'                    TO DA-RECORD-TYPE.
 14558
 14559
 14560* EXEC CICS HANDLE CONDITION
 14561*        NOTOPEN (6700-NOTOPEN-ERROR)
 14562*        DUPREC (6700-EXIT)
 14563*    END-EXEC.
 14564*    MOVE '"$J%                  ! E #00013177' TO DFHEIV0
 14565     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14566     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14567     MOVE X'4520233030303133313737' TO DFHEIV0(25:11)
 14568     CALL 'kxdfhei1' USING DFHEIV0
 14569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14570
 14571
 14572
 14573* EXEC CICS WRITE
 14574*        DATASET (DLYACTV-DSID)
 14575*        RIDFLD (DA-KEY)
 14576*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 275
* EL130.cbl
 14577*        LENGTH (DLYACTV-LENGTH)
 14578*    END-EXEC.
 14579*    MOVE '&$ L                  ''   #00013182' TO DFHEIV0
 14580     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14581     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14582     MOVE X'2020233030303133313832' TO DFHEIV0(25:11)
 14583     CALL 'kxdfhei1' USING DFHEIV0,
 14584           DLYACTV-DSID,
 14585           DAILY-ACTIVITY-RECORD,
 14586           DLYACTV-LENGTH,
 14587           DA-KEY,
 14588           DFHEIV99,
 14589           DFHEIV99
 14590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14591
 14592     GO TO 6700-EXIT.
 14593
 14594 6700-NOTOPEN-ERROR.
 14595     MOVE '2955'                 TO EMI-ERROR.
 14596     MOVE -1                     TO MAINTL.
 14597     MOVE AL-UANON               TO MAINTA.
 14598     PERFORM 9900-ERROR-FORMAT THRU
 14599             9900-EXIT.
 14600     GO TO 8200-SEND-DATAONLY.
 14601
 14602 6700-EXIT.
 14603     EXIT.
 14604
 14605*************************************************************
 14606*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14607*************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 276
* EL130.cbl
 14608/
 14609 6990-DEEDIT-DATE.
 14610
 14611
 14612* EXEC CICS BIF DEEDIT
 14613*        FIELD   (DATE-WORK)
 14614*        LENGTH  (8)
 14615*    END-EXEC.
 14616     MOVE 8
 14617       TO DFHEIV11
 14618*    MOVE '@"L                   #   #00013207' TO DFHEIV0
 14619     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14620     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14621     MOVE X'2020233030303133323037' TO DFHEIV0(25:11)
 14622     CALL 'kxdfhei1' USING DFHEIV0,
 14623           DATE-WORK,
 14624           DFHEIV11
 14625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14626
 14627 6990-EXIT.
 14628     EXIT.
 14629
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 277
* EL130.cbl
 14631 7000-BUILD-OUTPUT-MAP.
 14632
 14633     IF CLAIM-SWITCH = 'N'
 14634         GO TO 7050-BUILD-MAP-CERT-DATA
 14635     END-IF.
 14636
 14637     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14638         MOVE SPACES                 TO SEQUO
 14639         MOVE AL-SABOF               TO SEQUA
 14640     ELSE
 14641         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14642         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14643         MOVE WS-CLAIM-SEQU          TO SEQUO
 14644         MOVE AL-SABON               TO SEQUA
 14645     END-IF.
 14646
 14647     MOVE CL-CARRIER             TO CLMCARRO.
 14648     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14649     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14650     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14651     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14652     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14653     MOVE CL-INSURED-MID-INIT    TO INITO.
 14654     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14655     move cl-insured-type        to instypeo
 14656*    MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14657
 14658     MOVE AL-UANON               TO CLMCARRA
 14659                                    CLMTYPEA
 14660                                    PCERTNOA
 14661                                    PSUFXA
 14662                                    LSTNMEA
 14663                                    FSTNMEA
 14664                                    INITA
 14665                                    SEXA
 14666
 14667     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14668
 14669     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14670         MOVE ' '                 TO DC-OPTION-CODE
 14671         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14672         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14673         IF NOT DATE-CONVERSION-ERROR
 14674             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14675             MOVE AL-UANON            TO BIRTHDTA
 14676         END-IF
 14677     END-IF.
 14678
 14679     MOVE CL-SOC-SEC-NO          TO SSNO.
 14680     MOVE AL-UANON               TO SSNA.
 14681
 14682     IF CL-INCURRED-DT NOT = LOW-VALUES
 14683         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14684         MOVE ' '                TO DC-OPTION-CODE
 14685         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14686         IF NOT DATE-CONVERSION-ERROR
 14687             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14688             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 278
* EL130.cbl
 14689         END-IF
 14690     END-IF.
 14691
 14692     IF CL-REPORTED-DT NOT = LOW-VALUES
 14693         MOVE ' '                TO DC-OPTION-CODE
 14694         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14695         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14696         IF NOT DATE-CONVERSION-ERROR
 14697             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14698             MOVE AL-UANON            TO REPORTA
 14699         END-IF
 14700     END-IF.
 14701
 14702*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14703*        MOVE ' '                 TO DC-OPTION-CODE
 14704*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14705*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14706*        IF NOT DATE-CONVERSION-ERROR
 14707*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14708*            MOVE AL-UANON            TO ESTENDA
 14709*        END-IF
 14710*    END-IF.
 14711
 14712     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14713     MOVE WS-ICD-CODE-1          TO ICD1O.
 14714     MOVE WS-ICD-CODE-2          TO ICD2O.
 14715*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14716     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14717     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14718     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14719     MOVE CL-PRIORITY-CD         TO PRICDO.
 14720     MOVE AL-UANON               TO DIAGA
 14721                                    ICD1A
 14722                                    ICD2A
 14723*                                   CAUSEA
 14724                                    RELCLMA
 14725                                    PROCCDA
 14726                                    PRICDA.
 14727     MOVE AL-UNNON               TO MANRSVA.
 14728
 14729*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14730*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14731*        MOVE AL-UANON               TO PRODCDA
 14732*    END-IF.
 14733
 14734     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14735     MOVE CL-FILE-LOCATION       TO FILETOO.
 14736     MOVE CL-BENEFICIARY         TO BENECDO.
 14737     MOVE AL-UANON               TO SUPVA
 14738                                    FILETOA
 14739                                    BENECDA.
 14740
 14741     IF CLAIM-SWITCH = 'X'
 14742         GO TO 7099-EXIT
 14743     END-IF.
 14744
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 279
* EL130.cbl
 14746 7050-BUILD-MAP-CERT-DATA.
 14747     MOVE CM-CERT-PRIME          TO CERTNOO.
 14748     MOVE CM-CERT-SFX            TO SUFXO.
 14749     MOVE AL-SANON               TO CERTNOA
 14750                                    SUFXA.
 14751
 14752     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14753         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14754         MOVE ' '                TO DC-OPTION-CODE
 14755         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14756         IF NOT DATE-CONVERSION-ERROR
 14757             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14758         END-IF
 14759     END-IF.
 14760
 14761     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14762     MOVE CM-STATE               TO STATEO.
 14763     MOVE CM-CARRIER             TO CRTCARRO.
 14764     MOVE CM-GROUPING            TO GROUPO.
 14765     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14766     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14767     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14768     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14769     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14770     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14771     MOVE CM-JT-INITIAL          TO JNTINITO.
 14772     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14773     MOVE AL-UANON               TO ACCOUNTA
 14774                                    STATEA
 14775                                    CRTCARRA
 14776                                    GROUPA
 14777                                    CRTLNMEA
 14778                                    CRTFNMEA
 14779                                    CRTINITA
 14780                                    JNTLNMEA
 14781                                    JNTFNMEA
 14782                                    JNTINITA.
 14783     MOVE AL-UNNON               TO ISSAGEA
 14784                                    JNTAGEA.
 14785
 14786     IF CM-SSN-STATE   = CM-STATE AND
 14787        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14788*        NEXT SENTENCE
 14789         CONTINUE
 14790     ELSE
 14791         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14792     END-IF.
 14793
 14794     MOVE AL-UANON               TO CRTSSNA.
 14795
 14796     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14797     MOVE '2'                    TO DC-OPTION-CODE.
 14798     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14799     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14800
 14801*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14802     MOVE SPACES                 TO ELCNTL-KEY.
 14803     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 280
* EL130.cbl
 14804     MOVE '3'                    TO CNTL-REC-TYPE.
 14805     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14806     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14807
 14808
 14809
 14810* EXEC CICS READ
 14811*        DATASET  (ELCNTL-DSID)
 14812*        SET      (ADDRESS OF CONTROL-FILE)
 14813*        RIDFLD   (ELCNTL-KEY)
 14814*        RESP     (WS-RESPONSE)
 14815*    END-EXEC.
 14816*    MOVE '&"S        E          (  N#00013393' TO DFHEIV0
 14817     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14818     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14819     MOVE X'204E233030303133333933' TO DFHEIV0(25:11)
 14820     CALL 'kxdfhei1' USING DFHEIV0,
 14821           ELCNTL-DSID,
 14822           DFHEIV20,
 14823           DFHEIV99,
 14824           ELCNTL-KEY,
 14825           DFHEIV99,
 14826           DFHEIV99,
 14827           DFHEIV99
 14828     SET ADDRESS OF CONTROL-FILE TO
 14829         DFHEIV20
 14830     MOVE EIBRESP  TO WS-RESPONSE
 14831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14832
 14833
 14834     IF WS-RESP-NOTFND
 14835          MOVE ER-2848           TO EMI-ERROR
 14836          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14837          GO TO 8100-SEND-INITIAL-MAP
 14838     END-IF.
 14839
 14840     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14841     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14842     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 281
* EL130.cbl
 14844     IF CM-LF-BENEFIT-CD = '00'
 14845         MOVE ZEROS              TO LCVOTRMO
 14846                                    LCVRTRMO
 14847                                    LCVRATEO
 14848                                    LCVBENEO
 14849         MOVE SPACES             TO LCVDSCRO
 14850                                    LCVCDO
 14851                                    LCVKINDO
 14852                                    LCVFORMO
 14853                                    LCVCNDTO
 14854                                    LCVEXITO
 14855                                    LCVSTATO
 14856         IF CLMTYPEL GREATER THAN ZERO AND
 14857            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14858                MOVE ER-0521     TO EMI-ERROR
 14859                MOVE AL-UABON    TO CLMTYPEA
 14860                MOVE -1          TO CLMTYPEL
 14861                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14862                GO TO 7060-FILL-AH-COVERAGE
 14863         ELSE
 14864             GO TO 7060-FILL-AH-COVERAGE
 14865         END-IF
 14866     END-IF.
 14867
 14868     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14869     MOVE AL-UANON               TO LCVDSCRA.
 14870     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14871     MOVE '4'                    TO WS-REC-TYPE.
 14872     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14873     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14874     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14875     MOVE AL-UANON               TO LCVCDA.
 14876     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14877                                    CP-ORIGINAL-TERM.
 14878     MOVE AL-UNNON               TO LCVOTRMA.
 14879     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14880     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14881     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14882     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14883     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14884     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14885
 14886     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14887     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14888
 14889     IF CM-LF-PREMIUM-RATE NUMERIC
 14890         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14891     ELSE
 14892         MOVE ZEROS              TO LCVRATEO
 14893     END-IF.
 14894
 14895     MOVE AL-UNNON               TO LCVRATEA.
 14896
 14897     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14898         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14899     END-IF.
 14900
 14901     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 282
* EL130.cbl
 14902
 14903     MOVE AL-UNNON               TO LCVBENEA.
 14904
 14905     IF CM-POLICY-FORM-NO NOT = SPACES
 14906         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14907     ELSE
 14908         MOVE WS-FORM-HOLD       TO LCVFORMO
 14909     END-IF.
 14910
 14911     MOVE SPACES                 TO WS-FORM-HOLD.
 14912     MOVE 'L'                    TO WS-REC-TYPE.
 14913     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14914
 14915     IF WS-FORM-HOLD NOT = SPACES
 14916         MOVE WS-FORM-HOLD       TO LCVFORMO
 14917         MOVE AL-UANON           TO LCVFORMA
 14918     END-IF.
 14919
 14920     IF CM-LF-CURRENT-STATUS = '8'
 14921         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14922             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14923             MOVE ' '             TO DC-OPTION-CODE
 14924             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14925             IF NOT DATE-CONVERSION-ERROR
 14926                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14927                 MOVE AL-UANON            TO LCVCNDTA
 14928             END-IF
 14929         END-IF
 14930     END-IF.
 14931
 14932     IF CM-LF-CURRENT-STATUS = '7'
 14933         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14934             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 14935             MOVE ' '            TO DC-OPTION-CODE
 14936             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14937             IF NOT DATE-CONVERSION-ERROR
 14938                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14939                 MOVE AL-UANON   TO LCVCNDTA
 14940             END-IF
 14941         END-IF
 14942     END-IF.
 14943
 14944     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14945         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 14946             MOVE ' '            TO DC-OPTION-CODE
 14947             MOVE CM-LF-DEATH-EXIT-DT
 14948                                 TO DC-BIN-DATE-1
 14949             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14950             IF NOT DATE-CONVERSION-ERROR
 14951                 MOVE DC-GREG-DATE-1-EDIT
 14952                                 TO LCVEXITO
 14953             END-IF
 14954         END-IF
 14955     END-IF.
 14956
 14957     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14958         IF CP-REMAINING-TERM-3 = ZEROS
 14959             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 283
* EL130.cbl
 14960         ELSE
 14961             MOVE 'ACTIVE'       TO LCVSTATO
 14962         END-IF
 14963     END-IF.
 14964
 14965     IF CM-LF-CURRENT-STATUS = '2'
 14966        MOVE 'PEND  '            TO LCVSTATO
 14967     END-IF.
 14968     IF CM-LF-CURRENT-STATUS = '3'
 14969        MOVE 'RESTORE'           TO LCVSTATO
 14970     END-IF.
 14971     IF CM-LF-CURRENT-STATUS = '5'
 14972        MOVE 'REISSUE'           TO LCVSTATO
 14973     END-IF.
 14974     IF CM-LF-CURRENT-STATUS = '6'
 14975        MOVE 'LMP DIS'           TO LCVSTATO
 14976     END-IF.
 14977     IF CM-LF-CURRENT-STATUS = '7'
 14978        MOVE 'DEATH  '           TO LCVSTATO
 14979     END-IF.
 14980     IF CM-LF-CURRENT-STATUS = '8'
 14981        MOVE 'CANCEL '           TO LCVSTATO
 14982     END-IF.
 14983     IF CM-LF-CURRENT-STATUS = '9'
 14984        MOVE 'RE-ONLY'           TO LCVSTATO
 14985     END-IF.
 14986     IF CM-LF-CURRENT-STATUS = 'V'
 14987        MOVE 'VOID   '           TO LCVSTATO
 14988     END-IF.
 14989     IF CM-LF-CURRENT-STATUS = 'D'
 14990        MOVE 'DECLINE'           TO LCVSTATO
 14991     END-IF.
 14992
 14993     IF PI-COMPANY-ID = 'CID'
 14994         IF CM-LF-BENEFIT-CD >= '2O' AND
 14995            CM-LF-BENEFIT-CD <= '2V'
 14996             MOVE ER-0878       TO EMI-ERROR
 14997             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14998         END-IF
 14999     END-IF.
 15000
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 284
* EL130.cbl
 15002 7060-FILL-AH-COVERAGE.
 15003
 15004     IF CM-AH-BENEFIT-CD = '00'
 15005         MOVE ZEROS              TO ACVOTRMO
 15006                                    ACVRTRMO
 15007                                    ACVRATEO
 15008                                    ACVBENEO
 15009         MOVE SPACES             TO ACVDSCRO
 15010                                    ACVCDO
 15011                                    ACVKINDO
 15012                                    ACVFORMO
 15013                                    ACVCNDTO
 15014                                    ACVEXITO
 15015                                    ACVSTATO
 15016         IF (CLMTYPEL GREATER THAN ZERO AND
 15017             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 15018             MOVE ER-0521     TO EMI-ERROR
 15019             MOVE AL-UABON    TO CLMTYPEA
 15020             MOVE -1          TO CLMTYPEL
 15021             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15022             GO TO 7070-BUILD-MAP-FINISH
 15023         ELSE
 15024             GO TO 7070-BUILD-MAP-FINISH
 15025         END-IF
 15026     END-IF.
 15027
 15028     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15029     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 15030     MOVE AL-UANON               TO ACVDSCRA
 15031                                    ACVCDA.
 15032     MOVE '5'                    TO WS-REC-TYPE.
 15033     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 15034     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 15035
 15036     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 15037                                    CP-ORIGINAL-TERM.
 15038     MOVE AL-UNNON               TO ACVOTRMA.
 15039
 15040     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15041     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15042     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 15043     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15044     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15045     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15046
 15047     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 15048     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15049
 15050     IF CM-AH-PREMIUM-RATE NUMERIC
 15051         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15052     ELSE
 15053         MOVE ZEROS              TO ACVRATEO
 15054     END-IF.
 15055
 15056     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 15057     MOVE AL-UNNON               TO ACVRATEA
 15058                                    ACVBENEA.
 15059
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 285
* EL130.cbl
 15060     IF CM-POLICY-FORM-NO NOT = SPACES
 15061         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 15062     ELSE
 15063         MOVE WS-FORM-HOLD       TO ACVFORMO
 15064         MOVE SPACES TO WS-FORM-HOLD
 15065         MOVE 'A'                TO WS-REC-TYPE
 15066         PERFORM 7400-READ-STATE THRU 7499-EXIT
 15067         IF WS-FORM-HOLD NOT = SPACES
 15068             MOVE WS-FORM-HOLD   TO ACVFORMO
 15069         END-IF
 15070     END-IF.
 15071
 15072     MOVE AL-UANON               TO ACVFORMA.
 15073
 15074     IF CM-AH-CURRENT-STATUS = '8'
 15075         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 15076             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15077             MOVE ' '             TO DC-OPTION-CODE
 15078             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15079             IF NOT DATE-CONVERSION-ERROR
 15080                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15081                MOVE AL-UANON    TO ACVCNDTA
 15082             END-IF
 15083         END-IF
 15084     END-IF.
 15085
 15086     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15087         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15088             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 15089             MOVE ' '             TO DC-OPTION-CODE
 15090             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15091             IF NOT DATE-CONVERSION-ERROR
 15092                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15093                MOVE AL-UANON            TO ACVCNDTA
 15094             END-IF
 15095         END-IF
 15096     END-IF.
 15097
 15098     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15099         MOVE ' '                TO DC-OPTION-CODE
 15100         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15101         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15102         IF NOT DATE-CONVERSION-ERROR
 15103             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 15104         END-IF
 15105     END-IF.
 15106
 15107     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15108         IF CP-REMAINING-TERM-3 = ZEROS
 15109             MOVE 'EXPIRED'      TO ACVSTATO
 15110         ELSE
 15111             MOVE 'ACTIVE'       TO ACVSTATO
 15112         END-IF
 15113     END-IF.
 15114
 15115     IF CM-AH-CURRENT-STATUS = '2'
 15116         MOVE 'PEND  '           TO ACVSTATO
 15117     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 286
* EL130.cbl
 15118     IF CM-AH-CURRENT-STATUS = '3'
 15119         MOVE 'RESTORE'          TO ACVSTATO
 15120     END-IF.
 15121     IF CM-AH-CURRENT-STATUS = '5'
 15122         MOVE 'REISSUE'          TO ACVSTATO
 15123     END-IF.
 15124     IF CM-AH-CURRENT-STATUS = '6'
 15125         MOVE 'LMP DIS'          TO ACVSTATO
 15126     END-IF.
 15127     IF CM-AH-CURRENT-STATUS = '7'
 15128         MOVE 'DEATH  '          TO ACVSTATO
 15129     END-IF.
 15130     IF CM-AH-CURRENT-STATUS = '8'
 15131         MOVE 'CANCEL '          TO ACVSTATO
 15132     END-IF.
 15133     IF CM-AH-CURRENT-STATUS = '9'
 15134         MOVE 'RE-ONLY'          TO ACVSTATO
 15135     END-IF.
 15136     IF CM-AH-CURRENT-STATUS = 'V'
 15137         MOVE 'VOID   '          TO ACVSTATO
 15138     END-IF.
 15139     IF CM-AH-CURRENT-STATUS = 'D'
 15140         MOVE 'DECLINE'          TO ACVSTATO
 15141     END-IF.
 15142
 15143     IF PI-COMPANY-ID = 'DCC' OR 'VPP'
 15144        IF CM-ACCOUNT (9:2) = 'BI'
 15145           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 15146           MOVE CM-CARRIER       TO CTRLR-CARRIER
 15147           MOVE CM-GROUPING      TO CTRLR-GROUPING
 15148           MOVE CM-STATE         TO CTRLR-STATE
 15149           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 15150           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 15151           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 15152           MOVE 'C'              TO CTRLR-REC-TYPE
 15153
 15154* EXEC CICS READ
 15155*            DATASET  (ELCRTT-DSID)
 15156*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 15157*            RIDFLD   (ELCRTT-KEY)
 15158*            RESP     (WS-RESPONSE)
 15159*          END-EXEC
 15160*    MOVE '&"S        E          (  N#00013719' TO DFHEIV0
 15161     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15162     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15163     MOVE X'204E233030303133373139' TO DFHEIV0(25:11)
 15164     CALL 'kxdfhei1' USING DFHEIV0,
 15165           ELCRTT-DSID,
 15166           DFHEIV20,
 15167           DFHEIV99,
 15168           ELCRTT-KEY,
 15169           DFHEIV99,
 15170           DFHEIV99,
 15171           DFHEIV99
 15172     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 15173         DFHEIV20
 15174     MOVE EIBRESP  TO WS-RESPONSE
 15175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 287
* EL130.cbl
 15176           IF WS-RESP-NORMAL
 15177               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 15178               MOVE WS-DIAG-VIN-MSG TO DIAGO
 15179               MOVE AL-UANON        TO DIAGA
 15180           END-IF
 15181        END-IF
 15182     END-IF.
 15183
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 288
* EL130.cbl
 15185 7070-BUILD-MAP-FINISH.
 15186     MOVE CM-LOAN-APR            TO APRO.
 15187     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15188     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15189     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 15190     MOVE AL-UNNON               TO APRA
 15191                                    PMTFREQA.
 15192     MOVE AL-UANON               TO INDGRPA
 15193                                    PREMTYPA.
 15194
 15195     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 15196         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 15197         MOVE AL-UANON               TO REINCDA
 15198     END-IF.
 15199
 15200     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 15201*        NEXT SENTENCE
 15202         CONTINUE
 15203     ELSE
 15204         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15205         MOVE ' '                TO DC-OPTION-CODE
 15206         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15207         IF NOT DATE-CONVERSION-ERROR
 15208             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 15209             MOVE AL-UANON            TO ADDONDTA
 15210         END-IF
 15211     END-IF.
 15212
 15213     IF CLAIM-SWITCH = 'N'
 15214         IF SEXL = ZEROS
 15215             MOVE CM-INSURED-SEX TO SEXO
 15216*            MOVE AL-UANON       TO SEXA
 15217         END-IF
 15218     END-IF.
 15219
 15220     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 15221         MOVE CM-MEMBER-NO       TO MEMBERO
 15222         MOVE AL-UANON           TO MEMBERA
 15223     END-IF.
 15224
 15225     IF MAINTI = 'A'
 15226         IF (LOANNOL = ZEROS OR
 15227             EIBAID = DFHPF5)
 15228             MOVE CM-LOAN-NUMBER TO LOANNOO
 15229             MOVE AL-UANON       TO LOANNOA
 15230         ELSE
 15231*            NEXT SENTENCE
 15232             CONTINUE
 15233         END-IF
 15234     ELSE
 15235         MOVE CM-LOAN-NUMBER     TO LOANNOO
 15236         MOVE AL-UANON           TO LOANNOA
 15237     END-IF.
 15238
 15239     IF MAINTI = 'A'
 15240         IF (LOANBALL = ZEROS OR
 15241             EIBAID = DFHPF5)
 15242             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 289
* EL130.cbl
 15243             MOVE AL-UNNON       TO LOANBALA
 15244         ELSE
 15245*            NEXT SENTENCE
 15246             CONTINUE
 15247         END-IF
 15248     ELSE
 15249         MOVE CM-LOAN-BALANCE    TO LOANBALO
 15250         MOVE AL-UNNON           TO LOANBALA
 15251     END-IF.
 15252
 15253     IF CM-PREMIUM-TYPE NOT = '3'
 15254         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15255             PERFORM 7200-PROTECT-CERT-FIELDS
 15256         ELSE
 15257             PERFORM 7300-RESET-KEY-ATTRBS
 15258         END-IF
 15259     ELSE
 15260         PERFORM 7300-RESET-KEY-ATTRBS
 15261     END-IF.
 15262
 15263*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15264*        NEXT SENTENCE
 15265*        CONTINUE
 15266*    ELSE
 15267         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15268*    END-IF.
 15269
 15270 7099-EXIT.
 15271     EXIT.
 15272
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 290
* EL130.cbl
 15274 7100-READ-BENEFIT.
 15275
 15276
 15277* EXEC CICS HANDLE CONDITION
 15278*         NOTFND   (7120-NOT-FOUND)
 15279*    END-EXEC.
 15280*    MOVE '"$I                   ! F #00013825' TO DFHEIV0
 15281     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15283     MOVE X'4620233030303133383235' TO DFHEIV0(25:11)
 15284     CALL 'kxdfhei1' USING DFHEIV0
 15285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15286
 15287
 15288     MOVE SPACES                 TO ELCNTL-KEY.
 15289     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 15290     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 15291     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15292     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15293
 15294 7105-READ-FILE.
 15295     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 15296
 15297     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 15298        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 15299          GO TO 7120-NOT-FOUND
 15300     END-IF.
 15301
 15302     MOVE 1                      TO SUB.
 15303 7110-LOOP.
 15304     IF SUB = 9
 15305         GO TO 7120-NOT-FOUND
 15306     END-IF.
 15307
 15308     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 15309         ADD 1                   TO SUB
 15310         GO TO 7110-LOOP
 15311     END-IF.
 15312
 15313     if ws-rec-type = '4'
 15314        move cf-joint-indicator (sub)
 15315                                 to ws-lf-joint-indicator
 15316     else
 15317        move cf-joint-indicator (sub)
 15318                                 to ws-ah-joint-indicator
 15319     end-if
 15320     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 15321     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 15322     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 15323
 15324     GO TO 7199-EXIT.
 15325
 15326 7120-NOT-FOUND.
 15327     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 15328                                    WS-FORM-HOLD.
 15329
 15330 7199-EXIT.
 15331      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 291
* EL130.cbl
 15332
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 292
* EL130.cbl
 15334 7200-PROTECT-CERT-FIELDS.
 15335     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15336                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15337                                LCVFORMA ACVFORMA JNTLNMEA
 15338                                JNTFNMEA JNTINITA.
 15339
 15340     IF CM-LF-CURRENT-STATUS = '2' OR
 15341        CM-AH-CURRENT-STATUS = '2'
 15342         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 15343     END-IF.
 15344
 15345     MOVE AL-SANOF TO
 15346            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 15347            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 15348            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 15349            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 15350            LCVRATEA   ACVRATEA.
 15351
 15352     MOVE 'S'                    TO CERTMTI.
 15353
 15354 7300-RESET-KEY-ATTRBS.
 15355     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15356                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15357                                LCVFORMA ACVFORMA JNTLNMEA
 15358                                JNTFNMEA JNTINITA.
 15359
 15360     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15361         MOVE AL-SANOF           TO REINCDA
 15362     END-IF.
 15363
 15364     MOVE 'S'                    TO CERTMTI.
 15365
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 293
* EL130.cbl
 15367 7400-READ-STATE.
 15368
 15369
 15370* EXEC CICS HANDLE CONDITION
 15371*         NOTFND   (7499-EXIT)
 15372*    END-EXEC.
 15373*    MOVE '"$I                   ! G #00013910' TO DFHEIV0
 15374     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15375     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15376     MOVE X'4720233030303133393130' TO DFHEIV0(25:11)
 15377     CALL 'kxdfhei1' USING DFHEIV0
 15378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15379
 15380
 15381     MOVE SPACES                 TO ELCNTL-KEY.
 15382     MOVE CM-STATE               TO CNTL-ACCESS.
 15383     MOVE '3'                    TO CNTL-REC-TYPE.
 15384     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15385     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15386
 15387     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15388
 15389     MOVE 1                      TO SUB.
 15390
 15391 7410-LOOP.
 15392     IF SUB = 21
 15393        GO TO 7499-EXIT
 15394     END-IF.
 15395
 15396*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15397*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15398*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15399*        GO TO 7499-EXIT.
 15400
 15401     ADD 1                       TO SUB.
 15402     GO TO 7410-LOOP.
 15403
 15404 7499-EXIT.
 15405      EXIT.
 15406
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 294
* EL130.cbl
 15408 7500-BROWSE-FOR-DUPLICATE.
 15409
 15410     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15411
 15412
 15413
 15414* EXEC CICS HANDLE CONDITION
 15415*        NOTFND   (7500-EXIT)
 15416*        DUPKEY   (7500-DUPLICATE-KEY)
 15417*        ENDFILE  (7500-EXIT)
 15418*    END-EXEC.
 15419*    MOVE '"$I$''                 ! H #00013946' TO DFHEIV0
 15420     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15422     MOVE X'4820233030303133393436' TO DFHEIV0(25:11)
 15423     CALL 'kxdfhei1' USING DFHEIV0
 15424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15425
 15426
 15427
 15428
 15429* EXEC CICS STARTBR
 15430*        DATASET    (ELMSTR5-DSID)
 15431*        RIDFLD     (ELMSTR5-KEY)
 15432*    END-EXEC.
 15433     MOVE 0
 15434       TO DFHEIV11
 15435*    MOVE '&,         G          &   #00013953' TO DFHEIV0
 15436     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15437     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15438     MOVE X'2020233030303133393533' TO DFHEIV0(25:11)
 15439     CALL 'kxdfhei1' USING DFHEIV0,
 15440           ELMSTR5-DSID,
 15441           ELMSTR5-KEY,
 15442           DFHEIV99,
 15443           DFHEIV11,
 15444           DFHEIV99
 15445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15446
 15447
 15448
 15449
 15450* EXEC CICS HANDLE CONDITION
 15451*        ENDFILE  (7500-END-BROWSE)
 15452*    END-EXEC.
 15453*    MOVE '"$''                   ! I #00013959' TO DFHEIV0
 15454     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15456     MOVE X'4920233030303133393539' TO DFHEIV0(25:11)
 15457     CALL 'kxdfhei1' USING DFHEIV0
 15458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15459
 15460
 15461 7500-READ-CLAIM-LOOP.
 15462
 15463
 15464
 15465* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 295
* EL130.cbl
 15466*        DATASET   (ELMSTR5-DSID)
 15467*        SET       (ADDRESS OF CLAIM-MASTER)
 15468*        RIDFLD    (ELMSTR5-KEY)
 15469*    END-EXEC.
 15470     MOVE 0
 15471       TO DFHEIV11
 15472*    MOVE '&.S                   )   #00013966' TO DFHEIV0
 15473     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15474     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15475     MOVE X'2020233030303133393636' TO DFHEIV0(25:11)
 15476     CALL 'kxdfhei1' USING DFHEIV0,
 15477           ELMSTR5-DSID,
 15478           DFHEIV20,
 15479           DFHEIV99,
 15480           ELMSTR5-KEY,
 15481           DFHEIV99,
 15482           DFHEIV11,
 15483           DFHEIV99,
 15484           DFHEIV99
 15485     SET ADDRESS OF CLAIM-MASTER TO
 15486         DFHEIV20
 15487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15488
 15489
 15490 7500-DUPLICATE-KEY.
 15491
 15492     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15493        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15494        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15495        CL-CERT-STATE     NOT = CM-STATE       OR
 15496        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15497        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15498        CL-CERT-NO        NOT = CM-CERT-NO
 15499           GO TO 7500-CHECK-MATCH-COUNT
 15500     END-IF.
 15501
 15502     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15503
 15504     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15505        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15506        GO TO 7500-END-BROWSE
 15507     ELSE
 15508        GO TO 7500-READ-CLAIM-LOOP
 15509     END-IF.
 15510
 15511 7500-CHECK-MATCH-COUNT.
 15512
 15513     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15514        CL-CERT-NO    = CM-CERT-NO
 15515          GO TO 7500-READ-CLAIM-LOOP
 15516     END-IF.
 15517
 15518 7500-END-BROWSE.
 15519
 15520
 15521
 15522* EXEC CICS ENDBR
 15523*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 296
* EL130.cbl
 15524*    END-EXEC.
 15525     MOVE 0
 15526       TO DFHEIV11
 15527*    MOVE '&2                    $   #00014003' TO DFHEIV0
 15528     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15529     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15530     MOVE X'2020233030303134303033' TO DFHEIV0(25:11)
 15531     CALL 'kxdfhei1' USING DFHEIV0,
 15532           ELMSTR5-DSID,
 15533           DFHEIV11,
 15534           DFHEIV99
 15535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15536
 15537
 15538 7500-EXIT.
 15539     EXIT.
 15540
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 297
* EL130.cbl
 15542 7550-FALL-THRU-PARA.
 15543
 15544
 15545
 15546* EXEC CICS DUMP
 15547*         DUMPCODE ('E130')
 15548*         TASK
 15549*    END-EXEC.
 15550     MOVE 'E130' TO DFHEIV5
 15551*    MOVE '<"   T                $   #00014014' TO DFHEIV0
 15552     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15553     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15554     MOVE X'2020233030303134303134' TO DFHEIV0(25:11)
 15555     CALL 'kxdfhei1' USING DFHEIV0,
 15556           DFHEIV5,
 15557           DFHEIV99,
 15558           DFHEIV99
 15559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15560
 15561
 15562
 15563
 15564* EXEC CICS RETURN
 15565*    END-EXEC.
 15566*    MOVE '.(                    ''   #00014020' TO DFHEIV0
 15567     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15568     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15569     MOVE X'2020233030303134303230' TO DFHEIV0(25:11)
 15570     CALL 'kxdfhei1' USING DFHEIV0,
 15571           DFHEIV99,
 15572           DFHEIV99,
 15573           DFHEIV99,
 15574           DFHEIV99,
 15575           DFHEIV99,
 15576           DFHEIV99
 15577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15578
 15579
 15580 7600-BROWSE-CLAIM.
 15581
 15582
 15583
 15584* EXEC CICS READ
 15585*        DATASET(ELMSTR-DSID)
 15586*        SET    (ADDRESS OF CLAIM-MASTER)
 15587*        RIDFLD (ELMSTR-KEY)
 15588*        GENERIC
 15589*        EQUAL
 15590*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15591*    END-EXEC.
 15592*    MOVE '&"S  KG    E          (   #00014026' TO DFHEIV0
 15593     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15594     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15595     MOVE X'2020233030303134303236' TO DFHEIV0(25:11)
 15596     CALL 'kxdfhei1' USING DFHEIV0,
 15597           ELMSTR-DSID,
 15598           DFHEIV20,
 15599           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 298
* EL130.cbl
 15600           ELMSTR-KEY,
 15601           ELMSTR-GENERIC-LENGTH,
 15602           DFHEIV99,
 15603           DFHEIV99
 15604     SET ADDRESS OF CLAIM-MASTER TO
 15605         DFHEIV20
 15606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15607
 15608
 15609     MOVE CL-CERT-PRIME          TO CERTNOI.
 15610     MOVE CL-CERT-SFX            TO SUFXI.
 15611
 15612 7610-BROWSE-CLAIM-LOOP.
 15613
 15614     MOVE LOW-VALUES             TO BCERT1O
 15615                                    BSUFX1O
 15616                                    BCERT2O
 15617                                    BSUFX2O
 15618                                    BCERT3O
 15619                                    BSUFX3O
 15620                                    BCERT4O
 15621                                    BSUFX4O
 15622                                    BCERT5O
 15623                                    BSUFX5O.
 15624
 15625     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15626
 15627
 15628
 15629* EXEC CICS HANDLE CONDITION
 15630*        ENDFILE  (7630-END-BROWSE)
 15631*    END-EXEC.
 15632*    MOVE '"$''                   ! J #00014054' TO DFHEIV0
 15633     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15635     MOVE X'4A20233030303134303534' TO DFHEIV0(25:11)
 15636     CALL 'kxdfhei1' USING DFHEIV0
 15637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15638
 15639
 15640
 15641
 15642* EXEC CICS STARTBR
 15643*        DATASET    (ELMSTR-DSID)
 15644*        RIDFLD     (ELMSTR-KEY)
 15645*    END-EXEC.
 15646     MOVE 0
 15647       TO DFHEIV11
 15648*    MOVE '&,         G          &   #00014059' TO DFHEIV0
 15649     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15650     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15651     MOVE X'2020233030303134303539' TO DFHEIV0(25:11)
 15652     CALL 'kxdfhei1' USING DFHEIV0,
 15653           ELMSTR-DSID,
 15654           ELMSTR-KEY,
 15655           DFHEIV99,
 15656           DFHEIV11,
 15657           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 299
* EL130.cbl
 15658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15659
 15660
 15661     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15662
 15663 7620-READ-CLAIM-LOOP.
 15664
 15665
 15666
 15667* EXEC CICS READNEXT
 15668*        DATASET   (ELMSTR-DSID)
 15669*        SET       (ADDRESS OF CLAIM-MASTER)
 15670*        RIDFLD    (ELMSTR-KEY)
 15671*    END-EXEC.
 15672     MOVE 0
 15673       TO DFHEIV11
 15674*    MOVE '&.S                   )   #00014069' TO DFHEIV0
 15675     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15676     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15677     MOVE X'2020233030303134303639' TO DFHEIV0(25:11)
 15678     CALL 'kxdfhei1' USING DFHEIV0,
 15679           ELMSTR-DSID,
 15680           DFHEIV20,
 15681           DFHEIV99,
 15682           ELMSTR-KEY,
 15683           DFHEIV99,
 15684           DFHEIV11,
 15685           DFHEIV99,
 15686           DFHEIV99
 15687     SET ADDRESS OF CLAIM-MASTER TO
 15688         DFHEIV20
 15689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15690
 15691
 15692     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15693        CL-CARRIER     NOT = CLMCARRI       OR
 15694        CL-CLAIM-NO    NOT = CLMNOI
 15695          GO TO 7630-END-BROWSE
 15696     END-IF.
 15697
 15698     IF WS-ASSOCIATED-CERTS = 1
 15699         MOVE CL-CERT-PRIME      TO BCERT1O
 15700         MOVE CL-CERT-SFX        TO BSUFX1O
 15701     END-IF.
 15702
 15703     IF WS-ASSOCIATED-CERTS = 2
 15704         MOVE CL-CERT-PRIME      TO BCERT2O
 15705         MOVE CL-CERT-SFX        TO BSUFX2O
 15706     END-IF.
 15707
 15708     IF WS-ASSOCIATED-CERTS = 3
 15709         MOVE CL-CERT-PRIME      TO BCERT3O
 15710         MOVE CL-CERT-SFX        TO BSUFX3O
 15711     END-IF.
 15712
 15713     IF WS-ASSOCIATED-CERTS = 4
 15714         MOVE CL-CERT-PRIME      TO BCERT4O
 15715         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 300
* EL130.cbl
 15716     END-IF.
 15717
 15718     IF WS-ASSOCIATED-CERTS = 5
 15719         MOVE CL-CERT-PRIME      TO BCERT5O
 15720         MOVE CL-CERT-SFX        TO BSUFX5O
 15721     ELSE
 15722         ADD +1                  TO WS-ASSOCIATED-CERTS
 15723         GO TO 7620-READ-CLAIM-LOOP
 15724     END-IF.
 15725
 15726 7630-END-BROWSE.
 15727
 15728
 15729
 15730* EXEC CICS ENDBR
 15731*        DATASET   (ELMSTR-DSID)
 15732*    END-EXEC.
 15733     MOVE 0
 15734       TO DFHEIV11
 15735*    MOVE '&2                    $   #00014112' TO DFHEIV0
 15736     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15737     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15738     MOVE X'2020233030303134313132' TO DFHEIV0(25:11)
 15739     CALL 'kxdfhei1' USING DFHEIV0,
 15740           ELMSTR-DSID,
 15741           DFHEIV11,
 15742           DFHEIV99
 15743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15744
 15745
 15746 7640-HIGHLIGHT-CERT-DISPLAYED.
 15747
 15748     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15749     MOVE AL-SANON               TO BCERT1A
 15750                                    BSUFX1A
 15751                                    BCERT2A
 15752                                    BSUFX2A
 15753                                    BCERT3A
 15754                                    BSUFX3A
 15755                                    BCERT4A
 15756                                    BSUFX4A
 15757                                    BCERT5A
 15758                                    BSUFX5A.
 15759
 15760     IF BCERT1O = CERTNOI AND
 15761        BSUFX1O = SUFXI
 15762            MOVE AL-SABON        TO BCERT1A
 15763                                    BSUFX1A
 15764     END-IF.
 15765
 15766     IF BCERT2O = CERTNOI AND
 15767        BSUFX2O = SUFXI
 15768            MOVE AL-SABON        TO BCERT2A
 15769                                    BSUFX2A
 15770     END-IF.
 15771
 15772     IF BCERT3O = CERTNOI AND
 15773        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 301
* EL130.cbl
 15774            MOVE AL-SABON        TO BCERT3A
 15775                                    BSUFX3A
 15776     END-IF.
 15777
 15778     IF BCERT4O = CERTNOI AND
 15779        BSUFX4O = SUFXI
 15780            MOVE AL-SABON        TO BCERT4A
 15781                                    BSUFX4A
 15782     END-IF.
 15783
 15784     IF BCERT5O = CERTNOI AND
 15785        BSUFX5O = SUFXI
 15786            MOVE AL-SABON        TO BCERT5A
 15787                                    BSUFX5A
 15788     END-IF.
 15789
 15790 7699-EXIT.
 15791     EXIT.
 15792
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 302
* EL130.cbl
 15794 7700-CHECK-SEQUENCE.
 15795
 15796
 15797
 15798* EXEC CICS HANDLE CONDITION
 15799*        ENDFILE  (7799-EXIT)
 15800*        NOTFND   (7799-EXIT)
 15801*    END-EXEC.
 15802*    MOVE '"$''I                  ! K #00014167' TO DFHEIV0
 15803     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15804     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15805     MOVE X'4B20233030303134313637' TO DFHEIV0(25:11)
 15806     CALL 'kxdfhei1' USING DFHEIV0
 15807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15808
 15809
 15810
 15811
 15812* EXEC CICS READ
 15813*        DATASET(ELMSTR-DSID)
 15814*        SET    (ADDRESS OF CLAIM-MASTER)
 15815*        RIDFLD (ELMSTR-KEY)
 15816*        GENERIC
 15817*        EQUAL
 15818*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15819*    END-EXEC.
 15820*    MOVE '&"S  KG    E          (   #00014173' TO DFHEIV0
 15821     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15823     MOVE X'2020233030303134313733' TO DFHEIV0(25:11)
 15824     CALL 'kxdfhei1' USING DFHEIV0,
 15825           ELMSTR-DSID,
 15826           DFHEIV20,
 15827           DFHEIV99,
 15828           ELMSTR-KEY,
 15829           ELMSTR-GENERIC-LENGTH,
 15830           DFHEIV99,
 15831           DFHEIV99
 15832     SET ADDRESS OF CLAIM-MASTER TO
 15833         DFHEIV20
 15834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15835
 15836
 15837     COMPUTE WS-ASSOC-CERT-TOTAL =
 15838             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15839
 15840     GO TO 7799-EXIT.
 15841
 15842 7710-RESEQUENCE-CLAIMS.
 15843
 15844
 15845
 15846* EXEC CICS HANDLE CONDITION
 15847*        ENDFILE  (7790-END-BROWSE)
 15848*    END-EXEC.
 15849*    MOVE '"$''                   ! L #00014190' TO DFHEIV0
 15850     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 303
* EL130.cbl
 15852     MOVE X'4C20233030303134313930' TO DFHEIV0(25:11)
 15853     CALL 'kxdfhei1' USING DFHEIV0
 15854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15855
 15856
 15857
 15858
 15859* EXEC CICS STARTBR
 15860*        DATASET    (ELMSTR-DSID)
 15861*        RIDFLD     (ELMSTR-KEY)
 15862*    END-EXEC.
 15863     MOVE 0
 15864       TO DFHEIV11
 15865*    MOVE '&,         G          &   #00014195' TO DFHEIV0
 15866     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15867     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15868     MOVE X'2020233030303134313935' TO DFHEIV0(25:11)
 15869     CALL 'kxdfhei1' USING DFHEIV0,
 15870           ELMSTR-DSID,
 15871           ELMSTR-KEY,
 15872           DFHEIV99,
 15873           DFHEIV11,
 15874           DFHEIV99
 15875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15876
 15877
 15878     ADD +1 TO WS-ASSOC-CERT-SEQU
 15879               WS-READNEXT-SWITCH.
 15880
 15881 7720-READ-CLAIM-LOOP.
 15882
 15883
 15884
 15885* EXEC CICS READNEXT
 15886*        DATASET   (ELMSTR-DSID)
 15887*        SET       (ADDRESS OF CLAIM-MASTER)
 15888*        RIDFLD    (ELMSTR-KEY)
 15889*    END-EXEC.
 15890     MOVE 0
 15891       TO DFHEIV11
 15892*    MOVE '&.S                   )   #00014206' TO DFHEIV0
 15893     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15894     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15895     MOVE X'2020233030303134323036' TO DFHEIV0(25:11)
 15896     CALL 'kxdfhei1' USING DFHEIV0,
 15897           ELMSTR-DSID,
 15898           DFHEIV20,
 15899           DFHEIV99,
 15900           ELMSTR-KEY,
 15901           DFHEIV99,
 15902           DFHEIV11,
 15903           DFHEIV99,
 15904           DFHEIV99
 15905     SET ADDRESS OF CLAIM-MASTER TO
 15906         DFHEIV20
 15907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15908
 15909
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 304
* EL130.cbl
 15910     IF WS-READNEXT-SWITCH = 1
 15911         ADD 1 TO WS-READNEXT-SWITCH
 15912         GO TO 7720-READ-CLAIM-LOOP
 15913     END-IF.
 15914
 15915 7730-END-BROWSE.
 15916
 15917
 15918
 15919* EXEC CICS ENDBR
 15920*        DATASET   (ELMSTR-DSID)
 15921*    END-EXEC.
 15922     MOVE 0
 15923       TO DFHEIV11
 15924*    MOVE '&2                    $   #00014220' TO DFHEIV0
 15925     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15926     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15927     MOVE X'2020233030303134323230' TO DFHEIV0(25:11)
 15928     CALL 'kxdfhei1' USING DFHEIV0,
 15929           ELMSTR-DSID,
 15930           DFHEIV11,
 15931           DFHEIV99
 15932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15933
 15934
 15935 7740-READ-CLAIM-UPDATE.
 15936
 15937     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 15938        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 15939        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 15940          GO TO 7799-EXIT
 15941     ELSE
 15942          MOVE ZERO              TO WS-READNEXT-SWITCH
 15943     END-IF.
 15944
 15945
 15946
 15947* EXEC CICS READ
 15948*        DATASET(ELMSTR-DSID)
 15949*        SET    (ADDRESS OF CLAIM-MASTER)
 15950*        RIDFLD (ELMSTR-KEY)
 15951*        UPDATE
 15952*    END-EXEC.
 15953*    MOVE '&"S        EU         (   #00014235' TO DFHEIV0
 15954     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15955     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15956     MOVE X'2020233030303134323335' TO DFHEIV0(25:11)
 15957     CALL 'kxdfhei1' USING DFHEIV0,
 15958           ELMSTR-DSID,
 15959           DFHEIV20,
 15960           DFHEIV99,
 15961           ELMSTR-KEY,
 15962           DFHEIV99,
 15963           DFHEIV99,
 15964           DFHEIV99
 15965     SET ADDRESS OF CLAIM-MASTER TO
 15966         DFHEIV20
 15967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 305
* EL130.cbl
 15968
 15969
 15970     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15971     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15972
 15973
 15974
 15975* EXEC CICS REWRITE
 15976*         DATASET     (ELMSTR-DSID)
 15977*         FROM        (CLAIM-MASTER)
 15978*    END-EXEC.
 15979     MOVE LENGTH OF
 15980      CLAIM-MASTER
 15981       TO DFHEIV11
 15982*    MOVE '&& L                  %   #00014246' TO DFHEIV0
 15983     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15984     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15985     MOVE X'2020233030303134323436' TO DFHEIV0(25:11)
 15986     CALL 'kxdfhei1' USING DFHEIV0,
 15987           ELMSTR-DSID,
 15988           CLAIM-MASTER,
 15989           DFHEIV11,
 15990           DFHEIV99
 15991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15992
 15993
 15994     GO TO 7710-RESEQUENCE-CLAIMS.
 15995
 15996 7790-END-BROWSE.
 15997
 15998
 15999
 16000* EXEC CICS ENDBR
 16001*        DATASET   (ELMSTR-DSID)
 16002*    END-EXEC.
 16003     MOVE 0
 16004       TO DFHEIV11
 16005*    MOVE '&2                    $   #00014256' TO DFHEIV0
 16006     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16007     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16008     MOVE X'2020233030303134323536' TO DFHEIV0(25:11)
 16009     CALL 'kxdfhei1' USING DFHEIV0,
 16010           ELMSTR-DSID,
 16011           DFHEIV11,
 16012           DFHEIV99
 16013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16014
 16015
 16016 7799-EXIT.
 16017     EXIT.
 16018
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 306
* EL130.cbl
 16020************************************************
 16021*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 16022************************************************
 16023
 16024 7900-READ-ACTV-UPDATE.
 16025     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16026     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16027     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16028     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16029     MOVE +0                     TO TRLR-SEQ-NO.
 16030     MOVE '1'                    TO TRLR-TYPE.
 16031     GO TO 7900-READ-TRAILER-UPDATE.
 16032
 16033 7900-READ-NINETY-UPDATE.
 16034     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16035     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16036     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16037     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16038     MOVE +90                    TO TRLR-SEQ-NO.
 16039     MOVE '6'                    TO TRLR-TYPE.
 16040
 16041 7900-READ-TRAILER-UPDATE.
 16042
 16043
 16044* EXEC CICS READ  UPDATE
 16045*        DATASET    (ELTRLR-DSID)
 16046*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 16047*        RIDFLD     (ELTRLR-KEY)
 16048*    END-EXEC.
 16049*    MOVE '&"S        EU         (   #00014287' TO DFHEIV0
 16050     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16051     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16052     MOVE X'2020233030303134323837' TO DFHEIV0(25:11)
 16053     CALL 'kxdfhei1' USING DFHEIV0,
 16054           ELTRLR-DSID,
 16055           DFHEIV20,
 16056           DFHEIV99,
 16057           ELTRLR-KEY,
 16058           DFHEIV99,
 16059           DFHEIV99,
 16060           DFHEIV99
 16061     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16062         DFHEIV20
 16063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16064
 16065
 16066 7900-EXIT.
 16067      EXIT.
 16068
 16069 7910-READ-ACTV.
 16070     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16071     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16072     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16073     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16074     MOVE +0                     TO TRLR-SEQ-NO.
 16075     MOVE '1'                    TO TRLR-TYPE.
 16076     GO TO 7910-READ-TRAILER.
 16077
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 307
* EL130.cbl
 16078 7910-READ-NINETY.
 16079     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16080     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16081     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16082     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16083     MOVE +90                    TO TRLR-SEQ-NO.
 16084     MOVE '6'                    TO TRLR-TYPE.
 16085
 16086 7910-READ-TRAILER.
 16087     MOVE 'TRLR'                 TO FILE-SWITCH.
 16088
 16089
 16090
 16091* EXEC CICS READ
 16092*        DATASET   (ELTRLR-DSID)
 16093*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16094*        RIDFLD    (ELTRLR-KEY)
 16095*    END-EXEC.
 16096*    MOVE '&"S        E          (   #00014317' TO DFHEIV0
 16097     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16098     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16099     MOVE X'2020233030303134333137' TO DFHEIV0(25:11)
 16100     CALL 'kxdfhei1' USING DFHEIV0,
 16101           ELTRLR-DSID,
 16102           DFHEIV20,
 16103           DFHEIV99,
 16104           ELTRLR-KEY,
 16105           DFHEIV99,
 16106           DFHEIV99,
 16107           DFHEIV99
 16108     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16109         DFHEIV20
 16110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16111
 16112
 16113 7910-EXIT.
 16114      EXIT.
 16115
 16116 7915-REWRITE-TRAILER.
 16117
 16118
 16119* EXEC CICS REWRITE
 16120*        DATASET   (ELTRLR-DSID)
 16121*        FROM      (ACTIVITY-TRAILERS)
 16122*    END-EXEC.
 16123     MOVE LENGTH OF
 16124      ACTIVITY-TRAILERS
 16125       TO DFHEIV11
 16126*    MOVE '&& L                  %   #00014328' TO DFHEIV0
 16127     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16128     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16129     MOVE X'2020233030303134333238' TO DFHEIV0(25:11)
 16130     CALL 'kxdfhei1' USING DFHEIV0,
 16131           ELTRLR-DSID,
 16132           ACTIVITY-TRAILERS,
 16133           DFHEIV11,
 16134           DFHEIV99
 16135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 308
* EL130.cbl
 16136
 16137
 16138 7915-EXIT.
 16139      EXIT.
 16140
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 309
* EL130.cbl
 16142********************************************
 16143*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 16144********************************************
 16145
 16146 7920-READ-CLAIM-UPDATE.
 16147
 16148
 16149
 16150* EXEC CICS READ
 16151*        UPDATE
 16152*        DATASET   (ELMSTR-DSID)
 16153*        SET       (ADDRESS OF CLAIM-MASTER)
 16154*        RIDFLD    (ELMSTR-KEY)
 16155*    END-EXEC.
 16156*    MOVE '&"S        EU         (   #00014344' TO DFHEIV0
 16157     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16158     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16159     MOVE X'2020233030303134333434' TO DFHEIV0(25:11)
 16160     CALL 'kxdfhei1' USING DFHEIV0,
 16161           ELMSTR-DSID,
 16162           DFHEIV20,
 16163           DFHEIV99,
 16164           ELMSTR-KEY,
 16165           DFHEIV99,
 16166           DFHEIV99,
 16167           DFHEIV99
 16168     SET ADDRESS OF CLAIM-MASTER TO
 16169         DFHEIV20
 16170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16171
 16172
 16173 7920-EXIT.
 16174      EXIT.
 16175
 16176 7950-READ-CLAIM.
 16177
 16178
 16179* EXEC CICS READ
 16180*        DATASET   (ELMSTR-DSID)
 16181*        SET       (ADDRESS OF CLAIM-MASTER)
 16182*        RIDFLD    (ELMSTR-KEY)
 16183*    END-EXEC.
 16184*    MOVE '&"S        E          (   #00014356' TO DFHEIV0
 16185     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16186     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16187     MOVE X'2020233030303134333536' TO DFHEIV0(25:11)
 16188     CALL 'kxdfhei1' USING DFHEIV0,
 16189           ELMSTR-DSID,
 16190           DFHEIV20,
 16191           DFHEIV99,
 16192           ELMSTR-KEY,
 16193           DFHEIV99,
 16194           DFHEIV99,
 16195           DFHEIV99
 16196     SET ADDRESS OF CLAIM-MASTER TO
 16197         DFHEIV20
 16198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16199
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 310
* EL130.cbl
 16200
 16201 7950-EXIT.
 16202      EXIT.
 16203
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 311
* EL130.cbl
 16205***************************************
 16206*  I/O REQUESTS AGAINST CONTROL FILE  *
 16207***************************************
 16208
 16209 7960-READ-CNTL-UPDATE.
 16210
 16211
 16212* EXEC CICS READ
 16213*        UPDATE
 16214*        DATASET  (ELCNTL-DSID)
 16215*        SET      (ADDRESS OF CONTROL-FILE)
 16216*        RIDFLD   (ELCNTL-KEY)
 16217*    END-EXEC.
 16218*    MOVE '&"S        EU         (   #00014372' TO DFHEIV0
 16219     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16220     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16221     MOVE X'2020233030303134333732' TO DFHEIV0(25:11)
 16222     CALL 'kxdfhei1' USING DFHEIV0,
 16223           ELCNTL-DSID,
 16224           DFHEIV20,
 16225           DFHEIV99,
 16226           ELCNTL-KEY,
 16227           DFHEIV99,
 16228           DFHEIV99,
 16229           DFHEIV99
 16230     SET ADDRESS OF CONTROL-FILE TO
 16231         DFHEIV20
 16232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16233
 16234
 16235 7960-EXIT.
 16236      EXIT.
 16237
 16238 7970-READ-CNTL.
 16239
 16240
 16241* EXEC CICS READ
 16242*        DATASET  (ELCNTL-DSID)
 16243*        SET      (ADDRESS OF CONTROL-FILE)
 16244*        RIDFLD   (ELCNTL-KEY)
 16245*    END-EXEC.
 16246*    MOVE '&"S        E          (   #00014384' TO DFHEIV0
 16247     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16248     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16249     MOVE X'2020233030303134333834' TO DFHEIV0(25:11)
 16250     CALL 'kxdfhei1' USING DFHEIV0,
 16251           ELCNTL-DSID,
 16252           DFHEIV20,
 16253           DFHEIV99,
 16254           ELCNTL-KEY,
 16255           DFHEIV99,
 16256           DFHEIV99,
 16257           DFHEIV99
 16258     SET ADDRESS OF CONTROL-FILE TO
 16259         DFHEIV20
 16260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16261
 16262
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 312
* EL130.cbl
 16263 7970-EXIT.
 16264      EXIT.
 16265
 16266 7975-READ-CNTL-GTEQ.
 16267
 16268
 16269* EXEC CICS READ
 16270*         DATASET   (ELCNTL-DSID)
 16271*         SET       (ADDRESS OF CONTROL-FILE)
 16272*         RIDFLD    (ELCNTL-KEY)
 16273*         GTEQ
 16274*     END-EXEC.
 16275*    MOVE '&"S        G          (   #00014395' TO DFHEIV0
 16276     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16277     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16278     MOVE X'2020233030303134333935' TO DFHEIV0(25:11)
 16279     CALL 'kxdfhei1' USING DFHEIV0,
 16280           ELCNTL-DSID,
 16281           DFHEIV20,
 16282           DFHEIV99,
 16283           ELCNTL-KEY,
 16284           DFHEIV99,
 16285           DFHEIV99,
 16286           DFHEIV99
 16287     SET ADDRESS OF CONTROL-FILE TO
 16288         DFHEIV20
 16289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16290
 16291
 16292 7975-EXIT.
 16293      EXIT.
 16294
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 313
* EL130.cbl
 16296**************************************************
 16297*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 16298**************************************************
 16299
 16300 7980-READ-CERT5.
 16301
 16302
 16303* EXEC CICS READ
 16304*         DATASET  (ELCERT5-DSID)
 16305*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 16306*         RIDFLD   (ELCERT-KEY-5)
 16307*     END-EXEC.
 16308*    MOVE '&"S        E          (   #00014412' TO DFHEIV0
 16309     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16310     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16311     MOVE X'2020233030303134343132' TO DFHEIV0(25:11)
 16312     CALL 'kxdfhei1' USING DFHEIV0,
 16313           ELCERT5-DSID,
 16314           DFHEIV20,
 16315           DFHEIV99,
 16316           ELCERT-KEY-5,
 16317           DFHEIV99,
 16318           DFHEIV99,
 16319           DFHEIV99
 16320     SET ADDRESS OF CERTIFICATE-MASTER TO
 16321         DFHEIV20
 16322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16323
 16324
 16325 7980-EXIT.
 16326      EXIT.
 16327
 16328 7930-READ-CERT-UPDATE.
 16329
 16330
 16331* EXEC CICS READ
 16332*        DATASET  (ELCERT-DSID)
 16333*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16334*        RIDFLD   (ELCERT-KEY)
 16335*        UPDATE
 16336*    END-EXEC.
 16337*    MOVE '&"S        EU         (   #00014423' TO DFHEIV0
 16338     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16339     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16340     MOVE X'2020233030303134343233' TO DFHEIV0(25:11)
 16341     CALL 'kxdfhei1' USING DFHEIV0,
 16342           ELCERT-DSID,
 16343           DFHEIV20,
 16344           DFHEIV99,
 16345           ELCERT-KEY,
 16346           DFHEIV99,
 16347           DFHEIV99,
 16348           DFHEIV99
 16349     SET ADDRESS OF CERTIFICATE-MASTER TO
 16350         DFHEIV20
 16351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16352
 16353
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 314
* EL130.cbl
 16354 7930-EXIT.
 16355      EXIT.
 16356
 16357 7940-READ-CERT.
 16358
 16359
 16360* EXEC CICS READ
 16361*        DATASET  (ELCERT-DSID)
 16362*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16363*        RIDFLD   (ELCERT-KEY)
 16364*    END-EXEC.
 16365*    MOVE '&"S        E          (   #00014435' TO DFHEIV0
 16366     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16367     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16368     MOVE X'2020233030303134343335' TO DFHEIV0(25:11)
 16369     CALL 'kxdfhei1' USING DFHEIV0,
 16370           ELCERT-DSID,
 16371           DFHEIV20,
 16372           DFHEIV99,
 16373           ELCERT-KEY,
 16374           DFHEIV99,
 16375           DFHEIV99,
 16376           DFHEIV99
 16377     SET ADDRESS OF CERTIFICATE-MASTER TO
 16378         DFHEIV20
 16379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16380
 16381
 16382 7940-EXIT.
 16383      EXIT.
 16384
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 315
* EL130.cbl
 16386**************************************************
 16387*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16388**************************************************
 16389
 16390 7991-READ-BENE.
 16391
 16392
 16393* EXEC CICS READ
 16394*         DATASET   (ELBENE-DSID)
 16395*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16396*         RIDFLD    (ELBENE-KEY)
 16397*     END-EXEC.
 16398*    MOVE '&"S        E          (   #00014451' TO DFHEIV0
 16399     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16400     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16401     MOVE X'2020233030303134343531' TO DFHEIV0(25:11)
 16402     CALL 'kxdfhei1' USING DFHEIV0,
 16403           ELBENE-DSID,
 16404           DFHEIV20,
 16405           DFHEIV99,
 16406           ELBENE-KEY,
 16407           DFHEIV99,
 16408           DFHEIV99,
 16409           DFHEIV99
 16410     SET ADDRESS OF BENEFICIARY-MASTER TO
 16411         DFHEIV20
 16412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16413
 16414
 16415 7991-EXIT.
 16416      EXIT.
 16417
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 316
* EL130.cbl
 16419**************************************************
 16420*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16421**************************************************
 16422
 16423 7992-READ-REIN.
 16424
 16425
 16426
 16427* EXEC CICS HANDLE CONDITION
 16428*        NOTFND   (7992-NOT-FOUND)
 16429*    END-EXEC.
 16430*    MOVE '"$I                   ! M #00014468' TO DFHEIV0
 16431     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16433     MOVE X'4D20233030303134343638' TO DFHEIV0(25:11)
 16434     CALL 'kxdfhei1' USING DFHEIV0
 16435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16436
 16437
 16438
 16439
 16440* EXEC CICS READ
 16441*        DATASET   (ERREIN-DSID)
 16442*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16443*        RIDFLD    (ERREIN-KEY)
 16444*    END-EXEC.
 16445*    MOVE '&"S        E          (   #00014473' TO DFHEIV0
 16446     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16448     MOVE X'2020233030303134343733' TO DFHEIV0(25:11)
 16449     CALL 'kxdfhei1' USING DFHEIV0,
 16450           ERREIN-DSID,
 16451           DFHEIV20,
 16452           DFHEIV99,
 16453           ERREIN-KEY,
 16454           DFHEIV99,
 16455           DFHEIV99,
 16456           DFHEIV99
 16457     SET ADDRESS OF REINSURANCE-RECORD TO
 16458         DFHEIV20
 16459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16460
 16461
 16462     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16463
 16464     GO TO 7992-EXIT.
 16465
 16466 7992-NOT-FOUND.
 16467     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16468
 16469 7992-EXIT.
 16470     EXIT.
 16471
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 317
* EL130.cbl
 16473 8000-LOAD-ERROR-MESSAGES.
 16474     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16475
 16476     IF EMI-NO-ERRORS
 16477         GO TO 8000-EXIT
 16478     END-IF.
 16479
 16480     perform varying e1 from +1 by +1 until e1 > +3
 16481        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16482                                or '1655' or '1660'
 16483           move 'W'              to emi-severity (e1)
 16484        end-if
 16485     end-perform
 16486     IF EMI-NUMBER-OF-LINES = 1
 16487         MOVE EMI-LINE1          TO ERRMSG1O
 16488         GO TO 8000-EXIT
 16489     END-IF.
 16490
 16491     IF EMI-NUMBER-OF-LINES = 2
 16492          MOVE EMI-LINE1         TO ERRMSG1O
 16493          MOVE EMI-LINE2         TO ERRMSG2O
 16494          GO TO 8000-EXIT
 16495     END-IF.
 16496
 16497     MOVE EMI-LINE1              TO ERRMSG1O.
 16498
 16499 8000-EXIT.
 16500     EXIT.
 16501
 16502 8100-SEND-INITIAL-MAP.
 16503     MOVE SAVE-DATE              TO RUNDTEO.
 16504     MOVE EIBTIME                TO TIME-IN.
 16505     MOVE TIME-OUT               TO RUNTIMEO.
 16506     IF EIBAID = DFHPF11
 16507        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16508        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16509     end-if
 16510     IF RETURNED-FROM = XCTL-114
 16511        CONTINUE
 16512     ELSE
 16513        MOVE -1                  TO MAINTL
 16514     END-IF.
 16515
 16516*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16517         MOVE SPACES             TO PRODO.
 16518         MOVE AL-SANOF           TO PRODCDA.
 16519*    END-IF.
 16520
 16521     MOVE PI-COMPANY-ID          TO COMPO.
 16522     MOVE AL-PABOF               TO COMPA.
 16523     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16524     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16525     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16526
 16527     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16528
 16529     IF NOT PI-NO-CARRIER-SECURITY
 16530        MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 318
* EL130.cbl
 16531        MOVE AL-SABOF            TO CLMCARRA
 16532     END-IF.
 16533
 16534     IF PI-PROCESSOR-ID = 'PEMA'
 16535        MOVE AL-UANON            TO CERTNOA
 16536                                    SUFXA
 16537     END-IF.
 16538*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16539*        NEXT SENTENCE
 16540*        CONTINUE
 16541*    ELSE
 16542         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16543*    END-IF.
 16544
 16545
 16546
 16547* EXEC CICS SEND
 16548*        MAP     (MAP-NAME)
 16549*        MAPSET  (MAPSET-NAME)
 16550*        FROM    (EL130AO)
 16551*        ERASE
 16552*        CURSOR
 16553*    END-EXEC.
 16554     MOVE LENGTH OF
 16555      EL130AO
 16556       TO DFHEIV12
 16557     MOVE -1
 16558       TO DFHEIV11
 16559*    MOVE '8$     CT  E    H L F ,   #00014563' TO DFHEIV0
 16560     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16561     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16562     MOVE X'2020233030303134353633' TO DFHEIV0(25:11)
 16563     CALL 'kxdfhei1' USING DFHEIV0,
 16564           MAP-NAME,
 16565           EL130AO,
 16566           DFHEIV12,
 16567           MAPSET-NAME,
 16568           DFHEIV99,
 16569           DFHEIV99,
 16570           DFHEIV99,
 16571           DFHEIV11,
 16572           DFHEIV99,
 16573           DFHEIV99,
 16574           DFHEIV99
 16575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16576
 16577
 16578     GO TO 9100-RETURN-TRAN.
 16579
 16580 8150-SEND-MAP-CURSOR.
 16581     MOVE SAVE-DATE              TO RUNDTEO.
 16582     MOVE EIBTIME                TO TIME-IN.
 16583     MOVE TIME-OUT               TO RUNTIMEO.
 16584     IF EIBAID = DFHPF11
 16585        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16586        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16587     end-if
 16588     MOVE PI-COMPANY-ID          TO COMPO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 319
* EL130.cbl
 16589     MOVE AL-PABOF               TO COMPA
 16590     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16591     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16592     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16593
 16594*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16595         MOVE SPACES             TO PRODO.
 16596         MOVE AL-SANOF           TO PRODCDA.
 16597*    END-IF.
 16598
 16599     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16600
 16601     IF NOT PI-NO-CARRIER-SECURITY
 16602         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16603         MOVE AL-SABOF            TO CLMCARRA
 16604     END-IF.
 16605
 16606     IF PI-PROCESSOR-ID = 'PEMA'
 16607        MOVE AL-UANON            TO CERTNOA
 16608                                    SUFXA
 16609     END-IF.
 16610*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16611*        NEXT SENTENCE
 16612*        CONTINUE
 16613*    ELSE
 16614         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16615*    END-IF.
 16616
 16617
 16618
 16619* EXEC CICS SEND
 16620*        MAP      (MAP-NAME)
 16621*        MAPSET   (MAPSET-NAME)
 16622*        FROM     (EL130AO)
 16623*        CURSOR   (PI-CURSOR)
 16624*        ERASE
 16625*    END-EXEC.
 16626     MOVE LENGTH OF
 16627      EL130AO
 16628       TO DFHEIV11
 16629*    MOVE '8$     CT  E    H L F ,   #00014611' TO DFHEIV0
 16630     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16631     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16632     MOVE X'2020233030303134363131' TO DFHEIV0(25:11)
 16633     CALL 'kxdfhei1' USING DFHEIV0,
 16634           MAP-NAME,
 16635           EL130AO,
 16636           DFHEIV11,
 16637           MAPSET-NAME,
 16638           DFHEIV99,
 16639           DFHEIV99,
 16640           DFHEIV99,
 16641           PI-CURSOR,
 16642           DFHEIV99,
 16643           DFHEIV99,
 16644           DFHEIV99
 16645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16646
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 320
* EL130.cbl
 16647
 16648     GO TO 9100-RETURN-TRAN.
 16649
 16650 8200-SEND-DATAONLY.
 16651     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16652
 16653     IF EIBAID = DFHPF11
 16654        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16655        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16656        go to 8100-send-initial-map
 16657     end-if
 16658*    IF EIBAID = DFHPF11
 16659*       MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16660*       move pi-last-claim       to emi-claim-no
 16661*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16662*       go to 8100-send-initial-map
 16663*    END-IF.
 16664     .
 16665 8200-BYPASS-ERROR.
 16666     MOVE SAVE-DATE              TO RUNDTEO.
 16667     MOVE EIBTIME                TO TIME-IN.
 16668     MOVE TIME-OUT               TO RUNTIMEO.
 16669     MOVE PI-COMPANY-ID          TO COMPO.
 16670     MOVE AL-PABOF               TO COMPA
 16671     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16672
 16673*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16674         MOVE SPACES             TO PRODO.
 16675         MOVE AL-SANOF           TO PRODCDA.
 16676*    END-IF.
 16677
 16678     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16679     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16680
 16681     IF PI-PROCESSOR-ID = 'PEMA'
 16682        MOVE AL-UANON            TO CERTNOA
 16683                                    SUFXA
 16684     END-IF.
 16685     IF NOT PI-NO-CARRIER-SECURITY
 16686        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16687        MOVE AL-SABOF            TO CLMCARRA
 16688     END-IF.
 16689
 16690*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16691*        NEXT SENTENCE
 16692*        CONTINUE
 16693*    ELSE
 16694         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16695*    END-IF.
 16696
 16697*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16698         MOVE AL-SANOF           TO PRODCDA.
 16699*    END-IF.
 16700
 16701
 16702
 16703* EXEC CICS SEND
 16704*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 321
* EL130.cbl
 16705*        MAPSET   (MAPSET-NAME)
 16706*        FROM     (EL130AO)
 16707*        DATAONLY
 16708*        CURSOR
 16709*    END-EXEC.
 16710     MOVE LENGTH OF
 16711      EL130AO
 16712       TO DFHEIV12
 16713     MOVE -1
 16714       TO DFHEIV11
 16715*    MOVE '8$D    CT       H L F ,   #00014673' TO DFHEIV0
 16716     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16717     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16718     MOVE X'2020233030303134363733' TO DFHEIV0(25:11)
 16719     CALL 'kxdfhei1' USING DFHEIV0,
 16720           MAP-NAME,
 16721           EL130AO,
 16722           DFHEIV12,
 16723           MAPSET-NAME,
 16724           DFHEIV99,
 16725           DFHEIV99,
 16726           DFHEIV99,
 16727           DFHEIV11,
 16728           DFHEIV99,
 16729           DFHEIV99,
 16730           DFHEIV99
 16731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16732
 16733
 16734     GO TO 9100-RETURN-TRAN.
 16735
 16736 8300-SEND-TEXT.
 16737
 16738
 16739* EXEC CICS SEND TEXT
 16740*        FROM     (LOGOFF-TEXT)
 16741*        LENGTH   (LOGOFF-LENGTH)
 16742*        ERASE
 16743*        FREEKB
 16744*    END-EXEC.
 16745*    MOVE '8&      T  E F  H   F -   #00014685' TO DFHEIV0
 16746     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16747     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16748     MOVE X'2020233030303134363835' TO DFHEIV0(25:11)
 16749     CALL 'kxdfhei1' USING DFHEIV0,
 16750           LOGOFF-TEXT,
 16751           LOGOFF-LENGTH,
 16752           DFHEIV99,
 16753           DFHEIV99,
 16754           DFHEIV99,
 16755           DFHEIV99,
 16756           DFHEIV99,
 16757           DFHEIV99,
 16758           DFHEIV99,
 16759           DFHEIV99,
 16760           DFHEIV99,
 16761           DFHEIV99
 16762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 322
* EL130.cbl
 16763
 16764
 16765
 16766
 16767* EXEC CICS RETURN
 16768*    END-EXEC.
 16769*    MOVE '.(                    ''   #00014693' TO DFHEIV0
 16770     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16771     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16772     MOVE X'2020233030303134363933' TO DFHEIV0(25:11)
 16773     CALL 'kxdfhei1' USING DFHEIV0,
 16774           DFHEIV99,
 16775           DFHEIV99,
 16776           DFHEIV99,
 16777           DFHEIV99,
 16778           DFHEIV99,
 16779           DFHEIV99
 16780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16781
 16782
 16783 8800-UNAUTHORIZED-ACCESS.
 16784     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16785     GO TO 8300-SEND-TEXT.
 16786
 16787 8810-PF23.
 16788     MOVE EIBAID TO PI-ENTRY-CD-1.
 16789     MOVE XCTL-005               TO PGM-NAME.
 16790     GO TO 9300-XCTL.
 16791
 16792 8820-TERM-ERROR.
 16793     MOVE ER-0412                TO EMI-ERROR.
 16794     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16795     MOVE -1                     TO MAINTL.
 16796     GO TO 8200-SEND-DATAONLY.
 16797
 16798 8830-TRAN-ERROR.
 16799     MOVE ER-0413                TO EMI-ERROR.
 16800     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16801     MOVE -1                     TO MAINTL.
 16802     GO TO 8200-SEND-DATAONLY.
 16803
 16804 9000-RETURN-CICS.
 16805
 16806
 16807* EXEC CICS RETURN
 16808*    END-EXEC.
 16809*    MOVE '.(                    ''   #00014719' TO DFHEIV0
 16810     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16811     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16812     MOVE X'2020233030303134373139' TO DFHEIV0(25:11)
 16813     CALL 'kxdfhei1' USING DFHEIV0,
 16814           DFHEIV99,
 16815           DFHEIV99,
 16816           DFHEIV99,
 16817           DFHEIV99,
 16818           DFHEIV99,
 16819           DFHEIV99
 16820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 323
* EL130.cbl
 16821
 16822
 16823 9100-RETURN-TRAN.
 16824     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16825     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16826
 16827
 16828
 16829* EXEC CICS RETURN
 16830*        TRANSID   (TRANS-ID)
 16831*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16832*        LENGTH    (PI-COMM-LENGTH)
 16833*    END-EXEC.
 16834*    MOVE '.(CT                  ''   #00014727' TO DFHEIV0
 16835     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16836     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16837     MOVE X'2020233030303134373237' TO DFHEIV0(25:11)
 16838     CALL 'kxdfhei1' USING DFHEIV0,
 16839           TRANS-ID,
 16840           PROGRAM-INTERFACE-BLOCK,
 16841           PI-COMM-LENGTH,
 16842           DFHEIV99,
 16843           DFHEIV99,
 16844           DFHEIV99
 16845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16846
 16847
 16848 9200-RETURN-MAIN-MENU.
 16849     MOVE XCTL-126               TO PGM-NAME.
 16850     GO TO 9300-XCTL.
 16851
 16852 9300-XCTL.
 16853
 16854
 16855* EXEC CICS XCTL
 16856*        PROGRAM   (PGM-NAME)
 16857*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16858*        LENGTH    (PI-COMM-LENGTH)
 16859*    END-EXEC.
 16860*    MOVE '.$C                   %   #00014739' TO DFHEIV0
 16861     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16862     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16863     MOVE X'2020233030303134373339' TO DFHEIV0(25:11)
 16864     CALL 'kxdfhei1' USING DFHEIV0,
 16865           PGM-NAME,
 16866           PROGRAM-INTERFACE-BLOCK,
 16867           PI-COMM-LENGTH,
 16868           DFHEIV99
 16869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16870
 16871
 16872 9400-CLEAR.
 16873     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16874     GO TO 9300-XCTL.
 16875
 16876 9500-PF12.
 16877     MOVE XCTL-010               TO PGM-NAME.
 16878     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 324
* EL130.cbl
 16879
 16880 9600-PGMID-ERROR.
 16881
 16882
 16883* EXEC CICS HANDLE CONDITION
 16884*        PGMIDERR  (8300-SEND-TEXT)
 16885*    END-EXEC.
 16886*    MOVE '"$L                   ! N #00014755' TO DFHEIV0
 16887     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16889     MOVE X'4E20233030303134373535' TO DFHEIV0(25:11)
 16890     CALL 'kxdfhei1' USING DFHEIV0
 16891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16892
 16893
 16894     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16895     MOVE ' '                    TO PI-ENTRY-CD-1.
 16896     MOVE XCTL-005               TO PGM-NAME.
 16897     MOVE PGM-NAME               TO LOGOFF-PGM.
 16898     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16899     GO TO 9300-XCTL.
 16900
 16901 9700-LINK-DATE-CONVERT.
 16902     MOVE LINK-ELDATCV           TO PGM-NAME.
 16903
 16904
 16905* EXEC CICS LINK
 16906*        PROGRAM    (PGM-NAME)
 16907*        COMMAREA   (DATE-CONVERSION-DATA)
 16908*        LENGTH     (DC-COMM-LENGTH)
 16909*    END-EXEC.
 16910*    MOVE '."C                   (   #00014769' TO DFHEIV0
 16911     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16912     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16913     MOVE X'2020233030303134373639' TO DFHEIV0(25:11)
 16914     CALL 'kxdfhei1' USING DFHEIV0,
 16915           PGM-NAME,
 16916           DATE-CONVERSION-DATA,
 16917           DC-COMM-LENGTH,
 16918           DFHEIV99,
 16919           DFHEIV99,
 16920           DFHEIV99,
 16921           DFHEIV99
 16922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16923
 16924
 16925 9700-EXIT.
 16926     EXIT.
 16927
 16928 9800-LINK-REM-TERM.
 16929     MOVE LINK-ELRTRM            TO PGM-NAME.
 16930
 16931
 16932* EXEC CICS LINK
 16933*        PROGRAM    (PGM-NAME)
 16934*        COMMAREA   (CALCULATION-PASS-AREA)
 16935*        LENGTH     (CP-COMM-LENGTH)
 16936*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 325
* EL130.cbl
 16937*    MOVE '."C                   (   #00014781' TO DFHEIV0
 16938     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16940     MOVE X'2020233030303134373831' TO DFHEIV0(25:11)
 16941     CALL 'kxdfhei1' USING DFHEIV0,
 16942           PGM-NAME,
 16943           CALCULATION-PASS-AREA,
 16944           CP-COMM-LENGTH,
 16945           DFHEIV99,
 16946           DFHEIV99,
 16947           DFHEIV99,
 16948           DFHEIV99
 16949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16950
 16951
 16952 9800-EXIT.
 16953     EXIT.
 16954
 16955 9900-ERROR-FORMAT.
 16956*    if emi-error = 1651 or 1652 or 1653 or 1655
 16957*       display ' 9900 error ' emi-error
 16958*       display emi-message-area (1)
 16959*       display emi-message-area (2)
 16960*       display emi-message-area (3)
 16961*    end-if
 16962     IF NOT EMI-ERRORS-COMPLETE
 16963         MOVE LINK-001           TO PGM-NAME
 16964
 16965* EXEC CICS LINK
 16966*            PROGRAM   (PGM-NAME)
 16967*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 16968*            LENGTH    (EMI-COMM-LENGTH)
 16969*        END-EXEC
 16970*    MOVE '."C                   (   #00014799' TO DFHEIV0
 16971     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16973     MOVE X'2020233030303134373939' TO DFHEIV0(25:11)
 16974     CALL 'kxdfhei1' USING DFHEIV0,
 16975           PGM-NAME,
 16976           ERROR-MESSAGE-INTERFACE-BLOCK,
 16977           EMI-COMM-LENGTH,
 16978           DFHEIV99,
 16979           DFHEIV99,
 16980           DFHEIV99,
 16981           DFHEIV99
 16982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16983         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 16984            subtract 1 from emi-fatal-ctr
 16985         end-if
 16986     END-IF.
 16987
 16988     .
 16989 9900-EXIT.
 16990     EXIT.
 16991
 16992 9990-ABEND.
 16993     MOVE -1                     TO MAINTL.
 16994     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 326
* EL130.cbl
 16995     MOVE DFHEIBLK               TO EMI-LINE1.
 16996
 16997
 16998* EXEC CICS LINK
 16999*        PROGRAM   (PGM-NAME)
 17000*        COMMAREA  (EMI-LINE1)
 17001*        LENGTH    (72)
 17002*    END-EXEC.
 17003     MOVE 72
 17004       TO DFHEIV11
 17005*    MOVE '."C                   (   #00014818' TO DFHEIV0
 17006     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17008     MOVE X'2020233030303134383138' TO DFHEIV0(25:11)
 17009     CALL 'kxdfhei1' USING DFHEIV0,
 17010           PGM-NAME,
 17011           EMI-LINE1,
 17012           DFHEIV11,
 17013           DFHEIV99,
 17014           DFHEIV99,
 17015           DFHEIV99,
 17016           DFHEIV99
 17017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17018
 17019
 17020     MOVE EMI-LINE1              TO ERRMSG2O.
 17021
 17022     GO TO 8200-BYPASS-ERROR.
 17023
 17024
 17025
 17026* GOBACK.
 17027     MOVE '9%                    "   ' TO DFHEIV0
 17028     MOVE 'EL130' TO DFHEIV1
 17029     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17030     GOBACK.
 17031
 17032 9995-SECURITY-VIOLATION.
 17033*             COPY ELCSCTP.
 17034******************************************************************
 17035*                                                                *
 17036*                            ELCSCTP                             *
 17037*                            VMOD=2.001                          *
 17038*                                                                *
 17039*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17040******************************************************************
 17041
 17042
 17043     MOVE EIBDATE          TO SM-JUL-DATE.
 17044     MOVE EIBTRMID         TO SM-TERMID.
 17045     MOVE THIS-PGM         TO SM-PGM.
 17046     MOVE EIBTIME          TO TIME-IN.
 17047     MOVE TIME-OUT         TO SM-TIME.
 17048     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17049
 17050
 17051* EXEC CICS LINK
 17052*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 327
* EL130.cbl
 17053*         COMMAREA (SECURITY-MESSAGE)
 17054*         LENGTH   (80)
 17055*    END-EXEC.
 17056     MOVE 'EL003' TO DFHEIV1
 17057     MOVE 80
 17058       TO DFHEIV11
 17059*    MOVE '."C                   (   #00014849' TO DFHEIV0
 17060     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17061     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17062     MOVE X'2020233030303134383439' TO DFHEIV0(25:11)
 17063     CALL 'kxdfhei1' USING DFHEIV0,
 17064           DFHEIV1,
 17065           SECURITY-MESSAGE,
 17066           DFHEIV11,
 17067           DFHEIV99,
 17068           DFHEIV99,
 17069           DFHEIV99,
 17070           DFHEIV99
 17071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17072
 17073
 17074******************************************************************
 17075
 17076
 17077 9995-EXIT.
 17078     EXIT.
 17079
 17080
 17081 9999-DFHBACK SECTION.
 17082     MOVE '9%                    "   ' TO DFHEIV0
 17083     MOVE 'EL130' TO DFHEIV1
 17084     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17085     GOBACK.
 17086 9999-DFHEXIT.
 17087     IF DFHEIGDJ EQUAL 0001
 17088         NEXT SENTENCE
 17089     ELSE IF DFHEIGDJ EQUAL 2
 17090         GO TO 0100-TEST-ENTRY,
 17091               8100-SEND-INITIAL-MAP,
 17092               9600-PGMID-ERROR,
 17093               8820-TERM-ERROR,
 17094               8830-TRAN-ERROR,
 17095               9990-ABEND
 17096         DEPENDING ON DFHEIGDI
 17097     ELSE IF DFHEIGDJ EQUAL 3
 17098         GO TO 0450-ADD-ELACTQ-RECORD
 17099         DEPENDING ON DFHEIGDI
 17100     ELSE IF DFHEIGDJ EQUAL 4
 17101         GO TO 8820-TERM-ERROR,
 17102               8830-TRAN-ERROR
 17103         DEPENDING ON DFHEIGDI
 17104     ELSE IF DFHEIGDJ EQUAL 5
 17105         GO TO 0660-NOT-FOUND,
 17106               0670-QIDERR
 17107         DEPENDING ON DFHEIGDI
 17108     ELSE IF DFHEIGDJ EQUAL 6
 17109         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17110         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 328
* EL130.cbl
 17111     ELSE IF DFHEIGDJ EQUAL 7
 17112         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17113         DEPENDING ON DFHEIGDI
 17114     ELSE IF DFHEIGDJ EQUAL 8
 17115         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17116         DEPENDING ON DFHEIGDI
 17117     ELSE IF DFHEIGDJ EQUAL 9
 17118         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17119         DEPENDING ON DFHEIGDI
 17120     ELSE IF DFHEIGDJ EQUAL 10
 17121         GO TO 2050-DELETE-NOT-FOUND
 17122         DEPENDING ON DFHEIGDI
 17123     ELSE IF DFHEIGDJ EQUAL 11
 17124         GO TO 2010-DELETE-CL
 17125         DEPENDING ON DFHEIGDI
 17126     ELSE IF DFHEIGDJ EQUAL 12
 17127         GO TO 3010-TEST-FOR-ERRORS
 17128         DEPENDING ON DFHEIGDI
 17129     ELSE IF DFHEIGDJ EQUAL 13
 17130         GO TO 3008-DUP-ERROR,
 17131               3009-NOT-FOUND
 17132         DEPENDING ON DFHEIGDI
 17133     ELSE IF DFHEIGDJ EQUAL 14
 17134         GO TO 3030-BUILD-CONT
 17135         DEPENDING ON DFHEIGDI
 17136     ELSE IF DFHEIGDJ EQUAL 15
 17137         GO TO 3033-ACCT-NOT-FOUND,
 17138               3033-ACCT-NOT-FOUND
 17139         DEPENDING ON DFHEIGDI
 17140     ELSE IF DFHEIGDJ EQUAL 16
 17141         GO TO 3032-NOT-IN-DT-RANGE
 17142         DEPENDING ON DFHEIGDI
 17143     ELSE IF DFHEIGDJ EQUAL 17
 17144         GO TO 3070-BUILD-CONT
 17145         DEPENDING ON DFHEIGDI
 17146     ELSE IF DFHEIGDJ EQUAL 18
 17147         GO TO 3065-CERT-NOT-FOUND
 17148         DEPENDING ON DFHEIGDI
 17149     ELSE IF DFHEIGDJ EQUAL 19
 17150         GO TO 3100-CARRIER-NOT-FOUND
 17151         DEPENDING ON DFHEIGDI
 17152     ELSE IF DFHEIGDJ EQUAL 20
 17153         GO TO 3110-COMPANY-NOT-FOUND
 17154         DEPENDING ON DFHEIGDI
 17155     ELSE IF DFHEIGDJ EQUAL 21
 17156         GO TO 3200-BUILD-ZERO-TRAILER
 17157         DEPENDING ON DFHEIGDI
 17158     ELSE IF DFHEIGDJ EQUAL 22
 17159         GO TO 9999-DFHBACK
 17160         DEPENDING ON DFHEIGDI
 17161     ELSE IF DFHEIGDJ EQUAL 23
 17162         GO TO 3290-NO-INSURED-ADDRESS
 17163         DEPENDING ON DFHEIGDI
 17164     ELSE IF DFHEIGDJ EQUAL 24
 17165         GO TO 3410-DUP-KEY
 17166         DEPENDING ON DFHEIGDI
 17167     ELSE IF DFHEIGDJ EQUAL 25
 17168         GO TO 3690-CERT-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 329
* EL130.cbl
 17169         DEPENDING ON DFHEIGDI
 17170     ELSE IF DFHEIGDJ EQUAL 26
 17171         GO TO 3850-CLAIM-MSTR-WRITTEN
 17172         DEPENDING ON DFHEIGDI
 17173     ELSE IF DFHEIGDJ EQUAL 27
 17174         GO TO 3992-DUPREC
 17175         DEPENDING ON DFHEIGDI
 17176     ELSE IF DFHEIGDJ EQUAL 28
 17177         GO TO 5050-CERT-NOT-FOUND
 17178         DEPENDING ON DFHEIGDI
 17179     ELSE IF DFHEIGDJ EQUAL 29
 17180         GO TO 5030-CERT-WRITTEN
 17181         DEPENDING ON DFHEIGDI
 17182     ELSE IF DFHEIGDJ EQUAL 30
 17183         GO TO 5035-CLAIM-WRITTEN
 17184         DEPENDING ON DFHEIGDI
 17185     ELSE IF DFHEIGDJ EQUAL 31
 17186         GO TO 9990-ABEND,
 17187               5799-EXIT
 17188         DEPENDING ON DFHEIGDI
 17189     ELSE IF DFHEIGDJ EQUAL 32
 17190         GO TO 3100-CARRIER-NOT-FOUND
 17191         DEPENDING ON DFHEIGDI
 17192     ELSE IF DFHEIGDJ EQUAL 33
 17193         GO TO 6040-NO-PROCESSOR-RECORD
 17194         DEPENDING ON DFHEIGDI
 17195     ELSE IF DFHEIGDJ EQUAL 34
 17196         GO TO 6060-NO-BENEFICIARY-RECORD
 17197         DEPENDING ON DFHEIGDI
 17198     ELSE IF DFHEIGDJ EQUAL 35
 17199         GO TO 6499-EXIT,
 17200               6499-EXIT
 17201         DEPENDING ON DFHEIGDI
 17202     ELSE IF DFHEIGDJ EQUAL 36
 17203         GO TO 6600-NOT-FOUND
 17204         DEPENDING ON DFHEIGDI
 17205     ELSE IF DFHEIGDJ EQUAL 37
 17206         GO TO 6700-NOTOPEN-ERROR,
 17207               6700-EXIT
 17208         DEPENDING ON DFHEIGDI
 17209     ELSE IF DFHEIGDJ EQUAL 38
 17210         GO TO 7120-NOT-FOUND
 17211         DEPENDING ON DFHEIGDI
 17212     ELSE IF DFHEIGDJ EQUAL 39
 17213         GO TO 7499-EXIT
 17214         DEPENDING ON DFHEIGDI
 17215     ELSE IF DFHEIGDJ EQUAL 40
 17216         GO TO 7500-EXIT,
 17217               7500-DUPLICATE-KEY,
 17218               7500-EXIT
 17219         DEPENDING ON DFHEIGDI
 17220     ELSE IF DFHEIGDJ EQUAL 41
 17221         GO TO 7500-END-BROWSE
 17222         DEPENDING ON DFHEIGDI
 17223     ELSE IF DFHEIGDJ EQUAL 42
 17224         GO TO 7630-END-BROWSE
 17225         DEPENDING ON DFHEIGDI
 17226     ELSE IF DFHEIGDJ EQUAL 43
* Micro Focus Server Express         V5.1 revision 000 11-Jan-18 10:07 Page 330
* EL130.cbl
 17227         GO TO 7799-EXIT,
 17228               7799-EXIT
 17229         DEPENDING ON DFHEIGDI
 17230     ELSE IF DFHEIGDJ EQUAL 44
 17231         GO TO 7790-END-BROWSE
 17232         DEPENDING ON DFHEIGDI
 17233     ELSE IF DFHEIGDJ EQUAL 45
 17234         GO TO 7992-NOT-FOUND
 17235         DEPENDING ON DFHEIGDI
 17236     ELSE IF DFHEIGDJ EQUAL 46
 17237         GO TO 8300-SEND-TEXT
 17238         DEPENDING ON DFHEIGDI.
 17239     MOVE '9%                    "   ' TO DFHEIV0
 17240     MOVE 'EL130' TO DFHEIV1
 17241     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17242     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12832     Code:       54847
