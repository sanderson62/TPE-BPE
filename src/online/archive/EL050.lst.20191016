* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    58* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    59* 092618  CR2018050200001  PEMA  Add check for open clm on issue
    60******************************************************************
    61 ENVIRONMENT DIVISION.
    62
    63 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   3
* EL050.cbl
    65 WORKING-STORAGE SECTION.
    66 01  DFH-START PIC X(04).
    67
    68 77  FILLER   PIC X(32) VALUE '********************************'.
    69 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    70 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    71
    72 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    73 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    74                                   USAGE POINTER.
    75 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    76 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    78                                   USAGE IS POINTER.
    79 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    80 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    81                                   USAGE IS POINTER.
    82 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    83 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    84                                   USAGE IS POINTER.
    85
    86 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    87 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    88                                   USAGE IS POINTER.
    89
    90*    COPY ELC50WS.
    91*****************************************************************
    92*                                                               *
    93*                            ELC50WS.                           *
    94*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    95*                            VMOD=2.061.                        *
    96*                                                               *
    97*   THIS IS THE WORKING STORAGE FOR EL050                       *
    98*                                   EL517                       *
    99*****************************************************************
   100******************************************************************
   101*                   C H A N G E   L O G
   102*
   103* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   104*-----------------------------------------------------------------
   105*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   106* EFFECTIVE    NUMBER
   107*-----------------------------------------------------------------
   108* 123102                   PEMA  ADD DCC PROCESSING
   109* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   110* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   111* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   112* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   113* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   114* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   115* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   116* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   117* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   118* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   119* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   120* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   121* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   122* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   4
* EL050.cbl
   123* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   124* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   125* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   126* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   127* 030309  CR2009021700001  PEMA  ADD ER-2883
   128* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   129* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   130* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   131* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   132* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   133* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   134* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   135* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   136* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   137* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   138* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   139* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   140* 061412  CR2011022800001  AJRA  NAPERSOFT
   141* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   142* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   143* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   144* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   145* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   146* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   147* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   148* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   149* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   150* 091114  IR2014091000001  TANA  ADD ERROR 2898
   151* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   152* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   153* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   154* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   155* 100617  CR2017062000003  PEMA  Inforce state comm cap
   156* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   157* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   158* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   159* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
   160* 100518  CR2017061500001  TANA  ADD NEW ERROR MSGS
   161* 092618  CR2018050200001  PEMA  Add check for open clm on issue
   162*-----------------------------------------------------------------
   163
   164 01  WORK-AREAS.
   165
   166*****************************************************************
   167*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   168*****************************************************************
   169
   170     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   171     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   172     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   173     12  WS-NAME-EDIT-WORK-AREA.
   174         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   175         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   176             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   177         16  WS-WORK-NAME.
   178             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   179             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   180             20  FILLER           PIC X(10)     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   5
* EL050.cbl
   181         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   182             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   183
   184*****************************************************************
   185*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   186*****************************************************************
   187
   188     12  WS-ERRESC-KEY.
   189         16 WS-ERRESC-SEARCH-KEY.
   190             20  WS-ERRESC-COMPANY-CD PIC  X.
   191             20  WS-ERRESC-CARRIER    PIC  X.
   192             20  WS-ERRESC-GROUP      PIC X(6).
   193             20  WS-ERRESC-STATE      PIC XX.
   194             20  WS-ERRESC-ACCOUNT    PIC X(10).
   195         16 WS-ERRESC-RESIDUAL-KEY.
   196             20  WS-ERRESC-AGENT      PIC X(10).
   197             20  WS-ERRESC-RES-STATE  PIC XX.
   198             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   199*                                          YYYYMMDD
   200     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   201     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   202
   203*RESIDENT STATE TAX MASTER(ERRESS)
   204*
   205     12  WS-ERRESS-KEY.
   206         16  WS-ERRESS-COMPANY-CD      PIC  X.
   207         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   208         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   209         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   210*                                          YYYYMMDD
   211
   212     12  WS-CONTRACT-DATE              PIC 9(8).
   213*                                          YYYYMMDD
   214     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   215     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   216         16 WS-YEAR-YY                 PIC   9999.
   217         16 FILLER                     PIC 9(4).
   218*                                          YYYYMMDD
   219     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   220     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   221     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   222     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   223
   224     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   225         88  DPRB-1ST-TIME                      VALUE ' '.
   226
   227*****************************************************************
   228*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   229*****************************************************************
   230
   231     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   232     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   233     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   234     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   235     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   236     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   237     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
   238     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   6
* EL050.cbl
   239     12  ws-st-agent-sig-edit    pic x          value spaces.
   240     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   241     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   244         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   245         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   246     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   247         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   248         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   249     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   250
   251     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   252     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   253
   254     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   255     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   260     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   261     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   264     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   265     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   266     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   267     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   268     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   269     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   278     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   279     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   280     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   281     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   282     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   283     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   284     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   285     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   286     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   287     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   288     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   289     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   290     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   291     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   292     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   293     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   294     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   295     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   296     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   7
* EL050.cbl
   297     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   298     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   299     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   300     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   301     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   302     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   303     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   304     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   305     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   306     12  WS-2671-SW               PIC X         VALUE SPACE.
   307     12  WS-2672-SW               PIC X         VALUE SPACE.
   308     12  ws-9813-sw               pic x         value spaces.
   309     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   310         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   311     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   312         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   313     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   314
   315     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   316         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   317         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   318         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   319         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   320
   321     12  WS-CREDIT-EDIT-CONTROLS.
   322         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   323         16  WS-MIN-AGE           PIC 99                VALUE  0.
   324         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   325         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   326         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   327         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   328
   329     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   330     12  WS-AGE-FIELDS.
   331         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   332         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   333         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   334         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   335
   336     12  WS-SAVE-ALLOWABLE-BENEFIT.
   337         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   338         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   339         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   340         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   341         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   342         16  FILLER                      PIC XX.
   343
   344     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   345     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   346     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   347     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   348     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   349     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   350     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   351     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   352     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   353     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   354
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   8
* EL050.cbl
   355     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   356     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   357     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   358     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   359     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   360     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   361     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   362     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   363         88  WS-REDUCING              VALUE 'R'.
   364         88  WS-LEVEL                 VALUE 'L' 'P'.
   365     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   366
   367     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   368     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   369     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   370     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   371     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   372     12  ws-ah-max-bens           pic 99        value zeros.
   373     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   374     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   375     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   376     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   377
   378     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   379     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   380     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   381     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   382     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   383     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   384     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   385     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   386     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   387     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   388     12  WS-ACCT-SIG-SW.
   389         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   390         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   391     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   392     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   393     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   394     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   395     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   396     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   397     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   398     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   399     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   400     12  WS-INITIALS.
   401         16  WS-INIT-1            PIC X         VALUE SPACES.
   402         16  WS-INIT-2            PIC X         VALUE SPACES.
   403
   404     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   405     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   406     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   407     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   408     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   409*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   410     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   411     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   412     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page   9
* EL050.cbl
   413     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   414     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   415     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   416     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   417     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   418     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   419     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   420     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   421     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   422     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   423     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   424     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   425     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   426     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   427     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   428     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   429     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   430     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   431     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   432******** FLA
   433     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   434     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   435     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   436     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   437     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   438********
   439     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   440     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   441     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   442     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   443     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   444     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   445     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   446     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   447     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   448     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   449
   450     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   451         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   452                                         '0' THRU '9'.
   453
   454     12  NUMBER-OF-MONTHS.
   455         16  SK-MO OCCURS 12 TIMES PIC X.
   456
   457     12  WS-WORK-DATE.
   458         16  WS-YEAR            PIC 99    VALUE 00.
   459         16  WS-MONTH           PIC 99    VALUE 00.
   460         16  WS-DAY             PIC 99    VALUE 00.
   461
   462     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   463     12  WS-WORK-CRIT-DEV       REDEFINES
   464         WS-WORK-LF-CRIT-PER    PIC X(03).
   465
   466     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   467     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   468
   469     12  WS-WORK-DATE-FROM.
   470         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  10
* EL050.cbl
   471         16  FILLER             PIC X  VALUE SPACE.
   472         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   473         16  FILLER             PIC X         VALUE SPACE.
   474         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   475
   476     12  WS-WORK-DATE-THRU.
   477         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   478         16  FILLER             PIC X         VALUE SPACE.
   479         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   480         16  FILLER             PIC X         VALUE SPACE.
   481         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   482
   483     12  WS-LF-INPUT-CD.
   484         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   485         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   486
   487     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   488     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   489         16  WS-AH-INPUT-CD-1   PIC X.
   490         16  WS-AH-INPUT-CD-2-3 PIC XX.
   491
   492     12  WS-SWITCHES.
   493         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   494         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   495             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   496         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   497             88  BANK-ACCT-FOUND          VALUE 'Y'.
   498         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   499             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   500         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   501             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   502         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   503             88  COMP-MASTER-FOUND        VALUE 'Y'.
   504         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   505             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   506         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   507             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   508         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   509             88  STAT-MASTER-FOUND        VALUE 'Y'.
   510         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   511             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   512         16  ELCRTT-FOUND-SW          PIC X    VALUE SPACES.
   513             88  ELCRTT-FOUND             VALUE 'Y'.
   514         16  ELCRTT-UPDATE-SW         PIC X    VALUE SPACES.
   515             88  ELCRTT-UPDATE            VALUE 'Y'.
   516         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   517             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   518         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   519             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   520         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   521             88  FORM-MASTER-FOUND        VALUE 'Y'.
   522         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   523             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   524         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   525             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   526         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   527             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   528         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  11
* EL050.cbl
   529             88  NO-BENEFIT-FOUND         VALUE 'N'.
   530         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   531             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   532         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   533             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   534         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   535             88  AH-BENEFIT-FOUND         VALUE ' '.
   536             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   537         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   538             88  LF-BENEFIT-FOUND         VALUE ' '.
   539             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   540         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   541             88  NO-STATE-RECORD          VALUE '1'.
   542         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   543             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   544         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   545             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   546         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   547             88  CERT-WAS-FOUND           VALUE ' '.
   548             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   549         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   550             88  BROWSE-STARTED           VALUE 'Y'.
   551         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   552             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   553         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   554             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   555         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   556             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   557         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   558             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   559         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   560             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   561         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   562             88  APP-CERT-USED            VALUE 'Y' 'A'.
   563         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   564             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   565             88  FIRST-TIME-THROUGH       VALUE '1'.
   566             88  CTBL-NOT-FOUND           VALUE '2'.
   567
   568         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   569             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   570
   571         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   572             88  DLO-ERROR-FOUND          VALUE 'Y'.
   573
   574********FLA
   575     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   576     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   577********
   578     12  RC-SW-1                  PIC X           VALUE '0'.
   579     12  RC-SW-2                  PIC X           VALUE '0'.
   580     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   581     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   582     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   583     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   584     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   585     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   586     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  12
* EL050.cbl
   587     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   588     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   589     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   590     12  LIT-SPACES               PIC X           VALUE SPACES.
   591     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   592     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   593     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   594     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   595     12  erpndm-unlock-sw         pic x           value spaces.
   596         88  need-to-unlock-erpndm  value 'Y'.
   597     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   598     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   599     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   600         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   601         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   602     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   603         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   604
   605 01  WS-EXTRA-PERIODS-BY-STATE.
   606     12  WS-INT-PERIODS          PIC 9.
   607     12  WS-EXTRA-PMTS           PIC 9.
   608 01  ws-net-only-state           pic x value 'N'.
   609 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   610     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   611     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   612 01  WS-CRI-SSN-WORK-AREA.
   613     05  WS-CRI-SOC-SEC-NO.
   614         10  WS-SS-REPT-CD       PIC X(5).
   615         10  WS-SS-LAST-NAME     PIC X(5).
   616         10  WS-SS-INITIAL       PIC X.
   617
   618     05  WS-CRI-REPORT-CODE.
   619         10  FILLER              PIC X(5).
   620         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   621
   622     05  WS-CRI-LAST-NAME.
   623         10  WS-CRI-NAME-MOVE    PIC X(5).
   624         10  FILLER              PIC X(10).
   625
   626 01  ws-state-commission-caps.
   627     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   628     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   629     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   630     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   631     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   632     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   633     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   634     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   635     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   636     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   637     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   638     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   639     05  ws-st-cap-limit-to      pic x.
   640     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   641     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   642     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   643     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   644     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  13
* EL050.cbl
   645     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   646     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   647     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   648     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   649     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   650     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   651     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   652 01  WS-NUM-TABLE                PIC X(26)  VALUE
   653     '12345678012345070923456789'.
   654 01  FILLER REDEFINES WS-NUM-TABLE.
   655     05  WS-NUM OCCURS 26        PIC 9.
   656 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   657 01  V1                          PIC S999 COMP-3.
   658 01  V2                          PIC S999 COMP-3.
   659 01  V3                          PIC S999 COMP-3.
   660 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   661 01  FILLER REDEFINES WS-WORK-VIN.
   662     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   663 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   664 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   665 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   666 01  WS-HEX-WORK.
   667     05  FILLER                  PIC X  VALUE LOW-VALUES.
   668     05  WS-HEX-BYTE             PIC X.
   669 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   670 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   671 01  WS-WORK-HIN-ROW-B.
   672     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   673
   674 01  ws-benefit-cd-chg-sw      pic x value spaces.
   675     88  benefit-code-chg           value 'Y'.
   676 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   677 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   678     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   679 01  WS-ROW-D-TABLE.
   680     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   681
   682 01  WS-HIN-TABLE-B.
   683     05  F                       PIC XX VALUE 'A2'.
   684     05  F                       PIC XX VALUE 'B3'.
   685     05  F                       PIC XX VALUE 'C4'.
   686     05  F                       PIC XX VALUE 'D5'.
   687     05  F                       PIC XX VALUE 'E6'.
   688     05  F                       PIC XX VALUE 'F7'.
   689     05  F                       PIC XX VALUE 'G8'.
   690     05  F                       PIC XX VALUE 'H9'.
   691     05  F                       PIC XX VALUE 'I1'.
   692     05  F                       PIC XX VALUE 'J2'.
   693     05  F                       PIC XX VALUE 'K3'.
   694     05  F                       PIC XX VALUE 'L4'.
   695     05  F                       PIC XX VALUE 'M5'.
   696     05  F                       PIC XX VALUE 'N6'.
   697     05  F                       PIC XX VALUE 'O0'.
   698     05  F                       PIC XX VALUE 'P7'.
   699     05  F                       PIC XX VALUE 'Q0'.
   700     05  F                       PIC XX VALUE 'R8'.
   701     05  F                       PIC XX VALUE 'S9'.
   702     05  F                       PIC XX VALUE 'T2'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  14
* EL050.cbl
   703     05  F                       PIC XX VALUE 'U3'.
   704     05  F                       PIC XX VALUE 'V4'.
   705     05  F                       PIC XX VALUE 'W5'.
   706     05  F                       PIC XX VALUE 'X6'.
   707     05  F                       PIC XX VALUE 'Y7'.
   708     05  F                       PIC XX VALUE 'Z8'.
   709 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   710     05  WS-VAL-IN               PIC X.
   711     05  WS-VAL-OUT              PIC 9.
   712 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   713 01  ws-greg-eff-date            pic x(10) value ' '.
   714 01  WS-COMPARE-BINARY-DATES.
   715     05  WS-971231                PIC XX VALUE X'92FF'.
   716     05  WS-931231                PIC XX VALUE X'8CFF'.
   717     05  WS-791231                PIC XX VALUE X'77FF'.
   718     05  WS-771001                PIC XX VALUE X'74A1'.
   719     05  WS-820301                PIC XX VALUE X'7B41'.
   720     05  WS-831031                PIC XX VALUE X'7DBF'.
   721     05  WS-831231                PIC XX VALUE X'7DFF'.
   722     05  WS-810831                PIC XX VALUE X'7A7F'.
   723     05  WS-830901                PIC XX VALUE X'7D81'.
   724
   725 01  FILE-ACCESS-IDS.
   726     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   727     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   728     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   729     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   730     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   731     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   732     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   733     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   734     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   735     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   736     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   737     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   738     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   739     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   740     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   741     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   742     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   743 01  DD-IU-SW                    PIC X   VALUE ' '.
   744     88  DD-IU-PRESENT                 VALUE 'Y'.
   745
   746 01  ACCESS-KEYS.
   747     12  ELMSTR-KEY.
   748         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   749         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   750     12  W-CLAIM-KEY.
   751         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   752         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   753
   754     12  ELCNTL-KEY.
   755         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   756         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   757         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   758         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   759
   760     12  ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  15
* EL050.cbl
   761         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   762         16  CERT-CARRIER         PIC X       VALUE SPACE.
   763         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   764         16  CERT-STATE           PIC XX      VALUE SPACES.
   765         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   766         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   767         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   768
   769     12  ELCERT2-KEY.
   770         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   771         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   772
   773     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   774
   775     12  ELCERT-SAVE.
   776         16  FILLER                      PIC XX    VALUE SPACES.
   777
   778         16  WCS-CONTROL-PRIMARY.
   779             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   780             20  WCS-CARRIER             PIC X     VALUE SPACE.
   781             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   782             20  WCS-STATE               PIC XX    VALUE SPACES.
   783             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   784             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   785             20  WCS-CERT-NO.
   786                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   787                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   788
   789         16  CS-CONTROL-BY-NAME.
   790             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   791             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   792             20  CS-INSURED-INITIALS.
   793                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   794                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   795
   796         16  CS-CONTROL-BY-SSN.
   797             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   798             20  CS-SOC-SEC-NO.
   799                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   800                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   801                 24  CS-SSN-LN3.
   802                     28 CS-INSURED-INITIALS-A2   PIC XX
   803                                     VALUE SPACES.
   804                     28 CS-PART-LAST-NAME-A2     PIC X
   805                                     VALUE SPACE.
   806
   807         16  CS-CONTROL-BY-CERT-NO.
   808             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   809             20  CS-CERT-NO-A4           PIC X(11)
   810                                     VALUE SPACES.
   811
   812         16  CS-CONTROL-BY-MEMB.
   813             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   814             20  CS-MEMBER-NO.
   815                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   816                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   817                 24  CS-MEMB-LN4.
   818                     28 CS-INSURED-INITIALS-A5   PIC XX
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  16
* EL050.cbl
   819                                      VALUE SPACES.
   820                     28 CS-PART-LAST-NAME-A5     PIC XX
   821                                      VALUE SPACES.
   822
   823         16  FILLER              PIC X(360) VALUE SPACES.
   824
   825     12  ERACCT-KEY.
   826         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   827         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   828         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   829         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   830         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   831         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   832
   833     12  ERCOMP-KEY.
   834         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   835         16  COMP-CARRIER         PIC X     VALUE SPACES.
   836         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   837         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   838         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   839         16  COMP-TYPE            PIC X     VALUE SPACES.
   840
   841     12  ERLOFC-KEY.
   842         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   843         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   844         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   845         16  LOFC-STATE           PIC XX    VALUE SPACES.
   846         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   847         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   848
   849     12  WS-ELCRTT-KEY.
   850         16  WS-ELCRTT-PRIMARY       PIC X(33).
   851         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   852
   853     12  ERBXRF-KEY.
   854         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   855         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   856         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   857         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   858
   859     12  ERAGTC-KEY.
   860         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   861         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   862         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   863         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   864         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   865         16  AGTC-TYPE            PIC X     VALUE SPACES.
   866
   867     12  ERPLAN-KEY.
   868         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   869         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   870         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   871         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   872         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   873         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   874         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   875         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   876
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  17
* EL050.cbl
   877     12  ERFORM-KEY.
   878         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   879         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   880         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   881         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   882
   883     12  ERREIN-KEY.
   884         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   885         16  REIN-TYPE            PIC X     VALUE SPACES.
   886         16  REIN-TABLE-CO.
   887             20  REIN-CODE-1      PIC X     VALUE SPACE.
   888             20  REIN-CODE-2      PIC X     VALUE SPACE.
   889             20  REIN-CODE-3      PIC X     VALUE SPACE.
   890         16  FILLER               PIC X(3)  VALUE SPACES.
   891
   892     12  ERCTBL-KEY.
   893         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   894         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   895         16  CTBL-CNTRL-2.
   896             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   897             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   898
   899     12  ELCRTO-KEY.
   900         16  ELCRTO-COMPANY-CD       PIC X.
   901         16  ELCRTO-CARRIER          PIC X.
   902         16  ELCRTO-GROUPING         PIC X(6).
   903         16  ELCRTO-STATE            PIC XX.
   904         16  ELCRTO-ACCOUNT          PIC X(10).
   905         16  ELCRTO-CERT-EFF-DT      PIC XX.
   906         16  ELCRTO-CERT-NO.
   907             20  ELCRTO-CERT-PRIME   PIC X(10).
   908             20  ELCRTO-CERT-SFX     PIC X.
   909         16  ELCRTO-RECORD-TYPE      PIC X.
   910         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   911
   912
   913     12  WS-ACCESS.
   914         16  FILLER               PIC XX    VALUE SPACES.
   915         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   916
   917     12  WS-CARR-ACCESS.
   918         16  FILLER               PIC X(3)  VALUE SPACES.
   919         16  WS-CARR              PIC X     VALUE SPACE.
   920*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   921*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   922     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   923         88  WS-DMD-LF-RATING   VALUE 'Y'.
   924         88  WS-DMD-AH-RATING   VALUE 'Y'.
   925         88  WS-DMD-NO-RATING   VALUE 'N'.
   926
   927     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   928         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   929                                         'NJ' 'NL'
   930                                         'PJ' 'PL'
   931                                         'SJ' 'SL'.
   932     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   933         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   934                                         'NI' 'NJ' 'NL' 'NU'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  18
* EL050.cbl
   935                                         'PJ' 'PL' 'PI' 'PU'
   936                                         'SI' 'SJ' 'SL' 'SU'
   937                                         'MX' 'MY' 'MZ'.
   938 01  ERPDEF-KEY-SAVE             PIC X(18).
   939 01  ERPDEF-KEY.
   940     12  ERPDEF-COMPANY-CD       PIC X.
   941     12  ERPDEF-STATE            PIC XX.
   942     12  ERPDEF-PROD-CD          PIC XXX.
   943     12  F                       PIC X(7).
   944     12  ERPDEF-BEN-TYPE         PIC X.
   945     12  ERPDEF-BEN-CODE         PIC XX.
   946     12  ERPDEF-EXP-DT           PIC XX.
   947
   948 01  ELSTAT-KEY-SAVE             PIC X(20).
   949 01  ELSTAT-KEY.
   950     12  ELSTAT-COMPANY-ID       PIC XXX.
   951     12  ELSTAT-CARRIER          PIC X.
   952     12  ELSTAT-GROUP            PIC X(6).
   953     12  ELSTAT-STATE            PIC XX.
   954     12  ELSTAT-EXP-DT           PIC 9(8).
   955 01  WS-ERROR-VALUES.
   956     12  ER-1570                     PIC S9(4)   VALUE +1570.
   957     12  ER-1571                     PIC S9(4)   VALUE +1571.
   958     12  er-1572                     pic s9(4)   value +1572.
   959     12  er-1573                     pic s9(4)   value +1573.
   960     12  er-1574                     pic s9(4)   value +1574.
   961     12  ER-1575                     PIC S9(4)   VALUE +1575.
   962     12  er-1576                     pic s9(4)   value +1576.
   963     12  er-1583                     pic s9(4)   value +1583.
   964     12  er-1743                     pic s9(4)   value +1743.
   965     12  er-1744                     pic s9(4)   value +1744.
   966     12  er-1745                     pic s9(4)   value +1745.
   967     12  er-1746                     pic s9(4)   value +1746.
   968     12  er-1747                     pic s9(4)   value +1747.
   969     12  er-1748                     pic s9(4)   value +1748.
   970     12  er-1749                     pic s9(4)   value +1749.
   971     12  er-1750                     pic s9(4)   value +1750.
   972     12  er-1751                     pic s9(4)   value +1751.
   973     12  er-1752                     pic s9(4)   value +1752.
   974     12  er-1753                     pic s9(4)   value +1753.
   975     12  er-1754                     pic s9(4)   value +1754.
   976     12  er-1755                     pic s9(4)   value +1755.
   977     12  er-1756                     pic s9(4)   value +1756.
   978     12  er-1757                     pic s9(4)   value +1757.
   979     12  er-1758                     pic s9(4)   value +1758.
   980     12  er-1759                     pic s9(4)   value +1759.
   981     12  er-1760                     pic s9(4)   value +1760.
   982     12  er-1761                     pic s9(4)   value +1761.
   983     12  ER-1891                     PIC S9(4)   VALUE +1891.
   984     12  ER-1892                     PIC S9(4)   VALUE +1892.
   985     12  ER-1893                     PIC S9(4)   VALUE +1893.
   986     12  ER-1894                     PIC S9(4)   VALUE +1894.
   987     12  ER-1895                     PIC S9(4)   VALUE +1895.
   988     12  ER-1896                     PIC S9(4)   VALUE +1896.
   989     12  ER-1897                     PIC S9(4)   VALUE +1897.
   990     12  ER-1898                     PIC S9(4)   VALUE +1898.
   991     12  ER-1899                     PIC S9(4)   VALUE +1899.
   992     12  ER-1900                     PIC S9(4)   VALUE +1900.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  19
* EL050.cbl
   993     12  ER-1901                     PIC S9(4)   VALUE +1901.
   994     12  ER-1902                     PIC S9(4)   VALUE +1902.
   995     12  ER-1903                     PIC S9(4)   VALUE +1903.
   996     12  ER-1904                     PIC S9(4)   VALUE +1904.
   997     12  ER-1905                     PIC S9(4)   VALUE +1905.
   998     12  ER-1906                     PIC S9(4)   VALUE +1906.
   999     12  ER-1907                     PIC S9(4)   VALUE +1907.
  1000     12  ER-1909                     PIC S9(4)   VALUE +1909.
  1001     12  ER-1910                     PIC S9(4)   VALUE +1910.
  1002     12  ER-1911                     PIC S9(4)   VALUE +1911.
  1003     12  ER-1912                     PIC S9(4)   VALUE +1912.
  1004     12  ER-1913                     PIC S9(4)   VALUE +1913.
  1005     12  ER-1914                     PIC S9(4)   VALUE +1914.
  1006     12  ER-1915                     PIC S9(4)   VALUE +1915.
  1007     12  ER-1916                     PIC S9(4)   VALUE +1916.
  1008     12  ER-1917                     PIC S9(4)   VALUE +1917.
  1009     12  ER-1918                     PIC S9(4)   VALUE +1918.
  1010     12  ER-1919                     PIC S9(4)   VALUE +1919.
  1011     12  ER-1920                     PIC S9(4)   VALUE +1920.
  1012     12  ER-1921                     PIC S9(4)   VALUE +1921.
  1013     12  ER-1922                     PIC S9(4)   VALUE +1922.
  1014     12  ER-1923                     PIC S9(4)   VALUE +1923.
  1015     12  ER-1924                     PIC S9(4)   VALUE +1924.
  1016     12  ER-1925                     PIC S9(4)   VALUE +1925.
  1017     12  ER-1926                     PIC S9(4)   VALUE +1926.
  1018     12  ER-1927                     PIC S9(4)   VALUE +1927.
  1019     12  ER-1955                     PIC s9(4)   VALUE +1955.
  1020     12  ER-1956                     PIC s9(4)   VALUE +1956.
  1021     12  ER-1957                     PIC s9(4)   VALUE +1957.
  1022     12  ER-1958                     PIC s9(4)   VALUE +1958.
  1023     12  ER-1959                     PIC s9(4)   VALUE +1959.
  1024     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1025     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1026     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1027     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1028     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1029     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1030     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1031     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1032     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1033     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1034     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1035     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1036     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1037     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1038     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1039     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1040     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1041     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1042     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1043     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1044     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1045     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1046     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1047     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1048     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1049     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1050     12  ER-2621                     PIC S9(4)   VALUE +2621.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  20
* EL050.cbl
  1051     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1052     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1053     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1054     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1055     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1056     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1057     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1058     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1059     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1060     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1061     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1062     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1063     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1064     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1065     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1066     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1067     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1068     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1069     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1070     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1071     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1072     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1073     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1074     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1075     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1076     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1077     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1078     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1079     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1080     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1081     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1082     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1083     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1084     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1085     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1086     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1087     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1088     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1089     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1090     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1091     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1092     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1093     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1094     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1095     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1096     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1097     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1098     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1099     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1100     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1101     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1102     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1103     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1104     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1105     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1106     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1107     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1108     12  ER-2679                     PIC S9(4)   VALUE +2679.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  21
* EL050.cbl
  1109     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1110     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1111     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1112     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1113     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1114     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1115     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1116     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1117     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1118     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1119     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1120     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1121     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1122     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1123     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1124     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1125     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1126     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1127     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1128     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1129     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1130     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1131     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1132     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1133     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1134     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1135     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1136     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1137     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1138     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1139     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1140     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1141     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1142     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1143     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1144     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1145     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1146     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1147     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1148     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1149     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1150     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1151     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1152     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1153     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1154     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1155     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1156     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1157     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1158     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1159     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1160     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1161     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1162     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1163     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1164     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1165     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1166     12  ER-2747                     PIC S9(4)   VALUE +2747.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  22
* EL050.cbl
  1167     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1168     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1169     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1170     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1171     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1172     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1173     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1174     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1175     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1176     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1177     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1178     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1179     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1180     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1181     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1182     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1183     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1184     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1185     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1186     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1187     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1188     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1189     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1190     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1191     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1192     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1193     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1194     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1195     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1196     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1197     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1198     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1199     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1200     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1201     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1202     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1203     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1204     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1205     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1206     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1207     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1208     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1209     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1210     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1211     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1212     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1213     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1214     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1215     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1216     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1217     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1218     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1219     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1220     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1221     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1222     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1223     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1224     12  ER-2889                     PIC S9(4)   VALUE +2889.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  23
* EL050.cbl
  1225     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1226     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1227     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1228     12  ER-2894                     PIC S9(4)   VALUE +2894.
  1229     12  ER-2895                     PIC S9(4)   VALUE +2895.
  1230     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1231     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1232     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1233     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1234     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1235     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1236     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1237     12  ER-2998                     PIC S9(4)   VALUE +2998.
  1238     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1239     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1240     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1241     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1242     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1243     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1244     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1245     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1246     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1247     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1248     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1249     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1250     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1251     12  er-3270                     pic s9(4)   value +3270.
  1252     12  er-3273                     pic s9(4)   value +3273.
  1253     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1254     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1255     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1256     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1257     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1258     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1259     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1260     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1261     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1262     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1263     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1264     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1265     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1266     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1267     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1268     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1269     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1270     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1271     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1272     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1273     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1274     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1275     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1276     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1277     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1278     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1279     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1280     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1281     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1282     12  ER-8043                     PIC S9(4)   VALUE +8043.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  24
* EL050.cbl
  1283     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1284     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1285     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1286     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1287     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1288     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1289     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1290     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1291     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1292     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1293     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1294     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1295     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1296     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1297     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1298     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1299     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1300     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1301     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1302     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1303     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1304     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1305     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1306     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1307     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1308     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1309     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1310     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1311     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1312     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1313     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1314     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1315     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1316     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1317     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1318     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1319     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1320     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1321     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1322     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1323     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1324     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1325     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1326     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1327     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1328     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1329     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1330     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1331     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1332     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1333     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1334     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1335     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1336     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1337     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1338     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1339     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1340     12  ER-8317                     PIC S9(4)   VALUE +8317.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  25
* EL050.cbl
  1341     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1342     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1343     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1344     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1345     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1346     12  er-9823                     pic s9(4)   value +9823.
  1347     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1348******************************************************************
  1349***************   END OF ELC50WS     ****************************
  1350******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  26
* EL050.cbl
  1353 01  WORKING-STORAGE-WORK-AREAS.
  1354     12  WS-RESPONSE             PIC S9(8)  COMP.
  1355         88  WS-RESP-NORMAL           VALUE +00.
  1356         88  WS-RESP-ERROR            VALUE +01.
  1357         88  WS-RESP-NOTFND           VALUE +13.
  1358         88  WS-RESP-DUPREC           VALUE +14.
  1359         88  WS-RESP-ENDFILE          VALUE +20.
  1360     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1361     12  WORK-AREAS.
  1362         16  WK-CONV-GREG.
  1363             24  WCG-CENT             PIC XX.
  1364             24  WCG-REST             PIC X(4).
  1365         16  WORK-GREGORIAN-DATE.
  1366             24  WK-GREG-CENT         PIC XX.
  1367             24  WK-GREG-DATE-YYMMDD.
  1368                 28  WK-GREG-YYMM     PIC X(4).
  1369                 28  WK-GREG-DD       PIC XX.
  1370
  1371         16  WORK-SELECT-DATE.
  1372             24  WK-SELECT-CENT            PIC XX.
  1373             24  WK-SELECT-DATE-YYMMDD.
  1374                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1375                 28  FILLER                PIC XX.
  1376
  1377         16  WK-FORM-NO.
  1378             24  WK-FORM-BANK-ID       PIC X(5).
  1379             24  WK-FORM-UNDRWRTR      PIC X(1).
  1380             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1381
  1382         16  WK-MEMBER-NO.
  1383             24  WK-MEMBER-1-6        PIC X(6).
  1384             24  WK-MEMBER-7-12       PIC X(6).
  1385
  1386         16  WK-FULL-CERT-NO.
  1387             24  WK-CERT-POS-1-2      PIC X(2).
  1388             24  WK-CERT-POS-3        PIC X(1).
  1389             24  WK-CERT-POS-4        PIC X(1).
  1390             24  WK-CERT-POS-5-6      PIC X(2).
  1391             24  WK-CERT-POS-7        PIC X(1).
  1392             24  WK-CERT-POS-8-11     PIC X(4).
  1393
  1394         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1395             88  VALID-RATE-CODE        VALUE 'Y'.
  1396             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1397
  1398         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1399         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1400         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1401         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1402         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1403         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1404         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1405         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1406         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1407         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1408
  1409* DLO001
  1410 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  27
* EL050.cbl
  1411     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1412     12  DMPF-RETURN-CODE          PIC XX.
  1413         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1414         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1415         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1416         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1417         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1418         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1419
  1420* DLO002
  1421 01  WS-DLO-INTERNAL-POLICY-FORM.
  1422     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1423     12  DIPF-RETURN-CODE          PIC XX.
  1424         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1425         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1426         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1427         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1428         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1429         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1430
  1431* DLO003
  1432 01  WS-DLO-VALID-BANK-ID.
  1433     12  DVBI-BANK-ID              PIC X(5).
  1434     12  DVBI-BANK-ID-TYPE         PIC X.
  1435         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1436         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1437         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1438         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1439         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1440     12  DVBI-RETURN-CODE          PIC XX.
  1441         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1442         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1443         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1444         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1445         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1446         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1447         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1448         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1449         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1450
  1451* DLO007
  1452 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1453     12  DCUA-RES-STATE            PIC XX.
  1454     12  DCUA-BEN-TYPE             PIC XX.
  1455     12  DCUA-SYS-IDENT            PIC X.
  1456         88  DCUA-CLAIM                        VALUE 'C'.
  1457         88  DCUA-PREMIUM                      VALUE 'P'.
  1458     12  DCUA-COVERAGE-RULE        PIC X.
  1459     12  DCUA-CLIENT-ID            PIC X(10).
  1460     12  DCUA-EFF-DATE             PIC X(8).
  1461     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1462     12  DCUA-RETURN-CODE          PIC XX.
  1463         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1464     12  DCUA-CERT-NUMBER          PIC X(11).
  1465     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1466     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1467
  1468* DLO011
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  28
* EL050.cbl
  1469 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1470     12  DPRB-RATE-CODE            PIC X(4).
  1471     12  DPRB-COVERAGE-CATEG       PIC X.
  1472     12  DPRB-RETURN-CODE          PIC XX.
  1473         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1474         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1475         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1476         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1477         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1478         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1479         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1480         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1481         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1482     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1483     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1484     12  DPRB-BEN-TYPE             PIC XX.
  1485
  1486* DLO017
  1487 01  WS-DLO-VALID-RATE-CODE.
  1488     12  DVRC-RATE-CODE            PIC X(4).
  1489     12  DVRC-RETURN-CODE          PIC XX.
  1490         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1491         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1492         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1493         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1494         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1495         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1496
  1497* DLO019
  1498 01  WS-DLO-ORIG-COV-CAT.
  1499     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1500     12  DOCC-RETURN-CODE          PIC XX.
  1501     12  DOCC-ORIG-COV-CAT         PIC X.
  1502     12  DOCC-UNDERWITER           PIC XX.
  1503     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1504     12  DOCC-FILLER               PIC X(6).
  1505
  1506* DLO021
  1507 01  WS-DLO-VALID-LOAN-OFFICER.
  1508     12  DVLO-LOAN-OFFICER.
  1509         16  DVLO-BILL-TYPE        PIC X.
  1510         16  DVLO-BILL-SOURCE      PIC X.
  1511         16  DVLO-BATCH-TYPE       PIC X.
  1512     12  DVLO-RETURN-CODE          PIC XX.
  1513         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1514         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1515         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1516         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1517         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1518         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1519
  1520* DLO022
  1521 01  WS-DLO-VALID-STATE-CODE.
  1522     12  DVSC-STATE-CODE           PIC XX.
  1523     12  DVSC-RETURN-CODE          PIC XX.
  1524         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1525
  1526* DLO023
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  29
* EL050.cbl
  1527 01  WS-DLO-VALID-CODE-VALUES.
  1528     12  DVCV-SYSTEM-ID            PIC XX.
  1529         88  DVCV-CLAIMS                       VALUE 'CL'.
  1530         88  DVCV-CREDIT                       VALUE 'CR'.
  1531     12  DVCV-RECORD-TYPE          PIC XX.
  1532         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1533         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1534         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1535         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1536         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1537         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1538         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1539         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1540     12  DVCV-RECORD-KEY           PIC X(6).
  1541     12  DVCV-RETURN-CODE          PIC XX.
  1542         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1543         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1544         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1545         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1546         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1547         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1548         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1549     12  DVCV-CODE-DESC            PIC X(60).
  1550     12  DVCV-GEN-DESC-1           PIC X(20).
  1551     12  DVCV-GEN-DESC-2           PIC X(20).
  1552     12  DVCV-GEN-DESC-3           PIC X(20).
  1553
  1554 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1555 01  hldi-pass-area.
  1556     03  PA-VIN                  PIC X(17).
  1557     03  PA-ErrorCode            PIC X(10).
  1558     03  PA-ErrorDesc            PIC X(30).
  1559     03  PA-ModelYear            PIC 9(7).
  1560     03  PA-MakeName             PIC X(50).
  1561     03  PA-ModelName            PIC X(50).
  1562     03  PA-SeriesName           PIC X(50).
  1563 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1564 01  zipcd-pass-area.
  1565     03  PA-zip                  PIC X(5).
  1566     03  PA-ErrorCode-zip        PIC X(10).
  1567     03  PA-city                 PIC x(50).
  1568     03  PA-state                PIC Xx.
  1569 01  clmhs-pass-area-len         pic s9(4) comp value +40.
  1570 01  clmhs-pass-area.
  1571     03  pa-clmhs-state          pic xx.
  1572     03  pa-account              pic x(10).
  1573     03  pa-eff-dt               pic x(10).
  1574     03  pa-cert-no              pic x(11).
  1575     03  pa-clm-count            pic 9(5).
  1576****  this is for aggregate report.
  1577****  Length is erpndb + 100 of passed-key-area
  1578 01  ws-passed-key-length        pic s9(4) comp value +587.
  1579 01  ws-pass-to-pemaggo.
  1580     05  ws-passed-erpndb        pic x(585).
  1581     05  ws-exceed-limit-yn      pic x.
  1582     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  30
* EL050.cbl
  1584*    COPY ERCBXRF.
  1585******************************************************************
  1586*                                                                *
  1587*                                                                *
  1588*                            ERCBXRF                             *
  1589*                                                                *
  1590*   ONLINE CREDIT SYSTEM                                         *
  1591*                                                                *
  1592*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1593*                                                                *
  1594*   FILE TYPE = VSAM,KSDS                                        *
  1595*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1596*                                                                *
  1597*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1598*       ALTERNATE PATH = NONE                                    *
  1599*                                                                *
  1600*   LOG = NO                                                     *
  1601*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1602*                                                                *
  1603******************************************************************
  1604
  1605 01  BANK-CROSS-REFERENCE.
  1606     12  BK-RECORD-ID                PIC XX.
  1607         88  VALID-BK-ID             VALUE 'BK'.
  1608
  1609     12  BK-CONTROL-PRIMARY.
  1610         16  BK-COMPANY-CD           PIC X.
  1611         16  BK-CARRIER              PIC X.
  1612         16  BK-GROUPING             PIC X(6).
  1613         16  BK-BANK-NO              PIC X(10).
  1614
  1615     12  BK-MAINT-INFORMATION.
  1616         16  BK-LAST-MAINT-DT        PIC XX.
  1617         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1618         16  BK-LAST-MAINT-USER      PIC X(4).
  1619         16  FILLER                  PIC X(9).
  1620
  1621     12  FILLER                      PIC X(37).
  1622
  1623     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1624
  1625     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1626                            DEPENDING ON BK-BANK-POINTER-CNT.
  1627         16  BK-AM-ACCOUNT           PIC X(10).
  1628         16  BK-AM-EXP-DT            PIC XX.
  1629         16  BK-AM-EFF-DT            PIC XX.
  1630         16  BK-AM-STATE             PIC XX.
  1631         16  FILLER                  PIC X(20).
  1632
  1633******************************************************************
  1634
  1635*    COPY ERCCOMP.
  1636******************************************************************
  1637*                                                                *
  1638*                                                                *
  1639*                            ERCCOMP                             *
  1640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1641*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  31
* EL050.cbl
  1642*                                                                *
  1643*   ONLINE CREDIT SYSTEM                                         *
  1644*                                                                *
  1645*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1646*                                                                *
  1647*   FILE TYPE = VSAM,KSDS                                        *
  1648*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1649*                                                                *
  1650*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1651*       ALTERNATE PATH = NONE                                    *
  1652*                                                                *
  1653*   LOG = NO                                                     *
  1654*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1655*                                                                *
  1656******************************************************************
  1657*                   C H A N G E   L O G
  1658*
  1659* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1660*-----------------------------------------------------------------
  1661*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1662* EFFECTIVE    NUMBER
  1663*-----------------------------------------------------------------
  1664* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1665* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1666* 092205    2005050300006  PEMA  ADD LEASE FEE
  1667* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1668* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1669* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1670* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1671* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1672* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1673******************************************************************
  1674
  1675 01  COMPENSATION-MASTER.
  1676     12  CO-RECORD-ID                          PIC XX.
  1677         88  VALID-CO-ID                          VALUE 'CO'.
  1678
  1679     12  CO-CONTROL-PRIMARY.
  1680         16  CO-COMPANY-CD                     PIC X.
  1681         16  CO-CONTROL.
  1682             20  CO-CTL-1.
  1683                 24  CO-CARR-GROUP.
  1684                     28  CO-CARRIER            PIC X.
  1685                     28  CO-GROUPING.
  1686                         32  CO-GROUP-PREFIX   PIC XXX.
  1687                         32  CO-GROUP-PRIME    PIC XXX.
  1688                 24  CO-RESP-NO.
  1689                     28  CO-RESP-PREFIX        PIC X(4).
  1690                     28  CO-RESP-PRIME         PIC X(6).
  1691             20  CO-CTL-2.
  1692                 24  CO-ACCOUNT.
  1693                     28  CO-ACCT-PREFIX        PIC X(4).
  1694                     28  CO-ACCT-PRIME         PIC X(6).
  1695         16  CO-TYPE                           PIC X.
  1696             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1697             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1698             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1699
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  32
* EL050.cbl
  1700     12  CO-MAINT-INFORMATION.
  1701         16  CO-LAST-MAINT-DT                  PIC XX.
  1702         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1703         16  CO-LAST-MAINT-USER                PIC X(4).
  1704     12  FILLER                                PIC XX.
  1705     12  CO-STMT-TYPE                          PIC XXX.
  1706     12  CO-COMP-TYPE                          PIC X.
  1707         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1708     12  CO-STMT-OWNER                         PIC X(4).
  1709     12  CO-BALANCE-CONTROL                    PIC X.
  1710         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1711         88  CO-NO-BALANCE                        VALUE 'N'.
  1712
  1713     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1714         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1715         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1716         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1717
  1718     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1719         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1720         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1721
  1722     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1723     12  CO-GA-DIRECT-DEP                      PIC X.
  1724     12  CO-FUTURE-SPACE                       PIC X.
  1725         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1726
  1727     12  CO-ACCT-NAME                          PIC X(30).
  1728     12  CO-MAIL-NAME                          PIC X(30).
  1729     12  CO-ADDR-1                             PIC X(30).
  1730     12  CO-ADDR-2                             PIC X(30).
  1731     12  CO-ADDR-3.
  1732         16  CO-ADDR-CITY                      PIC X(27).
  1733         16  CO-ADDR-STATE                     PIC XX.
  1734     12  CO-CSO-1099                           PIC X.
  1735     12  CO-ZIP.
  1736         16  CO-ZIP-PRIME.
  1737             20  CO-ZIP-PRI-1ST                PIC X.
  1738                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1739             20  FILLER                        PIC X(4).
  1740         16  CO-ZIP-PLUS4                      PIC X(4).
  1741     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1742         16  CO-CAN-POSTAL-1                   PIC XXX.
  1743         16  CO-CAN-POSTAL-2                   PIC XXX.
  1744         16  FILLER                            PIC XXX.
  1745     12  CO-SOC-SEC                            PIC X(13).
  1746     12  CO-TELEPHONE.
  1747         16  CO-AREA-CODE                      PIC XXX.
  1748         16  CO-PREFIX                         PIC XXX.
  1749         16  CO-PHONE                          PIC X(4).
  1750
  1751     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1752
  1753     12  CO-AR-BAL-LEVEL                       PIC X.
  1754         88  CO-AR-REF-LVL                        VALUE '1'.
  1755         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1756         88  CO-AR-BILL-LVL                       VALUE '2'.
  1757         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  33
* EL050.cbl
  1758         88  CO-AR-FR-LVL                         VALUE '4'.
  1759
  1760     12  CO-AR-NORMAL-PRINT                    PIC X.
  1761         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1762         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1763
  1764     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1765
  1766     12  CO-AR-REPORTING                       PIC X.
  1767         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1768         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1769
  1770     12  CO-AR-PULL-CHECK                      PIC X.
  1771         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1772         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1773
  1774     12  CO-AR-BALANCE-PRINT                   PIC X.
  1775         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1776
  1777     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1778         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1779         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1780         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1781
  1782     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1783
  1784     12  CO-USER-CODE                          PIC X.
  1785     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1786
  1787******************************************************************
  1788*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1789*    THE LAST MONTH END RUN.
  1790******************************************************************
  1791
  1792     12  CO-LAST-ACTIVITY-DATE.
  1793         16  CO-ACT-YEAR                       PIC 99.
  1794         16  CO-ACT-MONTH                      PIC 99.
  1795         16  CO-ACT-DAY                        PIC 99.
  1796
  1797     12  CO-LAST-STMT-DT.
  1798         16  CO-LAST-STMT-YEAR                 PIC 99.
  1799         16  CO-LAST-STMT-MONTH                PIC 99.
  1800         16  CO-LAST-STMT-DAY                  PIC 99.
  1801
  1802     12  CO-MO-END-TOTALS.
  1803         16  CO-MONTHLY-TOTALS.
  1804             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1805             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1806             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1807             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1808             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1809
  1810         16  CO-AGING-TOTALS.
  1811             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1812             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1813             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1814             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1815
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  34
* EL050.cbl
  1816         16  CO-YTD-TOTALS.
  1817             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1818             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1819
  1820         16  CO-OVER-UNDER-TOTALS.
  1821             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1822             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1823
  1824     12  CO-MISCELLANEOUS-TOTALS.
  1825         16  CO-FICA-TOTALS.
  1826             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1827             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1828
  1829         16  CO-CLAIM-TOTALS.
  1830             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1831             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1832
  1833******************************************************************
  1834*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1835*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1836******************************************************************
  1837
  1838     12  CO-CURRENT-TOTALS.
  1839         16  CO-CURRENT-LAST-STMT-DT.
  1840             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1841             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1842             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1843
  1844         16  CO-CURRENT-MONTHLY-TOTALS.
  1845             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1846             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1847             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1848             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1849             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1850
  1851         16  CO-CURRENT-AGING-TOTALS.
  1852             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1853             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1854             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1855             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1856
  1857         16  CO-CURRENT-YTD-TOTALS.
  1858             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1859             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1860
  1861     12  CO-PAID-COMM-TOTALS.
  1862         16  CO-YTD-PAID-COMMS.
  1863             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1864             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1865
  1866     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1867         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1868         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1869
  1870     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1871         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1872         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1873         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  35
* EL050.cbl
  1874         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1875         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1876         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1877         88  CO-FINAL-LETTER                  VALUE 'F'.
  1878         88  CO-RECONCILING                   VALUE 'R'.
  1879         88  CO-PHONE-CALL                    VALUE 'P'.
  1880         88  CO-LEGAL                         VALUE 'L'.
  1881         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1882         88  CO-WRITE-OFF                     VALUE 'W'.
  1883         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1884
  1885     12  CO-CSR-CODE                       PIC X(4).
  1886
  1887     12  CO-GA-STATUS-INFO.
  1888         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1889         16  CO-GA-TERMINATION-DT          PIC XX.
  1890         16  CO-GA-STATUS-CODE             PIC X.
  1891             88  CO-GA-ACTIVE                 VALUE 'A'.
  1892             88  CO-GA-INACTIVE               VALUE 'I'.
  1893             88  CO-GA-PENDING                VALUE 'P'.
  1894         16  CO-GA-COMMENTS.
  1895             20  CO-GA-COMMENT-1           PIC X(40).
  1896             20  CO-GA-COMMENT-2           PIC X(40).
  1897             20  CO-GA-COMMENT-3           PIC X(40).
  1898             20  CO-GA-COMMENT-4           PIC X(40).
  1899
  1900     12  CO-RPTCD2                         PIC X(10).
  1901     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1902         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1903         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1904
  1905     12  CO-TYPE-AGENT                     PIC X(01).
  1906         88  CO-CORPORATION                   VALUE 'C'.
  1907         88  CO-PARTNERSHIP                   VALUE 'P'.
  1908         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1909         88  CO-TRUST                         VALUE 'T'.
  1910         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1911
  1912     12  CO-FAXNO.
  1913         16  CO-FAX-AREA-CODE                  PIC XXX.
  1914         16  CO-FAX-PREFIX                     PIC XXX.
  1915         16  CO-FAX-PHONE                      PIC X(4).
  1916
  1917     12  CO-BANK-INFORMATION.
  1918         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1919         16  CO-BANK-TRANSIT-NON REDEFINES
  1920             CO-BANK-TRANSIT-NO                PIC 9(8).
  1921
  1922         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1923     12  CO-MISC-DEDUCT-INFO REDEFINES
  1924                  CO-BANK-INFORMATION.
  1925         16  CO-MD-GL-ACCT                     PIC X(10).
  1926         16  CO-MD-DIV                         PIC XX.
  1927         16  CO-MD-CENTER                      PIC X(4).
  1928         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1929         16  CO-CREATE-AP-CHECK                PIC X.
  1930         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1931         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  36
* EL050.cbl
  1932     12  CO-ACH-STATUS                         PIC X.
  1933         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1934         88  CO-ACH-PENDING                        VALUE 'P'.
  1935
  1936     12  CO-BILL-SW                            PIC X.
  1937     12  CO-CONTROL-NAME                       PIC X(30).
  1938     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1939     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1940     12  CO-CLP-STATE                          PIC XX.
  1941     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1942     12  CO-SPP-REFUND-EDIT                    PIC X.
  1943
  1944******************************************************************
  1945
  1946*    COPY ERCAGTC.
  1947******************************************************************
  1948*                                                                *
  1949*                                                                *
  1950*                            ERCAGTC                             *
  1951*                            VMOD=2.001                          *
  1952*                                                                *
  1953*   ONLINE CREDIT SYSTEM                                         *
  1954*                                                                *
  1955*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1956*                                                                *
  1957*   FILE TYPE = VSAM,KSDS                                        *
  1958*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1959*                                                                *
  1960*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1961*       ALTERNATE PATH = NONE                                    *
  1962*                                                                *
  1963*   LOG = NO                                                     *
  1964*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1965*                                                                *
  1966******************************************************************
  1967*                   C H A N G E   L O G
  1968*
  1969* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1970*-----------------------------------------------------------------
  1971*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1972* EFFECTIVE    NUMBER
  1973*-----------------------------------------------------------------
  1974* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1975* 111004                         NEW FILE AND COPYBOOK
  1976* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1977******************************************************************
  1978 01  AGENT-COMMISSIONS.
  1979     12  AG-RECORD-ID                          PIC XX.
  1980         88  VALID-CO-ID                          VALUE 'AG'.
  1981     12  AG-CONTROL-PRIMARY.
  1982         16  AG-COMPANY-CD                     PIC X.
  1983         16  AG-CONTROL.
  1984             20  AG-CTL-1.
  1985                 24  AG-CARR-GROUP.
  1986                     28  AG-CARRIER            PIC X.
  1987                     28  AG-GROUPING           PIC X(6).
  1988                 24  AG-BANK                   PIC X(10).
  1989             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  37
* EL050.cbl
  1990                 24  AG-EXP-DT                 PIC XX.
  1991         16  AG-TYPE                           PIC X.
  1992             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1993             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1994     12  AG-MAINT-INFORMATION.
  1995         16  AG-LAST-MAINT-DT                  PIC XX.
  1996         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1997         16  AG-LAST-MAINT-USER                PIC X(4).
  1998         16  FILLER                            PIC X(10).
  1999     12  AG-EFF-DT                             PIC XX.
  2000     12  AG-COMM-STRUCTURE.
  2001         16  AG-AGT-COMMS OCCURS 10.
  2002             20  AG-AGT                PIC X(10).
  2003             20  AG-COM-TYP            PIC X.
  2004             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2005             20  AG-RECALC-LV-INDIC    PIC X.
  2006             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2007             20  AG-LRCALC-LV-INDIC    PIC X.
  2008             20  FILLER                PIC X(05).
  2009     12  FILLER                  PIC X(145).
  2010******************************************************************
  2011*    COPY ERCRESS.
  2012******************************************************************
  2013*                                                                *
  2014*                            ERCRESS                             *
  2015*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2016*                            VMOD=2.002                          *
  2017*                                                                *
  2018*   CREDIT RESIDENT STATE TAXES MASTER                          *
  2019*                                                                *
  2020*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  2021*   VSAM RESIDENT STATE TAX MASTER                              *
  2022*                                                                *
  2023*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  2024*                                                                *
  2025*   FILE TYPE = VSAM,KSDS                                        *
  2026*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  2027*                                                                *
  2028*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  2029*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  2030*                                                                *
  2031*   LOG = NO                                                     *
  2032*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2033*                                                                *
  2034*                                                                *
  2035******************************************************************
  2036
  2037 01  RESIDENT-STATE-TAX-MASTER.
  2038
  2039     10  ERRESS-PRIMARY-KEY.
  2040         15  RES-COMPANY-CD        PIC X.
  2041         15  RES-RESIDENT-STATE    PIC XX.
  2042         15  RES-COVERAGE-CATEGORY PIC X.
  2043         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2044*                                      YYYYMMDD
  2045*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2046
  2047     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  38
* EL050.cbl
  2048
  2049         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2050         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2051         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2052         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2053
  2054     10 RES-RECALC-SW              PIC   X.
  2055         88 RECALC                VALUE 'Y'.
  2056         88 NO-RECALC             VALUE 'N'.
  2057     10  RES-MAINT-BY              PIC X(4).
  2058     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2059     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2060*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  39
* EL050.cbl
  2062*    COPY ERCRESC.
  2063******************************************************************
  2064*                                                                *
  2065*                            ERCRESC                             *
  2066*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2067*                            VMOD=2.003                          *
  2068*                                                                *
  2069*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2070*                                                                *
  2071*   FILE TYPE = VSAM,KSDS                                        *
  2072*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2073*                                                                *
  2074*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2075*       ALTERNATE PATH1 = NONE                                   *
  2076*                                                                *
  2077*   LOG = NO                                                     *
  2078*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2079*                                                                *
  2080******************************************************************
  2081
  2082 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2083
  2084     10  ERRESC-RECORD-KEY.
  2085         15  RESC-COMPANY-CD           PIC   X.
  2086         15  RESC-CARRIER              PIC   X.
  2087         15  RESC-GROUP                PIC   X(6).
  2088         15  RESC-STATE                PIC   XX.
  2089         15  RESC-ACCOUNT              PIC   X(10).
  2090         15  RESC-AGENT                PIC   X(10).
  2091         15  RESC-RESIDENT-STATE       PIC   XX.
  2092         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2093*                                           YYYYMMDD
  2094     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2095
  2096     10  RESC-COMM-RECORD-DATA.
  2097         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2098             20 RESC-COVERAGE-CAT      PIC    X.
  2099             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2100             20 RESC-COMMISSION-TAB REDEFINES
  2101                RESC-COMMISSION-PER    PIC  XXX.
  2102
  2103     10  RESC-MAINT-BY                 PIC X(4).
  2104     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2105     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2106*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  40
* EL050.cbl
  2108*    COPY ERCPLAN.
  2109******************************************************************
  2110*                                                                *
  2111*                                                                *
  2112*                            ERCPLAN                             *
  2113*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2114*                            VMOD=2.003                          *
  2115*                                                                *
  2116*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2117*                                                                *
  2118*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2119*   PLAN MASTER                                                  *
  2120*                                                                *
  2121*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2122*                                                                *
  2123*   FILE TYPE = VSAM,KSDS                                        *
  2124*   RECORD SIZE = 420   RECFORM = FIX                            *
  2125*                                                                *
  2126*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2127*       ALTERNATE PATH1 = N/A                                    *
  2128*                                                                *
  2129*   LOG = NO                                                     *
  2130*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2131*                                                                *
  2132*                                                                *
  2133******************************************************************
  2134
  2135 01  PLAN-MASTER.
  2136     12  PL-RECORD-ID                      PIC XX.
  2137         88  VALID-PL-ID                      VALUE 'PL'.
  2138
  2139     12  PL-CONTROL-PRIMARY.
  2140         16  PL-COMPANY-CD                 PIC X.
  2141         16  PL-MSTR-CNTRL.
  2142             20  PL-CONTROL-A.
  2143                 24  PL-CARRIER            PIC X.
  2144                 24  PL-GROUPING           PIC X(6).
  2145                 24  PL-STATE              PIC XX.
  2146                 24  PL-ACCOUNT            PIC X(10).
  2147             20  PL-BENEFIT-TYPE           PIC X.
  2148             20  PL-BENEFIT-CODE           PIC XX.
  2149             20  PL-REVISION-NO            PIC X(3).
  2150
  2151     12  PL-CONTROL-BY-VAR-GRP.
  2152         16  PL-COMPANY-CD-A1              PIC X.
  2153         16  PL-VG-CARRIER                 PIC X.
  2154         16  PL-VG-GROUPING                PIC X(6).
  2155         16  PL-VG-STATE                   PIC XX.
  2156         16  PL-VG-ACCOUNT                 PIC X(10).
  2157         16  PL-BENEFIT-TYPE-A1            PIC X.
  2158         16  PL-BENEFIT-CODE-A1            PIC XX.
  2159         16  PL-REVISION-NO-A1             PIC 999.
  2160
  2161     12  PL-MAINT-INFORMATION.
  2162         16  PL-LAST-MAINT-DT              PIC XX.
  2163         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2164         16  PL-LAST-MAINT-USER            PIC X(4).
  2165         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  41
* EL050.cbl
  2166
  2167     12  PL-LIABILITY-LIMITS.
  2168         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2169         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2170             20  PL-LM-AGE                 PIC S99        COMP-3.
  2171             20  PL-LM-DUR                 PIC S999       COMP-3.
  2172             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2173             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2174
  2175     12  FILLER                            PIC X(30).
  2176
  2177     12  PL-GL-ACCOUNT-NOS.
  2178         16  PL-PREMIUM-GL                 PIC X(8).
  2179         16  PL-COMM-GL                    PIC X(8).
  2180         16  PL-CLAIM-GL                   PIC X(8).
  2181     12  FILLER                            PIC X(24).
  2182     12  PL-TOLERANCES.
  2183         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2184         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2185         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2186         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2187         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2188         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2189     12  PL-OVER-SHORT.
  2190         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2191         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2192     12  FILLER                            PIC X(24).
  2193     12  PLAN-MISC.
  2194         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2195         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2196         16  PL-IG                         PIC X.
  2197         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2198         16  PL-POLICY-FORM                PIC X(12).
  2199         16  PL-EDIT-FOR-FORM              PIC X(01).
  2200         16  PL-DEV-CODE                   PIC XXX.
  2201         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2202         16  PL-CALC-METHOD                PIC X.
  2203         16  PL-BENEFIT-GROUP              PIC X(05).
  2204         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2205
  2206         16  FILLER                        PIC X(99).
  2207******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  42
* EL050.cbl
  2209*    COPY ELCCERT.
  2210******************************************************************
  2211*                                                                *
  2212*                            ELCCERT.                            *
  2213*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2214*                            VMOD=2.013                          *
  2215*                                                                *
  2216*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2217*                                                                *
  2218*   FILE TYPE = VSAM,KSDS                                        *
  2219*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2220*                                                                *
  2221*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2222*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2223*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2224*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2225*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2226*                                                                *
  2227*   LOG = YES                                                    *
  2228*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2229******************************************************************
  2230*                   C H A N G E   L O G
  2231*
  2232* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2233*-----------------------------------------------------------------
  2234*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2235* EFFECTIVE    NUMBER
  2236*-----------------------------------------------------------------
  2237* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2238* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2239* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2240* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2241* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2242* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2243* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2244* 032612  CR2011110200001  PEMA  AHL CHANGES
  2245* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2246* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2247* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2248******************************************************************
  2249
  2250 01  CERTIFICATE-MASTER.
  2251     12  CM-RECORD-ID                      PIC XX.
  2252         88  VALID-CM-ID                      VALUE 'CM'.
  2253
  2254     12  CM-CONTROL-PRIMARY.
  2255         16  CM-COMPANY-CD                 PIC X.
  2256         16  CM-CARRIER                    PIC X.
  2257         16  CM-GROUPING.
  2258             20  CM-GROUPING-PREFIX        PIC X(3).
  2259             20  CM-GROUPING-PRIME         PIC X(3).
  2260         16  CM-STATE                      PIC XX.
  2261         16  CM-ACCOUNT.
  2262             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2263             20  CM-ACCOUNT-PRIME          PIC X(6).
  2264         16  CM-CERT-EFF-DT                PIC XX.
  2265         16  CM-CERT-NO.
  2266             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  43
* EL050.cbl
  2267             20  CM-CERT-SFX               PIC X.
  2268
  2269     12  CM-CONTROL-BY-NAME.
  2270         16  CM-COMPANY-CD-A1              PIC X.
  2271         16  CM-INSURED-LAST-NAME          PIC X(15).
  2272         16  CM-INSURED-INITIALS.
  2273             20  CM-INSURED-INITIAL1       PIC X.
  2274             20  CM-INSURED-INITIAL2       PIC X.
  2275
  2276     12  CM-CONTROL-BY-SSN.
  2277         16  CM-COMPANY-CD-A2              PIC X.
  2278         16  CM-SOC-SEC-NO.
  2279             20  CM-SSN-STATE              PIC XX.
  2280             20  CM-SSN-ACCOUNT            PIC X(6).
  2281             20  CM-SSN-LN3.
  2282                 25  CM-INSURED-INITIALS-A2.
  2283                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2284                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2285                 25 CM-PART-LAST-NAME-A2         PIC X.
  2286
  2287     12  CM-CONTROL-BY-CERT-NO.
  2288         16  CM-COMPANY-CD-A4              PIC X.
  2289         16  CM-CERT-NO-A4                 PIC X(11).
  2290
  2291     12  CM-CONTROL-BY-MEMB.
  2292         16  CM-COMPANY-CD-A5              PIC X.
  2293         16  CM-MEMBER-NO.
  2294             20  CM-MEMB-STATE             PIC XX.
  2295             20  CM-MEMB-ACCOUNT           PIC X(6).
  2296             20  CM-MEMB-LN4.
  2297                 25  CM-INSURED-INITIALS-A5.
  2298                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2299                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2300                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2301
  2302     12  CM-INSURED-PROFILE-DATA.
  2303         16  CM-INSURED-FIRST-NAME.
  2304             20  CM-INSURED-1ST-INIT       PIC X.
  2305             20  FILLER                    PIC X(9).
  2306         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2307         16  CM-INSURED-SEX                PIC X.
  2308             88  CM-SEX-MALE                  VALUE 'M'.
  2309             88  CM-SEX-FEMAL                 VALUE 'F'.
  2310         16  CM-INSURED-JOINT-AGE          PIC 99.
  2311         16  CM-JOINT-INSURED-NAME.
  2312             20  CM-JT-LAST-NAME           PIC X(15).
  2313             20  CM-JT-FIRST-NAME.
  2314                 24  CM-JT-1ST-INIT        PIC X.
  2315                 24  FILLER                PIC X(9).
  2316             20  CM-JT-INITIAL             PIC X.
  2317
  2318     12  CM-LIFE-DATA.
  2319         16  CM-LF-BENEFIT-CD              PIC XX.
  2320         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2321         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2322         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2323         16  CM-LF-DEV-CODE                PIC XXX.
  2324         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  44
* EL050.cbl
  2325         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2326         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2327         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2328         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2329         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2330         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2331         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2332         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2333         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2334         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2335         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2336         16  cm-temp-epiq                  pic xx.
  2337             88  EPIQ-CLASS                  value 'EQ'.
  2338*        16  FILLER                        PIC XX.
  2339
  2340     12  CM-AH-DATA.
  2341         16  CM-AH-BENEFIT-CD              PIC XX.
  2342         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2343         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2344         16  CM-AH-DEV-CODE                PIC XXX.
  2345         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2346         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2347         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2348         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2349         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2350         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2351         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2352         16  CM-AH-PAID-THRU-DT            PIC XX.
  2353             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2354         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2355         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2356         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2357         16  FILLER                        PIC X.
  2358
  2359     12  CM-LOAN-INFORMATION.
  2360         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2361         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2362                                           PIC S9(5)V99  COMP-3.
  2363         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2364         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2365         16  CM-PAY-FREQUENCY              PIC S99.
  2366         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2367         16  CM-RATE-CLASS                 PIC XX.
  2368         16  CM-BENEFICIARY                PIC X(25).
  2369         16  CM-POLICY-FORM-NO             PIC X(12).
  2370         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2371         16  CM-LAST-ADD-ON-DT             PIC XX.
  2372         16  CM-DEDUCTIBLE-AMOUNTS.
  2373             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2374             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2375         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2376             20  CM-RESIDENT-STATE         PIC XX.
  2377             20  CM-RATE-CODE              PIC X(4).
  2378             20  FILLER                    PIC XX.
  2379         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2380             20  CM-LOAN-OFFICER           PIC X(5).
  2381             20  FILLER                    PIC XXX.
  2382         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  45
* EL050.cbl
  2383         16  CM-UNDERWRITING-CODE          PIC X.
  2384             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2385         16  CM-POST-CARD-IND              PIC X.
  2386         16  CM-REF-INTERFACE-SW           PIC X.
  2387         16  CM-PREMIUM-TYPE               PIC X.
  2388             88  CM-SING-PRM                  VALUE '1'.
  2389             88  CM-O-B-COVERAGE              VALUE '2'.
  2390             88  CM-OPEN-END                  VALUE '3'.
  2391         16  CM-IND-GRP-TYPE               PIC X.
  2392             88  CM-INDIVIDUAL                VALUE 'I'.
  2393             88  CM-GROUP                     VALUE 'G'.
  2394         16  CM-SKIP-CODE                  PIC X.
  2395             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2396             88  SKIP-JULY                    VALUE '1'.
  2397             88  SKIP-AUGUST                  VALUE '2'.
  2398             88  SKIP-SEPTEMBER               VALUE '3'.
  2399             88  SKIP-JULY-AUG                VALUE '4'.
  2400             88  SKIP-AUG-SEPT                VALUE '5'.
  2401             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2402             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2403             88  SKIP-JUNE                    VALUE '8'.
  2404             88  SKIP-JUNE-JULY               VALUE '9'.
  2405             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2406             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2407         16  CM-PAYMENT-MODE               PIC X.
  2408             88  PAY-MONTHLY                  VALUE SPACE.
  2409             88  PAY-WEEKLY                   VALUE '1'.
  2410             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2411             88  PAY-BI-WEEKLY                VALUE '3'.
  2412             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2413         16  CM-LOAN-NUMBER                PIC X(8).
  2414         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2415         16  CM-OLD-LOF                    PIC XXX.
  2416*        16  CM-LOAN-OFFICER               PIC XXX.
  2417         16  CM-REIN-TABLE                 PIC XXX.
  2418         16  CM-SPECIAL-REIN-CODE          PIC X.
  2419         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2420         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2421         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2422
  2423     12  CM-STATUS-DATA.
  2424         16  CM-ENTRY-STATUS               PIC X.
  2425         16  CM-ENTRY-DT                   PIC XX.
  2426
  2427         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2428         16  CM-LF-CANCEL-DT               PIC XX.
  2429         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2430
  2431         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2432         16  CM-LF-DEATH-DT                PIC XX.
  2433         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2434
  2435         16  CM-LF-CURRENT-STATUS          PIC X.
  2436             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2437                                                'M' '4' '5' '9'.
  2438             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2439             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2440             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  46
* EL050.cbl
  2441             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2442             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2443             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2444             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2445             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2446             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2447             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2448             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2449             88  CM-LF-DECLINED               VALUE 'D'.
  2450             88  CM-LF-VOIDED                 VALUE 'V'.
  2451
  2452         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2453         16  CM-AH-CANCEL-DT               PIC XX.
  2454         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2455
  2456         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2457         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2458         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2459
  2460         16  CM-AH-CURRENT-STATUS          PIC X.
  2461             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2462                                                'M' '4' '5' '9'.
  2463             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2464             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2465             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2466             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2467             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2468             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2469             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2470             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2471             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2472             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2473             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2474             88  CM-AH-DECLINED               VALUE 'D'.
  2475             88  CM-AH-VOIDED                 VALUE 'V'.
  2476
  2477         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2478             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2479             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2480             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2481         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2482
  2483         16  CM-ENTRY-BATCH                PIC X(6).
  2484         16  CM-LF-EXIT-BATCH              PIC X(6).
  2485         16  CM-AH-EXIT-BATCH              PIC X(6).
  2486         16  CM-LAST-MONTH-END             PIC XX.
  2487
  2488     12  CM-NOTE-SW                        PIC X.
  2489         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2490         88  CERT-NOTES-PRESENT               VALUE '1'.
  2491         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2492         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2493         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2494         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2495         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2496         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2497     12  CM-COMP-EXCP-SW                   PIC X.
  2498         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  47
* EL050.cbl
  2499         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2500     12  CM-INSURED-ADDRESS-SW             PIC X.
  2501         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2502         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2503
  2504*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2505     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2506     12  FILLER                            PIC X.
  2507
  2508*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2509     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2510     12  FILLER                            PIC X.
  2511*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2512     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2513
  2514     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2515         88  CERT-ADDED-BATCH                 VALUE ' '.
  2516         88  CERT-ADDED-ONLINE                VALUE '1'.
  2517         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2518         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2519         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2520     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2521         88  CERT-AS-LOADED                   VALUE ' '.
  2522         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2523         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2524         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2525         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2526         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2527         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2528         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2529
  2530     12  CM-ACCOUNT-COMM-PCTS.
  2531         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2532         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2533
  2534     12  CM-USER-FIELD                     PIC X.
  2535     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2536     12  CM-CLP-STATE                      PIC XX.
  2537     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2538     12  CM-USER-RESERVED                  PIC XXX.
  2539     12  FILLER REDEFINES CM-USER-RESERVED.
  2540         16  CM-AH-CLASS-CD                PIC XX.
  2541         16  F                             PIC X.
  2542******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  48
* EL050.cbl
  2544*    COPY ERCMAIL.
  2545******************************************************************
  2546*                                                                *
  2547*                                                                *
  2548*                            ERCMAIL                             *
  2549*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2550*                            VMOD=2.003                          *
  2551*                                                                *
  2552*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2553*                                                                *
  2554*   FILE TYPE = VSAM,KSDS                                        *
  2555*   RECORD SIZE = 374   RECFORM = FIX                            *
  2556*                                                                *
  2557*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2558*   ALTERNATE PATH    = NOT USED                                 *
  2559*                                                                *
  2560*   LOG = YES                                                    *
  2561*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2562******************************************************************
  2563*                   C H A N G E   L O G
  2564*
  2565* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2566*-----------------------------------------------------------------
  2567*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2568* EFFECTIVE    NUMBER
  2569*-----------------------------------------------------------------
  2570* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2571* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2572* 111108                   PEMA  ADD CRED BENE ADDR2
  2573******************************************************************
  2574
  2575 01  MAILING-DATA.
  2576     12  MA-RECORD-ID                      PIC XX.
  2577         88  VALID-MA-ID                       VALUE 'MA'.
  2578
  2579     12  MA-CONTROL-PRIMARY.
  2580         16  MA-COMPANY-CD                 PIC X.
  2581         16  MA-CARRIER                    PIC X.
  2582         16  MA-GROUPING.
  2583             20  MA-GROUPING-PREFIX        PIC XXX.
  2584             20  MA-GROUPING-PRIME         PIC XXX.
  2585         16  MA-STATE                      PIC XX.
  2586         16  MA-ACCOUNT.
  2587             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2588             20  MA-ACCOUNT-PRIME          PIC X(6).
  2589         16  MA-CERT-EFF-DT                PIC XX.
  2590         16  MA-CERT-NO.
  2591             20  MA-CERT-PRIME             PIC X(10).
  2592             20  MA-CERT-SFX               PIC X.
  2593
  2594     12  FILLER                            PIC XX.
  2595
  2596     12  MA-ACCESS-CONTROL.
  2597         16  MA-SOURCE-SYSTEM              PIC XX.
  2598             88  MA-FROM-CREDIT                VALUE 'CR'.
  2599             88  MA-FROM-VSI                   VALUE 'VS'.
  2600             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2601             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  49
* EL050.cbl
  2602         16  MA-RECORD-ADD-DT              PIC XX.
  2603         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2604         16  MA-LAST-MAINT-DT              PIC XX.
  2605         16  MA-LAST-MAINT-BY              PIC XXXX.
  2606         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2607
  2608     12  MA-PROFILE-INFO.
  2609         16  MA-QUALIFY-CODE-1             PIC XX.
  2610         16  MA-QUALIFY-CODE-2             PIC XX.
  2611         16  MA-QUALIFY-CODE-3             PIC XX.
  2612         16  MA-QUALIFY-CODE-4             PIC XX.
  2613         16  MA-QUALIFY-CODE-5             PIC XX.
  2614
  2615         16  MA-INSURED-LAST-NAME          PIC X(15).
  2616         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2617         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2618         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2619         16  MA-INSURED-BIRTH-DT           PIC XX.
  2620         16  MA-INSURED-SEX                PIC X.
  2621             88  MA-SEX-MALE                   VALUE 'M'.
  2622             88  MA-SEX-FEMALE                 VALUE 'F'.
  2623         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2624
  2625         16  MA-ADDRESS-CORRECTED          PIC X.
  2626         16  MA-JOINT-BIRTH-DT             PIC XX.
  2627*        16  FILLER                        PIC X(12).
  2628
  2629         16  MA-ADDRESS-LINE-1             PIC X(30).
  2630         16  MA-ADDRESS-LINE-2             PIC X(30).
  2631         16  MA-CITY-STATE.
  2632             20  MA-CITY                   PIC X(28).
  2633             20  MA-ADDR-STATE             PIC XX.
  2634         16  MA-ZIP.
  2635             20  MA-ZIP-CODE.
  2636                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2637                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2638                 24  FILLER                PIC X(4).
  2639             20  MA-ZIP-PLUS4              PIC X(4).
  2640         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2641             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2642             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2643             20  FILLER                    PIC X(3).
  2644
  2645         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2646
  2647         16  FILLER                        PIC XXX.
  2648*        16  FILLER                        PIC X(10).
  2649
  2650     12  MA-CRED-BENE-INFO.
  2651         16  MA-CRED-BENE-NAME                 PIC X(25).
  2652         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2653         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2654         16  MA-CRED-BENE-CTYST.
  2655             20  MA-CRED-BENE-CITY             PIC X(28).
  2656             20  MA-CRED-BENE-STATE            PIC XX.
  2657         16  MA-CRED-BENE-ZIP.
  2658             20  MA-CB-ZIP-CODE.
  2659                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  50
* EL050.cbl
  2660                     88  MA-CB-CANADIAN-POST-CODE
  2661                                           VALUE 'A' THRU 'Z'.
  2662                 24  FILLER                    PIC X(4).
  2663             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2664         16  MA-CB-CANADIAN-POSTAL-CODE
  2665                            REDEFINES MA-CRED-BENE-ZIP.
  2666             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2667             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2668             20  FILLER                        PIC X(3).
  2669     12  MA-POST-CARD-MAIL-DATA.
  2670         16  MA-MAIL-DATA OCCURS 7.
  2671             20  MA-MAIL-TYPE              PIC X.
  2672                 88  MA-12MO-MAILING           VALUE '1'.
  2673                 88  MA-EXP-MAILING            VALUE '2'.
  2674             20  MA-MAIL-STATUS            PIC X.
  2675                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2676                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2677                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2678             20  MA-MAIL-DATE              PIC XX.
  2679     12  FILLER                            PIC XX.
  2680     12  FILLER                            PIC XX.
  2681*    12  FILLER                            PIC X(30).
  2682******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  51
* EL050.cbl
  2684*    COPY ERCPNDM.
  2685******************************************************************
  2686*                                                                *
  2687*                                                                *
  2688*                            ERCPNDM                             *
  2689*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2690*                            VMOD=2.003                          *
  2691*                                                                *
  2692*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2693*                                                                *
  2694*   FILE TYPE = VSAM,KSDS                                        *
  2695*   RECORD SIZE = 374   RECFORM = FIX                            *
  2696*                                                                *
  2697*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2698*   ALTERNATE PATH    = NOT USED                                 *
  2699*                                                                *
  2700*   LOG = YES                                                    *
  2701*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2702******************************************************************
  2703*                   C H A N G E   L O G
  2704*
  2705* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2706*-----------------------------------------------------------------
  2707*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2708* EFFECTIVE    NUMBER
  2709*-----------------------------------------------------------------
  2710* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2711* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2712* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2713* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2714******************************************************************
  2715
  2716 01  PENDING-MAILING-DATA.
  2717     12  PM-RECORD-ID                      PIC XX.
  2718         88  VALID-MA-ID                       VALUE 'PM'.
  2719
  2720     12  PM-CONTROL-PRIMARY.
  2721         16  PM-COMPANY-CD                 PIC X.
  2722         16  PM-ENTRY-BATCH                PIC X(6).
  2723         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2724         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2725
  2726     12  FILLER                            PIC X(14).
  2727
  2728     12  PM-ACCESS-CONTROL.
  2729         16  PM-SOURCE-SYSTEM              PIC XX.
  2730             88  PM-FROM-CREDIT                VALUE 'CR'.
  2731             88  PM-FROM-VSI                   VALUE 'VS'.
  2732             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2733             88  PM-FROM-OTHER                 VALUE 'OT'.
  2734         16  PM-RECORD-ADD-DT              PIC XX.
  2735         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2736         16  PM-LAST-MAINT-DT              PIC XX.
  2737         16  PM-LAST-MAINT-BY              PIC XXXX.
  2738         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2739
  2740     12  PM-PROFILE-INFO.
  2741         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  52
* EL050.cbl
  2742         16  PM-QUALIFY-CODE-2             PIC XX.
  2743         16  PM-QUALIFY-CODE-3             PIC XX.
  2744         16  PM-QUALIFY-CODE-4             PIC XX.
  2745         16  PM-QUALIFY-CODE-5             PIC XX.
  2746
  2747         16  PM-INSURED-LAST-NAME          PIC X(15).
  2748         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2749         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2750         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2751         16  PM-INSURED-BIRTH-DT           PIC XX.
  2752         16  PM-INSURED-SEX                PIC X.
  2753             88  PM-SEX-MALE                   VALUE 'M'.
  2754             88  PM-SEX-FEMALE                 VALUE 'F'.
  2755         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2756
  2757         16  PM-ADDRESS-CORRECTED          PIC X.
  2758         16  PM-JOINT-BIRTH-DT             PIC XX.
  2759*        16  FILLER                        PIC X(12).
  2760
  2761         16  PM-ADDRESS-LINE-1             PIC X(30).
  2762         16  PM-ADDRESS-LINE-2             PIC X(30).
  2763         16  PM-CITY-STATE.
  2764             20  PM-CITY                   PIC X(28).
  2765             20  PM-STATE                  PIC XX.
  2766         16  PM-ZIP.
  2767             20  PM-ZIP-CODE.
  2768                 24  PM-ZIP-1              PIC X.
  2769                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2770                 24  FILLER                PIC X(4).
  2771             20  PM-ZIP-PLUS4              PIC X(4).
  2772         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2773             20  PM-CAN-POST1              PIC XXX.
  2774             20  PM-CAN-POST2              PIC XXX.
  2775             20  FILLER                    PIC XXX.
  2776
  2777         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2778         16  pm-city-st-zip-verified       pic x.
  2779         16  FILLER                        PIC XX.
  2780
  2781     12  PM-CRED-BENE-INFO.
  2782         16  PM-CRED-BENE-NAME             PIC X(25).
  2783         16  PM-CRED-BENE-ADDR             PIC X(30).
  2784         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2785         16  PM-CRED-BENE-CTYST.
  2786             20  PM-CRED-BENE-CITY         PIC X(28).
  2787             20  PM-CRED-BENE-STATE        PIC XX.
  2788         16  PM-CRED-BENE-ZIP.
  2789             20  PM-CB-ZIP-CODE.
  2790                 24  PM-CB-ZIP-1           PIC X.
  2791                     88  PM-CB-CANADIAN-POST-CODE
  2792                                  VALUE 'A' THRU 'Z'.
  2793                 24  FILLER                PIC X(4).
  2794             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2795         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2796             20  PM-CB-CAN-POST1           PIC XXX.
  2797             20  PM-CB-CAN-POST2           PIC XXX.
  2798             20  FILLER                    PIC XXX.
  2799     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  53
* EL050.cbl
  2800         16  PM-MAIL-DATA OCCURS 7.
  2801             20  PM-MAIL-TYPE              PIC X.
  2802                 88  PM-12MO-MAILING           VALUE '1'.
  2803                 88  PM-EXP-MAILING            VALUE '2'.
  2804             20  PM-MAIL-STATUS            PIC X.
  2805                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2806                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2807                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2808             20  PM-MAIL-DATE              PIC XX.
  2809     12  FILLER                            PIC XX.
  2810     12  FILLER                            PIC X(12).
  2811*    12  FILLER                            PIC X(30).
  2812
  2813******************************************************************
  2814*                                COPY ERCLOFC.
  2815******************************************************************
  2816*                                                                *
  2817*                                                                *
  2818*                            ERCLOFC                             *
  2819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2820*                            VMOD=2.003                          *
  2821*                                                                *
  2822*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2823*                                                                *
  2824*   FILE TYPE = VSAM,KSDS                                        *
  2825*   RECORD SIZE = 670   RECFORM = FIX                            *
  2826*                                                                *
  2827*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2828*                                                                *
  2829*   LOG = YES                                                    *
  2830*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2831*                                                                *
  2832******************************************************************
  2833
  2834 01  LOAN-OFFICER-MASTER.
  2835     12  LO-RECORD-ID                PIC XX.
  2836         88  VALID-LO-ID                VALUE 'LO'.
  2837
  2838     12  LO-CONTROL-PRIMARY.
  2839         16  LO-COMPANY-CD           PIC X.
  2840         16  LO-CARRIER              PIC X.
  2841         16  LO-GROUPING.
  2842             20  LO-GROUPING-PREFIX  PIC XXX.
  2843             20  LO-GROUPING-PRIME   PIC XXX.
  2844         16  LO-STATE                PIC XX.
  2845         16  LO-ACCOUNT.
  2846             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2847             20  LO-ACCOUNT-PRIME    PIC X(6).
  2848         16  LO-OFFICER-CODE         PIC X(5).
  2849
  2850     12  LO-OFFICER-NAME             PIC X(30).
  2851
  2852     12  LO-LAST-MAINT-DT            PIC XX.
  2853     12  LO-LAST-USER                PIC X(4).
  2854     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2855
  2856     12  LO-COMP-CONTROL             PIC X.
  2857             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  54
* EL050.cbl
  2858             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2859     12  LO-DETAIL-CONTROL           PIC X.
  2860             88  LO-PRINT-DETAIL        VALUE 'D'.
  2861             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2862
  2863     12  LO-SV-CARRIER               PIC X.
  2864     12  LO-SV-GROUPING              PIC X(6).
  2865     12  LO-SV-STATE                 PIC XX.
  2866
  2867     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2868     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2869
  2870     12  LO-OFFICER-INFO.
  2871         16  FILLER OCCURS 12 TIMES.
  2872             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2873             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2874             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2875             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2876             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2877             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2878             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2879             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2880     12  FILLER                      PIC X(198).
  2881******************************************************************
  2882*                                COPY ERCPDEF.
  2883******************************************************************
  2884*                                                                *
  2885*                                                                *
  2886*                            ERCPDEF.                            *
  2887*                                                                *
  2888*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2889*                                                                *
  2890*    FILE TYPE = VSAM,KSDS                                       *
  2891*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2892*                                                                *
  2893*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2894*                                                                *
  2895*    LOG = YES                                                   *
  2896*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2897******************************************************************
  2898*                   C H A N G E   L O G
  2899*
  2900* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2901*-----------------------------------------------------------------
  2902*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2903* EFFECTIVE    NUMBER
  2904*-----------------------------------------------------------------
  2905* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2906* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2907* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2908* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  2909******************************************************************
  2910 01  PRODUCT-MASTER.
  2911    12  PD-RECORD-ID                 PIC X(02).
  2912        88  VALID-PD-ID                  VALUE 'PD'.
  2913    12  PD-CONTROL-PRIMARY.
  2914        16  PD-COMPANY-CD            PIC X.
  2915        16  PD-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  55
* EL050.cbl
  2916        16  PD-PRODUCT-CD            PIC XXX.
  2917        16  PD-FILLER                PIC X(7).
  2918        16  PD-BEN-TYPE              PIC X.
  2919        16  PD-BEN-CODE              PIC XX.
  2920        16  PD-PROD-EXP-DT           PIC XX.
  2921    12  FILLER                       PIC X(50).
  2922    12  PD-PRODUCT-DATA OCCURS 8.
  2923        16  PD-PROD-CODE             PIC X.
  2924            88  PD-PROD-LIFE           VALUE 'L'.
  2925            88  PD-PROD-PROP           VALUE 'P'.
  2926            88  PD-PROD-AH             VALUE 'A'.
  2927            88  PD-PROD-IU             VALUE 'I'.
  2928            88  PD-PROD-GAP            VALUE 'G'.
  2929            88  PD-PROD-FAML           VALUE 'F'.
  2930            88  PD-PROD-OTH            VALUE 'O'.
  2931        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2932        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2933        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2934        16  PD-MAX-TERM              PIC S999        COMP-3.
  2935        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2936        16  FILLER                   PIC X.
  2937        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2938        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2939        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2940        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2941        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2942        16  PD-REC-CRIT-PERIOD       PIC 99.
  2943        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2944            20  PD-RECURRING-YN      PIC X.
  2945            20  FILLER               PIC X.
  2946        16  PD-RTW-MOS               PIC 99.
  2947        16  PD-MAX-EXTENSION         PIC 99.
  2948        16  pd-ben-pct               pic sv999 comp-3.
  2949*       16  FILLER                   PIC XX.
  2950    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2951    12  PD-TERM-LIMITS OCCURS 15.
  2952        16  PD-LOW-TERM              PIC S999        COMP-3.
  2953        16  PD-HI-TERM               PIC S999        COMP-3.
  2954*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2955    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2956        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2957        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2958    12  PD-EARN-FACTORS.
  2959        16  FILLER OCCURS 15.
  2960            20  FILLER OCCURS 15.
  2961                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2962    12  PD-PRODUCT-DESC              PIC X(80).
  2963    12  PD-TRUNCATED                 PIC X.
  2964    12  FILLER                       PIC X(59).
  2965    12  PD-MAINT-INFORMATION.
  2966        16  PD-LAST-MAINT-DT         PIC X(02).
  2967        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2968        16  PD-LAST-MAINT-BY         PIC X(04).
  2969*                                COPY ELCSTATE.
  2970******************************************************************
  2971*                                                                *
  2972*                                                                *
  2973*                            ELCSTATE.                           *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  56
* EL050.cbl
  2974*                                                                *
  2975*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2976*                                                                *
  2977*   FILE TYPE = VSAM,KSDS                                        *
  2978*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2979*                                                                *
  2980*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2981*       ALTERNATE INDEX = NONE                                   *
  2982*                                                                *
  2983*   LOG = YES                                                    *
  2984*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2985******************************************************************
  2986*                   C H A N G E   L O G
  2987*
  2988* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2989*-----------------------------------------------------------------
  2990*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2991* EFFECTIVE    NUMBER
  2992*-----------------------------------------------------------------
  2993* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2994******************************************************************
  2995*
  2996 01  STATE-FILE.
  2997     12  SF-RECORD-ID                       PIC XX.
  2998         88  VALID-CF-ID                        VALUE 'SF'.
  2999     12  SF-CONTROL-PRIMARY.
  3000         16  SF-COMPANY-ID                  PIC XXX.
  3001         16  SF-CARRIER-CODE                PIC X.
  3002         16  SF-GROUPING                    PIC X(6).
  3003         16  SF-STATE-CODE                  PIC XX.
  3004         16  SF-EXPIRE-DATE                 PIC 9(8).
  3005****************************************************************
  3006*             STATE CONTROLS
  3007****************************************************************
  3008     12  SF-LAST-MAINT-DT                   PIC XX.
  3009     12  SF-LAST-MAINT-BY                   PIC X(4).
  3010     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3011     12  SF-STATE-RT-CONTROLS.
  3012         16  SF-ST-RT-CALC                  PIC X.
  3013     12  SF-ST-TAX-CONTROLS.
  3014         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3015         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3016         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3017     12  SF-ST-REFUND-OPTIONS.
  3018         16  SF-ST-RF-LR-CALC               PIC X.
  3019         16  SF-ST-RF-LL-CALC               PIC X.
  3020         16  SF-ST-RF-LN-CALC               PIC X.
  3021         16  SF-ST-RF-AH-CALC               PIC X.
  3022         16  SF-ST-RF-CP-CALC               PIC X.
  3023     12  SF-ST-UNEARN-PREM-OPTIONS.
  3024         16  SF-ST-LUEP-R78                 PIC X.
  3025         16  SF-ST-LUEP-PRO                 PIC X.
  3026         16  SF-ST-LUEP-ST                  PIC X.
  3027         16  SF-ST-LUEP-DOM                 PIC X.
  3028         16  SF-ST-AUEP-R78                 PIC X.
  3029         16  SF-ST-AUEP-PRO                 PIC X.
  3030         16  SF-ST-AUEP-ST                  PIC X.
  3031         16  SF-ST-AUEP-DOM                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  57
* EL050.cbl
  3032         16  SF-ST-CUEP-R78                 PIC X.
  3033         16  SF-ST-CUEP-PRO                 PIC X.
  3034         16  SF-ST-CUEP-ST                  PIC X.
  3035         16  SF-ST-CUEP-DOM                 PIC X.
  3036     12  SF-ST-EARN-PREM-OPTIONS.
  3037         16  SF-ST-LEP-R78                  PIC X.
  3038         16  SF-ST-LEP-PRO                  PIC X.
  3039         16  SF-ST-LEP-ST                   PIC X.
  3040         16  SF-ST-LEP-DOM                  PIC X.
  3041         16  SF-ST-AEP-R78                  PIC X.
  3042         16  SF-ST-AEP-PRO                  PIC X.
  3043         16  SF-ST-AEP-ST                   PIC X.
  3044         16  SF-ST-AEP-DOM                  PIC X.
  3045         16  SF-ST-CEP-R78                  PIC X.
  3046         16  SF-ST-CEP-PRO                  PIC X.
  3047         16  SF-ST-CEP-ST                   PIC X.
  3048         16  SF-ST-CEP-DOM                  PIC X.
  3049     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  58
* EL050.cbl
  3051*    COPY ELCCRTT.
  3052******************************************************************
  3053*                                                                *
  3054*                            ELCCRTT.                            *
  3055*                                                                *
  3056*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3057*                                                                *
  3058*   FILE TYPE = VSAM,KSDS                                        *
  3059*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3060*                                                                *
  3061*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3062*                                                                *
  3063*   LOG = YES                                                    *
  3064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3065******************************************************************
  3066*                   C H A N G E   L O G
  3067*
  3068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3069*-----------------------------------------------------------------
  3070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3071* EFFECTIVE    NUMBER
  3072*-----------------------------------------------------------------
  3073* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3074* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3075* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3076* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3077* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3078* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3079* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3080* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3081* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3082* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3083* 091318  CR2018073000001  PEMA  ADD Refund methods
  3084* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3085******************************************************************
  3086
  3087 01  CERTIFICATE-TRAILERS.
  3088     12  CS-RECORD-ID                      PIC XX.
  3089         88  VALID-CS-ID                      VALUE 'CS'.
  3090
  3091     12  CS-CONTROL-PRIMARY.
  3092         16  CS-COMPANY-CD                 PIC X.
  3093         16  CS-CARRIER                    PIC X.
  3094         16  CS-GROUPING                   PIC X(6).
  3095         16  CS-STATE                      PIC XX.
  3096         16  CS-ACCOUNT                    PIC X(10).
  3097         16  CS-CERT-EFF-DT                PIC XX.
  3098         16  CS-CERT-NO.
  3099             20  CS-CERT-PRIME             PIC X(10).
  3100             20  CS-CERT-SFX               PIC X.
  3101         16  CS-TRAILER-TYPE               PIC X.
  3102             88  COMM-TRLR           VALUE 'A'.
  3103             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3104             88  CERT-DATA-TRLR      VALUE 'C'.
  3105
  3106     12  CS-DATA-AREA                      PIC X(516).
  3107
  3108     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  59
* EL050.cbl
  3109         16  CS-BANK-COMMISSION-AREA.
  3110             20  CS-BANK-COMMS       OCCURS 10.
  3111                 24  CS-AGT                PIC X(10).
  3112                 24  CS-COM-TYP            PIC X.
  3113                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3114                 24  CS-RECALC-LV-INDIC    PIC X.
  3115                 24  FILLER                PIC X(10).
  3116         16  FILLER                        PIC X(256).
  3117
  3118     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3119****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3120         16  CS-MB-CLAIM-DATA OCCURS 24.
  3121             20  CS-CLAIM-NO               PIC X(7).
  3122             20  CS-CLAIM-TYPE             PIC X.
  3123                 88  CS-AH-CLM               VALUE 'A'.
  3124                 88  CS-IU-CLM               VALUE 'I'.
  3125                 88  CS-GP-CLM               VALUE 'G'.
  3126                 88  CS-LF-CLM               VALUE 'L'.
  3127                 88  CS-PR-CLM               VALUE 'P'.
  3128                 88  CS-FL-CLM               VALUE 'F'.
  3129                 88  CS-OT-CLM               VALUE 'O'.
  3130             20  CS-INSURED-TYPE           PIC X.
  3131                 88  CS-PRIM-INSURED          VALUE 'P'.
  3132                 88  CS-CO-BORROWER           VALUE 'C'.
  3133             20  CS-BENEFIT-PERIOD         PIC 99.
  3134             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3135             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3136             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3137         16  FILLER                        PIC X(12).
  3138     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3139         16  CS-VIN-NUMBER                 PIC X(17).
  3140         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3141         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3142         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3143         16  cs-agent-name.
  3144             20  cs-agent-fname            pic x(20).
  3145             20  cs-agent-mi               pic x.
  3146             20  cs-agent-lname            pic x(25).
  3147         16  cs-license-no                 pic x(15).
  3148         16  cs-npn-number                 pic x(10).
  3149         16  cs-agent-edit-status          pic x.
  3150             88  cs-ae-refer-to-manager      value 'M'.
  3151             88  cs-ae-cover-sheet           value 'C'.
  3152             88  cs-ae-sig-form              value 'S'.
  3153             88  cs-ae-verified              value 'V'.
  3154             88  cs-unidentified-signature   value 'U'.
  3155             88  cs-cert-returned            value 'R'.
  3156             88  cs-accept-no-commission     value 'N'.
  3157         16  cs-year                       pic 9999.
  3158         16  cs-make                       pic x(20).
  3159         16  cs-model                      pic x(20).
  3160         16  cs-future                     pic x(20).
  3161         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3162         16  cs-claim-verification-status  pic x.
  3163             88  cs-clm-ver-eligible         value 'A'.
  3164             88  cs-clm-ver-partial-elig     value 'B'.
  3165             88  cs-clm-ver-not-eligible     value 'C'.
  3166             88  cs-clm-ver-not-elig-opn-clm value 'D'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  60
* EL050.cbl
  3167             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3168             88  cs-clm-ver-ND-CERT          value 'F'.
  3169             88  cs-clm-ver-spec-other       value 'G'.
  3170             88  cs-clam-ver-pratial-corrected
  3171                                             value 'H'.
  3172             88  cs-clm-ver-no-matches       value 'I'.
  3173             88  cs-clm-ver-not-elig-corrected
  3174                                             value 'J'.
  3175             88  cs-clm-ver-needs-review     value 'R'.
  3176             88  cs-clm-ver-sent-to-claims   value 'W'.
  3177         16  CS-LF-REFUND-METHOD           PIC X.
  3178         16  CS-AH-REFUND-METHOD           PIC X.
  3179         16  FILLER                        PIC X(353). *> was 420
  3180*        16  FILLER                        PIC X(496).
  3181*    COPY ELCCRTO.
  3182******************************************************************
  3183*                                                                *
  3184*                            ELCCRTO.                            *
  3185*                                                                *
  3186*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3187*                                                                *
  3188*   FILE TYPE = VSAM,KSDS                                        *
  3189*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3190*                                                                *
  3191*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3192*                                                                *
  3193*   LOG = YES                                                    *
  3194*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3195******************************************************************
  3196*                   C H A N G E   L O G
  3197*
  3198* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3199*-----------------------------------------------------------------
  3200*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3201* EFFECTIVE    NUMBER
  3202*-----------------------------------------------------------------
  3203* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3204* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3205* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3206* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3207* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3208******************************************************************
  3209 01  ORIGINAL-CERTIFICATE.
  3210     12  OC-RECORD-ID                      PIC XX.
  3211         88  VALID-OC-ID                      VALUE 'OC'.
  3212     12  OC-CONTROL-PRIMARY.
  3213         16  OC-COMPANY-CD                 PIC X.
  3214         16  OC-CARRIER                    PIC X.
  3215         16  OC-GROUPING                   PIC X(6).
  3216         16  OC-STATE                      PIC XX.
  3217         16  OC-ACCOUNT                    PIC X(10).
  3218         16  OC-CERT-EFF-DT                PIC XX.
  3219         16  OC-CERT-NO.
  3220             20  OC-CERT-PRIME             PIC X(10).
  3221             20  OC-CERT-SFX               PIC X.
  3222         16  OC-RECORD-TYPE                PIC X.
  3223         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3224     12  OC-LAST-MAINT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  61
* EL050.cbl
  3225     12  OC-LAST-MAINT-BY                  PIC X(4).
  3226     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3227     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3228     12  FILLER                            PIC X(49).
  3229     12  OC-ORIG-REC.
  3230         16  OC-INS-LAST-NAME              PIC X(15).
  3231         16  OC-INS-FIRST-NAME             PIC X(10).
  3232         16  OC-INS-MIDDLE-INIT            PIC X.
  3233         16  OC-INS-AGE                    PIC S999     COMP-3.
  3234         16  OC-JNT-LAST-NAME              PIC X(15).
  3235         16  OC-JNT-FIRST-NAME             PIC X(10).
  3236         16  OC-JNT-MIDDLE-INIT            PIC X.
  3237         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3238         16  OC-LF-BENCD                   PIC XX.
  3239         16  OC-LF-TERM                    PIC S999      COMP-3.
  3240         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3241         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3242         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3243         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3244         16  OC-LF-EXP-DT                  PIC XX.
  3245         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3246         16  OC-LF-CANCEL-DT               PIC XX.
  3247         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3248         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3249         16  OC-AH-BENCD                   PIC XX.
  3250         16  OC-AH-TERM                    PIC S999      COMP-3.
  3251         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3252         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3253         16  OC-AH-EXP-DT                  PIC XX.
  3254         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3255         16  OC-AH-CP                      PIC 99.
  3256         16  OC-AH-CANCEL-DT               PIC XX.
  3257         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3258         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3259         16  OC-CRED-BENE-NAME             PIC X(25).
  3260         16  OC-1ST-PMT-DT                 PIC XX.
  3261         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3262         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3263         16  OC-ISSUE-TRAN-IND             PIC X.
  3264         16  OC-CANCEL-TRAN-IND            PIC X.
  3265         16  FILLER                        PIC X(211).
  3266
  3267     12  FILLER                            PIC X(50).
  3268******************************************************************
  3269
  3270*    COPY ELCDATE.
  3271******************************************************************
  3272*                                                                *
  3273*                                                                *
  3274*                            ELCDATE.                            *
  3275*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3276*                            VMOD=2.003
  3277*                                                                *
  3278*                                                                *
  3279*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3280*                 LENGTH = 200                                   *
  3281******************************************************************
  3282
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  62
* EL050.cbl
  3283 01  DATE-CONVERSION-DATA.
  3284     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3285     12  DC-OPTION-CODE                PIC X.
  3286         88  BIN-TO-GREG                VALUE ' '.
  3287         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3288         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3289         88  YMD-GREG-TO-BIN            VALUE '3'.
  3290         88  MDY-GREG-TO-BIN            VALUE '4'.
  3291         88  JULIAN-TO-BIN              VALUE '5'.
  3292         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3293         88  FIND-CENTURY               VALUE '7'.
  3294         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3295         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3296         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3297         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3298         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3299         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3300         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3301         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3302         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3303         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3304         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3305         88  BIN-3-TO-GREG              VALUE 'I'.
  3306         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3307         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3308         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3309         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3310         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3311         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3312         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3313         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3314         88  THREE-CHARACTER-BIN
  3315                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3316         88  GREGORIAN-TO-BIN
  3317                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3318         88  BIN-TO-GREGORIAN
  3319                  VALUES ' ' '1' 'I' '8' 'G'.
  3320         88  JULIAN-TO-BINARY
  3321                  VALUES '5' 'C' 'E' 'F'.
  3322     12  DC-ERROR-CODE                 PIC X.
  3323         88  NO-CONVERSION-ERROR        VALUE ' '.
  3324         88  DATE-CONVERSION-ERROR
  3325                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3326         88  DATE-IS-ZERO               VALUE '1'.
  3327         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3328         88  DATE-IS-INVALID            VALUE '3'.
  3329         88  DATE1-GREATER-DATE2        VALUE '4'.
  3330         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3331         88  DATE-INVALID-OPTION        VALUE '9'.
  3332         88  INVALID-CENTURY            VALUE 'A'.
  3333         88  ONLY-CENTURY               VALUE 'B'.
  3334         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3335         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3336     12  DC-END-OF-MONTH               PIC X.
  3337         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3338     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3339         88  USE-NORMAL-PROCESS         VALUE ' '.
  3340         88  ADJUST-DOWN-100-YRS        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  63
* EL050.cbl
  3341         88  ADJUST-UP-100-YRS          VALUE '2'.
  3342     12  FILLER                        PIC X.
  3343     12  DC-CONVERSION-DATES.
  3344         16  DC-BIN-DATE-1             PIC XX.
  3345         16  DC-BIN-DATE-2             PIC XX.
  3346         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3347         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3348                       DC-GREG-DATE-1-EDIT.
  3349             20  DC-EDIT1-MONTH        PIC 99.
  3350             20  SLASH1-1              PIC X.
  3351             20  DC-EDIT1-DAY          PIC 99.
  3352             20  SLASH1-2              PIC X.
  3353             20  DC-EDIT1-YEAR         PIC 99.
  3354         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3355         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3356                     DC-GREG-DATE-2-EDIT.
  3357             20  DC-EDIT2-MONTH        PIC 99.
  3358             20  SLASH2-1              PIC X.
  3359             20  DC-EDIT2-DAY          PIC 99.
  3360             20  SLASH2-2              PIC X.
  3361             20  DC-EDIT2-YEAR         PIC 99.
  3362         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3363         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3364                     DC-GREG-DATE-1-YMD.
  3365             20  DC-YMD-YEAR           PIC 99.
  3366             20  DC-YMD-MONTH          PIC 99.
  3367             20  DC-YMD-DAY            PIC 99.
  3368         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3369         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3370                      DC-GREG-DATE-1-MDY.
  3371             20  DC-MDY-MONTH          PIC 99.
  3372             20  DC-MDY-DAY            PIC 99.
  3373             20  DC-MDY-YEAR           PIC 99.
  3374         16  DC-GREG-DATE-1-ALPHA.
  3375             20  DC-ALPHA-MONTH        PIC X(10).
  3376             20  DC-ALPHA-DAY          PIC 99.
  3377             20  FILLER                PIC XX.
  3378             20  DC-ALPHA-CENTURY.
  3379                 24 DC-ALPHA-CEN-N     PIC 99.
  3380             20  DC-ALPHA-YEAR         PIC 99.
  3381         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3382         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3383         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3384         16  DC-JULIAN-DATE            PIC 9(05).
  3385         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3386                                       PIC 9(05).
  3387         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3388             20  DC-JULIAN-YEAR        PIC 99.
  3389             20  DC-JULIAN-DAYS        PIC 999.
  3390         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3391         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3392         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3393     12  DATE-CONVERSION-VARIBLES.
  3394         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3395         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3396             20  FILLER                PIC 9(3).
  3397             20  HOLD-CEN-1-CCYY.
  3398                 24  HOLD-CEN-1-CC     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  64
* EL050.cbl
  3399                 24  HOLD-CEN-1-YY     PIC 99.
  3400             20  HOLD-CEN-1-MO         PIC 99.
  3401             20  HOLD-CEN-1-DA         PIC 99.
  3402         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3403             20  HOLD-CEN-1-R-MO       PIC 99.
  3404             20  HOLD-CEN-1-R-DA       PIC 99.
  3405             20  HOLD-CEN-1-R-CCYY.
  3406                 24  HOLD-CEN-1-R-CC   PIC 99.
  3407                 24  HOLD-CEN-1-R-YY   PIC 99.
  3408             20  FILLER                PIC 9(3).
  3409         16  HOLD-CENTURY-1-X.
  3410             20  FILLER                PIC X(3)  VALUE SPACES.
  3411             20  HOLD-CEN-1-X-CCYY.
  3412                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3413                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3414             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3415             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3416         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3417             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3418             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3419             20  HOLD-CEN-1-R-X-CCYY.
  3420                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3421                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3422             20  FILLER                PIC XXX.
  3423         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3424         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3425         16  DC-JULIAN-DATE-1          PIC 9(07).
  3426         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3427             20  DC-JULIAN-1-CCYY.
  3428                 24  DC-JULIAN-1-CC    PIC 99.
  3429                 24  DC-JULIAN-1-YR    PIC 99.
  3430             20  DC-JULIAN-DA-1        PIC 999.
  3431         16  DC-JULIAN-DATE-2          PIC 9(07).
  3432         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3433             20  DC-JULIAN-2-CCYY.
  3434                 24  DC-JULIAN-2-CC    PIC 99.
  3435                 24  DC-JULIAN-2-YR    PIC 99.
  3436             20  DC-JULIAN-DA-2        PIC 999.
  3437         16  DC-GREG-DATE-A-EDIT.
  3438             20  DC-EDITA-MONTH        PIC 99.
  3439             20  SLASHA-1              PIC X VALUE '/'.
  3440             20  DC-EDITA-DAY          PIC 99.
  3441             20  SLASHA-2              PIC X VALUE '/'.
  3442             20  DC-EDITA-CCYY.
  3443                 24  DC-EDITA-CENT     PIC 99.
  3444                 24  DC-EDITA-YEAR     PIC 99.
  3445         16  DC-GREG-DATE-B-EDIT.
  3446             20  DC-EDITB-MONTH        PIC 99.
  3447             20  SLASHB-1              PIC X VALUE '/'.
  3448             20  DC-EDITB-DAY          PIC 99.
  3449             20  SLASHB-2              PIC X VALUE '/'.
  3450             20  DC-EDITB-CCYY.
  3451                 24  DC-EDITB-CENT     PIC 99.
  3452                 24  DC-EDITB-YEAR     PIC 99.
  3453         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3454         16  DC-GREG-DATE-CYMD-R REDEFINES
  3455                              DC-GREG-DATE-CYMD.
  3456             20  DC-CYMD-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  65
* EL050.cbl
  3457             20  DC-CYMD-YEAR          PIC 99.
  3458             20  DC-CYMD-MONTH         PIC 99.
  3459             20  DC-CYMD-DAY           PIC 99.
  3460         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3461         16  DC-GREG-DATE-MDCY-R REDEFINES
  3462                              DC-GREG-DATE-MDCY.
  3463             20  DC-MDCY-MONTH         PIC 99.
  3464             20  DC-MDCY-DAY           PIC 99.
  3465             20  DC-MDCY-CEN           PIC 99.
  3466             20  DC-MDCY-YEAR          PIC 99.
  3467    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3468        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3469    12  DC-EL310-DATE                  PIC X(21).
  3470    12  FILLER                         PIC X(28).
  3471
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  66
* EL050.cbl
  3473*    COPY ELCCALC.
  3474******************************************************************
  3475*                                                                *
  3476*                           ELCCALC.                            *
  3477*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3478*                            VMOD=2.025                          *
  3479*                                                                *
  3480*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3481*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3482*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3483*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3484*                                                                *
  3485*  PASSED TO ELRTRM                                              *
  3486*  -----------------                                             *
  3487*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3488*  ORIGINAL TERM                                                 *
  3489*  BEGINNING DATE                                                *
  3490*  ENDING DATE                                                   *
  3491*  COMPANY I.D.                                                  *
  3492*  ACCOUNT MASTER USER FIELD                                     *
  3493*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3494*  FREE LOOK DAYS                                                *
  3495*                                                                *
  3496*  RETURNED FROM ELRTRM                                          *
  3497*  ---------------------                                         *
  3498*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3499*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3500*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3501*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3502*----------------------------------------------------------------*
  3503*  PASSED TO ELRAMT                                              *
  3504*  ----------------                                              *
  3505*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3506*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3507*  ORIGINAL AMOUNT                                               *
  3508*  ALTERNATE BENEFIT (BALLON)                                    *
  3509*  A.P.R. - NET PAY ONLY                                         *
  3510*  METHOD
  3511*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3512*  COMPANY I.D.                                                  *
  3513*  BENEFIT TYPE                                                  *
  3514*                                                                *
  3515*  RETURNED FROM ELRAMT                                          *
  3516*  --------------------                                          *
  3517*  REMAINING AMOUNT 1 - CURRENT                                  *
  3518*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3519*  REMAINING AMOUNT FACTOR
  3520*----------------------------------------------------------------*
  3521*  PASSED TO ELRESV                                              *
  3522*  -----------------                                             *
  3523*  CERTIFICATE EFFECTIVE DATE                                    *
  3524*  VALUATION DATE                                                *
  3525*  PAID THRU DATE                                                *
  3526*  BENEFIT                                                       *
  3527*  INCURRED DATE                                                 *
  3528*  REPORTED DATE                                                 *
  3529*  ISSUE AGE                                                     *
  3530*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  67
* EL050.cbl
  3531*  CDT PERCENT                                                   *
  3532*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3533* *CLAIM TYPE (LIFE, A/H)                                        *
  3534* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3535* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3536*                                                                *
  3537*  RETURNED FROM ELRESV                                          *
  3538*  --------------------                                          *
  3539*  CDT TABLE USED                                                *
  3540*  CDT FACTOR USED                                               *
  3541*  PAY TO CURRENT RESERVE                                        *
  3542*  I.B.N.R. - A/H ONLY                                           *
  3543*  FUTURE (ACCRUED) AH ONLY                                      *
  3544*----------------------------------------------------------------*
  3545*  PASSED TO ELRATE                                              *
  3546*  ----------------                                              *
  3547*  CERT ISSUE DATE                                               *
  3548*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3549*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3550*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3551*  STATE CODE (CLIENT DEFINED)                                   *
  3552*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3553*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3554*  DEVIATION CODE                                                *
  3555*  ISSUE AGE                                                     *
  3556*  ORIGINAL BENEFIT AMOUNT                                       *
  3557*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3558*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3559*  BENEFIT KIND (LIFE OR A/H)                                    *
  3560*  A.P.R.                                                        *
  3561*  METHOD
  3562*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3563*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3564*  COMPANY I.D. (3 CHARACTER)                                    *
  3565*  BENEFIT CODE                                                  *
  3566*  BENEFIT OVERRIDE CODE                                         *
  3567*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3568*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3569*  JOINT INDICATOR (CSL ONLY)                                    *
  3570*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3571*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3572*                                                                *
  3573*  RETURNED FROM ELRATE                                          *
  3574*  --------------------                                          *
  3575*  CALCULATED PREMIUM                                            *
  3576*  PREMIUM RATE                                                  *
  3577*  MORTALITY CODE                                                *
  3578*  MAX ATTAINED AGE                                              *
  3579*  MAX AGE                                                       *
  3580*  MAX TERM                                                      *
  3581*  MAX MONTHLY BENEFIT                                           *
  3582*  MAX TOTAL BENIFIT                                             *
  3583*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3584*----------------------------------------------------------------*
  3585*  PASSED TO ELRFND                                              *
  3586*  ----------------                                              *
  3587*  CERT ISSUE DATE                                               *
  3588*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  68
* EL050.cbl
  3589*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3590*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3591*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3592*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3593*  STATE CODE (CLIENT DEFINED)                                   *
  3594*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3595*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3596*  DEVIATION CODE                                                *
  3597*  ISSUE AGE                                                     *
  3598*  ORIGINAL BENEFIT AMOUNT                                       *
  3599*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3600*  PROCESS TYPE (CANCEL)                                         *
  3601*  BENEFIT KIND (LIFE OR A/H)                                    *
  3602*  A.P.R.                                                        *
  3603*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3604*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3605*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3606*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3607*  COMPANY I.D. (3 CHARACTER)                                    *
  3608*  BENEFIT CODE                                                  *
  3609*  BENEFIT OVERRIDE CODE                                         *
  3610*                                                                *
  3611*  RETURNED FROM ELRFND                                          *
  3612*  --------------------                                          *
  3613*  CALCULATED REFUND                                             *
  3614*----------------------------------------------------------------*
  3615*  PASSED TO ELEARN                                              *
  3616*  ----------------                                              *
  3617*  CERT ISSUE DATE                                               *
  3618*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3619*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3620*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3621*  STATE CODE (CLIENT DEFINED)                                   *
  3622*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3623*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3624*  DEVIATION CODE                                                *
  3625*  ISSUE AGE                                                     *
  3626*  ORIGINAL BENEFIT AMOUNT                                       *
  3627*  BENEFIT KIND (LIFE OR A/H)                                    *
  3628*  A.P.R.                                                        *
  3629*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3630*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3631*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3632*  COMPANY I.D. (3 CHARACTER)                                    *
  3633*  BENEFIT CODE                                                  *
  3634*  BENEFIT OVERRIDE CODE                                         *
  3635*                                                                *
  3636*  RETURNED FROM ELEARN                                          *
  3637*  --------------------                                          *
  3638*  INDICATED  EARNINGS                                           *
  3639*----------------------------------------------------------------*
  3640*                 LENGTH = 450                                   *
  3641*                                                                *
  3642******************************************************************
  3643******************************************************************
  3644*                   C H A N G E   L O G
  3645*
  3646* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  69
* EL050.cbl
  3647*-----------------------------------------------------------------
  3648*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3649* EFFECTIVE    NUMBER
  3650*-----------------------------------------------------------------
  3651* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3652* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3653* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3654* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3655* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3656* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3657* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3658* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3659* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3660* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3661* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3662******************************************************************
  3663
  3664 01  CALCULATION-PASS-AREA.
  3665     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3666                                     COMP.
  3667
  3668     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3669       88  NO-CP-ERROR                             VALUE ZERO.
  3670       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3671                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3672       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3673       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3674       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3675       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3676       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3677       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3678       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3679       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3680       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3681       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3682       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3683       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3684       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3685       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3686       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3687       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3688       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3689
  3690     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3691       88  NO-CP-ERROR-2                           VALUE ZERO.
  3692***********************  INPUT AREAS ****************************
  3693
  3694     12  CP-CALCULATION-AREA.
  3695         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3696         16  CP-CERT-EFF-DT        PIC XX.
  3697         16  CP-VALUATION-DT       PIC XX.
  3698         16  CP-PAID-THRU-DT       PIC XX.
  3699         16  CP-BENEFIT-TYPE       PIC X.
  3700           88  CP-AH                               VALUE 'A' 'D'
  3701                                                   'I' 'U'.
  3702           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3703           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3704         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  70
* EL050.cbl
  3705         16  CP-REPORTED-DT        PIC XX.
  3706         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3707         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3708         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3709                                     COMP-3.
  3710         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3711                                     COMP-3.
  3712         16  CP-CDT-METHOD         PIC X.
  3713           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3714           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3715           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3716         16  CP-CLAIM-TYPE         PIC X.
  3717           88  CP-AH-CLAIM                         VALUE 'A'.
  3718           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3719         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3720                                     COMP-3.
  3721         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3722                                     COMP-3.
  3723         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3724                                     COMP-3.
  3725         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3726                                     COMP-3.
  3727         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3728                                     COMP-3.
  3729         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3730                                     COMP-3.
  3731         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3732                                     COMP-3.
  3733         16  CP-REM-TERM-METHOD    PIC X.
  3734           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3735           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3736           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3737           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3738           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3739           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3740           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3741         16  CP-EARNING-METHOD     PIC X.
  3742           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3743           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3744           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3745           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3746           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3747           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3748           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3749           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3750           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3751           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3752           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3753           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3754           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3755           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3756         16  CP-PROCESS-TYPE       PIC X.
  3757           88  CP-CLAIM                            VALUE '1'.
  3758           88  CP-CANCEL                           VALUE '2'.
  3759           88  CP-ISSUE                            VALUE '3'.
  3760         16  CP-SPECIAL-CALC-CD    PIC X.
  3761           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3762           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  71
* EL050.cbl
  3763           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3764           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3765           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3766           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3767           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3768           88  CP-FARM-PLAN                    VALUE 'F'.
  3769           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3770           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3771           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3772           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3773           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3774           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3775           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3776           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3777           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3778           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3779                                                     'W' 'X'.
  3780           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3781           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3782           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3783           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3784           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3785           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3786           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3787           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3788           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3789           88  CP-CSL-METH-1                   VALUE '5'.
  3790           88  CP-CSL-METH-2                   VALUE '6'.
  3791           88  CP-CSL-METH-3                   VALUE '7'.
  3792           88  CP-CSL-METH-4                   VALUE '8'.
  3793
  3794         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3795                                     COMP-3.
  3796         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3797         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3798         16  CP-STATE              PIC XX          VALUE SPACE.
  3799         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3800         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3801           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3802               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3803         16  CP-R78-OPTION         PIC X.
  3804           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3805           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3806
  3807         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3808         16  CP-IBNR-RESERVE-SW    PIC X.
  3809         16  CP-CLAIM-STATUS       PIC X.
  3810         16  CP-RATE-FILE          PIC X.
  3811         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3812                                     COMP-3.
  3813
  3814         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3815         16  CP-AH-OVERRIDE-CODE   PIC X.
  3816
  3817         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3818                                     COMP-3.
  3819         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3820                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  72
* EL050.cbl
  3821         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3822                                     COMP-3.
  3823         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3824                                     COMP-3.
  3825         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3826                                     COMP-3.
  3827         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3828                                  PIC S9(7)V99 COMP-3.
  3829
  3830         16  CP-PAID-FROM-DATE     PIC X(02).
  3831         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3832         16  CP-EXT-DAYS-CALC      PIC X.
  3833           88  CP-EXT-NO-CHG                   VALUE ' '.
  3834           88  CP-EXT-CHG-LF                   VALUE '1'.
  3835           88  CP-EXT-CHG-AH                   VALUE '2'.
  3836           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3837         16  CP-DOMICILE-STATE     PIC XX.
  3838         16  CP-CARRIER            PIC X.
  3839         16  CP-REIN-FLAG          PIC X.
  3840         16  CP-REM-TRM-CALC-OPTION PIC X.
  3841           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3842                      '2' '3' '4' '5'.
  3843           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3844           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3845           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3846           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3847           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3848           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3849           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3850           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3851         16  CP-SIG-SWITCH         PIC X.
  3852         16  CP-RATING-METHOD      PIC X.
  3853           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3854           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3855           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3856           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3857           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3858           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3859           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3860           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3861           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3862         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3863                                     COMP-3.
  3864         16  CP-BEN-CATEGORY       PIC X.
  3865         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3866         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3867                                   PIC S99V9(5) COMP-3.
  3868         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3869         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3870                                   PIC S99V9(5) COMP-3.
  3871         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3872         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3873         16  CP-EXPIRE-DT          PIC XX.
  3874         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3875         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3876         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3877         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3878         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  73
* EL050.cbl
  3879             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3880             88  CP-CALC-CLP              VALUE 'C'.
  3881         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3882         16  CP-CANCEL-REASON      PIC X.
  3883         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3884         16  CP-PMT-MODE           PIC X.
  3885         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3886         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3887         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3888         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3889         16  FILLER                PIC X.
  3890
  3891***************    OUTPUT FROM ELRESV   ************************
  3892
  3893         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3894
  3895         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3896                                     COMP-3.
  3897         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3898                                     COMP-3.
  3899         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3900                                     COMP-3.
  3901         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3902                                     COMP-3.
  3903         16  FILLER                PIC X(09).
  3904***************    OUTPUT FROM ELRTRM   *************************
  3905
  3906         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3907                                     COMP-3.
  3908         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3909                                     COMP-3.
  3910         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3911                                     COMP-3.
  3912         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3913                                     COMP-3.
  3914         16  FILLER                PIC X(12).
  3915
  3916***************    OUTPUT FROM ELRAMT   *************************
  3917
  3918         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3919                                     COMP-3.
  3920         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3921                                     COMP-3.
  3922         16  FILLER                PIC X(12).
  3923
  3924***************    OUTPUT FROM ELRATE   *************************
  3925
  3926         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3927                                     COMP-3.
  3928         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3929                                     COMP-3.
  3930         16  CP-MORTALITY-CODE     PIC X(4).
  3931         16  CP-RATE-EDIT-FLAG     PIC X.
  3932             88  CP-RATES-NEED-APR                  VALUE '1'.
  3933         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3934                                     COMP-3.
  3935         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3936         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  74
* EL050.cbl
  3937         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3938                                   PIC S9(7)V99 COMP-3.
  3939         16  FILLER                PIC X(07).
  3940
  3941***************    OUTPUT FROM ELRFND   *************************
  3942
  3943         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3944                                     COMP-3.
  3945         16  CP-REFUND-TYPE-USED   PIC X.
  3946           88  CP-R-AS-R78                         VALUE '1'.
  3947           88  CP-R-AS-PRORATA                     VALUE '2'.
  3948           88  CP-R-AS-CALIF                       VALUE '3'.
  3949           88  CP-R-AS-TEXAS                       VALUE '4'.
  3950           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3951           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3952           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3953           88  CP-R-AS-MEAN                        VALUE '8'.
  3954           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3955           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3956           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3957           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3958           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3959           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3960         16  FILLER                PIC X(12).
  3961
  3962***************    OUTPUT FROM ELEARN   *************************
  3963
  3964         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3965                                     COMP-3.
  3966         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3967                                     COMP-3.
  3968         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3969                                     COMP-3.
  3970         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3971                                     COMP-3.
  3972         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3973                                     COMP-3.
  3974         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3975                                     COMP-3.
  3976         16  CP-EARNING-TYPE-USED  PIC X.
  3977           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3978           88  CP-E-AS-R78                         VALUE '1'.
  3979           88  CP-E-AS-PRORATA                     VALUE '2'.
  3980           88  CP-E-AS-TEXAS                       VALUE '4'.
  3981           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3982           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3983           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3984           88  CP-E-AS-MEAN                        VALUE '8'.
  3985           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3986         16  FILLER                PIC X(12).
  3987
  3988***************    OUTPUT FROM ELPMNT   *************************
  3989
  3990         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3991                                     COMP-3.
  3992         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3993                                     COMP-3.
  3994         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  75
* EL050.cbl
  3995
  3996***************   MISC WORK AREAS    *****************************
  3997         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3998                                     COMP-3.
  3999         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4000                                     COMP-3.
  4001         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4002                                     COMP-3.
  4003         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4004                                     COMP-3.
  4005         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4006                                     COMP-3.
  4007         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4008                                     COMP-3.
  4009         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4010             88  OPEN-RATE-FILE                   VALUE 'O'.
  4011             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4012             88  IO-ERROR                         VALUE 'E'.
  4013
  4014         16  CP-FIRST-PAY-DATE     PIC XX.
  4015
  4016         16  CP-JOINT-INDICATOR    PIC X.
  4017
  4018         16  CP-RESERVE-REMAINING-TERM
  4019                                   PIC S9(4)V9    VALUE ZERO
  4020                                     COMP-3.
  4021
  4022         16  CP-INSURED-BIRTH-DT   PIC XX.
  4023
  4024         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4025                                     COMP-3.
  4026
  4027         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4028                                     COMP-3.
  4029
  4030         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4031                                     COMP-3.
  4032
  4033         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4034                                     COMP-3.
  4035
  4036         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4037                                     COMP-3.
  4038
  4039         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4040                                     COMP-3.
  4041
  4042         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4043                                     COMP-3.
  4044
  4045         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4046             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4047
  4048         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4049                                     COMP-3.
  4050         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4051                                     COMP-3.
  4052         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  76
* EL050.cbl
  4053         16  cp-extra-periods      pic 9 value zeros.
  4054         16  cp-net-only-state     pic x value spaces.
  4055         16  FILLER                PIC X(13).
  4056******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  77
* EL050.cbl
  4058******************************************************************
  4059*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4060*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4061*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4062*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4063*** MODIFICATION.                                              ***
  4064*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4065*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4066******************************************************************
  4067*    COPY ERCPNDB.
  4068******************************************************************
  4069*                                                                *
  4070*                                                                *
  4071*                            ERCPNDB.                            *
  4072*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4073*                            VMOD=2.025                          *
  4074*                                                                *
  4075*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4076*                                                                *
  4077******************************************************************
  4078*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4079*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4080******************************************************************
  4081*                                                                *
  4082*                                                                *
  4083*   FILE TYPE = VSAM,KSDS                                        *
  4084*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4085*                                                                *
  4086*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4087*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4088*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4089*                                                 RKP=13,LEN=36  *
  4090*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4091*                                      AND CHG-SEQ.)             *
  4092*                                                RKP=49,LEN=11   *
  4093*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4094*                                      AND CHG-SEQ.)             *
  4095*                                                RKP=60,LEN=15   *
  4096*                                                                *
  4097*   LOG = NO                                                     *
  4098*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4099******************************************************************
  4100******************************************************************
  4101*                   C H A N G E   L O G
  4102*
  4103* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4104*-----------------------------------------------------------------
  4105*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4106* EFFECTIVE    NUMBER
  4107*-----------------------------------------------------------------
  4108* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4109* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4110* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4111* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4112* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4113* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4114* 032306                   PEMA  ADD BOW LOAN NUMBER
  4115* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  78
* EL050.cbl
  4116* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4117* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4118* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4119* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4120* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4121* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4122* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4123* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4124* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4125* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4126* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4127******************************************************************
  4128
  4129 01  PENDING-BUSINESS.
  4130     12  PB-RECORD-ID                     PIC XX.
  4131         88  VALID-PB-ID                        VALUE 'PB'.
  4132
  4133     12  PB-CONTROL-PRIMARY.
  4134         16  PB-COMPANY-CD                PIC X.
  4135         16  PB-ENTRY-BATCH               PIC X(6).
  4136         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4137         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4138
  4139     12  PB-CONTROL-BY-ACCOUNT.
  4140         16  PB-COMPANY-CD-A1             PIC X.
  4141         16  PB-CARRIER                   PIC X.
  4142         16  PB-GROUPING.
  4143             20  PB-GROUPING-PREFIX       PIC XXX.
  4144             20  PB-GROUPING-PRIME        PIC XXX.
  4145         16  PB-STATE                     PIC XX.
  4146         16  PB-ACCOUNT.
  4147             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4148             20  PB-ACCOUNT-PRIME         PIC X(6).
  4149         16  PB-CERT-EFF-DT               PIC XX.
  4150         16  PB-CERT-NO.
  4151             20  PB-CERT-PRIME            PIC X(10).
  4152             20  PB-CERT-SFX              PIC X.
  4153         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4154
  4155         16  PB-RECORD-TYPE               PIC X.
  4156             88  PB-MAILING-DATA                VALUE '0'.
  4157             88  PB-ISSUE                       VALUE '1'.
  4158             88  PB-CANCELLATION                VALUE '2'.
  4159             88  PB-BATCH-TRAILER               VALUE '9'.
  4160
  4161     12  PB-CONTROL-BY-ORIG-BATCH.
  4162         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4163         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4164         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4165         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4166
  4167     12  PB-CONTROL-BY-CSR.
  4168         16  PB-CSR-COMPANY-CD            PIC X.
  4169         16  PB-CSR-ID                    PIC X(4).
  4170         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4171         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4172         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4173******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  79
* EL050.cbl
  4174*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4175******************************************************************
  4176
  4177     12  PB-LAST-MAINT-DT                 PIC XX.
  4178     12  PB-LAST-MAINT-BY                 PIC X(4).
  4179     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4180
  4181     12  PB-RECORD-BODY                   PIC X(375).
  4182
  4183     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4184         16  PB-CERT-ORIGIN               PIC X.
  4185             88  CLASIC-CREATED-CERT         VALUE '1'.
  4186         16  PB-I-NAME.
  4187             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4188             20  PB-I-INSURED-FIRST-NAME.
  4189                 24  PB-I-INSURED-1ST-INIT PIC X.
  4190                 24  FILLER                PIC X(9).
  4191             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4192         16  PB-I-AGE                     PIC S99   COMP-3.
  4193         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4194         16  PB-I-BIRTHDAY                PIC XX.
  4195         16  PB-I-INSURED-SEX             PIC X.
  4196             88  PB-SEX-MALE     VALUE 'M'.
  4197             88  PB-SEX-FEMALE   VALUE 'F'.
  4198
  4199         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4200         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4201         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4202         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4203         16  PB-I-SKIP-CODE               PIC X.
  4204             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4205             88  PB-SKIP-JULY              VALUE '1'.
  4206             88  PB-SKIP-AUGUST            VALUE '2'.
  4207             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4208             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4209             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4210             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4211             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4212             88  PB-SKIP-JUNE              VALUE '8'.
  4213             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4214             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4215             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4216         16  PB-I-TERM-TYPE               PIC X.
  4217             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4218             88  PB-PAID-WEEKLY            VALUE 'W'.
  4219             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4220             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4221             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4222         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4223         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4224         16  PB-I-DATA-ENTRY-SW           PIC X.
  4225             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4226             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4227             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4228             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4229         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4230         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4231*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  80
* EL050.cbl
  4232         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4233         16  FILLER                       PIC X.
  4234
  4235         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4236             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4237             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4238                                                   '90' THRU '99'.
  4239         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4240                                          PIC XX.
  4241         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4242         16  PB-I-AMOUNT-FINANCED REDEFINES
  4243                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4244         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4245         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4246                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4247         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4248         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4249         16  PB-I-CLP-AMOUNT REDEFINES
  4250                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4251         16  PB-I-LF-CALC-FLAG            PIC X.
  4252             88 PB-COMP-LF-PREM               VALUE '?'.
  4253         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4254         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4255         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4256         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4257         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4258         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4259         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4260         16  PB-I-LF-ABBR                 PIC XXX.
  4261         16  PB-I-LF-INPUT-CD             PIC XX.
  4262
  4263         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4264             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4265             88  PB-INVALID-AH               VALUE '  ' '00'
  4266                                                   '90' THRU '99'.
  4267         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4268         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4269         16  PB-I-AH-CALC-FLAG            PIC X.
  4270             88 PB-COMP-AH-PREM                  VALUE '?'.
  4271         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4272         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4273         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4274         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4275         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4276         16  PB-I-AH-ABBR                 PIC XXX.
  4277         16  PB-I-AH-INPUT-CD             PIC XXX.
  4278
  4279         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4280         16  PB-I-REIN-TABLE              PIC XXX.
  4281         16  PB-I-BUSINESS-TYPE           PIC 99.
  4282         16  PB-I-INDV-GRP-CD             PIC X.
  4283         16  PB-I-MORT-CODE.
  4284             20  PB-I-TABLE               PIC X.
  4285             20  PB-I-INTEREST            PIC XX.
  4286             20  PB-I-MORT-TYP            PIC X.
  4287         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4288         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4289         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  81
* EL050.cbl
  4290         16  PB-I-INDV-GRP-OVRD           PIC X.
  4291         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4292         16  PB-I-SIG-SW                  PIC X.
  4293             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4294         16  PB-I-RATE-CLASS              PIC XX.
  4295         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4296         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4297         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4298         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4299         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4300         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4301         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4302         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4303         16  PB-I-OB-FLAG                 PIC X.
  4304             88  PB-I-OB                      VALUE 'B'.
  4305             88  PB-I-SUMMARY                 VALUE 'Z'.
  4306         16  PB-I-ENTRY-STATUS            PIC X.
  4307             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4308                                              'M' '5' '9' '2'.
  4309             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4310             88  PB-I-POLICY-PENDING          VALUE '2'.
  4311             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4312             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4313             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4314             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4315             88  PB-I-REIN-ONLY               VALUE '9'.
  4316             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4317             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4318             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4319             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4320         16  PB-I-INT-CODE                PIC X.
  4321             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4322             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4323         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4324         16  PB-I-SOC-SEC-NO              PIC X(11).
  4325         16  PB-I-MEMBER-NO               PIC X(12).
  4326         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4327*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4328         16  PB-I-OLD-LOF                 PIC XXX.
  4329         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4330         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4331         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4332         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4333         16  PB-I-LIFE-INDICATOR          PIC X.
  4334             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4335         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4336         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4337                                          PIC S9(5)V99    COMP-3.
  4338         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4339             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4340             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4341         16  PB-I-1ST-PMT-DT              PIC XX.
  4342         16  PB-I-JOINT-INSURED.
  4343             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4344             20 PB-I-JOINT-FIRST-NAME.
  4345                24  PB-I-JOINT-FIRST-INIT PIC X.
  4346                24  FILLER                PIC X(9).
  4347             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  82
* EL050.cbl
  4348*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4349         16  PB-I-BENEFICIARY-NAME.
  4350             20  PB-I-BANK-NUMBER         PIC X(10).
  4351             20  FILLER                   PIC X(15).
  4352         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4353         16  PB-I-REFERENCE               PIC X(12).
  4354         16  FILLER REDEFINES PB-I-REFERENCE.
  4355             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4356             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4357             20  PB-I-CLP-STATE           PIC XX.
  4358         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4359             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4360             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4361             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4362         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4363         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4364         16  PB-I-RESIDENT-STATE          PIC XX.
  4365         16  PB-I-RATE-CODE               PIC X(4).
  4366         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4367         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4368         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4369         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4370         16  PB-I-BANK-NOCHRGB            PIC 99.
  4371         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4372         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4373
  4374     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4375         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4376             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4377         16  PB-C-CANCEL-ORIGIN           PIC X.
  4378             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4379         16  PB-C-LF-CANCEL-DT            PIC XX.
  4380         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4381         16  PB-C-LF-CALC-REQ             PIC X.
  4382             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4383         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4384         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4385         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4386             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4387         16  PB-C-AH-CANCEL-DT            PIC XX.
  4388         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4389         16  PB-C-AH-CALC-REQ             PIC X.
  4390             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4391         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4392         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4393         16  PB-C-LAST-NAME               PIC X(15).
  4394         16  PB-C-REFUND-SW               PIC X.
  4395             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4396             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4397         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4398         16  PB-C-PAYEE-CODE              PIC X(6).
  4399         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4400         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4401         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4402         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4403         16  PB-C-REFERENCE               PIC X(12).
  4404         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4405         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  83
* EL050.cbl
  4406         16  PB-C-POST-CARD-IND           PIC X.
  4407         16  PB-C-CANCEL-REASON           PIC X.
  4408         16  PB-C-REF-INTERFACE-SW        PIC X.
  4409         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4410         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4411         16  FILLER                       PIC X(01).
  4412*        16  FILLER                       PIC X(18).
  4413         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4414*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4415         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4416         16  PB-CANCELED-CERT-DATA.
  4417             20  PB-CI-INSURED-NAME.
  4418                 24  PB-CI-LAST-NAME      PIC X(15).
  4419                 24  PB-CI-INITIALS       PIC XX.
  4420             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4421             20  PB-CI-INSURED-SEX        PIC X.
  4422             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4423             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4424             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4425             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4426             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4427             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4428             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4429             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4430             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4431             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4432             20  PB-CI-RATE-CLASS         PIC XX.
  4433             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4434             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4435             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4436             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4437             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4438             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4439             20  PB-CI-LF-ABBR            PIC X(3).
  4440             20  PB-CI-AH-ABBR            PIC X(3).
  4441             20  PB-CI-OB-FLAG            PIC X.
  4442                 88  PB-CI-OB                VALUE 'B'.
  4443             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4444                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4445                                           'M' '4' '5' '9' '2'.
  4446                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4447                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4448                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4449                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4450                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4451                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4452                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4453                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4454                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4455                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4456                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4457                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4458                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4459             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4460                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4461                                           'M' '4' '5' '9' '2'.
  4462                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4463                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  84
* EL050.cbl
  4464                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4465                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4466                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4467                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4468                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4469                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4470                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4471                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4472                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4473                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4474                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4475             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4476             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4477             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4478             20  PB-CI-MEMBER-NO          PIC X(12).
  4479             20  PB-CI-INT-CODE           PIC X.
  4480                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4481                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4482             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4483             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4484             20  PB-CI-COMP-EXCP-SW       PIC X.
  4485                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4486                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4487             20  PB-CI-ENTRY-STATUS       PIC X.
  4488             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4489             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4490             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4491             20  PB-CI-DEATH-DT           PIC XX.
  4492             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4493             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4494             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4495             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4496             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4497             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4498             20  PB-CI-ENTRY-DT              PIC XX.
  4499             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4500             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4501             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4502             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4503             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4504             20  PB-CI-OLD-LOF               PIC XXX.
  4505*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4506             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4507             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4508             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4509             20  PB-CI-INDV-GRP-CD           PIC X.
  4510             20  PB-CI-BENEFICIARY-NAME.
  4511                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4512                 24  FILLER                  PIC X(15).
  4513             20  PB-CI-NOTE-SW               PIC X.
  4514             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4515             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4516             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4517             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4518             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4519             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4520             20  PB-CI-FIRST-NAME            PIC X(10).
  4521             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  85
* EL050.cbl
  4522
  4523         16  FILLER                       PIC X(13).
  4524*032306  16  FILLER                       PIC X(27).
  4525*        16  FILLER                       PIC X(46).
  4526
  4527     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4528         16  FILLER                       PIC X(10).
  4529         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4530         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4531         16  PB-M-INSURED-MID-INIT        PIC X.
  4532         16  PB-M-INSURED-AGE             PIC 99.
  4533         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4534         16  PB-M-INSURED-SEX             PIC X.
  4535         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4536         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4537         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4538         16  PB-M-INSURED-CITY-STATE.
  4539             20  PB-M-INSURED-CITY        PIC X(28).
  4540             20  PB-M-INSURED-STATE       PIC XX.
  4541         16  PB-M-INSURED-ZIP-CODE.
  4542             20  PB-M-INSURED-ZIP-PRIME.
  4543                 24  PB-M-INSURED-ZIP-1   PIC X.
  4544                     88  PB-M-CANADIAN-POST-CODE
  4545                                             VALUE 'A' THRU 'Z'.
  4546                 24  FILLER               PIC X(4).
  4547             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4548         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4549                                        PB-M-INSURED-ZIP-CODE.
  4550             20  PM-M-INS-CAN-POST1       PIC XXX.
  4551             20  PM-M-INS-CAN-POST2       PIC XXX.
  4552             20  FILLER                   PIC XXX.
  4553         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4554         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4555         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4556         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4557         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4558         16  PB-M-CRED-BENE-CITYST.
  4559             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4560             20  PB-M-CRED-BENE-STATE     PIC XX.
  4561         16  FILLER                       PIC X(92).
  4562
  4563     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4564         16  FILLER                       PIC X(10).
  4565         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4566         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4567         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4568         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4569         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4570         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4571         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4572         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4573         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4574         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4575         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4576         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4577         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4578         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4579         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  86
* EL050.cbl
  4580         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4581         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4582         16  PB-ACCOUNT-NAME              PIC X(30).
  4583         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4584         16  PB-REFERENCE                 PIC X(12).
  4585         16  PB-B-RECEIVED-DT             PIC XX.
  4586         16  FILLER                       PIC X(234).
  4587
  4588     12  PB-RECORD-STATUS.
  4589         16  PB-CREDIT-SELECT-DT          PIC XX.
  4590         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4591         16  PB-BILLED-DT                 PIC XX.
  4592         16  PB-BILLING-STATUS            PIC X.
  4593             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4594             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4595             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4596         16  PB-RECORD-BILL               PIC X.
  4597             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4598             88  PB-RECORD-RETURNED           VALUE 'R'.
  4599             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4600             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4601             88  PB-OVERRIDE-AH               VALUE 'A'.
  4602             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4603         16  PB-BATCH-ENTRY               PIC X.
  4604             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4605             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4606             88  PB-REISSUED-CERT             VALUE 'E'.
  4607             88  PB-CASH-CERT                 VALUE 'C'.
  4608             88  PB-MONTHLY-CERT              VALUE 'M'.
  4609             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4610             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4611             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4612         16  PB-FORCE-CODE                PIC X.
  4613             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4614             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4615             88  PB-CANCEL-FORCE              VALUE '8'.
  4616             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4617             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4618             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4619             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4620             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4621             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4622             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4623             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4624         16  PB-FATAL-FLAG                PIC X.
  4625             88  PB-FATAL-ERRORS              VALUE 'X'.
  4626         16  PB-FORCE-ER-CD               PIC X.
  4627             88  PB-FORCE-ERRORS              VALUE 'F'.
  4628             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4629         16  PB-WARN-ER-CD                PIC X.
  4630             88  PB-WARNING-ERRORS            VALUE 'W'.
  4631         16  FILLER                       PIC X.
  4632         16  PB-OUT-BAL-CD                PIC X.
  4633             88  PB-OUT-OF-BAL                VALUE 'O'.
  4634         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4635         16  PB-AH-OVERRIDE-L1            PIC X.
  4636         16  PB-INPUT-DT                  PIC XX.
  4637         16  PB-INPUT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  87
* EL050.cbl
  4638         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4639         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4640         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4641         16  PB-LF-EARNING-METHOD         PIC X.
  4642         16  PB-AH-EARNING-METHOD         PIC X.
  4643         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4644         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4645         16  PB-REIN-CD                   PIC XXX.
  4646         16  PB-LF-REFUND-TYPE            PIC X.
  4647         16  PB-AH-REFUND-TYPE            PIC X.
  4648         16  PB-ACCT-EFF-DT               PIC XX.
  4649         16  PB-ACCT-EXP-DT               PIC XX.
  4650         16  PB-COMPANY-ID                PIC X(3).
  4651         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4652         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4653         16  PB-SV-CARRIER                PIC X.
  4654         16  PB-SV-GROUPING               PIC X(6).
  4655         16  PB-SV-STATE                  PIC XX.
  4656         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4657         16  PB-GA-BILLING-INFO.
  4658             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4659                                          PIC XX.
  4660         16  PB-SV-REMIT-TO  REDEFINES
  4661             PB-GA-BILLING-INFO           PIC X(10).
  4662         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4663         16  PB-I-LOAN-OFFICER            PIC X(5).
  4664         16  PB-I-VIN                     PIC X(17).
  4665
  4666         16  FILLER                       PIC X(04).
  4667         16  IMNET-BYPASS-SW              PIC X.
  4668
  4669******************************************************************
  4670*                COMMON EDIT ERRORS                              *
  4671******************************************************************
  4672
  4673     12  PB-COMMON-ERRORS.
  4674         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4675                                           PIC S9(4)     COMP.
  4676
  4677******************************************************************
  4678
  4679* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4680*    COPY ELC50W1.
  4681******************************************************************
  4682*                                                                *
  4683*                                                                *
  4684*                             ELC50W1                            *
  4685*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4686*                            VMOD=2.004                          *
  4687*                                                                *
  4688*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4689*                                                                *
  4690*                                                                *
  4691******************************************************************
  4692
  4693     12  WK-WORK-AREA.
  4694         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4695         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  88
* EL050.cbl
  4696         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4697         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4698         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4699         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4700         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4701         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4702         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4703         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4704         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4705         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4706         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4707         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4708         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4709         16  WK-CREDIT-EDIT-CONTROLS.
  4710             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4711             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4712             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4713             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4714             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4715             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4716         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4717         16  WK-SAVE-REIN-DATA.
  4718             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4719             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4720             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4721         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4722             88  ENTRY-FROM-EL6311       VALUE '6'.
  4723         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4724         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4725     12  WK-RECORD-ADDRESSES.
  4726         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4727         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4728         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4729         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4730         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4731         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4732         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4733         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4734     12  WK-OVER-SHORT-AREA.
  4735         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4736         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4737         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4738             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4739         16  FILLER                   PIC X(5) VALUE SPACES.
  4740
  4741*    COPY ELCEDITC.
  4742******************************************************************
  4743*                                                                *
  4744*                                                                *
  4745*                            ELCEDITC                            *
  4746*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4747*                            VMOD=2.012                          *
  4748*                                                                *
  4749*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4750*                     EL6313, EL050 AND EL517.                   *
  4751*                                                                *
  4752******************************************************************
  4753******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  89
* EL050.cbl
  4754*                   C H A N G E   L O G
  4755*
  4756* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4757*-----------------------------------------------------------------
  4758*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4759* EFFECTIVE    NUMBER
  4760*-----------------------------------------------------------------
  4761* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4762******************************************************************
  4763
  4764     12  EDIT-CRITERIA-DATA.
  4765         16  EC-CO-MONTH-END-DT       PIC XX.
  4766         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4767         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4768         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4769         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4770         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4771         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4772         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4773         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4774         16  EC-CO-REM-TERM-CALC      PIC X.
  4775               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4776               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4777               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4778               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4779
  4780         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4781               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4782               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4783               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4784               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4785               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4786               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4787               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4788               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4789               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4790               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4791
  4792         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4793               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4794               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4795               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4796               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4797               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4798               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4799               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4800               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4801
  4802         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4803                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4804                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4805
  4806         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4807                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4808                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4809                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4810                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4811                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  90
* EL050.cbl
  4812                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4813                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4814                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4815
  4816         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4817               88  EC-BR-REDUCING                   VALUE 'R'.
  4818               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4819
  4820         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4821         16  EC-BR-LF-DESC             PIC X(10).
  4822         16  EC-BR-AH-DESC             PIC X(10).
  4823         16  EC-BR-LF-COMMENT          PIC X(10).
  4824         16  EC-BR-AH-COMMENT          PIC X(10).
  4825
  4826         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4827               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4828               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4829               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4830               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4831
  4832         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4833               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4834               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4835               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4836               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4837
  4838         16  EC-BR-LF-REFUND-CALC      PIC X.
  4839                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4840                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4841                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4842                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4843                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4844                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4845                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4846
  4847         16  EC-BR-AH-REFUND-CALC      PIC X.
  4848                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4849                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4850                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4851                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4852                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4853                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4854                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4855                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4856
  4857         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4858                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4859                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4860                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4861
  4862         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4863                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4864                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4865                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4866
  4867         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4868         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4869         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  91
* EL050.cbl
  4870         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4871
  4872         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4873         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4874                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4875                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4876                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4877                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4878
  4879         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4880               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4881               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4882               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4883               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4884               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4885
  4886         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4887               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4888               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4889               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4890               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4891               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4892
  4893         16  EC-ST-LF-REFUND-CALC      PIC X.
  4894                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4895                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4896                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4897                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4898                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4899                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4900                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4901                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4902
  4903         16  EC-ST-AH-REFUND-CALC      PIC X.
  4904                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4905                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4906                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4907                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4908                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4909                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4910                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4911                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4912
  4913         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4914         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4915         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4916         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4917         16  EC-AM-EXPIRATION-DT       PIC XX.
  4918         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4919         16  EC-AM-CLASS-CD            PIC XX.
  4920         16  EC-AM-LF-DEVIATION        PIC XXX.
  4921         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4922         16  EC-AM-AH-DEVIATION        PIC XXX.
  4923         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4924         16  EC-AM-PHONE-NO            PIC X(10).
  4925
  4926         16  EC-AM-LF-REFUND-CALC      PIC X.
  4927                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  92
* EL050.cbl
  4928                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4929                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4930                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4931                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4932                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4933                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4934
  4935         16  EC-AM-AH-REFUND-CALC      PIC X.
  4936                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4937                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4938                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4939                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4940                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4941                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4942                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4943
  4944         16  EC-AM-BEN-I-G-CD          PIC X.
  4945                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4946                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4947                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4948
  4949         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4950         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4951         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4952         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4953         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4954         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4955         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4956         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4957         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4958
  4959         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4960         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4961         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4962         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4963         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4964         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4965         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4966         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4967         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4968         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4969         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4970         16  EC-RT-LF-NSP-ST           PIC XX.
  4971         16  EC-RT-AH-NSP-ST           PIC XX.
  4972         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4973         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4974
  4975         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4976             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4977                                             'M' '5' '9' '2'.
  4978             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4979             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4980             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4981             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4982             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4983             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4984             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4985             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  93
* EL050.cbl
  4986             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4987             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4988
  4989         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4990             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4991                                             'M' '5' '9' '2'.
  4992             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4993             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4994             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4995             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4996             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4997             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4998             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4999             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  5000             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  5001             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  5002
  5003         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5004         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5005         16  EC-CM-LF-CANCEL-DT        PIC XX.
  5006         16  EC-CM-AH-CANCEL-DT        PIC XX.
  5007         16  EC-CM-DEATH-DT            PIC XX.
  5008
  5009*DMD CUSTOM CODING FIELDS BELOW
  5010*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  5011         16  EC-BR-DMD-RATING-SW       PIC X.
  5012                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  5013                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  5014                 88  NO-DMD-RATING               VALUE 'N'.
  5015
  5016         16  EC-NEW-CERT               PIC X(11).
  5017         16  EC-NEW-STATE              PIC XX.
  5018         16  FILLER                    PIC X.
  5019*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  5020         16  OVER-SHORT-EDIT-FIELDS.
  5021             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5022             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5023             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5024             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5025             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  5026             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5027             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5028             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5029             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5030         16  FILLER                    PIC X(71).
  5031******************************************************************
  5032
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  94
* EL050.cbl
  5034*    COPY ELCDIFRD.
  5035******************************************************************
  5036*                                                                *
  5037*                                                                *
  5038*                            ELCDIFRD.                           *
  5039*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5040*                            VMOD=2.004                          *
  5041*                                                                *
  5042*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  5043*                                                                *
  5044******************************************************************
  5045*
  5046  01  WS-DIFFERENCE-CALCULATION.
  5047        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  5048        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  5049        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  5050        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  5051        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  5052        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5053        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5054        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5055        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5056        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5057        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5058
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  95
* EL050.cbl
  5060****************************************************************
  5061*
  5062* Copyright (c) 2007-2013 Dell Inc.
  5063* All rights reserved.
  5064*
  5065****************************************************************
  5066 01  DFHEIV.
  5067   02  DFHEIV0               PIC X(35).
  5068   02  DFHEIV1               PIC X(08).
  5069   02  DFHEIV2               PIC X(08).
  5070   02  DFHEIV3               PIC X(08).
  5071   02  DFHEIV4               PIC X(06).
  5072   02  DFHEIV5               PIC X(04).
  5073   02  DFHEIV6               PIC X(04).
  5074   02  DFHEIV7               PIC X(02).
  5075   02  DFHEIV8               PIC X(02).
  5076   02  DFHEIV9               PIC X(01).
  5077   02  DFHEIV10              PIC S9(7) COMP-3.
  5078   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5079   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5080   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5081   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5082   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5083   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5084   02  DFHEIV17              PIC X(04).
  5085   02  DFHEIV18              PIC X(04).
  5086   02  DFHEIV19              PIC X(04).
  5087   02  DFHEIV20              USAGE IS POINTER.
  5088   02  DFHEIV21              USAGE IS POINTER.
  5089   02  DFHEIV22              USAGE IS POINTER.
  5090   02  DFHEIV23              USAGE IS POINTER.
  5091   02  DFHEIV24              USAGE IS POINTER.
  5092   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5093   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5094   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5095   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5096   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5097   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5098   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5099   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5100   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5101   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5102   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5103   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5104   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5105   02  FILLER                PIC X(02).
  5106   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5107   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5108   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5109   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5110   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5111   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5112   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5113 LINKAGE  SECTION.
  5114*****************************************************************
  5115*                                                               *
  5116* Copyright (c) 2007-2013 Dell Inc.                             *
  5117* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  96
* EL050.cbl
  5118*                                                               *
  5119*****************************************************************
  5120 01  dfheiblk.
  5121     02  eibtime          pic s9(7) comp-3.
  5122     02  eibdate          pic s9(7) comp-3.
  5123     02  eibtrnid         pic x(4).
  5124     02  eibtaskn         pic s9(7) comp-3.
  5125     02  eibtrmid         pic x(4).
  5126     02  dfheigdi         pic s9(4) comp.
  5127     02  eibcposn         pic s9(4) comp.
  5128     02  eibcalen         pic s9(4) comp.
  5129     02  eibaid           pic x(1).
  5130     02  eibfiller1       pic x(1).
  5131     02  eibfn            pic x(2).
  5132     02  eibfiller2       pic x(2).
  5133     02  eibrcode         pic x(6).
  5134     02  eibfiller3       pic x(2).
  5135     02  eibds            pic x(8).
  5136     02  eibreqid         pic x(8).
  5137     02  eibrsrce         pic x(8).
  5138     02  eibsync          pic x(1).
  5139     02  eibfree          pic x(1).
  5140     02  eibrecv          pic x(1).
  5141     02  eibsend          pic x(1).
  5142     02  eibatt           pic x(1).
  5143     02  eibeoc           pic x(1).
  5144     02  eibfmh           pic x(1).
  5145     02  eibcompl         pic x(1).
  5146     02  eibsig           pic x(1).
  5147     02  eibconf          pic x(1).
  5148     02  eiberr           pic x(1).
  5149     02  eibrldbk         pic x(1).
  5150     02  eiberrcd         pic x(4).
  5151     02  eibsynrb         pic x(1).
  5152     02  eibnodat         pic x(1).
  5153     02  eibfiller5       pic x(2).
  5154     02  eibresp          pic s9(8) comp.
  5155     02  eibresp2         pic s9(8) comp.
  5156     02  dfheigdj         pic s9(4) comp.
  5157     02  dfheigdk         pic s9(4) comp.
  5158
  5159 01  DFHCOMMAREA                   PIC X(1036).
  5160
  5161*01 PARMLIST .
  5162*    02  FILLER                    PIC S9(8)   COMP.
  5163*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5164*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5165*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5166*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5167*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5168*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5169*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5170
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  97
* EL050.cbl
  5172*    COPY ELCCNTL.
  5173******************************************************************
  5174*                                                                *
  5175*                                                                *
  5176*                            ELCCNTL.                            *
  5177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5178*                            VMOD=2.059                          *
  5179*                                                                *
  5180*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5181*                                                                *
  5182*   FILE TYPE = VSAM,KSDS                                        *
  5183*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5184*                                                                *
  5185*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5186*       ALTERNATE INDEX = NONE                                   *
  5187*                                                                *
  5188*   LOG = YES                                                    *
  5189*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5190******************************************************************
  5191*                   C H A N G E   L O G
  5192*
  5193* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5194*-----------------------------------------------------------------
  5195*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5196* EFFECTIVE    NUMBER
  5197*-----------------------------------------------------------------
  5198* 082503                   PEMA  ADD BENEFIT GROUP
  5199* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5200* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5201* 092705    2005050300006  PEMA  ADD SPP LEASES
  5202* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5203* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5204* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5205* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5206* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5207* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5208* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5209* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5210* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5211* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5212* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5213******************************************************************
  5214*
  5215 01  CONTROL-FILE.
  5216     12  CF-RECORD-ID                       PIC XX.
  5217         88  VALID-CF-ID                        VALUE 'CF'.
  5218
  5219     12  CF-CONTROL-PRIMARY.
  5220         16  CF-COMPANY-ID                  PIC XXX.
  5221         16  CF-RECORD-TYPE                 PIC X.
  5222             88  CF-COMPANY-MASTER              VALUE '1'.
  5223             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5224             88  CF-STATE-MASTER                VALUE '3'.
  5225             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5226             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5227             88  CF-CARRIER-MASTER              VALUE '6'.
  5228             88  CF-MORTALITY-MASTER            VALUE '7'.
  5229             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  98
* EL050.cbl
  5230             88  CF-TERMINAL-MASTER             VALUE '9'.
  5231             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5232             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5233             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5234             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5235             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5236             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5237             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5238             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5239             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5240         16  CF-ACCESS-CD-GENL              PIC X(4).
  5241         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5242             20  CF-PROCESSOR               PIC X(4).
  5243         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5244             20  CF-STATE-CODE              PIC XX.
  5245             20  FILLER                     PIC XX.
  5246         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5247             20  FILLER                     PIC XX.
  5248             20  CF-HI-BEN-IN-REC           PIC XX.
  5249         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5250             20  FILLER                     PIC XXX.
  5251             20  CF-CARRIER-CNTL            PIC X.
  5252         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5253             20  FILLER                     PIC XX.
  5254             20  CF-HI-TYPE-IN-REC          PIC 99.
  5255         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5256             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5257                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5258             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5259             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5260         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5261             20  FILLER                     PIC X.
  5262             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5263         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5264             20  FILLER                     PIC XX.
  5265             20  CF-MORTGAGE-PLAN           PIC XX.
  5266         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5267
  5268     12  CF-LAST-MAINT-DT                   PIC XX.
  5269     12  CF-LAST-MAINT-BY                   PIC X(4).
  5270     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5271
  5272     12  CF-RECORD-BODY                     PIC X(728).
  5273
  5274
  5275****************************************************************
  5276*             COMPANY MASTER RECORD                            *
  5277****************************************************************
  5278
  5279     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5280         16  CF-COMPANY-ADDRESS.
  5281             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5282             20  CF-CL-IN-CARE-OF           PIC X(30).
  5283             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5284             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5285             20  CF-CL-CITY-STATE           PIC X(30).
  5286             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5287             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page  99
* EL050.cbl
  5288         16  CF-COMPANY-CD                  PIC X.
  5289         16  CF-COMPANY-PASSWORD            PIC X(8).
  5290         16  CF-SECURITY-OPTION             PIC X.
  5291             88  ALL-SECURITY                   VALUE '1'.
  5292             88  COMPANY-VERIFY                 VALUE '2'.
  5293             88  PROCESSOR-VERIFY               VALUE '3'.
  5294             88  NO-SECURITY                    VALUE '4'.
  5295             88  ALL-BUT-TERM                   VALUE '5'.
  5296         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5297             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5298         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5299             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5300         16  CF-INFORCE-LOCATION            PIC X.
  5301             88  CERTS-ARE-ONLINE               VALUE '1'.
  5302             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5303             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5304         16  CF-LOWER-CASE-LETTERS          PIC X.
  5305         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5306             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5307             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5308             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5309             88  CF-ACCNT-CNTL                  VALUE '3'.
  5310             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5311
  5312         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5313         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5314
  5315         16  CF-LGX-CREDIT-USER             PIC X.
  5316             88  CO-IS-NOT-USER                 VALUE 'N'.
  5317             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5318
  5319         16 CF-CREDIT-CALC-CODES.
  5320             20  CF-CR-REM-TERM-CALC PIC X.
  5321               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5322               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5323               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5324               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5325               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5326               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5327               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5328             20  CF-CR-R78-METHOD           PIC X.
  5329               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5330               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5331
  5332         16  CF-CLAIM-CONTROL-COUNTS.
  5333             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5334                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5335
  5336             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5337                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5338
  5339             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5340                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5341
  5342             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5343                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5344
  5345         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 100
* EL050.cbl
  5346
  5347         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5348             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5349             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5350             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5351             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5352                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5353                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5354             20  CF-CO-PREM-REJECT-SW       PIC X.
  5355                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5356                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5357             20  CF-CO-REF-REJECT-SW        PIC X.
  5358                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5359                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5360
  5361         16  CF-CO-REPORTING-DT             PIC XX.
  5362         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5363         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5364           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5365           88  CF-CO-MONTH-END                  VALUE '1'.
  5366
  5367         16  CF-LGX-CLAIM-USER              PIC X.
  5368             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5369             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5370
  5371         16  CF-CREDIT-EDIT-CONTROLS.
  5372             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5373             20  CF-MIN-AGE                 PIC 99.
  5374             20  CF-DEFAULT-AGE             PIC 99.
  5375             20  CF-MIN-TERM                PIC S999      COMP-3.
  5376             20  CF-MAX-TERM                PIC S999      COMP-3.
  5377             20  CF-DEFAULT-SEX             PIC X.
  5378             20  CF-JOINT-AGE-INPUT         PIC X.
  5379                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5380             20  CF-BIRTH-DATE-INPUT        PIC X.
  5381                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5382             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5383                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5384                 88  CF-ZERO-CARRIER            VALUE '1'.
  5385                 88  CF-ZERO-GROUPING           VALUE '2'.
  5386                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5387             20  CF-EDIT-SW                 PIC X.
  5388                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5389             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5390             20  CF-CR-PR-METHOD            PIC X.
  5391               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5392               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5393             20  FILLER                     PIC X.
  5394
  5395         16  CF-CREDIT-MISC-CONTROLS.
  5396             20  CF-REIN-TABLE-SW           PIC X.
  5397                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5398             20  CF-COMP-TABLE-SW           PIC X.
  5399                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5400             20  CF-EXPERIENCE-RETENTION-AGE
  5401                                            PIC S9        COMP-3.
  5402             20  CF-CONVERSION-DT           PIC XX.
  5403             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 101
* EL050.cbl
  5404             20  CF-RUN-FREQUENCY-SW        PIC X.
  5405                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5406                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5407
  5408             20  CF-CR-CHECK-NO-CONTROL.
  5409                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5410                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5411                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5412                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5413                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5414                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5415
  5416                 24  CF-CR-CHECK-COUNT       REDEFINES
  5417                     CF-CR-CHECK-COUNTER      PIC X(4).
  5418
  5419                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5420                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5421
  5422                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5423                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5424                 24  CF-MAIL-PROCESSING       PIC X.
  5425                     88  MAIL-PROCESSING          VALUE 'Y'.
  5426
  5427         16  CF-MISC-SYSTEM-CONTROL.
  5428             20  CF-SYSTEM-C                 PIC X.
  5429                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5430             20  CF-SYSTEM-D                 PIC X.
  5431                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5432             20  CF-SOC-SEC-NO-SW            PIC X.
  5433                 88  SOC-SEC-NO-USED             VALUE '1'.
  5434             20  CF-MEMBER-NO-SW             PIC X.
  5435                 88  MEMBER-NO-USED              VALUE '1'.
  5436             20  CF-TAX-ID-NUMBER            PIC X(11).
  5437             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5438             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5439                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5440                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5441                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5442                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5443             20  CF-SYSTEM-E                 PIC X.
  5444                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5445
  5446         16  CF-LGX-LIFE-USER               PIC X.
  5447             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5448             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5449
  5450         16  CF-CR-MONTH-END-DT             PIC XX.
  5451
  5452         16  CF-FILE-MAINT-DATES.
  5453             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5454                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5455             20  CF-LAST-BATCH       REDEFINES
  5456                 CF-LAST-BATCH-NO               PIC X(4).
  5457             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5458             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5459             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5460             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5461             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 102
* EL050.cbl
  5462             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5463             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5464             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5465             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5466             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5467
  5468         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5469         16  FILLER                         PIC X.
  5470
  5471         16  CF-ALT-MORT-CODE               PIC X(4).
  5472         16  CF-MEMBER-CAPTION              PIC X(10).
  5473
  5474         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5475             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5476             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5477             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5478             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5479             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5480
  5481         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5482
  5483         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5484         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5485         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5486         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5487
  5488         16  CF-AH-OVERRIDE-L1              PIC X.
  5489         16  CF-AH-OVERRIDE-L2              PIC XX.
  5490         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5491         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5492
  5493         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5494         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5495
  5496         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5497         16  CF-AR-LAST-EL860-DT            PIC XX.
  5498         16  CF-MP-MONTH-END-DT             PIC XX.
  5499
  5500         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5501         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5502             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5503
  5504         16  CF-AR-MONTH-END-DT             PIC XX.
  5505
  5506         16  CF-CRDTCRD-USER                PIC X.
  5507             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5508             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5509
  5510         16  CF-CC-MONTH-END-DT             PIC XX.
  5511
  5512         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5513
  5514         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5515             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5516             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5517             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5518         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5519         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 103
* EL050.cbl
  5520         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5521         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5522             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5523             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5524         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5525         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5526         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5527             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5528         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5529
  5530         16  CF-CL-ZIP-CODE.
  5531             20  CF-CL-ZIP-PRIME.
  5532                 24  CF-CL-ZIP-1ST          PIC X.
  5533                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5534                 24  FILLER                 PIC X(4).
  5535             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5536         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5537             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5538             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5539             20  FILLER                     PIC XXX.
  5540
  5541         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5542         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5543         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5544         16  CF-CO-OPTION-START-DATE        PIC XX.
  5545         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5546           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5547                                                      '3' '4'.
  5548           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5549           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5550           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5551           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5552           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5553           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5554
  5555         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5556
  5557         16  CF-PAYMENT-APPROVAL-LEVELS.
  5558             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5559             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5560             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5561             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5562             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5563             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5564
  5565         16  CF-END-USER-REPORTING-USER     PIC X.
  5566             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5567             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5568
  5569         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5570             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5571             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5572
  5573         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5574
  5575         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5576         16  FILLER                         PIC X.
  5577
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 104
* EL050.cbl
  5578         16  CF-CREDIT-ARCHIVE-CNTL.
  5579             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5580             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5581             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5582
  5583         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5584
  5585         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5586             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5587             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5588
  5589         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5590             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5591             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5592
  5593         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5594
  5595         16  CF-CO-ACH-ID-CODE              PIC  X.
  5596             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5597             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5598             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5599         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5600         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5601         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5602         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5603         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5604         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5605         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5606         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5607         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5608                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5609         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5610                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5611
  5612         16  CF-CO-OVER-SHORT.
  5613             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5614             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5615
  5616*         16  FILLER                         PIC X(102).
  5617         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5618             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5619             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5620
  5621         16  CF-AH-APPROVAL-DAYS.
  5622             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5623             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5624             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5625             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5626
  5627         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5628
  5629         16  CF-APPROV-LEV-5.
  5630             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5631             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5632             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5633
  5634         16  FILLER                         PIC X(68).
  5635****************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 105
* EL050.cbl
  5636*             PROCESSOR/USER RECORD                            *
  5637****************************************************************
  5638
  5639     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5640         16  CF-PROCESSOR-NAME              PIC X(30).
  5641         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5642         16  CF-PROCESSOR-TITLE             PIC X(26).
  5643         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5644                 88  MESSAGE-YES                VALUE 'Y'.
  5645                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5646
  5647*****************************************************
  5648****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5649****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5650****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5651****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5652*****************************************************
  5653
  5654         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5655             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5656             20  CF-APPLICATION-FORCE       PIC X.
  5657             20  CF-INDIVIDUAL-APP.
  5658                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5659                     28  CF-BROWSE-APP      PIC X.
  5660                     28  CF-UPDATE-APP      PIC X.
  5661
  5662         16  CF-CURRENT-TERM-ON             PIC X(4).
  5663         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5664             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5665             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5666             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5667             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5668             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5669             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5670             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5671         16  CF-PROCESSOR-CARRIER           PIC X.
  5672             88  NO-CARRIER-SECURITY            VALUE ' '.
  5673         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5674             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5675         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5676             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5677         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5678             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5679
  5680         16  CF-PROC-SYS-ACCESS-SW.
  5681             20  CF-PROC-CREDIT-CLAIMS-SW.
  5682                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5683                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5684                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5685                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5686             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5687                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5688                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5689             20  CF-PROC-LIFE-GNRLDGR-SW.
  5690                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5691                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5692                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5693                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 106
* EL050.cbl
  5694             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5695                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5696                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5697         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5698             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5699             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5700         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5701
  5702         16  CF-APPROVAL-LEVEL                  PIC X.
  5703             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5704             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5705             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5706             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5707             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5708
  5709         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5710
  5711         16  CF-LANGUAGE-TYPE                   PIC X.
  5712             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5713             88  CF-LANG-IS-FR                      VALUE 'F'.
  5714
  5715         16  CF-CSR-IND                         PIC X.
  5716         16  FILLER                             PIC X(239).
  5717
  5718****************************************************************
  5719*             PROCESSOR/REMINDERS RECORD                       *
  5720****************************************************************
  5721
  5722     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5723         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5724             20  CF-START-REMIND-DT         PIC XX.
  5725             20  CF-END-REMIND-DT           PIC XX.
  5726             20  CF-REMINDER-TEXT           PIC X(50).
  5727         16  FILLER                         PIC X(296).
  5728
  5729
  5730****************************************************************
  5731*             STATE MASTER RECORD                              *
  5732****************************************************************
  5733
  5734     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5735         16  CF-STATE-ABBREVIATION          PIC XX.
  5736         16  CF-STATE-NAME                  PIC X(25).
  5737         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5738         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5739             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5740             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5741             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5742             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5743                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5744                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5745             20  CF-ST-PREM-REJECT-SW       PIC X.
  5746                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5747                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5748             20  CF-ST-REF-REJECT-SW        PIC X.
  5749                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5750                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5751         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 107
* EL050.cbl
  5752         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5753         16  CF-ST-REFUND-RULES.
  5754             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5755             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5756             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5757         16  CF-ST-FST-PMT-EXTENSION.
  5758             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5759             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5760                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5761                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5762                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5763                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5764         16  CF-ST-STATE-CALL.
  5765             20  CF-ST-CALL-UNEARNED        PIC X.
  5766             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5767             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5768         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5769             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5770             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5771         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5772         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5773         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5774         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5775         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5776         16  FILLER                         PIC X.
  5777         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5778             20  CF-ST-BENEFIT-CD           PIC XX.
  5779             20  CF-ST-BENEFIT-KIND         PIC X.
  5780                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5781                 88  CF-ST-AH-KIND              VALUE 'A'.
  5782             20  CF-ST-REM-TERM-CALC        PIC X.
  5783                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5784                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5785                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5786                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5787                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5788                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5789                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5790                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5791
  5792             20  CF-ST-REFUND-CALC          PIC X.
  5793                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5794                 88  ST-REFD-BY-R78             VALUE '1'.
  5795                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5796                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5797                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5798                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5799                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5800                 88  ST-REFD-UTAH               VALUE '7'.
  5801                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5802                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5803                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5804
  5805             20  CF-ST-EARNING-CALC         PIC X.
  5806                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5807                 88  ST-EARN-BY-R78             VALUE '1'.
  5808                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5809                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 108
* EL050.cbl
  5810                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5811                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5812                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5813                 88  ST-EARN-MEAN               VALUE '8'.
  5814                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5815
  5816             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5817                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5818                 88  ST-OVRD-BY-R78             VALUE '1'.
  5819                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5820                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5821                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5822                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5823                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5824                 88  ST-OVRD-MEAN               VALUE '8'.
  5825                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5826             20  cf-st-extra-periods        pic 9.
  5827*            20  FILLER                     PIC X.
  5828
  5829         16  CF-ST-COMMISSION-CAPS.
  5830             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5831             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5832             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5833             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5834         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5835                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5836                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5837                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5838
  5839         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5840
  5841         16  CF-ST-STATUTORY-INTEREST.
  5842             20  CF-ST-STAT-DATE-FROM       PIC X.
  5843                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5844                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5845             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5846             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5847             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5848             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5849             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5850
  5851         16  CF-ST-OVER-SHORT.
  5852             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5853             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5854
  5855         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5856
  5857         16  CF-ST-RT-CALC                  PIC X.
  5858
  5859         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5860         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5861         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5862         16  CF-ST-RF-LR-CALC               PIC X.
  5863         16  CF-ST-RF-LL-CALC               PIC X.
  5864         16  CF-ST-RF-LN-CALC               PIC X.
  5865         16  CF-ST-RF-AH-CALC               PIC X.
  5866         16  CF-ST-RF-CP-CALC               PIC X.
  5867*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 109
* EL050.cbl
  5868*CIDMOD         16  FILLER                         PIC X(192).
  5869         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5870             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5871         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5872         16  CF-ST-VFY-2ND-BENE             PIC X.
  5873         16  CF-ST-CAUSAL-STATE             PIC X.
  5874         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5875         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5876         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5877             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5878         16  CF-ST-NET-ONLY-STATE           PIC X.
  5879             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5880         16  cf-commission-cap-required     pic x.
  5881         16  CF-ST-GA-COMMISSION-CAPS.
  5882             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5883             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5884             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5885             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5886         16  CF-ST-TOT-COMMISSION-CAPS.
  5887             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5888             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5889             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5890             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5891         16  FILLER                         PIC X(156).
  5892
  5893****************************************************************
  5894*             BENEFIT MASTER RECORD                            *
  5895****************************************************************
  5896
  5897     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5898         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5899             20  CF-BENEFIT-CODE            PIC XX.
  5900             20  CF-BENEFIT-NUMERIC  REDEFINES
  5901                 CF-BENEFIT-CODE            PIC XX.
  5902             20  CF-BENEFIT-ALPHA           PIC XXX.
  5903             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5904             20  CF-BENEFIT-COMMENT         PIC X(10).
  5905
  5906             20  CF-LF-COVERAGE-TYPE        PIC X.
  5907                 88  CF-REDUCING                VALUE 'R'.
  5908                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5909
  5910             20  CF-SPECIAL-CALC-CD         PIC X.
  5911                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5912                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5913                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5914                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5915                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5916                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5917                 88  CF-FARM-PLAN               VALUE 'F'.
  5918                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5919                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5920                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5921                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5922                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5923                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5924                 88  CF-PRUDENTIAL              VALUE 'P'.
  5925                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 110
* EL050.cbl
  5926                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5927                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5928                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5929                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5930                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5931
  5932             20  CF-JOINT-INDICATOR         PIC X.
  5933                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5934
  5935*            20  FILLER                     PIC X(12).
  5936             20  cf-maximum-benefits        pic s999 comp-3.
  5937             20  FILLER                     PIC X(09).
  5938             20  CF-BENEFIT-CATEGORY        PIC X.
  5939             20  CF-LOAN-TYPE               PIC X(8).
  5940
  5941             20  CF-CO-REM-TERM-CALC        PIC X.
  5942                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5943                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5944                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5945                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5946                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5947
  5948             20  CF-CO-EARNINGS-CALC        PIC X.
  5949                 88  CO-EARN-BY-R78             VALUE '1'.
  5950                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5951                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5952                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5953                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5954                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5955                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5956                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5957
  5958             20  CF-CO-REFUND-CALC          PIC X.
  5959                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5960                 88  CO-REFD-BY-R78             VALUE '1'.
  5961                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5962                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5963                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5964                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5965                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5966                 88  CO-REFD-MEAN               VALUE '8'.
  5967                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5968                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5969                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5970
  5971             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5972                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5973                 88  CO-OVRD-BY-R78             VALUE '1'.
  5974                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5975                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5976                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5977                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5978                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5979                 88  CO-OVRD-MEAN               VALUE '8'.
  5980                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5981
  5982             20  CF-CO-BEN-I-G-CD           PIC X.
  5983                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 111
* EL050.cbl
  5984                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5985                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5986
  5987         16  FILLER                         PIC X(304).
  5988
  5989
  5990****************************************************************
  5991*             CARRIER MASTER RECORD                            *
  5992****************************************************************
  5993
  5994     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5995         16  CF-ADDRESS-DATA.
  5996             20  CF-MAIL-TO-NAME            PIC X(30).
  5997             20  CF-IN-CARE-OF              PIC X(30).
  5998             20  CF-ADDRESS-LINE-1          PIC X(30).
  5999             20  CF-ADDRESS-LINE-2          PIC X(30).
  6000             20  CF-CITY-STATE              PIC X(30).
  6001             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6002             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6003
  6004         16  CF-CLAIM-NO-CONTROL.
  6005             20  CF-CLAIM-NO-METHOD         PIC X.
  6006                 88  CLAIM-NO-MANUAL            VALUE '1'.
  6007                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6008                 88  CLAIM-NO-SEQ               VALUE '3'.
  6009                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6010             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6011                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6012                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6013                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6014
  6015         16  CF-CHECK-NO-CONTROL.
  6016             20  CF-CHECK-NO-METHOD         PIC X.
  6017                 88  CHECK-NO-MANUAL            VALUE '1'.
  6018                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6019                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6020                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6021             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6022                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6023
  6024         16  CF-DOMICILE-STATE              PIC XX.
  6025
  6026         16  CF-EXPENSE-CONTROLS.
  6027             20  CF-EXPENSE-METHOD          PIC X.
  6028                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6029                 88  DOLLARS-PER-PMT            VALUE '2'.
  6030                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6031                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6032             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6033             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6034
  6035         16  CF-CORRESPONDENCE-CONTROL.
  6036             20  CF-LETTER-RESEND-OPT       PIC X.
  6037                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6038                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6039             20  FILLER                     PIC X(4).
  6040
  6041         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 112
* EL050.cbl
  6042             20  CF-MANUAL-SW               PIC X.
  6043                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6044             20  CF-FUTURE-SW               PIC X.
  6045                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6046             20  CF-PTC-SW                  PIC X.
  6047                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6048             20  CF-IBNR-SW                 PIC X.
  6049                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6050             20  CF-PTC-LF-SW               PIC X.
  6051                 88  CF-LF-PTC-USED             VALUE '1'.
  6052             20  CF-CDT-ACCESS-METHOD       PIC X.
  6053                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6054                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6055                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6056             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6057
  6058         16  CF-CLAIM-CALC-METHOD           PIC X.
  6059             88  360-PLUS-MONTHS                VALUE '1'.
  6060             88  365-PLUS-MONTHS                VALUE '2'.
  6061             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6062             88  360-DAILY                      VALUE '4'.
  6063             88  365-DAILY                      VALUE '5'.
  6064
  6065         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6066         16  FILLER                         PIC X(11).
  6067
  6068         16  CF-LIMIT-AMOUNTS.
  6069             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6070             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6071             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6072             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6073             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6074             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6075             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6076             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6077             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6078             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6079
  6080         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6081         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6082         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6083
  6084         16  CF-ZIP-CODE.
  6085             20  CF-ZIP-PRIME.
  6086                 24  CF-ZIP-1ST             PIC X.
  6087                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6088                 24  FILLER                 PIC X(4).
  6089             20  CF-ZIP-PLUS4               PIC X(4).
  6090         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6091             20  CF-CAN-POSTAL-1            PIC XXX.
  6092             20  CF-CAN-POSTAL-2            PIC XXX.
  6093             20  FILLER                     PIC XXX.
  6094
  6095         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6096         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6097         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6098
  6099         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 113
* EL050.cbl
  6100             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6101             88  CF-NO-RATING                   VALUE 'N'.
  6102
  6103         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6104
  6105         16  CF-CARRIER-OVER-SHORT.
  6106             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6107             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6108
  6109         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6110         16  CF-SECPAY-SWITCH               PIC X.
  6111             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6112             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6113         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6114         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6115         16  FILLER                         PIC X(444).
  6116*        16  FILLER                         PIC X(452).
  6117
  6118
  6119****************************************************************
  6120*             MORTALITY MASTER RECORD                          *
  6121****************************************************************
  6122
  6123     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6124         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6125                                INDEXED BY CF-MORT-NDX.
  6126             20  CF-MORT-TABLE              PIC X(5).
  6127             20  CF-MORT-TABLE-TYPE         PIC X.
  6128                 88  CF-MORT-JOINT              VALUE 'J'.
  6129                 88  CF-MORT-SINGLE             VALUE 'S'.
  6130                 88  CF-MORT-COMBINED           VALUE 'C'.
  6131                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6132                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6133             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6134             20  CF-MORT-AGE-METHOD         PIC XX.
  6135                 88  CF-AGE-LAST                VALUE 'AL'.
  6136                 88  CF-AGE-NEAR                VALUE 'AN'.
  6137             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6138             20  CF-MORT-ADJUSTMENT-DIRECTION
  6139                                            PIC X.
  6140                 88  CF-MINUS                   VALUE '-'.
  6141                 88  CF-PLUS                    VALUE '+'.
  6142             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6143             20  CF-MORT-JOINT-CODE         PIC X.
  6144                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6145             20  CF-MORT-PC-Q               PIC X.
  6146                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6147             20  CF-MORT-TABLE-CODE         PIC X(4).
  6148             20  CF-MORT-COMMENTS           PIC X(15).
  6149             20  FILLER                     PIC X(14).
  6150
  6151         16  FILLER                         PIC X(251).
  6152
  6153
  6154****************************************************************
  6155*             BUSSINESS TYPE MASTER RECORD                     *
  6156****************************************************************
  6157
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 114
* EL050.cbl
  6158     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6159* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6160* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6161* AND RECORD 05 IS TYPES 81-99
  6162         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6163             20  CF-BUSINESS-TITLE          PIC  X(19).
  6164             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6165                                            PIC S9V9(4) COMP-3.
  6166             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6167             20  FILLER                     PIC  X.
  6168         16  FILLER                         PIC  X(248).
  6169
  6170
  6171****************************************************************
  6172*             TERMINAL MASTER RECORD                           *
  6173****************************************************************
  6174
  6175     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6176
  6177         16  CF-COMPANY-TERMINALS.
  6178             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6179                                  PIC X(4).
  6180         16  FILLER               PIC X(248).
  6181
  6182
  6183****************************************************************
  6184*             LIFE EDIT MASTER RECORD                          *
  6185****************************************************************
  6186
  6187     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6188         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6189             20  CF-LIFE-CODE-IN            PIC XX.
  6190             20  CF-LIFE-CODE-OUT           PIC XX.
  6191         16  FILLER                         PIC X(248).
  6192
  6193
  6194****************************************************************
  6195*             AH EDIT MASTER RECORD                            *
  6196****************************************************************
  6197
  6198     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6199         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6200             20  CF-AH-CODE-IN              PIC XXX.
  6201             20  CF-AH-CODE-OUT             PIC XX.
  6202         16  FILLER                         PIC X(248).
  6203
  6204
  6205****************************************************************
  6206*             CREDIBILITY TABLES                               *
  6207****************************************************************
  6208
  6209     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6210         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6211                             INDEXED BY CF-CRDB-NDX.
  6212             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6213             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6214             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6215         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 115
* EL050.cbl
  6216
  6217
  6218****************************************************************
  6219*             REPORT CUSTOMIZATION RECORD                      *
  6220****************************************************************
  6221
  6222     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6223         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6224             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6225             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6226             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6227**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6228****       A T-TRANSFER.                                   ****
  6229             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6230
  6231         16  FILLER                         PIC XX.
  6232
  6233         16  CF-CARRIER-CNTL-OPT.
  6234             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6235                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6236                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6237             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6238                                            PIC X.
  6239         16  CF-GROUP-CNTL-OPT.
  6240             20  CF-GROUP-OPT-SEQ           PIC 9.
  6241                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6242                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6243             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6244                                            PIC X(6).
  6245         16  CF-STATE-CNTL-OPT.
  6246             20  CF-STATE-OPT-SEQ           PIC 9.
  6247                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6248                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6249             20  CF-STATE-SELECT OCCURS 3 TIMES
  6250                                            PIC XX.
  6251         16  CF-ACCOUNT-CNTL-OPT.
  6252             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6253                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6254                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6255             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6256                                            PIC X(10).
  6257         16  CF-BUS-TYP-CNTL-OPT.
  6258             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6259                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6260                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6261             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6262                                            PIC XX.
  6263         16  CF-LF-TYP-CNTL-OPT.
  6264             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6265                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6266                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6267             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6268                                            PIC XX.
  6269         16  CF-AH-TYP-CNTL-OPT.
  6270             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6271                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6272                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6273             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 116
* EL050.cbl
  6274                                            PIC XX.
  6275         16  CF-REPTCD1-CNTL-OPT.
  6276             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6277                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6278                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6279             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6280                                            PIC X(10).
  6281         16  CF-REPTCD2-CNTL-OPT.
  6282             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6283                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6284                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6285             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6286                                            PIC X(10).
  6287         16  CF-USER1-CNTL-OPT.
  6288             20  CF-USER1-OPT-SEQ           PIC 9.
  6289                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6290                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6291             20  CF-USER1-SELECT OCCURS 3 TIMES
  6292                                            PIC X(10).
  6293         16  CF-USER2-CNTL-OPT.
  6294             20  CF-USER2-OPT-SEQ           PIC 9.
  6295                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6296                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6297             20  CF-USER2-SELECT OCCURS 3 TIMES
  6298                                            PIC X(10).
  6299         16  CF-USER3-CNTL-OPT.
  6300             20  CF-USER3-OPT-SEQ           PIC 9.
  6301                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6302                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6303             20  CF-USER3-SELECT OCCURS 3 TIMES
  6304                                            PIC X(10).
  6305         16  CF-USER4-CNTL-OPT.
  6306             20  CF-USER4-OPT-SEQ           PIC 9.
  6307                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6308                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6309             20  CF-USER4-SELECT OCCURS 3 TIMES
  6310                                            PIC X(10).
  6311         16  CF-USER5-CNTL-OPT.
  6312             20  CF-USER5-OPT-SEQ           PIC 9.
  6313                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6314                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6315             20  CF-USER5-SELECT OCCURS 3 TIMES
  6316                                            PIC X(10).
  6317         16  CF-REINS-CNTL-OPT.
  6318             20  CF-REINS-OPT-SEQ           PIC 9.
  6319                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6320                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6321             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6322                 24  CF-REINS-PRIME         PIC XXX.
  6323                 24  CF-REINS-SUB           PIC XXX.
  6324
  6325         16  CF-AGENT-CNTL-OPT.
  6326             20  CF-AGENT-OPT-SEQ           PIC 9.
  6327                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6328                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6329             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6330                                            PIC X(10).
  6331
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 117
* EL050.cbl
  6332         16  FILLER                         PIC X(43).
  6333
  6334         16  CF-LOSS-RATIO-SELECT.
  6335             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6336             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6337         16  CF-ENTRY-DATE-SELECT.
  6338             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6339             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6340         16  CF-EFFECTIVE-DATE-SELECT.
  6341             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6342             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6343
  6344         16  CF-EXCEPTION-LIST-IND          PIC X.
  6345             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6346
  6347         16  FILLER                         PIC X(318).
  6348
  6349****************************************************************
  6350*                  EXCEPTION REPORTING RECORD                  *
  6351****************************************************************
  6352
  6353     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6354         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6355             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6356
  6357         16  CF-COMBINED-LIFE-AH-OPT.
  6358             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6359             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6360             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6361             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6362
  6363         16  CF-LIFE-OPT.
  6364             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6365             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6366             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6367             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6368             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6369             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6370             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6371             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6372             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6373             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6374
  6375         16  CF-AH-OPT.
  6376             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6377             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6378             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6379             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6380             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6381             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6382             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6383             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6384             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6385             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6386
  6387         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6388             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6389             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 118
* EL050.cbl
  6390             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6391
  6392         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6393
  6394         16  FILLER                         PIC X(673).
  6395
  6396
  6397****************************************************************
  6398*             MORTGAGE SYSTEM PLAN RECORD                      *
  6399****************************************************************
  6400
  6401     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6402         16  CF-PLAN-TYPE                   PIC X.
  6403             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6404             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6405             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6406         16  CF-PLAN-ABBREV                 PIC XXX.
  6407         16  CF-PLAN-DESCRIPT               PIC X(10).
  6408         16  CF-PLAN-NOTES                  PIC X(20).
  6409         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6410         16  CF-PLAN-UNDERWRITING.
  6411             20  CF-PLAN-TERM-DATA.
  6412                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6413                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6414             20  CF-PLAN-AGE-DATA.
  6415                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6416                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6417                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6418             20  CF-PLAN-BENEFIT-DATA.
  6419                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6420                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6421                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6422                                            PIC S9(7)V99  COMP-3.
  6423         16  CF-PLAN-POLICY-FORMS.
  6424             20  CF-POLICY-FORM             PIC X(12).
  6425             20  CF-MASTER-APPLICATION      PIC X(12).
  6426             20  CF-MASTER-POLICY           PIC X(12).
  6427         16  CF-PLAN-RATING.
  6428             20  CF-RATE-CODE               PIC X(5).
  6429             20  CF-SEX-RATING              PIC X.
  6430                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6431                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6432             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6433             20  CF-SUB-STD-TYPE            PIC X.
  6434                 88  CF-PCT-OF-PREM            VALUE '1'.
  6435                 88  CF-PCT-OF-BENE            VALUE '2'.
  6436         16  CF-PLAN-PREM-TOLERANCES.
  6437             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6438             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6439         16  CF-PLAN-PYMT-TOLERANCES.
  6440             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6441             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6442         16  CF-PLAN-MISC-DATA.
  6443             20  FILLER                     PIC X.
  6444             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6445             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6446         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6447         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 119
* EL050.cbl
  6448             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6449                                                     '1'.
  6450             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6451                                                     '2'.
  6452         16  CF-MIB-SEARCH-SW               PIC X.
  6453             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6454             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6455             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6456             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6457         16  CF-ALPHA-SEARCH-SW             PIC X.
  6458             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6459             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6460             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6461             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6462             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6463             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6464             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6465             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6466             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6467             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6468                                                     'A' 'B' 'C'
  6469                                                     'X' 'Y' 'Z'.
  6470         16  CF-EFF-DT-RULE-SW              PIC X.
  6471             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6472             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6473             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6474             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6475             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6476         16  FILLER                         PIC X(4).
  6477         16  CF-HEALTH-QUESTIONS            PIC X.
  6478             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6479         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6480         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6481         16  CF-PLAN-SNGL-JNT               PIC X.
  6482             88  CF-COMBINED-PLAN              VALUE 'C'.
  6483             88  CF-JNT-PLAN                   VALUE 'J'.
  6484             88  CF-SNGL-PLAN                  VALUE 'S'.
  6485         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6486         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6487         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6488         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6489         16  CF-RERATE-CNTL                 PIC  X.
  6490             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6491             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6492             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6493             88  CF-AUTO-RECALC                 VALUE '4'.
  6494         16  CF-BENEFIT-TYPE                PIC  X.
  6495             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6496             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6497         16  CF-POLICY-FEE                  PIC S999V99
  6498                                                    COMP-3.
  6499         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6500         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6501         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6502         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6503         16  FILLER                         PIC  X(32).
  6504         16  CF-TERMINATION-FORM            PIC  X(04).
  6505         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 120
* EL050.cbl
  6506         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6507                                                       COMP-3.
  6508         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6509         16  CF-ISSUE-LETTER                PIC  X(4).
  6510         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6511         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6512             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6513             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6514         16  CF-MP-REFUND-CALC              PIC X.
  6515             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6516             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6517             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6518             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6519             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6520             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6521             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6522             88  CF-MP-REFD-MEAN                VALUE '8'.
  6523         16  CF-ALT-RATE-CODE               PIC  X(5).
  6524
  6525
  6526         16  FILLER                         PIC X(498).
  6527****************************************************************
  6528*             MORTGAGE COMPANY MASTER RECORD                   *
  6529****************************************************************
  6530
  6531     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6532         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6533         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6534             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6535             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6536             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6537             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6538             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6539
  6540         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6541         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6542         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6543         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6544         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6545
  6546         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6547             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6548         16  CF-MP-RECON-USE-IND            PIC X(1).
  6549             88  CF-MP-USE-RECON             VALUE 'Y'.
  6550         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6551             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6552         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6553             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6554             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6555         16  FILLER                         PIC X(1).
  6556         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6557             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6558         16  CF-MORTG-MIB-VERSION           PIC X.
  6559             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6560             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6561             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6562         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6563             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 121
* EL050.cbl
  6564                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6565             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6566                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6567             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6568                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6569             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6570                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6571             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6572                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6573             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6574                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6575         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6576         16  FILLER                         PIC X(7).
  6577         16  CF-MORTG-DESTINATION-SYMBOL.
  6578             20  CF-MORTG-MIB-COMM          PIC X(5).
  6579             20  CF-MORTG-MIB-TERM          PIC X(5).
  6580         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6581             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6582         16  FILLER                         PIC X(03).
  6583         16  CF-MP-CHECK-NO-CONTROL.
  6584             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6585                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6586                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6587                                                ' ' LOW-VALUES.
  6588                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6589                                               VALUE '3'.
  6590         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6591         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6592         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6593             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6594                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6595             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6596                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6597             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6598                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6599             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6600                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6601             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6602                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6603             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6604                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6605         16  CF-MORTG-BILLING-AREA.
  6606             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6607                                            PIC X.
  6608         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6609         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6610         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6611         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6612             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6613             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6614         16  FILLER                         PIC X.
  6615         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6616             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6617             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6618         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6619         16  FILLER                         PIC X(8).
  6620         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6621         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 122
* EL050.cbl
  6622         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6623         16  CF-ACH-COMPANY-ID.
  6624             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6625                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6626                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6627                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6628             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6629         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6630             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6631         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6632             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6633             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6634         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6635         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6636         16  FILLER                         PIC X(536).
  6637
  6638****************************************************************
  6639*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6640****************************************************************
  6641
  6642     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6643         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6644             20  CF-FEMALE-HEIGHT.
  6645                 24  CF-FEMALE-FT           PIC 99.
  6646                 24  CF-FEMALE-IN           PIC 99.
  6647             20  CF-FEMALE-MIN-WT           PIC 999.
  6648             20  CF-FEMALE-MAX-WT           PIC 999.
  6649         16  FILLER                         PIC X(428).
  6650
  6651     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6652         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6653             20  CF-MALE-HEIGHT.
  6654                 24  CF-MALE-FT             PIC 99.
  6655                 24  CF-MALE-IN             PIC 99.
  6656             20  CF-MALE-MIN-WT             PIC 999.
  6657             20  CF-MALE-MAX-WT             PIC 999.
  6658         16  FILLER                         PIC X(428).
  6659******************************************************************
  6660*             AUTOMATIC ACTIVITY RECORD                          *
  6661******************************************************************
  6662     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6663         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6664             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6665             20  CF-SYS-LETTER-ID           PIC X(04).
  6666             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6667             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6668             20  CF-SYS-RESET-SW            PIC X(01).
  6669             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6670             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6671
  6672         16  FILLER                         PIC X(50).
  6673
  6674         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6675             20  CF-USER-ACTIVE-SW          PIC X(01).
  6676             20  CF-USER-LETTER-ID          PIC X(04).
  6677             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6678             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6679             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 123
* EL050.cbl
  6680             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6681             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6682             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6683
  6684         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 124
* EL050.cbl
  6686*    COPY ERCACCT.
  6687******************************************************************
  6688*                                                                *
  6689*                                                                *
  6690*                            ERCACCT                             *
  6691*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6692*                            VMOD=2.031                          *
  6693*                                                                *
  6694*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6695*                                                                *
  6696*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6697*   VSAM ACCOUNT MASTER FILES.                                   *
  6698*                                                                *
  6699*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6700*                                                                *
  6701*   FILE TYPE = VSAM,KSDS                                        *
  6702*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6703*                                                                *
  6704*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6705*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6706*                                                                *
  6707*   LOG = NO                                                     *
  6708*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6709*                                                                *
  6710*                                                                *
  6711******************************************************************
  6712*                   C H A N G E   L O G
  6713*
  6714* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6715*-----------------------------------------------------------------
  6716*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6717* EFFECTIVE    NUMBER
  6718*-----------------------------------------------------------------
  6719* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6720* 092705    2005050300006  PEMA  ADD SPP LEASES
  6721* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6722* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6723* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6724* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6725* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6726* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6727******************************************************************
  6728
  6729 01  ACCOUNT-MASTER.
  6730     12  AM-RECORD-ID                      PIC XX.
  6731         88  VALID-AM-ID                      VALUE 'AM'.
  6732
  6733     12  AM-CONTROL-PRIMARY.
  6734         16  AM-COMPANY-CD                 PIC X.
  6735         16  AM-MSTR-CNTRL.
  6736             20  AM-CONTROL-A.
  6737                 24  AM-CARRIER            PIC X.
  6738                 24  AM-GROUPING.
  6739                     28 AM-GROUPING-PREFIX PIC XXX.
  6740                     28 AM-GROUPING-PRIME  PIC XXX.
  6741                 24  AM-STATE              PIC XX.
  6742                 24  AM-ACCOUNT.
  6743                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 125
* EL050.cbl
  6744                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6745             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6746                                           PIC X(19).
  6747             20  AM-CNTRL-B.
  6748                 24  AM-EXPIRATION-DT      PIC XX.
  6749                 24  FILLER                PIC X(4).
  6750             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6751                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6752
  6753     12  AM-CONTROL-BY-VAR-GRP.
  6754         16  AM-COMPANY-CD-A1              PIC X.
  6755         16  AM-VG-CARRIER                 PIC X.
  6756         16  AM-VG-GROUPING                PIC X(6).
  6757         16  AM-VG-STATE                   PIC XX.
  6758         16  AM-VG-ACCOUNT                 PIC X(10).
  6759         16  AM-VG-DATE.
  6760             20  AM-VG-EXPIRATION-DT       PIC XX.
  6761             20  FILLER                    PIC X(4).
  6762         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6763                                           PIC 9(11)      COMP-3.
  6764     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6765         16  FILLER                        PIC X(10).
  6766         16  AM-VG-KEY3.
  6767             20  AM-VG3-ACCOUNT            PIC X(10).
  6768             20  AM-VG3-EXP-DT             PIC XX.
  6769         16  FILLER                        PIC X(4).
  6770     12  AM-MAINT-INFORMATION.
  6771         16  AM-LAST-MAINT-DT              PIC XX.
  6772         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6773         16  AM-LAST-MAINT-USER            PIC X(4).
  6774         16  FILLER                        PIC XX.
  6775
  6776     12  AM-EFFECTIVE-DT                   PIC XX.
  6777     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6778
  6779     12  AM-PREV-DATES  COMP-3.
  6780         16  AM-PREV-EXP-DT                PIC 9(11).
  6781         16  AM-PREV-EFF-DT                PIC 9(11).
  6782
  6783     12  AM-REPORT-CODE-1                  PIC X(10).
  6784     12  AM-REPORT-CODE-2                  PIC X(10).
  6785
  6786     12  AM-CITY-CODE                      PIC X(4).
  6787     12  AM-COUNTY-PARISH                  PIC X(6).
  6788
  6789     12  AM-NAME                           PIC X(30).
  6790     12  AM-PERSON                         PIC X(30).
  6791     12  AM-ADDRS                          PIC X(30).
  6792     12  AM-CITY.
  6793         16  AM-ADDR-CITY                  PIC X(28).
  6794         16  AM-ADDR-STATE                 PIC XX.
  6795     12  AM-ZIP.
  6796         16  AM-ZIP-PRIME.
  6797             20  AM-ZIP-PRI-1ST            PIC X.
  6798                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6799             20  FILLER                    PIC X(4).
  6800         16  AM-ZIP-PLUS4                  PIC X(4).
  6801     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 126
* EL050.cbl
  6802         16  AM-CAN-POSTAL-1               PIC XXX.
  6803         16  AM-CAN-POSTAL-2               PIC XXX.
  6804         16  FILLER                        PIC XXX.
  6805     12  AM-TEL-NO.
  6806         16  AM-AREA-CODE                  PIC 999.
  6807         16  AM-TEL-PRE                    PIC 999.
  6808         16  AM-TEL-NBR                    PIC 9(4).
  6809     12  AM-TEL-LOC                        PIC X.
  6810         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6811         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6812
  6813     12  AM-COMM-STRUCTURE.
  6814         16  AM-DEFN-1.
  6815             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6816                 24  AM-AGT.
  6817                     28  AM-AGT-PREFIX     PIC X(4).
  6818                     28  AM-AGT-PRIME      PIC X(6).
  6819                 24  AM-COM-TYP            PIC X.
  6820                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6821                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6822                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6823                 24  AM-RECALC-LV-INDIC    PIC X.
  6824                 24  AM-RETRO-LV-INDIC     PIC X.
  6825                 24  AM-GL-CODES           PIC X.
  6826                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6827                 24  FILLER                PIC X(01).
  6828         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6829             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6830                 24  FILLER                PIC X(11).
  6831                 24  AM-L-COMA             PIC XXX.
  6832                 24  AM-J-COMA             PIC XXX.
  6833                 24  AM-A-COMA             PIC XXX.
  6834                 24  FILLER                PIC X(6).
  6835
  6836     12  AM-COMM-CHANGE-STATUS             PIC X.
  6837         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6838
  6839     12  AM-CSR-CODE                       PIC X(4).
  6840
  6841     12  AM-BILLING-STATUS                 PIC X.
  6842         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6843         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6844     12  AM-AUTO-REFUND-SW                 PIC X.
  6845         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6846         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6847     12  AM-GPCD                           PIC 99.
  6848     12  AM-IG                             PIC X.
  6849         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6850         88  AM-HAS-GROUP                     VALUE '2'.
  6851     12  AM-STATUS                         PIC X.
  6852         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6853         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6854         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6855         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6856         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6857         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6858         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6859         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 127
* EL050.cbl
  6860         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6861         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6862     12  AM-REMIT-TO                       PIC 99.
  6863     12  AM-ID-NO                          PIC X(11).
  6864
  6865     12  AM-CAL-TABLE                      PIC XX.
  6866     12  AM-LF-DEVIATION                   PIC XXX.
  6867     12  AM-AH-DEVIATION                   PIC XXX.
  6868     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6869     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6870     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6871     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6872     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6873     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6874
  6875     12  AM-USER-FIELDS.
  6876         16  AM-FLD-1                      PIC XX.
  6877         16  AM-FLD-2                      PIC XX.
  6878         16  AM-FLD-3                      PIC XX.
  6879         16  AM-FLD-4                      PIC XX.
  6880         16  AM-FLD-5                      PIC XX.
  6881
  6882     12  AM-1ST-PROD-DATE.
  6883         16  AM-1ST-PROD-YR                PIC XX.
  6884         16  AM-1ST-PROD-MO                PIC XX.
  6885         16  AM-1ST-PROD-DA                PIC XX.
  6886     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6887     12  AM-CERTS-PURGED-DATE.
  6888         16  AM-PUR-YR                     PIC XX.
  6889         16  AM-PUR-MO                     PIC XX.
  6890         16  AM-PUR-DA                     PIC XX.
  6891     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6892     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6893     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6894     12  AM-INACTIVE-DATE.
  6895         16  AM-INA-MO                     PIC 99.
  6896         16  AM-INA-DA                     PIC 99.
  6897         16  AM-INA-YR                     PIC 99.
  6898     12  AM-AR-HI-CERT-DATE                PIC XX.
  6899
  6900     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6901     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6902
  6903     12  AM-OB-PAYMENT-MODE                PIC X.
  6904         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6905         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6906         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6907         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6908
  6909     12  AM-AH-ONLY-INDICATOR              PIC X.
  6910         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6911         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6912
  6913     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6914
  6915     12  AM-OVER-SHORT.
  6916         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6917         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 128
* EL050.cbl
  6918
  6919     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6920     12  AM-DCC-CLP-STATE                  PIC XX.
  6921
  6922     12  AM-RECALC-COMM                    PIC X.
  6923     12  AM-RECALC-REIN                    PIC X.
  6924
  6925     12  AM-REI-TABLE                      PIC XXX.
  6926     12  AM-REI-ET-LF                      PIC X.
  6927     12  AM-REI-ET-AH                      PIC X.
  6928     12  AM-REI-PE-LF                      PIC X.
  6929     12  AM-REI-PE-AH                      PIC X.
  6930     12  AM-REI-PRT-ST                     PIC X.
  6931     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6932     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6933     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6934     12  AM-REI-GROUP-A                    PIC X(6).
  6935     12  AM-REI-MORT                       PIC X(4).
  6936     12  AM-REI-PRT-OW                     PIC X.
  6937     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6938     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6939     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6940     12  AM-REI-GROUP-B                    PIC X(6).
  6941
  6942     12  AM-TRUST-TYPE                     PIC X(2).
  6943
  6944     12  AM-EMPLOYER-STMT-USED             PIC X.
  6945     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6946
  6947     12  AM-STD-AH-TYPE                    PIC XX.
  6948     12  AM-EARN-METHODS.
  6949         16  AM-EARN-METHOD-R              PIC X.
  6950             88 AM-REF-RL-R78                 VALUE 'R'.
  6951             88 AM-REF-RL-PR                  VALUE 'P'.
  6952             88 AM-REF-RL-MEAN                VALUE 'M'.
  6953             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6954         16  AM-EARN-METHOD-L              PIC X.
  6955             88 AM-REF-LL-R78                 VALUE 'R'.
  6956             88 AM-REF-LL-PR                  VALUE 'P'.
  6957             88 AM-REF-LL-MEAN                VALUE 'M'.
  6958             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6959         16  AM-EARN-METHOD-A              PIC X.
  6960             88 AM-REF-AH-R78                 VALUE 'R'.
  6961             88 AM-REF-AH-PR                  VALUE 'P'.
  6962             88 AM-REF-AH-MEAN                VALUE 'M'.
  6963             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6964             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6965             88 AM-REF-AH-NET                 VALUE 'N'.
  6966
  6967     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6968     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6969     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6970
  6971     12  AM-RET-Y-N                        PIC X.
  6972     12  AM-RET-P-E                        PIC X.
  6973     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6974     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6975     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 129
* EL050.cbl
  6976     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6977         16  AM-POOL-PRIME                 PIC XXX.
  6978         16  AM-POOL-SUB                   PIC XXX.
  6979     12  AM-RETRO-EARNINGS.
  6980         16  AM-RET-EARN-R                 PIC X.
  6981         16  AM-RET-EARN-L                 PIC X.
  6982         16  AM-RET-EARN-A                 PIC X.
  6983     12  AM-RET-ST-TAX-USE                 PIC X.
  6984         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6985         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6986     12  AM-RETRO-BEG-EARNINGS.
  6987         16  AM-RET-BEG-EARN-R             PIC X.
  6988         16  AM-RET-BEG-EARN-L             PIC X.
  6989         16  AM-RET-BEG-EARN-A             PIC X.
  6990     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6991     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6992
  6993     12  AM-USER-SELECT-OPTIONS.
  6994         16  AM-USER-SELECT-1              PIC X(10).
  6995         16  AM-USER-SELECT-2              PIC X(10).
  6996         16  AM-USER-SELECT-3              PIC X(10).
  6997         16  AM-USER-SELECT-4              PIC X(10).
  6998         16  AM-USER-SELECT-5              PIC X(10).
  6999
  7000     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7001
  7002     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7003
  7004     12  AM-RPT045A-SWITCH                 PIC X.
  7005         88  RPT045A-OFF                   VALUE 'N'.
  7006
  7007     12  AM-INSURANCE-LIMITS.
  7008         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  7009         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  7010
  7011     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  7012         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  7013
  7014     12  AM-DISMBR-COVERAGE-SW             PIC X.
  7015         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  7016         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  7017
  7018     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  7019
  7020     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  7021     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  7022     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  7023     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  7024     12  AM-DCC-UEF-STATE                  PIC XX.
  7025     12  FILLER                            PIC XXX.
  7026     12  AM-REPORT-CODE-3                  PIC X(10).
  7027*    12  FILLER                            PIC X(22).
  7028
  7029     12  AM-RESERVE-DATE.
  7030         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  7031         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  7032         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  7033
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 130
* EL050.cbl
  7034     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  7035     12  AM-NOTIFICATION-TYPES.
  7036         16  AM-NOTIF-OF-LETTERS           PIC X.
  7037         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  7038         16  AM-NOTIF-OF-REPORTS           PIC X.
  7039         16  AM-NOTIF-OF-STATUS            PIC X.
  7040
  7041     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  7042         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  7043         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  7044         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  7045         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  7046
  7047     12  AM-BENEFIT-CONTROLS.
  7048         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  7049             20  AM-BENEFIT-CODE           PIC XX.
  7050             20  AM-BENEFIT-TYPE           PIC X.
  7051             20  AM-BENEFIT-REVISION       PIC XXX.
  7052             20  AM-BENEFIT-REM-TERM       PIC X.
  7053             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  7054             20  FILLER                    PIC XX.
  7055         16  FILLER                        PIC X(80).
  7056
  7057     12  AM-TRANSFER-DATA.
  7058         16  AM-TRANSFERRED-FROM.
  7059             20  AM-TRNFROM-CARRIER        PIC X.
  7060             20  AM-TRNFROM-GROUPING.
  7061                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7062                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7063             20  AM-TRNFROM-STATE          PIC XX.
  7064             20  AM-TRNFROM-ACCOUNT.
  7065                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7066                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7067             20  AM-TRNFROM-DTE            PIC XX.
  7068         16  AM-TRANSFERRED-TO.
  7069             20  AM-TRNTO-CARRIER          PIC X.
  7070             20  AM-TRNTO-GROUPING.
  7071                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7072                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7073             20  AM-TRNTO-STATE            PIC XX.
  7074             20  AM-TRNTO-ACCOUNT.
  7075                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7076                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7077             20  AM-TRNTO-DTE              PIC XX.
  7078         16  FILLER                        PIC X(10).
  7079
  7080     12  AM-SAVED-REMIT-TO                 PIC 99.
  7081
  7082     12  AM-COMM-STRUCTURE-SAVED.
  7083         16  AM-DEFN-1-SAVED.
  7084             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7085                 24  AM-AGT-SV             PIC X(10).
  7086                 24  AM-COM-TYP-SV         PIC X.
  7087                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7088                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7089                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7090                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7091                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 131
* EL050.cbl
  7092                 24  AM-GL-CODES-SV        PIC X.
  7093                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7094                 24  FILLER                PIC X.
  7095         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7096             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7097                 24  FILLER                PIC X(11).
  7098                 24  AM-L-COMA-SV          PIC XXX.
  7099                 24  AM-J-COMA-SV          PIC XXX.
  7100                 24  AM-A-COMA-SV          PIC XXX.
  7101                 24  FILLER                PIC X(6).
  7102
  7103     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7104         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7105            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7106            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7107            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7108
  7109     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7110     12  FILLER                            PIC X(120).
  7111
  7112     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7113         16  AM-CONTROL-NAME               PIC X(30).
  7114         16  AM-EXECUTIVE-ONE.
  7115             20  AM-EXEC1-NAME             PIC X(15).
  7116             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7117                                                          COMP-3.
  7118             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7119                                                          COMP-3.
  7120         16  AM-EXECUTIVE-TWO.
  7121             20  AM-EXEC2-NAME             PIC X(15).
  7122             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7123                                                          COMP-3.
  7124             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7125                                                          COMP-3.
  7126
  7127     12  AM-RETRO-ADDITIONAL-DATA.
  7128         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7129         16  AM-RETRO-PREM-P-E             PIC X.
  7130         16  AM-RETRO-CLMS-P-I             PIC X.
  7131         16  AM-RETRO-RET-BRACKET-LF.
  7132             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7133                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7134                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7135             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7136                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7137                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7138             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7139                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7140                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7141         16  AM-RETRO-RET-BRACKET-AH.
  7142             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7143                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7144                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7145                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7146             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7147                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7148                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7149             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 132
* EL050.cbl
  7150                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7151                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7152
  7153     12  AM-COMMENTS.
  7154         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7155
  7156     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7157         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7158         16  AM-FLI-BILLING-CODE           PIC X.
  7159         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7160         16  AM-FLI-UNITED-IDENT           PIC X.
  7161         16  AM-FLI-INTEREST-LOST-DATA.
  7162             20  AM-FLI-BANK-NO            PIC X(5).
  7163             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7164             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7165             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7166         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7167             20  AM-FLI-AGT                PIC X(9).
  7168             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7169             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7170         16  FILLER                        PIC X(102).
  7171
  7172     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7173         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7174             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7175             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7176             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7177             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7178             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7179         16  FILLER                          PIC X(10).
  7180******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 133
* EL050.cbl
  7182*    COPY ERCREIN.
  7183******************************************************************
  7184*                                                                *
  7185*                            ERCREIN                             *
  7186*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7187*                            VMOD=2.010                          *
  7188*                                                                *
  7189*   ONLINE CREDIT SYSTEM                                         *
  7190*                                                                *
  7191*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7192*                                                                *
  7193*   FILE TYPE = VSAM,KSDS                                        *
  7194*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7195*                                                                *
  7196*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7197*       ALTERNATE PATH = NONE                                    *
  7198*                                                                *
  7199*   LOG = NO                                                     *
  7200*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7201*                                                                *
  7202******************************************************************
  7203*                   C H A N G E   L O G
  7204*
  7205* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7206*-----------------------------------------------------------------
  7207*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7208* EFFECTIVE    NUMBER
  7209*-----------------------------------------------------------------
  7210* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7211* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7212******************************************************************
  7213 01  REINSURANCE-RECORD.
  7214     12  RE-RECORD-ID                      PIC XX.
  7215         88  VALID-RE-ID                      VALUE 'RE'.
  7216
  7217     12  RE-CONTROL-PRIMARY.
  7218         16  RE-COMPANY-CD                 PIC X.
  7219         16  RE-KEY.
  7220             20  RE-CODE                   PIC X.
  7221                 88  RE-TABLE-RECORD          VALUE 'A'.
  7222                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7223             20  RE-TABLE                  PIC XXX.
  7224             20  FILLER                    PIC XXX.
  7225         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7226             20  FILLER                    PIC X.
  7227             20  RE-COMPANY.
  7228                 24  RE-COMP-PRIME         PIC XXX.
  7229                 24  RE-COMP-SUB           PIC XXX.
  7230
  7231     12  RE-MAINT-INFORMATION.
  7232         16  RE-LAST-MAINT-DT              PIC XX.
  7233         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7234         16  RE-LAST-MAINT-USER            PIC X(4).
  7235         16  FILLER                        PIC X(10).
  7236
  7237     12  RE-TABLE-DATA.
  7238         16  RE-100-COMP                   PIC 99.
  7239
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 134
* EL050.cbl
  7240         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7241             20  RE-REI-COMP-NO.
  7242                 24  RE-REI-COMP           PIC XXX.
  7243                 24  RE-REI-COMP-SUB       PIC XXX.
  7244             20  RE-LF-QC                  PIC X.
  7245             20  RE-AH-QC                  PIC X.
  7246             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7247             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7248             20  RE-LFAGE-LO               PIC 99.
  7249             20  RE-LFAGE-HI               PIC 99.
  7250             20  RE-AHAGE-LO               PIC 99.
  7251             20  RE-AHAGE-HI               PIC 99.
  7252             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7253             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7254             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7255             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7256             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7257             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7258             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7259             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7260             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7261             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7262             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7263             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7264             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7265             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7266             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7267             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7268             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7269             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7270             20  RE-LF-BEN-CODE            PIC X.
  7271             20  RE-AH-BEN-CODE            PIC X.
  7272             20  RE-INTERACTIVE            PIC X.
  7273             20  RE-REMAINING              PIC X.
  7274             20  RE-LF-RUNOFF-SW           PIC X.
  7275             20  RE-AH-RUNOFF-SW           PIC X.
  7276             20  FILLER                    PIC X(19).
  7277
  7278         16  RE-COMP-INFO-END              PIC X(6).
  7279         16  RE-NSP-ST-CD-LF               PIC XX.
  7280         16  RE-NSP-ST-CD-AH               PIC XX.
  7281         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7282             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7283
  7284         16  FILLER                        PIC X(27).
  7285
  7286     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7287         16  RE-NAME                       PIC X(30).
  7288         16  RE-LF-PE                      PIC X.
  7289         16  RE-AH-PE                      PIC X.
  7290         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7291         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7292         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7293         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7294         16  RE-PRT-ST                     PIC X.
  7295         16  RE-PRT-OW                     PIC X.
  7296         16  RE-MORT-CODE                  PIC X(4).
  7297         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 135
* EL050.cbl
  7298         16  RE-ZERO-LF-FEE                PIC X.
  7299         16  RE-ZERO-AH-FEE                PIC X.
  7300         16  RE-CEDE-NAME                  PIC X(30).
  7301         16  RE-LF-COMM                    PIC X.
  7302         16  RE-AH-COMM                    PIC X.
  7303         16  RE-LF-TAX                     PIC X.
  7304         16  RE-AH-TAX                     PIC X.
  7305         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7306         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7307         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7308
  7309         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7310             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7311
  7312         16  RE-LF-CEDING-FEE-BRACKETS.
  7313             20  RE-LF-FEE-METHOD          PIC X.
  7314                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7315                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7316                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7317                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7318             20  RE-LF-FEE-BASIS           PIC X.
  7319                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7320                 88  RE-LF-NET-CEDED               VALUE '2'.
  7321                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7322                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7323                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7324                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7325                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7326                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7327             20  FILLER                    PIC XXX.
  7328             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7329                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7330                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7331
  7332         16  RE-AH-CEDING-FEE-BRACKETS.
  7333             20  RE-AH-FEE-METHOD          PIC X.
  7334                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7335                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7336                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7337                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7338             20  RE-AH-FEE-BASIS           PIC X.
  7339                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7340                 88  RE-AH-NET-CEDED               VALUE '2'.
  7341                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7342                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7343                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7344                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7345                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7346                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7347             20  FILLER                    PIC XXX.
  7348             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7349                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7350                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7351
  7352         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7353
  7354         16  RE-OLD-CEDING-STMT            PIC X.
  7355
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 136
* EL050.cbl
  7356         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7357         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7358         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7359         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7360         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7361         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7362         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7363         16  RE-MORT-SW                    PIC X.
  7364         16  RE-CEDING-TYPE-FLAG           PIC X.
  7365             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7366             88  RE-CEDED                          VALUE 'C'.
  7367             88  RE-ASSUMED                        VALUE 'A'.
  7368             88  RE-PHANTOM                        VALUE 'P'.
  7369
  7370         16  RE-CEDING-STMT-OPT-A          PIC X.
  7371             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7372         16  RE-CEDING-STMT-OPT-B          PIC X.
  7373             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7374         16  RE-CEDING-STMT-OPT-C          PIC X.
  7375             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7376         16  RE-CEDING-STMT-OPT-D          PIC X.
  7377             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7378         16  RE-CEDING-STMT-OPT-E          PIC X.
  7379             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7380
  7381         16  RE-PRT-CRSV                   PIC X.
  7382
  7383         16  RE-GL-CENTER                  PIC X(4).
  7384
  7385         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7386
  7387         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7388
  7389         16  RE-EARN-STOP-CODE             PIC X.
  7390             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7391             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7392
  7393         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7394             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7395
  7396         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7397         16  FILLER                        PIC X(2281).
  7398
  7399         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7400
  7401******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 137
* EL050.cbl
  7403*    COPY ERCCTBL.
  7404******************************************************************
  7405*                                                                *
  7406*                                                                *
  7407*                            ERCCTBL                             *
  7408*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7409*                            VMOD=2.003
  7410*                                                                *
  7411*   ONLINE CREDIT SYSTEM                                         *
  7412*                                                                *
  7413*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7414*                                                                *
  7415*   FILE TYPE = VSAM,KSDS                                        *
  7416*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7417*                                                                *
  7418*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7419*       ALTERNATE PATH = NONE                                    *
  7420*                                                                *
  7421*   LOG = NO                                                     *
  7422*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7423*                                                                *
  7424*                                                                *
  7425******************************************************************
  7426
  7427 01  COMM-TABLE-RECORD.
  7428     12  CT-RECORD-ID                      PIC XX.
  7429         88  VALID-CT-ID                      VALUE 'CT'.
  7430
  7431     12  CT-CONTROL-PRIMARY.
  7432         16  CT-COMPANY-CD                 PIC X.
  7433         16  CT-TABLE                      PIC XXX.
  7434         16  CT-CNTRL-2.
  7435             20  CT-BEN-TYPE               PIC X.
  7436             20  CT-BEN-CODE               PIC XX.
  7437
  7438     12  CT-MAINT-INFORMATION.
  7439         16  CT-LAST-MAINT-DT              PIC XX.
  7440         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7441         16  CT-LAST-MAINT-USER            PIC X(4).
  7442         16  FILLER                        PIC X(31).
  7443
  7444     12  CT-LIMITS.
  7445         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7446
  7447         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7448
  7449         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7450
  7451     12  CT-RATES.
  7452         16  CT-RTX          OCCURS 27 TIMES.
  7453             20  CT-RT                     PIC SV9(5)     COMP-3.
  7454             20  CT-RT-R   REDEFINES
  7455                 CT-RT                     PIC XXX.
  7456
  7457     12  FILLER                            PIC  X(42).
  7458
  7459******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 138
* EL050.cbl
  7461*    COPY ERCFORM.
  7462******************************************************************
  7463*                                                                *
  7464*                                                                *
  7465*                            ERCFORM.                            *
  7466*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7467*                            VMOD=2.003                          *
  7468*                                                                *
  7469*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7470*                                                                *
  7471*    FILE TYPE = VSAM,KSDS                                       *
  7472*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7473*                                                                *
  7474*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7475*                                                                *
  7476*    LOG = YES                                                   *
  7477*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7478******************************************************************
  7479 01  FORM-MASTER.
  7480    12  FO-RECORD-ID                 PIC X(02).
  7481        88  VALID-FO-ID                  VALUE 'FO'.
  7482
  7483    12  FO-CONTROL-PRIMARY.
  7484        16  FO-COMPANY-CD            PIC X(01).
  7485        16  FO-STATE                 PIC X(02).
  7486        16  FO-FORM-ID               PIC X(12).
  7487        16  FO-FORM-EXP-DT           PIC X(02).
  7488
  7489    12  FO-POLICY-FORM-DATA.
  7490        16  FO-IND-GRP-CD            PIC X(01).
  7491        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7492        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7493        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7494        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7495        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7496        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7497        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7498        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7499        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7500        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7501        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7502        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7503        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7504        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7505        16  FO-APP-CERT-USE-CD       PIC X(01).
  7506
  7507    12  FILLER                       PIC X(29).
  7508
  7509    12  FO-FORM-PLAN-TABLE.
  7510        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7511            20  FO-PLAN-TYPE         PIC X(01).
  7512            20  FO-PLAN-ID           PIC X(02).
  7513            20  FO-PLAN-TERM         PIC 9(03).
  7514            20  FO-PLAN-REFUND-METHOD
  7515                                     PIC X.
  7516
  7517    12  FILLER                       PIC X(30).
  7518
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 139
* EL050.cbl
  7519    12  FO-COMMENTS-AREA.
  7520        16  FO-COMMENT-LINE-1        PIC X(78).
  7521
  7522    12  FILLER                       PIC X(20).
  7523
  7524    12  FO-MAINT-INFORMATION.
  7525        16  FO-LAST-MAINT-DT         PIC X(02).
  7526        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7527        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 140
* EL050.cbl
  7529*    COPY ELCMSTR.
  7530******************************************************************
  7531*                                                                *
  7532*                            ELCMSTR.                            *
  7533*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7534*                            VMOD=2.012                          *
  7535*                                                                *
  7536*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7537*                                                                *
  7538*   FILE TYPE = VSAM,KSDS                                        *
  7539*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7540*                                                                *
  7541*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7542*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7543*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7544*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7545*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7546*                                                 RKP=75,LEN=21  *
  7547*                                                                *
  7548*   **** NOTE ****                                               *
  7549*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7550*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7551*                                                                *
  7552*   LOG = YES                                                    *
  7553*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7554******************************************************************
  7555*                   C H A N G E   L O G
  7556*
  7557* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7558*-----------------------------------------------------------------
  7559*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7560* EFFECTIVE    NUMBER
  7561*-----------------------------------------------------------------
  7562* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7563* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7564* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7565* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7566* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7567* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7568* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7569******************************************************************
  7570 01  CLAIM-MASTER.
  7571     12  CL-RECORD-ID                PIC XX.
  7572         88  VALID-CL-ID         VALUE 'CL'.
  7573
  7574     12  CL-CONTROL-PRIMARY.
  7575         16  CL-COMPANY-CD           PIC X.
  7576         16  CL-CARRIER              PIC X.
  7577         16  CL-CLAIM-NO             PIC X(7).
  7578         16  CL-CERT-NO.
  7579             20  CL-CERT-PRIME       PIC X(10).
  7580             20  CL-CERT-SFX         PIC X.
  7581
  7582     12  CL-CONTROL-BY-NAME.
  7583         16  CL-COMPANY-CD-A1        PIC X.
  7584         16  CL-INSURED-LAST-NAME    PIC X(15).
  7585         16  CL-INSURED-NAME.
  7586             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 141
* EL050.cbl
  7587             20  CL-INSURED-MID-INIT PIC X.
  7588
  7589     12  CL-CONTROL-BY-SSN.
  7590         16  CL-COMPANY-CD-A2        PIC X.
  7591         16  CL-SOC-SEC-NO.
  7592             20  CL-SSN-STATE        PIC XX.
  7593             20  CL-SSN-ACCOUNT      PIC X(6).
  7594             20  CL-SSN-LN3          PIC X(3).
  7595
  7596     12  CL-CONTROL-BY-CERT-NO.
  7597         16  CL-COMPANY-CD-A4        PIC X.
  7598         16  CL-CERT-NO-A4.
  7599             20  CL-CERT-A4-PRIME    PIC X(10).
  7600             20  CL-CERT-A4-SFX      PIC X.
  7601
  7602     12  CL-CONTROL-BY-CCN.
  7603         16  CL-COMPANY-CD-A5        PIC X.
  7604         16  CL-CCN-A5.
  7605             20  CL-CCN.
  7606                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7607                 24  CL-CCN-PRIME-A5 PIC X(12).
  7608             20  CL-CCN-FILLER-A5    PIC X(4).
  7609
  7610     12  CL-INSURED-PROFILE-DATA.
  7611         16  CL-INSURED-BIRTH-DT     PIC XX.
  7612         16  CL-INSURED-SEX-CD       PIC X.
  7613             88  INSURED-IS-MALE        VALUE 'M'.
  7614             88  INSURED-IS-FEMALE      VALUE 'F'.
  7615             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7616         16  CL-INSURED-OCC-CD       PIC X(6).
  7617         16  FILLER                  PIC X(5).
  7618
  7619     12  CL-PROCESSING-INFO.
  7620         16  CL-PROCESSOR-ID         PIC X(4).
  7621         16  CL-CLAIM-STATUS         PIC X.
  7622             88  CLAIM-IS-OPEN          VALUE 'O'.
  7623             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7624         16  CL-CLAIM-TYPE           PIC X.
  7625*            88  AH-CLAIM               VALUE 'A'.
  7626*            88  LIFE-CLAIM             VALUE 'L'.
  7627*            88  PROPERTY-CLAIM         VALUE 'P'.
  7628*            88  IUI-CLAIM              VALUE 'I'.
  7629*            88  GAP-CLAIM              VALUE 'G'.
  7630*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7631*            88  OTHER-CLAIM            VALUE 'O'.
  7632         16  CL-CLAIM-PREM-TYPE      PIC X.
  7633             88  SINGLE-PREMIUM         VALUE '1'.
  7634             88  O-B-COVERAGE           VALUE '2'.
  7635             88  OPEN-END-COVERAGE      VALUE '3'.
  7636         16  CL-INCURRED-DT          PIC XX.
  7637         16  CL-REPORTED-DT          PIC XX.
  7638         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7639         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7640         16  CL-LAST-PMT-DT          PIC XX.
  7641         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7642         16  CL-PAID-THRU-DT         PIC XX.
  7643         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7644         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 142
* EL050.cbl
  7645         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7646         16  CL-PMT-CALC-METHOD      PIC X.
  7647             88  CL-360-DAY-YR          VALUE '1'.
  7648             88  CL-365-DAY-YR          VALUE '2'.
  7649             88  CL-FULL-MONTHS         VALUE '3'.
  7650         16  CL-CAUSE-CD             PIC X(6).
  7651
  7652         16  CL-PRIME-CERT-NO.
  7653             20  CL-PRIME-CERT-PRIME PIC X(10).
  7654             20  CL-PRIME-CERT-SFX   PIC X.
  7655
  7656         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7657             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7658             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7659
  7660         16  CL-MICROFILM-NO         PIC X(10).
  7661         16  FILLER REDEFINES CL-MICROFILM-NO.
  7662             20  CL-BENEFIT-PERIOD   PIC 99.
  7663             20  FILLER              PIC X(8).
  7664         16  CL-PROG-FORM-TYPE       PIC X.
  7665         16  CL-LAST-ADD-ON-DT       PIC XX.
  7666
  7667         16  CL-LAST-REOPEN-DT       PIC XX.
  7668         16  CL-LAST-CLOSE-DT        PIC XX.
  7669         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7670             88  FINAL-PAID             VALUE '1'.
  7671             88  CLAIM-DENIED           VALUE '2'.
  7672             88  AUTO-CLOSE             VALUE '3'.
  7673             88  MANUAL-CLOSE           VALUE '4'.
  7674             88  BENEFITS-CHANGED       VALUE 'C'.
  7675             88  SETUP-ERRORS           VALUE 'E'.
  7676         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7677         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7678         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7679             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7680         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7681         16  FILLER                  PIC X.
  7682
  7683     12  CL-CERTIFICATE-DATA.
  7684         16  CL-CERT-ORIGIN          PIC X.
  7685             88  CERT-WAS-ONLINE        VALUE '1'.
  7686             88  CERT-WAS-CREATED       VALUE '2'.
  7687             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7688         16  CL-CERT-KEY-DATA.
  7689             20  CL-CERT-CARRIER     PIC X.
  7690             20  CL-CERT-GROUPING    PIC X(6).
  7691             20  CL-CERT-STATE       PIC XX.
  7692             20  CL-CERT-ACCOUNT.
  7693                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7694                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7695             20  CL-CERT-EFF-DT      PIC XX.
  7696
  7697     12  CL-STATUS-CONTROLS.
  7698         16  CL-PRIORITY-CD          PIC X.
  7699             88  CONFIDENTIAL-DATA      VALUE '8'.
  7700             88  HIGHEST-PRIORITY       VALUE '9'.
  7701         16  CL-SUPV-ATTN-CD         PIC X.
  7702             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 143
* EL050.cbl
  7703             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7704         16  CL-PURGED-DT            PIC XX.
  7705         16  CL-RESTORED-DT          PIC XX.
  7706         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7707         16  CL-NEXT-RESEND-DT       PIC XX.
  7708         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7709         16  CL-CRITICAL-PERIOD      PIC 99.
  7710*        16  FILLER                  PIC XX.
  7711         16  CL-LAST-MAINT-DT        PIC XX.
  7712         16  CL-LAST-MAINT-USER      PIC X(4).
  7713         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7714         16  CL-LAST-MAINT-TYPE      PIC X.
  7715             88  CLAIM-SET-UP           VALUE ' '.
  7716             88  PAYMENT-MADE           VALUE '1'.
  7717             88  LETTER-SENT            VALUE '2'.
  7718             88  MASTER-WAS-ALTERED     VALUE '3'.
  7719             88  MASTER-WAS-RESTORED    VALUE '4'.
  7720             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7721             88  FILE-CONVERTED         VALUE '6'.
  7722             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7723             88  ERROR-CORRECTION       VALUE 'E'.
  7724         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7725         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7726         16  CL-BENEFICIARY          PIC X(10).
  7727         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7728         16  CL-DENIAL-TYPE          PIC X.
  7729             88  CL-TYPE-DENIAL          VALUE '1'.
  7730             88  CL-TYPE-RESCISSION      VALUE '2'.
  7731             88  CL-TYPE-REFORMATION     VALUE '3'.
  7732             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7733             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7734         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7735         16  filler                  pic x(3).
  7736*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7737*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7738*        16  CL-RTW-DT               PIC XX.
  7739
  7740     12  CL-TRAILER-CONTROLS.
  7741         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7742             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7743             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7744             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7745         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7746         16  FILLER                  PIC XX.
  7747         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7748         16  CL-ADDRESS-TRAILER-CNT.
  7749             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7750                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7751             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7752                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7753             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7754                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7755             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7756                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7757             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7758                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7759             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7760                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 144
* EL050.cbl
  7761             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7762                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7763
  7764     12  CL-CV-REFERENCE-NO.
  7765         16  CL-CV-REFNO-PRIME       PIC X(18).
  7766         16  CL-CV-REFNO-SFX         PIC XX.
  7767
  7768     12  CL-FILE-LOCATION            PIC X(4).
  7769
  7770     12  CL-PROCESS-ERRORS.
  7771         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7772             88  NO-FATAL-ERRORS        VALUE ZERO.
  7773         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7774             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7775
  7776     12  CL-PRODUCT-CD               PIC X.
  7777
  7778     12  CL-CURRENT-KEY-DATA.
  7779         16  CL-CURRENT-CARRIER      PIC X.
  7780         16  CL-CURRENT-GROUPING     PIC X(6).
  7781         16  CL-CURRENT-STATE        PIC XX.
  7782         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7783
  7784     12  CL-ASSOCIATES               PIC X.
  7785         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7786         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7787         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7788         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7789
  7790     12  CL-ACTIVITY-CODE            PIC 99.
  7791     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7792     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7793
  7794     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7795     12  CL-LAG-REPORT-CODE          PIC 9.
  7796     12  CL-LOAN-TYPE                PIC XX.
  7797     12  CL-LEGAL-STATE              PIC XX.
  7798
  7799     12  CL-YESNOSW                  PIC X.
  7800     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7801         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7802         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7803         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7804     12  cl-insured-type             pic x.
  7805         88  cl-claim-on-primary         value 'P'.
  7806         88  cl-claim-on-co-borrower     value 'C'.
  7807     12  cl-benefit-expiration-dt    PIC XX.
  7808
  7809 01  PLAN-RECORDS.
  7810     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7811     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7812
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 145
* EL050.cbl
  7814 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7815                          ACCOUNT-MASTER REINSURANCE-RECORD
  7816                          COMM-TABLE-RECORD FORM-MASTER
  7817                          CLAIM-MASTER PLAN-RECORDS.
  7818 0000-DFHEXIT SECTION.
  7819     MOVE '9#                    $   ' TO DFHEIV0.
  7820     MOVE 'EL050' TO DFHEIV1.
  7821     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7822
  7823     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7824
  7825
  7826* EXEC CICS  HANDLE CONDITION
  7827*           ERROR    (9300-ABEND)
  7828*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7829*    END-EXEC.
  7830*    MOVE '"$.J                  ! " #00007821' TO DFHEIV0
  7831     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7832     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7833     MOVE X'2220233030303037383231' TO DFHEIV0(25:11)
  7834     CALL 'kxdfhei1' USING DFHEIV0
  7835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7836
  7837
  7838 0000-COPY-PROCEDURE-DIV.
  7839*                          COPY ELC50PD.
  7840******************************************************************
  7841*                                                                *
  7842*                            ELC50PD                             *
  7843*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7844*                            VMOD=2.188                          *
  7845*                                                                *
  7846******************************************************************
  7847*                   C H A N G E   L O G
  7848*
  7849* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7850*-----------------------------------------------------------------
  7851*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7852* EFFECTIVE    NUMBER
  7853*-----------------------------------------------------------------
  7854* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7855* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7856* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7857*                             2709 AND 2718
  7858* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7859* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7860* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7861* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7862* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7863*                                IS OPEN OR CNC DT < PD THRU
  7864* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7865* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7866* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7867* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7868* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7869* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7870* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7871* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 146
* EL050.cbl
  7872* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7873* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7874* 020906                   PEMA  EXPAND LOAN OFFICER
  7875* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7876* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7877* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7878* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7879* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7880* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7881* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7882* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7883* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7884* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7885* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7886* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7887* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7888* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7889* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7890* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7891* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7892* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7893* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7894* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7895* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7896* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7897* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7898* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7899* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7900*                                UPDATE VIN ON CERT TRAILER
  7901* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7902* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7903* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7904* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7905* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7906* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7907* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7908* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7909* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7910* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7911* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7912* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7913* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7914* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7915* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7916* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7917* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7918* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7919* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7920* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7921* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7922* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7923* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7924* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7925* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7926* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7927* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7928* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7929* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 147
* EL050.cbl
  7930* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7931* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7932* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7933* 032912  CR2011110200001  PEMA  AHL CHANGES
  7934* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7935* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7936* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7937* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7938* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7939* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7940* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7941* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7942* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7943* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7944* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7945* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7946* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7947* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7948* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7949* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7950* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7951* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7952* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7953* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7954* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7955* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7956* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7957* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7958* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7959* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7960* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7961*                                CERT #, ADD 2898 FORCIBLE ERROR
  7962* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7963* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7964* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7965* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7966* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7967* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7968* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7969* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7970* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7971* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7972* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7973* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7974* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7975* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7976* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7977* 100617  CR2017062000003  PEMA  New comm cap edits
  7978* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7979* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7980* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7981* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7982* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7983* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
  7984* 070218  IR2018062700001  PEMA  Fix edit for spaces in certno
  7985* 092118  CR2018073000001  PEMA  Add lf & ah refund method to ELCR
  7986* 092618  CR2018050200001  PEMA  Add check for open clm on issue
  7987* 021519  CR2019021100001  PEMA  Non-monthly calcs for AL.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 148
* EL050.cbl
  7988******************************************************************
  7989************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7990******************************************************************
  7991
  7992     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7993
  7994     MOVE SPACES                 TO PB-FATAL-FLAG
  7995                                    PB-FORCE-ER-CD
  7996                                    PB-WARN-ER-CD
  7997                                    PB-OUT-BAL-CD.
  7998
  7999     MOVE SPACE                  TO WS-IG-OVRD-AH
  8000                                    WS-IG-OVRD-LF
  8001                                    WS-IG-OVRD-AM
  8002                                    WS-IG-OVRD
  8003                                    WS-IG-OVRD-AH-PL
  8004                                    WS-IG-OVRD-LF-PL
  8005                                    WS-IG-OVRD-AH-BEN
  8006                                    WS-IG-OVRD-LF-BEN.
  8007
  8008******************************************************************
  8009*************       INITIALIZE COMMON ERRORS       ***************
  8010******************************************************************
  8011
  8012     MOVE +0                     TO PB-NO-OF-ERRORS.
  8013     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  8014
  8015******************************************************************
  8016
  8017     MOVE EIBDATE                TO DC-JULIAN-DATE.
  8018     SET JULIAN-TO-BIN           TO TRUE.
  8019*    MOVE 5                      TO DC-OPTION-CODE.
  8020     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8021     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  8022
  8023     MOVE ZERO                   TO  SUB4.
  8024
  8025 0040-INITIALIZE-GA-BILL-DT.
  8026
  8027     ADD +1                      TO  SUB4.
  8028
  8029     IF  SUB4 GREATER THAN +5
  8030         GO TO 0050-CHECK-CNTL-FOUND.
  8031
  8032     IF  PB-GA-BILL-DT (SUB4) = SPACES
  8033         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  8034
  8035     GO TO 0040-INITIALIZE-GA-BILL-DT.
  8036
  8037 0050-CHECK-CNTL-FOUND.
  8038
  8039     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  8040        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  8041                                         WS-AH-REM-TERM-CALC
  8042                                         EC-CO-REM-TERM-CALC
  8043        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  8044        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  8045        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 149
* EL050.cbl
  8046                                         WS-TOL-AH-CLAIM
  8047        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  8048                                         WS-TOL-AH-PREM
  8049                                         EC-CO-TOL-PREM
  8050        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  8051                                         WS-TOL-AH-REFUND
  8052                                         EC-CO-TOL-REFUND
  8053        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  8054                                         WS-AH-REFUND-OVS-AMT
  8055                                         EC-CO-OVR-SHT-AMT
  8056        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  8057                                         WS-TOL-AH-PREM-PCT
  8058                                         EC-CO-TOL-PREM-PCT
  8059        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  8060                                         WS-TOL-AH-REFUND-PCT
  8061                                         EC-CO-TOL-REFUND-PCT
  8062        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  8063                                         WS-AH-REFUND-OVS-PCT
  8064                                         EC-CO-OVR-SHT-PCT
  8065        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  8066        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  8067        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8068        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8069        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8070        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8071        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8072        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8073        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8074        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8075        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8076        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8077                                         EC-CO-MONTH-END-DT
  8078        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8079          GO TO 0100-READ-ACCT.
  8080
  8081     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8082     MOVE SPACES                 TO CNTL-ACCESS.
  8083     MOVE '1'                    TO CNTL-REC-TYPE.
  8084     MOVE +0                     TO CNTL-SEQ-NO.
  8085
  8086     MOVE '1' TO RC-SW-1.
  8087     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8088     IF NOT CF-COMPANY-MASTER
  8089         MOVE ZEROS             TO WK-CO-TOL-PREM
  8090                                   WK-CO-TOL-CLAIM
  8091                                   WK-CO-TOL-REFUND
  8092                                   WK-REFUND-OVS-AMT
  8093                                   WK-REFUND-OVS-PCT
  8094                                   WK-CO-TOL-PREM-PCT
  8095                                   WK-CO-TOL-REFUND-PCT
  8096                                   WK-DEFAULT-APR
  8097                                   WK-CO-MAX-CAP
  8098        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8099                                   WK-CR-R78-METHOD
  8100                                   WK-CO-REF-REJECT-SW
  8101                                   WK-CO-PREM-REJECT-SW
  8102                                   WK-REM-TRM-CALC-OPTION
  8103                                   WK-BIRTH-DATE-INPUT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 150
* EL050.cbl
  8104                                   WK-JOINT-AGE-INPUT
  8105        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8106        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8107        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8108        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8109          GO TO 0099-COMPANY-NOT-FOUND.
  8110
  8111     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8112        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8113     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8114        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8115     IF CF-CO-TOL-CAP NOT NUMERIC
  8116        MOVE +0                    TO CF-CO-TOL-CAP.
  8117     IF CF-DEFAULT-APR NOT NUMERIC
  8118        MOVE +0                    TO CF-DEFAULT-APR.
  8119
  8120     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8121     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8122     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8123     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8124     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8125     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8126     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8127     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8128     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8129     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8130     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8131     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8132
  8133     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8134          CF-CO-OVR-SHT-AMT > +0
  8135        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8136
  8137     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8138          CF-CO-OVR-SHT-PCT > +0
  8139        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8140
  8141     IF CF-VALID-REM-TRM-OPTION
  8142         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8143     ELSE
  8144         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8145
  8146     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8147     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8148     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8149     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8150
  8151     GO TO 0050-CHECK-CNTL-FOUND.
  8152
  8153 0099-COMPANY-NOT-FOUND.
  8154
  8155     MOVE ER-2616                TO WS-ERROR.
  8156     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8157
  8158 0100-READ-ACCT.
  8159
  8160     MOVE SPACES                 TO DATE-RANGE-SW.
  8161
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 151
* EL050.cbl
  8162     IF WK-ACCT-ADDR = ZEROS
  8163        GO TO 0102-ACCT-GETMAIN.
  8164
  8165     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8166     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8167     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8168
  8169     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8170        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8171        GO TO 0105-READ-ACCT
  8172     END-IF
  8173
  8174     IF PB-CARRIER NOT = SPACES
  8175        IF PB-CARRIER NOT = AM-VG-CARRIER
  8176           GO TO 0105-READ-ACCT.
  8177
  8178     IF PB-STATE NOT = SPACES
  8179        IF PB-STATE NOT = AM-VG-STATE
  8180           GO TO 0105-READ-ACCT.
  8181
  8182     IF PB-GROUPING NOT = SPACES
  8183        IF PB-GROUPING NOT = AM-VG-GROUPING
  8184           GO TO 0105-READ-ACCT.
  8185
  8186     MOVE 'X'                 TO DATE-RANGE-SW.
  8187
  8188     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8189        MOVE 'X'                 TO DATE-RANGE-SW
  8190        GO TO 0105-READ-ACCT.
  8191
  8192     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8193        GO TO 0105-READ-ACCT.
  8194
  8195     GO TO 0180-ACCOUNT-FOUND.
  8196
  8197 0102-ACCT-GETMAIN.
  8198     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8199     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8200
  8201 0105-READ-ACCT.
  8202     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8203     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8204     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8205     MOVE PB-STATE               TO ACCT-STATE.
  8206     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8207     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8208
  8209     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8210
  8211     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8212
  8213 0110-FIND-ACCT-TOLERANCES-LOOP.
  8214     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8215
  8216     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8217        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8218        GO TO 0199-ACCT-NOT-FOUND
  8219     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 152
* EL050.cbl
  8220     IF PB-CARRIER NOT = SPACES
  8221        IF PB-CARRIER NOT = AM-VG-CARRIER
  8222           GO TO 0199-ACCT-NOT-FOUND.
  8223
  8224     IF PB-STATE NOT = SPACES
  8225        IF PB-STATE NOT = AM-VG-STATE
  8226           GO TO 0199-ACCT-NOT-FOUND.
  8227
  8228     IF PB-GROUPING NOT = SPACES
  8229        IF PB-GROUPING NOT = AM-VG-GROUPING
  8230           GO TO 0199-ACCT-NOT-FOUND.
  8231
  8232     MOVE 'X'                    TO DATE-RANGE-SW.
  8233
  8234     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8235        MOVE 'X'                 TO DATE-RANGE-SW
  8236        GO TO 0199-ACCT-NOT-FOUND.
  8237
  8238     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8239        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8240
  8241 0180-ACCOUNT-FOUND.
  8242     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8243     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8244     MOVE AM-STATE               TO PB-SV-STATE.
  8245     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8246
  8247     IF AM-CANCEL-FEE  NOT NUMERIC
  8248        MOVE ZEROS TO AM-CANCEL-FEE.
  8249
  8250     IF AM-MAX-MON-BEN NOT NUMERIC
  8251        MOVE ZEROS TO AM-MAX-MON-BEN.
  8252
  8253     IF AM-MAX-TOT-BEN NOT NUMERIC
  8254        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8255
  8256     IF AM-CLP-TOL-PCT NOT NUMERIC
  8257        MOVE +0                  TO AM-CLP-TOL-PCT
  8258     END-IF
  8259     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8260        MOVE +0                  TO AM-SPP-LEASE-COMM
  8261     END-IF
  8262     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8263        MOVE ER-2611             TO   WS-ERROR
  8264        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8265
  8266     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8267        MOVE ER-2621             TO   WS-ERROR
  8268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8269
  8270     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8271        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8272        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8273        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8274         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8275
  8276     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8277     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 153
* EL050.cbl
  8278     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8279     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8280     IF AM-CLP-TOL-PCT NOT = ZEROS
  8281        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8282     END-IF
  8283     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8284        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8285     END-IF
  8286*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8287*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8288*                                   WS-ADMIN-FEES
  8289*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8290*          (SUB5 > +10)
  8291*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8292*             AND (AM-A-COM (SUB5) NUMERIC)
  8293*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8294*                + (AM-A-COM (SUB5) * 1000)
  8295*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8296*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8297*                + (AM-A-COM (SUB5) * 1000)
  8298*             END-IF
  8299*             IF AM-COM-TYP (SUB5) = 'N'
  8300*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8301*                + (AM-A-COM (SUB5) * 1000)
  8302*             END-IF
  8303*          END-IF
  8304*       END-PERFORM
  8305*    END-IF
  8306     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8307        AND (PB-ISSUE)
  8308        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8309                                    ws-cred-union-fees
  8310        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8311           (SUB5 > +10)
  8312           MOVE +0 TO WS-WK-RATE
  8313           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8314                                   'O' OR 'S')
  8315              IF (AM-A-COM (SUB5) NUMERIC)
  8316                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8317                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8318              ELSE
  8319                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8320                 IF PB-ISSUE
  8321                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8322                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8323                 ELSE
  8324                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8325                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8326                 END-IF
  8327                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8328                 MOVE ZEROS             TO WS-SUB1
  8329                                           WS-COMMISSION
  8330                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8331                 MOVE '0530'               TO CTBL-SW
  8332                 MOVE ' '                  TO WS-CTBL-READ-SW
  8333                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8334                 IF FIRST-TIME-THROUGH
  8335                    MOVE 'AA'              TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 154
* EL050.cbl
  8336                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8337                 END-IF
  8338                 IF CTBL-TABLE-FOUND
  8339                    IF PB-ISSUE
  8340                       COMPUTE WS-COMM-CK-AMT =
  8341                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8342                    ELSE
  8343                       COMPUTE WS-COMM-CK-AMT =
  8344                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8345                    END-IF
  8346                    PERFORM 8800-GET-COMP-RATE
  8347                              THRU 8800-EXIT
  8348                 END-IF
  8349              END-IF
  8350              if am-com-typ (sub5) = 'O' or 'S'
  8351                 compute ws-cred-union-fees rounded =
  8352                    ws-cred-union-fees +
  8353                    (pb-i-ah-premium-amt * ws-wk-rate)
  8354              else
  8355                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8356                + (WS-WK-RATE * 1000)
  8357              end-if
  8358           END-IF
  8359        END-PERFORM
  8360     END-IF
  8361     IF PB-COMPANY-ID EQUAL 'CRI'
  8362         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8363
  8364     IF PB-COMPANY-ID EQUAL 'NCL'
  8365         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8366     END-IF
  8367
  8368     GO TO 0200-READ-CERT.
  8369
  8370 0199-ACCT-NOT-FOUND.
  8371
  8372     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8373
  8374     IF DATE-RANGE-SW NOT = SPACES
  8375        MOVE ER-2601             TO WS-ERROR
  8376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8377     ELSE
  8378        MOVE ER-2619             TO WS-ERROR
  8379        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8380
  8381     GO TO 9990-RETURN.
  8382
  8383 0200-READ-CERT.
  8384
  8385     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8386     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8387     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8388     MOVE PB-SV-STATE            TO CERT-STATE.
  8389     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8390     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8391     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8392
  8393     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 155
* EL050.cbl
  8394
  8395     IF CERT-WAS-NOT-FOUND
  8396        GO TO 0299-CERT-NOT-FOUND.
  8397
  8398     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8399        MOVE ER-2759             TO WS-ERROR
  8400        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8401        GO TO 0298-UNLOCK-RETURN.
  8402
  8403     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8404         MOVE ER-2758            TO WS-ERROR
  8405         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8406         GO TO 0298-UNLOCK-RETURN.
  8407
  8408     IF PB-ISSUE
  8409        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8410           IF CERT-WAS-CREATED-FOR-CLAIM
  8411              NEXT SENTENCE
  8412            ELSE
  8413              MOVE ER-2626       TO WS-ERROR
  8414              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8415              GO TO 0298-UNLOCK-RETURN.
  8416
  8417     IF NOT PB-CANCELLATION
  8418        GO TO 0300-CONTINUE-EDIT.
  8419
  8420     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8421     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8422     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8423     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8424     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8425     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8426
  8427     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8428     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8429     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8430     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8431     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8432     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8433     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8434     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8435     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8436
  8437     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8438     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8439     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8440     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8441     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8442     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8443     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8444
  8445     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8446     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8447
  8448     MOVE CM-CREDIT-INTERFACE-SW-1
  8449                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8450     MOVE CM-CREDIT-INTERFACE-SW-2
  8451                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 156
* EL050.cbl
  8452
  8453     IF CM-O-B-COVERAGE
  8454         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8455
  8456     IF CM-LIVES NOT NUMERIC
  8457         MOVE ZERO                TO CM-LIVES.
  8458
  8459     IF CM-BILLED NOT NUMERIC
  8460         MOVE ZERO                TO CM-BILLED.
  8461
  8462     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8463         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8464         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8465         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8466         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8467         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8468         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8469         MOVE CM-LIVES             TO PB-CI-LIVES
  8470*The next line causes a problem with my change  I dont think it is
  8471*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8472
  8473     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8474     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8475     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8476     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8477     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8478     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8479
  8480     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8481     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8482     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8483     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8484
  8485     IF CM-LIFE-COMM-PCT NUMERIC
  8486         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8487     ELSE
  8488         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8489
  8490     IF CM-AH-COMM-PCT NUMERIC
  8491         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8492     ELSE
  8493         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8494
  8495     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8496
  8497     IF CM-LOAN-APR       NOT NUMERIC
  8498           MOVE ZERO               TO CM-LOAN-APR.
  8499
  8500     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8501           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8502
  8503     IF CM-LOAN-TERM      NOT NUMERIC
  8504           MOVE ZERO               TO CM-LOAN-TERM.
  8505
  8506     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8507           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8508
  8509     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 157
* EL050.cbl
  8510           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8511
  8512     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8513     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8514     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8515     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8516     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8517     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8518     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8519     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8520     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8521     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8522     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8523     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8524     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8525
  8526     IF CM-STATE = CM-SSN-STATE
  8527         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8528
  8529     IF CM-STATE NOT = CM-MEMB-STATE
  8530         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8531
  8532     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8533
  8534     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8535*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8536        IF CM-ADDL-CLP NOT NUMERIC
  8537           MOVE +0               TO CM-ADDL-CLP
  8538        END-IF
  8539        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8540        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8541           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8542        END-IF
  8543     END-IF
  8544     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8545        MOVE +0                  TO WS-ADMIN-FEES
  8546                                    WS-CSO-ADMIN-FEE
  8547                                    WS-COMM-AND-MFEE
  8548                                    WS-1ST-YR-ALLOW
  8549        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8550           (SUB5 > +10)
  8551           MOVE +0 TO WS-WK-RATE
  8552           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8553              IF (AM-A-COM (SUB5) NUMERIC)
  8554                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8555                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8556              ELSE
  8557                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8558                 IF PB-ISSUE
  8559                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8560                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8561                 ELSE
  8562                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8563                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8564                 END-IF
  8565                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8566                 MOVE ZEROS             TO WS-SUB1
  8567                                           WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 158
* EL050.cbl
  8568                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8569                 MOVE '0530'               TO CTBL-SW
  8570                 MOVE ' '                  TO WS-CTBL-READ-SW
  8571                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8572                 IF FIRST-TIME-THROUGH
  8573                    MOVE 'AA'              TO CTBL-BEN-CODE
  8574                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8575                 END-IF
  8576                 IF CTBL-TABLE-FOUND
  8577                    IF PB-ISSUE
  8578                       COMPUTE WS-COMM-CK-AMT =
  8579                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8580                    ELSE
  8581                       COMPUTE WS-COMM-CK-AMT =
  8582                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8583                    END-IF
  8584                    PERFORM 8800-GET-COMP-RATE
  8585                              THRU 8800-EXIT
  8586                 END-IF
  8587              END-IF
  8588              IF AM-COM-TYP (SUB5) = 'I'
  8589                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8590                   + (WS-WK-RATE * 1000)
  8591              END-IF
  8592              IF AM-COM-TYP (SUB5) = 'N'
  8593                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8594                   + (WS-WK-RATE * 1000)
  8595              END-IF
  8596              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8597                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8598                   + (WS-WK-RATE * 1000)
  8599              END-IF
  8600              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8601                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8602                   + (WS-WK-RATE * 1000)
  8603              END-IF
  8604           END-IF
  8605        END-PERFORM
  8606     END-IF
  8607     GO TO 0300-CONTINUE-EDIT.
  8608
  8609 0298-UNLOCK-RETURN.
  8610      PERFORM 9250-UNLOCK-RETURN
  8611      GO TO 9990-RETURN.
  8612
  8613 0299-CERT-NOT-FOUND.
  8614
  8615     MOVE '1'                     TO CERT-STATUS-SW.
  8616
  8617     IF PB-COMPANY-ID = 'UCL'
  8618         IF WS-ERROR = ER-2799
  8619             GO TO 3000-CONTINUE-EDIT.
  8620
  8621     IF NOT PB-CANCELLATION
  8622         GO TO 0300-CONTINUE-EDIT.
  8623
  8624     MOVE ER-2726                  TO  WS-ERROR.
  8625     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 159
* EL050.cbl
  8626     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8627     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8628                                    PB-CI-LF-TERM
  8629                                    PB-C-LF-REM-TERM
  8630                                    PB-CI-AH-TERM
  8631                                    PB-C-AH-REM-TERM
  8632                                    PB-CI-LF-BENEFIT-CD
  8633                                    PB-CI-LF-BENEFIT-AMT
  8634                                    PB-CI-LF-ALT-BENEFIT-AMT
  8635                                    PB-CI-LF-PREMIUM-AMT
  8636                                    PB-CI-LF-ALT-PREMIUM-AMT
  8637                                    PB-CI-AH-BENEFIT-CD
  8638                                    PB-CI-AH-BENEFIT-AMT
  8639                                    PB-CI-AH-PREMIUM-AMT
  8640                                    PB-CI-PAY-FREQUENCY
  8641                                    PB-CI-LOAN-APR
  8642                                    PB-CI-LOAN-TERM
  8643                                    PB-CI-LIFE-COMMISSION
  8644                                    PB-CI-AH-COMMISSION
  8645                                    PB-CI-CURR-SEQ
  8646                                    PB-CI-AH-CANCEL-AMT
  8647                                    PB-CI-LF-CANCEL-AMT
  8648                                    PB-CI-RATE-DEV-PCT-LF
  8649                                    PB-CI-RATE-DEV-PCT-AH
  8650                                    PB-CI-EXTENTION-DAYS
  8651                                    PB-CI-TERM-IN-DAYS
  8652                                    PB-CI-LIVES
  8653                                    PB-CI-LF-CRIT-PER
  8654                                    PB-CI-AH-CRIT-PER
  8655                                    PB-CI-ADDL-CLP
  8656                                    PB-CI-DDF-IU-RATE-UP.
  8657
  8658     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8659                                    PB-CI-AH-SETTLEMENT-DT
  8660                                    PB-CI-DEATH-DT
  8661                                    PB-CI-LF-PRIOR-CANCEL-DT
  8662                                    PB-CI-AH-PRIOR-CANCEL-DT
  8663                                    PB-CI-ENTRY-DT
  8664                                    PB-CI-LF-EXPIRE-DT
  8665                                    PB-CI-AH-EXPIRE-DT
  8666                                    PB-CI-LOAN-1ST-PMT-DT.
  8667
  8668     IF ACCOUNT-MAST-FOUND
  8669        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8670        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8671
  8672
  8673 0300-CONTINUE-EDIT.
  8674
  8675     IF PB-ISSUE
  8676        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8677            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8678
  8679     IF PB-ISSUE
  8680        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8681            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8682
  8683     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 160
* EL050.cbl
  8684       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8685          (AM-NO-AH-ONLY)
  8686           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8687               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8688                   MOVE ER-2679 TO WS-ERROR
  8689                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8690
  8691     IF PB-ISSUE
  8692        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8693        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8694        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8695     ELSE
  8696        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8697        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8698        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8699
  8700     MOVE 'N'                    TO PLAN-MASTER-SW
  8701                                    PLAN-MASTER-LIFE-SW
  8702                                    FORM-MASTER-SW
  8703                                    WS-APP-CERT-SW.
  8704
  8705     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8706                                    WS-PL-TOL-LF-REFUND
  8707                                    WS-PL-REF-OVS-AMT
  8708                                    WS-PL-TOL-LF-PREM-PCT
  8709                                    WS-PL-TOL-LF-REFUND-PCT
  8710                                    WS-PL-REF-OVS-PCT
  8711                                    WS-PL-TOL-LF-CLAIM.
  8712
  8713     IF PB-COMPANY-ID = 'NCL'
  8714       IF PB-ISSUE
  8715         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8716             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8717             IF FORM-MASTER-FOUND
  8718                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8719
  8720     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8721        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8722
  8723********************** MON CODE **********************
  8724     IF PB-COMPANY-ID = 'MON'
  8725     IF PB-ISSUE
  8726     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8727        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8728             PB-I-LOAN-APR = ZERO)
  8729               MOVE 14.0         TO PB-I-LOAN-APR.
  8730******************************************************
  8731
  8732     IF PB-COMPANY-ID = 'NCL'
  8733       IF PB-ISSUE
  8734           IF FORM-MASTER-FOUND
  8735             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8736                AM-DISMBR-COVERAGE
  8737                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8738                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8739                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8740                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8741                                           PB-I-LIFE-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 161
* EL050.cbl
  8742
  8743     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8744
  8745     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8746         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8747         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8748         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8749         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8750         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8751           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8752             GO TO 0301-LIFE-BENEFIT-SEARCH
  8753         ELSE
  8754             NEXT SENTENCE
  8755     ELSE
  8756         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8757
  8758     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8759     MOVE '4'                    TO CNTL-REC-TYPE.
  8760     MOVE +0                     TO CNTL-SEQ-NO.
  8761     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8762
  8763     MOVE '1' TO RC-SW-2.
  8764     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8765
  8766     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8767        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8768         GO TO 0305-BENEFIT-NOT-FOUND.
  8769
  8770     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8771
  8772 0301-LIFE-BENEFIT-SEARCH.
  8773
  8774     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8775
  8776     IF NO-BENEFIT-FOUND
  8777        GO TO 0305-BENEFIT-NOT-FOUND.
  8778
  8779     IF WS-BEN-CD = '99'
  8780        GO TO 0305-BENEFIT-NOT-FOUND.
  8781
  8782     IF PB-COMPANY-ID = 'NCL'
  8783         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8784             GO TO 0304-LIFE-BENEFIT-FOUND.
  8785
  8786     MOVE +1                     TO SUB5.
  8787     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8788
  8789* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8790* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8791     IF PB-COMPANY-ID = 'DMD'
  8792         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8793
  8794 0302-EDIT-ACCT-LF-BENEFITS.
  8795
  8796     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8797        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8798           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8799                                 TO WS-SAVE-ALLOWABLE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 162
* EL050.cbl
  8800           GO TO 03XX-GET-LIFE-ERPLAN.
  8801
  8802     IF SUB5 LESS THAN +20
  8803        ADD +1                   TO SUB5
  8804        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8805
  8806     MOVE +1                     TO SUB5.
  8807
  8808     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8809        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8810
  8811 0303-EDIT-DMD-EXTRA-BENEFITS.
  8812
  8813     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8814        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8815           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8816                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8817           GO TO 03XX-GET-LIFE-ERPLAN.
  8818
  8819     IF SUB5 LESS THAN +30
  8820        ADD +1                   TO SUB5
  8821        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8822
  8823     MOVE +1                     TO SUB5.
  8824
  8825 03XX-EDIT-FOR-NINETY-LF.
  8826
  8827***************************************************************
  8828*                                                             *
  8829*    NINETY BENEFIT PLAN TYPES:                               *
  8830*                                                             *
  8831*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8832*      92 = ALL GROUP REDUCING BENEFITS                       *
  8833*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8834*      94 = ALL GROUP LEVEL BENEFITS                          *
  8835*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8836*           BENEFIT CONTROLS.                                 *
  8837*      99 = ALL BENEFITS                                      *
  8838*                                                             *
  8839***************************************************************
  8840
  8841     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8842                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8843
  8844     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8845       AND
  8846        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8847        GO TO 03XX-GET-LIFE-ERPLAN.
  8848
  8849     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8850       AND
  8851        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8852        IF CF-REDUCING (SUB3)
  8853           IF (PB-I-INDV-GRP-OVRD = 'I')
  8854              OR
  8855           ((AM-IG = '1') AND
  8856           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8857              OR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 163
* EL050.cbl
  8858           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8859           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8860           (AM-IG NOT = '2'))
  8861              GO TO 03XX-GET-LIFE-ERPLAN.
  8862
  8863     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8864       AND
  8865        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8866        IF CF-REDUCING (SUB3)
  8867           IF (PB-I-INDV-GRP-OVRD = 'G')
  8868              OR
  8869           ((AM-IG = '2') AND
  8870           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8871              OR
  8872           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8873           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8874           (AM-IG NOT = '1'))
  8875              GO TO 03XX-GET-LIFE-ERPLAN.
  8876
  8877     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8878       AND
  8879        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8880        IF CF-LEVEL    (SUB3)
  8881           IF (PB-I-INDV-GRP-OVRD = 'I')
  8882              OR
  8883           ((AM-IG = '1') AND
  8884           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8885              OR
  8886           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8887           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8888            (AM-IG NOT = '2'))
  8889              GO TO 03XX-GET-LIFE-ERPLAN.
  8890
  8891     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8892       AND
  8893        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8894        IF CF-LEVEL    (SUB3)
  8895           IF (PB-I-INDV-GRP-OVRD = 'G')
  8896              OR
  8897           ((AM-IG = '2') AND
  8898           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8899              OR
  8900           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8901           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8902           (AM-IG NOT = '1'))
  8903              GO TO 03XX-GET-LIFE-ERPLAN.
  8904
  8905     IF SUB5 LESS THAN +20
  8906        ADD +1                   TO SUB5
  8907        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8908
  8909     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8910
  8911     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8912        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8913
  8914     MOVE +1                     TO SUB5.
  8915
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 164
* EL050.cbl
  8916 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8917
  8918     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8919                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8920
  8921     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8922       AND
  8923        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8924        GO TO 03XX-GET-LIFE-ERPLAN.
  8925
  8926     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8927       AND
  8928        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8929        IF CF-REDUCING (SUB3)
  8930           IF (PB-I-INDV-GRP-OVRD = 'I')
  8931              OR
  8932           ((AM-IG = '1') AND
  8933           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8934              OR
  8935           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8936           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8937           (AM-IG NOT = '2'))
  8938              GO TO 03XX-GET-LIFE-ERPLAN.
  8939
  8940     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8941       AND
  8942        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8943        IF CF-REDUCING (SUB3)
  8944           IF (PB-I-INDV-GRP-OVRD = 'G')
  8945              OR
  8946           ((AM-IG = '2') AND
  8947           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8948              OR
  8949           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8950           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8951           (AM-IG NOT = '1'))
  8952              GO TO 03XX-GET-LIFE-ERPLAN.
  8953
  8954     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8955       AND
  8956        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8957        IF CF-LEVEL    (SUB3)
  8958           IF (PB-I-INDV-GRP-OVRD = 'I')
  8959              OR
  8960           ((AM-IG = '1') AND
  8961           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8962              OR
  8963           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8964           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8965            (AM-IG NOT = '2'))
  8966              GO TO 03XX-GET-LIFE-ERPLAN.
  8967
  8968     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8969       AND
  8970        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8971        IF CF-LEVEL    (SUB3)
  8972           IF (PB-I-INDV-GRP-OVRD = 'G')
  8973              OR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 165
* EL050.cbl
  8974           ((AM-IG = '2') AND
  8975           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8976              OR
  8977           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8978           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8979           (AM-IG NOT = '1'))
  8980              GO TO 03XX-GET-LIFE-ERPLAN.
  8981
  8982     IF SUB5 LESS THAN +30
  8983        ADD +1                   TO SUB5
  8984        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8985
  8986     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8987
  8988 03XX-EDIT-FOR-NINETY-LF-CONT.
  8989
  8990     MOVE +99                    TO SUB5.
  8991
  8992     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8993        IF PB-ISSUE
  8994           MOVE ER-1924          TO  WS-ERROR
  8995           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8996
  8997     GO TO 0304-LIFE-BENEFIT-FOUND.
  8998
  8999 03XX-GET-LIFE-ERPLAN.
  9000
  9001     IF WK-PLAN-ADDR EQUAL +0
  9002        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  9003
  9004     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9005     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9006     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9007     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  9008     MOVE 'Y'                    TO PLAN-MASTER-SW
  9009                                    PLAN-MASTER-LIFE-SW.
  9010     GO TO XXXX-CHECK-LF-PLAN-KEY.
  9011
  9012 03XX-ERPLAN-LIFE-GETMAIN.
  9013
  9014     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9015     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9016
  9017 03XX-ERPLAN-LIFE-READ.
  9018
  9019     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9020     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9021     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9022     MOVE PB-SV-STATE            TO PLAN-STATE.
  9023     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9024     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  9025     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9026     MOVE WS-SAVE-BENEFIT-REVISION
  9027                                 TO PLAN-REVISION-NO.
  9028
  9029     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9030     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  9031
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 166
* EL050.cbl
  9032     IF PB-COMPANY-ID = 'NCL'
  9033       IF NOT LF-PLAN-MASTER-FOUND
  9034         IF NOT PB-POLICY-IS-DECLINED  AND
  9035            NOT PB-POLICY-IS-VOIDED
  9036             MOVE  ER-1921         TO  WS-ERROR
  9037             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9038             GO TO 0304-LIFE-BENEFIT-FOUND.
  9039
  9040     IF NOT LF-PLAN-MASTER-FOUND
  9041        GO TO 0304-LIFE-BENEFIT-FOUND.
  9042
  9043 XXXX-CHECK-LF-PLAN-KEY.
  9044
  9045     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9046        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9047        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9048        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9049        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9050        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9051        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9052        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9053        MOVE 'N'                 TO PLAN-MASTER-SW
  9054          GO TO 03XX-ERPLAN-LIFE-READ.
  9055
  9056     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  9057
  9058     IF  PB-CANCELLATION
  9059         GO TO  0303-LF-ACCT-BEN-FOUND.
  9060
  9061     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9062        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9063           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9064           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9065              MOVE ER-2644             TO WS-ERROR
  9066              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9067           ELSE
  9068              NEXT SENTENCE
  9069        ELSE
  9070           IF PB-COMPANY-ID NOT = 'NCL'
  9071              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9072                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9073
  9074 0303-LF-ACCT-BEN-FOUND.
  9075
  9076     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9077
  9078     IF PL-DEV-CODE NOT = SPACES
  9079        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9080
  9081     IF PL-DEV-PCT NUMERIC AND
  9082        PL-DEV-PCT NOT = ZEROS
  9083        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9084
  9085     IF PL-TOL-PREM-AMT GREATER THAN +0
  9086        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9087
  9088     IF PL-TOL-REF-AMT GREATER THAN +0
  9089        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 167
* EL050.cbl
  9090
  9091     IF PL-TOL-PREM-PCT GREATER THAN +0
  9092        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9093
  9094     IF PL-TOL-REF-PCT GREATER THAN +0
  9095        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9096
  9097     IF PL-TOL-CLM-AMT GREATER THAN +0
  9098        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9099
  9100     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9101                          PL-OVER-SHORT-AMT > +0
  9102        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9103
  9104     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9105                          PL-OVER-SHORT-PCT > +0
  9106        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9107
  9108     IF PL-SALES-TAX NUMERIC AND
  9109                          PL-SALES-TAX > +0
  9110         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9111
  9112     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9113        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9114                                    WS-IG-OVRD-AM.
  9115
  9116 0304-LIFE-BENEFIT-FOUND.
  9117
  9118     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9119
  9120     IF PB-ISSUE
  9121        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9122     ELSE
  9123        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9124
  9125     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9126     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9127     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9128     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9129     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9130                                         WS-LF-REFUND-CALC.
  9131     if (ws-lf-earnings-calc = '5')
  9132        and (pb-i-loan-apr = zeros)
  9133        and (benefit-code-chg)
  9134        move +99.9999 to pb-i-loan-apr
  9135     end-if
  9136
  9137     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9138        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9139
  9140     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9141        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9142     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9143
  9144     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9145     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9146     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9147     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 168
* EL050.cbl
  9148     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9149     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9150
  9151     IF PB-COMPANY-ID = 'NCL'  AND
  9152        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9153         NEXT SENTENCE
  9154     ELSE
  9155         IF SUB5 NOT GREATER THAN +20
  9156            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9157               MOVE WS-SAVE-BENEFIT-REM-TERM
  9158                                      TO WS-AM-LF-BENE-REM-TERM
  9159                                         EC-BR-LF-REM-TERM-CALC.
  9160
  9161     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9162     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9163
  9164     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9165
  9166 0305-BENEFIT-NOT-FOUND.
  9167
  9168     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9169     MOVE ER-2604                TO WS-ERROR.
  9170     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9171
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 169
* EL050.cbl
  9173
  9174 0310-FIND-AH-BENEFIT-RECORD.
  9175
  9176     MOVE 'N'                    TO PLAN-MASTER-SW
  9177                                    PLAN-MASTER-AH-SW.
  9178
  9179     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9180                                    WS-PL-TOL-AH-REFUND
  9181                                    WS-AH-PL-REF-OVS-AMT
  9182                                    WS-PL-TOL-AH-PREM-PCT
  9183                                    WS-PL-TOL-AH-REFUND-PCT
  9184                                    WS-AH-PL-REF-OVS-PCT
  9185                                    WS-PL-TOL-AH-CLAIM.
  9186     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9187
  9188
  9189     if pb-issue
  9190        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9191           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9192        end-if
  9193        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9194           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9195           GO TO 0399-BENEFIT-NOT-FOUND
  9196        end-if
  9197     end-if
  9198
  9199     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9200        GO TO 0400-FIND-CARRIER.
  9201
  9202     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9203
  9204     IF WK-AH-BEN-ADDR NOT = ZEROS
  9205         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9206         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9207         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9208         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9209           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9210             GO TO 0311-AH-BENEFIT-SEARCH
  9211         ELSE
  9212             NEXT SENTENCE
  9213     ELSE
  9214         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9215
  9216     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9217     MOVE '5'                    TO CNTL-REC-TYPE.
  9218     MOVE +0                     TO CNTL-SEQ-NO.
  9219     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9220
  9221     MOVE '2' TO RC-SW-2.
  9222     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9223
  9224     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9225        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9226          GO TO 0399-BENEFIT-NOT-FOUND.
  9227
  9228     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9229
  9230 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 170
* EL050.cbl
  9231
  9232     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9233
  9234     IF NO-BENEFIT-FOUND
  9235         GO TO 0399-BENEFIT-NOT-FOUND.
  9236
  9237     IF WS-BEN-CD = '99'
  9238        GO TO 0399-BENEFIT-NOT-FOUND.
  9239
  9240     IF PB-COMPANY-ID  =  'NCL'
  9241         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9242             GO TO 0314-A-H-BENEFIT-FOUND.
  9243
  9244     MOVE +1                     TO SUB5.
  9245     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9246
  9247* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9248* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9249     IF PB-COMPANY-ID = 'DMD'
  9250         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9251
  9252 0312-EDIT-ACCT-AH-BENEFITS.
  9253
  9254     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9255        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9256           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9257                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9258           GO TO 03XX-GET-AH-ERPLAN.
  9259
  9260     IF SUB5 LESS THAN +20
  9261        ADD +1                   TO SUB5
  9262        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9263
  9264     MOVE +1                     TO SUB5.
  9265
  9266     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9267        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9268
  9269 0313-EDIT-DMD-EXTRA-BENEFITS.
  9270
  9271     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9272        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9273           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9274                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9275           GO TO 03XX-GET-AH-ERPLAN.
  9276
  9277     IF SUB5 LESS THAN +30
  9278        ADD +1                   TO SUB5
  9279        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9280
  9281     MOVE +1                     TO SUB5.
  9282
  9283 03XX-EDIT-FOR-NINETY-AH.
  9284
  9285***************************************************************
  9286*                                                             *
  9287*    NINETY BENEFIT PLAN TYPES:                               *
  9288*                                                             *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 171
* EL050.cbl
  9289*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9290*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9291*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9292*           BENEFIT CONTROLS.                                 *
  9293*      99 = ALL BENEFITS.                                     *
  9294*                                                             *
  9295***************************************************************
  9296
  9297     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9298                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9299
  9300     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9301       AND
  9302        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9303        GO TO 03XX-GET-AH-ERPLAN.
  9304
  9305     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9306       AND
  9307        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9308           IF (PB-I-INDV-GRP-OVRD = 'I')
  9309              OR
  9310           ((AM-IG = '1') AND
  9311           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9312              OR
  9313           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9314           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9315           (AM-IG NOT = '2'))
  9316              GO TO 03XX-GET-AH-ERPLAN.
  9317
  9318     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9319       AND
  9320        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9321           IF (PB-I-INDV-GRP-OVRD = 'G')
  9322              OR
  9323           ((AM-IG = '2') AND
  9324           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9325              OR
  9326           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9327           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9328           (AM-IG NOT = '1'))
  9329              GO TO 03XX-GET-AH-ERPLAN.
  9330
  9331     IF SUB5 LESS THAN +20
  9332        ADD +1                   TO SUB5
  9333        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9334
  9335     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9336        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9337
  9338     MOVE +1                    TO SUB5.
  9339
  9340 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9341
  9342     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9343                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9344
  9345     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9346       AND
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 172
* EL050.cbl
  9347        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9348        GO TO 03XX-GET-AH-ERPLAN.
  9349
  9350     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9351       AND
  9352        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9353           IF (PB-I-INDV-GRP-OVRD = 'I')
  9354              OR
  9355           ((AM-IG = '1') AND
  9356           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9357              OR
  9358           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9359           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9360           (AM-IG NOT = '2'))
  9361              GO TO 03XX-GET-AH-ERPLAN.
  9362
  9363     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9364       AND
  9365        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9366           IF (PB-I-INDV-GRP-OVRD = 'G')
  9367              OR
  9368           ((AM-IG = '2') AND
  9369           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9370              OR
  9371           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9372           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9373           (AM-IG NOT = '1'))
  9374              GO TO 03XX-GET-AH-ERPLAN.
  9375
  9376     IF SUB5 LESS THAN +30
  9377        ADD +1                   TO SUB5
  9378        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9379
  9380 03XX-EDIT-FOR-NINETY-AH-CONT.
  9381
  9382     MOVE +99                    TO SUB5.
  9383
  9384     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9385
  9386     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9387        IF PB-ISSUE
  9388           MOVE ER-1925          TO  WS-ERROR
  9389           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9390
  9391     GO TO 0314-A-H-BENEFIT-FOUND.
  9392
  9393 03XX-GET-AH-ERPLAN.
  9394
  9395     IF WK-PLAN-ADDR EQUAL +0
  9396         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9397
  9398     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9399     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9400     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9401     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9402     MOVE 'Y'                    TO PLAN-MASTER-SW
  9403                                    PLAN-MASTER-AH-SW.
  9404*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 173
* EL050.cbl
  9405     GO TO 03XX-ERPLAN-AH-READ.
  9406
  9407 03XX-ERPLAN-AH-GETMAIN.
  9408
  9409     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9410     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9411
  9412 03XX-ERPLAN-AH-READ.
  9413
  9414     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9415     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9416     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9417     MOVE PB-SV-STATE            TO PLAN-STATE.
  9418     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9419     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9420     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9421     MOVE WS-SAVE-BENEFIT-REVISION
  9422                                 TO PLAN-REVISION-NO.
  9423
  9424     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9425     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9426
  9427     IF PB-COMPANY-ID = 'NCL'
  9428       IF NOT AH-PLAN-MASTER-FOUND
  9429         IF NOT PB-POLICY-IS-DECLINED  AND
  9430            NOT PB-POLICY-IS-VOIDED
  9431             MOVE  ER-1922         TO  WS-ERROR
  9432             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9433             GO TO 0314-A-H-BENEFIT-FOUND.
  9434
  9435     IF NOT AH-PLAN-MASTER-FOUND
  9436        GO TO 0314-A-H-BENEFIT-FOUND.
  9437
  9438 XXXX-CHECK-AH-PLAN-KEY.
  9439
  9440     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9441        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9442        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9443        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9444        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9445        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9446        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9447        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9448        MOVE 'N'                 TO PLAN-MASTER-SW
  9449          GO TO 03XX-ERPLAN-AH-READ.
  9450
  9451     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9452
  9453     IF  PB-CANCELLATION
  9454         GO TO  0313-AH-ACCT-BEN-FOUND.
  9455
  9456     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9457       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9458          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9459          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9460             MOVE ER-2644             TO WS-ERROR
  9461             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9462          ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 174
* EL050.cbl
  9463             NEXT SENTENCE
  9464       ELSE
  9465          IF PB-COMPANY-ID NOT = 'NCL'
  9466             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9467                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9468
  9469 0313-AH-ACCT-BEN-FOUND.
  9470
  9471     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9472
  9473     IF PL-DEV-CODE NOT = SPACES
  9474        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9475
  9476     IF PL-DEV-PCT NUMERIC AND
  9477        PL-DEV-PCT NOT = ZEROS
  9478        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9479
  9480     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9481        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9482
  9483     IF PL-TOL-REF-AMT NOT EQUAL +0
  9484        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9485
  9486     IF PL-TOL-PREM-PCT GREATER THAN +0
  9487        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9488
  9489     IF PL-TOL-REF-PCT GREATER THAN +0
  9490        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9491
  9492     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9493        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9494
  9495     IF PL-OVER-SHORT-AMT NUMERIC AND
  9496                          PL-OVER-SHORT-AMT > +0
  9497        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9498
  9499     IF PL-OVER-SHORT-PCT NUMERIC AND
  9500                          PL-OVER-SHORT-PCT > +0
  9501        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9502
  9503     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9504        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9505        IF WS-IG-OVRD-AM EQUAL SPACES
  9506            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9507
  9508 0314-A-H-BENEFIT-FOUND.
  9509
  9510     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9511
  9512     IF PB-ISSUE
  9513        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9514       ELSE
  9515        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9516
  9517     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9518     if cf-maximum-benefits (sub3) numeric
  9519        move cf-maximum-benefits (sub3)
  9520                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 175
* EL050.cbl
  9521     else
  9522        move zeros               to ws-ah-max-bens
  9523     end-if
  9524     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9525     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9526     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9527                                         WS-AH-REFUND-CALC.
  9528
  9529     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9530        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9531
  9532     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9533        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9534     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9535
  9536     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9537     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9538     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9539     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9540     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9541     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9542
  9543     IF PB-COMPANY-ID = 'NCL'  AND
  9544        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9545         NEXT SENTENCE
  9546     ELSE
  9547         IF SUB5 NOT GREATER THAN +20
  9548            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9549                MOVE WS-SAVE-BENEFIT-REM-TERM
  9550                                      TO WS-AM-AH-BENE-REM-TERM
  9551                                         EC-BR-AH-REM-TERM-CALC.
  9552
  9553     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9554     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9555
  9556     GO TO 0400-FIND-CARRIER.
  9557
  9558 0399-BENEFIT-NOT-FOUND.
  9559
  9560     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9561     MOVE ER-2605                TO WS-ERROR.
  9562     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9563
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 176
* EL050.cbl
  9565
  9566 0400-FIND-CARRIER.
  9567
  9568     MOVE PB-SV-CARRIER          TO WS-CARR.
  9569
  9570     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9571     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9572     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9573     MOVE '6'                    TO CNTL-REC-TYPE.
  9574
  9575*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9576     MOVE SPACE                  TO WS-DMD-RATING-SW
  9577                                    EC-BR-DMD-RATING-SW.
  9578
  9579     MOVE '2'                    TO RC-SW-1.
  9580     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9581
  9582     IF NOT CF-CARRIER-MASTER
  9583        GO TO 0400-CARRIER-NOT-FOUND.
  9584
  9585 0400-BUILD-CARR-TOL.
  9586
  9587     IF CF-CR-TOL-PREM NUMERIC AND
  9588        CF-CR-TOL-PREM GREATER THAN +0
  9589        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9590                                    WS-TOL-AH-PREM.
  9591
  9592     IF CF-CR-TOL-REFUND NUMERIC AND
  9593        CF-CR-TOL-REFUND GREATER THAN +0
  9594        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9595                                    WS-TOL-AH-REFUND.
  9596
  9597     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9598        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9599        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9600                                    WS-AH-REFUND-OVS-AMT.
  9601
  9602     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9603        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9604        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9605                                    WS-AH-REFUND-OVS-PCT.
  9606
  9607     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9608        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9609        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9610                                    WS-TOL-AH-PREM-PCT.
  9611
  9612     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9613        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9614        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9615                                     WS-TOL-AH-REFUND-PCT.
  9616
  9617     IF CF-COMPANY-ID EQUAL 'DMD'
  9618         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9619                                    EC-BR-DMD-RATING-SW.
  9620
  9621     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9622     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 177
* EL050.cbl
  9623        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9624     END-IF
  9625     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9626        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9627     END-IF
  9628     IF WS-TOL-CLP-PCT = ZEROS
  9629        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9630     END-IF
  9631
  9632     IF WS-SPP-LEASE-COMM = ZEROS
  9633        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9634     END-IF
  9635     GO TO 0400-FIND-ERPDEF.
  9636
  9637 0400-CARRIER-NOT-FOUND.
  9638
  9639     MOVE ER-2602                TO WS-ERROR.
  9640     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9641
  9642 0400-FIND-ERPDEF.
  9643*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9644     IF (PB-COMPANY-ID = 'DCC')
  9645        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9646        CONTINUE
  9647     ELSE
  9648        GO TO 0400-FIND-ERCOMP
  9649     END-IF
  9650     MOVE ' '                    TO PDEF-MASTER-SW
  9651     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9652     MOVE PB-STATE               TO ERPDEF-STATE
  9653     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9654        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9655     END-IF
  9656     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9657     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9658     IF PB-ISSUE
  9659        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9660     ELSE
  9661        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9662     END-IF
  9663     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9664     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9665     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9666     IF PDEF-MASTER-FOUND
  9667        MOVE 'N'                 TO PDEF-MASTER-SW
  9668        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9669        IF PDEF-MASTER-FOUND
  9670           IF (ERPDEF-KEY-SAVE (1:16) =
  9671                        PD-CONTROL-PRIMARY (1:16))
  9672              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9673              CONTINUE
  9674           ELSE
  9675              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9676              IF (ERPDEF-KEY-SAVE (1:16) =
  9677                        PD-CONTROL-PRIMARY (1:16))
  9678                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9679                 CONTINUE
  9680              ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 178
* EL050.cbl
  9681                 MOVE 'N'        TO PDEF-MASTER-SW
  9682              END-IF
  9683           END-IF
  9684        END-IF
  9685        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9686     END-IF
  9687     IF PDEF-MASTER-FOUND
  9688        IF PD-TRUNCATED = 'Y'
  9689           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9690        END-IF
  9691     END-IF
  9692     .
  9693 0400-FIND-ERCOMP.
  9694     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9695        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9696           (WS-SUB1 > +10)
  9697           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9698                 OR 'A' OR 'N'
  9699              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9700              MOVE PB-CARRIER    TO COMP-CARRIER
  9701              MOVE PB-GROUPING   TO COMP-GROUPING
  9702              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9703              MOVE AM-AGT (WS-SUB1)
  9704                                 TO COMP-FIN-RESP
  9705              MOVE 'G'           TO COMP-TYPE
  9706              PERFORM 8582-READ-COMPENSATION-MASTER
  9707                                 THRU 8582-EXIT
  9708              IF COMP-MASTER-FOUND
  9709                 IF CO-GA-INACTIVE
  9710                    MOVE ER-2763 TO WS-ERROR
  9711                    PERFORM 9900-ERROR-FORMAT
  9712                                 THRU 9900-EXIT
  9713                    MOVE +11     TO WS-SUB1
  9714                 END-IF
  9715                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9716                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9717                    MOVE ER-2788 TO WS-ERROR
  9718                    PERFORM 9900-ERROR-FORMAT
  9719                                 THRU 9900-EXIT
  9720                    MOVE +11     TO WS-SUB1
  9721                 END-IF
  9722              END-IF
  9723           END-IF
  9724        END-PERFORM
  9725     END-IF
  9726     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9727        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9728           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9729                                    WS-CLP-STATE
  9730        ELSE
  9731           MOVE SPACES           TO PB-I-CLP-STATE
  9732                                    WS-CLP-STATE
  9733        END-IF
  9734     END-IF
  9735
  9736     IF (PB-COMPANY-ID = 'DCC')
  9737        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9738        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 179
* EL050.cbl
  9739        CONTINUE
  9740     ELSE
  9741        GO TO 0400-FIND-STATE-RECORD
  9742     END-IF
  9743     MOVE SPACES                 TO WS-CLP-STATE
  9744     MOVE +0                     TO WS-BANK-FEE
  9745                                    WS-BANK-LFEE
  9746                                    WS-BANK-NOCHRGB
  9747
  9748     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9749     IF (PB-ISSUE)
  9750        AND (PB-I-BANK-NUMBER NOT =
  9751            SPACES AND ZEROS AND LOW-VALUES)
  9752        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9753     ELSE
  9754        IF (PB-CANCELLATION)
  9755           AND (PB-CI-BANK-NUMBER NOT =
  9756                SPACES AND ZEROS AND LOW-VALUES)
  9757           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9758        END-IF
  9759     END-IF
  9760     IF COMP-FIN-RESP NOT = LOW-VALUES
  9761        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9762        MOVE PB-CARRIER          TO COMP-CARRIER
  9763        MOVE PB-GROUPING         TO COMP-GROUPING
  9764        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9765        MOVE 'B'                 TO COMP-TYPE
  9766        PERFORM 8582-READ-COMPENSATION-MASTER
  9767                                 THRU 8582-EXIT
  9768        IF COMP-MASTER-FOUND
  9769           IF CO-MAX-BANK-FEE NOT NUMERIC
  9770              MOVE +0            TO CO-MAX-BANK-FEE
  9771           END-IF
  9772           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9773              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9774           END-IF
  9775           IF CO-GA-INACTIVE
  9776              MOVE ER-2763       TO WS-ERROR
  9777              PERFORM 9900-ERROR-FORMAT
  9778                                 THRU 9900-EXIT
  9779           END-IF
  9780           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9781              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9782              MOVE ER-2788 TO WS-ERROR
  9783              PERFORM 9900-ERROR-FORMAT
  9784                                 THRU 9900-EXIT
  9785              MOVE +11     TO WS-SUB1
  9786           END-IF
  9787           IF WS-AH-BEN-CATEGORY = 'G'
  9788              MOVE CO-MAX-BANK-FEE
  9789                                 TO WS-BANK-FEE
  9790                                    PB-I-BANK-FEE
  9791           ELSE
  9792              MOVE CO-MAX-BANK-FEE-LEASE
  9793                                 TO WS-BANK-LFEE
  9794                                    PB-I-BANK-FEE
  9795           END-IF
  9796           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 180
* EL050.cbl
  9797              AND (WS-AH-REFUND-CALC = 'G'))
  9798                        OR
  9799              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9800              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9801              CONTINUE
  9802           ELSE
  9803              MOVE ER-2789 TO WS-ERROR
  9804              PERFORM 9900-ERROR-FORMAT
  9805                                 THRU 9900-EXIT
  9806           END-IF
  9807           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9808                                    PB-I-CLP-STATE
  9809           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9810           MOVE CO-CARRIER       TO BXRF-CARRIER
  9811           MOVE CO-GROUPING      TO BXRF-GROUPING
  9812           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9813           MOVE BXRF-MAX-REC-LENGTH
  9814                                 TO BXRF-REC-LENGTH
  9815           PERFORM 8584-READ-BANK-CROSS-REF
  9816                                 THRU 8584-EXIT
  9817           IF BXRF-MASTER-FOUND
  9818              MOVE ' '           TO BANK-ACCT-SW
  9819              MOVE BK-BANK-POINTER-CNT
  9820                                 TO BK-BANK-POINTER-CNT
  9821              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9822                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9823                 OR (BANK-ACCT-FOUND)
  9824                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9825                    AND (BK-AM-EXP-DT (WS-SUB1)
  9826                                 > PB-CERT-EFF-DT)
  9827                    AND (BK-AM-EFF-DT (WS-SUB1)
  9828                                 NOT > PB-CERT-EFF-DT)
  9829                    SET BANK-ACCT-FOUND TO TRUE
  9830                 END-IF
  9831              END-PERFORM
  9832              IF NOT BANK-ACCT-FOUND
  9833                 MOVE ZEROS      TO WS-BANK-FEE
  9834                                    WS-BANK-LFEE
  9835                 MOVE ER-2869    TO WS-ERROR
  9836                 PERFORM 9900-ERROR-FORMAT
  9837                                 THRU 9900-EXIT
  9838              ELSE
  9839                 PERFORM 5000-PROCESS-REPS
  9840                                 THRU 5000-EXIT
  9841                 IF AGENT-MASTER-FOUND
  9842                    MOVE +0      TO WS-BANK-FEE
  9843                                    WS-BANK-LFEE
  9844*                   MOVE AG-SPP-FEES (1)
  9845*                                TO PB-I-BANK-FEE
  9846*                                   WS-BANK-FEE
  9847                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9848                       (WS-SUB1 > +10)
  9849                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9850                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9851                       END-IF
  9852                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9853                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9854                       END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 181
* EL050.cbl
  9855                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9856                          AG-SPP-FEES (WS-SUB1)
  9857                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9858                          AG-SPP-LFEES (WS-SUB1)
  9859                    END-PERFORM
  9860                    IF WS-AH-BEN-CATEGORY = 'G'
  9861                       MOVE WS-BANK-FEE
  9862                                 TO PB-I-BANK-FEE
  9863                    ELSE
  9864                       MOVE WS-BANK-LFEE
  9865                                 TO PB-I-BANK-FEE
  9866                    END-IF
  9867                 END-IF
  9868              END-IF
  9869           END-IF
  9870        ELSE
  9871           MOVE ER-2879          TO WS-ERROR
  9872           PERFORM 9900-ERROR-FORMAT
  9873                                 THRU 9900-EXIT
  9874        END-IF
  9875     ELSE
  9876        MOVE ER-2879             TO WS-ERROR
  9877        PERFORM 9900-ERROR-FORMAT
  9878                                 THRU 9900-EXIT
  9879     END-IF
  9880     IF WS-AH-BEN-CATEGORY = 'G'
  9881        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9882        + WS-BANK-FEE
  9883     ELSE
  9884        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9885        + WS-BANK-LFEE
  9886     END-IF
  9887     .
  9888 0400-FIND-STATE-RECORD.
  9889
  9890     IF WK-STATE-ADDR NOT = ZEROS
  9891         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9892         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9893         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9894         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9895         IF PB-SV-STATE = CF-STATE-CODE
  9896             GO TO 0405-CONTINUE-EDIT
  9897         ELSE
  9898             NEXT SENTENCE
  9899     ELSE
  9900         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9901
  9902     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9903     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9904     MOVE '3'                    TO CNTL-REC-TYPE.
  9905     MOVE +0                     TO CNTL-SEQ-NO.
  9906
  9907     MOVE '3'                    TO RC-SW-2.
  9908     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9909
  9910     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9911        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9912        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 182
* EL050.cbl
  9913        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9914                                    WS-TOL-AH-CLAIM
  9915                                    WS-MINIMUM-REFUND
  9916                                    WS-TOL-LF-PREM
  9917                                    WS-TOL-AH-PREM
  9918                                    WS-TOL-LF-REFUND
  9919                                    WS-TOL-AH-REFUND
  9920                                    EC-ST-TOL-PREM-PCT
  9921                                    WS-TOL-LF-PREM-PCT
  9922                                    WS-TOL-AH-PREM-PCT
  9923                                    EC-ST-TOL-REFUND-PCT
  9924                                    WS-TOL-LF-REFUND-PCT
  9925                                    WS-TOL-AH-REFUND-PCT
  9926                                    EC-ST-TOL-PREM
  9927                                    EC-ST-TOL-REFUND
  9928                                    EC-ST-FST-PMT-DAYS-MAX
  9929                                    WS-FREE-LOOK-PERIOD
  9930                                    WS-ST-LF-PREM-TAX
  9931                                    WS-ST-AH-PREM-TAX-I
  9932                                    WS-ST-AH-PREM-TAX-G
  9933                                    WS-BANK-FEE
  9934                                    WS-BANK-LFEE
  9935                                    WS-TOL-CLP-PCT
  9936                                    WS-SPP-LEASE-COMM
  9937                                    WS-INT-PERIODS
  9938                                    WS-EXTRA-PMTS
  9939        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9940                                    EC-ST-FST-PMT-DAYS-CHG
  9941                                    WS-LF-REM-TERM-CALC
  9942                                    WS-LF-REFUND-CALC
  9943                                    EC-ST-LF-REM-TERM-CALC
  9944                                    EC-ST-LF-REFUND-CALC
  9945                                    WS-AH-REM-TERM-CALC
  9946                                    WS-AH-REFUND-CALC
  9947                                    WS-LF-BEN-CATEGORY
  9948                                    WS-AH-BEN-CATEGORY
  9949                                    WS-CLP-STATE
  9950                                    WS-ST-REFUND-CLAIM-FLAG
  9951                                    WS-ST-CAUSAL-STATE
  9952                                    ws-st-agent-sig-edit
  9953                                    EC-ST-AH-REM-TERM-CALC
  9954                                    EC-ST-AH-REFUND-CALC
  9955          GO TO 0499-STATE-NOT-FOUND.
  9956
  9957     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9958
  9959 0405-CONTINUE-EDIT.
  9960
  9961     IF (PB-COMPANY-ID <> 'AHL')
  9962        and (pb-issue)
  9963        MOVE +0                  TO SUB3
  9964        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9965        IF SUB3 > +0
  9966           MOVE ER-3270          TO WS-ERROR
  9967           PERFORM 9900-ERROR-FORMAT
  9968                                 THRU 9900-EXIT
  9969        else
  9970           IF PB-CERT-PRIME NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 183
* EL050.cbl
  9971              MOVE ER-2722       TO WS-ERROR
  9972              PERFORM 9900-ERROR-FORMAT
  9973                                 THRU 9900-EXIT
  9974           end-if
  9975        END-IF
  9976     END-IF
  9977     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9978
  9979     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9980        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9981                                    WS-TOL-AH-CLAIM.
  9982
  9983     IF CF-ST-REFUND-MIN NOT NUMERIC
  9984        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9985
  9986     IF CF-ST-REFUND-MIN NOT = ZEROS
  9987        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9988
  9989     IF CF-ST-TOL-PREM  NOT = ZEROS
  9990        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9991                                    WS-TOL-AH-PREM
  9992        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9993
  9994     IF CF-ST-TOL-REFUND NOT = ZEROS
  9995        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9996                                    WS-TOL-AH-REFUND
  9997        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9998
  9999     IF CF-ST-OVR-SHT-AMT NUMERIC AND
 10000        CF-ST-OVR-SHT-AMT GREATER THAN +0
 10001        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
 10002                                    WS-AH-REFUND-OVS-AMT
 10003                                    EC-ST-OVR-SHT-AMT.
 10004
 10005     IF CF-ST-TOL-PREM-PCT NUMERIC AND
 10006        CF-ST-TOL-PREM-PCT GREATER THAN +0
 10007        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
 10008                                    WS-TOL-LF-PREM-PCT
 10009                                    WS-TOL-AH-PREM-PCT.
 10010
 10011     IF CF-ST-TOL-REF-PCT NUMERIC AND
 10012        CF-ST-TOL-REF-PCT GREATER THAN +0
 10013        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
 10014                                    WS-TOL-LF-REFUND-PCT
 10015                                    WS-TOL-AH-REFUND-PCT.
 10016
 10017     IF CF-ST-OVR-SHT-PCT NUMERIC AND
 10018        CF-ST-OVR-SHT-PCT GREATER THAN +0
 10019        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
 10020                                    WS-AH-REFUND-OVS-PCT
 10021                                    EC-ST-OVR-SHT-PCT.
 10022
 10023     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
 10024     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
 10025
 10026     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
 10027          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
 10028
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 184
* EL050.cbl
 10029     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
 10030     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
 10031     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
 10032
 10033     IF CF-ST-LF-PREM-TAX NUMERIC
 10034        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10035     END-IF
 10036     IF CF-ST-AH-PREM-TAX-I NUMERIC
 10037        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10038     END-IF
 10039     IF CF-ST-AH-PREM-TAX-G NUMERIC
 10040        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10041     END-IF
 10042
 10043     IF CF-ST-REF-AH-DEATH-IND > SPACES
 10044         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 10045     END-IF.
 10046
 10047     IF CF-ST-CAUSAL-STATE > SPACES
 10048         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
 10049     END-IF.
 10050     if cf-st-extra-interest-periods not numeric
 10051        move zeros               to cf-st-extra-interest-periods
 10052     end-if
 10053     if cf-st-extra-payments not numeric
 10054        move zeros               to cf-st-extra-payments
 10055     end-if
 10056
 10057     move cf-st-extra-interest-periods
 10058                                 to ws-int-periods
 10059     move cf-st-extra-payments   to ws-extra-pmts
 10060     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10061     move cf-st-net-only-state   to ws-net-only-state
 10062     if cf-st-comm-cap-sl not numeric
 10063        move zeros               to cf-st-comm-cap-sl
 10064     end-if
 10065     if cf-st-comm-cap-jl not numeric
 10066        move zeros               to cf-st-comm-cap-jl
 10067     end-if
 10068     if cf-st-comm-cap-sa not numeric
 10069        move zeros               to cf-st-comm-cap-sa
 10070     end-if
 10071     if cf-st-comm-cap-ja not numeric
 10072        move zeros               to cf-st-comm-cap-ja
 10073     end-if
 10074     if cf-st-ga-comm-cap-sl not numeric
 10075        move zeros               to cf-st-ga-comm-cap-sl
 10076     end-if
 10077     if cf-st-ga-comm-cap-jl not numeric
 10078        move zeros               to cf-st-ga-comm-cap-jl
 10079     end-if
 10080     if cf-st-ga-comm-cap-sa not numeric
 10081        move zeros               to cf-st-ga-comm-cap-sa
 10082     end-if
 10083     if cf-st-ga-comm-cap-ja not numeric
 10084        move zeros               to cf-st-ga-comm-cap-ja
 10085     end-if
 10086
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 185
* EL050.cbl
 10087     if cf-st-tot-comm-cap-sl not numeric
 10088        move zeros               to cf-st-tot-comm-cap-sl
 10089     end-if
 10090     if cf-st-tot-comm-cap-jl not numeric
 10091        move zeros               to cf-st-tot-comm-cap-jl
 10092     end-if
 10093     if cf-st-tot-comm-cap-sa not numeric
 10094        move zeros               to cf-st-tot-comm-cap-sa
 10095     end-if
 10096     if cf-st-tot-comm-cap-ja not numeric
 10097        move zeros               to cf-st-tot-comm-cap-ja
 10098     end-if
 10099
 10100     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10101     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10102     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10103     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10104     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10105     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10106     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10107     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10108     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10109     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10110     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10111     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10112     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10113     IF WS-LF-BENEFIT-CD = ZEROS
 10114        GO TO 0410-CHECK-AH.
 10115
 10116     IF CF-ST-RT-CALC NOT = SPACES
 10117        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10118                                    EC-ST-LF-REM-TERM-CALC
 10119     END-IF
 10120
 10121     IF WS-LF-COVERAGE-TYPE = 'R'
 10122        IF WS-LF-EARNINGS-CALC = '5'
 10123           IF CF-ST-RF-LN-CALC > '0'
 10124              MOVE CF-ST-RF-LN-CALC
 10125                                 TO WS-LF-REFUND-CALC
 10126                                    EC-ST-LF-REFUND-CALC
 10127           END-IF
 10128        ELSE
 10129           IF CF-ST-RF-LR-CALC > '0'
 10130              MOVE CF-ST-RF-LR-CALC
 10131                                 TO WS-LF-REFUND-CALC
 10132                                    EC-ST-LF-REFUND-CALC
 10133           END-IF
 10134        END-IF
 10135     ELSE
 10136        IF CF-ST-RF-LL-CALC > '0'
 10137           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10138                                    EC-ST-LF-REFUND-CALC
 10139        END-IF
 10140     END-IF
 10141
 10142     IF CF-ST-RT-CALC NOT = SPACES
 10143        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10144                                    EC-ST-LF-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 186
* EL050.cbl
 10145     END-IF
 10146
 10147     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10148     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10149
 10150     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10151
 10152     IF NO-BENEFIT-FOUND
 10153        GO TO 0410-CHECK-AH.
 10154
 10155     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10156        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10157                                 TO EC-ST-LF-REM-TERM-CALC
 10158                                    WS-LF-REM-TERM-CALC
 10159     END-IF
 10160
 10161     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10162        MOVE CF-ST-REFUND-CALC (SUB3)
 10163                                 TO WS-LF-REFUND-CALC
 10164                                    EC-ST-LF-REFUND-CALC
 10165     END-IF
 10166*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10167     if cf-st-extra-periods (sub3) not numeric
 10168        move zeros               to cf-st-extra-periods (sub3)
 10169     end-if
 10170     if cf-st-extra-periods (sub3) > zeros
 10171        if ws-lf-ben-category = 'P'
 10172           move cf-st-extra-periods (sub3)
 10173                                 to ws-extra-pmts
 10174        else
 10175           if ws-lf-ben-category = 'I'
 10176              move cf-st-extra-periods (sub3)
 10177                                 to ws-int-periods
 10178           end-if
 10179        end-if
 10180     end-if
 10181     .
 10182 0410-CHECK-AH.
 10183
 10184     IF WS-AH-BENEFIT-CD = ZEROS
 10185        GO TO 0500-SET-ACCOUNT.
 10186
 10187     IF CF-ST-RT-CALC NOT = SPACES
 10188        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10189                                    EC-ST-AH-REM-TERM-CALC
 10190     END-IF
 10191
 10192     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10193        IF CF-ST-RF-CP-CALC > '0'
 10194           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10195                                    EC-ST-AH-REFUND-CALC
 10196        END-IF
 10197     ELSE
 10198        IF CF-ST-RF-AH-CALC > '0'
 10199           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10200                                    EC-ST-AH-REFUND-CALC
 10201        END-IF
 10202     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 187
* EL050.cbl
 10203     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10204     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10205
 10206     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10207
 10208     IF NO-BENEFIT-FOUND
 10209        GO TO 0500-SET-ACCOUNT.
 10210
 10211     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10212        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10213                                 TO WS-AH-REM-TERM-CALC
 10214                                    EC-ST-AH-REM-TERM-CALC
 10215     END-IF
 10216
 10217     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10218        MOVE CF-ST-REFUND-CALC (SUB3)
 10219                                 TO WS-AH-REFUND-CALC
 10220                                    EC-ST-AH-REFUND-CALC
 10221     END-IF
 10222
 10223*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10224
 10225     GO TO 0500-SET-ACCOUNT.
 10226
 10227 0499-STATE-NOT-FOUND.
 10228
 10229     MOVE ER-2603                TO WS-ERROR.
 10230     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10231
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 188
* EL050.cbl
 10233
 10234 0500-SET-ACCOUNT.
 10235*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10236     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10237        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10238        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10239        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10240        MOVE '3'                 TO CNTL-REC-TYPE
 10241        MOVE +0                  TO CNTL-SEQ-NO
 10242
 10243        MOVE '3'                 TO RC-SW-2
 10244        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10245
 10246        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10247           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10248           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10249           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10250                                    WS-ST-AH-PREM-TAX-I
 10251                                    WS-ST-AH-PREM-TAX-G
 10252        ELSE
 10253           IF CF-ST-LF-PREM-TAX NUMERIC
 10254              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10255           END-IF
 10256           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10257              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10258           END-IF
 10259           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10260              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10261           END-IF
 10262        END-IF
 10263        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10264     END-IF
 10265*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10266*  FOR DCC ONLY
 10267     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10268
 10269        MOVE ' '                 TO STAT-MASTER-SW
 10270        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10271        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10272        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10273        MOVE PB-STATE            TO ELSTAT-STATE
 10274        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10275           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10276        END-IF
 10277
 10278        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10279        SET BIN-TO-GREG          TO TRUE
 10280        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10281        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10282        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10283
 10284        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10285        IF STAT-MASTER-FOUND
 10286           MOVE 'N'              TO STAT-MASTER-SW
 10287           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10288           IF STAT-MASTER-FOUND
 10289              IF (ELSTAT-KEY-SAVE (1:12) =
 10290                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 189
* EL050.cbl
 10291                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10292                    MOVE 'F'        TO STAT-MASTER-SW
 10293                 ELSE
 10294                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10295                    IF (STAT-MASTER-FOUND)
 10296                       AND (ELSTAT-KEY-SAVE (1:12) =
 10297                           SF-CONTROL-PRIMARY (1:12))
 10298                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10299                       MOVE 'F'     TO STAT-MASTER-SW
 10300                    END-IF
 10301                 END-IF
 10302              END-IF
 10303           END-IF
 10304        END-IF
 10305
 10306        IF STAT-MASTER-SW = 'F'
 10307           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10308              and (sf-st-lf-prem-tax > zeros)
 10309              MOVE SF-ST-LF-PREM-TAX
 10310                                 TO WS-ST-LF-PREM-TAX
 10311           END-IF
 10312           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10313              and (sf-st-ah-prem-tax-i > zeros)
 10314              MOVE SF-ST-AH-PREM-TAX-I
 10315                                 TO WS-ST-AH-PREM-TAX-I
 10316           END-IF
 10317           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10318              and (sf-st-ah-prem-tax-g > zeros)
 10319              MOVE SF-ST-AH-PREM-TAX-G
 10320                                 TO WS-ST-AH-PREM-TAX-G
 10321           END-IF
 10322        END-IF
 10323     END-IF
 10324     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10325        AND (PB-ISSUE)
 10326        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10327        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10328        AND (AM-GPCD = 06)
 10329        MOVE 'Y'                 TO WS-GOOD-HIN
 10330        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10331           MOVE PB-I-VIN         TO WS-WORK-VIN
 10332           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10333              (V1 > 16)
 10334              IF WS-WORK-VIN (V1:1) NUMERIC
 10335                 MOVE WS-WORK-VIN-N (V1)
 10336                                 TO WS-ROW-B-VAL (V1)
 10337              ELSE
 10338                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10339                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10340                    OR (V2 > 26)
 10341                 END-PERFORM
 10342                 IF V2 < 27
 10343                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10344                 ELSE
 10345                    MOVE 'N'     TO WS-GOOD-HIN
 10346                 END-IF
 10347              END-IF
 10348              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 190
* EL050.cbl
 10349                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10350              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10351                 WS-ROW-D-VAL (V1)
 10352           END-PERFORM
 10353           MOVE ZEROS            TO WS-VIN-REMAINDER
 10354           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10355             REMAINDER WS-VIN-REMAINDER
 10356           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10357              CONTINUE
 10358           ELSE
 10359              MOVE 'N'           TO WS-GOOD-HIN
 10360           END-IF
 10361        ELSE
 10362           MOVE 'N'              TO WS-GOOD-HIN
 10363        END-IF
 10364        IF WS-GOOD-HIN NOT = 'Y'
 10365           MOVE ER-3826           TO WS-ERROR
 10366           PERFORM 9900-ERROR-FORMAT
 10367                                 THRU 9900-EXIT
 10368        END-IF
 10369     END-IF
 10370     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10371        AND (PB-ISSUE)
 10372        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10373        AND (AM-GPCD NOT = 06)
 10374        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10375           perform 3400-edit-vin thru 3400-exit
 10376        ELSE
 10377          MOVE ER-3826           TO WS-ERROR
 10378          PERFORM 9900-ERROR-FORMAT
 10379                                 THRU 9900-EXIT
 10380        END-IF
 10381     END-IF
 10382     if (pb-company-id = 'CID')
 10383        and (pb-issue)
 10384        and (pb-i-vin not = spaces and low-values and zeros)
 10385        perform 3400-edit-vin    thru 3400-exit
 10386     end-if
 10387******************************************************************
 10388******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10389******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10390******* METHODS.
 10391******************************************************************
 10392     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10393        IF PB-CANCELLATION
 10394           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10395              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10396                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10397                IF FORM-MASTER-FOUND
 10398                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10399******************************************************************
 10400
 10401     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10402     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10403
 10404     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10405     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10406     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 191
* EL050.cbl
 10407     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10408
 10409
 10410     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10411     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10412     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10413
 10414     IF AM-LF-OB-RATE NOT NUMERIC
 10415         MOVE ZERO               TO AM-LF-OB-RATE.
 10416
 10417     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10418         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10419
 10420     IF AM-AH-OB-RATE NOT NUMERIC
 10421         MOVE ZERO               TO AM-AH-OB-RATE.
 10422
 10423     IF WS-LF-JOINT-INDICATOR = 'J'
 10424         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10425     ELSE
 10426         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10427
 10428     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10429
 10430     IF WS-IG-OVRD-AM  EQUAL SPACE
 10431         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10432
 10433     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10434         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10435                                       WS-IG-OVRD
 10436     ELSE
 10437         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10438             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10439                                       WS-IG-OVRD
 10440         ELSE
 10441             MOVE AM-IG             TO WS-IG-OVRD-AH
 10442                                       WS-IG-OVRD.
 10443
 10444     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10445         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10446                                       WS-IG-OVRD
 10447     ELSE
 10448         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10449             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10450                                       WS-IG-OVRD
 10451         ELSE
 10452             MOVE AM-IG             TO WS-IG-OVRD-LF
 10453                                       WS-IG-OVRD.
 10454
 10455     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10456     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10457     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10458     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10459*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10460     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10461                                              TO 'PRLDSFCTIA'.
 10462
 10463     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10464     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 192
* EL050.cbl
 10465     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10466     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10467
 10468     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10469     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10470     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10471     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10472     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10473     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10474     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10475
 10476     IF WS-ACCT-AH-DEV-PCT > +0
 10477        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10478     ELSE
 10479        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10480
 10481     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10482        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10483     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10484        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10485
 10486        IF AM-EARN-METHOD-L = 'S'
 10487            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10488                                        WS-LF-REFUND-CALC.
 10489
 10490        IF AM-EARN-METHOD-R = 'S'
 10491            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10492                                        WS-LF-REFUND-CALC.
 10493
 10494     IF WS-LF-COVERAGE-TYPE = 'R'
 10495         IF AM-EARN-METHOD-R = 'R'
 10496            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10497                                    WS-LF-REFUND-CALC.
 10498     IF WS-LF-COVERAGE-TYPE = 'R'
 10499         IF AM-EARN-METHOD-R = 'P'
 10500            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10501                                    WS-LF-REFUND-CALC.
 10502     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10503         IF AM-EARN-METHOD-L = 'R'
 10504            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10505                                    WS-LF-REFUND-CALC.
 10506     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10507         IF AM-EARN-METHOD-L = 'P'
 10508            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10509                                    WS-LF-REFUND-CALC.
 10510     IF WS-LF-COVERAGE-TYPE = 'R'
 10511         IF AM-EARN-METHOD-R = 'A'
 10512            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10513                                    WS-LF-REFUND-CALC.
 10514     IF WS-LF-COVERAGE-TYPE = 'R'
 10515         IF AM-EARN-METHOD-R = 'M'
 10516            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10517                                    WS-LF-REFUND-CALC.
 10518     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10519         IF AM-EARN-METHOD-L = 'A'
 10520            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10521                                    WS-LF-REFUND-CALC.
 10522     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 193
* EL050.cbl
 10523         IF AM-EARN-METHOD-L = 'M'
 10524            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10525                                    WS-LF-REFUND-CALC.
 10526
 10527     IF AM-EARN-METHOD-A = 'R'
 10528        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10529                                    WS-AH-REFUND-CALC.
 10530     IF AM-EARN-METHOD-A = 'P'
 10531        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10532                                    WS-AH-REFUND-CALC.
 10533     IF AM-EARN-METHOD-A = 'C'
 10534        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10535                                    WS-AH-REFUND-CALC.
 10536     IF AM-EARN-METHOD-A = 'A'
 10537        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10538                                    WS-AH-REFUND-CALC.
 10539     IF AM-EARN-METHOD-A = 'M'
 10540        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10541                                    WS-AH-REFUND-CALC.
 10542     IF AM-EARN-METHOD-A = 'N'
 10543        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10544                                    WS-AH-REFUND-CALC.
 10545     IF AM-EARN-METHOD-A = 'S'
 10546        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10547                                    WS-AH-REFUND-CALC.
 10548
 10549     IF AM-TOL-PREM NOT = ZEROS
 10550        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10551                                    WS-TOL-AH-PREM.
 10552
 10553     IF AM-OVR-SHT-AMT NUMERIC AND
 10554                  AM-OVR-SHT-AMT > 0
 10555        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10556                                    EC-AM-LF-OVR-SHT-AMT
 10557                                    WS-AH-REFUND-OVS-AMT
 10558                                    EC-AM-AH-OVR-SHT-AMT.
 10559
 10560     IF AM-OVR-SHT-PCT NUMERIC AND
 10561                    AM-OVR-SHT-PCT > 0
 10562        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10563                                    EC-AM-LF-OVR-SHT-PCT
 10564                                    WS-AH-REFUND-OVS-PCT
 10565                                    EC-AM-AH-OVR-SHT-PCT.
 10566
 10567     IF AM-TOL-REF-PCT NUMERIC AND
 10568                  AM-TOL-REF-PCT > 0
 10569        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10570                                    WS-TOL-AH-REFUND-PCT.
 10571
 10572     IF AM-TOL-REF  NOT = ZEROS  AND
 10573                  AM-TOL-REF NUMERIC
 10574        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10575                                    EC-AM-LF-TOL-REFUND
 10576                                    WS-TOL-AH-REFUND
 10577                                    EC-AM-AH-TOL-REFUND.
 10578
 10579     IF AM-TOL-CLM  NOT = ZEROS
 10580        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 194
* EL050.cbl
 10581                                    WS-TOL-AH-CLAIM.
 10582
 10583     IF AM-CLP-TOL-PCT NOT NUMERIC
 10584        MOVE +0                  TO AM-CLP-TOL-PCT
 10585     END-IF
 10586
 10587     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10588        MOVE +0                  TO AM-SPP-LEASE-COMM
 10589     END-IF
 10590     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10591        MOVE WS-PL-TOL-LF-PREM-PCT
 10592                                 TO WS-TOL-LF-PREM-PCT.
 10593
 10594     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10595        MOVE WS-PL-TOL-AH-PREM-PCT
 10596                                 TO WS-TOL-AH-PREM-PCT.
 10597
 10598     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10599        MOVE WS-PL-TOL-LF-REFUND-PCT
 10600                                 TO WS-TOL-LF-REFUND-PCT.
 10601
 10602     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10603        MOVE WS-PL-TOL-AH-REFUND-PCT
 10604                                 TO WS-TOL-AH-REFUND-PCT.
 10605
 10606     IF WS-PL-REF-OVS-AMT > +0
 10607        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10608
 10609     IF WS-PL-REF-OVS-PCT > +0
 10610        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10611
 10612     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10613        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10614     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10615        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10616     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10617        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10618     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10619        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10620     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10621        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10622     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10623        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10624
 10625     IF WS-AH-PL-REF-OVS-AMT > +0
 10626        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10627
 10628     IF WS-AH-PL-REF-OVS-PCT > +0
 10629        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10630
 10631     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10632     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10633
 10634     IF PB-CANCELLATION
 10635        GO TO 3000-CONTINUE-EDIT.
 10636
 10637     MOVE +1 TO SUB1.
 10638     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 195
* EL050.cbl
 10639     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10640
 10641     IF CF-COMPANY-ID = 'DMD'
 10642       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10643         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10644        ELSE
 10645         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10646
 10647  0525-FIND-ACCT-COMM.
 10648     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10649        NEXT SENTENCE
 10650      ELSE
 10651         ADD +1 TO SUB1
 10652         IF SUB1 LESS +11
 10653            GO TO 0525-FIND-ACCT-COMM
 10654          ELSE
 10655             GO TO 0550-st-comm-cap-check.
 10656
 10657     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10658     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10659                                    PB-I-LIFE-COMMISSION.
 10660***  IF PB-COMPANY-ID = 'CRI'
 10661     IF PB-PREM-ACCTNG-ONLY
 10662         GO TO 0550-st-comm-cap-check.
 10663
 10664     MOVE '0530' TO CTBL-SW.
 10665     MOVE ' '    TO WS-CTBL-READ-SW.
 10666
 10667
 10668 0530-GET-AH-COMP.
 10669     IF NO-AH-COVERAGE  OR
 10670        NO-AH-BENEFIT-MATCH
 10671           GO TO 0540-NEXT-READ-STEP.
 10672
 10673     IF AM-A-COM (SUB1) NUMERIC
 10674        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10675         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10676         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10677         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10678         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10679     ELSE
 10680          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10681          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10682          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10683          MOVE ZEROS             TO WS-SUB1
 10684                                    WS-COMMISSION
 10685          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10686          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10687          IF WS-COMMISSION > ZEROS
 10688             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10689             GO TO 0540-NEXT-READ-STEP
 10690          END-IF
 10691          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10692          IF CTBL-TABLE-FOUND
 10693             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10694                                        PB-I-AH-TERM
 10695             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10696             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 196
* EL050.cbl
 10697             GO TO 0540-NEXT-READ-STEP
 10698          ELSE
 10699             IF FIRST-TIME-THROUGH
 10700                 GO TO 0530-GET-AH-COMP
 10701             ELSE
 10702                 MOVE ER-2609                TO WS-ERROR
 10703                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10704
 10705 0540-NEXT-READ-STEP.
 10706     MOVE '0540' TO CTBL-SW.
 10707     MOVE ' '    TO WS-CTBL-READ-SW.
 10708
 10709 0540-GET-LF-COMP.
 10710     IF NO-LIFE-COVERAGE  OR
 10711        NO-LF-BENEFIT-MATCH
 10712           GO TO 0550-st-comm-cap-check.
 10713
 10714     IF WS-LF-JOINT-INDICATOR = 'J'
 10715        IF AM-J-COM (SUB1) NUMERIC
 10716           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10717           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10718           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10719           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10720           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10721        ELSE
 10722           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10723           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10724           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10725           MOVE ZEROS                TO WS-SUB1
 10726                                        WS-COMMISSION
 10727           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10728           IF WS-COMMISSION > ZEROS
 10729              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10730              GO TO 0550-st-comm-cap-check
 10731           END-IF
 10732           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10733           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10734           IF CTBL-TABLE-FOUND
 10735              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10736              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10737              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10738              GO TO 0550-st-comm-cap-check
 10739           ELSE
 10740              IF FIRST-TIME-THROUGH
 10741                  GO TO 0540-GET-LF-COMP
 10742              ELSE
 10743                  MOVE ER-2609                TO WS-ERROR
 10744                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10745                  GO TO 0550-st-comm-cap-check.
 10746
 10747     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10748        IF AM-L-COM (SUB1) NUMERIC
 10749           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10750           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10751           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10752           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10753           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10754        ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 197
* EL050.cbl
 10755           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10756           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10757           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10758           MOVE ZEROS                TO WS-SUB1
 10759                                        WS-COMMISSION
 10760           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10761           IF WS-COMMISSION IS GREATER THAN ZEROS
 10762              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10763              GO TO 0550-st-comm-cap-check
 10764           END-IF
 10765           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10766           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10767           IF CTBL-TABLE-FOUND
 10768              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10769              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10770              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10771              GO TO 0550-st-comm-cap-check
 10772           ELSE
 10773              IF FIRST-TIME-THROUGH
 10774                  GO TO 0540-GET-LF-COMP
 10775              ELSE
 10776                  MOVE ER-2609                TO WS-ERROR
 10777                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10778
 10779 0550-st-comm-cap-check.
 10780
 10781     move +0                     to ws-tot-sl-wk-rate
 10782                                    ws-sl-wk-rate
 10783                                    ws-ga-sl-wk-rate
 10784                                    ws-tot-jl-wk-rate
 10785                                    ws-jl-wk-rate
 10786                                    ws-ga-jl-wk-rate
 10787                                    ws-tot-sa-wk-rate
 10788                                    ws-sa-wk-rate
 10789                                    ws-ga-sa-wk-rate
 10790                                    ws-tot-ja-wk-rate
 10791                                    ws-ja-wk-rate
 10792                                    ws-ga-ja-wk-rate
 10793     perform varying sub5 from +1 by +1 until
 10794        (sub5 > +10)
 10795        move +0                  to ws-wk-rate
 10796        if (am-gl-codes (sub5) <> 'Y')
 10797           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10798           if pb-i-lf-benefit-cd <> '  ' and '00'
 10799              move zeros         to ws-wk-rate
 10800              if (am-l-com (sub5) numeric)
 10801                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10802                 move am-l-com(sub5)
 10803                                 to ws-wk-rate
 10804              else
 10805                 move pb-company-cd to ctbl-company-cd
 10806                 move pb-i-lf-benefit-cd
 10807                                 to ctbl-ben-code
 10808                 move pb-i-lf-term  to ws-work-term
 10809                 move pb-life-override-l1
 10810                                 to ctbl-ben-type
 10811                 move zeros      to ws-sub1
 10812                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 198
* EL050.cbl
 10813                 move am-l-coma (sub5)
 10814                                 to ctbl-table
 10815                 move '0540'     to ctbl-sw
 10816                 perform 0552-get-it
 10817                                 thru 0552-exit
 10818              end-if
 10819              compute ws-tot-sl-wk-rate =
 10820                 ws-tot-sl-wk-rate + ws-wk-rate
 10821              if am-com-typ(sub5) = 'C' or 'D'
 10822                 compute ws-sl-wk-rate =
 10823                    ws-sl-wk-rate + ws-wk-rate
 10824              else
 10825                 if am-com-typ(sub5) = 'O' or 'P'
 10826                    compute ws-ga-sl-wk-rate =
 10827                       ws-ga-sl-wk-rate + ws-wk-rate
 10828                 end-if
 10829              end-if
 10830
 10831              move zeros         to ws-wk-rate
 10832              if (am-j-com (sub5) numeric)
 10833                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10834                 move am-j-com(sub5)
 10835                                 to ws-wk-rate
 10836              else
 10837                 move pb-company-cd to ctbl-company-cd
 10838                 move pb-i-lf-benefit-cd
 10839                                 to ctbl-ben-code
 10840                 move pb-i-lf-term  to ws-work-term
 10841                 move pb-life-override-l1
 10842                                 to ctbl-ben-type
 10843                 move zeros      to ws-sub1
 10844                                    ws-commission
 10845                 move am-j-coma (sub5)
 10846                                 to ctbl-table
 10847                 move '0540'     to ctbl-sw
 10848                 perform 0552-get-it
 10849                                 thru 0552-exit
 10850              end-if
 10851              compute ws-tot-jl-wk-rate =
 10852                 ws-tot-jl-wk-rate + ws-wk-rate
 10853              if am-com-typ(sub5) = 'C' or 'D'
 10854                 compute ws-jl-wk-rate =
 10855                    ws-jl-wk-rate + ws-wk-rate
 10856              else
 10857                 if am-com-typ(sub5) = 'O' or 'P'
 10858                    compute ws-ga-jl-wk-rate =
 10859                       ws-ga-jl-wk-rate + ws-wk-rate
 10860                 end-if
 10861              end-if
 10862           end-if
 10863           move zeros            to ws-wk-rate
 10864
 10865           if pb-i-ah-benefit-cd <> '  ' and '00'
 10866              if (am-a-com (sub5) numeric)
 10867                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10868                 move am-a-com(sub5)
 10869                                 to ws-wk-rate
 10870              else
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 199
* EL050.cbl
 10871                 move pb-company-cd to ctbl-company-cd
 10872                 move pb-i-ah-benefit-cd
 10873                                 to ctbl-ben-code
 10874                 move pb-i-ah-term  to ws-work-term
 10875                 move pb-ah-override-l1
 10876                                 to ctbl-ben-type
 10877                 move zeros      to ws-sub1
 10878                                    ws-commission
 10879                 move am-a-coma (sub5)
 10880                                 to ctbl-table
 10881                 move '0530'     to ctbl-sw
 10882                 perform 0552-get-it
 10883                                 thru 0552-exit
 10884              end-if
 10885              compute ws-tot-sa-wk-rate =
 10886                 ws-tot-sa-wk-rate + ws-wk-rate
 10887              if am-com-typ(sub5) = 'C' or 'D'
 10888                 compute ws-sa-wk-rate =
 10889                    ws-sa-wk-rate + ws-wk-rate
 10890              else
 10891                 if am-com-typ(sub5) = 'O' or 'P'
 10892                    compute ws-ga-sa-wk-rate =
 10893                       ws-ga-sa-wk-rate + ws-wk-rate
 10894                 end-if
 10895              end-if
 10896           end-if
 10897        end-if
 10898     end-perform
 10899
 10900     go to 0550-continue
 10901
 10902     .
 10903 0552-get-it.
 10904
 10905     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10906     MOVE ZEROS                  TO WS-SUB1
 10907                                    WS-COMMISSION
 10908     MOVE ' '                    TO WS-CTBL-READ-SW
 10909     PERFORM 8300-READ-CTBL-TABLE
 10910                                 THRU 8300-EXIT
 10911     IF FIRST-TIME-THROUGH
 10912        MOVE 'AA'                TO CTBL-BEN-CODE
 10913        PERFORM 8300-READ-CTBL-TABLE
 10914                                 THRU 8300-EXIT
 10915     END-IF
 10916     IF CTBL-TABLE-FOUND
 10917        if pb-life-override-l1 = ctbl-ben-type
 10918           move pb-i-lf-benefit-amt
 10919                                 to WS-COMM-CK-AMT
 10920        else
 10921           compute ws-comm-ck-amt =
 10922              pb-I-ah-benefit-amt * pb-i-ah-term
 10923        end-if
 10924        PERFORM 8800-GET-COMP-RATE
 10925                                 THRU 8800-EXIT
 10926     else
 10927        move zeros               to ws-wk-rate
 10928     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 200
* EL050.cbl
 10929
 10930     .
 10931 0552-exit.
 10932     exit.
 10933
 10934 0550-continue.
 10935
 10936     if ws-lf-joint-indicator = 'J'
 10937        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10938           and (ws-st-comm-cap-jl <> zeros)
 10939           MOVE ER-1956          TO WS-ERROR
 10940           PERFORM 9900-ERROR-FORMAT
 10941                                 THRU 9900-EXIT
 10942        end-if
 10943        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10944           and (ws-st-ga-comm-cap-jl <> zeros)
 10945           MOVE ER-1959          TO WS-ERROR
 10946           PERFORM 9900-ERROR-FORMAT
 10947                                 THRU 9900-EXIT
 10948        end-if
 10949        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10950           and (ws-st-tot-comm-cap-jl <> zeros)
 10951           MOVE ER-1962          TO WS-ERROR
 10952           PERFORM 9900-ERROR-FORMAT
 10953                                 THRU 9900-EXIT
 10954        end-if
 10955     else
 10956        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10957           and (ws-st-comm-cap-sl <> zeros)
 10958           MOVE ER-1955          TO WS-ERROR
 10959           PERFORM 9900-ERROR-FORMAT
 10960                                 THRU 9900-EXIT
 10961        end-if
 10962        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10963           and (ws-st-ga-comm-cap-sl <> zeros)
 10964           MOVE ER-1958          TO WS-ERROR
 10965           PERFORM 9900-ERROR-FORMAT
 10966                                 THRU 9900-EXIT
 10967        end-if
 10968        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10969           and (ws-st-tot-comm-cap-sl <> zeros)
 10970           MOVE ER-1961          TO WS-ERROR
 10971           PERFORM 9900-ERROR-FORMAT
 10972                                 THRU 9900-EXIT
 10973        end-if
 10974
 10975     if ws-ah-joint-indicator = 'J'
 10976        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10977           and (ws-st-comm-cap-ja <> zeros)
 10978           MOVE ER-1957          TO WS-ERROR
 10979           PERFORM 9900-ERROR-FORMAT
 10980                                 THRU 9900-EXIT
 10981        end-if
 10982        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10983           and (ws-st-ga-comm-cap-ja <> zeros)
 10984           MOVE ER-1960          TO WS-ERROR
 10985           PERFORM 9900-ERROR-FORMAT
 10986                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 201
* EL050.cbl
 10987        end-if
 10988        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10989           and (ws-st-tot-comm-cap-ja <> zeros)
 10990           MOVE ER-1963          TO WS-ERROR
 10991           PERFORM 9900-ERROR-FORMAT
 10992                                 THRU 9900-EXIT
 10993        end-if
 10994     else
 10995        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 10996           and (ws-st-comm-cap-sa <> zeros)
 10997           MOVE ER-1957          TO WS-ERROR
 10998           PERFORM 9900-ERROR-FORMAT
 10999                                 THRU 9900-EXIT
 11000        end-if
 11001        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 11002           and (ws-st-ga-comm-cap-sa <> zeros)
 11003           MOVE ER-1960          TO WS-ERROR
 11004           PERFORM 9900-ERROR-FORMAT
 11005                                 THRU 9900-EXIT
 11006        end-if
 11007        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 11008           and (ws-st-tot-comm-cap-sa <> zeros)
 11009           MOVE ER-1963          TO WS-ERROR
 11010           PERFORM 9900-ERROR-FORMAT
 11011                                 THRU 9900-EXIT
 11012        end-if
 11013     end-if
 11014     .
 11015 0560-EDIT-CONTINUE.
 11016     MOVE ZEROS                  TO WS-LF-PMF-COMM
 11017                                    WS-AH-PMF-COMM
 11018*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 11019*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 11020     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 11021        (SUB1 > +10)
 11022        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 11023           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 11024           MOVE '0530'           TO CTBL-SW
 11025           MOVE ' '              TO WS-CTBL-READ-SW
 11026           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 11027           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 11028           MOVE '0540'           TO CTBL-SW
 11029           MOVE ' '              TO WS-CTBL-READ-SW
 11030           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 11031        END-IF
 11032     END-PERFORM
 11033     GO TO 0564-EDIT-CONTINUE
 11034     .
 11035 0561-CHECK-AH.
 11036     IF (NO-AH-COVERAGE)
 11037        OR (NO-AH-BENEFIT-MATCH)
 11038        CONTINUE
 11039     ELSE
 11040        IF (AM-A-COM (SUB1) NUMERIC)
 11041           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11042           IF (AM-COM-TYP (SUB1) = 'A')
 11043              AND (WS-AH-PMF-COMM = ZEROS)
 11044              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 202
* EL050.cbl
 11045           END-IF
 11046           CONTINUE
 11047        ELSE
 11048           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 11049           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 11050           MOVE PB-AH-OVERRIDE-L1
 11051                                 TO CTBL-BEN-TYPE
 11052           MOVE ZEROS            TO WS-SUB1
 11053                                    WS-COMMISSION
 11054           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 11055           PERFORM 8300-READ-CTBL-TABLE
 11056                                 THRU 8300-EXIT
 11057           IF CTBL-TABLE-FOUND
 11058              IF (AM-COM-TYP (SUB1) = 'A')
 11059                 AND (WS-AH-PMF-COMM = ZEROS)
 11060                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11061                                        PB-I-AH-TERM
 11062                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11063                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11064              END-IF
 11065              CONTINUE
 11066           ELSE
 11067              IF FIRST-TIME-THROUGH
 11068                 GO TO 0561-CHECK-AH
 11069              ELSE
 11070                 MOVE ER-2609    TO WS-ERROR
 11071                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11072              END-IF
 11073           END-IF
 11074        END-IF
 11075     END-IF
 11076     .
 11077 0561-EXIT.
 11078     EXIT.
 11079 0563-CHECK-LF.
 11080     IF (NO-LIFE-COVERAGE)
 11081        OR (NO-LF-BENEFIT-MATCH)
 11082        CONTINUE
 11083     ELSE
 11084        IF WS-LF-JOINT-INDICATOR = 'J'
 11085           IF AM-J-COM (SUB1) NUMERIC
 11086              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11087              IF (AM-COM-TYP (SUB1) = 'A')
 11088                 AND (WS-LF-PMF-COMM = ZEROS)
 11089                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11090              END-IF
 11091              CONTINUE
 11092           ELSE
 11093              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11094              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11095              MOVE PB-LIFE-OVERRIDE-L1
 11096                                 TO CTBL-BEN-TYPE
 11097              MOVE ZEROS         TO WS-SUB1
 11098                                    WS-COMMISSION
 11099              MOVE AM-J-COMA (SUB1)
 11100                                 TO CTBL-TABLE
 11101              PERFORM 8300-READ-CTBL-TABLE
 11102                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 203
* EL050.cbl
 11103              IF CTBL-TABLE-FOUND
 11104                 IF (AM-COM-TYP (SUB1) = 'A')
 11105                    AND (WS-LF-PMF-COMM = ZEROS)
 11106                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11107                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11108                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11109                 END-IF
 11110                 CONTINUE
 11111              ELSE
 11112                 IF FIRST-TIME-THROUGH
 11113                    GO TO 0563-CHECK-LF
 11114                 ELSE
 11115                    MOVE ER-2609 TO WS-ERROR
 11116                    PERFORM 9900-ERROR-FORMAT
 11117                                 THRU 9900-EXIT
 11118*                   GO TO 0560-EDIT-CONTINUE
 11119                 END-IF
 11120              END-IF
 11121           END-IF
 11122        ELSE
 11123           IF AM-L-COM (SUB1) NUMERIC
 11124              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11125              IF (AM-COM-TYP (SUB1) = 'A')
 11126                 AND (WS-LF-PMF-COMM = ZEROS)
 11127                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11128              END-IF
 11129              CONTINUE
 11130           ELSE
 11131              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11132              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11133              MOVE PB-LIFE-OVERRIDE-L1
 11134                                 TO CTBL-BEN-TYPE
 11135              MOVE ZEROS         TO WS-SUB1
 11136                                    WS-COMMISSION
 11137              MOVE AM-L-COMA (SUB1)
 11138                                 TO CTBL-TABLE
 11139              PERFORM 8300-READ-CTBL-TABLE
 11140                                 THRU 8300-EXIT
 11141              IF CTBL-TABLE-FOUND
 11142                 CONTINUE
 11143              ELSE
 11144                 IF FIRST-TIME-THROUGH
 11145                    GO TO 0563-CHECK-LF
 11146                 ELSE
 11147                    MOVE ER-2609 TO WS-ERROR
 11148                    PERFORM 9900-ERROR-FORMAT
 11149                                 THRU 9900-EXIT
 11150                 END-IF
 11151              END-IF
 11152           END-IF
 11153        END-IF
 11154     END-IF
 11155     .
 11156 0563-EXIT.
 11157     EXIT.
 11158 0564-EDIT-CONTINUE.
 11159
 11160     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 204
* EL050.cbl
 11161         IF PB-I-NUM-BILLED EQUAL ZEROS
 11162            MOVE ER-8148       TO WS-ERROR
 11163            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11164
 11165*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11166*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11167*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11168*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11169*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11170*         IF NO-CONVERSION-ERROR
 11171*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11172*         ELSE
 11173*             IF PB-COMPANY-ID EQUAL 'HAN'
 11174*                 MOVE ZEROS     TO PB-I-AGE.
 11175     IF PB-I-BIRTHDAY > LOW-VALUES
 11176        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11177        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11178        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11179        PERFORM 8500-DATE-CONVERT
 11180                                 THRU 8500-EXIT
 11181        IF NO-CONVERSION-ERROR
 11182           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11183           IF PB-I-AGE > ZEROS
 11184              IF WS-WORK-AGE NOT = PB-I-AGE
 11185                 MOVE ER-9501    TO WS-ERROR
 11186                 PERFORM 9900-ERROR-FORMAT
 11187                                 THRU 9900-EXIT
 11188              END-IF
 11189           ELSE
 11190              MOVE WS-WORK-AGE   TO PB-I-AGE
 11191           END-IF
 11192        END-IF
 11193     END-IF
 11194     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11195                                   WS-INS-AGE-SET
 11196     IF PB-I-AGE = ZEROS
 11197        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11198           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11199                                   WS-INS-AGE-SET
 11200           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11201
 11202     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11203                                   WS-AH-EDIT-AGE.
 11204
 11205     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11206        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11207        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11208        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11209        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11210        IF NO-CONVERSION-ERROR
 11211           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11212           IF PB-I-JOINT-AGE > 0
 11213              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11214                 MOVE ER-9503    TO WS-ERROR
 11215                 PERFORM 9900-ERROR-FORMAT
 11216                                 THRU 9900-EXIT
 11217              END-IF
 11218           ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 205
* EL050.cbl
 11219              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11220           END-IF
 11221        ELSE
 11222           MOVE ZEROS            TO PB-I-JOINT-AGE
 11223        END-IF
 11224     END-IF
 11225     IF PB-I-JOINT-AGE NOT NUMERIC
 11226        MOVE ZERO               TO PB-I-JOINT-AGE.
 11227
 11228     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11229                                   WS-JNT-AGE-SET
 11230     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11231        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11232           (WS-AH-JOINT-INDICATOR = 'J')
 11233           IF PB-I-JOINT-AGE = ZEROS
 11234               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11235                                          WS-JNT-AGE-SET
 11236               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11237           END-IF
 11238        END-IF
 11239     END-IF
 11240
 11241     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11242     IF WS-LF-JOINT-INDICATOR = 'J'
 11243        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11244        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11245            IF  PB-I-JOINT-AGE = ZERO
 11246                MOVE ER-2686       TO WS-ERROR
 11247                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11248            ELSE
 11249                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11250                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11251                    IF PB-COMPANY-ID NOT = 'LBL'
 11252                        MOVE ER-2685    TO WS-ERROR
 11253                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11254
 11255     IF WS-AH-JOINT-INDICATOR = 'J'
 11256        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11257            IF  PB-I-JOINT-AGE = ZERO
 11258                MOVE ER-2686       TO WS-ERROR
 11259                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11260            ELSE
 11261                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11262                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11263                                           WS-EDIT-AGE
 11264                    IF PB-COMPANY-ID NOT = 'LBL'
 11265                        MOVE ER-2685    TO WS-ERROR
 11266                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11267
 11268******************************************************************
 11269*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11270******************************************************************
 11271
 11272     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11273        (WS-AH-SPECIAL-CALC-CD = 'O')
 11274        NEXT SENTENCE
 11275     ELSE
 11276        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 206
* EL050.cbl
 11277          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11278           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11279            WS-AH-JOINT-INDICATOR = 'J')  AND
 11280           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11281            MOVE ER-2627             TO WS-ERROR
 11282            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11283
 11284     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11285        (WS-AH-SPECIAL-CALC-CD = 'O')
 11286         NEXT SENTENCE
 11287     ELSE
 11288         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11289            WS-AH-JOINT-INDICATOR = 'J'
 11290             IF PB-I-JOINT-INSURED = SPACES
 11291                 IF PB-COMPANY-ID NOT = 'JAL'
 11292                     MOVE ER-2696    TO WS-ERROR
 11293                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11294
 11295     IF PB-COMPANY-ID NOT = 'BOA'
 11296        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11297           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11298           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11299               PB-I-JOINT-INSURED NOT = SPACES)
 11300                MOVE ER-2691         TO WS-ERROR
 11301                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11302
 11303     IF PB-COMPANY-ID = 'BOA'
 11304        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11305           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11306            IF PB-I-JOINT-AGE NOT = ZEROS
 11307                MOVE ER-2691         TO WS-ERROR
 11308                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11309
 11310     IF PB-COMPANY-ID = 'CRI'
 11311        IF PB-I-SIG-SW = 'J'
 11312           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11313              WS-AH-JOINT-INDICATOR NOT = 'J'
 11314              MOVE ER-2675       TO WS-ERROR
 11315              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11316
 11317     IF PB-COMPANY-ID = 'CRI'
 11318        IF PB-I-SIG-SW = 'S'
 11319           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11320              WS-AH-JOINT-INDICATOR = 'J'
 11321              MOVE ER-2676       TO WS-ERROR
 11322              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11323
 11324     IF PB-COMPANY-ID = 'CVL'
 11325         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11326            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11327              MOVE ER-2783           TO WS-ERROR
 11328              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11329     IF (WS-LF-JOINT-INDICATOR = 'J')
 11330        AND (WS-AH-JOINT-INDICATOR = 'J')
 11331        AND (PB-I-LF-TERM > 120)
 11332        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11333        MOVE ER-2783             TO WS-ERROR
 11334        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 207
* EL050.cbl
 11335     END-IF
 11336     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11337
 11338     IF PB-I-INDV-GRP-OVRD = 'I'
 11339        MOVE ER-2666             TO WS-ERROR
 11340        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11341        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11342
 11343     IF PB-I-INDV-GRP-OVRD = 'G'
 11344        MOVE ER-2666             TO WS-ERROR
 11345        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11346        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11347
 11348     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11349        NEXT SENTENCE
 11350     ELSE
 11351        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11352
 11353     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11354        IF WS-ERROR = ER-2666
 11355           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11356           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11357
 11358     IF PB-COMPANY-ID = 'CID'
 11359        IF PB-STATE = 'UT' OR 'MO'
 11360           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11361                 OR '76' OR '77')
 11362                      OR
 11363               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11364                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11365                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11366                   OR '2K' OR '2L'))
 11367              AND PB-I-INDV-GRP-CD = 'I'
 11368              MOVE ER-2721             TO WS-ERROR
 11369              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11370           END-IF
 11371        END-IF
 11372     END-IF
 11373
 11374     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11375     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11376        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11377     ELSE
 11378        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11379     END-IF
 11380
 11381*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11382*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11383     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11384                                    ACCOUNT-AH-CK-SW.
 11385
 11386     IF PB-REISSUED-CERT       OR
 11387        PB-REIN-ONLY-CERT      OR
 11388        PB-POLICY-IS-DECLINED  OR
 11389        PB-POLICY-IS-VOIDED
 11390*       OR PB-MONTHLY-CERT
 11391         GO TO 3000-CONTINUE-EDIT.
 11392
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 208
* EL050.cbl
 11393     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11394        IF WS-EDIT-AGE           > +65
 11395           MOVE ER-2709          TO WS-ERROR
 11396           PERFORM 9900-ERROR-FORMAT
 11397                                 THRU 9900-EXIT
 11398        ELSE
 11399           IF WS-EDIT-AGE        > +55
 11400              MOVE ER-2718       TO WS-ERROR
 11401              PERFORM 9900-ERROR-FORMAT
 11402                                 THRU 9900-EXIT
 11403           END-IF
 11404        END-IF
 11405     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11406        IF WS-EDIT-AGE           > +65
 11407           MOVE ER-2709          TO WS-ERROR
 11408           PERFORM 9900-ERROR-FORMAT
 11409                                 THRU 9900-EXIT
 11410        END-IF
 11411     END-IF
 11412     .
 11413
 11414 0565-LIFE-PLAN-LIMIT-EDITS.
 11415
 11416     IF NOT LF-PLAN-MASTER-FOUND
 11417        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11418                                    EC-AM-LF-MAX-TOT-BEN
 11419        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11420
 11421     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11422
 11423     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11424         IF PL-LM-AGE (1) = ZEROS
 11425             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11426
 11427     IF NO-LF-BENEFIT-MATCH          OR
 11428        WS-LF-BENEFIT-CD = ZEROS     OR
 11429        WS-LF-SPECIAL-CALC-CD = 'M'
 11430        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11431
 11432     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11433     MOVE +1                     TO SUB2.
 11434
 11435     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11436        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11437           MOVE +5   TO SUB2
 11438           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11439              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11440              (PL-LM-AGE (SUB2) EQUAL +0)
 11441              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11442              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11443
 11444     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11445
 11446     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11447                               + PB-I-LF-ALT-BENEFIT-AMT.
 11448
 11449 0568-CHECK-LIFE-ATT-AGE.
 11450
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 209
* EL050.cbl
 11451     IF PL-ATT-AGE NUMERIC AND
 11452        PL-ATT-AGE > +0
 11453        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11454     END-IF
 11455*    IF PL-ATT-AGE NUMERIC AND
 11456*       PL-ATT-AGE > +0
 11457*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11458*       IF PB-I-BIRTHDAY > LOW-VALUES
 11459*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11460*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11461*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11462*          SET BIN-PLUS-ELAPSED  TO TRUE
 11463*          PERFORM 8500-DATE-CONVERT
 11464*                                THRU 8500-EXIT
 11465*          IF NO-CONVERSION-ERROR
 11466*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11467*             MOVE ER-2669       TO WS-ERROR
 11468*             PERFORM 9900-ERROR-FORMAT
 11469*                                THRU 9900-EXIT
 11470*          END-IF
 11471*       ELSE
 11472*          IF WS-ATT-AGE >= PL-ATT-AGE
 11473*             MOVE ER-2669       TO WS-ERROR
 11474*             PERFORM 9900-ERROR-FORMAT
 11475*                                THRU 9900-EXIT
 11476*          END-IF
 11477*       END-IF
 11478*    END-IF
 11479     .
 11480 0570-CHECK-LIFE-LIMITS.
 11481
 11482     IF PB-COMPANY-ID EQUAL 'CRI'
 11483        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11484           IF SUB2 GREATER THAN +4
 11485              MOVE ER-2637 TO WS-ERROR
 11486              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11487              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11488
 11489     IF PB-COMPANY-ID  =  'NCL'
 11490        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11491            SUB2 GREATER THAN +8
 11492             MOVE 'U'         TO PB-BATCH-ENTRY
 11493             MOVE ER-2637     TO WS-ERROR
 11494             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11495             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11496
 11497     IF SUB2 > +8
 11498        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11499           AND (PB-I-SIG-SW = 'Y')
 11500           CONTINUE
 11501        ELSE
 11502           MOVE ER-2637          TO WS-ERROR
 11503           PERFORM 9900-ERROR-FORMAT
 11504                                 THRU 9900-EXIT
 11505        END-IF
 11506        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11507     END-IF
 11508     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 210
* EL050.cbl
 11509     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11510     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11511
 11512     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11513        ADD +1  TO SUB2
 11514        GO TO 0570-CHECK-LIFE-LIMITS.
 11515
 11516     IF PB-COMPANY-ID = 'NCL'
 11517         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11518
 11519     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11520        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11521        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11522           AND (PB-I-SIG-SW = 'Y')
 11523           CONTINUE
 11524        ELSE
 11525           MOVE ER-2637          TO WS-ERROR
 11526           PERFORM 9900-ERROR-FORMAT
 11527                                 THRU 9900-EXIT
 11528        END-IF
 11529     END-IF
 11530     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11531
 11532
 11533 0570-CHECK-NCL-LIFE-LIMITS.
 11534
 11535     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11536        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11537         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11538
 11539     IF APP-CERT-USED
 11540         IF SUB2  LESS THAN  +5
 11541             MOVE +5          TO SUB2
 11542             GO TO 0570-CHECK-LIFE-LIMITS.
 11543
 11544     MOVE ER-2637             TO WS-ERROR.
 11545     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11546
 11547     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11548
 11549 0575-CHECK-NCL-SIG-SWITCH.
 11550
 11551     IF NOT APP-CERT-USED
 11552         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11553
 11554     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11555        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11556        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11557        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11558         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11559
 11560     IF SUB2 GREATER THAN +4
 11561         IF PL-LM-AGE (5) = ZEROS  AND
 11562            PL-LM-AGE (6) = ZEROS  AND
 11563            PL-LM-AGE (7) = ZEROS  AND
 11564            PL-LM-AGE (8) = ZEROS
 11565             MOVE  ER-1927        TO WS-ERROR
 11566             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 211
* EL050.cbl
 11567             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11568         ELSE
 11569             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11570                 MOVE  ER-1920    TO WS-ERROR
 11571                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11572
 11573     IF PB-I-SIG-SW  = 'Y'
 11574       IF NOT PB-I-POLICY-ACCEPTED  AND
 11575          NOT PB-I-POLICY-DECLINED
 11576           MOVE 'U'               TO PB-BATCH-ENTRY
 11577           MOVE  ER-1926          TO WS-ERROR
 11578           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11579
 11580
 11581 0580-AH-PLAN-LIMIT-EDITS.
 11582
 11583     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11584        IF PB-I-AH-BENEFIT-AMT > +1250
 11585           MOVE ER-2702          TO WS-ERROR
 11586           PERFORM 9900-ERROR-FORMAT
 11587                                 THRU 9900-EXIT
 11588        END-IF
 11589     END-IF
 11590
 11591     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11592        AND (PB-MONTHLY-CERT)
 11593        IF PB-I-AH-BENEFIT-AMT > +3000
 11594           MOVE ER-2881          TO WS-ERROR
 11595           PERFORM 9900-ERROR-FORMAT
 11596                                 THRU 9900-EXIT
 11597        END-IF
 11598     END-IF
 11599     IF NOT AH-PLAN-MASTER-FOUND
 11600        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11601        GO TO 3000-CONTINUE-EDIT.
 11602
 11603     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11604
 11605     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11606         IF PL-LM-AGE (1) = ZEROS
 11607             GO TO 3000-CONTINUE-EDIT.
 11608
 11609     IF NO-AH-BENEFIT-MATCH          OR
 11610        WS-AH-BENEFIT-CD = ZEROS     OR
 11611        WS-AH-SPECIAL-CALC-CD = 'M'
 11612        GO TO 3000-CONTINUE-EDIT.
 11613
 11614     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11615     MOVE +1                     TO SUB2.
 11616
 11617     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11618        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11619           MOVE +5 TO SUB2
 11620           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11621              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11622              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11623              (PL-LM-AGE (SUB2) EQUAL +0)
 11624              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 212
* EL050.cbl
 11625              GO TO 3000-CONTINUE-EDIT.
 11626
 11627     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11628
 11629 0590-CHECK-AH-ATT-AGE.
 11630
 11631     IF PL-ATT-AGE NUMERIC AND
 11632        PL-ATT-AGE GREATER THAN +0
 11633        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11634     END-IF
 11635*       IF WS-ATT-AGE >= PL-ATT-AGE
 11636*          MOVE ER-3054          TO WS-ERROR
 11637*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11638     .
 11639 0597-CHECK-AH-LIMITS.
 11640
 11641     IF PB-COMPANY-ID EQUAL 'CRI'
 11642        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11643           IF SUB2 GREATER THAN +4
 11644              MOVE ER-2638       TO WS-ERROR
 11645              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11646              GO TO 3000-CONTINUE-EDIT.
 11647
 11648     IF PB-COMPANY-ID  =  'NCL'
 11649        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11650            SUB2 GREATER THAN +8
 11651             MOVE 'U'            TO PB-BATCH-ENTRY
 11652             MOVE ER-2638        TO WS-ERROR
 11653             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11654             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11655
 11656     IF SUB2 > +8
 11657        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11658           AND (PB-I-SIG-SW = 'Y')
 11659           CONTINUE
 11660        ELSE
 11661           MOVE ER-2638          TO WS-ERROR
 11662           PERFORM 9900-ERROR-FORMAT
 11663                                 THRU 9900-EXIT
 11664        END-IF
 11665        GO TO 3000-CONTINUE-EDIT
 11666     END-IF
 11667
 11668     IF PB-COMPANY-ID = 'CRI'
 11669        IF WS-ERROR = ER-2638
 11670           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11671
 11672     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11673     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11674     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11675     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11676
 11677     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11678        ADD +1                   TO SUB2
 11679        GO TO 0597-CHECK-AH-LIMITS.
 11680
 11681     IF PB-COMPANY-ID = 'NCL'
 11682         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 213
* EL050.cbl
 11683
 11684     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11685        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11686        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11687                                 > PL-LM-AMT (SUB2))
 11688        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11689           AND (PB-I-SIG-SW = 'Y')
 11690           CONTINUE
 11691        ELSE
 11692           MOVE ER-2638          TO WS-ERROR
 11693           PERFORM 9900-ERROR-FORMAT
 11694                                 THRU 9900-EXIT
 11695        END-IF
 11696     END-IF
 11697
 11698     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11699         IF  WS-ERROR    EQUAL    ER-2638
 11700             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11701                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11702                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11703                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11704                MOVE  ER-1910    TO  WS-ERROR
 11705                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11706
 11707     IF PB-COMPANY-ID = 'CRI'
 11708        IF WS-ERROR = ER-2638
 11709            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11710            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11711            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11712
 11713     GO TO 3000-CONTINUE-EDIT.
 11714
 11715 0597-CHECK-NCL-AH-LIMITS.
 11716
 11717     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11718        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11719        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11720                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11721         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11722
 11723     IF APP-CERT-USED
 11724         IF SUB2  LESS THAN  +5
 11725             MOVE +5             TO SUB2
 11726             GO TO 0597-CHECK-AH-LIMITS.
 11727
 11728     MOVE ER-2638                TO WS-ERROR.
 11729     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11730
 11731     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11732
 11733 0599-CHECK-NCL-SIG-SWITCH.
 11734
 11735     IF NOT APP-CERT-USED
 11736         GO TO 3000-CONTINUE-EDIT.
 11737
 11738     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11739        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11740        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 214
* EL050.cbl
 11741        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11742         GO TO 3000-CONTINUE-EDIT.
 11743
 11744     IF SUB2 GREATER THAN +4
 11745         IF PL-LM-AGE (5) = ZEROS  AND
 11746            PL-LM-AGE (6) = ZEROS  AND
 11747            PL-LM-AGE (7) = ZEROS  AND
 11748            PL-LM-AGE (8) = ZEROS
 11749             MOVE  ER-1927        TO WS-ERROR
 11750             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11751             GO TO 3000-CONTINUE-EDIT
 11752         ELSE
 11753             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11754                 MOVE  ER-1920    TO WS-ERROR
 11755                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11756
 11757     IF PB-I-SIG-SW  = 'Y'
 11758       IF NOT PB-I-POLICY-ACCEPTED  AND
 11759          NOT PB-I-POLICY-DECLINED
 11760           MOVE 'U'               TO PB-BATCH-ENTRY
 11761           MOVE  ER-1926          TO WS-ERROR
 11762           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11763
 11764******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 215
* EL050.cbl
 11766
 11767 3000-CONTINUE-EDIT.
 11768
 11769     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11770     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11771     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11772     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11773     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11774
 11775     IF BROWSE-STARTED
 11776        PERFORM 9990-RETURN THRU 9990-EXIT
 11777        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11778
 11779     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11780        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11781        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11782        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11783*       MOVE 1                   TO DC-OPTION-CODE
 11784        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11785        IF DATE-CONVERSION-ERROR
 11786           MOVE ER-2622          TO WS-ERROR
 11787           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11788        ELSE
 11789           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11790              MOVE ER-2623       TO WS-ERROR
 11791              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11792           ELSE
 11793              MOVE ER-2622       TO WS-ERROR
 11794              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11795
 11796     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11797     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11798     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11799*    MOVE 1                      TO DC-OPTION-CODE.
 11800     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11801     IF DATE-CONVERSION-ERROR
 11802        GO TO 3005-EDIT-CONTINUE
 11803     ELSE
 11804        IF DC-ELAPSED-DAYS GREATER +180
 11805           MOVE ER-2613          TO WS-ERROR
 11806           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11807        ELSE
 11808           IF DC-ELAPSED-DAYS GREATER +90
 11809              MOVE ER-2612       TO WS-ERROR
 11810              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11811           ELSE
 11812             IF DC-ELAPSED-DAYS GREATER +60
 11813                MOVE ER-2614     TO WS-ERROR
 11814                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11815
 11816 3005-EDIT-CONTINUE.
 11817
 11818     IF PB-CANCELLATION
 11819         GO TO 3700-EDIT-CANCEL.
 11820
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 216
* EL050.cbl
 11822******************************************************************
 11823*                  E D I T   I S S U E                           *
 11824******************************************************************
 11825
 11826 3020-EDIT-ISSUE.
 11827
 11828      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11829      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11830      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11831      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11832      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11833
 11834     IF PB-ISSUE-FORCE
 11835        OR PB-ISSUE-DATE-FORCED
 11836        OR PB-FORCE-OFF
 11837        OR PB-OVERCHARGE-FORCE
 11838        or pb-exceeded-limit-forced
 11839        CONTINUE
 11840     ELSE
 11841        MOVE ER-2670             TO WS-ERROR
 11842        PERFORM 9900-ERROR-FORMAT
 11843                                 THRU 9900-EXIT
 11844     END-IF
 11845     .
 11846 3022-SET-POLICY-STATUS.
 11847
 11848     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11849
 11850     IF (PB-REISSUED-CERT)
 11851             OR
 11852        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11853         AND (PB-MONTHLY-CERT))
 11854         MOVE '5'                TO PB-I-ENTRY-STATUS
 11855         MOVE 'E'                TO PB-BATCH-ENTRY
 11856     END-IF
 11857
 11858     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11859        IF PB-MONTHLY-CERT
 11860           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11861        END-IF
 11862        IF PB-CASH-CERT
 11863           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11864        END-IF
 11865     END-IF
 11866     IF PB-POLICY-IS-DECLINED
 11867         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11868     IF PB-POLICY-IS-VOIDED
 11869         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11870     IF PB-NEEDS-UNDERWRITING
 11871         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11872     IF PB-REIN-ONLY-CERT
 11873         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11874     IF PB-PREM-ACCTNG-ONLY
 11875         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11876
 11877     MOVE SPACE                  TO PB-I-OB-FLAG.
 11878
 11879     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 217
* EL050.cbl
 11880         MOVE ER-2665            TO WS-ERROR
 11881         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11882         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11883
 11884     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11885        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11886           MOVE 'Z'             TO PB-I-OB-FLAG.
 11887
 11888     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11889        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11890           MOVE 'Z'             TO PB-I-OB-FLAG.
 11891
 11892     IF ACCOUNT-MAST-FOUND
 11893         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11894         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11895         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11896         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11897         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11898         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11899         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11900     END-IF
 11901
 11902     IF ACCOUNT-MAST-FOUND
 11903        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11904         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11905
 11906     IF (ACCOUNT-MAST-FOUND)
 11907*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11908        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11909        IF PB-REISSUED-CERT
 11910           CONTINUE
 11911        ELSE
 11912           MOVE ER-2608          TO WS-ERROR
 11913           PERFORM 9900-ERROR-FORMAT
 11914                                 THRU 9900-EXIT
 11915         END-IF
 11916     END-IF
 11917
 11918     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11919        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11920        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11921
 11922**********   DMD CUSTOM CODE FOLLOWS  **********
 11923 3024-EDIT-DMD-FIELDS.
 11924     IF PB-COMPANY-ID NOT = 'DMD'
 11925        GO TO 3025-EDIT-REINSURANCE.
 11926
 11927*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11928*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11929*** ERROR IF THEY ARE NOT EQUAL.
 11930
 11931     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11932     SET BIN-TO-GREG               TO TRUE.
 11933     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11934     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11935**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11936
 11937     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 218
* EL050.cbl
 11938     SET BIN-TO-GREG               TO TRUE.
 11939     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11940     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11941**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11942
 11943     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11944        MOVE ER-8116               TO WS-ERROR
 11945        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11946
 11947     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11948
 11949     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11950                                      WK-FULL-CERT-NO.
 11951     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11952
 11953     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11954
 11955     IF PB-VALID-LIFE
 11956        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11957     ELSE
 11958        IF PB-VALID-AH
 11959          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11960
 11961
 11962     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11963     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11964     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11965                                      DCUA-UNDRWRTR-CODE
 11966                                      DCUA-UNDRWRTR-GROUP-CODE
 11967                                      DCUA-RETURN-CODE.
 11968
 11969****************************************************************
 11970*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11971***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11972***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11973***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11974***   TO THIS RECORD.                                        ***
 11975****************************************************************
 11976     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11977     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11978     IF DCUA-SUCCESSFUL-PROCESS
 11979        GO TO 3024-EDIT-DL7-CONT.
 11980
 11981     IF DCUA-RETURN-CODE EQUAL '01'
 11982        MOVE ER-8110               TO WS-ERROR
 11983        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11984        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11985        GO TO 3024-EDIT-DL7-CONT.
 11986
 11987     IF DCUA-RETURN-CODE EQUAL '02'
 11988        MOVE ER-8111               TO WS-ERROR
 11989        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11990        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11991        GO TO 3024-EDIT-DL7-CONT.
 11992
 11993     IF DCUA-RETURN-CODE EQUAL '03'
 11994        MOVE ER-8074               TO WS-ERROR
 11995        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 219
* EL050.cbl
 11996        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11997        GO TO 3024-EDIT-DL7-CONT.
 11998
 11999     IF DCUA-RETURN-CODE EQUAL '04'
 12000        MOVE ER-8075               TO WS-ERROR
 12001        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12002        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12003        GO TO 3024-EDIT-DL7-CONT.
 12004
 12005     IF DCUA-RETURN-CODE EQUAL '05'
 12006        MOVE ER-8076               TO WS-ERROR
 12007        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12008        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12009        GO TO 3024-EDIT-DL7-CONT.
 12010
 12011     IF DCUA-RETURN-CODE EQUAL '06'
 12012        MOVE ER-8077               TO WS-ERROR
 12013        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12014        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12015        GO TO 3024-EDIT-DL7-CONT.
 12016
 12017     IF DCUA-RETURN-CODE EQUAL '07'
 12018        MOVE ER-8078               TO WS-ERROR
 12019        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12020        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12021        GO TO 3024-EDIT-DL7-CONT.
 12022
 12023     IF DCUA-RETURN-CODE EQUAL 'E1'
 12024        MOVE ER-8079               TO WS-ERROR
 12025        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12026        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12027        GO TO 3024-EDIT-DL7-CONT.
 12028
 12029     IF DCUA-RETURN-CODE EQUAL 'E2'
 12030        MOVE ER-8080               TO WS-ERROR
 12031        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12032        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12033        GO TO 3024-EDIT-DL7-CONT.
 12034
 12035     IF DCUA-RETURN-CODE EQUAL 'E3'
 12036        MOVE ER-8098               TO WS-ERROR
 12037        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12038        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12039        GO TO 3024-EDIT-DL7-CONT.
 12040
 12041     IF DCUA-RETURN-CODE EQUAL 'C1'
 12042        MOVE ER-8099               TO WS-ERROR
 12043        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12044        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12045        GO TO 3024-EDIT-DL7-CONT.
 12046
 12047     IF DCUA-RETURN-CODE EQUAL 'U1'
 12048        MOVE ER-8109               TO WS-ERROR
 12049        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12050        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12051        GO TO 3024-EDIT-DL7-CONT.
 12052
 12053     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 220
* EL050.cbl
 12054        MOVE ER-8112               TO WS-ERROR
 12055        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12056        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12057        GO TO 3024-EDIT-DL7-CONT.
 12058
 12059     IF DCUA-RETURN-CODE EQUAL 'N2'
 12060        MOVE ER-8113               TO WS-ERROR
 12061        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12062        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12063        GO TO 3024-EDIT-DL7-CONT.
 12064
 12065     IF DCUA-RETURN-CODE EQUAL 'N3'
 12066        MOVE ER-8114               TO WS-ERROR
 12067        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12068        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12069        GO TO 3024-EDIT-DL7-CONT.
 12070
 12071     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12072     MOVE ER-8097                  TO WS-ERROR.
 12073     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12074     GO TO 3024-EDIT-DL7-CONT.
 12075
 12076 3024-EDIT-DL7-CONT.
 12077
 12078     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12079     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12080     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12081        NEXT SENTENCE
 12082     ELSE
 12083        MOVE ER-9263               TO WS-ERROR
 12084        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12085
 12086******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12087******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12088     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12089        NEXT SENTENCE
 12090     ELSE
 12091        MOVE ER-8039               TO WS-ERROR
 12092        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12093
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 221
* EL050.cbl
 12095****************************************************************
 12096*** VALIDATE STATE  : DLO022                                 ***
 12097****************************************************************
 12098     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12099     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12100
 12101     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12102     IF DVSC-SUCCESSFUL-EDIT
 12103        GO TO 3024-EDIT-DL22-CONT.
 12104
 12105     IF DVSC-RETURN-CODE EQUAL '01'
 12106        MOVE ER-8300               TO WS-ERROR
 12107        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12108        GO TO 3024-EDIT-DL22-CONT.
 12109
 12110     IF DVSC-RETURN-CODE EQUAL '02'
 12111        MOVE ER-8301               TO WS-ERROR
 12112        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12113        GO TO 3024-EDIT-DL22-CONT.
 12114
 12115     IF DVSC-RETURN-CODE EQUAL '03'
 12116        MOVE ER-8302               TO WS-ERROR
 12117        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12118        GO TO 3024-EDIT-DL22-CONT.
 12119
 12120     IF DVSC-RETURN-CODE EQUAL 'N1'
 12121        MOVE ER-8304               TO WS-ERROR
 12122        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12123        GO TO 3024-EDIT-DL22-CONT.
 12124
 12125     MOVE ER-8303                  TO WS-ERROR
 12126     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12127
 12128 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 222
* EL050.cbl
 12130****************************************************************
 12131*** VALIDATE LOAN OFFICER : DLO021                           ***
 12132****************************************************************
 12133
 12134     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12135     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12136     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12137     IF DVLO-SUCCESSFUL-EDIT
 12138        GO TO 3024-EDIT-DL21-CONT.
 12139
 12140     IF DVLO-RETURN-CODE EQUAL '01'
 12141        MOVE ER-8081               TO WS-ERROR
 12142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12143        GO TO 3024-EDIT-DL21-CONT.
 12144
 12145     IF DVLO-RETURN-CODE EQUAL '02'
 12146        MOVE ER-8082               TO WS-ERROR
 12147        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12148        GO TO 3024-EDIT-DL21-CONT.
 12149
 12150     IF DVLO-RETURN-CODE EQUAL '03'
 12151        MOVE ER-8083               TO WS-ERROR
 12152        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12153        GO TO 3024-EDIT-DL21-CONT.
 12154
 12155     IF DVLO-RETURN-CODE EQUAL '04'
 12156        MOVE ER-8084               TO WS-ERROR
 12157        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12158        GO TO 3024-EDIT-DL21-CONT.
 12159
 12160     IF DVLO-RETURN-CODE EQUAL '05'
 12161        MOVE ER-8085               TO WS-ERROR
 12162        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12163        GO TO 3024-EDIT-DL21-CONT.
 12164
 12165     MOVE ER-7825                  TO WS-ERROR
 12166     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12167     GO TO 3024-EDIT-DL21-CONT.
 12168
 12169 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 223
* EL050.cbl
 12171
 12172****************************************************************
 12173*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12174****************************************************************
 12175
 12176     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12177     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12178     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12179     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12180     IF DIPF-SUCCESSFUL-EDIT
 12181        GO TO 3024-EDIT-DL02-CONT.
 12182
 12183     IF DIPF-RETURN-CODE EQUAL '01'
 12184        MOVE ER-8086               TO WS-ERROR
 12185        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12186        GO TO 3024-EDIT-DL02-CONT.
 12187
 12188     IF DIPF-RETURN-CODE EQUAL '02'
 12189        MOVE ER-8087               TO WS-ERROR
 12190        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12191        GO TO 3024-EDIT-DL02-CONT.
 12192
 12193     IF DIPF-RETURN-CODE EQUAL '03'
 12194        MOVE ER-8088               TO WS-ERROR
 12195        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12196        GO TO 3024-EDIT-DL02-CONT.
 12197
 12198     MOVE ER-8095                  TO WS-ERROR
 12199     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12200     GO TO 3024-EDIT-DL02-CONT.
 12201
 12202 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 224
* EL050.cbl
 12204
 12205****************************************************************
 12206*** VALIDATE BANK ID : DLO003                                ***
 12207****************************************************************
 12208
 12209     MOVE WK-GREG-CENT           TO WCG-CENT.
 12210     MOVE WK-GREG-YYMM           TO WCG-REST.
 12211     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12212        MOVE ER-8040               TO WS-ERROR
 12213        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12214
 12215     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12216     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12217     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12218     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12219     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12220     IF DVBI-SUCCESSFUL-EDIT
 12221        GO TO 3024-EDIT-DL03-CONT.
 12222
 12223     IF DVBI-RETURN-CODE EQUAL '01'
 12224        MOVE ER-8089               TO WS-ERROR
 12225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12226        GO TO 3024-EDIT-DL03-CONT.
 12227
 12228     IF DVBI-RETURN-CODE EQUAL '02'
 12229        MOVE ER-8090               TO WS-ERROR
 12230        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12231        GO TO 3024-EDIT-DL03-CONT.
 12232
 12233     IF DVBI-RETURN-CODE EQUAL '03'
 12234        MOVE ER-8091               TO WS-ERROR
 12235        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12236        GO TO 3024-EDIT-DL03-CONT.
 12237
 12238     IF DVBI-RETURN-CODE EQUAL '04'
 12239        MOVE ER-8092               TO WS-ERROR
 12240        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12241        GO TO 3024-EDIT-DL03-CONT.
 12242
 12243     IF DVBI-RETURN-CODE EQUAL '05'
 12244        MOVE ER-8093               TO WS-ERROR
 12245        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12246        GO TO 3024-EDIT-DL03-CONT.
 12247
 12248     IF DVBI-RETURN-CODE EQUAL '06'
 12249        MOVE ER-8094               TO WS-ERROR
 12250        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12251        GO TO 3024-EDIT-DL03-CONT.
 12252
 12253     MOVE ER-8096                  TO WS-ERROR
 12254     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12255     GO TO 3024-EDIT-DL03-CONT.
 12256
 12257 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 225
* EL050.cbl
 12259
 12260     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12261        NEXT SENTENCE
 12262     ELSE
 12263        MOVE ER-8042               TO WS-ERROR
 12264        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12265
 12266     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12267     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12268     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12269
 12270     IF DMPF-RETURN-CODE = '01'
 12271        MOVE ER-8067               TO WS-ERROR
 12272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12273        GO TO 3024-EDIT-DL01-CONT.
 12274
 12275     IF DMPF-RETURN-CODE = '02'
 12276        MOVE ER-8068               TO WS-ERROR
 12277        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12278        GO TO 3024-EDIT-DL01-CONT.
 12279
 12280     IF DMPF-RETURN-CODE = '03'
 12281        MOVE ER-8069               TO WS-ERROR
 12282        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12283        GO TO 3024-EDIT-DL01-CONT.
 12284
 12285     IF DMPF-RETURN-CODE = 'E1'
 12286        MOVE ER-8070               TO WS-ERROR
 12287        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12288        GO TO 3024-EDIT-DL01-CONT.
 12289
 12290     IF DMPF-RETURN-CODE = 'N1'
 12291        MOVE ER-8071               TO WS-ERROR
 12292        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12293        GO TO 3024-EDIT-DL01-CONT.
 12294
 12295     IF DMPF-RETURN-CODE NOT = 'OK'
 12296        MOVE ER-8072               TO WS-ERROR
 12297        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12298
 12299 3024-EDIT-DL01-CONT.
 12300******************************************************************
 12301***  VALIDATES RATE CODES : DLO017                             ***
 12302******************************************************************
 12303
 12304      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12305      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12306      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12307      IF DVRC-SUCCESSFUL-EDIT
 12308        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12309        GO TO 3024-CHECK-VALID-RATE.
 12310
 12311      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12312
 12313      IF DVRC-RETURN-CODE EQUAL '01'
 12314         MOVE ER-7817                   TO WS-ERROR
 12315         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12316         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 226
* EL050.cbl
 12317
 12318      IF DVRC-RETURN-CODE EQUAL '02'
 12319         MOVE ER-7818                   TO WS-ERROR
 12320         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12321         GO TO 3025-EDIT-REINSURANCE.
 12322
 12323      IF DVRC-RETURN-CODE EQUAL '03'
 12324         MOVE ER-7819                   TO WS-ERROR
 12325         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12326         GO TO 3025-EDIT-REINSURANCE.
 12327
 12328       MOVE ER-7820                     TO WS-ERROR.
 12329       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12330       GO TO 3025-EDIT-REINSURANCE.
 12331
 12332******************************************************************
 12333***  GET PREMIUM RATES : DLO011                                ***
 12334******************************************************************
 12335
 12336 3024-CHECK-VALID-RATE.
 12337
 12338     IF VALID-RATE-CODE
 12339        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12340        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12341        MOVE SPACES                TO DPRB-RETURN-CODE
 12342        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12343     ELSE
 12344         GO TO 3025-EDIT-REINSURANCE.
 12345
 12346      IF DPRB-SUCCESSFUL-PROCESS
 12347         IF PB-VALID-LIFE
 12348             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12349             GO TO 3025-EDIT-REINSURANCE
 12350         ELSE
 12351             IF PB-VALID-AH
 12352                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12353                 GO TO 3025-EDIT-REINSURANCE.
 12354
 12355      IF DPRB-RETURN-CODE EQUAL '01'
 12356         MOVE ER-7812                   TO WS-ERROR
 12357         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12358         GO TO 3025-EDIT-REINSURANCE.
 12359
 12360      IF DPRB-RETURN-CODE EQUAL '02'
 12361         MOVE ER-7813                   TO WS-ERROR
 12362         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12363         GO TO 3025-EDIT-REINSURANCE.
 12364
 12365      IF DPRB-RETURN-CODE EQUAL '03'
 12366         MOVE ER-7814                   TO WS-ERROR
 12367         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12368         GO TO 3025-EDIT-REINSURANCE.
 12369
 12370      IF DPRB-RETURN-CODE EQUAL '04'
 12371         IF NOT DPRB-1ST-TIME
 12372            MOVE ER-7815                   TO WS-ERROR
 12373            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12374            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 227
* EL050.cbl
 12375          ELSE
 12376         IF PB-VALID-LIFE
 12377            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12378          ELSE
 12379            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12380         END-IF
 12381         MOVE SPACES                TO DOCC-RETURN-CODE
 12382         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12383         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12384         IF DOCC-RETURN-CODE = 'OK'
 12385             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12386             GO TO 3024-CHECK-VALID-RATE
 12387           ELSE
 12388             MOVE ER-7823               TO WS-ERROR
 12389             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12390             GO TO 3025-EDIT-REINSURANCE.
 12391
 12392       MOVE ER-7816                     TO WS-ERROR.
 12393       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12394       GO TO 3025-EDIT-REINSURANCE.
 12395
 12396**********   DMD CUSTOM CODE ABOVE    **********
 12397
 12398 3025-EDIT-REINSURANCE.
 12399     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12400         GO TO 3027-EDIT-CONTINUE.
 12401
 12402     MOVE LOW-VALUES               TO ERREIN-KEY.
 12403     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12404     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12405                                      REIN-CODE-2
 12406                                      REIN-CODE-3.
 12407     MOVE 'A'                      TO REIN-TYPE.
 12408
 12409     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12410
 12411     MOVE '3026' TO REIN-SW.
 12412     MOVE ' '                   TO WS-REIN-READ-SW.
 12413
 12414     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12415     IF REIN-TABLE-NOT-FOUND
 12416         GO TO 3026-NO-SPEC-TABLE.
 12417
 12418     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12419     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12420                                   WS-NSP-ST-CD-LF.
 12421     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12422                                   WS-NSP-ST-CD-AH.
 12423
 12424     GO TO 3040-EDIT-CONTINUE.
 12425
 12426 3026-NO-SPEC-TABLE.
 12427
 12428     MOVE ER-2664                TO WS-ERROR.
 12429     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12430     GO TO 3040-EDIT-CONTINUE.
 12431
 12432 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 228
* EL050.cbl
 12433
 12434     IF PB-I-REIN-TABLE = SPACES
 12435       GO TO 3040-EDIT-CONTINUE.
 12436
 12437     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12438          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12439          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12440           GO TO 3040-EDIT-CONTINUE.
 12441
 12442     MOVE LOW-VALUES            TO ERREIN-KEY.
 12443     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12444     MOVE 'A'                   TO REIN-TYPE.
 12445     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12446
 12447     MOVE '3028'                TO REIN-SW.
 12448     MOVE ' '                   TO WS-REIN-READ-SW.
 12449
 12450     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12451     IF REIN-TABLE-NOT-FOUND
 12452         GO TO 3028-NO-REIN-TABLE.
 12453
 12454     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12455     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12456                                   WS-NSP-ST-CD-LF.
 12457     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12458                                   WS-NSP-ST-CD-AH.
 12459
 12460     GO TO 3040-EDIT-CONTINUE.
 12461
 12462 3028-NO-REIN-TABLE.
 12463
 12464     MOVE ER-2615                TO WS-ERROR.
 12465     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12466     GO TO 3040-EDIT-CONTINUE.
 12467
 12468 3040-EDIT-CONTINUE.
 12469
 12470     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12471         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12472
 12473     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12474         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12475
 12476     IF (NOT PB-REISSUED-CERT)
 12477        AND (NOT PB-MONTHLY-CERT)
 12478        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12479            MOVE '001'           TO PB-I-LF-TERM
 12480            MOVE 'M'             TO PB-I-INSURED-SEX.
 12481
 12482     IF (NOT PB-REISSUED-CERT)
 12483        AND (NOT PB-MONTHLY-CERT)
 12484        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12485            MOVE '001'           TO PB-I-AH-TERM
 12486            MOVE 'M'             TO PB-I-INSURED-SEX.
 12487
 12488 3040-EDIT-1ST-PMT-DT.
 12489     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12490     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 229
* EL050.cbl
 12491         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12492
 12493******************************************************************
 12494*                                                                *
 12495*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12496*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12497*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12498*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12499*                                                                *
 12500******************************************************************
 12501
 12502     IF PB-EFF-DT-PROCESSING
 12503        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12504                                    PB-I-LF-EXPIRE-DT
 12505                                    PB-I-AH-EXPIRE-DT
 12506        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12507        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12508        MOVE ZERO                TO DC-ELAPSED-DAYS
 12509        MOVE +1                  TO DC-ELAPSED-MONTHS
 12510        SET BIN-PLUS-ELAPSED     TO TRUE
 12511*       MOVE 6                   TO DC-OPTION-CODE
 12512        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12513        IF NO-CONVERSION-ERROR
 12514           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12515
 12516******************************************************************
 12517*                                                                *
 12518*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12519*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12520*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12521*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12522*                                                                *
 12523******************************************************************
 12524
 12525     IF PB-EXT-DAYS-PROCESSING
 12526          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12527                                         PB-I-LF-EXPIRE-DT
 12528                                         PB-I-AH-EXPIRE-DT
 12529          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12530          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12531          MOVE +1                     TO DC-ELAPSED-MONTHS
 12532          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12533          SET BIN-PLUS-ELAPSED        TO TRUE
 12534*         MOVE 6                      TO DC-OPTION-CODE
 12535          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12536          IF NO-CONVERSION-ERROR
 12537             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12538
 12539******************************************************************
 12540*                                                                *
 12541*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12542*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12543*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12544*        (EXPIRE DATE - (TERM -1))  *  -1.
 12545*                                                                *
 12546******************************************************************
 12547
 12548     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 230
* EL050.cbl
 12549        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12550           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12551              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12552              MOVE PB-I-AH-TERM      TO WS-TERM
 12553           ELSE
 12554              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12555              MOVE PB-I-LF-TERM      TO WS-TERM
 12556        ELSE
 12557           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12558              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12559              MOVE PB-I-LF-TERM      TO WS-TERM
 12560           ELSE
 12561              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12562              MOVE PB-I-AH-TERM      TO WS-TERM.
 12563
 12564     IF PB-EXPIRE-DT-PROCESSING
 12565        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12566        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12567        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12568        MOVE ZERO                TO DC-ELAPSED-DAYS
 12569                                    DC-ODD-DAYS-OVER
 12570          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12571          SET BIN-PLUS-ELAPSED    TO TRUE
 12572*         MOVE 6                  TO DC-OPTION-CODE
 12573          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12574          IF NO-CONVERSION-ERROR
 12575             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12576
 12577******************************************************************
 12578*                                                                *
 12579*            1ST PAYMENT DATE PROCESSING                         *
 12580*                                                                *
 12581******************************************************************
 12582
 12583     IF PB-1ST-PMT-DT-PROCESSING
 12584        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12585                                    PB-I-AH-EXPIRE-DT
 12586        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12587
 12588     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12589         NEXT SENTENCE
 12590     ELSE
 12591         MOVE ER-2680                 TO WS-ERROR
 12592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12593         GO TO 3060-ORIG-TERM-CHECK.
 12594
 12595     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12596     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12597     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12598*    MOVE 1                      TO DC-OPTION-CODE.
 12599     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12600                                    DC-ELAPSED-DAYS
 12601                                    DC-ODD-DAYS-OVER.
 12602
 12603     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12604
 12605     IF DATE-CONVERSION-ERROR
 12606        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 231
* EL050.cbl
 12607
 12608     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12609     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12610        AND (WS-LF-COVERAGE-TYPE = 'L')
 12611        IF (DC-ELAPSED-MONTHS > 1)
 12612                      OR
 12613           ((DC-ELAPSED-MONTHS = 1)
 12614           AND (DC-ODD-DAYS-OVER > 0))
 12615           MOVE ER-2882          TO WS-ERROR
 12616           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12617        END-IF
 12618     END-IF
 12619     if dc-elapsed-months > 0
 12620        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12621        + dc-odd-days-over
 12622     end-if
 12623     IF PB-EXT-DAYS-PROCESSING
 12624        CONTINUE
 12625     ELSE
 12626        IF DC-ELAPSED-MONTHS = +0
 12627           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12628        ELSE
 12629           IF (WS-LF-EARNINGS-CALC = '4')
 12630              AND (DC-ELAPSED-MONTHS > ZERO)
 12631              AND (DC-ELAPSED-DAYS > ZERO)
 12632              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12633           ELSE
 12634              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12635                                 THRU 6499-EXIT
 12636              MOVE WS-ODD-DAYS-OVER
 12637                                 TO PB-I-EXTENTION-DAYS
 12638           END-IF
 12639        END-IF
 12640     END-IF
 12641******************************************************************
 12642*                                                                *
 12643*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12644*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12645*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12646*            AND ANY ODD DAYS.                                   *
 12647*                                                                *
 12648******************************************************************
 12649
 12650     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12651                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12652     IF WS-LF-EARNINGS-CALC NOT = '4'
 12653        IF DC-ELAPSED-DAYS > ZEROS
 12654           MOVE ER-2681          TO WS-ERROR
 12655           PERFORM 9900-ERROR-FORMAT
 12656                                 THRU 9900-EXIT
 12657        END-IF
 12658     END-IF
 12659
 12660     IF WS-LF-EARNINGS-CALC NOT = '4'
 12661        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12662           MOVE ER-2681          TO WS-ERROR
 12663           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12664
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 232
* EL050.cbl
 12665     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12666        (PB-I-LF-TERM NOT = ZERO) AND
 12667         NOT NO-LIFE-COVERAGE
 12668          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12669          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12670          IF WS-LF-EARNINGS-CALC = '4'
 12671             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12672             PB-I-PAY-FREQUENCY
 12673          END-IF
 12674          MOVE ZERO              TO DC-ELAPSED-DAYS
 12675                                    DC-ODD-DAYS-OVER
 12676          MOVE 1                 TO DC-END-OF-MONTH
 12677          SET BIN-PLUS-ELAPSED        TO TRUE
 12678*         MOVE 6                 TO DC-OPTION-CODE
 12679          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12680          IF NO-CONVERSION-ERROR
 12681             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12682             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12683                (WS-LF-SPECIAL-CALC-CD = 'L')
 12684                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12685                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12686                  MOVE +1             TO DC-ELAPSED-MONTHS
 12687                  SET BIN-PLUS-ELAPSED  TO TRUE
 12688*                 MOVE 6              TO DC-OPTION-CODE
 12689                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12690                  IF NO-CONVERSION-ERROR
 12691                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12692
 12693* okay, i had to move the new att age edit down here because the
 12694* expiration date could get recalculated and i need the exp date
 12695     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12696        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12697        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12698        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12699           AND ZEROS
 12700           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12701           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12702           SET ELAPSED-BETWEEN-BIN TO TRUE
 12703           PERFORM 8500-DATE-CONVERT
 12704                                 THRU 8500-EXIT
 12705           IF NO-CONVERSION-ERROR
 12706              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12707                 MOVE ER-2669       TO WS-ERROR
 12708*                PERFORM 9900-ERROR-FORMAT
 12709*                                THRU 9900-EXIT
 12710              END-IF
 12711           END-IF
 12712        ELSE
 12713           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12714           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12715              MOVE ER-2669       TO WS-ERROR
 12716*             PERFORM 9900-ERROR-FORMAT
 12717*                                THRU 9900-EXIT
 12718           ELSE
 12719              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12720                 MOVE ER-1570    TO WS-ERROR
 12721                 PERFORM 9900-ERROR-FORMAT
 12722                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 233
* EL050.cbl
 12723              END-IF
 12724           END-IF
 12725        END-IF
 12726        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12727           AND ZEROS
 12728           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12729           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12730           SET ELAPSED-BETWEEN-BIN TO TRUE
 12731           PERFORM 8500-DATE-CONVERT
 12732                                 THRU 8500-EXIT
 12733           IF NO-CONVERSION-ERROR
 12734              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12735                 MOVE ER-2669       TO WS-ERROR
 12736*                PERFORM 9900-ERROR-FORMAT
 12737*                                THRU 9900-EXIT
 12738              END-IF
 12739           END-IF
 12740        ELSE
 12741           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12742             (PB-I-LF-TERM / 12)
 12743           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12744              MOVE ER-2669       TO WS-ERROR
 12745*             PERFORM 9900-ERROR-FORMAT
 12746*                                THRU 9900-EXIT
 12747           ELSE
 12748              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12749                 MOVE ER-1571    TO WS-ERROR
 12750                 PERFORM 9900-ERROR-FORMAT
 12751                                 THRU 9900-EXIT
 12752              END-IF
 12753           END-IF
 12754        END-IF
 12755        IF WS-ERROR = ER-2669
 12756           PERFORM 9900-ERROR-FORMAT
 12757                                 THRU 9900-EXIT
 12758        END-IF
 12759     END-IF
 12760     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12761        (PB-I-AH-TERM NOT = ZERO) AND
 12762         NOT NO-AH-COVERAGE
 12763          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12764             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12765             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12766             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12767          ELSE
 12768             IF WS-LF-EARNINGS-CALC = '4'
 12769                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12770                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12771                PB-I-PAY-FREQUENCY
 12772             ELSE
 12773                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12774                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12775             END-IF
 12776          END-IF
 12777          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12778                                         DC-ODD-DAYS-OVER
 12779          MOVE 1                      TO DC-END-OF-MONTH
 12780          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 234
* EL050.cbl
 12781*         MOVE 6                      TO DC-OPTION-CODE
 12782          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12783          IF NO-CONVERSION-ERROR
 12784             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12785     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12786        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12787        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12788        IF PB-I-BIRTHDAY > LOW-VALUES
 12789           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12790           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12791           SET ELAPSED-BETWEEN-BIN TO TRUE
 12792           PERFORM 8500-DATE-CONVERT
 12793                                 THRU 8500-EXIT
 12794           IF NO-CONVERSION-ERROR
 12795              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12796                 MOVE ER-3054       TO WS-ERROR
 12797*                PERFORM 9900-ERROR-FORMAT
 12798*                                THRU 9900-EXIT
 12799              END-IF
 12800           END-IF
 12801        ELSE
 12802           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12803           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12804              MOVE ER-3054       TO WS-ERROR
 12805*             PERFORM 9900-ERROR-FORMAT
 12806*                                THRU 9900-EXIT
 12807           END-IF
 12808        END-IF
 12809        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12810           AND ZEROS
 12811           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12812           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12813           SET ELAPSED-BETWEEN-BIN TO TRUE
 12814           PERFORM 8500-DATE-CONVERT
 12815                                 THRU 8500-EXIT
 12816           IF NO-CONVERSION-ERROR
 12817              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12818                 MOVE ER-3054       TO WS-ERROR
 12819*                PERFORM 9900-ERROR-FORMAT
 12820*                                THRU 9900-EXIT
 12821              END-IF
 12822           END-IF
 12823        ELSE
 12824           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12825             (PB-I-AH-TERM / 12)
 12826           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12827              MOVE ER-3054       TO WS-ERROR
 12828*             PERFORM 9900-ERROR-FORMAT
 12829*                                THRU 9900-EXIT
 12830           END-IF
 12831        END-IF
 12832        IF WS-ERROR = ER-3054
 12833           PERFORM 9900-ERROR-FORMAT
 12834                                 THRU 9900-EXIT
 12835        END-IF
 12836     END-IF
 12837     MOVE SPACE                       TO DC-END-OF-MONTH.
 12838
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 235
* EL050.cbl
 12839     IF PB-COMPANY-ID = 'NCB'
 12840        GO TO 3040-EDIT-EXTENSION-DAYS.
 12841
 12842     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12843       AND
 12844        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12845        NEXT SENTENCE
 12846     ELSE
 12847        GO TO 3040-EDIT-EXTENSION-DAYS.
 12848
 12849     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12850        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12851        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12852     ELSE
 12853        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12854        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12855
 12856     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12857*    MOVE '1'      TO DC-OPTION-CODE
 12858     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12859     IF (NO-CONVERSION-ERROR)
 12860        AND (DC-ELAPSED-MONTHS > +1)
 12861        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12862        MOVE ER-2668   TO WS-ERROR
 12863        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12864
 12865 3040-EDIT-EXTENSION-DAYS.
 12866
 12867     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12868        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12869         GO TO 3050-EDIT-TERM-IN-DAYS
 12870     ELSE
 12871         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12872
 12873     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12874         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12875     ELSE
 12876        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12877           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12878           MOVE ER-2681         TO WS-ERROR
 12879           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12880
 12881     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12882        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12883        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12884         GO TO 3060-ORIG-TERM-CHECK.
 12885
 12886     GO TO 3060-ORIG-TERM-CHECK.
 12887
 12888 3050-EDIT-TERM-IN-DAYS.
 12889
 12890     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12891
 12892     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12893         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12894     ELSE
 12895         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12896            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 236
* EL050.cbl
 12897            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12898
 12899     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12900                                       REMAINDER WS-WORK-TERM.
 12901     IF WS-WORK-TERM GREATER THAN ZERO
 12902         ADD +1 TO PB-I-LF-TERM.
 12903
 12904     IF NOT NO-AH-COVERAGE
 12905         MOVE ER-2684            TO WS-ERROR
 12906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12907
 12908
 12909 3060-ORIG-TERM-CHECK.
 12910
 12911******************************************************************
 12912*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12913******************************************************************
 12914
 12915     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12916        NEXT SENTENCE
 12917     ELSE
 12918        IF NOT NO-LIFE-COVERAGE
 12919           IF PB-I-LF-TERM NUMERIC
 12920              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12921              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12922              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12923                  NEXT SENTENCE
 12924           ELSE
 12925              MOVE ER-2647       TO WS-ERROR
 12926              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12927
 12928     IF NOT NO-AH-COVERAGE
 12929         IF PB-I-AH-TERM NUMERIC
 12930            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12931            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12932            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12933             NEXT SENTENCE
 12934          ELSE
 12935              MOVE ER-2658       TO WS-ERROR
 12936              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12937
 12938     IF PB-COMPANY-ID = 'NCB'
 12939        GO TO 3070-LOAN-TERM-CHECK.
 12940
 12941     IF POLICY-HAS-AH
 12942       AND
 12943        POLICY-HAS-LIFE
 12944       AND
 12945        PB-I-LF-TERM NUMERIC
 12946       AND
 12947        PB-I-AH-TERM NUMERIC
 12948        NEXT SENTENCE
 12949     ELSE
 12950        GO TO 3070-LOAN-TERM-CHECK.
 12951
 12952     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12953     IF WS-TEX-FACT-2 LESS THAN +0
 12954        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 237
* EL050.cbl
 12955
 12956     IF WS-TEX-FACT-2 GREATER THAN +1
 12957        MOVE ER-2668             TO WS-ERROR
 12958        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12959
 12960 3070-LOAN-TERM-CHECK.
 12961
 12962     IF (WS-LF-BENEFIT-CD = ZERO)
 12963         OR (NO-LF-BENEFIT-MATCH)
 12964            GO TO 3125-EDIT-PMT-FREQ.
 12965*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12966*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12967*          AND 'V' AND 'W' AND 'X'
 12968*          GO TO 3125-EDIT-PMT-FREQ
 12969*       END-IF
 12970*    ELSE
 12971*       IF WS-AH-DCC-TRUNC = 'T'
 12972*          CONTINUE
 12973*       ELSE
 12974*          GO TO 3125-EDIT-PMT-FREQ
 12975*       END-IF
 12976*    END-IF
 12977     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12978                    OR
 12979        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12980        AND (WS-AH-DCC-TRUNC = 'T'))
 12981        CONTINUE
 12982     ELSE
 12983        GO TO 3125-EDIT-PMT-FREQ
 12984     END-IF
 12985     IF PB-I-LOAN-TERM NOT NUMERIC
 12986         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12987
 12988     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12989        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12990*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12991        PB-I-LOAN-TERM NOT GREATER THAN +360
 12992         NEXT SENTENCE
 12993     ELSE
 12994         MOVE ER-2648            TO WS-ERROR
 12995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12996
 12997     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12998        MOVE ER-3058             TO WS-ERROR
 12999        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13000     end-if
 13001
 13002     IF WS-STATE-ABBREVIATION = 'NC'
 13003        IF PB-I-LOAN-TERM > +59
 13004           CONTINUE
 13005        ELSE
 13006           MOVE ER-2792          TO WS-ERROR
 13007           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13008        END-IF
 13009     END-IF
 13010
 13011     .
 13012 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 238
* EL050.cbl
 13013     IF (WS-LF-BENEFIT-CD = ZERO)
 13014         OR (NO-LF-BENEFIT-MATCH)
 13015         or (pb-state = 'AL')
 13016            GO TO 3127-EDIT-LOAN-OFFICER.
 13017     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 13018                    OR
 13019        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 13020        AND (WS-AH-DCC-TRUNC = 'T'))
 13021                    OR
 13022         (PB-COMPANY-ID = 'AHL')
 13023        CONTINUE
 13024     ELSE
 13025        IF (PB-I-LOAN-TERM > ZEROS)
 13026           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 13027           MOVE ER-1575          TO WS-ERROR
 13028           PERFORM 9900-ERROR-FORMAT
 13029                                 THRU 9900-EXIT
 13030        END-IF
 13031     END-IF
 13032     IF WS-LF-EARNINGS-CALC NOT = '4'
 13033         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 13034            MOVE ER-2653         TO WS-ERROR
 13035            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13036            GO TO 3127-EDIT-LOAN-OFFICER
 13037         ELSE
 13038            GO TO 3127-EDIT-LOAN-OFFICER.
 13039
 13040     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 13041         MOVE ER-2655            TO WS-ERROR
 13042         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13043         GO TO 3127-EDIT-LOAN-OFFICER.
 13044
 13045     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 13046         MOVE ER-2654            TO WS-ERROR
 13047         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13048         GO TO 3127-EDIT-LOAN-OFFICER.
 13049
 13050     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 13051         GIVING WS-TEX-FACT-2
 13052             REMAINDER WS-TEX-FACT-3.
 13053
 13054*    IF WS-TEX-FACT-3 NOT = ZERO
 13055*       MOVE ER-2654             TO WS-ERROR
 13056*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13057
 13058
 13059 3127-EDIT-LOAN-OFFICER.
 13060
 13061     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13062        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13063           MOVE ER-2690          TO WS-ERROR
 13064           PERFORM 9900-ERROR-FORMAT
 13065                                 THRU 9900-EXIT
 13066        ELSE
 13067           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13068           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13069           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13070           MOVE PB-SV-STATE      TO LOFC-STATE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 239
* EL050.cbl
 13071           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 13072           MOVE PB-I-LOAN-OFFICER
 13073                                 TO LOFC-CODE
 13074           PERFORM 8586-READ-LOAN-OFFICER
 13075                                 THRU 8586-EXIT
 13076           IF (NOT LOFC-MASTER-FOUND)
 13077              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13078              MOVE ER-3006       TO WS-ERROR
 13079              PERFORM 9900-ERROR-FORMAT
 13080                                 THRU 9900-EXIT
 13081           END-IF
 13082        END-IF
 13083     END-IF
 13084     .
 13085 3129-EDIT-APR.
 13086
 13087     IF (WS-LF-BENEFIT-CD = ZERO)
 13088        OR (NO-LF-BENEFIT-MATCH)
 13089        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13090           GO TO 3130-EDIT-AGE
 13091*       ELSE
 13092*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13093*             GO TO 3130-EDIT-AGE
 13094*          END-IF
 13095        END-IF
 13096     END-IF
 13097
 13098     IF (WS-STATE-ABBREVIATION = 'OH')
 13099         AND (PB-I-RATE-CLASS NOT = 'L ')
 13100         AND (PB-I-LF-TERM GREATER THAN 60)
 13101         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13102         GO TO 3129-APR-CONT.
 13103
 13104     IF (WS-STATE-ABBREVIATION = 'RI')
 13105         AND (PB-I-LF-TERM GREATER THAN 60)
 13106         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13107         GO TO 3129-APR-CONT.
 13108
 13109     IF (WS-STATE-ABBREVIATION = 'UT')
 13110         AND (PB-I-LF-TERM GREATER THAN 62)
 13111         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13112         AND (PB-CERT-EFF-DT LESS WS-830901)
 13113         GO TO 3129-APR-CONT.
 13114
 13115     IF PB-COMPANY-ID = 'LAP'
 13116        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13117           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13118              MOVE ER-2656         TO WS-ERROR
 13119              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13120              GO TO 3130-EDIT-AGE.
 13121
 13122     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13123        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13124        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13125        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13126        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13127        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13128         GO TO 3130-EDIT-AGE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 240
* EL050.cbl
 13129
 13130 3129-APR-CONT.
 13131     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13132         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13133         GO TO 3130-EDIT-AGE.
 13134
 13135     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13136         WS-AH-BENEFIT-CD (1:1) = 'S')
 13137        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13138        AND (PB-I-LOAN-APR = ZERO)
 13139        MOVE ER-2657             TO WS-ERROR
 13140        PERFORM 9900-ERROR-FORMAT
 13141                                 THRU 9900-EXIT
 13142        GO TO 3130-EDIT-AGE
 13143     END-IF
 13144*    IF PB-I-LOAN-APR = ZERO
 13145*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13146*    END-IF
 13147
 13148     if pb-i-loan-apr = +99.9999
 13149        move er-2656             to ws-error
 13150        PERFORM 9900-ERROR-FORMAT
 13151                                 THRU 9900-EXIT
 13152        GO TO 3130-EDIT-AGE
 13153     end-if
 13154*    IF PB-I-LOAN-APR = ZERO
 13155*       MOVE ER-2656             TO WS-ERROR
 13156*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13157*       GO TO 3130-EDIT-AGE.
 13158
 13159*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13160     if pb-i-loan-apr not = +99.9999
 13161        IF PB-I-LOAN-APR > +30.000
 13162           MOVE ER-2657          TO WS-ERROR
 13163           PERFORM 9900-ERROR-FORMAT
 13164                                 THRU 9900-EXIT
 13165        end-if
 13166     end-if
 13167     .
 13168 3130-EDIT-AGE.
 13169
 13170******************************************************************
 13171*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13172******************************************************************
 13173
 13174     IF NOT NO-LIFE-COVERAGE
 13175        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13176           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13177               MOVE ER-2628             TO WS-ERROR
 13178               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13179
 13180     IF NOT NO-AH-COVERAGE
 13181        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13182           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13183               MOVE ER-2628         TO WS-ERROR
 13184               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13185
 13186 3133-SEX-CODE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 241
* EL050.cbl
 13187     IF PB-I-INSURED-SEX = SPACE OR ZERO
 13188         IF WS-DEFAULT-SEX = 'M'
 13189             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13190          ELSE
 13191             IF WS-DEFAULT-SEX = 'F'
 13192             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13193
 13194     IF PB-I-INSURED-SEX = '1'
 13195         MOVE 'M' TO PB-I-INSURED-SEX.
 13196
 13197     IF PB-I-INSURED-SEX = '2'
 13198         MOVE 'F' TO PB-I-INSURED-SEX.
 13199
 13200 3134-SIG-SW-EDIT.
 13201     IF PB-I-SIG-SW = SPACE
 13202         MOVE 'N'                TO  PB-I-SIG-SW.
 13203
 13204     IF PB-COMPANY-ID = 'NCL'
 13205         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13206             NEXT SENTENCE
 13207         ELSE
 13208             MOVE ER-1923        TO  WS-ERROR
 13209             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13210     ELSE
 13211     IF PB-COMPANY-ID = 'CRI'
 13212         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13213             NEXT SENTENCE
 13214         ELSE
 13215             MOVE ER-2606        TO  WS-ERROR
 13216             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13217     ELSE
 13218     IF PB-COMPANY-ID = 'TMS'
 13219         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13220             NEXT SENTENCE
 13221         ELSE
 13222             MOVE ER-2689        TO  WS-ERROR
 13223             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13224     ELSE
 13225         IF PB-I-SIG-SW = 'Y' OR 'N'
 13226             NEXT SENTENCE
 13227         ELSE
 13228             MOVE ER-2651        TO  WS-ERROR
 13229             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13230
 13231     IF PB-COMPANY-ID = 'FLA'
 13232         IF (WS-EDIT-AGE GREATER 54  OR
 13233             WS-AH-EDIT-AGE GREATER 54)  AND
 13234            PB-I-SIG-SW = 'N'
 13235            MOVE ER-2651         TO  WS-ERROR
 13236            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13237
 13238 3135-NAME-EDIT.
 13239
 13240     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13241        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13242        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13243           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13244                                 TO PB-I-JOINT-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 242
* EL050.cbl
 13245        END-PERFORM
 13246     END-IF
 13247     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13248        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13249        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13250           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13251                                 TO PB-I-JOINT-LAST-NAME
 13252        END-PERFORM
 13253     END-IF
 13254     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13255        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13256        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13257           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13258                                 TO PB-I-INSURED-FIRST-NAME
 13259        END-PERFORM
 13260     END-IF
 13261     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13262        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13263        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13264           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13265                                 TO PB-I-INSURED-LAST-NAME
 13266        END-PERFORM
 13267     END-IF
 13268     IF PB-I-INSURED-LAST-NAME = SPACES
 13269       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13270       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13271           MOVE ER-2660    TO WS-ERROR
 13272           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13273
 13274 3136-EDIT-SEX.
 13275
 13276******************************************************************
 13277*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13278******************************************************************
 13279
 13280     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13281        (WS-AH-SPECIAL-CALC-CD = 'O')
 13282        NEXT SENTENCE
 13283     ELSE
 13284        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13285           NEXT SENTENCE
 13286        ELSE
 13287           MOVE ER-2629            TO WS-ERROR
 13288           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13289
 13290 3137-EDIT-EFF-DATE.
 13291
 13292     IF PB-REISSUED-CERT       OR
 13293        PB-POLICY-IS-DECLINED  OR
 13294        PB-POLICY-IS-VOIDED
 13295         GO TO 3139-EDIT-COVERAGE-CODES.
 13296
 13297     MOVE SPACE                  TO WS-2671-SW
 13298                                    WS-2672-SW.
 13299
 13300     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13301         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13302             MOVE ER-2703        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 243
* EL050.cbl
 13303             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13304             GO TO 3139-EDIT-COVERAGE-CODES.
 13305
 13306     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13307         GO TO 3139-EDIT-COVERAGE-CODES.
 13308
 13309     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13310     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13311*    MOVE '1'                    TO DC-OPTION-CODE.
 13312     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13313     MOVE +0                     TO DC-ELAPSED-MONTHS
 13314                                    DC-ELAPSED-DAYS.
 13315     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13316
 13317     IF DATE-CONVERSION-ERROR
 13318         GO TO 3139-EDIT-COVERAGE-CODES.
 13319
 13320     IF DC-ELAPSED-DAYS GREATER +180
 13321         MOVE ER-2672            TO WS-ERROR
 13322         MOVE 'Y'                TO WS-2672-SW
 13323         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13324     END-IF
 13325
 13326     IF WS-ERROR = ER-2671  AND
 13327        PB-COMPANY-ID  = 'LBL'
 13328        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13329        MOVE SPACE               TO WS-2671-SW
 13330        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13331
 13332     IF PB-ISSUE-DATE-FORCED  AND
 13333      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13334         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13335         MOVE ER-2673            TO WS-ERROR
 13336         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13337         MOVE SPACE              TO WS-2671-SW
 13338                                    WS-2672-SW.
 13339
 13340     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13341         IF PB-ISSUE-DATE-FORCED
 13342             MOVE ER-2600          TO  WS-ERROR
 13343             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13344         ELSE
 13345             MOVE ER-2692          TO  WS-ERROR
 13346             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13347
 13348
 13349 3139-EDIT-COVERAGE-CODES.
 13350
 13351     if pb-company-id not = 'AHL'
 13352        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13353           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13354           MOVE ER-2787          TO WS-ERROR
 13355           PERFORM 9900-ERROR-FORMAT
 13356                                 THRU 9900-EXIT
 13357        END-IF
 13358     end-if
 13359     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13360        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 244
* EL050.cbl
 13361                                 > 250000.00
 13362           MOVE ER-2719          TO WS-ERROR
 13363           PERFORM 9900-ERROR-FORMAT
 13364                                 THRU 9900-EXIT
 13365        END-IF
 13366     END-IF
 13367
 13368     IF PB-POLICY-IS-DECLINED  OR
 13369        PB-POLICY-IS-VOIDED
 13370         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13371
 13372     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13373        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13374         MOVE ER-2630                TO WS-ERROR
 13375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13376
 13377     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13378        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13379        PB-I-LF-PREMIUM-AMT = ZERO
 13380         GO TO 3140-CHECK-AH-FOR-ZERO.
 13381
 13382     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13383        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13384        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13385         GO TO 3140-CHECK-AH-FOR-ZERO.
 13386
 13387     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13388        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13389        MOVE ER-2631             TO WS-ERROR
 13390        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13391     END-IF
 13392
 13393
 13394******************************************************************
 13395*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13396******************************************************************
 13397
 13398     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13399        NEXT SENTENCE
 13400     ELSE
 13401        IF PB-I-LF-BENEFIT-AMT = ZERO
 13402           MOVE ER-2632             TO WS-ERROR
 13403           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13404
 13405
 13406******************************************************************
 13407*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13408******************************************************************
 13409
 13410     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13411        CONTINUE
 13412     ELSE
 13413        IF PB-I-LF-PREMIUM-AMT = ZERO
 13414           IF (NOT PB-COMP-LF-PREM)
 13415              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13416              and (ws-lf-ben-category not = 'C')
 13417              MOVE ER-2633       TO WS-ERROR
 13418              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 245
* EL050.cbl
 13419           END-IF
 13420        END-IF
 13421     END-IF
 13422     .
 13423 3140-CHECK-AH-FOR-ZERO.
 13424
 13425     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13426        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13427        PB-I-AH-PREMIUM-AMT = ZERO
 13428         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13429
 13430     IF PB-COMPANY-ID = 'CSL'  AND
 13431        PB-I-AH-BENEFIT-CD = ZERO  AND
 13432        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13433        PB-I-AH-PREMIUM-AMT = ZERO
 13434         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13435
 13436     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13437        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13438        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13439         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13440
 13441     IF PB-I-AH-BENEFIT-CD = ZERO
 13442         MOVE ER-2634            TO WS-ERROR
 13443         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13444
 13445******************************************************************
 13446*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13447******************************************************************
 13448
 13449     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13450        NEXT SENTENCE
 13451     ELSE
 13452        IF PB-I-AH-BENEFIT-AMT = ZERO
 13453           MOVE ER-2635             TO WS-ERROR
 13454           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13455
 13456******************************************************************
 13457*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13458******************************************************************
 13459
 13460     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13461        NEXT SENTENCE
 13462     ELSE
 13463        IF PB-I-AH-PREMIUM-AMT = ZERO
 13464            IF NOT PB-COMP-AH-PREM
 13465                MOVE ER-2636    TO WS-ERROR
 13466                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13467
 13468
 13469 3140-EDIT-MAX-AMT-SIZES.
 13470* CUSTOM CODE FOR CLIENT    'DMD'
 13471     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13472                                     WS-RES-MUNI-TAX
 13473                                     PB-I-STATE-TAX
 13474                                     PB-I-MUNI-TAX.
 13475
 13476     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 246
* EL050.cbl
 13477
 13478     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13479        GO TO 3150-RATE-OUTSTAND-BAL.
 13480
 13481     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13482        GO TO 3150-RATE-OUTSTAND-BAL.
 13483
 13484     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13485        GO TO 3150-RATE-OUTSTAND-BAL.
 13486
 13487     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13488                             OR 'RIC')
 13489        GO TO 3150-RATE-OUTSTAND-BAL.
 13490
 13491     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13492        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13493            GO TO 3150-RATE-OUTSTAND-BAL
 13494        ELSE
 13495           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13496               GO TO 3150-RATE-OUTSTAND-BAL.
 13497
 13498     IF NOT PB-NO-MONTHS-SKIPPED
 13499        GO TO 3150-RATE-OUTSTAND-BAL.
 13500
 13501     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13502        GO TO 3150-RATE-OUTSTAND-BAL.
 13503
 13504     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13505        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13506           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13507             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13508           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13509           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13510              MOVE ER-2693     TO WS-ERROR
 13511              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13512              GO TO 3150-RATE-OUTSTAND-BAL
 13513           ELSE
 13514              GO TO 3150-RATE-OUTSTAND-BAL.
 13515
 13516 3150-RATE-OUTSTAND-BAL.
 13517
 13518* DMD RATING TEST
 13519     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13520         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13521         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13522         MOVE ER-2687                 TO WS-ERROR
 13523         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13524         MOVE 'B'                     TO PB-I-OB-FLAG
 13525         GO TO 3260-EDIT-CONTINUE.
 13526
 13527     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13528         IF  WS-ERROR    EQUAL    ER-2693
 13529             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13530                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13531                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13532                 MOVE  +0            TO  WS-ERROR.
 13533
 13534     IF  PB-COMPANY-ID   EQUAL    'CDL'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 247
* EL050.cbl
 13535         IF  WS-ERROR    EQUAL    ER-2693
 13536             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13537                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13538                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13539                 MOVE  +0            TO  WS-ERROR.
 13540
 13541     IF PLAN-MASTER-AH-SW = 'Y'
 13542        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13543            IF  WS-ERROR    EQUAL    ER-2693
 13544              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13545                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13546                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13547                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13548                 MOVE  ER-1910           TO  WS-ERROR
 13549                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13550
 13551     IF PLAN-MASTER-AH-SW = 'Y'
 13552        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13553            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13554               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13555               MOVE  ER-1910           TO  WS-ERROR
 13556               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13557
 13558     IF PLAN-MASTER-AH-SW = 'Y'
 13559        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13560            IF  WS-ERROR    EQUAL    ER-2693
 13561                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13562                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13563                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13564                 MOVE  +0       TO  WS-ERROR.
 13565
 13566     IF WS-ERROR = ER-2693
 13567        IF PB-COMPANY-ID = 'JAL' AND
 13568           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13569           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13570           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13571
 13572     IF WS-ERROR = ER-2693
 13573        IF PB-COMPANY-ID = 'NCL'  AND
 13574           PB-I-AH-BENEFIT-CD = 'OA'
 13575           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13576           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13577
 13578     IF WS-ERROR = ER-2693
 13579        IF PB-COMPANY-ID = 'CNL' AND
 13580           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13581           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13582           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13583
 13584     IF WS-ERROR = ER-2693
 13585        IF PB-COMPANY-ID = 'HER'
 13586           IF WS-LEVEL
 13587              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13588              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13589
 13590     IF ((LF-BENEFIT-FOUND) AND
 13591         (NOT NO-LIFE-COVERAGE)  AND
 13592         (WS-LF-SPECIAL-CALC-CD = 'O'))
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 248
* EL050.cbl
 13593       OR   ((AH-BENEFIT-FOUND) AND
 13594             (NOT NO-AH-COVERAGE)    AND
 13595             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13596         NEXT SENTENCE
 13597     ELSE
 13598         GO TO 3215-EDIT-RATES.
 13599
 13600     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13601        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13602           MOVE ER-2674          TO WS-ERROR
 13603           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13604           GO TO 3215-EDIT-RATES.
 13605
 13606     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13607        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13608           MOVE ER-2674          TO WS-ERROR
 13609           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13610           GO TO 3215-EDIT-RATES.
 13611
 13612     MOVE 'B'                    TO PB-I-OB-FLAG.
 13613
 13614     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13615         NEXT SENTENCE
 13616     ELSE
 13617         IF NOT NO-LIFE-COVERAGE
 13618             IF WS-ACCT-LF-OB-RT = ZERO
 13619                MOVE ER-2641    TO WS-ERROR
 13620                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13621
 13622     IF PB-COMPANY-ID = 'CRI'
 13623       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13624         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13625         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13626         IF WS-ERROR = ER-2675
 13627            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13628            MOVE ER-2687              TO WS-ERROR
 13629            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13630         ELSE
 13631            MOVE ER-2687              TO WS-ERROR
 13632            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13633
 13634
 13635     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13636         NEXT SENTENCE
 13637     ELSE
 13638       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13639            NEXT SENTENCE
 13640       ELSE
 13641         IF NOT NO-AH-COVERAGE
 13642             IF WS-ACCT-AH-OB-RT = ZERO
 13643                MOVE ER-2642    TO WS-ERROR
 13644                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13645
 13646     IF PB-COMPANY-ID = 'CRI'
 13647       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13648         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13649         IF WS-ERROR = ER-2676
 13650            SUBTRACT +1               FROM PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 249
* EL050.cbl
 13651            MOVE ER-2687              TO WS-ERROR
 13652            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13653         ELSE
 13654            MOVE ER-2687              TO WS-ERROR
 13655            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13656
 13657     IF PB-COMPANY-ID NOT = 'GIC'
 13658         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13659            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13660     ELSE
 13661         IF PB-I-LF-PREM-CALC = ZEROS
 13662             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13663                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13664
 13665     IF PB-COMPANY-ID NOT = 'GIC'
 13666         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13667            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13668     ELSE
 13669         IF PB-I-AH-PREM-CALC = ZEROS
 13670             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13671                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13672
 13673     MOVE ZEROS TO PB-I-MORT-CODE.
 13674
 13675     GO TO 3260-EDIT-CONTINUE.
 13676
 13677
 13678 3215-EDIT-RATES.
 13679     IF ACCOUNT-MAST-FOUND
 13680         NEXT SENTENCE
 13681     ELSE
 13682         GO TO 3999-END-EDIT.
 13683
 13684 3220-CHECK-LF-RATES.
 13685
 13686     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13687        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13688        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13689        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13690           AND (NOT WS-LF-CASH))
 13691                           OR
 13692           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13693           AND (NOT WS-AH-CASH)))
 13694                       AND
 13695           (PB-I-ENTRY-STATUS NOT = '5')
 13696           MOVE 'M'              TO PB-BATCH-ENTRY
 13697                                    PB-I-ENTRY-STATUS
 13698        END-IF
 13699     END-IF
 13700     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13701                                    PB-I-AH-PREM-CALC
 13702                                    PB-I-LF-ALT-PREM-CALC
 13703                                    PB-I-LF-ALT-RATE
 13704                                    PB-I-LF-REI-RATE
 13705                                    PB-I-LF-ALT-REI-RATE
 13706                                    PB-I-AH-REI-RATE
 13707                                    PB-I-TOT-FEES-CALC.
 13708
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 250
* EL050.cbl
 13709     IF PB-COMPANY-ID EQUAL 'DMD'
 13710        NEXT SENTENCE
 13711     ELSE
 13712        MOVE ZEROS               TO PB-I-LF-RATE
 13713                                    PB-I-AH-RATE.
 13714
 13715     IF PB-I-TOT-FEES NOT NUMERIC
 13716        MOVE ZEROS               TO PB-I-TOT-FEES
 13717     END-IF
 13718     IF PB-I-LIVES NOT NUMERIC
 13719         MOVE ZERO               TO PB-I-LIVES.
 13720
 13721     IF PB-I-NUM-BILLED NOT NUMERIC
 13722         MOVE ZERO               TO PB-I-NUM-BILLED.
 13723
 13724     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13725        MOVE +0                  TO PB-I-LF-PREM-TAX
 13726     END-IF
 13727
 13728     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13729        MOVE +0                  TO PB-I-AH-PREM-TAX
 13730     END-IF
 13731
 13732     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13733        PB-I-PAY-FREQUENCY = ZEROS
 13734            MOVE 12 TO CP-PAY-FREQUENCY
 13735     ELSE
 13736            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13737
 13738     IF PB-I-STATE-TAX NOT NUMERIC
 13739         MOVE ZEROS               TO PB-I-STATE-TAX.
 13740
 13741     IF PB-I-MUNI-TAX NOT NUMERIC
 13742         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13743
 13744     MOVE SPACES                 TO CP-BEN-CATEGORY
 13745     IF PB-COMPANY-ID  = 'CSL'  AND
 13746        PB-I-LF-TERM NOT = ZERO
 13747        COMPUTE WS-PAYMENT-AMT =
 13748             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13749        COMPUTE WS-CSL-AMT1 =
 13750             PB-I-LF-TERM * AM-MAX-MON-BEN
 13751        COMPUTE WS-CSL-AMT2 =
 13752             WS-PAYMENT-AMT * PB-I-LF-TERM
 13753        IF CP-PAY-FREQUENCY NOT = 12
 13754           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13755           MOVE '8' TO WS-CSL-CALC-CD
 13756        ELSE
 13757           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13758              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13759               AM-MAX-TOT-BEN
 13760               MOVE '6' TO WS-CSL-CALC-CD
 13761           ELSE
 13762              IF (WS-CSL-AMT1  GREATER THAN
 13763                 AM-MAX-TOT-BEN) AND
 13764                 (WS-CSL-AMT2  GREATER THAN
 13765                 AM-MAX-TOT-BEN)
 13766                 MOVE '7' TO WS-CSL-CALC-CD
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 251
* EL050.cbl
 13767              ELSE
 13768                 MOVE '5' TO WS-CSL-CALC-CD.
 13769
 13770     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13771         NEXT SENTENCE
 13772     ELSE
 13773         GO TO 3300-CHECK-AH-RATES.
 13774
 13775*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13776
 13777     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13778        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13779              OR
 13780           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13781           MOVE ER-2618          TO WS-ERROR
 13782           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13783           GO TO 3300-CHECK-AH-RATES.
 13784
 13785     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13786           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13787                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13788
 13789     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13790         MOVE ER-2687             TO WS-ERROR
 13791         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13792         MOVE 'Z000'              TO PB-I-MORT-CODE
 13793         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13794         GO TO 3300-CHECK-AH-RATES.
 13795
 13796     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13797        IF PB-I-LIVES = ZERO
 13798           MOVE ER-2688          TO WS-ERROR
 13799           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13800
 13801     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13802
 13803     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13804     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13805     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13806     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13807     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13808     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13809     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13810     MOVE '3'                    TO CP-PROCESS-TYPE.
 13811     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13812     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13813
 13814******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13815     IF PB-COMPANY-ID EQUAL 'CDL'
 13816         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13817            CP-EARN-AS-NET-PAY)
 13818             IF PB-CERT-EFF-DT GREATER  WS-931231
 13819                 MOVE '1'        TO CP-EARNING-METHOD.
 13820*******
 13821
 13822     MOVE PB-SV-STATE            TO CP-STATE.
 13823     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13824     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 252
* EL050.cbl
 13825     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13826     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13827     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13828                                    CP-RATING-BENEFIT-AMT.
 13829     IF CP-STATE-STD-ABBRV = 'OR'
 13830         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13831                                         PB-I-LF-ALT-BENEFIT-AMT.
 13832     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13833     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13834     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13835     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13836     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13837     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13838     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13839     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13840     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13841                                    CP-REMAINING-TERM
 13842                                    CP-LOAN-TERM.
 13843
 13844     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13845         NEXT SENTENCE
 13846     ELSE
 13847         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13848             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13849                                           PB-I-LF-PREMIUM-AMT.
 13850
 13851     IF PB-COMPANY-ID EQUAL 'CSL'
 13852        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13853           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13854                                         PB-I-LF-PREMIUM-AMT.
 13855
 13856     IF PB-COMPANY-ID EQUAL 'NCB'
 13857         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13858            CP-EARN-AS-NET-PAY
 13859             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13860                 PB-I-LF-PREMIUM-AMT.
 13861
 13862     IF (CP-TRUNCATED-LIFE)
 13863        or ((pb-company-id = 'AHL')
 13864           and (pb-i-loan-term > pb-i-lf-term))
 13865        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13866
 13867     IF PB-COMPANY-ID EQUAL 'CRI'
 13868        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13869
 13870     IF CP-TERM-IS-DAYS
 13871         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13872     ELSE
 13873         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13874     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13875        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13876        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13877        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13878        IF WS-LF-BEN-CATEGORY = 'D'
 13879           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13880           MOVE PB-I-LIFE-COMMISSION
 13881                                 TO CP-DCC-ACT-COMM
 13882           MOVE WS-LF-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 253
* EL050.cbl
 13883                                 TO CP-BEN-CATEGORY
 13884        END-IF
 13885        IF (CP-BENEFIT-CD (1:1) = 'P')
 13886           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13887           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13888           add pb-i-ah-premium-amt to cp-original-premium
 13889        END-IF
 13890     END-IF
 13891     IF PB-COMPANY-ID = 'CSL'
 13892         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13893         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13894         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13895
 13896     IF PB-COMPANY-ID = 'CSL'
 13897        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13898
 13899     IF (CP-SPECIAL-CALC-CD = 'H')
 13900        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13901         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13902                                    TO CP-ALTERNATE-BENEFIT
 13903         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13904     if (pb-company-id = 'CID')
 13905        and (ws-lf-earnings-calc = '4')
 13906        and (cp-state-std-abbrv = 'MN' OR 'WA' or 'AL')
 13907        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13908        move pb-i-term-type      to cp-pmt-mode
 13909        move pb-i-no-of-payments to cp-no-of-pmts
 13910        move pb-i-ah-benefit-amt to cp-monthly-payment
 13911     end-if
 13912     move ws-net-only-state      to cp-net-only-state
 13913     IF (PB-COMPANY-ID = 'CID')
 13914        AND (WS-LF-EARNINGS-CALC = 'B')
 13915        AND (CP-STATE-STD-ABBRV = 'MN')
 13916        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13917                                 TO CP-ALTERNATE-BENEFIT
 13918        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13919     END-IF
 13920     IF (PB-COMPANY-ID = 'CID')
 13921        AND (WS-LF-EARNINGS-CALC = 'B')
 13922        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13923                                 TO CP-ALTERNATE-BENEFIT
 13924        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13925        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13926*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13927*         pb-i-lf-alt-premium-amt
 13928        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13929        IF WS-LF-BEN-CATEGORY = 'P'
 13930           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13931        ELSE
 13932           IF WS-LF-BEN-CATEGORY = 'I'
 13933              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13934           END-IF
 13935        END-IF
 13936     END-IF
 13937     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13938     MOVE 'R'                   TO CP-RATE-FILE.
 13939     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13940
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 254
* EL050.cbl
 13941     IF CP-ERROR-RATE-NOT-FOUND
 13942        MOVE ER-2641            TO WS-ERROR
 13943        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13944        GO TO 3300-CHECK-AH-RATES.
 13945
 13946     IF PB-COMPANY-ID EQUAL 'CRI'
 13947        IF CP-ERROR-NO-LIMITS-CRI
 13948           IF NOT ACCOUNT-LIFE-CHECKED
 13949              MOVE ER-2607      TO WS-ERROR
 13950              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13951
 13952******************************************************************
 13953*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13954*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13955******************************************************************
 13956
 13957* CALC LIFE AGE AT EXPIRATION.
 13958
 13959     COMPUTE WS-AGE-AT-EXPIRE =
 13960          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13961
 13962*    IF PB-STATE = 'CO' OR 'UT'
 13963*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13964*        MOVE 'F'            TO PB-FATAL-FLAG
 13965*        MOVE ER-2709        TO WS-ERROR
 13966*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13967*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13968
 13969*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13970*        MOVE 'X'            TO PB-FATAL-FLAG
 13971*        MOVE ER-2718        TO WS-ERROR
 13972*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13973*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13974
 13975* CALC A & H AGE AT EXPIRATION.
 13976
 13977     COMPUTE WS-AGE-AT-EXPIRE =
 13978          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13979
 13980*    IF PB-STATE = 'CO' OR 'UT'
 13981*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13982*        MOVE 'F'            TO PB-FATAL-FLAG
 13983*        MOVE ER-2709        TO WS-ERROR
 13984*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13985*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13986
 13987*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13988*        MOVE 'X'            TO PB-FATAL-FLAG
 13989*        MOVE ER-2718        TO WS-ERROR
 13990*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13991*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13992
 13993     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13994        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13995
 13996     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13997        and (not pb-monthly-cert)
 13998        GO TO 3221-CHECK-ERROR-RATE-OPEN
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 255
* EL050.cbl
 13999     end-if
 14000
 14001     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14002        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 14003
 14004     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14005         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 14006         MOVE ER-2639        TO WS-ERROR
 14007         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14008
 14009
 14010******************************************************************
 14011*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14012******************************************************************
 14013
 14014 PREMIUM-EDITING-IS-BYPASSED.
 14015     IF (CP-R-MAX-ATT-AGE NUMERIC)
 14016        AND (CP-R-MAX-ATT-AGE > +0)
 14017        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 14018        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14019           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14020           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14021           MOVE '1'              TO DC-OPTION-CODE
 14022           PERFORM 8500-DATE-CONVERT
 14023                                 THRU 8500-EXIT
 14024           IF NO-CONVERSION-ERROR
 14025              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14026                 MOVE ER-2661       TO WS-ERROR
 14027*                PERFORM 9900-ERROR-FORMAT
 14028*                                THRU 9900-EXIT
 14029              END-IF
 14030           END-IF
 14031        ELSE
 14032           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14033           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14034              MOVE ER-2661       TO WS-ERROR
 14035*             PERFORM 9900-ERROR-FORMAT
 14036*                                THRU 9900-EXIT
 14037           ELSE
 14038              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14039                 MOVE ER-1570    TO WS-ERROR
 14040                 PERFORM 9900-ERROR-FORMAT
 14041                                 THRU 9900-EXIT
 14042              END-IF
 14043           END-IF
 14044        END-IF
 14045        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14046           MOVE PB-I-JOINT-BIRTHDAY
 14047                                 TO DC-BIN-DATE-1
 14048           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14049           MOVE '1'              TO DC-OPTION-CODE
 14050           PERFORM 8500-DATE-CONVERT
 14051                                 THRU 8500-EXIT
 14052           IF NO-CONVERSION-ERROR
 14053              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14054                 MOVE ER-2661       TO WS-ERROR
 14055*                PERFORM 9900-ERROR-FORMAT
 14056*                                THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 256
* EL050.cbl
 14057              END-IF
 14058           ELSE
 14059              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 14060           END-IF
 14061        ELSE
 14062           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14063             (PB-I-LF-TERM / 12)
 14064           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14065              MOVE ER-2661       TO WS-ERROR
 14066*             PERFORM 9900-ERROR-FORMAT
 14067*                                THRU 9900-EXIT
 14068           ELSE
 14069              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14070                 MOVE ER-1571    TO WS-ERROR
 14071                 PERFORM 9900-ERROR-FORMAT
 14072                                 THRU 9900-EXIT
 14073              END-IF
 14074           END-IF
 14075        END-IF
 14076        IF WS-ERROR = ER-2661
 14077           PERFORM 9900-ERROR-FORMAT
 14078                                 THRU 9900-EXIT
 14079        END-IF
 14080     END-IF
 14081*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14082*       MOVE ER-2661             TO WS-ERROR
 14083*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14084
 14085     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14086        MOVE ER-2662             TO WS-ERROR
 14087        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14088
 14089     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14090        MOVE ER-2677             TO WS-ERROR
 14091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14092
 14093     IF CP-ERROR-LOAN-TERM
 14094        MOVE ER-2648             TO WS-ERROR
 14095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14096
 14097 3221-CHECK-ERROR-RATE-OPEN.
 14098
 14099     IF CP-ERROR-RATE-FILE-NOTOPEN
 14100         GO TO 3990-FILES-NOT-OPEN.
 14101
 14102     IF PB-COMPANY-ID NOT = 'DMD'
 14103        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14104     END-IF
 14105     .
 14106 3221-CONTINUE.
 14107     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14108                                    WS-DCC-AH-RATE
 14109     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14110        IF WS-LF-BEN-CATEGORY = 'D'
 14111           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14112              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14113        END-IF
 14114     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 257
* EL050.cbl
 14115     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14116*   X'A4FF' = 12/31/2009
 14117     IF (PB-COMPANY-ID = 'CID')
 14118        AND (WS-LF-EARNINGS-CALC = 'B')
 14119        AND (CP-STATE-STD-ABBRV = 'MN')
 14120        AND (PB-CERT-EFF-DT > X'A4FF')
 14121        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14122     END-IF
 14123     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14124
 14125     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14126     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14127        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14128        AND (PB-I-POLICY-IS-MONTHLY)
 14129        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14130        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14131     END-IF
 14132     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14133     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14134     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14135     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14136     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14137        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14138        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14139        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14140        MOVE ER-2786             TO WS-ERROR
 14141        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14142     END-IF
 14143
 14144     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14145
 14146******************************************************************
 14147*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14148******************************************************************
 14149     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14150        and ((not pb-monthly-cert)
 14151        or (ws-lf-ben-category = 'C'))
 14152        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14153
 14154     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14155        GO TO 3225-CHECK-ALT-LIFE-RATE
 14156     ELSE
 14157       IF PB-I-LF-RATE = ZERO
 14158          MOVE ER-2641          TO WS-ERROR
 14159          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14160
 14161 3225-CHECK-ALT-LIFE-RATE.
 14162
 14163     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14164        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14165        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14166         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14167
 14168     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14169         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14170             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14171                   OR
 14172              (PB-I-LF-ALT-PREMIUM-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 258
* EL050.cbl
 14173              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14174              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14175             MOVE ER-2720        TO  WS-ERROR
 14176             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14177             GO TO 3225-RATING-CONT
 14178         ELSE
 14179             GO TO 3225-RATING-CONT.
 14180     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14181        AND (AM-GPCD = 01 OR 06 OR 15)
 14182        MOVE ER-2798             TO WS-ERROR
 14183        PERFORM 9900-ERROR-FORMAT
 14184                                 THRU 9900-EXIT
 14185*       GO TO 3225-RATING-CONT
 14186     END-IF
 14187     if (pb-company-id = 'CID')
 14188        and (ws-lf-earnings-calc = 'B')
 14189        and (ws-lf-ben-category = 'P' or 'I')
 14190        and (ws-net-only-state = 'Y')
 14191        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14192*       display ' balloon prem ' pb-i-lf-alt-prem-calc
 14193        go to 3225-rating-cont
 14194     end-if
 14195     IF (PB-COMPANY-ID = 'CID')
 14196        AND (WS-LF-EARNINGS-CALC = 'B')
 14197        AND (CP-STATE-STD-ABBRV = 'MN')
 14198        AND (PB-CERT-EFF-DT > X'A4FF')
 14199        GO TO 3225-RATING-CONT
 14200     END-IF
 14201     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14202        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14203           AND (PB-I-POLICY-IS-MONTHLY)
 14204           GO TO 3225-RATING-CONT
 14205        END-IF
 14206     END-IF
 14207
 14208     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14209        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14210        CP-EARN-AS-REG-BALLOON
 14211        NEXT SENTENCE
 14212     ELSE
 14213        MOVE '2'                 TO CP-EARNING-METHOD.
 14214
 14215 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14216
 14217     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14218
 14219     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14220        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14221        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14222         NEXT SENTENCE
 14223     ELSE
 14224         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14225
 14226     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14227     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14228     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14229                                     CP-RATING-BENEFIT-AMT.
 14230     IF CP-STATE-STD-ABBRV = 'OR'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 259
* EL050.cbl
 14231         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14232                                         PB-I-LF-ALT-BENEFIT-AMT.
 14233     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14234        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14235     END-IF
 14236     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14237     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14238     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14239                                    CP-REMAINING-TERM
 14240                                    CP-LOAN-TERM.
 14241     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14242        ADD +1                   TO CP-ORIGINAL-TERM
 14243                                    CP-REMAINING-TERM
 14244                                    CP-LOAN-TERM.
 14245
 14246     MOVE 'R'                   TO CP-RATE-FILE.
 14247     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14248
 14249     IF CP-ERROR-RATE-NOT-FOUND
 14250         MOVE ER-2641            TO WS-ERROR
 14251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14252         GO TO 3300-CHECK-AH-RATES.
 14253
 14254     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14255     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14256
 14257     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14258         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14259
 14260     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14261                               + PB-I-LF-ALT-BENEFIT-AMT.
 14262
 14263     IF ACCOUNT-LIFE-CHECKED  OR
 14264        PB-POLICY-IS-VOIDED   OR
 14265        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14266        and (not pb-monthly-cert))
 14267        GO TO 3225-CONTINUE.
 14268
 14269     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14270        GO TO 3225-CONTINUE.
 14271
 14272     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14273                             EC-RT-LF-MAX-TOT-BEN
 14274        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14275        MOVE ER-2639       TO WS-ERROR
 14276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14277
 14278 3225-CONTINUE.
 14279     IF PB-I-LF-ALT-RATE = ZERO
 14280         MOVE ER-2659            TO WS-ERROR
 14281         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14282
 14283     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14284        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14285        MOVE ER-2698             TO WS-ERROR
 14286        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14287
 14288 3225-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 260
* EL050.cbl
 14289
 14290     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14291        and (not pb-monthly-cert)
 14292         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14293         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14294         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14295            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14296            CONTINUE
 14297         ELSE
 14298            MOVE ER-2687         TO WS-ERROR
 14299            PERFORM 9900-ERROR-FORMAT
 14300                                 THRU 9900-EXIT
 14301         END-IF
 14302         GO TO 3290-EDIT-LF-REIN-RATE
 14303     END-IF
 14304
 14305* DMD RATING TEST
 14306     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14307         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14308         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14309         MOVE ER-2687                 TO WS-ERROR
 14310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14311         GO TO 3290-EDIT-LF-REIN-RATE.
 14312
 14313 3230-CLIENT-MORT-CD-SPECIALS.
 14314
 14315     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14316     SET BIN-TO-GREG          TO TRUE.
 14317*    MOVE ' '                 TO DC-OPTION-CODE.
 14318     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14319     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14320
 14321 C-POS-3230-MORT-CD.
 14322     IF PB-COMPANY-ID = 'POS' AND
 14323        PB-SV-CARRIER = '2'
 14324         NEXT SENTENCE
 14325     ELSE
 14326         GO TO C-POS-3240-MORT-CD.
 14327
 14328     IF PB-SV-GROUPING = '030'
 14329        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14330         MOVE '2350' TO PB-I-MORT-CODE
 14331      ELSE
 14332         MOVE '3300' TO PB-I-MORT-CODE.
 14333
 14334
 14335 C-POS-3240-MORT-CD.
 14336     IF PB-COMPANY-ID = 'POS' AND
 14337        PB-SV-CARRIER = '1'
 14338         NEXT SENTENCE
 14339     ELSE
 14340         GO TO 3230-CONTINUE.
 14341
 14342     IF PB-SV-STATE = '45' OR '47'
 14343        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14344         MOVE '5200' TO PB-I-MORT-CODE
 14345     ELSE
 14346         MOVE '8300' TO PB-I-MORT-CODE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 261
* EL050.cbl
 14347
 14348 3230-CONTINUE.
 14349
 14350     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14351        GO TO 3240-CONTINUE
 14352     END-IF
 14353
 14354     IF PB-CERT-EFF-DT > WS-971231
 14355        GO TO 3240-CONTINUE
 14356     END-IF
 14357
 14358     IF LF-BENEFIT-FOUND AND
 14359        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14360         MOVE 'F250'       TO PB-I-MORT-CODE
 14361     ELSE
 14362         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14363             MOVE '7250'   TO PB-I-MORT-CODE
 14364         ELSE
 14365             MOVE '4251'   TO PB-I-MORT-CODE
 14366         END-IF
 14367     END-IF
 14368
 14369     .
 14370 3240-CONTINUE.
 14371
 14372     IF PB-COMPANY-ID NOT = 'GNL'
 14373         GO TO 3256-CONTINUE.
 14374
 14375     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14376         MOVE 'A300' TO PB-I-MORT-CODE
 14377     ELSE
 14378         MOVE '8350' TO PB-I-MORT-CODE.
 14379
 14380 3256-CONTINUE.
 14381     IF PB-COMPANY-ID NOT = 'ABL'
 14382         GO TO 3260-EDIT-CONTINUE.
 14383
 14384     IF PB-I-LF-TERM GREATER THAN 59
 14385         MOVE 'F550' TO PB-I-MORT-CODE
 14386     ELSE
 14387         MOVE 'E550' TO PB-I-MORT-CODE.
 14388
 14389 3260-EDIT-CONTINUE.
 14390     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14391
 14392 3290-EDIT-LF-REIN-RATE.
 14393     IF LF-REIN-NSP-NOT-USED
 14394         GO TO 3290-RATING-CONT.
 14395
 14396     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14397        GO TO 3290-RATING-CONT.
 14398     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14399     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14400     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14401     MOVE '3'                   TO CP-PROCESS-TYPE.
 14402     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14403
 14404******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 262
* EL050.cbl
 14405     IF PB-COMPANY-ID EQUAL 'CDL'
 14406         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14407            CP-EARN-AS-NET-PAY)
 14408             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14409*            MOVE SPACE          TO DC-OPTION-CODE
 14410             SET BIN-TO-GREG     TO TRUE
 14411             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14412***  Y2K PROJ 7744
 14413             IF DC-GREG-DATE-CYMD GREATER 19931231
 14414                 MOVE '1'        TO CP-EARNING-METHOD.
 14415***  Y2K PROJ 7744
 14416*******
 14417
 14418     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14419     MOVE PB-SV-STATE           TO CP-STATE.
 14420     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14421     MOVE ZERO                  TO CP-DEVIATION-CODE
 14422                                   CP-RATE-DEV-PCT.
 14423     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14424     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14425                                   CP-RATING-BENEFIT-AMT.
 14426
 14427************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14428     IF PB-COMPANY-ID EQUAL 'NCB'
 14429         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14430            CP-EARN-AS-NET-PAY
 14431             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14432                 PB-I-LF-PREMIUM-AMT.
 14433************
 14434
 14435     IF CP-STATE-STD-ABBRV = 'OR'
 14436         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14437                                         PB-I-LF-ALT-BENEFIT-AMT.
 14438     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14439     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14440     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14441     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14442     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14443     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14444     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14445     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14446                                   CP-REMAINING-TERM
 14447                                   CP-LOAN-TERM.
 14448     IF CP-TRUNCATED-LIFE
 14449        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14450
 14451     IF CP-TERM-IS-DAYS
 14452         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14453     ELSE
 14454         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14455
 14456     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14457        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14458     END-IF
 14459     IF PB-COMPANY-ID NOT = 'TIC'
 14460          MOVE ZERO          TO CP-CLASS-CODE.
 14461
 14462     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 263
* EL050.cbl
 14463
 14464     MOVE 'R'                   TO CP-RATE-FILE.
 14465     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14466
 14467     IF CP-ERROR-RATE-NOT-FOUND
 14468        IF PB-I-OB
 14469           MOVE ER-2625      TO WS-ERROR
 14470           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14471           GO TO 3299-EDIT-CONTINUE
 14472        ELSE
 14473           MOVE ER-2643      TO WS-ERROR
 14474           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14475           GO TO 3299-EDIT-CONTINUE.
 14476
 14477     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14478
 14479     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14480     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14481
 14482     IF PB-I-LF-REI-RATE = ZERO
 14483         MOVE ER-2643        TO WS-ERROR
 14484         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14485
 14486 3290-CHECK-ALT-REIN-RATE.
 14487
 14488     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14489        GO TO 3290-RATING-CONT.
 14490
 14491     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14492     MOVE '2'                    TO CP-EARNING-METHOD.
 14493     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14494     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14495     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14496     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14497                                     CP-RATING-BENEFIT-AMT.
 14498     IF CP-STATE-STD-ABBRV = 'OR'
 14499         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14500                                         PB-I-LF-ALT-BENEFIT-AMT.
 14501     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14502        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14503     END-IF
 14504     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14505     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14506     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14507                                    CP-REMAINING-TERM
 14508                                    CP-LOAN-TERM.
 14509     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14510        ADD +1                   TO CP-ORIGINAL-TERM
 14511                                    CP-REMAINING-TERM
 14512                                    CP-LOAN-TERM.
 14513
 14514     MOVE 'R'                   TO CP-RATE-FILE.
 14515     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14516
 14517     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14518
 14519     IF PB-I-LF-ALT-REI-RATE = ZERO
 14520         MOVE ER-2643            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 264
* EL050.cbl
 14521         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14522
 14523 3290-RATING-CONT.
 14524
 14525     IF PB-I-OB
 14526*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14527        GO TO 3300-CHECK-AH-RATES.
 14528
 14529 3299-EDIT-CONTINUE.
 14530
 14531     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14532         NEXT SENTENCE
 14533     ELSE
 14534         MOVE ER-2620           TO WS-ERROR
 14535         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14536
 14537 3300-CHECK-AH-RATES.
 14538     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14539         NEXT SENTENCE
 14540     ELSE
 14541         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14542
 14543     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14544        and (not pb-monthly-cert))
 14545                  or
 14546        ((CF-COMPANY-ID = 'DMD') AND
 14547                (NO-DMD-RATING))
 14548         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14549            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14550            CONTINUE
 14551         ELSE
 14552            MOVE ER-2687         TO WS-ERROR
 14553            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14554         END-IF
 14555         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14556         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14557     END-IF
 14558
 14559     IF PB-I-OB
 14560        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14561
 14562     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14563         MOVE ER-2687             TO WS-ERROR
 14564         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14565         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14566         GO TO 3999-END-EDIT.
 14567
 14568*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14569     if pb-company-id = 'AHL'
 14570        go to 3300-skip-crit-per
 14571     end-if
 14572     if (pb-i-ah-crit-per not = zeros)
 14573        and (ws-ah-special-calc-cd not = 'C')
 14574        MOVE ER-1572             TO WS-ERROR
 14575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14576        go to 3300-skip-crit-per
 14577     END-IF
 14578     if (pb-company-id = 'DCC' or 'VPP')
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 265
* EL050.cbl
 14579        and (am-dcc-product-code not = spaces)
 14580        go to 3300-skip-crit-per
 14581     end-if
 14582     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14583        IF PB-I-AH-CRIT-PER = ZERO
 14584           move ws-ah-max-bens   to pb-i-ah-crit-per
 14585*          MOVE ER-2618       TO WS-ERROR
 14586*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14587*          GO TO 3999-END-EDIT
 14588        END-IF
 14589     END-IF
 14590     if (ws-ah-special-calc-cd = 'C')
 14591        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14592        MOVE ER-1576             TO WS-ERROR
 14593        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14594     end-if
 14595
 14596     .
 14597 3300-skip-crit-per.
 14598     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14599     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14600     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14601     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14602     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14603     MOVE PB-SV-STATE            TO CP-STATE.
 14604     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14605     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14606     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14607*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14608     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14609     MOVE '3'                    TO CP-PROCESS-TYPE.
 14610     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14611     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14612                                    CP-RATING-BENEFIT-AMT.
 14613     IF PB-COMPANY-ID = 'CID'
 14614               OR
 14615        CP-STATE-STD-ABBRV = 'OR'
 14616         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14617                                         PB-I-AH-TERM.
 14618     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14619        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14620           AND (PB-I-POLICY-IS-MONTHLY)
 14621           MOVE PB-I-LF-BENEFIT-AMT
 14622                                 TO CP-NET-BENEFIT-AMT
 14623           move pb-i-ah-premium-amt to cp-original-premium
 14624           add pb-i-lf-premium-amt to cp-original-premium
 14625        END-IF
 14626     END-IF
 14627     MOVE SPACES                 TO CP-BEN-CATEGORY
 14628     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14629        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14630        EVALUATE TRUE
 14631           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14632              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14633              MOVE PB-I-LF-BENEFIT-AMT
 14634                                 TO CP-RATING-BENEFIT-AMT
 14635              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14636           WHEN WS-AH-BEN-CATEGORY = 'G'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 266
* EL050.cbl
 14637              MOVE PB-I-UNPAID-CASH-PRICE
 14638                                 TO CP-RATING-BENEFIT-AMT
 14639           WHEN WS-AH-BEN-CATEGORY = 'D'
 14640              MOVE WS-AH-PMF-COMM
 14641                                 TO CP-DCC-PMF-COMM
 14642              MOVE PB-I-AH-COMMISSION
 14643                                 TO CP-DCC-ACT-COMM
 14644        END-EVALUATE
 14645     END-IF
 14646     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14647     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14648     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14649     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14650     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14651     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14652     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14653                                    CP-REMAINING-TERM
 14654                                    WS-WORK-TERM.
 14655     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14656
 14657     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14658     SET BIN-TO-GREG             TO TRUE.
 14659*    MOVE ' '                    TO DC-OPTION-CODE.
 14660     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14661     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE
 14662
 14663     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14664     IF NOT VALID-SKIP-CODE
 14665         MOVE ER-2683            TO WS-ERROR
 14666         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14667         GO TO 3320-RATE-CONTINUE.
 14668
 14669     IF PB-NO-MONTHS-SKIPPED
 14670         GO TO 3320-RATE-CONTINUE.
 14671
 14672     MOVE SPACE TO NUMBER-OF-MONTHS.
 14673
 14674     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14675         MOVE 'S'                TO SK-MO (6).
 14676     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14677         MOVE 'S'                TO SK-MO (7).
 14678     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14679         MOVE 'S'                TO SK-MO (8).
 14680     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14681         MOVE 'S'                TO SK-MO (9).
 14682     IF PB-I-SKIP-CODE = 'A'
 14683         MOVE 'S'                TO SK-MO (10).
 14684
 14685     MOVE 1                      TO SUB2.
 14686     MOVE PB-I-AH-TERM           TO SUB3.
 14687     MOVE WS-MONTH               TO SUB1.
 14688     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14689     GO TO 3320-RATE-CONTINUE.
 14690
 14691 3310-GET-SKIP-MO.
 14692     IF SUB1 = 13
 14693         MOVE 1                  TO SUB1.
 14694
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 267
* EL050.cbl
 14695     IF SK-MO (SUB1) = 'S'
 14696         SUBTRACT 1 FROM WS-WORK-TERM.
 14697
 14698     ADD 1 TO SUB2
 14699              SUB1.
 14700
 14701 3320-RATE-CONTINUE.
 14702
 14703     IF WS-WORK-TERM = ZERO
 14704         MOVE 1                  TO WS-WORK-TERM.
 14705
 14706     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14707                                    CP-LOAN-TERM.
 14708
 14709     IF PB-COMPANY-ID EQUAL 'DMD'
 14710         NEXT SENTENCE
 14711     ELSE
 14712         MOVE ZERO               TO PB-I-AH-RATE
 14713                                    PB-I-AH-REI-RATE.
 14714
 14715
 14716     IF PB-COMPANY-ID EQUAL 'CRI'
 14717        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14718
 14719     IF PB-COMPANY-ID = 'CSL'
 14720         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14721         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14722         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14723         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14724
 14725     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14726        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14727           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14728              PB-I-RATE-DEV-PCT-LF
 14729        END-IF
 14730        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14731                                 TO CP-ALTERNATE-BENEFIT
 14732        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14733        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14734        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14735     END-IF
 14736*    if ws-clp-state not = spaces
 14737*       move ws-clp-state to cp-state
 14738*    end-if
 14739     IF (PB-COMPANY-ID = 'CID')
 14740        AND (WS-LF-EARNINGS-CALC = 'B')
 14741        AND (CP-STATE-STD-ABBRV = 'MN')
 14742        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14743     ELSE
 14744        MOVE ' '                 TO CP-AH-BALLOON-SW
 14745     END-IF
 14746     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14747     MOVE 'R'                   TO CP-RATE-FILE.
 14748     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14749
 14750     IF (CP-ERROR-RATE-NOT-FOUND)
 14751        and (not pb-monthly-cert)
 14752        IF PB-I-OB
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 268
* EL050.cbl
 14753           MOVE ER-2624          TO WS-ERROR
 14754           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14755           GO TO 3340-CALCULATE-PREMIUM-AMT
 14756        ELSE
 14757          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14758              NEXT SENTENCE
 14759          ELSE
 14760           MOVE ER-2642          TO WS-ERROR
 14761           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14762           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14763
 14764     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14765        CP-ERROR-DIV-BY-ZERO
 14766           MOVE ER-3782          TO WS-ERROR
 14767           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14768
 14769     IF PB-COMPANY-ID EQUAL 'CRI'
 14770        IF CP-ERROR-NO-LIMITS-CRI
 14771           IF NOT ACCOUNT-AH-CHECKED
 14772              MOVE ER-2607          TO WS-ERROR
 14773              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14774
 14775     IF ACCOUNT-AH-CHECKED
 14776        NEXT SENTENCE
 14777     ELSE
 14778       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14779          MOVE ER-2640           TO WS-ERROR
 14780          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14781
 14782     IF PB-COMPANY-ID = 'CRI'
 14783         IF WS-ERROR = ER-2640
 14784             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14785     IF ACCOUNT-AH-CHECKED
 14786        CONTINUE
 14787     ELSE
 14788        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14789           AND (CP-R-MAX-ATT-AGE > +0)
 14790           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14791           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14792              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14793              MOVE PB-I-AH-EXPIRE-DT
 14794                                 TO DC-BIN-DATE-2
 14795              MOVE '1'           TO DC-OPTION-CODE
 14796              PERFORM 8500-DATE-CONVERT
 14797                                 THRU 8500-EXIT
 14798              IF NO-CONVERSION-ERROR
 14799                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14800                    MOVE ER-2661       TO WS-ERROR
 14801*                   PERFORM 9900-ERROR-FORMAT
 14802*                                THRU 9900-EXIT
 14803                 END-IF
 14804              END-IF
 14805           ELSE
 14806              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14807              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14808                 MOVE ER-2661    TO WS-ERROR
 14809*                PERFORM 9900-ERROR-FORMAT
 14810*                                THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 269
* EL050.cbl
 14811              ELSE
 14812                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14813                    MOVE ER-1570 TO WS-ERROR
 14814                    PERFORM 9900-ERROR-FORMAT
 14815                                 THRU 9900-EXIT
 14816                 END-IF
 14817              END-IF
 14818           END-IF
 14819           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14820              MOVE PB-I-JOINT-BIRTHDAY
 14821                                    TO DC-BIN-DATE-1
 14822              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14823              MOVE '1'              TO DC-OPTION-CODE
 14824              PERFORM 8500-DATE-CONVERT
 14825                                    THRU 8500-EXIT
 14826              IF NO-CONVERSION-ERROR
 14827                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14828                    MOVE ER-2661       TO WS-ERROR
 14829*                   PERFORM 9900-ERROR-FORMAT
 14830*                                   THRU 9900-EXIT
 14831                 END-IF
 14832              END-IF
 14833           ELSE
 14834              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14835                (PB-I-AH-TERM / 12)
 14836              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14837                 MOVE ER-2661       TO WS-ERROR
 14838*                PERFORM 9900-ERROR-FORMAT
 14839*                                   THRU 9900-EXIT
 14840              ELSE
 14841                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14842                    MOVE ER-1571 TO WS-ERROR
 14843                    PERFORM 9900-ERROR-FORMAT
 14844                                 THRU 9900-EXIT
 14845                 END-IF
 14846              END-IF
 14847           END-IF
 14848           IF WS-ERROR = ER-2661
 14849              PERFORM 9900-ERROR-FORMAT
 14850                                    THRU 9900-EXIT
 14851           END-IF
 14852        END-IF
 14853     END-IF
 14854*    IF ACCOUNT-AH-CHECKED
 14855*       NEXT SENTENCE
 14856*    ELSE
 14857*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14858*          MOVE ER-2661          TO WS-ERROR
 14859*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14860
 14861     IF ACCOUNT-AH-CHECKED
 14862        NEXT SENTENCE
 14863     ELSE
 14864        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14865           MOVE ER-2663          TO WS-ERROR
 14866           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14867
 14868     IF ACCOUNT-AH-CHECKED OR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 270
* EL050.cbl
 14869        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14870         PB-POLICY-IS-VOIDED
 14871        NEXT SENTENCE
 14872     ELSE
 14873        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14874           MOVE ER-2667            TO WS-ERROR
 14875           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14876
 14877     IF PB-COMPANY-ID = 'CRI'
 14878         IF WS-ERROR = ER-2667
 14879             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14880
 14881     IF ACCOUNT-AH-CHECKED
 14882        NEXT SENTENCE
 14883     ELSE
 14884        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14885           MOVE ER-2678            TO WS-ERROR
 14886           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14887
 14888     IF CP-ERROR-RATE-FILE-NOTOPEN
 14889         GO TO 3990-FILES-NOT-OPEN.
 14890
 14891 3321-CONTINUE.
 14892     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14893     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14894     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14895*    IF (PB-COMPANY-ID = 'DCC')
 14896        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14897        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14898                                    PB-I-LF-ALT-PREM-CALC
 14899        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14900        IF WS-AH-BEN-CATEGORY = 'G'
 14901           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14902           + PB-I-ADDL-CLP)
 14903           * (1 + WS-TOL-CLP-PCT)
 14904*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14905        ELSE
 14906           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14907           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14908*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14909        END-IF
 14910        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14911                                 TO PB-I-AH-PREM-CALC
 14912        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14913           MOVE ER-8152          TO WS-ERROR
 14914           PERFORM 9900-ERROR-FORMAT
 14915                                 THRU 9900-EXIT
 14916        ELSE
 14917           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14918                 PB-I-ADDL-CLP)
 14919              MOVE ER-8148       TO WS-ERROR
 14920              PERFORM 9900-ERROR-FORMAT
 14921                                 THRU 9900-EXIT
 14922           END-IF
 14923        END-IF
 14924     END-IF
 14925     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14926        AND (PB-I-POLICY-IS-MONTHLY)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 271
* EL050.cbl
 14927        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14928        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14929        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14930           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14931        END-IF
 14932     END-IF
 14933     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14934        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14935        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14936        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14937        MOVE ER-2786             TO WS-ERROR
 14938        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14939     END-IF
 14940     MOVE +0                     TO PB-I-AH-CLP
 14941     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14942        evaluate true
 14943           when WS-AH-BEN-CATEGORY = 'D'
 14944              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14945                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14946           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14947              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14948           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14949              compute ws-cred-union-fees rounded =
 14950                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14951                    pb-i-ah-commission)
 14952              COMPUTE PB-I-AH-CLP =
 14953                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14954        end-evaluate
 14955     END-IF
 14956     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14957
 14958     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14959         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14960
 14961     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14962         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14963
 14964     if (ws-ah-special-calc-cd = 'E')
 14965        and (pb-monthly-cert)
 14966        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14967     end-if
 14968     IF PB-COMPANY-ID = 'CRI'
 14969         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14970            PB-I-PAYMENT-AMOUNT = ZERO
 14971             NEXT SENTENCE
 14972         ELSE
 14973             COMPUTE PB-I-AH-PREM-CALC =
 14974                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14975                 (CP-PREMIUM-RATE / 100)
 14976             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14977                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14978                                             PB-I-RATE-DEV-PCT-AH.
 14979
 14980     IF (PB-I-AH-RATE  = ZERO)
 14981        and (not pb-monthly-cert)
 14982       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14983           NEXT SENTENCE
 14984       ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 272
* EL050.cbl
 14985         MOVE ER-2642            TO WS-ERROR
 14986         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14987
 14988     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14989     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14990     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14991     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14992     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14993     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14994
 14995     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14996        AND (WS-AH-BEN-CATEGORY = 'G')
 14997        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14998        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14999        IF CP-DEVIATION-CODE NOT = '000'
 15000           MOVE '000'            TO CP-DEVIATION-CODE
 15001           PERFORM 7000-GET-RATE THRU 7000-EXIT
 15002           IF NO-CP-ERROR
 15003              COMPUTE PB-I-DDF-IU-RATE-UP =
 15004              PB-I-AH-CLP - CP-CALC-PREMIUM
 15005           ELSE
 15006              MOVE ER-3057        TO WS-ERROR
 15007              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15008           END-IF
 15009        END-IF
 15010     END-IF
 15011     .
 15012 3335-EDIT-AH-REIN-NSP-RATE.
 15013     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15014        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 15015              compute ws-cred-union-fees rounded =
 15016                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 15017                    pb-i-ah-commission)
 15018              COMPUTE PB-I-AH-CLP =
 15019                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 15020        end-if
 15021     END-IF
 15022     IF AH-REIN-NSP-NOT-USED
 15023         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15024
 15025     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 15026     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15027         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15028     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 15029     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 15030     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 15031     MOVE PB-SV-STATE            TO CP-STATE.
 15032     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15033     MOVE ZERO                   TO CP-DEVIATION-CODE
 15034                                    CP-RATE-DEV-PCT.
 15035*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15036     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15037     MOVE '3'                    TO CP-PROCESS-TYPE.
 15038     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 15039     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15040                                    CP-RATING-BENEFIT-AMT.
 15041     IF CP-STATE-STD-ABBRV = 'OR'
 15042         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 273
* EL050.cbl
 15043                                         PB-I-AH-TERM.
 15044     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 15045     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15046     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15047     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15048     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15049     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 15050                                    CP-REMAINING-TERM
 15051                                    WS-WORK-TERM.
 15052     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 15053     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15054        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15055     END-IF
 15056     IF  PB-COMPANY-ID = 'TIC'
 15057         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 15058            MOVE ZERO TO CP-CLASS-CODE.
 15059
 15060     IF PB-COMPANY-ID NOT = 'TIC'
 15061          MOVE ZERO          TO CP-CLASS-CODE.
 15062
 15063     MOVE ZERO               TO CP-DEVIATION-CODE.
 15064
 15065     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15066
 15067     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15068
 15069     MOVE 'R'                   TO CP-RATE-FILE.
 15070     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15071
 15072     IF CP-ERROR-RATE-NOT-FOUND
 15073         MOVE ER-2645        TO WS-ERROR
 15074         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15075         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15076
 15077     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15078
 15079     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15080     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15081
 15082     IF PB-I-AH-REI-RATE = ZERO
 15083         MOVE ER-2645        TO WS-ERROR
 15084         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15085
 15086
 15087 3340-CALCULATE-PREMIUM-AMT.
 15088     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15089     SET BIN-TO-GREG             TO TRUE
 15090     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 15091     move dc-greg-date-a-edit    to ws-greg-eff-date
 15092
 15093     IF PB-COMPANY-ID = 'NCL'
 15094         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15095             WS-AH-SPECIAL-CALC-CD = 'O')
 15096             GO TO 3999-END-EDIT.
 15097
 15098     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15099                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15100                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 274
* EL050.cbl
 15101                         OR 'AHL'
 15102         NEXT SENTENCE
 15103     ELSE
 15104         IF WS-STATE-ABBREVIATION = 'CT'
 15105             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15106                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 15107                 COMPUTE PB-I-LF-PREM-CALC =
 15108                                     PB-I-LF-PREM-CALC * .90
 15109                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15110                                     PB-I-LF-ALT-PREM-CALC * .90
 15111                 COMPUTE PB-I-AH-PREM-CALC =
 15112                                     PB-I-AH-PREM-CALC * .90.
 15113
 15114     IF PB-COMP-LF-PREM
 15115        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15116        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15117
 15118     IF PB-COMP-AH-PREM
 15119        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15120
 15121 3340-CHECK-DCC-TOT-FEES.
 15122     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15123        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15124        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15125        AND (PB-I-POLICY-IS-MONTHLY)
 15126        CONTINUE
 15127     ELSE
 15128        GO TO 3340-EDIT-LF-AH-TOL
 15129     END-IF
 15130     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15131     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15132     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15133        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15134           PB-I-RATE-DEV-PCT-LF
 15135     END-IF
 15136     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15137        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15138           PB-I-RATE-DEV-PCT-AH
 15139     END-IF
 15140     MOVE 'N'                    TO CP-BEN-CATEGORY
 15141     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15142
 15143     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15144     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15145     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15146     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15147     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15148     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15149     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15150     MOVE '3'                    TO CP-PROCESS-TYPE.
 15151     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15152     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15153
 15154     MOVE PB-SV-STATE            TO CP-STATE.
 15155     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15156     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15157     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15158     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 275
* EL050.cbl
 15159     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15160                                    CP-RATING-BENEFIT-AMT.
 15161     IF CP-STATE-STD-ABBRV = 'OR'
 15162         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15163                                         PB-I-LF-ALT-BENEFIT-AMT.
 15164     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 15165     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15166     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15167     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15168     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15169     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15170     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15171     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15172     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15173                                    CP-REMAINING-TERM
 15174                                    CP-LOAN-TERM.
 15175     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15176        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15177           PB-I-LF-PREMIUM-AMT
 15178     end-if
 15179
 15180     IF CP-TRUNCATED-LIFE
 15181        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15182
 15183     IF CP-TERM-IS-DAYS
 15184         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15185     ELSE
 15186         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15187
 15188     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15189     IF CP-SPECIAL-CALC-CD = 'H'
 15190         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15191                                    TO CP-ALTERNATE-BENEFIT
 15192         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15193     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15194     MOVE 'R'                    TO CP-RATE-FILE
 15195     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15196     IF NOT CP-ERROR-RATE-NOT-FOUND
 15197        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15198        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15199           AND (CP-BENEFIT-CD (1:1) = 'S')
 15200           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15201                                    PB-I-LF-PREMIUM-AMT
 15202        END-IF
 15203     ELSE
 15204        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15205     END-IF
 15206     .
 15207 3340-EDIT-LF-AH-TOL.
 15208
 15209***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15210***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15211***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15212***
 15213     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15214         PB-I-AH-PREMIUM-AMT
 15215          GIVING WS-CALC-WORK.
 15216
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 276
* EL050.cbl
 15217     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15218        AND WS-CALC-WORK NOT = ZERO
 15219         MOVE ER-2649            TO WS-ERROR
 15220         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15221
 15222     SUBTRACT PB-I-LF-PREM-CALC
 15223             FROM PB-I-LF-PREMIUM-AMT
 15224                 GIVING WS-UNSIGN-WRK1.
 15225
 15226     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15227             FROM PB-I-LF-ALT-PREMIUM-AMT
 15228                 GIVING WS-UNSIGN-WRK4.
 15229
 15230     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15231                                + WS-UNSIGN-WRK4.
 15232
 15233     SUBTRACT PB-I-AH-PREM-CALC
 15234             FROM PB-I-AH-PREMIUM-AMT
 15235                 GIVING WS-UNSIGN-WRK2.
 15236
 15237******************************************************************
 15238*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15239******************************************************************
 15240
 15241     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15242         MOVE ZERO TO WS-UNSIGN-WRK1.
 15243
 15244     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15245         MOVE ZERO TO WS-UNSIGN-WRK2.
 15246
 15247     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15248             GIVING WS-UNSIGN-WRK3.
 15249
 15250 3342-CONTINUE.
 15251
 15252     IF (PB-I-LF-RATE = ZERO  AND
 15253         PB-I-AH-RATE = ZERO)
 15254         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15255            WS-AH-SPECIAL-CALC-CD = 'O'
 15256              NEXT SENTENCE
 15257         ELSE
 15258             GO TO 3345-EDIT-CONTINUE.
 15259
 15260     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15261         NEXT SENTENCE
 15262     ELSE
 15263     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15264        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15265           IF (PB-REISSUED-CERT         OR
 15266               PB-POLICY-IS-DECLINED    OR
 15267               PB-POLICY-IS-VOIDED)
 15268              NEXT SENTENCE
 15269           ELSE
 15270              IF WS-PREM-REJECT-SW = SPACE
 15271                 MOVE ER-2652    TO WS-ERROR
 15272                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15273                 GO TO 3344-CHECK-AH
 15274              ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 277
* EL050.cbl
 15275                 MOVE ER-2650    TO WS-ERROR
 15276                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15277                 GO TO 3344-CHECK-AH.
 15278
 15279***
 15280***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 15281***
 15282
 15283     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15284         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15285            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15286             (1 + WS-TOL-LF-PREM-PCT)
 15287         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15288            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15289             (1 - WS-TOL-LF-PREM-PCT)
 15290     ELSE
 15291         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15292         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15293
 15294***
 15295***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15296***
 15297
 15298     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15299         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15300          WS-TOL-LF-PREM.
 15301
 15302     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15303         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15304          WS-TOL-LF-PREM.
 15305
 15306     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15307        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15308
 15309     IF PB-REISSUED-CERT
 15310        or PB-POLICY-IS-DECLINED
 15311        or PB-POLICY-IS-VOIDED
 15312        continue
 15313     ELSE
 15314        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15315              > WS-TOL-LF-HIGH-PREM-AMT)
 15316           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15317              < WS-TOL-LF-LOW-PREM-AMT))
 15318                      or
 15319           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15320              > WS-TOL-LF-HIGH-PREM-PCT)
 15321           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15322              < WS-TOL-LF-LOW-PREM-PCT))
 15323           IF WS-PREM-REJECT-SW = SPACE
 15324              MOVE ER-2652       TO WS-ERROR
 15325              PERFORM 9900-ERROR-FORMAT
 15326                                 THRU 9900-EXIT
 15327           ELSE
 15328              MOVE ER-2650       TO WS-ERROR
 15329              PERFORM 9900-ERROR-FORMAT
 15330                                 THRU 9900-EXIT
 15331           end-if
 15332        end-if
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 278
* EL050.cbl
 15333     end-if
 15334
 15335*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15336*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15337*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15338*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15339
 15340     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15341        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15342                      OR
 15343           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15344           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15345           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15346           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15347        END-IF
 15348     END-IF
 15349
 15350     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15351        IF WS-COMP-MAX-CAP GREATER THAN +0
 15352           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15353              IF (PB-REISSUED-CERT         OR
 15354                  PB-POLICY-IS-DECLINED    OR
 15355                  PB-POLICY-IS-VOIDED)
 15356                 NEXT SENTENCE
 15357              ELSE
 15358                  MOVE ER-2646   TO  WS-ERROR
 15359                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15360
 15361 3344-CVL-TOLERANCE-CHECK.
 15362
 15363      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15364          GO TO 3344-CHECK-AH.
 15365
 15366      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15367          GO TO 3344-CHECK-AH.
 15368
 15369      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15370                                     WS-UNSIGN-WRK6.
 15371
 15372      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15373          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15374                                 + PB-I-LF-PREMIUM-AMT
 15375                                 - PB-I-LF-PREM-CALC.
 15376
 15377      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15378          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15379                                 + PB-I-LF-ALT-PREMIUM-AMT
 15380                                 - PB-I-LF-ALT-PREM-CALC.
 15381
 15382      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15383          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15384              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15385                 MOVE ER-2652    TO  WS-ERROR
 15386                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15387              ELSE
 15388                 MOVE ER-2650    TO  WS-ERROR
 15389                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15390
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 279
* EL050.cbl
 15391      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15392          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15393              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15394                 MOVE ER-2652    TO  WS-ERROR
 15395                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15396              ELSE
 15397                 MOVE ER-2650    TO  WS-ERROR
 15398                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15399
 15400 3344-CHECK-AH.
 15401
 15402****************************************************************
 15403***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15404***
 15405
 15406     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15407         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15408             (1 + WS-TOL-AH-PREM-PCT)
 15409         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15410             (1 - WS-TOL-AH-PREM-PCT)
 15411     ELSE
 15412         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15413         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15414
 15415***
 15416***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15417***
 15418
 15419     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15420         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15421
 15422     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15423         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15424
 15425     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15426        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15427
 15428     IF (PB-REISSUED-CERT)
 15429        OR (PB-POLICY-IS-DECLINED)
 15430        OR (PB-POLICY-IS-VOIDED)
 15431        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15432        CONTINUE
 15433     ELSE
 15434        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15435              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15436                          or
 15437           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15438              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15439           IF WS-PREM-REJECT-SW = SPACE
 15440              MOVE ER-3052       TO WS-ERROR
 15441              PERFORM 9900-ERROR-FORMAT
 15442                                 THRU 9900-EXIT
 15443           ELSE
 15444              MOVE ER-3050       TO WS-ERROR
 15445              PERFORM 9900-ERROR-FORMAT
 15446                                 THRU 9900-EXIT
 15447           END-IF
 15448        END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 280
* EL050.cbl
 15449     END-IF
 15450     if (pb-company-id = 'DCC' or 'VPP')
 15451        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15452        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15453        and (pb-i-policy-is-monthly)
 15454        compute ws-tol-ah-high-prem-amt =
 15455           pb-i-tot-fees-calc + ws-tol-ah-prem
 15456        compute ws-tol-ah-low-prem-amt =
 15457           pb-i-tot-fees-calc - ws-tol-ah-prem
 15458        if ws-tol-ah-prem-pct > zeros
 15459           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15460              (1 + ws-tol-ah-prem-pct)
 15461           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15462              (1 - ws-tol-ah-prem-pct)
 15463        else
 15464           move +9999999.99      to ws-tol-ah-high-prem-pct
 15465           move +0               to ws-tol-ah-low-prem-pct
 15466        end-if
 15467        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15468            or
 15469           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15470                          or
 15471           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15472           or
 15473           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15474            move er-3049         to ws-error
 15475           perform 9900-error-format
 15476                                 thru 9900-exit
 15477
 15478        end-if
 15479     end-if
 15480     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15481         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15482             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15483             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15484
 15485     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15486        IF WS-COMP-MAX-CAP GREATER THAN +0
 15487           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15488              IF (PB-REISSUED-CERT         OR
 15489                  PB-POLICY-IS-DECLINED    OR
 15490                  PB-POLICY-IS-VOIDED)
 15491                 NEXT SENTENCE
 15492              ELSE
 15493                  MOVE ER-2646   TO  WS-ERROR
 15494                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15495
 15496     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15497        (WS-COMP-MAX-CAP EQUAL +0)
 15498           GO TO 3345-EDIT-CONTINUE.
 15499
 15500     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15501        GREATER THAN WS-COMP-MAX-CAP
 15502           MOVE ER-2646          TO  WS-ERROR
 15503           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15504
 15505 3345-EDIT-CONTINUE.
 15506
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 281
* EL050.cbl
 15507*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15508*       IF PB-ENTRY-BATCH   NUMERIC
 15509*          IF PB-ISSUE
 15510*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15511*          ELSE
 15512*              IF PB-CANCELLATION
 15513*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15514
 15515*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15516*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15517*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15518*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15519*        ELSE
 15520*            MOVE  ER-1909            TO  WS-ERROR
 15521*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15522
 15523     IF PB-I-POLICY-ACCEPTED
 15524        IF PB-POLICY-IS-DECLINED  OR
 15525           PB-REISSUED-CERT  OR
 15526           PB-REIN-ONLY-CERT  OR
 15527           PB-POLICY-IS-VOIDED
 15528            MOVE  ER-1891         TO  WS-ERROR
 15529            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15530        ELSE
 15531            MOVE SPACE            TO  PB-BATCH-ENTRY
 15532            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15533
 15534     IF PB-I-POLICY-DECLINED
 15535        IF PB-REISSUED-CERT  OR
 15536           PB-REIN-ONLY-CERT  OR
 15537           PB-POLICY-IS-VOIDED
 15538            MOVE  ER-1906         TO  WS-ERROR
 15539            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15540        ELSE
 15541            MOVE  'D'             TO  PB-BATCH-ENTRY
 15542                                      PB-I-ENTRY-STATUS.
 15543
 15544     IF PB-I-NEEDS-UNDERWRITING
 15545        IF PB-POLICY-IS-DECLINED OR
 15546           PB-REISSUED-CERT  OR
 15547           PB-REIN-ONLY-CERT  OR
 15548           PB-POLICY-IS-VOIDED
 15549            MOVE  ER-1907         TO  WS-ERROR
 15550            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15551        ELSE
 15552            MOVE 'U'              TO  PB-BATCH-ENTRY
 15553                                      PB-I-ENTRY-STATUS.
 15554
 15555     IF PB-NEEDS-UNDERWRITING
 15556        MOVE  ER-1901             TO  WS-ERROR
 15557        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15558     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15559        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15560        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15561        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15562           AND (NOT WS-LF-CASH))
 15563                           OR
 15564           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 282
* EL050.cbl
 15565           AND (NOT WS-AH-CASH)))
 15566                       AND
 15567           (PB-I-ENTRY-STATUS NOT = '5')
 15568           MOVE 'M'              TO PB-BATCH-ENTRY
 15569                                    PB-I-ENTRY-STATUS
 15570        END-IF
 15571     END-IF
 15572     move pending-business       to ws-passed-erpndb
 15573     move ' '                    to ws-exceed-limit-yn
 15574     perform 7780-call-agg       thru 7780-exit
 15575*    display ' el050 exceed ' ws-exceed-limit-yn
 15576     if ws-exceed-limit-yn = 'Y'
 15577        MOVE  ER-9813            TO WS-ERROR
 15578        move 'Y'                 to ws-9813-sw
 15579        PERFORM  9900-ERROR-FORMAT
 15580                                 THRU 9900-EXIT
 15581     end-if
 15582     if (PB-EXCEEDED-LIMIT-FORCED)
 15583        and (ws-9813-sw = 'Y')
 15584        subtract +1 from PB-NO-OF-ERRORS
 15585        move er-9823             to ws-error
 15586        PERFORM  9900-ERROR-FORMAT
 15587                                 THRU 9900-EXIT
 15588     end-if
 15589     IF  PB-COMPANY-ID NOT = 'NCL'
 15590         GO TO 3999-END-EDIT.
 15591
 15592     IF PB-REISSUED-CERT  OR
 15593        PB-POLICY-IS-DECLINED  OR
 15594        PB-POLICY-IS-VOIDED  OR
 15595        PB-I-OB
 15596         GO TO 3999-END-EDIT.
 15597
 15598     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15599         MOVE  ER-2644            TO  WS-ERROR
 15600         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15601         GO TO 3999-END-EDIT.
 15602
 15603     MOVE 'N'                     TO  FORM-MASTER-SW.
 15604     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15605
 15606     IF NOT FORM-MASTER-FOUND
 15607         GO TO 3999-END-EDIT.
 15608
 15609     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15610                                      FORM-MASTER-AH-SW.
 15611
 15612     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15613         MOVE  +1                 TO SUB6
 15614         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15615
 15616     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15617         MOVE  +1                 TO SUB6
 15618         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15619
 15620     IF LF-FORM-MASTER-FOUND  OR
 15621        AH-FORM-MASTER-FOUND
 15622         GO TO 3360-CHECK-FORM-LIMITS
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 283
* EL050.cbl
 15623     ELSE
 15624         GO TO 3999-END-EDIT.
 15625
 15626******************************************************************
 15627*                  3350-GET-ERFORM                               *
 15628*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15629*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15630******************************************************************
 15631
 15632 3350-GET-ERFORM.
 15633
 15634     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15635         GO TO  3350-ERFORM-GETMAIN.
 15636
 15637     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15638     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15639     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15640     MOVE 'Y'                     TO FORM-MASTER-SW.
 15641
 15642     IF PB-CANCELLATION
 15643         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15644            PB-SV-STATE          EQUAL   FO-STATE       AND
 15645            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15646              GO TO 3350-EXIT
 15647         ELSE
 15648             NEXT SENTENCE
 15649     ELSE
 15650         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15651            PB-SV-STATE          EQUAL   FO-STATE       AND
 15652            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15653              GO TO 3350-EXIT.
 15654
 15655 3350-ERFORM-GETMAIN.
 15656
 15657     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15658     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15659
 15660 3350-ERFORM-READ.
 15661
 15662     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15663     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15664     IF PB-CANCELLATION
 15665         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15666     ELSE
 15667         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15668     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15669
 15670     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15671
 15672     IF FORM-MASTER-FOUND
 15673       IF PB-CANCELLATION
 15674          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15675             PB-SV-STATE          EQUAL   FO-STATE       AND
 15676             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15677              GO  TO 3350-EXIT
 15678          ELSE
 15679              NEXT SENTENCE
 15680       ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 284
* EL050.cbl
 15681          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15682             PB-SV-STATE          EQUAL   FO-STATE       AND
 15683             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15684              GO  TO 3350-EXIT.
 15685
 15686     MOVE  'N'                    TO  FORM-MASTER-SW.
 15687     MOVE  ER-1895                TO  WS-ERROR.
 15688     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15689
 15690 3350-EXIT.
 15691      EXIT.
 15692
 15693******************************************************************
 15694*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15695*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15696*   VALID FOR THE POLICY FORM USED.                              *
 15697******************************************************************
 15698
 15699 3355-EDIT-FORM-LF-BENEFITS.
 15700
 15701     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15702        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15703         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15704         GO TO   3355-EXIT.
 15705
 15706     IF  SUB6    LESS THAN   +40
 15707         ADD  +1      TO  SUB6
 15708         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15709
 15710     MOVE  ER-1896         TO  WS-ERROR.
 15711     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15712
 15713 3355-EXIT.
 15714      EXIT.
 15715
 15716******************************************************************
 15717*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15718*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15719*   VALID FOR THE POLICY FORM USED.                              *
 15720******************************************************************
 15721
 15722 3356-EDIT-FORM-AH-BENEFITS.
 15723
 15724     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15725        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15726         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15727         GO TO  3356-EXIT.
 15728
 15729      IF  SUB6    LESS THAN     +40
 15730          ADD  +1      TO  SUB6
 15731          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15732
 15733     MOVE  ER-1897         TO  WS-ERROR.
 15734     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15735
 15736 3356-EXIT.
 15737      EXIT.
 15738
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 285
* EL050.cbl
 15739******************************************************************
 15740*                  3357-BENEFIT-SEARCH                           *
 15741*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15742*   CANCELLATIONS ONLY.                                          *
 15743******************************************************************
 15744 3357-BENEFIT-SEARCH.
 15745     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15746         MOVE +1                          TO SUB6
 15747         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15748
 15749     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15750         MOVE +1                          TO SUB6
 15751         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15752
 15753 3357-EXIT.
 15754     EXIT.
 15755
 15756******************************************************************
 15757*                  3358-BENEFIT-LIFE-SEARCH                      *
 15758*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15759*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15760*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15761******************************************************************
 15762 3358-BENEFIT-LIFE-SEARCH.
 15763     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15764       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15765         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15766           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15767              IF FO-PLAN-REFUND-METHOD (SUB6)
 15768                     IS GREATER THAN SPACES
 15769                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15770                                          WS-LF-REFUND-CALC
 15771                 GO TO 3358-EXIT.
 15772
 15773     IF SUB6 LESS THAN +40
 15774         ADD +1                 TO SUB6
 15775         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15776
 15777 3358-EXIT.
 15778     EXIT.
 15779******************************************************************
 15780*                  3359-BENEFIT-AH-SEARCH                        *
 15781*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15782*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15783*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15784******************************************************************
 15785 3359-BENEFIT-AH-SEARCH.
 15786     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15787       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15788         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15789           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15790              IF FO-PLAN-REFUND-METHOD (SUB6)
 15791                      IS GREATER THAN SPACES
 15792                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15793                                          WS-AH-REFUND-CALC
 15794                 GO TO 3359-EXIT.
 15795
 15796     IF SUB6 LESS THAN +40
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 286
* EL050.cbl
 15797         ADD +1                 TO SUB6
 15798         GO TO 3359-BENEFIT-AH-SEARCH.
 15799
 15800 3359-EXIT.
 15801     EXIT.
 15802
 15803******************************************************************
 15804*                  3360-CHECK-FORM-LIMITS                        *
 15805*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15806*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15807******************************************************************
 15808
 15809 3360-CHECK-FORM-LIMITS.
 15810
 15811     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15812         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15813
 15814     IF NOT LF-FORM-MASTER-FOUND
 15815         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15816
 15817 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15818
 15819     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15820       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15821        WS-LF-JOINT-INDICATOR = 'J'  AND
 15822        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15823         IF PB-COMPANY-ID = 'NCL'
 15824            MOVE  ER-1911          TO  WS-ERROR
 15825            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15826         ELSE
 15827            MOVE  ER-1892          TO  WS-ERROR
 15828            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15829
 15830 3360-CHECK-FORM-LF-ATT-AGE.
 15831
 15832     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15833
 15834     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15835         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15836         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15837            IF PB-COMPANY-ID = 'NCL'
 15838                MOVE  ER-1913      TO  WS-ERROR
 15839                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15840            ELSE
 15841                MOVE  ER-1894      TO  WS-ERROR
 15842                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15843
 15844 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15845
 15846     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15847         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15848         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15849            IF PB-COMPANY-ID = 'NCL'
 15850                MOVE  ER-1914      TO  WS-ERROR
 15851                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15852            ELSE
 15853                MOVE  ER-1899      TO  WS-ERROR
 15854                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 287
* EL050.cbl
 15855
 15856 3360-CHECK-FORM-LF-TERM-BAMT.
 15857
 15858     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15859         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15860         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15861           IF  PB-COMPANY-ID = 'NCL'
 15862               MOVE  ER-1916       TO  WS-ERROR
 15863               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15864           ELSE
 15865               MOVE  ER-1902       TO  WS-ERROR
 15866               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15867
 15868     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15869                                    PB-I-LF-ALT-BENEFIT-AMT.
 15870
 15871     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15872         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15873         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15874             IF  PB-COMPANY-ID = 'NCL'
 15875                 MOVE  ER-1918     TO  WS-ERROR
 15876                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15877             ELSE
 15878                 MOVE  ER-1904     TO  WS-ERROR
 15879                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15880
 15881******************************************************************
 15882*                  3360-CHECK-FORM-AH-LIMITS                     *
 15883*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15884*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15885******************************************************************
 15886
 15887 3360-CHECK-FORM-AH-LIMITS.
 15888
 15889     IF NOT AH-FORM-MASTER-FOUND
 15890         GO TO 3999-END-EDIT.
 15891
 15892 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15893
 15894     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15895       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15896        WS-AH-JOINT-INDICATOR = 'J'  AND
 15897        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15898         IF PB-COMPANY-ID = 'NCL'
 15899            MOVE  ER-1912          TO  WS-ERROR
 15900            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15901         ELSE
 15902            MOVE  ER-1893          TO  WS-ERROR
 15903            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15904
 15905 3360-CHECK-FORM-AH-ATT-AGE.
 15906
 15907     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15908
 15909     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15910         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15911         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15912            IF PB-COMPANY-ID = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 288
* EL050.cbl
 15913                MOVE  ER-1913      TO  WS-ERROR
 15914                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15915            ELSE
 15916                MOVE  ER-1894      TO  WS-ERROR
 15917                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15918
 15919 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15920
 15921     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15922         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15923         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15924            IF PB-COMPANY-ID = 'NCL'
 15925                MOVE  ER-1915      TO  WS-ERROR
 15926                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15927            ELSE
 15928                MOVE  ER-1900      TO  WS-ERROR
 15929                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15930
 15931 3360-CHECK-FORM-AH-TERM-BAMT.
 15932
 15933     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15934         FO-AH-MAX-TERM    GREATER THAN  +0
 15935         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15936             IF  PB-COMPANY-ID = 'NCL'
 15937                 MOVE  ER-1917     TO  WS-ERROR
 15938                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15939             ELSE
 15940                  MOVE  ER-1903    TO  WS-ERROR
 15941                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15942
 15943     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15944         FO-MAX-AH-AMT    GREATER THAN  +0
 15945         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15946             IF  PB-COMPANY-ID = 'NCL'
 15947                 MOVE  ER-1919     TO  WS-ERROR
 15948                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15949             ELSE
 15950                 MOVE  ER-1905     TO  WS-ERROR
 15951                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15952
 15953     GO TO 3999-END-EDIT.
 15954
 15955******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 289
* EL050.cbl
 15957 3400-edit-vin.
 15958
 15959     move spaces                 to hldi-pass-area
 15960     MOVE PB-I-VIN               TO WS-WORK-VIN
 15961     MOVE +8                     TO V2
 15962     MOVE ZEROS                  TO WS-VIN-TOTAL
 15963     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15964      (V1 > 17)
 15965        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15966           MOVE ER-3825          TO WS-ERROR
 15967           PERFORM 9900-ERROR-FORMAT
 15968                                 THRU 9900-EXIT
 15969        ELSE
 15970           IF V1 = 8
 15971              MOVE 10            TO V2
 15972           END-IF
 15973           IF V1 = 9
 15974              MOVE 0             TO V2
 15975           END-IF
 15976           IF V1 = 10
 15977              MOVE 9             TO V2
 15978           END-IF
 15979           IF WS-WORK-VIN (V1:1) NUMERIC
 15980              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15981               + (WS-WORK-VIN-N (V1) * V2)
 15982           ELSE
 15983              MOVE WS-WORK-VIN (V1:1)
 15984                            TO WS-HEX-BYTE
 15985              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15986              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15987               + (WS-NUM (V3) * V2)
 15988           END-IF
 15989           COMPUTE V2 = V2 - 1
 15990        END-IF
 15991     END-PERFORM
 15992     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15993     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15994        REMAINDER WS-VIN-REMAINDER
 15995     IF ((WS-WORK-VIN (9:1) = 'X')
 15996        AND (WS-VIN-REMAINDER = 10))
 15997                OR
 15998        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15999        if pb-company-id = 'VPP'
 16000           perform 3410-check-with-hldi
 16001                                 thru 3410-exit
 16002        end-if
 16003     ELSE
 16004        IF WS-WORK-VIN (1:1) > 0 AND < 6
 16005           MOVE ER-3826          TO WS-ERROR
 16006           PERFORM 9900-ERROR-FORMAT
 16007                                 THRU 9900-EXIT
 16008        ELSE
 16009           MOVE ER-3827          TO WS-ERROR
 16010           PERFORM 9900-ERROR-FORMAT
 16011                                 THRU 9900-EXIT
 16012        END-IF
 16013     END-IF
 16014
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 290
* EL050.cbl
 16015     .
 16016 3400-exit.
 16017     exit.
 16018 3410-check-with-hldi.
 16019     move spaces                 to hldi-pass-area
 16020     move pb-i-vin               to pa-vin
 16021     perform 7785-call-hldi      thru 7785-exit
 16022*    display 'PA-VIN        ' PA-VIN
 16023*    display 'PA-ErrorCode  ' PA-ErrorCode
 16024*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 16025*    display 'PA-ModelYear  ' PA-ModelYear
 16026*    display 'PA-MakeName   ' PA-MakeName
 16027*    display 'PA-ModelName  ' PA-ModelName
 16028*    display 'PA-SeriesName ' PA-SeriesName
 16029     if pa-errorcode (1:1) not = '0'
 16030        move spaces              to hldi-pass-area
 16031        move pb-i-vin            to pa-vin
 16032*       move pa-errordesc        to pa-seriesname
 16033*       perform 7786-call-hldim  thru 7786-exit
 16034*       display 'PA-VIN        ' PA-VIN
 16035*       display 'PA-ErrorCode  ' PA-ErrorCode
 16036*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 16037*       display 'PA-ModelYear  ' PA-ModelYear
 16038*       display 'PA-MakeName   ' PA-MakeName
 16039*       display 'PA-ModelName  ' PA-ModelName
 16040*       display 'PA-SeriesName ' PA-SeriesName
 16041     end-if
 16042     .
 16043 3410-exit.
 16044     exit.
 16045******************************************************************
 16046*                  E D I T   C A N C E L                         *
 16047******************************************************************
 16048
 16049 3700-EDIT-CANCEL.
 16050     IF PB-COMPANY-ID = 'DMD'
 16051         MOVE ZEROS                   TO WS-RES-STATE-TAX
 16052                                         WS-RES-MUNI-TAX
 16053                                         PB-CI-STATE-TAX
 16054                                         PB-CI-MUNI-TAX
 16055         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 16056
 16057*    IF PB-COMPANY-ID  EQUAL  'NCL'
 16058*       IF PB-ENTRY-BATCH  NUMERIC
 16059*          IF PB-CANCELLATION
 16060*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 16061*          ELSE
 16062*             IF PB-ISSUE
 16063*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 16064
 16065     IF PB-C-INT-ON-REFS NOT NUMERIC
 16066        MOVE ZEROS               TO PB-C-INT-ON-REFS
 16067     END-IF
 16068*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16069*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16070
 16071     IF CM-ENTRY-STATUS = 'V'
 16072        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 291
* EL050.cbl
 16073        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16074        GO TO 3999-END-EDIT.
 16075
 16076     IF CM-ENTRY-STATUS = 'D'
 16077        MOVE ER-2781             TO WS-ERROR
 16078        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16079        GO TO 3999-END-EDIT.
 16080
 16081     IF CM-ENTRY-STATUS = 'U'
 16082        MOVE ER-2782             TO WS-ERROR
 16083        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16084
 16085***************************************************************
 16086*                                                             *
 16087*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16088*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16089*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16090*   OF ANOTHER COVERAGE.                                      *
 16091*                                                             *
 16092***************************************************************
 16093
 16094     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16095                                    PB-C-AH-CANCEL-VOID-SW.
 16096
 16097     if pb-company-id = 'DCC' or 'VPP'
 16098        if ((pb-ci-lf-cancel-amt <> zeros)
 16099                       or
 16100            (pb-ci-ah-cancel-amt <> zeros))
 16101           MOVE ER-3068          TO WS-ERROR
 16102           PERFORM 9900-ERROR-FORMAT
 16103                                 THRU 9900-EXIT
 16104           GO TO 3999-END-EDIT
 16105        end-if
 16106     end-if
 16107     IF PB-C-LF-CANCEL-AMT = ZERO
 16108        NEXT SENTENCE
 16109     ELSE
 16110        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16111           AND
 16112           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16113               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16114               MOVE ER-2745           TO WS-ERROR
 16115               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16116
 16117     IF PB-C-AH-CANCEL-AMT = ZERO
 16118        NEXT SENTENCE
 16119     ELSE
 16120        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16121           AND
 16122           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16123               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16124               MOVE ER-2745           TO WS-ERROR
 16125               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16126
 16127     IF WS-LF-EARNINGS-CALC = '4'
 16128        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16129
 16130     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 292
* EL050.cbl
 16131     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16132     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16133     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16134     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16135     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16136
 16137     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16138                                      PB-C-AH-REF-CALC.
 16139     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16140
 16141******************************************************************
 16142*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16143*             TO VALIDATE COVERAGE.                              *
 16144******************************************************************
 16145
 16146     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16147        PB-C-LF-CANCEL-AMT = ZEROS
 16148          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16149      ELSE
 16150          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16151
 16152     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16153        PB-C-AH-CANCEL-AMT = ZEROS
 16154          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16155      ELSE
 16156          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16157
 16158     EVALUATE TRUE
 16159         WHEN PB-CANCEL-FORCE             OR
 16160              PB-CANCEL-DATE-FORCED       OR
 16161              PB-FORCE-OFF
 16162                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16163                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16164                  END-IF
 16165         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16166               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16167              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16168                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16169         WHEN OTHER
 16170              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16171                 MOVE ER-2794              TO WS-ERROR
 16172              ELSE
 16173                 MOVE ER-2749              TO WS-ERROR
 16174              END-IF
 16175              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16176     END-EVALUATE.
 16177
 16178
 16179*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16180*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16181*            MOVE  ER-1909            TO  WS-ERROR
 16182*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16183*        ELSE
 16184*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16185
 16186     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16187     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16188        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 293
* EL050.cbl
 16189     ELSE
 16190        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16191     END-IF
 16192     .
 16193 3705-EDIT-CANCEL-DT.
 16194
 16195     IF LF-COVERAGE-CANCELLED
 16196        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16197         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16198         MOVE WS-CURRENT-MONTH-END
 16199                                 TO DC-BIN-DATE-2
 16200         SET ELAPSED-BETWEEN-BIN TO TRUE
 16201*        MOVE 1                  TO DC-OPTION-CODE
 16202         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16203         IF DATE-CONVERSION-ERROR
 16204            NEXT SENTENCE
 16205          ELSE
 16206             IF DC-ELAPSED-DAYS GREATER +180
 16207                IF PB-CANCEL-DATE-FORCED  OR
 16208                   PB-CANCEL-DATE-FORCED-NO-FEE
 16209                      MOVE ER-2751  TO WS-ERROR
 16210                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16211                 ELSE
 16212                   MOVE ER-2752  TO WS-ERROR
 16213                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16214
 16215     IF AH-COVERAGE-CANCELLED
 16216        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16217         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16218         MOVE WS-CURRENT-MONTH-END
 16219                                 TO DC-BIN-DATE-2
 16220         SET ELAPSED-BETWEEN-BIN TO TRUE
 16221*        MOVE 1                  TO DC-OPTION-CODE
 16222         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16223         IF DATE-CONVERSION-ERROR
 16224            NEXT SENTENCE
 16225          ELSE
 16226             IF DC-ELAPSED-DAYS GREATER +180
 16227                IF PB-CANCEL-DATE-FORCED OR
 16228                   PB-CANCEL-DATE-FORCED-NO-FEE
 16229                      MOVE ER-2751  TO WS-ERROR
 16230                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16231                 ELSE
 16232                   MOVE ER-2752  TO WS-ERROR
 16233                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16234
 16235     IF WS-ERROR = ER-2752
 16236        AND (PB-COMPANY-ID = 'ABL'
 16237         OR  PB-COMPANY-ID = 'FGL'
 16238         OR  PB-COMPANY-ID = 'IST'
 16239         OR  PB-COMPANY-ID = 'JHL'
 16240         OR  PB-COMPANY-ID = 'LAP'
 16241         OR  PB-COMPANY-ID = 'LBL'
 16242         OR  PB-COMPANY-ID = 'NCB'
 16243         OR  PB-COMPANY-ID = 'NLI'
 16244         OR  PB-COMPANY-ID = 'OFI'
 16245         OR  PB-COMPANY-ID = 'PLI'
 16246         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 294
* EL050.cbl
 16247         OR  PB-COMPANY-ID = 'TIC'
 16248         OR  PB-COMPANY-ID = 'HER'
 16249         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16250         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16251            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16252            MOVE ER-2762     TO WS-ERROR
 16253            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16254
 16255     IF LF-COVERAGE-CANCELLED
 16256        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16257        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16258             MOVE ER-2733         TO WS-ERROR
 16259             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16260
 16261     IF AH-COVERAGE-CANCELLED
 16262        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16263        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16264              MOVE ER-2733        TO WS-ERROR
 16265              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16266
 16267     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16268        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16269        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16270           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16271            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16272              IF PB-COMPANY-ID NOT = 'LAP'
 16273               MOVE ER-2704            TO WS-ERROR
 16274               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16275
 16276     IF CERT-WAS-NOT-FOUND
 16277         GO TO 3999-END-EDIT.
 16278
 16279     IF PB-COMPANY-ID EQUAL 'CDC'
 16280        IF LF-COVERAGE-CANCELLED
 16281           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16282            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16283            MOVE PB-C-LF-CANCEL-DT
 16284                                 TO DC-BIN-DATE-2
 16285            SET ELAPSED-BETWEEN-BIN TO TRUE
 16286*           MOVE 1               TO DC-OPTION-CODE
 16287            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16288            IF DATE-CONVERSION-ERROR
 16289               NEXT SENTENCE
 16290             ELSE
 16291                IF DC-ELAPSED-DAYS GREATER +60
 16292                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16293
 16294     IF PB-COMPANY-ID EQUAL 'CDC'
 16295        IF AH-COVERAGE-CANCELLED
 16296           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16297            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16298            MOVE PB-C-AH-CANCEL-DT
 16299                                 TO DC-BIN-DATE-2
 16300            MOVE +0              TO DC-ELAPSED-DAYS
 16301                                    DC-ELAPSED-MONTHS
 16302            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16303*           MOVE 1               TO DC-OPTION-CODE
 16304            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 295
* EL050.cbl
 16305            IF DATE-CONVERSION-ERROR
 16306               NEXT SENTENCE
 16307             ELSE
 16308                IF DC-ELAPSED-DAYS GREATER +60
 16309                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16310
 16311     MOVE +0                     TO DC-ELAPSED-DAYS
 16312                                    DC-ELAPSED-MONTHS.
 16313
 16314     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16315        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16316          MOVE 'Z'                TO PB-CI-OB-FLAG
 16317          MOVE ER-2767            TO WS-ERROR
 16318          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16319          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16320          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16321          GO TO 3775-OVER-REF-CHK
 16322        ELSE
 16323          MOVE ZEROS              TO PB-CI-LIVES
 16324                                     PB-C-LIVES
 16325          IF PB-CI-OB-FLAG NOT = 'B'
 16326             MOVE SPACE           TO PB-CI-OB-FLAG.
 16327
 16328     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16329         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16330     ELSE
 16331         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16332
 16333     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16334        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16335            MOVE ER-2760         TO WS-ERROR
 16336            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16337
 16338     IF LF-COVERAGE-CANCELLED
 16339        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16340         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16341            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16342               MOVE ER-2774       TO WS-ERROR
 16343               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16344
 16345     IF AH-COVERAGE-CANCELLED
 16346        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16347         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16348            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16349               MOVE ER-2775       TO WS-ERROR
 16350               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16351
 16352     IF LF-COVERAGE-CANCELLED
 16353        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16354         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16355            MOVE ER-2776         TO WS-ERROR
 16356            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16357
 16358     IF AH-COVERAGE-CANCELLED
 16359        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16360         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16361            MOVE ER-2777         TO WS-ERROR
 16362            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 296
* EL050.cbl
 16363
 16364     IF LF-COVERAGE-CANCELLED
 16365        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16366        if pb-ci-lf-expire-dt = low-values or spaces
 16367           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16368           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16369           MOVE PB-CI-EXTENTION-DAYS
 16370                                 TO DC-ELAPSED-DAYS
 16371           SET BIN-PLUS-ELAPSED  TO TRUE
 16372           PERFORM 8500-DATE-CONVERT
 16373                                 THRU 8500-EXIT
 16374           IF DATE-CONVERSION-ERROR
 16375              move low-values    to dc-bin-date-2
 16376           end-if
 16377        else
 16378           move pb-ci-lf-expire-dt
 16379                                 to dc-bin-date-2
 16380        end-if
 16381        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16382           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16383                             OR  'FIA'
 16384              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16385           ELSE
 16386              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16387              MOVE ER-2731       TO WS-ERROR
 16388              PERFORM 9900-ERROR-FORMAT
 16389                                 THRU 9900-EXIT
 16390           end-if
 16391        end-if
 16392     end-if
 16393*    IF LF-COVERAGE-CANCELLED
 16394*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16395*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16396*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16397*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16398*        SET BIN-PLUS-ELAPSED      TO TRUE
 16399*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16400*        IF DATE-CONVERSION-ERROR
 16401*           NEXT SENTENCE
 16402*         ELSE
 16403*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16404*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16405*                            OR  'FIA'
 16406*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16407*              ELSE
 16408*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16409*               MOVE ER-2731       TO WS-ERROR
 16410*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16411     .
 16412 3705-EDIT-AH-CANCEL-DT.
 16413     IF AH-COVERAGE-CANCELLED
 16414        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16415        if pb-ci-AH-expire-dt = low-values or spaces
 16416           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16417           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16418           MOVE PB-CI-EXTENTION-DAYS
 16419                                 TO DC-ELAPSED-DAYS
 16420           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 297
* EL050.cbl
 16421           PERFORM 8500-DATE-CONVERT
 16422                                 THRU 8500-EXIT
 16423           IF DATE-CONVERSION-ERROR
 16424              move low-values    to dc-bin-date-2
 16425           end-if
 16426        else
 16427           move pb-ci-ah-expire-dt
 16428                                 to dc-bin-date-2
 16429        end-if
 16430        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16431           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16432                             OR  'FIA'
 16433              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16434           ELSE
 16435              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16436              MOVE ER-2771       TO WS-ERROR
 16437              PERFORM 9900-ERROR-FORMAT
 16438                                 THRU 9900-EXIT
 16439           end-if
 16440        end-if
 16441     end-if
 16442*    IF AH-COVERAGE-CANCELLED
 16443*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16444*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16445*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16446*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16447**       MOVE 6                    TO DC-OPTION-CODE
 16448*        SET BIN-PLUS-ELAPSED      TO TRUE
 16449*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16450*        IF DATE-CONVERSION-ERROR
 16451*           NEXT SENTENCE
 16452*         ELSE
 16453*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16454*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16455*                             OR 'FIA'
 16456*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16457*             ELSE
 16458*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16459*              MOVE ER-2771       TO WS-ERROR
 16460*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16461     .
 16462 3705-EDIT-CONTINUED.
 16463
 16464*    IF LF-COVERAGE-CANCELLED
 16465*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16466*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16467*            MOVE ER-2727         TO WS-ERROR
 16468*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16469*
 16470*    IF AH-COVERAGE-CANCELLED
 16471*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16472*        IF PB-COMPANY-ID = 'ACE'
 16473*           MOVE ER-2727        TO WS-ERROR
 16474*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16475*        ELSE
 16476*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16477*              MOVE ER-2727     TO WS-ERROR
 16478*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 298
* EL050.cbl
 16479
 16480     IF PB-COMPANY-ID = 'ACE'
 16481       IF AH-COVERAGE-CANCELLED
 16482         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16483           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16484              MOVE ER-2732      TO WS-ERROR
 16485              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16486
 16487     IF PB-COMPANY-ID      EQUAL   'HER'
 16488        IF WS-ERROR        EQUAL   ER-2727
 16489            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16490            MOVE  ER-2725          TO  WS-ERROR
 16491            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16492
 16493     IF PB-C-CLAIM-CREATED-CANCEL
 16494            MOVE ER-2748         TO WS-ERROR
 16495            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16496
 16497     IF PB-C-LAST-NAME NOT = SPACES
 16498         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16499            MOVE ER-2747         TO WS-ERROR
 16500            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16501
 16502 3710-EDIT-LUMP-SUM-PRIOR.
 16503
 16504     IF AH-COVERAGE-CANCELLED
 16505         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16506             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16507                MOVE ER-2735    TO WS-ERROR
 16508                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16509
 16510     IF LF-COVERAGE-CANCELLED
 16511         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16512             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16513                MOVE ER-2735    TO WS-ERROR
 16514                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16515
 16516 3710-EDIT-PRIOR-DEATH.
 16517
 16518*    IF LF-COVERAGE-CANCELLED
 16519*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16520*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16521*           (NOT PB-CI-OB)
 16522*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16523*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16524*                   MOVE ER-2732  TO WS-ERROR
 16525*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16526*
 16527*    IF AH-COVERAGE-CANCELLED
 16528*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16529*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16530*           (NOT PB-CI-OB)
 16531*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16532*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16533*                   MOVE ER-2732  TO WS-ERROR
 16534*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16535
 16536     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 299
* EL050.cbl
 16537         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16538            (NOT PB-COMP-LF-CANCEL)
 16539             NEXT SENTENCE
 16540         ELSE
 16541           IF PB-C-LF-CANCEL-VOIDED
 16542              NEXT SENTENCE
 16543           ELSE
 16544              MOVE ER-2753      TO WS-ERROR
 16545              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16546
 16547     IF CANCEL-FUTURE-DT
 16548         GO TO 3999-END-EDIT.
 16549
 16550 3715-GET-REMAIN-TERM-LF.
 16551
 16552     IF NO-LF-BENEFIT-MATCH  OR
 16553        WS-LF-BENEFIT-CD = ZEROS
 16554        GO TO 3730-GET-AH-REMAIN-TERM.
 16555
 16556     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16557     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16558     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16559     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16560     MOVE PB-SV-STATE            TO CP-STATE.
 16561     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16562     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16563     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16564     MOVE '2'                    TO CP-PROCESS-TYPE.
 16565     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16566     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16567     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16568     IF (PB-COMPANY-ID = 'CID')
 16569        AND (CP-STATE-STD-ABBRV = 'WI')
 16570        MOVE '7'                 TO CP-REM-TERM-METHOD
 16571        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16572     ELSE
 16573        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16574        MOVE WS-REM-TRM-CALC-OPTION
 16575                                 TO CP-REM-TRM-CALC-OPTION
 16576     END-IF
 16577**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16578     IF (PB-COMPANY-ID = 'CID')
 16579        AND (CP-STATE-STD-ABBRV = 'MO')
 16580        AND (PB-CERT-EFF-DT >= X'9B41')
 16581        AND (PB-CERT-EFF-DT <= X'A2FB')
 16582        MOVE '7'                 TO CP-REM-TERM-METHOD
 16583        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16584     END-IF
 16585     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16586                                    CP-LOAN-TERM.
 16587     IF CP-TRUNCATED-LIFE
 16588        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16589
 16590     IF CP-TERM-IS-DAYS
 16591         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16592     ELSE
 16593         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16594
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 300
* EL050.cbl
 16595     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16596
 16597     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16598
 16599     IF LF-COVERAGE-CANCELLED
 16600        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16601        NEXT SENTENCE
 16602      ELSE
 16603          GO TO 3730-GET-AH-REMAIN-TERM.
 16604
 16605 3720-GET-LF-REFUND.
 16606
 16607     IF PB-C-LF-CANCEL-VOIDED
 16608        GO TO 3730-GET-AH-REMAIN-TERM
 16609     end-if
 16610
 16611     IF PB-COMPANY-ID EQUAL 'BOA'
 16612         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16613         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16614         GO TO 3730-GET-AH-REMAIN-TERM.
 16615
 16616     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16617        (WS-AH-SPECIAL-CALC-CD = 'M')
 16618         MOVE ER-2767            TO WS-ERROR
 16619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16620         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16621         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16622         GO TO 3780-UPDATE-CANCEL-CERT.
 16623
 16624*    if (ws-lf-earnings-calc = '6')
 16625*       or (pb-c-lf-refund-override = '6')
 16626*       move cp-remaining-term-1 to cp-remaining-term-2
 16627*    end-if
 16628     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16629
 16630     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16631     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16632     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16633     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16634     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16635     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16636     IF PB-COMPANY-ID = 'DCC'
 16637        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16638        IF PDEF-MASTER-FOUND
 16639           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16640              (V1 > +8)
 16641              OR (PD-PROD-CODE (V1) = 'L')
 16642           END-PERFORM
 16643           IF V1 < +9
 16644              MOVE PD-MAX-AMT (V1)
 16645                           TO CP-R-MAX-TOT-BEN
 16646                              EC-AM-LF-MAX-TOT-BEN
 16647           END-IF
 16648        ELSE
 16649        MOVE ' '                 TO PDEF-MASTER-SW
 16650        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16651        MOVE PB-STATE            TO ERPDEF-STATE
 16652        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 301
* EL050.cbl
 16653           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16654        END-IF
 16655        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16656        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16657        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16658        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16659        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16660        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16661        IF PDEF-MASTER-FOUND
 16662           MOVE 'N'              TO PDEF-MASTER-SW
 16663           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16664           IF PDEF-MASTER-FOUND
 16665              IF (ERPDEF-KEY-SAVE (1:16) =
 16666                           PD-CONTROL-PRIMARY (1:16))
 16667                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16668                 CONTINUE
 16669              ELSE
 16670                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16671                 IF (ERPDEF-KEY-SAVE (1:16) =
 16672                           PD-CONTROL-PRIMARY (1:16))
 16673                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16674                    CONTINUE
 16675                 ELSE
 16676                    MOVE 'N'     TO PDEF-MASTER-SW
 16677                 END-IF
 16678              END-IF
 16679
 16680              IF PDEF-MASTER-FOUND
 16681                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16682                    (V1 > +8)
 16683                    OR (PD-PROD-CODE (V1) = 'L')
 16684                 END-PERFORM
 16685                 IF V1 < +9
 16686                    MOVE PD-MAX-AMT (V1)
 16687                                 TO CP-R-MAX-TOT-BEN
 16688                                    EC-AM-LF-MAX-TOT-BEN
 16689                 END-IF
 16690              END-IF
 16691           END-IF
 16692           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16693        END-IF
 16694        END-IF
 16695     END-IF
 16696     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16697
 16698     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16699
 16700     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16701                                    PB-C-LF-REM-TERM.
 16702
 16703     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16704     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16705
 16706     IF PB-COMPANY-ID EQUAL 'FLC'
 16707        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16708           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16709           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16710                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 302
* EL050.cbl
 16711                    - CM-LF-ITD-DEATH-AMT
 16712           IF PB-C-LF-REF-CALC LESS THAN +0
 16713              MOVE +0            TO PB-C-LF-REF-CALC
 16714              GO TO 3730-GET-AH-REMAIN-TERM
 16715           ELSE
 16716              GO TO 3730-GET-AH-REMAIN-TERM.
 16717
 16718     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16719                            OR '4' OR '5' OR '6' OR '8'
 16720                            OR '9' OR 'G'
 16721        MOVE PB-C-LF-REFUND-OVERRIDE
 16722                                 TO CP-EARNING-METHOD.
 16723
 16724     if pb-company-id = 'AHL'
 16725        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16726        if cp-class-code = spaces
 16727           move zeros            to cp-class-code
 16728        end-if
 16729     ELSE
 16730        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16731     END-IF
 16732*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16733     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16734     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16735                                    CP-RATING-BENEFIT-AMT.
 16736     IF CP-STATE-STD-ABBRV = 'OR'
 16737         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16738                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16739     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16740     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16741     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16742     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16743     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16744     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16745     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16746     IF WS-DEFAULT-APR NOT NUMERIC
 16747         MOVE ZEROS TO WS-DEFAULT-APR.
 16748****   N O T E   ****
 16749*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16750*      THE OH HARD CODING IN ELCRFNDP
 16751
 16752     IF PB-COMPANY-ID = 'CID'
 16753        IF CP-STATE-STD-ABBRV = 'OH'
 16754           MOVE WS-LF-EARNINGS-CALC
 16755                                 TO CP-EARNING-METHOD
 16756        END-IF
 16757     END-IF
 16758
 16759****   N O T E   ****
 16760
 16761*    IF CP-EARN-AS-NET-PAY
 16762*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16763*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16764*               MOVE WS-DEFAULT-APR
 16765*                                TO  CP-LOAN-APR
 16766*               MOVE ER-3780     TO  WS-ERROR
 16767*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16768*           ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 303
* EL050.cbl
 16769*               MOVE ER-3781     TO  WS-ERROR
 16770*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16771*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16772     move ' '                    to cp-ext-days-calc
 16773     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16774
 16775     IF CP-REFUND-TYPE-USED NOT = SPACE
 16776         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16777
 16778     IF CP-ERROR-RATE-IS-ZERO OR
 16779        CP-ERROR-RATE-NOT-FOUND
 16780        MOVE ER-2740             TO WS-ERROR
 16781        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16782
 16783     IF CP-ERROR-RATE-FILE-NOTOPEN
 16784        MOVE ER-2617             TO WS-ERROR
 16785        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16786
 16787     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16788        AND PB-CI-ENTRY-STATUS = 'M'
 16789        MOVE +0                  TO PB-C-LF-REF-CALC
 16790     ELSE
 16791        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16792     END-IF
 16793
 16794     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16795         GO TO 3730-GET-AH-REMAIN-TERM.
 16796
 16797*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16798*       ADD +1                   TO PB-C-LF-REM-TERM
 16799*                                   CP-REMAINING-TERM
 16800*                                   CP-ORIGINAL-TERM.
 16801
 16802     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16803     MOVE '2'                    TO CP-EARNING-METHOD
 16804                                    CP-RATING-METHOD.
 16805     IF PB-COMPANY-ID = 'CID'
 16806        IF (CP-STATE-STD-ABBRV = 'MN')
 16807           AND (PB-CERT-EFF-DT > X'A4FF')
 16808           AND (WS-LF-EARNINGS-CALC = 'B')
 16809           MOVE '5'              TO CP-EARNING-METHOD
 16810           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16811        END-IF
 16812     END-IF
 16813     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16814                                        CP-REMAINING-BENEFIT
 16815                                        CP-RATING-BENEFIT-AMT.
 16816     IF CP-STATE-STD-ABBRV = 'OR'
 16817         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16818                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16819     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16820     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16821
 16822     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16823
 16824     IF CP-ERROR-RATE-IS-ZERO OR
 16825        CP-ERROR-RATE-NOT-FOUND
 16826        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 304
* EL050.cbl
 16827        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16828
 16829     IF CP-ERROR-RATE-FILE-NOTOPEN
 16830        MOVE ER-2617             TO WS-ERROR
 16831        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16832
 16833     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16834
 16835******************************************************************
 16836
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 305
* EL050.cbl
 16838 3730-GET-AH-REMAIN-TERM.
 16839     IF NO-AH-BENEFIT-MATCH  OR
 16840        WS-AH-BENEFIT-CD = ZEROS
 16841         GO TO 3770-CHECK-REFUNDS.
 16842
 16843     IF PB-CI-AH-LUMP-SUM-DISAB
 16844         IF  PB-C-AH-CANCEL-AMT = ZERO
 16845            IF NOT PB-COMP-AH-CANCEL
 16846             GO TO 3770-CHECK-REFUNDS.
 16847
 16848     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16849     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16850     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16851     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16852     MOVE PB-SV-STATE            TO CP-STATE.
 16853     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16854     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16855     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16856     MOVE '2'                    TO CP-PROCESS-TYPE.
 16857     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16858     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16859     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16860     IF (PB-COMPANY-ID = 'CID')
 16861        AND (CP-STATE-STD-ABBRV = 'WI')
 16862        MOVE '7'                 TO CP-REM-TERM-METHOD
 16863        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16864     ELSE
 16865        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16866        MOVE WS-REM-TRM-CALC-OPTION
 16867                                 TO CP-REM-TRM-CALC-OPTION
 16868     END-IF
 16869     IF (PB-COMPANY-ID = 'CID')
 16870        AND (CP-STATE-STD-ABBRV = 'MO')
 16871        AND (PB-CERT-EFF-DT >= X'9B41')
 16872        AND (PB-CERT-EFF-DT <= X'A2FB')
 16873        MOVE '7'                 TO CP-REM-TERM-METHOD
 16874        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16875     END-IF
 16876     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16877                                    CP-LOAN-TERM.
 16878     IF NOT CP-TERM-IS-DAYS
 16879         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16880
 16881     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16882
 16883     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16884
 16885     IF AH-COVERAGE-CANCELLED
 16886        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16887        NEXT SENTENCE
 16888      ELSE
 16889         GO TO 3770-CHECK-REFUNDS.
 16890
 16891 3740-GET-AH-REFUND.
 16892
 16893     IF PB-C-AH-CANCEL-VOIDED
 16894        GO TO 3780-UPDATE-CANCEL-CERT
 16895     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 306
* EL050.cbl
 16896
 16897     IF PB-COMPANY-ID = 'BOA'
 16898         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16899         GO TO 3770-CHECK-REFUNDS.
 16900
 16901     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16902*    MOVE ' '                    TO DC-OPTION-CODE
 16903     SET BIN-TO-GREG             TO TRUE
 16904     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16905     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16906                                    PB-C-AH-REM-TERM.
 16907     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16908     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16909
 16910     IF PB-COMPANY-ID EQUAL 'FLC'
 16911        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16912           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16913           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16914                    - CM-AH-ITD-AH-PMT)
 16915           IF PB-C-AH-REF-CALC LESS THAN +0
 16916              MOVE +0            TO PB-C-AH-REF-CALC
 16917              GO TO 3770-CHECK-REFUNDS
 16918           ELSE
 16919              GO TO 3770-CHECK-REFUNDS.
 16920
 16921     IF PB-COMPANY-ID = 'DCC'
 16922        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16923            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16924           MOVE 'S'              TO CP-EARNING-METHOD
 16925        END-IF
 16926     END-IF
 16927     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16928                            OR '4' OR '5' OR '6' OR '8'
 16929                            OR '9' OR 'G' OR 'S'
 16930        MOVE PB-C-AH-REFUND-OVERRIDE
 16931                                 TO CP-EARNING-METHOD.
 16932
 16933     if pb-company-id = 'AHL'
 16934        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16935        if cp-class-code = spaces
 16936           move zeros            to cp-class-code
 16937        end-if
 16938     ELSE
 16939        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16940     END-IF
 16941*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16942     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16943     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16944                                    CP-RATING-BENEFIT-AMT.
 16945     IF CP-STATE-STD-ABBRV = 'OR'
 16946         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16947                                         PB-CI-AH-TERM.
 16948     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16949     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16950     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16951     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16952     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16953     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 307
* EL050.cbl
 16954
 16955     IF CP-STATE-STD-ABBRV = 'OH'
 16956        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16957                                AND 'CID' AND 'DCC' and 'VPP'
 16958                                AND 'AHL')
 16959           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16960              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16961              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16962              MOVE '6' TO CP-EARNING-METHOD
 16963           END-IF
 16964        END-IF
 16965        IF PB-COMPANY-ID = 'CID'
 16966           IF NO-LIFE-COVERAGE
 16967              IF CP-CRITICAL-PERIOD
 16968                 MOVE '2'       TO CP-EARNING-METHOD
 16969              ELSE
 16970                 MOVE '6'       TO CP-EARNING-METHOD
 16971              END-IF
 16972           ELSE
 16973              IF WS-LF-COVERAGE-TYPE = 'L'
 16974                 MOVE '2'       TO CP-EARNING-METHOD
 16975              ELSE
 16976                 IF (PB-CI-LF-TERM > +60) OR
 16977                    (WS-LF-EARNINGS-CALC = '5')
 16978                    IF CP-CRITICAL-PERIOD
 16979                       MOVE '2'  TO CP-EARNING-METHOD
 16980                    ELSE
 16981                       MOVE '6'  TO CP-EARNING-METHOD
 16982                    END-IF
 16983                 ELSE
 16984                    MOVE '1'     TO CP-EARNING-METHOD
 16985                 END-IF
 16986              END-IF
 16987           END-IF
 16988        END-IF
 16989     END-IF
 16990
 16991*    IF CP-STATE-STD-ABBRV = 'VA'
 16992*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16993*          IF CP-ORIGINAL-TERM GREATER 61
 16994*             MOVE '6' TO CP-EARNING-METHOD
 16995*          ELSE
 16996*             MOVE '1' TO CP-EARNING-METHOD.
 16997
 16998     IF WS-DEFAULT-APR NOT NUMERIC
 16999         MOVE ZEROS TO WS-DEFAULT-APR.
 17000     IF CP-EARN-AS-NET-PAY
 17001         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 17002            IF WS-DEFAULT-APR GREATER THAN ZEROS
 17003                MOVE WS-DEFAULT-APR
 17004                                 TO  CP-LOAN-APR
 17005                MOVE ER-3780     TO  WS-ERROR
 17006                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 17007            ELSE
 17008                MOVE ER-3781     TO  WS-ERROR
 17009                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 17010     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17011     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 308
* EL050.cbl
 17012        AND CP-CANCEL-REASON = 'R'
 17013        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17014        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 17015     END-IF
 17016     IF PB-COMPANY-ID = 'DCC'
 17017        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17018        AND (CP-EARNING-METHOD = 'D')
 17019        AND (CP-CANCEL-REASON NOT = 'R')
 17020        CONTINUE
 17021     ELSE
 17022        GO TO 3750-CONTINUE
 17023     END-IF
 17024     MOVE ' '                    TO DD-IU-SW
 17025     IF NOT PDEF-MASTER-FOUND
 17026        MOVE ' '                 TO PDEF-MASTER-SW
 17027        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17028        MOVE PB-STATE            TO ERPDEF-STATE
 17029        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 17030           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 17031        END-IF
 17032        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17033        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17034        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17035        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17036        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17037        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17038        IF PDEF-MASTER-FOUND
 17039           MOVE 'N'              TO PDEF-MASTER-SW
 17040           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17041           IF PDEF-MASTER-FOUND
 17042              IF (ERPDEF-KEY-SAVE (1:16) =
 17043                           PD-CONTROL-PRIMARY (1:16))
 17044                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17045                 CONTINUE
 17046              ELSE
 17047                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17048                 IF (ERPDEF-KEY-SAVE (1:16) =
 17049                           PD-CONTROL-PRIMARY (1:16))
 17050                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17051                    CONTINUE
 17052                 ELSE
 17053                    MOVE ER-2740 TO WS-ERROR
 17054                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17055                    GO TO 3770-CHECK-REFUNDS
 17056                 END-IF
 17057              END-IF
 17058           END-IF
 17059           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17060        END-IF
 17061     END-IF
 17062     IF PDEF-MASTER-FOUND
 17063        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17064           (V1 > +8)
 17065           OR (PD-PROD-CODE (V1) = 'I')
 17066        END-PERFORM
 17067        IF V1 < +9
 17068           SET DD-IU-PRESENT        TO TRUE
 17069        END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 309
* EL050.cbl
 17070        IF WS-AH-DCC-TRUNC = 'T'
 17071           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17072        ELSE
 17073           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17074        END-IF
 17075        EVALUATE TRUE
 17076           WHEN WS-TERM > +168
 17077              MOVE 15               TO V1
 17078           WHEN WS-TERM > +156
 17079              MOVE 14               TO V1
 17080           WHEN WS-TERM > +144
 17081              MOVE 13               TO V1
 17082           WHEN WS-TERM > +132
 17083              MOVE 12               TO V1
 17084           WHEN WS-TERM > +120
 17085              MOVE 11               TO V1
 17086           WHEN WS-TERM > +108
 17087              MOVE 10               TO V1
 17088           WHEN WS-TERM > +96
 17089              MOVE 9                TO V1
 17090           WHEN WS-TERM > +84
 17091              MOVE 8                TO V1
 17092           WHEN WS-TERM > +72
 17093              MOVE 7                TO V1
 17094           WHEN WS-TERM > +60
 17095              MOVE 6                TO V1
 17096           WHEN WS-TERM > +48
 17097              MOVE 5                TO V1
 17098           WHEN WS-TERM > +36
 17099              MOVE 4                TO V1
 17100           WHEN WS-TERM > +24
 17101              MOVE 3                TO V1
 17102           WHEN WS-TERM > +12
 17103              MOVE 2                TO V1
 17104           WHEN OTHER
 17105              MOVE 1                TO V1
 17106        END-EVALUATE
 17107
 17108        EVALUATE TRUE
 17109*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17110*             < +13)
 17111*             AND (DD-IU-PRESENT)
 17112*             MOVE 2                TO V2
 17113*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17114*             MOVE 1                TO V2
 17115           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17116              MOVE 2                TO V2
 17117           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17118              MOVE 3                TO V2
 17119           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17120              MOVE 4                TO V2
 17121           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17122              MOVE 5                TO V2
 17123           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17124              MOVE 6                TO V2
 17125           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17126              MOVE 7                TO V2
 17127           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 310
* EL050.cbl
 17128              MOVE 8                TO V2
 17129           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17130              MOVE 9                TO V2
 17131           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17132              MOVE 10               TO V2
 17133           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17134              MOVE 11               TO V2
 17135           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17136              MOVE 12               TO V2
 17137           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17138              MOVE 13               TO V2
 17139           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17140              MOVE 14               TO V2
 17141           WHEN OTHER
 17142              MOVE 15               TO V2
 17143        END-EVALUATE
 17144
 17145        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17146                                 TO CP-DDF-LO-FACT
 17147        MOVE PD-UEP-FACTOR (V1 V2)
 17148                                 TO CP-DDF-HI-FACT
 17149
 17150        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17151        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17152        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17153           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17154        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17155        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17156        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17157           + PD-1ST-YR-ADMIN-ALLOW
 17158
 17159        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17160*       IF PI-CLP-YN = 'Y'
 17161*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17162*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17163*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17164*       END-IF
 17165
 17166        IF DD-IU-PRESENT
 17167           MOVE 'I'              TO CP-EARNING-METHOD
 17168        END-IF
 17169        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17170                                     CP-CLP-RATE-UP
 17171        IF CP-IU-RATE-UP NOT = ZEROS
 17172           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17173              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17174           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17175              / (1 - WS-WORK-FACT)
 17176        END-IF
 17177     END-IF
 17178     .
 17179 3750-CONTINUE.
 17180     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17181
 17182     IF CP-REFUND-TYPE-USED NOT = SPACE
 17183         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17184
 17185     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 311
* EL050.cbl
 17186        CP-ERROR-RATE-NOT-FOUND
 17187        MOVE ER-2740             TO WS-ERROR
 17188        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17189
 17190     IF CP-ERROR-RATE-FILE-NOTOPEN
 17191        MOVE ER-2617             TO WS-ERROR
 17192        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17193     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17194        AND (PB-CI-ENTRY-STATUS = 'M')
 17195        MOVE +0                  TO PB-C-AH-REF-CALC
 17196     ELSE
 17197        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17198     END-IF
 17199     if pb-company-id = 'VPP'
 17200        MOVE cm-ah-clp           to cp-original-premium
 17201        move zeros               to cp-calc-refund
 17202        perform 7600-get-refund  thru 7600-exit
 17203        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17204           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17205        else
 17206           move zeros            to pb-c-ah-rfnd-clp
 17207        end-if
 17208        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17209           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17210           pb-ci-cancel-fee
 17211     end-if
 17212     IF PB-COMPANY-ID = 'DCC'
 17213        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17214        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17215        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17216        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17217        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17218        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17219        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17220        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17221*       if pb-c-cancel-amt < +0
 17222*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17223*       end-if
 17224*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17225     END-IF
 17226     .
 17227 3770-CHECK-REFUNDS.
 17228
 17229     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17230        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17231           MOVE ER-2766          TO WS-ERROR
 17232           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17233           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17234           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17235              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17236
 17237     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17238        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17239           MOVE ER-2766          TO WS-ERROR
 17240           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17241           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17242           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17243              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 312
* EL050.cbl
 17244
 17245     IF PB-COMP-LF-CANCEL
 17246        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17247        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17248           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17249              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17250
 17251     IF PB-COMP-AH-CANCEL
 17252        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17253        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17254           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17255              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17256
 17257     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17258             GIVING WS-UNSIGN-WRK1
 17259     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17260             GIVING WS-UNSIGN-WRK2.
 17261
 17262     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17263         MOVE ZERO TO WS-UNSIGN-WRK1.
 17264
 17265     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17266         MOVE ZERO TO WS-UNSIGN-WRK2.
 17267
 17268     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17269
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 313
* EL050.cbl
 17271
 17272 3772-CONTINUE.
 17273
 17274**********************************
 17275*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17276*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17277*** DOUBLES THE TOLERANCE AMOUNT.
 17278***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17279**********************************
 17280     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17281     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17282         IF WS-REF-REJECT-SW = SPACE
 17283             MOVE ER-2754        TO WS-ERROR
 17284             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17285           ELSE
 17286             MOVE ER-2736        TO WS-ERROR
 17287             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17288**********************************
 17289
 17290 3773-CONTINUE.
 17291
 17292     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17293        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17294           MOVE ER-2723          TO WS-ERROR
 17295           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17296
 17297     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17298        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17299           MOVE ER-2724          TO WS-ERROR
 17300           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17301
 17302     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17303         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17304             (1 + WS-LF-REFUND-OVS-PCT)
 17305     ELSE
 17306         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17307
 17308     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17309         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17310             (1 - WS-TOL-LF-REFUND-PCT)
 17311     ELSE
 17312         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17313
 17314     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17315        AND (PB-CI-ENTRY-STATUS = 'M')
 17316        AND (PB-C-LF-CANCEL-AMT > +0)
 17317        MOVE ER-3843             TO WS-ERROR
 17318        PERFORM 9900-ERROR-FORMAT
 17319                                 THRU 9900-EXIT
 17320     END-IF
 17321     EVALUATE TRUE
 17322        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17323           CONTINUE
 17324        WHEN PB-C-LF-CANCEL-AMT = +0
 17325                 AND PB-C-LF-REF-CALC > +0
 17326           CONTINUE
 17327        WHEN WS-LF-REFUND-OVS-AMT = 0
 17328                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 314
* EL050.cbl
 17329           CONTINUE
 17330        WHEN OTHER
 17331           IF WS-TOL-LF-REFUND  = +0
 17332              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17333           END-IF
 17334           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17335                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17336                          (PB-C-LF-CANCEL-AMT))
 17337              CONTINUE
 17338           ELSE
 17339              IF WS-LF-REFUND-OVS-AMT = +0
 17340                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17341              END-IF
 17342              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17343                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17344                                       PB-C-LF-CANCEL-AMT)
 17345                 CONTINUE
 17346              ELSE
 17347                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17348                   MOVE ER-2754   TO  WS-ERROR
 17349                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17350                 ELSE
 17351                    MOVE ER-2736   TO  WS-ERROR
 17352                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17353                 END-IF
 17354              END-IF
 17355           END-IF
 17356     END-EVALUATE.
 17357
 17358     EVALUATE TRUE
 17359        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17360           CONTINUE
 17361        WHEN PB-C-LF-CANCEL-AMT = +0
 17362                 AND PB-C-LF-REF-CALC > +0
 17363           CONTINUE
 17364        WHEN OTHER
 17365           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17366               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17367              CONTINUE
 17368           ELSE
 17369              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17370               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17371                CONTINUE
 17372              ELSE
 17373                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17374                     MOVE ER-2754   TO  WS-ERROR
 17375                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17376                 ELSE
 17377                     MOVE ER-2736   TO  WS-ERROR
 17378                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17379                 END-IF
 17380              END-IF
 17381           END-IF
 17382     END-EVALUATE.
 17383
 17384     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17385         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17386             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 315
* EL050.cbl
 17387     ELSE
 17388         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17389
 17390     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17391         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17392             (1 - WS-TOL-AH-REFUND-PCT)
 17393     ELSE
 17394         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17395
 17396     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17397        AND (PB-CI-ENTRY-STATUS = 'M')
 17398        AND (PB-C-AH-CANCEL-AMT > +0)
 17399        MOVE ER-3843             TO WS-ERROR
 17400        PERFORM 9900-ERROR-FORMAT
 17401                                 THRU 9900-EXIT
 17402     END-IF
 17403     EVALUATE TRUE
 17404        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17405           CONTINUE
 17406*       WHEN PB-C-AH-REF-CALC = +0 AND
 17407*                  PB-C-AH-CANCEL-AMT > +0
 17408        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17409                   PB-C-AH-REF-CALC > +0
 17410           CONTINUE
 17411        WHEN WS-AH-REFUND-OVS-AMT = +0
 17412                AND WS-TOL-AH-REFUND = +0
 17413           CONTINUE
 17414        WHEN OTHER
 17415           IF WS-TOL-AH-REFUND = +0
 17416              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17417           END-IF
 17418           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17419               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17420                                         PB-C-AH-CANCEL-AMT)
 17421              CONTINUE
 17422           ELSE
 17423              IF WS-AH-REFUND-OVS-AMT = +0
 17424                 MOVE +9999999.99 TO
 17425                         WS-AH-REFUND-OVS-AMT
 17426              END-IF
 17427              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17428                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17429                                         PB-C-AH-CANCEL-AMT)
 17430                 CONTINUE
 17431              ELSE
 17432                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17433                    MOVE ER-2754   TO  WS-ERROR
 17434                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17435                 ELSE
 17436                    MOVE ER-2736   TO  WS-ERROR
 17437                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17438                 END-IF
 17439              END-IF
 17440           END-IF
 17441     END-EVALUATE.
 17442
 17443     EVALUATE TRUE
 17444        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 316
* EL050.cbl
 17445           CONTINUE
 17446*       WHEN PB-C-AH-REF-CALC > +0 AND
 17447*                  PB-C-AH-CANCEL-AMT = +0
 17448        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17449                   PB-C-AH-REF-CALC = +0
 17450           CONTINUE
 17451        WHEN OTHER
 17452           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17453               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17454              CONTINUE
 17455           ELSE
 17456              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17457                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17458                 CONTINUE
 17459              ELSE
 17460                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17461                     MOVE ER-2754   TO  WS-ERROR
 17462                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17463                 ELSE
 17464                     MOVE ER-2736   TO  WS-ERROR
 17465                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17466                 END-IF
 17467              END-IF
 17468           END-IF
 17469     END-EVALUATE.
 17470
 17471     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17472        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17473        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17474           AND  PB-C-LF-REF-CALC < +1.00
 17475           AND  PB-C-AH-REF-CALC < +1.00
 17476           CONTINUE
 17477        ELSE
 17478           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17479              AND (PB-CI-ENTRY-STATUS = 'M')
 17480              CONTINUE
 17481           ELSE
 17482              MOVE ER-2741       TO WS-ERROR
 17483              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17484           END-IF
 17485        END-IF
 17486     END-IF
 17487
 17488     IF (PB-C-LF-CANCEL-AMT = ZERO
 17489        AND WS-LF-BENEFIT-CD NOT = ZERO
 17490        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17491        AND PB-C-LF-REF-CALC NOT = ZERO)
 17492        OR
 17493        (PB-C-LF-CANCEL-AMT = ZERO
 17494        AND WS-LF-BENEFIT-CD NOT = ZERO
 17495        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17496             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17497                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17498                NEXT SENTENCE
 17499             ELSE
 17500                MOVE ER-2739        TO WS-ERROR
 17501                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17502
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 317
* EL050.cbl
 17503     IF (PB-C-AH-CANCEL-AMT = ZERO
 17504        AND WS-AH-BENEFIT-CD NOT = ZERO
 17505        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17506        AND PB-C-AH-REF-CALC NOT = ZERO)
 17507        OR
 17508        (PB-C-AH-CANCEL-AMT = ZERO
 17509        AND WS-AH-BENEFIT-CD NOT = ZERO
 17510        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17511             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17512                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17513                NEXT SENTENCE
 17514             ELSE
 17515                MOVE ER-2738        TO WS-ERROR
 17516                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17517
 17518 3775-OVER-REF-CHK.
 17519
 17520     IF PB-CI-ENTRY-STATUS = '5'
 17521        GO TO 3780-UPDATE-CANCEL-CERT.
 17522
 17523     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17524                              PB-CI-LF-ALT-PREMIUM-AMT.
 17525
 17526     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17527        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17528                                 PB-C-LF-REF-CALC
 17529      ELSE
 17530        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17531                                 PB-C-LF-CANCEL-AMT.
 17532
 17533     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17534        MOVE ER-2755             TO WS-ERROR
 17535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17536
 17537     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17538
 17539     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17540        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17541                                 PB-C-AH-REF-CALC
 17542      ELSE
 17543        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17544                                 PB-C-AH-CANCEL-AMT.
 17545
 17546     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17547        MOVE ER-2778             TO WS-ERROR
 17548        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17549
 17550     IF PB-CI-OB-FLAG NOT = 'Z'
 17551        NEXT SENTENCE
 17552       ELSE
 17553         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17554            MOVE ER-2757           TO WS-ERROR
 17555            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17556
 17557 3780-UPDATE-CANCEL-CERT.
 17558
 17559     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17560        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 318
* EL050.cbl
 17561        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17562
 17563     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17564         MOVE ER-2729              TO WS-ERROR
 17565         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17566
 17567     IF PB-CI-LF-BENEFIT-CD = ZERO
 17568         GO TO 3780-UPDATE-CONT-1.
 17569
 17570     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17571         GO TO 3780-UPDATE-CONT-1.
 17572
 17573     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17574       AND
 17575        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17576       AND
 17577        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17578       AND
 17579        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17580            NEXT SENTENCE
 17581       ELSE
 17582        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17583          AND
 17584***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17585***       AND
 17586           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17587            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17588               MOVE ER-2730      TO WS-ERROR
 17589               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17590               GO TO 3999-END-EDIT
 17591            ELSE
 17592               GO TO 3999-END-EDIT
 17593        ELSE
 17594            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17595               MOVE ER-2765           TO WS-ERROR
 17596               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17597               GO TO 3785-CHECK-REF-INT.
 17598*              GO TO 3999-END-EDIT.
 17599
 17600 3780-UPDATE-CONT-1.
 17601     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17602
 17603     IF PB-CI-AH-BENEFIT-CD = ZERO
 17604         GO TO 3780-UPDATE-CONT-2.
 17605
 17606     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17607         GO TO 3780-UPDATE-CONT-2.
 17608
 17609     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17610
 17611     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17612       AND
 17613        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17614       AND
 17615        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17616       AND
 17617        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17618            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 319
* EL050.cbl
 17619       ELSE
 17620        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17621          AND
 17622***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17623***       AND
 17624           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17625           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17626            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17627               MOVE ER-2773      TO WS-ERROR
 17628               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17629               GO TO 3999-END-EDIT
 17630            ELSE
 17631               GO TO 3999-END-EDIT
 17632            END-IF
 17633           ELSE
 17634             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17635                IF MSTR-CERT-NO = W-CL-CERT-NO
 17636                   MOVE ER-2890 TO WS-ERROR
 17637                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17638                   GO TO 3999-END-EDIT
 17639                ELSE
 17640                   MOVE ER-2898 TO WS-ERROR
 17641                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17642                   GO TO 3999-END-EDIT
 17643                END-IF
 17644             ELSE
 17645                GO TO 3785-CHECK-REF-INT
 17646             END-IF
 17647           END-IF
 17648          ELSE
 17649            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17650              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17651                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17652                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17653                      MOVE ER-2890 TO WS-ERROR
 17654                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17655                      GO TO 3999-END-EDIT
 17656                   ELSE
 17657                      MOVE ER-2898 TO WS-ERROR
 17658                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17659                      GO TO 3999-END-EDIT
 17660                   END-IF
 17661                ELSE
 17662                   MOVE ER-2765 TO WS-ERROR
 17663                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17664                   GO TO 3785-CHECK-REF-INT
 17665                END-IF
 17666              ELSE
 17667               MOVE ER-2765      TO WS-ERROR
 17668               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17669               GO TO 3785-CHECK-REF-INT.
 17670*              GO TO 3999-END-EDIT.
 17671
 17672 3780-UPDATE-CONT-2.
 17673
 17674     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17675        AND WS-LF-BENEFIT-CD = ZERO
 17676           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 320
* EL050.cbl
 17677           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17678
 17679     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17680        AND WS-AH-BENEFIT-CD = ZERO
 17681           MOVE ER-2744           TO WS-ERROR
 17682           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17683
 17684     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17685        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17686        AND
 17687        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17688         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17689           MOVE ER-2746           TO WS-ERROR
 17690           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17691
 17692     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17693       AND
 17694        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17695             MOVE ER-2737        TO WS-ERROR
 17696             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17697
 17698     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17699       AND
 17700        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17701             MOVE ER-2737        TO WS-ERROR
 17702             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17703
 17704     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17705         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17706             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17707             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17708         ELSE
 17709             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17710                 MOVE ER-2768    TO WS-ERROR
 17711                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17712             ELSE
 17713                 MOVE ER-2756    TO WS-ERROR
 17714                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17715
 17716     IF CERT-PEND-ISSUE-RETURNED
 17717        MOVE ER-2772             TO WS-ERROR
 17718        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17719 3785-CHECK-REF-INT.
 17720*    IF PB-STATE NOT = 'NH' and 'TN'
 17721     IF PB-STATE NOT = 'NH'
 17722        GO TO 3999-END-EDIT
 17723     END-IF
 17724
 17725     MOVE ER-2796                TO WS-ERROR
 17726     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17727     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17728        OR (CM-REF-INTERFACE-SW = 'Y')
 17729        MOVE ER-2793             TO WS-ERROR
 17730        PERFORM 9900-ERROR-FORMAT
 17731                                 THRU 9900-EXIT
 17732     END-IF
 17733     MOVE +0                     TO WS-PAYMENT-AMT
 17734     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 321
* EL050.cbl
 17735        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17736               PB-C-AH-CANCEL-DT
 17737           GO TO 3999-END-EDIT
 17738        END-IF
 17739     end-if
 17740***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17741***-_-
 17742***-_-   For TN it's only flat cancels
 17743***-_-
 17744***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17745     if pb-state = 'TN'
 17746        if ((pb-c-lf-cancel-dt <> low-values)
 17747           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17748                      or
 17749           ((pb-c-ah-cancel-dt <> low-values)
 17750           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17751           GO TO 3999-END-EDIT
 17752        END-IF
 17753     end-if
 17754     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17755        GO TO 3999-END-EDIT
 17756     END-IF
 17757***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17758***-_-
 17759***-_-   if cancel date within 15 days of effective date, bypass
 17760***-_-
 17761***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17762     IF PB-STATE NOT = 'NH'
 17763        GO TO 3785-CONTINUE
 17764     END-IF
 17765     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17766     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17767     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17768        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17769     END-IF
 17770     MOVE '1'                    TO DC-OPTION-CODE
 17771     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17772     IF NO-CONVERSION-ERROR
 17773        IF DC-ELAPSED-DAYS < +16
 17774           GO TO 3999-END-EDIT
 17775        END-IF
 17776     END-IF
 17777***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17778***-_-
 17779***-_-   if cancel date within 30 days of current date then
 17780***-_-   bypass else subtract 15 days from period
 17781***-_-
 17782***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17783     MOVE +0                     TO DC-ELAPSED-DAYS
 17784     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17785     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17786     MOVE '1'                    TO DC-OPTION-CODE
 17787     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17788     IF NO-CONVERSION-ERROR
 17789        IF DC-ELAPSED-DAYS > +30
 17790           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17791        ELSE
 17792           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 322
* EL050.cbl
 17793        END-IF
 17794     ELSE
 17795        GO TO 3999-END-EDIT
 17796     END-IF
 17797     .
 17798 3785-CONTINUE.
 17799     if pb-state = 'TN'
 17800        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17801        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17802        MOVE '1'                 TO DC-OPTION-CODE
 17803        PERFORM 8500-DATE-CONVERT
 17804                                 THRU 8500-EXIT
 17805        IF no-CONVERSION-ERROR
 17806           IF DC-ELAPSED-DAYS < +16
 17807              GO TO 3999-END-EDIT
 17808           END-IF
 17809        END-IF
 17810     end-if
 17811***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17812***-_-
 17813***-_-   'NH' is 10%, TN is 3.5%
 17814***-_-
 17815***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17816*    if pb-state = 'NH'
 17817*       move +1.10               to ws-work-rate
 17818*    else
 17819*       move +1.035              to ws-work-rate
 17820*    end-if
 17821     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17822     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17823        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17824           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17825     IF WS-PAYMENT-AMT < 10.00
 17826        GO TO 3999-END-EDIT
 17827     END-IF
 17828*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17829
 17830     if (cm-soc-sec-no(1:9) numeric)
 17831        and (cm-soc-sec-no(1:9) not = zeros)
 17832        GO TO 3999-END-EDIT
 17833     END-IF
 17834     MOVE ER-2795                TO WS-ERROR
 17835     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17836
 17837     GO TO 3999-END-EDIT.
 17838******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 323
* EL050.cbl
 17840 3990-FILES-NOT-OPEN.
 17841
 17842     MOVE ER-2617                TO WS-ERROR.
 17843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17844     GO TO 9990-RETURN.
 17845
 17846 3999-END-EDIT.
 17847
 17848     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17849
 17850     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17851         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17852         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17853             PERFORM 9250-UNLOCK-RETURN
 17854             GO TO 9990-RETURN
 17855          ELSE
 17856             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17857             GO TO 9990-RETURN.
 17858
 17859     IF PB-CANCELLATION
 17860          GO TO 9990-RETURN.
 17861
 17862     IF CERT-WAS-NOT-FOUND
 17863        MOVE SPACES              TO CERTIFICATE-MASTER.
 17864
 17865     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17866
 17867     IF CERT-WAS-FOUND
 17868         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17869             PERFORM 9250-UNLOCK-RETURN
 17870          ELSE
 17871            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17872      ELSE
 17873         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17874
 17875*    if pb-company-id = 'VPP'
 17876*       perform 8150-read-elcrtt thru 8150-exit
 17877*       if ws-vehicle-odometer numeric
 17878*          if ws-vehicle-odometer > 6000
 17879*             move er-1583       to ws-error
 17880*             PERFORM 9900-ERROR-FORMAT
 17881*                                THRU 9900-EXIT
 17882*          end-if
 17883*       end-if
 17884*    end-if
 17885     if pb-cert-sfx not = ' '
 17886        perform 7320-CHECK-FOR-OPEN-CLMS-issue
 17887                                 thru 7320-exit
 17888     end-if
 17889     perform 8145-read-elcrtt-upd thru 8145-exit
 17890     if not elcrtt-found
 17891        move 'CS'                to certificate-trailers
 17892        move cm-control-primary  to cs-control-primary
 17893        move 'C'                 TO cs-trailer-type
 17894        move zeros               to cs-vehicle-odometer
 17895     end-if
 17896     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17897        IF ((PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 324
* EL050.cbl
 17898           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17899                         or
 17900           (pb-company-id = 'CID' or 'VPP')
 17901           IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 17902               or (hldi-pass-area not = spaces)
 17903               move pa-modelyear        to cs-year
 17904               move pa-makename         to cs-make
 17905               move pa-modelname        to cs-model
 17906               move pa-seriesname       to cs-future
 17907               MOVE PB-I-VIN            TO CS-VIN-NUMBER
 17908               move 'Y'                 to elcrtt-update-sw
 17909           end-if
 17910        end-if
 17911     end-if
 17912     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17913        IF WS-INS-AGE-SET = 'Y'
 17914           MOVE WS-INS-AGE-DEFAULTED
 17915                                 TO CS-INS-AGE-DEFAULT-FLAG
 17916           move 'Y'              to elcrtt-update-sw
 17917        END-IF
 17918        IF WS-JNT-AGE-SET = 'Y'
 17919           MOVE WS-JNT-AGE-DEFAULTED
 17920                                 TO CS-JNT-AGE-DEFAULT-FLAG
 17921           move 'Y'              to elcrtt-update-sw
 17922        END-IF
 17923     end-if
 17924     move cs-ins-age-default-flag to ws-ins-age-defaulted
 17925     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 17926     move cs-vehicle-odometer    to ws-vehicle-odometer
 17927     if ws-ins-age-defaulted = 'Y'
 17928        move er-1573             to ws-error
 17929        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17930     end-if
 17931
 17932     if ws-jnt-age-defaulted = 'Y'
 17933        move er-1574             to ws-error
 17934        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17935     end-if
 17936***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17937***                                                           ****
 17938***  Set an error if the state requires verification of agent ****
 17939***  and agent hasn't verified yet and the status is not =    ****
 17940***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17941***  and the entry date > 09/01/2015.                         ****
 17942***                                                           ****
 17943***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17944     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17945        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17946        and (pb-account (9:2) not = 'OB')
 17947        if (ws-st-agent-sig-edit = 'Y')
 17948           and (am-report-code-1 not = 'CONLEY')
 17949           evaluate true
 17950              when cs-agent-edit-status = 'C'
 17951                 move er-1743    to ws-error
 17952                 perform 9900-error-format
 17953                                 thru 9900-exit
 17954              when cs-agent-edit-status = 'S'
 17955                 move er-1744    to ws-error
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 325
* EL050.cbl
 17956                 perform 9900-error-format
 17957                                 thru 9900-exit
 17958              when cs-agent-edit-status = 'M'
 17959                 move er-1745    to ws-error
 17960                 perform 9900-error-format
 17961                                 thru 9900-exit
 17962              when cs-agent-edit-status = 'R'
 17963                 move er-1747    to ws-error
 17964                 perform 9900-error-format
 17965                                 thru 9900-exit
 17966              when cs-agent-edit-status = 'N'
 17967                 move er-1748    to ws-error
 17968                 perform 9900-error-format
 17969                                 thru 9900-exit
 17970              when cs-agent-edit-status <> 'V' and 'U' and
 17971                                           'R' and 'N' and
 17972                                           'H'
 17973                 move er-1746    to ws-error
 17974                 perform 9900-error-format
 17975                                 thru 9900-exit
 17976           end-evaluate
 17977        end-if
 17978     end-if
 17979*    move ' ' to cs-claim-verification-status
 17980*    move 'Y' to elcrtt-update-sw
 17981     if cs-claim-verification-status = ' ' or 'R'
 17982        move pb-state            to pa-clmhs-state
 17983        move pb-account          to pa-account
 17984        move ws-greg-eff-date    to pa-eff-dt
 17985        move pb-cert-no          to pa-cert-no
 17986        perform 7795-call-sqlclmhs
 17987                                 thru 7795-exit
 17988        if pa-clm-count > 0
 17989           if cs-claim-verification-status = ' '
 17990              move 'R'           to cs-claim-verification-status
 17991*             display 'Updating elcrtt ' pb-state ' '
 17992*                pb-account ' ' pb-cert-no
 17993              move 'Y'           to elcrtt-update-sw
 17994           end-if
 17995        else
 17996           if cs-claim-verification-status = 'R'
 17997              move ' '           to cs-claim-verification-status
 17998              move 'Y'           to elcrtt-update-sw
 17999           end-if
 18000        end-if
 18001     end-if
 18002
 18003     if cs-claim-verification-status <> ' '
 18004        evaluate true
 18005           when cs-claim-verification-status = 'R'
 18006              move er-1749    to ws-error
 18007              perform 9900-error-format
 18008                              thru 9900-exit
 18009           when cs-claim-verification-status = 'W'
 18010              move er-1750    to ws-error
 18011              perform 9900-error-format
 18012                              thru 9900-exit
 18013           when cs-claim-verification-status = 'I'
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 326
* EL050.cbl
 18014              move er-1751    to ws-error
 18015              perform 9900-error-format
 18016                              thru 9900-exit
 18017           when cs-claim-verification-status = 'K'
 18018              move er-1761    to ws-error
 18019              perform 9900-error-format
 18020                              thru 9900-exit
 18021           when cs-claim-verification-status = 'A'
 18022              move er-1752    to ws-error
 18023              perform 9900-error-format
 18024                              thru 9900-exit
 18025           when cs-claim-verification-status = 'B'
 18026              move er-1754    to ws-error
 18027              perform 9900-error-format
 18028                              thru 9900-exit
 18029           when cs-claim-verification-status = 'C'
 18030              move er-1753    to ws-error
 18031              perform 9900-error-format
 18032                              thru 9900-exit
 18033           when cs-claim-verification-status = 'D'
 18034              move er-1757    to ws-error
 18035              perform 9900-error-format
 18036                              thru 9900-exit
 18037           when cs-claim-verification-status = 'E'
 18038              move er-1758    to ws-error
 18039              perform 9900-error-format
 18040                              thru 9900-exit
 18041           when cs-claim-verification-status = 'F'
 18042              move er-1759    to ws-error
 18043              perform 9900-error-format
 18044                              thru 9900-exit
 18045           when cs-claim-verification-status = 'G'
 18046              move er-1760    to ws-error
 18047              perform 9900-error-format
 18048                              thru 9900-exit
 18049*          when cs-claim-verification-status = 'H'
 18050*             move er-1756    to ws-error
 18051*             perform 9900-error-format
 18052*                             thru 9900-exit
 18053*          when cs-claim-verification-status = 'J'
 18054*             move er-1755    to ws-error
 18055*             perform 9900-error-format
 18056*                             thru 9900-exit
 18057        end-evaluate
 18058     end-if
 18059
 18060     IF ELCRTT-UPDATE
 18061        perform 8150-update-elcrtt thru 8150-exit
 18062*       display ' back from 8150 ' elcrtt-file-status
 18063     else
 18064        if elcrtt-found
 18065           perform 8155-unlock-elcrtt
 18066                                 thru 8155-exit
 18067        end-if
 18068     end-if
 18069     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18070     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 18071        AND (WS-NO-SECURE-PAY))
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 327
* EL050.cbl
 18072                  OR
 18073        (WS-LF-SPECIAL-CALC-CD = 'O'
 18074        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18075        SET SKIP-ADDR-EDIT       TO TRUE
 18076     END-IF
 18077     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18078        AND (NOT SKIP-ADDR-EDIT)
 18079        MOVE ER-2963             TO WS-ERROR
 18080        PERFORM 9900-ERROR-FORMAT
 18081                                 THRU 9900-EXIT
 18082        GO TO 9990-RETURN
 18083     END-IF
 18084     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 18085     IF ERPNDM-FOUND NOT = 'X'
 18086        move 'Y'                 to erpndm-unlock-sw
 18087        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18088           OR (PM-CITY        = SPACES OR LOW-VALUES)
 18089           OR (PM-STATE       = SPACES OR LOW-VALUES)
 18090           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 18091           or (pm-zip-code    = zeros)
 18092           or (pm-zip-code not numeric))
 18093           AND (NOT SKIP-ADDR-EDIT)
 18094           MOVE ER-2694          TO WS-ERROR
 18095           PERFORM 9900-ERROR-FORMAT
 18096                                 THRU 9900-EXIT
 18097        END-IF
 18098        MOVE ' '                 TO STATE-RECORD-ERROR
 18099        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18100        MOVE PM-STATE            TO CNTL-ACCESS
 18101        MOVE '3'                 TO CNTL-REC-TYPE
 18102        MOVE +0                  TO CNTL-SEQ-NO
 18103        MOVE '0'                 TO RC-SW-2
 18104        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18105        IF (NO-STATE-RECORD)
 18106           OR (CF-RECORD-TYPE NOT = '3')
 18107           OR (PM-STATE NOT = CF-STATE-CODE)
 18108           IF (PM-STATE = SPACES)
 18109              AND (SKIP-ADDR-EDIT)
 18110              CONTINUE
 18111           ELSE
 18112              MOVE ER-2963       TO WS-ERROR
 18113              PERFORM 9900-ERROR-FORMAT
 18114                                 THRU 9900-EXIT
 18115           END-IF
 18116        END-IF
 18117        if (ws-error not = er-2963 and er-2694)
 18118           and (pm-city-st-zip-verified = ' ')
 18119           and (pb-company-id = 'CID')
 18120           move spaces           to zipcd-pass-area
 18121           move pm-zip-code      to pa-zip
 18122           move pm-city          to pa-city
 18123           move pm-state         to pa-state
 18124           perform 7790-call-zip-verify
 18125                                 thru 7790-exit
 18126           if pa-errorcode-zip (1:1) = ' '
 18127                    move 'Y'     to pm-city-st-zip-verified
 18128                    PERFORM 8102-REWRITE-ERPNDM
 18129                                 THRU 8102-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 328
* EL050.cbl
 18130                    move 'N'     to erpndm-unlock-sw
 18131           else
 18132              MOVE ER-3061       TO WS-ERROR
 18133              PERFORM 9900-ERROR-FORMAT
 18134                                 THRU 9900-EXIT
 18135           end-if
 18136        end-if
 18137        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18138           MOVE ER-2883          TO WS-ERROR
 18139           PERFORM 9900-ERROR-FORMAT
 18140                                 THRU 9900-EXIT
 18141        END-IF
 18142        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18143           MOVE ' '                 TO STATE-RECORD-ERROR
 18144           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18145           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18146           MOVE '3'                 TO CNTL-REC-TYPE
 18147           MOVE +0                  TO CNTL-SEQ-NO
 18148           MOVE '0'                 TO RC-SW-2
 18149           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18150           IF NO-STATE-RECORD
 18151              OR (CF-RECORD-TYPE NOT = '3')
 18152              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18153              MOVE ER-2964          TO WS-ERROR
 18154              PERFORM 9900-ERROR-FORMAT
 18155                                    THRU 9900-EXIT
 18156           END-IF
 18157        END-IF
 18158     ELSE
 18159        IF NOT SKIP-ADDR-EDIT
 18160           MOVE ER-2393          TO WS-ERROR
 18161           PERFORM 9900-ERROR-FORMAT
 18162                                 THRU 9900-EXIT
 18163        END-IF
 18164     END-IF
 18165     if need-to-unlock-erpndm
 18166        perform 8104-unlock-erpndm
 18167                                 thru 8104-exit
 18168     end-if
 18169     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 18170
 18171     IF (ERMAIL-FOUND = ' ' AND
 18172        ERPNDM-FOUND = ' ')
 18173        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 18174           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18175           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18176          OR
 18177           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 18178          OR
 18179           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 18180           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 18181           GO TO 3999-UNLOCK-ERMAIL.
 18182
 18183     IF ERPNDM-FOUND = 'X'
 18184        GO TO 3999-UNLOCK-ERMAIL.
 18185
 18186     IF PM-INSURED-LAST-NAME      = SPACES
 18187        AND PM-INSURED-FIRST-NAME = SPACES
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 329
* EL050.cbl
 18188        AND PM-ADDRESS-LINE-1     = SPACES
 18189        AND PM-ADDRESS-LINE-2     = SPACES
 18190        AND PM-CITY-STATE         = SPACES
 18191        AND PM-CRED-BENE-NAME     = SPACES
 18192        AND PM-CRED-BENE-ADDR     = SPACES
 18193        AND PM-CRED-BENE-CTYST    = SPACES
 18194        GO TO 3999-UNLOCK-ERMAIL
 18195     END-IF
 18196
 18197     MOVE SPACES                 TO MAILING-DATA.
 18198
 18199     MOVE 'MA'                   TO MA-RECORD-ID.
 18200     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18201     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18202     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18203     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18204     MOVE PB-SV-STATE            TO MA-STATE.
 18205     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18206     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18207
 18208     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18209     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18210
 18211     IF ERMAIL-FOUND = ' '
 18212        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18213     ELSE
 18214        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18215        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18216        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18217
 18218     GO TO 9990-RETURN.
 18219
 18220 3999-UNLOCK-ERMAIL.
 18221     IF ERMAIL-FOUND = ' '
 18222        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18223
 18224     GO TO 9990-RETURN.
 18225******************************************************************
 18226
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 330
* EL050.cbl
 18228 4000-UPDATE-CANCELLED-CERT.
 18229     IF CERT-WAS-NOT-FOUND
 18230        GO TO 4299-EXIT.
 18231
 18232*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18233     IF PB-C-INT-ON-REFS > ZEROS
 18234        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18235     END-IF
 18236     IF PB-C-REF-INTERFACE-SW = 'Y'
 18237        MOVE PB-C-REF-INTERFACE-SW
 18238                                 TO CM-ref-INTERFACE-SW
 18239     END-IF
 18240*    IF ERMAIL-FOUND = ' '
 18241*       PERFORM 8140-UNLOCK-ERMAIL
 18242*                                THRU 8140-EXIT
 18243*    end-if
 18244     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18245     IF ERMAIL-FOUND = 'X'
 18246        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18247        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18248        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18249        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18250           MOVE ER-2694          TO WS-ERROR
 18251           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18252     END-IF
 18253
 18254     IF PB-C-POST-CARD-IND = 'Y'
 18255        MOVE +8                  TO SUB
 18256*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18257        IF ERMAIL-FOUND = ' '
 18258           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18259              (SUB > +7)
 18260              OR (MA-MAIL-STATUS (SUB) = '1')
 18261           END-PERFORM
 18262        END-IF
 18263        IF (SUB > +7)
 18264           OR (ERMAIL-FOUND = 'X')
 18265           MOVE ER-3789          TO WS-ERROR
 18266           PERFORM 9900-ERROR-FORMAT
 18267                                 THRU 9900-EXIT
 18268        END-IF
 18269     ELSE
 18270        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18271     END-IF
 18272
 18273     IF ERMAIL-FOUND = ' '
 18274        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18275     END-IF.
 18276
 18277     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18278
 18279     IF PB-CI-OB-FLAG = 'Z'
 18280        GO TO 4150-SUMMARY-CERT-CANCEL.
 18281     perform 8145-read-elcrtt-upd thru 8145-exit
 18282     if not elcrtt-found
 18283        move 'CS'                to certificate-trailers
 18284        move cm-control-primary  to cs-control-primary
 18285        move 'C'                 TO cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 331
* EL050.cbl
 18286        move zeros               to cs-vehicle-odometer
 18287     end-if
 18288
 18289     if pb-lf-refund-type <> cs-lf-refund-method
 18290        move pb-lf-refund-type   to cs-lf-refund-method
 18291        set elcrtt-update to true
 18292     end-if
 18293     if pb-ah-refund-type <> cs-ah-refund-method
 18294        move pb-ah-refund-type   to cs-ah-refund-method
 18295        set elcrtt-update to true
 18296     end-if
 18297     IF PB-C-LF-CANCEL-VOIDED
 18298         PERFORM 4200-REVERSE-LF-CANCEL.
 18299     IF PB-C-AH-CANCEL-VOIDED
 18300         PERFORM 4200-REVERSE-AH-CANCEL.
 18301     IF ELCRTT-UPDATE
 18302        perform 8150-update-elcrtt thru 8150-exit
 18303     else
 18304        if elcrtt-found
 18305           perform 8155-unlock-elcrtt
 18306                                 thru 8155-exit
 18307        end-if
 18308     end-if
 18309     .
 18310 4100-APPLY-LF-CANCEL.
 18311
 18312     MOVE +0                     TO WS-SUB.
 18313
 18314 4100-CHECK-LF-ERRORS.
 18315
 18316     ADD +1                       TO WS-SUB.
 18317
 18318     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18319        IF LF-COVERAGE-CANCELLED
 18320           GO TO 4100-LF-CANCEL-CONT
 18321        ELSE
 18322           GO TO 4100-UPDATE-LF-COVERAGE.
 18323
 18324     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18325                                   ER-2729 OR
 18326                                   ER-2730 OR
 18327                                   ER-2731 OR
 18328                                   ER-2732 OR
 18329                                   ER-2737 OR
 18330                                   ER-2740 OR
 18331                                   ER-2743 OR
 18332                                   ER-2749 OR
 18333                                   ER-2750 OR
 18334                                   ER-2755 OR
 18335                                   ER-2757 OR
 18336                                   ER-2760 OR
 18337                                   ER-2772 OR
 18338                                   ER-2774 OR
 18339                                   ER-2776 OR
 18340                                   ER-2794
 18341        GO TO 4100-UPDATE-LF-COVERAGE.
 18342
 18343     GO TO 4100-CHECK-LF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 332
* EL050.cbl
 18344
 18345 4100-UPDATE-LF-COVERAGE.
 18346
 18347     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18348     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18349     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18350        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18351     END-IF
 18352     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18353                                      TO CM-CREDIT-INTERFACE-SW-2.
 18354     IF CM-LF-CANCEL-DT = LOW-VALUE
 18355         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18356
 18357     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18358         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18359                                         CM-LF-STATUS-AT-CANCEL.
 18360
 18361     GO TO 4100-APPLY-AH-CANCEL.
 18362
 18363 4100-LF-CANCEL-CONT.
 18364     IF PB-C-LF-CANCEL-VOIDED
 18365         GO TO 4100-APPLY-AH-CANCEL.
 18366
 18367     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18368         GO TO 4100-APPLY-AH-CANCEL.
 18369
 18370     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18371        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18372           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18373        ELSE
 18374           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18375
 18376     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18377     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18378
 18379     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18380         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18381
 18382     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18383        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18384         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18385         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18386
 18387     IF PB-RECORD-RETURNED
 18388        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18389      ELSE
 18390        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18391
 18392 4100-APPLY-AH-CANCEL.
 18393
 18394     MOVE +0                      TO WS-SUB.
 18395
 18396 4100-CHECK-AH-ERRORS.
 18397
 18398     ADD +1                       TO WS-SUB.
 18399
 18400     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18401        IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 333
* EL050.cbl
 18402           GO TO 4100-AH-CANCEL-CONT
 18403        ELSE
 18404           GO TO 4100-UPDATE-AH-COVERAGE.
 18405
 18406     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18407                                   ER-2729 OR
 18408                                   ER-2732 OR
 18409                                   ER-2737 OR
 18410                                   ER-2740 OR
 18411                                   ER-2744 OR
 18412                                   ER-2749 OR
 18413                                   ER-2750 OR
 18414                                   ER-2755 OR
 18415                                   ER-2757 OR
 18416                                   ER-2760 OR
 18417                                   ER-2771 OR
 18418                                   ER-2772 OR
 18419                                   ER-2773 OR
 18420                                   ER-2775 OR
 18421                                   ER-2777 OR
 18422                                   ER-2778 OR
 18423                                   ER-2794
 18424        GO TO 4100-UPDATE-AH-COVERAGE.
 18425
 18426     GO TO 4100-CHECK-AH-ERRORS.
 18427
 18428 4100-UPDATE-AH-COVERAGE.
 18429
 18430     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18431     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18432     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18433     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18434                                      TO CM-CREDIT-INTERFACE-SW-2.
 18435     IF CM-AH-CANCEL-DT = LOW-VALUE
 18436         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18437
 18438     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18439         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18440                                         CM-AH-STATUS-AT-CANCEL.
 18441
 18442     IF LF-COVERAGE-CANCELLED
 18443         IF PB-RECORD-RETURNED
 18444              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18445          ELSE
 18446              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18447
 18448     GO TO 4299-EXIT.
 18449
 18450 4100-AH-CANCEL-CONT.
 18451     IF PB-C-AH-CANCEL-VOIDED
 18452         GO TO 4299-EXIT.
 18453
 18454     if cm-credit-interface-sw-2 = ' '
 18455        if pb-fatal-errors or pb-unforced-errors
 18456           move '4'              to cm-credit-interface-sw-2
 18457        else
 18458           move '1'              to cm-credit-interface-sw-2
 18459        end-if
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 334
* EL050.cbl
 18460     end-if
 18461     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18462         GO TO 4299-EXIT.
 18463
 18464     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18465        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18466           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18467        ELSE
 18468           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18469
 18470     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18471     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18472
 18473     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18474         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18475
 18476     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18477         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18478         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18479
 18480     IF PB-RECORD-RETURNED
 18481        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18482      ELSE
 18483        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18484
 18485     GO TO 4299-EXIT.
 18486
 18487 4150-SUMMARY-CERT-CANCEL.
 18488     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18489
 18490     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18491        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18492                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18493     ELSE
 18494        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18495                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18496
 18497     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18498        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18499                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18500     ELSE
 18501        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18502                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18503
 18504     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18505        NEXT SENTENCE
 18506     ELSE
 18507        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18508
 18509     GO TO 4299-EXIT.
 18510
 18511 4200-REVERSE-LF-CANCEL.
 18512     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18513
 18514     IF CM-LF-CANCEL-APPLIED
 18515        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18516        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18517        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 335
* EL050.cbl
 18518
 18519     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18520
 18521     IF PB-RECORD-RETURNED
 18522        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18523       ELSE
 18524        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18525
 18526 4200-REVERSE-LF-EXIT.
 18527       EXIT.
 18528
 18529 4200-REVERSE-AH-CANCEL.
 18530     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18531
 18532     IF CM-AH-CANCEL-APPLIED
 18533        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18534        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18535        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18536
 18537     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18538
 18539     IF PB-RECORD-RETURNED
 18540        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18541       ELSE
 18542        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18543
 18544 4200-REVERSE-AH-EXIT.
 18545       EXIT.
 18546
 18547 4299-EXIT.
 18548       EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 336
* EL050.cbl
 18550
 18551 4500-UPDATE-NEW-CERT.
 18552     IF CERT-WAS-FOUND
 18553         NEXT SENTENCE
 18554       ELSE
 18555         GO TO 4520-BUILD-NEW-KEY.
 18556
 18557     IF  CLASIC-CREATED-CERT
 18558         GO TO 4999-EXIT.
 18559
 18560     IF  CERT-WAS-CREATED-FOR-CLAIM
 18561         GO TO 4520-BUILD-NEW-KEY.
 18562
 18563     IF CERT-ADDED-BATCH
 18564        IF CM-RECORD-ID = 'CM'
 18565            GO TO 4999-EXIT.
 18566
 18567 4520-BUILD-NEW-KEY.
 18568* BUILD CONTROL PRIMARY
 18569
 18570     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18571                                       CM-COMPANY-CD-A1
 18572                                       CM-COMPANY-CD-A2
 18573                                       CM-COMPANY-CD-A4
 18574                                       CM-COMPANY-CD-A5.
 18575
 18576     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18577     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18578     MOVE PB-SV-STATE               TO CM-STATE.
 18579     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18580     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18581     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18582     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18583
 18584     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18585
 18586     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18587     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18588     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18589     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18590
 18591     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18592        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18593
 18594     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18595         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18596         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18597         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18598         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18599     ELSE
 18600         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18601
 18602     IF PB-COMPANY-ID   EQUAL  'CRI'
 18603         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18604         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18605         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18606         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18607         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 337
* EL050.cbl
 18608
 18609     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18610        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18611         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18612
 18613     IF PB-COMPANY-ID  = 'LBL'
 18614        IF PB-I-JOINT-COVERAGE
 18615            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18616                                           PB-I-MEMBER-NO
 18617            GO TO 4550-CONT-CERT-PROCESS.
 18618
 18619     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18620        NEXT SENTENCE
 18621     ELSE
 18622        GO TO 4540-BUILD-MEMBER-NO.
 18623
 18624******************************************************************
 18625*                                                                *
 18626*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18627*    FOR 'MON'.                                                  *
 18628*                                                                *
 18629******************************************************************
 18630
 18631     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18632     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18633     MOVE +1                     TO WS-SUB1
 18634                                    WS-SUB2.
 18635
 18636 4530-EDIT-MEMB-NAME.
 18637
 18638     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18639        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18640        ADD +1                       TO WS-SUB2.
 18641
 18642     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18643        ADD +1                       TO WS-SUB1
 18644        GO TO 4530-EDIT-MEMB-NAME.
 18645
 18646     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18647     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18648     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18649*    MOVE SPACE                      TO DC-OPTION-CODE.
 18650     SET  BIN-TO-GREG                TO TRUE.
 18651     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18652     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18653
 18654     GO TO 4550-CONT-CERT-PROCESS.
 18655
 18656******************************************************************
 18657*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18658******************************************************************
 18659
 18660 4540-BUILD-MEMBER-NO.
 18661
 18662     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18663         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18664         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18665         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 338
* EL050.cbl
 18666         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18667     ELSE
 18668         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18669
 18670     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18671        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18672         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18673
 18674 4550-CONT-CERT-PROCESS.
 18675
 18676*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18677*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18678*    ELSE
 18679*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18680
 18681     IF CERT-WAS-CREATED-FOR-CLAIM
 18682        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18683        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18684
 18685     IF CERT-AND-CLAIM-ONLINE
 18686        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18687        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18688
 18689     MOVE 'CM'                     TO CM-RECORD-ID.
 18690     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18691
 18692     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18693        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18694        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18695     ELSE
 18696        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18697        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18698
 18699     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18700     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18701     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18702     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18703     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18704     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18705     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18706                                      CM-LF-ITD-CANCEL-AMT
 18707                                      CM-LF-ITD-DEATH-AMT
 18708                                      CM-AH-ITD-AH-PMT
 18709                                      CM-AH-ITD-LUMP-PMT
 18710                                      CM-AH-ITD-CANCEL-AMT
 18711                                      CM-LF-NSP-PREMIUM-AMT
 18712                                      CM-AH-NSP-PREMIUM-AMT.
 18713*                                     CM-CLAIM-DEDUCT-WITHHELD
 18714*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18715     if pb-i-loan-apr = +99.9999
 18716        move zeros                 to cm-loan-apr
 18717     else
 18718        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18719     end-if
 18720     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18721     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18722     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18723     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 339
* EL050.cbl
 18724     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18725     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18726     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18727     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18728     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18729     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18730     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18731
 18732     IF PB-I-LIVES NOT NUMERIC
 18733         MOVE ZERO                 TO PB-I-LIVES.
 18734
 18735     IF PB-I-NUM-BILLED NOT NUMERIC
 18736         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18737
 18738     MOVE PB-I-LIVES               TO CM-LIVES.
 18739     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18740
 18741     IF PB-COMPANY-ID EQUAL  'DMD'
 18742         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18743         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18744
 18745     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18746     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18747     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18748     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18749     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18750     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18751
 18752     IF PB-I-LF-POLICY-FEE NUMERIC
 18753        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18754     ELSE
 18755        MOVE +0                    TO CM-LF-POLICY-FEE.
 18756
 18757     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18758        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18759        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18760     ELSE
 18761        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18762
 18763     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18764     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18765     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18766     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18767     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18768     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18769     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18770     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18771     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18772
 18773     IF PB-I-CANCEL-FEE NUMERIC
 18774        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18775     ELSE
 18776        MOVE +0                  TO CM-CANCEL-FEE
 18777     END-IF
 18778
 18779     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18780        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18781     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 340
* EL050.cbl
 18782        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18783
 18784     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18785     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18786
 18787     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18788                                      CM-LF-DEATH-EXIT-DT
 18789                                      CM-AH-SETTLEMENT-EXIT-DT.
 18790
 18791*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18792*                       'TIH' OR 'OFL' OR 'FLA' OR
 18793*                       'TII' OR 'TMS' OR 'CRI' OR
 18794*                       'NCL'
 18795     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18796
 18797     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18798         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18799            MOVE '2'                TO CM-PREMIUM-TYPE.
 18800
 18801     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18802         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18803            MOVE '2'                TO CM-PREMIUM-TYPE.
 18804
 18805     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18806         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18807     ELSE
 18808         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18809         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18810
 18811     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18812     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18813     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18814     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18815     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18816     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18817     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18818     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18819
 18820     IF PB-NO-MONTHS-SKIPPED
 18821         MOVE SPACE                 TO CM-SKIP-CODE
 18822     ELSE
 18823         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18824
 18825     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18826     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18827                                       CM-LF-STATUS-AT-CANCEL.
 18828
 18829     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18830     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18831                                       CM-AH-STATUS-AT-CANCEL.
 18832
 18833     MOVE '1'                       TO CM-ENTRY-STATUS.
 18834
 18835     IF PB-REISSUED-CERT
 18836        MOVE '5'                    TO CM-ENTRY-STATUS.
 18837
 18838     IF PB-MONTHLY-CERT
 18839        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 341
* EL050.cbl
 18840
 18841     IF PB-CASH-CERT
 18842        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18843
 18844     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18845     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18846     IF PB-POLICY-IS-DECLINED
 18847        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18848
 18849     IF PB-POLICY-IS-VOIDED
 18850        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18851
 18852     IF PB-NEEDS-UNDERWRITING
 18853        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18854
 18855     IF PB-REIN-ONLY-CERT
 18856        MOVE '9'                    TO CM-ENTRY-STATUS.
 18857
 18858     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18859         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18860     ELSE
 18861         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18862
 18863     IF PB-RECORD-RETURNED
 18864        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18865      ELSE
 18866        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18867
 18868     IF PB-I-MAIL-ADDRS-PRESENT
 18869        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18870
 18871     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18872                                       CM-ENTRY-DT.
 18873
 18874 4999-EXIT.
 18875     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 342
* EL050.cbl
 18877
 18878 5000-PROCESS-REPS.
 18879     MOVE ' '                    TO AGTC-MASTER-SW
 18880     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18881     MOVE CO-TYPE                TO AGTC-TYPE
 18882     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18883     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18884     IF (AGTC-MASTER-SW NOT = 'N')
 18885        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18886        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18887        PERFORM 8583-READ-ERAGTC-NEXT
 18888                                 THRU 8583-EXIT
 18889     END-IF
 18890     IF AGTC-MASTER-SW = 'N'
 18891        CONTINUE
 18892     ELSE
 18893        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18894           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18895              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18896              MOVE 'Y'           TO AGTC-MASTER-SW
 18897           END-IF
 18898        END-IF
 18899     END-IF
 18900     .
 18901 5000-EXIT.
 18902     EXIT.
 18903 6370-EDIT-INPUT-LF-CODE.
 18904     move ' ' to ws-benefit-cd-chg-sw
 18905     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18906        MOVE +1                  TO SUB
 18907        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18908        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18909        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18910        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18911        GO TO 6370-SEARCH-LOOP.
 18912
 18913     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18914
 18915     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18916     MOVE SPACES                 TO CNTL-ACCESS.
 18917*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18918     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18919     MOVE +0                     TO CNTL-SEQ-NO.
 18920     MOVE '4' TO RC-SW-2.
 18921     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18922
 18923     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18924        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18925        GO TO 6370-NO-LF-FOUND.
 18926
 18927     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18928     MOVE +1                     TO SUB.
 18929
 18930 6370-SEARCH-LOOP.
 18931     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18932         GO TO 6370-NO-LF-FOUND.
 18933
 18934     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 343
* EL050.cbl
 18935        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18936           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18937           set benefit-code-chg to true
 18938        end-if
 18939        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18940        GO TO 6370-HER-NET-PAY-CHECK.
 18941
 18942     ADD 1   TO SUB.
 18943*    IF SUB GREATER 120
 18944     IF SUB GREATER 200
 18945         GO TO 6370-NO-LF-FOUND.
 18946
 18947     GO TO 6370-SEARCH-LOOP.
 18948
 18949 6370-NO-LF-FOUND.
 18950
 18951     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18952        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18953        set benefit-code-chg to true
 18954     end-if
 18955     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18956
 18957 6370-HER-NET-PAY-CHECK.
 18958
 18959     IF PB-COMPANY-ID = 'CID'
 18960        IF PB-SV-STATE = 'CA' OR 'MN'
 18961           IF PB-I-LF-BENEFIT-CD = '02'
 18962              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18963           ELSE
 18964              IF PB-I-LF-BENEFIT-CD = '04'
 18965                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18966              END-IF
 18967           END-IF
 18968        END-IF
 18969     END-IF
 18970
 18971     IF PB-COMPANY-ID NOT = 'HER'
 18972         GO TO 6370-EXIT.
 18973
 18974     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18975         GO TO 6370-EXIT.
 18976
 18977     IF PB-I-LF-TERM NOT NUMERIC
 18978         MOVE ZEROS              TO PB-I-LF-TERM.
 18979
 18980     IF PB-I-LOAN-TERM NOT NUMERIC
 18981         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18982
 18983     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18984         GO TO 6370-EXIT.
 18985
 18986     IF PB-I-LF-BENEFIT-CD = '33'
 18987         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18988
 18989     IF PB-I-LF-BENEFIT-CD = '34'
 18990         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18991
 18992 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 344
* EL050.cbl
 18993     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 345
* EL050.cbl
 18995
 18996 6380-EDIT-INPUT-AH-CODE.
 18997     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18998        MOVE +1                  TO SUB
 18999        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 19000        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 19001        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 19002        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 19003        GO TO 6380-SEARCH-LOOP.
 19004
 19005     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 19006
 19007     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 19008     MOVE SPACES                 TO CNTL-ACCESS.
 19009     MOVE 'A'                    TO CNTL-REC-TYPE.
 19010*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 19011     MOVE +0                     TO CNTL-SEQ-NO.
 19012     MOVE '5' TO RC-SW-2.
 19013     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 19014
 19015     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 19016        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 19017        GO TO 6380-NO-AH-FOUND.
 19018
 19019     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 19020     MOVE +1 TO SUB.
 19021
 19022 6380-SEARCH-LOOP.
 19023     IF CF-AH-CODE-OUT (SUB) = ZEROS
 19024         GO TO 6380-NO-AH-FOUND.
 19025
 19026     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 19027         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 19028         GO TO 6380-CSO-AH-ONLY-CHECKS.
 19029
 19030     ADD 1   TO SUB.
 19031     IF SUB GREATER THAN 96
 19032*    IF SUB GREATER THAN 300
 19033         GO TO 6380-NO-AH-FOUND.
 19034
 19035     GO TO 6380-SEARCH-LOOP.
 19036
 19037 6380-NO-AH-FOUND.
 19038
 19039     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 19040
 19041     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 19042         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 19043     ELSE
 19044         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 19045
 19046 6380-CSO-AH-ONLY-CHECKS.
 19047
 19048     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 19049        NEXT SENTENCE
 19050      ELSE
 19051        GO TO 6380-EXIT.
 19052
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 346
* EL050.cbl
 19053     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 19054         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 19055
 19056
 19057     GO TO 6380-EXIT
 19058     .
 19059 6380-CSO-LIFE-WITH-AH-CHECKS.
 19060
 19061
 19062     .
 19063 6380-EXIT.
 19064     EXIT.
 19065
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 347
* EL050.cbl
 19067
 19068 6400-COMPUTE-EXTENSION-DAYS.
 19069
 19070******************************************************************
 19071*                                                                *
 19072*                   COMPUTE EXTENSION DAYS                       *
 19073*                                                                *
 19074*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 19075*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 19076*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 19077*    THE EXTENSION DAYS.                                         *
 19078*                                                                *
 19079******************************************************************
 19080
 19081     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 19082     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 19083
 19084******************************************************************
 19085*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 19086*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 19087******************************************************************
 19088
 19089     IF DC-ELAPSED-MONTHS GREATER THAN +0
 19090        COMPUTE WS-ODD-DAYS-OVER =
 19091               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 19092     ELSE
 19093        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 19094
 19095     IF WS-ODD-DAYS-OVER = ZEROS
 19096           GO TO 6499-EXIT
 19097     ELSE
 19098        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 19099           IF WS-WDF-MONTH = 02
 19100              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 19101              ADD 2       TO  WS-ODD-DAYS-OVER
 19102              GO TO 6499-EXIT
 19103           ELSE
 19104              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 19105                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 19106                 GO TO 6499-EXIT
 19107               ELSE
 19108                 GO TO 6499-EXIT
 19109        ELSE
 19110           GO TO 6499-EXIT.
 19111
 19112 6412-CHECK-TO-DAY.
 19113
 19114        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 19115           IF WS-WDT-DAY = 28
 19116              ADD 2              TO WS-ODD-DAYS-OVER
 19117           ELSE
 19118              IF WS-WDT-DAY = 29
 19119                 ADD 1           TO WS-ODD-DAYS-OVER
 19120              ELSE
 19121                 NEXT SENTENCE
 19122        ELSE
 19123           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 19124              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 348
* EL050.cbl
 19125
 19126     GO TO 6499-EXIT.
 19127
 19128
 19129 6415-CHECK-LEAP-YEAR.
 19130
 19131     IF DC-DAYS-IN-MONTH = 29
 19132        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 19133
 19134 6415-EXIT.
 19135     EXIT.
 19136
 19137 6499-EXIT.
 19138      EXIT.
 19139
 19140 6500-END.
 19141     EXIT.
 19142
 19143
 19144******************************************************************
 19145************* PROCEDURE DIVISION FOR EL050 ***********************
 19146********************** ELC50PD END *******************************
 19147
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 349
* EL050.cbl
 19149
 19150**START***********************************************************
 19151*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 19152*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 19153******************************************************************
 19154*
 19155 6600-GET-STATE-MUNICIPAL-TAX.
 19156
 19157     IF PB-COMPANY-ID NOT = 'DMD'
 19158         GO TO 6640-EXIT.
 19159
 19160     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19161     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19162     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19163*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19164*
 19165***  Y2K PROJ 7744
 19166     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19167     SET BIN-TO-GREG          TO TRUE.
 19168     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19169
 19170     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19171
 19172     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19173     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 19174
 19175
 19176* EXEC CICS HANDLE CONDITION
 19177*        INVREQ    (6610-START-BROWSE)
 19178*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19179*        NOTFND    (6630-END-OF-FILE)
 19180*    END-EXEC.
 19181*    MOVE '"$8JI                 ! # #00019165' TO DFHEIV0
 19182     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 19183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19184     MOVE X'2320233030303139313635' TO DFHEIV0(25:11)
 19185     CALL 'kxdfhei1' USING DFHEIV0
 19186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19187
 19188
 19189 6610-START-BROWSE.
 19190
 19191
 19192* EXEC CICS HANDLE CONDITION
 19193*        NOTFND    (6630-END-OF-FILE)
 19194*        DISABLED  (6630-ERRESS-PROBLEM)
 19195*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19196*        ENDFILE   (6630-END-OF-FILE)
 19197*    END-EXEC.
 19198*    MOVE '"$IcJ''                ! $ #00019173' TO DFHEIV0
 19199     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19200     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19201     MOVE X'2420233030303139313733' TO DFHEIV0(25:11)
 19202     CALL 'kxdfhei1' USING DFHEIV0
 19203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19204
 19205
 19206
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 350
* EL050.cbl
 19207* EXEC CICS STARTBR
 19208*        DATASET (FILE-ID-ERRESS)
 19209*        RIDFLD  (WS-ERRESS-KEY)
 19210*        GTEQ
 19211*    END-EXEC.
 19212     MOVE 0
 19213       TO DFHEIV11
 19214*    MOVE '&,         G          &   #00019180' TO DFHEIV0
 19215     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19216     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19217     MOVE X'2020233030303139313830' TO DFHEIV0(25:11)
 19218     CALL 'kxdfhei1' USING DFHEIV0,
 19219           FILE-ID-ERRESS,
 19220           WS-ERRESS-KEY,
 19221           DFHEIV99,
 19222           DFHEIV11,
 19223           DFHEIV99
 19224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19225
 19226
 19227 6620-READ-NEXT-ERRESS-MASTER.
 19228
 19229
 19230* EXEC CICS HANDLE CONDITION
 19231*        NOTFND    (6630-END-OF-FILE)
 19232*        ENDFILE   (6630-END-OF-FILE)
 19233*        DISABLED  (6630-ERRESS-PROBLEM)
 19234*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19235*    END-EXEC.
 19236*    MOVE '"$I''cJ                ! % #00019188' TO DFHEIV0
 19237     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19238     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19239     MOVE X'2520233030303139313838' TO DFHEIV0(25:11)
 19240     CALL 'kxdfhei1' USING DFHEIV0
 19241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19242
 19243
 19244
 19245* EXEC CICS READNEXT
 19246*        DATASET (FILE-ID-ERRESS)
 19247*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19248*        RIDFLD  (WS-ERRESS-KEY)
 19249*    END-EXEC.
 19250     MOVE LENGTH OF
 19251      RESIDENT-STATE-TAX-MASTER
 19252       TO DFHEIV12
 19253     MOVE 0
 19254       TO DFHEIV11
 19255*    MOVE '&.IL                  )   #00019195' TO DFHEIV0
 19256     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19257     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19258     MOVE X'2020233030303139313935' TO DFHEIV0(25:11)
 19259     CALL 'kxdfhei1' USING DFHEIV0,
 19260           FILE-ID-ERRESS,
 19261           RESIDENT-STATE-TAX-MASTER,
 19262           DFHEIV12,
 19263           WS-ERRESS-KEY,
 19264           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 351
* EL050.cbl
 19265           DFHEIV11,
 19266           DFHEIV99,
 19267           DFHEIV99
 19268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19269
 19270
 19271     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19272
 19273* EXEC CICS ENDBR
 19274*            DATASET (FILE-ID-ERRESS)
 19275*       END-EXEC
 19276     MOVE 0
 19277       TO DFHEIV11
 19278*    MOVE '&2                    $   #00019202' TO DFHEIV0
 19279     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19280     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19281     MOVE X'2020233030303139323032' TO DFHEIV0(25:11)
 19282     CALL 'kxdfhei1' USING DFHEIV0,
 19283           FILE-ID-ERRESS,
 19284           DFHEIV11,
 19285           DFHEIV99
 19286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19287        GO TO 6630-END-OF-FILE.
 19288
 19289     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19290        NEXT SENTENCE
 19291      ELSE
 19292        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19293
 19294*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19295*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19296*
 19297     MOVE +2                     TO WS-SUB1.
 19298
 19299     IF PB-ISSUE
 19300     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19301        MOVE +1                  TO WS-SUB1.
 19302
 19303     IF PB-CANCELLATION
 19304     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19305        MOVE +1                  TO WS-SUB1.
 19306*
 19307*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19308*
 19309***  Y2K PROJ 7744
 19310     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19311***  Y2K PROJ 7744
 19312
 19313*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19314* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19315* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19316
 19317     ADD 1                    TO WS-YEAR-YY.
 19318
 19319     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19320         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19321                              TO WS-RES-STATE-TAX
 19322         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 352
* EL050.cbl
 19323                              TO WS-RES-MUNI-TAX
 19324     ELSE
 19325         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19326                              TO WS-RES-STATE-TAX
 19327         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19328                              TO WS-RES-MUNI-TAX.
 19329
 19330*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19331
 19332     IF PB-CANCELLATION
 19333         GO TO 6640-CANCEL-TAX.
 19334
 19335     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19336         COMPUTE PB-I-STATE-TAX ROUNDED =
 19337                                   PB-I-LF-PREMIUM-AMT
 19338                                 * WS-RES-STATE-TAX
 19339         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19340                                   PB-I-LF-PREMIUM-AMT
 19341                                 * WS-RES-MUNI-TAX
 19342     ELSE
 19343     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19344         COMPUTE PB-I-STATE-TAX ROUNDED =
 19345                                   PB-I-AH-PREMIUM-AMT
 19346                                 * WS-RES-STATE-TAX
 19347         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19348                                   PB-I-AH-PREMIUM-AMT
 19349                                 * WS-RES-MUNI-TAX.
 19350
 19351
 19352* EXEC CICS ENDBR
 19353*         DATASET (FILE-ID-ERRESS)
 19354*    END-EXEC.
 19355     MOVE 0
 19356       TO DFHEIV11
 19357*    MOVE '&2                    $   #00019269' TO DFHEIV0
 19358     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19360     MOVE X'2020233030303139323639' TO DFHEIV0(25:11)
 19361     CALL 'kxdfhei1' USING DFHEIV0,
 19362           FILE-ID-ERRESS,
 19363           DFHEIV11,
 19364           DFHEIV99
 19365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19366
 19367
 19368     GO TO 6640-EXIT.
 19369
 19370 6640-CANCEL-TAX.
 19371     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19372
 19373     IF PB-C-LF-CANCEL-AMT > ZEROS
 19374         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19375                                   PB-C-LF-CANCEL-AMT
 19376                                 * WS-RES-STATE-TAX
 19377         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19378                                   PB-C-LF-CANCEL-AMT
 19379                                *  WS-RES-MUNI-TAX
 19380     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 353
* EL050.cbl
 19381     IF PB-C-AH-CANCEL-AMT > ZEROS
 19382         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19383                                   PB-C-AH-CANCEL-AMT
 19384                                 * WS-RES-STATE-TAX
 19385         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19386                                   PB-C-AH-CANCEL-AMT
 19387                                *  WS-RES-MUNI-TAX.
 19388
 19389
 19390* EXEC CICS ENDBR
 19391*         DATASET (FILE-ID-ERRESS)
 19392*    END-EXEC.
 19393     MOVE 0
 19394       TO DFHEIV11
 19395*    MOVE '&2                    $   #00019294' TO DFHEIV0
 19396     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19397     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19398     MOVE X'2020233030303139323934' TO DFHEIV0(25:11)
 19399     CALL 'kxdfhei1' USING DFHEIV0,
 19400           FILE-ID-ERRESS,
 19401           DFHEIV11,
 19402           DFHEIV99
 19403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19404
 19405
 19406     GO TO 6640-EXIT.
 19407
 19408 6630-END-OF-FILE.
 19409     MOVE ER-8002              TO WS-ERROR.
 19410     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19411
 19412     GO TO 6640-EXIT.
 19413
 19414 6630-ERRESS-PROBLEM.
 19415     MOVE ER-8044              TO WS-ERROR.
 19416     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19417
 19418 6640-EXIT.
 19419     EXIT.
 19420
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 354
* EL050.cbl
 19422 6650-GET-RES-STATE-COMM.
 19423
 19424     IF PB-COMPANY-ID NOT = 'DMD'
 19425         GO TO 6700-COMM-EXIT.
 19426
 19427     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19428     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19429     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19430     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19431     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19432     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19433     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19434
 19435*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19436*
 19437***  Y2K PROJ 7744
 19438     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19439     SET BIN-TO-GREG          TO TRUE.
 19440     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19441
 19442     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19443***  Y2K PROJ 7744
 19444
 19445     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19446
 19447
 19448* EXEC CICS HANDLE CONDITION
 19449*        INVREQ    (6660-START-BROWSE)
 19450*        DISABLED  (6690-ERRESC-PROBLEM)
 19451*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19452*        NOTFND    (6690-END-OF-FILE)
 19453*    END-EXEC.
 19454*    MOVE '"$8cJI                ! & #00019339' TO DFHEIV0
 19455     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19456     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19457     MOVE X'2620233030303139333339' TO DFHEIV0(25:11)
 19458     CALL 'kxdfhei1' USING DFHEIV0
 19459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19460
 19461
 19462
 19463* EXEC CICS RESETBR
 19464*        DATASET (FILE-ID-ERRESC)
 19465*        RIDFLD  (WS-ERRESC-KEY)
 19466*    END-EXEC.
 19467     MOVE 0
 19468       TO DFHEIV11
 19469*    MOVE '&4         G          &   #00019346' TO DFHEIV0
 19470     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19471     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19472     MOVE X'2020233030303139333436' TO DFHEIV0(25:11)
 19473     CALL 'kxdfhei1' USING DFHEIV0,
 19474           FILE-ID-ERRESC,
 19475           WS-ERRESC-KEY,
 19476           DFHEIV99,
 19477           DFHEIV11,
 19478           DFHEIV99
 19479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 355
* EL050.cbl
 19480
 19481
 19482 6660-START-BROWSE.
 19483
 19484
 19485* EXEC CICS HANDLE CONDITION
 19486*        NOTFND    (6690-END-OF-FILE)
 19487*        DISABLED  (6690-ERRESC-PROBLEM)
 19488*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19489*        ENDFILE   (6690-END-OF-FILE)
 19490*    END-EXEC.
 19491*    MOVE '"$IcJ''                ! '' #00019353' TO DFHEIV0
 19492     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19493     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19494     MOVE X'2720233030303139333533' TO DFHEIV0(25:11)
 19495     CALL 'kxdfhei1' USING DFHEIV0
 19496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19497
 19498
 19499
 19500* EXEC CICS STARTBR
 19501*        DATASET (FILE-ID-ERRESC)
 19502*        RIDFLD  (WS-ERRESC-KEY)
 19503*        GTEQ
 19504*    END-EXEC.
 19505     MOVE 0
 19506       TO DFHEIV11
 19507*    MOVE '&,         G          &   #00019360' TO DFHEIV0
 19508     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19509     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19510     MOVE X'2020233030303139333630' TO DFHEIV0(25:11)
 19511     CALL 'kxdfhei1' USING DFHEIV0,
 19512           FILE-ID-ERRESC,
 19513           WS-ERRESC-KEY,
 19514           DFHEIV99,
 19515           DFHEIV11,
 19516           DFHEIV99
 19517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19518
 19519
 19520     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19521
 19522 6670-READ-NEXT-ERRESC-MASTER.
 19523
 19524
 19525* EXEC CICS HANDLE CONDITION
 19526*        NOTFND    (6690-END-OF-FILE)
 19527*        DISABLED  (6690-ERRESC-PROBLEM)
 19528*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19529*        ENDFILE   (6690-END-OF-FILE)
 19530*    END-EXEC.
 19531*    MOVE '"$IcJ''                ! ( #00019370' TO DFHEIV0
 19532     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19534     MOVE X'2820233030303139333730' TO DFHEIV0(25:11)
 19535     CALL 'kxdfhei1' USING DFHEIV0
 19536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19537
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 356
* EL050.cbl
 19538
 19539
 19540* EXEC CICS READNEXT
 19541*        DATASET (FILE-ID-ERRESC)
 19542*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19543*        RIDFLD  (ERRESC-RECORD-KEY)
 19544*    END-EXEC.
 19545     MOVE LENGTH OF
 19546      ACCOUNT-RESIDENT-ST-COMMISSION
 19547       TO DFHEIV12
 19548     MOVE 0
 19549       TO DFHEIV11
 19550*    MOVE '&.IL                  )   #00019377' TO DFHEIV0
 19551     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19552     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19553     MOVE X'2020233030303139333737' TO DFHEIV0(25:11)
 19554     CALL 'kxdfhei1' USING DFHEIV0,
 19555           FILE-ID-ERRESC,
 19556           ACCOUNT-RESIDENT-ST-COMMISSION,
 19557           DFHEIV12,
 19558           ERRESC-RECORD-KEY,
 19559           DFHEIV99,
 19560           DFHEIV11,
 19561           DFHEIV99,
 19562           DFHEIV99
 19563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19564
 19565
 19566     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19567        NEXT SENTENCE
 19568     ELSE
 19569
 19570* EXEC CICS ENDBR
 19571*            DATASET (FILE-ID-ERRESC)
 19572*       END-EXEC
 19573     MOVE 0
 19574       TO DFHEIV11
 19575*    MOVE '&2                    $   #00019386' TO DFHEIV0
 19576     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19577     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19578     MOVE X'2020233030303139333836' TO DFHEIV0(25:11)
 19579     CALL 'kxdfhei1' USING DFHEIV0,
 19580           FILE-ID-ERRESC,
 19581           DFHEIV11,
 19582           DFHEIV99
 19583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19584        GO TO 6690-END-OF-FILE.
 19585
 19586     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19587
 19588* EXEC CICS ENDBR
 19589*            DATASET (FILE-ID-ERRESC)
 19590*       END-EXEC
 19591     MOVE 0
 19592       TO DFHEIV11
 19593*    MOVE '&2                    $   #00019392' TO DFHEIV0
 19594     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19595     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 357
* EL050.cbl
 19596     MOVE X'2020233030303139333932' TO DFHEIV0(25:11)
 19597     CALL 'kxdfhei1' USING DFHEIV0,
 19598           FILE-ID-ERRESC,
 19599           DFHEIV11,
 19600           DFHEIV99
 19601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19602        GO TO 6690-END-OF-FILE.
 19603
 19604     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19605        NEXT SENTENCE
 19606      ELSE
 19607        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19608
 19609* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19610*
 19611     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19612
 19613     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19614
 19615     IF WS-SUB1 > ZERO
 19616         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19617             PERFORM 6680-SET-COMMISSION
 19618         ELSE
 19619             PERFORM 6680-SET-TABLE-CODE.
 19620
 19621
 19622* EXEC CICS ENDBR
 19623*         DATASET (FILE-ID-ERRESC)
 19624*    END-EXEC.
 19625     MOVE 0
 19626       TO DFHEIV11
 19627*    MOVE '&2                    $   #00019414' TO DFHEIV0
 19628     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19629     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19630     MOVE X'2020233030303139343134' TO DFHEIV0(25:11)
 19631     CALL 'kxdfhei1' USING DFHEIV0,
 19632           FILE-ID-ERRESC,
 19633           DFHEIV11,
 19634           DFHEIV99
 19635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19636
 19637
 19638     GO TO 6700-COMM-EXIT.
 19639
 19640 6680-SET-TABLE-CODE.
 19641     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19642        MOVE ZEROS             TO WS-SUB1
 19643     ELSE
 19644* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19645* TO COMPUTE AH COMMISSION.
 19646        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19647        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19648        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19649        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19650        PERFORM 6680-READ-CTBL-TABLE
 19651        IF WS-CTBL-READ-SW NOT = 'Y'
 19652           MOVE ZEROS          TO WS-SUB1.
 19653
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 358
* EL050.cbl
 19654 6680-READ-CTBL-TABLE.
 19655*
 19656* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19657* TO COMPUTE LIFE COMMISSION
 19658
 19659     IF CTBL-SW = '0540'
 19660        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19661        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19662        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19663
 19664     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19665
 19666     IF CTBL-TABLE-FOUND
 19667        IF CTBL-SW = '0530'
 19668             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19669                                    * PB-I-AH-TERM
 19670             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19671             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19672        ELSE
 19673             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19674             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19675             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19676     ELSE
 19677        IF FIRST-TIME-THROUGH
 19678            GO TO 6680-READ-CTBL-TABLE
 19679        ELSE
 19680            MOVE ZEROS         TO WS-SUB1.
 19681
 19682 6680-SET-COMMISSION.
 19683     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19684           MOVE ZEROS          TO WS-SUB1
 19685       ELSE
 19686           MOVE RESC-COMMISSION-PER (WS-SUB)
 19687                               TO WS-COMMISSION
 19688           IF CTBL-SW = '0530'
 19689               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19690           ELSE
 19691               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19692
 19693 6680-SEARCH-CATEGORY.
 19694     ADD +1                   TO WS-SUB.
 19695     IF WS-SUB > +12
 19696         GO TO 6680-EXIT.
 19697
 19698     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19699          MOVE WS-SUB         TO WS-SUB1
 19700          GO TO 6680-EXIT.
 19701
 19702     GO TO 6680-SEARCH-CATEGORY.
 19703
 19704 6680-EXIT.
 19705     EXIT.
 19706
 19707 6690-END-OF-FILE.
 19708     GO TO 6700-COMM-EXIT.
 19709
 19710 6690-ERRESC-PROBLEM.
 19711      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 359
* EL050.cbl
 19712      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19713
 19714      GO TO 6700-COMM-EXIT.
 19715
 19716 6700-COMM-EXIT.
 19717     EXIT.
 19718
 19719 7000-GET-RATE.
 19720
 19721* EXEC CICS LINK
 19722*        PROGRAM    ('ELRATE')
 19723*        COMMAREA   (CALCULATION-PASS-AREA)
 19724*        LENGTH     (CP-COMM-LENGTH)
 19725*    END-EXEC.
 19726     MOVE 'ELRATE' TO DFHEIV1
 19727*    MOVE '."C                   (   #00019500' TO DFHEIV0
 19728     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19729     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19730     MOVE X'2020233030303139353030' TO DFHEIV0(25:11)
 19731     CALL 'kxdfhei1' USING DFHEIV0,
 19732           DFHEIV1,
 19733           CALCULATION-PASS-AREA,
 19734           CP-COMM-LENGTH,
 19735           DFHEIV99,
 19736           DFHEIV99,
 19737           DFHEIV99,
 19738           DFHEIV99
 19739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19740
 19741
 19742 7000-EXIT.
 19743     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 360
* EL050.cbl
 19745 7100-FIND-BENEFIT-IN-STATE.
 19746     MOVE 'N'                    TO BEN-SEARCH-SW.
 19747
 19748     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19749         VARYING SUB3 FROM 1 BY 1 UNTIL
 19750            ((SUB3 GREATER 50) OR
 19751              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19752               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19753
 19754     IF SUB3 NOT = 51
 19755         MOVE 'Y'                TO BEN-SEARCH-SW.
 19756
 19757     GO TO 7199-EXIT.
 19758
 19759 7100-BENEFIT-DUMMY.
 19760
 19761 7100-DUMMY-EXIT.
 19762     EXIT.
 19763
 19764 7199-EXIT.
 19765     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 361
* EL050.cbl
 19767 7200-FIND-BENEFIT.
 19768     MOVE 'N'                    TO BEN-SEARCH-SW.
 19769
 19770     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19771         VARYING SUB3 FROM 1 BY 1 UNTIL
 19772            ((SUB3 GREATER 8) OR
 19773            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19774
 19775     IF SUB3 NOT = 9
 19776         MOVE 'Y'                TO BEN-SEARCH-SW.
 19777
 19778     GO TO 7200-EXIT.
 19779
 19780 7200-BENEFIT-DUMMY.
 19781
 19782 7200-DUMMY-EXIT.
 19783     EXIT.
 19784
 19785 7200-EXIT.
 19786     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 362
* EL050.cbl
 19788 7250-LOOK-FOR-RESCINDED-CLAIM.
 19789     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19790                                    W-CL-COMP-CD.
 19791     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19792                                    W-CL-CERT-NO.
 19793
 19794
 19795* EXEC CICS HANDLE CONDITION
 19796*        NOTFND  (7250-CONTINUE)
 19797*        ENDFILE (7250-CONTINUE)
 19798*    END-EXEC.
 19799*    MOVE '"$I''                  ! ) #00019558' TO DFHEIV0
 19800     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19802     MOVE X'2920233030303139353538' TO DFHEIV0(25:11)
 19803     CALL 'kxdfhei1' USING DFHEIV0
 19804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19805
 19806
 19807
 19808* EXEC CICS IGNORE CONDITION
 19809*        DUPKEY
 19810*    END-EXEC.
 19811*    MOVE '"*$                   !   #00019563' TO DFHEIV0
 19812     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19813     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19814     MOVE X'2020233030303139353633' TO DFHEIV0(25:11)
 19815     CALL 'kxdfhei1' USING DFHEIV0
 19816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19817
 19818
 19819
 19820* EXEC CICS STARTBR
 19821*        DATASET   (CLMS-ID)
 19822*        RIDFLD    (ELMSTR-KEY)
 19823*        GENERIC   EQUAL
 19824*        KEYLENGTH (ELMSTR-LENGTH)
 19825*    END-EXEC.
 19826     MOVE 0
 19827       TO DFHEIV11
 19828*    MOVE '&,   KG    E          &   #00019567' TO DFHEIV0
 19829     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19830     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19831     MOVE X'2020233030303139353637' TO DFHEIV0(25:11)
 19832     CALL 'kxdfhei1' USING DFHEIV0,
 19833           CLMS-ID,
 19834           ELMSTR-KEY,
 19835           ELMSTR-LENGTH,
 19836           DFHEIV11,
 19837           DFHEIV99
 19838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19839
 19840
 19841     MOVE 'Y'                    TO W-BROWSE-SW.
 19842
 19843 7250-NEXT-CLAIM.
 19844
 19845
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 363
* EL050.cbl
 19846* EXEC CICS READNEXT
 19847*        DATASET   (CLMS-ID)
 19848*        RIDFLD    (ELMSTR-KEY)
 19849*        SET       (ADDRESS OF CLAIM-MASTER)
 19850*    END-EXEC.
 19851     MOVE 0
 19852       TO DFHEIV11
 19853*    MOVE '&.S                   )   #00019578' TO DFHEIV0
 19854     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19855     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19856     MOVE X'2020233030303139353738' TO DFHEIV0(25:11)
 19857     CALL 'kxdfhei1' USING DFHEIV0,
 19858           CLMS-ID,
 19859           DFHEIV20,
 19860           DFHEIV99,
 19861           ELMSTR-KEY,
 19862           DFHEIV99,
 19863           DFHEIV11,
 19864           DFHEIV99,
 19865           DFHEIV99
 19866     SET ADDRESS OF CLAIM-MASTER TO
 19867         DFHEIV20
 19868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19869
 19870
 19871     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19872        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19873         GO TO 7250-CONTINUE
 19874     END-IF.
 19875
 19876     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19877        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19878        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19879        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19880        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19881         GO TO 7250-NEXT-CLAIM
 19882     END-IF.
 19883
 19884     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19885        OR (CL-CLAIM-TYPE = 'I')
 19886        OR (CL-CLAIM-TYPE = 'G')
 19887        OR (CL-CLAIM-TYPE = 'F')
 19888          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19889              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19890              GO TO 7250-CONTINUE
 19891          END-IF
 19892     END-IF.
 19893
 19894     GO TO 7250-NEXT-CLAIM.
 19895
 19896 7250-CONTINUE.
 19897
 19898     IF W-BROWSE-SW = 'Y'
 19899
 19900* EXEC CICS ENDBR
 19901*            DATASET   (CLMS-ID)
 19902*        END-EXEC
 19903     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 364
* EL050.cbl
 19904       TO DFHEIV11
 19905*    MOVE '&2                    $   #00019612' TO DFHEIV0
 19906     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19907     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19908     MOVE X'2020233030303139363132' TO DFHEIV0(25:11)
 19909     CALL 'kxdfhei1' USING DFHEIV0,
 19910           CLMS-ID,
 19911           DFHEIV11,
 19912           DFHEIV99
 19913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19914         MOVE 'N' TO W-BROWSE-SW
 19915     END-IF.
 19916
 19917 7250-EXIT.
 19918     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 365
* EL050.cbl
 19920 7300-CHECK-FOR-OPEN-CLMS.
 19921
 19922*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19923*    MOVE SPACES                 TO CNTL-ACCESS.
 19924*    MOVE '1'                    TO CNTL-REC-TYPE.
 19925*    MOVE +0                     TO CNTL-SEQ-NO.
 19926
 19927*    MOVE '3'                    TO RC-SW-1.
 19928*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19929
 19930*    IF NOT CF-COMPANY-MASTER
 19931*         PERFORM 0099-COMPANY-NOT-FOUND
 19932*         GO TO 7300-EXIT.
 19933
 19934     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19935                                    W-CL-COMP-CD.
 19936     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19937                                    W-CL-CERT-NO.
 19938
 19939
 19940* EXEC CICS HANDLE CONDITION
 19941*        NOTFND  (7300-CONTINUE)
 19942*        ENDFILE (7300-CONTINUE)
 19943*    END-EXEC.
 19944*    MOVE '"$I''                  ! * #00019640' TO DFHEIV0
 19945     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19946     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19947     MOVE X'2A20233030303139363430' TO DFHEIV0(25:11)
 19948     CALL 'kxdfhei1' USING DFHEIV0
 19949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19950
 19951
 19952
 19953* EXEC CICS IGNORE CONDITION
 19954*        DUPKEY
 19955*    END-EXEC.
 19956*    MOVE '"*$                   !   #00019645' TO DFHEIV0
 19957     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19958     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19959     MOVE X'2020233030303139363435' TO DFHEIV0(25:11)
 19960     CALL 'kxdfhei1' USING DFHEIV0
 19961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19962
 19963
 19964
 19965* EXEC CICS STARTBR
 19966*        DATASET   (CLMS-ID)
 19967*        RIDFLD    (ELMSTR-KEY)
 19968*        GENERIC   EQUAL
 19969*        KEYLENGTH (ELMSTR-LENGTH)
 19970*    END-EXEC.
 19971     MOVE 0
 19972       TO DFHEIV11
 19973*    MOVE '&,   KG    E          &   #00019649' TO DFHEIV0
 19974     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19975     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19976     MOVE X'2020233030303139363439' TO DFHEIV0(25:11)
 19977     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 366
* EL050.cbl
 19978           CLMS-ID,
 19979           ELMSTR-KEY,
 19980           ELMSTR-LENGTH,
 19981           DFHEIV11,
 19982           DFHEIV99
 19983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19984
 19985
 19986     MOVE 'Y'                    TO W-BROWSE-SW.
 19987
 19988 7300-NEXT-CLAIM.
 19989
 19990
 19991* EXEC CICS READNEXT
 19992*        DATASET   (CLMS-ID)
 19993*        RIDFLD    (ELMSTR-KEY)
 19994*        SET       (ADDRESS OF CLAIM-MASTER)
 19995*    END-EXEC.
 19996     MOVE 0
 19997       TO DFHEIV11
 19998*    MOVE '&.S                   )   #00019660' TO DFHEIV0
 19999     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20000     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20001     MOVE X'2020233030303139363630' TO DFHEIV0(25:11)
 20002     CALL 'kxdfhei1' USING DFHEIV0,
 20003           CLMS-ID,
 20004           DFHEIV20,
 20005           DFHEIV99,
 20006           ELMSTR-KEY,
 20007           DFHEIV99,
 20008           DFHEIV11,
 20009           DFHEIV99,
 20010           DFHEIV99
 20011     SET ADDRESS OF CLAIM-MASTER TO
 20012         DFHEIV20
 20013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20014
 20015
 20016     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20017        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20018         GO TO 7300-CONTINUE.
 20019
 20020     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20021        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20022        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20023        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20024        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20025         GO TO 7300-NEXT-CLAIM.
 20026
 20027*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 20028     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20029        OR (CL-CLAIM-TYPE = 'I')
 20030        OR (CL-CLAIM-TYPE = 'G')
 20031        OR (CL-CLAIM-TYPE = 'F')
 20032        IF CLAIM-IS-OPEN
 20033           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20034             AND PB-C-AH-CANCEL-DT > SPACES
 20035              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 367
* EL050.cbl
 20036              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20037           END-IF
 20038           EVALUATE TRUE
 20039             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20040                 MOVE ER-2884      TO WS-ERROR
 20041             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20042                 MOVE ER-2887      TO WS-ERROR
 20043             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20044                 MOVE ER-2886      TO WS-ERROR
 20045             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20046                 MOVE ER-2888      TO WS-ERROR
 20047             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20048                 MOVE ER-2885      TO WS-ERROR
 20049             WHEN OTHER
 20050                 MOVE ER-2768      TO WS-ERROR
 20051           END-EVALUATE
 20052           IF PB-C-AH-CANCEL-VOIDED OR
 20053              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20054                NOT AH-COVERAGE-CANCELLED)
 20055               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20056               MOVE ER-2768      TO WS-ERROR
 20057           END-IF
 20058           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20059           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20060              PB-FORCE-CODE NOT EQUAL '8'
 20061               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20062           END-IF
 20063           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20064           GO TO 7300-NEXT-CLAIM
 20065        ELSE
 20066           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20067*****THIS IS A RESCISSION OR REFORMATION
 20068              IF AH-COVERAGE-CANCELLED
 20069                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 20070                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 20071                    MOVE 1                   TO DC-ELAPSED-DAYS
 20072                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 20073                    SET BIN-PLUS-ELAPSED     TO TRUE
 20074                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 20075                    IF NO-CONVERSION-ERROR
 20076                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 20077                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 20078                          MOVE ER-2897 TO WS-ERROR
 20079                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20080                          GO TO 7300-NEXT-CLAIM
 20081                       END-IF
 20082                    END-IF
 20083                 ELSE
 20084                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 20085                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20086                         MOVE ER-2890 TO WS-ERROR
 20087                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20088                         GO TO 7300-NEXT-CLAIM
 20089                      ELSE
 20090                         MOVE ER-2898 TO WS-ERROR
 20091                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20092                         GO TO 7300-NEXT-CLAIM
 20093                      END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 368
* EL050.cbl
 20094                   END-IF
 20095                 END-IF
 20096              END-IF
 20097           ELSE
 20098              IF CL-DENIAL-TYPE = '1'  AND
 20099                 CL-TOTAL-PAID-AMT = 0
 20100                    GO TO 7300-NEXT-CLAIM
 20101              END-IF
 20102              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20103               AND PB-C-AH-CANCEL-DT > SPACES
 20104                 MOVE ER-2756        TO WS-ERROR
 20105                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20106                 GO TO 7300-NEXT-CLAIM
 20107              END-IF
 20108           END-IF
 20109        END-IF
 20110     ELSE
 20111*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 20112        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 20113          OR (CL-CLAIM-TYPE = 'O')
 20114           IF (CLAIM-IS-OPEN)
 20115              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 20116                 <> zeros
 20117              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 20118                 <> zeros)
 20119              MOVE ER-2889      TO WS-ERROR
 20120              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20121              GO TO 7300-NEXT-CLAIM
 20122           ELSE
 20123              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20124*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 20125                 IF (LF-COVERAGE-CANCELLED AND
 20126                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20127                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20128                         MOVE ER-2890 TO WS-ERROR
 20129                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20130                         GO TO 7300-NEXT-CLAIM
 20131                      ELSE
 20132                         MOVE ER-2898 TO WS-ERROR
 20133                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20134                         GO TO 7300-NEXT-CLAIM
 20135                      END-IF
 20136                 END-IF
 20137              ELSE
 20138                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 20139                    and (CL-TOTAL-PAID-AMT = 0)
 20140                    GO TO 7300-NEXT-CLAIM
 20141                 END-IF
 20142                 IF (
 20143                      (AH-COVERAGE-CANCELLED)
 20144                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 20145                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 20146                      and (pb-ci-ah-cancel-amt +
 20147                         pb-c-ah-cancel-amt) <> zeros
 20148                    )
 20149                               OR
 20150                    (
 20151                      (LF-COVERAGE-CANCELLED)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 369
* EL050.cbl
 20152                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
 20153                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 20154                      and (pb-ci-lf-cancel-amt +
 20155                         pb-c-lf-cancel-amt) <> zeros
 20156                    )
 20157                       IF CL-CLAIM-TYPE = 'O'
 20158                          MOVE ER-2998 TO WS-ERROR
 20159                       ELSE
 20160                          MOVE ER-2965 TO WS-ERROR
 20161                       END-IF
 20162                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20163                       GO TO 7300-NEXT-CLAIM
 20164                 END-IF
 20165                 IF LF-COVERAGE-CANCELLED
 20166                  IF CL-TOTAL-PAID-AMT > 0
 20167                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20168                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20169                        MOVE ER-2891 TO WS-ERROR
 20170                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20171                        GO TO 7300-NEXT-CLAIM
 20172                      END-IF
 20173                    ELSE
 20174****only show this error if cert num matches exactly
 20175                      IF PB-CERT-NO = CL-CERT-NO
 20176                         IF CL-CLAIM-TYPE = 'O'
 20177                            MOVE ER-2895 TO WS-ERROR
 20178                         ELSE
 20179                            MOVE ER-2892 TO WS-ERROR
 20180                         END-IF
 20181                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20182                         GO TO 7300-NEXT-CLAIM
 20183                      END-IF
 20184                    END-IF
 20185                  END-IF
 20186                 END-IF
 20187              END-IF
 20188           END-IF
 20189        END-IF
 20190     END-IF
 20191
 20192     GO TO 7300-NEXT-CLAIM.
 20193
 20194 7300-CONTINUE.
 20195
 20196     IF W-BROWSE-SW = 'Y'
 20197
 20198* EXEC CICS ENDBR
 20199*            DATASET   (CLMS-ID)
 20200*        END-EXEC.
 20201     MOVE 0
 20202       TO DFHEIV11
 20203*    MOVE '&2                    $   #00019847' TO DFHEIV0
 20204     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20205     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20206     MOVE X'2020233030303139383437' TO DFHEIV0(25:11)
 20207     CALL 'kxdfhei1' USING DFHEIV0,
 20208           CLMS-ID,
 20209           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 370
* EL050.cbl
 20210           DFHEIV99
 20211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20212
 20213
 20214 7300-EXIT.
 20215     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 371
* EL050.cbl
 20217 7320-CHECK-FOR-OPEN-CLMS-issue.
 20218
 20219     move ' '                    to w-browse-sw
 20220     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20221                                    W-CL-COMP-CD
 20222     MOVE PB-CERT-NO(1:10)       TO MSTR-CERT-NO
 20223                                    W-CL-CERT-NO
 20224
 20225
 20226* EXEC CICS HANDLE CONDITION
 20227*        NOTFND  (7320-CONTINUE)
 20228*        ENDFILE (7320-CONTINUE)
 20229*    END-EXEC.
 20230*    MOVE '"$I''                  ! + #00019862' TO DFHEIV0
 20231     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20233     MOVE X'2B20233030303139383632' TO DFHEIV0(25:11)
 20234     CALL 'kxdfhei1' USING DFHEIV0
 20235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20236
 20237
 20238
 20239* EXEC CICS IGNORE CONDITION
 20240*        DUPKEY
 20241*    END-EXEC.
 20242*    MOVE '"*$                   !   #00019867' TO DFHEIV0
 20243     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 20244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20245     MOVE X'2020233030303139383637' TO DFHEIV0(25:11)
 20246     CALL 'kxdfhei1' USING DFHEIV0
 20247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20248
 20249
 20250
 20251* EXEC CICS STARTBR
 20252*        DATASET   (CLMS-ID)
 20253*        RIDFLD    (ELMSTR-KEY)
 20254*        GENERIC   EQUAL
 20255*        KEYLENGTH (ELMSTR-LENGTH)
 20256*    END-EXEC.
 20257     MOVE 0
 20258       TO DFHEIV11
 20259*    MOVE '&,   KG    E          &   #00019871' TO DFHEIV0
 20260     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 20261     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20262     MOVE X'2020233030303139383731' TO DFHEIV0(25:11)
 20263     CALL 'kxdfhei1' USING DFHEIV0,
 20264           CLMS-ID,
 20265           ELMSTR-KEY,
 20266           ELMSTR-LENGTH,
 20267           DFHEIV11,
 20268           DFHEIV99
 20269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20270
 20271
 20272     MOVE 'Y'                    TO W-BROWSE-SW.
 20273
 20274 7320-NEXT-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 372
* EL050.cbl
 20275
 20276
 20277* EXEC CICS READNEXT
 20278*        DATASET   (CLMS-ID)
 20279*        RIDFLD    (ELMSTR-KEY)
 20280*        SET       (ADDRESS OF CLAIM-MASTER)
 20281*    END-EXEC.
 20282     MOVE 0
 20283       TO DFHEIV11
 20284*    MOVE '&.S                   )   #00019882' TO DFHEIV0
 20285     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20286     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20287     MOVE X'2020233030303139383832' TO DFHEIV0(25:11)
 20288     CALL 'kxdfhei1' USING DFHEIV0,
 20289           CLMS-ID,
 20290           DFHEIV20,
 20291           DFHEIV99,
 20292           ELMSTR-KEY,
 20293           DFHEIV99,
 20294           DFHEIV11,
 20295           DFHEIV99,
 20296           DFHEIV99
 20297     SET ADDRESS OF CLAIM-MASTER TO
 20298         DFHEIV20
 20299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20300
 20301
 20302     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20303        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20304         GO TO 7320-CONTINUE.
 20305
 20306     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20307        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20308        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20309        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20310        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20311         GO TO 7320-NEXT-CLAIM.
 20312
 20313     IF CLAIM-IS-OPEN
 20314        MOVE ER-3273             TO WS-ERROR
 20315        PERFORM 9900-ERROR-FORMAT
 20316                                 THRU 9900-EXIT
 20317     END-IF
 20318
 20319     GO TO 7320-NEXT-CLAIM.
 20320
 20321 7320-CONTINUE.
 20322
 20323     IF W-BROWSE-SW = 'Y'
 20324
 20325* EXEC CICS ENDBR
 20326*            DATASET   (CLMS-ID)
 20327*        END-EXEC.
 20328     MOVE 0
 20329       TO DFHEIV11
 20330*    MOVE '&2                    $   #00019910' TO DFHEIV0
 20331     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20332     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 373
* EL050.cbl
 20333     MOVE X'2020233030303139393130' TO DFHEIV0(25:11)
 20334     CALL 'kxdfhei1' USING DFHEIV0,
 20335           CLMS-ID,
 20336           DFHEIV11,
 20337           DFHEIV99
 20338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20339
 20340
 20341 7320-EXIT.
 20342     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 374
* EL050.cbl
 20344 7400-GET-REMAIN-TERM.
 20345
 20346* EXEC CICS LINK
 20347*        PROGRAM    ('ELRTRM')
 20348*        COMMAREA   (CALCULATION-PASS-AREA)
 20349*        LENGTH     (CP-COMM-LENGTH)
 20350*    END-EXEC.
 20351     MOVE 'ELRTRM' TO DFHEIV1
 20352*    MOVE '."C                   (   #00019918' TO DFHEIV0
 20353     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20354     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20355     MOVE X'2020233030303139393138' TO DFHEIV0(25:11)
 20356     CALL 'kxdfhei1' USING DFHEIV0,
 20357           DFHEIV1,
 20358           CALCULATION-PASS-AREA,
 20359           CP-COMM-LENGTH,
 20360           DFHEIV99,
 20361           DFHEIV99,
 20362           DFHEIV99,
 20363           DFHEIV99
 20364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20365
 20366
 20367 7400-EXIT.
 20368     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 375
* EL050.cbl
 20370
 20371 7500-GET-REMAIN-AMOUNT.
 20372
 20373* EXEC CICS LINK
 20374*        PROGRAM    ('ELRAMT')
 20375*        COMMAREA   (CALCULATION-PASS-AREA)
 20376*        LENGTH     (CP-COMM-LENGTH)
 20377*    END-EXEC.
 20378     MOVE 'ELRAMT' TO DFHEIV1
 20379*    MOVE '."C                   (   #00019929' TO DFHEIV0
 20380     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20381     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20382     MOVE X'2020233030303139393239' TO DFHEIV0(25:11)
 20383     CALL 'kxdfhei1' USING DFHEIV0,
 20384           DFHEIV1,
 20385           CALCULATION-PASS-AREA,
 20386           CP-COMM-LENGTH,
 20387           DFHEIV99,
 20388           DFHEIV99,
 20389           DFHEIV99,
 20390           DFHEIV99
 20391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20392
 20393
 20394 7500-EXIT.
 20395     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 376
* EL050.cbl
 20397
 20398 7600-GET-REFUND.
 20399
 20400* EXEC CICS LINK
 20401*        PROGRAM    ('ELRFND')
 20402*        COMMAREA   (CALCULATION-PASS-AREA)
 20403*        LENGTH     (CP-COMM-LENGTH)
 20404*    END-EXEC.
 20405     MOVE 'ELRFND' TO DFHEIV1
 20406*    MOVE '."C                   (   #00019940' TO DFHEIV0
 20407     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20408     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20409     MOVE X'2020233030303139393430' TO DFHEIV0(25:11)
 20410     CALL 'kxdfhei1' USING DFHEIV0,
 20411           DFHEIV1,
 20412           CALCULATION-PASS-AREA,
 20413           CP-COMM-LENGTH,
 20414           DFHEIV99,
 20415           DFHEIV99,
 20416           DFHEIV99,
 20417           DFHEIV99
 20418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20419
 20420
 20421 7600-EXIT.
 20422     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 377
* EL050.cbl
 20424 7700-CALL-DL1.
 20425
 20426* EXEC CICS LINK
 20427*        PROGRAM    ('DLO001')
 20428*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20429*        LENGTH     (DLO001-COMM-LENGTH)
 20430*    END-EXEC.
 20431     MOVE 'DLO001' TO DFHEIV1
 20432*    MOVE '."C                   (   #00019950' TO DFHEIV0
 20433     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20434     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20435     MOVE X'2020233030303139393530' TO DFHEIV0(25:11)
 20436     CALL 'kxdfhei1' USING DFHEIV0,
 20437           DFHEIV1,
 20438           WS-DLO-MASTER-POLICY-FORM,
 20439           DLO001-COMM-LENGTH,
 20440           DFHEIV99,
 20441           DFHEIV99,
 20442           DFHEIV99,
 20443           DFHEIV99
 20444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20445
 20446
 20447 7700-EXIT.
 20448     EXIT.
 20449
 20450 7710-CALL-DL2.
 20451
 20452* EXEC CICS LINK
 20453*        PROGRAM    ('DLO002')
 20454*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20455*        LENGTH     (DLO002-COMM-LENGTH)
 20456*    END-EXEC.
 20457     MOVE 'DLO002' TO DFHEIV1
 20458*    MOVE '."C                   (   #00019960' TO DFHEIV0
 20459     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20460     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20461     MOVE X'2020233030303139393630' TO DFHEIV0(25:11)
 20462     CALL 'kxdfhei1' USING DFHEIV0,
 20463           DFHEIV1,
 20464           WS-DLO-INTERNAL-POLICY-FORM,
 20465           DLO002-COMM-LENGTH,
 20466           DFHEIV99,
 20467           DFHEIV99,
 20468           DFHEIV99,
 20469           DFHEIV99
 20470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20471
 20472
 20473 7710-EXIT.
 20474     EXIT.
 20475
 20476 7720-CALL-DL3.
 20477
 20478* EXEC CICS LINK
 20479*        PROGRAM    ('DLO003')
 20480*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20481*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 378
* EL050.cbl
 20482*    END-EXEC.
 20483     MOVE 'DLO003' TO DFHEIV1
 20484*    MOVE '."C                   (   #00019970' TO DFHEIV0
 20485     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20487     MOVE X'2020233030303139393730' TO DFHEIV0(25:11)
 20488     CALL 'kxdfhei1' USING DFHEIV0,
 20489           DFHEIV1,
 20490           WS-DLO-VALID-BANK-ID,
 20491           DLO003-COMM-LENGTH,
 20492           DFHEIV99,
 20493           DFHEIV99,
 20494           DFHEIV99,
 20495           DFHEIV99
 20496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20497
 20498
 20499 7720-EXIT.
 20500     EXIT.
 20501
 20502 7730-CALL-DL7.
 20503
 20504* EXEC CICS LINK
 20505*        PROGRAM    ('DLO007')
 20506*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20507*        LENGTH     (DLO007-COMM-LENGTH)
 20508*    END-EXEC.
 20509     MOVE 'DLO007' TO DFHEIV1
 20510*    MOVE '."C                   (   #00019980' TO DFHEIV0
 20511     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20512     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20513     MOVE X'2020233030303139393830' TO DFHEIV0(25:11)
 20514     CALL 'kxdfhei1' USING DFHEIV0,
 20515           DFHEIV1,
 20516           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20517           DLO007-COMM-LENGTH,
 20518           DFHEIV99,
 20519           DFHEIV99,
 20520           DFHEIV99,
 20521           DFHEIV99
 20522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20523
 20524
 20525 7730-EXIT.
 20526     EXIT.
 20527
 20528 7740-CALL-DL11.
 20529
 20530* EXEC CICS LINK
 20531*        PROGRAM    ('DLO011')
 20532*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20533*        LENGTH     (DLO011-COMM-LENGTH)
 20534*    END-EXEC.
 20535     MOVE 'DLO011' TO DFHEIV1
 20536*    MOVE '."C                   (   #00019990' TO DFHEIV0
 20537     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20538     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20539     MOVE X'2020233030303139393930' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 379
* EL050.cbl
 20540     CALL 'kxdfhei1' USING DFHEIV0,
 20541           DFHEIV1,
 20542           WS-DLO-PREM-RATES-BEN-TYPE,
 20543           DLO011-COMM-LENGTH,
 20544           DFHEIV99,
 20545           DFHEIV99,
 20546           DFHEIV99,
 20547           DFHEIV99
 20548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20549
 20550
 20551 7740-EXIT.
 20552     EXIT.
 20553
 20554 7750-CALL-DL17.
 20555
 20556* EXEC CICS LINK
 20557*        PROGRAM    ('DLO017')
 20558*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20559*        LENGTH     (DLO017-COMM-LENGTH)
 20560*    END-EXEC.
 20561     MOVE 'DLO017' TO DFHEIV1
 20562*    MOVE '."C                   (   #00020000' TO DFHEIV0
 20563     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20564     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20565     MOVE X'2020233030303230303030' TO DFHEIV0(25:11)
 20566     CALL 'kxdfhei1' USING DFHEIV0,
 20567           DFHEIV1,
 20568           WS-DLO-VALID-RATE-CODE,
 20569           DLO017-COMM-LENGTH,
 20570           DFHEIV99,
 20571           DFHEIV99,
 20572           DFHEIV99,
 20573           DFHEIV99
 20574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20575
 20576
 20577 7750-EXIT.
 20578     EXIT.
 20579
 20580 7755-CALL-DL19.
 20581
 20582* EXEC CICS LINK
 20583*        PROGRAM    ('DLO019')
 20584*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20585*        LENGTH     (DLO019-COMM-LENGTH)
 20586*    END-EXEC.
 20587     MOVE 'DLO019' TO DFHEIV1
 20588*    MOVE '."C                   (   #00020010' TO DFHEIV0
 20589     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20591     MOVE X'2020233030303230303130' TO DFHEIV0(25:11)
 20592     CALL 'kxdfhei1' USING DFHEIV0,
 20593           DFHEIV1,
 20594           WS-DLO-ORIG-COV-CAT,
 20595           DLO019-COMM-LENGTH,
 20596           DFHEIV99,
 20597           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 380
* EL050.cbl
 20598           DFHEIV99,
 20599           DFHEIV99
 20600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20601
 20602
 20603 7755-EXIT.
 20604     EXIT.
 20605
 20606 7760-CALL-DL21.
 20607
 20608* EXEC CICS LINK
 20609*        PROGRAM    ('DLO021')
 20610*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20611*        LENGTH     (DLO021-COMM-LENGTH)
 20612*    END-EXEC.
 20613     MOVE 'DLO021' TO DFHEIV1
 20614*    MOVE '."C                   (   #00020020' TO DFHEIV0
 20615     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20617     MOVE X'2020233030303230303230' TO DFHEIV0(25:11)
 20618     CALL 'kxdfhei1' USING DFHEIV0,
 20619           DFHEIV1,
 20620           WS-DLO-VALID-LOAN-OFFICER,
 20621           DLO021-COMM-LENGTH,
 20622           DFHEIV99,
 20623           DFHEIV99,
 20624           DFHEIV99,
 20625           DFHEIV99
 20626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20627
 20628
 20629 7760-EXIT.
 20630     EXIT.
 20631
 20632 7770-CALL-DL22.
 20633
 20634* EXEC CICS LINK
 20635*        PROGRAM    ('DLO022')
 20636*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20637*        LENGTH     (DLO022-COMM-LENGTH)
 20638*    END-EXEC.
 20639     MOVE 'DLO022' TO DFHEIV1
 20640*    MOVE '."C                   (   #00020030' TO DFHEIV0
 20641     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20642     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20643     MOVE X'2020233030303230303330' TO DFHEIV0(25:11)
 20644     CALL 'kxdfhei1' USING DFHEIV0,
 20645           DFHEIV1,
 20646           WS-DLO-VALID-STATE-CODE,
 20647           DLO022-COMM-LENGTH,
 20648           DFHEIV99,
 20649           DFHEIV99,
 20650           DFHEIV99,
 20651           DFHEIV99
 20652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20653
 20654
 20655 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 381
* EL050.cbl
 20656     EXIT.
 20657
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 382
* EL050.cbl
 20659
 20660 7780-CALL-AGG.
 20661
 20662* EXEC CICS LINK
 20663*        PROGRAM    ('ELAGGO')
 20664*        COMMAREA   (WS-PASS-to-pemaggo)
 20665*        LENGTH     (ws-passed-key-LENGTH)
 20666*    END-EXEC.
 20667     MOVE 'ELAGGO' TO DFHEIV1
 20668*    MOVE '."C                   (   #00020042' TO DFHEIV0
 20669     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20670     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20671     MOVE X'2020233030303230303432' TO DFHEIV0(25:11)
 20672     CALL 'kxdfhei1' USING DFHEIV0,
 20673           DFHEIV1,
 20674           WS-PASS-to-pemaggo,
 20675           ws-passed-key-LENGTH,
 20676           DFHEIV99,
 20677           DFHEIV99,
 20678           DFHEIV99,
 20679           DFHEIV99
 20680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20681
 20682 7780-EXIT.
 20683     EXIT.
 20684 7785-CALL-HLDI.
 20685
 20686* EXEC CICS LINK
 20687*        PROGRAM    ('ELHLDI')
 20688*        COMMAREA   (HLDI-PASS-AREA)
 20689*        LENGTH     (HLDI-PASS-AREA-LEN)
 20690*    END-EXEC.
 20691     MOVE 'ELHLDI' TO DFHEIV1
 20692*    MOVE '."C                   (   #00020050' TO DFHEIV0
 20693     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20694     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20695     MOVE X'2020233030303230303530' TO DFHEIV0(25:11)
 20696     CALL 'kxdfhei1' USING DFHEIV0,
 20697           DFHEIV1,
 20698           HLDI-PASS-AREA,
 20699           HLDI-PASS-AREA-LEN,
 20700           DFHEIV99,
 20701           DFHEIV99,
 20702           DFHEIV99,
 20703           DFHEIV99
 20704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20705
 20706 7785-EXIT.
 20707     EXIT.
 20708 7786-CALL-HLDIM.
 20709
 20710* EXEC CICS LINK
 20711*        PROGRAM    ('ELHLDIM')
 20712*        COMMAREA   (HLDI-PASS-AREA)
 20713*        LENGTH     (HLDI-PASS-AREA-LEN)
 20714*    END-EXEC.
 20715     MOVE 'ELHLDIM' TO DFHEIV1
 20716*    MOVE '."C                   (   #00020058' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 383
* EL050.cbl
 20717     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20718     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20719     MOVE X'2020233030303230303538' TO DFHEIV0(25:11)
 20720     CALL 'kxdfhei1' USING DFHEIV0,
 20721           DFHEIV1,
 20722           HLDI-PASS-AREA,
 20723           HLDI-PASS-AREA-LEN,
 20724           DFHEIV99,
 20725           DFHEIV99,
 20726           DFHEIV99,
 20727           DFHEIV99
 20728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20729
 20730 7786-EXIT.
 20731     EXIT.
 20732 7790-CALL-ZIP-VERIFY.
 20733
 20734
 20735* EXEC CICS LINK
 20736*        PROGRAM    ('WSZIPCD')
 20737*        COMMAREA   (ZIPCD-PASS-AREA)
 20738*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20739*    END-EXEC.
 20740     MOVE 'WSZIPCD' TO DFHEIV1
 20741*    MOVE '."C                   (   #00020067' TO DFHEIV0
 20742     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20744     MOVE X'2020233030303230303637' TO DFHEIV0(25:11)
 20745     CALL 'kxdfhei1' USING DFHEIV0,
 20746           DFHEIV1,
 20747           ZIPCD-PASS-AREA,
 20748           ZIPCD-PASS-AREA-LEN,
 20749           DFHEIV99,
 20750           DFHEIV99,
 20751           DFHEIV99,
 20752           DFHEIV99
 20753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20754
 20755
 20756 7790-EXIT.
 20757     EXIT.
 20758 7795-call-sqlclmhs.
 20759
 20760
 20761* EXEC CICS LINK
 20762*        PROGRAM    ('SQLCLMHS')
 20763*        COMMAREA   (clmhs-PASS-AREA)
 20764*        LENGTH     (clmhs-PASS-AREA-LEN)
 20765*    END-EXEC.
 20766     MOVE 'SQLCLMHS' TO DFHEIV1
 20767*    MOVE '."C                   (   #00020077' TO DFHEIV0
 20768     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20769     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20770     MOVE X'2020233030303230303737' TO DFHEIV0(25:11)
 20771     CALL 'kxdfhei1' USING DFHEIV0,
 20772           DFHEIV1,
 20773           clmhs-PASS-AREA,
 20774           clmhs-PASS-AREA-LEN,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 384
* EL050.cbl
 20775           DFHEIV99,
 20776           DFHEIV99,
 20777           DFHEIV99,
 20778           DFHEIV99
 20779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20780
 20781
 20782 7795-EXIT.
 20783     EXIT.
 20784 7800-REWRITE-CERT.
 20785******************************************************************
 20786*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20787*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20788******************************************************************
 20789
 20790     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20791        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20792        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20793        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20794
 20795* EXEC CICS REWRITE
 20796*                  DATASET (CERT-ID)
 20797*                  FROM    (CERTIFICATE-MASTER)
 20798*              END-EXEC
 20799     MOVE LENGTH OF
 20800      CERTIFICATE-MASTER
 20801       TO DFHEIV11
 20802*    MOVE '&& L                  %   #00020095' TO DFHEIV0
 20803     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20804     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20805     MOVE X'2020233030303230303935' TO DFHEIV0(25:11)
 20806     CALL 'kxdfhei1' USING DFHEIV0,
 20807           CERT-ID,
 20808           CERTIFICATE-MASTER,
 20809           DFHEIV11,
 20810           DFHEIV99
 20811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20812        GO TO 7800-EXIT.
 20813
 20814       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20815       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20816
 20817 7800-EXIT.
 20818      EXIT.
 20819
 20820 7900-DELETE-CERT.
 20821
 20822* EXEC CICS DELETE
 20823*        DATASET (CERT-ID)
 20824*    END-EXEC.
 20825*    MOVE '&(                    &   #00020108' TO DFHEIV0
 20826     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20827     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20828     MOVE X'2020233030303230313038' TO DFHEIV0(25:11)
 20829     CALL 'kxdfhei1' USING DFHEIV0,
 20830           CERT-ID,
 20831           DFHEIV99,
 20832           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 385
* EL050.cbl
 20833           DFHEIV99,
 20834           DFHEIV99
 20835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20836
 20837
 20838 7900-EXIT.
 20839     EXIT.
 20840
 20841 8000-WRITE-CERT.
 20842
 20843* EXEC CICS HANDLE CONDITION
 20844*        DUPKEY    (8000-FREE-MAIN)
 20845*    END-EXEC.
 20846*    MOVE '"$$                   ! , #00020116' TO DFHEIV0
 20847     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20848     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20849     MOVE X'2C20233030303230313136' TO DFHEIV0(25:11)
 20850     CALL 'kxdfhei1' USING DFHEIV0
 20851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20852
 20853
 20854
 20855* EXEC CICS WRITE
 20856*        DATASET     (CERT-ID)
 20857*        FROM        (CERTIFICATE-MASTER)
 20858*        RIDFLD      (ELCERT-KEY)
 20859*    END-EXEC.
 20860     MOVE LENGTH OF
 20861      CERTIFICATE-MASTER
 20862       TO DFHEIV11
 20863*    MOVE '&$ L                  ''   #00020120' TO DFHEIV0
 20864     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20865     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20866     MOVE X'2020233030303230313230' TO DFHEIV0(25:11)
 20867     CALL 'kxdfhei1' USING DFHEIV0,
 20868           CERT-ID,
 20869           CERTIFICATE-MASTER,
 20870           DFHEIV11,
 20871           ELCERT-KEY,
 20872           DFHEIV99,
 20873           DFHEIV99
 20874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20875
 20876
 20877 8000-FREE-MAIN.
 20878
 20879 8000-EXIT.
 20880      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 386
* EL050.cbl
 20882
 20883 8100-READ-ERPNDM.
 20884
 20885* EXEC CICS HANDLE CONDITION
 20886*         NOTFND     (8100-NOTFND)
 20887*         ENDFILE    (8100-NOTFND)
 20888*    END-EXEC.
 20889*    MOVE '"$I''                  ! - #00020133' TO DFHEIV0
 20890     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20892     MOVE X'2D20233030303230313333' TO DFHEIV0(25:11)
 20893     CALL 'kxdfhei1' USING DFHEIV0
 20894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20895
 20896
 20897     MOVE SPACES                 TO ERPNDM-FOUND.
 20898     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20899
 20900
 20901* EXEC CICS READ UPDATE
 20902*         DATASET   (FILE-ERPNDM)
 20903*         RIDFLD    (PM-CONTROL-PRIMARY)
 20904*         INTO      (PENDING-MAILING-DATA)
 20905*    END-EXEC.
 20906     MOVE LENGTH OF
 20907      PENDING-MAILING-DATA
 20908       TO DFHEIV11
 20909*    MOVE '&"IL       EU         (   #00020141' TO DFHEIV0
 20910     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20911     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20912     MOVE X'2020233030303230313431' TO DFHEIV0(25:11)
 20913     CALL 'kxdfhei1' USING DFHEIV0,
 20914           FILE-ERPNDM,
 20915           PENDING-MAILING-DATA,
 20916           DFHEIV11,
 20917           PM-CONTROL-PRIMARY,
 20918           DFHEIV99,
 20919           DFHEIV99,
 20920           DFHEIV99
 20921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20922
 20923
 20924     GO TO 8100-EXIT.
 20925
 20926 8100-NOTFND.
 20927
 20928     MOVE 'X'                    TO ERPNDM-FOUND.
 20929     MOVE ER-2694                TO WS-ERROR.
 20930     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20931     MOVE ER-2883                TO WS-ERROR
 20932     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20933     .
 20934 8100-EXIT.
 20935     EXIT.
 20936 8102-REWRITE-ERPNDM.
 20937
 20938
 20939* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 387
* EL050.cbl
 20940*         DATASET    (FILE-ERPNDM)
 20941*         FROM       (PENDING-MAILING-DATA)
 20942*    END-EXEC
 20943     MOVE LENGTH OF
 20944      PENDING-MAILING-DATA
 20945       TO DFHEIV11
 20946*    MOVE '&& L                  %   #00020161' TO DFHEIV0
 20947     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20948     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20949     MOVE X'2020233030303230313631' TO DFHEIV0(25:11)
 20950     CALL 'kxdfhei1' USING DFHEIV0,
 20951           FILE-ERPNDM,
 20952           PENDING-MAILING-DATA,
 20953           DFHEIV11,
 20954           DFHEIV99
 20955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20956
 20957     .
 20958 8102-EXIT.
 20959     EXIT.
 20960 8104-UNLOCK-ERPNDM.
 20961
 20962
 20963* EXEC CICS UNLOCK
 20964*         DATASET   (FILE-ERPNDM)
 20965*    END-EXEC
 20966*    MOVE '&*                    #   #00020171' TO DFHEIV0
 20967     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20968     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20969     MOVE X'2020233030303230313731' TO DFHEIV0(25:11)
 20970     CALL 'kxdfhei1' USING DFHEIV0,
 20971           FILE-ERPNDM,
 20972           DFHEIV99
 20973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20974
 20975     .
 20976 8104-EXIT.
 20977     EXIT.
 20978 8110-READ-ERMAIL.
 20979
 20980* EXEC CICS HANDLE CONDITION
 20981*         NOTFND     (8110-NOTFND)
 20982*         ENDFILE    (8110-NOTFND)
 20983*    END-EXEC.
 20984*    MOVE '"$I''                  ! . #00020179' TO DFHEIV0
 20985     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20986     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20987     MOVE X'2E20233030303230313739' TO DFHEIV0(25:11)
 20988     CALL 'kxdfhei1' USING DFHEIV0
 20989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20990
 20991
 20992     MOVE SPACES                 TO ERMAIL-FOUND.
 20993     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20994     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20995     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20996     MOVE PB-SV-STATE            TO MA-STATE.
 20997
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 388
* EL050.cbl
 20998
 20999* EXEC CICS READ
 21000*         UPDATE
 21001*         DATASET   (FILE-ERMAIL)
 21002*         RIDFLD    (MA-CONTROL-PRIMARY)
 21003*         INTO      (MAILING-DATA)
 21004*    END-EXEC.
 21005     MOVE LENGTH OF
 21006      MAILING-DATA
 21007       TO DFHEIV11
 21008*    MOVE '&"IL       EU         (   #00020190' TO DFHEIV0
 21009     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21010     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21011     MOVE X'2020233030303230313930' TO DFHEIV0(25:11)
 21012     CALL 'kxdfhei1' USING DFHEIV0,
 21013           FILE-ERMAIL,
 21014           MAILING-DATA,
 21015           DFHEIV11,
 21016           MA-CONTROL-PRIMARY,
 21017           DFHEIV99,
 21018           DFHEIV99,
 21019           DFHEIV99
 21020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21021
 21022
 21023     GO TO 8110-EXIT.
 21024
 21025 8110-NOTFND.
 21026     MOVE 'X'                    TO ERMAIL-FOUND.
 21027
 21028 8110-EXIT.
 21029     EXIT.
 21030
 21031 8120-REWRITE-ERMAIL.
 21032
 21033* EXEC CICS REWRITE
 21034*         DATASET    (FILE-ERMAIL)
 21035*         FROM       (MAILING-DATA)
 21036*    END-EXEC.
 21037     MOVE LENGTH OF
 21038      MAILING-DATA
 21039       TO DFHEIV11
 21040*    MOVE '&& L                  %   #00020206' TO DFHEIV0
 21041     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21042     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21043     MOVE X'2020233030303230323036' TO DFHEIV0(25:11)
 21044     CALL 'kxdfhei1' USING DFHEIV0,
 21045           FILE-ERMAIL,
 21046           MAILING-DATA,
 21047           DFHEIV11,
 21048           DFHEIV99
 21049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21050
 21051
 21052 8120-EXIT.
 21053     EXIT.
 21054
 21055 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 389
* EL050.cbl
 21056
 21057* EXEC CICS HANDLE CONDITION
 21058*         DUPKEY   (8130-EXIT)
 21059*    END-EXEC.
 21060*    MOVE '"$$                   ! / #00020215' TO DFHEIV0
 21061     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 21062     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21063     MOVE X'2F20233030303230323135' TO DFHEIV0(25:11)
 21064     CALL 'kxdfhei1' USING DFHEIV0
 21065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21066
 21067
 21068
 21069* EXEC CICS WRITE
 21070*         DATASET     (FILE-ERMAIL)
 21071*         RIDFLD      (MA-CONTROL-PRIMARY)
 21072*         FROM        (MAILING-DATA)
 21073*    END-EXEC.
 21074     MOVE LENGTH OF
 21075      MAILING-DATA
 21076       TO DFHEIV11
 21077*    MOVE '&$ L                  ''   #00020219' TO DFHEIV0
 21078     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21079     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21080     MOVE X'2020233030303230323139' TO DFHEIV0(25:11)
 21081     CALL 'kxdfhei1' USING DFHEIV0,
 21082           FILE-ERMAIL,
 21083           MAILING-DATA,
 21084           DFHEIV11,
 21085           MA-CONTROL-PRIMARY,
 21086           DFHEIV99,
 21087           DFHEIV99
 21088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21089
 21090
 21091 8130-EXIT.
 21092     EXIT.
 21093
 21094 8140-UNLOCK-ERMAIL.
 21095
 21096* EXEC CICS UNLOCK
 21097*         DATASET   (FILE-ERMAIL)
 21098*    END-EXEC.
 21099*    MOVE '&*                    #   #00020229' TO DFHEIV0
 21100     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21101     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21102     MOVE X'2020233030303230323239' TO DFHEIV0(25:11)
 21103     CALL 'kxdfhei1' USING DFHEIV0,
 21104           FILE-ERMAIL,
 21105           DFHEIV99
 21106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21107
 21108
 21109 8140-EXIT.
 21110     EXIT.
 21111
 21112 8145-read-elcrtt-upd.
 21113
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 390
* EL050.cbl
 21114     move ' '                    to elcrtt-found-sw
 21115                                    elcrtt-update-sw
 21116
 21117* EXEC CICS HANDLE CONDITION
 21118*        NOTFND   (8145-exit)
 21119*    END-EXEC
 21120*    MOVE '"$I                   ! 0 #00020240' TO DFHEIV0
 21121     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21122     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21123     MOVE X'3020233030303230323430' TO DFHEIV0(25:11)
 21124     CALL 'kxdfhei1' USING DFHEIV0
 21125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21126
 21127     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21128     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21129
 21130
 21131* EXEC CICS READ UPDATE
 21132*        DATASET  (CRTT-ID)
 21133*        RIDFLD   (WS-ELCRTT-KEY)
 21134*        INTO     (CERTIFICATE-TRAILERS)
 21135*    END-EXEC
 21136     MOVE LENGTH OF
 21137      CERTIFICATE-TRAILERS
 21138       TO DFHEIV11
 21139*    MOVE '&"IL       EU         (   #00020247' TO DFHEIV0
 21140     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21141     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21142     MOVE X'2020233030303230323437' TO DFHEIV0(25:11)
 21143     CALL 'kxdfhei1' USING DFHEIV0,
 21144           CRTT-ID,
 21145           CERTIFICATE-TRAILERS,
 21146           DFHEIV11,
 21147           WS-ELCRTT-KEY,
 21148           DFHEIV99,
 21149           DFHEIV99,
 21150           DFHEIV99
 21151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21152
 21153     set elcrtt-found to true
 21154
 21155     .
 21156 8145-exit.
 21157     exit.
 21158 8150-UPDATE-ELCRTT.
 21159
 21160     if elcrtt-found
 21161
 21162* EXEC CICS REWRITE
 21163*           DATASET  (CRTT-ID)
 21164*           FROM     (CERTIFICATE-TRAILERS)
 21165*        END-EXEC
 21166     MOVE LENGTH OF
 21167      CERTIFICATE-TRAILERS
 21168       TO DFHEIV11
 21169*    MOVE '&& L                  %   #00020261' TO DFHEIV0
 21170     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21171     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 391
* EL050.cbl
 21172     MOVE X'2020233030303230323631' TO DFHEIV0(25:11)
 21173     CALL 'kxdfhei1' USING DFHEIV0,
 21174           CRTT-ID,
 21175           CERTIFICATE-TRAILERS,
 21176           DFHEIV11,
 21177           DFHEIV99
 21178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21179     ELSE
 21180
 21181* EXEC CICS WRITE
 21182*          DATASET  (CRTT-ID)
 21183*          RIDFLD   (WS-ELCRTT-KEY)
 21184*          FROM     (CERTIFICATE-TRAILERS)
 21185*       END-EXEC
 21186     MOVE LENGTH OF
 21187      CERTIFICATE-TRAILERS
 21188       TO DFHEIV11
 21189*    MOVE '&$ L                  ''   #00020266' TO DFHEIV0
 21190     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21191     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21192     MOVE X'2020233030303230323636' TO DFHEIV0(25:11)
 21193     CALL 'kxdfhei1' USING DFHEIV0,
 21194           CRTT-ID,
 21195           CERTIFICATE-TRAILERS,
 21196           DFHEIV11,
 21197           WS-ELCRTT-KEY,
 21198           DFHEIV99,
 21199           DFHEIV99
 21200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21201     end-if
 21202
 21203     .
 21204 8150-EXIT.
 21205     EXIT.
 21206
 21207 8155-unlock-elcrtt.
 21208
 21209
 21210* EXEC CICS UNLOCK
 21211*       DATASET  (CRTT-ID)
 21212*    END-EXEC
 21213*    MOVE '&*                    #   #00020279' TO DFHEIV0
 21214     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21215     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21216     MOVE X'2020233030303230323739' TO DFHEIV0(25:11)
 21217     CALL 'kxdfhei1' USING DFHEIV0,
 21218           CRTT-ID,
 21219           DFHEIV99
 21220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21221
 21222     .
 21223 8155-exit.
 21224     exit.
 21225
 21226 8190-UPDATE-REFUND-CLAIM-FLAG.
 21227
 21228* EXEC CICS HANDLE CONDITION
 21229*        NOTFND   (8190-NOTFND)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 392
* EL050.cbl
 21230*    END-EXEC.
 21231*    MOVE '"$I                   ! 1 #00020288' TO DFHEIV0
 21232     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21234     MOVE X'3120233030303230323838' TO DFHEIV0(25:11)
 21235     CALL 'kxdfhei1' USING DFHEIV0
 21236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21237
 21238
 21239     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21240     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21241
 21242
 21243* EXEC CICS READ
 21244*        UPDATE
 21245*        DATASET  (CRTT-ID)
 21246*        RIDFLD   (WS-ELCRTT-KEY)
 21247*        INTO     (CERTIFICATE-TRAILERS)
 21248*    END-EXEC.
 21249     MOVE LENGTH OF
 21250      CERTIFICATE-TRAILERS
 21251       TO DFHEIV11
 21252*    MOVE '&"IL       EU         (   #00020295' TO DFHEIV0
 21253     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21254     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21255     MOVE X'2020233030303230323935' TO DFHEIV0(25:11)
 21256     CALL 'kxdfhei1' USING DFHEIV0,
 21257           CRTT-ID,
 21258           CERTIFICATE-TRAILERS,
 21259           DFHEIV11,
 21260           WS-ELCRTT-KEY,
 21261           DFHEIV99,
 21262           DFHEIV99,
 21263           DFHEIV99
 21264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21265
 21266
 21267     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21268
 21269* EXEC CICS REWRITE
 21270*       DATASET  (CRTT-ID)
 21271*       FROM     (CERTIFICATE-TRAILERS)
 21272*    END-EXEC.
 21273     MOVE LENGTH OF
 21274      CERTIFICATE-TRAILERS
 21275       TO DFHEIV11
 21276*    MOVE '&& L                  %   #00020303' TO DFHEIV0
 21277     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21278     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21279     MOVE X'2020233030303230333033' TO DFHEIV0(25:11)
 21280     CALL 'kxdfhei1' USING DFHEIV0,
 21281           CRTT-ID,
 21282           CERTIFICATE-TRAILERS,
 21283           DFHEIV11,
 21284           DFHEIV99
 21285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21286
 21287
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 393
* EL050.cbl
 21288     GO TO 8190-EXIT.
 21289
 21290 8190-NOTFND.
 21291
 21292     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21293     MOVE 'CS'         TO CS-RECORD-ID.
 21294     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21295     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21296     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21297     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21298
 21299* EXEC CICS WRITE
 21300*       DATASET  (CRTT-ID)
 21301*       RIDFLD   (WS-ELCRTT-KEY)
 21302*       FROM     (CERTIFICATE-TRAILERS)
 21303*    END-EXEC.
 21304     MOVE LENGTH OF
 21305      CERTIFICATE-TRAILERS
 21306       TO DFHEIV11
 21307*    MOVE '&$ L                  ''   #00020318' TO DFHEIV0
 21308     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21309     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21310     MOVE X'2020233030303230333138' TO DFHEIV0(25:11)
 21311     CALL 'kxdfhei1' USING DFHEIV0,
 21312           CRTT-ID,
 21313           CERTIFICATE-TRAILERS,
 21314           DFHEIV11,
 21315           WS-ELCRTT-KEY,
 21316           DFHEIV99,
 21317           DFHEIV99
 21318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21319
 21320
 21321 8190-EXIT.
 21322     EXIT.
 21323
 21324 8195-UPDATE-AGE-FLAGS.
 21325
 21326* EXEC CICS HANDLE CONDITION
 21327*        NOTFND   (8195-NOTFND)
 21328*    END-EXEC.
 21329*    MOVE '"$I                   ! 2 #00020328' TO DFHEIV0
 21330     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21332     MOVE X'3220233030303230333238' TO DFHEIV0(25:11)
 21333     CALL 'kxdfhei1' USING DFHEIV0
 21334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21335
 21336
 21337     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21338     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21339
 21340
 21341* EXEC CICS READ
 21342*        UPDATE
 21343*        DATASET  (CRTT-ID)
 21344*        RIDFLD   (WS-ELCRTT-KEY)
 21345*        INTO     (CERTIFICATE-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 394
* EL050.cbl
 21346*    END-EXEC.
 21347     MOVE LENGTH OF
 21348      CERTIFICATE-TRAILERS
 21349       TO DFHEIV11
 21350*    MOVE '&"IL       EU         (   #00020335' TO DFHEIV0
 21351     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21352     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21353     MOVE X'2020233030303230333335' TO DFHEIV0(25:11)
 21354     CALL 'kxdfhei1' USING DFHEIV0,
 21355           CRTT-ID,
 21356           CERTIFICATE-TRAILERS,
 21357           DFHEIV11,
 21358           WS-ELCRTT-KEY,
 21359           DFHEIV99,
 21360           DFHEIV99,
 21361           DFHEIV99
 21362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21363
 21364
 21365     IF WS-INS-AGE-SET = 'Y'
 21366        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21367     END-IF
 21368     IF WS-JNT-AGE-SET = 'Y'
 21369        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21370     END-IF
 21371
 21372
 21373* EXEC CICS REWRITE
 21374*       DATASET  (CRTT-ID)
 21375*       FROM     (CERTIFICATE-TRAILERS)
 21376*    END-EXEC.
 21377     MOVE LENGTH OF
 21378      CERTIFICATE-TRAILERS
 21379       TO DFHEIV11
 21380*    MOVE '&& L                  %   #00020349' TO DFHEIV0
 21381     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21382     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21383     MOVE X'2020233030303230333439' TO DFHEIV0(25:11)
 21384     CALL 'kxdfhei1' USING DFHEIV0,
 21385           CRTT-ID,
 21386           CERTIFICATE-TRAILERS,
 21387           DFHEIV11,
 21388           DFHEIV99
 21389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21390
 21391
 21392     GO TO 8195-EXIT.
 21393
 21394 8195-NOTFND.
 21395
 21396     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21397     MOVE 'CS'         TO CS-RECORD-ID.
 21398     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21399     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21400     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21401     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21402     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21403
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 395
* EL050.cbl
 21404* EXEC CICS WRITE
 21405*       DATASET  (CRTT-ID)
 21406*       RIDFLD   (WS-ELCRTT-KEY)
 21407*       FROM     (CERTIFICATE-TRAILERS)
 21408*    END-EXEC.
 21409     MOVE LENGTH OF
 21410      CERTIFICATE-TRAILERS
 21411       TO DFHEIV11
 21412*    MOVE '&$ L                  ''   #00020365' TO DFHEIV0
 21413     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21414     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21415     MOVE X'2020233030303230333635' TO DFHEIV0(25:11)
 21416     CALL 'kxdfhei1' USING DFHEIV0,
 21417           CRTT-ID,
 21418           CERTIFICATE-TRAILERS,
 21419           DFHEIV11,
 21420           WS-ELCRTT-KEY,
 21421           DFHEIV99,
 21422           DFHEIV99
 21423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21424
 21425
 21426 8195-EXIT.
 21427     EXIT.
 21428
 21429 8200-READ-REIN-TABLE.
 21430
 21431* EXEC CICS HANDLE CONDITION
 21432*         NOTFND   (8200-NOTFND)
 21433*    END-EXEC.
 21434*    MOVE '"$I                   ! 3 #00020375' TO DFHEIV0
 21435     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21437     MOVE X'3320233030303230333735' TO DFHEIV0(25:11)
 21438     CALL 'kxdfhei1' USING DFHEIV0
 21439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21440
 21441
 21442
 21443* EXEC CICS READ
 21444*        DATASET     (REIN-ID)
 21445*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21446*        RIDFLD      (ERREIN-KEY)
 21447*    END-EXEC.
 21448*    MOVE '&"S        E          (   #00020379' TO DFHEIV0
 21449     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21450     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21451     MOVE X'2020233030303230333739' TO DFHEIV0(25:11)
 21452     CALL 'kxdfhei1' USING DFHEIV0,
 21453           REIN-ID,
 21454           DFHEIV20,
 21455           DFHEIV99,
 21456           ERREIN-KEY,
 21457           DFHEIV99,
 21458           DFHEIV99,
 21459           DFHEIV99
 21460     SET ADDRESS OF REINSURANCE-RECORD TO
 21461         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 396
* EL050.cbl
 21462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21463
 21464
 21465     GO TO 8200-EXIT.
 21466
 21467 8200-NOTFND.
 21468     MOVE 'N'             TO WS-REIN-READ-SW.
 21469
 21470 8200-EXIT.
 21471      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 397
* EL050.cbl
 21473
 21474 8300-READ-CTBL-TABLE.
 21475
 21476* EXEC CICS HANDLE CONDITION
 21477*        NOTFND    (8300-NOTFND)
 21478*        DISABLED  (8300-ERRESS-PROBLEM)
 21479*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21480*        ENDFILE   (8300-NOTFND)
 21481*    END-EXEC.
 21482*    MOVE '"$IcJ''                ! 4 #00020395' TO DFHEIV0
 21483     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21485     MOVE X'3420233030303230333935' TO DFHEIV0(25:11)
 21486     CALL 'kxdfhei1' USING DFHEIV0
 21487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21488
 21489
 21490
 21491* EXEC CICS READ
 21492*        DATASET     (CTBL-ID)
 21493*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21494*        RIDFLD      (ERCTBL-KEY)
 21495*    END-EXEC.
 21496*    MOVE '&"S        E          (   #00020402' TO DFHEIV0
 21497     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21498     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21499     MOVE X'2020233030303230343032' TO DFHEIV0(25:11)
 21500     CALL 'kxdfhei1' USING DFHEIV0,
 21501           CTBL-ID,
 21502           DFHEIV20,
 21503           DFHEIV99,
 21504           ERCTBL-KEY,
 21505           DFHEIV99,
 21506           DFHEIV99,
 21507           DFHEIV99
 21508     SET ADDRESS OF COMM-TABLE-RECORD TO
 21509         DFHEIV20
 21510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21511
 21512
 21513     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21514
 21515     GO TO 8300-EXIT.
 21516
 21517 8300-NOTFND.
 21518
 21519     IF CTBL-SW = '0530'
 21520         MOVE 'AA'                     TO WS-AH-COMP-CD
 21521         MOVE '0550'                   TO CTBL-SW
 21522         MOVE '1'                      TO WS-CTBL-READ-SW
 21523         GO TO 8300-EXIT.
 21524
 21525     IF CTBL-SW = '0540'
 21526         MOVE 'AA'                     TO WS-LF-COMP-CD
 21527         MOVE '0550'                   TO CTBL-SW
 21528         MOVE '1'                      TO WS-CTBL-READ-SW
 21529         GO TO 8300-EXIT.
 21530
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 398
* EL050.cbl
 21531     IF CTBL-SW = '0550'
 21532         MOVE '2'                      TO WS-CTBL-READ-SW
 21533         GO TO 8300-EXIT.
 21534
 21535     GO TO 8300-EXIT.
 21536
 21537 8300-ERRESS-PROBLEM.
 21538
 21539      MOVE ER-8050              TO WS-ERROR.
 21540      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21541
 21542     GO TO 8300-EXIT.
 21543
 21544 8300-EXIT.
 21545      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 399
* EL050.cbl
 21547
 21548
 21549 8400-GETMAIN-ERFORM.
 21550
 21551
 21552* EXEC CICS   GETMAIN
 21553*        LENGTH  (500)
 21554*        SET     (ADDRESS OF FORM-MASTER)
 21555*    END-EXEC.
 21556     MOVE 500
 21557       TO DFHEIV11
 21558*    MOVE '," L                  $   #00020446' TO DFHEIV0
 21559     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21560     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21561     MOVE X'2020233030303230343436' TO DFHEIV0(25:11)
 21562     CALL 'kxdfhei1' USING DFHEIV0,
 21563           DFHEIV20,
 21564           DFHEIV11,
 21565           DFHEIV99
 21566     SET ADDRESS OF FORM-MASTER TO
 21567         DFHEIV20
 21568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21569
 21570
 21571     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21572
 21573 8400-EXIT.
 21574      EXIT.
 21575
 21576 8450-READ-FORM-MASTER.
 21577
 21578
 21579* EXEC CICS  HANDLE CONDITION
 21580*        NOTFND   (8450-FORM-NOT-FOUND)
 21581*        ENDFILE  (8450-FORM-NOT-FOUND)
 21582*    END-EXEC.
 21583*    MOVE '"$I''                  ! 5 #00020458' TO DFHEIV0
 21584     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21585     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21586     MOVE X'3520233030303230343538' TO DFHEIV0(25:11)
 21587     CALL 'kxdfhei1' USING DFHEIV0
 21588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21589
 21590
 21591
 21592* EXEC CICS   READ
 21593*        DATASET   (FORM-ID)
 21594*        RIDFLD    (ERFORM-KEY)
 21595*        INTO      (FORM-MASTER)
 21596*        GTEQ
 21597*    END-EXEC.
 21598     MOVE LENGTH OF
 21599      FORM-MASTER
 21600       TO DFHEIV11
 21601*    MOVE '&"IL       G          (   #00020463' TO DFHEIV0
 21602     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21603     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21604     MOVE X'2020233030303230343633' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 400
* EL050.cbl
 21605     CALL 'kxdfhei1' USING DFHEIV0,
 21606           FORM-ID,
 21607           FORM-MASTER,
 21608           DFHEIV11,
 21609           ERFORM-KEY,
 21610           DFHEIV99,
 21611           DFHEIV99,
 21612           DFHEIV99
 21613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21614
 21615
 21616     MOVE  'Y'           TO  FORM-MASTER-SW.
 21617
 21618     GO TO  8450-EXIT.
 21619
 21620 8450-FORM-NOT-FOUND.
 21621
 21622     MOVE  'N'           TO  FORM-MASTER-SW.
 21623
 21624 8450-EXIT.
 21625      EXIT.
 21626
 21627 8500-DATE-CONVERT.
 21628
 21629* EXEC CICS LINK
 21630*        PROGRAM    ('ELDATCV')
 21631*        COMMAREA   (DATE-CONVERSION-DATA)
 21632*        LENGTH     (DC-COMM-LENGTH)
 21633*    END-EXEC.
 21634     MOVE 'ELDATCV' TO DFHEIV1
 21635*    MOVE '."C                   (   #00020482' TO DFHEIV0
 21636     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21637     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21638     MOVE X'2020233030303230343832' TO DFHEIV0(25:11)
 21639     CALL 'kxdfhei1' USING DFHEIV0,
 21640           DFHEIV1,
 21641           DATE-CONVERSION-DATA,
 21642           DC-COMM-LENGTH,
 21643           DFHEIV99,
 21644           DFHEIV99,
 21645           DFHEIV99,
 21646           DFHEIV99
 21647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21648
 21649
 21650 8500-EXIT.
 21651     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 401
* EL050.cbl
 21653
 21654 8555-RELOAD-CONTROL-FILE.
 21655     CONTINUE.
 21656
 21657 8555-EXIT.
 21658     EXIT.
 21659
 21660 8557-GETMAIN-ERPLAN.
 21661
 21662
 21663* EXEC CICS GETMAIN
 21664*        LENGTH    (840)
 21665*        SET       (ADDRESS OF PLAN-RECORDS)
 21666*    END-EXEC.
 21667     MOVE 840
 21668       TO DFHEIV11
 21669*    MOVE '," L                  $   #00020500' TO DFHEIV0
 21670     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21671     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21672     MOVE X'2020233030303230353030' TO DFHEIV0(25:11)
 21673     CALL 'kxdfhei1' USING DFHEIV0,
 21674           DFHEIV20,
 21675           DFHEIV11,
 21676           DFHEIV99
 21677     SET ADDRESS OF PLAN-RECORDS TO
 21678         DFHEIV20
 21679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21680
 21681
 21682     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21683
 21684 8557-EXIT.
 21685     EXIT.
 21686
 21687 8560-GETMAIN.
 21688
 21689* EXEC CICS GETMAIN
 21690*        LENGTH    (2000)
 21691*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21692*    END-EXEC.
 21693     MOVE 2000
 21694       TO DFHEIV11
 21695*    MOVE '," L                  $   #00020511' TO DFHEIV0
 21696     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21697     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21698     MOVE X'2020233030303230353131' TO DFHEIV0(25:11)
 21699     CALL 'kxdfhei1' USING DFHEIV0,
 21700           DFHEIV20,
 21701           DFHEIV11,
 21702           DFHEIV99
 21703     SET ADDRESS OF ACCOUNT-MASTER TO
 21704         DFHEIV20
 21705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21706
 21707
 21708     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21709
 21710 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 402
* EL050.cbl
 21711     EXIT.
 21712
 21713 8570-START-ACCOUNT-MASTER.
 21714
 21715* EXEC CICS HANDLE CONDITION
 21716*        NOTFND    (0199-ACCT-NOT-FOUND)
 21717*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21718*    END-EXEC.
 21719*    MOVE '"$I''                  ! 6 #00020522' TO DFHEIV0
 21720     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21721     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21722     MOVE X'3620233030303230353232' TO DFHEIV0(25:11)
 21723     CALL 'kxdfhei1' USING DFHEIV0
 21724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21725
 21726
 21727
 21728* EXEC CICS STARTBR
 21729*        DATASET    (ACCT-ID)
 21730*        RIDFLD     (ERACCT-KEY)
 21731*        GTEQ
 21732*    END-EXEC.
 21733     MOVE 0
 21734       TO DFHEIV11
 21735*    MOVE '&,         G          &   #00020527' TO DFHEIV0
 21736     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21737     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21738     MOVE X'2020233030303230353237' TO DFHEIV0(25:11)
 21739     CALL 'kxdfhei1' USING DFHEIV0,
 21740           ACCT-ID,
 21741           ERACCT-KEY,
 21742           DFHEIV99,
 21743           DFHEIV11,
 21744           DFHEIV99
 21745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21746
 21747
 21748 8570-EXIT.
 21749     EXIT.
 21750
 21751 8580-READ-ACCOUNT-MASTER.
 21752
 21753* EXEC CICS HANDLE CONDITION
 21754*        NOTFND    (0199-ACCT-NOT-FOUND)
 21755*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21756*    END-EXEC.
 21757*    MOVE '"$I''                  ! 7 #00020537' TO DFHEIV0
 21758     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21760     MOVE X'3720233030303230353337' TO DFHEIV0(25:11)
 21761     CALL 'kxdfhei1' USING DFHEIV0
 21762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21763
 21764
 21765
 21766* EXEC CICS READNEXT
 21767*        DATASET     (ACCT-ID)
 21768*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 403
* EL050.cbl
 21769*        RIDFLD      (ERACCT-KEY)
 21770*    END-EXEC.
 21771     MOVE LENGTH OF
 21772      ACCOUNT-MASTER
 21773       TO DFHEIV12
 21774     MOVE 0
 21775       TO DFHEIV11
 21776*    MOVE '&.IL                  )   #00020542' TO DFHEIV0
 21777     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21778     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21779     MOVE X'2020233030303230353432' TO DFHEIV0(25:11)
 21780     CALL 'kxdfhei1' USING DFHEIV0,
 21781           ACCT-ID,
 21782           ACCOUNT-MASTER,
 21783           DFHEIV12,
 21784           ERACCT-KEY,
 21785           DFHEIV99,
 21786           DFHEIV11,
 21787           DFHEIV99,
 21788           DFHEIV99
 21789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21790
 21791
 21792 8580-EXIT.
 21793     EXIT.
 21794
 21795 8582-READ-COMPENSATION-MASTER.
 21796
 21797* EXEC CICS HANDLE CONDITION
 21798*        NOTFND    (8582-COMP-NOT-FOUND)
 21799*        ENDFILE   (8582-COMP-NOT-FOUND)
 21800*    END-EXEC.
 21801*    MOVE '"$I''                  ! 8 #00020552' TO DFHEIV0
 21802     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21804     MOVE X'3820233030303230353532' TO DFHEIV0(25:11)
 21805     CALL 'kxdfhei1' USING DFHEIV0
 21806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21807
 21808
 21809
 21810* EXEC CICS READ
 21811*        DATASET     (COMP-ID)
 21812*        INTO        (COMPENSATION-MASTER)
 21813*        RIDFLD      (ERCOMP-KEY)
 21814*    END-EXEC.
 21815     MOVE LENGTH OF
 21816      COMPENSATION-MASTER
 21817       TO DFHEIV11
 21818*    MOVE '&"IL       E          (   #00020557' TO DFHEIV0
 21819     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21820     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21821     MOVE X'2020233030303230353537' TO DFHEIV0(25:11)
 21822     CALL 'kxdfhei1' USING DFHEIV0,
 21823           COMP-ID,
 21824           COMPENSATION-MASTER,
 21825           DFHEIV11,
 21826           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 404
* EL050.cbl
 21827           DFHEIV99,
 21828           DFHEIV99,
 21829           DFHEIV99
 21830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21831
 21832
 21833     MOVE 'Y'                    TO COMP-MASTER-SW
 21834
 21835     GO TO 8582-EXIT
 21836     .
 21837 8582-COMP-NOT-FOUND.
 21838
 21839     MOVE 'N'                    TO COMP-MASTER-SW.
 21840
 21841 8582-EXIT.
 21842     EXIT.
 21843
 21844 8583-READ-ERAGTC.
 21845
 21846* EXEC CICS HANDLE CONDITION
 21847*        NOTFND    (8583-AGTC-NOT-FOUND)
 21848*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21849*    END-EXEC.
 21850*    MOVE '"$I''                  ! 9 #00020575' TO DFHEIV0
 21851     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21853     MOVE X'3920233030303230353735' TO DFHEIV0(25:11)
 21854     CALL 'kxdfhei1' USING DFHEIV0
 21855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21856
 21857
 21858
 21859* EXEC CICS STARTBR
 21860*        DATASET    (AGTC-ID)
 21861*        RIDFLD     (ERAGTC-KEY)
 21862*        GTEQ
 21863*    END-EXEC.
 21864     MOVE 0
 21865       TO DFHEIV11
 21866*    MOVE '&,         G          &   #00020580' TO DFHEIV0
 21867     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21868     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21869     MOVE X'2020233030303230353830' TO DFHEIV0(25:11)
 21870     CALL 'kxdfhei1' USING DFHEIV0,
 21871           AGTC-ID,
 21872           ERAGTC-KEY,
 21873           DFHEIV99,
 21874           DFHEIV11,
 21875           DFHEIV99
 21876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21877
 21878
 21879 8583-READ-ERAGTC-NEXT.
 21880
 21881* EXEC CICS READNEXT
 21882*        DATASET     (AGTC-ID)
 21883*        INTO        (AGENT-COMMISSIONS)
 21884*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 405
* EL050.cbl
 21885*    END-EXEC.
 21886     MOVE LENGTH OF
 21887      AGENT-COMMISSIONS
 21888       TO DFHEIV12
 21889     MOVE 0
 21890       TO DFHEIV11
 21891*    MOVE '&.IL                  )   #00020587' TO DFHEIV0
 21892     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21893     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21894     MOVE X'2020233030303230353837' TO DFHEIV0(25:11)
 21895     CALL 'kxdfhei1' USING DFHEIV0,
 21896           AGTC-ID,
 21897           AGENT-COMMISSIONS,
 21898           DFHEIV12,
 21899           ERAGTC-KEY,
 21900           DFHEIV99,
 21901           DFHEIV11,
 21902           DFHEIV99,
 21903           DFHEIV99
 21904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21905
 21906
 21907*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21908
 21909     GO TO 8583-EXIT
 21910     .
 21911 8583-AGTC-NOT-FOUND.
 21912
 21913     MOVE 'N'                    TO AGTC-MASTER-SW.
 21914
 21915 8583-EXIT.
 21916     EXIT.
 21917
 21918 8584-READ-BANK-CROSS-REF.
 21919
 21920* EXEC CICS HANDLE CONDITION
 21921*        NOTFND    (8584-BXRF-NOT-FOUND)
 21922*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21923*    END-EXEC.
 21924*    MOVE '"$I''                  ! : #00020605' TO DFHEIV0
 21925     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21926     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21927     MOVE X'3A20233030303230363035' TO DFHEIV0(25:11)
 21928     CALL 'kxdfhei1' USING DFHEIV0
 21929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21930
 21931
 21932
 21933* EXEC CICS READ
 21934*        DATASET     (BXRF-ID)
 21935*        INTO        (BANK-CROSS-REFERENCE)
 21936*        RIDFLD      (ERBXRF-KEY)
 21937*        LENGTH      (BXRF-REC-LENGTH)
 21938*    END-EXEC.
 21939*    MOVE '&"IL       E          (   #00020610' TO DFHEIV0
 21940     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21942     MOVE X'2020233030303230363130' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 406
* EL050.cbl
 21943     CALL 'kxdfhei1' USING DFHEIV0,
 21944           BXRF-ID,
 21945           BANK-CROSS-REFERENCE,
 21946           BXRF-REC-LENGTH,
 21947           ERBXRF-KEY,
 21948           DFHEIV99,
 21949           DFHEIV99,
 21950           DFHEIV99
 21951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21952
 21953
 21954     MOVE 'Y'                    TO BXRF-MASTER-SW
 21955
 21956     GO TO 8584-EXIT
 21957     .
 21958 8584-BXRF-NOT-FOUND.
 21959
 21960     MOVE 'N'                    TO BXRF-MASTER-SW.
 21961
 21962 8584-EXIT.
 21963     EXIT.
 21964
 21965 8585-READ-PLAN-MASTER.
 21966
 21967
 21968* EXEC CICS HANDLE CONDITION
 21969*        NOTFND    (8585-PLAN-NOT-FOUND)
 21970*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21971*    END-EXEC.
 21972*    MOVE '"$I''                  ! ; #00020630' TO DFHEIV0
 21973     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21975     MOVE X'3B20233030303230363330' TO DFHEIV0(25:11)
 21976     CALL 'kxdfhei1' USING DFHEIV0
 21977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21978
 21979
 21980
 21981* EXEC CICS READ
 21982*        DATASET     (PLAN-ID)
 21983*        INTO        (PLAN-MASTER)
 21984*        RIDFLD      (ERPLAN-KEY)
 21985*    END-EXEC.
 21986     MOVE LENGTH OF
 21987      PLAN-MASTER
 21988       TO DFHEIV11
 21989*    MOVE '&"IL       E          (   #00020635' TO DFHEIV0
 21990     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21992     MOVE X'2020233030303230363335' TO DFHEIV0(25:11)
 21993     CALL 'kxdfhei1' USING DFHEIV0,
 21994           PLAN-ID,
 21995           PLAN-MASTER,
 21996           DFHEIV11,
 21997           ERPLAN-KEY,
 21998           DFHEIV99,
 21999           DFHEIV99,
 22000           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 407
* EL050.cbl
 22001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22002
 22003
 22004     MOVE 'Y'                    TO PLAN-MASTER-SW.
 22005
 22006     GO TO 8585-EXIT.
 22007
 22008 8585-PLAN-NOT-FOUND.
 22009
 22010     MOVE 'N'                    TO PLAN-MASTER-SW.
 22011
 22012 8585-EXIT.
 22013     EXIT.
 22014
 22015 8586-READ-LOAN-OFFICER.
 22016
 22017* EXEC CICS READ
 22018*        DATASET     (LOFC-ID)
 22019*        INTO        (LOAN-OFFICER-MASTER)
 22020*        RIDFLD      (ERLOFC-KEY)
 22021*        RESP        (WS-RESPONSE)
 22022*    END-EXEC
 22023     MOVE LENGTH OF
 22024      LOAN-OFFICER-MASTER
 22025       TO DFHEIV11
 22026*    MOVE '&"IL       E          (  N#00020653' TO DFHEIV0
 22027     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22029     MOVE X'204E233030303230363533' TO DFHEIV0(25:11)
 22030     CALL 'kxdfhei1' USING DFHEIV0,
 22031           LOFC-ID,
 22032           LOAN-OFFICER-MASTER,
 22033           DFHEIV11,
 22034           ERLOFC-KEY,
 22035           DFHEIV99,
 22036           DFHEIV99,
 22037           DFHEIV99
 22038     MOVE EIBRESP  TO WS-RESPONSE
 22039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22040
 22041     IF WS-RESP-NORMAL
 22042        MOVE 'Y'                 TO LOFC-MASTER-SW
 22043     ELSE
 22044        MOVE 'N'                 TO LOFC-MASTER-SW
 22045     END-IF
 22046     .
 22047 8586-EXIT.
 22048     EXIT.
 22049 8587-START-ERPDEF.
 22050
 22051* EXEC CICS STARTBR
 22052*       DATASET   (PDEF-ID)
 22053*       RIDFLD    (ERPDEF-KEY)
 22054*       GTEQ
 22055*       RESP      (WS-RESPONSE)
 22056*    END-EXEC
 22057     MOVE 0
 22058       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 408
* EL050.cbl
 22059*    MOVE '&,         G          &  N#00020669' TO DFHEIV0
 22060     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22061     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22062     MOVE X'204E233030303230363639' TO DFHEIV0(25:11)
 22063     CALL 'kxdfhei1' USING DFHEIV0,
 22064           PDEF-ID,
 22065           ERPDEF-KEY,
 22066           DFHEIV99,
 22067           DFHEIV11,
 22068           DFHEIV99
 22069     MOVE EIBRESP  TO WS-RESPONSE
 22070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22071     IF WS-RESP-NORMAL
 22072        MOVE 'Y'                 TO PDEF-MASTER-SW
 22073     ELSE
 22074        MOVE 'N'                 TO PDEF-MASTER-SW
 22075     END-IF
 22076     .
 22077 8587-EXIT.
 22078     EXIT.
 22079 8588-READ-ERPDEF.
 22080
 22081* EXEC CICS READNEXT
 22082*       DATASET   (PDEF-ID)
 22083*       RIDFLD    (ERPDEF-KEY)
 22084*       INTO      (PRODUCT-MASTER)
 22085*       RESP      (WS-RESPONSE)
 22086*    END-EXEC
 22087     MOVE LENGTH OF
 22088      PRODUCT-MASTER
 22089       TO DFHEIV12
 22090     MOVE 0
 22091       TO DFHEIV11
 22092*    MOVE '&.IL                  )  N#00020684' TO DFHEIV0
 22093     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22094     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22095     MOVE X'204E233030303230363834' TO DFHEIV0(25:11)
 22096     CALL 'kxdfhei1' USING DFHEIV0,
 22097           PDEF-ID,
 22098           PRODUCT-MASTER,
 22099           DFHEIV12,
 22100           ERPDEF-KEY,
 22101           DFHEIV99,
 22102           DFHEIV11,
 22103           DFHEIV99,
 22104           DFHEIV99
 22105     MOVE EIBRESP  TO WS-RESPONSE
 22106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22107     IF WS-RESP-NORMAL
 22108        MOVE 'Y'                 TO PDEF-MASTER-SW
 22109     ELSE
 22110        MOVE 'N'                 TO PDEF-MASTER-SW
 22111     END-IF
 22112     .
 22113 8588-EXIT.
 22114     EXIT.
 22115 8589-ENDBR-ERPDEF.
 22116
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 409
* EL050.cbl
 22117* EXEC CICS ENDBR
 22118*       DATASET   (PDEF-ID)
 22119*    END-EXEC
 22120     MOVE 0
 22121       TO DFHEIV11
 22122*    MOVE '&2                    $   #00020699' TO DFHEIV0
 22123     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22124     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22125     MOVE X'2020233030303230363939' TO DFHEIV0(25:11)
 22126     CALL 'kxdfhei1' USING DFHEIV0,
 22127           PDEF-ID,
 22128           DFHEIV11,
 22129           DFHEIV99
 22130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22131     .
 22132 8589-EXIT.
 22133     EXIT.
 22134 8590-READ-CERT-MASTER.
 22135     IF PB-COMPANY-ID = 'UCL'
 22136         GO TO 8690-READ-CERT-MASTER-UCL.
 22137
 22138
 22139* EXEC CICS HANDLE CONDITION
 22140*         NOTFND    (0299-CERT-NOT-FOUND)
 22141*    END-EXEC.
 22142*    MOVE '"$I                   ! < #00020709' TO DFHEIV0
 22143     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22145     MOVE X'3C20233030303230373039' TO DFHEIV0(25:11)
 22146     CALL 'kxdfhei1' USING DFHEIV0
 22147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22148
 22149
 22150
 22151* EXEC CICS READ
 22152*        DATASET     (CERT-ID)
 22153*        INTO        (CERTIFICATE-MASTER)
 22154*        RIDFLD      (ELCERT-KEY)
 22155*        UPDATE
 22156*    END-EXEC.
 22157     MOVE LENGTH OF
 22158      CERTIFICATE-MASTER
 22159       TO DFHEIV11
 22160*    MOVE '&"IL       EU         (   #00020713' TO DFHEIV0
 22161     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22162     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22163     MOVE X'2020233030303230373133' TO DFHEIV0(25:11)
 22164     CALL 'kxdfhei1' USING DFHEIV0,
 22165           CERT-ID,
 22166           CERTIFICATE-MASTER,
 22167           DFHEIV11,
 22168           ELCERT-KEY,
 22169           DFHEIV99,
 22170           DFHEIV99,
 22171           DFHEIV99
 22172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22173
 22174
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 410
* EL050.cbl
 22175 8590-EXIT.
 22176     EXIT.
 22177
 22178 8690-READ-CERT-MASTER-UCL.
 22179
 22180* EXEC CICS HANDLE CONDITION
 22181*         NOTFND    (8700-READ-CERT-MASTER)
 22182*    END-EXEC.
 22183*    MOVE '"$I                   ! = #00020724' TO DFHEIV0
 22184     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22185     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22186     MOVE X'3D20233030303230373234' TO DFHEIV0(25:11)
 22187     CALL 'kxdfhei1' USING DFHEIV0
 22188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22189
 22190
 22191 8690-READ-CERT-CONT.
 22192
 22193* EXEC CICS READ
 22194*        DATASET     (CERT-ID)
 22195*        INTO        (CERTIFICATE-MASTER)
 22196*        RIDFLD      (ELCERT-KEY)
 22197*        UPDATE
 22198*    END-EXEC.
 22199     MOVE LENGTH OF
 22200      CERTIFICATE-MASTER
 22201       TO DFHEIV11
 22202*    MOVE '&"IL       EU         (   #00020729' TO DFHEIV0
 22203     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22204     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22205     MOVE X'2020233030303230373239' TO DFHEIV0(25:11)
 22206     CALL 'kxdfhei1' USING DFHEIV0,
 22207           CERT-ID,
 22208           CERTIFICATE-MASTER,
 22209           DFHEIV11,
 22210           ELCERT-KEY,
 22211           DFHEIV99,
 22212           DFHEIV99,
 22213           DFHEIV99
 22214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22215
 22216
 22217     GO TO 8590-EXIT.
 22218
 22219 8700-READ-CERT-MASTER.
 22220     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 22221     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 22222
 22223* EXEC CICS HANDLE CONDITION
 22224*         DUPKEY    (8720-COMP-ACCOUNTS)
 22225*         ENDFILE   (8730-END-BROWSE)
 22226*         NOTFND    (8740-NOT-FOUND)
 22227*    END-EXEC.
 22228*    MOVE '"$$''I                 ! > #00020741' TO DFHEIV0
 22229     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 22230     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22231     MOVE X'3E20233030303230373431' TO DFHEIV0(25:11)
 22232     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 411
* EL050.cbl
 22233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22234
 22235
 22236
 22237* EXEC CICS STARTBR
 22238*        DATASET     ('ELCERT5')
 22239*        RIDFLD      (ELCERT2-KEY)
 22240*        EQUAL
 22241*    END-EXEC.
 22242     MOVE 'ELCERT5' TO DFHEIV1
 22243     MOVE 0
 22244       TO DFHEIV11
 22245*    MOVE '&,         E          &   #00020747' TO DFHEIV0
 22246     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 22247     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22248     MOVE X'2020233030303230373437' TO DFHEIV0(25:11)
 22249     CALL 'kxdfhei1' USING DFHEIV0,
 22250           DFHEIV1,
 22251           ELCERT2-KEY,
 22252           DFHEIV99,
 22253           DFHEIV11,
 22254           DFHEIV99
 22255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22256
 22257
 22258 8710-READ-NEXT.
 22259
 22260* EXEC CICS READNEXT
 22261*        DATASET     ('ELCERT5')
 22262*        INTO        (CERTIFICATE-MASTER)
 22263*        RIDFLD      (ELCERT2-KEY)
 22264*    END-EXEC.
 22265     MOVE LENGTH OF
 22266      CERTIFICATE-MASTER
 22267       TO DFHEIV12
 22268     MOVE 'ELCERT5' TO DFHEIV1
 22269     MOVE 0
 22270       TO DFHEIV11
 22271*    MOVE '&.IL                  )   #00020754' TO DFHEIV0
 22272     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22273     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22274     MOVE X'2020233030303230373534' TO DFHEIV0(25:11)
 22275     CALL 'kxdfhei1' USING DFHEIV0,
 22276           DFHEIV1,
 22277           CERTIFICATE-MASTER,
 22278           DFHEIV12,
 22279           ELCERT2-KEY,
 22280           DFHEIV99,
 22281           DFHEIV11,
 22282           DFHEIV99,
 22283           DFHEIV99
 22284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22285
 22286
 22287 8720-COMP-ACCOUNTS.
 22288
 22289* EXEC CICS ENTER
 22290*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 412
* EL050.cbl
 22291*         FROM (PB-C-LAST-NAME)
 22292*    END-EXEC.
 22293     MOVE 001
 22294       TO DFHEIV11
 22295*    MOVE ':$F                   %   #00020761' TO DFHEIV0
 22296     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22297     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22298     MOVE X'2020233030303230373631' TO DFHEIV0(25:11)
 22299     CALL 'kxdfhei1' USING DFHEIV0,
 22300           DFHEIV11,
 22301           PB-C-LAST-NAME,
 22302           DFHEIV99,
 22303           DFHEIV99
 22304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22305
 22306
 22307
 22308* EXEC CICS ENTER
 22309*         TRACEID (002)
 22310*         FROM (CM-INSURED-LAST-NAME)
 22311*    END-EXEC.
 22312     MOVE 002
 22313       TO DFHEIV11
 22314*    MOVE ':$F                   %   #00020766' TO DFHEIV0
 22315     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22316     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22317     MOVE X'2020233030303230373636' TO DFHEIV0(25:11)
 22318     CALL 'kxdfhei1' USING DFHEIV0,
 22319           DFHEIV11,
 22320           CM-INSURED-LAST-NAME,
 22321           DFHEIV99,
 22322           DFHEIV99
 22323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22324
 22325
 22326     IF PB-CERT-NO NOT = CM-CERT-NO
 22327         GO TO 8730-END-BROWSE.
 22328
 22329     IF PB-ACCOUNT = CM-ACCOUNT
 22330         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22331             MOVE ER-2799        TO WS-ERROR
 22332             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22333             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22334             GO TO 8730-END-BROWSE.
 22335
 22336     GO TO 8710-READ-NEXT.
 22337
 22338 8730-END-BROWSE.
 22339
 22340* EXEC CICS ENDBR
 22341*         DATASET    ('ELCERT5')
 22342*    END-EXEC.
 22343     MOVE 'ELCERT5' TO DFHEIV1
 22344     MOVE 0
 22345       TO DFHEIV11
 22346*    MOVE '&2                    $   #00020784' TO DFHEIV0
 22347     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22348     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 413
* EL050.cbl
 22349     MOVE X'2020233030303230373834' TO DFHEIV0(25:11)
 22350     CALL 'kxdfhei1' USING DFHEIV0,
 22351           DFHEIV1,
 22352           DFHEIV11,
 22353           DFHEIV99
 22354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22355
 22356
 22357 8740-NOT-FOUND.
 22358     GO TO 0299-CERT-NOT-FOUND.
 22359
 22360 8750-START-ELSTAT.
 22361
 22362* EXEC CICS STARTBR
 22363*       DATASET   (STAT-ID)
 22364*       RIDFLD    (ELSTAT-KEY)
 22365*       GTEQ
 22366*       RESP      (WS-RESPONSE)
 22367*    END-EXEC
 22368     MOVE 0
 22369       TO DFHEIV11
 22370*    MOVE '&,         G          &  N#00020792' TO DFHEIV0
 22371     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22372     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22373     MOVE X'204E233030303230373932' TO DFHEIV0(25:11)
 22374     CALL 'kxdfhei1' USING DFHEIV0,
 22375           STAT-ID,
 22376           ELSTAT-KEY,
 22377           DFHEIV99,
 22378           DFHEIV11,
 22379           DFHEIV99
 22380     MOVE EIBRESP  TO WS-RESPONSE
 22381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22382     IF WS-RESP-NORMAL
 22383        MOVE 'Y'                 TO STAT-MASTER-SW
 22384     ELSE
 22385        MOVE 'N'                 TO STAT-MASTER-SW
 22386     END-IF
 22387     .
 22388 8750-EXIT.
 22389     EXIT.
 22390 8752-READ-ELSTAT.
 22391
 22392* EXEC CICS READNEXT
 22393*       DATASET   (STAT-ID)
 22394*       RIDFLD    (ELSTAT-KEY)
 22395*       INTO      (STATE-FILE)
 22396*       RESP      (WS-RESPONSE)
 22397*    END-EXEC
 22398     MOVE LENGTH OF
 22399      STATE-FILE
 22400       TO DFHEIV12
 22401     MOVE 0
 22402       TO DFHEIV11
 22403*    MOVE '&.IL                  )  N#00020807' TO DFHEIV0
 22404     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22405     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22406     MOVE X'204E233030303230383037' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 414
* EL050.cbl
 22407     CALL 'kxdfhei1' USING DFHEIV0,
 22408           STAT-ID,
 22409           STATE-FILE,
 22410           DFHEIV12,
 22411           ELSTAT-KEY,
 22412           DFHEIV99,
 22413           DFHEIV11,
 22414           DFHEIV99,
 22415           DFHEIV99
 22416     MOVE EIBRESP  TO WS-RESPONSE
 22417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22418     IF WS-RESP-NORMAL
 22419        MOVE 'Y'                 TO STAT-MASTER-SW
 22420     ELSE
 22421        MOVE 'N'                 TO STAT-MASTER-SW
 22422     END-IF
 22423     .
 22424 8752-EXIT.
 22425     EXIT.
 22426 8800-GET-COMP-RATE.
 22427     MOVE +1 TO IB.
 22428     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22429         ADD +9 TO IB
 22430         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22431             ADD +9 TO IB
 22432             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22433                MOVE ZEROS       TO WS-WK-RATE
 22434                GO TO 8800-EXIT.
 22435
 22436     IF PB-I-AGE GREATER CT-AGE (1)
 22437         ADD +3 TO IB
 22438         IF PB-I-AGE GREATER CT-AGE (2)
 22439             ADD +3 TO IB
 22440             IF PB-I-AGE GREATER CT-AGE (3)
 22441                MOVE ZEROS       TO WS-WK-RATE
 22442                GO TO 8800-EXIT.
 22443
 22444     IF WS-WORK-TERM GREATER CT-TRM (1)
 22445         ADD +1 TO IB
 22446         IF WS-WORK-TERM GREATER CT-TRM (2)
 22447             ADD +1 TO IB
 22448             IF WS-WORK-TERM GREATER CT-TRM (3)
 22449                MOVE ZEROS       TO WS-WK-RATE
 22450                GO TO 8800-EXIT.
 22451
 22452     IF CT-RT (IB) NOT NUMERIC
 22453         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22454         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22455         GO TO 8800-GET-COMP-RATE.
 22456
 22457     MOVE CT-RT (IB) TO WS-WK-RATE.
 22458
 22459 8800-EXIT.
 22460     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 415
* EL050.cbl
 22462 8900-ADDRESS-FILE.
 22463     IF ERACCT-FILE-ADDRESSED
 22464         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22465         GO TO 8900-ADDRESS-EXIT.
 22466
 22467     IF ELCNTL-FILE-ADDRESSED
 22468         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22469         GO TO 8900-ADDRESS-EXIT.
 22470
 22471     IF ERPLAN-FILE-ADDRESSED
 22472         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22473         GO TO 8900-ADDRESS-EXIT.
 22474
 22475     IF ERFORM-FILE-ADDRESSED
 22476         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22477         GO TO 8900-ADDRESS-EXIT.
 22478
 22479 8900-ADDRESS-EXIT.
 22480     EXIT.
 22481
 22482 9000-READ-CONTROL.
 22483
 22484* EXEC CICS HANDLE CONDITION
 22485*        NOTFND    (9000-NOTFND)
 22486*    END-EXEC.
 22487*    MOVE '"$I                   ! ? #00020878' TO DFHEIV0
 22488     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22489     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22490     MOVE X'3F20233030303230383738' TO DFHEIV0(25:11)
 22491     CALL 'kxdfhei1' USING DFHEIV0
 22492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22493
 22494
 22495
 22496* EXEC CICS READ
 22497*        DATASET     (CNTL-ID)
 22498*        SET         (ADDRESS OF CONTROL-FILE)
 22499*        RIDFLD      (ELCNTL-KEY)
 22500*        GTEQ
 22501*    END-EXEC.
 22502*    MOVE '&"S        G          (   #00020882' TO DFHEIV0
 22503     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22504     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22505     MOVE X'2020233030303230383832' TO DFHEIV0(25:11)
 22506     CALL 'kxdfhei1' USING DFHEIV0,
 22507           CNTL-ID,
 22508           DFHEIV20,
 22509           DFHEIV99,
 22510           ELCNTL-KEY,
 22511           DFHEIV99,
 22512           DFHEIV99,
 22513           DFHEIV99
 22514     SET ADDRESS OF CONTROL-FILE TO
 22515         DFHEIV20
 22516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22517
 22518
 22519     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 416
* EL050.cbl
 22520
 22521 9000-NOTFND.
 22522     IF RC-SW-1 = '1'
 22523        MOVE ER-2616              TO WS-ERROR
 22524        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22525        GO TO 9000-EXIT.
 22526
 22527     IF RC-SW-1 = '2'
 22528        MOVE ER-2602              TO WS-ERROR
 22529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22530
 22531 9000-EXIT.
 22532      EXIT.
 22533
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 417
* EL050.cbl
 22535 9100-READ-CONTROL.
 22536
 22537* EXEC CICS HANDLE CONDITION
 22538*        NOTFND  (9100-NOTFND)
 22539*        ENDFILE (9100-NOTFND)
 22540*    END-EXEC.
 22541*    MOVE '"$I''                  ! @ #00020906' TO DFHEIV0
 22542     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22544     MOVE X'4020233030303230393036' TO DFHEIV0(25:11)
 22545     CALL 'kxdfhei1' USING DFHEIV0
 22546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22547
 22548
 22549
 22550* EXEC CICS READ
 22551*        DATASET     (CNTL-ID)
 22552*        INTO        (CONTROL-FILE)
 22553*        RIDFLD      (ELCNTL-KEY)
 22554*        GTEQ
 22555*    END-EXEC.
 22556     MOVE LENGTH OF
 22557      CONTROL-FILE
 22558       TO DFHEIV11
 22559*    MOVE '&"IL       G          (   #00020911' TO DFHEIV0
 22560     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22561     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22562     MOVE X'2020233030303230393131' TO DFHEIV0(25:11)
 22563     CALL 'kxdfhei1' USING DFHEIV0,
 22564           CNTL-ID,
 22565           CONTROL-FILE,
 22566           DFHEIV11,
 22567           ELCNTL-KEY,
 22568           DFHEIV99,
 22569           DFHEIV99,
 22570           DFHEIV99
 22571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22572
 22573
 22574     GO TO 9100-EXIT.
 22575
 22576 9100-NOTFND.
 22577     IF RC-SW-2 = '0'
 22578        MOVE '1'                  TO STATE-RECORD-ERROR
 22579        GO TO 9100-EXIT
 22580     END-IF
 22581     IF RC-SW-2 = '1'
 22582        MOVE '1'                  TO LF-BENEFIT-ERROR
 22583        MOVE ER-2604              TO WS-ERROR
 22584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22585        GO TO 9100-EXIT.
 22586
 22587     IF RC-SW-2 = '2'
 22588        MOVE '1'                  TO AH-BENEFIT-ERROR
 22589        MOVE ER-2605              TO WS-ERROR
 22590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22591        GO TO 9100-EXIT.
 22592
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 418
* EL050.cbl
 22593     IF RC-SW-2 = '3'
 22594         MOVE ER-2603           TO WS-ERROR
 22595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22596         GO TO 9100-EXIT.
 22597
 22598     IF RC-SW-2 = '4'
 22599         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22600         GO TO 9100-EXIT.
 22601
 22602     IF RC-SW-2 = '5'
 22603         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22604         IF WS-AH-INPUT-CD-1 = SPACE
 22605             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22606         ELSE
 22607             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22608
 22609 9100-EXIT.
 22610      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 419
* EL050.cbl
 22612 9200-CONTROL-GETMAIN.
 22613
 22614* EXEC CICS GETMAIN
 22615*         LENGTH   (750)
 22616*         SET      (ADDRESS OF CONTROL-FILE)
 22617*    END-EXEC.
 22618     MOVE 750
 22619       TO DFHEIV11
 22620*    MOVE '," L                  $   #00020957' TO DFHEIV0
 22621     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22622     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22623     MOVE X'2020233030303230393537' TO DFHEIV0(25:11)
 22624     CALL 'kxdfhei1' USING DFHEIV0,
 22625           DFHEIV20,
 22626           DFHEIV11,
 22627           DFHEIV99
 22628     SET ADDRESS OF CONTROL-FILE TO
 22629         DFHEIV20
 22630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22631
 22632
 22633     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22634
 22635 9200-EXIT.
 22636     EXIT.
 22637
 22638 9250-UNLOCK-RETURN.
 22639
 22640* EXEC CICS UNLOCK
 22641*        DATASET   (CERT-ID)
 22642*    END-EXEC.
 22643*    MOVE '&*                    #   #00020968' TO DFHEIV0
 22644     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22645     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22646     MOVE X'2020233030303230393638' TO DFHEIV0(25:11)
 22647     CALL 'kxdfhei1' USING DFHEIV0,
 22648           CERT-ID,
 22649           DFHEIV99
 22650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22651
 22652
 22653 9300-ABEND.
 22654     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22655
 22656
 22657* EXEC CICS LINK
 22658*        PROGRAM   ('EL004')
 22659*        COMMAREA  (WS-ERROR-LINE)
 22660*        LENGTH    (72)
 22661*    END-EXEC.
 22662     MOVE 'EL004' TO DFHEIV1
 22663     MOVE 72
 22664       TO DFHEIV11
 22665*    MOVE '."C                   (   #00020975' TO DFHEIV0
 22666     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22667     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22668     MOVE X'2020233030303230393735' TO DFHEIV0(25:11)
 22669     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 420
* EL050.cbl
 22670           DFHEIV1,
 22671           WS-ERROR-LINE,
 22672           DFHEIV11,
 22673           DFHEIV99,
 22674           DFHEIV99,
 22675           DFHEIV99,
 22676           DFHEIV99
 22677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22678
 22679
 22680     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22681
 22682
 22683* EXEC CICS ABEND
 22684*        ABCODE ('EL50')
 22685*    END-EXEC.
 22686     MOVE 'EL50' TO DFHEIV5
 22687*    MOVE '.,A                   "   #00020983' TO DFHEIV0
 22688     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22689     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22690     MOVE X'2020233030303230393833' TO DFHEIV0(25:11)
 22691     CALL 'kxdfhei1' USING DFHEIV0,
 22692           DFHEIV5
 22693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22694
 22695
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 421
* EL050.cbl
 22697
 22698******************************************************************
 22699*                                                                *
 22700*            E R R O R   F O R M A T   R O U T I N E             *
 22701*                                                                *
 22702******************************************************************
 22703
 22704 9900-ERROR-FORMAT.
 22705
 22706     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22707                    PB-COMMON-ERROR (2) OR
 22708                    PB-COMMON-ERROR (3) OR
 22709                    PB-COMMON-ERROR (4) OR
 22710                    PB-COMMON-ERROR (5) OR
 22711                    PB-COMMON-ERROR (6) OR
 22712                    PB-COMMON-ERROR (7) OR
 22713                    PB-COMMON-ERROR (8) OR
 22714                    PB-COMMON-ERROR (9) OR
 22715                    PB-COMMON-ERROR (10)
 22716        GO TO 9900-EXIT.
 22717
 22718     IF PB-NO-OF-ERRORS = +10
 22719        GO TO 9900-EXIT.
 22720
 22721     ADD +1  TO PB-NO-OF-ERRORS.
 22722     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22723                                       (PB-NO-OF-ERRORS).
 22724 9900-EXIT.
 22725     EXIT.
 22726
 22727 9990-RETURN.
 22728     IF BROWSE-STARTED
 22729
 22730* EXEC CICS ENDBR
 22731*            DATASET  (ACCT-ID)
 22732*       END-EXEC.
 22733     MOVE 0
 22734       TO DFHEIV11
 22735*    MOVE '&2                    $   #00021020' TO DFHEIV0
 22736     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22737     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22738     MOVE X'2020233030303231303230' TO DFHEIV0(25:11)
 22739     CALL 'kxdfhei1' USING DFHEIV0,
 22740           ACCT-ID,
 22741           DFHEIV11,
 22742           DFHEIV99
 22743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22744
 22745
 22746 9990-EXIT.
 22747     EXIT.
 22748
 22749
 22750****Check for CRTO record, add one if not found.
 22751 9991-CHECK-FOR-ELCRTO.
 22752
 22753* EXEC CICS HANDLE CONDITION
 22754*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 422
* EL050.cbl
 22755*         ENDFILE (9991-CRTO-NOT-FOUND)
 22756*     END-EXEC.
 22757*    MOVE '"$I''                  ! A #00021030' TO DFHEIV0
 22758     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22760     MOVE X'4120233030303231303330' TO DFHEIV0(25:11)
 22761     CALL 'kxdfhei1' USING DFHEIV0
 22762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22763
 22764     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22765     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22766     MOVE +0                     TO ELCRTO-SEQ-NO
 22767
 22768
 22769* EXEC CICS READ
 22770*       DATASET   ('ELCRTO')
 22771*       INTO      (ORIGINAL-CERTIFICATE)
 22772*       RIDFLD    (ELCRTO-KEY)
 22773*       GTEQ
 22774*       RESP      (WS-RESPONSE)
 22775*    END-EXEC
 22776     MOVE LENGTH OF
 22777      ORIGINAL-CERTIFICATE
 22778       TO DFHEIV11
 22779     MOVE 'ELCRTO' TO DFHEIV1
 22780*    MOVE '&"IL       G          (  N#00021038' TO DFHEIV0
 22781     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22783     MOVE X'204E233030303231303338' TO DFHEIV0(25:11)
 22784     CALL 'kxdfhei1' USING DFHEIV0,
 22785           DFHEIV1,
 22786           ORIGINAL-CERTIFICATE,
 22787           DFHEIV11,
 22788           ELCRTO-KEY,
 22789           DFHEIV99,
 22790           DFHEIV99,
 22791           DFHEIV99
 22792     MOVE EIBRESP  TO WS-RESPONSE
 22793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22794
 22795     IF WS-RESP-NORMAL
 22796        AND (OC-CONTROL-PRIMARY (1:33) =
 22797                 PB-CONTROL-BY-ACCOUNT (1:33))
 22798        AND (OC-RECORD-TYPE =  'I')
 22799           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22800               GO TO 9991-CHECK-INDICATORS
 22801           ELSE
 22802               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22803               GO TO 9991-CRTO-ADD-REC
 22804           END-IF
 22805     END-IF.
 22806
 22807 9991-CRTO-NOT-FOUND.
 22808
 22809     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22810     MOVE 'OC'                TO OC-RECORD-ID
 22811     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22812                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 423
* EL050.cbl
 22813     MOVE +4096               TO OC-KEY-SEQ-NO.
 22814
 22815 9991-CRTO-ADD-REC.
 22816
 22817     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22818     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22819     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22820     MOVE 'I'                 TO OC-RECORD-TYPE
 22821     IF PB-ISSUE
 22822         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22823         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22824         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22825         MOVE PB-I-AGE               TO OC-INS-AGE
 22826         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22827         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22828         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22829         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22830         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22831         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22832         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22833         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22834         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22835         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22836         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22837         IF PB-I-JOINT-COMMISSION > +0
 22838             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22839         ELSE
 22840             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22841         END-IF
 22842         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22843         MOVE +0                     TO OC-LF-CANCEL-AMT
 22844                                        OC-LF-ITD-CANCEL-AMT
 22845         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22846         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22847         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22848         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22849         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22850         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22851         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22852         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22853         MOVE +0                     TO OC-AH-CANCEL-AMT
 22854                                        OC-AH-ITD-CANCEL-AMT
 22855         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22856         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22857         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22858     ELSE
 22859         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22860         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22861         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22862         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22863         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22864         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22865         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22866         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22867         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22868          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22869             MOVE SPACES             TO OC-LF-BENCD
 22870             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 424
* EL050.cbl
 22871                                        OC-LF-BEN-AMT
 22872                                        OC-LF-PRM-AMT
 22873                                        OC-LF-ALT-BEN-AMT
 22874                                        OC-LF-ALT-PRM-AMT
 22875                                        OC-LF-COMM-PCT
 22876                                        OC-LF-CANCEL-AMT
 22877             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22878             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22879         ELSE
 22880             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22881             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22882             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22883             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22884             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22885             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22886             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22887             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22888             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22889             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22890         END-IF
 22891         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22892         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22893          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22894             MOVE SPACES             TO OC-AH-BENCD
 22895             MOVE ZEROS              TO OC-AH-TERM
 22896                                        OC-AH-BEN-AMT
 22897                                        OC-AH-PRM-AMT
 22898                                        OC-AH-COMM-PCT
 22899                                        OC-AH-CANCEL-AMT
 22900                                        OC-AH-CP
 22901             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22902             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22903         ELSE
 22904             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22905             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22906             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22907             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22908             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22909             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22910             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22911             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22912             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22913         END-IF
 22914         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22915         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22916         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22917         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22918     END-IF
 22919     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22920
 22921     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22922
 22923
 22924* EXEC CICS READ
 22925*         DATASET   (FILE-ERMAIL)
 22926*         RIDFLD    (MA-CONTROL-PRIMARY)
 22927*         INTO      (MAILING-DATA)
 22928*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 425
* EL050.cbl
 22929*    END-EXEC
 22930     MOVE LENGTH OF
 22931      MAILING-DATA
 22932       TO DFHEIV11
 22933*    MOVE '&"IL       E          (  N#00021174' TO DFHEIV0
 22934     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22935     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22936     MOVE X'204E233030303231313734' TO DFHEIV0(25:11)
 22937     CALL 'kxdfhei1' USING DFHEIV0,
 22938           FILE-ERMAIL,
 22939           MAILING-DATA,
 22940           DFHEIV11,
 22941           MA-CONTROL-PRIMARY,
 22942           DFHEIV99,
 22943           DFHEIV99,
 22944           DFHEIV99
 22945     MOVE EIBRESP  TO WS-RESPONSE
 22946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22947
 22948     IF WS-RESP-NORMAL
 22949         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22950     END-IF.
 22951
 22952     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22953     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22954
 22955
 22956* EXEC CICS READ
 22957*         DATASET  (CRTT-ID)
 22958*         RIDFLD   (WS-ELCRTT-KEY)
 22959*         INTO     (CERTIFICATE-TRAILERS)
 22960*         RESP     (WS-RESPONSE)
 22961*    END-EXEC
 22962     MOVE LENGTH OF
 22963      CERTIFICATE-TRAILERS
 22964       TO DFHEIV11
 22965*    MOVE '&"IL       E          (  N#00021188' TO DFHEIV0
 22966     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22967     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22968     MOVE X'204E233030303231313838' TO DFHEIV0(25:11)
 22969     CALL 'kxdfhei1' USING DFHEIV0,
 22970           CRTT-ID,
 22971           CERTIFICATE-TRAILERS,
 22972           DFHEIV11,
 22973           WS-ELCRTT-KEY,
 22974           DFHEIV99,
 22975           DFHEIV99,
 22976           DFHEIV99
 22977     MOVE EIBRESP  TO WS-RESPONSE
 22978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22979
 22980     IF WS-RESP-NORMAL
 22981         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22982         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22983     END-IF.
 22984
 22985
 22986* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 426
* EL050.cbl
 22987*       DATASET   ('ELCRTO')
 22988*       FROM      (ORIGINAL-CERTIFICATE)
 22989*       RIDFLD    (OC-CONTROL-PRIMARY)
 22990*       RESP      (WS-RESPONSE)
 22991*    END-EXEC.
 22992     MOVE LENGTH OF
 22993      ORIGINAL-CERTIFICATE
 22994       TO DFHEIV11
 22995     MOVE 'ELCRTO' TO DFHEIV1
 22996*    MOVE '&$ L                  ''  N#00021200' TO DFHEIV0
 22997     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22998     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22999     MOVE X'204E233030303231323030' TO DFHEIV0(25:11)
 23000     CALL 'kxdfhei1' USING DFHEIV0,
 23001           DFHEIV1,
 23002           ORIGINAL-CERTIFICATE,
 23003           DFHEIV11,
 23004           OC-CONTROL-PRIMARY,
 23005           DFHEIV99,
 23006           DFHEIV99
 23007     MOVE EIBRESP  TO WS-RESPONSE
 23008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23009
 23010
 23011     GO TO 9991-EXIT.
 23012
 23013 9991-CHECK-INDICATORS.
 23014
 23015     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 23016         GO TO 9991-EXIT
 23017     END-IF.
 23018
 23019     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 23020         GO TO 9991-EXIT
 23021     END-IF.
 23022
 23023
 23024* EXEC CICS READ
 23025*       DATASET   ('ELCRTO')
 23026*       INTO      (ORIGINAL-CERTIFICATE)
 23027*       RIDFLD    (OC-CONTROL-PRIMARY)
 23028*       UPDATE
 23029*       RESP      (WS-RESPONSE)
 23030*    END-EXEC
 23031     MOVE LENGTH OF
 23032      ORIGINAL-CERTIFICATE
 23033       TO DFHEIV11
 23034     MOVE 'ELCRTO' TO DFHEIV1
 23035*    MOVE '&"IL       EU         (  N#00021219' TO DFHEIV0
 23036     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23037     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23038     MOVE X'204E233030303231323139' TO DFHEIV0(25:11)
 23039     CALL 'kxdfhei1' USING DFHEIV0,
 23040           DFHEIV1,
 23041           ORIGINAL-CERTIFICATE,
 23042           DFHEIV11,
 23043           OC-CONTROL-PRIMARY,
 23044           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 427
* EL050.cbl
 23045           DFHEIV99,
 23046           DFHEIV99
 23047     MOVE EIBRESP  TO WS-RESPONSE
 23048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23049     IF WS-RESP-NORMAL
 23050        IF PB-ISSUE
 23051          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 23052          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 23053          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 23054          MOVE PB-I-AGE               TO OC-INS-AGE
 23055          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 23056          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 23057          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 23058          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 23059          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 23060          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 23061          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 23062          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 23063          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 23064          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 23065          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 23066          IF PB-I-JOINT-COMMISSION > +0
 23067              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 23068          ELSE
 23069              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 23070          END-IF
 23071          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 23072          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 23073          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 23074          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 23075          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 23076          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 23077          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 23078          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 23079          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 23080
 23081          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 23082
 23083* EXEC CICS READ
 23084*             DATASET   (FILE-ERMAIL)
 23085*             RIDFLD    (MA-CONTROL-PRIMARY)
 23086*             INTO      (MAILING-DATA)
 23087*             RESP      (WS-RESPONSE)
 23088*         END-EXEC
 23089     MOVE LENGTH OF
 23090      MAILING-DATA
 23091       TO DFHEIV11
 23092*    MOVE '&"IL       E          (  N#00021259' TO DFHEIV0
 23093     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23094     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23095     MOVE X'204E233030303231323539' TO DFHEIV0(25:11)
 23096     CALL 'kxdfhei1' USING DFHEIV0,
 23097           FILE-ERMAIL,
 23098           MAILING-DATA,
 23099           DFHEIV11,
 23100           MA-CONTROL-PRIMARY,
 23101           DFHEIV99,
 23102           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 428
* EL050.cbl
 23103           DFHEIV99
 23104     MOVE EIBRESP  TO WS-RESPONSE
 23105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23106          IF WS-RESP-NORMAL
 23107             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 23108          END-IF
 23109
 23110          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 23111          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 23112
 23113* EXEC CICS READ
 23114*             DATASET  (CRTT-ID)
 23115*             RIDFLD   (WS-ELCRTT-KEY)
 23116*             INTO     (CERTIFICATE-TRAILERS)
 23117*             RESP     (WS-RESPONSE)
 23118*         END-EXEC
 23119     MOVE LENGTH OF
 23120      CERTIFICATE-TRAILERS
 23121       TO DFHEIV11
 23122*    MOVE '&"IL       E          (  N#00021271' TO DFHEIV0
 23123     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23125     MOVE X'204E233030303231323731' TO DFHEIV0(25:11)
 23126     CALL 'kxdfhei1' USING DFHEIV0,
 23127           CRTT-ID,
 23128           CERTIFICATE-TRAILERS,
 23129           DFHEIV11,
 23130           WS-ELCRTT-KEY,
 23131           DFHEIV99,
 23132           DFHEIV99,
 23133           DFHEIV99
 23134     MOVE EIBRESP  TO WS-RESPONSE
 23135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23136          IF WS-RESP-NORMAL
 23137             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 23138                               OC-INS-AGE-DEFAULT-FLAG
 23139             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 23140                               OC-JNT-AGE-DEFAULT-FLAG
 23141          END-IF
 23142
 23143        ELSE
 23144          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23145             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 23146             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 23147             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 23148          END-IF
 23149          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23150             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 23151             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 23152             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 23153          END-IF
 23154          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 23155        END-IF
 23156
 23157* EXEC CICS REWRITE
 23158*          DATASET   ('ELCRTO')
 23159*          FROM      (ORIGINAL-CERTIFICATE)
 23160*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 429
* EL050.cbl
 23161*       END-EXEC
 23162     MOVE LENGTH OF
 23163      ORIGINAL-CERTIFICATE
 23164       TO DFHEIV11
 23165     MOVE 'ELCRTO' TO DFHEIV1
 23166*    MOVE '&& L                  %  N#00021297' TO DFHEIV0
 23167     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23168     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23169     MOVE X'204E233030303231323937' TO DFHEIV0(25:11)
 23170     CALL 'kxdfhei1' USING DFHEIV0,
 23171           DFHEIV1,
 23172           ORIGINAL-CERTIFICATE,
 23173           DFHEIV11,
 23174           DFHEIV99
 23175     MOVE EIBRESP  TO WS-RESPONSE
 23176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23177     END-IF.
 23178
 23179 9991-EXIT.
 23180     EXIT.
 23181
 23182
 23183 9999-RETURN.
 23184     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 23185
 23186
 23187* EXEC CICS RETURN
 23188*    END-EXEC.
 23189*    MOVE '.(                    ''   #00021311' TO DFHEIV0
 23190     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23191     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23192     MOVE X'2020233030303231333131' TO DFHEIV0(25:11)
 23193     CALL 'kxdfhei1' USING DFHEIV0,
 23194           DFHEIV99,
 23195           DFHEIV99,
 23196           DFHEIV99,
 23197           DFHEIV99,
 23198           DFHEIV99,
 23199           DFHEIV99
 23200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23201
 23202
 23203
 23204* GOBACK.
 23205     MOVE '9%                    "   ' TO DFHEIV0
 23206     MOVE 'EL050' TO DFHEIV1
 23207     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23208     GOBACK.
 23209
 23210 9999-DFHBACK SECTION.
 23211     MOVE '9%                    "   ' TO DFHEIV0
 23212     MOVE 'EL050' TO DFHEIV1
 23213     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23214     GOBACK.
 23215 9999-DFHEXIT.
 23216     IF DFHEIGDJ EQUAL 0001
 23217         NEXT SENTENCE
 23218     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 430
* EL050.cbl
 23219         GO TO 9300-ABEND,
 23220               3990-FILES-NOT-OPEN
 23221         DEPENDING ON DFHEIGDI
 23222     ELSE IF DFHEIGDJ EQUAL 3
 23223         GO TO 6610-START-BROWSE,
 23224               6630-ERRESS-PROBLEM,
 23225               6630-END-OF-FILE
 23226         DEPENDING ON DFHEIGDI
 23227     ELSE IF DFHEIGDJ EQUAL 4
 23228         GO TO 6630-END-OF-FILE,
 23229               6630-ERRESS-PROBLEM,
 23230               6630-ERRESS-PROBLEM,
 23231               6630-END-OF-FILE
 23232         DEPENDING ON DFHEIGDI
 23233     ELSE IF DFHEIGDJ EQUAL 5
 23234         GO TO 6630-END-OF-FILE,
 23235               6630-END-OF-FILE,
 23236               6630-ERRESS-PROBLEM,
 23237               6630-ERRESS-PROBLEM
 23238         DEPENDING ON DFHEIGDI
 23239     ELSE IF DFHEIGDJ EQUAL 6
 23240         GO TO 6660-START-BROWSE,
 23241               6690-ERRESC-PROBLEM,
 23242               6690-ERRESC-PROBLEM,
 23243               6690-END-OF-FILE
 23244         DEPENDING ON DFHEIGDI
 23245     ELSE IF DFHEIGDJ EQUAL 7
 23246         GO TO 6690-END-OF-FILE,
 23247               6690-ERRESC-PROBLEM,
 23248               6690-ERRESC-PROBLEM,
 23249               6690-END-OF-FILE
 23250         DEPENDING ON DFHEIGDI
 23251     ELSE IF DFHEIGDJ EQUAL 8
 23252         GO TO 6690-END-OF-FILE,
 23253               6690-ERRESC-PROBLEM,
 23254               6690-ERRESC-PROBLEM,
 23255               6690-END-OF-FILE
 23256         DEPENDING ON DFHEIGDI
 23257     ELSE IF DFHEIGDJ EQUAL 9
 23258         GO TO 7250-CONTINUE,
 23259               7250-CONTINUE
 23260         DEPENDING ON DFHEIGDI
 23261     ELSE IF DFHEIGDJ EQUAL 10
 23262         GO TO 7300-CONTINUE,
 23263               7300-CONTINUE
 23264         DEPENDING ON DFHEIGDI
 23265     ELSE IF DFHEIGDJ EQUAL 11
 23266         GO TO 7320-CONTINUE,
 23267               7320-CONTINUE
 23268         DEPENDING ON DFHEIGDI
 23269     ELSE IF DFHEIGDJ EQUAL 12
 23270         GO TO 8000-FREE-MAIN
 23271         DEPENDING ON DFHEIGDI
 23272     ELSE IF DFHEIGDJ EQUAL 13
 23273         GO TO 8100-NOTFND,
 23274               8100-NOTFND
 23275         DEPENDING ON DFHEIGDI
 23276     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 431
* EL050.cbl
 23277         GO TO 8110-NOTFND,
 23278               8110-NOTFND
 23279         DEPENDING ON DFHEIGDI
 23280     ELSE IF DFHEIGDJ EQUAL 15
 23281         GO TO 8130-EXIT
 23282         DEPENDING ON DFHEIGDI
 23283     ELSE IF DFHEIGDJ EQUAL 16
 23284         GO TO 8145-exit
 23285         DEPENDING ON DFHEIGDI
 23286     ELSE IF DFHEIGDJ EQUAL 17
 23287         GO TO 8190-NOTFND
 23288         DEPENDING ON DFHEIGDI
 23289     ELSE IF DFHEIGDJ EQUAL 18
 23290         GO TO 8195-NOTFND
 23291         DEPENDING ON DFHEIGDI
 23292     ELSE IF DFHEIGDJ EQUAL 19
 23293         GO TO 8200-NOTFND
 23294         DEPENDING ON DFHEIGDI
 23295     ELSE IF DFHEIGDJ EQUAL 20
 23296         GO TO 8300-NOTFND,
 23297               8300-ERRESS-PROBLEM,
 23298               8300-ERRESS-PROBLEM,
 23299               8300-NOTFND
 23300         DEPENDING ON DFHEIGDI
 23301     ELSE IF DFHEIGDJ EQUAL 21
 23302         GO TO 8450-FORM-NOT-FOUND,
 23303               8450-FORM-NOT-FOUND
 23304         DEPENDING ON DFHEIGDI
 23305     ELSE IF DFHEIGDJ EQUAL 22
 23306         GO TO 0199-ACCT-NOT-FOUND,
 23307               0199-ACCT-NOT-FOUND
 23308         DEPENDING ON DFHEIGDI
 23309     ELSE IF DFHEIGDJ EQUAL 23
 23310         GO TO 0199-ACCT-NOT-FOUND,
 23311               0199-ACCT-NOT-FOUND
 23312         DEPENDING ON DFHEIGDI
 23313     ELSE IF DFHEIGDJ EQUAL 24
 23314         GO TO 8582-COMP-NOT-FOUND,
 23315               8582-COMP-NOT-FOUND
 23316         DEPENDING ON DFHEIGDI
 23317     ELSE IF DFHEIGDJ EQUAL 25
 23318         GO TO 8583-AGTC-NOT-FOUND,
 23319               8583-AGTC-NOT-FOUND
 23320         DEPENDING ON DFHEIGDI
 23321     ELSE IF DFHEIGDJ EQUAL 26
 23322         GO TO 8584-BXRF-NOT-FOUND,
 23323               8584-BXRF-NOT-FOUND
 23324         DEPENDING ON DFHEIGDI
 23325     ELSE IF DFHEIGDJ EQUAL 27
 23326         GO TO 8585-PLAN-NOT-FOUND,
 23327               8585-PLAN-NOT-FOUND
 23328         DEPENDING ON DFHEIGDI
 23329     ELSE IF DFHEIGDJ EQUAL 28
 23330         GO TO 0299-CERT-NOT-FOUND
 23331         DEPENDING ON DFHEIGDI
 23332     ELSE IF DFHEIGDJ EQUAL 29
 23333         GO TO 8700-READ-CERT-MASTER
 23334         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 08-Apr-19 08:59 Page 432
* EL050.cbl
 23335     ELSE IF DFHEIGDJ EQUAL 30
 23336         GO TO 8720-COMP-ACCOUNTS,
 23337               8730-END-BROWSE,
 23338               8740-NOT-FOUND
 23339         DEPENDING ON DFHEIGDI
 23340     ELSE IF DFHEIGDJ EQUAL 31
 23341         GO TO 9000-NOTFND
 23342         DEPENDING ON DFHEIGDI
 23343     ELSE IF DFHEIGDJ EQUAL 32
 23344         GO TO 9100-NOTFND,
 23345               9100-NOTFND
 23346         DEPENDING ON DFHEIGDI
 23347     ELSE IF DFHEIGDJ EQUAL 33
 23348         GO TO 9991-CRTO-NOT-FOUND,
 23349               9991-CRTO-NOT-FOUND
 23350         DEPENDING ON DFHEIGDI.
 23351     MOVE '9%                    "   ' TO DFHEIV0
 23352     MOVE 'EL050' TO DFHEIV1
 23353     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23354     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41824     Code:       95826
