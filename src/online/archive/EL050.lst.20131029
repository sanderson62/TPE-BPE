* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45******************************************************************
    46 ENVIRONMENT DIVISION.
    47
    48 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page   3
* EL050.cbl
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52
    53 77  FILLER   PIC X(32) VALUE '********************************'.
    54 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    55 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    56
    57 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    58 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    59                                   USAGE POINTER.
    60 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    61 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    63                                   USAGE IS POINTER.
    64 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    65 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    66                                   USAGE IS POINTER.
    67 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    68 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    69                                   USAGE IS POINTER.
    70
    71 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    73                                   USAGE IS POINTER.
    74
    75*    COPY ELC50WS.
    76*****************************************************************
    77*                                                               *
    78*                            ELC50WS.                           *
    79*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    80*                            VMOD=2.061.                        *
    81*                                                               *
    82*   THIS IS THE WORKING STORAGE FOR EL050                       *
    83*                                   EL517                       *
    84*****************************************************************
    85******************************************************************
    86*                   C H A N G E   L O G
    87*
    88* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    89*-----------------------------------------------------------------
    90*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    91* EFFECTIVE    NUMBER
    92*-----------------------------------------------------------------
    93* 123102                   PEMA  ADD DCC PROCESSING
    94* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    95* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    96* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    97* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    98* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    99* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   100* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   101* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   102* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   103* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   104* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   105* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   106* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   107* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page   4
* EL050.cbl
   108* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   109* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   110* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   111* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   112* 030309  CR2009021700001  PEMA  ADD ER-2883
   113* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   114* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   115* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   116* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   117* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   118* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   119* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   120* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   121* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   122* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   123* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   124* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   125* 061412  CR2011022800001  AJRA  NAPERSOFT
   126* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   127* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   128* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   129*-----------------------------------------------------------------
   130
   131 01  WORK-AREAS.
   132
   133*****************************************************************
   134*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   135*****************************************************************
   136
   137     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   138     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   139     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   140     12  WS-NAME-EDIT-WORK-AREA.
   141         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   142         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   143             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   144         16  WS-WORK-NAME.
   145             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   146             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   147             20  FILLER           PIC X(10)     VALUE SPACES.
   148         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   149             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   150
   151*****************************************************************
   152*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   153*****************************************************************
   154
   155     12  WS-ERRESC-KEY.
   156         16 WS-ERRESC-SEARCH-KEY.
   157             20  WS-ERRESC-COMPANY-CD PIC  X.
   158             20  WS-ERRESC-CARRIER    PIC  X.
   159             20  WS-ERRESC-GROUP      PIC X(6).
   160             20  WS-ERRESC-STATE      PIC XX.
   161             20  WS-ERRESC-ACCOUNT    PIC X(10).
   162         16 WS-ERRESC-RESIDUAL-KEY.
   163             20  WS-ERRESC-AGENT      PIC X(10).
   164             20  WS-ERRESC-RES-STATE  PIC XX.
   165             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page   5
* EL050.cbl
   166*                                          YYYYMMDD
   167     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   168     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   169
   170*RESIDENT STATE TAX MASTER(ERRESS)
   171*
   172     12  WS-ERRESS-KEY.
   173         16  WS-ERRESS-COMPANY-CD      PIC  X.
   174         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   175         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   176         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   177*                                          YYYYMMDD
   178
   179     12  WS-CONTRACT-DATE              PIC 9(8).
   180*                                          YYYYMMDD
   181     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   182     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   183         16 WS-YEAR-YY                 PIC   9999.
   184         16 FILLER                     PIC 9(4).
   185*                                          YYYYMMDD
   186     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   187     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   188     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   189     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   190
   191     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   192         88  DPRB-1ST-TIME                      VALUE ' '.
   193
   194*****************************************************************
   195*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   196*****************************************************************
   197
   198     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   199     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   200     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   201     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   202     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   203     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   204     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   205     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   206     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   207     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   208         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   209         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   210     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   211         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   212         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   213     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   214
   215     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   216     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   217
   218     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   219     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   220     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   222     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page   6
* EL050.cbl
   224     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   225     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   229     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   230     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   231     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   232     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   233     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   253     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   254     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   255     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   256     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   257     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   261     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   262     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   264     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   265     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   266     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   267     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   268     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   269     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   270     12  WS-2671-SW               PIC X         VALUE SPACE.
   271     12  WS-2672-SW               PIC X         VALUE SPACE.
   272     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   273         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   274     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   275         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   276     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   277
   278     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   279         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   280         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   281         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page   7
* EL050.cbl
   282         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   283
   284     12  WS-CREDIT-EDIT-CONTROLS.
   285         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   286         16  WS-MIN-AGE           PIC 99                VALUE  0.
   287         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   288         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   289         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   290         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   291
   292     12  WS-AGE-FIELDS.
   293         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   294         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   295         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   296         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   297
   298     12  WS-SAVE-ALLOWABLE-BENEFIT.
   299         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   300         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   301         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   302         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   303         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   304         16  FILLER                      PIC XX.
   305
   306     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   307     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   308     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   309     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   310     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   311     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   312     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   313     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   314     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   315     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   316
   317     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   318     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   319     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   320     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   321     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   322     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   323     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   324     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   325         88  WS-REDUCING              VALUE 'R'.
   326         88  WS-LEVEL                 VALUE 'L' 'P'.
   327     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   328
   329     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   330     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   331     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   332     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   333     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   334     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   335     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   336     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   337     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   338
   339     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page   8
* EL050.cbl
   340     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   341     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   342     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   343     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   344     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   345     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   346     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   347     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   348     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   349     12  WS-ACCT-SIG-SW.
   350         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   351         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   352     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   353     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   354     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   355     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   356     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   357     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   358     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   359     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   360     12  WS-INITIALS.
   361         16  WS-INIT-1            PIC X         VALUE SPACES.
   362         16  WS-INIT-2            PIC X         VALUE SPACES.
   363
   364     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   365     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   366     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   367     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   368     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   369*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   370     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   371     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   372     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   373     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   374     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   375     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   376     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   377     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   378     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   379     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   380     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   381     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   382     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   383     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   385     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   386     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   387     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   388     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   389     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   390     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   391     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   392******** FLA
   393     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   394     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   395     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   396     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   397     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page   9
* EL050.cbl
   398********
   399     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   400     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   401     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   402     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   403     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   404     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   405     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   406     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   407     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   408     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   409
   410     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   411         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   412                                         '0' THRU '9'.
   413
   414     12  NUMBER-OF-MONTHS.
   415         16  SK-MO OCCURS 12 TIMES PIC X.
   416
   417     12  WS-WORK-DATE.
   418         16  WS-YEAR            PIC 99    VALUE 00.
   419         16  WS-MONTH           PIC 99    VALUE 00.
   420         16  WS-DAY             PIC 99    VALUE 00.
   421
   422     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   423     12  WS-WORK-CRIT-DEV       REDEFINES
   424         WS-WORK-LF-CRIT-PER    PIC X(03).
   425
   426     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   427     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   428
   429     12  WS-WORK-DATE-FROM.
   430         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   431         16  FILLER             PIC X  VALUE SPACE.
   432         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   433         16  FILLER             PIC X         VALUE SPACE.
   434         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   435
   436     12  WS-WORK-DATE-THRU.
   437         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   438         16  FILLER             PIC X         VALUE SPACE.
   439         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   440         16  FILLER             PIC X         VALUE SPACE.
   441         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   442
   443     12  WS-LF-INPUT-CD.
   444         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   445         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   446
   447     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   448     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   449         16  WS-AH-INPUT-CD-1   PIC X.
   450         16  WS-AH-INPUT-CD-2-3 PIC XX.
   451
   452     12  WS-SWITCHES.
   453         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   454         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   455             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  10
* EL050.cbl
   456         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   457             88  BANK-ACCT-FOUND          VALUE 'Y'.
   458         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   459             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   460         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   461             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   462         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   463             88  COMP-MASTER-FOUND        VALUE 'Y'.
   464         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   465             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   466         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   467             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   468         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   469             88  STAT-MASTER-FOUND        VALUE 'Y'.
   470         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   471             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   472         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   473             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   474         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   475             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   476         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   477             88  FORM-MASTER-FOUND        VALUE 'Y'.
   478         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   479             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   480         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   481             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   482         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   483             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   484         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   485             88  NO-BENEFIT-FOUND         VALUE 'N'.
   486         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   487             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   488         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   489             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   490         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   491             88  AH-BENEFIT-FOUND         VALUE ' '.
   492             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   493         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   494             88  LF-BENEFIT-FOUND         VALUE ' '.
   495             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   496         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   497             88  NO-STATE-RECORD          VALUE '1'.
   498         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   499             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   500         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   501             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   502         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   503             88  CERT-WAS-FOUND           VALUE ' '.
   504             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   505         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   506             88  BROWSE-STARTED           VALUE 'Y'.
   507         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   508             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   509         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   510             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   511         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   512             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   513         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  11
* EL050.cbl
   514             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   515         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   516             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   517         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   518             88  APP-CERT-USED            VALUE 'Y' 'A'.
   519         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   520             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   521             88  FIRST-TIME-THROUGH       VALUE '1'.
   522             88  CTBL-NOT-FOUND           VALUE '2'.
   523
   524         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   525             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   526
   527         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   528             88  DLO-ERROR-FOUND          VALUE 'Y'.
   529
   530********FLA
   531     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   532     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   533********
   534     12  RC-SW-1                  PIC X           VALUE '0'.
   535     12  RC-SW-2                  PIC X           VALUE '0'.
   536     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   537     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   538     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   539     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   540     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   541     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   542     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   543     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   544     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   545     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   546     12  LIT-SPACES               PIC X           VALUE SPACES.
   547     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   548     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   549     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   550     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   551     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   552     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   553     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   554         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   555         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   556     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   557         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   558
   559 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   560     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   561     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   562 01  WS-CRI-SSN-WORK-AREA.
   563     05  WS-CRI-SOC-SEC-NO.
   564         10  WS-SS-REPT-CD       PIC X(5).
   565         10  WS-SS-LAST-NAME     PIC X(5).
   566         10  WS-SS-INITIAL       PIC X.
   567
   568     05  WS-CRI-REPORT-CODE.
   569         10  FILLER              PIC X(5).
   570         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   571
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  12
* EL050.cbl
   572     05  WS-CRI-LAST-NAME.
   573         10  WS-CRI-NAME-MOVE    PIC X(5).
   574         10  FILLER              PIC X(10).
   575
   576 01  WS-NUM-TABLE                PIC X(26)  VALUE
   577     '12345678012345070923456789'.
   578 01  FILLER REDEFINES WS-NUM-TABLE.
   579     05  WS-NUM OCCURS 26        PIC 9.
   580 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   581 01  V1                          PIC S999 COMP-3.
   582 01  V2                          PIC S999 COMP-3.
   583 01  V3                          PIC S999 COMP-3.
   584 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   585 01  FILLER REDEFINES WS-WORK-VIN.
   586     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   587 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   588 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   589 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   590 01  WS-HEX-WORK.
   591     05  FILLER                  PIC X  VALUE LOW-VALUES.
   592     05  WS-HEX-BYTE             PIC X.
   593 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   594 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   595 01  WS-WORK-HIN-ROW-B.
   596     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   597
   598 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   599 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   600     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   601 01  WS-ROW-D-TABLE.
   602     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   603
   604 01  WS-HIN-TABLE-B.
   605     05  F                       PIC XX VALUE 'A2'.
   606     05  F                       PIC XX VALUE 'B3'.
   607     05  F                       PIC XX VALUE 'C4'.
   608     05  F                       PIC XX VALUE 'D5'.
   609     05  F                       PIC XX VALUE 'E6'.
   610     05  F                       PIC XX VALUE 'F7'.
   611     05  F                       PIC XX VALUE 'G8'.
   612     05  F                       PIC XX VALUE 'H9'.
   613     05  F                       PIC XX VALUE 'I1'.
   614     05  F                       PIC XX VALUE 'J2'.
   615     05  F                       PIC XX VALUE 'K3'.
   616     05  F                       PIC XX VALUE 'L4'.
   617     05  F                       PIC XX VALUE 'M5'.
   618     05  F                       PIC XX VALUE 'N6'.
   619     05  F                       PIC XX VALUE 'O0'.
   620     05  F                       PIC XX VALUE 'P7'.
   621     05  F                       PIC XX VALUE 'Q0'.
   622     05  F                       PIC XX VALUE 'R8'.
   623     05  F                       PIC XX VALUE 'S9'.
   624     05  F                       PIC XX VALUE 'T2'.
   625     05  F                       PIC XX VALUE 'U3'.
   626     05  F                       PIC XX VALUE 'V4'.
   627     05  F                       PIC XX VALUE 'W5'.
   628     05  F                       PIC XX VALUE 'X6'.
   629     05  F                       PIC XX VALUE 'Y7'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  13
* EL050.cbl
   630     05  F                       PIC XX VALUE 'Z8'.
   631 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   632     05  WS-VAL-IN               PIC X.
   633     05  WS-VAL-OUT              PIC 9.
   634 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   635 01  WS-COMPARE-BINARY-DATES.
   636     05  WS-971231                PIC XX VALUE X'92FF'.
   637     05  WS-931231                PIC XX VALUE X'8CFF'.
   638     05  WS-791231                PIC XX VALUE X'77FF'.
   639     05  WS-771001                PIC XX VALUE X'74A1'.
   640     05  WS-820301                PIC XX VALUE X'7B41'.
   641     05  WS-831031                PIC XX VALUE X'7DBF'.
   642     05  WS-831231                PIC XX VALUE X'7DFF'.
   643     05  WS-810831                PIC XX VALUE X'7A7F'.
   644     05  WS-830901                PIC XX VALUE X'7D81'.
   645
   646 01  FILE-ACCESS-IDS.
   647     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   648     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   649     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   650     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   651     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   652     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   653     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   654     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   655     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   656     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   657     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   658     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   659     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   660     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   661     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   662     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   663     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   664 01  DD-IU-SW                    PIC X   VALUE ' '.
   665     88  DD-IU-PRESENT                 VALUE 'Y'.
   666
   667 01  ACCESS-KEYS.
   668     12  ELMSTR-KEY.
   669         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   670         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   671     12  W-CLAIM-KEY.
   672         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   673         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   674
   675     12  ELCNTL-KEY.
   676         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   677         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   678         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   679         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   680
   681     12  ELCERT-KEY.
   682         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   683         16  CERT-CARRIER         PIC X       VALUE SPACE.
   684         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   685         16  CERT-STATE           PIC XX      VALUE SPACES.
   686         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   687         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  14
* EL050.cbl
   688         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   689
   690     12  ELCERT2-KEY.
   691         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   692         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   693
   694     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   695
   696     12  ELCERT-SAVE.
   697         16  FILLER                      PIC XX    VALUE SPACES.
   698
   699         16  WCS-CONTROL-PRIMARY.
   700             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   701             20  WCS-CARRIER             PIC X     VALUE SPACE.
   702             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   703             20  WCS-STATE               PIC XX    VALUE SPACES.
   704             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   705             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   706             20  WCS-CERT-NO.
   707                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   708                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   709
   710         16  CS-CONTROL-BY-NAME.
   711             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   712             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   713             20  CS-INSURED-INITIALS.
   714                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   715                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   716
   717         16  CS-CONTROL-BY-SSN.
   718             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   719             20  CS-SOC-SEC-NO.
   720                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   721                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   722                 24  CS-SSN-LN3.
   723                     28 CS-INSURED-INITIALS-A2   PIC XX
   724                                     VALUE SPACES.
   725                     28 CS-PART-LAST-NAME-A2     PIC X
   726                                     VALUE SPACE.
   727
   728         16  CS-CONTROL-BY-CERT-NO.
   729             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   730             20  CS-CERT-NO-A4           PIC X(11)
   731                                     VALUE SPACES.
   732
   733         16  CS-CONTROL-BY-MEMB.
   734             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   735             20  CS-MEMBER-NO.
   736                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   737                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   738                 24  CS-MEMB-LN4.
   739                     28 CS-INSURED-INITIALS-A5   PIC XX
   740                                      VALUE SPACES.
   741                     28 CS-PART-LAST-NAME-A5     PIC XX
   742                                      VALUE SPACES.
   743
   744         16  FILLER              PIC X(360) VALUE SPACES.
   745
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  15
* EL050.cbl
   746     12  ERACCT-KEY.
   747         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   748         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   749         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   750         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   751         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   752         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   753
   754     12  ERCOMP-KEY.
   755         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   756         16  COMP-CARRIER         PIC X     VALUE SPACES.
   757         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   758         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   759         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   760         16  COMP-TYPE            PIC X     VALUE SPACES.
   761
   762     12  ERLOFC-KEY.
   763         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   764         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   765         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   766         16  LOFC-STATE           PIC XX    VALUE SPACES.
   767         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   768         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   769
   770     12  WS-ELCRTT-KEY.
   771         16  WS-ELCRTT-PRIMARY       PIC X(33).
   772         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   773
   774     12  ERBXRF-KEY.
   775         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   776         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   777         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   778         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   779
   780     12  ERAGTC-KEY.
   781         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   782         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   783         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   784         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   785         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   786         16  AGTC-TYPE            PIC X     VALUE SPACES.
   787
   788     12  ERPLAN-KEY.
   789         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   790         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   791         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   792         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   793         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   794         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   795         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   796         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   797
   798     12  ERFORM-KEY.
   799         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   800         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   801         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   802         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   803
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  16
* EL050.cbl
   804     12  ERREIN-KEY.
   805         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   806         16  REIN-TYPE            PIC X     VALUE SPACES.
   807         16  REIN-TABLE-CO.
   808             20  REIN-CODE-1      PIC X     VALUE SPACE.
   809             20  REIN-CODE-2      PIC X     VALUE SPACE.
   810             20  REIN-CODE-3      PIC X     VALUE SPACE.
   811         16  FILLER               PIC X(3)  VALUE SPACES.
   812
   813     12  ERCTBL-KEY.
   814         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   815         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   816         16  CTBL-CNTRL-2.
   817             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   818             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   819
   820     12  ELCRTO-KEY.
   821         16  ELCRTO-COMPANY-CD       PIC X.
   822         16  ELCRTO-CARRIER          PIC X.
   823         16  ELCRTO-GROUPING         PIC X(6).
   824         16  ELCRTO-STATE            PIC XX.
   825         16  ELCRTO-ACCOUNT          PIC X(10).
   826         16  ELCRTO-CERT-EFF-DT      PIC XX.
   827         16  ELCRTO-CERT-NO.
   828             20  ELCRTO-CERT-PRIME   PIC X(10).
   829             20  ELCRTO-CERT-SFX     PIC X.
   830         16  ELCRTO-RECORD-TYPE      PIC X.
   831         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   832
   833
   834     12  WS-ACCESS.
   835         16  FILLER               PIC XX    VALUE SPACES.
   836         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   837
   838     12  WS-CARR-ACCESS.
   839         16  FILLER               PIC X(3)  VALUE SPACES.
   840         16  WS-CARR              PIC X     VALUE SPACE.
   841*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   842*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   843     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   844         88  WS-DMD-LF-RATING   VALUE 'Y'.
   845         88  WS-DMD-AH-RATING   VALUE 'Y'.
   846         88  WS-DMD-NO-RATING   VALUE 'N'.
   847
   848     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   849         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   850                                         'NJ' 'NL'
   851                                         'PJ' 'PL'
   852                                         'SJ' 'SL'.
   853     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   854         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   855                                         'NI' 'NJ' 'NL' 'NU'
   856                                         'PJ' 'PL' 'PI' 'PU'
   857                                         'SI' 'SJ' 'SL' 'SU'
   858                                         'MX' 'MY' 'MZ'.
   859 01  ERPDEF-KEY-SAVE             PIC X(18).
   860 01  ERPDEF-KEY.
   861     12  ERPDEF-COMPANY-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  17
* EL050.cbl
   862     12  ERPDEF-STATE            PIC XX.
   863     12  ERPDEF-PROD-CD          PIC XXX.
   864     12  F                       PIC X(7).
   865     12  ERPDEF-BEN-TYPE         PIC X.
   866     12  ERPDEF-BEN-CODE         PIC XX.
   867     12  ERPDEF-EXP-DT           PIC XX.
   868
   869 01  ELSTAT-KEY-SAVE             PIC X(20).
   870 01  ELSTAT-KEY.
   871     12  ELSTAT-COMPANY-ID       PIC XXX.
   872     12  ELSTAT-CARRIER          PIC X.
   873     12  ELSTAT-GROUP            PIC X(6).
   874     12  ELSTAT-STATE            PIC XX.
   875     12  ELSTAT-EXP-DT           PIC 9(8).
   876 01  WS-ERROR-VALUES.
   877     12  ER-1570                     PIC S9(4)   VALUE +1570.
   878     12  ER-1571                     PIC S9(4)   VALUE +1571.
   879     12  ER-1575                     PIC S9(4)   VALUE +1575.
   880     12  ER-1891                     PIC S9(4)   VALUE +1891.
   881     12  ER-1892                     PIC S9(4)   VALUE +1892.
   882     12  ER-1893                     PIC S9(4)   VALUE +1893.
   883     12  ER-1894                     PIC S9(4)   VALUE +1894.
   884     12  ER-1895                     PIC S9(4)   VALUE +1895.
   885     12  ER-1896                     PIC S9(4)   VALUE +1896.
   886     12  ER-1897                     PIC S9(4)   VALUE +1897.
   887     12  ER-1898                     PIC S9(4)   VALUE +1898.
   888     12  ER-1899                     PIC S9(4)   VALUE +1899.
   889     12  ER-1900                     PIC S9(4)   VALUE +1900.
   890     12  ER-1901                     PIC S9(4)   VALUE +1901.
   891     12  ER-1902                     PIC S9(4)   VALUE +1902.
   892     12  ER-1903                     PIC S9(4)   VALUE +1903.
   893     12  ER-1904                     PIC S9(4)   VALUE +1904.
   894     12  ER-1905                     PIC S9(4)   VALUE +1905.
   895     12  ER-1906                     PIC S9(4)   VALUE +1906.
   896     12  ER-1907                     PIC S9(4)   VALUE +1907.
   897     12  ER-1909                     PIC S9(4)   VALUE +1909.
   898     12  ER-1910                     PIC S9(4)   VALUE +1910.
   899     12  ER-1911                     PIC S9(4)   VALUE +1911.
   900     12  ER-1912                     PIC S9(4)   VALUE +1912.
   901     12  ER-1913                     PIC S9(4)   VALUE +1913.
   902     12  ER-1914                     PIC S9(4)   VALUE +1914.
   903     12  ER-1915                     PIC S9(4)   VALUE +1915.
   904     12  ER-1916                     PIC S9(4)   VALUE +1916.
   905     12  ER-1917                     PIC S9(4)   VALUE +1917.
   906     12  ER-1918                     PIC S9(4)   VALUE +1918.
   907     12  ER-1919                     PIC S9(4)   VALUE +1919.
   908     12  ER-1920                     PIC S9(4)   VALUE +1920.
   909     12  ER-1921                     PIC S9(4)   VALUE +1921.
   910     12  ER-1922                     PIC S9(4)   VALUE +1922.
   911     12  ER-1923                     PIC S9(4)   VALUE +1923.
   912     12  ER-1924                     PIC S9(4)   VALUE +1924.
   913     12  ER-1925                     PIC S9(4)   VALUE +1925.
   914     12  ER-1926                     PIC S9(4)   VALUE +1926.
   915     12  ER-1927                     PIC S9(4)   VALUE +1927.
   916     12  ER-2393                     PIC S9(4)   VALUE +2393.
   917     12  ER-2600                     PIC S9(4)   VALUE +2600.
   918     12  ER-2601                     PIC S9(4)   VALUE +2601.
   919     12  ER-2602                     PIC S9(4)   VALUE +2602.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  18
* EL050.cbl
   920     12  ER-2603                     PIC S9(4)   VALUE +2603.
   921     12  ER-2604                     PIC S9(4)   VALUE +2604.
   922     12  ER-2605                     PIC S9(4)   VALUE +2605.
   923     12  ER-2606                     PIC S9(4)   VALUE +2606.
   924     12  ER-2607                     PIC S9(4)   VALUE +2607.
   925     12  ER-2608                     PIC S9(4)   VALUE +2608.
   926     12  ER-2609                     PIC S9(4)   VALUE +2609.
   927     12  ER-2610                     PIC S9(4)   VALUE +2610.
   928     12  ER-2611                     PIC S9(4)   VALUE +2611.
   929     12  ER-2612                     PIC S9(4)   VALUE +2612.
   930     12  ER-2613                     PIC S9(4)   VALUE +2613.
   931     12  ER-2614                     PIC S9(4)   VALUE +2614.
   932     12  ER-2615                     PIC S9(4)   VALUE +2615.
   933     12  ER-2616                     PIC S9(4)   VALUE +2616.
   934     12  ER-2617                     PIC S9(4)   VALUE +2617.
   935     12  ER-2618                     PIC S9(4)   VALUE +2618.
   936     12  ER-2619                     PIC S9(4)   VALUE +2619.
   937     12  ER-2620                     PIC S9(4)   VALUE +2620.
   938     12  ER-2621                     PIC S9(4)   VALUE +2621.
   939     12  ER-2622                     PIC S9(4)   VALUE +2622.
   940     12  ER-2623                     PIC S9(4)   VALUE +2623.
   941     12  ER-2624                     PIC S9(4)   VALUE +2624.
   942     12  ER-2625                     PIC S9(4)   VALUE +2625.
   943     12  ER-2626                     PIC S9(4)   VALUE +2626.
   944     12  ER-2627                     PIC S9(4)   VALUE +2627.
   945     12  ER-2628                     PIC S9(4)   VALUE +2628.
   946     12  ER-2629                     PIC S9(4)   VALUE +2629.
   947     12  ER-2630                     PIC S9(4)   VALUE +2630.
   948     12  ER-2631                     PIC S9(4)   VALUE +2631.
   949     12  ER-2632                     PIC S9(4)   VALUE +2632.
   950     12  ER-2633                     PIC S9(4)   VALUE +2633.
   951     12  ER-2634                     PIC S9(4)   VALUE +2634.
   952     12  ER-2635                     PIC S9(4)   VALUE +2635.
   953     12  ER-2636                     PIC S9(4)   VALUE +2636.
   954     12  ER-2637                     PIC S9(4)   VALUE +2637.
   955     12  ER-2638                     PIC S9(4)   VALUE +2638.
   956     12  ER-2639                     PIC S9(4)   VALUE +2639.
   957     12  ER-2640                     PIC S9(4)   VALUE +2640.
   958     12  ER-2641                     PIC S9(4)   VALUE +2641.
   959     12  ER-2642                     PIC S9(4)   VALUE +2642.
   960     12  ER-2643                     PIC S9(4)   VALUE +2643.
   961     12  ER-2644                     PIC S9(4)   VALUE +2644.
   962     12  ER-2645                     PIC S9(4)   VALUE +2645.
   963     12  ER-2646                     PIC S9(4)   VALUE +2646.
   964     12  ER-2647                     PIC S9(4)   VALUE +2647.
   965     12  ER-2648                     PIC S9(4)   VALUE +2648.
   966     12  ER-2649                     PIC S9(4)   VALUE +2649.
   967     12  ER-2650                     PIC S9(4)   VALUE +2650.
   968     12  ER-2651                     PIC S9(4)   VALUE +2651.
   969     12  ER-2652                     PIC S9(4)   VALUE +2652.
   970     12  ER-2653                     PIC S9(4)   VALUE +2653.
   971     12  ER-2654                     PIC S9(4)   VALUE +2654.
   972     12  ER-2655                     PIC S9(4)   VALUE +2655.
   973     12  ER-2656                     PIC S9(4)   VALUE +2656.
   974     12  ER-2657                     PIC S9(4)   VALUE +2657.
   975     12  ER-2658                     PIC S9(4)   VALUE +2658.
   976     12  ER-2659                     PIC S9(4)   VALUE +2659.
   977     12  ER-2660                     PIC S9(4)   VALUE +2660.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  19
* EL050.cbl
   978     12  ER-2661                     PIC S9(4)   VALUE +2661.
   979     12  ER-2662                     PIC S9(4)   VALUE +2662.
   980     12  ER-2663                     PIC S9(4)   VALUE +2663.
   981     12  ER-2664                     PIC S9(4)   VALUE +2664.
   982     12  ER-2665                     PIC S9(4)   VALUE +2665.
   983     12  ER-2666                     PIC S9(4)   VALUE +2666.
   984     12  ER-2667                     PIC S9(4)   VALUE +2667.
   985     12  ER-2668                     PIC S9(4)   VALUE +2668.
   986     12  ER-2669                     PIC S9(4)   VALUE +2669.
   987     12  ER-2670                     PIC S9(4)   VALUE +2670.
   988     12  ER-2671                     PIC S9(4)   VALUE +2671.
   989     12  ER-2672                     PIC S9(4)   VALUE +2672.
   990     12  ER-2673                     PIC S9(4)   VALUE +2673.
   991     12  ER-2674                     PIC S9(4)   VALUE +2674.
   992     12  ER-2675                     PIC S9(4)   VALUE +2675.
   993     12  ER-2676                     PIC S9(4)   VALUE +2676.
   994     12  ER-2677                     PIC S9(4)   VALUE +2677.
   995     12  ER-2678                     PIC S9(4)   VALUE +2678.
   996     12  ER-2679                     PIC S9(4)   VALUE +2679.
   997     12  ER-2680                     PIC S9(4)   VALUE +2680.
   998     12  ER-2681                     PIC S9(4)   VALUE +2681.
   999     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1000     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1001     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1002     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1003     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1004     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1005     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1006     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1007     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1008     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1009     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1010     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1011     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1012     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1013     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1014     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1015     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1016     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1017     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1018     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1019     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1020     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1021     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1022     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1023     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1024     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1025     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1026     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1027     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1028     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1029     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1030     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1031     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1032     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1033     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1034     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1035     12  ER-2728                     PIC S9(4)   VALUE +2728.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  20
* EL050.cbl
  1036     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1037     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1038     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1039     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1040     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1041     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1042     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1043     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1044     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1045     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1046     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1047     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1048     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1049     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1050     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1051     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1052     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1053     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1054     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1055     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1056     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1057     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1058     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1059     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1060     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1061     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1062     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1063     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1064     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1065     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1066     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1067     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1068     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1069     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1070     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1071     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1072     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1073     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1074     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1075     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1076     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1077     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1078     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1079     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1080     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1081     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1082     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1083     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1084     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1085     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1086     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1087     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1088     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1089     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1090     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1091     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1092     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1093     12  ER-2788                     PIC S9(4)   VALUE +2788.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  21
* EL050.cbl
  1094     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1095     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1096     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1097     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1098     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1099     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1100     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1101     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1102     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1103     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1104     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1105     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1106     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1107     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1108     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1109     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1110     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1111     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1112     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1113     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1114     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1115     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1116     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1117     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1118     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1119     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1120     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1121     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1122     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1123     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1124     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1125     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1126     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1127     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1128     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1129     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1130     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1131     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1132     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1133     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1134     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1135     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1136     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1137     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1138     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1139     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1140     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1141     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1142     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1143     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1144     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1145     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1146     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1147     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1148     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1149     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1150     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1151     12  ER-8039                     PIC S9(4)   VALUE +8039.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  22
* EL050.cbl
  1152     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1153     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1154     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1155     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1156     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1157     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1158     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1159     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1160     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1161     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1162     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1163     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1164     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1165     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1166     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1167     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1168     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1169     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1170     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1171     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1172     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1173     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1174     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1175     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1176     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1177     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1178     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1179     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1180     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1181     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1182     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1183     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1184     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1185     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1186     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1187     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1188     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1189     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1190     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1191     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1192     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1193     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1194     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1195     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1196     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1197     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1198     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1199     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1200     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1201     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1202     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1203     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1204     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1205     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1206     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1207     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1208     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1209     12  ER-8313                     PIC S9(4)   VALUE +8313.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  23
* EL050.cbl
  1210     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1211     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1212     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1213     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1214     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1215     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1216     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1217     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1218     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1219******************************************************************
  1220***************   END OF ELC50WS     ****************************
  1221******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  24
* EL050.cbl
  1224 01  WORKING-STORAGE-WORK-AREAS.
  1225     12  WS-RESPONSE             PIC S9(8)  COMP.
  1226         88  WS-RESP-NORMAL           VALUE +00.
  1227         88  WS-RESP-ERROR            VALUE +01.
  1228         88  WS-RESP-NOTFND           VALUE +13.
  1229         88  WS-RESP-DUPREC           VALUE +14.
  1230         88  WS-RESP-ENDFILE          VALUE +20.
  1231     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1232     12  WORK-AREAS.
  1233         16  WK-CONV-GREG.
  1234             24  WCG-CENT             PIC XX.
  1235             24  WCG-REST             PIC X(4).
  1236         16  WORK-GREGORIAN-DATE.
  1237             24  WK-GREG-CENT         PIC XX.
  1238             24  WK-GREG-DATE-YYMMDD.
  1239                 28  WK-GREG-YYMM     PIC X(4).
  1240                 28  WK-GREG-DD       PIC XX.
  1241
  1242         16  WORK-SELECT-DATE.
  1243             24  WK-SELECT-CENT            PIC XX.
  1244             24  WK-SELECT-DATE-YYMMDD.
  1245                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1246                 28  FILLER                PIC XX.
  1247
  1248         16  WK-FORM-NO.
  1249             24  WK-FORM-BANK-ID       PIC X(5).
  1250             24  WK-FORM-UNDRWRTR      PIC X(1).
  1251             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1252
  1253         16  WK-MEMBER-NO.
  1254             24  WK-MEMBER-1-6        PIC X(6).
  1255             24  WK-MEMBER-7-12       PIC X(6).
  1256
  1257         16  WK-FULL-CERT-NO.
  1258             24  WK-CERT-POS-1-2      PIC X(2).
  1259             24  WK-CERT-POS-3        PIC X(1).
  1260             24  WK-CERT-POS-4        PIC X(1).
  1261             24  WK-CERT-POS-5-6      PIC X(2).
  1262             24  WK-CERT-POS-7        PIC X(1).
  1263             24  WK-CERT-POS-8-11     PIC X(4).
  1264
  1265         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1266             88  VALID-RATE-CODE        VALUE 'Y'.
  1267             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1268
  1269         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1270         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1271         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1272         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1273         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1274         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1275         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1276         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1277         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1278         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1279
  1280* DLO001
  1281 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  25
* EL050.cbl
  1282     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1283     12  DMPF-RETURN-CODE          PIC XX.
  1284         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1285         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1286         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1287         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1288         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1289         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1290
  1291* DLO002
  1292 01  WS-DLO-INTERNAL-POLICY-FORM.
  1293     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1294     12  DIPF-RETURN-CODE          PIC XX.
  1295         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1296         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1297         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1298         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1299         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1300         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1301
  1302* DLO003
  1303 01  WS-DLO-VALID-BANK-ID.
  1304     12  DVBI-BANK-ID              PIC X(5).
  1305     12  DVBI-BANK-ID-TYPE         PIC X.
  1306         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1307         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1308         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1309         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1310         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1311     12  DVBI-RETURN-CODE          PIC XX.
  1312         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1313         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1314         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1315         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1316         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1317         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1318         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1319         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1320         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1321
  1322* DLO007
  1323 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1324     12  DCUA-RES-STATE            PIC XX.
  1325     12  DCUA-BEN-TYPE             PIC XX.
  1326     12  DCUA-SYS-IDENT            PIC X.
  1327         88  DCUA-CLAIM                        VALUE 'C'.
  1328         88  DCUA-PREMIUM                      VALUE 'P'.
  1329     12  DCUA-COVERAGE-RULE        PIC X.
  1330     12  DCUA-CLIENT-ID            PIC X(10).
  1331     12  DCUA-EFF-DATE             PIC X(8).
  1332     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1333     12  DCUA-RETURN-CODE          PIC XX.
  1334         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1335     12  DCUA-CERT-NUMBER          PIC X(11).
  1336     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1337     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1338
  1339* DLO011
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  26
* EL050.cbl
  1340 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1341     12  DPRB-RATE-CODE            PIC X(4).
  1342     12  DPRB-COVERAGE-CATEG       PIC X.
  1343     12  DPRB-RETURN-CODE          PIC XX.
  1344         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1345         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1346         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1347         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1348         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1349         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1350         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1351         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1352         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1353     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1354     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1355     12  DPRB-BEN-TYPE             PIC XX.
  1356
  1357* DLO017
  1358 01  WS-DLO-VALID-RATE-CODE.
  1359     12  DVRC-RATE-CODE            PIC X(4).
  1360     12  DVRC-RETURN-CODE          PIC XX.
  1361         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1362         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1363         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1364         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1365         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1366         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1367
  1368* DLO019
  1369 01  WS-DLO-ORIG-COV-CAT.
  1370     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1371     12  DOCC-RETURN-CODE          PIC XX.
  1372     12  DOCC-ORIG-COV-CAT         PIC X.
  1373     12  DOCC-UNDERWITER           PIC XX.
  1374     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1375     12  DOCC-FILLER               PIC X(6).
  1376
  1377* DLO021
  1378 01  WS-DLO-VALID-LOAN-OFFICER.
  1379     12  DVLO-LOAN-OFFICER.
  1380         16  DVLO-BILL-TYPE        PIC X.
  1381         16  DVLO-BILL-SOURCE      PIC X.
  1382         16  DVLO-BATCH-TYPE       PIC X.
  1383     12  DVLO-RETURN-CODE          PIC XX.
  1384         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1385         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1386         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1387         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1388         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1389         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1390
  1391* DLO022
  1392 01  WS-DLO-VALID-STATE-CODE.
  1393     12  DVSC-STATE-CODE           PIC XX.
  1394     12  DVSC-RETURN-CODE          PIC XX.
  1395         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1396
  1397* DLO023
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  27
* EL050.cbl
  1398 01  WS-DLO-VALID-CODE-VALUES.
  1399     12  DVCV-SYSTEM-ID            PIC XX.
  1400         88  DVCV-CLAIMS                       VALUE 'CL'.
  1401         88  DVCV-CREDIT                       VALUE 'CR'.
  1402     12  DVCV-RECORD-TYPE          PIC XX.
  1403         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1404         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1405         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1406         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1407         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1408         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1409         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1410         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1411     12  DVCV-RECORD-KEY           PIC X(6).
  1412     12  DVCV-RETURN-CODE          PIC XX.
  1413         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1414         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1415         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1416         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1417         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1418         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1419         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1420     12  DVCV-CODE-DESC            PIC X(60).
  1421     12  DVCV-GEN-DESC-1           PIC X(20).
  1422     12  DVCV-GEN-DESC-2           PIC X(20).
  1423     12  DVCV-GEN-DESC-3           PIC X(20).
  1424
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  28
* EL050.cbl
  1426*    COPY ERCBXRF.
  1427******************************************************************
  1428*                                                                *
  1429*                                                                *
  1430*                            ERCBXRF                             *
  1431*                                                                *
  1432*   ONLINE CREDIT SYSTEM                                         *
  1433*                                                                *
  1434*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1435*                                                                *
  1436*   FILE TYPE = VSAM,KSDS                                        *
  1437*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1438*                                                                *
  1439*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1440*       ALTERNATE PATH = NONE                                    *
  1441*                                                                *
  1442*   LOG = NO                                                     *
  1443*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1444*                                                                *
  1445******************************************************************
  1446
  1447 01  BANK-CROSS-REFERENCE.
  1448     12  BK-RECORD-ID                PIC XX.
  1449         88  VALID-BK-ID             VALUE 'BK'.
  1450
  1451     12  BK-CONTROL-PRIMARY.
  1452         16  BK-COMPANY-CD           PIC X.
  1453         16  BK-CARRIER              PIC X.
  1454         16  BK-GROUPING             PIC X(6).
  1455         16  BK-BANK-NO              PIC X(10).
  1456
  1457     12  BK-MAINT-INFORMATION.
  1458         16  BK-LAST-MAINT-DT        PIC XX.
  1459         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1460         16  BK-LAST-MAINT-USER      PIC X(4).
  1461         16  FILLER                  PIC X(9).
  1462
  1463     12  FILLER                      PIC X(37).
  1464
  1465     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1466
  1467     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1468                            DEPENDING ON BK-BANK-POINTER-CNT.
  1469         16  BK-AM-ACCOUNT           PIC X(10).
  1470         16  BK-AM-EXP-DT            PIC XX.
  1471         16  BK-AM-EFF-DT            PIC XX.
  1472         16  BK-AM-STATE             PIC XX.
  1473         16  FILLER                  PIC X(20).
  1474
  1475******************************************************************
  1476
  1477*    COPY ERCCOMP.
  1478******************************************************************
  1479*                                                                *
  1480*                                                                *
  1481*                            ERCCOMP                             *
  1482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1483*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  29
* EL050.cbl
  1484*                                                                *
  1485*   ONLINE CREDIT SYSTEM                                         *
  1486*                                                                *
  1487*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1488*                                                                *
  1489*   FILE TYPE = VSAM,KSDS                                        *
  1490*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1491*                                                                *
  1492*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1493*       ALTERNATE PATH = NONE                                    *
  1494*                                                                *
  1495*   LOG = NO                                                     *
  1496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1497*                                                                *
  1498******************************************************************
  1499*                   C H A N G E   L O G
  1500*
  1501* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1502*-----------------------------------------------------------------
  1503*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1504* EFFECTIVE    NUMBER
  1505*-----------------------------------------------------------------
  1506* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1507* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1508* 092205    2005050300006  PEMA  ADD LEASE FEE
  1509* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1510* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1511* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1512* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1513* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1514* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1515******************************************************************
  1516
  1517 01  COMPENSATION-MASTER.
  1518     12  CO-RECORD-ID                          PIC XX.
  1519         88  VALID-CO-ID                          VALUE 'CO'.
  1520
  1521     12  CO-CONTROL-PRIMARY.
  1522         16  CO-COMPANY-CD                     PIC X.
  1523         16  CO-CONTROL.
  1524             20  CO-CTL-1.
  1525                 24  CO-CARR-GROUP.
  1526                     28  CO-CARRIER            PIC X.
  1527                     28  CO-GROUPING.
  1528                         32  CO-GROUP-PREFIX   PIC XXX.
  1529                         32  CO-GROUP-PRIME    PIC XXX.
  1530                 24  CO-RESP-NO.
  1531                     28  CO-RESP-PREFIX        PIC X(4).
  1532                     28  CO-RESP-PRIME         PIC X(6).
  1533             20  CO-CTL-2.
  1534                 24  CO-ACCOUNT.
  1535                     28  CO-ACCT-PREFIX        PIC X(4).
  1536                     28  CO-ACCT-PRIME         PIC X(6).
  1537         16  CO-TYPE                           PIC X.
  1538             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1539             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1540             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1541
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  30
* EL050.cbl
  1542     12  CO-MAINT-INFORMATION.
  1543         16  CO-LAST-MAINT-DT                  PIC XX.
  1544         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1545         16  CO-LAST-MAINT-USER                PIC X(4).
  1546     12  FILLER                                PIC XX.
  1547     12  CO-STMT-TYPE                          PIC XXX.
  1548     12  CO-COMP-TYPE                          PIC X.
  1549         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1550     12  CO-STMT-OWNER                         PIC X(4).
  1551     12  CO-BALANCE-CONTROL                    PIC X.
  1552         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1553         88  CO-NO-BALANCE                        VALUE 'N'.
  1554
  1555     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1556         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1557         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1558         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1559
  1560     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1561         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1562         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1563
  1564     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1565     12  CO-GA-DIRECT-DEP                      PIC X.
  1566     12  CO-FUTURE-SPACE                       PIC X.
  1567         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1568
  1569     12  CO-ACCT-NAME                          PIC X(30).
  1570     12  CO-MAIL-NAME                          PIC X(30).
  1571     12  CO-ADDR-1                             PIC X(30).
  1572     12  CO-ADDR-2                             PIC X(30).
  1573     12  CO-ADDR-3.
  1574         16  CO-ADDR-CITY                      PIC X(27).
  1575         16  CO-ADDR-STATE                     PIC XX.
  1576     12  CO-CSO-1099                           PIC X.
  1577     12  CO-ZIP.
  1578         16  CO-ZIP-PRIME.
  1579             20  CO-ZIP-PRI-1ST                PIC X.
  1580                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1581             20  FILLER                        PIC X(4).
  1582         16  CO-ZIP-PLUS4                      PIC X(4).
  1583     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1584         16  CO-CAN-POSTAL-1                   PIC XXX.
  1585         16  CO-CAN-POSTAL-2                   PIC XXX.
  1586         16  FILLER                            PIC XXX.
  1587     12  CO-SOC-SEC                            PIC X(13).
  1588     12  CO-TELEPHONE.
  1589         16  CO-AREA-CODE                      PIC XXX.
  1590         16  CO-PREFIX                         PIC XXX.
  1591         16  CO-PHONE                          PIC X(4).
  1592
  1593     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1594
  1595     12  CO-AR-BAL-LEVEL                       PIC X.
  1596         88  CO-AR-REF-LVL                        VALUE '1'.
  1597         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1598         88  CO-AR-BILL-LVL                       VALUE '2'.
  1599         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  31
* EL050.cbl
  1600         88  CO-AR-FR-LVL                         VALUE '4'.
  1601
  1602     12  CO-AR-NORMAL-PRINT                    PIC X.
  1603         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1604         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1605
  1606     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1607
  1608     12  CO-AR-REPORTING                       PIC X.
  1609         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1610         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1611
  1612     12  CO-AR-PULL-CHECK                      PIC X.
  1613         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1614         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1615
  1616     12  CO-AR-BALANCE-PRINT                   PIC X.
  1617         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1618
  1619     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1620         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1621         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1622         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1623
  1624     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1625
  1626     12  CO-USER-CODE                          PIC X.
  1627     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1628
  1629******************************************************************
  1630*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1631*    THE LAST MONTH END RUN.
  1632******************************************************************
  1633
  1634     12  CO-LAST-ACTIVITY-DATE.
  1635         16  CO-ACT-YEAR                       PIC 99.
  1636         16  CO-ACT-MONTH                      PIC 99.
  1637         16  CO-ACT-DAY                        PIC 99.
  1638
  1639     12  CO-LAST-STMT-DT.
  1640         16  CO-LAST-STMT-YEAR                 PIC 99.
  1641         16  CO-LAST-STMT-MONTH                PIC 99.
  1642         16  CO-LAST-STMT-DAY                  PIC 99.
  1643
  1644     12  CO-MO-END-TOTALS.
  1645         16  CO-MONTHLY-TOTALS.
  1646             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1647             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1648             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1649             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1650             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1651
  1652         16  CO-AGING-TOTALS.
  1653             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1654             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1655             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1656             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1657
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  32
* EL050.cbl
  1658         16  CO-YTD-TOTALS.
  1659             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1660             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1661
  1662         16  CO-OVER-UNDER-TOTALS.
  1663             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1664             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1665
  1666     12  CO-MISCELLANEOUS-TOTALS.
  1667         16  CO-FICA-TOTALS.
  1668             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1669             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1670
  1671         16  CO-CLAIM-TOTALS.
  1672             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1673             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1674
  1675******************************************************************
  1676*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1677*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1678******************************************************************
  1679
  1680     12  CO-CURRENT-TOTALS.
  1681         16  CO-CURRENT-LAST-STMT-DT.
  1682             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1683             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1684             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1685
  1686         16  CO-CURRENT-MONTHLY-TOTALS.
  1687             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1688             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1689             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1690             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1691             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1692
  1693         16  CO-CURRENT-AGING-TOTALS.
  1694             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1695             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1696             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1697             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1698
  1699         16  CO-CURRENT-YTD-TOTALS.
  1700             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1701             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1702
  1703     12  CO-PAID-COMM-TOTALS.
  1704         16  CO-YTD-PAID-COMMS.
  1705             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1706             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1707
  1708     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1709         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1710         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1711
  1712     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1713         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1714         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1715         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  33
* EL050.cbl
  1716         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1717         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1718         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1719         88  CO-FINAL-LETTER                  VALUE 'F'.
  1720         88  CO-RECONCILING                   VALUE 'R'.
  1721         88  CO-PHONE-CALL                    VALUE 'P'.
  1722         88  CO-LEGAL                         VALUE 'L'.
  1723         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1724         88  CO-WRITE-OFF                     VALUE 'W'.
  1725         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1726
  1727     12  CO-CSR-CODE                       PIC X(4).
  1728
  1729     12  CO-GA-STATUS-INFO.
  1730         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1731         16  CO-GA-TERMINATION-DT          PIC XX.
  1732         16  CO-GA-STATUS-CODE             PIC X.
  1733             88  CO-GA-ACTIVE                 VALUE 'A'.
  1734             88  CO-GA-INACTIVE               VALUE 'I'.
  1735             88  CO-GA-PENDING                VALUE 'P'.
  1736         16  CO-GA-COMMENTS.
  1737             20  CO-GA-COMMENT-1           PIC X(40).
  1738             20  CO-GA-COMMENT-2           PIC X(40).
  1739             20  CO-GA-COMMENT-3           PIC X(40).
  1740             20  CO-GA-COMMENT-4           PIC X(40).
  1741
  1742     12  CO-RPTCD2                         PIC X(10).
  1743     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1744         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1745         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1746
  1747     12  CO-TYPE-AGENT                     PIC X(01).
  1748         88  CO-CORPORATION                   VALUE 'C'.
  1749         88  CO-PARTNERSHIP                   VALUE 'P'.
  1750         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1751         88  CO-TRUST                         VALUE 'T'.
  1752         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1753
  1754     12  CO-FAXNO.
  1755         16  CO-FAX-AREA-CODE                  PIC XXX.
  1756         16  CO-FAX-PREFIX                     PIC XXX.
  1757         16  CO-FAX-PHONE                      PIC X(4).
  1758
  1759     12  CO-BANK-INFORMATION.
  1760         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1761         16  CO-BANK-TRANSIT-NON REDEFINES
  1762             CO-BANK-TRANSIT-NO                PIC 9(8).
  1763
  1764         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1765     12  CO-MISC-DEDUCT-INFO REDEFINES
  1766                  CO-BANK-INFORMATION.
  1767         16  CO-MD-GL-ACCT                     PIC X(10).
  1768         16  CO-MD-DIV                         PIC XX.
  1769         16  CO-MD-CENTER                      PIC X(4).
  1770         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1771         16  CO-CREATE-AP-CHECK                PIC X.
  1772         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1773         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  34
* EL050.cbl
  1774     12  CO-ACH-STATUS                         PIC X.
  1775         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1776         88  CO-ACH-PENDING                        VALUE 'P'.
  1777
  1778     12  CO-BILL-SW                            PIC X.
  1779     12  CO-CONTROL-NAME                       PIC X(30).
  1780     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1781     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1782     12  CO-CLP-STATE                          PIC XX.
  1783     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1784     12  CO-SPP-REFUND-EDIT                    PIC X.
  1785
  1786******************************************************************
  1787
  1788*    COPY ERCAGTC.
  1789******************************************************************
  1790*                                                                *
  1791*                                                                *
  1792*                            ERCAGTC                             *
  1793*                            VMOD=2.001                          *
  1794*                                                                *
  1795*   ONLINE CREDIT SYSTEM                                         *
  1796*                                                                *
  1797*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1798*                                                                *
  1799*   FILE TYPE = VSAM,KSDS                                        *
  1800*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1801*                                                                *
  1802*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1803*       ALTERNATE PATH = NONE                                    *
  1804*                                                                *
  1805*   LOG = NO                                                     *
  1806*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1807*                                                                *
  1808******************************************************************
  1809*                   C H A N G E   L O G
  1810*
  1811* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1812*-----------------------------------------------------------------
  1813*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1814* EFFECTIVE    NUMBER
  1815*-----------------------------------------------------------------
  1816* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1817* 111004                         NEW FILE AND COPYBOOK
  1818* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1819******************************************************************
  1820 01  AGENT-COMMISSIONS.
  1821     12  AG-RECORD-ID                          PIC XX.
  1822         88  VALID-CO-ID                          VALUE 'AG'.
  1823     12  AG-CONTROL-PRIMARY.
  1824         16  AG-COMPANY-CD                     PIC X.
  1825         16  AG-CONTROL.
  1826             20  AG-CTL-1.
  1827                 24  AG-CARR-GROUP.
  1828                     28  AG-CARRIER            PIC X.
  1829                     28  AG-GROUPING           PIC X(6).
  1830                 24  AG-BANK                   PIC X(10).
  1831             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  35
* EL050.cbl
  1832                 24  AG-EXP-DT                 PIC XX.
  1833         16  AG-TYPE                           PIC X.
  1834             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1835             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1836     12  AG-MAINT-INFORMATION.
  1837         16  AG-LAST-MAINT-DT                  PIC XX.
  1838         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1839         16  AG-LAST-MAINT-USER                PIC X(4).
  1840         16  FILLER                            PIC X(10).
  1841     12  AG-EFF-DT                             PIC XX.
  1842     12  AG-COMM-STRUCTURE.
  1843         16  AG-AGT-COMMS OCCURS 10.
  1844             20  AG-AGT                PIC X(10).
  1845             20  AG-COM-TYP            PIC X.
  1846             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1847             20  AG-RECALC-LV-INDIC    PIC X.
  1848             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1849             20  AG-LRCALC-LV-INDIC    PIC X.
  1850             20  FILLER                PIC X(05).
  1851     12  FILLER                  PIC X(145).
  1852******************************************************************
  1853*    COPY ERCRESS.
  1854******************************************************************
  1855*                                                                *
  1856*                            ERCRESS                             *
  1857*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1858*                            VMOD=2.002                          *
  1859*                                                                *
  1860*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1861*                                                                *
  1862*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1863*   VSAM RESIDENT STATE TAX MASTER                              *
  1864*                                                                *
  1865*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1866*                                                                *
  1867*   FILE TYPE = VSAM,KSDS                                        *
  1868*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1869*                                                                *
  1870*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1871*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1872*                                                                *
  1873*   LOG = NO                                                     *
  1874*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1875*                                                                *
  1876*                                                                *
  1877******************************************************************
  1878
  1879 01  RESIDENT-STATE-TAX-MASTER.
  1880
  1881     10  ERRESS-PRIMARY-KEY.
  1882         15  RES-COMPANY-CD        PIC X.
  1883         15  RES-RESIDENT-STATE    PIC XX.
  1884         15  RES-COVERAGE-CATEGORY PIC X.
  1885         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1886*                                      YYYYMMDD
  1887*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1888
  1889     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  36
* EL050.cbl
  1890
  1891         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1892         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1893         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1894         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1895
  1896     10 RES-RECALC-SW              PIC   X.
  1897         88 RECALC                VALUE 'Y'.
  1898         88 NO-RECALC             VALUE 'N'.
  1899     10  RES-MAINT-BY              PIC X(4).
  1900     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1901     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1902*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  37
* EL050.cbl
  1904*    COPY ERCRESC.
  1905******************************************************************
  1906*                                                                *
  1907*                            ERCRESC                             *
  1908*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1909*                            VMOD=2.003                          *
  1910*                                                                *
  1911*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1912*                                                                *
  1913*   FILE TYPE = VSAM,KSDS                                        *
  1914*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1915*                                                                *
  1916*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1917*       ALTERNATE PATH1 = NONE                                   *
  1918*                                                                *
  1919*   LOG = NO                                                     *
  1920*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1921*                                                                *
  1922******************************************************************
  1923
  1924 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1925
  1926     10  ERRESC-RECORD-KEY.
  1927         15  RESC-COMPANY-CD           PIC   X.
  1928         15  RESC-CARRIER              PIC   X.
  1929         15  RESC-GROUP                PIC   X(6).
  1930         15  RESC-STATE                PIC   XX.
  1931         15  RESC-ACCOUNT              PIC   X(10).
  1932         15  RESC-AGENT                PIC   X(10).
  1933         15  RESC-RESIDENT-STATE       PIC   XX.
  1934         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1935*                                           YYYYMMDD
  1936     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1937
  1938     10  RESC-COMM-RECORD-DATA.
  1939         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1940             20 RESC-COVERAGE-CAT      PIC    X.
  1941             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1942             20 RESC-COMMISSION-TAB REDEFINES
  1943                RESC-COMMISSION-PER    PIC  XXX.
  1944
  1945     10  RESC-MAINT-BY                 PIC X(4).
  1946     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1947     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1948*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  38
* EL050.cbl
  1950*    COPY ERCPLAN.
  1951******************************************************************
  1952*                                                                *
  1953*                                                                *
  1954*                            ERCPLAN                             *
  1955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1956*                            VMOD=2.003                          *
  1957*                                                                *
  1958*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1959*                                                                *
  1960*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1961*   PLAN MASTER                                                  *
  1962*                                                                *
  1963*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1964*                                                                *
  1965*   FILE TYPE = VSAM,KSDS                                        *
  1966*   RECORD SIZE = 420   RECFORM = FIX                            *
  1967*                                                                *
  1968*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1969*       ALTERNATE PATH1 = N/A                                    *
  1970*                                                                *
  1971*   LOG = NO                                                     *
  1972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1973*                                                                *
  1974*                                                                *
  1975******************************************************************
  1976
  1977 01  PLAN-MASTER.
  1978     12  PL-RECORD-ID                      PIC XX.
  1979         88  VALID-PL-ID                      VALUE 'PL'.
  1980
  1981     12  PL-CONTROL-PRIMARY.
  1982         16  PL-COMPANY-CD                 PIC X.
  1983         16  PL-MSTR-CNTRL.
  1984             20  PL-CONTROL-A.
  1985                 24  PL-CARRIER            PIC X.
  1986                 24  PL-GROUPING           PIC X(6).
  1987                 24  PL-STATE              PIC XX.
  1988                 24  PL-ACCOUNT            PIC X(10).
  1989             20  PL-BENEFIT-TYPE           PIC X.
  1990             20  PL-BENEFIT-CODE           PIC XX.
  1991             20  PL-REVISION-NO            PIC X(3).
  1992
  1993     12  PL-CONTROL-BY-VAR-GRP.
  1994         16  PL-COMPANY-CD-A1              PIC X.
  1995         16  PL-VG-CARRIER                 PIC X.
  1996         16  PL-VG-GROUPING                PIC X(6).
  1997         16  PL-VG-STATE                   PIC XX.
  1998         16  PL-VG-ACCOUNT                 PIC X(10).
  1999         16  PL-BENEFIT-TYPE-A1            PIC X.
  2000         16  PL-BENEFIT-CODE-A1            PIC XX.
  2001         16  PL-REVISION-NO-A1             PIC 999.
  2002
  2003     12  PL-MAINT-INFORMATION.
  2004         16  PL-LAST-MAINT-DT              PIC XX.
  2005         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2006         16  PL-LAST-MAINT-USER            PIC X(4).
  2007         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  39
* EL050.cbl
  2008
  2009     12  PL-LIABILITY-LIMITS.
  2010         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2011         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2012             20  PL-LM-AGE                 PIC S99        COMP-3.
  2013             20  PL-LM-DUR                 PIC S999       COMP-3.
  2014             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2015             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2016
  2017     12  FILLER                            PIC X(30).
  2018
  2019     12  PL-GL-ACCOUNT-NOS.
  2020         16  PL-PREMIUM-GL                 PIC X(8).
  2021         16  PL-COMM-GL                    PIC X(8).
  2022         16  PL-CLAIM-GL                   PIC X(8).
  2023     12  FILLER                            PIC X(24).
  2024     12  PL-TOLERANCES.
  2025         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2026         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2027         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2028         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2029         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2030         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2031     12  PL-OVER-SHORT.
  2032         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2033         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2034     12  FILLER                            PIC X(24).
  2035     12  PLAN-MISC.
  2036         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2037         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2038         16  PL-IG                         PIC X.
  2039         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2040         16  PL-POLICY-FORM                PIC X(12).
  2041         16  PL-EDIT-FOR-FORM              PIC X(01).
  2042         16  PL-DEV-CODE                   PIC XXX.
  2043         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2044         16  PL-CALC-METHOD                PIC X.
  2045         16  PL-BENEFIT-GROUP              PIC X(05).
  2046         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2047
  2048         16  FILLER                        PIC X(99).
  2049******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  40
* EL050.cbl
  2051*    COPY ELCCERT.
  2052******************************************************************
  2053*                                                                *
  2054*                            ELCCERT.                            *
  2055*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2056*                            VMOD=2.013                          *
  2057*                                                                *
  2058*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2059*                                                                *
  2060*   FILE TYPE = VSAM,KSDS                                        *
  2061*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2062*                                                                *
  2063*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2064*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2065*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2066*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2067*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2068*                                                                *
  2069*   LOG = YES                                                    *
  2070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2071******************************************************************
  2072*                   C H A N G E   L O G
  2073*
  2074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2075*-----------------------------------------------------------------
  2076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2077* EFFECTIVE    NUMBER
  2078*-----------------------------------------------------------------
  2079* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2080* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2081* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2082* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2083* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2084* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2085* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2086* 032612  CR2011110200001  PEMA  AHL CHANGES
  2087******************************************************************
  2088
  2089 01  CERTIFICATE-MASTER.
  2090     12  CM-RECORD-ID                      PIC XX.
  2091         88  VALID-CM-ID                      VALUE 'CM'.
  2092
  2093     12  CM-CONTROL-PRIMARY.
  2094         16  CM-COMPANY-CD                 PIC X.
  2095         16  CM-CARRIER                    PIC X.
  2096         16  CM-GROUPING.
  2097             20  CM-GROUPING-PREFIX        PIC X(3).
  2098             20  CM-GROUPING-PRIME         PIC X(3).
  2099         16  CM-STATE                      PIC XX.
  2100         16  CM-ACCOUNT.
  2101             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2102             20  CM-ACCOUNT-PRIME          PIC X(6).
  2103         16  CM-CERT-EFF-DT                PIC XX.
  2104         16  CM-CERT-NO.
  2105             20  CM-CERT-PRIME             PIC X(10).
  2106             20  CM-CERT-SFX               PIC X.
  2107
  2108     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  41
* EL050.cbl
  2109         16  CM-COMPANY-CD-A1              PIC X.
  2110         16  CM-INSURED-LAST-NAME          PIC X(15).
  2111         16  CM-INSURED-INITIALS.
  2112             20  CM-INSURED-INITIAL1       PIC X.
  2113             20  CM-INSURED-INITIAL2       PIC X.
  2114
  2115     12  CM-CONTROL-BY-SSN.
  2116         16  CM-COMPANY-CD-A2              PIC X.
  2117         16  CM-SOC-SEC-NO.
  2118             20  CM-SSN-STATE              PIC XX.
  2119             20  CM-SSN-ACCOUNT            PIC X(6).
  2120             20  CM-SSN-LN3.
  2121                 25  CM-INSURED-INITIALS-A2.
  2122                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2123                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2124                 25 CM-PART-LAST-NAME-A2         PIC X.
  2125
  2126     12  CM-CONTROL-BY-CERT-NO.
  2127         16  CM-COMPANY-CD-A4              PIC X.
  2128         16  CM-CERT-NO-A4                 PIC X(11).
  2129
  2130     12  CM-CONTROL-BY-MEMB.
  2131         16  CM-COMPANY-CD-A5              PIC X.
  2132         16  CM-MEMBER-NO.
  2133             20  CM-MEMB-STATE             PIC XX.
  2134             20  CM-MEMB-ACCOUNT           PIC X(6).
  2135             20  CM-MEMB-LN4.
  2136                 25  CM-INSURED-INITIALS-A5.
  2137                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2138                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2139                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2140
  2141     12  CM-INSURED-PROFILE-DATA.
  2142         16  CM-INSURED-FIRST-NAME.
  2143             20  CM-INSURED-1ST-INIT       PIC X.
  2144             20  FILLER                    PIC X(9).
  2145         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2146         16  CM-INSURED-SEX                PIC X.
  2147             88  CM-SEX-MALE                  VALUE 'M'.
  2148             88  CM-SEX-FEMAL                 VALUE 'F'.
  2149         16  CM-INSURED-JOINT-AGE          PIC 99.
  2150         16  CM-JOINT-INSURED-NAME.
  2151             20  CM-JT-LAST-NAME           PIC X(15).
  2152             20  CM-JT-FIRST-NAME.
  2153                 24  CM-JT-1ST-INIT        PIC X.
  2154                 24  FILLER                PIC X(9).
  2155             20  CM-JT-INITIAL             PIC X.
  2156
  2157     12  CM-LIFE-DATA.
  2158         16  CM-LF-BENEFIT-CD              PIC XX.
  2159         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2160         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2161         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2162         16  CM-LF-DEV-CODE                PIC XXX.
  2163         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2164         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2165         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2166         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  42
* EL050.cbl
  2167         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2168         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2169         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2170         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2171         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2172         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2173         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2174         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2175         16  FILLER                        PIC XX.
  2176
  2177     12  CM-AH-DATA.
  2178         16  CM-AH-BENEFIT-CD              PIC XX.
  2179         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2180         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2181         16  CM-AH-DEV-CODE                PIC XXX.
  2182         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2183         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2184         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2185         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2186         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2187         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2188         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2189         16  CM-AH-PAID-THRU-DT            PIC XX.
  2190             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2191         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2192         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2193         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2194         16  FILLER                        PIC X.
  2195
  2196     12  CM-LOAN-INFORMATION.
  2197         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2198         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2199                                           PIC S9(5)V99  COMP-3.
  2200         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2201         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2202         16  CM-PAY-FREQUENCY              PIC S99.
  2203         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2204         16  CM-RATE-CLASS                 PIC XX.
  2205         16  CM-BENEFICIARY                PIC X(25).
  2206         16  CM-POLICY-FORM-NO             PIC X(12).
  2207         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2208         16  CM-LAST-ADD-ON-DT             PIC XX.
  2209         16  CM-DEDUCTIBLE-AMOUNTS.
  2210             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2211             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2212         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2213             20  CM-RESIDENT-STATE         PIC XX.
  2214             20  CM-RATE-CODE              PIC X(4).
  2215             20  FILLER                    PIC XX.
  2216         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2217             20  CM-LOAN-OFFICER           PIC X(5).
  2218             20  FILLER                    PIC XXX.
  2219         16  CM-CSR-CODE                   PIC XXX.
  2220         16  CM-UNDERWRITING-CODE          PIC X.
  2221             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2222         16  CM-POST-CARD-IND              PIC X.
  2223         16  CM-NH-INTERFACE-SW            PIC X.
  2224         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  43
* EL050.cbl
  2225             88  CM-SING-PRM                  VALUE '1'.
  2226             88  CM-O-B-COVERAGE              VALUE '2'.
  2227             88  CM-OPEN-END                  VALUE '3'.
  2228         16  CM-IND-GRP-TYPE               PIC X.
  2229             88  CM-INDIVIDUAL                VALUE 'I'.
  2230             88  CM-GROUP                     VALUE 'G'.
  2231         16  CM-SKIP-CODE                  PIC X.
  2232             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2233             88  SKIP-JULY                    VALUE '1'.
  2234             88  SKIP-AUGUST                  VALUE '2'.
  2235             88  SKIP-SEPTEMBER               VALUE '3'.
  2236             88  SKIP-JULY-AUG                VALUE '4'.
  2237             88  SKIP-AUG-SEPT                VALUE '5'.
  2238             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2239             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2240             88  SKIP-JUNE                    VALUE '8'.
  2241             88  SKIP-JUNE-JULY               VALUE '9'.
  2242             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2243             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2244         16  CM-PAYMENT-MODE               PIC X.
  2245             88  PAY-MONTHLY                  VALUE SPACE.
  2246             88  PAY-WEEKLY                   VALUE '1'.
  2247             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2248             88  PAY-BI-WEEKLY                VALUE '3'.
  2249             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2250         16  CM-LOAN-NUMBER                PIC X(8).
  2251         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2252         16  CM-OLD-LOF                    PIC XXX.
  2253*        16  CM-LOAN-OFFICER               PIC XXX.
  2254         16  CM-REIN-TABLE                 PIC XXX.
  2255         16  CM-SPECIAL-REIN-CODE          PIC X.
  2256         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2257         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2258         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2259
  2260     12  CM-STATUS-DATA.
  2261         16  CM-ENTRY-STATUS               PIC X.
  2262         16  CM-ENTRY-DT                   PIC XX.
  2263
  2264         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2265         16  CM-LF-CANCEL-DT               PIC XX.
  2266         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2267
  2268         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2269         16  CM-LF-DEATH-DT                PIC XX.
  2270         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2271
  2272         16  CM-LF-CURRENT-STATUS          PIC X.
  2273             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2274                                                'M' '4' '5' '9'.
  2275             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2276             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2277             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2278             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2279             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2280             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2281             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2282             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  44
* EL050.cbl
  2283             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2284             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2285             88  CM-LF-DECLINED               VALUE 'D'.
  2286             88  CM-LF-VOIDED                 VALUE 'V'.
  2287
  2288         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2289         16  CM-AH-CANCEL-DT               PIC XX.
  2290         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2291
  2292         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2293         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2294         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2295
  2296         16  CM-AH-CURRENT-STATUS          PIC X.
  2297             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2298                                                'M' '4' '5' '9'.
  2299             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2300             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2301             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2302             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2303             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2304             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2305             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2306             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2307             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2308             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2309             88  CM-AH-DECLINED               VALUE 'D'.
  2310             88  CM-AH-VOIDED                 VALUE 'V'.
  2311
  2312         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2313             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2314             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2315             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2316         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2317
  2318         16  CM-ENTRY-BATCH                PIC X(6).
  2319         16  CM-LF-EXIT-BATCH              PIC X(6).
  2320         16  CM-AH-EXIT-BATCH              PIC X(6).
  2321         16  CM-LAST-MONTH-END             PIC XX.
  2322
  2323     12  CM-NOTE-SW                        PIC X.
  2324         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2325         88  CERT-NOTES-PRESENT               VALUE '1'.
  2326         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2327         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2328         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2329         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2330         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2331         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2332     12  CM-COMP-EXCP-SW                   PIC X.
  2333         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2334         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2335     12  CM-INSURED-ADDRESS-SW             PIC X.
  2336         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2337         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2338
  2339*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2340     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  45
* EL050.cbl
  2341     12  FILLER                            PIC X.
  2342
  2343*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2344     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2345     12  FILLER                            PIC X.
  2346*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2347     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2348
  2349     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2350         88  CERT-ADDED-BATCH                 VALUE ' '.
  2351         88  CERT-ADDED-ONLINE                VALUE '1'.
  2352         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2353         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2354         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2355     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2356         88  CERT-AS-LOADED                   VALUE ' '.
  2357         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2358         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2359         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2360         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2361         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2362         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2363         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2364
  2365     12  CM-ACCOUNT-COMM-PCTS.
  2366         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2367         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2368
  2369     12  CM-USER-FIELD                     PIC X.
  2370     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2371     12  CM-CLP-STATE                      PIC XX.
  2372     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2373     12  CM-USER-RESERVED                  PIC XXX.
  2374     12  FILLER REDEFINES CM-USER-RESERVED.
  2375         16  CM-AH-CLASS-CD                PIC XX.
  2376         16  F                             PIC X.
  2377******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  46
* EL050.cbl
  2379*    COPY ERCMAIL.
  2380******************************************************************
  2381*                                                                *
  2382*                                                                *
  2383*                            ERCMAIL                             *
  2384*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2385*                            VMOD=2.003                          *
  2386*                                                                *
  2387*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2388*                                                                *
  2389*   FILE TYPE = VSAM,KSDS                                        *
  2390*   RECORD SIZE = 374   RECFORM = FIX                            *
  2391*                                                                *
  2392*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2393*   ALTERNATE PATH    = NOT USED                                 *
  2394*                                                                *
  2395*   LOG = YES                                                    *
  2396*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2397******************************************************************
  2398*                   C H A N G E   L O G
  2399*
  2400* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2401*-----------------------------------------------------------------
  2402*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2403* EFFECTIVE    NUMBER
  2404*-----------------------------------------------------------------
  2405* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2406* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2407* 111108                   PEMA  ADD CRED BENE ADDR2
  2408******************************************************************
  2409
  2410 01  MAILING-DATA.
  2411     12  MA-RECORD-ID                      PIC XX.
  2412         88  VALID-MA-ID                       VALUE 'MA'.
  2413
  2414     12  MA-CONTROL-PRIMARY.
  2415         16  MA-COMPANY-CD                 PIC X.
  2416         16  MA-CARRIER                    PIC X.
  2417         16  MA-GROUPING.
  2418             20  MA-GROUPING-PREFIX        PIC XXX.
  2419             20  MA-GROUPING-PRIME         PIC XXX.
  2420         16  MA-STATE                      PIC XX.
  2421         16  MA-ACCOUNT.
  2422             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2423             20  MA-ACCOUNT-PRIME          PIC X(6).
  2424         16  MA-CERT-EFF-DT                PIC XX.
  2425         16  MA-CERT-NO.
  2426             20  MA-CERT-PRIME             PIC X(10).
  2427             20  MA-CERT-SFX               PIC X.
  2428
  2429     12  FILLER                            PIC XX.
  2430
  2431     12  MA-ACCESS-CONTROL.
  2432         16  MA-SOURCE-SYSTEM              PIC XX.
  2433             88  MA-FROM-CREDIT                VALUE 'CR'.
  2434             88  MA-FROM-VSI                   VALUE 'VS'.
  2435             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2436             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  47
* EL050.cbl
  2437         16  MA-RECORD-ADD-DT              PIC XX.
  2438         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2439         16  MA-LAST-MAINT-DT              PIC XX.
  2440         16  MA-LAST-MAINT-BY              PIC XXXX.
  2441         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2442
  2443     12  MA-PROFILE-INFO.
  2444         16  MA-QUALIFY-CODE-1             PIC XX.
  2445         16  MA-QUALIFY-CODE-2             PIC XX.
  2446         16  MA-QUALIFY-CODE-3             PIC XX.
  2447         16  MA-QUALIFY-CODE-4             PIC XX.
  2448         16  MA-QUALIFY-CODE-5             PIC XX.
  2449
  2450         16  MA-INSURED-LAST-NAME          PIC X(15).
  2451         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2452         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2453         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2454         16  MA-INSURED-BIRTH-DT           PIC XX.
  2455         16  MA-INSURED-SEX                PIC X.
  2456             88  MA-SEX-MALE                   VALUE 'M'.
  2457             88  MA-SEX-FEMALE                 VALUE 'F'.
  2458         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2459
  2460         16  MA-ADDRESS-CORRECTED          PIC X.
  2461         16  MA-JOINT-BIRTH-DT             PIC XX.
  2462*        16  FILLER                        PIC X(12).
  2463
  2464         16  MA-ADDRESS-LINE-1             PIC X(30).
  2465         16  MA-ADDRESS-LINE-2             PIC X(30).
  2466         16  MA-CITY-STATE.
  2467             20  MA-CITY                   PIC X(28).
  2468             20  MA-ADDR-STATE             PIC XX.
  2469         16  MA-ZIP.
  2470             20  MA-ZIP-CODE.
  2471                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2472                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2473                 24  FILLER                PIC X(4).
  2474             20  MA-ZIP-PLUS4              PIC X(4).
  2475         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2476             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2477             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2478             20  FILLER                    PIC X(3).
  2479
  2480         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2481
  2482         16  FILLER                        PIC XXX.
  2483*        16  FILLER                        PIC X(10).
  2484
  2485     12  MA-CRED-BENE-INFO.
  2486         16  MA-CRED-BENE-NAME                 PIC X(25).
  2487         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2488         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2489         16  MA-CRED-BENE-CTYST.
  2490             20  MA-CRED-BENE-CITY             PIC X(28).
  2491             20  MA-CRED-BENE-STATE            PIC XX.
  2492         16  MA-CRED-BENE-ZIP.
  2493             20  MA-CB-ZIP-CODE.
  2494                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  48
* EL050.cbl
  2495                     88  MA-CB-CANADIAN-POST-CODE
  2496                                           VALUE 'A' THRU 'Z'.
  2497                 24  FILLER                    PIC X(4).
  2498             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2499         16  MA-CB-CANADIAN-POSTAL-CODE
  2500                            REDEFINES MA-CRED-BENE-ZIP.
  2501             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2502             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2503             20  FILLER                        PIC X(3).
  2504     12  MA-POST-CARD-MAIL-DATA.
  2505         16  MA-MAIL-DATA OCCURS 7.
  2506             20  MA-MAIL-TYPE              PIC X.
  2507                 88  MA-12MO-MAILING           VALUE '1'.
  2508                 88  MA-EXP-MAILING            VALUE '2'.
  2509             20  MA-MAIL-STATUS            PIC X.
  2510                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2511                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2512                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2513             20  MA-MAIL-DATE              PIC XX.
  2514     12  FILLER                            PIC XX.
  2515     12  FILLER                            PIC XX.
  2516*    12  FILLER                            PIC X(30).
  2517******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  49
* EL050.cbl
  2519*    COPY ERCPNDM.
  2520******************************************************************
  2521*                                                                *
  2522*                                                                *
  2523*                            ERCPNDM                             *
  2524*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2525*                            VMOD=2.003                          *
  2526*                                                                *
  2527*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2528*                                                                *
  2529*   FILE TYPE = VSAM,KSDS                                        *
  2530*   RECORD SIZE = 374   RECFORM = FIX                            *
  2531*                                                                *
  2532*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2533*   ALTERNATE PATH    = NOT USED                                 *
  2534*                                                                *
  2535*   LOG = YES                                                    *
  2536*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2537******************************************************************
  2538*                   C H A N G E   L O G
  2539*
  2540* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2541*-----------------------------------------------------------------
  2542*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2543* EFFECTIVE    NUMBER
  2544*-----------------------------------------------------------------
  2545* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2546* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2547* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2548******************************************************************
  2549
  2550 01  PENDING-MAILING-DATA.
  2551     12  PM-RECORD-ID                      PIC XX.
  2552         88  VALID-MA-ID                       VALUE 'PM'.
  2553
  2554     12  PM-CONTROL-PRIMARY.
  2555         16  PM-COMPANY-CD                 PIC X.
  2556         16  PM-ENTRY-BATCH                PIC X(6).
  2557         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2558         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2559
  2560     12  FILLER                            PIC X(14).
  2561
  2562     12  PM-ACCESS-CONTROL.
  2563         16  PM-SOURCE-SYSTEM              PIC XX.
  2564             88  PM-FROM-CREDIT                VALUE 'CR'.
  2565             88  PM-FROM-VSI                   VALUE 'VS'.
  2566             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2567             88  PM-FROM-OTHER                 VALUE 'OT'.
  2568         16  PM-RECORD-ADD-DT              PIC XX.
  2569         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2570         16  PM-LAST-MAINT-DT              PIC XX.
  2571         16  PM-LAST-MAINT-BY              PIC XXXX.
  2572         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2573
  2574     12  PM-PROFILE-INFO.
  2575         16  PM-QUALIFY-CODE-1             PIC XX.
  2576         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  50
* EL050.cbl
  2577         16  PM-QUALIFY-CODE-3             PIC XX.
  2578         16  PM-QUALIFY-CODE-4             PIC XX.
  2579         16  PM-QUALIFY-CODE-5             PIC XX.
  2580
  2581         16  PM-INSURED-LAST-NAME          PIC X(15).
  2582         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2583         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2584         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2585         16  PM-INSURED-BIRTH-DT           PIC XX.
  2586         16  PM-INSURED-SEX                PIC X.
  2587             88  PM-SEX-MALE                   VALUE 'M'.
  2588             88  PM-SEX-FEMALE                 VALUE 'F'.
  2589         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2590
  2591         16  PM-ADDRESS-CORRECTED          PIC X.
  2592         16  PM-JOINT-BIRTH-DT             PIC XX.
  2593*        16  FILLER                        PIC X(12).
  2594
  2595         16  PM-ADDRESS-LINE-1             PIC X(30).
  2596         16  PM-ADDRESS-LINE-2             PIC X(30).
  2597         16  PM-CITY-STATE.
  2598             20  PM-CITY                   PIC X(28).
  2599             20  PM-STATE                  PIC XX.
  2600         16  PM-ZIP.
  2601             20  PM-ZIP-CODE.
  2602                 24  PM-ZIP-1              PIC X.
  2603                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2604                 24  FILLER                PIC X(4).
  2605             20  PM-ZIP-PLUS4              PIC X(4).
  2606         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2607             20  PM-CAN-POST1              PIC XXX.
  2608             20  PM-CAN-POST2              PIC XXX.
  2609             20  FILLER                    PIC XXX.
  2610
  2611         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2612
  2613         16  FILLER                        PIC X(03).
  2614
  2615     12  PM-CRED-BENE-INFO.
  2616         16  PM-CRED-BENE-NAME             PIC X(25).
  2617         16  PM-CRED-BENE-ADDR             PIC X(30).
  2618         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2619         16  PM-CRED-BENE-CTYST.
  2620             20  PM-CRED-BENE-CITY         PIC X(28).
  2621             20  PM-CRED-BENE-STATE        PIC XX.
  2622         16  PM-CRED-BENE-ZIP.
  2623             20  PM-CB-ZIP-CODE.
  2624                 24  PM-CB-ZIP-1           PIC X.
  2625                     88  PM-CB-CANADIAN-POST-CODE
  2626                                  VALUE 'A' THRU 'Z'.
  2627                 24  FILLER                PIC X(4).
  2628             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2629         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2630             20  PM-CB-CAN-POST1           PIC XXX.
  2631             20  PM-CB-CAN-POST2           PIC XXX.
  2632             20  FILLER                    PIC XXX.
  2633     12  PM-POST-CARD-MAIL-DATA.
  2634         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  51
* EL050.cbl
  2635             20  PM-MAIL-TYPE              PIC X.
  2636                 88  PM-12MO-MAILING           VALUE '1'.
  2637                 88  PM-EXP-MAILING            VALUE '2'.
  2638             20  PM-MAIL-STATUS            PIC X.
  2639                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2640                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2641                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2642             20  PM-MAIL-DATE              PIC XX.
  2643     12  FILLER                            PIC XX.
  2644     12  FILLER                            PIC X(12).
  2645*    12  FILLER                            PIC X(30).
  2646
  2647******************************************************************
  2648*                                COPY ERCLOFC.
  2649******************************************************************
  2650*                                                                *
  2651*                                                                *
  2652*                            ERCLOFC                             *
  2653*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2654*                            VMOD=2.003                          *
  2655*                                                                *
  2656*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2657*                                                                *
  2658*   FILE TYPE = VSAM,KSDS                                        *
  2659*   RECORD SIZE = 670   RECFORM = FIX                            *
  2660*                                                                *
  2661*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2662*                                                                *
  2663*   LOG = YES                                                    *
  2664*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2665*                                                                *
  2666******************************************************************
  2667
  2668 01  LOAN-OFFICER-MASTER.
  2669     12  LO-RECORD-ID                PIC XX.
  2670         88  VALID-LO-ID                VALUE 'LO'.
  2671
  2672     12  LO-CONTROL-PRIMARY.
  2673         16  LO-COMPANY-CD           PIC X.
  2674         16  LO-CARRIER              PIC X.
  2675         16  LO-GROUPING.
  2676             20  LO-GROUPING-PREFIX  PIC XXX.
  2677             20  LO-GROUPING-PRIME   PIC XXX.
  2678         16  LO-STATE                PIC XX.
  2679         16  LO-ACCOUNT.
  2680             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2681             20  LO-ACCOUNT-PRIME    PIC X(6).
  2682         16  LO-OFFICER-CODE         PIC X(5).
  2683
  2684     12  LO-OFFICER-NAME             PIC X(30).
  2685
  2686     12  LO-LAST-MAINT-DT            PIC XX.
  2687     12  LO-LAST-USER                PIC X(4).
  2688     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2689
  2690     12  LO-COMP-CONTROL             PIC X.
  2691             88  LO-SHOW-COMP           VALUE 'Y'.
  2692             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  52
* EL050.cbl
  2693     12  LO-DETAIL-CONTROL           PIC X.
  2694             88  LO-PRINT-DETAIL        VALUE 'D'.
  2695             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2696
  2697     12  LO-SV-CARRIER               PIC X.
  2698     12  LO-SV-GROUPING              PIC X(6).
  2699     12  LO-SV-STATE                 PIC XX.
  2700
  2701     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2702     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2703
  2704     12  LO-OFFICER-INFO.
  2705         16  FILLER OCCURS 12 TIMES.
  2706             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2707             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2708             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2709             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2710             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2711             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2712             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2713             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2714     12  FILLER                      PIC X(198).
  2715******************************************************************
  2716*                                COPY ERCPDEF.
  2717******************************************************************
  2718*                                                                *
  2719*                                                                *
  2720*                            ERCPDEF.                            *
  2721*                                                                *
  2722*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2723*                                                                *
  2724*    FILE TYPE = VSAM,KSDS                                       *
  2725*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2726*                                                                *
  2727*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2728*                                                                *
  2729*    LOG = YES                                                   *
  2730*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2731******************************************************************
  2732 01  PRODUCT-MASTER.
  2733    12  PD-RECORD-ID                 PIC X(02).
  2734        88  VALID-PD-ID                  VALUE 'PD'.
  2735    12  PD-CONTROL-PRIMARY.
  2736        16  PD-COMPANY-CD            PIC X.
  2737        16  PD-STATE                 PIC XX.
  2738        16  PD-PRODUCT-CD            PIC XXX.
  2739        16  PD-FILLER                PIC X(7).
  2740        16  PD-BEN-TYPE              PIC X.
  2741        16  PD-BEN-CODE              PIC XX.
  2742        16  PD-PROD-EXP-DT           PIC XX.
  2743    12  FILLER                       PIC X(50).
  2744    12  PD-PRODUCT-DATA OCCURS 8.
  2745        16  PD-PROD-CODE             PIC X.
  2746            88  PD-PROD-LIFE           VALUE 'L'.
  2747            88  PD-PROD-PROP           VALUE 'P'.
  2748            88  PD-PROD-AH             VALUE 'A'.
  2749            88  PD-PROD-IU             VALUE 'I'.
  2750            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  53
* EL050.cbl
  2751        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2752        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2753        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2754        16  PD-MAX-TERM              PIC S999        COMP-3.
  2755        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2756        16  FILLER                   PIC X.
  2757        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2758        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2759        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2760        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2761        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2762        16  PD-REC-CRIT-PERIOD       PIC X.
  2763        16  PD-RTW-MOS               PIC 99.
  2764        16  FILLER                   PIC X(5).
  2765    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2766    12  PD-TERM-LIMITS OCCURS 15.
  2767        16  PD-LOW-TERM              PIC S999        COMP-3.
  2768        16  PD-HI-TERM               PIC S999        COMP-3.
  2769*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2770    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2771        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2772        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2773    12  PD-EARN-FACTORS.
  2774        16  FILLER OCCURS 15.
  2775            20  FILLER OCCURS 15.
  2776                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2777    12  PD-PRODUCT-DESC              PIC X(80).
  2778    12  PD-TRUNCATED                 PIC X.
  2779    12  FILLER                       PIC X(59).
  2780    12  PD-MAINT-INFORMATION.
  2781        16  PD-LAST-MAINT-DT         PIC X(02).
  2782        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2783        16  PD-LAST-MAINT-BY         PIC X(04).
  2784*                                COPY ELCSTATE.
  2785******************************************************************
  2786*                                                                *
  2787*                                                                *
  2788*                            ELCSTATE.                           *
  2789*                                                                *
  2790*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2791*                                                                *
  2792*   FILE TYPE = VSAM,KSDS                                        *
  2793*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2794*                                                                *
  2795*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2796*       ALTERNATE INDEX = NONE                                   *
  2797*                                                                *
  2798*   LOG = YES                                                    *
  2799*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2800******************************************************************
  2801*                   C H A N G E   L O G
  2802*
  2803* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2804*-----------------------------------------------------------------
  2805*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2806* EFFECTIVE    NUMBER
  2807*-----------------------------------------------------------------
  2808* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  54
* EL050.cbl
  2809******************************************************************
  2810*
  2811 01  STATE-FILE.
  2812     12  SF-RECORD-ID                       PIC XX.
  2813         88  VALID-CF-ID                        VALUE 'SF'.
  2814     12  SF-CONTROL-PRIMARY.
  2815         16  SF-COMPANY-ID                  PIC XXX.
  2816         16  SF-CARRIER-CODE                PIC X.
  2817         16  SF-GROUPING                    PIC X(6).
  2818         16  SF-STATE-CODE                  PIC XX.
  2819         16  SF-EXPIRE-DATE                 PIC 9(8).
  2820****************************************************************
  2821*             STATE CONTROLS
  2822****************************************************************
  2823     12  SF-LAST-MAINT-DT                   PIC XX.
  2824     12  SF-LAST-MAINT-BY                   PIC X(4).
  2825     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2826     12  SF-STATE-RT-CONTROLS.
  2827         16  SF-ST-RT-CALC                  PIC X.
  2828     12  SF-ST-TAX-CONTROLS.
  2829         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2830         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2831         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2832     12  SF-ST-REFUND-OPTIONS.
  2833         16  SF-ST-RF-LR-CALC               PIC X.
  2834         16  SF-ST-RF-LL-CALC               PIC X.
  2835         16  SF-ST-RF-LN-CALC               PIC X.
  2836         16  SF-ST-RF-AH-CALC               PIC X.
  2837         16  SF-ST-RF-CP-CALC               PIC X.
  2838     12  SF-ST-UNEARN-PREM-OPTIONS.
  2839         16  SF-ST-LUEP-R78                 PIC X.
  2840         16  SF-ST-LUEP-PRO                 PIC X.
  2841         16  SF-ST-LUEP-ST                  PIC X.
  2842         16  SF-ST-LUEP-DOM                 PIC X.
  2843         16  SF-ST-AUEP-R78                 PIC X.
  2844         16  SF-ST-AUEP-PRO                 PIC X.
  2845         16  SF-ST-AUEP-ST                  PIC X.
  2846         16  SF-ST-AUEP-DOM                 PIC X.
  2847         16  SF-ST-CUEP-R78                 PIC X.
  2848         16  SF-ST-CUEP-PRO                 PIC X.
  2849         16  SF-ST-CUEP-ST                  PIC X.
  2850         16  SF-ST-CUEP-DOM                 PIC X.
  2851     12  SF-ST-EARN-PREM-OPTIONS.
  2852         16  SF-ST-LEP-R78                  PIC X.
  2853         16  SF-ST-LEP-PRO                  PIC X.
  2854         16  SF-ST-LEP-ST                   PIC X.
  2855         16  SF-ST-LEP-DOM                  PIC X.
  2856         16  SF-ST-AEP-R78                  PIC X.
  2857         16  SF-ST-AEP-PRO                  PIC X.
  2858         16  SF-ST-AEP-ST                   PIC X.
  2859         16  SF-ST-AEP-DOM                  PIC X.
  2860         16  SF-ST-CEP-R78                  PIC X.
  2861         16  SF-ST-CEP-PRO                  PIC X.
  2862         16  SF-ST-CEP-ST                   PIC X.
  2863         16  SF-ST-CEP-DOM                  PIC X.
  2864     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  55
* EL050.cbl
  2866*    COPY ELCCRTT.
  2867******************************************************************
  2868*                                                                *
  2869*                            ELCCRTT.                            *
  2870*                                                                *
  2871*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2872*                                                                *
  2873*   FILE TYPE = VSAM,KSDS                                        *
  2874*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2875*                                                                *
  2876*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2877*                                                                *
  2878*   LOG = YES                                                    *
  2879*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2880******************************************************************
  2881*                   C H A N G E   L O G
  2882*
  2883* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2884*-----------------------------------------------------------------
  2885*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2886* EFFECTIVE    NUMBER
  2887*-----------------------------------------------------------------
  2888* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2889* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2890* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2891* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2892* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2893******************************************************************
  2894
  2895 01  CERTIFICATE-TRAILERS.
  2896     12  CS-RECORD-ID                      PIC XX.
  2897         88  VALID-CS-ID                      VALUE 'CS'.
  2898
  2899     12  CS-CONTROL-PRIMARY.
  2900         16  CS-COMPANY-CD                 PIC X.
  2901         16  CS-CARRIER                    PIC X.
  2902         16  CS-GROUPING                   PIC X(6).
  2903         16  CS-STATE                      PIC XX.
  2904         16  CS-ACCOUNT                    PIC X(10).
  2905         16  CS-CERT-EFF-DT                PIC XX.
  2906         16  CS-CERT-NO.
  2907             20  CS-CERT-PRIME             PIC X(10).
  2908             20  CS-CERT-SFX               PIC X.
  2909         16  CS-TRAILER-TYPE               PIC X.
  2910             88  COMM-TRLR           VALUE 'A'.
  2911             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2912             88  CERT-DATA-TRLR      VALUE 'C'.
  2913
  2914     12  CS-DATA-AREA                      PIC X(516).
  2915
  2916     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2917         16  CS-BANK-COMMISSION-AREA.
  2918             20  CS-BANK-COMMS       OCCURS 10.
  2919                 24  CS-AGT                PIC X(10).
  2920                 24  CS-COM-TYP            PIC X.
  2921                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2922                 24  CS-RECALC-LV-INDIC    PIC X.
  2923                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  56
* EL050.cbl
  2924         16  FILLER                        PIC X(256).
  2925
  2926     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2927****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2928****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2929         16  CS-MB-CLAIM-DATA OCCURS 2.
  2930             20  FILLER OCCURS 10.
  2931                 24  CS-CLAIM-TYPE         PIC X.
  2932                     88  CS-AH-CLM           VALUE 'A'.
  2933                     88  CS-IU-CLM           VALUE 'I'.
  2934                     88  CS-GP-CLM           VALUE 'G'.
  2935                     88  CS-LF-CLM           VALUE 'L'.
  2936                     88  CS-PR-CLM           VALUE 'P'.
  2937                 24  CS-BANK               PIC S999 COMP-3.
  2938                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2939                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2940                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2941         16  FILLER                        PIC X(216).
  2942     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2943         16  CS-VIN-NUMBER                 PIC X(17).
  2944         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2945         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2946         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2947         16  FILLER                        PIC X(496).
  2948******************************************************************
  2949*    COPY ELCCRTO.
  2950******************************************************************
  2951*                                                                *
  2952*                            ELCCRTO.                            *
  2953*                                                                *
  2954*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2955*                                                                *
  2956*   FILE TYPE = VSAM,KSDS                                        *
  2957*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2958*                                                                *
  2959*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2960*                                                                *
  2961*   LOG = YES                                                    *
  2962*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2963******************************************************************
  2964*                   C H A N G E   L O G
  2965*
  2966* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2967*-----------------------------------------------------------------
  2968*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2969* EFFECTIVE    NUMBER
  2970*-----------------------------------------------------------------
  2971* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2972* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2973* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2974* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2975* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2976******************************************************************
  2977 01  ORIGINAL-CERTIFICATE.
  2978     12  OC-RECORD-ID                      PIC XX.
  2979         88  VALID-OC-ID                      VALUE 'OC'.
  2980     12  OC-CONTROL-PRIMARY.
  2981         16  OC-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  57
* EL050.cbl
  2982         16  OC-CARRIER                    PIC X.
  2983         16  OC-GROUPING                   PIC X(6).
  2984         16  OC-STATE                      PIC XX.
  2985         16  OC-ACCOUNT                    PIC X(10).
  2986         16  OC-CERT-EFF-DT                PIC XX.
  2987         16  OC-CERT-NO.
  2988             20  OC-CERT-PRIME             PIC X(10).
  2989             20  OC-CERT-SFX               PIC X.
  2990         16  OC-RECORD-TYPE                PIC X.
  2991         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2992     12  OC-LAST-MAINT-DT                  PIC XX.
  2993     12  OC-LAST-MAINT-BY                  PIC X(4).
  2994     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2995     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2996     12  FILLER                            PIC X(49).
  2997     12  OC-ORIG-REC.
  2998         16  OC-INS-LAST-NAME              PIC X(15).
  2999         16  OC-INS-FIRST-NAME             PIC X(10).
  3000         16  OC-INS-MIDDLE-INIT            PIC X.
  3001         16  OC-INS-AGE                    PIC S999     COMP-3.
  3002         16  OC-JNT-LAST-NAME              PIC X(15).
  3003         16  OC-JNT-FIRST-NAME             PIC X(10).
  3004         16  OC-JNT-MIDDLE-INIT            PIC X.
  3005         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3006         16  OC-LF-BENCD                   PIC XX.
  3007         16  OC-LF-TERM                    PIC S999      COMP-3.
  3008         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3009         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3010         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3011         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3012         16  OC-LF-EXP-DT                  PIC XX.
  3013         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3014         16  OC-LF-CANCEL-DT               PIC XX.
  3015         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3016         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3017         16  OC-AH-BENCD                   PIC XX.
  3018         16  OC-AH-TERM                    PIC S999      COMP-3.
  3019         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3020         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3021         16  OC-AH-EXP-DT                  PIC XX.
  3022         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3023         16  OC-AH-CP                      PIC 99.
  3024         16  OC-AH-CANCEL-DT               PIC XX.
  3025         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3026         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3027         16  OC-CRED-BENE-NAME             PIC X(25).
  3028         16  OC-1ST-PMT-DT                 PIC XX.
  3029         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3030         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3031         16  OC-ISSUE-TRAN-IND             PIC X.
  3032         16  OC-CANCEL-TRAN-IND            PIC X.
  3033         16  FILLER                        PIC X(211).
  3034
  3035     12  FILLER                            PIC X(50).
  3036******************************************************************
  3037
  3038*    COPY ELCDATE.
  3039******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  58
* EL050.cbl
  3040*                                                                *
  3041*                                                                *
  3042*                            ELCDATE.                            *
  3043*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3044*                            VMOD=2.003
  3045*                                                                *
  3046*                                                                *
  3047*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3048*                 LENGTH = 200                                   *
  3049******************************************************************
  3050
  3051 01  DATE-CONVERSION-DATA.
  3052     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3053     12  DC-OPTION-CODE                PIC X.
  3054         88  BIN-TO-GREG                VALUE ' '.
  3055         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3056         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3057         88  YMD-GREG-TO-BIN            VALUE '3'.
  3058         88  MDY-GREG-TO-BIN            VALUE '4'.
  3059         88  JULIAN-TO-BIN              VALUE '5'.
  3060         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3061         88  FIND-CENTURY               VALUE '7'.
  3062         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3063         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3064         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3065         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3066         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3067         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3068         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3069         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3070         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3071         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3072         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3073         88  BIN-3-TO-GREG              VALUE 'I'.
  3074         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3075         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3076         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3077         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3078         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3079         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3080         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3081         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3082         88  THREE-CHARACTER-BIN
  3083                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3084         88  GREGORIAN-TO-BIN
  3085                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3086         88  BIN-TO-GREGORIAN
  3087                  VALUES ' ' '1' 'I' '8' 'G'.
  3088         88  JULIAN-TO-BINARY
  3089                  VALUES '5' 'C' 'E' 'F'.
  3090     12  DC-ERROR-CODE                 PIC X.
  3091         88  NO-CONVERSION-ERROR        VALUE ' '.
  3092         88  DATE-CONVERSION-ERROR
  3093                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3094         88  DATE-IS-ZERO               VALUE '1'.
  3095         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3096         88  DATE-IS-INVALID            VALUE '3'.
  3097         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  59
* EL050.cbl
  3098         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3099         88  DATE-INVALID-OPTION        VALUE '9'.
  3100         88  INVALID-CENTURY            VALUE 'A'.
  3101         88  ONLY-CENTURY               VALUE 'B'.
  3102         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3103         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3104     12  DC-END-OF-MONTH               PIC X.
  3105         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3106     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3107         88  USE-NORMAL-PROCESS         VALUE ' '.
  3108         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3109         88  ADJUST-UP-100-YRS          VALUE '2'.
  3110     12  FILLER                        PIC X.
  3111     12  DC-CONVERSION-DATES.
  3112         16  DC-BIN-DATE-1             PIC XX.
  3113         16  DC-BIN-DATE-2             PIC XX.
  3114         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3115         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3116                       DC-GREG-DATE-1-EDIT.
  3117             20  DC-EDIT1-MONTH        PIC 99.
  3118             20  SLASH1-1              PIC X.
  3119             20  DC-EDIT1-DAY          PIC 99.
  3120             20  SLASH1-2              PIC X.
  3121             20  DC-EDIT1-YEAR         PIC 99.
  3122         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3123         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3124                     DC-GREG-DATE-2-EDIT.
  3125             20  DC-EDIT2-MONTH        PIC 99.
  3126             20  SLASH2-1              PIC X.
  3127             20  DC-EDIT2-DAY          PIC 99.
  3128             20  SLASH2-2              PIC X.
  3129             20  DC-EDIT2-YEAR         PIC 99.
  3130         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3131         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3132                     DC-GREG-DATE-1-YMD.
  3133             20  DC-YMD-YEAR           PIC 99.
  3134             20  DC-YMD-MONTH          PIC 99.
  3135             20  DC-YMD-DAY            PIC 99.
  3136         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3137         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3138                      DC-GREG-DATE-1-MDY.
  3139             20  DC-MDY-MONTH          PIC 99.
  3140             20  DC-MDY-DAY            PIC 99.
  3141             20  DC-MDY-YEAR           PIC 99.
  3142         16  DC-GREG-DATE-1-ALPHA.
  3143             20  DC-ALPHA-MONTH        PIC X(10).
  3144             20  DC-ALPHA-DAY          PIC 99.
  3145             20  FILLER                PIC XX.
  3146             20  DC-ALPHA-CENTURY.
  3147                 24 DC-ALPHA-CEN-N     PIC 99.
  3148             20  DC-ALPHA-YEAR         PIC 99.
  3149         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3150         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3151         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3152         16  DC-JULIAN-DATE            PIC 9(05).
  3153         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3154                                       PIC 9(05).
  3155         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  60
* EL050.cbl
  3156             20  DC-JULIAN-YEAR        PIC 99.
  3157             20  DC-JULIAN-DAYS        PIC 999.
  3158         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3159         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3160         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3161     12  DATE-CONVERSION-VARIBLES.
  3162         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3163         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3164             20  FILLER                PIC 9(3).
  3165             20  HOLD-CEN-1-CCYY.
  3166                 24  HOLD-CEN-1-CC     PIC 99.
  3167                 24  HOLD-CEN-1-YY     PIC 99.
  3168             20  HOLD-CEN-1-MO         PIC 99.
  3169             20  HOLD-CEN-1-DA         PIC 99.
  3170         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3171             20  HOLD-CEN-1-R-MO       PIC 99.
  3172             20  HOLD-CEN-1-R-DA       PIC 99.
  3173             20  HOLD-CEN-1-R-CCYY.
  3174                 24  HOLD-CEN-1-R-CC   PIC 99.
  3175                 24  HOLD-CEN-1-R-YY   PIC 99.
  3176             20  FILLER                PIC 9(3).
  3177         16  HOLD-CENTURY-1-X.
  3178             20  FILLER                PIC X(3)  VALUE SPACES.
  3179             20  HOLD-CEN-1-X-CCYY.
  3180                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3181                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3182             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3183             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3184         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3185             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3186             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3187             20  HOLD-CEN-1-R-X-CCYY.
  3188                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3189                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3190             20  FILLER                PIC XXX.
  3191         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3192         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3193         16  DC-JULIAN-DATE-1          PIC 9(07).
  3194         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3195             20  DC-JULIAN-1-CCYY.
  3196                 24  DC-JULIAN-1-CC    PIC 99.
  3197                 24  DC-JULIAN-1-YR    PIC 99.
  3198             20  DC-JULIAN-DA-1        PIC 999.
  3199         16  DC-JULIAN-DATE-2          PIC 9(07).
  3200         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3201             20  DC-JULIAN-2-CCYY.
  3202                 24  DC-JULIAN-2-CC    PIC 99.
  3203                 24  DC-JULIAN-2-YR    PIC 99.
  3204             20  DC-JULIAN-DA-2        PIC 999.
  3205         16  DC-GREG-DATE-A-EDIT.
  3206             20  DC-EDITA-MONTH        PIC 99.
  3207             20  SLASHA-1              PIC X VALUE '/'.
  3208             20  DC-EDITA-DAY          PIC 99.
  3209             20  SLASHA-2              PIC X VALUE '/'.
  3210             20  DC-EDITA-CCYY.
  3211                 24  DC-EDITA-CENT     PIC 99.
  3212                 24  DC-EDITA-YEAR     PIC 99.
  3213         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  61
* EL050.cbl
  3214             20  DC-EDITB-MONTH        PIC 99.
  3215             20  SLASHB-1              PIC X VALUE '/'.
  3216             20  DC-EDITB-DAY          PIC 99.
  3217             20  SLASHB-2              PIC X VALUE '/'.
  3218             20  DC-EDITB-CCYY.
  3219                 24  DC-EDITB-CENT     PIC 99.
  3220                 24  DC-EDITB-YEAR     PIC 99.
  3221         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3222         16  DC-GREG-DATE-CYMD-R REDEFINES
  3223                              DC-GREG-DATE-CYMD.
  3224             20  DC-CYMD-CEN           PIC 99.
  3225             20  DC-CYMD-YEAR          PIC 99.
  3226             20  DC-CYMD-MONTH         PIC 99.
  3227             20  DC-CYMD-DAY           PIC 99.
  3228         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3229         16  DC-GREG-DATE-MDCY-R REDEFINES
  3230                              DC-GREG-DATE-MDCY.
  3231             20  DC-MDCY-MONTH         PIC 99.
  3232             20  DC-MDCY-DAY           PIC 99.
  3233             20  DC-MDCY-CEN           PIC 99.
  3234             20  DC-MDCY-YEAR          PIC 99.
  3235    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3236        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3237    12  DC-EL310-DATE                  PIC X(21).
  3238    12  FILLER                         PIC X(28).
  3239
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  62
* EL050.cbl
  3241*    COPY ELCCALC.
  3242******************************************************************
  3243*                                                                *
  3244*                           ELCCALC.                            *
  3245*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3246*                            VMOD=2.025                          *
  3247*                                                                *
  3248*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3249*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3250*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3251*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3252*                                                                *
  3253*  PASSED TO ELRTRM                                              *
  3254*  -----------------                                             *
  3255*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3256*  ORIGINAL TERM                                                 *
  3257*  BEGINNING DATE                                                *
  3258*  ENDING DATE                                                   *
  3259*  COMPANY I.D.                                                  *
  3260*  ACCOUNT MASTER USER FIELD                                     *
  3261*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3262*  FREE LOOK DAYS                                                *
  3263*                                                                *
  3264*  RETURNED FROM ELRTRM                                          *
  3265*  ---------------------                                         *
  3266*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3267*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3268*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3269*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3270*----------------------------------------------------------------*
  3271*  PASSED TO ELRAMT                                              *
  3272*  ----------------                                              *
  3273*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3274*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3275*  ORIGINAL AMOUNT                                               *
  3276*  ALTERNATE BENEFIT (BALLON)                                    *
  3277*  A.P.R. - NET PAY ONLY                                         *
  3278*  METHOD
  3279*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3280*  COMPANY I.D.                                                  *
  3281*  BENEFIT TYPE                                                  *
  3282*                                                                *
  3283*  RETURNED FROM ELRAMT                                          *
  3284*  --------------------                                          *
  3285*  REMAINING AMOUNT 1 - CURRENT                                  *
  3286*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3287*  REMAINING AMOUNT FACTOR
  3288*----------------------------------------------------------------*
  3289*  PASSED TO ELRESV                                              *
  3290*  -----------------                                             *
  3291*  CERTIFICATE EFFECTIVE DATE                                    *
  3292*  VALUATION DATE                                                *
  3293*  PAID THRU DATE                                                *
  3294*  BENEFIT                                                       *
  3295*  INCURRED DATE                                                 *
  3296*  REPORTED DATE                                                 *
  3297*  ISSUE AGE                                                     *
  3298*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  63
* EL050.cbl
  3299*  CDT PERCENT                                                   *
  3300*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3301* *CLAIM TYPE (LIFE, A/H)                                        *
  3302* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3303* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3304*                                                                *
  3305*  RETURNED FROM ELRESV                                          *
  3306*  --------------------                                          *
  3307*  CDT TABLE USED                                                *
  3308*  CDT FACTOR USED                                               *
  3309*  PAY TO CURRENT RESERVE                                        *
  3310*  I.B.N.R. - A/H ONLY                                           *
  3311*  FUTURE (ACCRUED) AH ONLY                                      *
  3312*----------------------------------------------------------------*
  3313*  PASSED TO ELRATE                                              *
  3314*  ----------------                                              *
  3315*  CERT ISSUE DATE                                               *
  3316*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3317*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3318*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3319*  STATE CODE (CLIENT DEFINED)                                   *
  3320*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3321*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3322*  DEVIATION CODE                                                *
  3323*  ISSUE AGE                                                     *
  3324*  ORIGINAL BENEFIT AMOUNT                                       *
  3325*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3326*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3327*  BENEFIT KIND (LIFE OR A/H)                                    *
  3328*  A.P.R.                                                        *
  3329*  METHOD
  3330*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3331*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3332*  COMPANY I.D. (3 CHARACTER)                                    *
  3333*  BENEFIT CODE                                                  *
  3334*  BENEFIT OVERRIDE CODE                                         *
  3335*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3336*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3337*  JOINT INDICATOR (CSL ONLY)                                    *
  3338*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3339*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3340*                                                                *
  3341*  RETURNED FROM ELRATE                                          *
  3342*  --------------------                                          *
  3343*  CALCULATED PREMIUM                                            *
  3344*  PREMIUM RATE                                                  *
  3345*  MORTALITY CODE                                                *
  3346*  MAX ATTAINED AGE                                              *
  3347*  MAX AGE                                                       *
  3348*  MAX TERM                                                      *
  3349*  MAX MONTHLY BENEFIT                                           *
  3350*  MAX TOTAL BENIFIT                                             *
  3351*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3352*----------------------------------------------------------------*
  3353*  PASSED TO ELRFND                                              *
  3354*  ----------------                                              *
  3355*  CERT ISSUE DATE                                               *
  3356*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  64
* EL050.cbl
  3357*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3358*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3359*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3360*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3361*  STATE CODE (CLIENT DEFINED)                                   *
  3362*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3363*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3364*  DEVIATION CODE                                                *
  3365*  ISSUE AGE                                                     *
  3366*  ORIGINAL BENEFIT AMOUNT                                       *
  3367*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3368*  PROCESS TYPE (CANCEL)                                         *
  3369*  BENEFIT KIND (LIFE OR A/H)                                    *
  3370*  A.P.R.                                                        *
  3371*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3372*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3373*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3374*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3375*  COMPANY I.D. (3 CHARACTER)                                    *
  3376*  BENEFIT CODE                                                  *
  3377*  BENEFIT OVERRIDE CODE                                         *
  3378*                                                                *
  3379*  RETURNED FROM ELRFND                                          *
  3380*  --------------------                                          *
  3381*  CALCULATED REFUND                                             *
  3382*----------------------------------------------------------------*
  3383*  PASSED TO ELEARN                                              *
  3384*  ----------------                                              *
  3385*  CERT ISSUE DATE                                               *
  3386*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3387*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3388*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3389*  STATE CODE (CLIENT DEFINED)                                   *
  3390*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3391*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3392*  DEVIATION CODE                                                *
  3393*  ISSUE AGE                                                     *
  3394*  ORIGINAL BENEFIT AMOUNT                                       *
  3395*  BENEFIT KIND (LIFE OR A/H)                                    *
  3396*  A.P.R.                                                        *
  3397*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3398*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3399*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3400*  COMPANY I.D. (3 CHARACTER)                                    *
  3401*  BENEFIT CODE                                                  *
  3402*  BENEFIT OVERRIDE CODE                                         *
  3403*                                                                *
  3404*  RETURNED FROM ELEARN                                          *
  3405*  --------------------                                          *
  3406*  INDICATED  EARNINGS                                           *
  3407*----------------------------------------------------------------*
  3408*                 LENGTH = 450                                   *
  3409*                                                                *
  3410******************************************************************
  3411******************************************************************
  3412*                   C H A N G E   L O G
  3413*
  3414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  65
* EL050.cbl
  3415*-----------------------------------------------------------------
  3416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3417* EFFECTIVE    NUMBER
  3418*-----------------------------------------------------------------
  3419* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3420* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3421* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3422* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3423* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3424* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3425* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3426* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3427* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3428******************************************************************
  3429
  3430 01  CALCULATION-PASS-AREA.
  3431     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3432                                     COMP.
  3433
  3434     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3435       88  NO-CP-ERROR                             VALUE ZERO.
  3436       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3437                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3438       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3439       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3440       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3441       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3442       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3443       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3444       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3445       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3446       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3447       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3448       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3449       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3450       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3451       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3452       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3453       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3454       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3455
  3456     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3457       88  NO-CP-ERROR-2                           VALUE ZERO.
  3458***********************  INPUT AREAS ****************************
  3459
  3460     12  CP-CALCULATION-AREA.
  3461         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3462         16  CP-CERT-EFF-DT        PIC XX.
  3463         16  CP-VALUATION-DT       PIC XX.
  3464         16  CP-PAID-THRU-DT       PIC XX.
  3465         16  CP-BENEFIT-TYPE       PIC X.
  3466           88  CP-AH                               VALUE 'A' 'D'
  3467                                                   'I' 'U'.
  3468           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3469           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3470         16  CP-INCURRED-DT        PIC XX.
  3471         16  CP-REPORTED-DT        PIC XX.
  3472         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  66
* EL050.cbl
  3473         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3474         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3475                                     COMP-3.
  3476         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3477                                     COMP-3.
  3478         16  CP-CDT-METHOD         PIC X.
  3479           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3480           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3481           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3482         16  CP-CLAIM-TYPE         PIC X.
  3483           88  CP-AH-CLAIM                         VALUE 'A'.
  3484           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3485         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3486                                     COMP-3.
  3487         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3488                                     COMP-3.
  3489         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3490                                     COMP-3.
  3491         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3492                                     COMP-3.
  3493         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3494                                     COMP-3.
  3495         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3496                                     COMP-3.
  3497         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3498                                     COMP-3.
  3499         16  CP-REM-TERM-METHOD    PIC X.
  3500           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3501           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3502           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3503           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3504           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3505           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3506           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3507         16  CP-EARNING-METHOD     PIC X.
  3508           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3509           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3510           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3511           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3512           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3513           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3514           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3515           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3516           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3517           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3518           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3519           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3520           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3521           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3522         16  CP-PROCESS-TYPE       PIC X.
  3523           88  CP-CLAIM                            VALUE '1'.
  3524           88  CP-CANCEL                           VALUE '2'.
  3525           88  CP-ISSUE                            VALUE '3'.
  3526         16  CP-SPECIAL-CALC-CD    PIC X.
  3527           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3528           88  CP-1-MTH-INTEREST               VALUE ' '.
  3529           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3530           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  67
* EL050.cbl
  3531           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3532           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3533           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3534           88  CP-FARM-PLAN                    VALUE 'F'.
  3535           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3536           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3537           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3538           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3539           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3540           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3541           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3542           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3543           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3544           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3545                                                     'W' 'X'.
  3546           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3547           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3548           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3549           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3550           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3551           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3552           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3553           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3554           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3555           88  CP-CSL-METH-1                   VALUE '5'.
  3556           88  CP-CSL-METH-2                   VALUE '6'.
  3557           88  CP-CSL-METH-3                   VALUE '7'.
  3558           88  CP-CSL-METH-4                   VALUE '8'.
  3559
  3560         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3561                                     COMP-3.
  3562         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3563         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3564         16  CP-STATE              PIC XX          VALUE SPACE.
  3565         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3566         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3567           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3568               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3569         16  CP-R78-OPTION         PIC X.
  3570           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3571           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3572
  3573         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3574         16  CP-IBNR-RESERVE-SW    PIC X.
  3575         16  CP-CLAIM-STATUS       PIC X.
  3576         16  CP-RATE-FILE          PIC X.
  3577         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3578                                     COMP-3.
  3579
  3580         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3581         16  CP-AH-OVERRIDE-CODE   PIC X.
  3582
  3583         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3586                                   PIC S9(5)V99 COMP-3.
  3587         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3588                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  68
* EL050.cbl
  3589         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3594                                  PIC S9(7)V99 COMP-3.
  3595
  3596         16  CP-PAID-FROM-DATE     PIC X(02).
  3597         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3598         16  CP-EXT-DAYS-CALC      PIC X.
  3599           88  CP-EXT-NO-CHG                   VALUE ' '.
  3600           88  CP-EXT-CHG-LF                   VALUE '1'.
  3601           88  CP-EXT-CHG-AH                   VALUE '2'.
  3602           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3603         16  CP-DOMICILE-STATE     PIC XX.
  3604         16  CP-CARRIER            PIC X.
  3605         16  CP-REIN-FLAG          PIC X.
  3606         16  CP-REM-TRM-CALC-OPTION PIC X.
  3607           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3608                      '2' '3' '4' '5'.
  3609           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3610           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3611           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3612           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3613           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3614           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3615           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3616           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3617         16  CP-SIG-SWITCH         PIC X.
  3618         16  CP-RATING-METHOD      PIC X.
  3619           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3620           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3621           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3622           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3623           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3624           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3625           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3626           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3627           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3628         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3629                                     COMP-3.
  3630         16  CP-BEN-CATEGORY       PIC X.
  3631         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3632         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3633                                   PIC S99V9(5) COMP-3.
  3634         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3635         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3636                                   PIC S99V9(5) COMP-3.
  3637         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3638         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3639         16  CP-EXPIRE-DT          PIC XX.
  3640         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3641         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3642         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3643         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3644         16  CP-DDF-SPEC-CALC      PIC X.
  3645             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3646             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  69
* EL050.cbl
  3647         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3648         16  CP-CANCEL-REASON      PIC X.
  3649         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3650         16  CP-PMT-MODE           PIC X.
  3651         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3652         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3653         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3654         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3655         16  FILLER                PIC X.
  3656
  3657***************    OUTPUT FROM ELRESV   ************************
  3658
  3659         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3660
  3661         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3662                                     COMP-3.
  3663         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3664                                     COMP-3.
  3665         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3668                                     COMP-3.
  3669         16  FILLER                PIC X(09).
  3670***************    OUTPUT FROM ELRTRM   *************************
  3671
  3672         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3673                                     COMP-3.
  3674         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3675                                     COMP-3.
  3676         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3677                                     COMP-3.
  3678         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3679                                     COMP-3.
  3680         16  FILLER                PIC X(12).
  3681
  3682***************    OUTPUT FROM ELRAMT   *************************
  3683
  3684         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3685                                     COMP-3.
  3686         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3687                                     COMP-3.
  3688         16  FILLER                PIC X(12).
  3689
  3690***************    OUTPUT FROM ELRATE   *************************
  3691
  3692         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3693                                     COMP-3.
  3694         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3695                                     COMP-3.
  3696         16  CP-MORTALITY-CODE     PIC X(4).
  3697         16  CP-RATE-EDIT-FLAG     PIC X.
  3698             88  CP-RATES-NEED-APR                  VALUE '1'.
  3699         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3700                                     COMP-3.
  3701         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3702         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3703         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3704                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  70
* EL050.cbl
  3705         16  FILLER                PIC X(07).
  3706
  3707***************    OUTPUT FROM ELRFND   *************************
  3708
  3709         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3710                                     COMP-3.
  3711         16  CP-REFUND-TYPE-USED   PIC X.
  3712           88  CP-R-AS-R78                         VALUE '1'.
  3713           88  CP-R-AS-PRORATA                     VALUE '2'.
  3714           88  CP-R-AS-CALIF                       VALUE '3'.
  3715           88  CP-R-AS-TEXAS                       VALUE '4'.
  3716           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3717           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3718           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3719           88  CP-R-AS-MEAN                        VALUE '8'.
  3720           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3721           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3722           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3723           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3724           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3725           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3726         16  FILLER                PIC X(12).
  3727
  3728***************    OUTPUT FROM ELEARN   *************************
  3729
  3730         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3731                                     COMP-3.
  3732         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3733                                     COMP-3.
  3734         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3737                                     COMP-3.
  3738         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3739                                     COMP-3.
  3740         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-EARNING-TYPE-USED  PIC X.
  3743           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3744           88  CP-E-AS-R78                         VALUE '1'.
  3745           88  CP-E-AS-PRORATA                     VALUE '2'.
  3746           88  CP-E-AS-TEXAS                       VALUE '4'.
  3747           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3748           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3749           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3750           88  CP-E-AS-MEAN                        VALUE '8'.
  3751           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3752         16  FILLER                PIC X(12).
  3753
  3754***************    OUTPUT FROM ELPMNT   *************************
  3755
  3756         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3757                                     COMP-3.
  3758         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3759                                     COMP-3.
  3760         16  FILLER                PIC X(12).
  3761
  3762***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  71
* EL050.cbl
  3763         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3764                                     COMP-3.
  3765         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3768                                     COMP-3.
  3769         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3770                                     COMP-3.
  3771         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3772                                     COMP-3.
  3773         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3774                                     COMP-3.
  3775         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3776             88  OPEN-RATE-FILE                   VALUE 'O'.
  3777             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3778             88  IO-ERROR                         VALUE 'E'.
  3779
  3780         16  CP-FIRST-PAY-DATE     PIC XX.
  3781
  3782         16  CP-JOINT-INDICATOR    PIC X.
  3783
  3784         16  CP-RESERVE-REMAINING-TERM
  3785                                   PIC S9(4)V9    VALUE ZERO
  3786                                     COMP-3.
  3787
  3788         16  CP-INSURED-BIRTH-DT   PIC XX.
  3789
  3790         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3791                                     COMP-3.
  3792
  3793         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3794                                     COMP-3.
  3795
  3796         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3797                                     COMP-3.
  3798
  3799         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3800                                     COMP-3.
  3801
  3802         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3803                                     COMP-3.
  3804
  3805         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3806                                     COMP-3.
  3807
  3808         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3809                                     COMP-3.
  3810
  3811         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3812             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3813
  3814         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3815                                     COMP-3.
  3816         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3817                                     COMP-3.
  3818         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3819         16  FILLER                PIC X(15).
  3820******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  72
* EL050.cbl
  3822******************************************************************
  3823*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3824*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3825*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3826*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3827*** MODIFICATION.                                              ***
  3828*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3829*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3830******************************************************************
  3831*    COPY ERCPNDB.
  3832******************************************************************
  3833*                                                                *
  3834*                                                                *
  3835*                            ERCPNDB.                            *
  3836*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3837*                            VMOD=2.025                          *
  3838*                                                                *
  3839*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3840*                                                                *
  3841******************************************************************
  3842*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3843*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3844******************************************************************
  3845*                                                                *
  3846*                                                                *
  3847*   FILE TYPE = VSAM,KSDS                                        *
  3848*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3849*                                                                *
  3850*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3851*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3852*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3853*                                                 RKP=13,LEN=36  *
  3854*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3855*                                      AND CHG-SEQ.)             *
  3856*                                                RKP=49,LEN=11   *
  3857*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3858*                                      AND CHG-SEQ.)             *
  3859*                                                RKP=60,LEN=15   *
  3860*                                                                *
  3861*   LOG = NO                                                     *
  3862*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3863******************************************************************
  3864******************************************************************
  3865*                   C H A N G E   L O G
  3866*
  3867* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3868*-----------------------------------------------------------------
  3869*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3870* EFFECTIVE    NUMBER
  3871*-----------------------------------------------------------------
  3872* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3873* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3874* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3875* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3876* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3877* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3878* 032306                   PEMA  ADD BOW LOAN NUMBER
  3879* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  73
* EL050.cbl
  3880* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3881* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3882* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3883* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3884* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3885* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3886* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3887******************************************************************
  3888
  3889 01  PENDING-BUSINESS.
  3890     12  PB-RECORD-ID                     PIC XX.
  3891         88  VALID-PB-ID                        VALUE 'PB'.
  3892
  3893     12  PB-CONTROL-PRIMARY.
  3894         16  PB-COMPANY-CD                PIC X.
  3895         16  PB-ENTRY-BATCH               PIC X(6).
  3896         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3897         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3898
  3899     12  PB-CONTROL-BY-ACCOUNT.
  3900         16  PB-COMPANY-CD-A1             PIC X.
  3901         16  PB-CARRIER                   PIC X.
  3902         16  PB-GROUPING.
  3903             20  PB-GROUPING-PREFIX       PIC XXX.
  3904             20  PB-GROUPING-PRIME        PIC XXX.
  3905         16  PB-STATE                     PIC XX.
  3906         16  PB-ACCOUNT.
  3907             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3908             20  PB-ACCOUNT-PRIME         PIC X(6).
  3909         16  PB-CERT-EFF-DT               PIC XX.
  3910         16  PB-CERT-NO.
  3911             20  PB-CERT-PRIME            PIC X(10).
  3912             20  PB-CERT-SFX              PIC X.
  3913         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3914
  3915         16  PB-RECORD-TYPE               PIC X.
  3916             88  PB-MAILING-DATA                VALUE '0'.
  3917             88  PB-ISSUE                       VALUE '1'.
  3918             88  PB-CANCELLATION                VALUE '2'.
  3919             88  PB-BATCH-TRAILER               VALUE '9'.
  3920
  3921     12  PB-CONTROL-BY-ORIG-BATCH.
  3922         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3923         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3924         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3925         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3926
  3927     12  PB-CONTROL-BY-CSR.
  3928         16  PB-CSR-COMPANY-CD            PIC X.
  3929         16  PB-CSR-ID                    PIC X(4).
  3930         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3931         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3932         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3933******************************************************************
  3934*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3935******************************************************************
  3936
  3937     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  74
* EL050.cbl
  3938     12  PB-LAST-MAINT-BY                 PIC X(4).
  3939     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3940
  3941     12  PB-RECORD-BODY                   PIC X(375).
  3942
  3943     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3944         16  PB-CERT-ORIGIN               PIC X.
  3945             88  CLASIC-CREATED-CERT         VALUE '1'.
  3946         16  PB-I-NAME.
  3947             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3948             20  PB-I-INSURED-FIRST-NAME.
  3949                 24  PB-I-INSURED-1ST-INIT PIC X.
  3950                 24  FILLER                PIC X(9).
  3951             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3952         16  PB-I-AGE                     PIC S99   COMP-3.
  3953         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3954         16  PB-I-BIRTHDAY                PIC XX.
  3955         16  PB-I-INSURED-SEX             PIC X.
  3956             88  PB-SEX-MALE     VALUE 'M'.
  3957             88  PB-SEX-FEMALE   VALUE 'F'.
  3958
  3959         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3960         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3961         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3962         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3963         16  PB-I-SKIP-CODE               PIC X.
  3964             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3965             88  PB-SKIP-JULY              VALUE '1'.
  3966             88  PB-SKIP-AUGUST            VALUE '2'.
  3967             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3968             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3969             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3970             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3971             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3972             88  PB-SKIP-JUNE              VALUE '8'.
  3973             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3974             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3975             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3976         16  PB-I-TERM-TYPE               PIC X.
  3977             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3978             88  PB-PAID-WEEKLY            VALUE 'W'.
  3979             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3980             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3981             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3982         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3983         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3984         16  PB-I-DATA-ENTRY-SW           PIC X.
  3985             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3986             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3987             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3988             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3989         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3990         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3991*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3992         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3993         16  FILLER                       PIC X.
  3994
  3995         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  75
* EL050.cbl
  3996             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3997             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3998                                                   '90' THRU '99'.
  3999         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4000                                          PIC XX.
  4001         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4002         16  PB-I-AMOUNT-FINANCED REDEFINES
  4003                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4004         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4005         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4006                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4007         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4008         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4009         16  PB-I-CLP-AMOUNT REDEFINES
  4010                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4011         16  PB-I-LF-CALC-FLAG            PIC X.
  4012             88 PB-COMP-LF-PREM               VALUE '?'.
  4013         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4014         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4015         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4016         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4017         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4018         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4019         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4020         16  PB-I-LF-ABBR                 PIC XXX.
  4021         16  PB-I-LF-INPUT-CD             PIC XX.
  4022
  4023         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4024             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4025             88  PB-INVALID-AH               VALUE '  ' '00'
  4026                                                   '90' THRU '99'.
  4027         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4028         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4029         16  PB-I-AH-CALC-FLAG            PIC X.
  4030             88 PB-COMP-AH-PREM                  VALUE '?'.
  4031         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4032         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4033         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4034         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4035         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4036         16  PB-I-AH-ABBR                 PIC XXX.
  4037         16  PB-I-AH-INPUT-CD             PIC XXX.
  4038
  4039         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4040         16  PB-I-REIN-TABLE              PIC XXX.
  4041         16  PB-I-BUSINESS-TYPE           PIC 99.
  4042         16  PB-I-INDV-GRP-CD             PIC X.
  4043         16  PB-I-MORT-CODE.
  4044             20  PB-I-TABLE               PIC X.
  4045             20  PB-I-INTEREST            PIC XX.
  4046             20  PB-I-MORT-TYP            PIC X.
  4047         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4048         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4049         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4050         16  PB-I-INDV-GRP-OVRD           PIC X.
  4051         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4052         16  PB-I-SIG-SW                  PIC X.
  4053             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  76
* EL050.cbl
  4054         16  PB-I-RATE-CLASS              PIC XX.
  4055         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4056         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4057         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4058         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4059         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4060         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4061         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4062         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4063         16  PB-I-OB-FLAG                 PIC X.
  4064             88  PB-I-OB                      VALUE 'B'.
  4065             88  PB-I-SUMMARY                 VALUE 'Z'.
  4066         16  PB-I-ENTRY-STATUS            PIC X.
  4067             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4068                                              'M' '5' '9' '2'.
  4069             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4070             88  PB-I-POLICY-PENDING          VALUE '2'.
  4071             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4072             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4073             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4074             88  PB-I-REIN-ONLY               VALUE '9'.
  4075             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4076             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4077             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4078             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4079         16  PB-I-INT-CODE                PIC X.
  4080             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4081             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4082         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4083         16  PB-I-SOC-SEC-NO              PIC X(11).
  4084         16  PB-I-MEMBER-NO               PIC X(12).
  4085         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4086*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4087         16  PB-I-OLD-LOF                 PIC XXX.
  4088         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4089         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4090         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4091         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4092         16  PB-I-LIFE-INDICATOR          PIC X.
  4093             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4094         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4095         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4096                                          PIC S9(5)V99    COMP-3.
  4097         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4098             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4099             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4100         16  PB-I-1ST-PMT-DT              PIC XX.
  4101         16  PB-I-JOINT-INSURED.
  4102             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4103             20 PB-I-JOINT-FIRST-NAME.
  4104                24  PB-I-JOINT-FIRST-INIT PIC X.
  4105                24  FILLER                PIC X(9).
  4106             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4107*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4108         16  PB-I-BENEFICIARY-NAME.
  4109             20  PB-I-BANK-NUMBER         PIC X(10).
  4110             20  FILLER                   PIC X(15).
  4111         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  77
* EL050.cbl
  4112         16  PB-I-REFERENCE               PIC X(12).
  4113         16  FILLER REDEFINES PB-I-REFERENCE.
  4114             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4115             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4116             20  PB-I-CLP-STATE           PIC XX.
  4117         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4118             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4119             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4120             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4121         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4122         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4123         16  PB-I-RESIDENT-STATE          PIC XX.
  4124         16  PB-I-RATE-CODE               PIC X(4).
  4125         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4126         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4127         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4128         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4129         16  PB-I-BANK-NOCHRGB            PIC 99.
  4130         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4131         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4132
  4133     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4134         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4135             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4136         16  PB-C-CANCEL-ORIGIN           PIC X.
  4137             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4138         16  PB-C-LF-CANCEL-DT            PIC XX.
  4139         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4140         16  PB-C-LF-CALC-REQ             PIC X.
  4141             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4142         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4143         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4144         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4145             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4146         16  PB-C-AH-CANCEL-DT            PIC XX.
  4147         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4148         16  PB-C-AH-CALC-REQ             PIC X.
  4149             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4150         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4151         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4152         16  PB-C-LAST-NAME               PIC X(15).
  4153         16  PB-C-REFUND-SW               PIC X.
  4154             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4155             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4156         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4157         16  PB-C-PAYEE-CODE              PIC X(6).
  4158         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4159         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4160         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4161         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4162         16  PB-C-REFERENCE               PIC X(12).
  4163         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4164         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4165         16  PB-C-POST-CARD-IND           PIC X.
  4166         16  PB-C-CANCEL-REASON           PIC X.
  4167         16  PB-C-REF-INTERFACE-SW        PIC X.
  4168         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4169         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  78
* EL050.cbl
  4170         16  FILLER                       PIC X(01).
  4171*        16  FILLER                       PIC X(18).
  4172         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4173*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4174         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4175         16  PB-CANCELED-CERT-DATA.
  4176             20  PB-CI-INSURED-NAME.
  4177                 24  PB-CI-LAST-NAME      PIC X(15).
  4178                 24  PB-CI-INITIALS       PIC XX.
  4179             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4180             20  PB-CI-INSURED-SEX        PIC X.
  4181             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4182             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4183             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4184             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4185             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4186             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4187             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4188             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4189             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4190             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4191             20  PB-CI-RATE-CLASS         PIC XX.
  4192             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4193             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4194             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4195             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4196             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4197             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4198             20  PB-CI-LF-ABBR            PIC X(3).
  4199             20  PB-CI-AH-ABBR            PIC X(3).
  4200             20  PB-CI-OB-FLAG            PIC X.
  4201                 88  PB-CI-OB                VALUE 'B'.
  4202             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4203                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4204                                           'M' '4' '5' '9' '2'.
  4205                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4206                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4207                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4208                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4209                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4210                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4211                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4212                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4213                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4214                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4215                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4216                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4217             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4218                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4219                                           'M' '4' '5' '9' '2'.
  4220                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4221                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4222                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4223                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4224                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4225                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4226                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4227                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  79
* EL050.cbl
  4228                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4229                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4230                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4231                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4232             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4233             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4234             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4235             20  PB-CI-MEMBER-NO          PIC X(12).
  4236             20  PB-CI-INT-CODE           PIC X.
  4237                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4238                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4239             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4240             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4241             20  PB-CI-COMP-EXCP-SW       PIC X.
  4242                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4243                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4244             20  PB-CI-ENTRY-STATUS       PIC X.
  4245             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4246             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4247             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4248             20  PB-CI-DEATH-DT           PIC XX.
  4249             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4250             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4251             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4252             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4253             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4254             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4255             20  PB-CI-ENTRY-DT              PIC XX.
  4256             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4257             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4258             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4259             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4260             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4261             20  PB-CI-OLD-LOF               PIC XXX.
  4262*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4263             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4264             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4265             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4266             20  PB-CI-INDV-GRP-CD           PIC X.
  4267             20  PB-CI-BENEFICIARY-NAME.
  4268                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4269                 24  FILLER                  PIC X(15).
  4270             20  PB-CI-NOTE-SW               PIC X.
  4271             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4272             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4273             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4274             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4275             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4276             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4277             20  PB-CI-FIRST-NAME            PIC X(10).
  4278             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4279
  4280         16  FILLER                       PIC X(13).
  4281*032306  16  FILLER                       PIC X(27).
  4282*        16  FILLER                       PIC X(46).
  4283
  4284     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4285         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  80
* EL050.cbl
  4286         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4287         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4288         16  PB-M-INSURED-MID-INIT        PIC X.
  4289         16  PB-M-INSURED-AGE             PIC 99.
  4290         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4291         16  PB-M-INSURED-SEX             PIC X.
  4292         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4293         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4294         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4295         16  PB-M-INSURED-CITY-STATE.
  4296             20  PB-M-INSURED-CITY        PIC X(28).
  4297             20  PB-M-INSURED-STATE       PIC XX.
  4298         16  PB-M-INSURED-ZIP-CODE.
  4299             20  PB-M-INSURED-ZIP-PRIME.
  4300                 24  PB-M-INSURED-ZIP-1   PIC X.
  4301                     88  PB-M-CANADIAN-POST-CODE
  4302                                             VALUE 'A' THRU 'Z'.
  4303                 24  FILLER               PIC X(4).
  4304             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4305         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4306                                        PB-M-INSURED-ZIP-CODE.
  4307             20  PM-M-INS-CAN-POST1       PIC XXX.
  4308             20  PM-M-INS-CAN-POST2       PIC XXX.
  4309             20  FILLER                   PIC XXX.
  4310         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4311         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4312         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4313         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4314         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4315         16  PB-M-CRED-BENE-CITYST.
  4316             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4317             20  PB-M-CRED-BENE-STATE     PIC XX.
  4318         16  FILLER                       PIC X(92).
  4319
  4320     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4321         16  FILLER                       PIC X(10).
  4322         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4323         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4324         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4325         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4326         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4327         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4328         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4329         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4330         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4331         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4332         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4333         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4334         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4335         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4336         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4337         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4338         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4339         16  PB-ACCOUNT-NAME              PIC X(30).
  4340         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4341         16  PB-REFERENCE                 PIC X(12).
  4342         16  PB-B-RECEIVED-DT             PIC XX.
  4343         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  81
* EL050.cbl
  4344
  4345     12  PB-RECORD-STATUS.
  4346         16  PB-CREDIT-SELECT-DT          PIC XX.
  4347         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4348         16  PB-BILLED-DT                 PIC XX.
  4349         16  PB-BILLING-STATUS            PIC X.
  4350             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4351             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4352             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4353         16  PB-RECORD-BILL               PIC X.
  4354             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4355             88  PB-RECORD-RETURNED           VALUE 'R'.
  4356             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4357             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4358             88  PB-OVERRIDE-AH               VALUE 'A'.
  4359             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4360         16  PB-BATCH-ENTRY               PIC X.
  4361             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4362             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4363             88  PB-REISSUED-CERT             VALUE 'E'.
  4364             88  PB-MONTHLY-CERT              VALUE 'M'.
  4365             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4366             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4367             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4368         16  PB-FORCE-CODE                PIC X.
  4369             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4370             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4371             88  PB-CANCEL-FORCE              VALUE '8'.
  4372             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4373             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4374             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4375             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4376             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4377             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4378             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4379         16  PB-FATAL-FLAG                PIC X.
  4380             88  PB-FATAL-ERRORS              VALUE 'X'.
  4381         16  PB-FORCE-ER-CD               PIC X.
  4382             88  PB-FORCE-ERRORS              VALUE 'F'.
  4383             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4384         16  PB-WARN-ER-CD                PIC X.
  4385             88  PB-WARNING-ERRORS            VALUE 'W'.
  4386         16  FILLER                       PIC X.
  4387         16  PB-OUT-BAL-CD                PIC X.
  4388             88  PB-OUT-OF-BAL                VALUE 'O'.
  4389         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4390         16  PB-AH-OVERRIDE-L1            PIC X.
  4391         16  PB-INPUT-DT                  PIC XX.
  4392         16  PB-INPUT-BY                  PIC X(4).
  4393         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4394         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4395         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4396         16  PB-LF-EARNING-METHOD         PIC X.
  4397         16  PB-AH-EARNING-METHOD         PIC X.
  4398         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4399         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4400         16  PB-REIN-CD                   PIC XXX.
  4401         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  82
* EL050.cbl
  4402         16  PB-AH-REFUND-TYPE            PIC X.
  4403         16  PB-ACCT-EFF-DT               PIC XX.
  4404         16  PB-ACCT-EXP-DT               PIC XX.
  4405         16  PB-COMPANY-ID                PIC X(3).
  4406         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4407         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4408         16  PB-SV-CARRIER                PIC X.
  4409         16  PB-SV-GROUPING               PIC X(6).
  4410         16  PB-SV-STATE                  PIC XX.
  4411         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4412         16  PB-GA-BILLING-INFO.
  4413             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4414                                          PIC XX.
  4415         16  PB-SV-REMIT-TO  REDEFINES
  4416             PB-GA-BILLING-INFO           PIC X(10).
  4417         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4418         16  PB-I-LOAN-OFFICER            PIC X(5).
  4419         16  PB-I-VIN                     PIC X(17).
  4420
  4421         16  FILLER                       PIC X(04).
  4422         16  IMNET-BYPASS-SW              PIC X.
  4423
  4424******************************************************************
  4425*                COMMON EDIT ERRORS                              *
  4426******************************************************************
  4427
  4428     12  PB-COMMON-ERRORS.
  4429         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4430                                           PIC S9(4)     COMP.
  4431
  4432******************************************************************
  4433
  4434* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4435*    COPY ELC50W1.
  4436******************************************************************
  4437*                                                                *
  4438*                                                                *
  4439*                             ELC50W1                            *
  4440*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4441*                            VMOD=2.004                          *
  4442*                                                                *
  4443*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4444*                                                                *
  4445*                                                                *
  4446******************************************************************
  4447
  4448     12  WK-WORK-AREA.
  4449         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4450         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4451         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4452         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4453         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4454         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4455         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4456         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4457         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4458         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4459         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  83
* EL050.cbl
  4460         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4461         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4462         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4463         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4464         16  WK-CREDIT-EDIT-CONTROLS.
  4465             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4466             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4467             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4468             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4469             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4470             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4471         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4472         16  WK-SAVE-REIN-DATA.
  4473             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4474             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4475             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4476         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4477             88  ENTRY-FROM-EL6311       VALUE '6'.
  4478         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4479         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4480     12  WK-RECORD-ADDRESSES.
  4481         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4482         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4483         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4484         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4485         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4486         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4487         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4488         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4489     12  WK-OVER-SHORT-AREA.
  4490         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4491         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4492         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4493             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4494         16  FILLER                   PIC X(5) VALUE SPACES.
  4495
  4496*    COPY ELCEDITC.
  4497******************************************************************
  4498*                                                                *
  4499*                                                                *
  4500*                            ELCEDITC                            *
  4501*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4502*                            VMOD=2.012                          *
  4503*                                                                *
  4504*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4505*                     EL6313, EL050 AND EL517.                   *
  4506*                                                                *
  4507******************************************************************
  4508******************************************************************
  4509*                   C H A N G E   L O G
  4510*
  4511* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4512*-----------------------------------------------------------------
  4513*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4514* EFFECTIVE    NUMBER
  4515*-----------------------------------------------------------------
  4516* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4517******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  84
* EL050.cbl
  4518
  4519     12  EDIT-CRITERIA-DATA.
  4520         16  EC-CO-MONTH-END-DT       PIC XX.
  4521         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4522         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4523         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4524         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4525         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4526         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4527         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4528         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4529         16  EC-CO-REM-TERM-CALC      PIC X.
  4530               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4531               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4532               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4533               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4534
  4535         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4536               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4537               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4538               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4539               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4540               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4541               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4542               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4543               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4544               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4545               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4546
  4547         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4548               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4549               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4550               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4551               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4552               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4553               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4554               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4555               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4556
  4557         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4558                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4559                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4560
  4561         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4562                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4563                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4564                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4565                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4566                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4567                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4568                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4569                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4570
  4571         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4572               88  EC-BR-REDUCING                   VALUE 'R'.
  4573               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4574
  4575         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  85
* EL050.cbl
  4576         16  EC-BR-LF-DESC             PIC X(10).
  4577         16  EC-BR-AH-DESC             PIC X(10).
  4578         16  EC-BR-LF-COMMENT          PIC X(10).
  4579         16  EC-BR-AH-COMMENT          PIC X(10).
  4580
  4581         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4582               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4583               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4584               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4585               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4586
  4587         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4588               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4589               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4590               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4591               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4592
  4593         16  EC-BR-LF-REFUND-CALC      PIC X.
  4594                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4595                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4596                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4597                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4598                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4599                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4600                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4601
  4602         16  EC-BR-AH-REFUND-CALC      PIC X.
  4603                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4604                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4605                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4606                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4607                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4608                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4609                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4610                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4611
  4612         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4613                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4614                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4615                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4616
  4617         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4618                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4619                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4620                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4621
  4622         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4623         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4624         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4625         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4626
  4627         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4628         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4629                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4630                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4631                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4632                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4633
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  86
* EL050.cbl
  4634         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4635               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4636               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4637               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4638               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4639               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4640
  4641         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4642               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4643               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4644               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4645               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4646               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4647
  4648         16  EC-ST-LF-REFUND-CALC      PIC X.
  4649                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4650                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4651                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4652                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4653                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4654                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4655                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4656                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4657
  4658         16  EC-ST-AH-REFUND-CALC      PIC X.
  4659                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4660                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4661                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4662                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4663                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4664                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4665                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4666                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4667
  4668         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4669         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4670         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4671         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4672         16  EC-AM-EXPIRATION-DT       PIC XX.
  4673         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4674         16  EC-AM-CLASS-CD            PIC XX.
  4675         16  EC-AM-LF-DEVIATION        PIC XXX.
  4676         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4677         16  EC-AM-AH-DEVIATION        PIC XXX.
  4678         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4679         16  EC-AM-PHONE-NO            PIC X(10).
  4680
  4681         16  EC-AM-LF-REFUND-CALC      PIC X.
  4682                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4683                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4684                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4685                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4686                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4687                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4688                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4689
  4690         16  EC-AM-AH-REFUND-CALC      PIC X.
  4691                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  87
* EL050.cbl
  4692                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4693                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4694                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4695                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4696                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4697                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4698
  4699         16  EC-AM-BEN-I-G-CD          PIC X.
  4700                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4701                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4702                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4703
  4704         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4705         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4706         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4707         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4708         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4709         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4710         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4711         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4712         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4713
  4714         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4715         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4716         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4717         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4718         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4719         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4720         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4721         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4722         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4723         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4724         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4725         16  EC-RT-LF-NSP-ST           PIC XX.
  4726         16  EC-RT-AH-NSP-ST           PIC XX.
  4727         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4728         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4729
  4730         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4731             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4732                                             'M' '5' '9' '2'.
  4733             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4734             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4735             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4736             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4737             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4738             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4739             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4740             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4741             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4742             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4743
  4744         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4745             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4746                                             'M' '5' '9' '2'.
  4747             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4748             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4749             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  88
* EL050.cbl
  4750             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4751             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4752             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4753             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4754             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4755             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4756             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4757
  4758         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4759         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4760         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4761         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4762         16  EC-CM-DEATH-DT            PIC XX.
  4763
  4764*DMD CUSTOM CODING FIELDS BELOW
  4765*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4766         16  EC-BR-DMD-RATING-SW       PIC X.
  4767                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4768                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4769                 88  NO-DMD-RATING               VALUE 'N'.
  4770
  4771         16  EC-NEW-CERT               PIC X(11).
  4772         16  EC-NEW-STATE              PIC XX.
  4773         16  FILLER                    PIC X.
  4774*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4775         16  OVER-SHORT-EDIT-FIELDS.
  4776             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4777             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4778             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4779             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4780             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4781             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4782             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4783             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4784             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4785         16  FILLER                    PIC X(71).
  4786******************************************************************
  4787
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  89
* EL050.cbl
  4789*    COPY ELCDIFRD.
  4790******************************************************************
  4791*                                                                *
  4792*                                                                *
  4793*                            ELCDIFRD.                           *
  4794*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4795*                            VMOD=2.004                          *
  4796*                                                                *
  4797*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4798*                                                                *
  4799******************************************************************
  4800*
  4801  01  WS-DIFFERENCE-CALCULATION.
  4802        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4803        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4804        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4805        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4806        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4807        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4808        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4809        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4810        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4811        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4812        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4813
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  90
* EL050.cbl
  4815****************************************************************
  4816*
  4817* Copyright (c) 2007 by Clerity Solutions, Inc.
  4818* All rights reserved.
  4819*
  4820****************************************************************
  4821 01  DFHEIV.
  4822   02  DFHEIV0               PIC X(35).
  4823   02  DFHEIV1               PIC X(08).
  4824   02  DFHEIV2               PIC X(08).
  4825   02  DFHEIV3               PIC X(08).
  4826   02  DFHEIV4               PIC X(06).
  4827   02  DFHEIV5               PIC X(04).
  4828   02  DFHEIV6               PIC X(04).
  4829   02  DFHEIV7               PIC X(02).
  4830   02  DFHEIV8               PIC X(02).
  4831   02  DFHEIV9               PIC X(01).
  4832   02  DFHEIV10              PIC S9(7) COMP-3.
  4833   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4834   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4835   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4836   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4837   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4838   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4839   02  DFHEIV17              PIC X(04).
  4840   02  DFHEIV18              PIC X(04).
  4841   02  DFHEIV19              PIC X(04).
  4842   02  DFHEIV20              USAGE IS POINTER.
  4843   02  DFHEIV21              USAGE IS POINTER.
  4844   02  DFHEIV22              USAGE IS POINTER.
  4845   02  DFHEIV23              USAGE IS POINTER.
  4846   02  DFHEIV24              USAGE IS POINTER.
  4847   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4848   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4849   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4850   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4851   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4852   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4853   02  FILLER                PIC X(02).
  4854   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4855   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4856   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4857   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4858   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4859 LINKAGE  SECTION.
  4860*****************************************************************
  4861*                                                               *
  4862* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4863* All rights reserved.                                          *
  4864*                                                               *
  4865*****************************************************************
  4866 01  dfheiblk.
  4867     02  eibtime          pic s9(7) comp-3.
  4868     02  eibdate          pic s9(7) comp-3.
  4869     02  eibtrnid         pic x(4).
  4870     02  eibtaskn         pic s9(7) comp-3.
  4871     02  eibtrmid         pic x(4).
  4872     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  91
* EL050.cbl
  4873     02  eibcposn         pic s9(4) comp.
  4874     02  eibcalen         pic s9(4) comp.
  4875     02  eibaid           pic x(1).
  4876     02  eibfiller1       pic x(1).
  4877     02  eibfn            pic x(2).
  4878     02  eibfiller2       pic x(2).
  4879     02  eibrcode         pic x(6).
  4880     02  eibfiller3       pic x(2).
  4881     02  eibds            pic x(8).
  4882     02  eibreqid         pic x(8).
  4883     02  eibrsrce         pic x(8).
  4884     02  eibsync          pic x(1).
  4885     02  eibfree          pic x(1).
  4886     02  eibrecv          pic x(1).
  4887     02  eibsend          pic x(1).
  4888     02  eibatt           pic x(1).
  4889     02  eibeoc           pic x(1).
  4890     02  eibfmh           pic x(1).
  4891     02  eibcompl         pic x(1).
  4892     02  eibsig           pic x(1).
  4893     02  eibconf          pic x(1).
  4894     02  eiberr           pic x(1).
  4895     02  eibrldbk         pic x(1).
  4896     02  eiberrcd         pic x(4).
  4897     02  eibsynrb         pic x(1).
  4898     02  eibnodat         pic x(1).
  4899     02  eibfiller5       pic x(2).
  4900     02  eibresp          pic 9(09) comp.
  4901     02  eibresp2         pic 9(09) comp.
  4902     02  dfheigdj         pic s9(4) comp.
  4903     02  dfheigdk         pic s9(4) comp.
  4904
  4905 01  DFHCOMMAREA                   PIC X(1036).
  4906
  4907*01 PARMLIST .
  4908*    02  FILLER                    PIC S9(8)   COMP.
  4909*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4910*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4911*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4912*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4913*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4914*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4915*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4916
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  92
* EL050.cbl
  4918*    COPY ELCCNTL.
  4919******************************************************************
  4920*                                                                *
  4921*                                                                *
  4922*                            ELCCNTL.                            *
  4923*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4924*                            VMOD=2.059                          *
  4925*                                                                *
  4926*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4927*                                                                *
  4928*   FILE TYPE = VSAM,KSDS                                        *
  4929*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4930*                                                                *
  4931*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4932*       ALTERNATE INDEX = NONE                                   *
  4933*                                                                *
  4934*   LOG = YES                                                    *
  4935*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4936******************************************************************
  4937*                   C H A N G E   L O G
  4938*
  4939* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4940*-----------------------------------------------------------------
  4941*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4942* EFFECTIVE    NUMBER
  4943*-----------------------------------------------------------------
  4944* 082503                   PEMA  ADD BENEFIT GROUP
  4945* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4946* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4947* 092705    2005050300006  PEMA  ADD SPP LEASES
  4948* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4949* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4950* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4951* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4952* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4953* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4954* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4955* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4956* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4957******************************************************************
  4958*
  4959 01  CONTROL-FILE.
  4960     12  CF-RECORD-ID                       PIC XX.
  4961         88  VALID-CF-ID                        VALUE 'CF'.
  4962
  4963     12  CF-CONTROL-PRIMARY.
  4964         16  CF-COMPANY-ID                  PIC XXX.
  4965         16  CF-RECORD-TYPE                 PIC X.
  4966             88  CF-COMPANY-MASTER              VALUE '1'.
  4967             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4968             88  CF-STATE-MASTER                VALUE '3'.
  4969             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4970             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4971             88  CF-CARRIER-MASTER              VALUE '6'.
  4972             88  CF-MORTALITY-MASTER            VALUE '7'.
  4973             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4974             88  CF-TERMINAL-MASTER             VALUE '9'.
  4975             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  93
* EL050.cbl
  4976             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4977             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4978             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4979             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4980             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4981             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4982             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4983             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4984         16  CF-ACCESS-CD-GENL              PIC X(4).
  4985         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4986             20  CF-PROCESSOR               PIC X(4).
  4987         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4988             20  CF-STATE-CODE              PIC XX.
  4989             20  FILLER                     PIC XX.
  4990         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4991             20  FILLER                     PIC XX.
  4992             20  CF-HI-BEN-IN-REC           PIC XX.
  4993         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4994             20  FILLER                     PIC XXX.
  4995             20  CF-CARRIER-CNTL            PIC X.
  4996         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4997             20  FILLER                     PIC XX.
  4998             20  CF-HI-TYPE-IN-REC          PIC 99.
  4999         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5000             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5001                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5002             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5003             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5004         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5005             20  FILLER                     PIC X.
  5006             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5007         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5008             20  FILLER                     PIC XX.
  5009             20  CF-MORTGAGE-PLAN           PIC XX.
  5010         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5011
  5012     12  CF-LAST-MAINT-DT                   PIC XX.
  5013     12  CF-LAST-MAINT-BY                   PIC X(4).
  5014     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5015
  5016     12  CF-RECORD-BODY                     PIC X(728).
  5017
  5018
  5019****************************************************************
  5020*             COMPANY MASTER RECORD                            *
  5021****************************************************************
  5022
  5023     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5024         16  CF-COMPANY-ADDRESS.
  5025             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5026             20  CF-CL-IN-CARE-OF           PIC X(30).
  5027             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5028             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5029             20  CF-CL-CITY-STATE           PIC X(30).
  5030             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5031             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5032         16  CF-COMPANY-CD                  PIC X.
  5033         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  94
* EL050.cbl
  5034         16  CF-SECURITY-OPTION             PIC X.
  5035             88  ALL-SECURITY                   VALUE '1'.
  5036             88  COMPANY-VERIFY                 VALUE '2'.
  5037             88  PROCESSOR-VERIFY               VALUE '3'.
  5038             88  NO-SECURITY                    VALUE '4'.
  5039             88  ALL-BUT-TERM                   VALUE '5'.
  5040         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5041             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5042         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5043             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5044         16  CF-INFORCE-LOCATION            PIC X.
  5045             88  CERTS-ARE-ONLINE               VALUE '1'.
  5046             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5047             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5048         16  CF-LOWER-CASE-LETTERS          PIC X.
  5049         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5050             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5051             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5052             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5053             88  CF-ACCNT-CNTL                  VALUE '3'.
  5054             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5055
  5056         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5057         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5058
  5059         16  CF-LGX-CREDIT-USER             PIC X.
  5060             88  CO-IS-NOT-USER                 VALUE 'N'.
  5061             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5062
  5063         16 CF-CREDIT-CALC-CODES.
  5064             20  CF-CR-REM-TERM-CALC PIC X.
  5065               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5066               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5067               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5068               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5069               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5070               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5071               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5072             20  CF-CR-R78-METHOD           PIC X.
  5073               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5074               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5075
  5076         16  CF-CLAIM-CONTROL-COUNTS.
  5077             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5078                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5079
  5080             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5081                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5082
  5083             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5084                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5085
  5086             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5087                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5088
  5089         16  CF-CURRENT-MONTH-END           PIC XX.
  5090
  5091         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  95
* EL050.cbl
  5092             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5093             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5094             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5095             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5096                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5097                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5098             20  CF-CO-PREM-REJECT-SW       PIC X.
  5099                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5100                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5101             20  CF-CO-REF-REJECT-SW        PIC X.
  5102                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5103                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5104
  5105         16  CF-CO-REPORTING-DT             PIC XX.
  5106         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5107         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5108           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5109           88  CF-CO-MONTH-END                  VALUE '1'.
  5110
  5111         16  CF-LGX-CLAIM-USER              PIC X.
  5112             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5113             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5114
  5115         16  CF-CREDIT-EDIT-CONTROLS.
  5116             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5117             20  CF-MIN-AGE                 PIC 99.
  5118             20  CF-DEFAULT-AGE             PIC 99.
  5119             20  CF-MIN-TERM                PIC S999      COMP-3.
  5120             20  CF-MAX-TERM                PIC S999      COMP-3.
  5121             20  CF-DEFAULT-SEX             PIC X.
  5122             20  CF-JOINT-AGE-INPUT         PIC X.
  5123                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5124             20  CF-BIRTH-DATE-INPUT        PIC X.
  5125                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5126             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5127                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5128                 88  CF-ZERO-CARRIER            VALUE '1'.
  5129                 88  CF-ZERO-GROUPING           VALUE '2'.
  5130                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5131             20  CF-EDIT-SW                 PIC X.
  5132                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5133             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5134             20  CF-CR-PR-METHOD            PIC X.
  5135               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5136               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5137             20  FILLER                     PIC X.
  5138
  5139         16  CF-CREDIT-MISC-CONTROLS.
  5140             20  CF-REIN-TABLE-SW           PIC X.
  5141                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5142             20  CF-COMP-TABLE-SW           PIC X.
  5143                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5144             20  CF-EXPERIENCE-RETENTION-AGE
  5145                                            PIC S9        COMP-3.
  5146             20  CF-CONVERSION-DT           PIC XX.
  5147             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5148             20  CF-RUN-FREQUENCY-SW        PIC X.
  5149                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  96
* EL050.cbl
  5150                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5151
  5152             20  CF-CR-CHECK-NO-CONTROL.
  5153                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5154                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5155                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5156                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5157                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5158                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5159
  5160                 24  CF-CR-CHECK-COUNT       REDEFINES
  5161                     CF-CR-CHECK-COUNTER      PIC X(4).
  5162
  5163                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5164                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5165
  5166                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5167                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5168                 24  CF-MAIL-PROCESSING       PIC X.
  5169                     88  MAIL-PROCESSING          VALUE 'Y'.
  5170
  5171         16  CF-MISC-SYSTEM-CONTROL.
  5172             20  CF-SYSTEM-C                 PIC X.
  5173                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5174             20  CF-SYSTEM-D                 PIC X.
  5175                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5176             20  CF-SOC-SEC-NO-SW            PIC X.
  5177                 88  SOC-SEC-NO-USED             VALUE '1'.
  5178             20  CF-MEMBER-NO-SW             PIC X.
  5179                 88  MEMBER-NO-USED              VALUE '1'.
  5180             20  CF-TAX-ID-NUMBER            PIC X(11).
  5181             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5182             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5183                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5184                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5185                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5186                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5187             20  CF-SYSTEM-E                 PIC X.
  5188                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5189
  5190         16  CF-LGX-LIFE-USER               PIC X.
  5191             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5192             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5193
  5194         16  CF-CR-MONTH-END-DT             PIC XX.
  5195
  5196         16  CF-FILE-MAINT-DATES.
  5197             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5198                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5199             20  CF-LAST-BATCH       REDEFINES
  5200                 CF-LAST-BATCH-NO               PIC X(4).
  5201             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5202             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5203             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5204             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5205             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5206             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5207             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  97
* EL050.cbl
  5208             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5209             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5210             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5211
  5212         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5213         16  FILLER                         PIC X.
  5214
  5215         16  CF-ALT-MORT-CODE               PIC X(4).
  5216         16  CF-MEMBER-CAPTION              PIC X(10).
  5217
  5218         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5219             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5220             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5221             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5222             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5223             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5224
  5225         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5226
  5227         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5228         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5229         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5230         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5231
  5232         16  CF-AH-OVERRIDE-L1              PIC X.
  5233         16  CF-AH-OVERRIDE-L2              PIC XX.
  5234         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5235         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5236
  5237         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5238         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5239
  5240         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5241         16  CF-AR-LAST-EL860-DT            PIC XX.
  5242         16  CF-MP-MONTH-END-DT             PIC XX.
  5243
  5244         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5245         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5246             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5247
  5248         16  CF-AR-MONTH-END-DT             PIC XX.
  5249
  5250         16  CF-CRDTCRD-USER                PIC X.
  5251             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5252             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5253
  5254         16  CF-CC-MONTH-END-DT             PIC XX.
  5255
  5256         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5257
  5258         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5259             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5260             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5261             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5262         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5263         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5264         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5265         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  98
* EL050.cbl
  5266             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5267             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5268         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5269         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5270         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5271             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5272         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5273
  5274         16  CF-CL-ZIP-CODE.
  5275             20  CF-CL-ZIP-PRIME.
  5276                 24  CF-CL-ZIP-1ST          PIC X.
  5277                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5278                 24  FILLER                 PIC X(4).
  5279             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5280         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5281             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5282             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5283             20  FILLER                     PIC XXX.
  5284
  5285         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5286         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5287         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5288         16  CF-CO-OPTION-START-DATE        PIC XX.
  5289         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5290           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5291                                                      '3' '4'.
  5292           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5293           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5294           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5295           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5296           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5297           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5298
  5299         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5300
  5301         16  CF-PAYMENT-APPROVAL-LEVELS.
  5302             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5303             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5304             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5305             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5306             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5307             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5308
  5309         16  CF-END-USER-REPORTING-USER     PIC X.
  5310             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5311             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5312
  5313         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5314             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5315             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5316
  5317         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5318
  5319         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5320         16  FILLER                         PIC X.
  5321
  5322         16  CF-CREDIT-ARCHIVE-CNTL.
  5323             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page  99
* EL050.cbl
  5324             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5325             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5326
  5327         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5328
  5329         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5330             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5331             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5332
  5333         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5334             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5335             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5336
  5337         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5338
  5339         16  CF-CO-ACH-ID-CODE              PIC  X.
  5340             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5341             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5342             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5343         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5344         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5345         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5346         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5347         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5348         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5349         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5350         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5351         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5352                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5353         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5354                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5355
  5356         16  CF-CO-OVER-SHORT.
  5357             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5358             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5359
  5360*         16  FILLER                         PIC X(102).
  5361         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5362             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5363             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5364
  5365         16  CF-AH-APPROVAL-DAYS.
  5366             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5367             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5368             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5369             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5370
  5371         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5372
  5373         16  CF-APPROV-LEV-5.
  5374             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5375             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5376             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5377
  5378         16  FILLER                         PIC X(68).
  5379****************************************************************
  5380*             PROCESSOR/USER RECORD                            *
  5381****************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 100
* EL050.cbl
  5382
  5383     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5384         16  CF-PROCESSOR-NAME              PIC X(30).
  5385         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5386         16  CF-PROCESSOR-TITLE             PIC X(26).
  5387         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5388                 88  MESSAGE-YES                VALUE 'Y'.
  5389                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5390
  5391*****************************************************
  5392****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5393****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5394****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5395****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5396*****************************************************
  5397
  5398         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5399             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5400             20  CF-APPLICATION-FORCE       PIC X.
  5401             20  CF-INDIVIDUAL-APP.
  5402                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5403                     28  CF-BROWSE-APP      PIC X.
  5404                     28  CF-UPDATE-APP      PIC X.
  5405
  5406         16  CF-CURRENT-TERM-ON             PIC X(4).
  5407         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5408             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5409             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5410             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5411             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5412             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5413             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5414             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5415         16  CF-PROCESSOR-CARRIER           PIC X.
  5416             88  NO-CARRIER-SECURITY            VALUE ' '.
  5417         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5418             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5419         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5420             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5421         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5422             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5423
  5424         16  CF-PROC-SYS-ACCESS-SW.
  5425             20  CF-PROC-CREDIT-CLAIMS-SW.
  5426                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5427                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5428                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5429                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5430             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5431                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5432                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5433             20  CF-PROC-LIFE-GNRLDGR-SW.
  5434                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5435                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5436                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5437                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5438             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5439                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 101
* EL050.cbl
  5440                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5441         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5442             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5443             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5444         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5445
  5446         16  CF-APPROVAL-LEVEL                  PIC X.
  5447             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5448             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5449             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5450             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5451             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5452
  5453         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5454
  5455         16  CF-LANGUAGE-TYPE                   PIC X.
  5456             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5457             88  CF-LANG-IS-FR                      VALUE 'F'.
  5458
  5459         16  CF-CSR-IND                         PIC X.
  5460         16  FILLER                             PIC X(239).
  5461
  5462****************************************************************
  5463*             PROCESSOR/REMINDERS RECORD                       *
  5464****************************************************************
  5465
  5466     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5467         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5468             20  CF-START-REMIND-DT         PIC XX.
  5469             20  CF-END-REMIND-DT           PIC XX.
  5470             20  CF-REMINDER-TEXT           PIC X(50).
  5471         16  FILLER                         PIC X(296).
  5472
  5473
  5474****************************************************************
  5475*             STATE MASTER RECORD                              *
  5476****************************************************************
  5477
  5478     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5479         16  CF-STATE-ABBREVIATION          PIC XX.
  5480         16  CF-STATE-NAME                  PIC X(25).
  5481         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5482         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5483             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5484             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5485             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5486             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5487                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5488                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5489             20  CF-ST-PREM-REJECT-SW       PIC X.
  5490                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5491                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5492             20  CF-ST-REF-REJECT-SW        PIC X.
  5493                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5494                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5495         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5496         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5497         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 102
* EL050.cbl
  5498             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5499             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5500             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5501         16  CF-ST-FST-PMT-EXTENSION.
  5502             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5503             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5504                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5505                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5506                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5507                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5508         16  CF-ST-STATE-CALL.
  5509             20  CF-ST-CALL-UNEARNED        PIC X.
  5510             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5511             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5512         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5513             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5514             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5515         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5516         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5517         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5518         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5519         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5520         16  FILLER                         PIC X.
  5521         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5522             20  CF-ST-BENEFIT-CD           PIC XX.
  5523             20  CF-ST-BENEFIT-KIND         PIC X.
  5524                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5525                 88  CF-ST-AH-KIND              VALUE 'A'.
  5526             20  CF-ST-REM-TERM-CALC        PIC X.
  5527                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5528                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5529                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5530                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5531                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5532                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5533                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5534                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5535
  5536             20  CF-ST-REFUND-CALC          PIC X.
  5537                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5538                 88  ST-REFD-BY-R78             VALUE '1'.
  5539                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5540                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5541                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5542                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5543                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5544                 88  ST-REFD-UTAH               VALUE '7'.
  5545                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5546                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5547                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5548
  5549             20  CF-ST-EARNING-CALC         PIC X.
  5550                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5551                 88  ST-EARN-BY-R78             VALUE '1'.
  5552                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5553                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5554                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5555                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 103
* EL050.cbl
  5556                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5557                 88  ST-EARN-MEAN               VALUE '8'.
  5558                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5559
  5560             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5561                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5562                 88  ST-OVRD-BY-R78             VALUE '1'.
  5563                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5564                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5565                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5566                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5567                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5568                 88  ST-OVRD-MEAN               VALUE '8'.
  5569                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5570             20  FILLER                     PIC X.
  5571
  5572         16  CF-ST-COMMISSION-CAPS.
  5573             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5574             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5575             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5576             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5577         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5578                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5579
  5580         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5581
  5582         16  CF-ST-STATUTORY-INTEREST.
  5583             20  CF-ST-STAT-DATE-FROM       PIC X.
  5584                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5585                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5586             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5587             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5588             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5589             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5590             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5591
  5592         16  CF-ST-OVER-SHORT.
  5593             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5594             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5595
  5596         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5597
  5598         16  CF-ST-RT-CALC                  PIC X.
  5599
  5600         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5601         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5602         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5603         16  CF-ST-RF-LR-CALC               PIC X.
  5604         16  CF-ST-RF-LL-CALC               PIC X.
  5605         16  CF-ST-RF-LN-CALC               PIC X.
  5606         16  CF-ST-RF-AH-CALC               PIC X.
  5607         16  CF-ST-RF-CP-CALC               PIC X.
  5608*        16  FILLER                         PIC X(206).
  5609*CIDMOD         16  FILLER                         PIC X(192).
  5610         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5611             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5612         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5613         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 104
* EL050.cbl
  5614         16  CF-ST-CAUSAL-STATE             PIC X.
  5615         16  FILLER                         PIC X(185).
  5616
  5617****************************************************************
  5618*             BENEFIT MASTER RECORD                            *
  5619****************************************************************
  5620
  5621     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5622         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5623             20  CF-BENEFIT-CODE            PIC XX.
  5624             20  CF-BENEFIT-NUMERIC  REDEFINES
  5625                 CF-BENEFIT-CODE            PIC XX.
  5626             20  CF-BENEFIT-ALPHA           PIC XXX.
  5627             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5628             20  CF-BENEFIT-COMMENT         PIC X(10).
  5629
  5630             20  CF-LF-COVERAGE-TYPE        PIC X.
  5631                 88  CF-REDUCING                VALUE 'R'.
  5632                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5633
  5634             20  CF-SPECIAL-CALC-CD         PIC X.
  5635                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5636                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5637                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5638                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5639                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5640                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5641                 88  CF-FARM-PLAN               VALUE 'F'.
  5642                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5643                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5644                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5645                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5646                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5647                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5648                 88  CF-PRUDENTIAL              VALUE 'P'.
  5649                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5650                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5651                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5652                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5653                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5654                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5655
  5656             20  CF-JOINT-INDICATOR         PIC X.
  5657                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5658
  5659*            20  FILLER                     PIC X(12).
  5660             20  FILLER                     PIC X(11).
  5661             20  CF-BENEFIT-CATEGORY        PIC X.
  5662             20  CF-LOAN-TYPE               PIC X(8).
  5663
  5664             20  CF-CO-REM-TERM-CALC        PIC X.
  5665                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5666                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5667                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5668                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5669                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5670
  5671             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 105
* EL050.cbl
  5672                 88  CO-EARN-BY-R78             VALUE '1'.
  5673                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5674                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5675                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5676                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5677                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5678                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5679                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5680
  5681             20  CF-CO-REFUND-CALC          PIC X.
  5682                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5683                 88  CO-REFD-BY-R78             VALUE '1'.
  5684                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5685                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5686                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5687                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5688                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5689                 88  CO-REFD-MEAN               VALUE '8'.
  5690                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5691                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5692                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5693
  5694             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5695                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5696                 88  CO-OVRD-BY-R78             VALUE '1'.
  5697                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5698                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5699                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5700                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5701                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5702                 88  CO-OVRD-MEAN               VALUE '8'.
  5703                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5704
  5705             20  CF-CO-BEN-I-G-CD           PIC X.
  5706                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5707                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5708                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5709
  5710         16  FILLER                         PIC X(304).
  5711
  5712
  5713****************************************************************
  5714*             CARRIER MASTER RECORD                            *
  5715****************************************************************
  5716
  5717     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5718         16  CF-ADDRESS-DATA.
  5719             20  CF-MAIL-TO-NAME            PIC X(30).
  5720             20  CF-IN-CARE-OF              PIC X(30).
  5721             20  CF-ADDRESS-LINE-1          PIC X(30).
  5722             20  CF-ADDRESS-LINE-2          PIC X(30).
  5723             20  CF-CITY-STATE              PIC X(30).
  5724             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5725             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5726
  5727         16  CF-CLAIM-NO-CONTROL.
  5728             20  CF-CLAIM-NO-METHOD         PIC X.
  5729                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 106
* EL050.cbl
  5730                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5731                 88  CLAIM-NO-SEQ               VALUE '3'.
  5732                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5733             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5734                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5735                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5736                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5737
  5738         16  CF-CHECK-NO-CONTROL.
  5739             20  CF-CHECK-NO-METHOD         PIC X.
  5740                 88  CHECK-NO-MANUAL            VALUE '1'.
  5741                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5742                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5743                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5744             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5745                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5746
  5747         16  CF-DOMICILE-STATE              PIC XX.
  5748
  5749         16  CF-EXPENSE-CONTROLS.
  5750             20  CF-EXPENSE-METHOD          PIC X.
  5751                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5752                 88  DOLLARS-PER-PMT            VALUE '2'.
  5753                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5754                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5755             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5756             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5757
  5758         16  CF-CORRESPONDENCE-CONTROL.
  5759             20  CF-LETTER-RESEND-OPT       PIC X.
  5760                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5761                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5762             20  FILLER                     PIC X(4).
  5763
  5764         16  CF-RESERVE-CONTROLS.
  5765             20  CF-MANUAL-SW               PIC X.
  5766                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5767             20  CF-FUTURE-SW               PIC X.
  5768                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5769             20  CF-PTC-SW                  PIC X.
  5770                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5771             20  CF-IBNR-SW                 PIC X.
  5772                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5773             20  CF-PTC-LF-SW               PIC X.
  5774                 88  CF-LF-PTC-USED             VALUE '1'.
  5775             20  CF-CDT-ACCESS-METHOD       PIC X.
  5776                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5777                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5778                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5779             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5780
  5781         16  CF-CLAIM-CALC-METHOD           PIC X.
  5782             88  360-PLUS-MONTHS                VALUE '1'.
  5783             88  365-PLUS-MONTHS                VALUE '2'.
  5784             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5785             88  360-DAILY                      VALUE '4'.
  5786             88  365-DAILY                      VALUE '5'.
  5787
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 107
* EL050.cbl
  5788         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5789         16  FILLER                         PIC X(11).
  5790
  5791         16  CF-LIMIT-AMOUNTS.
  5792             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5793             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5794             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5795             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5796             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5797             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5798             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5799             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5800             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5801             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5802
  5803         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5804         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5805         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5806
  5807         16  CF-ZIP-CODE.
  5808             20  CF-ZIP-PRIME.
  5809                 24  CF-ZIP-1ST             PIC X.
  5810                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5811                 24  FILLER                 PIC X(4).
  5812             20  CF-ZIP-PLUS4               PIC X(4).
  5813         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5814             20  CF-CAN-POSTAL-1            PIC XXX.
  5815             20  CF-CAN-POSTAL-2            PIC XXX.
  5816             20  FILLER                     PIC XXX.
  5817
  5818         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5819         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5820         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5821
  5822         16  CF-RATING-SWITCH               PIC X.
  5823             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5824             88  CF-NO-RATING                   VALUE 'N'.
  5825
  5826         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5827
  5828         16  CF-CARRIER-OVER-SHORT.
  5829             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5830             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5831
  5832         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5833         16  CF-SECPAY-SWITCH               PIC X.
  5834             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5835             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5836         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5837         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5838         16  FILLER                         PIC X(444).
  5839*        16  FILLER                         PIC X(452).
  5840
  5841
  5842****************************************************************
  5843*             MORTALITY MASTER RECORD                          *
  5844****************************************************************
  5845
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 108
* EL050.cbl
  5846     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5847         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5848                                INDEXED BY CF-MORT-NDX.
  5849             20  CF-MORT-TABLE              PIC X(5).
  5850             20  CF-MORT-TABLE-TYPE         PIC X.
  5851                 88  CF-MORT-JOINT              VALUE 'J'.
  5852                 88  CF-MORT-SINGLE             VALUE 'S'.
  5853                 88  CF-MORT-COMBINED           VALUE 'C'.
  5854                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5855                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5856             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5857             20  CF-MORT-AGE-METHOD         PIC XX.
  5858                 88  CF-AGE-LAST                VALUE 'AL'.
  5859                 88  CF-AGE-NEAR                VALUE 'AN'.
  5860             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5861             20  CF-MORT-ADJUSTMENT-DIRECTION
  5862                                            PIC X.
  5863                 88  CF-MINUS                   VALUE '-'.
  5864                 88  CF-PLUS                    VALUE '+'.
  5865             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5866             20  CF-MORT-JOINT-CODE         PIC X.
  5867                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5868             20  CF-MORT-PC-Q               PIC X.
  5869                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5870             20  CF-MORT-TABLE-CODE         PIC X(4).
  5871             20  CF-MORT-COMMENTS           PIC X(15).
  5872             20  FILLER                     PIC X(14).
  5873
  5874         16  FILLER                         PIC X(251).
  5875
  5876
  5877****************************************************************
  5878*             BUSSINESS TYPE MASTER RECORD                     *
  5879****************************************************************
  5880
  5881     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5882* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5883* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5884* AND RECORD 05 IS TYPES 81-99
  5885         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5886             20  CF-BUSINESS-TITLE          PIC  X(19).
  5887             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5888                                            PIC S9V9(4) COMP-3.
  5889             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5890             20  FILLER                     PIC  X.
  5891         16  FILLER                         PIC  X(248).
  5892
  5893
  5894****************************************************************
  5895*             TERMINAL MASTER RECORD                           *
  5896****************************************************************
  5897
  5898     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5899
  5900         16  CF-COMPANY-TERMINALS.
  5901             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5902                                  PIC X(4).
  5903         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 109
* EL050.cbl
  5904
  5905
  5906****************************************************************
  5907*             LIFE EDIT MASTER RECORD                          *
  5908****************************************************************
  5909
  5910     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5911         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5912             20  CF-LIFE-CODE-IN            PIC XX.
  5913             20  CF-LIFE-CODE-OUT           PIC XX.
  5914         16  FILLER                         PIC X(248).
  5915
  5916
  5917****************************************************************
  5918*             AH EDIT MASTER RECORD                            *
  5919****************************************************************
  5920
  5921     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5922         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5923             20  CF-AH-CODE-IN              PIC XXX.
  5924             20  CF-AH-CODE-OUT             PIC XX.
  5925         16  FILLER                         PIC X(248).
  5926
  5927
  5928****************************************************************
  5929*             CREDIBILITY TABLES                               *
  5930****************************************************************
  5931
  5932     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5933         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5934                             INDEXED BY CF-CRDB-NDX.
  5935             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5936             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5937             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5938         16  FILLER                         PIC  X(332).
  5939
  5940
  5941****************************************************************
  5942*             REPORT CUSTOMIZATION RECORD                      *
  5943****************************************************************
  5944
  5945     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5946         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5947             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5948             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5949             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5950**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5951****       A T-TRANSFER.                                   ****
  5952             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5953
  5954         16  FILLER                         PIC XX.
  5955
  5956         16  CF-CARRIER-CNTL-OPT.
  5957             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5958                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5959                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5960             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5961                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 110
* EL050.cbl
  5962         16  CF-GROUP-CNTL-OPT.
  5963             20  CF-GROUP-OPT-SEQ           PIC 9.
  5964                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5965                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5966             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5967                                            PIC X(6).
  5968         16  CF-STATE-CNTL-OPT.
  5969             20  CF-STATE-OPT-SEQ           PIC 9.
  5970                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5971                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5972             20  CF-STATE-SELECT OCCURS 3 TIMES
  5973                                            PIC XX.
  5974         16  CF-ACCOUNT-CNTL-OPT.
  5975             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5976                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5977                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5978             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5979                                            PIC X(10).
  5980         16  CF-BUS-TYP-CNTL-OPT.
  5981             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5982                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5983                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5984             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5985                                            PIC XX.
  5986         16  CF-LF-TYP-CNTL-OPT.
  5987             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5988                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5989                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5990             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5991                                            PIC XX.
  5992         16  CF-AH-TYP-CNTL-OPT.
  5993             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5994                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5995                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5996             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5997                                            PIC XX.
  5998         16  CF-REPTCD1-CNTL-OPT.
  5999             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6000                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6001                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6002             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6003                                            PIC X(10).
  6004         16  CF-REPTCD2-CNTL-OPT.
  6005             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6006                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6007                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6008             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6009                                            PIC X(10).
  6010         16  CF-USER1-CNTL-OPT.
  6011             20  CF-USER1-OPT-SEQ           PIC 9.
  6012                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6013                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6014             20  CF-USER1-SELECT OCCURS 3 TIMES
  6015                                            PIC X(10).
  6016         16  CF-USER2-CNTL-OPT.
  6017             20  CF-USER2-OPT-SEQ           PIC 9.
  6018                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6019                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 111
* EL050.cbl
  6020             20  CF-USER2-SELECT OCCURS 3 TIMES
  6021                                            PIC X(10).
  6022         16  CF-USER3-CNTL-OPT.
  6023             20  CF-USER3-OPT-SEQ           PIC 9.
  6024                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6025                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6026             20  CF-USER3-SELECT OCCURS 3 TIMES
  6027                                            PIC X(10).
  6028         16  CF-USER4-CNTL-OPT.
  6029             20  CF-USER4-OPT-SEQ           PIC 9.
  6030                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6031                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6032             20  CF-USER4-SELECT OCCURS 3 TIMES
  6033                                            PIC X(10).
  6034         16  CF-USER5-CNTL-OPT.
  6035             20  CF-USER5-OPT-SEQ           PIC 9.
  6036                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6037                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6038             20  CF-USER5-SELECT OCCURS 3 TIMES
  6039                                            PIC X(10).
  6040         16  CF-REINS-CNTL-OPT.
  6041             20  CF-REINS-OPT-SEQ           PIC 9.
  6042                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6043                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6044             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6045                 24  CF-REINS-PRIME         PIC XXX.
  6046                 24  CF-REINS-SUB           PIC XXX.
  6047
  6048         16  CF-AGENT-CNTL-OPT.
  6049             20  CF-AGENT-OPT-SEQ           PIC 9.
  6050                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6051                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6052             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6053                                            PIC X(10).
  6054
  6055         16  FILLER                         PIC X(43).
  6056
  6057         16  CF-LOSS-RATIO-SELECT.
  6058             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6059             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6060         16  CF-ENTRY-DATE-SELECT.
  6061             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6062             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6063         16  CF-EFFECTIVE-DATE-SELECT.
  6064             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6065             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6066
  6067         16  CF-EXCEPTION-LIST-IND          PIC X.
  6068             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6069
  6070         16  FILLER                         PIC X(318).
  6071
  6072****************************************************************
  6073*                  EXCEPTION REPORTING RECORD                  *
  6074****************************************************************
  6075
  6076     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6077         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 112
* EL050.cbl
  6078             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6079
  6080         16  CF-COMBINED-LIFE-AH-OPT.
  6081             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6082             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6083             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6084             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6085
  6086         16  CF-LIFE-OPT.
  6087             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6088             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6089             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6090             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6091             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6092             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6093             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6094             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6095             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6096             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6097
  6098         16  CF-AH-OPT.
  6099             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6100             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6101             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6102             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6103             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6104             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6105             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6106             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6107             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6108             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6109
  6110         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6111             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6112             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6113             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6114
  6115         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6116
  6117         16  FILLER                         PIC X(673).
  6118
  6119
  6120****************************************************************
  6121*             MORTGAGE SYSTEM PLAN RECORD                      *
  6122****************************************************************
  6123
  6124     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6125         16  CF-PLAN-TYPE                   PIC X.
  6126             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6127             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6128             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6129         16  CF-PLAN-ABBREV                 PIC XXX.
  6130         16  CF-PLAN-DESCRIPT               PIC X(10).
  6131         16  CF-PLAN-NOTES                  PIC X(20).
  6132         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6133         16  CF-PLAN-UNDERWRITING.
  6134             20  CF-PLAN-TERM-DATA.
  6135                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 113
* EL050.cbl
  6136                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6137             20  CF-PLAN-AGE-DATA.
  6138                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6139                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6140                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6141             20  CF-PLAN-BENEFIT-DATA.
  6142                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6143                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6144                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6145                                            PIC S9(7)V99  COMP-3.
  6146         16  CF-PLAN-POLICY-FORMS.
  6147             20  CF-POLICY-FORM             PIC X(12).
  6148             20  CF-MASTER-APPLICATION      PIC X(12).
  6149             20  CF-MASTER-POLICY           PIC X(12).
  6150         16  CF-PLAN-RATING.
  6151             20  CF-RATE-CODE               PIC X(5).
  6152             20  CF-SEX-RATING              PIC X.
  6153                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6154                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6155             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6156             20  CF-SUB-STD-TYPE            PIC X.
  6157                 88  CF-PCT-OF-PREM            VALUE '1'.
  6158                 88  CF-PCT-OF-BENE            VALUE '2'.
  6159         16  CF-PLAN-PREM-TOLERANCES.
  6160             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6161             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6162         16  CF-PLAN-PYMT-TOLERANCES.
  6163             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6164             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6165         16  CF-PLAN-MISC-DATA.
  6166             20  FILLER                     PIC X.
  6167             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6168             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6169         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6170         16  CF-PLAN-IND-GRP                PIC X.
  6171             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6172                                                     '1'.
  6173             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6174                                                     '2'.
  6175         16  CF-MIB-SEARCH-SW               PIC X.
  6176             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6177             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6178             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6179             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6180         16  CF-ALPHA-SEARCH-SW             PIC X.
  6181             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6182             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6183             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6184             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6185             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6186             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6187             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6188             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6189             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6190             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6191                                                     'A' 'B' 'C'
  6192                                                     'X' 'Y' 'Z'.
  6193         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 114
* EL050.cbl
  6194             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6195             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6196             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6197             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6198             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6199         16  FILLER                         PIC X(4).
  6200         16  CF-HEALTH-QUESTIONS            PIC X.
  6201             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6202         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6203         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6204         16  CF-PLAN-SNGL-JNT               PIC X.
  6205             88  CF-COMBINED-PLAN              VALUE 'C'.
  6206             88  CF-JNT-PLAN                   VALUE 'J'.
  6207             88  CF-SNGL-PLAN                  VALUE 'S'.
  6208         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6209         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6210         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6211         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6212         16  CF-RERATE-CNTL                 PIC  X.
  6213             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6214             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6215             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6216             88  CF-AUTO-RECALC                 VALUE '4'.
  6217         16  CF-BENEFIT-TYPE                PIC  X.
  6218             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6219             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6220         16  CF-POLICY-FEE                  PIC S999V99
  6221                                                    COMP-3.
  6222         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6223         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6224         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6225         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6226         16  FILLER                         PIC  X(32).
  6227         16  CF-TERMINATION-FORM            PIC  X(04).
  6228         16  FILLER                         PIC  X(08).
  6229         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6230                                                       COMP-3.
  6231         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6232         16  CF-ISSUE-LETTER                PIC  X(4).
  6233         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6234         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6235             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6236             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6237         16  CF-MP-REFUND-CALC              PIC X.
  6238             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6239             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6240             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6241             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6242             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6243             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6244             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6245             88  CF-MP-REFD-MEAN                VALUE '8'.
  6246         16  CF-ALT-RATE-CODE               PIC  X(5).
  6247
  6248
  6249         16  FILLER                         PIC X(498).
  6250****************************************************************
  6251*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 115
* EL050.cbl
  6252****************************************************************
  6253
  6254     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6255         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6256         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6257             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6258             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6259             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6260             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6261             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6262
  6263         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6264         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6265         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6266         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6267         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6268
  6269         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6270             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6271         16  CF-MP-RECON-USE-IND            PIC X(1).
  6272             88  CF-MP-USE-RECON             VALUE 'Y'.
  6273         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6274             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6275         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6276             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6277             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6278         16  FILLER                         PIC X(1).
  6279         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6280             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6281         16  CF-MORTG-MIB-VERSION           PIC X.
  6282             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6283             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6284             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6285         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6286             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6287                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6288             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6289                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6290             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6291                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6292             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6293                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6294             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6295                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6296             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6297                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6298         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6299         16  FILLER                         PIC X(7).
  6300         16  CF-MORTG-DESTINATION-SYMBOL.
  6301             20  CF-MORTG-MIB-COMM          PIC X(5).
  6302             20  CF-MORTG-MIB-TERM          PIC X(5).
  6303         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6304             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6305         16  FILLER                         PIC X(03).
  6306         16  CF-MP-CHECK-NO-CONTROL.
  6307             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6308                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6309                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 116
* EL050.cbl
  6310                                                ' ' LOW-VALUES.
  6311                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6312                                               VALUE '3'.
  6313         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6314         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6315         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6316             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6317                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6318             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6319                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6320             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6321                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6322             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6323                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6324             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6325                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6326             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6327                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6328         16  CF-MORTG-BILLING-AREA.
  6329             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6330                                            PIC X.
  6331         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6332         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6333         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6334         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6335             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6336             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6337         16  FILLER                         PIC X.
  6338         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6339             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6340             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6341         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6342         16  FILLER                         PIC X(8).
  6343         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6344         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6345         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6346         16  CF-ACH-COMPANY-ID.
  6347             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6348                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6349                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6350                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6351             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6352         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6353             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6354         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6355             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6356             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6357         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6358         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6359         16  FILLER                         PIC X(536).
  6360
  6361****************************************************************
  6362*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6363****************************************************************
  6364
  6365     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6366         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6367             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 117
* EL050.cbl
  6368                 24  CF-FEMALE-FT           PIC 99.
  6369                 24  CF-FEMALE-IN           PIC 99.
  6370             20  CF-FEMALE-MIN-WT           PIC 999.
  6371             20  CF-FEMALE-MAX-WT           PIC 999.
  6372         16  FILLER                         PIC X(428).
  6373
  6374     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6375         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6376             20  CF-MALE-HEIGHT.
  6377                 24  CF-MALE-FT             PIC 99.
  6378                 24  CF-MALE-IN             PIC 99.
  6379             20  CF-MALE-MIN-WT             PIC 999.
  6380             20  CF-MALE-MAX-WT             PIC 999.
  6381         16  FILLER                         PIC X(428).
  6382******************************************************************
  6383*             AUTOMATIC ACTIVITY RECORD                          *
  6384******************************************************************
  6385     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6386         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6387             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6388             20  CF-SYS-LETTER-ID           PIC X(04).
  6389             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6390             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6391             20  CF-SYS-RESET-SW            PIC X(01).
  6392             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6393             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6394
  6395         16  FILLER                         PIC X(50).
  6396
  6397         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6398             20  CF-USER-ACTIVE-SW          PIC X(01).
  6399             20  CF-USER-LETTER-ID          PIC X(04).
  6400             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6401             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6402             20  CF-USER-RESET-SW           PIC X(01).
  6403             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6404             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6405             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6406
  6407         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 118
* EL050.cbl
  6409*    COPY ERCACCT.
  6410******************************************************************
  6411*                                                                *
  6412*                                                                *
  6413*                            ERCACCT                             *
  6414*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6415*                            VMOD=2.031                          *
  6416*                                                                *
  6417*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6418*                                                                *
  6419*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6420*   VSAM ACCOUNT MASTER FILES.                                   *
  6421*                                                                *
  6422*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6423*                                                                *
  6424*   FILE TYPE = VSAM,KSDS                                        *
  6425*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6426*                                                                *
  6427*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6428*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6429*                                                                *
  6430*   LOG = NO                                                     *
  6431*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6432*                                                                *
  6433*                                                                *
  6434******************************************************************
  6435*                   C H A N G E   L O G
  6436*
  6437* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6438*-----------------------------------------------------------------
  6439*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6440* EFFECTIVE    NUMBER
  6441*-----------------------------------------------------------------
  6442* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6443* 092705    2005050300006  PEMA  ADD SPP LEASES
  6444* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6445* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6446* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6447* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6448* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6449******************************************************************
  6450
  6451 01  ACCOUNT-MASTER.
  6452     12  AM-RECORD-ID                      PIC XX.
  6453         88  VALID-AM-ID                      VALUE 'AM'.
  6454
  6455     12  AM-CONTROL-PRIMARY.
  6456         16  AM-COMPANY-CD                 PIC X.
  6457         16  AM-MSTR-CNTRL.
  6458             20  AM-CONTROL-A.
  6459                 24  AM-CARRIER            PIC X.
  6460                 24  AM-GROUPING.
  6461                     28 AM-GROUPING-PREFIX PIC XXX.
  6462                     28 AM-GROUPING-PRIME  PIC XXX.
  6463                 24  AM-STATE              PIC XX.
  6464                 24  AM-ACCOUNT.
  6465                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6466                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 119
* EL050.cbl
  6467             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6468                                           PIC X(19).
  6469             20  AM-CNTRL-B.
  6470                 24  AM-EXPIRATION-DT      PIC XX.
  6471                 24  FILLER                PIC X(4).
  6472             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6473                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6474
  6475     12  AM-CONTROL-BY-VAR-GRP.
  6476         16  AM-COMPANY-CD-A1              PIC X.
  6477         16  AM-VG-CARRIER                 PIC X.
  6478         16  AM-VG-GROUPING                PIC X(6).
  6479         16  AM-VG-STATE                   PIC XX.
  6480         16  AM-VG-ACCOUNT                 PIC X(10).
  6481         16  AM-VG-DATE.
  6482             20  AM-VG-EXPIRATION-DT       PIC XX.
  6483             20  FILLER                    PIC X(4).
  6484         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6485                                           PIC 9(11)      COMP-3.
  6486     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6487         16  FILLER                        PIC X(10).
  6488         16  AM-VG-KEY3.
  6489             20  AM-VG3-ACCOUNT            PIC X(10).
  6490             20  AM-VG3-EXP-DT             PIC XX.
  6491         16  FILLER                        PIC X(4).
  6492     12  AM-MAINT-INFORMATION.
  6493         16  AM-LAST-MAINT-DT              PIC XX.
  6494         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6495         16  AM-LAST-MAINT-USER            PIC X(4).
  6496         16  FILLER                        PIC XX.
  6497
  6498     12  AM-EFFECTIVE-DT                   PIC XX.
  6499     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6500
  6501     12  AM-PREV-DATES  COMP-3.
  6502         16  AM-PREV-EXP-DT                PIC 9(11).
  6503         16  AM-PREV-EFF-DT                PIC 9(11).
  6504
  6505     12  AM-REPORT-CODE-1                  PIC X(10).
  6506     12  AM-REPORT-CODE-2                  PIC X(10).
  6507
  6508     12  AM-CITY-CODE                      PIC X(4).
  6509     12  AM-COUNTY-PARISH                  PIC X(6).
  6510
  6511     12  AM-NAME                           PIC X(30).
  6512     12  AM-PERSON                         PIC X(30).
  6513     12  AM-ADDRS                          PIC X(30).
  6514     12  AM-CITY.
  6515         16  AM-ADDR-CITY                  PIC X(28).
  6516         16  AM-ADDR-STATE                 PIC XX.
  6517     12  AM-ZIP.
  6518         16  AM-ZIP-PRIME.
  6519             20  AM-ZIP-PRI-1ST            PIC X.
  6520                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6521             20  FILLER                    PIC X(4).
  6522         16  AM-ZIP-PLUS4                  PIC X(4).
  6523     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6524         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 120
* EL050.cbl
  6525         16  AM-CAN-POSTAL-2               PIC XXX.
  6526         16  FILLER                        PIC XXX.
  6527     12  AM-TEL-NO.
  6528         16  AM-AREA-CODE                  PIC 999.
  6529         16  AM-TEL-PRE                    PIC 999.
  6530         16  AM-TEL-NBR                    PIC 9(4).
  6531     12  AM-TEL-LOC                        PIC X.
  6532         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6533         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6534
  6535     12  AM-COMM-STRUCTURE.
  6536         16  AM-DEFN-1.
  6537             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6538                 24  AM-AGT.
  6539                     28  AM-AGT-PREFIX     PIC X(4).
  6540                     28  AM-AGT-PRIME      PIC X(6).
  6541                 24  AM-COM-TYP            PIC X.
  6542                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6543                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6544                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6545                 24  AM-RECALC-LV-INDIC    PIC X.
  6546                 24  AM-RETRO-LV-INDIC     PIC X.
  6547                 24  AM-GL-CODES           PIC X.
  6548                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6549                 24  FILLER                PIC X(01).
  6550         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6551             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6552                 24  FILLER                PIC X(11).
  6553                 24  AM-L-COMA             PIC XXX.
  6554                 24  AM-J-COMA             PIC XXX.
  6555                 24  AM-A-COMA             PIC XXX.
  6556                 24  FILLER                PIC X(6).
  6557
  6558     12  AM-COMM-CHANGE-STATUS             PIC X.
  6559         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6560
  6561     12  AM-CSR-CODE                       PIC X(4).
  6562
  6563     12  AM-BILLING-STATUS                 PIC X.
  6564         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6565         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6566     12  AM-AUTO-REFUND-SW                 PIC X.
  6567         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6568         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6569     12  AM-GPCD                           PIC 99.
  6570     12  AM-IG                             PIC X.
  6571         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6572         88  AM-HAS-GROUP                     VALUE '2'.
  6573     12  AM-STATUS                         PIC X.
  6574         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6575         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6576         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6577         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6578         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6579         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6580     12  AM-REMIT-TO                       PIC 99.
  6581     12  AM-ID-NO                          PIC X(11).
  6582
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 121
* EL050.cbl
  6583     12  AM-CAL-TABLE                      PIC XX.
  6584     12  AM-LF-DEVIATION                   PIC XXX.
  6585     12  AM-AH-DEVIATION                   PIC XXX.
  6586     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6587     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6588     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6589     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6590     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6591     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6592
  6593     12  AM-USER-FIELDS.
  6594         16  AM-FLD-1                      PIC XX.
  6595         16  AM-FLD-2                      PIC XX.
  6596         16  AM-FLD-3                      PIC XX.
  6597         16  AM-FLD-4                      PIC XX.
  6598         16  AM-FLD-5                      PIC XX.
  6599
  6600     12  AM-1ST-PROD-DATE.
  6601         16  AM-1ST-PROD-YR                PIC XX.
  6602         16  AM-1ST-PROD-MO                PIC XX.
  6603         16  AM-1ST-PROD-DA                PIC XX.
  6604     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6605     12  AM-CERTS-PURGED-DATE.
  6606         16  AM-PUR-YR                     PIC XX.
  6607         16  AM-PUR-MO                     PIC XX.
  6608         16  AM-PUR-DA                     PIC XX.
  6609     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6610     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6611     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6612     12  AM-INACTIVE-DATE.
  6613         16  AM-INA-MO                     PIC 99.
  6614         16  AM-INA-DA                     PIC 99.
  6615         16  AM-INA-YR                     PIC 99.
  6616     12  AM-AR-HI-CERT-DATE                PIC XX.
  6617
  6618     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6619     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6620
  6621     12  AM-OB-PAYMENT-MODE                PIC X.
  6622         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6623         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6624         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6625         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6626
  6627     12  AM-AH-ONLY-INDICATOR              PIC X.
  6628         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6629         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6630
  6631     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6632
  6633     12  AM-OVER-SHORT.
  6634         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6635         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6636
  6637     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6638     12  AM-DCC-CLP-STATE                  PIC XX.
  6639
  6640     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 122
* EL050.cbl
  6641     12  AM-RECALC-REIN                    PIC X.
  6642
  6643     12  AM-REI-TABLE                      PIC XXX.
  6644     12  AM-REI-ET-LF                      PIC X.
  6645     12  AM-REI-ET-AH                      PIC X.
  6646     12  AM-REI-PE-LF                      PIC X.
  6647     12  AM-REI-PE-AH                      PIC X.
  6648     12  AM-REI-PRT-ST                     PIC X.
  6649     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6650     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6651     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6652     12  AM-REI-GROUP-A                    PIC X(6).
  6653     12  AM-REI-MORT                       PIC X(4).
  6654     12  AM-REI-PRT-OW                     PIC X.
  6655     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6656     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6657     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6658     12  AM-REI-GROUP-B                    PIC X(6).
  6659
  6660     12  AM-TRUST-TYPE                     PIC X(2).
  6661
  6662     12  AM-EMPLOYER-STMT-USED             PIC X.
  6663     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6664
  6665     12  AM-STD-AH-TYPE                    PIC XX.
  6666     12  AM-EARN-METHODS.
  6667         16  AM-EARN-METHOD-R              PIC X.
  6668             88 AM-REF-RL-R78                 VALUE 'R'.
  6669             88 AM-REF-RL-PR                  VALUE 'P'.
  6670             88 AM-REF-RL-MEAN                VALUE 'M'.
  6671             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6672         16  AM-EARN-METHOD-L              PIC X.
  6673             88 AM-REF-LL-R78                 VALUE 'R'.
  6674             88 AM-REF-LL-PR                  VALUE 'P'.
  6675             88 AM-REF-LL-MEAN                VALUE 'M'.
  6676             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6677         16  AM-EARN-METHOD-A              PIC X.
  6678             88 AM-REF-AH-R78                 VALUE 'R'.
  6679             88 AM-REF-AH-PR                  VALUE 'P'.
  6680             88 AM-REF-AH-MEAN                VALUE 'M'.
  6681             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6682             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6683             88 AM-REF-AH-NET                 VALUE 'N'.
  6684
  6685     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6686     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6687     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6688
  6689     12  AM-RET-Y-N                        PIC X.
  6690     12  AM-RET-P-E                        PIC X.
  6691     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6692     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6693     12  AM-RET-GRP                        PIC X(6).
  6694     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6695         16  AM-POOL-PRIME                 PIC XXX.
  6696         16  AM-POOL-SUB                   PIC XXX.
  6697     12  AM-RETRO-EARNINGS.
  6698         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 123
* EL050.cbl
  6699         16  AM-RET-EARN-L                 PIC X.
  6700         16  AM-RET-EARN-A                 PIC X.
  6701     12  AM-RET-ST-TAX-USE                 PIC X.
  6702         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6703         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6704     12  AM-RETRO-BEG-EARNINGS.
  6705         16  AM-RET-BEG-EARN-R             PIC X.
  6706         16  AM-RET-BEG-EARN-L             PIC X.
  6707         16  AM-RET-BEG-EARN-A             PIC X.
  6708     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6709     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6710
  6711     12  AM-USER-SELECT-OPTIONS.
  6712         16  AM-USER-SELECT-1              PIC X(10).
  6713         16  AM-USER-SELECT-2              PIC X(10).
  6714         16  AM-USER-SELECT-3              PIC X(10).
  6715         16  AM-USER-SELECT-4              PIC X(10).
  6716         16  AM-USER-SELECT-5              PIC X(10).
  6717
  6718     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6719
  6720     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6721
  6722     12  AM-RPT045A-SWITCH                 PIC X.
  6723         88  RPT045A-OFF                   VALUE 'N'.
  6724
  6725     12  AM-INSURANCE-LIMITS.
  6726         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6727         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6728
  6729     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6730         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6731
  6732     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6733         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6734         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6735
  6736     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6737
  6738     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6739     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6740     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6741     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6742     12  AM-DCC-UEF-STATE                  PIC XX.
  6743     12  FILLER                            PIC XXX.
  6744     12  AM-REPORT-CODE-3                  PIC X(10).
  6745*    12  FILLER                            PIC X(22).
  6746
  6747     12  AM-RESERVE-DATE.
  6748         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6749         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6750         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6751
  6752     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6753     12  AM-NOTIFICATION-TYPES.
  6754         16  AM-NOTIF-OF-LETTERS           PIC X.
  6755         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6756         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 124
* EL050.cbl
  6757         16  AM-NOTIF-OF-STATUS            PIC X.
  6758
  6759     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6760         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6761         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6762         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6763         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6764
  6765     12  AM-BENEFIT-CONTROLS.
  6766         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6767             20  AM-BENEFIT-CODE           PIC XX.
  6768             20  AM-BENEFIT-TYPE           PIC X.
  6769             20  AM-BENEFIT-REVISION       PIC XXX.
  6770             20  AM-BENEFIT-REM-TERM       PIC X.
  6771             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6772             20  FILLER                    PIC XX.
  6773         16  FILLER                        PIC X(80).
  6774
  6775     12  AM-TRANSFER-DATA.
  6776         16  AM-TRANSFERRED-FROM.
  6777             20  AM-TRNFROM-CARRIER        PIC X.
  6778             20  AM-TRNFROM-GROUPING.
  6779                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6780                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6781             20  AM-TRNFROM-STATE          PIC XX.
  6782             20  AM-TRNFROM-ACCOUNT.
  6783                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6784                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6785             20  AM-TRNFROM-DTE            PIC XX.
  6786         16  AM-TRANSFERRED-TO.
  6787             20  AM-TRNTO-CARRIER          PIC X.
  6788             20  AM-TRNTO-GROUPING.
  6789                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6790                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6791             20  AM-TRNTO-STATE            PIC XX.
  6792             20  AM-TRNTO-ACCOUNT.
  6793                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6794                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6795             20  AM-TRNTO-DTE              PIC XX.
  6796         16  FILLER                        PIC X(10).
  6797
  6798     12  AM-SAVED-REMIT-TO                 PIC 99.
  6799
  6800     12  AM-COMM-STRUCTURE-SAVED.
  6801         16  AM-DEFN-1-SAVED.
  6802             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6803                 24  AM-AGT-SV             PIC X(10).
  6804                 24  AM-COM-TYP-SV         PIC X.
  6805                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6806                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6807                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6808                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6809                 24  FILLER                PIC X.
  6810                 24  AM-GL-CODES-SV        PIC X.
  6811                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6812                 24  FILLER                PIC X.
  6813         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6814             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 125
* EL050.cbl
  6815                 24  FILLER                PIC X(11).
  6816                 24  AM-L-COMA-SV          PIC XXX.
  6817                 24  AM-J-COMA-SV          PIC XXX.
  6818                 24  AM-A-COMA-SV          PIC XXX.
  6819                 24  FILLER                PIC X(6).
  6820
  6821     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6822         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6823            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6824            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6825            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6826
  6827     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6828     12  FILLER                            PIC X(120).
  6829
  6830     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6831         16  AM-CONTROL-NAME               PIC X(30).
  6832         16  AM-EXECUTIVE-ONE.
  6833             20  AM-EXEC1-NAME             PIC X(15).
  6834             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6835                                                          COMP-3.
  6836             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6837                                                          COMP-3.
  6838         16  AM-EXECUTIVE-TWO.
  6839             20  AM-EXEC2-NAME             PIC X(15).
  6840             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6841                                                          COMP-3.
  6842             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6843                                                          COMP-3.
  6844
  6845     12  AM-RETRO-ADDITIONAL-DATA.
  6846         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6847         16  AM-RETRO-PREM-P-E             PIC X.
  6848         16  AM-RETRO-CLMS-P-I             PIC X.
  6849         16  AM-RETRO-RET-BRACKET-LF.
  6850             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6851                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6852                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6853             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6854                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6855                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6856             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6857                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6858                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6859         16  AM-RETRO-RET-BRACKET-AH.
  6860             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6861                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6862                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6863                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6864             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6865                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6866                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6867             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6868                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6869                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6870
  6871     12  AM-COMMENTS.
  6872         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 126
* EL050.cbl
  6873
  6874     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6875         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6876         16  AM-FLI-BILLING-CODE           PIC X.
  6877         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6878         16  AM-FLI-UNITED-IDENT           PIC X.
  6879         16  AM-FLI-INTEREST-LOST-DATA.
  6880             20  AM-FLI-BANK-NO            PIC X(5).
  6881             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6882             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6883             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6884         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6885             20  AM-FLI-AGT                PIC X(9).
  6886             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6887             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6888         16  FILLER                        PIC X(102).
  6889
  6890     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6891         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6892             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6893             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6894             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6895             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6896             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6897         16  FILLER                          PIC X(10).
  6898******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 127
* EL050.cbl
  6900*    COPY ERCREIN.
  6901******************************************************************
  6902*                                                                *
  6903*                            ERCREIN                             *
  6904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6905*                            VMOD=2.010                          *
  6906*                                                                *
  6907*   ONLINE CREDIT SYSTEM                                         *
  6908*                                                                *
  6909*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6910*                                                                *
  6911*   FILE TYPE = VSAM,KSDS                                        *
  6912*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6913*                                                                *
  6914*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6915*       ALTERNATE PATH = NONE                                    *
  6916*                                                                *
  6917*   LOG = NO                                                     *
  6918*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6919*                                                                *
  6920******************************************************************
  6921*                   C H A N G E   L O G
  6922*
  6923* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6924*-----------------------------------------------------------------
  6925*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6926* EFFECTIVE    NUMBER
  6927*-----------------------------------------------------------------
  6928* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6929* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6930******************************************************************
  6931 01  REINSURANCE-RECORD.
  6932     12  RE-RECORD-ID                      PIC XX.
  6933         88  VALID-RE-ID                      VALUE 'RE'.
  6934
  6935     12  RE-CONTROL-PRIMARY.
  6936         16  RE-COMPANY-CD                 PIC X.
  6937         16  RE-KEY.
  6938             20  RE-CODE                   PIC X.
  6939                 88  RE-TABLE-RECORD          VALUE 'A'.
  6940                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6941             20  RE-TABLE                  PIC XXX.
  6942             20  FILLER                    PIC XXX.
  6943         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6944             20  FILLER                    PIC X.
  6945             20  RE-COMPANY.
  6946                 24  RE-COMP-PRIME         PIC XXX.
  6947                 24  RE-COMP-SUB           PIC XXX.
  6948
  6949     12  RE-MAINT-INFORMATION.
  6950         16  RE-LAST-MAINT-DT              PIC XX.
  6951         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6952         16  RE-LAST-MAINT-USER            PIC X(4).
  6953         16  FILLER                        PIC X(10).
  6954
  6955     12  RE-TABLE-DATA.
  6956         16  RE-100-COMP                   PIC 99.
  6957
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 128
* EL050.cbl
  6958         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6959             20  RE-REI-COMP-NO.
  6960                 24  RE-REI-COMP           PIC XXX.
  6961                 24  RE-REI-COMP-SUB       PIC XXX.
  6962             20  RE-LF-QC                  PIC X.
  6963             20  RE-AH-QC                  PIC X.
  6964             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6965             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6966             20  RE-LFAGE-LO               PIC 99.
  6967             20  RE-LFAGE-HI               PIC 99.
  6968             20  RE-AHAGE-LO               PIC 99.
  6969             20  RE-AHAGE-HI               PIC 99.
  6970             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6971             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6972             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6973             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6974             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6975             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6976             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6977             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6978             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6979             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6980             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6981             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6982             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6983             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6984             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6985             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6986             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6987             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6988             20  RE-LF-BEN-CODE            PIC X.
  6989             20  RE-AH-BEN-CODE            PIC X.
  6990             20  RE-INTERACTIVE            PIC X.
  6991             20  RE-REMAINING              PIC X.
  6992             20  RE-LF-RUNOFF-SW           PIC X.
  6993             20  RE-AH-RUNOFF-SW           PIC X.
  6994             20  FILLER                    PIC X(19).
  6995
  6996         16  RE-COMP-INFO-END              PIC X(6).
  6997         16  RE-NSP-ST-CD-LF               PIC XX.
  6998         16  RE-NSP-ST-CD-AH               PIC XX.
  6999         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7000             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7001
  7002         16  FILLER                        PIC X(27).
  7003
  7004     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7005         16  RE-NAME                       PIC X(30).
  7006         16  RE-LF-PE                      PIC X.
  7007         16  RE-AH-PE                      PIC X.
  7008         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7009         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7010         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7011         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7012         16  RE-PRT-ST                     PIC X.
  7013         16  RE-PRT-OW                     PIC X.
  7014         16  RE-MORT-CODE                  PIC X(4).
  7015         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 129
* EL050.cbl
  7016         16  RE-ZERO-LF-FEE                PIC X.
  7017         16  RE-ZERO-AH-FEE                PIC X.
  7018         16  RE-CEDE-NAME                  PIC X(30).
  7019         16  RE-LF-COMM                    PIC X.
  7020         16  RE-AH-COMM                    PIC X.
  7021         16  RE-LF-TAX                     PIC X.
  7022         16  RE-AH-TAX                     PIC X.
  7023         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7024         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7025         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7026
  7027         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7028             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7029
  7030         16  RE-LF-CEDING-FEE-BRACKETS.
  7031             20  RE-LF-FEE-METHOD          PIC X.
  7032                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7033                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7034                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7035                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7036             20  RE-LF-FEE-BASIS           PIC X.
  7037                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7038                 88  RE-LF-NET-CEDED               VALUE '2'.
  7039                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7040                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7041                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7042                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7043                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7044                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7045             20  FILLER                    PIC XXX.
  7046             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7047                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7048                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7049
  7050         16  RE-AH-CEDING-FEE-BRACKETS.
  7051             20  RE-AH-FEE-METHOD          PIC X.
  7052                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7053                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7054                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7055                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7056             20  RE-AH-FEE-BASIS           PIC X.
  7057                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7058                 88  RE-AH-NET-CEDED               VALUE '2'.
  7059                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7060                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7061                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7062                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7063                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7064                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7065             20  FILLER                    PIC XXX.
  7066             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7067                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7068                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7069
  7070         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7071
  7072         16  RE-OLD-CEDING-STMT            PIC X.
  7073
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 130
* EL050.cbl
  7074         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7075         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7076         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7077         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7078         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7079         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7080         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7081         16  RE-MORT-SW                    PIC X.
  7082         16  RE-CEDING-TYPE-FLAG           PIC X.
  7083             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7084             88  RE-CEDED                          VALUE 'C'.
  7085             88  RE-ASSUMED                        VALUE 'A'.
  7086             88  RE-PHANTOM                        VALUE 'P'.
  7087
  7088         16  RE-CEDING-STMT-OPT-A          PIC X.
  7089             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7090         16  RE-CEDING-STMT-OPT-B          PIC X.
  7091             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7092         16  RE-CEDING-STMT-OPT-C          PIC X.
  7093             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7094         16  RE-CEDING-STMT-OPT-D          PIC X.
  7095             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7096         16  RE-CEDING-STMT-OPT-E          PIC X.
  7097             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7098
  7099         16  RE-PRT-CRSV                   PIC X.
  7100
  7101         16  RE-GL-CENTER                  PIC X(4).
  7102
  7103         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7104
  7105         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7106
  7107         16  RE-EARN-STOP-CODE             PIC X.
  7108             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7109             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7110
  7111         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7112             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7113
  7114         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7115         16  FILLER                        PIC X(2281).
  7116
  7117         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7118
  7119******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 131
* EL050.cbl
  7121*    COPY ERCCTBL.
  7122******************************************************************
  7123*                                                                *
  7124*                                                                *
  7125*                            ERCCTBL                             *
  7126*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7127*                            VMOD=2.003
  7128*                                                                *
  7129*   ONLINE CREDIT SYSTEM                                         *
  7130*                                                                *
  7131*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7132*                                                                *
  7133*   FILE TYPE = VSAM,KSDS                                        *
  7134*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7135*                                                                *
  7136*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7137*       ALTERNATE PATH = NONE                                    *
  7138*                                                                *
  7139*   LOG = NO                                                     *
  7140*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7141*                                                                *
  7142*                                                                *
  7143******************************************************************
  7144
  7145 01  COMM-TABLE-RECORD.
  7146     12  CT-RECORD-ID                      PIC XX.
  7147         88  VALID-CT-ID                      VALUE 'CT'.
  7148
  7149     12  CT-CONTROL-PRIMARY.
  7150         16  CT-COMPANY-CD                 PIC X.
  7151         16  CT-TABLE                      PIC XXX.
  7152         16  CT-CNTRL-2.
  7153             20  CT-BEN-TYPE               PIC X.
  7154             20  CT-BEN-CODE               PIC XX.
  7155
  7156     12  CT-MAINT-INFORMATION.
  7157         16  CT-LAST-MAINT-DT              PIC XX.
  7158         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7159         16  CT-LAST-MAINT-USER            PIC X(4).
  7160         16  FILLER                        PIC X(31).
  7161
  7162     12  CT-LIMITS.
  7163         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7164
  7165         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7166
  7167         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7168
  7169     12  CT-RATES.
  7170         16  CT-RTX          OCCURS 27 TIMES.
  7171             20  CT-RT                     PIC SV9(5)     COMP-3.
  7172             20  CT-RT-R   REDEFINES
  7173                 CT-RT                     PIC XXX.
  7174
  7175     12  FILLER                            PIC  X(42).
  7176
  7177******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 132
* EL050.cbl
  7179*    COPY ERCFORM.
  7180******************************************************************
  7181*                                                                *
  7182*                                                                *
  7183*                            ERCFORM.                            *
  7184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7185*                            VMOD=2.003                          *
  7186*                                                                *
  7187*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7188*                                                                *
  7189*    FILE TYPE = VSAM,KSDS                                       *
  7190*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7191*                                                                *
  7192*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7193*                                                                *
  7194*    LOG = YES                                                   *
  7195*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7196******************************************************************
  7197 01  FORM-MASTER.
  7198    12  FO-RECORD-ID                 PIC X(02).
  7199        88  VALID-FO-ID                  VALUE 'FO'.
  7200
  7201    12  FO-CONTROL-PRIMARY.
  7202        16  FO-COMPANY-CD            PIC X(01).
  7203        16  FO-STATE                 PIC X(02).
  7204        16  FO-FORM-ID               PIC X(12).
  7205        16  FO-FORM-EXP-DT           PIC X(02).
  7206
  7207    12  FO-POLICY-FORM-DATA.
  7208        16  FO-IND-GRP-CD            PIC X(01).
  7209        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7210        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7211        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7212        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7213        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7214        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7215        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7216        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7217        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7218        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7219        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7220        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7221        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7222        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7223        16  FO-APP-CERT-USE-CD       PIC X(01).
  7224
  7225    12  FILLER                       PIC X(29).
  7226
  7227    12  FO-FORM-PLAN-TABLE.
  7228        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7229            20  FO-PLAN-TYPE         PIC X(01).
  7230            20  FO-PLAN-ID           PIC X(02).
  7231            20  FO-PLAN-TERM         PIC 9(03).
  7232            20  FO-PLAN-REFUND-METHOD
  7233                                     PIC X.
  7234
  7235    12  FILLER                       PIC X(30).
  7236
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 133
* EL050.cbl
  7237    12  FO-COMMENTS-AREA.
  7238        16  FO-COMMENT-LINE-1        PIC X(78).
  7239
  7240    12  FILLER                       PIC X(20).
  7241
  7242    12  FO-MAINT-INFORMATION.
  7243        16  FO-LAST-MAINT-DT         PIC X(02).
  7244        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7245        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 134
* EL050.cbl
  7247*    COPY ELCMSTR.
  7248******************************************************************
  7249*                                                                *
  7250*                            ELCMSTR.                            *
  7251*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7252*                            VMOD=2.012                          *
  7253*                                                                *
  7254*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7255*                                                                *
  7256*   FILE TYPE = VSAM,KSDS                                        *
  7257*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7258*                                                                *
  7259*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7260*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7261*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7262*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7263*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7264*                                                 RKP=75,LEN=21  *
  7265*                                                                *
  7266*   **** NOTE ****                                               *
  7267*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7268*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7269*                                                                *
  7270*   LOG = YES                                                    *
  7271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7272******************************************************************
  7273*                   C H A N G E   L O G
  7274*
  7275* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7276*-----------------------------------------------------------------
  7277*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7278* EFFECTIVE    NUMBER
  7279*-----------------------------------------------------------------
  7280* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7281* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7282* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7283******************************************************************
  7284 01  CLAIM-MASTER.
  7285     12  CL-RECORD-ID                PIC XX.
  7286         88  VALID-CL-ID         VALUE 'CL'.
  7287
  7288     12  CL-CONTROL-PRIMARY.
  7289         16  CL-COMPANY-CD           PIC X.
  7290         16  CL-CARRIER              PIC X.
  7291         16  CL-CLAIM-NO             PIC X(7).
  7292         16  CL-CERT-NO.
  7293             20  CL-CERT-PRIME       PIC X(10).
  7294             20  CL-CERT-SFX         PIC X.
  7295
  7296     12  CL-CONTROL-BY-NAME.
  7297         16  CL-COMPANY-CD-A1        PIC X.
  7298         16  CL-INSURED-LAST-NAME    PIC X(15).
  7299         16  CL-INSURED-NAME.
  7300             20  CL-INSURED-1ST-NAME PIC X(12).
  7301             20  CL-INSURED-MID-INIT PIC X.
  7302
  7303     12  CL-CONTROL-BY-SSN.
  7304         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 135
* EL050.cbl
  7305         16  CL-SOC-SEC-NO.
  7306             20  CL-SSN-STATE        PIC XX.
  7307             20  CL-SSN-ACCOUNT      PIC X(6).
  7308             20  CL-SSN-LN3          PIC X(3).
  7309
  7310     12  CL-CONTROL-BY-CERT-NO.
  7311         16  CL-COMPANY-CD-A4        PIC X.
  7312         16  CL-CERT-NO-A4.
  7313             20  CL-CERT-A4-PRIME    PIC X(10).
  7314             20  CL-CERT-A4-SFX      PIC X.
  7315
  7316     12  CL-CONTROL-BY-CCN.
  7317         16  CL-COMPANY-CD-A5        PIC X.
  7318         16  CL-CCN-A5.
  7319             20  CL-CCN.
  7320                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7321                 24  CL-CCN-PRIME-A5 PIC X(12).
  7322             20  CL-CCN-FILLER-A5    PIC X(4).
  7323
  7324     12  CL-INSURED-PROFILE-DATA.
  7325         16  CL-INSURED-BIRTH-DT     PIC XX.
  7326         16  CL-INSURED-SEX-CD       PIC X.
  7327             88  INSURED-IS-MALE        VALUE 'M'.
  7328             88  INSURED-IS-FEMALE      VALUE 'F'.
  7329             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7330         16  CL-INSURED-OCC-CD       PIC X(6).
  7331         16  FILLER                  PIC X(5).
  7332
  7333     12  CL-PROCESSING-INFO.
  7334         16  CL-PROCESSOR-ID         PIC X(4).
  7335         16  CL-CLAIM-STATUS         PIC X.
  7336             88  CLAIM-IS-OPEN          VALUE 'O'.
  7337             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7338         16  CL-CLAIM-TYPE           PIC X.
  7339*            88  AH-CLAIM               VALUE 'A'.
  7340*            88  LIFE-CLAIM             VALUE 'L'.
  7341*            88  PROPERTY-CLAIM         VALUE 'P'.
  7342*            88  IUI-CLAIM              VALUE 'I'.
  7343*            88  GAP-CLAIM              VALUE 'G'.
  7344         16  CL-CLAIM-PREM-TYPE      PIC X.
  7345             88  SINGLE-PREMIUM         VALUE '1'.
  7346             88  O-B-COVERAGE           VALUE '2'.
  7347             88  OPEN-END-COVERAGE      VALUE '3'.
  7348         16  CL-INCURRED-DT          PIC XX.
  7349         16  CL-REPORTED-DT          PIC XX.
  7350         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7351         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7352         16  CL-LAST-PMT-DT          PIC XX.
  7353         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7354         16  CL-PAID-THRU-DT         PIC XX.
  7355         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7356         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7357         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7358         16  CL-PMT-CALC-METHOD      PIC X.
  7359             88  CL-360-DAY-YR          VALUE '1'.
  7360             88  CL-365-DAY-YR          VALUE '2'.
  7361             88  CL-FULL-MONTHS         VALUE '3'.
  7362         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 136
* EL050.cbl
  7363
  7364         16  CL-PRIME-CERT-NO.
  7365             20  CL-PRIME-CERT-PRIME PIC X(10).
  7366             20  CL-PRIME-CERT-SFX   PIC X.
  7367
  7368         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7369             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7370             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7371
  7372         16  CL-MICROFILM-NO         PIC X(10).
  7373         16  CL-PROG-FORM-TYPE       PIC X.
  7374         16  CL-LAST-ADD-ON-DT       PIC XX.
  7375
  7376         16  CL-LAST-REOPEN-DT       PIC XX.
  7377         16  CL-LAST-CLOSE-DT        PIC XX.
  7378         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7379             88  FINAL-PAID             VALUE '1'.
  7380             88  CLAIM-DENIED           VALUE '2'.
  7381             88  AUTO-CLOSE             VALUE '3'.
  7382             88  MANUAL-CLOSE           VALUE '4'.
  7383             88  BENEFITS-CHANGED       VALUE 'C'.
  7384             88  SETUP-ERRORS           VALUE 'E'.
  7385         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7386         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7387         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7388             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7389         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7390         16  FILLER                  PIC X.
  7391
  7392     12  CL-CERTIFICATE-DATA.
  7393         16  CL-CERT-ORIGIN          PIC X.
  7394             88  CERT-WAS-ONLINE        VALUE '1'.
  7395             88  CERT-WAS-CREATED       VALUE '2'.
  7396             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7397         16  CL-CERT-KEY-DATA.
  7398             20  CL-CERT-CARRIER     PIC X.
  7399             20  CL-CERT-GROUPING    PIC X(6).
  7400             20  CL-CERT-STATE       PIC XX.
  7401             20  CL-CERT-ACCOUNT.
  7402                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7403                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7404             20  CL-CERT-EFF-DT      PIC XX.
  7405
  7406     12  CL-STATUS-CONTROLS.
  7407         16  CL-PRIORITY-CD          PIC X.
  7408             88  CONFIDENTIAL-DATA      VALUE '8'.
  7409             88  HIGHEST-PRIORITY       VALUE '9'.
  7410         16  CL-SUPV-ATTN-CD         PIC X.
  7411             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7412             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7413         16  CL-PURGED-DT            PIC XX.
  7414         16  CL-RESTORED-DT          PIC XX.
  7415         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7416         16  CL-NEXT-RESEND-DT       PIC XX.
  7417         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7418         16  CL-CRITICAL-PERIOD      PIC 99.
  7419*        16  FILLER                  PIC XX.
  7420         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 137
* EL050.cbl
  7421         16  CL-LAST-MAINT-USER      PIC X(4).
  7422         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7423         16  CL-LAST-MAINT-TYPE      PIC X.
  7424             88  CLAIM-SET-UP           VALUE ' '.
  7425             88  PAYMENT-MADE           VALUE '1'.
  7426             88  LETTER-SENT            VALUE '2'.
  7427             88  MASTER-WAS-ALTERED     VALUE '3'.
  7428             88  MASTER-WAS-RESTORED    VALUE '4'.
  7429             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7430             88  FILE-CONVERTED         VALUE '6'.
  7431             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7432             88  ERROR-CORRECTION       VALUE 'E'.
  7433         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7434         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7435         16  CL-BENEFICIARY          PIC X(10).
  7436         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7437         16  CL-DENIAL-TYPE          PIC X.
  7438             88  CL-TYPE-DENIAL          VALUE '1'.
  7439             88  CL-TYPE-RESCISSION      VALUE '2'.
  7440             88  CL-TYPE-REFORMATION     VALUE '3'.
  7441             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7442             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7443         16  CL-CRIT-PER-RECURRENT   PIC X.
  7444         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7445         16  CL-RTW-DT               PIC XX.
  7446
  7447     12  CL-TRAILER-CONTROLS.
  7448         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7449             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7450             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7451             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7452         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7453         16  FILLER                  PIC XX.
  7454         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7455         16  CL-ADDRESS-TRAILER-CNT.
  7456             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7457                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7458             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7459                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7460             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7461                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7462             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7463                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7464             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7465                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7466             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7467                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7468             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7469                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7470
  7471     12  CL-CV-REFERENCE-NO.
  7472         16  CL-CV-REFNO-PRIME       PIC X(18).
  7473         16  CL-CV-REFNO-SFX         PIC XX.
  7474
  7475     12  CL-FILE-LOCATION            PIC X(4).
  7476
  7477     12  CL-PROCESS-ERRORS.
  7478         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 138
* EL050.cbl
  7479             88  NO-FATAL-ERRORS        VALUE ZERO.
  7480         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7481             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7482
  7483     12  CL-PRODUCT-CD               PIC X.
  7484
  7485     12  CL-CURRENT-KEY-DATA.
  7486         16  CL-CURRENT-CARRIER      PIC X.
  7487         16  CL-CURRENT-GROUPING     PIC X(6).
  7488         16  CL-CURRENT-STATE        PIC XX.
  7489         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7490
  7491     12  CL-ASSOCIATES               PIC X.
  7492         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7493         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7494         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7495         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7496
  7497     12  CL-ACTIVITY-CODE            PIC 99.
  7498     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7499     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7500
  7501     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7502     12  CL-LAG-REPORT-CODE          PIC 9.
  7503     12  CL-LOAN-TYPE                PIC XX.
  7504     12  CL-LEGAL-STATE              PIC XX.
  7505
  7506     12  CL-YESNOSW                  PIC X.
  7507     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7508         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7509         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7510         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7511     12  cl-insured-claim            pic x.
  7512         88  cl-claim-on-primary         value 'P'.
  7513         88  cl-claim-on-secondary       value 'S'.
  7514     12  cl-benefit-expiration-dt    PIC XX.
  7515
  7516 01  PLAN-RECORDS.
  7517     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7518     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7519
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 139
* EL050.cbl
  7521 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7522                          ACCOUNT-MASTER REINSURANCE-RECORD
  7523                          COMM-TABLE-RECORD FORM-MASTER
  7524                          CLAIM-MASTER PLAN-RECORDS.
  7525 0000-DFHEXIT SECTION.
  7526     MOVE '9#                    $   ' TO DFHEIV0.
  7527     MOVE 'EL050' TO DFHEIV1.
  7528     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7529
  7530     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7531
  7532
  7533* EXEC CICS  HANDLE CONDITION
  7534*           ERROR    (9300-ABEND)
  7535*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7536*    END-EXEC.
  7537*    MOVE '"$.J                  ! " #00007528' TO DFHEIV0
  7538     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7540     MOVE X'2220233030303037353238' TO DFHEIV0(25:11)
  7541     CALL 'kxdfhei1' USING DFHEIV0
  7542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7543
  7544
  7545 0000-COPY-PROCEDURE-DIV.
  7546*                          COPY ELC50PD.
  7547******************************************************************
  7548*                                                                *
  7549*                            ELC50PD                             *
  7550*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7551*                            VMOD=2.188                          *
  7552*                                                                *
  7553******************************************************************
  7554*                   C H A N G E   L O G
  7555*
  7556* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7557*-----------------------------------------------------------------
  7558*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7559* EFFECTIVE    NUMBER
  7560*-----------------------------------------------------------------
  7561* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7562* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7563* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7564*                             2709 AND 2718
  7565* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7566* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7567* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7568* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7569* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7570*                                IS OPEN OR CNC DT < PD THRU
  7571* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7572* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7573* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7574* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7575* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7576* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7577* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7578* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 140
* EL050.cbl
  7579* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7580* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7581* 020906                   PEMA  EXPAND LOAN OFFICER
  7582* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7583* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7584* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7585* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7586* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7587* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7588* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7589* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7590* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7591* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7592* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7593* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7594* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7595* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7596* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7597* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7598* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7599* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7600* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7601* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7602* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7603* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7604* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7605* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7606* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7607*                                UPDATE VIN ON CERT TRAILER
  7608* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7609* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7610* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7611* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7612* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7613* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7614* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7615* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7616* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7617* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7618* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7619* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7620* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7621* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7622* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7623* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7624* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7625* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7626* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7627* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7628* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7629* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7630* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7631* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7632* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7633* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7634* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7635* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7636* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 141
* EL050.cbl
  7637* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7638* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7639* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7640* 032912  CR2011110200001  PEMA  AHL CHANGES
  7641* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7642* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7643* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7644* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7645* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7646* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7647* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7648* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7649* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7650* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7651* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7652* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7653* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7654* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7655* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7656* 102813  IR2013102100001  PEMA  CORRECT VOID INTFCE SW 2
  7657******************************************************************
  7658************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7659******************************************************************
  7660
  7661     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7662
  7663     MOVE SPACES                 TO PB-FATAL-FLAG
  7664                                    PB-FORCE-ER-CD
  7665                                    PB-WARN-ER-CD
  7666                                    PB-OUT-BAL-CD.
  7667
  7668     MOVE SPACE                  TO WS-IG-OVRD-AH
  7669                                    WS-IG-OVRD-LF
  7670                                    WS-IG-OVRD-AM
  7671                                    WS-IG-OVRD
  7672                                    WS-IG-OVRD-AH-PL
  7673                                    WS-IG-OVRD-LF-PL
  7674                                    WS-IG-OVRD-AH-BEN
  7675                                    WS-IG-OVRD-LF-BEN.
  7676
  7677******************************************************************
  7678*************       INITIALIZE COMMON ERRORS       ***************
  7679******************************************************************
  7680
  7681     MOVE +0                     TO PB-NO-OF-ERRORS.
  7682     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7683
  7684******************************************************************
  7685
  7686     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7687     SET JULIAN-TO-BIN           TO TRUE.
  7688*    MOVE 5                      TO DC-OPTION-CODE.
  7689     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7690     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7691
  7692     MOVE ZERO                   TO  SUB4.
  7693
  7694 0040-INITIALIZE-GA-BILL-DT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 142
* EL050.cbl
  7695
  7696     ADD +1                      TO  SUB4.
  7697
  7698     IF  SUB4 GREATER THAN +5
  7699         GO TO 0050-CHECK-CNTL-FOUND.
  7700
  7701     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7702         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7703
  7704     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7705
  7706 0050-CHECK-CNTL-FOUND.
  7707
  7708     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7709        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7710                                         WS-AH-REM-TERM-CALC
  7711                                         EC-CO-REM-TERM-CALC
  7712        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7713        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7714        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7715                                         WS-TOL-AH-CLAIM
  7716        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7717                                         WS-TOL-AH-PREM
  7718                                         EC-CO-TOL-PREM
  7719        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7720                                         WS-TOL-AH-REFUND
  7721                                         EC-CO-TOL-REFUND
  7722        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7723                                         WS-AH-REFUND-OVS-AMT
  7724                                         EC-CO-OVR-SHT-AMT
  7725        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7726                                         WS-TOL-AH-PREM-PCT
  7727                                         EC-CO-TOL-PREM-PCT
  7728        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7729                                         WS-TOL-AH-REFUND-PCT
  7730                                         EC-CO-TOL-REFUND-PCT
  7731        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7732                                         WS-AH-REFUND-OVS-PCT
  7733                                         EC-CO-OVR-SHT-PCT
  7734        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7735        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7736        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7737        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7738        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7739        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7740        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7741        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7742        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7743        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7744        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7745        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7746                                         EC-CO-MONTH-END-DT
  7747        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7748          GO TO 0100-READ-ACCT.
  7749
  7750     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7751     MOVE SPACES                 TO CNTL-ACCESS.
  7752     MOVE '1'                    TO CNTL-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 143
* EL050.cbl
  7753     MOVE +0                     TO CNTL-SEQ-NO.
  7754
  7755     MOVE '1' TO RC-SW-1.
  7756     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7757     IF NOT CF-COMPANY-MASTER
  7758         MOVE ZEROS             TO WK-CO-TOL-PREM
  7759                                   WK-CO-TOL-CLAIM
  7760                                   WK-CO-TOL-REFUND
  7761                                   WK-REFUND-OVS-AMT
  7762                                   WK-REFUND-OVS-PCT
  7763                                   WK-CO-TOL-PREM-PCT
  7764                                   WK-CO-TOL-REFUND-PCT
  7765                                   WK-DEFAULT-APR
  7766                                   WK-CO-MAX-CAP
  7767        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7768                                   WK-CR-R78-METHOD
  7769                                   WK-CO-REF-REJECT-SW
  7770                                   WK-CO-PREM-REJECT-SW
  7771                                   WK-REM-TRM-CALC-OPTION
  7772                                   WK-BIRTH-DATE-INPUT
  7773                                   WK-JOINT-AGE-INPUT
  7774        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7775        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7776        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7777        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7778          GO TO 0099-COMPANY-NOT-FOUND.
  7779
  7780     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7781        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7782     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7783        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7784     IF CF-CO-TOL-CAP NOT NUMERIC
  7785        MOVE +0                    TO CF-CO-TOL-CAP.
  7786     IF CF-DEFAULT-APR NOT NUMERIC
  7787        MOVE +0                    TO CF-DEFAULT-APR.
  7788
  7789     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7790     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7791     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7792     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7793     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7794     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7795     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7796     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7797     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7798     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7799     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7800     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7801
  7802     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7803          CF-CO-OVR-SHT-AMT > +0
  7804        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7805
  7806     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7807          CF-CO-OVR-SHT-PCT > +0
  7808        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7809
  7810     IF CF-VALID-REM-TRM-OPTION
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 144
* EL050.cbl
  7811         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7812     ELSE
  7813         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7814
  7815     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7816     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7817     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7818     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7819
  7820     GO TO 0050-CHECK-CNTL-FOUND.
  7821
  7822 0099-COMPANY-NOT-FOUND.
  7823
  7824     MOVE ER-2616                TO WS-ERROR.
  7825     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7826
  7827 0100-READ-ACCT.
  7828
  7829     MOVE SPACES                 TO DATE-RANGE-SW.
  7830
  7831     IF WK-ACCT-ADDR = ZEROS
  7832        GO TO 0102-ACCT-GETMAIN.
  7833
  7834     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7835     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7836     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7837
  7838     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7839        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7840        GO TO 0105-READ-ACCT
  7841     END-IF
  7842
  7843     IF PB-CARRIER NOT = SPACES
  7844        IF PB-CARRIER NOT = AM-VG-CARRIER
  7845           GO TO 0105-READ-ACCT.
  7846
  7847     IF PB-STATE NOT = SPACES
  7848        IF PB-STATE NOT = AM-VG-STATE
  7849           GO TO 0105-READ-ACCT.
  7850
  7851     IF PB-GROUPING NOT = SPACES
  7852        IF PB-GROUPING NOT = AM-VG-GROUPING
  7853           GO TO 0105-READ-ACCT.
  7854
  7855     MOVE 'X'                 TO DATE-RANGE-SW.
  7856
  7857     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7858        MOVE 'X'                 TO DATE-RANGE-SW
  7859        GO TO 0105-READ-ACCT.
  7860
  7861     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7862        GO TO 0105-READ-ACCT.
  7863
  7864     GO TO 0180-ACCOUNT-FOUND.
  7865
  7866 0102-ACCT-GETMAIN.
  7867     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7868     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 145
* EL050.cbl
  7869
  7870 0105-READ-ACCT.
  7871     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7872     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7873     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7874     MOVE PB-STATE               TO ACCT-STATE.
  7875     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7876     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7877
  7878     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7879
  7880     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7881
  7882 0110-FIND-ACCT-TOLERANCES-LOOP.
  7883     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7884
  7885     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7886        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7887        GO TO 0199-ACCT-NOT-FOUND
  7888     END-IF
  7889     IF PB-CARRIER NOT = SPACES
  7890        IF PB-CARRIER NOT = AM-VG-CARRIER
  7891           GO TO 0199-ACCT-NOT-FOUND.
  7892
  7893     IF PB-STATE NOT = SPACES
  7894        IF PB-STATE NOT = AM-VG-STATE
  7895           GO TO 0199-ACCT-NOT-FOUND.
  7896
  7897     IF PB-GROUPING NOT = SPACES
  7898        IF PB-GROUPING NOT = AM-VG-GROUPING
  7899           GO TO 0199-ACCT-NOT-FOUND.
  7900
  7901     MOVE 'X'                    TO DATE-RANGE-SW.
  7902
  7903     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7904        MOVE 'X'                 TO DATE-RANGE-SW
  7905        GO TO 0199-ACCT-NOT-FOUND.
  7906
  7907     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7908        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7909
  7910 0180-ACCOUNT-FOUND.
  7911     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7912     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7913     MOVE AM-STATE               TO PB-SV-STATE.
  7914     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7915
  7916     IF AM-CANCEL-FEE  NOT NUMERIC
  7917        MOVE ZEROS TO AM-CANCEL-FEE.
  7918
  7919     IF AM-MAX-MON-BEN NOT NUMERIC
  7920        MOVE ZEROS TO AM-MAX-MON-BEN.
  7921
  7922     IF AM-MAX-TOT-BEN NOT NUMERIC
  7923        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7924
  7925     IF AM-CLP-TOL-PCT NOT NUMERIC
  7926        MOVE +0                  TO AM-CLP-TOL-PCT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 146
* EL050.cbl
  7927     END-IF
  7928     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7929        MOVE +0                  TO AM-SPP-LEASE-COMM
  7930     END-IF
  7931     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7932        MOVE ER-2611             TO   WS-ERROR
  7933        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7934
  7935     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7936        MOVE ER-2621             TO   WS-ERROR
  7937        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7938
  7939     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7940        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7941        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7942        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7943         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7944
  7945     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7946     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7947     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7948     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7949     IF AM-CLP-TOL-PCT NOT = ZEROS
  7950        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7951     END-IF
  7952     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7953        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7954     END-IF
  7955*    IF PB-COMPANY-ID = 'DCC'
  7956*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7957*                                   WS-ADMIN-FEES
  7958*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7959*          (SUB5 > +10)
  7960*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7961*             AND (AM-A-COM (SUB5) NUMERIC)
  7962*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7963*                + (AM-A-COM (SUB5) * 1000)
  7964*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7965*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7966*                + (AM-A-COM (SUB5) * 1000)
  7967*             END-IF
  7968*             IF AM-COM-TYP (SUB5) = 'N'
  7969*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7970*                + (AM-A-COM (SUB5) * 1000)
  7971*             END-IF
  7972*          END-IF
  7973*       END-PERFORM
  7974*    END-IF
  7975     IF (PB-COMPANY-ID = 'DCC')
  7976        AND (PB-ISSUE)
  7977        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7978        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7979           (SUB5 > +10)
  7980           MOVE +0 TO WS-WK-RATE
  7981           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7982              IF (AM-A-COM (SUB5) NUMERIC)
  7983                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7984                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 147
* EL050.cbl
  7985              ELSE
  7986                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7987                 IF PB-ISSUE
  7988                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7989                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7990                 ELSE
  7991                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7992                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7993                 END-IF
  7994                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7995                 MOVE ZEROS             TO WS-SUB1
  7996                                           WS-COMMISSION
  7997                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7998                 MOVE '0530'               TO CTBL-SW
  7999                 MOVE ' '                  TO WS-CTBL-READ-SW
  8000                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8001                 IF FIRST-TIME-THROUGH
  8002                    MOVE 'AA'              TO CTBL-BEN-CODE
  8003                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8004                 END-IF
  8005                 IF CTBL-TABLE-FOUND
  8006                    IF PB-ISSUE
  8007                       COMPUTE WS-COMM-CK-AMT =
  8008                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8009                    ELSE
  8010                       COMPUTE WS-COMM-CK-AMT =
  8011                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8012                    END-IF
  8013                    PERFORM 8800-GET-COMP-RATE
  8014                              THRU 8800-EXIT
  8015                 END-IF
  8016              END-IF
  8017              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8018                + (WS-WK-RATE * 1000)
  8019           END-IF
  8020        END-PERFORM
  8021     END-IF
  8022     IF PB-COMPANY-ID EQUAL 'CRI'
  8023         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8024
  8025     IF PB-COMPANY-ID EQUAL 'NCL'
  8026         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8027     END-IF
  8028
  8029     GO TO 0200-READ-CERT.
  8030
  8031 0199-ACCT-NOT-FOUND.
  8032
  8033     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8034
  8035     IF DATE-RANGE-SW NOT = SPACES
  8036        MOVE ER-2601             TO WS-ERROR
  8037        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8038     ELSE
  8039        MOVE ER-2619             TO WS-ERROR
  8040        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8041
  8042     GO TO 9990-RETURN.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 148
* EL050.cbl
  8043
  8044 0200-READ-CERT.
  8045
  8046     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8047     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8048     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8049     MOVE PB-SV-STATE            TO CERT-STATE.
  8050     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8051     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8052     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8053
  8054     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8055
  8056     IF CERT-WAS-NOT-FOUND
  8057        GO TO 0299-CERT-NOT-FOUND.
  8058
  8059     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8060        MOVE ER-2759             TO WS-ERROR
  8061        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8062        GO TO 0298-UNLOCK-RETURN.
  8063
  8064     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8065         MOVE ER-2758            TO WS-ERROR
  8066         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8067         GO TO 0298-UNLOCK-RETURN.
  8068
  8069     IF PB-ISSUE
  8070        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8071           IF CERT-WAS-CREATED-FOR-CLAIM
  8072              NEXT SENTENCE
  8073            ELSE
  8074              MOVE ER-2626       TO WS-ERROR
  8075              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8076              GO TO 0298-UNLOCK-RETURN.
  8077
  8078     IF NOT PB-CANCELLATION
  8079        GO TO 0300-CONTINUE-EDIT.
  8080
  8081     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8082     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8083     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8084     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8085     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8086     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8087
  8088     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8089     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8090     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8091     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8092     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8093     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8094     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8095     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8096     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8097
  8098     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8099     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8100     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 149
* EL050.cbl
  8101     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8102     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8103     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8104     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8105
  8106     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8107     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8108
  8109     MOVE CM-CREDIT-INTERFACE-SW-1
  8110                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8111     MOVE CM-CREDIT-INTERFACE-SW-2
  8112                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8113
  8114     IF CM-O-B-COVERAGE
  8115         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8116
  8117     IF CM-LIVES NOT NUMERIC
  8118         MOVE ZERO                TO CM-LIVES.
  8119
  8120     IF CM-BILLED NOT NUMERIC
  8121         MOVE ZERO                TO CM-BILLED.
  8122
  8123     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8124         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8125         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8126         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8127         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8128         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8129         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8130         MOVE CM-LIVES             TO PB-CI-LIVES
  8131*The next line causes a problem with my change  I dont think it is
  8132*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8133
  8134     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8135     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8136     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8137     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8138     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8139     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8140
  8141     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8142     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8143     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8144     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8145
  8146     IF CM-LIFE-COMM-PCT NUMERIC
  8147         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8148     ELSE
  8149         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8150
  8151     IF CM-AH-COMM-PCT NUMERIC
  8152         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8153     ELSE
  8154         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8155
  8156     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8157
  8158     IF CM-LOAN-APR       NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 150
* EL050.cbl
  8159           MOVE ZERO               TO CM-LOAN-APR.
  8160
  8161     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8162           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8163
  8164     IF CM-LOAN-TERM      NOT NUMERIC
  8165           MOVE ZERO               TO CM-LOAN-TERM.
  8166
  8167     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8168           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8169
  8170     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8171           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8172
  8173     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8174     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8175     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8176     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8177     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8178     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8179     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8180     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8181     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8182     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8183     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8184     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8185
  8186     IF CM-STATE = CM-SSN-STATE
  8187         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8188
  8189     IF CM-STATE NOT = CM-MEMB-STATE
  8190         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8191
  8192     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8193
  8194     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8195        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8196        IF CM-ADDL-CLP NOT NUMERIC
  8197           MOVE +0               TO CM-ADDL-CLP
  8198        END-IF
  8199        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8200        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8201           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8202        END-IF
  8203     END-IF
  8204     IF PB-COMPANY-ID = 'DCC'
  8205        MOVE +0                  TO WS-ADMIN-FEES
  8206                                    WS-CSO-ADMIN-FEE
  8207                                    WS-COMM-AND-MFEE
  8208                                    WS-1ST-YR-ALLOW
  8209        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8210           (SUB5 > +10)
  8211           MOVE +0 TO WS-WK-RATE
  8212           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8213              IF (AM-A-COM (SUB5) NUMERIC)
  8214                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8215                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8216              ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 151
* EL050.cbl
  8217                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8218                 IF PB-ISSUE
  8219                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8220                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8221                 ELSE
  8222                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8223                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8224                 END-IF
  8225                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8226                 MOVE ZEROS             TO WS-SUB1
  8227                                           WS-COMMISSION
  8228                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8229                 MOVE '0530'               TO CTBL-SW
  8230                 MOVE ' '                  TO WS-CTBL-READ-SW
  8231                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8232                 IF FIRST-TIME-THROUGH
  8233                    MOVE 'AA'              TO CTBL-BEN-CODE
  8234                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8235                 END-IF
  8236                 IF CTBL-TABLE-FOUND
  8237                    IF PB-ISSUE
  8238                       COMPUTE WS-COMM-CK-AMT =
  8239                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8240                    ELSE
  8241                       COMPUTE WS-COMM-CK-AMT =
  8242                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8243                    END-IF
  8244                    PERFORM 8800-GET-COMP-RATE
  8245                              THRU 8800-EXIT
  8246                 END-IF
  8247              END-IF
  8248              IF AM-COM-TYP (SUB5) = 'I'
  8249                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8250                   + (WS-WK-RATE * 1000)
  8251              END-IF
  8252              IF AM-COM-TYP (SUB5) = 'N'
  8253                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8254                   + (WS-WK-RATE * 1000)
  8255              END-IF
  8256              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8257                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8258                   + (WS-WK-RATE * 1000)
  8259              END-IF
  8260              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8261                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8262                   + (WS-WK-RATE * 1000)
  8263              END-IF
  8264           END-IF
  8265        END-PERFORM
  8266     END-IF
  8267     GO TO 0300-CONTINUE-EDIT.
  8268
  8269 0298-UNLOCK-RETURN.
  8270      PERFORM 9250-UNLOCK-RETURN
  8271      GO TO 9990-RETURN.
  8272
  8273 0299-CERT-NOT-FOUND.
  8274
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 152
* EL050.cbl
  8275     MOVE '1'                     TO CERT-STATUS-SW.
  8276
  8277     IF PB-COMPANY-ID = 'UCL'
  8278         IF WS-ERROR = ER-2799
  8279             GO TO 3000-CONTINUE-EDIT.
  8280
  8281     IF NOT PB-CANCELLATION
  8282         GO TO 0300-CONTINUE-EDIT.
  8283
  8284     MOVE ER-2726                  TO  WS-ERROR.
  8285     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8286     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8287     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8288                                    PB-CI-LF-TERM
  8289                                    PB-C-LF-REM-TERM
  8290                                    PB-CI-AH-TERM
  8291                                    PB-C-AH-REM-TERM
  8292                                    PB-CI-LF-BENEFIT-CD
  8293                                    PB-CI-LF-BENEFIT-AMT
  8294                                    PB-CI-LF-ALT-BENEFIT-AMT
  8295                                    PB-CI-LF-PREMIUM-AMT
  8296                                    PB-CI-LF-ALT-PREMIUM-AMT
  8297                                    PB-CI-AH-BENEFIT-CD
  8298                                    PB-CI-AH-BENEFIT-AMT
  8299                                    PB-CI-AH-PREMIUM-AMT
  8300                                    PB-CI-PAY-FREQUENCY
  8301                                    PB-CI-LOAN-APR
  8302                                    PB-CI-LOAN-TERM
  8303                                    PB-CI-LIFE-COMMISSION
  8304                                    PB-CI-AH-COMMISSION
  8305                                    PB-CI-CURR-SEQ
  8306                                    PB-CI-AH-CANCEL-AMT
  8307                                    PB-CI-LF-CANCEL-AMT
  8308                                    PB-CI-RATE-DEV-PCT-LF
  8309                                    PB-CI-RATE-DEV-PCT-AH
  8310                                    PB-CI-EXTENTION-DAYS
  8311                                    PB-CI-TERM-IN-DAYS
  8312                                    PB-CI-LIVES
  8313                                    PB-CI-LF-CRIT-PER
  8314                                    PB-CI-AH-CRIT-PER
  8315                                    PB-CI-ADDL-CLP
  8316                                    PB-CI-DDF-IU-RATE-UP.
  8317
  8318     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8319                                    PB-CI-AH-SETTLEMENT-DT
  8320                                    PB-CI-DEATH-DT
  8321                                    PB-CI-LF-PRIOR-CANCEL-DT
  8322                                    PB-CI-AH-PRIOR-CANCEL-DT
  8323                                    PB-CI-ENTRY-DT
  8324                                    PB-CI-LF-EXPIRE-DT
  8325                                    PB-CI-AH-EXPIRE-DT
  8326                                    PB-CI-LOAN-1ST-PMT-DT.
  8327
  8328     IF ACCOUNT-MAST-FOUND
  8329        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8330        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8331
  8332     GO TO 3000-CONTINUE-EDIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 153
* EL050.cbl
  8333
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 154
* EL050.cbl
  8335
  8336 0300-CONTINUE-EDIT.
  8337
  8338     IF PB-ISSUE
  8339        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8340            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8341
  8342     IF PB-ISSUE
  8343        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8344            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8345
  8346     IF PB-ISSUE
  8347       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8348          (AM-NO-AH-ONLY)
  8349           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8350               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8351                   MOVE ER-2679 TO WS-ERROR
  8352                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8353
  8354     IF PB-ISSUE
  8355        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8356        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8357        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8358     ELSE
  8359        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8360        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8361        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8362
  8363     MOVE 'N'                    TO PLAN-MASTER-SW
  8364                                    PLAN-MASTER-LIFE-SW
  8365                                    FORM-MASTER-SW
  8366                                    WS-APP-CERT-SW.
  8367
  8368     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8369                                    WS-PL-TOL-LF-REFUND
  8370                                    WS-PL-REF-OVS-AMT
  8371                                    WS-PL-TOL-LF-PREM-PCT
  8372                                    WS-PL-TOL-LF-REFUND-PCT
  8373                                    WS-PL-REF-OVS-PCT
  8374                                    WS-PL-TOL-LF-CLAIM.
  8375
  8376     IF PB-COMPANY-ID = 'NCL'
  8377       IF PB-ISSUE
  8378         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8379             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8380             IF FORM-MASTER-FOUND
  8381                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8382
  8383     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8384        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8385
  8386********************** MON CODE **********************
  8387     IF PB-COMPANY-ID = 'MON'
  8388     IF PB-ISSUE
  8389     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8390        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8391             PB-I-LOAN-APR = ZERO)
  8392               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 155
* EL050.cbl
  8393******************************************************
  8394
  8395     IF PB-COMPANY-ID = 'NCL'
  8396       IF PB-ISSUE
  8397           IF FORM-MASTER-FOUND
  8398             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8399                AM-DISMBR-COVERAGE
  8400                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8401                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8402                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8403                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8404                                           PB-I-LIFE-BENEFIT-CD.
  8405
  8406     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8407
  8408     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8409         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8410         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8411         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8412         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8413         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8414           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8415             GO TO 0301-LIFE-BENEFIT-SEARCH
  8416         ELSE
  8417             NEXT SENTENCE
  8418     ELSE
  8419         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8420
  8421     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8422     MOVE '4'                    TO CNTL-REC-TYPE.
  8423     MOVE +0                     TO CNTL-SEQ-NO.
  8424     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8425
  8426     MOVE '1' TO RC-SW-2.
  8427     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8428
  8429     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8430        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8431         GO TO 0305-BENEFIT-NOT-FOUND.
  8432
  8433     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8434
  8435 0301-LIFE-BENEFIT-SEARCH.
  8436
  8437     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8438
  8439     IF NO-BENEFIT-FOUND
  8440        GO TO 0305-BENEFIT-NOT-FOUND.
  8441
  8442     IF WS-BEN-CD = '99'
  8443        GO TO 0305-BENEFIT-NOT-FOUND.
  8444
  8445     IF PB-COMPANY-ID = 'NCL'
  8446         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8447             GO TO 0304-LIFE-BENEFIT-FOUND.
  8448
  8449     MOVE +1                     TO SUB5.
  8450     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 156
* EL050.cbl
  8451
  8452* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8453* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8454     IF PB-COMPANY-ID = 'DMD'
  8455         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8456
  8457 0302-EDIT-ACCT-LF-BENEFITS.
  8458
  8459     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8460        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8461           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8462                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8463           GO TO 03XX-GET-LIFE-ERPLAN.
  8464
  8465     IF SUB5 LESS THAN +20
  8466        ADD +1                   TO SUB5
  8467        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8468
  8469     MOVE +1                     TO SUB5.
  8470
  8471     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8472        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8473
  8474 0303-EDIT-DMD-EXTRA-BENEFITS.
  8475
  8476     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8477        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8478           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8479                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8480           GO TO 03XX-GET-LIFE-ERPLAN.
  8481
  8482     IF SUB5 LESS THAN +30
  8483        ADD +1                   TO SUB5
  8484        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8485
  8486     MOVE +1                     TO SUB5.
  8487
  8488 03XX-EDIT-FOR-NINETY-LF.
  8489
  8490***************************************************************
  8491*                                                             *
  8492*    NINETY BENEFIT PLAN TYPES:                               *
  8493*                                                             *
  8494*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8495*      92 = ALL GROUP REDUCING BENEFITS                       *
  8496*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8497*      94 = ALL GROUP LEVEL BENEFITS                          *
  8498*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8499*           BENEFIT CONTROLS.                                 *
  8500*      99 = ALL BENEFITS                                      *
  8501*                                                             *
  8502***************************************************************
  8503
  8504     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8505                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8506
  8507     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8508       AND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 157
* EL050.cbl
  8509        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8510        GO TO 03XX-GET-LIFE-ERPLAN.
  8511
  8512     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8513       AND
  8514        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8515        IF CF-REDUCING (SUB3)
  8516           IF (PB-I-INDV-GRP-OVRD = 'I')
  8517              OR
  8518           ((AM-IG = '1') AND
  8519           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8520              OR
  8521           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8522           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8523           (AM-IG NOT = '2'))
  8524              GO TO 03XX-GET-LIFE-ERPLAN.
  8525
  8526     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8527       AND
  8528        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8529        IF CF-REDUCING (SUB3)
  8530           IF (PB-I-INDV-GRP-OVRD = 'G')
  8531              OR
  8532           ((AM-IG = '2') AND
  8533           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8534              OR
  8535           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8536           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8537           (AM-IG NOT = '1'))
  8538              GO TO 03XX-GET-LIFE-ERPLAN.
  8539
  8540     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8541       AND
  8542        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8543        IF CF-LEVEL    (SUB3)
  8544           IF (PB-I-INDV-GRP-OVRD = 'I')
  8545              OR
  8546           ((AM-IG = '1') AND
  8547           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8548              OR
  8549           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8550           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8551            (AM-IG NOT = '2'))
  8552              GO TO 03XX-GET-LIFE-ERPLAN.
  8553
  8554     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8555       AND
  8556        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8557        IF CF-LEVEL    (SUB3)
  8558           IF (PB-I-INDV-GRP-OVRD = 'G')
  8559              OR
  8560           ((AM-IG = '2') AND
  8561           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8562              OR
  8563           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8564           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8565           (AM-IG NOT = '1'))
  8566              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 158
* EL050.cbl
  8567
  8568     IF SUB5 LESS THAN +20
  8569        ADD +1                   TO SUB5
  8570        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8571
  8572     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8573
  8574     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8575        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8576
  8577     MOVE +1                     TO SUB5.
  8578
  8579 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8580
  8581     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8582                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8583
  8584     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8585       AND
  8586        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8587        GO TO 03XX-GET-LIFE-ERPLAN.
  8588
  8589     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8590       AND
  8591        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8592        IF CF-REDUCING (SUB3)
  8593           IF (PB-I-INDV-GRP-OVRD = 'I')
  8594              OR
  8595           ((AM-IG = '1') AND
  8596           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8597              OR
  8598           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8599           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8600           (AM-IG NOT = '2'))
  8601              GO TO 03XX-GET-LIFE-ERPLAN.
  8602
  8603     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8604       AND
  8605        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8606        IF CF-REDUCING (SUB3)
  8607           IF (PB-I-INDV-GRP-OVRD = 'G')
  8608              OR
  8609           ((AM-IG = '2') AND
  8610           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8611              OR
  8612           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8613           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8614           (AM-IG NOT = '1'))
  8615              GO TO 03XX-GET-LIFE-ERPLAN.
  8616
  8617     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8618       AND
  8619        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8620        IF CF-LEVEL    (SUB3)
  8621           IF (PB-I-INDV-GRP-OVRD = 'I')
  8622              OR
  8623           ((AM-IG = '1') AND
  8624           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 159
* EL050.cbl
  8625              OR
  8626           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8627           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8628            (AM-IG NOT = '2'))
  8629              GO TO 03XX-GET-LIFE-ERPLAN.
  8630
  8631     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8632       AND
  8633        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8634        IF CF-LEVEL    (SUB3)
  8635           IF (PB-I-INDV-GRP-OVRD = 'G')
  8636              OR
  8637           ((AM-IG = '2') AND
  8638           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8639              OR
  8640           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8641           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8642           (AM-IG NOT = '1'))
  8643              GO TO 03XX-GET-LIFE-ERPLAN.
  8644
  8645     IF SUB5 LESS THAN +30
  8646        ADD +1                   TO SUB5
  8647        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8648
  8649     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8650
  8651 03XX-EDIT-FOR-NINETY-LF-CONT.
  8652
  8653     MOVE +99                    TO SUB5.
  8654
  8655     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8656        IF PB-ISSUE
  8657           MOVE ER-1924          TO  WS-ERROR
  8658           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8659
  8660     GO TO 0304-LIFE-BENEFIT-FOUND.
  8661
  8662 03XX-GET-LIFE-ERPLAN.
  8663
  8664     IF WK-PLAN-ADDR EQUAL +0
  8665        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8666
  8667     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8668     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8669     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8670     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8671     MOVE 'Y'                    TO PLAN-MASTER-SW
  8672                                    PLAN-MASTER-LIFE-SW.
  8673     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8674
  8675 03XX-ERPLAN-LIFE-GETMAIN.
  8676
  8677     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8678     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8679
  8680 03XX-ERPLAN-LIFE-READ.
  8681
  8682     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 160
* EL050.cbl
  8683     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8684     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8685     MOVE PB-SV-STATE            TO PLAN-STATE.
  8686     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8687     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8688     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8689     MOVE WS-SAVE-BENEFIT-REVISION
  8690                                 TO PLAN-REVISION-NO.
  8691
  8692     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8693     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8694
  8695     IF PB-COMPANY-ID = 'NCL'
  8696       IF NOT LF-PLAN-MASTER-FOUND
  8697         IF NOT PB-POLICY-IS-DECLINED  AND
  8698            NOT PB-POLICY-IS-VOIDED
  8699             MOVE  ER-1921         TO  WS-ERROR
  8700             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8701             GO TO 0304-LIFE-BENEFIT-FOUND.
  8702
  8703     IF NOT LF-PLAN-MASTER-FOUND
  8704        GO TO 0304-LIFE-BENEFIT-FOUND.
  8705
  8706 XXXX-CHECK-LF-PLAN-KEY.
  8707
  8708     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8709        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8710        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8711        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8712        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8713        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8714        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8715        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8716        MOVE 'N'                 TO PLAN-MASTER-SW
  8717          GO TO 03XX-ERPLAN-LIFE-READ.
  8718
  8719     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8720
  8721     IF  PB-CANCELLATION
  8722         GO TO  0303-LF-ACCT-BEN-FOUND.
  8723
  8724     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8725        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8726           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8727           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8728              MOVE ER-2644             TO WS-ERROR
  8729              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8730           ELSE
  8731              NEXT SENTENCE
  8732        ELSE
  8733           IF PB-COMPANY-ID NOT = 'NCL'
  8734              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8735                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8736
  8737 0303-LF-ACCT-BEN-FOUND.
  8738
  8739     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8740
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 161
* EL050.cbl
  8741     IF PL-DEV-CODE NOT = SPACES
  8742        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8743
  8744     IF PL-DEV-PCT NUMERIC AND
  8745        PL-DEV-PCT NOT = ZEROS
  8746        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8747
  8748     IF PL-TOL-PREM-AMT GREATER THAN +0
  8749        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8750
  8751     IF PL-TOL-REF-AMT GREATER THAN +0
  8752        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8753
  8754     IF PL-TOL-PREM-PCT GREATER THAN +0
  8755        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8756
  8757     IF PL-TOL-REF-PCT GREATER THAN +0
  8758        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8759
  8760     IF PL-TOL-CLM-AMT GREATER THAN +0
  8761        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8762
  8763     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8764                          PL-OVER-SHORT-AMT > +0
  8765        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8766
  8767     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8768                          PL-OVER-SHORT-PCT > +0
  8769        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8770
  8771     IF PL-SALES-TAX NUMERIC AND
  8772                          PL-SALES-TAX > +0
  8773         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8774
  8775     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8776        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8777                                    WS-IG-OVRD-AM.
  8778
  8779 0304-LIFE-BENEFIT-FOUND.
  8780
  8781     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8782
  8783     IF PB-ISSUE
  8784        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8785     ELSE
  8786        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8787
  8788     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8789     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8790     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8791     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8792     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8793                                         WS-LF-REFUND-CALC.
  8794
  8795     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8796        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8797
  8798     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 162
* EL050.cbl
  8799        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8800     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8801
  8802     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8803     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8804     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8805     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8806     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8807     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8808
  8809     IF PB-COMPANY-ID = 'NCL'  AND
  8810        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8811         NEXT SENTENCE
  8812     ELSE
  8813         IF SUB5 NOT GREATER THAN +20
  8814            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8815               MOVE WS-SAVE-BENEFIT-REM-TERM
  8816                                      TO WS-AM-LF-BENE-REM-TERM
  8817                                         EC-BR-LF-REM-TERM-CALC.
  8818
  8819     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8820     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8821
  8822     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8823
  8824 0305-BENEFIT-NOT-FOUND.
  8825
  8826     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8827     MOVE ER-2604                TO WS-ERROR.
  8828     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8829
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 163
* EL050.cbl
  8831
  8832 0310-FIND-AH-BENEFIT-RECORD.
  8833
  8834     MOVE 'N'                    TO PLAN-MASTER-SW
  8835                                    PLAN-MASTER-AH-SW.
  8836
  8837     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8838                                    WS-PL-TOL-AH-REFUND
  8839                                    WS-AH-PL-REF-OVS-AMT
  8840                                    WS-PL-TOL-AH-PREM-PCT
  8841                                    WS-PL-TOL-AH-REFUND-PCT
  8842                                    WS-AH-PL-REF-OVS-PCT
  8843                                    WS-PL-TOL-AH-CLAIM.
  8844     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8845
  8846
  8847     if pb-issue
  8848        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8849           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8850        end-if
  8851        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8852           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8853           GO TO 0399-BENEFIT-NOT-FOUND
  8854        end-if
  8855     end-if
  8856
  8857     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8858        GO TO 0400-FIND-CARRIER.
  8859
  8860     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8861
  8862     IF WK-AH-BEN-ADDR NOT = ZEROS
  8863         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8864         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8865         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8866         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8867           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8868             GO TO 0311-AH-BENEFIT-SEARCH
  8869         ELSE
  8870             NEXT SENTENCE
  8871     ELSE
  8872         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8873
  8874     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8875     MOVE '5'                    TO CNTL-REC-TYPE.
  8876     MOVE +0                     TO CNTL-SEQ-NO.
  8877     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8878
  8879     MOVE '2' TO RC-SW-2.
  8880     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8881
  8882     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8883        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8884          GO TO 0399-BENEFIT-NOT-FOUND.
  8885
  8886     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8887
  8888 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 164
* EL050.cbl
  8889
  8890     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8891
  8892     IF NO-BENEFIT-FOUND
  8893         GO TO 0399-BENEFIT-NOT-FOUND.
  8894
  8895     IF WS-BEN-CD = '99'
  8896        GO TO 0399-BENEFIT-NOT-FOUND.
  8897
  8898     IF PB-COMPANY-ID  =  'NCL'
  8899         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8900             GO TO 0314-A-H-BENEFIT-FOUND.
  8901
  8902     MOVE +1                     TO SUB5.
  8903     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8904
  8905* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8906* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8907     IF PB-COMPANY-ID = 'DMD'
  8908         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8909
  8910 0312-EDIT-ACCT-AH-BENEFITS.
  8911
  8912     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8913        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8914           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8915                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8916           GO TO 03XX-GET-AH-ERPLAN.
  8917
  8918     IF SUB5 LESS THAN +20
  8919        ADD +1                   TO SUB5
  8920        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8921
  8922     MOVE +1                     TO SUB5.
  8923
  8924     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8925        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8926
  8927 0313-EDIT-DMD-EXTRA-BENEFITS.
  8928
  8929     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8930        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8931           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8932                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8933           GO TO 03XX-GET-AH-ERPLAN.
  8934
  8935     IF SUB5 LESS THAN +30
  8936        ADD +1                   TO SUB5
  8937        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8938
  8939     MOVE +1                     TO SUB5.
  8940
  8941 03XX-EDIT-FOR-NINETY-AH.
  8942
  8943***************************************************************
  8944*                                                             *
  8945*    NINETY BENEFIT PLAN TYPES:                               *
  8946*                                                             *
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 165
* EL050.cbl
  8947*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8948*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8949*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8950*           BENEFIT CONTROLS.                                 *
  8951*      99 = ALL BENEFITS.                                     *
  8952*                                                             *
  8953***************************************************************
  8954
  8955     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8956                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8957
  8958     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8959       AND
  8960        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8961        GO TO 03XX-GET-AH-ERPLAN.
  8962
  8963     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8964       AND
  8965        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8966           IF (PB-I-INDV-GRP-OVRD = 'I')
  8967              OR
  8968           ((AM-IG = '1') AND
  8969           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8970              OR
  8971           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8972           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8973           (AM-IG NOT = '2'))
  8974              GO TO 03XX-GET-AH-ERPLAN.
  8975
  8976     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8977       AND
  8978        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8979           IF (PB-I-INDV-GRP-OVRD = 'G')
  8980              OR
  8981           ((AM-IG = '2') AND
  8982           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8983              OR
  8984           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8985           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8986           (AM-IG NOT = '1'))
  8987              GO TO 03XX-GET-AH-ERPLAN.
  8988
  8989     IF SUB5 LESS THAN +20
  8990        ADD +1                   TO SUB5
  8991        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8992
  8993     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8994        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8995
  8996     MOVE +1                    TO SUB5.
  8997
  8998 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8999
  9000     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9001                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9002
  9003     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9004       AND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 166
* EL050.cbl
  9005        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9006        GO TO 03XX-GET-AH-ERPLAN.
  9007
  9008     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9009       AND
  9010        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9011           IF (PB-I-INDV-GRP-OVRD = 'I')
  9012              OR
  9013           ((AM-IG = '1') AND
  9014           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9015              OR
  9016           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9017           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9018           (AM-IG NOT = '2'))
  9019              GO TO 03XX-GET-AH-ERPLAN.
  9020
  9021     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9022       AND
  9023        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9024           IF (PB-I-INDV-GRP-OVRD = 'G')
  9025              OR
  9026           ((AM-IG = '2') AND
  9027           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9028              OR
  9029           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9030           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9031           (AM-IG NOT = '1'))
  9032              GO TO 03XX-GET-AH-ERPLAN.
  9033
  9034     IF SUB5 LESS THAN +30
  9035        ADD +1                   TO SUB5
  9036        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9037
  9038 03XX-EDIT-FOR-NINETY-AH-CONT.
  9039
  9040     MOVE +99                    TO SUB5.
  9041
  9042     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9043
  9044     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9045        IF PB-ISSUE
  9046           MOVE ER-1925          TO  WS-ERROR
  9047           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9048
  9049     GO TO 0314-A-H-BENEFIT-FOUND.
  9050
  9051 03XX-GET-AH-ERPLAN.
  9052
  9053     IF WK-PLAN-ADDR EQUAL +0
  9054         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9055
  9056     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9057     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9058     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9059     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9060     MOVE 'Y'                    TO PLAN-MASTER-SW
  9061                                    PLAN-MASTER-AH-SW.
  9062*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 167
* EL050.cbl
  9063     GO TO 03XX-ERPLAN-AH-READ.
  9064
  9065 03XX-ERPLAN-AH-GETMAIN.
  9066
  9067     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9068     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9069
  9070 03XX-ERPLAN-AH-READ.
  9071
  9072     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9073     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9074     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9075     MOVE PB-SV-STATE            TO PLAN-STATE.
  9076     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9077     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9078     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9079     MOVE WS-SAVE-BENEFIT-REVISION
  9080                                 TO PLAN-REVISION-NO.
  9081
  9082     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9083     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9084
  9085     IF PB-COMPANY-ID = 'NCL'
  9086       IF NOT AH-PLAN-MASTER-FOUND
  9087         IF NOT PB-POLICY-IS-DECLINED  AND
  9088            NOT PB-POLICY-IS-VOIDED
  9089             MOVE  ER-1922         TO  WS-ERROR
  9090             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9091             GO TO 0314-A-H-BENEFIT-FOUND.
  9092
  9093     IF NOT AH-PLAN-MASTER-FOUND
  9094        GO TO 0314-A-H-BENEFIT-FOUND.
  9095
  9096 XXXX-CHECK-AH-PLAN-KEY.
  9097
  9098     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9099        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9100        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9101        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9102        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9103        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9104        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9105        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9106        MOVE 'N'                 TO PLAN-MASTER-SW
  9107          GO TO 03XX-ERPLAN-AH-READ.
  9108
  9109     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9110
  9111     IF  PB-CANCELLATION
  9112         GO TO  0313-AH-ACCT-BEN-FOUND.
  9113
  9114     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9115       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9116          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9117          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9118             MOVE ER-2644             TO WS-ERROR
  9119             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9120          ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 168
* EL050.cbl
  9121             NEXT SENTENCE
  9122       ELSE
  9123          IF PB-COMPANY-ID NOT = 'NCL'
  9124             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9125                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9126
  9127 0313-AH-ACCT-BEN-FOUND.
  9128
  9129     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9130
  9131     IF PL-DEV-CODE NOT = SPACES
  9132        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9133
  9134     IF PL-DEV-PCT NUMERIC AND
  9135        PL-DEV-PCT NOT = ZEROS
  9136        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9137
  9138     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9139        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9140
  9141     IF PL-TOL-REF-AMT NOT EQUAL +0
  9142        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9143
  9144     IF PL-TOL-PREM-PCT GREATER THAN +0
  9145        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9146
  9147     IF PL-TOL-REF-PCT GREATER THAN +0
  9148        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9149
  9150     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9151        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9152
  9153     IF PL-OVER-SHORT-AMT NUMERIC AND
  9154                          PL-OVER-SHORT-AMT > +0
  9155        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9156
  9157     IF PL-OVER-SHORT-PCT NUMERIC AND
  9158                          PL-OVER-SHORT-PCT > +0
  9159        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9160
  9161     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9162        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9163        IF WS-IG-OVRD-AM EQUAL SPACES
  9164            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9165
  9166 0314-A-H-BENEFIT-FOUND.
  9167
  9168     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9169
  9170     IF PB-ISSUE
  9171        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9172       ELSE
  9173        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9174
  9175     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9176     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9177     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9178     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 169
* EL050.cbl
  9179                                         WS-AH-REFUND-CALC.
  9180
  9181     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9182        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9183
  9184     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9185        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9186     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9187
  9188     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9189     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9190     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9191     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9192     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9193     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9194
  9195     IF PB-COMPANY-ID = 'NCL'  AND
  9196        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9197         NEXT SENTENCE
  9198     ELSE
  9199         IF SUB5 NOT GREATER THAN +20
  9200            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9201                MOVE WS-SAVE-BENEFIT-REM-TERM
  9202                                      TO WS-AM-AH-BENE-REM-TERM
  9203                                         EC-BR-AH-REM-TERM-CALC.
  9204
  9205     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9206     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9207
  9208     GO TO 0400-FIND-CARRIER.
  9209
  9210 0399-BENEFIT-NOT-FOUND.
  9211
  9212     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9213     MOVE ER-2605                TO WS-ERROR.
  9214     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9215
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 170
* EL050.cbl
  9217
  9218 0400-FIND-CARRIER.
  9219
  9220     MOVE PB-SV-CARRIER          TO WS-CARR.
  9221
  9222     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9223     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9224     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9225     MOVE '6'                    TO CNTL-REC-TYPE.
  9226
  9227*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9228     MOVE SPACE                  TO WS-DMD-RATING-SW
  9229                                    EC-BR-DMD-RATING-SW.
  9230
  9231     MOVE '2'                    TO RC-SW-1.
  9232     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9233
  9234     IF NOT CF-CARRIER-MASTER
  9235        GO TO 0400-CARRIER-NOT-FOUND.
  9236
  9237 0400-BUILD-CARR-TOL.
  9238
  9239     IF CF-CR-TOL-PREM NUMERIC AND
  9240        CF-CR-TOL-PREM GREATER THAN +0
  9241        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9242                                    WS-TOL-AH-PREM.
  9243
  9244     IF CF-CR-TOL-REFUND NUMERIC AND
  9245        CF-CR-TOL-REFUND GREATER THAN +0
  9246        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9247                                    WS-TOL-AH-REFUND.
  9248
  9249     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9250        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9251        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9252                                    WS-AH-REFUND-OVS-AMT.
  9253
  9254     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9255        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9256        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9257                                    WS-AH-REFUND-OVS-PCT.
  9258
  9259     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9260        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9261        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9262                                    WS-TOL-AH-PREM-PCT.
  9263
  9264     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9265        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9266        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9267                                     WS-TOL-AH-REFUND-PCT.
  9268
  9269     IF CF-COMPANY-ID EQUAL 'DMD'
  9270         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9271                                    EC-BR-DMD-RATING-SW.
  9272
  9273     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9274     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 171
* EL050.cbl
  9275        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9276     END-IF
  9277     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9278        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9279     END-IF
  9280     IF WS-TOL-CLP-PCT = ZEROS
  9281        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9282     END-IF
  9283
  9284     IF WS-SPP-LEASE-COMM = ZEROS
  9285        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9286     END-IF
  9287     GO TO 0400-FIND-ERPDEF.
  9288
  9289 0400-CARRIER-NOT-FOUND.
  9290
  9291     MOVE ER-2602                TO WS-ERROR.
  9292     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9293
  9294 0400-FIND-ERPDEF.
  9295     IF PB-COMPANY-ID = 'DCC'
  9296        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9297        CONTINUE
  9298     ELSE
  9299        GO TO 0400-FIND-ERCOMP
  9300     END-IF
  9301     MOVE ' '                    TO PDEF-MASTER-SW
  9302     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9303     MOVE PB-STATE               TO ERPDEF-STATE
  9304     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9305     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9306     IF PB-ISSUE
  9307        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9308     ELSE
  9309        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9310     END-IF
  9311     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9312     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9313     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9314     IF PDEF-MASTER-FOUND
  9315        MOVE 'N'                 TO PDEF-MASTER-SW
  9316        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9317        IF PDEF-MASTER-FOUND
  9318           IF (ERPDEF-KEY-SAVE (1:16) =
  9319                        PD-CONTROL-PRIMARY (1:16))
  9320              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9321              CONTINUE
  9322           ELSE
  9323              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9324              IF (ERPDEF-KEY-SAVE (1:16) =
  9325                        PD-CONTROL-PRIMARY (1:16))
  9326                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9327                 CONTINUE
  9328              ELSE
  9329                 MOVE 'N'        TO PDEF-MASTER-SW
  9330              END-IF
  9331           END-IF
  9332        END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 172
* EL050.cbl
  9333        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9334     END-IF
  9335     IF PDEF-MASTER-FOUND
  9336        IF PD-TRUNCATED = 'Y'
  9337           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9338        END-IF
  9339     END-IF
  9340     .
  9341 0400-FIND-ERCOMP.
  9342     IF PB-COMPANY-ID = 'DCC'
  9343        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9344           (WS-SUB1 > +10)
  9345           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9346                 OR 'A' OR 'N'
  9347              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9348              MOVE PB-CARRIER    TO COMP-CARRIER
  9349              MOVE PB-GROUPING   TO COMP-GROUPING
  9350              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9351              MOVE AM-AGT (WS-SUB1)
  9352                                 TO COMP-FIN-RESP
  9353              MOVE 'G'           TO COMP-TYPE
  9354              PERFORM 8582-READ-COMPENSATION-MASTER
  9355                                 THRU 8582-EXIT
  9356              IF COMP-MASTER-FOUND
  9357                 IF CO-GA-INACTIVE
  9358                    MOVE ER-2763 TO WS-ERROR
  9359                    PERFORM 9900-ERROR-FORMAT
  9360                                 THRU 9900-EXIT
  9361                    MOVE +11     TO WS-SUB1
  9362                 END-IF
  9363                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9364                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9365                    MOVE ER-2788 TO WS-ERROR
  9366                    PERFORM 9900-ERROR-FORMAT
  9367                                 THRU 9900-EXIT
  9368                    MOVE +11     TO WS-SUB1
  9369                 END-IF
  9370              END-IF
  9371           END-IF
  9372        END-PERFORM
  9373     END-IF
  9374     IF PB-COMPANY-ID = 'DCC'
  9375        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9376           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9377                                    WS-CLP-STATE
  9378        ELSE
  9379           MOVE SPACES           TO PB-I-CLP-STATE
  9380                                    WS-CLP-STATE
  9381        END-IF
  9382     END-IF
  9383
  9384     IF (PB-COMPANY-ID = 'DCC')
  9385        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9386        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9387        CONTINUE
  9388     ELSE
  9389        GO TO 0400-FIND-STATE-RECORD
  9390     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 173
* EL050.cbl
  9391     MOVE SPACES                 TO WS-CLP-STATE
  9392     MOVE +0                     TO WS-BANK-FEE
  9393                                    WS-BANK-LFEE
  9394                                    WS-BANK-NOCHRGB
  9395
  9396     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9397     IF (PB-ISSUE)
  9398        AND (PB-I-BANK-NUMBER NOT =
  9399            SPACES AND ZEROS AND LOW-VALUES)
  9400        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9401     ELSE
  9402        IF (PB-CANCELLATION)
  9403           AND (PB-CI-BANK-NUMBER NOT =
  9404                SPACES AND ZEROS AND LOW-VALUES)
  9405           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9406        END-IF
  9407     END-IF
  9408     IF COMP-FIN-RESP NOT = LOW-VALUES
  9409        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9410        MOVE PB-CARRIER          TO COMP-CARRIER
  9411        MOVE PB-GROUPING         TO COMP-GROUPING
  9412        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9413        MOVE 'B'                 TO COMP-TYPE
  9414        PERFORM 8582-READ-COMPENSATION-MASTER
  9415                                 THRU 8582-EXIT
  9416        IF COMP-MASTER-FOUND
  9417           IF CO-MAX-BANK-FEE NOT NUMERIC
  9418              MOVE +0            TO CO-MAX-BANK-FEE
  9419           END-IF
  9420           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9421              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9422           END-IF
  9423           IF CO-GA-INACTIVE
  9424              MOVE ER-2763       TO WS-ERROR
  9425              PERFORM 9900-ERROR-FORMAT
  9426                                 THRU 9900-EXIT
  9427           END-IF
  9428           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9429              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9430              MOVE ER-2788 TO WS-ERROR
  9431              PERFORM 9900-ERROR-FORMAT
  9432                                 THRU 9900-EXIT
  9433              MOVE +11     TO WS-SUB1
  9434           END-IF
  9435           IF WS-AH-BEN-CATEGORY = 'G'
  9436              MOVE CO-MAX-BANK-FEE
  9437                                 TO WS-BANK-FEE
  9438                                    PB-I-BANK-FEE
  9439           ELSE
  9440              MOVE CO-MAX-BANK-FEE-LEASE
  9441                                 TO WS-BANK-LFEE
  9442                                    PB-I-BANK-FEE
  9443           END-IF
  9444           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9445              AND (WS-AH-REFUND-CALC = 'G'))
  9446                        OR
  9447              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9448              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 174
* EL050.cbl
  9449              CONTINUE
  9450           ELSE
  9451              MOVE ER-2789 TO WS-ERROR
  9452              PERFORM 9900-ERROR-FORMAT
  9453                                 THRU 9900-EXIT
  9454           END-IF
  9455           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9456                                    PB-I-CLP-STATE
  9457           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9458           MOVE CO-CARRIER       TO BXRF-CARRIER
  9459           MOVE CO-GROUPING      TO BXRF-GROUPING
  9460           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9461           MOVE BXRF-MAX-REC-LENGTH
  9462                                 TO BXRF-REC-LENGTH
  9463           PERFORM 8584-READ-BANK-CROSS-REF
  9464                                 THRU 8584-EXIT
  9465           IF BXRF-MASTER-FOUND
  9466              MOVE ' '           TO BANK-ACCT-SW
  9467              MOVE BK-BANK-POINTER-CNT
  9468                                 TO BK-BANK-POINTER-CNT
  9469              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9470                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9471                 OR (BANK-ACCT-FOUND)
  9472                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9473                    AND (BK-AM-EXP-DT (WS-SUB1)
  9474                                 > PB-CERT-EFF-DT)
  9475                    AND (BK-AM-EFF-DT (WS-SUB1)
  9476                                 NOT > PB-CERT-EFF-DT)
  9477                    SET BANK-ACCT-FOUND TO TRUE
  9478                 END-IF
  9479              END-PERFORM
  9480              IF NOT BANK-ACCT-FOUND
  9481                 MOVE ZEROS      TO WS-BANK-FEE
  9482                                    WS-BANK-LFEE
  9483                 MOVE ER-2869    TO WS-ERROR
  9484                 PERFORM 9900-ERROR-FORMAT
  9485                                 THRU 9900-EXIT
  9486              ELSE
  9487                 PERFORM 5000-PROCESS-REPS
  9488                                 THRU 5000-EXIT
  9489                 IF AGENT-MASTER-FOUND
  9490                    MOVE +0      TO WS-BANK-FEE
  9491                                    WS-BANK-LFEE
  9492*                   MOVE AG-SPP-FEES (1)
  9493*                                TO PB-I-BANK-FEE
  9494*                                   WS-BANK-FEE
  9495                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9496                       (WS-SUB1 > +10)
  9497                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9498                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9499                       END-IF
  9500                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9501                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9502                       END-IF
  9503                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9504                          AG-SPP-FEES (WS-SUB1)
  9505                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9506                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 175
* EL050.cbl
  9507                    END-PERFORM
  9508                    IF WS-AH-BEN-CATEGORY = 'G'
  9509                       MOVE WS-BANK-FEE
  9510                                 TO PB-I-BANK-FEE
  9511                    ELSE
  9512                       MOVE WS-BANK-LFEE
  9513                                 TO PB-I-BANK-FEE
  9514                    END-IF
  9515                 END-IF
  9516              END-IF
  9517           END-IF
  9518        ELSE
  9519           MOVE ER-2879          TO WS-ERROR
  9520           PERFORM 9900-ERROR-FORMAT
  9521                                 THRU 9900-EXIT
  9522        END-IF
  9523     ELSE
  9524        MOVE ER-2879             TO WS-ERROR
  9525        PERFORM 9900-ERROR-FORMAT
  9526                                 THRU 9900-EXIT
  9527     END-IF
  9528     IF WS-AH-BEN-CATEGORY = 'G'
  9529        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9530        + WS-BANK-FEE
  9531     ELSE
  9532        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9533        + WS-BANK-LFEE
  9534     END-IF
  9535     .
  9536 0400-FIND-STATE-RECORD.
  9537
  9538     IF WK-STATE-ADDR NOT = ZEROS
  9539         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9540         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9541         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9542         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9543         IF PB-SV-STATE = CF-STATE-CODE
  9544             GO TO 0405-CONTINUE-EDIT
  9545         ELSE
  9546             NEXT SENTENCE
  9547     ELSE
  9548         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9549
  9550     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9551     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9552     MOVE '3'                    TO CNTL-REC-TYPE.
  9553     MOVE +0                     TO CNTL-SEQ-NO.
  9554
  9555     MOVE '3'                    TO RC-SW-2.
  9556     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9557
  9558     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9559        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9560        PB-SV-STATE   NOT = CF-STATE-CODE)
  9561        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9562                                    WS-TOL-AH-CLAIM
  9563                                    WS-MINIMUM-REFUND
  9564                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 176
* EL050.cbl
  9565                                    WS-TOL-AH-PREM
  9566                                    WS-TOL-LF-REFUND
  9567                                    WS-TOL-AH-REFUND
  9568                                    EC-ST-TOL-PREM-PCT
  9569                                    WS-TOL-LF-PREM-PCT
  9570                                    WS-TOL-AH-PREM-PCT
  9571                                    EC-ST-TOL-REFUND-PCT
  9572                                    WS-TOL-LF-REFUND-PCT
  9573                                    WS-TOL-AH-REFUND-PCT
  9574                                    EC-ST-TOL-PREM
  9575                                    EC-ST-TOL-REFUND
  9576                                    EC-ST-FST-PMT-DAYS-MAX
  9577                                    WS-FREE-LOOK-PERIOD
  9578                                    WS-ST-LF-PREM-TAX
  9579                                    WS-ST-AH-PREM-TAX-I
  9580                                    WS-ST-AH-PREM-TAX-G
  9581                                    WS-BANK-FEE
  9582                                    WS-BANK-LFEE
  9583                                    WS-TOL-CLP-PCT
  9584                                    WS-SPP-LEASE-COMM
  9585        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9586                                    EC-ST-FST-PMT-DAYS-CHG
  9587                                    WS-LF-REM-TERM-CALC
  9588                                    WS-LF-REFUND-CALC
  9589                                    EC-ST-LF-REM-TERM-CALC
  9590                                    EC-ST-LF-REFUND-CALC
  9591                                    WS-AH-REM-TERM-CALC
  9592                                    WS-AH-REFUND-CALC
  9593                                    WS-LF-BEN-CATEGORY
  9594                                    WS-AH-BEN-CATEGORY
  9595                                    WS-CLP-STATE
  9596                                    WS-ST-REFUND-CLAIM-FLAG
  9597                                    EC-ST-AH-REM-TERM-CALC
  9598                                    EC-ST-AH-REFUND-CALC
  9599          GO TO 0499-STATE-NOT-FOUND.
  9600
  9601     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9602
  9603 0405-CONTINUE-EDIT.
  9604
  9605     if pb-company-id = 'AHL'
  9606        continue
  9607     else
  9608        IF PB-CERT-PRIME NOT NUMERIC
  9609           MOVE ER-2722          TO WS-ERROR
  9610           PERFORM 9900-ERROR-FORMAT
  9611                                 THRU 9900-EXIT
  9612        end-if
  9613     END-IF
  9614*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9615*       MOVE +0                  TO SUB3
  9616*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9617*       IF SUB3 > +0
  9618*          MOVE ER-2722          TO WS-ERROR
  9619*          PERFORM 9900-ERROR-FORMAT
  9620*                                THRU 9900-EXIT
  9621*       END-IF
  9622*    END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 177
* EL050.cbl
  9623*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9624*       IF PB-CERT-PRIME NOT NUMERIC
  9625*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9626*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9627*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9628*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9629*
  9630*          MOVE ER-2722          TO WS-ERROR
  9631*          PERFORM 9900-ERROR-FORMAT
  9632*                                THRU 9900-EXIT
  9633*       END-IF
  9634*    END-IF
  9635
  9636     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9637
  9638     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9639        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9640                                    WS-TOL-AH-CLAIM.
  9641
  9642     IF CF-ST-REFUND-MIN NOT NUMERIC
  9643        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9644
  9645     IF CF-ST-REFUND-MIN NOT = ZEROS
  9646        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9647
  9648     IF CF-ST-TOL-PREM  NOT = ZEROS
  9649        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9650                                    WS-TOL-AH-PREM
  9651        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9652
  9653     IF CF-ST-TOL-REFUND NOT = ZEROS
  9654        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9655                                    WS-TOL-AH-REFUND
  9656        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9657
  9658     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9659        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9660        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9661                                    WS-AH-REFUND-OVS-AMT
  9662                                    EC-ST-OVR-SHT-AMT.
  9663
  9664     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9665        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9666        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9667                                    WS-TOL-LF-PREM-PCT
  9668                                    WS-TOL-AH-PREM-PCT.
  9669
  9670     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9671        CF-ST-TOL-REF-PCT GREATER THAN +0
  9672        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9673                                    WS-TOL-LF-REFUND-PCT
  9674                                    WS-TOL-AH-REFUND-PCT.
  9675
  9676     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9677        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9678        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9679                                    WS-AH-REFUND-OVS-PCT
  9680                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 178
* EL050.cbl
  9681
  9682     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9683     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9684
  9685     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9686          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9687
  9688     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9689     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9690     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9691
  9692     IF CF-ST-LF-PREM-TAX NUMERIC
  9693        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9694     END-IF
  9695     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9696        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9697     END-IF
  9698     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9699        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9700     END-IF
  9701
  9702     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9703         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9704     END-IF.
  9705
  9706     IF WS-LF-BENEFIT-CD = ZEROS
  9707        GO TO 0410-CHECK-AH.
  9708
  9709     IF CF-ST-RT-CALC NOT = SPACES
  9710        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9711                                    EC-ST-LF-REM-TERM-CALC
  9712     END-IF
  9713
  9714     IF WS-LF-COVERAGE-TYPE = 'R'
  9715        IF WS-LF-EARNINGS-CALC = '5'
  9716           IF CF-ST-RF-LN-CALC > '0'
  9717              MOVE CF-ST-RF-LN-CALC
  9718                                 TO WS-LF-REFUND-CALC
  9719                                    EC-ST-LF-REFUND-CALC
  9720           END-IF
  9721        ELSE
  9722           IF CF-ST-RF-LR-CALC > '0'
  9723              MOVE CF-ST-RF-LR-CALC
  9724                                 TO WS-LF-REFUND-CALC
  9725                                    EC-ST-LF-REFUND-CALC
  9726           END-IF
  9727        END-IF
  9728     ELSE
  9729        IF CF-ST-RF-LL-CALC > '0'
  9730           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9731                                    EC-ST-LF-REFUND-CALC
  9732        END-IF
  9733     END-IF
  9734
  9735     IF CF-ST-RT-CALC NOT = SPACES
  9736        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9737                                    EC-ST-LF-REM-TERM-CALC
  9738     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 179
* EL050.cbl
  9739
  9740     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9741     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9742
  9743     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9744
  9745     IF NO-BENEFIT-FOUND
  9746        GO TO 0410-CHECK-AH.
  9747
  9748     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9749        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9750                                 TO EC-ST-LF-REM-TERM-CALC
  9751                                    WS-LF-REM-TERM-CALC
  9752     END-IF
  9753
  9754     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9755        MOVE CF-ST-REFUND-CALC (SUB3)
  9756                                 TO WS-LF-REFUND-CALC
  9757                                    EC-ST-LF-REFUND-CALC
  9758     END-IF
  9759*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9760
  9761     .
  9762 0410-CHECK-AH.
  9763
  9764     IF WS-AH-BENEFIT-CD = ZEROS
  9765        GO TO 0500-SET-ACCOUNT.
  9766
  9767     IF CF-ST-RT-CALC NOT = SPACES
  9768        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9769                                    EC-ST-AH-REM-TERM-CALC
  9770     END-IF
  9771
  9772     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9773        IF CF-ST-RF-CP-CALC > '0'
  9774           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9775                                    EC-ST-AH-REFUND-CALC
  9776        END-IF
  9777     ELSE
  9778        IF CF-ST-RF-AH-CALC > '0'
  9779           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9780                                    EC-ST-AH-REFUND-CALC
  9781        END-IF
  9782     END-IF
  9783     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9784     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9785
  9786     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9787
  9788     IF NO-BENEFIT-FOUND
  9789        GO TO 0500-SET-ACCOUNT.
  9790
  9791     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9792        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9793                                 TO WS-AH-REM-TERM-CALC
  9794                                    EC-ST-AH-REM-TERM-CALC
  9795     END-IF
  9796
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 180
* EL050.cbl
  9797     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9798        MOVE CF-ST-REFUND-CALC (SUB3)
  9799                                 TO WS-AH-REFUND-CALC
  9800                                    EC-ST-AH-REFUND-CALC
  9801     END-IF
  9802
  9803*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9804
  9805     GO TO 0500-SET-ACCOUNT.
  9806
  9807 0499-STATE-NOT-FOUND.
  9808
  9809     MOVE ER-2603                TO WS-ERROR.
  9810     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9811
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 181
* EL050.cbl
  9813
  9814 0500-SET-ACCOUNT.
  9815*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9816     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9817        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9818        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9819        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9820        MOVE '3'                 TO CNTL-REC-TYPE
  9821        MOVE +0                  TO CNTL-SEQ-NO
  9822
  9823        MOVE '3'                 TO RC-SW-2
  9824        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9825
  9826        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9827           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9828           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9829           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9830                                    WS-ST-AH-PREM-TAX-I
  9831                                    WS-ST-AH-PREM-TAX-G
  9832        ELSE
  9833           IF CF-ST-LF-PREM-TAX NUMERIC
  9834              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9835           END-IF
  9836           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9837              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9838           END-IF
  9839           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9840              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9841           END-IF
  9842        END-IF
  9843        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9844     END-IF
  9845*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9846*  FOR DCC ONLY
  9847     IF PB-COMPANY-ID = 'DCC'
  9848
  9849     MOVE ' '                    TO STAT-MASTER-SW
  9850     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9851     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9852     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9853     MOVE PB-STATE               TO ELSTAT-STATE
  9854     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9855        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9856     END-IF
  9857
  9858     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9859     SET BIN-TO-GREG             TO TRUE
  9860     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9861     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9862     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9863
  9864     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9865     IF STAT-MASTER-FOUND
  9866        MOVE 'N'                 TO STAT-MASTER-SW
  9867        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9868        IF STAT-MASTER-FOUND
  9869           IF (ELSTAT-KEY-SAVE (1:12) =
  9870                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 182
* EL050.cbl
  9871              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9872                 MOVE 'F'        TO STAT-MASTER-SW
  9873              ELSE
  9874                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9875                 IF (STAT-MASTER-FOUND)
  9876                    AND (ELSTAT-KEY-SAVE (1:12) =
  9877                        SF-CONTROL-PRIMARY (1:12))
  9878                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9879                    MOVE 'F'     TO STAT-MASTER-SW
  9880                 END-IF
  9881              END-IF
  9882           END-IF
  9883        END-IF
  9884     END-IF
  9885
  9886     IF STAT-MASTER-SW = 'F'
  9887        IF SF-ST-LF-PREM-TAX NUMERIC
  9888           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9889        END-IF
  9890        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9891           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9892        END-IF
  9893        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9894           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9895        END-IF
  9896     END-IF
  9897
  9898     END-IF
  9899     IF (PB-COMPANY-ID = 'DCC')
  9900        AND (PB-ISSUE)
  9901        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9902        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9903        AND (AM-GPCD = 06)
  9904        MOVE 'Y'                 TO WS-GOOD-HIN
  9905        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9906           MOVE PB-I-VIN         TO WS-WORK-VIN
  9907           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9908              (V1 > 16)
  9909              IF WS-WORK-VIN (V1:1) NUMERIC
  9910                 MOVE WS-WORK-VIN-N (V1)
  9911                                 TO WS-ROW-B-VAL (V1)
  9912              ELSE
  9913                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9914                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9915                    OR (V2 > 26)
  9916                 END-PERFORM
  9917                 IF V2 < 27
  9918                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9919                 ELSE
  9920                    MOVE 'N'     TO WS-GOOD-HIN
  9921                 END-IF
  9922              END-IF
  9923              COMPUTE WS-ROW-D-VAL (V1) =
  9924                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9925              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9926                 WS-ROW-D-VAL (V1)
  9927           END-PERFORM
  9928           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 183
* EL050.cbl
  9929           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9930             REMAINDER WS-VIN-REMAINDER
  9931           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9932              CONTINUE
  9933           ELSE
  9934              MOVE 'N'           TO WS-GOOD-HIN
  9935           END-IF
  9936        ELSE
  9937           MOVE 'N'              TO WS-GOOD-HIN
  9938        END-IF
  9939        IF WS-GOOD-HIN NOT = 'Y'
  9940           MOVE ER-3826           TO WS-ERROR
  9941           PERFORM 9900-ERROR-FORMAT
  9942                                 THRU 9900-EXIT
  9943        END-IF
  9944     END-IF
  9945     IF (PB-COMPANY-ID = 'DCC')
  9946        AND (PB-ISSUE)
  9947        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9948        AND (AM-GPCD NOT = 06)
  9949        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9950          MOVE PB-I-VIN          TO WS-WORK-VIN
  9951          MOVE +8                TO V2
  9952          MOVE ZEROS             TO WS-VIN-TOTAL
  9953          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9954           (V1 > 17)
  9955             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9956                MOVE ER-3825     TO WS-ERROR
  9957                PERFORM 9900-ERROR-FORMAT
  9958                                 THRU 9900-EXIT
  9959             ELSE
  9960                IF V1 = 8
  9961                   MOVE 10       TO V2
  9962                END-IF
  9963                IF V1 = 9
  9964                   MOVE 0        TO V2
  9965                END-IF
  9966                IF V1 = 10
  9967                   MOVE 9        TO V2
  9968                END-IF
  9969                IF WS-WORK-VIN (V1:1) NUMERIC
  9970                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9971                    + (WS-WORK-VIN-N (V1) * V2)
  9972                ELSE
  9973                   MOVE WS-WORK-VIN (V1:1)
  9974                                 TO WS-HEX-BYTE
  9975                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9976                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9977                    + (WS-NUM (V3) * V2)
  9978                END-IF
  9979                COMPUTE V2 = V2 - 1
  9980             END-IF
  9981          END-PERFORM
  9982          MOVE ZEROS TO WS-VIN-REMAINDER
  9983          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9984             REMAINDER WS-VIN-REMAINDER
  9985          IF ((WS-WORK-VIN (9:1) = 'X')
  9986             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 184
* EL050.cbl
  9987                     OR
  9988             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9989             CONTINUE
  9990          ELSE
  9991             MOVE ER-3826        TO WS-ERROR
  9992             PERFORM 9900-ERROR-FORMAT
  9993                                 THRU 9900-EXIT
  9994          END-IF
  9995        ELSE
  9996          MOVE ER-3826           TO WS-ERROR
  9997          PERFORM 9900-ERROR-FORMAT
  9998                                 THRU 9900-EXIT
  9999        END-IF
 10000     END-IF
 10001******************************************************************
 10002******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10003******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10004******* METHODS.
 10005******************************************************************
 10006     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10007        IF PB-CANCELLATION
 10008           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10009              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10010                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10011                IF FORM-MASTER-FOUND
 10012                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10013******************************************************************
 10014
 10015     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10016     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10017
 10018     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10019     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10020     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10021     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10022
 10023
 10024     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10025     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10026     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10027
 10028     IF AM-LF-OB-RATE NOT NUMERIC
 10029         MOVE ZERO               TO AM-LF-OB-RATE.
 10030
 10031     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10032         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10033
 10034     IF AM-AH-OB-RATE NOT NUMERIC
 10035         MOVE ZERO               TO AM-AH-OB-RATE.
 10036
 10037     IF WS-LF-JOINT-INDICATOR = 'J'
 10038         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10039     ELSE
 10040         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10041
 10042     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10043
 10044     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 185
* EL050.cbl
 10045         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10046
 10047     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10048         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10049                                       WS-IG-OVRD
 10050     ELSE
 10051         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10052             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10053                                       WS-IG-OVRD
 10054         ELSE
 10055             MOVE AM-IG             TO WS-IG-OVRD-AH
 10056                                       WS-IG-OVRD.
 10057
 10058     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10059         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10060                                       WS-IG-OVRD
 10061     ELSE
 10062         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10063             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10064                                       WS-IG-OVRD
 10065         ELSE
 10066             MOVE AM-IG             TO WS-IG-OVRD-LF
 10067                                       WS-IG-OVRD.
 10068
 10069     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10070     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10071     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10072     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10073     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10074
 10075     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10076     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10077     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10078     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10079
 10080     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10081     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10082     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10083     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10084     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10085     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10086     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10087
 10088     IF WS-ACCT-AH-DEV-PCT > +0
 10089        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10090     ELSE
 10091        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10092
 10093     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10094        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10095     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10096        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10097
 10098        IF AM-EARN-METHOD-L = 'S'
 10099            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10100                                        WS-LF-REFUND-CALC.
 10101
 10102        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 186
* EL050.cbl
 10103            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10104                                        WS-LF-REFUND-CALC.
 10105
 10106     IF WS-LF-COVERAGE-TYPE = 'R'
 10107         IF AM-EARN-METHOD-R = 'R'
 10108            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10109                                    WS-LF-REFUND-CALC.
 10110     IF WS-LF-COVERAGE-TYPE = 'R'
 10111         IF AM-EARN-METHOD-R = 'P'
 10112            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10113                                    WS-LF-REFUND-CALC.
 10114     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10115         IF AM-EARN-METHOD-L = 'R'
 10116            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10117                                    WS-LF-REFUND-CALC.
 10118     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10119         IF AM-EARN-METHOD-L = 'P'
 10120            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10121                                    WS-LF-REFUND-CALC.
 10122     IF WS-LF-COVERAGE-TYPE = 'R'
 10123         IF AM-EARN-METHOD-R = 'A'
 10124            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10125                                    WS-LF-REFUND-CALC.
 10126     IF WS-LF-COVERAGE-TYPE = 'R'
 10127         IF AM-EARN-METHOD-R = 'M'
 10128            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10129                                    WS-LF-REFUND-CALC.
 10130     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10131         IF AM-EARN-METHOD-L = 'A'
 10132            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10133                                    WS-LF-REFUND-CALC.
 10134     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10135         IF AM-EARN-METHOD-L = 'M'
 10136            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10137                                    WS-LF-REFUND-CALC.
 10138
 10139     IF AM-EARN-METHOD-A = 'R'
 10140        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10141                                    WS-AH-REFUND-CALC.
 10142     IF AM-EARN-METHOD-A = 'P'
 10143        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10144                                    WS-AH-REFUND-CALC.
 10145     IF AM-EARN-METHOD-A = 'C'
 10146        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10147                                    WS-AH-REFUND-CALC.
 10148     IF AM-EARN-METHOD-A = 'A'
 10149        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10150                                    WS-AH-REFUND-CALC.
 10151     IF AM-EARN-METHOD-A = 'M'
 10152        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10153                                    WS-AH-REFUND-CALC.
 10154     IF AM-EARN-METHOD-A = 'N'
 10155        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10156                                    WS-AH-REFUND-CALC.
 10157     IF AM-EARN-METHOD-A = 'S'
 10158        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10159                                    WS-AH-REFUND-CALC.
 10160
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 187
* EL050.cbl
 10161     IF AM-TOL-PREM NOT = ZEROS
 10162        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10163                                    WS-TOL-AH-PREM.
 10164
 10165     IF AM-OVR-SHT-AMT NUMERIC AND
 10166                  AM-OVR-SHT-AMT > 0
 10167        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10168                                    EC-AM-LF-OVR-SHT-AMT
 10169                                    WS-AH-REFUND-OVS-AMT
 10170                                    EC-AM-AH-OVR-SHT-AMT.
 10171
 10172     IF AM-OVR-SHT-PCT NUMERIC AND
 10173                    AM-OVR-SHT-PCT > 0
 10174        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10175                                    EC-AM-LF-OVR-SHT-PCT
 10176                                    WS-AH-REFUND-OVS-PCT
 10177                                    EC-AM-AH-OVR-SHT-PCT.
 10178
 10179     IF AM-TOL-REF-PCT NUMERIC AND
 10180                  AM-TOL-REF-PCT > 0
 10181        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10182                                    WS-TOL-AH-REFUND-PCT.
 10183
 10184     IF AM-TOL-REF  NOT = ZEROS  AND
 10185                  AM-TOL-REF NUMERIC
 10186        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10187                                    EC-AM-LF-TOL-REFUND
 10188                                    WS-TOL-AH-REFUND
 10189                                    EC-AM-AH-TOL-REFUND.
 10190
 10191     IF AM-TOL-CLM  NOT = ZEROS
 10192        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10193                                    WS-TOL-AH-CLAIM.
 10194
 10195     IF AM-CLP-TOL-PCT NOT NUMERIC
 10196        MOVE +0                  TO AM-CLP-TOL-PCT
 10197     END-IF
 10198
 10199     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10200        MOVE +0                  TO AM-SPP-LEASE-COMM
 10201     END-IF
 10202     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10203        MOVE WS-PL-TOL-LF-PREM-PCT
 10204                                 TO WS-TOL-LF-PREM-PCT.
 10205
 10206     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10207        MOVE WS-PL-TOL-AH-PREM-PCT
 10208                                 TO WS-TOL-AH-PREM-PCT.
 10209
 10210     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10211        MOVE WS-PL-TOL-LF-REFUND-PCT
 10212                                 TO WS-TOL-LF-REFUND-PCT.
 10213
 10214     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10215        MOVE WS-PL-TOL-AH-REFUND-PCT
 10216                                 TO WS-TOL-AH-REFUND-PCT.
 10217
 10218     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 188
* EL050.cbl
 10219        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10220
 10221     IF WS-PL-REF-OVS-PCT > +0
 10222        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10223
 10224     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10225        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10226     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10227        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10228     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10229        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10230     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10231        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10232     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10233        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10234     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10235        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10236
 10237     IF WS-AH-PL-REF-OVS-AMT > +0
 10238        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10239
 10240     IF WS-AH-PL-REF-OVS-PCT > +0
 10241        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10242
 10243     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10244     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10245
 10246     IF PB-CANCELLATION
 10247        GO TO 3000-CONTINUE-EDIT.
 10248
 10249     MOVE +1 TO SUB1.
 10250     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10251     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10252
 10253     IF CF-COMPANY-ID = 'DMD'
 10254       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10255         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10256        ELSE
 10257         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10258
 10259  0525-FIND-ACCT-COMM.
 10260     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10261        NEXT SENTENCE
 10262      ELSE
 10263         ADD +1 TO SUB1
 10264         IF SUB1 LESS +11
 10265            GO TO 0525-FIND-ACCT-COMM
 10266          ELSE
 10267             GO TO 0560-EDIT-CONTINUE.
 10268
 10269     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10270     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10271                                    PB-I-LIFE-COMMISSION.
 10272***  IF PB-COMPANY-ID = 'CRI'
 10273     IF PB-PREM-ACCTNG-ONLY
 10274         GO TO 0560-EDIT-CONTINUE.
 10275
 10276     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 189
* EL050.cbl
 10277     MOVE ' '    TO WS-CTBL-READ-SW.
 10278
 10279
 10280 0530-GET-AH-COMP.
 10281     IF NO-AH-COVERAGE  OR
 10282        NO-AH-BENEFIT-MATCH
 10283           GO TO 0540-NEXT-READ-STEP.
 10284
 10285     IF AM-A-COM (SUB1) NUMERIC
 10286        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10287         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10288         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10289         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10290         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10291     ELSE
 10292          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10293          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10294          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10295          MOVE ZEROS             TO WS-SUB1
 10296                                    WS-COMMISSION
 10297          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10298          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10299          IF WS-COMMISSION > ZEROS
 10300             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10301             GO TO 0540-NEXT-READ-STEP
 10302          END-IF
 10303          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10304          IF CTBL-TABLE-FOUND
 10305             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10306                                        PB-I-AH-TERM
 10307             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10308             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10309             GO TO 0540-NEXT-READ-STEP
 10310          ELSE
 10311             IF FIRST-TIME-THROUGH
 10312                 GO TO 0530-GET-AH-COMP
 10313             ELSE
 10314                 MOVE ER-2609                TO WS-ERROR
 10315                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10316
 10317 0540-NEXT-READ-STEP.
 10318     MOVE '0540' TO CTBL-SW.
 10319     MOVE ' '    TO WS-CTBL-READ-SW.
 10320
 10321 0540-GET-LF-COMP.
 10322     IF NO-LIFE-COVERAGE  OR
 10323        NO-LF-BENEFIT-MATCH
 10324           GO TO 0560-EDIT-CONTINUE.
 10325
 10326     IF WS-LF-JOINT-INDICATOR = 'J'
 10327        IF AM-J-COM (SUB1) NUMERIC
 10328           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10329           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10330           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10331           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10332           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10333        ELSE
 10334           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 190
* EL050.cbl
 10335           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10336           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10337           MOVE ZEROS                TO WS-SUB1
 10338                                        WS-COMMISSION
 10339           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10340           IF WS-COMMISSION > ZEROS
 10341              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10342              GO TO 0560-EDIT-CONTINUE
 10343           END-IF
 10344           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10345           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10346           IF CTBL-TABLE-FOUND
 10347              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10348              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10349              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10350              GO TO 0560-EDIT-CONTINUE
 10351           ELSE
 10352              IF FIRST-TIME-THROUGH
 10353                  GO TO 0540-GET-LF-COMP
 10354              ELSE
 10355                  MOVE ER-2609                TO WS-ERROR
 10356                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10357                  GO TO 0560-EDIT-CONTINUE.
 10358
 10359     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10360        IF AM-L-COM (SUB1) NUMERIC
 10361           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10362           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10363           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10364           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10365           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10366        ELSE
 10367           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10368           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10369           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10370           MOVE ZEROS                TO WS-SUB1
 10371                                        WS-COMMISSION
 10372           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10373           IF WS-COMMISSION IS GREATER THAN ZEROS
 10374              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10375              GO TO 0560-EDIT-CONTINUE
 10376           END-IF
 10377           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10378           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10379           IF CTBL-TABLE-FOUND
 10380              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10381              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10382              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10383              GO TO 0560-EDIT-CONTINUE
 10384           ELSE
 10385              IF FIRST-TIME-THROUGH
 10386                  GO TO 0540-GET-LF-COMP
 10387              ELSE
 10388                  MOVE ER-2609                TO WS-ERROR
 10389                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10390
 10391*    GO TO 0560-EDIT-CONTINUE.
 10392
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 191
* EL050.cbl
 10393 0560-EDIT-CONTINUE.
 10394     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10395                                    WS-AH-PMF-COMM
 10396*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10397*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10398     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10399        (SUB1 > +10)
 10400        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10401           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10402           MOVE '0530'           TO CTBL-SW
 10403           MOVE ' '              TO WS-CTBL-READ-SW
 10404           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10405           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10406           MOVE '0540'           TO CTBL-SW
 10407           MOVE ' '              TO WS-CTBL-READ-SW
 10408           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10409        END-IF
 10410     END-PERFORM
 10411     GO TO 0564-EDIT-CONTINUE
 10412     .
 10413 0561-CHECK-AH.
 10414     IF (NO-AH-COVERAGE)
 10415        OR (NO-AH-BENEFIT-MATCH)
 10416        CONTINUE
 10417     ELSE
 10418        IF (AM-A-COM (SUB1) NUMERIC)
 10419           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10420           IF (AM-COM-TYP (SUB1) = 'A')
 10421              AND (WS-AH-PMF-COMM = ZEROS)
 10422              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10423           END-IF
 10424           CONTINUE
 10425        ELSE
 10426           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10427           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10428           MOVE PB-AH-OVERRIDE-L1
 10429                                 TO CTBL-BEN-TYPE
 10430           MOVE ZEROS            TO WS-SUB1
 10431                                    WS-COMMISSION
 10432           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10433           PERFORM 8300-READ-CTBL-TABLE
 10434                                 THRU 8300-EXIT
 10435           IF CTBL-TABLE-FOUND
 10436              IF (AM-COM-TYP (SUB1) = 'A')
 10437                 AND (WS-AH-PMF-COMM = ZEROS)
 10438                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10439                                        PB-I-AH-TERM
 10440                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10441                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10442              END-IF
 10443              CONTINUE
 10444           ELSE
 10445              IF FIRST-TIME-THROUGH
 10446                 GO TO 0561-CHECK-AH
 10447              ELSE
 10448                 MOVE ER-2609    TO WS-ERROR
 10449                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10450              END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 192
* EL050.cbl
 10451           END-IF
 10452        END-IF
 10453     END-IF
 10454     .
 10455 0561-EXIT.
 10456     EXIT.
 10457 0563-CHECK-LF.
 10458     IF (NO-LIFE-COVERAGE)
 10459        OR (NO-LF-BENEFIT-MATCH)
 10460        CONTINUE
 10461     ELSE
 10462        IF WS-LF-JOINT-INDICATOR = 'J'
 10463           IF AM-J-COM (SUB1) NUMERIC
 10464              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10465              IF (AM-COM-TYP (SUB1) = 'A')
 10466                 AND (WS-LF-PMF-COMM = ZEROS)
 10467                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10468              END-IF
 10469              CONTINUE
 10470           ELSE
 10471              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10472              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10473              MOVE PB-LIFE-OVERRIDE-L1
 10474                                 TO CTBL-BEN-TYPE
 10475              MOVE ZEROS         TO WS-SUB1
 10476                                    WS-COMMISSION
 10477              MOVE AM-J-COMA (SUB1)
 10478                                 TO CTBL-TABLE
 10479              PERFORM 8300-READ-CTBL-TABLE
 10480                                 THRU 8300-EXIT
 10481              IF CTBL-TABLE-FOUND
 10482                 IF (AM-COM-TYP (SUB1) = 'A')
 10483                    AND (WS-LF-PMF-COMM = ZEROS)
 10484                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10485                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10486                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10487                 END-IF
 10488                 CONTINUE
 10489              ELSE
 10490                 IF FIRST-TIME-THROUGH
 10491                    GO TO 0563-CHECK-LF
 10492                 ELSE
 10493                    MOVE ER-2609 TO WS-ERROR
 10494                    PERFORM 9900-ERROR-FORMAT
 10495                                 THRU 9900-EXIT
 10496*                   GO TO 0560-EDIT-CONTINUE
 10497                 END-IF
 10498              END-IF
 10499           END-IF
 10500        ELSE
 10501           IF AM-L-COM (SUB1) NUMERIC
 10502              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10503              IF (AM-COM-TYP (SUB1) = 'A')
 10504                 AND (WS-LF-PMF-COMM = ZEROS)
 10505                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10506              END-IF
 10507              CONTINUE
 10508           ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 193
* EL050.cbl
 10509              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10510              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10511              MOVE PB-LIFE-OVERRIDE-L1
 10512                                 TO CTBL-BEN-TYPE
 10513              MOVE ZEROS         TO WS-SUB1
 10514                                    WS-COMMISSION
 10515              MOVE AM-L-COMA (SUB1)
 10516                                 TO CTBL-TABLE
 10517              PERFORM 8300-READ-CTBL-TABLE
 10518                                 THRU 8300-EXIT
 10519              IF CTBL-TABLE-FOUND
 10520                 CONTINUE
 10521              ELSE
 10522                 IF FIRST-TIME-THROUGH
 10523                    GO TO 0563-CHECK-LF
 10524                 ELSE
 10525                    MOVE ER-2609 TO WS-ERROR
 10526                    PERFORM 9900-ERROR-FORMAT
 10527                                 THRU 9900-EXIT
 10528                 END-IF
 10529              END-IF
 10530           END-IF
 10531        END-IF
 10532     END-IF
 10533     .
 10534 0563-EXIT.
 10535     EXIT.
 10536 0564-EDIT-CONTINUE.
 10537
 10538     IF  PB-COMPANY-ID EQUAL 'DMD'
 10539         IF PB-I-NUM-BILLED EQUAL ZEROS
 10540            MOVE ER-8148       TO WS-ERROR
 10541            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10542
 10543*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10544*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10545*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10546*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10547*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10548*         IF NO-CONVERSION-ERROR
 10549*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10550*         ELSE
 10551*             IF PB-COMPANY-ID EQUAL 'HAN'
 10552*                 MOVE ZEROS     TO PB-I-AGE.
 10553     IF PB-I-BIRTHDAY > LOW-VALUES
 10554        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10555        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10556        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10557        PERFORM 8500-DATE-CONVERT
 10558                                 THRU 8500-EXIT
 10559        IF NO-CONVERSION-ERROR
 10560           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10561           IF PB-I-AGE > ZEROS
 10562              IF WS-WORK-AGE NOT = PB-I-AGE
 10563                 MOVE ER-9501    TO WS-ERROR
 10564                 PERFORM 9900-ERROR-FORMAT
 10565                                 THRU 9900-EXIT
 10566              END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 194
* EL050.cbl
 10567           ELSE
 10568              MOVE WS-WORK-AGE   TO PB-I-AGE
 10569           END-IF
 10570        END-IF
 10571     END-IF
 10572     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10573                                   WS-INS-AGE-SET
 10574     IF PB-I-AGE = ZEROS
 10575        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10576           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10577                                   WS-INS-AGE-SET
 10578           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10579
 10580     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10581                                   WS-AH-EDIT-AGE.
 10582
 10583     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10584        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10585        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10586        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10587        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10588        IF NO-CONVERSION-ERROR
 10589           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10590           IF PB-I-JOINT-AGE > 0
 10591              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10592                 MOVE ER-9503    TO WS-ERROR
 10593                 PERFORM 9900-ERROR-FORMAT
 10594                                 THRU 9900-EXIT
 10595              END-IF
 10596           ELSE
 10597              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10598           END-IF
 10599        ELSE
 10600           MOVE ZEROS            TO PB-I-JOINT-AGE
 10601        END-IF
 10602     END-IF
 10603     IF PB-I-JOINT-AGE NOT NUMERIC
 10604        MOVE ZERO               TO PB-I-JOINT-AGE.
 10605
 10606     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10607                                   WS-JNT-AGE-SET
 10608     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10609        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10610           (WS-AH-JOINT-INDICATOR = 'J')
 10611           IF PB-I-JOINT-AGE = ZEROS
 10612               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10613                                          WS-JNT-AGE-SET
 10614               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10615           END-IF
 10616        END-IF
 10617     END-IF
 10618
 10619     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10620     IF WS-LF-JOINT-INDICATOR = 'J'
 10621        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10622        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10623            IF  PB-I-JOINT-AGE = ZERO
 10624                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 195
* EL050.cbl
 10625                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10626            ELSE
 10627                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10628                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10629                    IF PB-COMPANY-ID NOT = 'LBL'
 10630                        MOVE ER-2685    TO WS-ERROR
 10631                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10632
 10633     IF WS-AH-JOINT-INDICATOR = 'J'
 10634        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10635            IF  PB-I-JOINT-AGE = ZERO
 10636                MOVE ER-2686       TO WS-ERROR
 10637                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10638            ELSE
 10639                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10640                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10641                                           WS-EDIT-AGE
 10642                    IF PB-COMPANY-ID NOT = 'LBL'
 10643                        MOVE ER-2685    TO WS-ERROR
 10644                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10645
 10646******************************************************************
 10647*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10648******************************************************************
 10649
 10650     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10651        (WS-AH-SPECIAL-CALC-CD = 'O')
 10652        NEXT SENTENCE
 10653     ELSE
 10654        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10655          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10656           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10657            WS-AH-JOINT-INDICATOR = 'J')  AND
 10658           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10659            MOVE ER-2627             TO WS-ERROR
 10660            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10661
 10662     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10663        (WS-AH-SPECIAL-CALC-CD = 'O')
 10664         NEXT SENTENCE
 10665     ELSE
 10666         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10667            WS-AH-JOINT-INDICATOR = 'J'
 10668             IF PB-I-JOINT-INSURED = SPACES
 10669                 IF PB-COMPANY-ID NOT = 'JAL'
 10670                     MOVE ER-2696    TO WS-ERROR
 10671                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10672
 10673     IF PB-COMPANY-ID NOT = 'BOA'
 10674        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10675           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10676           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10677               PB-I-JOINT-INSURED NOT = SPACES)
 10678                MOVE ER-2691         TO WS-ERROR
 10679                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10680
 10681     IF PB-COMPANY-ID = 'BOA'
 10682        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 196
* EL050.cbl
 10683           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10684            IF PB-I-JOINT-AGE NOT = ZEROS
 10685                MOVE ER-2691         TO WS-ERROR
 10686                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10687
 10688     IF PB-COMPANY-ID = 'CRI'
 10689        IF PB-I-SIG-SW = 'J'
 10690           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10691              WS-AH-JOINT-INDICATOR NOT = 'J'
 10692              MOVE ER-2675       TO WS-ERROR
 10693              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10694
 10695     IF PB-COMPANY-ID = 'CRI'
 10696        IF PB-I-SIG-SW = 'S'
 10697           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10698              WS-AH-JOINT-INDICATOR = 'J'
 10699              MOVE ER-2676       TO WS-ERROR
 10700              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10701
 10702     IF PB-COMPANY-ID = 'CVL'
 10703         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10704            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10705              MOVE ER-2783           TO WS-ERROR
 10706              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10707     IF (WS-LF-JOINT-INDICATOR = 'J')
 10708        AND (WS-AH-JOINT-INDICATOR = 'J')
 10709        AND (PB-I-LF-TERM > 120)
 10710        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10711        MOVE ER-2783             TO WS-ERROR
 10712        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10713     END-IF
 10714     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10715
 10716     IF PB-I-INDV-GRP-OVRD = 'I'
 10717        MOVE ER-2666             TO WS-ERROR
 10718        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10719        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10720
 10721     IF PB-I-INDV-GRP-OVRD = 'G'
 10722        MOVE ER-2666             TO WS-ERROR
 10723        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10724        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10725
 10726     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10727        NEXT SENTENCE
 10728     ELSE
 10729        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10730
 10731     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10732        IF WS-ERROR = ER-2666
 10733           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10734           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10735
 10736     IF PB-COMPANY-ID = 'CID'
 10737        IF PB-STATE = 'UT' OR 'MO'
 10738           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10739                 OR '76' OR '77')
 10740                      OR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 197
* EL050.cbl
 10741               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10742                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10743                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10744                   OR '2K' OR '2L'))
 10745              AND PB-I-INDV-GRP-CD = 'I'
 10746              MOVE ER-2721             TO WS-ERROR
 10747              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10748           END-IF
 10749        END-IF
 10750     END-IF
 10751
 10752     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10753     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10754        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10755     ELSE
 10756        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10757     END-IF
 10758
 10759*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10760*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10761     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10762                                    ACCOUNT-AH-CK-SW.
 10763
 10764     IF PB-REISSUED-CERT       OR
 10765        PB-REIN-ONLY-CERT      OR
 10766        PB-POLICY-IS-DECLINED  OR
 10767        PB-POLICY-IS-VOIDED
 10768*       OR PB-MONTHLY-CERT
 10769         GO TO 3000-CONTINUE-EDIT.
 10770
 10771     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10772        IF WS-EDIT-AGE           > +65
 10773           MOVE ER-2709          TO WS-ERROR
 10774           PERFORM 9900-ERROR-FORMAT
 10775                                 THRU 9900-EXIT
 10776        ELSE
 10777           IF WS-EDIT-AGE        > +55
 10778              MOVE ER-2718       TO WS-ERROR
 10779              PERFORM 9900-ERROR-FORMAT
 10780                                 THRU 9900-EXIT
 10781           END-IF
 10782        END-IF
 10783     IF PB-COMPANY-ID = 'DCC'
 10784        IF WS-EDIT-AGE           > +65
 10785           MOVE ER-2709          TO WS-ERROR
 10786           PERFORM 9900-ERROR-FORMAT
 10787                                 THRU 9900-EXIT
 10788        END-IF
 10789     END-IF
 10790     .
 10791
 10792 0565-LIFE-PLAN-LIMIT-EDITS.
 10793
 10794     IF NOT LF-PLAN-MASTER-FOUND
 10795        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10796                                    EC-AM-LF-MAX-TOT-BEN
 10797        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10798
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 198
* EL050.cbl
 10799     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10800
 10801     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10802         IF PL-LM-AGE (1) = ZEROS
 10803             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10804
 10805     IF NO-LF-BENEFIT-MATCH          OR
 10806        WS-LF-BENEFIT-CD = ZEROS     OR
 10807        WS-LF-SPECIAL-CALC-CD = 'M'
 10808        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10809
 10810     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10811     MOVE +1                     TO SUB2.
 10812
 10813     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10814        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10815           MOVE +5   TO SUB2
 10816           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10817              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10818              (PL-LM-AGE (SUB2) EQUAL +0)
 10819              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10820              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10821
 10822     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10823
 10824     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10825                               + PB-I-LF-ALT-BENEFIT-AMT.
 10826
 10827 0568-CHECK-LIFE-ATT-AGE.
 10828
 10829     IF PL-ATT-AGE NUMERIC AND
 10830        PL-ATT-AGE > +0
 10831        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10832     END-IF
 10833*    IF PL-ATT-AGE NUMERIC AND
 10834*       PL-ATT-AGE > +0
 10835*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10836*       IF PB-I-BIRTHDAY > LOW-VALUES
 10837*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10838*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10839*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10840*          SET BIN-PLUS-ELAPSED  TO TRUE
 10841*          PERFORM 8500-DATE-CONVERT
 10842*                                THRU 8500-EXIT
 10843*          IF NO-CONVERSION-ERROR
 10844*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10845*             MOVE ER-2669       TO WS-ERROR
 10846*             PERFORM 9900-ERROR-FORMAT
 10847*                                THRU 9900-EXIT
 10848*          END-IF
 10849*       ELSE
 10850*          IF WS-ATT-AGE >= PL-ATT-AGE
 10851*             MOVE ER-2669       TO WS-ERROR
 10852*             PERFORM 9900-ERROR-FORMAT
 10853*                                THRU 9900-EXIT
 10854*          END-IF
 10855*       END-IF
 10856*    END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 199
* EL050.cbl
 10857     .
 10858 0570-CHECK-LIFE-LIMITS.
 10859
 10860     IF PB-COMPANY-ID EQUAL 'CRI'
 10861        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10862           IF SUB2 GREATER THAN +4
 10863              MOVE ER-2637 TO WS-ERROR
 10864              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10865              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10866
 10867     IF PB-COMPANY-ID  =  'NCL'
 10868        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10869            SUB2 GREATER THAN +8
 10870             MOVE 'U'         TO PB-BATCH-ENTRY
 10871             MOVE ER-2637     TO WS-ERROR
 10872             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10873             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10874
 10875     IF SUB2 > +8
 10876        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10877           AND (PB-I-SIG-SW = 'Y')
 10878           CONTINUE
 10879        ELSE
 10880           MOVE ER-2637          TO WS-ERROR
 10881           PERFORM 9900-ERROR-FORMAT
 10882                                 THRU 9900-EXIT
 10883        END-IF
 10884        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10885     END-IF
 10886     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10887     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10888     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10889
 10890     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10891        ADD +1  TO SUB2
 10892        GO TO 0570-CHECK-LIFE-LIMITS.
 10893
 10894     IF PB-COMPANY-ID = 'NCL'
 10895         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10896
 10897     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10898        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10899        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10900           AND (PB-I-SIG-SW = 'Y')
 10901           CONTINUE
 10902        ELSE
 10903           MOVE ER-2637          TO WS-ERROR
 10904           PERFORM 9900-ERROR-FORMAT
 10905                                 THRU 9900-EXIT
 10906        END-IF
 10907     END-IF
 10908     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10909
 10910
 10911 0570-CHECK-NCL-LIFE-LIMITS.
 10912
 10913     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10914        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 200
* EL050.cbl
 10915         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10916
 10917     IF APP-CERT-USED
 10918         IF SUB2  LESS THAN  +5
 10919             MOVE +5          TO SUB2
 10920             GO TO 0570-CHECK-LIFE-LIMITS.
 10921
 10922     MOVE ER-2637             TO WS-ERROR.
 10923     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10924
 10925     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10926
 10927 0575-CHECK-NCL-SIG-SWITCH.
 10928
 10929     IF NOT APP-CERT-USED
 10930         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10931
 10932     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10933        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10934        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10935        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10936         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10937
 10938     IF SUB2 GREATER THAN +4
 10939         IF PL-LM-AGE (5) = ZEROS  AND
 10940            PL-LM-AGE (6) = ZEROS  AND
 10941            PL-LM-AGE (7) = ZEROS  AND
 10942            PL-LM-AGE (8) = ZEROS
 10943             MOVE  ER-1927        TO WS-ERROR
 10944             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10945             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10946         ELSE
 10947             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10948                 MOVE  ER-1920    TO WS-ERROR
 10949                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10950
 10951     IF PB-I-SIG-SW  = 'Y'
 10952       IF NOT PB-I-POLICY-ACCEPTED  AND
 10953          NOT PB-I-POLICY-DECLINED
 10954           MOVE 'U'               TO PB-BATCH-ENTRY
 10955           MOVE  ER-1926          TO WS-ERROR
 10956           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10957
 10958
 10959 0580-AH-PLAN-LIMIT-EDITS.
 10960
 10961     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10962        IF PB-I-AH-BENEFIT-AMT > +1250
 10963           MOVE ER-2702          TO WS-ERROR
 10964           PERFORM 9900-ERROR-FORMAT
 10965                                 THRU 9900-EXIT
 10966        END-IF
 10967     END-IF
 10968
 10969     IF (PB-COMPANY-ID = 'DCC')
 10970        AND (PB-MONTHLY-CERT)
 10971        IF PB-I-AH-BENEFIT-AMT > +3000
 10972           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 201
* EL050.cbl
 10973           PERFORM 9900-ERROR-FORMAT
 10974                                 THRU 9900-EXIT
 10975        END-IF
 10976     END-IF
 10977     IF NOT AH-PLAN-MASTER-FOUND
 10978        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10979        GO TO 3000-CONTINUE-EDIT.
 10980
 10981     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10982
 10983     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10984         IF PL-LM-AGE (1) = ZEROS
 10985             GO TO 3000-CONTINUE-EDIT.
 10986
 10987     IF NO-AH-BENEFIT-MATCH          OR
 10988        WS-AH-BENEFIT-CD = ZEROS     OR
 10989        WS-AH-SPECIAL-CALC-CD = 'M'
 10990        GO TO 3000-CONTINUE-EDIT.
 10991
 10992     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10993     MOVE +1                     TO SUB2.
 10994
 10995     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10996        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10997           MOVE +5 TO SUB2
 10998           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10999              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11000              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11001              (PL-LM-AGE (SUB2) EQUAL +0)
 11002              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11003              GO TO 3000-CONTINUE-EDIT.
 11004
 11005     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11006
 11007 0590-CHECK-AH-ATT-AGE.
 11008
 11009     IF PL-ATT-AGE NUMERIC AND
 11010        PL-ATT-AGE GREATER THAN +0
 11011        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11012     END-IF
 11013*       IF WS-ATT-AGE >= PL-ATT-AGE
 11014*          MOVE ER-3054          TO WS-ERROR
 11015*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11016     .
 11017 0597-CHECK-AH-LIMITS.
 11018
 11019     IF PB-COMPANY-ID EQUAL 'CRI'
 11020        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11021           IF SUB2 GREATER THAN +4
 11022              MOVE ER-2638       TO WS-ERROR
 11023              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11024              GO TO 3000-CONTINUE-EDIT.
 11025
 11026     IF PB-COMPANY-ID  =  'NCL'
 11027        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11028            SUB2 GREATER THAN +8
 11029             MOVE 'U'            TO PB-BATCH-ENTRY
 11030             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 202
* EL050.cbl
 11031             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11032             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11033
 11034     IF SUB2 > +8
 11035        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11036           AND (PB-I-SIG-SW = 'Y')
 11037           CONTINUE
 11038        ELSE
 11039           MOVE ER-2638          TO WS-ERROR
 11040           PERFORM 9900-ERROR-FORMAT
 11041                                 THRU 9900-EXIT
 11042        END-IF
 11043        GO TO 3000-CONTINUE-EDIT
 11044     END-IF
 11045
 11046     IF PB-COMPANY-ID = 'CRI'
 11047        IF WS-ERROR = ER-2638
 11048           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11049
 11050     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11051     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11052     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11053     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11054
 11055     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11056        ADD +1                   TO SUB2
 11057        GO TO 0597-CHECK-AH-LIMITS.
 11058
 11059     IF PB-COMPANY-ID = 'NCL'
 11060         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11061
 11062     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11063        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11064        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11065                                 > PL-LM-AMT (SUB2))
 11066        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11067           AND (PB-I-SIG-SW = 'Y')
 11068           CONTINUE
 11069        ELSE
 11070           MOVE ER-2638          TO WS-ERROR
 11071           PERFORM 9900-ERROR-FORMAT
 11072                                 THRU 9900-EXIT
 11073        END-IF
 11074     END-IF
 11075
 11076     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11077         IF  WS-ERROR    EQUAL    ER-2638
 11078             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11079                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11080                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11081                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11082                MOVE  ER-1910    TO  WS-ERROR
 11083                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11084
 11085     IF PB-COMPANY-ID = 'CRI'
 11086        IF WS-ERROR = ER-2638
 11087            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11088            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 203
* EL050.cbl
 11089            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11090
 11091     GO TO 3000-CONTINUE-EDIT.
 11092
 11093 0597-CHECK-NCL-AH-LIMITS.
 11094
 11095     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11096        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11097        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11098                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11099         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11100
 11101     IF APP-CERT-USED
 11102         IF SUB2  LESS THAN  +5
 11103             MOVE +5             TO SUB2
 11104             GO TO 0597-CHECK-AH-LIMITS.
 11105
 11106     MOVE ER-2638                TO WS-ERROR.
 11107     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11108
 11109     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11110
 11111 0599-CHECK-NCL-SIG-SWITCH.
 11112
 11113     IF NOT APP-CERT-USED
 11114         GO TO 3000-CONTINUE-EDIT.
 11115
 11116     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11117        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11118        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11119        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11120         GO TO 3000-CONTINUE-EDIT.
 11121
 11122     IF SUB2 GREATER THAN +4
 11123         IF PL-LM-AGE (5) = ZEROS  AND
 11124            PL-LM-AGE (6) = ZEROS  AND
 11125            PL-LM-AGE (7) = ZEROS  AND
 11126            PL-LM-AGE (8) = ZEROS
 11127             MOVE  ER-1927        TO WS-ERROR
 11128             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11129             GO TO 3000-CONTINUE-EDIT
 11130         ELSE
 11131             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11132                 MOVE  ER-1920    TO WS-ERROR
 11133                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11134
 11135     IF PB-I-SIG-SW  = 'Y'
 11136       IF NOT PB-I-POLICY-ACCEPTED  AND
 11137          NOT PB-I-POLICY-DECLINED
 11138           MOVE 'U'               TO PB-BATCH-ENTRY
 11139           MOVE  ER-1926          TO WS-ERROR
 11140           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11141
 11142******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 204
* EL050.cbl
 11144
 11145 3000-CONTINUE-EDIT.
 11146
 11147     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11148     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11149     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11150     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11151     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11152
 11153     IF BROWSE-STARTED
 11154        PERFORM 9990-RETURN THRU 9990-EXIT
 11155        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11156
 11157     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11158        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11159        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11160        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11161*       MOVE 1                   TO DC-OPTION-CODE
 11162        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11163        IF DATE-CONVERSION-ERROR
 11164           MOVE ER-2622          TO WS-ERROR
 11165           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11166        ELSE
 11167           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11168              MOVE ER-2623       TO WS-ERROR
 11169              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11170           ELSE
 11171              MOVE ER-2622       TO WS-ERROR
 11172              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11173
 11174     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11175     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11176     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11177*    MOVE 1                      TO DC-OPTION-CODE.
 11178     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11179     IF DATE-CONVERSION-ERROR
 11180        GO TO 3005-EDIT-CONTINUE
 11181     ELSE
 11182        IF DC-ELAPSED-DAYS GREATER +180
 11183           MOVE ER-2613          TO WS-ERROR
 11184           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11185        ELSE
 11186           IF DC-ELAPSED-DAYS GREATER +90
 11187              MOVE ER-2612       TO WS-ERROR
 11188              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11189           ELSE
 11190             IF DC-ELAPSED-DAYS GREATER +60
 11191                MOVE ER-2614     TO WS-ERROR
 11192                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11193
 11194 3005-EDIT-CONTINUE.
 11195
 11196     IF PB-CANCELLATION
 11197         GO TO 3700-EDIT-CANCEL.
 11198
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 205
* EL050.cbl
 11200******************************************************************
 11201*                  E D I T   I S S U E                           *
 11202******************************************************************
 11203
 11204 3020-EDIT-ISSUE.
 11205
 11206      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11207      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11208      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11209      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11210      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11211
 11212     IF PB-ISSUE-FORCE
 11213        OR PB-ISSUE-DATE-FORCED
 11214        OR PB-FORCE-OFF
 11215        OR PB-OVERCHARGE-FORCE
 11216        CONTINUE
 11217     ELSE
 11218        MOVE ER-2670             TO WS-ERROR
 11219        PERFORM 9900-ERROR-FORMAT
 11220                                 THRU 9900-EXIT
 11221     END-IF
 11222     .
 11223 3022-SET-POLICY-STATUS.
 11224
 11225     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11226
 11227     IF (PB-REISSUED-CERT)
 11228             OR
 11229        ((PB-COMPANY-ID NOT = 'DCC')
 11230         AND (PB-MONTHLY-CERT))
 11231         MOVE '5'                TO PB-I-ENTRY-STATUS
 11232         MOVE 'E'                TO PB-BATCH-ENTRY
 11233     END-IF
 11234
 11235     IF PB-COMPANY-ID = 'DCC'
 11236        IF PB-MONTHLY-CERT
 11237           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11238        END-IF
 11239     END-IF
 11240     IF PB-POLICY-IS-DECLINED
 11241         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11242     IF PB-POLICY-IS-VOIDED
 11243         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11244     IF PB-NEEDS-UNDERWRITING
 11245         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11246     IF PB-REIN-ONLY-CERT
 11247         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11248     IF PB-PREM-ACCTNG-ONLY
 11249         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11250
 11251     MOVE SPACE                  TO PB-I-OB-FLAG.
 11252
 11253     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11254         MOVE ER-2665            TO WS-ERROR
 11255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11256         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11257
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 206
* EL050.cbl
 11258     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11259        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11260           MOVE 'Z'             TO PB-I-OB-FLAG.
 11261
 11262     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11263        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11264           MOVE 'Z'             TO PB-I-OB-FLAG.
 11265
 11266     IF ACCOUNT-MAST-FOUND
 11267         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11268         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11269         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11270         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11271         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11272         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11273         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11274     END-IF
 11275
 11276     IF ACCOUNT-MAST-FOUND
 11277        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11278         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11279
 11280     IF (ACCOUNT-MAST-FOUND)
 11281        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11282        IF PB-REISSUED-CERT
 11283           CONTINUE
 11284        ELSE
 11285           MOVE ER-2608          TO WS-ERROR
 11286           PERFORM 9900-ERROR-FORMAT
 11287                                 THRU 9900-EXIT
 11288         END-IF
 11289     END-IF
 11290
 11291     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11292        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11293        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11294
 11295**********   DMD CUSTOM CODE FOLLOWS  **********
 11296 3024-EDIT-DMD-FIELDS.
 11297     IF PB-COMPANY-ID NOT = 'DMD'
 11298        GO TO 3025-EDIT-REINSURANCE.
 11299
 11300*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11301*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11302*** ERROR IF THEY ARE NOT EQUAL.
 11303
 11304     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11305     SET BIN-TO-GREG               TO TRUE.
 11306     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11307     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11308**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11309
 11310     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11311     SET BIN-TO-GREG               TO TRUE.
 11312     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11313     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11314**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11315
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 207
* EL050.cbl
 11316     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11317        MOVE ER-8116               TO WS-ERROR
 11318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11319
 11320     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11321
 11322     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11323                                      WK-FULL-CERT-NO.
 11324     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11325
 11326     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11327
 11328     IF PB-VALID-LIFE
 11329        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11330     ELSE
 11331        IF PB-VALID-AH
 11332          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11333
 11334
 11335     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11336     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11337     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11338                                      DCUA-UNDRWRTR-CODE
 11339                                      DCUA-UNDRWRTR-GROUP-CODE
 11340                                      DCUA-RETURN-CODE.
 11341
 11342****************************************************************
 11343*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11344***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11345***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11346***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11347***   TO THIS RECORD.                                        ***
 11348****************************************************************
 11349     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11350     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11351     IF DCUA-SUCCESSFUL-PROCESS
 11352        GO TO 3024-EDIT-DL7-CONT.
 11353
 11354     IF DCUA-RETURN-CODE EQUAL '01'
 11355        MOVE ER-8110               TO WS-ERROR
 11356        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11357        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11358        GO TO 3024-EDIT-DL7-CONT.
 11359
 11360     IF DCUA-RETURN-CODE EQUAL '02'
 11361        MOVE ER-8111               TO WS-ERROR
 11362        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11363        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11364        GO TO 3024-EDIT-DL7-CONT.
 11365
 11366     IF DCUA-RETURN-CODE EQUAL '03'
 11367        MOVE ER-8074               TO WS-ERROR
 11368        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11370        GO TO 3024-EDIT-DL7-CONT.
 11371
 11372     IF DCUA-RETURN-CODE EQUAL '04'
 11373        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 208
* EL050.cbl
 11374        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11375        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11376        GO TO 3024-EDIT-DL7-CONT.
 11377
 11378     IF DCUA-RETURN-CODE EQUAL '05'
 11379        MOVE ER-8076               TO WS-ERROR
 11380        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11382        GO TO 3024-EDIT-DL7-CONT.
 11383
 11384     IF DCUA-RETURN-CODE EQUAL '06'
 11385        MOVE ER-8077               TO WS-ERROR
 11386        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11388        GO TO 3024-EDIT-DL7-CONT.
 11389
 11390     IF DCUA-RETURN-CODE EQUAL '07'
 11391        MOVE ER-8078               TO WS-ERROR
 11392        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11394        GO TO 3024-EDIT-DL7-CONT.
 11395
 11396     IF DCUA-RETURN-CODE EQUAL 'E1'
 11397        MOVE ER-8079               TO WS-ERROR
 11398        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11400        GO TO 3024-EDIT-DL7-CONT.
 11401
 11402     IF DCUA-RETURN-CODE EQUAL 'E2'
 11403        MOVE ER-8080               TO WS-ERROR
 11404        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11405        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11406        GO TO 3024-EDIT-DL7-CONT.
 11407
 11408     IF DCUA-RETURN-CODE EQUAL 'E3'
 11409        MOVE ER-8098               TO WS-ERROR
 11410        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11411        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11412        GO TO 3024-EDIT-DL7-CONT.
 11413
 11414     IF DCUA-RETURN-CODE EQUAL 'C1'
 11415        MOVE ER-8099               TO WS-ERROR
 11416        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11417        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11418        GO TO 3024-EDIT-DL7-CONT.
 11419
 11420     IF DCUA-RETURN-CODE EQUAL 'U1'
 11421        MOVE ER-8109               TO WS-ERROR
 11422        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11423        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11424        GO TO 3024-EDIT-DL7-CONT.
 11425
 11426     IF DCUA-RETURN-CODE EQUAL 'N1'
 11427        MOVE ER-8112               TO WS-ERROR
 11428        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11429        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11430        GO TO 3024-EDIT-DL7-CONT.
 11431
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 209
* EL050.cbl
 11432     IF DCUA-RETURN-CODE EQUAL 'N2'
 11433        MOVE ER-8113               TO WS-ERROR
 11434        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11435        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11436        GO TO 3024-EDIT-DL7-CONT.
 11437
 11438     IF DCUA-RETURN-CODE EQUAL 'N3'
 11439        MOVE ER-8114               TO WS-ERROR
 11440        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11441        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11442        GO TO 3024-EDIT-DL7-CONT.
 11443
 11444     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11445     MOVE ER-8097                  TO WS-ERROR.
 11446     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11447     GO TO 3024-EDIT-DL7-CONT.
 11448
 11449 3024-EDIT-DL7-CONT.
 11450
 11451     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11452     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11453     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11454        NEXT SENTENCE
 11455     ELSE
 11456        MOVE ER-9263               TO WS-ERROR
 11457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11458
 11459******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11460******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11461     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11462        NEXT SENTENCE
 11463     ELSE
 11464        MOVE ER-8039               TO WS-ERROR
 11465        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11466
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 210
* EL050.cbl
 11468****************************************************************
 11469*** VALIDATE STATE  : DLO022                                 ***
 11470****************************************************************
 11471     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11472     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11473
 11474     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11475     IF DVSC-SUCCESSFUL-EDIT
 11476        GO TO 3024-EDIT-DL22-CONT.
 11477
 11478     IF DVSC-RETURN-CODE EQUAL '01'
 11479        MOVE ER-8300               TO WS-ERROR
 11480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11481        GO TO 3024-EDIT-DL22-CONT.
 11482
 11483     IF DVSC-RETURN-CODE EQUAL '02'
 11484        MOVE ER-8301               TO WS-ERROR
 11485        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11486        GO TO 3024-EDIT-DL22-CONT.
 11487
 11488     IF DVSC-RETURN-CODE EQUAL '03'
 11489        MOVE ER-8302               TO WS-ERROR
 11490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11491        GO TO 3024-EDIT-DL22-CONT.
 11492
 11493     IF DVSC-RETURN-CODE EQUAL 'N1'
 11494        MOVE ER-8304               TO WS-ERROR
 11495        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11496        GO TO 3024-EDIT-DL22-CONT.
 11497
 11498     MOVE ER-8303                  TO WS-ERROR
 11499     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11500
 11501 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 211
* EL050.cbl
 11503****************************************************************
 11504*** VALIDATE LOAN OFFICER : DLO021                           ***
 11505****************************************************************
 11506
 11507     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11508     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11509     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11510     IF DVLO-SUCCESSFUL-EDIT
 11511        GO TO 3024-EDIT-DL21-CONT.
 11512
 11513     IF DVLO-RETURN-CODE EQUAL '01'
 11514        MOVE ER-8081               TO WS-ERROR
 11515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11516        GO TO 3024-EDIT-DL21-CONT.
 11517
 11518     IF DVLO-RETURN-CODE EQUAL '02'
 11519        MOVE ER-8082               TO WS-ERROR
 11520        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11521        GO TO 3024-EDIT-DL21-CONT.
 11522
 11523     IF DVLO-RETURN-CODE EQUAL '03'
 11524        MOVE ER-8083               TO WS-ERROR
 11525        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11526        GO TO 3024-EDIT-DL21-CONT.
 11527
 11528     IF DVLO-RETURN-CODE EQUAL '04'
 11529        MOVE ER-8084               TO WS-ERROR
 11530        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11531        GO TO 3024-EDIT-DL21-CONT.
 11532
 11533     IF DVLO-RETURN-CODE EQUAL '05'
 11534        MOVE ER-8085               TO WS-ERROR
 11535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11536        GO TO 3024-EDIT-DL21-CONT.
 11537
 11538     MOVE ER-7825                  TO WS-ERROR
 11539     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11540     GO TO 3024-EDIT-DL21-CONT.
 11541
 11542 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 212
* EL050.cbl
 11544
 11545****************************************************************
 11546*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11547****************************************************************
 11548
 11549     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11550     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11551     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11552     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11553     IF DIPF-SUCCESSFUL-EDIT
 11554        GO TO 3024-EDIT-DL02-CONT.
 11555
 11556     IF DIPF-RETURN-CODE EQUAL '01'
 11557        MOVE ER-8086               TO WS-ERROR
 11558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11559        GO TO 3024-EDIT-DL02-CONT.
 11560
 11561     IF DIPF-RETURN-CODE EQUAL '02'
 11562        MOVE ER-8087               TO WS-ERROR
 11563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11564        GO TO 3024-EDIT-DL02-CONT.
 11565
 11566     IF DIPF-RETURN-CODE EQUAL '03'
 11567        MOVE ER-8088               TO WS-ERROR
 11568        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11569        GO TO 3024-EDIT-DL02-CONT.
 11570
 11571     MOVE ER-8095                  TO WS-ERROR
 11572     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11573     GO TO 3024-EDIT-DL02-CONT.
 11574
 11575 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 213
* EL050.cbl
 11577
 11578****************************************************************
 11579*** VALIDATE BANK ID : DLO003                                ***
 11580****************************************************************
 11581
 11582     MOVE WK-GREG-CENT           TO WCG-CENT.
 11583     MOVE WK-GREG-YYMM           TO WCG-REST.
 11584     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11585        MOVE ER-8040               TO WS-ERROR
 11586        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11587
 11588     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11589     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11590     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11591     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11592     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11593     IF DVBI-SUCCESSFUL-EDIT
 11594        GO TO 3024-EDIT-DL03-CONT.
 11595
 11596     IF DVBI-RETURN-CODE EQUAL '01'
 11597        MOVE ER-8089               TO WS-ERROR
 11598        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11599        GO TO 3024-EDIT-DL03-CONT.
 11600
 11601     IF DVBI-RETURN-CODE EQUAL '02'
 11602        MOVE ER-8090               TO WS-ERROR
 11603        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11604        GO TO 3024-EDIT-DL03-CONT.
 11605
 11606     IF DVBI-RETURN-CODE EQUAL '03'
 11607        MOVE ER-8091               TO WS-ERROR
 11608        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11609        GO TO 3024-EDIT-DL03-CONT.
 11610
 11611     IF DVBI-RETURN-CODE EQUAL '04'
 11612        MOVE ER-8092               TO WS-ERROR
 11613        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11614        GO TO 3024-EDIT-DL03-CONT.
 11615
 11616     IF DVBI-RETURN-CODE EQUAL '05'
 11617        MOVE ER-8093               TO WS-ERROR
 11618        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11619        GO TO 3024-EDIT-DL03-CONT.
 11620
 11621     IF DVBI-RETURN-CODE EQUAL '06'
 11622        MOVE ER-8094               TO WS-ERROR
 11623        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11624        GO TO 3024-EDIT-DL03-CONT.
 11625
 11626     MOVE ER-8096                  TO WS-ERROR
 11627     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11628     GO TO 3024-EDIT-DL03-CONT.
 11629
 11630 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 214
* EL050.cbl
 11632
 11633     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11634        NEXT SENTENCE
 11635     ELSE
 11636        MOVE ER-8042               TO WS-ERROR
 11637        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11638
 11639     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11640     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11641     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11642
 11643     IF DMPF-RETURN-CODE = '01'
 11644        MOVE ER-8067               TO WS-ERROR
 11645        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11646        GO TO 3024-EDIT-DL01-CONT.
 11647
 11648     IF DMPF-RETURN-CODE = '02'
 11649        MOVE ER-8068               TO WS-ERROR
 11650        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11651        GO TO 3024-EDIT-DL01-CONT.
 11652
 11653     IF DMPF-RETURN-CODE = '03'
 11654        MOVE ER-8069               TO WS-ERROR
 11655        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11656        GO TO 3024-EDIT-DL01-CONT.
 11657
 11658     IF DMPF-RETURN-CODE = 'E1'
 11659        MOVE ER-8070               TO WS-ERROR
 11660        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11661        GO TO 3024-EDIT-DL01-CONT.
 11662
 11663     IF DMPF-RETURN-CODE = 'N1'
 11664        MOVE ER-8071               TO WS-ERROR
 11665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11666        GO TO 3024-EDIT-DL01-CONT.
 11667
 11668     IF DMPF-RETURN-CODE NOT = 'OK'
 11669        MOVE ER-8072               TO WS-ERROR
 11670        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11671
 11672 3024-EDIT-DL01-CONT.
 11673******************************************************************
 11674***  VALIDATES RATE CODES : DLO017                             ***
 11675******************************************************************
 11676
 11677      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11678      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11679      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11680      IF DVRC-SUCCESSFUL-EDIT
 11681        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11682        GO TO 3024-CHECK-VALID-RATE.
 11683
 11684      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11685
 11686      IF DVRC-RETURN-CODE EQUAL '01'
 11687         MOVE ER-7817                   TO WS-ERROR
 11688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11689         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 215
* EL050.cbl
 11690
 11691      IF DVRC-RETURN-CODE EQUAL '02'
 11692         MOVE ER-7818                   TO WS-ERROR
 11693         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11694         GO TO 3025-EDIT-REINSURANCE.
 11695
 11696      IF DVRC-RETURN-CODE EQUAL '03'
 11697         MOVE ER-7819                   TO WS-ERROR
 11698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11699         GO TO 3025-EDIT-REINSURANCE.
 11700
 11701       MOVE ER-7820                     TO WS-ERROR.
 11702       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11703       GO TO 3025-EDIT-REINSURANCE.
 11704
 11705******************************************************************
 11706***  GET PREMIUM RATES : DLO011                                ***
 11707******************************************************************
 11708
 11709 3024-CHECK-VALID-RATE.
 11710
 11711     IF VALID-RATE-CODE
 11712        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11713        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11714        MOVE SPACES                TO DPRB-RETURN-CODE
 11715        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11716     ELSE
 11717         GO TO 3025-EDIT-REINSURANCE.
 11718
 11719      IF DPRB-SUCCESSFUL-PROCESS
 11720         IF PB-VALID-LIFE
 11721             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11722             GO TO 3025-EDIT-REINSURANCE
 11723         ELSE
 11724             IF PB-VALID-AH
 11725                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11726                 GO TO 3025-EDIT-REINSURANCE.
 11727
 11728      IF DPRB-RETURN-CODE EQUAL '01'
 11729         MOVE ER-7812                   TO WS-ERROR
 11730         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11731         GO TO 3025-EDIT-REINSURANCE.
 11732
 11733      IF DPRB-RETURN-CODE EQUAL '02'
 11734         MOVE ER-7813                   TO WS-ERROR
 11735         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11736         GO TO 3025-EDIT-REINSURANCE.
 11737
 11738      IF DPRB-RETURN-CODE EQUAL '03'
 11739         MOVE ER-7814                   TO WS-ERROR
 11740         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11741         GO TO 3025-EDIT-REINSURANCE.
 11742
 11743      IF DPRB-RETURN-CODE EQUAL '04'
 11744         IF NOT DPRB-1ST-TIME
 11745            MOVE ER-7815                   TO WS-ERROR
 11746            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11747            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 216
* EL050.cbl
 11748          ELSE
 11749         IF PB-VALID-LIFE
 11750            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11751          ELSE
 11752            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11753         END-IF
 11754         MOVE SPACES                TO DOCC-RETURN-CODE
 11755         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11756         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11757         IF DOCC-RETURN-CODE = 'OK'
 11758             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11759             GO TO 3024-CHECK-VALID-RATE
 11760           ELSE
 11761             MOVE ER-7823               TO WS-ERROR
 11762             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11763             GO TO 3025-EDIT-REINSURANCE.
 11764
 11765       MOVE ER-7816                     TO WS-ERROR.
 11766       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11767       GO TO 3025-EDIT-REINSURANCE.
 11768
 11769**********   DMD CUSTOM CODE ABOVE    **********
 11770
 11771 3025-EDIT-REINSURANCE.
 11772     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11773         GO TO 3027-EDIT-CONTINUE.
 11774
 11775     MOVE LOW-VALUES               TO ERREIN-KEY.
 11776     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11777     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11778                                      REIN-CODE-2
 11779                                      REIN-CODE-3.
 11780     MOVE 'A'                      TO REIN-TYPE.
 11781
 11782     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11783
 11784     MOVE '3026' TO REIN-SW.
 11785     MOVE ' '                   TO WS-REIN-READ-SW.
 11786
 11787     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11788     IF REIN-TABLE-NOT-FOUND
 11789         GO TO 3026-NO-SPEC-TABLE.
 11790
 11791     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11792     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11793                                   WS-NSP-ST-CD-LF.
 11794     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11795                                   WS-NSP-ST-CD-AH.
 11796
 11797     GO TO 3040-EDIT-CONTINUE.
 11798
 11799 3026-NO-SPEC-TABLE.
 11800
 11801     MOVE ER-2664                TO WS-ERROR.
 11802     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11803     GO TO 3040-EDIT-CONTINUE.
 11804
 11805 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 217
* EL050.cbl
 11806
 11807     IF PB-I-REIN-TABLE = SPACES
 11808       GO TO 3040-EDIT-CONTINUE.
 11809
 11810     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11811          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11812          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11813           GO TO 3040-EDIT-CONTINUE.
 11814
 11815     MOVE LOW-VALUES            TO ERREIN-KEY.
 11816     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11817     MOVE 'A'                   TO REIN-TYPE.
 11818     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11819
 11820     MOVE '3028'                TO REIN-SW.
 11821     MOVE ' '                   TO WS-REIN-READ-SW.
 11822
 11823     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11824     IF REIN-TABLE-NOT-FOUND
 11825         GO TO 3028-NO-REIN-TABLE.
 11826
 11827     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11828     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11829                                   WS-NSP-ST-CD-LF.
 11830     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11831                                   WS-NSP-ST-CD-AH.
 11832
 11833     GO TO 3040-EDIT-CONTINUE.
 11834
 11835 3028-NO-REIN-TABLE.
 11836
 11837     MOVE ER-2615                TO WS-ERROR.
 11838     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11839     GO TO 3040-EDIT-CONTINUE.
 11840
 11841 3040-EDIT-CONTINUE.
 11842
 11843     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11844         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11845
 11846     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11847         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11848
 11849     IF (NOT PB-REISSUED-CERT)
 11850        AND (NOT PB-MONTHLY-CERT)
 11851        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11852            MOVE '001'           TO PB-I-LF-TERM
 11853            MOVE 'M'             TO PB-I-INSURED-SEX.
 11854
 11855     IF (NOT PB-REISSUED-CERT)
 11856        AND (NOT PB-MONTHLY-CERT)
 11857        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11858            MOVE '001'           TO PB-I-AH-TERM
 11859            MOVE 'M'             TO PB-I-INSURED-SEX.
 11860
 11861 3040-EDIT-1ST-PMT-DT.
 11862     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11863     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 218
* EL050.cbl
 11864         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11865
 11866******************************************************************
 11867*                                                                *
 11868*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11869*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11870*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11871*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11872*                                                                *
 11873******************************************************************
 11874
 11875     IF PB-EFF-DT-PROCESSING
 11876        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11877                                    PB-I-LF-EXPIRE-DT
 11878                                    PB-I-AH-EXPIRE-DT
 11879        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11880        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11881        MOVE ZERO                TO DC-ELAPSED-DAYS
 11882        MOVE +1                  TO DC-ELAPSED-MONTHS
 11883        SET BIN-PLUS-ELAPSED     TO TRUE
 11884*       MOVE 6                   TO DC-OPTION-CODE
 11885        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11886        IF NO-CONVERSION-ERROR
 11887           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11888
 11889******************************************************************
 11890*                                                                *
 11891*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11892*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11893*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11894*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11895*                                                                *
 11896******************************************************************
 11897
 11898     IF PB-EXT-DAYS-PROCESSING
 11899          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11900                                         PB-I-LF-EXPIRE-DT
 11901                                         PB-I-AH-EXPIRE-DT
 11902          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11903          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11904          MOVE +1                     TO DC-ELAPSED-MONTHS
 11905          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11906          SET BIN-PLUS-ELAPSED        TO TRUE
 11907*         MOVE 6                      TO DC-OPTION-CODE
 11908          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11909          IF NO-CONVERSION-ERROR
 11910             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11911
 11912******************************************************************
 11913*                                                                *
 11914*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11915*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11916*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11917*        (EXPIRE DATE - (TERM -1))  *  -1.
 11918*                                                                *
 11919******************************************************************
 11920
 11921     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 219
* EL050.cbl
 11922        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11923           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11924              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11925              MOVE PB-I-AH-TERM      TO WS-TERM
 11926           ELSE
 11927              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11928              MOVE PB-I-LF-TERM      TO WS-TERM
 11929        ELSE
 11930           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11931              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11932              MOVE PB-I-LF-TERM      TO WS-TERM
 11933           ELSE
 11934              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11935              MOVE PB-I-AH-TERM      TO WS-TERM.
 11936
 11937     IF PB-EXPIRE-DT-PROCESSING
 11938        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11939        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11940        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11941        MOVE ZERO                TO DC-ELAPSED-DAYS
 11942                                    DC-ODD-DAYS-OVER
 11943          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11944          SET BIN-PLUS-ELAPSED    TO TRUE
 11945*         MOVE 6                  TO DC-OPTION-CODE
 11946          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11947          IF NO-CONVERSION-ERROR
 11948             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11949
 11950******************************************************************
 11951*                                                                *
 11952*            1ST PAYMENT DATE PROCESSING                         *
 11953*                                                                *
 11954******************************************************************
 11955
 11956     IF PB-1ST-PMT-DT-PROCESSING
 11957        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11958                                    PB-I-AH-EXPIRE-DT
 11959        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11960
 11961     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11962         NEXT SENTENCE
 11963     ELSE
 11964         MOVE ER-2680                 TO WS-ERROR
 11965         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11966         GO TO 3060-ORIG-TERM-CHECK.
 11967
 11968     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11969     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11970     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11971*    MOVE 1                      TO DC-OPTION-CODE.
 11972     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11973                                    DC-ELAPSED-DAYS
 11974                                    DC-ODD-DAYS-OVER.
 11975
 11976     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11977
 11978     IF DATE-CONVERSION-ERROR
 11979        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 220
* EL050.cbl
 11980
 11981     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11982     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11983        AND (WS-LF-COVERAGE-TYPE = 'L')
 11984        IF (DC-ELAPSED-MONTHS > 1)
 11985                      OR
 11986           ((DC-ELAPSED-MONTHS = 1)
 11987           AND (DC-ODD-DAYS-OVER > 0))
 11988           MOVE ER-2882          TO WS-ERROR
 11989           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11990        END-IF
 11991     END-IF
 11992     if dc-elapsed-months > 0
 11993        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 11994        + dc-odd-days-over
 11995     end-if
 11996     IF PB-EXT-DAYS-PROCESSING
 11997        CONTINUE
 11998     ELSE
 11999        IF DC-ELAPSED-MONTHS = +0
 12000           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12001        ELSE
 12002           IF (WS-LF-EARNINGS-CALC = '4')
 12003              AND (DC-ELAPSED-MONTHS > ZERO)
 12004              AND (DC-ELAPSED-DAYS > ZERO)
 12005              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12006           ELSE
 12007              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12008                                 THRU 6499-EXIT
 12009              MOVE WS-ODD-DAYS-OVER
 12010                                 TO PB-I-EXTENTION-DAYS
 12011           END-IF
 12012        END-IF
 12013     END-IF
 12014******************************************************************
 12015*                                                                *
 12016*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12017*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12018*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12019*            AND ANY ODD DAYS.                                   *
 12020*                                                                *
 12021******************************************************************
 12022
 12023     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12024                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12025     IF WS-LF-EARNINGS-CALC NOT = '4'
 12026        IF DC-ELAPSED-DAYS > ZEROS
 12027           MOVE ER-2681          TO WS-ERROR
 12028           PERFORM 9900-ERROR-FORMAT
 12029                                 THRU 9900-EXIT
 12030        END-IF
 12031     END-IF
 12032
 12033     IF WS-LF-EARNINGS-CALC NOT = '4'
 12034        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12035           MOVE ER-2681          TO WS-ERROR
 12036           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12037
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 221
* EL050.cbl
 12038     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12039        (PB-I-LF-TERM NOT = ZERO) AND
 12040         NOT NO-LIFE-COVERAGE
 12041          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12042          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12043          IF WS-LF-EARNINGS-CALC = '4'
 12044             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12045             PB-I-PAY-FREQUENCY
 12046          END-IF
 12047          MOVE ZERO              TO DC-ELAPSED-DAYS
 12048                                    DC-ODD-DAYS-OVER
 12049          MOVE 1                 TO DC-END-OF-MONTH
 12050          SET BIN-PLUS-ELAPSED        TO TRUE
 12051*         MOVE 6                 TO DC-OPTION-CODE
 12052          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12053          IF NO-CONVERSION-ERROR
 12054             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12055             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12056                (WS-LF-SPECIAL-CALC-CD = 'L')
 12057                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12058                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12059                  MOVE +1             TO DC-ELAPSED-MONTHS
 12060                  SET BIN-PLUS-ELAPSED  TO TRUE
 12061*                 MOVE 6              TO DC-OPTION-CODE
 12062                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12063                  IF NO-CONVERSION-ERROR
 12064                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12065
 12066* okay, i had to move the new att age edit down here because the
 12067* expiration date could get recalculated and i need the exp date
 12068     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12069        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12070        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12071        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12072           AND ZEROS
 12073           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12074           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12075           SET ELAPSED-BETWEEN-BIN TO TRUE
 12076           PERFORM 8500-DATE-CONVERT
 12077                                 THRU 8500-EXIT
 12078           IF NO-CONVERSION-ERROR
 12079              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12080                 MOVE ER-2669       TO WS-ERROR
 12081*                PERFORM 9900-ERROR-FORMAT
 12082*                                THRU 9900-EXIT
 12083              END-IF
 12084           END-IF
 12085        ELSE
 12086           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12087           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12088              MOVE ER-2669       TO WS-ERROR
 12089*             PERFORM 9900-ERROR-FORMAT
 12090*                                THRU 9900-EXIT
 12091           ELSE
 12092              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12093                 MOVE ER-1570    TO WS-ERROR
 12094                 PERFORM 9900-ERROR-FORMAT
 12095                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 222
* EL050.cbl
 12096              END-IF
 12097           END-IF
 12098        END-IF
 12099        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12100           AND ZEROS
 12101           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12102           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12103           SET ELAPSED-BETWEEN-BIN TO TRUE
 12104           PERFORM 8500-DATE-CONVERT
 12105                                 THRU 8500-EXIT
 12106           IF NO-CONVERSION-ERROR
 12107              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12108                 MOVE ER-2669       TO WS-ERROR
 12109*                PERFORM 9900-ERROR-FORMAT
 12110*                                THRU 9900-EXIT
 12111              END-IF
 12112           END-IF
 12113        ELSE
 12114           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12115             (PB-I-LF-TERM / 12)
 12116           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12117              MOVE ER-2669       TO WS-ERROR
 12118*             PERFORM 9900-ERROR-FORMAT
 12119*                                THRU 9900-EXIT
 12120           ELSE
 12121              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12122                 MOVE ER-1571    TO WS-ERROR
 12123                 PERFORM 9900-ERROR-FORMAT
 12124                                 THRU 9900-EXIT
 12125              END-IF
 12126           END-IF
 12127        END-IF
 12128        IF WS-ERROR = ER-2669
 12129           PERFORM 9900-ERROR-FORMAT
 12130                                 THRU 9900-EXIT
 12131        END-IF
 12132     END-IF
 12133     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12134        (PB-I-AH-TERM NOT = ZERO) AND
 12135         NOT NO-AH-COVERAGE
 12136          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12137             AND (PB-COMPANY-ID = 'DCC')
 12138             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12139             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12140          ELSE
 12141             IF WS-LF-EARNINGS-CALC = '4'
 12142                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12143                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12144                PB-I-PAY-FREQUENCY
 12145             ELSE
 12146                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12147                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12148             END-IF
 12149          END-IF
 12150          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12151                                         DC-ODD-DAYS-OVER
 12152          MOVE 1                      TO DC-END-OF-MONTH
 12153          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 223
* EL050.cbl
 12154*         MOVE 6                      TO DC-OPTION-CODE
 12155          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12156          IF NO-CONVERSION-ERROR
 12157             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12158     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12159        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12160        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12161        IF PB-I-BIRTHDAY > LOW-VALUES
 12162           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12163           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12164           SET ELAPSED-BETWEEN-BIN TO TRUE
 12165           PERFORM 8500-DATE-CONVERT
 12166                                 THRU 8500-EXIT
 12167           IF NO-CONVERSION-ERROR
 12168              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12169                 MOVE ER-3054       TO WS-ERROR
 12170*                PERFORM 9900-ERROR-FORMAT
 12171*                                THRU 9900-EXIT
 12172              END-IF
 12173           END-IF
 12174        ELSE
 12175           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12176           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12177              MOVE ER-3054       TO WS-ERROR
 12178*             PERFORM 9900-ERROR-FORMAT
 12179*                                THRU 9900-EXIT
 12180           END-IF
 12181        END-IF
 12182        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12183           AND ZEROS
 12184           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12185           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12186           SET ELAPSED-BETWEEN-BIN TO TRUE
 12187           PERFORM 8500-DATE-CONVERT
 12188                                 THRU 8500-EXIT
 12189           IF NO-CONVERSION-ERROR
 12190              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12191                 MOVE ER-3054       TO WS-ERROR
 12192*                PERFORM 9900-ERROR-FORMAT
 12193*                                THRU 9900-EXIT
 12194              END-IF
 12195           END-IF
 12196        ELSE
 12197           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12198             (PB-I-AH-TERM / 12)
 12199           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12200              MOVE ER-3054       TO WS-ERROR
 12201*             PERFORM 9900-ERROR-FORMAT
 12202*                                THRU 9900-EXIT
 12203           END-IF
 12204        END-IF
 12205        IF WS-ERROR = ER-3054
 12206           PERFORM 9900-ERROR-FORMAT
 12207                                 THRU 9900-EXIT
 12208        END-IF
 12209     END-IF
 12210     MOVE SPACE                       TO DC-END-OF-MONTH.
 12211
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 224
* EL050.cbl
 12212     IF PB-COMPANY-ID = 'NCB'
 12213        GO TO 3040-EDIT-EXTENSION-DAYS.
 12214
 12215     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12216       AND
 12217        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12218        NEXT SENTENCE
 12219     ELSE
 12220        GO TO 3040-EDIT-EXTENSION-DAYS.
 12221
 12222     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12223        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12224        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12225     ELSE
 12226        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12227        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12228
 12229     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12230*    MOVE '1'      TO DC-OPTION-CODE
 12231     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12232     IF (NO-CONVERSION-ERROR)
 12233        AND (DC-ELAPSED-MONTHS > +1)
 12234        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12235        MOVE ER-2668   TO WS-ERROR
 12236        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12237
 12238 3040-EDIT-EXTENSION-DAYS.
 12239
 12240     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12241        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12242         GO TO 3050-EDIT-TERM-IN-DAYS
 12243     ELSE
 12244         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12245
 12246     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12247         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12248     ELSE
 12249        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12250           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12251           MOVE ER-2681         TO WS-ERROR
 12252           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12253
 12254     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12255        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12256        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12257         GO TO 3060-ORIG-TERM-CHECK.
 12258
 12259     GO TO 3060-ORIG-TERM-CHECK.
 12260
 12261 3050-EDIT-TERM-IN-DAYS.
 12262
 12263     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12264
 12265     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12266         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12267     ELSE
 12268         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12269            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 225
* EL050.cbl
 12270            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12271
 12272     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12273                                       REMAINDER WS-WORK-TERM.
 12274     IF WS-WORK-TERM GREATER THAN ZERO
 12275         ADD +1 TO PB-I-LF-TERM.
 12276
 12277     IF NOT NO-AH-COVERAGE
 12278         MOVE ER-2684            TO WS-ERROR
 12279         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12280
 12281
 12282 3060-ORIG-TERM-CHECK.
 12283
 12284******************************************************************
 12285*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12286******************************************************************
 12287
 12288     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12289        NEXT SENTENCE
 12290     ELSE
 12291        IF NOT NO-LIFE-COVERAGE
 12292           IF PB-I-LF-TERM NUMERIC
 12293              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12294              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12295              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12296                  NEXT SENTENCE
 12297           ELSE
 12298              MOVE ER-2647       TO WS-ERROR
 12299              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12300
 12301     IF NOT NO-AH-COVERAGE
 12302         IF PB-I-AH-TERM NUMERIC
 12303            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12304            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12305            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12306             NEXT SENTENCE
 12307          ELSE
 12308              MOVE ER-2658       TO WS-ERROR
 12309              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12310
 12311     IF PB-COMPANY-ID = 'NCB'
 12312        GO TO 3070-LOAN-TERM-CHECK.
 12313
 12314     IF POLICY-HAS-AH
 12315       AND
 12316        POLICY-HAS-LIFE
 12317       AND
 12318        PB-I-LF-TERM NUMERIC
 12319       AND
 12320        PB-I-AH-TERM NUMERIC
 12321        NEXT SENTENCE
 12322     ELSE
 12323        GO TO 3070-LOAN-TERM-CHECK.
 12324
 12325     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12326     IF WS-TEX-FACT-2 LESS THAN +0
 12327        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 226
* EL050.cbl
 12328
 12329     IF WS-TEX-FACT-2 GREATER THAN +1
 12330        MOVE ER-2668             TO WS-ERROR
 12331        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12332
 12333 3070-LOAN-TERM-CHECK.
 12334
 12335     IF (WS-LF-BENEFIT-CD = ZERO)
 12336         OR (NO-LF-BENEFIT-MATCH)
 12337            GO TO 3125-EDIT-PMT-FREQ.
 12338*    IF PB-COMPANY-ID NOT = 'DCC'
 12339*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12340*          AND 'V' AND 'W' AND 'X'
 12341*          GO TO 3125-EDIT-PMT-FREQ
 12342*       END-IF
 12343*    ELSE
 12344*       IF WS-AH-DCC-TRUNC = 'T'
 12345*          CONTINUE
 12346*       ELSE
 12347*          GO TO 3125-EDIT-PMT-FREQ
 12348*       END-IF
 12349*    END-IF
 12350     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12351                    OR
 12352        ((PB-COMPANY-ID = 'DCC')
 12353        AND (WS-AH-DCC-TRUNC = 'T'))
 12354        CONTINUE
 12355     ELSE
 12356        GO TO 3125-EDIT-PMT-FREQ
 12357     END-IF
 12358     IF PB-I-LOAN-TERM NOT NUMERIC
 12359         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12360
 12361     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12362        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12363*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12364        PB-I-LOAN-TERM NOT GREATER THAN +360
 12365         NEXT SENTENCE
 12366     ELSE
 12367         MOVE ER-2648            TO WS-ERROR
 12368         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12369
 12370     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12371        MOVE ER-3058             TO WS-ERROR
 12372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12373     end-if
 12374
 12375     IF WS-STATE-ABBREVIATION = 'NC'
 12376        IF PB-I-LOAN-TERM > +59
 12377           CONTINUE
 12378        ELSE
 12379           MOVE ER-2792          TO WS-ERROR
 12380           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12381        END-IF
 12382     END-IF
 12383
 12384     .
 12385 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 227
* EL050.cbl
 12386     IF (WS-LF-BENEFIT-CD = ZERO)
 12387         OR (NO-LF-BENEFIT-MATCH)
 12388            GO TO 3127-EDIT-LOAN-OFFICER.
 12389     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12390                    OR
 12391        ((PB-COMPANY-ID = 'DCC')
 12392        AND (WS-AH-DCC-TRUNC = 'T'))
 12393                    OR
 12394         (PB-COMPANY-ID = 'AHL')
 12395        CONTINUE
 12396     ELSE
 12397        IF (PB-I-LOAN-TERM > ZEROS)
 12398           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12399           MOVE ER-1575          TO WS-ERROR
 12400           PERFORM 9900-ERROR-FORMAT
 12401                                 THRU 9900-EXIT
 12402        END-IF
 12403     END-IF
 12404     IF WS-LF-EARNINGS-CALC NOT = '4'
 12405         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12406            MOVE ER-2653         TO WS-ERROR
 12407            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12408            GO TO 3127-EDIT-LOAN-OFFICER
 12409         ELSE
 12410            GO TO 3127-EDIT-LOAN-OFFICER.
 12411
 12412     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12413         MOVE ER-2655            TO WS-ERROR
 12414         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12415         GO TO 3127-EDIT-LOAN-OFFICER.
 12416
 12417     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12418         MOVE ER-2654            TO WS-ERROR
 12419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12420         GO TO 3127-EDIT-LOAN-OFFICER.
 12421
 12422     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12423         GIVING WS-TEX-FACT-2
 12424             REMAINDER WS-TEX-FACT-3.
 12425
 12426*    IF WS-TEX-FACT-3 NOT = ZERO
 12427*       MOVE ER-2654             TO WS-ERROR
 12428*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12429
 12430
 12431 3127-EDIT-LOAN-OFFICER.
 12432
 12433     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12434        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12435           MOVE ER-2690          TO WS-ERROR
 12436           PERFORM 9900-ERROR-FORMAT
 12437                                 THRU 9900-EXIT
 12438        ELSE
 12439           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12440           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12441           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12442           MOVE PB-SV-STATE      TO LOFC-STATE
 12443           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 228
* EL050.cbl
 12444           MOVE PB-I-LOAN-OFFICER
 12445                                 TO LOFC-CODE
 12446           PERFORM 8586-READ-LOAN-OFFICER
 12447                                 THRU 8586-EXIT
 12448           IF (NOT LOFC-MASTER-FOUND)
 12449              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12450              MOVE ER-3006       TO WS-ERROR
 12451              PERFORM 9900-ERROR-FORMAT
 12452                                 THRU 9900-EXIT
 12453           END-IF
 12454        END-IF
 12455     END-IF
 12456     .
 12457 3129-EDIT-APR.
 12458
 12459     IF (WS-LF-BENEFIT-CD = ZERO)
 12460        OR (NO-LF-BENEFIT-MATCH)
 12461        IF PB-COMPANY-ID NOT = 'DCC'
 12462           GO TO 3130-EDIT-AGE
 12463*       ELSE
 12464*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12465*             GO TO 3130-EDIT-AGE
 12466*          END-IF
 12467        END-IF
 12468     END-IF
 12469
 12470     IF (WS-STATE-ABBREVIATION = 'OH')
 12471         AND (PB-I-RATE-CLASS NOT = 'L ')
 12472         AND (PB-I-LF-TERM GREATER THAN 60)
 12473         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12474         GO TO 3129-APR-CONT.
 12475
 12476     IF (WS-STATE-ABBREVIATION = 'RI')
 12477         AND (PB-I-LF-TERM GREATER THAN 60)
 12478         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12479         GO TO 3129-APR-CONT.
 12480
 12481     IF (WS-STATE-ABBREVIATION = 'UT')
 12482         AND (PB-I-LF-TERM GREATER THAN 62)
 12483         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12484         AND (PB-CERT-EFF-DT LESS WS-830901)
 12485         GO TO 3129-APR-CONT.
 12486
 12487     IF PB-COMPANY-ID = 'LAP'
 12488        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12489           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12490              MOVE ER-2656         TO WS-ERROR
 12491              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12492              GO TO 3130-EDIT-AGE.
 12493
 12494     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12495        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12496        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12497        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12498        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12499        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12500         GO TO 3130-EDIT-AGE.
 12501
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 229
* EL050.cbl
 12502 3129-APR-CONT.
 12503     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12504         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12505         GO TO 3130-EDIT-AGE.
 12506
 12507     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12508         WS-AH-BENEFIT-CD (1:1) = 'S')
 12509        AND (PB-COMPANY-ID = 'DCC')
 12510        AND (PB-I-LOAN-APR = ZERO)
 12511        MOVE ER-2657             TO WS-ERROR
 12512        PERFORM 9900-ERROR-FORMAT
 12513                                 THRU 9900-EXIT
 12514        GO TO 3130-EDIT-AGE
 12515     END-IF
 12516     IF PB-I-LOAN-APR = ZERO
 12517        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12518     END-IF
 12519
 12520     IF PB-I-LOAN-APR = ZERO
 12521        MOVE ER-2656             TO WS-ERROR
 12522        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12523        GO TO 3130-EDIT-AGE.
 12524
 12525*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12526     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12527        MOVE ER-2657             TO WS-ERROR
 12528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12529
 12530 3130-EDIT-AGE.
 12531
 12532******************************************************************
 12533*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12534******************************************************************
 12535
 12536     IF NOT NO-LIFE-COVERAGE
 12537        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12538           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12539               MOVE ER-2628             TO WS-ERROR
 12540               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12541
 12542     IF NOT NO-AH-COVERAGE
 12543        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12544           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12545               MOVE ER-2628         TO WS-ERROR
 12546               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12547
 12548 3133-SEX-CODE.
 12549     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12550         IF WS-DEFAULT-SEX = 'M'
 12551             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12552          ELSE
 12553             IF WS-DEFAULT-SEX = 'F'
 12554             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12555
 12556     IF PB-I-INSURED-SEX = '1'
 12557         MOVE 'M' TO PB-I-INSURED-SEX.
 12558
 12559     IF PB-I-INSURED-SEX = '2'
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 230
* EL050.cbl
 12560         MOVE 'F' TO PB-I-INSURED-SEX.
 12561
 12562 3134-SIG-SW-EDIT.
 12563     IF PB-I-SIG-SW = SPACE
 12564         MOVE 'N'                TO  PB-I-SIG-SW.
 12565
 12566     IF PB-COMPANY-ID = 'NCL'
 12567         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12568             NEXT SENTENCE
 12569         ELSE
 12570             MOVE ER-1923        TO  WS-ERROR
 12571             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12572     ELSE
 12573     IF PB-COMPANY-ID = 'CRI'
 12574         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12575             NEXT SENTENCE
 12576         ELSE
 12577             MOVE ER-2606        TO  WS-ERROR
 12578             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12579     ELSE
 12580     IF PB-COMPANY-ID = 'TMS'
 12581         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12582             NEXT SENTENCE
 12583         ELSE
 12584             MOVE ER-2689        TO  WS-ERROR
 12585             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12586     ELSE
 12587         IF PB-I-SIG-SW = 'Y' OR 'N'
 12588             NEXT SENTENCE
 12589         ELSE
 12590             MOVE ER-2651        TO  WS-ERROR
 12591             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12592
 12593     IF PB-COMPANY-ID = 'FLA'
 12594         IF (WS-EDIT-AGE GREATER 54  OR
 12595             WS-AH-EDIT-AGE GREATER 54)  AND
 12596            PB-I-SIG-SW = 'N'
 12597            MOVE ER-2651         TO  WS-ERROR
 12598            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12599
 12600 3135-NAME-EDIT.
 12601
 12602     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12603        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12604        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12605           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12606                                 TO PB-I-JOINT-FIRST-NAME
 12607        END-PERFORM
 12608     END-IF
 12609     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12610        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12611        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12612           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12613                                 TO PB-I-JOINT-LAST-NAME
 12614        END-PERFORM
 12615     END-IF
 12616     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12617        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 231
* EL050.cbl
 12618        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12619           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12620                                 TO PB-I-INSURED-FIRST-NAME
 12621        END-PERFORM
 12622     END-IF
 12623     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12624        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12625        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12626           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12627                                 TO PB-I-INSURED-LAST-NAME
 12628        END-PERFORM
 12629     END-IF
 12630     IF PB-I-INSURED-LAST-NAME = SPACES
 12631       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12632       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12633           MOVE ER-2660    TO WS-ERROR
 12634           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12635
 12636 3136-EDIT-SEX.
 12637
 12638******************************************************************
 12639*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12640******************************************************************
 12641
 12642     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12643        (WS-AH-SPECIAL-CALC-CD = 'O')
 12644        NEXT SENTENCE
 12645     ELSE
 12646        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12647           NEXT SENTENCE
 12648        ELSE
 12649           MOVE ER-2629            TO WS-ERROR
 12650           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12651
 12652 3137-EDIT-EFF-DATE.
 12653
 12654     IF PB-REISSUED-CERT       OR
 12655        PB-POLICY-IS-DECLINED  OR
 12656        PB-POLICY-IS-VOIDED
 12657         GO TO 3139-EDIT-COVERAGE-CODES.
 12658
 12659     MOVE SPACE                  TO WS-2671-SW
 12660                                    WS-2672-SW.
 12661
 12662     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12663         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12664             MOVE ER-2703        TO WS-ERROR
 12665             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12666             GO TO 3139-EDIT-COVERAGE-CODES.
 12667
 12668     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12669         GO TO 3139-EDIT-COVERAGE-CODES.
 12670
 12671     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12672     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12673*    MOVE '1'                    TO DC-OPTION-CODE.
 12674     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12675     MOVE +0                     TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 232
* EL050.cbl
 12676                                    DC-ELAPSED-DAYS.
 12677     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12678
 12679     IF DATE-CONVERSION-ERROR
 12680         GO TO 3139-EDIT-COVERAGE-CODES.
 12681
 12682     IF DC-ELAPSED-DAYS GREATER +180
 12683         MOVE ER-2672            TO WS-ERROR
 12684         MOVE 'Y'                TO WS-2672-SW
 12685         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12686     END-IF
 12687
 12688     IF WS-ERROR = ER-2671  AND
 12689        PB-COMPANY-ID  = 'LBL'
 12690        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12691        MOVE SPACE               TO WS-2671-SW
 12692        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12693
 12694     IF PB-ISSUE-DATE-FORCED  AND
 12695      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12696         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12697         MOVE ER-2673            TO WS-ERROR
 12698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12699         MOVE SPACE              TO WS-2671-SW
 12700                                    WS-2672-SW.
 12701
 12702     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12703         IF PB-ISSUE-DATE-FORCED
 12704             MOVE ER-2600          TO  WS-ERROR
 12705             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12706         ELSE
 12707             MOVE ER-2692          TO  WS-ERROR
 12708             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12709
 12710
 12711 3139-EDIT-COVERAGE-CODES.
 12712
 12713     if pb-company-id not = 'AHL'
 12714        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12715           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12716           MOVE ER-2787          TO WS-ERROR
 12717           PERFORM 9900-ERROR-FORMAT
 12718                                 THRU 9900-EXIT
 12719        END-IF
 12720     end-if
 12721     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12722        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12723                                 > 250000.00
 12724           MOVE ER-2719          TO WS-ERROR
 12725           PERFORM 9900-ERROR-FORMAT
 12726                                 THRU 9900-EXIT
 12727        END-IF
 12728     END-IF
 12729
 12730     IF PB-POLICY-IS-DECLINED  OR
 12731        PB-POLICY-IS-VOIDED
 12732         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12733
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 233
* EL050.cbl
 12734     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12735        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12736         MOVE ER-2630                TO WS-ERROR
 12737         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12738
 12739     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12740        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12741        PB-I-LF-PREMIUM-AMT = ZERO
 12742         GO TO 3140-CHECK-AH-FOR-ZERO.
 12743
 12744     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12745        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12746        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12747         GO TO 3140-CHECK-AH-FOR-ZERO.
 12748
 12749     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12750        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12751        MOVE ER-2631             TO WS-ERROR
 12752        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12753     END-IF
 12754
 12755
 12756******************************************************************
 12757*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12758******************************************************************
 12759
 12760     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12761        NEXT SENTENCE
 12762     ELSE
 12763        IF PB-I-LF-BENEFIT-AMT = ZERO
 12764           MOVE ER-2632             TO WS-ERROR
 12765           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12766
 12767
 12768******************************************************************
 12769*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12770******************************************************************
 12771
 12772     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12773        CONTINUE
 12774     ELSE
 12775        IF PB-I-LF-PREMIUM-AMT = ZERO
 12776           IF (NOT PB-COMP-LF-PREM)
 12777              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12778              MOVE ER-2633       TO WS-ERROR
 12779              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12780           END-IF
 12781        END-IF
 12782     END-IF
 12783     .
 12784 3140-CHECK-AH-FOR-ZERO.
 12785
 12786     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12787        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12788        PB-I-AH-PREMIUM-AMT = ZERO
 12789         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12790
 12791     IF PB-COMPANY-ID = 'CSL'  AND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 234
* EL050.cbl
 12792        PB-I-AH-BENEFIT-CD = ZERO  AND
 12793        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12794        PB-I-AH-PREMIUM-AMT = ZERO
 12795         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12796
 12797     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12798        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12799        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12800         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12801
 12802     IF PB-I-AH-BENEFIT-CD = ZERO
 12803         MOVE ER-2634            TO WS-ERROR
 12804         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12805
 12806******************************************************************
 12807*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12808******************************************************************
 12809
 12810     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12811        NEXT SENTENCE
 12812     ELSE
 12813        IF PB-I-AH-BENEFIT-AMT = ZERO
 12814           MOVE ER-2635             TO WS-ERROR
 12815           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12816
 12817******************************************************************
 12818*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12819******************************************************************
 12820
 12821     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12822        NEXT SENTENCE
 12823     ELSE
 12824        IF PB-I-AH-PREMIUM-AMT = ZERO
 12825            IF NOT PB-COMP-AH-PREM
 12826                MOVE ER-2636    TO WS-ERROR
 12827                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12828
 12829
 12830 3140-EDIT-MAX-AMT-SIZES.
 12831* CUSTOM CODE FOR CLIENT    'DMD'
 12832     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12833                                     WS-RES-MUNI-TAX
 12834                                     PB-I-STATE-TAX
 12835                                     PB-I-MUNI-TAX.
 12836
 12837     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12838
 12839     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12840        GO TO 3150-RATE-OUTSTAND-BAL.
 12841
 12842     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12843        GO TO 3150-RATE-OUTSTAND-BAL.
 12844
 12845     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12846        GO TO 3150-RATE-OUTSTAND-BAL.
 12847
 12848     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12849                             OR 'RIC')
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 235
* EL050.cbl
 12850        GO TO 3150-RATE-OUTSTAND-BAL.
 12851
 12852     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12853        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12854            GO TO 3150-RATE-OUTSTAND-BAL
 12855        ELSE
 12856           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12857               GO TO 3150-RATE-OUTSTAND-BAL.
 12858
 12859     IF NOT PB-NO-MONTHS-SKIPPED
 12860        GO TO 3150-RATE-OUTSTAND-BAL.
 12861
 12862     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12863        GO TO 3150-RATE-OUTSTAND-BAL.
 12864
 12865     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12866        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12867           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12868             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12869           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12870           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12871              MOVE ER-2693     TO WS-ERROR
 12872              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12873              GO TO 3150-RATE-OUTSTAND-BAL
 12874           ELSE
 12875              GO TO 3150-RATE-OUTSTAND-BAL.
 12876
 12877 3150-RATE-OUTSTAND-BAL.
 12878
 12879* DMD RATING TEST
 12880     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12881         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12882         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12883         MOVE ER-2687                 TO WS-ERROR
 12884         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12885         MOVE 'B'                     TO PB-I-OB-FLAG
 12886         GO TO 3260-EDIT-CONTINUE.
 12887
 12888     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12889         IF  WS-ERROR    EQUAL    ER-2693
 12890             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12891                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12892                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12893                 MOVE  +0            TO  WS-ERROR.
 12894
 12895     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12896         IF  WS-ERROR    EQUAL    ER-2693
 12897             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12898                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12899                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12900                 MOVE  +0            TO  WS-ERROR.
 12901
 12902     IF PLAN-MASTER-AH-SW = 'Y'
 12903        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12904            IF  WS-ERROR    EQUAL    ER-2693
 12905              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12906                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12907                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 236
* EL050.cbl
 12908                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12909                 MOVE  ER-1910           TO  WS-ERROR
 12910                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12911
 12912     IF PLAN-MASTER-AH-SW = 'Y'
 12913        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12914            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12915               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12916               MOVE  ER-1910           TO  WS-ERROR
 12917               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12918
 12919     IF PLAN-MASTER-AH-SW = 'Y'
 12920        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12921            IF  WS-ERROR    EQUAL    ER-2693
 12922                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12923                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12924                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12925                 MOVE  +0       TO  WS-ERROR.
 12926
 12927     IF WS-ERROR = ER-2693
 12928        IF PB-COMPANY-ID = 'JAL' AND
 12929           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12930           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12931           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12932
 12933     IF WS-ERROR = ER-2693
 12934        IF PB-COMPANY-ID = 'NCL'  AND
 12935           PB-I-AH-BENEFIT-CD = 'OA'
 12936           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12937           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12938
 12939     IF WS-ERROR = ER-2693
 12940        IF PB-COMPANY-ID = 'CNL' AND
 12941           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12942           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12943           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12944
 12945     IF WS-ERROR = ER-2693
 12946        IF PB-COMPANY-ID = 'HER'
 12947           IF WS-LEVEL
 12948              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12949              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12950
 12951     IF ((LF-BENEFIT-FOUND) AND
 12952         (NOT NO-LIFE-COVERAGE)  AND
 12953         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12954       OR   ((AH-BENEFIT-FOUND) AND
 12955             (NOT NO-AH-COVERAGE)    AND
 12956             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12957         NEXT SENTENCE
 12958     ELSE
 12959         GO TO 3215-EDIT-RATES.
 12960
 12961     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12962        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12963           MOVE ER-2674          TO WS-ERROR
 12964           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12965           GO TO 3215-EDIT-RATES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 237
* EL050.cbl
 12966
 12967     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12968        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12969           MOVE ER-2674          TO WS-ERROR
 12970           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12971           GO TO 3215-EDIT-RATES.
 12972
 12973     MOVE 'B'                    TO PB-I-OB-FLAG.
 12974
 12975     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12976         NEXT SENTENCE
 12977     ELSE
 12978         IF NOT NO-LIFE-COVERAGE
 12979             IF WS-ACCT-LF-OB-RT = ZERO
 12980                MOVE ER-2641    TO WS-ERROR
 12981                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12982
 12983     IF PB-COMPANY-ID = 'CRI'
 12984       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12985         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12986         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12987         IF WS-ERROR = ER-2675
 12988            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12989            MOVE ER-2687              TO WS-ERROR
 12990            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12991         ELSE
 12992            MOVE ER-2687              TO WS-ERROR
 12993            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12994
 12995
 12996     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12997         NEXT SENTENCE
 12998     ELSE
 12999       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13000            NEXT SENTENCE
 13001       ELSE
 13002         IF NOT NO-AH-COVERAGE
 13003             IF WS-ACCT-AH-OB-RT = ZERO
 13004                MOVE ER-2642    TO WS-ERROR
 13005                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13006
 13007     IF PB-COMPANY-ID = 'CRI'
 13008       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13009         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13010         IF WS-ERROR = ER-2676
 13011            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13012            MOVE ER-2687              TO WS-ERROR
 13013            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13014         ELSE
 13015            MOVE ER-2687              TO WS-ERROR
 13016            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13017
 13018     IF PB-COMPANY-ID NOT = 'GIC'
 13019         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13020            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13021     ELSE
 13022         IF PB-I-LF-PREM-CALC = ZEROS
 13023             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 238
* EL050.cbl
 13024                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13025
 13026     IF PB-COMPANY-ID NOT = 'GIC'
 13027         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13028            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13029     ELSE
 13030         IF PB-I-AH-PREM-CALC = ZEROS
 13031             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13032                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13033
 13034     MOVE ZEROS TO PB-I-MORT-CODE.
 13035
 13036     GO TO 3260-EDIT-CONTINUE.
 13037
 13038
 13039 3215-EDIT-RATES.
 13040     IF ACCOUNT-MAST-FOUND
 13041         NEXT SENTENCE
 13042     ELSE
 13043         GO TO 3999-END-EDIT.
 13044
 13045 3220-CHECK-LF-RATES.
 13046
 13047     IF PB-COMPANY-ID = 'DCC'
 13048        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13049        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13050        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13051           AND (NOT WS-LF-CASH))
 13052                           OR
 13053           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13054           AND (NOT WS-AH-CASH)))
 13055                       AND
 13056           (PB-I-ENTRY-STATUS NOT = '5')
 13057           MOVE 'M'              TO PB-BATCH-ENTRY
 13058                                    PB-I-ENTRY-STATUS
 13059        END-IF
 13060     END-IF
 13061     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13062                                    PB-I-AH-PREM-CALC
 13063                                    PB-I-LF-ALT-PREM-CALC
 13064                                    PB-I-LF-ALT-RATE
 13065                                    PB-I-LF-REI-RATE
 13066                                    PB-I-LF-ALT-REI-RATE
 13067                                    PB-I-AH-REI-RATE
 13068                                    PB-I-TOT-FEES-CALC.
 13069
 13070     IF PB-COMPANY-ID EQUAL 'DMD'
 13071        NEXT SENTENCE
 13072     ELSE
 13073        MOVE ZEROS               TO PB-I-LF-RATE
 13074                                    PB-I-AH-RATE.
 13075
 13076     IF PB-I-TOT-FEES NOT NUMERIC
 13077        MOVE ZEROS               TO PB-I-TOT-FEES
 13078     END-IF
 13079     IF PB-I-LIVES NOT NUMERIC
 13080         MOVE ZERO               TO PB-I-LIVES.
 13081
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 239
* EL050.cbl
 13082     IF PB-I-NUM-BILLED NOT NUMERIC
 13083         MOVE ZERO               TO PB-I-NUM-BILLED.
 13084
 13085     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13086        MOVE +0                  TO PB-I-LF-PREM-TAX
 13087     END-IF
 13088
 13089     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13090        MOVE +0                  TO PB-I-AH-PREM-TAX
 13091     END-IF
 13092
 13093     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13094        PB-I-PAY-FREQUENCY = ZEROS
 13095            MOVE 12 TO CP-PAY-FREQUENCY
 13096     ELSE
 13097            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13098
 13099     IF PB-I-STATE-TAX NOT NUMERIC
 13100         MOVE ZEROS               TO PB-I-STATE-TAX.
 13101
 13102     IF PB-I-MUNI-TAX NOT NUMERIC
 13103         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13104
 13105     MOVE SPACES                 TO CP-BEN-CATEGORY
 13106     IF PB-COMPANY-ID  = 'CSL'  AND
 13107        PB-I-LF-TERM NOT = ZERO
 13108        COMPUTE WS-PAYMENT-AMT =
 13109             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13110        COMPUTE WS-CSL-AMT1 =
 13111             PB-I-LF-TERM * AM-MAX-MON-BEN
 13112        COMPUTE WS-CSL-AMT2 =
 13113             WS-PAYMENT-AMT * PB-I-LF-TERM
 13114        IF CP-PAY-FREQUENCY NOT = 12
 13115           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13116           MOVE '8' TO WS-CSL-CALC-CD
 13117        ELSE
 13118           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13119              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13120               AM-MAX-TOT-BEN
 13121               MOVE '6' TO WS-CSL-CALC-CD
 13122           ELSE
 13123              IF (WS-CSL-AMT1  GREATER THAN
 13124                 AM-MAX-TOT-BEN) AND
 13125                 (WS-CSL-AMT2  GREATER THAN
 13126                 AM-MAX-TOT-BEN)
 13127                 MOVE '7' TO WS-CSL-CALC-CD
 13128              ELSE
 13129                 MOVE '5' TO WS-CSL-CALC-CD.
 13130
 13131     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13132         NEXT SENTENCE
 13133     ELSE
 13134         GO TO 3300-CHECK-AH-RATES.
 13135
 13136*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13137
 13138     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13139        IF (PB-I-LF-CRIT-PER    EQUAL +0)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 240
* EL050.cbl
 13140              OR
 13141           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13142           MOVE ER-2618          TO WS-ERROR
 13143           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13144           GO TO 3300-CHECK-AH-RATES.
 13145
 13146     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13147           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13148                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13149
 13150     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13151         MOVE ER-2687             TO WS-ERROR
 13152         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13153         MOVE 'Z000'              TO PB-I-MORT-CODE
 13154         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13155         GO TO 3300-CHECK-AH-RATES.
 13156
 13157     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13158        IF PB-I-LIVES = ZERO
 13159           MOVE ER-2688          TO WS-ERROR
 13160           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13161
 13162     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13163
 13164     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13165     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13166     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13167     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13168     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13169     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13170     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13171     MOVE '3'                    TO CP-PROCESS-TYPE.
 13172     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13173     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13174
 13175******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13176     IF PB-COMPANY-ID EQUAL 'CDL'
 13177         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13178            CP-EARN-AS-NET-PAY)
 13179             IF PB-CERT-EFF-DT GREATER  WS-931231
 13180                 MOVE '1'        TO CP-EARNING-METHOD.
 13181*******
 13182
 13183     MOVE PB-SV-STATE            TO CP-STATE.
 13184     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13185     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13186     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13187     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13188     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13189                                    CP-RATING-BENEFIT-AMT.
 13190     IF CP-STATE-STD-ABBRV = 'OR'
 13191         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13192                                         PB-I-LF-ALT-BENEFIT-AMT.
 13193     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13194     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13195     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13196     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13197     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 241
* EL050.cbl
 13198     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13199     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13200     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13201     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13202                                    CP-REMAINING-TERM
 13203                                    CP-LOAN-TERM.
 13204
 13205     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13206         NEXT SENTENCE
 13207     ELSE
 13208         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13209             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13210                                           PB-I-LF-PREMIUM-AMT.
 13211
 13212     IF PB-COMPANY-ID EQUAL 'CSL'
 13213        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13214           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13215                                         PB-I-LF-PREMIUM-AMT.
 13216
 13217     IF PB-COMPANY-ID EQUAL 'NCB'
 13218         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13219            CP-EARN-AS-NET-PAY
 13220             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13221                 PB-I-LF-PREMIUM-AMT.
 13222
 13223     IF (CP-TRUNCATED-LIFE)
 13224        or ((pb-company-id = 'AHL')
 13225           and (pb-i-loan-term > pb-i-lf-term))
 13226        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13227
 13228     IF PB-COMPANY-ID EQUAL 'CRI'
 13229        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13230
 13231     IF CP-TERM-IS-DAYS
 13232         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13233     ELSE
 13234         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13235     IF PB-COMPANY-ID = 'DCC'
 13236        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13237        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13238        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13239        IF WS-LF-BEN-CATEGORY = 'D'
 13240           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13241           MOVE PB-I-LIFE-COMMISSION
 13242                                 TO CP-DCC-ACT-COMM
 13243           MOVE WS-LF-BEN-CATEGORY
 13244                                 TO CP-BEN-CATEGORY
 13245        END-IF
 13246        IF (CP-BENEFIT-CD (1:1) = 'P')
 13247           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13248           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13249           add pb-i-ah-premium-amt to cp-original-premium
 13250        END-IF
 13251     END-IF
 13252     IF PB-COMPANY-ID = 'CSL'
 13253         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13254         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13255         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 242
* EL050.cbl
 13256
 13257     IF PB-COMPANY-ID = 'CSL'
 13258        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13259
 13260     IF (CP-SPECIAL-CALC-CD = 'H')
 13261        OR (PB-COMPANY-ID = 'DCC')
 13262         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13263                                    TO CP-ALTERNATE-BENEFIT
 13264         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13265
 13266     IF (PB-COMPANY-ID = 'CID')
 13267        AND (WS-LF-EARNINGS-CALC = 'B')
 13268        AND (CP-STATE-STD-ABBRV = 'MN')
 13269        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13270                                 TO CP-ALTERNATE-BENEFIT
 13271        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13272     END-IF
 13273     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13274     MOVE 'R'                   TO CP-RATE-FILE.
 13275     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13276
 13277     IF CP-ERROR-RATE-NOT-FOUND
 13278        MOVE ER-2641            TO WS-ERROR
 13279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13280        GO TO 3300-CHECK-AH-RATES.
 13281
 13282     IF PB-COMPANY-ID EQUAL 'CRI'
 13283        IF CP-ERROR-NO-LIMITS-CRI
 13284           IF NOT ACCOUNT-LIFE-CHECKED
 13285              MOVE ER-2607      TO WS-ERROR
 13286              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13287
 13288******************************************************************
 13289*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13290*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13291******************************************************************
 13292
 13293* CALC LIFE AGE AT EXPIRATION.
 13294
 13295     COMPUTE WS-AGE-AT-EXPIRE =
 13296          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13297
 13298*    IF PB-STATE = 'CO' OR 'UT'
 13299*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13300*        MOVE 'F'            TO PB-FATAL-FLAG
 13301*        MOVE ER-2709        TO WS-ERROR
 13302*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13303*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13304
 13305*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13306*        MOVE 'X'            TO PB-FATAL-FLAG
 13307*        MOVE ER-2718        TO WS-ERROR
 13308*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13309*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13310
 13311* CALC A & H AGE AT EXPIRATION.
 13312
 13313     COMPUTE WS-AGE-AT-EXPIRE =
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 243
* EL050.cbl
 13314          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13315
 13316*    IF PB-STATE = 'CO' OR 'UT'
 13317*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13318*        MOVE 'F'            TO PB-FATAL-FLAG
 13319*        MOVE ER-2709        TO WS-ERROR
 13320*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13321*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13322
 13323*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13324*        MOVE 'X'            TO PB-FATAL-FLAG
 13325*        MOVE ER-2718        TO WS-ERROR
 13326*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13327*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13328
 13329     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13330        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13331
 13332     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13333        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13334
 13335     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13336        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13337
 13338     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13339         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13340         MOVE ER-2639        TO WS-ERROR
 13341         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13342
 13343
 13344******************************************************************
 13345*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13346******************************************************************
 13347
 13348 PREMIUM-EDITING-IS-BYPASSED.
 13349     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13350        AND (CP-R-MAX-ATT-AGE > +0)
 13351        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13352        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13353           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13354           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13355           MOVE '1'              TO DC-OPTION-CODE
 13356           PERFORM 8500-DATE-CONVERT
 13357                                 THRU 8500-EXIT
 13358           IF NO-CONVERSION-ERROR
 13359              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13360                 MOVE ER-2661       TO WS-ERROR
 13361*                PERFORM 9900-ERROR-FORMAT
 13362*                                THRU 9900-EXIT
 13363              END-IF
 13364           END-IF
 13365        ELSE
 13366           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13367           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13368              MOVE ER-2661       TO WS-ERROR
 13369*             PERFORM 9900-ERROR-FORMAT
 13370*                                THRU 9900-EXIT
 13371           ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 244
* EL050.cbl
 13372              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13373                 MOVE ER-1570    TO WS-ERROR
 13374                 PERFORM 9900-ERROR-FORMAT
 13375                                 THRU 9900-EXIT
 13376              END-IF
 13377           END-IF
 13378        END-IF
 13379        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13380           MOVE PB-I-JOINT-BIRTHDAY
 13381                                 TO DC-BIN-DATE-1
 13382           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13383           MOVE '1'              TO DC-OPTION-CODE
 13384           PERFORM 8500-DATE-CONVERT
 13385                                 THRU 8500-EXIT
 13386           IF NO-CONVERSION-ERROR
 13387              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13388                 MOVE ER-2661       TO WS-ERROR
 13389*                PERFORM 9900-ERROR-FORMAT
 13390*                                THRU 9900-EXIT
 13391              END-IF
 13392           ELSE
 13393              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13394           END-IF
 13395        ELSE
 13396           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13397             (PB-I-LF-TERM / 12)
 13398           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13399              MOVE ER-2661       TO WS-ERROR
 13400*             PERFORM 9900-ERROR-FORMAT
 13401*                                THRU 9900-EXIT
 13402           ELSE
 13403              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13404                 MOVE ER-1571    TO WS-ERROR
 13405                 PERFORM 9900-ERROR-FORMAT
 13406                                 THRU 9900-EXIT
 13407              END-IF
 13408           END-IF
 13409        END-IF
 13410        IF WS-ERROR = ER-2661
 13411           PERFORM 9900-ERROR-FORMAT
 13412                                 THRU 9900-EXIT
 13413        END-IF
 13414     END-IF
 13415*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13416*       MOVE ER-2661             TO WS-ERROR
 13417*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13418
 13419     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13420        MOVE ER-2662             TO WS-ERROR
 13421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13422
 13423     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13424        MOVE ER-2677             TO WS-ERROR
 13425        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13426
 13427     IF CP-ERROR-LOAN-TERM
 13428        MOVE ER-2648             TO WS-ERROR
 13429        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 245
* EL050.cbl
 13430
 13431 3221-CHECK-ERROR-RATE-OPEN.
 13432
 13433     IF CP-ERROR-RATE-FILE-NOTOPEN
 13434         GO TO 3990-FILES-NOT-OPEN.
 13435
 13436     IF PB-COMPANY-ID NOT = 'DMD'
 13437        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13438     END-IF
 13439     .
 13440 3221-CONTINUE.
 13441     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13442                                    WS-DCC-AH-RATE
 13443     IF PB-COMPANY-ID = 'DCC'
 13444        IF WS-LF-BEN-CATEGORY = 'D'
 13445           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13446              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13447        END-IF
 13448     END-IF
 13449     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13450*   X'A4FF' = 12/31/2009
 13451     IF (PB-COMPANY-ID = 'CID')
 13452        AND (WS-LF-EARNINGS-CALC = 'B')
 13453        AND (CP-STATE-STD-ABBRV = 'MN')
 13454        AND (PB-CERT-EFF-DT > X'A4FF')
 13455        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13456     END-IF
 13457     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13458
 13459     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13460     IF (PB-COMPANY-ID = 'DCC')
 13461        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13462        AND (PB-I-POLICY-IS-MONTHLY)
 13463        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13464        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13465     END-IF
 13466     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13467     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13468     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13469     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13470     IF (PB-COMPANY-ID = 'DCC')
 13471        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13472        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13473        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13474        MOVE ER-2786             TO WS-ERROR
 13475        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13476     END-IF
 13477
 13478     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13479
 13480******************************************************************
 13481*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13482******************************************************************
 13483     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13484        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13485
 13486     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13487        GO TO 3225-CHECK-ALT-LIFE-RATE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 246
* EL050.cbl
 13488     ELSE
 13489       IF PB-I-LF-RATE = ZERO
 13490          MOVE ER-2641          TO WS-ERROR
 13491          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13492
 13493 3225-CHECK-ALT-LIFE-RATE.
 13494
 13495     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13496        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13497        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13498         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13499
 13500     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13501         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13502             AND PB-COMPANY-ID NOT = 'DCC')
 13503                   OR
 13504              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13505              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13506              AND PB-COMPANY-ID NOT = 'DCC')
 13507             MOVE ER-2720        TO  WS-ERROR
 13508             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13509             GO TO 3225-RATING-CONT
 13510         ELSE
 13511             GO TO 3225-RATING-CONT.
 13512     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13513        AND (AM-GPCD = 01 OR 06 OR 15)
 13514        MOVE ER-2798             TO WS-ERROR
 13515        PERFORM 9900-ERROR-FORMAT
 13516                                 THRU 9900-EXIT
 13517*       GO TO 3225-RATING-CONT
 13518     END-IF
 13519     IF (PB-COMPANY-ID = 'CID')
 13520        AND (WS-LF-EARNINGS-CALC = 'B')
 13521        AND (CP-STATE-STD-ABBRV = 'MN')
 13522        AND (PB-CERT-EFF-DT > X'A4FF')
 13523        GO TO 3225-RATING-CONT
 13524     END-IF
 13525     IF PB-COMPANY-ID = 'DCC'
 13526        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13527           AND (PB-I-POLICY-IS-MONTHLY)
 13528           GO TO 3225-RATING-CONT
 13529        END-IF
 13530     END-IF
 13531
 13532     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13533        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13534        CP-EARN-AS-REG-BALLOON
 13535        NEXT SENTENCE
 13536     ELSE
 13537        MOVE '2'                 TO CP-EARNING-METHOD.
 13538
 13539 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13540
 13541     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13542
 13543     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13544        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13545        (CP-SPECIAL-CALC-CD EQUAL 'H')
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 247
* EL050.cbl
 13546         NEXT SENTENCE
 13547     ELSE
 13548         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13549
 13550     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13551     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13552     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13553                                     CP-RATING-BENEFIT-AMT.
 13554     IF CP-STATE-STD-ABBRV = 'OR'
 13555         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13556                                         PB-I-LF-ALT-BENEFIT-AMT.
 13557     IF PB-COMPANY-ID = 'DCC'
 13558        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13559     END-IF
 13560     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13561     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13562     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13563                                    CP-REMAINING-TERM
 13564                                    CP-LOAN-TERM.
 13565     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13566        ADD +1                   TO CP-ORIGINAL-TERM
 13567                                    CP-REMAINING-TERM
 13568                                    CP-LOAN-TERM.
 13569
 13570     MOVE 'R'                   TO CP-RATE-FILE.
 13571     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13572
 13573     IF CP-ERROR-RATE-NOT-FOUND
 13574         MOVE ER-2641            TO WS-ERROR
 13575         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13576         GO TO 3300-CHECK-AH-RATES.
 13577
 13578     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13579     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13580
 13581     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13582         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13583
 13584     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13585                               + PB-I-LF-ALT-BENEFIT-AMT.
 13586
 13587     IF ACCOUNT-LIFE-CHECKED  OR
 13588        PB-POLICY-IS-VOIDED   OR
 13589        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13590        GO TO 3225-CONTINUE.
 13591
 13592     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13593        GO TO 3225-CONTINUE.
 13594
 13595     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13596                             EC-RT-LF-MAX-TOT-BEN
 13597        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13598        MOVE ER-2639       TO WS-ERROR
 13599        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13600
 13601 3225-CONTINUE.
 13602     IF PB-I-LF-ALT-RATE = ZERO
 13603         MOVE ER-2659            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 248
* EL050.cbl
 13604         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13605
 13606     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13607        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13608        MOVE ER-2698             TO WS-ERROR
 13609        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13610
 13611 3225-RATING-CONT.
 13612
 13613     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13614         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13615         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13616         IF (PB-COMPANY-ID = 'DCC')
 13617            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13618            CONTINUE
 13619         ELSE
 13620            MOVE ER-2687         TO WS-ERROR
 13621            PERFORM 9900-ERROR-FORMAT
 13622                                 THRU 9900-EXIT
 13623         END-IF
 13624         GO TO 3290-EDIT-LF-REIN-RATE
 13625     END-IF
 13626
 13627* DMD RATING TEST
 13628     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13629         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13630         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13631         MOVE ER-2687                 TO WS-ERROR
 13632         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13633         GO TO 3290-EDIT-LF-REIN-RATE.
 13634
 13635 3230-CLIENT-MORT-CD-SPECIALS.
 13636
 13637     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13638     SET BIN-TO-GREG          TO TRUE.
 13639*    MOVE ' '                 TO DC-OPTION-CODE.
 13640     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13641     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13642
 13643 C-POS-3230-MORT-CD.
 13644     IF PB-COMPANY-ID = 'POS' AND
 13645        PB-SV-CARRIER = '2'
 13646         NEXT SENTENCE
 13647     ELSE
 13648         GO TO C-POS-3240-MORT-CD.
 13649
 13650     IF PB-SV-GROUPING = '030'
 13651        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13652         MOVE '2350' TO PB-I-MORT-CODE
 13653      ELSE
 13654         MOVE '3300' TO PB-I-MORT-CODE.
 13655
 13656
 13657 C-POS-3240-MORT-CD.
 13658     IF PB-COMPANY-ID = 'POS' AND
 13659        PB-SV-CARRIER = '1'
 13660         NEXT SENTENCE
 13661     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 249
* EL050.cbl
 13662         GO TO 3230-CONTINUE.
 13663
 13664     IF PB-SV-STATE = '45' OR '47'
 13665        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13666         MOVE '5200' TO PB-I-MORT-CODE
 13667     ELSE
 13668         MOVE '8300' TO PB-I-MORT-CODE.
 13669
 13670 3230-CONTINUE.
 13671
 13672     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13673        GO TO 3240-CONTINUE
 13674     END-IF
 13675
 13676     IF PB-CERT-EFF-DT > WS-971231
 13677        GO TO 3240-CONTINUE
 13678     END-IF
 13679
 13680     IF LF-BENEFIT-FOUND AND
 13681        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13682         MOVE 'F250'       TO PB-I-MORT-CODE
 13683     ELSE
 13684         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13685             MOVE '7250'   TO PB-I-MORT-CODE
 13686         ELSE
 13687             MOVE '4251'   TO PB-I-MORT-CODE
 13688         END-IF
 13689     END-IF
 13690
 13691     .
 13692 3240-CONTINUE.
 13693
 13694     IF PB-COMPANY-ID NOT = 'GNL'
 13695         GO TO 3256-CONTINUE.
 13696
 13697     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13698         MOVE 'A300' TO PB-I-MORT-CODE
 13699     ELSE
 13700         MOVE '8350' TO PB-I-MORT-CODE.
 13701
 13702 3256-CONTINUE.
 13703     IF PB-COMPANY-ID NOT = 'ABL'
 13704         GO TO 3260-EDIT-CONTINUE.
 13705
 13706     IF PB-I-LF-TERM GREATER THAN 59
 13707         MOVE 'F550' TO PB-I-MORT-CODE
 13708     ELSE
 13709         MOVE 'E550' TO PB-I-MORT-CODE.
 13710
 13711 3260-EDIT-CONTINUE.
 13712     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13713
 13714 3290-EDIT-LF-REIN-RATE.
 13715     IF LF-REIN-NSP-NOT-USED
 13716         GO TO 3290-RATING-CONT.
 13717
 13718     IF PB-COMPANY-ID = 'DCC'
 13719        GO TO 3290-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 250
* EL050.cbl
 13720     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13721     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13722     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13723     MOVE '3'                   TO CP-PROCESS-TYPE.
 13724     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13725
 13726******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13727     IF PB-COMPANY-ID EQUAL 'CDL'
 13728         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13729            CP-EARN-AS-NET-PAY)
 13730             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13731*            MOVE SPACE          TO DC-OPTION-CODE
 13732             SET BIN-TO-GREG     TO TRUE
 13733             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13734***  Y2K PROJ 7744
 13735             IF DC-GREG-DATE-CYMD GREATER 19931231
 13736                 MOVE '1'        TO CP-EARNING-METHOD.
 13737***  Y2K PROJ 7744
 13738*******
 13739
 13740     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13741     MOVE PB-SV-STATE           TO CP-STATE.
 13742     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13743     MOVE ZERO                  TO CP-DEVIATION-CODE
 13744                                   CP-RATE-DEV-PCT.
 13745     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13746     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13747                                   CP-RATING-BENEFIT-AMT.
 13748
 13749************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13750     IF PB-COMPANY-ID EQUAL 'NCB'
 13751         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13752            CP-EARN-AS-NET-PAY
 13753             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13754                 PB-I-LF-PREMIUM-AMT.
 13755************
 13756
 13757     IF CP-STATE-STD-ABBRV = 'OR'
 13758         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13759                                         PB-I-LF-ALT-BENEFIT-AMT.
 13760     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13761     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13762     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13763     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13764     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13765     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13766     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13767     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13768                                   CP-REMAINING-TERM
 13769                                   CP-LOAN-TERM.
 13770     IF CP-TRUNCATED-LIFE
 13771        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13772
 13773     IF CP-TERM-IS-DAYS
 13774         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13775     ELSE
 13776         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13777
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 251
* EL050.cbl
 13778     IF PB-COMPANY-ID = 'DCC'
 13779        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13780     END-IF
 13781     IF PB-COMPANY-ID NOT = 'TIC'
 13782          MOVE ZERO          TO CP-CLASS-CODE.
 13783
 13784     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13785
 13786     MOVE 'R'                   TO CP-RATE-FILE.
 13787     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13788
 13789     IF CP-ERROR-RATE-NOT-FOUND
 13790        IF PB-I-OB
 13791           MOVE ER-2625      TO WS-ERROR
 13792           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13793           GO TO 3299-EDIT-CONTINUE
 13794        ELSE
 13795           MOVE ER-2643      TO WS-ERROR
 13796           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13797           GO TO 3299-EDIT-CONTINUE.
 13798
 13799     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13800
 13801     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13802     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13803
 13804     IF PB-I-LF-REI-RATE = ZERO
 13805         MOVE ER-2643        TO WS-ERROR
 13806         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13807
 13808 3290-CHECK-ALT-REIN-RATE.
 13809
 13810     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13811        GO TO 3290-RATING-CONT.
 13812
 13813     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13814     MOVE '2'                    TO CP-EARNING-METHOD.
 13815     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13816     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13817     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13818     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13819                                     CP-RATING-BENEFIT-AMT.
 13820     IF CP-STATE-STD-ABBRV = 'OR'
 13821         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13822                                         PB-I-LF-ALT-BENEFIT-AMT.
 13823     IF PB-COMPANY-ID = 'DCC'
 13824        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13825     END-IF
 13826     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13827     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13828     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13829                                    CP-REMAINING-TERM
 13830                                    CP-LOAN-TERM.
 13831     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13832        ADD +1                   TO CP-ORIGINAL-TERM
 13833                                    CP-REMAINING-TERM
 13834                                    CP-LOAN-TERM.
 13835
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 252
* EL050.cbl
 13836     MOVE 'R'                   TO CP-RATE-FILE.
 13837     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13838
 13839     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13840
 13841     IF PB-I-LF-ALT-REI-RATE = ZERO
 13842         MOVE ER-2643            TO WS-ERROR
 13843         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13844
 13845 3290-RATING-CONT.
 13846
 13847     IF PB-I-OB
 13848*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13849        GO TO 3300-CHECK-AH-RATES.
 13850
 13851 3299-EDIT-CONTINUE.
 13852
 13853     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13854         NEXT SENTENCE
 13855     ELSE
 13856         MOVE ER-2620           TO WS-ERROR
 13857         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13858
 13859 3300-CHECK-AH-RATES.
 13860     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13861         NEXT SENTENCE
 13862     ELSE
 13863         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13864
 13865     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13866        ((CF-COMPANY-ID = 'DMD') AND
 13867                (NO-DMD-RATING))
 13868         IF (PB-COMPANY-ID = 'DCC')
 13869            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13870            CONTINUE
 13871         ELSE
 13872            MOVE ER-2687         TO WS-ERROR
 13873            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13874         END-IF
 13875         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13876         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13877     END-IF
 13878
 13879     IF PB-I-OB
 13880        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13881
 13882     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13883         MOVE ER-2687             TO WS-ERROR
 13884         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13885         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13886         GO TO 3999-END-EDIT.
 13887
 13888*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13889
 13890     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13891        IF PB-I-AH-CRIT-PER = ZERO
 13892           IF PB-COMPANY-ID = 'DCC'
 13893              AND AM-DCC-PRODUCT-CODE = 'DDF'
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 253
* EL050.cbl
 13894              CONTINUE
 13895           ELSE
 13896              MOVE ER-2618       TO WS-ERROR
 13897              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13898              GO TO 3999-END-EDIT
 13899           END-IF
 13900        END-IF
 13901     END-IF
 13902     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13903     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13904     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13905     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13906     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13907     MOVE PB-SV-STATE            TO CP-STATE.
 13908     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13909     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13910     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13911*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13912     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13913     MOVE '3'                    TO CP-PROCESS-TYPE.
 13914     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13915     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13916                                    CP-RATING-BENEFIT-AMT.
 13917     IF PB-COMPANY-ID = 'CID'
 13918               OR
 13919        CP-STATE-STD-ABBRV = 'OR'
 13920         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13921                                         PB-I-AH-TERM.
 13922     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13923        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13924           AND (PB-I-POLICY-IS-MONTHLY)
 13925           MOVE PB-I-LF-BENEFIT-AMT
 13926                                 TO CP-NET-BENEFIT-AMT
 13927           move pb-i-ah-premium-amt to cp-original-premium
 13928           add pb-i-lf-premium-amt to cp-original-premium
 13929        END-IF
 13930     END-IF
 13931     MOVE SPACES                 TO CP-BEN-CATEGORY
 13932     IF PB-COMPANY-ID = 'DCC'
 13933        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13934        EVALUATE TRUE
 13935           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13936              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13937              MOVE PB-I-LF-BENEFIT-AMT
 13938                                 TO CP-RATING-BENEFIT-AMT
 13939              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13940           WHEN WS-AH-BEN-CATEGORY = 'G'
 13941              MOVE PB-I-UNPAID-CASH-PRICE
 13942                                 TO CP-RATING-BENEFIT-AMT
 13943           WHEN WS-AH-BEN-CATEGORY = 'D'
 13944              MOVE WS-AH-PMF-COMM
 13945                                 TO CP-DCC-PMF-COMM
 13946              MOVE PB-I-AH-COMMISSION
 13947                                 TO CP-DCC-ACT-COMM
 13948        END-EVALUATE
 13949     END-IF
 13950     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13951     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 254
* EL050.cbl
 13952     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13953     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13954     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13955     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13956     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13957                                    CP-REMAINING-TERM
 13958                                    WS-WORK-TERM.
 13959     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13960
 13961     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13962     SET BIN-TO-GREG             TO TRUE.
 13963*    MOVE ' '                    TO DC-OPTION-CODE.
 13964     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13965     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13966
 13967     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13968     IF NOT VALID-SKIP-CODE
 13969         MOVE ER-2683            TO WS-ERROR
 13970         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13971         GO TO 3320-RATE-CONTINUE.
 13972
 13973     IF PB-NO-MONTHS-SKIPPED
 13974         GO TO 3320-RATE-CONTINUE.
 13975
 13976     MOVE SPACE TO NUMBER-OF-MONTHS.
 13977
 13978     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13979         MOVE 'S'                TO SK-MO (6).
 13980     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13981         MOVE 'S'                TO SK-MO (7).
 13982     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13983         MOVE 'S'                TO SK-MO (8).
 13984     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13985         MOVE 'S'                TO SK-MO (9).
 13986     IF PB-I-SKIP-CODE = 'A'
 13987         MOVE 'S'                TO SK-MO (10).
 13988
 13989     MOVE 1                      TO SUB2.
 13990     MOVE PB-I-AH-TERM           TO SUB3.
 13991     MOVE WS-MONTH               TO SUB1.
 13992     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13993     GO TO 3320-RATE-CONTINUE.
 13994
 13995 3310-GET-SKIP-MO.
 13996     IF SUB1 = 13
 13997         MOVE 1                  TO SUB1.
 13998
 13999     IF SK-MO (SUB1) = 'S'
 14000         SUBTRACT 1 FROM WS-WORK-TERM.
 14001
 14002     ADD 1 TO SUB2
 14003              SUB1.
 14004
 14005 3320-RATE-CONTINUE.
 14006
 14007     IF WS-WORK-TERM = ZERO
 14008         MOVE 1                  TO WS-WORK-TERM.
 14009
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 255
* EL050.cbl
 14010     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14011                                    CP-LOAN-TERM.
 14012
 14013     IF PB-COMPANY-ID EQUAL 'DMD'
 14014         NEXT SENTENCE
 14015     ELSE
 14016         MOVE ZERO               TO PB-I-AH-RATE
 14017                                    PB-I-AH-REI-RATE.
 14018
 14019
 14020     IF PB-COMPANY-ID EQUAL 'CRI'
 14021        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14022
 14023     IF PB-COMPANY-ID = 'CSL'
 14024         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14025         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14026         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14027         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14028
 14029     IF PB-COMPANY-ID = 'DCC'
 14030        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14031           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14032              PB-I-RATE-DEV-PCT-LF
 14033        END-IF
 14034        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14035                                 TO CP-ALTERNATE-BENEFIT
 14036        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14037        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14038        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14039     END-IF
 14040     IF (PB-COMPANY-ID = 'CID')
 14041        AND (WS-LF-EARNINGS-CALC = 'B')
 14042        AND (CP-STATE-STD-ABBRV = 'MN')
 14043        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14044     ELSE
 14045        MOVE ' '                 TO CP-AH-BALLOON-SW
 14046     END-IF
 14047     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14048     MOVE 'R'                   TO CP-RATE-FILE.
 14049     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14050
 14051     IF CP-ERROR-RATE-NOT-FOUND
 14052        IF PB-I-OB
 14053           MOVE ER-2624          TO WS-ERROR
 14054           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14055           GO TO 3340-CALCULATE-PREMIUM-AMT
 14056        ELSE
 14057          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14058              NEXT SENTENCE
 14059          ELSE
 14060           MOVE ER-2642          TO WS-ERROR
 14061           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14062           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14063
 14064     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14065        CP-ERROR-DIV-BY-ZERO
 14066           MOVE ER-3782          TO WS-ERROR
 14067           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 256
* EL050.cbl
 14068
 14069     IF PB-COMPANY-ID EQUAL 'CRI'
 14070        IF CP-ERROR-NO-LIMITS-CRI
 14071           IF NOT ACCOUNT-AH-CHECKED
 14072              MOVE ER-2607          TO WS-ERROR
 14073              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14074
 14075     IF ACCOUNT-AH-CHECKED
 14076        NEXT SENTENCE
 14077     ELSE
 14078       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14079          MOVE ER-2640           TO WS-ERROR
 14080          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14081
 14082     IF PB-COMPANY-ID = 'CRI'
 14083         IF WS-ERROR = ER-2640
 14084             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14085     IF ACCOUNT-AH-CHECKED
 14086        CONTINUE
 14087     ELSE
 14088        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14089           AND (CP-R-MAX-ATT-AGE > +0)
 14090           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14091           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14092              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14093              MOVE PB-I-AH-EXPIRE-DT
 14094                                 TO DC-BIN-DATE-2
 14095              MOVE '1'           TO DC-OPTION-CODE
 14096              PERFORM 8500-DATE-CONVERT
 14097                                 THRU 8500-EXIT
 14098              IF NO-CONVERSION-ERROR
 14099                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14100                    MOVE ER-2661       TO WS-ERROR
 14101*                   PERFORM 9900-ERROR-FORMAT
 14102*                                THRU 9900-EXIT
 14103                 END-IF
 14104              END-IF
 14105           ELSE
 14106              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14107              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14108                 MOVE ER-2661    TO WS-ERROR
 14109*                PERFORM 9900-ERROR-FORMAT
 14110*                                THRU 9900-EXIT
 14111              ELSE
 14112                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14113                    MOVE ER-1570 TO WS-ERROR
 14114                    PERFORM 9900-ERROR-FORMAT
 14115                                 THRU 9900-EXIT
 14116                 END-IF
 14117              END-IF
 14118           END-IF
 14119           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14120              MOVE PB-I-JOINT-BIRTHDAY
 14121                                    TO DC-BIN-DATE-1
 14122              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14123              MOVE '1'              TO DC-OPTION-CODE
 14124              PERFORM 8500-DATE-CONVERT
 14125                                    THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 257
* EL050.cbl
 14126              IF NO-CONVERSION-ERROR
 14127                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14128                    MOVE ER-2661       TO WS-ERROR
 14129*                   PERFORM 9900-ERROR-FORMAT
 14130*                                   THRU 9900-EXIT
 14131                 END-IF
 14132              END-IF
 14133           ELSE
 14134              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14135                (PB-I-AH-TERM / 12)
 14136              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14137                 MOVE ER-2661       TO WS-ERROR
 14138*                PERFORM 9900-ERROR-FORMAT
 14139*                                   THRU 9900-EXIT
 14140              ELSE
 14141                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14142                    MOVE ER-1571 TO WS-ERROR
 14143                    PERFORM 9900-ERROR-FORMAT
 14144                                 THRU 9900-EXIT
 14145                 END-IF
 14146              END-IF
 14147           END-IF
 14148           IF WS-ERROR = ER-2661
 14149              PERFORM 9900-ERROR-FORMAT
 14150                                    THRU 9900-EXIT
 14151           END-IF
 14152        END-IF
 14153     END-IF
 14154*    IF ACCOUNT-AH-CHECKED
 14155*       NEXT SENTENCE
 14156*    ELSE
 14157*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14158*          MOVE ER-2661          TO WS-ERROR
 14159*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14160
 14161     IF ACCOUNT-AH-CHECKED
 14162        NEXT SENTENCE
 14163     ELSE
 14164        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14165           MOVE ER-2663          TO WS-ERROR
 14166           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14167
 14168     IF ACCOUNT-AH-CHECKED OR
 14169        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14170         PB-POLICY-IS-VOIDED
 14171        NEXT SENTENCE
 14172     ELSE
 14173        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14174           MOVE ER-2667            TO WS-ERROR
 14175           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14176
 14177     IF PB-COMPANY-ID = 'CRI'
 14178         IF WS-ERROR = ER-2667
 14179             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14180
 14181     IF ACCOUNT-AH-CHECKED
 14182        NEXT SENTENCE
 14183     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 258
* EL050.cbl
 14184        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14185           MOVE ER-2678            TO WS-ERROR
 14186           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14187
 14188     IF CP-ERROR-RATE-FILE-NOTOPEN
 14189         GO TO 3990-FILES-NOT-OPEN.
 14190
 14191 3321-CONTINUE.
 14192     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14193     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14194     IF (PB-COMPANY-ID = 'DCC')
 14195        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14196        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14197                                    PB-I-LF-ALT-PREM-CALC
 14198        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14199        IF WS-AH-BEN-CATEGORY = 'G'
 14200           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14201           + PB-I-ADDL-CLP)
 14202           * (1 + WS-TOL-CLP-PCT)
 14203*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14204        ELSE
 14205           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14206           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14207*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14208        END-IF
 14209        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14210                                 TO PB-I-AH-PREM-CALC
 14211        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14212           MOVE ER-8152          TO WS-ERROR
 14213           PERFORM 9900-ERROR-FORMAT
 14214                                 THRU 9900-EXIT
 14215        ELSE
 14216           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14217                 PB-I-ADDL-CLP)
 14218              MOVE ER-8148       TO WS-ERROR
 14219              PERFORM 9900-ERROR-FORMAT
 14220                                 THRU 9900-EXIT
 14221           END-IF
 14222        END-IF
 14223     END-IF
 14224     IF (PB-COMPANY-ID = 'DCC')
 14225        AND (PB-I-POLICY-IS-MONTHLY)
 14226        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14227        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14228        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14229           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14230        END-IF
 14231     END-IF
 14232     IF (PB-COMPANY-ID = 'DCC')
 14233        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14234        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14235        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14236        MOVE ER-2786             TO WS-ERROR
 14237        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14238     END-IF
 14239     MOVE +0                     TO PB-I-AH-CLP
 14240     IF PB-COMPANY-ID = 'DCC'
 14241        IF WS-AH-BEN-CATEGORY = 'D'
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 259
* EL050.cbl
 14242           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14243              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14244        ELSE
 14245           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14246              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14247           END-IF
 14248        END-IF
 14249     END-IF
 14250     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14251
 14252     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14253         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14254
 14255     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14256         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14257
 14258     IF PB-COMPANY-ID = 'CRI'
 14259         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14260            PB-I-PAYMENT-AMOUNT = ZERO
 14261             NEXT SENTENCE
 14262         ELSE
 14263             COMPUTE PB-I-AH-PREM-CALC =
 14264                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14265                 (CP-PREMIUM-RATE / 100)
 14266             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14267                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14268                                             PB-I-RATE-DEV-PCT-AH.
 14269
 14270     IF PB-I-AH-RATE  = ZERO
 14271       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14272           NEXT SENTENCE
 14273       ELSE
 14274         MOVE ER-2642            TO WS-ERROR
 14275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14276
 14277     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14278     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14279     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14280     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14281     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14282     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14283
 14284     IF (PB-COMPANY-ID = 'DCC')
 14285        AND (WS-AH-BEN-CATEGORY = 'G')
 14286        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14287        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14288        IF CP-DEVIATION-CODE NOT = '000'
 14289           MOVE '000'            TO CP-DEVIATION-CODE
 14290           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14291           IF NO-CP-ERROR
 14292              COMPUTE PB-I-DDF-IU-RATE-UP =
 14293              PB-I-AH-CLP - CP-CALC-PREMIUM
 14294           ELSE
 14295              MOVE ER-3057        TO WS-ERROR
 14296              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14297           END-IF
 14298        END-IF
 14299     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 260
* EL050.cbl
 14300     .
 14301 3335-EDIT-AH-REIN-NSP-RATE.
 14302     IF AH-REIN-NSP-NOT-USED
 14303         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14304
 14305     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14306     IF PB-COMPANY-ID = 'DCC'
 14307         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14308     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14309     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14310     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14311     MOVE PB-SV-STATE            TO CP-STATE.
 14312     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14313     MOVE ZERO                   TO CP-DEVIATION-CODE
 14314                                    CP-RATE-DEV-PCT.
 14315*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14316     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14317     MOVE '3'                    TO CP-PROCESS-TYPE.
 14318     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14319     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14320                                    CP-RATING-BENEFIT-AMT.
 14321     IF CP-STATE-STD-ABBRV = 'OR'
 14322         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14323                                         PB-I-AH-TERM.
 14324     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14325     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14326     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14327     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14328     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14329     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14330                                    CP-REMAINING-TERM
 14331                                    WS-WORK-TERM.
 14332     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14333     IF PB-COMPANY-ID = 'DCC'
 14334        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14335     END-IF
 14336     IF  PB-COMPANY-ID = 'TIC'
 14337         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14338            MOVE ZERO TO CP-CLASS-CODE.
 14339
 14340     IF PB-COMPANY-ID NOT = 'TIC'
 14341          MOVE ZERO          TO CP-CLASS-CODE.
 14342
 14343     MOVE ZERO               TO CP-DEVIATION-CODE.
 14344
 14345     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14346
 14347     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14348
 14349     MOVE 'R'                   TO CP-RATE-FILE.
 14350     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14351
 14352     IF CP-ERROR-RATE-NOT-FOUND
 14353         MOVE ER-2645        TO WS-ERROR
 14354         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14355         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14356
 14357     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 261
* EL050.cbl
 14358
 14359     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14360     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14361
 14362     IF PB-I-AH-REI-RATE = ZERO
 14363         MOVE ER-2645        TO WS-ERROR
 14364         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14365
 14366
 14367 3340-CALCULATE-PREMIUM-AMT.
 14368
 14369     IF PB-COMPANY-ID = 'NCL'
 14370         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14371             WS-AH-SPECIAL-CALC-CD = 'O')
 14372             GO TO 3999-END-EDIT.
 14373
 14374     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14375                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14376                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14377                         OR 'AHL'
 14378         NEXT SENTENCE
 14379     ELSE
 14380         IF WS-STATE-ABBREVIATION = 'CT'
 14381             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14382                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14383                 COMPUTE PB-I-LF-PREM-CALC =
 14384                                     PB-I-LF-PREM-CALC * .90
 14385                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14386                                     PB-I-LF-ALT-PREM-CALC * .90
 14387                 COMPUTE PB-I-AH-PREM-CALC =
 14388                                     PB-I-AH-PREM-CALC * .90.
 14389
 14390     IF PB-COMP-LF-PREM
 14391        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14392        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14393
 14394     IF PB-COMP-AH-PREM
 14395        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14396
 14397 3340-CHECK-DCC-TOT-FEES.
 14398     IF (PB-COMPANY-ID = 'DCC')
 14399        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14400        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14401        AND (PB-I-POLICY-IS-MONTHLY)
 14402        CONTINUE
 14403     ELSE
 14404        GO TO 3340-EDIT-LF-AH-TOL
 14405     END-IF
 14406     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14407     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14408     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14409        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14410           PB-I-RATE-DEV-PCT-LF
 14411     END-IF
 14412     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14413        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14414           PB-I-RATE-DEV-PCT-AH
 14415     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 262
* EL050.cbl
 14416     MOVE 'N'                    TO CP-BEN-CATEGORY
 14417     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14418
 14419     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14420     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14421     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14422     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14423     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14424     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14425     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14426     MOVE '3'                    TO CP-PROCESS-TYPE.
 14427     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14428     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14429
 14430     MOVE PB-SV-STATE            TO CP-STATE.
 14431     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14432     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14433     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14434     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14435     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14436                                    CP-RATING-BENEFIT-AMT.
 14437     IF CP-STATE-STD-ABBRV = 'OR'
 14438         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14439                                         PB-I-LF-ALT-BENEFIT-AMT.
 14440     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14441     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14442     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14443     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14444     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14445     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14446     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14447     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14448     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14449                                    CP-REMAINING-TERM
 14450                                    CP-LOAN-TERM.
 14451     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14452         NEXT SENTENCE
 14453     ELSE
 14454         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14455             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14456                                           PB-I-LF-PREMIUM-AMT.
 14457
 14458     IF CP-TRUNCATED-LIFE
 14459        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14460
 14461     IF CP-TERM-IS-DAYS
 14462         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14463     ELSE
 14464         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14465
 14466     IF PB-COMPANY-ID = 'DCC'
 14467        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14468     END-IF
 14469     IF CP-SPECIAL-CALC-CD = 'H'
 14470         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14471                                    TO CP-ALTERNATE-BENEFIT
 14472         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14473     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 263
* EL050.cbl
 14474     MOVE 'R'                    TO CP-RATE-FILE
 14475     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14476     IF NOT CP-ERROR-RATE-NOT-FOUND
 14477        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14478        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14479           AND (CP-BENEFIT-CD (1:1) = 'S')
 14480           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14481                                    PB-I-LF-PREMIUM-AMT
 14482        END-IF
 14483     ELSE
 14484        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14485     END-IF
 14486     .
 14487 3340-EDIT-LF-AH-TOL.
 14488
 14489***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14490***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14491***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14492***
 14493     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14494         PB-I-AH-PREMIUM-AMT
 14495          GIVING WS-CALC-WORK.
 14496
 14497     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14498        AND WS-CALC-WORK NOT = ZERO
 14499         MOVE ER-2649            TO WS-ERROR
 14500         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14501
 14502     SUBTRACT PB-I-LF-PREM-CALC
 14503             FROM PB-I-LF-PREMIUM-AMT
 14504                 GIVING WS-UNSIGN-WRK1.
 14505
 14506     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14507             FROM PB-I-LF-ALT-PREMIUM-AMT
 14508                 GIVING WS-UNSIGN-WRK4.
 14509
 14510     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14511                                + WS-UNSIGN-WRK4.
 14512
 14513     SUBTRACT PB-I-AH-PREM-CALC
 14514             FROM PB-I-AH-PREMIUM-AMT
 14515                 GIVING WS-UNSIGN-WRK2.
 14516
 14517******************************************************************
 14518*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14519******************************************************************
 14520
 14521     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14522         MOVE ZERO TO WS-UNSIGN-WRK1.
 14523
 14524     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14525         MOVE ZERO TO WS-UNSIGN-WRK2.
 14526
 14527     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14528             GIVING WS-UNSIGN-WRK3.
 14529
 14530 3342-CONTINUE.
 14531
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 264
* EL050.cbl
 14532     IF (PB-I-LF-RATE = ZERO  AND
 14533         PB-I-AH-RATE = ZERO)
 14534         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14535            WS-AH-SPECIAL-CALC-CD = 'O'
 14536              NEXT SENTENCE
 14537         ELSE
 14538             GO TO 3345-EDIT-CONTINUE.
 14539
 14540     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14541         NEXT SENTENCE
 14542     ELSE
 14543     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14544        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14545           IF (PB-REISSUED-CERT         OR
 14546               PB-POLICY-IS-DECLINED    OR
 14547               PB-POLICY-IS-VOIDED)
 14548              NEXT SENTENCE
 14549           ELSE
 14550              IF WS-PREM-REJECT-SW = SPACE
 14551                 MOVE ER-2652    TO WS-ERROR
 14552                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14553                 GO TO 3344-CHECK-AH
 14554              ELSE
 14555                 MOVE ER-2650    TO WS-ERROR
 14556                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14557                 GO TO 3344-CHECK-AH.
 14558
 14559***
 14560***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14561***
 14562
 14563     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14564         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14565            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14566             (1 + WS-TOL-LF-PREM-PCT)
 14567         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14568            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14569             (1 - WS-TOL-LF-PREM-PCT)
 14570     ELSE
 14571         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14572         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14573
 14574***
 14575***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14576***
 14577
 14578     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14579         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14580          WS-TOL-LF-PREM.
 14581
 14582     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14583         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14584          WS-TOL-LF-PREM.
 14585
 14586     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14587        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14588
 14589     IF PB-REISSUED-CERT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 265
* EL050.cbl
 14590        or PB-POLICY-IS-DECLINED
 14591        or PB-POLICY-IS-VOIDED
 14592        continue
 14593     ELSE
 14594        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14595              > WS-TOL-LF-HIGH-PREM-AMT)
 14596           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14597              < WS-TOL-LF-LOW-PREM-AMT))
 14598                      or
 14599           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14600              > WS-TOL-LF-HIGH-PREM-PCT)
 14601           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14602              < WS-TOL-LF-LOW-PREM-PCT))
 14603           IF WS-PREM-REJECT-SW = SPACE
 14604              MOVE ER-2652       TO WS-ERROR
 14605              PERFORM 9900-ERROR-FORMAT
 14606                                 THRU 9900-EXIT
 14607           ELSE
 14608              MOVE ER-2650       TO WS-ERROR
 14609              PERFORM 9900-ERROR-FORMAT
 14610                                 THRU 9900-EXIT
 14611           end-if
 14612        end-if
 14613     end-if
 14614
 14615*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14616*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14617*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14618*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14619
 14620     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14621        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14622                      OR
 14623           ((PB-COMPANY-ID = 'DCC')
 14624           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14625           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14626           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14627        END-IF
 14628     END-IF
 14629
 14630     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14631        IF WS-COMP-MAX-CAP GREATER THAN +0
 14632           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14633              IF (PB-REISSUED-CERT         OR
 14634                  PB-POLICY-IS-DECLINED    OR
 14635                  PB-POLICY-IS-VOIDED)
 14636                 NEXT SENTENCE
 14637              ELSE
 14638                  MOVE ER-2646   TO  WS-ERROR
 14639                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14640
 14641 3344-CVL-TOLERANCE-CHECK.
 14642
 14643      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14644          GO TO 3344-CHECK-AH.
 14645
 14646      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14647          GO TO 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 266
* EL050.cbl
 14648
 14649      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14650                                     WS-UNSIGN-WRK6.
 14651
 14652      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14653          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14654                                 + PB-I-LF-PREMIUM-AMT
 14655                                 - PB-I-LF-PREM-CALC.
 14656
 14657      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14658          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14659                                 + PB-I-LF-ALT-PREMIUM-AMT
 14660                                 - PB-I-LF-ALT-PREM-CALC.
 14661
 14662      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14663          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14664              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14665                 MOVE ER-2652    TO  WS-ERROR
 14666                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14667              ELSE
 14668                 MOVE ER-2650    TO  WS-ERROR
 14669                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14670
 14671      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14672          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14673              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14674                 MOVE ER-2652    TO  WS-ERROR
 14675                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14676              ELSE
 14677                 MOVE ER-2650    TO  WS-ERROR
 14678                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14679
 14680 3344-CHECK-AH.
 14681
 14682****************************************************************
 14683***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14684***
 14685
 14686     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14687         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14688             (1 + WS-TOL-AH-PREM-PCT)
 14689         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14690             (1 - WS-TOL-AH-PREM-PCT)
 14691     ELSE
 14692         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14693         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14694
 14695***
 14696***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14697***
 14698
 14699     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14700         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14701
 14702     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14703         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14704
 14705     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 267
* EL050.cbl
 14706        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14707
 14708     IF (PB-REISSUED-CERT)
 14709        OR (PB-POLICY-IS-DECLINED)
 14710        OR (PB-POLICY-IS-VOIDED)
 14711        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14712        CONTINUE
 14713     ELSE
 14714        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14715              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14716                          or
 14717           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14718              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14719           IF WS-PREM-REJECT-SW = SPACE
 14720              MOVE ER-3052       TO WS-ERROR
 14721              PERFORM 9900-ERROR-FORMAT
 14722                                 THRU 9900-EXIT
 14723           ELSE
 14724              MOVE ER-3050       TO WS-ERROR
 14725              PERFORM 9900-ERROR-FORMAT
 14726                                 THRU 9900-EXIT
 14727           END-IF
 14728        END-IF
 14729     END-IF
 14730     if (pb-company-id = 'DCC')
 14731        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14732        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14733        and (pb-i-policy-is-monthly)
 14734        compute ws-tol-ah-high-prem-amt =
 14735           pb-i-tot-fees-calc + ws-tol-ah-prem
 14736        compute ws-tol-ah-low-prem-amt =
 14737           pb-i-tot-fees-calc - ws-tol-ah-prem
 14738        if ws-tol-ah-prem-pct > zeros
 14739           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14740              (1 + ws-tol-ah-prem-pct)
 14741           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14742              (1 - ws-tol-ah-prem-pct)
 14743        else
 14744           move +9999999.99      to ws-tol-ah-high-prem-pct
 14745           move +0               to ws-tol-ah-low-prem-pct
 14746        end-if
 14747        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14748            or
 14749           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14750                          or
 14751           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14752           or
 14753           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14754            move er-3049         to ws-error
 14755           perform 9900-error-format
 14756                                 thru 9900-exit
 14757
 14758        end-if
 14759     end-if
 14760     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14761         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14762             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14763             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 268
* EL050.cbl
 14764
 14765     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14766        IF WS-COMP-MAX-CAP GREATER THAN +0
 14767           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14768              IF (PB-REISSUED-CERT         OR
 14769                  PB-POLICY-IS-DECLINED    OR
 14770                  PB-POLICY-IS-VOIDED)
 14771                 NEXT SENTENCE
 14772              ELSE
 14773                  MOVE ER-2646   TO  WS-ERROR
 14774                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14775
 14776     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14777        (WS-COMP-MAX-CAP EQUAL +0)
 14778           GO TO 3345-EDIT-CONTINUE.
 14779
 14780     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14781        GREATER THAN WS-COMP-MAX-CAP
 14782           MOVE ER-2646          TO  WS-ERROR
 14783           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14784
 14785 3345-EDIT-CONTINUE.
 14786
 14787*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14788*       IF PB-ENTRY-BATCH   NUMERIC
 14789*          IF PB-ISSUE
 14790*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14791*          ELSE
 14792*              IF PB-CANCELLATION
 14793*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14794
 14795*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14796*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14797*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14798*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14799*        ELSE
 14800*            MOVE  ER-1909            TO  WS-ERROR
 14801*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14802
 14803     IF PB-I-POLICY-ACCEPTED
 14804        IF PB-POLICY-IS-DECLINED  OR
 14805           PB-REISSUED-CERT  OR
 14806           PB-REIN-ONLY-CERT  OR
 14807           PB-POLICY-IS-VOIDED
 14808            MOVE  ER-1891         TO  WS-ERROR
 14809            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14810        ELSE
 14811            MOVE SPACE            TO  PB-BATCH-ENTRY
 14812            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14813
 14814     IF PB-I-POLICY-DECLINED
 14815        IF PB-REISSUED-CERT  OR
 14816           PB-REIN-ONLY-CERT  OR
 14817           PB-POLICY-IS-VOIDED
 14818            MOVE  ER-1906         TO  WS-ERROR
 14819            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14820        ELSE
 14821            MOVE  'D'             TO  PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 269
* EL050.cbl
 14822                                      PB-I-ENTRY-STATUS.
 14823
 14824     IF PB-I-NEEDS-UNDERWRITING
 14825        IF PB-POLICY-IS-DECLINED OR
 14826           PB-REISSUED-CERT  OR
 14827           PB-REIN-ONLY-CERT  OR
 14828           PB-POLICY-IS-VOIDED
 14829            MOVE  ER-1907         TO  WS-ERROR
 14830            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14831        ELSE
 14832            MOVE 'U'              TO  PB-BATCH-ENTRY
 14833                                      PB-I-ENTRY-STATUS.
 14834
 14835     IF PB-NEEDS-UNDERWRITING
 14836        MOVE  ER-1901             TO  WS-ERROR
 14837        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14838     IF PB-COMPANY-ID = 'DCC'
 14839        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14840        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14841        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14842           AND (NOT WS-LF-CASH))
 14843                           OR
 14844           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14845           AND (NOT WS-AH-CASH)))
 14846                       AND
 14847           (PB-I-ENTRY-STATUS NOT = '5')
 14848           MOVE 'M'              TO PB-BATCH-ENTRY
 14849                                    PB-I-ENTRY-STATUS
 14850        END-IF
 14851     END-IF
 14852     IF  PB-COMPANY-ID NOT = 'NCL'
 14853         GO TO 3999-END-EDIT.
 14854
 14855     IF PB-REISSUED-CERT  OR
 14856        PB-POLICY-IS-DECLINED  OR
 14857        PB-POLICY-IS-VOIDED  OR
 14858        PB-I-OB
 14859         GO TO 3999-END-EDIT.
 14860
 14861     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14862         MOVE  ER-2644            TO  WS-ERROR
 14863         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14864         GO TO 3999-END-EDIT.
 14865
 14866     MOVE 'N'                     TO  FORM-MASTER-SW.
 14867     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14868
 14869     IF NOT FORM-MASTER-FOUND
 14870         GO TO 3999-END-EDIT.
 14871
 14872     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14873                                      FORM-MASTER-AH-SW.
 14874
 14875     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14876         MOVE  +1                 TO SUB6
 14877         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14878
 14879     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 270
* EL050.cbl
 14880         MOVE  +1                 TO SUB6
 14881         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14882
 14883     IF LF-FORM-MASTER-FOUND  OR
 14884        AH-FORM-MASTER-FOUND
 14885         GO TO 3360-CHECK-FORM-LIMITS
 14886     ELSE
 14887         GO TO 3999-END-EDIT.
 14888
 14889******************************************************************
 14890*                  3350-GET-ERFORM                               *
 14891*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14892*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14893******************************************************************
 14894
 14895 3350-GET-ERFORM.
 14896
 14897     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14898         GO TO  3350-ERFORM-GETMAIN.
 14899
 14900     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14901     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14902     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14903     MOVE 'Y'                     TO FORM-MASTER-SW.
 14904
 14905     IF PB-CANCELLATION
 14906         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14907            PB-SV-STATE          EQUAL   FO-STATE       AND
 14908            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14909              GO TO 3350-EXIT
 14910         ELSE
 14911             NEXT SENTENCE
 14912     ELSE
 14913         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14914            PB-SV-STATE          EQUAL   FO-STATE       AND
 14915            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14916              GO TO 3350-EXIT.
 14917
 14918 3350-ERFORM-GETMAIN.
 14919
 14920     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14921     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14922
 14923 3350-ERFORM-READ.
 14924
 14925     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14926     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14927     IF PB-CANCELLATION
 14928         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14929     ELSE
 14930         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14931     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14932
 14933     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14934
 14935     IF FORM-MASTER-FOUND
 14936       IF PB-CANCELLATION
 14937          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 271
* EL050.cbl
 14938             PB-SV-STATE          EQUAL   FO-STATE       AND
 14939             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14940              GO  TO 3350-EXIT
 14941          ELSE
 14942              NEXT SENTENCE
 14943       ELSE
 14944          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14945             PB-SV-STATE          EQUAL   FO-STATE       AND
 14946             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14947              GO  TO 3350-EXIT.
 14948
 14949     MOVE  'N'                    TO  FORM-MASTER-SW.
 14950     MOVE  ER-1895                TO  WS-ERROR.
 14951     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14952
 14953 3350-EXIT.
 14954      EXIT.
 14955
 14956******************************************************************
 14957*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14958*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14959*   VALID FOR THE POLICY FORM USED.                              *
 14960******************************************************************
 14961
 14962 3355-EDIT-FORM-LF-BENEFITS.
 14963
 14964     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14965        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14966         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14967         GO TO   3355-EXIT.
 14968
 14969     IF  SUB6    LESS THAN   +40
 14970         ADD  +1      TO  SUB6
 14971         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14972
 14973     MOVE  ER-1896         TO  WS-ERROR.
 14974     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14975
 14976 3355-EXIT.
 14977      EXIT.
 14978
 14979******************************************************************
 14980*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14981*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14982*   VALID FOR THE POLICY FORM USED.                              *
 14983******************************************************************
 14984
 14985 3356-EDIT-FORM-AH-BENEFITS.
 14986
 14987     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14988        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14989         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14990         GO TO  3356-EXIT.
 14991
 14992      IF  SUB6    LESS THAN     +40
 14993          ADD  +1      TO  SUB6
 14994          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14995
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 272
* EL050.cbl
 14996     MOVE  ER-1897         TO  WS-ERROR.
 14997     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14998
 14999 3356-EXIT.
 15000      EXIT.
 15001
 15002******************************************************************
 15003*                  3357-BENEFIT-SEARCH                           *
 15004*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15005*   CANCELLATIONS ONLY.                                          *
 15006******************************************************************
 15007 3357-BENEFIT-SEARCH.
 15008     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15009         MOVE +1                          TO SUB6
 15010         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15011
 15012     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15013         MOVE +1                          TO SUB6
 15014         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15015
 15016 3357-EXIT.
 15017     EXIT.
 15018
 15019******************************************************************
 15020*                  3358-BENEFIT-LIFE-SEARCH                      *
 15021*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15022*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15023*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15024******************************************************************
 15025 3358-BENEFIT-LIFE-SEARCH.
 15026     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15027       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15028         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15029           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15030              IF FO-PLAN-REFUND-METHOD (SUB6)
 15031                     IS GREATER THAN SPACES
 15032                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15033                                          WS-LF-REFUND-CALC
 15034                 GO TO 3358-EXIT.
 15035
 15036     IF SUB6 LESS THAN +40
 15037         ADD +1                 TO SUB6
 15038         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15039
 15040 3358-EXIT.
 15041     EXIT.
 15042******************************************************************
 15043*                  3359-BENEFIT-AH-SEARCH                        *
 15044*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15045*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15046*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15047******************************************************************
 15048 3359-BENEFIT-AH-SEARCH.
 15049     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15050       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15051         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15052           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15053              IF FO-PLAN-REFUND-METHOD (SUB6)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 273
* EL050.cbl
 15054                      IS GREATER THAN SPACES
 15055                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15056                                          WS-AH-REFUND-CALC
 15057                 GO TO 3359-EXIT.
 15058
 15059     IF SUB6 LESS THAN +40
 15060         ADD +1                 TO SUB6
 15061         GO TO 3359-BENEFIT-AH-SEARCH.
 15062
 15063 3359-EXIT.
 15064     EXIT.
 15065
 15066******************************************************************
 15067*                  3360-CHECK-FORM-LIMITS                        *
 15068*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15069*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15070******************************************************************
 15071
 15072 3360-CHECK-FORM-LIMITS.
 15073
 15074     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15075         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15076
 15077     IF NOT LF-FORM-MASTER-FOUND
 15078         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15079
 15080 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15081
 15082     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15083       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15084        WS-LF-JOINT-INDICATOR = 'J'  AND
 15085        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15086         IF PB-COMPANY-ID = 'NCL'
 15087            MOVE  ER-1911          TO  WS-ERROR
 15088            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15089         ELSE
 15090            MOVE  ER-1892          TO  WS-ERROR
 15091            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15092
 15093 3360-CHECK-FORM-LF-ATT-AGE.
 15094
 15095     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15096
 15097     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15098         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15099         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15100            IF PB-COMPANY-ID = 'NCL'
 15101                MOVE  ER-1913      TO  WS-ERROR
 15102                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15103            ELSE
 15104                MOVE  ER-1894      TO  WS-ERROR
 15105                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15106
 15107 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15108
 15109     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15110         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15111         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 274
* EL050.cbl
 15112            IF PB-COMPANY-ID = 'NCL'
 15113                MOVE  ER-1914      TO  WS-ERROR
 15114                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15115            ELSE
 15116                MOVE  ER-1899      TO  WS-ERROR
 15117                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15118
 15119 3360-CHECK-FORM-LF-TERM-BAMT.
 15120
 15121     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15122         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15123         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15124           IF  PB-COMPANY-ID = 'NCL'
 15125               MOVE  ER-1916       TO  WS-ERROR
 15126               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15127           ELSE
 15128               MOVE  ER-1902       TO  WS-ERROR
 15129               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15130
 15131     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15132                                    PB-I-LF-ALT-BENEFIT-AMT.
 15133
 15134     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15135         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15136         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15137             IF  PB-COMPANY-ID = 'NCL'
 15138                 MOVE  ER-1918     TO  WS-ERROR
 15139                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15140             ELSE
 15141                 MOVE  ER-1904     TO  WS-ERROR
 15142                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15143
 15144******************************************************************
 15145*                  3360-CHECK-FORM-AH-LIMITS                     *
 15146*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15147*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15148******************************************************************
 15149
 15150 3360-CHECK-FORM-AH-LIMITS.
 15151
 15152     IF NOT AH-FORM-MASTER-FOUND
 15153         GO TO 3999-END-EDIT.
 15154
 15155 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15156
 15157     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15158       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15159        WS-AH-JOINT-INDICATOR = 'J'  AND
 15160        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15161         IF PB-COMPANY-ID = 'NCL'
 15162            MOVE  ER-1912          TO  WS-ERROR
 15163            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15164         ELSE
 15165            MOVE  ER-1893          TO  WS-ERROR
 15166            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15167
 15168 3360-CHECK-FORM-AH-ATT-AGE.
 15169
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 275
* EL050.cbl
 15170     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15171
 15172     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15173         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15174         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15175            IF PB-COMPANY-ID = 'NCL'
 15176                MOVE  ER-1913      TO  WS-ERROR
 15177                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15178            ELSE
 15179                MOVE  ER-1894      TO  WS-ERROR
 15180                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15181
 15182 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15183
 15184     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15185         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15186         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15187            IF PB-COMPANY-ID = 'NCL'
 15188                MOVE  ER-1915      TO  WS-ERROR
 15189                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15190            ELSE
 15191                MOVE  ER-1900      TO  WS-ERROR
 15192                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15193
 15194 3360-CHECK-FORM-AH-TERM-BAMT.
 15195
 15196     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15197         FO-AH-MAX-TERM    GREATER THAN  +0
 15198         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15199             IF  PB-COMPANY-ID = 'NCL'
 15200                 MOVE  ER-1917     TO  WS-ERROR
 15201                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15202             ELSE
 15203                  MOVE  ER-1903    TO  WS-ERROR
 15204                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15205
 15206     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15207         FO-MAX-AH-AMT    GREATER THAN  +0
 15208         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15209             IF  PB-COMPANY-ID = 'NCL'
 15210                 MOVE  ER-1919     TO  WS-ERROR
 15211                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15212             ELSE
 15213                 MOVE  ER-1905     TO  WS-ERROR
 15214                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15215
 15216     GO TO 3999-END-EDIT.
 15217
 15218******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 276
* EL050.cbl
 15220******************************************************************
 15221*                  E D I T   C A N C E L                         *
 15222******************************************************************
 15223
 15224 3700-EDIT-CANCEL.
 15225     IF PB-COMPANY-ID = 'DMD'
 15226         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15227                                         WS-RES-MUNI-TAX
 15228                                         PB-CI-STATE-TAX
 15229                                         PB-CI-MUNI-TAX
 15230         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15231
 15232*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15233*       IF PB-ENTRY-BATCH  NUMERIC
 15234*          IF PB-CANCELLATION
 15235*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15236*          ELSE
 15237*             IF PB-ISSUE
 15238*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15239
 15240     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15241        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15242     END-IF
 15243*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15244*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15245
 15246     IF CM-ENTRY-STATUS = 'V'
 15247        MOVE ER-2780             TO WS-ERROR
 15248        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15249        GO TO 3999-END-EDIT.
 15250
 15251     IF CM-ENTRY-STATUS = 'D'
 15252        MOVE ER-2781             TO WS-ERROR
 15253        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15254        GO TO 3999-END-EDIT.
 15255
 15256     IF CM-ENTRY-STATUS = 'U'
 15257        MOVE ER-2782             TO WS-ERROR
 15258        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15259
 15260***************************************************************
 15261*                                                             *
 15262*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15263*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15264*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15265*   OF ANOTHER COVERAGE.                                      *
 15266*                                                             *
 15267***************************************************************
 15268
 15269     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15270                                    PB-C-AH-CANCEL-VOID-SW.
 15271
 15272     IF PB-C-LF-CANCEL-AMT = ZERO
 15273        NEXT SENTENCE
 15274     ELSE
 15275        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15276           AND
 15277           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 277
* EL050.cbl
 15278               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15279               MOVE ER-2745           TO WS-ERROR
 15280               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15281
 15282     IF PB-C-AH-CANCEL-AMT = ZERO
 15283        NEXT SENTENCE
 15284     ELSE
 15285        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15286           AND
 15287           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15288               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15289               MOVE ER-2745           TO WS-ERROR
 15290               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15291
 15292     IF WS-LF-EARNINGS-CALC = '4'
 15293        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15294
 15295     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15296     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15297     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15298     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15299     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15300     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15301
 15302     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15303                                      PB-C-AH-REF-CALC.
 15304     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15305
 15306******************************************************************
 15307*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15308*             TO VALIDATE COVERAGE.                              *
 15309******************************************************************
 15310
 15311     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15312        PB-C-LF-CANCEL-AMT = ZEROS
 15313          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15314      ELSE
 15315          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15316
 15317     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15318        PB-C-AH-CANCEL-AMT = ZEROS
 15319          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15320      ELSE
 15321          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15322
 15323     EVALUATE TRUE
 15324         WHEN PB-CANCEL-FORCE             OR
 15325              PB-CANCEL-DATE-FORCED       OR
 15326              PB-FORCE-OFF
 15327                  IF PB-COMPANY-ID = 'ACE'
 15328                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15329                  END-IF
 15330         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15331               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15332              (PB-COMPANY-ID = 'ACE' )
 15333                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15334         WHEN OTHER
 15335              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 278
* EL050.cbl
 15336                 MOVE ER-2794              TO WS-ERROR
 15337              ELSE
 15338                 MOVE ER-2749              TO WS-ERROR
 15339              END-IF
 15340              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15341     END-EVALUATE.
 15342
 15343
 15344*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15345*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15346*            MOVE  ER-1909            TO  WS-ERROR
 15347*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15348*        ELSE
 15349*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15350
 15351     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15352     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15353        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15354     ELSE
 15355        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15356     END-IF
 15357     .
 15358 3705-EDIT-CANCEL-DT.
 15359
 15360     IF LF-COVERAGE-CANCELLED
 15361        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15362         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15363         MOVE WS-CURRENT-MONTH-END
 15364                                 TO DC-BIN-DATE-2
 15365         SET ELAPSED-BETWEEN-BIN TO TRUE
 15366*        MOVE 1                  TO DC-OPTION-CODE
 15367         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15368         IF DATE-CONVERSION-ERROR
 15369            NEXT SENTENCE
 15370          ELSE
 15371             IF DC-ELAPSED-DAYS GREATER +180
 15372                IF PB-CANCEL-DATE-FORCED  OR
 15373                   PB-CANCEL-DATE-FORCED-NO-FEE
 15374                      MOVE ER-2751  TO WS-ERROR
 15375                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15376                 ELSE
 15377                   MOVE ER-2752  TO WS-ERROR
 15378                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15379
 15380     IF AH-COVERAGE-CANCELLED
 15381        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15382         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15383         MOVE WS-CURRENT-MONTH-END
 15384                                 TO DC-BIN-DATE-2
 15385         SET ELAPSED-BETWEEN-BIN TO TRUE
 15386*        MOVE 1                  TO DC-OPTION-CODE
 15387         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15388         IF DATE-CONVERSION-ERROR
 15389            NEXT SENTENCE
 15390          ELSE
 15391             IF DC-ELAPSED-DAYS GREATER +180
 15392                IF PB-CANCEL-DATE-FORCED OR
 15393                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 279
* EL050.cbl
 15394                      MOVE ER-2751  TO WS-ERROR
 15395                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15396                 ELSE
 15397                   MOVE ER-2752  TO WS-ERROR
 15398                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15399
 15400     IF WS-ERROR = ER-2752
 15401        AND (PB-COMPANY-ID = 'ABL'
 15402         OR  PB-COMPANY-ID = 'FGL'
 15403         OR  PB-COMPANY-ID = 'IST'
 15404         OR  PB-COMPANY-ID = 'JHL'
 15405         OR  PB-COMPANY-ID = 'LAP'
 15406         OR  PB-COMPANY-ID = 'LBL'
 15407         OR  PB-COMPANY-ID = 'NCB'
 15408         OR  PB-COMPANY-ID = 'NLI'
 15409         OR  PB-COMPANY-ID = 'OFI'
 15410         OR  PB-COMPANY-ID = 'PLI'
 15411         OR  PB-COMPANY-ID = 'TAO'
 15412         OR  PB-COMPANY-ID = 'TIC'
 15413         OR  PB-COMPANY-ID = 'HER'
 15414         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15415         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15416            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15417            MOVE ER-2762     TO WS-ERROR
 15418            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15419
 15420     IF LF-COVERAGE-CANCELLED
 15421        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15422        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15423             MOVE ER-2733         TO WS-ERROR
 15424             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15425
 15426     IF AH-COVERAGE-CANCELLED
 15427        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15428        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15429              MOVE ER-2733        TO WS-ERROR
 15430              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15431
 15432     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15433        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15434        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15435           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15436            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15437              IF PB-COMPANY-ID NOT = 'LAP'
 15438               MOVE ER-2704            TO WS-ERROR
 15439               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15440
 15441     IF CERT-WAS-NOT-FOUND
 15442         GO TO 3999-END-EDIT.
 15443
 15444     IF PB-COMPANY-ID EQUAL 'CDC'
 15445        IF LF-COVERAGE-CANCELLED
 15446           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15447            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15448            MOVE PB-C-LF-CANCEL-DT
 15449                                 TO DC-BIN-DATE-2
 15450            SET ELAPSED-BETWEEN-BIN TO TRUE
 15451*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 280
* EL050.cbl
 15452            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15453            IF DATE-CONVERSION-ERROR
 15454               NEXT SENTENCE
 15455             ELSE
 15456                IF DC-ELAPSED-DAYS GREATER +60
 15457                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15458
 15459     IF PB-COMPANY-ID EQUAL 'CDC'
 15460        IF AH-COVERAGE-CANCELLED
 15461           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15462            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15463            MOVE PB-C-AH-CANCEL-DT
 15464                                 TO DC-BIN-DATE-2
 15465            MOVE +0              TO DC-ELAPSED-DAYS
 15466                                    DC-ELAPSED-MONTHS
 15467            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15468*           MOVE 1               TO DC-OPTION-CODE
 15469            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15470            IF DATE-CONVERSION-ERROR
 15471               NEXT SENTENCE
 15472             ELSE
 15473                IF DC-ELAPSED-DAYS GREATER +60
 15474                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15475
 15476     MOVE +0                     TO DC-ELAPSED-DAYS
 15477                                    DC-ELAPSED-MONTHS.
 15478
 15479     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15480        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15481          MOVE 'Z'                TO PB-CI-OB-FLAG
 15482          MOVE ER-2767            TO WS-ERROR
 15483          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15484          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15485          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15486          GO TO 3775-OVER-REF-CHK
 15487        ELSE
 15488          MOVE ZEROS              TO PB-CI-LIVES
 15489                                     PB-C-LIVES
 15490          IF PB-CI-OB-FLAG NOT = 'B'
 15491             MOVE SPACE           TO PB-CI-OB-FLAG.
 15492
 15493     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15494         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15495     ELSE
 15496         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15497
 15498     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15499        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15500            MOVE ER-2760         TO WS-ERROR
 15501            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15502
 15503     IF LF-COVERAGE-CANCELLED
 15504        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15505         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15506            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15507               MOVE ER-2774       TO WS-ERROR
 15508               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15509
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 281
* EL050.cbl
 15510     IF AH-COVERAGE-CANCELLED
 15511        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15512         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15513            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15514               MOVE ER-2775       TO WS-ERROR
 15515               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15516
 15517     IF LF-COVERAGE-CANCELLED
 15518        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15519         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15520            MOVE ER-2776         TO WS-ERROR
 15521            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15522
 15523     IF AH-COVERAGE-CANCELLED
 15524        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15525         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15526            MOVE ER-2777         TO WS-ERROR
 15527            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15528     IF LF-COVERAGE-CANCELLED
 15529        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15530        if pb-ci-lf-expire-dt = low-values or spaces
 15531           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15532           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15533           MOVE PB-CI-EXTENTION-DAYS
 15534                                 TO DC-ELAPSED-DAYS
 15535           SET BIN-PLUS-ELAPSED  TO TRUE
 15536           PERFORM 8500-DATE-CONVERT
 15537                                 THRU 8500-EXIT
 15538           IF DATE-CONVERSION-ERROR
 15539              move low-values    to dc-bin-date-2
 15540           end-if
 15541        else
 15542           move pb-ci-lf-expire-dt
 15543                                 to dc-bin-date-2
 15544        end-if
 15545        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15546           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15547                             OR  'FIA'
 15548              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15549           ELSE
 15550              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15551              MOVE ER-2731       TO WS-ERROR
 15552              PERFORM 9900-ERROR-FORMAT
 15553                                 THRU 9900-EXIT
 15554           end-if
 15555        end-if
 15556     end-if
 15557*    IF LF-COVERAGE-CANCELLED
 15558*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15559*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15560*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15561*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15562*        SET BIN-PLUS-ELAPSED      TO TRUE
 15563*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15564*        IF DATE-CONVERSION-ERROR
 15565*           NEXT SENTENCE
 15566*         ELSE
 15567*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 282
* EL050.cbl
 15568*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15569*                            OR  'FIA'
 15570*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15571*              ELSE
 15572*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15573*               MOVE ER-2731       TO WS-ERROR
 15574*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15575     .
 15576 3705-EDIT-AH-CANCEL-DT.
 15577     IF AH-COVERAGE-CANCELLED
 15578        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15579        if pb-ci-AH-expire-dt = low-values or spaces
 15580           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15581           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15582           MOVE PB-CI-EXTENTION-DAYS
 15583                                 TO DC-ELAPSED-DAYS
 15584           SET BIN-PLUS-ELAPSED  TO TRUE
 15585           PERFORM 8500-DATE-CONVERT
 15586                                 THRU 8500-EXIT
 15587           IF DATE-CONVERSION-ERROR
 15588              move low-values    to dc-bin-date-2
 15589           end-if
 15590        else
 15591           move pb-ci-ah-expire-dt
 15592                                 to dc-bin-date-2
 15593        end-if
 15594        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15595           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15596                             OR  'FIA'
 15597              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15598           ELSE
 15599              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15600              MOVE ER-2771       TO WS-ERROR
 15601              PERFORM 9900-ERROR-FORMAT
 15602                                 THRU 9900-EXIT
 15603           end-if
 15604        end-if
 15605     end-if
 15606*    IF AH-COVERAGE-CANCELLED
 15607*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15608*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15609*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15610*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15611**       MOVE 6                    TO DC-OPTION-CODE
 15612*        SET BIN-PLUS-ELAPSED      TO TRUE
 15613*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15614*        IF DATE-CONVERSION-ERROR
 15615*           NEXT SENTENCE
 15616*         ELSE
 15617*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15618*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15619*                             OR 'FIA'
 15620*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15621*             ELSE
 15622*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15623*              MOVE ER-2771       TO WS-ERROR
 15624*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15625     .
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 283
* EL050.cbl
 15626 3705-EDIT-CONTINUED.
 15627
 15628*    IF LF-COVERAGE-CANCELLED
 15629*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15630*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15631*            MOVE ER-2727         TO WS-ERROR
 15632*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15633*
 15634*    IF AH-COVERAGE-CANCELLED
 15635*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15636*        IF PB-COMPANY-ID = 'ACE'
 15637*           MOVE ER-2727        TO WS-ERROR
 15638*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15639*        ELSE
 15640*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15641*              MOVE ER-2727     TO WS-ERROR
 15642*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15643
 15644     IF PB-COMPANY-ID = 'ACE'
 15645       IF AH-COVERAGE-CANCELLED
 15646         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15647           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15648              MOVE ER-2732      TO WS-ERROR
 15649              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15650
 15651     IF PB-COMPANY-ID      EQUAL   'HER'
 15652        IF WS-ERROR        EQUAL   ER-2727
 15653            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15654            MOVE  ER-2725          TO  WS-ERROR
 15655            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15656
 15657     IF PB-C-CLAIM-CREATED-CANCEL
 15658            MOVE ER-2748         TO WS-ERROR
 15659            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15660
 15661     IF PB-C-LAST-NAME NOT = SPACES
 15662         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15663            MOVE ER-2747         TO WS-ERROR
 15664            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15665
 15666 3710-EDIT-LUMP-SUM-PRIOR.
 15667
 15668     IF AH-COVERAGE-CANCELLED
 15669         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15670             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15671                MOVE ER-2735    TO WS-ERROR
 15672                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15673
 15674     IF LF-COVERAGE-CANCELLED
 15675         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15676             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15677                MOVE ER-2735    TO WS-ERROR
 15678                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15679
 15680 3710-EDIT-PRIOR-DEATH.
 15681
 15682*    IF LF-COVERAGE-CANCELLED
 15683*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 284
* EL050.cbl
 15684*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15685*           (NOT PB-CI-OB)
 15686*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15687*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15688*                   MOVE ER-2732  TO WS-ERROR
 15689*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15690*
 15691*    IF AH-COVERAGE-CANCELLED
 15692*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15693*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15694*           (NOT PB-CI-OB)
 15695*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15696*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15697*                   MOVE ER-2732  TO WS-ERROR
 15698*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15699
 15700     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15701         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15702            (NOT PB-COMP-LF-CANCEL)
 15703             NEXT SENTENCE
 15704         ELSE
 15705           IF PB-C-LF-CANCEL-VOIDED
 15706              NEXT SENTENCE
 15707           ELSE
 15708              MOVE ER-2753      TO WS-ERROR
 15709              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15710
 15711     IF CANCEL-FUTURE-DT
 15712         GO TO 3999-END-EDIT.
 15713
 15714 3715-GET-REMAIN-TERM-LF.
 15715
 15716     IF NO-LF-BENEFIT-MATCH  OR
 15717        WS-LF-BENEFIT-CD = ZEROS
 15718        GO TO 3730-GET-AH-REMAIN-TERM.
 15719
 15720     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15721     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15722     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15723     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15724     MOVE PB-SV-STATE            TO CP-STATE.
 15725     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15726     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15727     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15728     MOVE '2'                    TO CP-PROCESS-TYPE.
 15729     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15730     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15731     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15732     IF (PB-COMPANY-ID = 'CID')
 15733        AND (CP-STATE-STD-ABBRV = 'WI')
 15734        MOVE '7'                 TO CP-REM-TERM-METHOD
 15735        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15736     ELSE
 15737        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15738        MOVE WS-REM-TRM-CALC-OPTION
 15739                                 TO CP-REM-TRM-CALC-OPTION
 15740     END-IF
 15741**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 285
* EL050.cbl
 15742     IF (PB-COMPANY-ID = 'CID')
 15743        AND (CP-STATE-STD-ABBRV = 'MO')
 15744        AND (PB-CERT-EFF-DT >= X'9B41')
 15745        AND (PB-CERT-EFF-DT <= X'A2FB')
 15746        MOVE '7'                 TO CP-REM-TERM-METHOD
 15747        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15748     END-IF
 15749     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15750                                    CP-LOAN-TERM.
 15751     IF CP-TRUNCATED-LIFE
 15752        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15753
 15754     IF CP-TERM-IS-DAYS
 15755         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15756     ELSE
 15757         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15758
 15759     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15760
 15761     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15762
 15763     IF LF-COVERAGE-CANCELLED
 15764        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15765        NEXT SENTENCE
 15766      ELSE
 15767          GO TO 3730-GET-AH-REMAIN-TERM.
 15768
 15769 3720-GET-LF-REFUND.
 15770
 15771     IF PB-C-LF-CANCEL-VOIDED OR
 15772        PB-C-AH-CANCEL-VOIDED
 15773        GO TO 3780-UPDATE-CANCEL-CERT.
 15774
 15775     IF PB-COMPANY-ID EQUAL 'BOA'
 15776         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15777         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15778         GO TO 3730-GET-AH-REMAIN-TERM.
 15779
 15780     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15781        (WS-AH-SPECIAL-CALC-CD = 'M')
 15782         MOVE ER-2767            TO WS-ERROR
 15783         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15784         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15785         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15786         GO TO 3780-UPDATE-CANCEL-CERT.
 15787
 15788     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15789
 15790     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15791     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15792     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15793     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15794     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15795     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15796     IF (PB-COMPANY-ID = 'DCC')
 15797        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15798        IF PDEF-MASTER-FOUND
 15799           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 286
* EL050.cbl
 15800              (V1 > +8)
 15801              OR (PD-PROD-CODE (V1) = 'L')
 15802           END-PERFORM
 15803           IF V1 < +9
 15804              MOVE PD-MAX-AMT (V1)
 15805                           TO CP-R-MAX-TOT-BEN
 15806                              EC-AM-LF-MAX-TOT-BEN
 15807           END-IF
 15808        ELSE
 15809        MOVE ' '                 TO PDEF-MASTER-SW
 15810        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15811        MOVE PB-STATE            TO ERPDEF-STATE
 15812        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15813        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15814        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15815        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15816        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15817        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15818        IF PDEF-MASTER-FOUND
 15819           MOVE 'N'              TO PDEF-MASTER-SW
 15820           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15821           IF PDEF-MASTER-FOUND
 15822              IF (ERPDEF-KEY-SAVE (1:16) =
 15823                           PD-CONTROL-PRIMARY (1:16))
 15824                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15825                 CONTINUE
 15826              ELSE
 15827                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15828                 IF (ERPDEF-KEY-SAVE (1:16) =
 15829                           PD-CONTROL-PRIMARY (1:16))
 15830                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15831                    CONTINUE
 15832                 ELSE
 15833                    MOVE 'N'     TO PDEF-MASTER-SW
 15834                 END-IF
 15835              END-IF
 15836              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15837
 15838              IF PDEF-MASTER-FOUND
 15839                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15840                    (V1 > +8)
 15841                    OR (PD-PROD-CODE (V1) = 'L')
 15842                 END-PERFORM
 15843                 IF V1 < +9
 15844                    MOVE PD-MAX-AMT (V1)
 15845                                 TO CP-R-MAX-TOT-BEN
 15846                                    EC-AM-LF-MAX-TOT-BEN
 15847                 END-IF
 15848              END-IF
 15849           END-IF
 15850           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15851        END-IF
 15852        END-IF
 15853     END-IF
 15854     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15855
 15856     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15857
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 287
* EL050.cbl
 15858     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15859                                    PB-C-LF-REM-TERM.
 15860
 15861     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15862     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15863
 15864     IF PB-COMPANY-ID EQUAL 'FLC'
 15865        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15866           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15867           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15868                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15869                    - CM-LF-ITD-DEATH-AMT
 15870           IF PB-C-LF-REF-CALC LESS THAN +0
 15871              MOVE +0            TO PB-C-LF-REF-CALC
 15872              GO TO 3730-GET-AH-REMAIN-TERM
 15873           ELSE
 15874              GO TO 3730-GET-AH-REMAIN-TERM.
 15875
 15876     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15877                            OR '4' OR '5' OR '6' OR '8'
 15878                            OR '9' OR 'G'
 15879        MOVE PB-C-LF-REFUND-OVERRIDE
 15880                                 TO CP-EARNING-METHOD.
 15881
 15882     if pb-company-id = 'AHL'
 15883        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15884        if cp-class-code = spaces
 15885           move zeros            to cp-class-code
 15886        end-if
 15887     ELSE
 15888        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15889     END-IF
 15890*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15891     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15892     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15893                                    CP-RATING-BENEFIT-AMT.
 15894     IF CP-STATE-STD-ABBRV = 'OR'
 15895         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15896                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15897     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15898     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15899     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15900     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15901     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15902     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15903     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15904     IF WS-DEFAULT-APR NOT NUMERIC
 15905         MOVE ZEROS TO WS-DEFAULT-APR.
 15906****   N O T E   ****
 15907*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15908*      THE OH HARD CODING IN ELCRFNDP
 15909
 15910     IF PB-COMPANY-ID = 'CID'
 15911        IF CP-STATE-STD-ABBRV = 'OH'
 15912           MOVE WS-LF-EARNINGS-CALC
 15913                                 TO CP-EARNING-METHOD
 15914        END-IF
 15915     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 288
* EL050.cbl
 15916
 15917****   N O T E   ****
 15918
 15919     IF CP-EARN-AS-NET-PAY
 15920         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15921            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15922                MOVE WS-DEFAULT-APR
 15923                                 TO  CP-LOAN-APR
 15924                MOVE ER-3780     TO  WS-ERROR
 15925                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15926            ELSE
 15927                MOVE ER-3781     TO  WS-ERROR
 15928                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15929     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15930     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15931
 15932     IF CP-REFUND-TYPE-USED NOT = SPACE
 15933         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15934
 15935     IF CP-ERROR-RATE-IS-ZERO OR
 15936        CP-ERROR-RATE-NOT-FOUND
 15937        MOVE ER-2740             TO WS-ERROR
 15938        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15939
 15940     IF CP-ERROR-RATE-FILE-NOTOPEN
 15941        MOVE ER-2617             TO WS-ERROR
 15942        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15943
 15944     IF PB-COMPANY-ID = 'DCC'
 15945        AND PB-CI-ENTRY-STATUS = 'M'
 15946        MOVE +0                  TO PB-C-LF-REF-CALC
 15947     ELSE
 15948        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15949     END-IF
 15950
 15951     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15952         GO TO 3730-GET-AH-REMAIN-TERM.
 15953
 15954*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15955*       ADD +1                   TO PB-C-LF-REM-TERM
 15956*                                   CP-REMAINING-TERM
 15957*                                   CP-ORIGINAL-TERM.
 15958
 15959     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15960     MOVE '2'                    TO CP-EARNING-METHOD
 15961                                    CP-RATING-METHOD.
 15962     IF PB-COMPANY-ID = 'CID'
 15963        IF (CP-STATE-STD-ABBRV = 'MN')
 15964           AND (PB-CERT-EFF-DT > X'A4FF')
 15965           AND (WS-LF-EARNINGS-CALC = 'B')
 15966           MOVE '5'              TO CP-EARNING-METHOD
 15967           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15968        END-IF
 15969     END-IF
 15970     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15971                                        CP-REMAINING-BENEFIT
 15972                                        CP-RATING-BENEFIT-AMT.
 15973     IF CP-STATE-STD-ABBRV = 'OR'
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 289
* EL050.cbl
 15974         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15975                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15976     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15977     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15978
 15979     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15980
 15981     IF CP-ERROR-RATE-IS-ZERO OR
 15982        CP-ERROR-RATE-NOT-FOUND
 15983        MOVE ER-2740             TO WS-ERROR
 15984        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15985
 15986     IF CP-ERROR-RATE-FILE-NOTOPEN
 15987        MOVE ER-2617             TO WS-ERROR
 15988        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15989
 15990     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15991
 15992******************************************************************
 15993
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 290
* EL050.cbl
 15995 3730-GET-AH-REMAIN-TERM.
 15996     IF NO-AH-BENEFIT-MATCH  OR
 15997        WS-AH-BENEFIT-CD = ZEROS
 15998         GO TO 3770-CHECK-REFUNDS.
 15999
 16000     IF PB-CI-AH-LUMP-SUM-DISAB
 16001         IF  PB-C-AH-CANCEL-AMT = ZERO
 16002            IF NOT PB-COMP-AH-CANCEL
 16003             GO TO 3770-CHECK-REFUNDS.
 16004
 16005     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16006     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16007     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16008     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16009     MOVE PB-SV-STATE            TO CP-STATE.
 16010     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16011     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16012     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16013     MOVE '2'                    TO CP-PROCESS-TYPE.
 16014     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16015     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16016     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16017     IF (PB-COMPANY-ID = 'CID')
 16018        AND (CP-STATE-STD-ABBRV = 'WI')
 16019        MOVE '7'                 TO CP-REM-TERM-METHOD
 16020        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16021     ELSE
 16022        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16023        MOVE WS-REM-TRM-CALC-OPTION
 16024                                 TO CP-REM-TRM-CALC-OPTION
 16025     END-IF
 16026     IF (PB-COMPANY-ID = 'CID')
 16027        AND (CP-STATE-STD-ABBRV = 'MO')
 16028        AND (PB-CERT-EFF-DT >= X'9B41')
 16029        AND (PB-CERT-EFF-DT <= X'A2FB')
 16030        MOVE '7'                 TO CP-REM-TERM-METHOD
 16031        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16032     END-IF
 16033     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16034                                    CP-LOAN-TERM.
 16035     IF NOT CP-TERM-IS-DAYS
 16036         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16037
 16038     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16039
 16040     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16041
 16042     IF AH-COVERAGE-CANCELLED
 16043        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16044        NEXT SENTENCE
 16045      ELSE
 16046         GO TO 3770-CHECK-REFUNDS.
 16047
 16048 3740-GET-AH-REFUND.
 16049
 16050     IF PB-C-LF-CANCEL-VOIDED OR
 16051        PB-C-AH-CANCEL-VOIDED
 16052        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 291
* EL050.cbl
 16053
 16054     IF PB-COMPANY-ID = 'BOA'
 16055         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16056         GO TO 3770-CHECK-REFUNDS.
 16057
 16058     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16059*    MOVE ' '                    TO DC-OPTION-CODE
 16060     SET BIN-TO-GREG             TO TRUE
 16061     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16062     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16063                                    PB-C-AH-REM-TERM.
 16064     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16065     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16066
 16067     IF PB-COMPANY-ID EQUAL 'FLC'
 16068        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16069           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16070           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16071                    - CM-AH-ITD-AH-PMT)
 16072           IF PB-C-AH-REF-CALC LESS THAN +0
 16073              MOVE +0            TO PB-C-AH-REF-CALC
 16074              GO TO 3770-CHECK-REFUNDS
 16075           ELSE
 16076              GO TO 3770-CHECK-REFUNDS.
 16077
 16078     IF PB-COMPANY-ID = 'DCC'
 16079        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16080            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16081           MOVE 'S'              TO CP-EARNING-METHOD
 16082        END-IF
 16083     END-IF
 16084     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16085                            OR '4' OR '5' OR '6' OR '8'
 16086                            OR '9' OR 'G' OR 'S'
 16087        MOVE PB-C-AH-REFUND-OVERRIDE
 16088                                 TO CP-EARNING-METHOD.
 16089
 16090     if pb-company-id = 'AHL'
 16091        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16092        if cp-class-code = spaces
 16093           move zeros            to cp-class-code
 16094        end-if
 16095     ELSE
 16096        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16097     END-IF
 16098*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16099     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16100     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16101                                    CP-RATING-BENEFIT-AMT.
 16102     IF CP-STATE-STD-ABBRV = 'OR'
 16103         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16104                                         PB-CI-AH-TERM.
 16105     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16106     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16107     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16108     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16109     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16110     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 292
* EL050.cbl
 16111
 16112     IF CP-STATE-STD-ABBRV = 'OH'
 16113        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16114                                AND 'CID' AND 'DCC' AND 'AHL')
 16115           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16116              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16117              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16118              MOVE '6' TO CP-EARNING-METHOD
 16119           END-IF
 16120        END-IF
 16121        IF PB-COMPANY-ID = 'CID'
 16122           IF NO-LIFE-COVERAGE
 16123              IF CP-CRITICAL-PERIOD
 16124                 MOVE '2'       TO CP-EARNING-METHOD
 16125              ELSE
 16126                 MOVE '6'       TO CP-EARNING-METHOD
 16127              END-IF
 16128           ELSE
 16129              IF WS-LF-COVERAGE-TYPE = 'L'
 16130                 MOVE '2'       TO CP-EARNING-METHOD
 16131              ELSE
 16132                 IF (PB-CI-LF-TERM > +60) OR
 16133                    (WS-LF-EARNINGS-CALC = '5')
 16134                    IF CP-CRITICAL-PERIOD
 16135                       MOVE '2'  TO CP-EARNING-METHOD
 16136                    ELSE
 16137                       MOVE '6'  TO CP-EARNING-METHOD
 16138                    END-IF
 16139                 ELSE
 16140                    MOVE '1'     TO CP-EARNING-METHOD
 16141                 END-IF
 16142              END-IF
 16143           END-IF
 16144        END-IF
 16145     END-IF
 16146
 16147*    IF CP-STATE-STD-ABBRV = 'VA'
 16148*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16149*          IF CP-ORIGINAL-TERM GREATER 61
 16150*             MOVE '6' TO CP-EARNING-METHOD
 16151*          ELSE
 16152*             MOVE '1' TO CP-EARNING-METHOD.
 16153
 16154     IF WS-DEFAULT-APR NOT NUMERIC
 16155         MOVE ZEROS TO WS-DEFAULT-APR.
 16156     IF CP-EARN-AS-NET-PAY
 16157         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16158            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16159                MOVE WS-DEFAULT-APR
 16160                                 TO  CP-LOAN-APR
 16161                MOVE ER-3780     TO  WS-ERROR
 16162                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16163            ELSE
 16164                MOVE ER-3781     TO  WS-ERROR
 16165                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16166     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16167     IF PB-COMPANY-ID = 'DCC'
 16168        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 293
* EL050.cbl
 16169        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16170        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16171     END-IF
 16172     IF PB-COMPANY-ID = 'DCC'
 16173        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16174        AND (CP-EARNING-METHOD = 'D')
 16175        AND (CP-CANCEL-REASON NOT = 'R')
 16176        CONTINUE
 16177     ELSE
 16178        GO TO 3750-CONTINUE
 16179     END-IF
 16180     MOVE ' '                    TO DD-IU-SW
 16181     IF NOT PDEF-MASTER-FOUND
 16182        MOVE ' '                 TO PDEF-MASTER-SW
 16183        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16184        MOVE PB-STATE            TO ERPDEF-STATE
 16185        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16186        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16187        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16188        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16189        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16190        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16191        IF PDEF-MASTER-FOUND
 16192           MOVE 'N'              TO PDEF-MASTER-SW
 16193           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16194           IF PDEF-MASTER-FOUND
 16195              IF (ERPDEF-KEY-SAVE (1:16) =
 16196                           PD-CONTROL-PRIMARY (1:16))
 16197                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16198                 CONTINUE
 16199              ELSE
 16200                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16201                 IF (ERPDEF-KEY-SAVE (1:16) =
 16202                           PD-CONTROL-PRIMARY (1:16))
 16203                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16204                    CONTINUE
 16205                 ELSE
 16206                    MOVE ER-2740 TO WS-ERROR
 16207                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16208                    GO TO 3770-CHECK-REFUNDS
 16209                 END-IF
 16210              END-IF
 16211           END-IF
 16212           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16213        END-IF
 16214     END-IF
 16215     IF PDEF-MASTER-FOUND
 16216        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16217           (V1 > +8)
 16218           OR (PD-PROD-CODE (V1) = 'I')
 16219        END-PERFORM
 16220        IF V1 < +9
 16221           SET DD-IU-PRESENT        TO TRUE
 16222        END-IF
 16223        IF WS-AH-DCC-TRUNC = 'T'
 16224           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16225        ELSE
 16226           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 294
* EL050.cbl
 16227        END-IF
 16228        EVALUATE TRUE
 16229           WHEN WS-TERM > +168
 16230              MOVE 15               TO V1
 16231           WHEN WS-TERM > +156
 16232              MOVE 14               TO V1
 16233           WHEN WS-TERM > +144
 16234              MOVE 13               TO V1
 16235           WHEN WS-TERM > +132
 16236              MOVE 12               TO V1
 16237           WHEN WS-TERM > +120
 16238              MOVE 11               TO V1
 16239           WHEN WS-TERM > +108
 16240              MOVE 10               TO V1
 16241           WHEN WS-TERM > +96
 16242              MOVE 9                TO V1
 16243           WHEN WS-TERM > +84
 16244              MOVE 8                TO V1
 16245           WHEN WS-TERM > +72
 16246              MOVE 7                TO V1
 16247           WHEN WS-TERM > +60
 16248              MOVE 6                TO V1
 16249           WHEN WS-TERM > +48
 16250              MOVE 5                TO V1
 16251           WHEN WS-TERM > +36
 16252              MOVE 4                TO V1
 16253           WHEN WS-TERM > +24
 16254              MOVE 3                TO V1
 16255           WHEN WS-TERM > +12
 16256              MOVE 2                TO V1
 16257           WHEN OTHER
 16258              MOVE 1                TO V1
 16259        END-EVALUATE
 16260
 16261        EVALUATE TRUE
 16262*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16263*             < +13)
 16264*             AND (DD-IU-PRESENT)
 16265*             MOVE 2                TO V2
 16266*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16267*             MOVE 1                TO V2
 16268           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16269              MOVE 2                TO V2
 16270           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16271              MOVE 3                TO V2
 16272           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16273              MOVE 4                TO V2
 16274           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16275              MOVE 5                TO V2
 16276           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16277              MOVE 6                TO V2
 16278           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16279              MOVE 7                TO V2
 16280           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16281              MOVE 8                TO V2
 16282           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16283              MOVE 9                TO V2
 16284           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 295
* EL050.cbl
 16285              MOVE 10               TO V2
 16286           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16287              MOVE 11               TO V2
 16288           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16289              MOVE 12               TO V2
 16290           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16291              MOVE 13               TO V2
 16292           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16293              MOVE 14               TO V2
 16294           WHEN OTHER
 16295              MOVE 15               TO V2
 16296        END-EVALUATE
 16297
 16298        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16299                                 TO CP-DDF-LO-FACT
 16300        MOVE PD-UEP-FACTOR (V1 V2)
 16301                                 TO CP-DDF-HI-FACT
 16302
 16303        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16304        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16305        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16306           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16307        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16308        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16309        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16310           + PD-1ST-YR-ADMIN-ALLOW
 16311
 16312        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16313*       IF PI-CLP-YN = 'Y'
 16314*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16315*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16316*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16317*       END-IF
 16318
 16319        IF DD-IU-PRESENT
 16320           MOVE 'I'              TO CP-EARNING-METHOD
 16321        END-IF
 16322        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16323                                     CP-CLP-RATE-UP
 16324        IF CP-IU-RATE-UP NOT = ZEROS
 16325           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16326              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16327           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16328              / (1 - WS-WORK-FACT)
 16329        END-IF
 16330     END-IF
 16331     .
 16332 3750-CONTINUE.
 16333     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16334
 16335     IF CP-REFUND-TYPE-USED NOT = SPACE
 16336         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16337
 16338     IF CP-ERROR-RATE-IS-ZERO OR
 16339        CP-ERROR-RATE-NOT-FOUND
 16340        MOVE ER-2740             TO WS-ERROR
 16341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16342
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 296
* EL050.cbl
 16343     IF CP-ERROR-RATE-FILE-NOTOPEN
 16344        MOVE ER-2617             TO WS-ERROR
 16345        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16346     IF PB-COMPANY-ID = 'DCC'
 16347        AND PB-CI-ENTRY-STATUS = 'M'
 16348        MOVE +0                  TO PB-C-AH-REF-CALC
 16349     ELSE
 16350        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16351     END-IF
 16352     IF PB-COMPANY-ID = 'DCC'
 16353        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16354        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16355        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16356        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16357        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16358        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16359        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16360        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16361        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16362     END-IF
 16363     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 297
* EL050.cbl
 16365
 16366 3770-CHECK-REFUNDS.
 16367
 16368     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16369        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16370           MOVE ER-2766          TO WS-ERROR
 16371           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16372           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16373           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16374              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16375
 16376     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16377        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16378           MOVE ER-2766          TO WS-ERROR
 16379           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16380           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16381           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16382              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16383
 16384     IF PB-COMP-LF-CANCEL
 16385        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16386        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16387           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16388              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16389
 16390     IF PB-COMP-AH-CANCEL
 16391        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16392        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16393           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16394              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16395
 16396     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16397             GIVING WS-UNSIGN-WRK1
 16398     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16399             GIVING WS-UNSIGN-WRK2.
 16400
 16401     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16402         MOVE ZERO TO WS-UNSIGN-WRK1.
 16403
 16404     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16405         MOVE ZERO TO WS-UNSIGN-WRK2.
 16406
 16407     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16408
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 298
* EL050.cbl
 16410
 16411 3772-CONTINUE.
 16412
 16413**********************************
 16414*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16415*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16416*** DOUBLES THE TOLERANCE AMOUNT.
 16417***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16418**********************************
 16419     IF PB-COMPANY-ID = 'MON'
 16420     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16421         IF WS-REF-REJECT-SW = SPACE
 16422             MOVE ER-2754        TO WS-ERROR
 16423             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16424           ELSE
 16425             MOVE ER-2736        TO WS-ERROR
 16426             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16427**********************************
 16428
 16429 3773-CONTINUE.
 16430
 16431     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16432        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16433           MOVE ER-2723          TO WS-ERROR
 16434           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16435
 16436     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16437        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16438           MOVE ER-2724          TO WS-ERROR
 16439           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16440
 16441     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16442         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16443             (1 + WS-LF-REFUND-OVS-PCT)
 16444     ELSE
 16445         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16446
 16447     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16448         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16449             (1 - WS-TOL-LF-REFUND-PCT)
 16450     ELSE
 16451         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16452
 16453     IF (PB-COMPANY-ID = 'DCC')
 16454        AND (PB-CI-ENTRY-STATUS = 'M')
 16455        AND (PB-C-LF-CANCEL-AMT > +0)
 16456        MOVE ER-3843             TO WS-ERROR
 16457        PERFORM 9900-ERROR-FORMAT
 16458                                 THRU 9900-EXIT
 16459     END-IF
 16460     EVALUATE TRUE
 16461        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16462           CONTINUE
 16463        WHEN PB-C-LF-CANCEL-AMT = +0
 16464                 AND PB-C-LF-REF-CALC > +0
 16465           CONTINUE
 16466        WHEN WS-LF-REFUND-OVS-AMT = 0
 16467                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 299
* EL050.cbl
 16468           CONTINUE
 16469        WHEN OTHER
 16470           IF WS-TOL-LF-REFUND  = +0
 16471              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16472           END-IF
 16473           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16474                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16475                          (PB-C-LF-CANCEL-AMT))
 16476              CONTINUE
 16477           ELSE
 16478              IF WS-LF-REFUND-OVS-AMT = +0
 16479                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16480              END-IF
 16481              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16482                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16483                                       PB-C-LF-CANCEL-AMT)
 16484                 CONTINUE
 16485              ELSE
 16486                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16487                   MOVE ER-2754   TO  WS-ERROR
 16488                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16489                 ELSE
 16490                    MOVE ER-2736   TO  WS-ERROR
 16491                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16492                 END-IF
 16493              END-IF
 16494           END-IF
 16495     END-EVALUATE.
 16496
 16497     EVALUATE TRUE
 16498        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16499           CONTINUE
 16500        WHEN PB-C-LF-CANCEL-AMT = +0
 16501                 AND PB-C-LF-REF-CALC > +0
 16502           CONTINUE
 16503        WHEN OTHER
 16504           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16505               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16506              CONTINUE
 16507           ELSE
 16508              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16509               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16510                CONTINUE
 16511              ELSE
 16512                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16513                     MOVE ER-2754   TO  WS-ERROR
 16514                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16515                 ELSE
 16516                     MOVE ER-2736   TO  WS-ERROR
 16517                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16518                 END-IF
 16519              END-IF
 16520           END-IF
 16521     END-EVALUATE.
 16522
 16523     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16524         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16525             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 300
* EL050.cbl
 16526     ELSE
 16527         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16528
 16529     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16530         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16531             (1 - WS-TOL-AH-REFUND-PCT)
 16532     ELSE
 16533         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16534
 16535     IF (PB-COMPANY-ID = 'DCC')
 16536        AND (PB-CI-ENTRY-STATUS = 'M')
 16537        AND (PB-C-AH-CANCEL-AMT > +0)
 16538        MOVE ER-3843             TO WS-ERROR
 16539        PERFORM 9900-ERROR-FORMAT
 16540                                 THRU 9900-EXIT
 16541     END-IF
 16542     EVALUATE TRUE
 16543        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16544           CONTINUE
 16545*       WHEN PB-C-AH-REF-CALC = +0 AND
 16546*                  PB-C-AH-CANCEL-AMT > +0
 16547        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16548                   PB-C-AH-REF-CALC > +0
 16549           CONTINUE
 16550        WHEN WS-AH-REFUND-OVS-AMT = +0
 16551                AND WS-TOL-AH-REFUND = +0
 16552           CONTINUE
 16553        WHEN OTHER
 16554           IF WS-TOL-AH-REFUND = +0
 16555              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16556           END-IF
 16557           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16558               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16559                                         PB-C-AH-CANCEL-AMT)
 16560              CONTINUE
 16561           ELSE
 16562              IF WS-AH-REFUND-OVS-AMT = +0
 16563                 MOVE +9999999.99 TO
 16564                         WS-AH-REFUND-OVS-AMT
 16565              END-IF
 16566              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16567                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16568                                         PB-C-AH-CANCEL-AMT)
 16569                 CONTINUE
 16570              ELSE
 16571                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16572                    MOVE ER-2754   TO  WS-ERROR
 16573                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16574                 ELSE
 16575                    MOVE ER-2736   TO  WS-ERROR
 16576                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16577                 END-IF
 16578              END-IF
 16579           END-IF
 16580     END-EVALUATE.
 16581
 16582     EVALUATE TRUE
 16583        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 301
* EL050.cbl
 16584           CONTINUE
 16585*       WHEN PB-C-AH-REF-CALC > +0 AND
 16586*                  PB-C-AH-CANCEL-AMT = +0
 16587        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16588                   PB-C-AH-REF-CALC = +0
 16589           CONTINUE
 16590        WHEN OTHER
 16591           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16592               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16593              CONTINUE
 16594           ELSE
 16595              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16596                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16597                 CONTINUE
 16598              ELSE
 16599                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16600                     MOVE ER-2754   TO  WS-ERROR
 16601                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16602                 ELSE
 16603                     MOVE ER-2736   TO  WS-ERROR
 16604                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16605                 END-IF
 16606              END-IF
 16607           END-IF
 16608     END-EVALUATE.
 16609
 16610     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16611        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16612        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16613           AND  PB-C-LF-REF-CALC < +1.00
 16614           AND  PB-C-AH-REF-CALC < +1.00
 16615           CONTINUE
 16616        ELSE
 16617           IF (PB-COMPANY-ID = 'DCC')
 16618              AND (PB-CI-ENTRY-STATUS = 'M')
 16619              CONTINUE
 16620           ELSE
 16621              MOVE ER-2741       TO WS-ERROR
 16622              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16623           END-IF
 16624        END-IF
 16625     END-IF
 16626
 16627     IF (PB-C-LF-CANCEL-AMT = ZERO
 16628        AND WS-LF-BENEFIT-CD NOT = ZERO
 16629        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16630        AND PB-C-LF-REF-CALC NOT = ZERO)
 16631        OR
 16632        (PB-C-LF-CANCEL-AMT = ZERO
 16633        AND WS-LF-BENEFIT-CD NOT = ZERO
 16634        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16635             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16636                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16637                NEXT SENTENCE
 16638             ELSE
 16639                MOVE ER-2739        TO WS-ERROR
 16640                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16641
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 302
* EL050.cbl
 16642     IF (PB-C-AH-CANCEL-AMT = ZERO
 16643        AND WS-AH-BENEFIT-CD NOT = ZERO
 16644        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16645        AND PB-C-AH-REF-CALC NOT = ZERO)
 16646        OR
 16647        (PB-C-AH-CANCEL-AMT = ZERO
 16648        AND WS-AH-BENEFIT-CD NOT = ZERO
 16649        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16650             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16651                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16652                NEXT SENTENCE
 16653             ELSE
 16654                MOVE ER-2738        TO WS-ERROR
 16655                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16656
 16657 3775-OVER-REF-CHK.
 16658
 16659     IF PB-CI-ENTRY-STATUS = '5'
 16660        GO TO 3780-UPDATE-CANCEL-CERT.
 16661
 16662     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16663                              PB-CI-LF-ALT-PREMIUM-AMT.
 16664
 16665     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16666        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16667                                 PB-C-LF-REF-CALC
 16668      ELSE
 16669        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16670                                 PB-C-LF-CANCEL-AMT.
 16671
 16672     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16673        MOVE ER-2755             TO WS-ERROR
 16674        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16675
 16676     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16677
 16678     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16679        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16680                                 PB-C-AH-REF-CALC
 16681      ELSE
 16682        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16683                                 PB-C-AH-CANCEL-AMT.
 16684
 16685     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16686        MOVE ER-2778             TO WS-ERROR
 16687        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16688
 16689     IF PB-CI-OB-FLAG NOT = 'Z'
 16690        NEXT SENTENCE
 16691       ELSE
 16692         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16693            MOVE ER-2757           TO WS-ERROR
 16694            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16695
 16696 3780-UPDATE-CANCEL-CERT.
 16697
 16698     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16699        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 303
* EL050.cbl
 16700        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16701
 16702     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16703         MOVE ER-2729              TO WS-ERROR
 16704         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16705
 16706     IF PB-CI-LF-BENEFIT-CD = ZERO
 16707         GO TO 3780-UPDATE-CONT-1.
 16708
 16709     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16710         GO TO 3780-UPDATE-CONT-1.
 16711
 16712     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16713       AND
 16714        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16715       AND
 16716        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16717       AND
 16718        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16719            NEXT SENTENCE
 16720       ELSE
 16721        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16722          AND
 16723***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16724***       AND
 16725           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16726            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16727               MOVE ER-2730      TO WS-ERROR
 16728               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16729               GO TO 3999-END-EDIT
 16730            ELSE
 16731               GO TO 3999-END-EDIT
 16732        ELSE
 16733            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16734               MOVE ER-2765           TO WS-ERROR
 16735               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16736               GO TO 3785-CHECK-NH.
 16737*              GO TO 3999-END-EDIT.
 16738
 16739 3780-UPDATE-CONT-1.
 16740     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16741
 16742     IF PB-CI-AH-BENEFIT-CD = ZERO
 16743         GO TO 3780-UPDATE-CONT-2.
 16744
 16745     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16746         GO TO 3780-UPDATE-CONT-2.
 16747
 16748     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16749
 16750     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16751       AND
 16752        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16753       AND
 16754        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16755       AND
 16756        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16757            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 304
* EL050.cbl
 16758       ELSE
 16759        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16760          AND
 16761***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16762***       AND
 16763           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16764           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16765            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16766               MOVE ER-2773      TO WS-ERROR
 16767               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16768               GO TO 3999-END-EDIT
 16769            ELSE
 16770               GO TO 3999-END-EDIT
 16771            END-IF
 16772           ELSE
 16773             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16774                MOVE ER-2890 TO WS-ERROR
 16775                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16776                GO TO 3999-END-EDIT
 16777             ELSE
 16778                GO TO 3785-CHECK-NH
 16779             END-IF
 16780           END-IF
 16781          ELSE
 16782            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16783              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16784                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16785                   MOVE ER-2890 TO WS-ERROR
 16786                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16787                   GO TO 3999-END-EDIT
 16788                ELSE
 16789                   MOVE ER-2765 TO WS-ERROR
 16790                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16791                   GO TO 3785-CHECK-NH
 16792                END-IF
 16793              ELSE
 16794               MOVE ER-2765      TO WS-ERROR
 16795               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16796               GO TO 3785-CHECK-NH.
 16797*              GO TO 3999-END-EDIT.
 16798
 16799 3780-UPDATE-CONT-2.
 16800
 16801     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16802        AND WS-LF-BENEFIT-CD = ZERO
 16803           MOVE ER-2743           TO WS-ERROR
 16804           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16805
 16806     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16807        AND WS-AH-BENEFIT-CD = ZERO
 16808           MOVE ER-2744           TO WS-ERROR
 16809           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16810
 16811     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16812        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16813        AND
 16814        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16815         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 305
* EL050.cbl
 16816           MOVE ER-2746           TO WS-ERROR
 16817           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16818
 16819     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16820       AND
 16821        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16822             MOVE ER-2737        TO WS-ERROR
 16823             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16824
 16825     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16826       AND
 16827        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16828             MOVE ER-2737        TO WS-ERROR
 16829             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16830
 16831     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16832         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16833             OR 'CID' OR 'DCC' OR 'AHL'
 16834             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16835         ELSE
 16836             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16837                 MOVE ER-2768    TO WS-ERROR
 16838                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16839             ELSE
 16840                 MOVE ER-2756    TO WS-ERROR
 16841                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16842
 16843     IF CERT-PEND-ISSUE-RETURNED
 16844        MOVE ER-2772             TO WS-ERROR
 16845        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16846 3785-CHECK-NH.
 16847     IF PB-STATE NOT = 'NH'
 16848        GO TO 3999-END-EDIT
 16849     END-IF
 16850
 16851     MOVE ER-2796                TO WS-ERROR
 16852     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16853     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16854        OR (CM-NH-INTERFACE-SW = 'Y')
 16855        MOVE ER-2793             TO WS-ERROR
 16856        PERFORM 9900-ERROR-FORMAT
 16857                                 THRU 9900-EXIT
 16858     END-IF
 16859     MOVE +0                     TO WS-PAYMENT-AMT
 16860     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16861        GO TO 3999-END-EDIT
 16862     END-IF
 16863     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16864        GO TO 3999-END-EDIT
 16865     END-IF
 16866     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16867     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16868     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16869        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16870     END-IF
 16871     MOVE '1'                    TO DC-OPTION-CODE
 16872     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16873     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 306
* EL050.cbl
 16874        IF DC-ELAPSED-DAYS < +16
 16875           GO TO 3999-END-EDIT
 16876        END-IF
 16877     END-IF
 16878     MOVE +0                     TO DC-ELAPSED-DAYS
 16879     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16880     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16881     MOVE '1'                    TO DC-OPTION-CODE
 16882     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16883     IF NO-CONVERSION-ERROR
 16884        IF DC-ELAPSED-DAYS > +30
 16885           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16886        ELSE
 16887           GO TO 3999-END-EDIT
 16888        END-IF
 16889     ELSE
 16890        GO TO 3999-END-EDIT
 16891     END-IF
 16892     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16893        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16894           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16895     IF WS-PAYMENT-AMT < 600.00
 16896        GO TO 3999-END-EDIT
 16897     END-IF
 16898     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16899
 16900     IF (ERMAIL-FOUND = ' ')
 16901         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16902         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16903        GO TO 3999-END-EDIT
 16904     END-IF
 16905     MOVE ER-2795                TO WS-ERROR
 16906     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16907
 16908     GO TO 3999-END-EDIT.
 16909******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 307
* EL050.cbl
 16911 3990-FILES-NOT-OPEN.
 16912
 16913     MOVE ER-2617                TO WS-ERROR.
 16914     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16915     GO TO 9990-RETURN.
 16916
 16917 3999-END-EDIT.
 16918
 16919     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16920
 16921     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16922         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16923         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16924             PERFORM 9250-UNLOCK-RETURN
 16925             GO TO 9990-RETURN
 16926          ELSE
 16927             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16928             GO TO 9990-RETURN.
 16929
 16930     IF PB-CANCELLATION
 16931          GO TO 9990-RETURN.
 16932
 16933     IF CERT-WAS-NOT-FOUND
 16934        MOVE SPACES              TO CERTIFICATE-MASTER.
 16935
 16936     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16937
 16938     IF CERT-WAS-FOUND
 16939         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16940             PERFORM 9250-UNLOCK-RETURN
 16941          ELSE
 16942            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16943      ELSE
 16944         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16945
 16946     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16947        IF PB-COMPANY-ID = 'DCC' AND
 16948           (PB-CARRIER = '2' OR '4' OR '6')
 16949              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16950        END-IF
 16951     END-IF.
 16952
 16953     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16954         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16955     END-IF.
 16956
 16957     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16958     IF ((PB-COMPANY-ID = 'DCC')
 16959        AND (WS-NO-SECURE-PAY))
 16960                  OR
 16961        (WS-LF-SPECIAL-CALC-CD = 'O'
 16962        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16963        SET SKIP-ADDR-EDIT       TO TRUE
 16964     END-IF
 16965     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16966        AND (NOT SKIP-ADDR-EDIT)
 16967        MOVE ER-2963             TO WS-ERROR
 16968        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 308
* EL050.cbl
 16969                                 THRU 9900-EXIT
 16970        GO TO 9990-RETURN
 16971     END-IF
 16972     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 16973     IF ERPNDM-FOUND NOT = 'X'
 16974        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16975           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16976           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16977           AND (NOT SKIP-ADDR-EDIT)
 16978           MOVE ER-2694          TO WS-ERROR
 16979           PERFORM 9900-ERROR-FORMAT
 16980                                 THRU 9900-EXIT
 16981        END-IF
 16982        MOVE ' '                 TO STATE-RECORD-ERROR
 16983        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16984        MOVE PM-STATE            TO CNTL-ACCESS
 16985        MOVE '3'                 TO CNTL-REC-TYPE
 16986        MOVE +0                  TO CNTL-SEQ-NO
 16987        MOVE '0'                 TO RC-SW-2
 16988        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16989        IF (NO-STATE-RECORD)
 16990           OR (CF-RECORD-TYPE NOT = '3')
 16991           OR (PM-STATE NOT = CF-STATE-CODE)
 16992           IF (PM-STATE = SPACES)
 16993              AND (SKIP-ADDR-EDIT)
 16994              CONTINUE
 16995           ELSE
 16996              MOVE ER-2963       TO WS-ERROR
 16997              PERFORM 9900-ERROR-FORMAT
 16998                                 THRU 9900-EXIT
 16999           END-IF
 17000        END-IF
 17001        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17002           MOVE ER-2883          TO WS-ERROR
 17003           PERFORM 9900-ERROR-FORMAT
 17004                                 THRU 9900-EXIT
 17005        END-IF
 17006        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17007           MOVE ' '                 TO STATE-RECORD-ERROR
 17008           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17009           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17010           MOVE '3'                 TO CNTL-REC-TYPE
 17011           MOVE +0                  TO CNTL-SEQ-NO
 17012           MOVE '0'                 TO RC-SW-2
 17013           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17014           IF NO-STATE-RECORD
 17015              OR (CF-RECORD-TYPE NOT = '3')
 17016              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17017              MOVE ER-2964          TO WS-ERROR
 17018              PERFORM 9900-ERROR-FORMAT
 17019                                    THRU 9900-EXIT
 17020           END-IF
 17021        END-IF
 17022     ELSE
 17023        IF NOT SKIP-ADDR-EDIT
 17024           MOVE ER-2393          TO WS-ERROR
 17025           PERFORM 9900-ERROR-FORMAT
 17026                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 309
* EL050.cbl
 17027        END-IF
 17028     END-IF
 17029
 17030     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17031
 17032     IF (ERMAIL-FOUND = ' ' AND
 17033        ERPNDM-FOUND = ' ')
 17034        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17035           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17036           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17037          OR
 17038           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17039          OR
 17040           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17041           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17042           GO TO 3999-UNLOCK-ERMAIL.
 17043
 17044     IF ERPNDM-FOUND = 'X'
 17045        GO TO 3999-UNLOCK-ERMAIL.
 17046
 17047     IF PM-INSURED-LAST-NAME      = SPACES
 17048        AND PM-INSURED-FIRST-NAME = SPACES
 17049        AND PM-ADDRESS-LINE-1     = SPACES
 17050        AND PM-ADDRESS-LINE-2     = SPACES
 17051        AND PM-CITY-STATE         = SPACES
 17052        AND PM-CRED-BENE-NAME     = SPACES
 17053        AND PM-CRED-BENE-ADDR     = SPACES
 17054        AND PM-CRED-BENE-CTYST    = SPACES
 17055        GO TO 3999-UNLOCK-ERMAIL
 17056     END-IF
 17057
 17058     MOVE SPACES                 TO MAILING-DATA.
 17059
 17060     MOVE 'MA'                   TO MA-RECORD-ID.
 17061     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17062     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17063     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17064     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17065     MOVE PB-SV-STATE            TO MA-STATE.
 17066     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17067     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17068
 17069     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17070     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17071
 17072     IF ERMAIL-FOUND = ' '
 17073        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17074     ELSE
 17075        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17076        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17077        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17078
 17079     GO TO 9990-RETURN.
 17080
 17081 3999-UNLOCK-ERMAIL.
 17082     IF ERMAIL-FOUND = ' '
 17083        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17084
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 310
* EL050.cbl
 17085     GO TO 9990-RETURN.
 17086******************************************************************
 17087
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 311
* EL050.cbl
 17089 4000-UPDATE-CANCELLED-CERT.
 17090     IF CERT-WAS-NOT-FOUND
 17091        GO TO 4299-EXIT.
 17092
 17093*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17094     IF PB-C-NH-INT-ON-REFS > ZEROS
 17095        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17096     END-IF
 17097     IF PB-C-REF-INTERFACE-SW = 'Y'
 17098        MOVE PB-C-REF-INTERFACE-SW
 17099                                 TO CM-NH-INTERFACE-SW
 17100     END-IF
 17101     IF PB-C-POST-CARD-IND = 'Y'
 17102        MOVE +8                  TO SUB
 17103        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17104        IF ERMAIL-FOUND = ' '
 17105           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17106              (SUB > +7)
 17107              OR (MA-MAIL-STATUS (SUB) = '1')
 17108           END-PERFORM
 17109        END-IF
 17110        IF (SUB > +7)
 17111           OR (ERMAIL-FOUND = 'X')
 17112           MOVE ER-3789          TO WS-ERROR
 17113           PERFORM 9900-ERROR-FORMAT
 17114                                 THRU 9900-EXIT
 17115        END-IF
 17116     ELSE
 17117        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17118     END-IF
 17119     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17120
 17121     IF PB-CI-OB-FLAG = 'Z'
 17122        GO TO 4150-SUMMARY-CERT-CANCEL.
 17123
 17124     IF PB-C-LF-CANCEL-VOIDED
 17125         PERFORM 4200-REVERSE-LF-CANCEL.
 17126     IF PB-C-AH-CANCEL-VOIDED
 17127         PERFORM 4200-REVERSE-AH-CANCEL.
 17128
 17129 4100-APPLY-LF-CANCEL.
 17130
 17131     MOVE +0                     TO WS-SUB.
 17132
 17133 4100-CHECK-LF-ERRORS.
 17134
 17135     ADD +1                       TO WS-SUB.
 17136
 17137     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17138        IF LF-COVERAGE-CANCELLED
 17139           GO TO 4100-LF-CANCEL-CONT
 17140        ELSE
 17141           GO TO 4100-UPDATE-LF-COVERAGE.
 17142
 17143     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17144                                   ER-2729 OR
 17145                                   ER-2730 OR
 17146                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 312
* EL050.cbl
 17147                                   ER-2732 OR
 17148                                   ER-2737 OR
 17149                                   ER-2740 OR
 17150                                   ER-2743 OR
 17151                                   ER-2749 OR
 17152                                   ER-2750 OR
 17153                                   ER-2755 OR
 17154                                   ER-2757 OR
 17155                                   ER-2760 OR
 17156                                   ER-2772 OR
 17157                                   ER-2774 OR
 17158                                   ER-2776 OR
 17159                                   ER-2794
 17160        GO TO 4100-UPDATE-LF-COVERAGE.
 17161
 17162     GO TO 4100-CHECK-LF-ERRORS.
 17163
 17164 4100-UPDATE-LF-COVERAGE.
 17165
 17166     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17167     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17168     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17169        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17170     END-IF
 17171     if pb-c-ah-cancel-voided
 17172        or pb-c-lf-cancel-voided
 17173        continue
 17174     else
 17175        MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17176                                 TO CM-CREDIT-INTERFACE-SW-2
 17177     end-if
 17178     IF CM-LF-CANCEL-DT = LOW-VALUE
 17179         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17180
 17181     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17182         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17183                                         CM-LF-STATUS-AT-CANCEL.
 17184
 17185     GO TO 4100-APPLY-AH-CANCEL.
 17186
 17187 4100-LF-CANCEL-CONT.
 17188     IF PB-C-LF-CANCEL-VOIDED
 17189         GO TO 4100-APPLY-AH-CANCEL.
 17190
 17191     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17192         GO TO 4100-APPLY-AH-CANCEL.
 17193
 17194     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17195        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17196           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17197        ELSE
 17198           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17199
 17200     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17201     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17202
 17203     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17204         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 313
* EL050.cbl
 17205
 17206     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17207        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17208         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17209         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17210
 17211     IF PB-RECORD-RETURNED
 17212        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17213      ELSE
 17214        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17215
 17216 4100-APPLY-AH-CANCEL.
 17217
 17218     MOVE +0                      TO WS-SUB.
 17219
 17220 4100-CHECK-AH-ERRORS.
 17221
 17222     ADD +1                       TO WS-SUB.
 17223
 17224     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17225        IF AH-COVERAGE-CANCELLED
 17226           GO TO 4100-AH-CANCEL-CONT
 17227        ELSE
 17228           GO TO 4100-UPDATE-AH-COVERAGE.
 17229
 17230     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17231                                   ER-2729 OR
 17232                                   ER-2732 OR
 17233                                   ER-2737 OR
 17234                                   ER-2740 OR
 17235                                   ER-2744 OR
 17236                                   ER-2749 OR
 17237                                   ER-2750 OR
 17238                                   ER-2755 OR
 17239                                   ER-2757 OR
 17240                                   ER-2760 OR
 17241                                   ER-2771 OR
 17242                                   ER-2772 OR
 17243                                   ER-2773 OR
 17244                                   ER-2775 OR
 17245                                   ER-2777 OR
 17246                                   ER-2794
 17247        GO TO 4100-UPDATE-AH-COVERAGE.
 17248
 17249     GO TO 4100-CHECK-AH-ERRORS.
 17250
 17251 4100-UPDATE-AH-COVERAGE.
 17252
 17253     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17254     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17255     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17256     if pb-c-ah-cancel-voided
 17257        or pb-c-lf-cancel-voided
 17258        continue
 17259     else
 17260        MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17261                                 TO CM-CREDIT-INTERFACE-SW-2
 17262     end-if
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 314
* EL050.cbl
 17263     IF CM-AH-CANCEL-DT = LOW-VALUE
 17264         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17265
 17266     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17267         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17268                                         CM-AH-STATUS-AT-CANCEL.
 17269
 17270     IF ah-COVERAGE-CANCELLED
 17271         IF PB-RECORD-RETURNED
 17272              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17273          ELSE
 17274              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17275
 17276     GO TO 4299-EXIT.
 17277
 17278 4100-AH-CANCEL-CONT.
 17279     IF PB-C-AH-CANCEL-VOIDED
 17280         GO TO 4299-EXIT.
 17281     if cm-credit-interface-sw-2 = ' '
 17282        if pb-fatal-errors or pb-unforced-errors
 17283           move '4'              to cm-credit-interface-sw-2
 17284        else
 17285           move '1'              to cm-credit-interface-sw-2
 17286        end-if
 17287     end-if
 17288     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17289         GO TO 4299-EXIT.
 17290
 17291     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17292        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17293           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17294        ELSE
 17295           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17296
 17297     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17298     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17299
 17300     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17301         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17302
 17303     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17304         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17305         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17306
 17307     IF PB-RECORD-RETURNED
 17308        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17309      ELSE
 17310        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17311
 17312     GO TO 4299-EXIT.
 17313
 17314 4150-SUMMARY-CERT-CANCEL.
 17315     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17316
 17317     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17318        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17319                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17320     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 315
* EL050.cbl
 17321        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17322                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17323
 17324     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17325        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17326                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17327     ELSE
 17328        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17329                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17330
 17331     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17332        NEXT SENTENCE
 17333     ELSE
 17334        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17335
 17336     GO TO 4299-EXIT.
 17337
 17338 4200-REVERSE-LF-CANCEL.
 17339     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17340
 17341     IF CM-LF-CANCEL-APPLIED
 17342        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17343        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17344        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17345
 17346     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17347
 17348     IF PB-RECORD-RETURNED
 17349        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17350       ELSE
 17351        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17352
 17353 4200-REVERSE-LF-EXIT.
 17354       EXIT.
 17355
 17356 4200-REVERSE-AH-CANCEL.
 17357     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17358
 17359     IF CM-AH-CANCEL-APPLIED
 17360        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17361        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17362        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17363
 17364     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17365
 17366     IF PB-RECORD-RETURNED
 17367        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17368       ELSE
 17369        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17370
 17371 4200-REVERSE-AH-EXIT.
 17372       EXIT.
 17373
 17374 4299-EXIT.
 17375       EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 316
* EL050.cbl
 17377
 17378 4500-UPDATE-NEW-CERT.
 17379     IF CERT-WAS-FOUND
 17380         NEXT SENTENCE
 17381       ELSE
 17382         GO TO 4520-BUILD-NEW-KEY.
 17383
 17384     IF  CLASIC-CREATED-CERT
 17385         GO TO 4999-EXIT.
 17386
 17387     IF  CERT-WAS-CREATED-FOR-CLAIM
 17388         GO TO 4520-BUILD-NEW-KEY.
 17389
 17390     IF CERT-ADDED-BATCH
 17391        IF CM-RECORD-ID = 'CM'
 17392            GO TO 4999-EXIT.
 17393
 17394 4520-BUILD-NEW-KEY.
 17395* BUILD CONTROL PRIMARY
 17396
 17397     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17398                                       CM-COMPANY-CD-A1
 17399                                       CM-COMPANY-CD-A2
 17400                                       CM-COMPANY-CD-A4
 17401                                       CM-COMPANY-CD-A5.
 17402
 17403     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17404     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17405     MOVE PB-SV-STATE               TO CM-STATE.
 17406     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17407     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17408     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17409     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17410
 17411     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17412
 17413     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17414     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17415     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17416     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17417
 17418     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17419        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17420
 17421     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17422         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17423         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17424         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17425         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17426     ELSE
 17427         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17428
 17429     IF PB-COMPANY-ID   EQUAL  'CRI'
 17430         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17431         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17432         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17433         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17434         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 317
* EL050.cbl
 17435
 17436     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17437        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17438         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17439
 17440     IF PB-COMPANY-ID  = 'LBL'
 17441        IF PB-I-JOINT-COVERAGE
 17442            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17443                                           PB-I-MEMBER-NO
 17444            GO TO 4550-CONT-CERT-PROCESS.
 17445
 17446     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17447        NEXT SENTENCE
 17448     ELSE
 17449        GO TO 4540-BUILD-MEMBER-NO.
 17450
 17451******************************************************************
 17452*                                                                *
 17453*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17454*    FOR 'MON'.                                                  *
 17455*                                                                *
 17456******************************************************************
 17457
 17458     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17459     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17460     MOVE +1                     TO WS-SUB1
 17461                                    WS-SUB2.
 17462
 17463 4530-EDIT-MEMB-NAME.
 17464
 17465     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17466        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17467        ADD +1                       TO WS-SUB2.
 17468
 17469     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17470        ADD +1                       TO WS-SUB1
 17471        GO TO 4530-EDIT-MEMB-NAME.
 17472
 17473     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17474     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17475     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17476*    MOVE SPACE                      TO DC-OPTION-CODE.
 17477     SET  BIN-TO-GREG                TO TRUE.
 17478     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17479     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17480
 17481     GO TO 4550-CONT-CERT-PROCESS.
 17482
 17483******************************************************************
 17484*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17485******************************************************************
 17486
 17487 4540-BUILD-MEMBER-NO.
 17488
 17489     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17490         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17491         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17492         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 318
* EL050.cbl
 17493         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17494     ELSE
 17495         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17496
 17497     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17498        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17499         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17500
 17501 4550-CONT-CERT-PROCESS.
 17502
 17503*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17504*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17505*    ELSE
 17506*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17507
 17508     IF CERT-WAS-CREATED-FOR-CLAIM
 17509        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17510        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17511
 17512     IF CERT-AND-CLAIM-ONLINE
 17513        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17514        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17515
 17516     MOVE 'CM'                     TO CM-RECORD-ID.
 17517     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17518
 17519     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17520        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17521        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17522     ELSE
 17523        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17524        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17525
 17526     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17527     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17528     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17529     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17530     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17531     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17532     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17533                                      CM-LF-ITD-CANCEL-AMT
 17534                                      CM-LF-ITD-DEATH-AMT
 17535                                      CM-AH-ITD-AH-PMT
 17536                                      CM-AH-ITD-LUMP-PMT
 17537                                      CM-AH-ITD-CANCEL-AMT
 17538                                      CM-LF-NSP-PREMIUM-AMT
 17539                                      CM-AH-NSP-PREMIUM-AMT.
 17540*                                     CM-CLAIM-DEDUCT-WITHHELD
 17541*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17542     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17543     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17544     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17545     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17546     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17547     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17548     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17549     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17550     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 319
* EL050.cbl
 17551     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17552     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17553     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17554
 17555     IF PB-I-LIVES NOT NUMERIC
 17556         MOVE ZERO                 TO PB-I-LIVES.
 17557
 17558     IF PB-I-NUM-BILLED NOT NUMERIC
 17559         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17560
 17561     MOVE PB-I-LIVES               TO CM-LIVES.
 17562     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17563
 17564     IF PB-COMPANY-ID EQUAL  'DMD'
 17565         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17566         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17567
 17568     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17569     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17570     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17571     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17572     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17573     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17574
 17575     IF PB-I-LF-POLICY-FEE NUMERIC
 17576        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17577     ELSE
 17578        MOVE +0                    TO CM-LF-POLICY-FEE.
 17579
 17580     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17581        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17582        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17583     ELSE
 17584        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17585
 17586     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17587     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17588     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17589     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17590     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17591     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17592     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17593     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17594     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17595
 17596     IF PB-I-AH-POLICY-FEE NUMERIC
 17597        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17598     ELSE
 17599        MOVE +0                    TO CM-AH-POLICY-FEE.
 17600
 17601     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17602        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17603     ELSE
 17604        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17605
 17606     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17607     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17608
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 320
* EL050.cbl
 17609     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17610                                      CM-LF-DEATH-EXIT-DT
 17611                                      CM-AH-SETTLEMENT-EXIT-DT.
 17612
 17613*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17614*                       'TIH' OR 'OFL' OR 'FLA' OR
 17615*                       'TII' OR 'TMS' OR 'CRI' OR
 17616*                       'NCL'
 17617     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17618
 17619     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17620         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17621            MOVE '2'                TO CM-PREMIUM-TYPE.
 17622
 17623     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17624         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17625            MOVE '2'                TO CM-PREMIUM-TYPE.
 17626
 17627     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17628         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17629     ELSE
 17630         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17631         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17632
 17633     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17634     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17635     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17636     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17637     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17638     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17639     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17640     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17641
 17642     IF PB-NO-MONTHS-SKIPPED
 17643         MOVE SPACE                 TO CM-SKIP-CODE
 17644     ELSE
 17645         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17646
 17647     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17648     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17649                                       CM-LF-STATUS-AT-CANCEL.
 17650
 17651     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17652     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17653                                       CM-AH-STATUS-AT-CANCEL.
 17654
 17655     MOVE '1'                       TO CM-ENTRY-STATUS.
 17656
 17657     IF PB-REISSUED-CERT
 17658        MOVE '5'                    TO CM-ENTRY-STATUS.
 17659
 17660     IF PB-MONTHLY-CERT
 17661        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17662
 17663     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17664     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17665     IF PB-POLICY-IS-DECLINED
 17666        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 321
* EL050.cbl
 17667
 17668     IF PB-POLICY-IS-VOIDED
 17669        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17670
 17671     IF PB-NEEDS-UNDERWRITING
 17672        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17673
 17674     IF PB-REIN-ONLY-CERT
 17675        MOVE '9'                    TO CM-ENTRY-STATUS.
 17676
 17677     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17678         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17679     ELSE
 17680         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17681
 17682     IF PB-RECORD-RETURNED
 17683        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17684      ELSE
 17685        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17686
 17687     IF PB-I-MAIL-ADDRS-PRESENT
 17688        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17689
 17690     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17691                                       CM-ENTRY-DT.
 17692
 17693 4999-EXIT.
 17694     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 322
* EL050.cbl
 17696
 17697 5000-PROCESS-REPS.
 17698     MOVE ' '                    TO AGTC-MASTER-SW
 17699     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17700     MOVE CO-TYPE                TO AGTC-TYPE
 17701     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17702     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17703     IF (AGTC-MASTER-SW NOT = 'N')
 17704        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17705        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17706        PERFORM 8583-READ-ERAGTC-NEXT
 17707                                 THRU 8583-EXIT
 17708     END-IF
 17709     IF AGTC-MASTER-SW = 'N'
 17710        CONTINUE
 17711     ELSE
 17712        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17713           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17714              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17715              MOVE 'Y'           TO AGTC-MASTER-SW
 17716           END-IF
 17717        END-IF
 17718     END-IF
 17719     .
 17720 5000-EXIT.
 17721     EXIT.
 17722 6370-EDIT-INPUT-LF-CODE.
 17723     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17724        MOVE +1                  TO SUB
 17725        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17726        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17727        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17728        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17729        GO TO 6370-SEARCH-LOOP.
 17730
 17731     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17732
 17733     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17734     MOVE SPACES                 TO CNTL-ACCESS.
 17735*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17736     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17737     MOVE +0                     TO CNTL-SEQ-NO.
 17738     MOVE '4' TO RC-SW-2.
 17739     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17740
 17741     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17742        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17743        GO TO 6370-NO-LF-FOUND.
 17744
 17745     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17746     MOVE +1                     TO SUB.
 17747
 17748 6370-SEARCH-LOOP.
 17749     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17750         GO TO 6370-NO-LF-FOUND.
 17751
 17752     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17753         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 323
* EL050.cbl
 17754         GO TO 6370-HER-NET-PAY-CHECK.
 17755
 17756     ADD 1   TO SUB.
 17757*    IF SUB GREATER 120
 17758     IF SUB GREATER 200
 17759         GO TO 6370-NO-LF-FOUND.
 17760
 17761     GO TO 6370-SEARCH-LOOP.
 17762
 17763 6370-NO-LF-FOUND.
 17764
 17765     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17766
 17767 6370-HER-NET-PAY-CHECK.
 17768
 17769     IF PB-COMPANY-ID = 'CID'
 17770        IF PB-SV-STATE = 'CA' OR 'MN'
 17771           IF PB-I-LF-BENEFIT-CD = '02'
 17772              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17773           ELSE
 17774              IF PB-I-LF-BENEFIT-CD = '04'
 17775                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17776              END-IF
 17777           END-IF
 17778        END-IF
 17779     END-IF
 17780
 17781     IF PB-COMPANY-ID NOT = 'HER'
 17782         GO TO 6370-EXIT.
 17783
 17784     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17785         GO TO 6370-EXIT.
 17786
 17787     IF PB-I-LF-TERM NOT NUMERIC
 17788         MOVE ZEROS              TO PB-I-LF-TERM.
 17789
 17790     IF PB-I-LOAN-TERM NOT NUMERIC
 17791         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17792
 17793     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17794         GO TO 6370-EXIT.
 17795
 17796     IF PB-I-LF-BENEFIT-CD = '33'
 17797         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17798
 17799     IF PB-I-LF-BENEFIT-CD = '34'
 17800         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17801
 17802 6370-EXIT.
 17803     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 324
* EL050.cbl
 17805
 17806 6380-EDIT-INPUT-AH-CODE.
 17807     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17808        MOVE +1                  TO SUB
 17809        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17810        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17811        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17812        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17813        GO TO 6380-SEARCH-LOOP.
 17814
 17815     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17816
 17817     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17818     MOVE SPACES                 TO CNTL-ACCESS.
 17819     MOVE 'A'                    TO CNTL-REC-TYPE.
 17820*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17821     MOVE +0                     TO CNTL-SEQ-NO.
 17822     MOVE '5' TO RC-SW-2.
 17823     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17824
 17825     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17826        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17827        GO TO 6380-NO-AH-FOUND.
 17828
 17829     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17830     MOVE +1 TO SUB.
 17831
 17832 6380-SEARCH-LOOP.
 17833     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17834         GO TO 6380-NO-AH-FOUND.
 17835
 17836     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17837         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17838         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17839
 17840     ADD 1   TO SUB.
 17841     IF SUB GREATER THAN 96
 17842*    IF SUB GREATER THAN 300
 17843         GO TO 6380-NO-AH-FOUND.
 17844
 17845     GO TO 6380-SEARCH-LOOP.
 17846
 17847 6380-NO-AH-FOUND.
 17848
 17849     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17850
 17851     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17852         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17853     ELSE
 17854         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17855
 17856 6380-CSO-AH-ONLY-CHECKS.
 17857
 17858     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17859        NEXT SENTENCE
 17860      ELSE
 17861        GO TO 6380-EXIT.
 17862
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 325
* EL050.cbl
 17863     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17864         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17865
 17866
 17867     GO TO 6380-EXIT
 17868     .
 17869 6380-CSO-LIFE-WITH-AH-CHECKS.
 17870
 17871
 17872     .
 17873 6380-EXIT.
 17874     EXIT.
 17875
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 326
* EL050.cbl
 17877
 17878 6400-COMPUTE-EXTENSION-DAYS.
 17879
 17880******************************************************************
 17881*                                                                *
 17882*                   COMPUTE EXTENSION DAYS                       *
 17883*                                                                *
 17884*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17885*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17886*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17887*    THE EXTENSION DAYS.                                         *
 17888*                                                                *
 17889******************************************************************
 17890
 17891     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17892     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17893
 17894******************************************************************
 17895*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17896*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17897******************************************************************
 17898
 17899     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17900        COMPUTE WS-ODD-DAYS-OVER =
 17901               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17902     ELSE
 17903        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17904
 17905     IF WS-ODD-DAYS-OVER = ZEROS
 17906           GO TO 6499-EXIT
 17907     ELSE
 17908        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17909           IF WS-WDF-MONTH = 02
 17910              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17911              ADD 2       TO  WS-ODD-DAYS-OVER
 17912              GO TO 6499-EXIT
 17913           ELSE
 17914              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17915                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17916                 GO TO 6499-EXIT
 17917               ELSE
 17918                 GO TO 6499-EXIT
 17919        ELSE
 17920           GO TO 6499-EXIT.
 17921
 17922 6412-CHECK-TO-DAY.
 17923
 17924        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17925           IF WS-WDT-DAY = 28
 17926              ADD 2              TO WS-ODD-DAYS-OVER
 17927           ELSE
 17928              IF WS-WDT-DAY = 29
 17929                 ADD 1           TO WS-ODD-DAYS-OVER
 17930              ELSE
 17931                 NEXT SENTENCE
 17932        ELSE
 17933           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17934              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 327
* EL050.cbl
 17935
 17936     GO TO 6499-EXIT.
 17937
 17938
 17939 6415-CHECK-LEAP-YEAR.
 17940
 17941     IF DC-DAYS-IN-MONTH = 29
 17942        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17943
 17944 6415-EXIT.
 17945     EXIT.
 17946
 17947 6499-EXIT.
 17948      EXIT.
 17949
 17950 6500-END.
 17951     EXIT.
 17952
 17953
 17954******************************************************************
 17955************* PROCEDURE DIVISION FOR EL050 ***********************
 17956********************** ELC50PD END *******************************
 17957
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 328
* EL050.cbl
 17959
 17960**START***********************************************************
 17961*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17962*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17963******************************************************************
 17964*
 17965 6600-GET-STATE-MUNICIPAL-TAX.
 17966
 17967     IF PB-COMPANY-ID NOT = 'DMD'
 17968         GO TO 6640-EXIT.
 17969
 17970     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17971     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17972     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17973*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17974*
 17975***  Y2K PROJ 7744
 17976     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17977     SET BIN-TO-GREG          TO TRUE.
 17978     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17979
 17980     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17981
 17982     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17983     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17984
 17985
 17986* EXEC CICS HANDLE CONDITION
 17987*        INVREQ    (6610-START-BROWSE)
 17988*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17989*        NOTFND    (6630-END-OF-FILE)
 17990*    END-EXEC.
 17991*    MOVE '"$8JI                 ! # #00017973' TO DFHEIV0
 17992     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17994     MOVE X'2320233030303137393733' TO DFHEIV0(25:11)
 17995     CALL 'kxdfhei1' USING DFHEIV0
 17996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17997
 17998
 17999 6610-START-BROWSE.
 18000
 18001
 18002* EXEC CICS HANDLE CONDITION
 18003*        NOTFND    (6630-END-OF-FILE)
 18004*        DISABLED  (6630-ERRESS-PROBLEM)
 18005*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18006*        ENDFILE   (6630-END-OF-FILE)
 18007*    END-EXEC.
 18008*    MOVE '"$IcJ''                ! $ #00017981' TO DFHEIV0
 18009     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18010     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18011     MOVE X'2420233030303137393831' TO DFHEIV0(25:11)
 18012     CALL 'kxdfhei1' USING DFHEIV0
 18013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18014
 18015
 18016
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 329
* EL050.cbl
 18017* EXEC CICS STARTBR
 18018*        DATASET (FILE-ID-ERRESS)
 18019*        RIDFLD  (WS-ERRESS-KEY)
 18020*        GTEQ
 18021*    END-EXEC.
 18022     MOVE 0
 18023       TO DFHEIV11
 18024*    MOVE '&,         G          &   #00017988' TO DFHEIV0
 18025     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18026     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18027     MOVE X'2020233030303137393838' TO DFHEIV0(25:11)
 18028     CALL 'kxdfhei1' USING DFHEIV0,
 18029           FILE-ID-ERRESS,
 18030           WS-ERRESS-KEY,
 18031           DFHEIV99,
 18032           DFHEIV11,
 18033           DFHEIV99
 18034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18035
 18036
 18037 6620-READ-NEXT-ERRESS-MASTER.
 18038
 18039
 18040* EXEC CICS HANDLE CONDITION
 18041*        NOTFND    (6630-END-OF-FILE)
 18042*        ENDFILE   (6630-END-OF-FILE)
 18043*        DISABLED  (6630-ERRESS-PROBLEM)
 18044*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18045*    END-EXEC.
 18046*    MOVE '"$I''cJ                ! % #00017996' TO DFHEIV0
 18047     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18049     MOVE X'2520233030303137393936' TO DFHEIV0(25:11)
 18050     CALL 'kxdfhei1' USING DFHEIV0
 18051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18052
 18053
 18054
 18055* EXEC CICS READNEXT
 18056*        DATASET (FILE-ID-ERRESS)
 18057*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18058*        RIDFLD  (WS-ERRESS-KEY)
 18059*    END-EXEC.
 18060     MOVE LENGTH OF
 18061      RESIDENT-STATE-TAX-MASTER
 18062       TO DFHEIV12
 18063     MOVE 0
 18064       TO DFHEIV11
 18065*    MOVE '&.IL                  )   #00018003' TO DFHEIV0
 18066     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18067     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18068     MOVE X'2020233030303138303033' TO DFHEIV0(25:11)
 18069     CALL 'kxdfhei1' USING DFHEIV0,
 18070           FILE-ID-ERRESS,
 18071           RESIDENT-STATE-TAX-MASTER,
 18072           DFHEIV12,
 18073           WS-ERRESS-KEY,
 18074           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 330
* EL050.cbl
 18075           DFHEIV11,
 18076           DFHEIV99,
 18077           DFHEIV99
 18078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18079
 18080
 18081     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18082
 18083* EXEC CICS ENDBR
 18084*            DATASET (FILE-ID-ERRESS)
 18085*       END-EXEC
 18086     MOVE 0
 18087       TO DFHEIV11
 18088*    MOVE '&2                    $   #00018010' TO DFHEIV0
 18089     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18090     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18091     MOVE X'2020233030303138303130' TO DFHEIV0(25:11)
 18092     CALL 'kxdfhei1' USING DFHEIV0,
 18093           FILE-ID-ERRESS,
 18094           DFHEIV11,
 18095           DFHEIV99
 18096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18097        GO TO 6630-END-OF-FILE.
 18098
 18099     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18100        NEXT SENTENCE
 18101      ELSE
 18102        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18103
 18104*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18105*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18106*
 18107     MOVE +2                     TO WS-SUB1.
 18108
 18109     IF PB-ISSUE
 18110     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18111        MOVE +1                  TO WS-SUB1.
 18112
 18113     IF PB-CANCELLATION
 18114     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18115        MOVE +1                  TO WS-SUB1.
 18116*
 18117*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18118*
 18119***  Y2K PROJ 7744
 18120     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18121***  Y2K PROJ 7744
 18122
 18123*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18124* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18125* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18126
 18127     ADD 1                    TO WS-YEAR-YY.
 18128
 18129     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18130         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18131                              TO WS-RES-STATE-TAX
 18132         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 331
* EL050.cbl
 18133                              TO WS-RES-MUNI-TAX
 18134     ELSE
 18135         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18136                              TO WS-RES-STATE-TAX
 18137         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18138                              TO WS-RES-MUNI-TAX.
 18139
 18140*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18141
 18142     IF PB-CANCELLATION
 18143         GO TO 6640-CANCEL-TAX.
 18144
 18145     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18146         COMPUTE PB-I-STATE-TAX ROUNDED =
 18147                                   PB-I-LF-PREMIUM-AMT
 18148                                 * WS-RES-STATE-TAX
 18149         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18150                                   PB-I-LF-PREMIUM-AMT
 18151                                 * WS-RES-MUNI-TAX
 18152     ELSE
 18153     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18154         COMPUTE PB-I-STATE-TAX ROUNDED =
 18155                                   PB-I-AH-PREMIUM-AMT
 18156                                 * WS-RES-STATE-TAX
 18157         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18158                                   PB-I-AH-PREMIUM-AMT
 18159                                 * WS-RES-MUNI-TAX.
 18160
 18161
 18162* EXEC CICS ENDBR
 18163*         DATASET (FILE-ID-ERRESS)
 18164*    END-EXEC.
 18165     MOVE 0
 18166       TO DFHEIV11
 18167*    MOVE '&2                    $   #00018077' TO DFHEIV0
 18168     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18169     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18170     MOVE X'2020233030303138303737' TO DFHEIV0(25:11)
 18171     CALL 'kxdfhei1' USING DFHEIV0,
 18172           FILE-ID-ERRESS,
 18173           DFHEIV11,
 18174           DFHEIV99
 18175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18176
 18177
 18178     GO TO 6640-EXIT.
 18179
 18180 6640-CANCEL-TAX.
 18181     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18182
 18183     IF PB-C-LF-CANCEL-AMT > ZEROS
 18184         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18185                                   PB-C-LF-CANCEL-AMT
 18186                                 * WS-RES-STATE-TAX
 18187         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18188                                   PB-C-LF-CANCEL-AMT
 18189                                *  WS-RES-MUNI-TAX
 18190     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 332
* EL050.cbl
 18191     IF PB-C-AH-CANCEL-AMT > ZEROS
 18192         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18193                                   PB-C-AH-CANCEL-AMT
 18194                                 * WS-RES-STATE-TAX
 18195         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18196                                   PB-C-AH-CANCEL-AMT
 18197                                *  WS-RES-MUNI-TAX.
 18198
 18199
 18200* EXEC CICS ENDBR
 18201*         DATASET (FILE-ID-ERRESS)
 18202*    END-EXEC.
 18203     MOVE 0
 18204       TO DFHEIV11
 18205*    MOVE '&2                    $   #00018102' TO DFHEIV0
 18206     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18207     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18208     MOVE X'2020233030303138313032' TO DFHEIV0(25:11)
 18209     CALL 'kxdfhei1' USING DFHEIV0,
 18210           FILE-ID-ERRESS,
 18211           DFHEIV11,
 18212           DFHEIV99
 18213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18214
 18215
 18216     GO TO 6640-EXIT.
 18217
 18218 6630-END-OF-FILE.
 18219     MOVE ER-8002              TO WS-ERROR.
 18220     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18221
 18222     GO TO 6640-EXIT.
 18223
 18224 6630-ERRESS-PROBLEM.
 18225     MOVE ER-8044              TO WS-ERROR.
 18226     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18227
 18228 6640-EXIT.
 18229     EXIT.
 18230
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 333
* EL050.cbl
 18232 6650-GET-RES-STATE-COMM.
 18233
 18234     IF PB-COMPANY-ID NOT = 'DMD'
 18235         GO TO 6700-COMM-EXIT.
 18236
 18237     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18238     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18239     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18240     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18241     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18242     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18243     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18244
 18245*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18246*
 18247***  Y2K PROJ 7744
 18248     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18249     SET BIN-TO-GREG          TO TRUE.
 18250     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18251
 18252     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18253***  Y2K PROJ 7744
 18254
 18255     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18256
 18257
 18258* EXEC CICS HANDLE CONDITION
 18259*        INVREQ    (6660-START-BROWSE)
 18260*        DISABLED  (6690-ERRESC-PROBLEM)
 18261*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18262*        NOTFND    (6690-END-OF-FILE)
 18263*    END-EXEC.
 18264*    MOVE '"$8cJI                ! & #00018147' TO DFHEIV0
 18265     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18267     MOVE X'2620233030303138313437' TO DFHEIV0(25:11)
 18268     CALL 'kxdfhei1' USING DFHEIV0
 18269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18270
 18271
 18272
 18273* EXEC CICS RESETBR
 18274*        DATASET (FILE-ID-ERRESC)
 18275*        RIDFLD  (WS-ERRESC-KEY)
 18276*    END-EXEC.
 18277     MOVE 0
 18278       TO DFHEIV11
 18279*    MOVE '&4         G          &   #00018154' TO DFHEIV0
 18280     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18281     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18282     MOVE X'2020233030303138313534' TO DFHEIV0(25:11)
 18283     CALL 'kxdfhei1' USING DFHEIV0,
 18284           FILE-ID-ERRESC,
 18285           WS-ERRESC-KEY,
 18286           DFHEIV99,
 18287           DFHEIV11,
 18288           DFHEIV99
 18289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 334
* EL050.cbl
 18290
 18291
 18292 6660-START-BROWSE.
 18293
 18294
 18295* EXEC CICS HANDLE CONDITION
 18296*        NOTFND    (6690-END-OF-FILE)
 18297*        DISABLED  (6690-ERRESC-PROBLEM)
 18298*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18299*        ENDFILE   (6690-END-OF-FILE)
 18300*    END-EXEC.
 18301*    MOVE '"$IcJ''                ! '' #00018161' TO DFHEIV0
 18302     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18304     MOVE X'2720233030303138313631' TO DFHEIV0(25:11)
 18305     CALL 'kxdfhei1' USING DFHEIV0
 18306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18307
 18308
 18309
 18310* EXEC CICS STARTBR
 18311*        DATASET (FILE-ID-ERRESC)
 18312*        RIDFLD  (WS-ERRESC-KEY)
 18313*        GTEQ
 18314*    END-EXEC.
 18315     MOVE 0
 18316       TO DFHEIV11
 18317*    MOVE '&,         G          &   #00018168' TO DFHEIV0
 18318     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18319     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18320     MOVE X'2020233030303138313638' TO DFHEIV0(25:11)
 18321     CALL 'kxdfhei1' USING DFHEIV0,
 18322           FILE-ID-ERRESC,
 18323           WS-ERRESC-KEY,
 18324           DFHEIV99,
 18325           DFHEIV11,
 18326           DFHEIV99
 18327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18328
 18329
 18330     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18331
 18332 6670-READ-NEXT-ERRESC-MASTER.
 18333
 18334
 18335* EXEC CICS HANDLE CONDITION
 18336*        NOTFND    (6690-END-OF-FILE)
 18337*        DISABLED  (6690-ERRESC-PROBLEM)
 18338*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18339*        ENDFILE   (6690-END-OF-FILE)
 18340*    END-EXEC.
 18341*    MOVE '"$IcJ''                ! ( #00018178' TO DFHEIV0
 18342     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18343     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18344     MOVE X'2820233030303138313738' TO DFHEIV0(25:11)
 18345     CALL 'kxdfhei1' USING DFHEIV0
 18346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18347
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 335
* EL050.cbl
 18348
 18349
 18350* EXEC CICS READNEXT
 18351*        DATASET (FILE-ID-ERRESC)
 18352*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18353*        RIDFLD  (ERRESC-RECORD-KEY)
 18354*    END-EXEC.
 18355     MOVE LENGTH OF
 18356      ACCOUNT-RESIDENT-ST-COMMISSION
 18357       TO DFHEIV12
 18358     MOVE 0
 18359       TO DFHEIV11
 18360*    MOVE '&.IL                  )   #00018185' TO DFHEIV0
 18361     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18362     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18363     MOVE X'2020233030303138313835' TO DFHEIV0(25:11)
 18364     CALL 'kxdfhei1' USING DFHEIV0,
 18365           FILE-ID-ERRESC,
 18366           ACCOUNT-RESIDENT-ST-COMMISSION,
 18367           DFHEIV12,
 18368           ERRESC-RECORD-KEY,
 18369           DFHEIV99,
 18370           DFHEIV11,
 18371           DFHEIV99,
 18372           DFHEIV99
 18373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18374
 18375
 18376     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18377        NEXT SENTENCE
 18378     ELSE
 18379
 18380* EXEC CICS ENDBR
 18381*            DATASET (FILE-ID-ERRESC)
 18382*       END-EXEC
 18383     MOVE 0
 18384       TO DFHEIV11
 18385*    MOVE '&2                    $   #00018194' TO DFHEIV0
 18386     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18387     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18388     MOVE X'2020233030303138313934' TO DFHEIV0(25:11)
 18389     CALL 'kxdfhei1' USING DFHEIV0,
 18390           FILE-ID-ERRESC,
 18391           DFHEIV11,
 18392           DFHEIV99
 18393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18394        GO TO 6690-END-OF-FILE.
 18395
 18396     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18397
 18398* EXEC CICS ENDBR
 18399*            DATASET (FILE-ID-ERRESC)
 18400*       END-EXEC
 18401     MOVE 0
 18402       TO DFHEIV11
 18403*    MOVE '&2                    $   #00018200' TO DFHEIV0
 18404     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18405     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 336
* EL050.cbl
 18406     MOVE X'2020233030303138323030' TO DFHEIV0(25:11)
 18407     CALL 'kxdfhei1' USING DFHEIV0,
 18408           FILE-ID-ERRESC,
 18409           DFHEIV11,
 18410           DFHEIV99
 18411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18412        GO TO 6690-END-OF-FILE.
 18413
 18414     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18415        NEXT SENTENCE
 18416      ELSE
 18417        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18418
 18419* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18420*
 18421     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18422
 18423     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18424
 18425     IF WS-SUB1 > ZERO
 18426         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18427             PERFORM 6680-SET-COMMISSION
 18428         ELSE
 18429             PERFORM 6680-SET-TABLE-CODE.
 18430
 18431
 18432* EXEC CICS ENDBR
 18433*         DATASET (FILE-ID-ERRESC)
 18434*    END-EXEC.
 18435     MOVE 0
 18436       TO DFHEIV11
 18437*    MOVE '&2                    $   #00018222' TO DFHEIV0
 18438     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18439     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18440     MOVE X'2020233030303138323232' TO DFHEIV0(25:11)
 18441     CALL 'kxdfhei1' USING DFHEIV0,
 18442           FILE-ID-ERRESC,
 18443           DFHEIV11,
 18444           DFHEIV99
 18445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18446
 18447
 18448     GO TO 6700-COMM-EXIT.
 18449
 18450 6680-SET-TABLE-CODE.
 18451     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18452        MOVE ZEROS             TO WS-SUB1
 18453     ELSE
 18454* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18455* TO COMPUTE AH COMMISSION.
 18456        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18457        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18458        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18459        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18460        PERFORM 6680-READ-CTBL-TABLE
 18461        IF WS-CTBL-READ-SW NOT = 'Y'
 18462           MOVE ZEROS          TO WS-SUB1.
 18463
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 337
* EL050.cbl
 18464 6680-READ-CTBL-TABLE.
 18465*
 18466* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18467* TO COMPUTE LIFE COMMISSION
 18468
 18469     IF CTBL-SW = '0540'
 18470        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18471        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18472        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18473
 18474     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18475
 18476     IF CTBL-TABLE-FOUND
 18477        IF CTBL-SW = '0530'
 18478             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18479                                    * PB-I-AH-TERM
 18480             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18481             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18482        ELSE
 18483             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18484             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18485             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18486     ELSE
 18487        IF FIRST-TIME-THROUGH
 18488            GO TO 6680-READ-CTBL-TABLE
 18489        ELSE
 18490            MOVE ZEROS         TO WS-SUB1.
 18491
 18492 6680-SET-COMMISSION.
 18493     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18494           MOVE ZEROS          TO WS-SUB1
 18495       ELSE
 18496           MOVE RESC-COMMISSION-PER (WS-SUB)
 18497                               TO WS-COMMISSION
 18498           IF CTBL-SW = '0530'
 18499               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18500           ELSE
 18501               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18502
 18503 6680-SEARCH-CATEGORY.
 18504     ADD +1                   TO WS-SUB.
 18505     IF WS-SUB > +12
 18506         GO TO 6680-EXIT.
 18507
 18508     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18509          MOVE WS-SUB         TO WS-SUB1
 18510          GO TO 6680-EXIT.
 18511
 18512     GO TO 6680-SEARCH-CATEGORY.
 18513
 18514 6680-EXIT.
 18515     EXIT.
 18516
 18517 6690-END-OF-FILE.
 18518     GO TO 6700-COMM-EXIT.
 18519
 18520 6690-ERRESC-PROBLEM.
 18521      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 338
* EL050.cbl
 18522      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18523
 18524      GO TO 6700-COMM-EXIT.
 18525
 18526 6700-COMM-EXIT.
 18527     EXIT.
 18528
 18529 7000-GET-RATE.
 18530
 18531* EXEC CICS LINK
 18532*        PROGRAM    ('ELRATE')
 18533*        COMMAREA   (CALCULATION-PASS-AREA)
 18534*        LENGTH     (CP-COMM-LENGTH)
 18535*    END-EXEC.
 18536     MOVE 'ELRATE' TO DFHEIV1
 18537*    MOVE '."C                   (   #00018308' TO DFHEIV0
 18538     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18539     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18540     MOVE X'2020233030303138333038' TO DFHEIV0(25:11)
 18541     CALL 'kxdfhei1' USING DFHEIV0,
 18542           DFHEIV1,
 18543           CALCULATION-PASS-AREA,
 18544           CP-COMM-LENGTH,
 18545           DFHEIV99,
 18546           DFHEIV99,
 18547           DFHEIV99,
 18548           DFHEIV99
 18549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18550
 18551
 18552 7000-EXIT.
 18553     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 339
* EL050.cbl
 18555 7100-FIND-BENEFIT-IN-STATE.
 18556     MOVE 'N'                    TO BEN-SEARCH-SW.
 18557
 18558     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18559         VARYING SUB3 FROM 1 BY 1 UNTIL
 18560            ((SUB3 GREATER 50) OR
 18561              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18562               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18563
 18564     IF SUB3 NOT = 51
 18565         MOVE 'Y'                TO BEN-SEARCH-SW.
 18566
 18567     GO TO 7199-EXIT.
 18568
 18569 7100-BENEFIT-DUMMY.
 18570
 18571 7100-DUMMY-EXIT.
 18572     EXIT.
 18573
 18574 7199-EXIT.
 18575     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 340
* EL050.cbl
 18577 7200-FIND-BENEFIT.
 18578     MOVE 'N'                    TO BEN-SEARCH-SW.
 18579
 18580     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18581         VARYING SUB3 FROM 1 BY 1 UNTIL
 18582            ((SUB3 GREATER 8) OR
 18583            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18584
 18585     IF SUB3 NOT = 9
 18586         MOVE 'Y'                TO BEN-SEARCH-SW.
 18587
 18588     GO TO 7200-EXIT.
 18589
 18590 7200-BENEFIT-DUMMY.
 18591
 18592 7200-DUMMY-EXIT.
 18593     EXIT.
 18594
 18595 7200-EXIT.
 18596     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 341
* EL050.cbl
 18598 7250-LOOK-FOR-RESCINDED-CLAIM.
 18599     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18600                                    W-CL-COMP-CD.
 18601     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18602                                    W-CL-CERT-NO.
 18603
 18604
 18605* EXEC CICS HANDLE CONDITION
 18606*        NOTFND  (7250-CONTINUE)
 18607*        ENDFILE (7250-CONTINUE)
 18608*    END-EXEC.
 18609*    MOVE '"$I''                  ! ) #00018366' TO DFHEIV0
 18610     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18612     MOVE X'2920233030303138333636' TO DFHEIV0(25:11)
 18613     CALL 'kxdfhei1' USING DFHEIV0
 18614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18615
 18616
 18617
 18618* EXEC CICS IGNORE CONDITION
 18619*        DUPKEY
 18620*    END-EXEC.
 18621*    MOVE '"*$                   !   #00018371' TO DFHEIV0
 18622     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18624     MOVE X'2020233030303138333731' TO DFHEIV0(25:11)
 18625     CALL 'kxdfhei1' USING DFHEIV0
 18626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18627
 18628
 18629
 18630* EXEC CICS STARTBR
 18631*        DATASET   (CLMS-ID)
 18632*        RIDFLD    (ELMSTR-KEY)
 18633*        GENERIC   EQUAL
 18634*        KEYLENGTH (ELMSTR-LENGTH)
 18635*    END-EXEC.
 18636     MOVE 0
 18637       TO DFHEIV11
 18638*    MOVE '&,   KG    E          &   #00018375' TO DFHEIV0
 18639     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18640     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18641     MOVE X'2020233030303138333735' TO DFHEIV0(25:11)
 18642     CALL 'kxdfhei1' USING DFHEIV0,
 18643           CLMS-ID,
 18644           ELMSTR-KEY,
 18645           ELMSTR-LENGTH,
 18646           DFHEIV11,
 18647           DFHEIV99
 18648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18649
 18650
 18651     MOVE 'Y'                    TO W-BROWSE-SW.
 18652
 18653 7250-NEXT-CLAIM.
 18654
 18655
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 342
* EL050.cbl
 18656* EXEC CICS READNEXT
 18657*        DATASET   (CLMS-ID)
 18658*        RIDFLD    (ELMSTR-KEY)
 18659*        SET       (ADDRESS OF CLAIM-MASTER)
 18660*    END-EXEC.
 18661     MOVE 0
 18662       TO DFHEIV11
 18663*    MOVE '&.S                   )   #00018386' TO DFHEIV0
 18664     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18665     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18666     MOVE X'2020233030303138333836' TO DFHEIV0(25:11)
 18667     CALL 'kxdfhei1' USING DFHEIV0,
 18668           CLMS-ID,
 18669           DFHEIV20,
 18670           DFHEIV99,
 18671           ELMSTR-KEY,
 18672           DFHEIV99,
 18673           DFHEIV11,
 18674           DFHEIV99,
 18675           DFHEIV99
 18676     SET ADDRESS OF CLAIM-MASTER TO
 18677         DFHEIV20
 18678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18679
 18680
 18681     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18682        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18683         GO TO 7250-CONTINUE
 18684     END-IF.
 18685
 18686     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18687        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18688        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18689        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18690        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18691         GO TO 7250-NEXT-CLAIM
 18692     END-IF.
 18693
 18694     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18695        OR (CL-CLAIM-TYPE = 'I')
 18696        OR (CL-CLAIM-TYPE = 'G')
 18697          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18698              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18699              GO TO 7250-CONTINUE
 18700          END-IF
 18701     END-IF.
 18702
 18703     GO TO 7250-NEXT-CLAIM.
 18704
 18705 7250-CONTINUE.
 18706
 18707     IF W-BROWSE-SW = 'Y'
 18708
 18709* EXEC CICS ENDBR
 18710*            DATASET   (CLMS-ID)
 18711*        END-EXEC
 18712     MOVE 0
 18713       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 343
* EL050.cbl
 18714*    MOVE '&2                    $   #00018419' TO DFHEIV0
 18715     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18716     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18717     MOVE X'2020233030303138343139' TO DFHEIV0(25:11)
 18718     CALL 'kxdfhei1' USING DFHEIV0,
 18719           CLMS-ID,
 18720           DFHEIV11,
 18721           DFHEIV99
 18722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18723         MOVE 'N' TO W-BROWSE-SW
 18724     END-IF.
 18725
 18726 7250-EXIT.
 18727     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 344
* EL050.cbl
 18729 7300-CHECK-FOR-OPEN-CLMS.
 18730
 18731*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18732*    MOVE SPACES                 TO CNTL-ACCESS.
 18733*    MOVE '1'                    TO CNTL-REC-TYPE.
 18734*    MOVE +0                     TO CNTL-SEQ-NO.
 18735
 18736*    MOVE '3'                    TO RC-SW-1.
 18737*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18738
 18739*    IF NOT CF-COMPANY-MASTER
 18740*         PERFORM 0099-COMPANY-NOT-FOUND
 18741*         GO TO 7300-EXIT.
 18742
 18743     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18744                                    W-CL-COMP-CD.
 18745     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18746                                    W-CL-CERT-NO.
 18747
 18748
 18749* EXEC CICS HANDLE CONDITION
 18750*        NOTFND  (7300-CONTINUE)
 18751*        ENDFILE (7300-CONTINUE)
 18752*    END-EXEC.
 18753*    MOVE '"$I''                  ! * #00018447' TO DFHEIV0
 18754     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18755     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18756     MOVE X'2A20233030303138343437' TO DFHEIV0(25:11)
 18757     CALL 'kxdfhei1' USING DFHEIV0
 18758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18759
 18760
 18761
 18762* EXEC CICS IGNORE CONDITION
 18763*        DUPKEY
 18764*    END-EXEC.
 18765*    MOVE '"*$                   !   #00018452' TO DFHEIV0
 18766     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18768     MOVE X'2020233030303138343532' TO DFHEIV0(25:11)
 18769     CALL 'kxdfhei1' USING DFHEIV0
 18770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18771
 18772
 18773
 18774* EXEC CICS STARTBR
 18775*        DATASET   (CLMS-ID)
 18776*        RIDFLD    (ELMSTR-KEY)
 18777*        GENERIC   EQUAL
 18778*        KEYLENGTH (ELMSTR-LENGTH)
 18779*    END-EXEC.
 18780     MOVE 0
 18781       TO DFHEIV11
 18782*    MOVE '&,   KG    E          &   #00018456' TO DFHEIV0
 18783     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18784     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18785     MOVE X'2020233030303138343536' TO DFHEIV0(25:11)
 18786     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 345
* EL050.cbl
 18787           CLMS-ID,
 18788           ELMSTR-KEY,
 18789           ELMSTR-LENGTH,
 18790           DFHEIV11,
 18791           DFHEIV99
 18792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18793
 18794
 18795     MOVE 'Y'                    TO W-BROWSE-SW.
 18796
 18797 7300-NEXT-CLAIM.
 18798
 18799
 18800* EXEC CICS READNEXT
 18801*        DATASET   (CLMS-ID)
 18802*        RIDFLD    (ELMSTR-KEY)
 18803*        SET       (ADDRESS OF CLAIM-MASTER)
 18804*    END-EXEC.
 18805     MOVE 0
 18806       TO DFHEIV11
 18807*    MOVE '&.S                   )   #00018467' TO DFHEIV0
 18808     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18809     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18810     MOVE X'2020233030303138343637' TO DFHEIV0(25:11)
 18811     CALL 'kxdfhei1' USING DFHEIV0,
 18812           CLMS-ID,
 18813           DFHEIV20,
 18814           DFHEIV99,
 18815           ELMSTR-KEY,
 18816           DFHEIV99,
 18817           DFHEIV11,
 18818           DFHEIV99,
 18819           DFHEIV99
 18820     SET ADDRESS OF CLAIM-MASTER TO
 18821         DFHEIV20
 18822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18823
 18824
 18825     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18826        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18827         GO TO 7300-CONTINUE.
 18828
 18829     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18830        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18831        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18832        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18833        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18834         GO TO 7300-NEXT-CLAIM.
 18835
 18836*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18837     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18838        OR (CL-CLAIM-TYPE = 'I')
 18839        OR (CL-CLAIM-TYPE = 'G')
 18840        IF CLAIM-IS-OPEN
 18841           EVALUATE TRUE
 18842             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18843                 MOVE ER-2884      TO WS-ERROR
 18844             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 346
* EL050.cbl
 18845                 MOVE ER-2887      TO WS-ERROR
 18846             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18847                 MOVE ER-2886      TO WS-ERROR
 18848             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18849                 MOVE ER-2888      TO WS-ERROR
 18850             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18851                 MOVE ER-2885      TO WS-ERROR
 18852             WHEN OTHER
 18853                 MOVE ER-2768      TO WS-ERROR
 18854           END-EVALUATE
 18855           IF PB-C-AH-CANCEL-VOIDED OR
 18856              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18857                NOT AH-COVERAGE-CANCELLED)
 18858               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18859               MOVE ER-2768      TO WS-ERROR
 18860           END-IF
 18861           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18862           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18863              PB-FORCE-CODE NOT EQUAL '8'
 18864               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18865           END-IF
 18866           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18867           GO TO 7300-CONTINUE
 18868        ELSE
 18869           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18870*****THIS IS A RESCISSION OR REFORMATION
 18871              IF (AH-COVERAGE-CANCELLED AND
 18872                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18873                    MOVE ER-2890 TO WS-ERROR
 18874                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18875                    GO TO 7300-CONTINUE
 18876              END-IF
 18877           ELSE
 18878              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18879               AND PB-C-AH-CANCEL-DT > SPACES
 18880                 MOVE ER-2756        TO WS-ERROR
 18881                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18882                 GO TO 7300-CONTINUE
 18883              END-IF
 18884           END-IF
 18885        END-IF
 18886     ELSE
 18887*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18888        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18889           IF CLAIM-IS-OPEN
 18890              MOVE ER-2889      TO WS-ERROR
 18891              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18892              GO TO 7300-CONTINUE
 18893           ELSE
 18894              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18895*****THIS IS A RESCISSION OR REFORMATION
 18896                 IF (LF-COVERAGE-CANCELLED AND
 18897                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18898                       MOVE ER-2890 TO WS-ERROR
 18899                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18900                       GO TO 7300-CONTINUE
 18901                 END-IF
 18902              ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 347
* EL050.cbl
 18903                 IF (AH-COVERAGE-CANCELLED AND
 18904                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18905                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18906                    (LF-COVERAGE-CANCELLED AND
 18907                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18908                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18909                       MOVE ER-2965 TO WS-ERROR
 18910                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18911                       GO TO 7300-CONTINUE
 18912                 END-IF
 18913                 IF LF-COVERAGE-CANCELLED
 18914                  IF CL-TOTAL-PAID-AMT > 0
 18915                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18916                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18917                        MOVE ER-2891 TO WS-ERROR
 18918                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18919                        GO TO 7300-CONTINUE
 18920                      END-IF
 18921                    ELSE
 18922                      MOVE ER-2892 TO WS-ERROR
 18923                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18924                      GO TO 7300-CONTINUE
 18925                    END-IF
 18926                  END-IF
 18927                 END-IF
 18928              END-IF
 18929           END-IF
 18930        END-IF
 18931     END-IF
 18932
 18933     GO TO 7300-NEXT-CLAIM.
 18934
 18935 7300-CONTINUE.
 18936
 18937     IF W-BROWSE-SW = 'Y'
 18938
 18939* EXEC CICS ENDBR
 18940*            DATASET   (CLMS-ID)
 18941*        END-EXEC.
 18942     MOVE 0
 18943       TO DFHEIV11
 18944*    MOVE '&2                    $   #00018586' TO DFHEIV0
 18945     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18946     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18947     MOVE X'2020233030303138353836' TO DFHEIV0(25:11)
 18948     CALL 'kxdfhei1' USING DFHEIV0,
 18949           CLMS-ID,
 18950           DFHEIV11,
 18951           DFHEIV99
 18952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18953
 18954
 18955 7300-EXIT.
 18956     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 348
* EL050.cbl
 18958
 18959 7400-GET-REMAIN-TERM.
 18960
 18961* EXEC CICS LINK
 18962*        PROGRAM    ('ELRTRM')
 18963*        COMMAREA   (CALCULATION-PASS-AREA)
 18964*        LENGTH     (CP-COMM-LENGTH)
 18965*    END-EXEC.
 18966     MOVE 'ELRTRM' TO DFHEIV1
 18967*    MOVE '."C                   (   #00018595' TO DFHEIV0
 18968     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18969     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18970     MOVE X'2020233030303138353935' TO DFHEIV0(25:11)
 18971     CALL 'kxdfhei1' USING DFHEIV0,
 18972           DFHEIV1,
 18973           CALCULATION-PASS-AREA,
 18974           CP-COMM-LENGTH,
 18975           DFHEIV99,
 18976           DFHEIV99,
 18977           DFHEIV99,
 18978           DFHEIV99
 18979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18980
 18981
 18982 7400-EXIT.
 18983     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 349
* EL050.cbl
 18985
 18986 7500-GET-REMAIN-AMOUNT.
 18987
 18988* EXEC CICS LINK
 18989*        PROGRAM    ('ELRAMT')
 18990*        COMMAREA   (CALCULATION-PASS-AREA)
 18991*        LENGTH     (CP-COMM-LENGTH)
 18992*    END-EXEC.
 18993     MOVE 'ELRAMT' TO DFHEIV1
 18994*    MOVE '."C                   (   #00018606' TO DFHEIV0
 18995     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18996     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18997     MOVE X'2020233030303138363036' TO DFHEIV0(25:11)
 18998     CALL 'kxdfhei1' USING DFHEIV0,
 18999           DFHEIV1,
 19000           CALCULATION-PASS-AREA,
 19001           CP-COMM-LENGTH,
 19002           DFHEIV99,
 19003           DFHEIV99,
 19004           DFHEIV99,
 19005           DFHEIV99
 19006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19007
 19008
 19009 7500-EXIT.
 19010     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 350
* EL050.cbl
 19012
 19013 7600-GET-REFUND.
 19014
 19015* EXEC CICS LINK
 19016*        PROGRAM    ('ELRFND')
 19017*        COMMAREA   (CALCULATION-PASS-AREA)
 19018*        LENGTH     (CP-COMM-LENGTH)
 19019*    END-EXEC.
 19020     MOVE 'ELRFND' TO DFHEIV1
 19021*    MOVE '."C                   (   #00018617' TO DFHEIV0
 19022     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19023     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19024     MOVE X'2020233030303138363137' TO DFHEIV0(25:11)
 19025     CALL 'kxdfhei1' USING DFHEIV0,
 19026           DFHEIV1,
 19027           CALCULATION-PASS-AREA,
 19028           CP-COMM-LENGTH,
 19029           DFHEIV99,
 19030           DFHEIV99,
 19031           DFHEIV99,
 19032           DFHEIV99
 19033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19034
 19035
 19036 7600-EXIT.
 19037     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 351
* EL050.cbl
 19039 7700-CALL-DL1.
 19040
 19041* EXEC CICS LINK
 19042*        PROGRAM    ('DLO001')
 19043*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19044*        LENGTH     (DLO001-COMM-LENGTH)
 19045*    END-EXEC.
 19046     MOVE 'DLO001' TO DFHEIV1
 19047*    MOVE '."C                   (   #00018627' TO DFHEIV0
 19048     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19049     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19050     MOVE X'2020233030303138363237' TO DFHEIV0(25:11)
 19051     CALL 'kxdfhei1' USING DFHEIV0,
 19052           DFHEIV1,
 19053           WS-DLO-MASTER-POLICY-FORM,
 19054           DLO001-COMM-LENGTH,
 19055           DFHEIV99,
 19056           DFHEIV99,
 19057           DFHEIV99,
 19058           DFHEIV99
 19059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19060
 19061
 19062 7700-EXIT.
 19063     EXIT.
 19064
 19065 7710-CALL-DL2.
 19066
 19067* EXEC CICS LINK
 19068*        PROGRAM    ('DLO002')
 19069*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19070*        LENGTH     (DLO002-COMM-LENGTH)
 19071*    END-EXEC.
 19072     MOVE 'DLO002' TO DFHEIV1
 19073*    MOVE '."C                   (   #00018637' TO DFHEIV0
 19074     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19075     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19076     MOVE X'2020233030303138363337' TO DFHEIV0(25:11)
 19077     CALL 'kxdfhei1' USING DFHEIV0,
 19078           DFHEIV1,
 19079           WS-DLO-INTERNAL-POLICY-FORM,
 19080           DLO002-COMM-LENGTH,
 19081           DFHEIV99,
 19082           DFHEIV99,
 19083           DFHEIV99,
 19084           DFHEIV99
 19085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19086
 19087
 19088 7710-EXIT.
 19089     EXIT.
 19090
 19091 7720-CALL-DL3.
 19092
 19093* EXEC CICS LINK
 19094*        PROGRAM    ('DLO003')
 19095*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19096*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 352
* EL050.cbl
 19097*    END-EXEC.
 19098     MOVE 'DLO003' TO DFHEIV1
 19099*    MOVE '."C                   (   #00018647' TO DFHEIV0
 19100     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19102     MOVE X'2020233030303138363437' TO DFHEIV0(25:11)
 19103     CALL 'kxdfhei1' USING DFHEIV0,
 19104           DFHEIV1,
 19105           WS-DLO-VALID-BANK-ID,
 19106           DLO003-COMM-LENGTH,
 19107           DFHEIV99,
 19108           DFHEIV99,
 19109           DFHEIV99,
 19110           DFHEIV99
 19111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19112
 19113
 19114 7720-EXIT.
 19115     EXIT.
 19116
 19117 7730-CALL-DL7.
 19118
 19119* EXEC CICS LINK
 19120*        PROGRAM    ('DLO007')
 19121*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19122*        LENGTH     (DLO007-COMM-LENGTH)
 19123*    END-EXEC.
 19124     MOVE 'DLO007' TO DFHEIV1
 19125*    MOVE '."C                   (   #00018657' TO DFHEIV0
 19126     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19127     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19128     MOVE X'2020233030303138363537' TO DFHEIV0(25:11)
 19129     CALL 'kxdfhei1' USING DFHEIV0,
 19130           DFHEIV1,
 19131           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19132           DLO007-COMM-LENGTH,
 19133           DFHEIV99,
 19134           DFHEIV99,
 19135           DFHEIV99,
 19136           DFHEIV99
 19137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19138
 19139
 19140 7730-EXIT.
 19141     EXIT.
 19142
 19143 7740-CALL-DL11.
 19144
 19145* EXEC CICS LINK
 19146*        PROGRAM    ('DLO011')
 19147*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19148*        LENGTH     (DLO011-COMM-LENGTH)
 19149*    END-EXEC.
 19150     MOVE 'DLO011' TO DFHEIV1
 19151*    MOVE '."C                   (   #00018667' TO DFHEIV0
 19152     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19154     MOVE X'2020233030303138363637' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 353
* EL050.cbl
 19155     CALL 'kxdfhei1' USING DFHEIV0,
 19156           DFHEIV1,
 19157           WS-DLO-PREM-RATES-BEN-TYPE,
 19158           DLO011-COMM-LENGTH,
 19159           DFHEIV99,
 19160           DFHEIV99,
 19161           DFHEIV99,
 19162           DFHEIV99
 19163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19164
 19165
 19166 7740-EXIT.
 19167     EXIT.
 19168
 19169 7750-CALL-DL17.
 19170
 19171* EXEC CICS LINK
 19172*        PROGRAM    ('DLO017')
 19173*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19174*        LENGTH     (DLO017-COMM-LENGTH)
 19175*    END-EXEC.
 19176     MOVE 'DLO017' TO DFHEIV1
 19177*    MOVE '."C                   (   #00018677' TO DFHEIV0
 19178     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19179     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19180     MOVE X'2020233030303138363737' TO DFHEIV0(25:11)
 19181     CALL 'kxdfhei1' USING DFHEIV0,
 19182           DFHEIV1,
 19183           WS-DLO-VALID-RATE-CODE,
 19184           DLO017-COMM-LENGTH,
 19185           DFHEIV99,
 19186           DFHEIV99,
 19187           DFHEIV99,
 19188           DFHEIV99
 19189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19190
 19191
 19192 7750-EXIT.
 19193     EXIT.
 19194
 19195 7755-CALL-DL19.
 19196
 19197* EXEC CICS LINK
 19198*        PROGRAM    ('DLO019')
 19199*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19200*        LENGTH     (DLO019-COMM-LENGTH)
 19201*    END-EXEC.
 19202     MOVE 'DLO019' TO DFHEIV1
 19203*    MOVE '."C                   (   #00018687' TO DFHEIV0
 19204     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19206     MOVE X'2020233030303138363837' TO DFHEIV0(25:11)
 19207     CALL 'kxdfhei1' USING DFHEIV0,
 19208           DFHEIV1,
 19209           WS-DLO-ORIG-COV-CAT,
 19210           DLO019-COMM-LENGTH,
 19211           DFHEIV99,
 19212           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 354
* EL050.cbl
 19213           DFHEIV99,
 19214           DFHEIV99
 19215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19216
 19217
 19218 7755-EXIT.
 19219     EXIT.
 19220
 19221 7760-CALL-DL21.
 19222
 19223* EXEC CICS LINK
 19224*        PROGRAM    ('DLO021')
 19225*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19226*        LENGTH     (DLO021-COMM-LENGTH)
 19227*    END-EXEC.
 19228     MOVE 'DLO021' TO DFHEIV1
 19229*    MOVE '."C                   (   #00018697' TO DFHEIV0
 19230     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19231     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19232     MOVE X'2020233030303138363937' TO DFHEIV0(25:11)
 19233     CALL 'kxdfhei1' USING DFHEIV0,
 19234           DFHEIV1,
 19235           WS-DLO-VALID-LOAN-OFFICER,
 19236           DLO021-COMM-LENGTH,
 19237           DFHEIV99,
 19238           DFHEIV99,
 19239           DFHEIV99,
 19240           DFHEIV99
 19241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19242
 19243
 19244 7760-EXIT.
 19245     EXIT.
 19246
 19247 7770-CALL-DL22.
 19248
 19249* EXEC CICS LINK
 19250*        PROGRAM    ('DLO022')
 19251*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19252*        LENGTH     (DLO022-COMM-LENGTH)
 19253*    END-EXEC.
 19254     MOVE 'DLO022' TO DFHEIV1
 19255*    MOVE '."C                   (   #00018707' TO DFHEIV0
 19256     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19257     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19258     MOVE X'2020233030303138373037' TO DFHEIV0(25:11)
 19259     CALL 'kxdfhei1' USING DFHEIV0,
 19260           DFHEIV1,
 19261           WS-DLO-VALID-STATE-CODE,
 19262           DLO022-COMM-LENGTH,
 19263           DFHEIV99,
 19264           DFHEIV99,
 19265           DFHEIV99,
 19266           DFHEIV99
 19267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19268
 19269
 19270 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 355
* EL050.cbl
 19271     EXIT.
 19272
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 356
* EL050.cbl
 19274
 19275 7800-REWRITE-CERT.
 19276******************************************************************
 19277*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19278*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19279******************************************************************
 19280
 19281     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19282        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19283        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19284        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19285
 19286* EXEC CICS REWRITE
 19287*                  DATASET (CERT-ID)
 19288*                  FROM    (CERTIFICATE-MASTER)
 19289*              END-EXEC
 19290     MOVE LENGTH OF
 19291      CERTIFICATE-MASTER
 19292       TO DFHEIV11
 19293*    MOVE '&& L                  %   #00018728' TO DFHEIV0
 19294     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19295     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19296     MOVE X'2020233030303138373238' TO DFHEIV0(25:11)
 19297     CALL 'kxdfhei1' USING DFHEIV0,
 19298           CERT-ID,
 19299           CERTIFICATE-MASTER,
 19300           DFHEIV11,
 19301           DFHEIV99
 19302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19303        GO TO 7800-EXIT.
 19304
 19305       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19306       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19307
 19308 7800-EXIT.
 19309      EXIT.
 19310
 19311 7900-DELETE-CERT.
 19312
 19313* EXEC CICS DELETE
 19314*        DATASET (CERT-ID)
 19315*    END-EXEC.
 19316*    MOVE '&(                    &   #00018741' TO DFHEIV0
 19317     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19318     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19319     MOVE X'2020233030303138373431' TO DFHEIV0(25:11)
 19320     CALL 'kxdfhei1' USING DFHEIV0,
 19321           CERT-ID,
 19322           DFHEIV99,
 19323           DFHEIV99,
 19324           DFHEIV99,
 19325           DFHEIV99
 19326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19327
 19328
 19329 7900-EXIT.
 19330     EXIT.
 19331
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 357
* EL050.cbl
 19332 8000-WRITE-CERT.
 19333
 19334* EXEC CICS HANDLE CONDITION
 19335*        DUPKEY    (8000-FREE-MAIN)
 19336*    END-EXEC.
 19337*    MOVE '"$$                   ! + #00018749' TO DFHEIV0
 19338     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19339     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19340     MOVE X'2B20233030303138373439' TO DFHEIV0(25:11)
 19341     CALL 'kxdfhei1' USING DFHEIV0
 19342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19343
 19344
 19345
 19346* EXEC CICS WRITE
 19347*        DATASET     (CERT-ID)
 19348*        FROM        (CERTIFICATE-MASTER)
 19349*        RIDFLD      (ELCERT-KEY)
 19350*    END-EXEC.
 19351     MOVE LENGTH OF
 19352      CERTIFICATE-MASTER
 19353       TO DFHEIV11
 19354*    MOVE '&$ L                  ''   #00018753' TO DFHEIV0
 19355     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19356     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19357     MOVE X'2020233030303138373533' TO DFHEIV0(25:11)
 19358     CALL 'kxdfhei1' USING DFHEIV0,
 19359           CERT-ID,
 19360           CERTIFICATE-MASTER,
 19361           DFHEIV11,
 19362           ELCERT-KEY,
 19363           DFHEIV99,
 19364           DFHEIV99
 19365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19366
 19367
 19368 8000-FREE-MAIN.
 19369
 19370 8000-EXIT.
 19371      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 358
* EL050.cbl
 19373
 19374 8100-READ-ERPNDM.
 19375
 19376* EXEC CICS HANDLE CONDITION
 19377*         NOTFND     (8100-NOTFND)
 19378*         ENDFILE    (8100-NOTFND)
 19379*    END-EXEC.
 19380*    MOVE '"$I''                  ! , #00018766' TO DFHEIV0
 19381     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19383     MOVE X'2C20233030303138373636' TO DFHEIV0(25:11)
 19384     CALL 'kxdfhei1' USING DFHEIV0
 19385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19386
 19387
 19388     MOVE SPACES                 TO ERPNDM-FOUND.
 19389     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19390
 19391
 19392* EXEC CICS READ
 19393*         DATASET   (FILE-ERPNDM)
 19394*         RIDFLD    (PM-CONTROL-PRIMARY)
 19395*         INTO      (PENDING-MAILING-DATA)
 19396*    END-EXEC.
 19397     MOVE LENGTH OF
 19398      PENDING-MAILING-DATA
 19399       TO DFHEIV11
 19400*    MOVE '&"IL       E          (   #00018774' TO DFHEIV0
 19401     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19402     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19403     MOVE X'2020233030303138373734' TO DFHEIV0(25:11)
 19404     CALL 'kxdfhei1' USING DFHEIV0,
 19405           FILE-ERPNDM,
 19406           PENDING-MAILING-DATA,
 19407           DFHEIV11,
 19408           PM-CONTROL-PRIMARY,
 19409           DFHEIV99,
 19410           DFHEIV99,
 19411           DFHEIV99
 19412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19413
 19414
 19415     GO TO 8100-EXIT.
 19416
 19417 8100-NOTFND.
 19418
 19419     MOVE 'X'                    TO ERPNDM-FOUND.
 19420     MOVE ER-2694                TO WS-ERROR.
 19421     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19422     MOVE ER-2883                TO WS-ERROR
 19423     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19424     .
 19425 8100-EXIT.
 19426     EXIT.
 19427
 19428 8110-READ-ERMAIL.
 19429
 19430* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 359
* EL050.cbl
 19431*         NOTFND     (8110-NOTFND)
 19432*         ENDFILE    (8110-NOTFND)
 19433*    END-EXEC.
 19434*    MOVE '"$I''                  ! - #00018794' TO DFHEIV0
 19435     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19437     MOVE X'2D20233030303138373934' TO DFHEIV0(25:11)
 19438     CALL 'kxdfhei1' USING DFHEIV0
 19439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19440
 19441
 19442     MOVE SPACES                 TO ERMAIL-FOUND.
 19443     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19444     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19445     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19446     MOVE PB-SV-STATE            TO MA-STATE.
 19447
 19448
 19449* EXEC CICS READ
 19450*         UPDATE
 19451*         DATASET   (FILE-ERMAIL)
 19452*         RIDFLD    (MA-CONTROL-PRIMARY)
 19453*         INTO      (MAILING-DATA)
 19454*    END-EXEC.
 19455     MOVE LENGTH OF
 19456      MAILING-DATA
 19457       TO DFHEIV11
 19458*    MOVE '&"IL       EU         (   #00018805' TO DFHEIV0
 19459     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19461     MOVE X'2020233030303138383035' TO DFHEIV0(25:11)
 19462     CALL 'kxdfhei1' USING DFHEIV0,
 19463           FILE-ERMAIL,
 19464           MAILING-DATA,
 19465           DFHEIV11,
 19466           MA-CONTROL-PRIMARY,
 19467           DFHEIV99,
 19468           DFHEIV99,
 19469           DFHEIV99
 19470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19471
 19472
 19473     GO TO 8110-EXIT.
 19474
 19475 8110-NOTFND.
 19476     MOVE 'X'                    TO ERMAIL-FOUND.
 19477
 19478 8110-EXIT.
 19479     EXIT.
 19480
 19481 8120-REWRITE-ERMAIL.
 19482
 19483* EXEC CICS REWRITE
 19484*         DATASET    (FILE-ERMAIL)
 19485*         FROM       (MAILING-DATA)
 19486*    END-EXEC.
 19487     MOVE LENGTH OF
 19488      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 360
* EL050.cbl
 19489       TO DFHEIV11
 19490*    MOVE '&& L                  %   #00018821' TO DFHEIV0
 19491     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19492     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19493     MOVE X'2020233030303138383231' TO DFHEIV0(25:11)
 19494     CALL 'kxdfhei1' USING DFHEIV0,
 19495           FILE-ERMAIL,
 19496           MAILING-DATA,
 19497           DFHEIV11,
 19498           DFHEIV99
 19499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19500
 19501
 19502 8120-EXIT.
 19503     EXIT.
 19504
 19505 8130-WRITE-ERMAIL.
 19506
 19507* EXEC CICS HANDLE CONDITION
 19508*         DUPKEY   (8130-EXIT)
 19509*    END-EXEC.
 19510*    MOVE '"$$                   ! . #00018830' TO DFHEIV0
 19511     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19512     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19513     MOVE X'2E20233030303138383330' TO DFHEIV0(25:11)
 19514     CALL 'kxdfhei1' USING DFHEIV0
 19515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19516
 19517
 19518
 19519* EXEC CICS WRITE
 19520*         DATASET     (FILE-ERMAIL)
 19521*         RIDFLD      (MA-CONTROL-PRIMARY)
 19522*         FROM        (MAILING-DATA)
 19523*    END-EXEC.
 19524     MOVE LENGTH OF
 19525      MAILING-DATA
 19526       TO DFHEIV11
 19527*    MOVE '&$ L                  ''   #00018834' TO DFHEIV0
 19528     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19529     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19530     MOVE X'2020233030303138383334' TO DFHEIV0(25:11)
 19531     CALL 'kxdfhei1' USING DFHEIV0,
 19532           FILE-ERMAIL,
 19533           MAILING-DATA,
 19534           DFHEIV11,
 19535           MA-CONTROL-PRIMARY,
 19536           DFHEIV99,
 19537           DFHEIV99
 19538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19539
 19540
 19541 8130-EXIT.
 19542     EXIT.
 19543
 19544 8140-UNLOCK-ERMAIL.
 19545
 19546* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 361
* EL050.cbl
 19547*         DATASET   (FILE-ERMAIL)
 19548*    END-EXEC.
 19549*    MOVE '&*                    #   #00018844' TO DFHEIV0
 19550     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19551     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19552     MOVE X'2020233030303138383434' TO DFHEIV0(25:11)
 19553     CALL 'kxdfhei1' USING DFHEIV0,
 19554           FILE-ERMAIL,
 19555           DFHEIV99
 19556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19557
 19558
 19559 8140-EXIT.
 19560     EXIT.
 19561
 19562 8180-UPDATE-VIN-NUMBER.
 19563
 19564* EXEC CICS HANDLE CONDITION
 19565*        NOTFND   (8180-NOTFND)
 19566*    END-EXEC.
 19567*    MOVE '"$I                   ! / #00018852' TO DFHEIV0
 19568     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19570     MOVE X'2F20233030303138383532' TO DFHEIV0(25:11)
 19571     CALL 'kxdfhei1' USING DFHEIV0
 19572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19573
 19574
 19575     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19576     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19577
 19578
 19579* EXEC CICS READ
 19580*        UPDATE
 19581*        DATASET  (CRTT-ID)
 19582*        RIDFLD   (WS-ELCRTT-KEY)
 19583*        INTO     (CERTIFICATE-TRAILERS)
 19584*    END-EXEC.
 19585     MOVE LENGTH OF
 19586      CERTIFICATE-TRAILERS
 19587       TO DFHEIV11
 19588*    MOVE '&"IL       EU         (   #00018859' TO DFHEIV0
 19589     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19590     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19591     MOVE X'2020233030303138383539' TO DFHEIV0(25:11)
 19592     CALL 'kxdfhei1' USING DFHEIV0,
 19593           CRTT-ID,
 19594           CERTIFICATE-TRAILERS,
 19595           DFHEIV11,
 19596           WS-ELCRTT-KEY,
 19597           DFHEIV99,
 19598           DFHEIV99,
 19599           DFHEIV99
 19600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19601
 19602
 19603     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19604         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 362
* EL050.cbl
 19605
 19606* EXEC CICS REWRITE
 19607*           DATASET  (CRTT-ID)
 19608*           FROM     (CERTIFICATE-TRAILERS)
 19609*        END-EXEC
 19610     MOVE LENGTH OF
 19611      CERTIFICATE-TRAILERS
 19612       TO DFHEIV11
 19613*    MOVE '&& L                  %   #00018868' TO DFHEIV0
 19614     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19615     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19616     MOVE X'2020233030303138383638' TO DFHEIV0(25:11)
 19617     CALL 'kxdfhei1' USING DFHEIV0,
 19618           CRTT-ID,
 19619           CERTIFICATE-TRAILERS,
 19620           DFHEIV11,
 19621           DFHEIV99
 19622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19623     ELSE
 19624
 19625* EXEC CICS UNLOCK
 19626*          DATASET  (CRTT-ID)
 19627*       END-EXEC
 19628*    MOVE '&*                    #   #00018873' TO DFHEIV0
 19629     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19630     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19631     MOVE X'2020233030303138383733' TO DFHEIV0(25:11)
 19632     CALL 'kxdfhei1' USING DFHEIV0,
 19633           CRTT-ID,
 19634           DFHEIV99
 19635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19636     END-IF.
 19637
 19638     GO TO 8180-EXIT.
 19639
 19640 8180-NOTFND.
 19641
 19642     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19643     MOVE 'CS'         TO CS-RECORD-ID.
 19644     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19645     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19646     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19647     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19648
 19649* EXEC CICS WRITE
 19650*       DATASET  (CRTT-ID)
 19651*       RIDFLD   (WS-ELCRTT-KEY)
 19652*       FROM     (CERTIFICATE-TRAILERS)
 19653*    END-EXEC.
 19654     MOVE LENGTH OF
 19655      CERTIFICATE-TRAILERS
 19656       TO DFHEIV11
 19657*    MOVE '&$ L                  ''   #00018888' TO DFHEIV0
 19658     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19659     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19660     MOVE X'2020233030303138383838' TO DFHEIV0(25:11)
 19661     CALL 'kxdfhei1' USING DFHEIV0,
 19662           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 363
* EL050.cbl
 19663           CERTIFICATE-TRAILERS,
 19664           DFHEIV11,
 19665           WS-ELCRTT-KEY,
 19666           DFHEIV99,
 19667           DFHEIV99
 19668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19669
 19670
 19671 8180-EXIT.
 19672     EXIT.
 19673
 19674 8190-UPDATE-REFUND-CLAIM-FLAG.
 19675
 19676* EXEC CICS HANDLE CONDITION
 19677*        NOTFND   (8190-NOTFND)
 19678*    END-EXEC.
 19679*    MOVE '"$I                   ! 0 #00018898' TO DFHEIV0
 19680     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19681     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19682     MOVE X'3020233030303138383938' TO DFHEIV0(25:11)
 19683     CALL 'kxdfhei1' USING DFHEIV0
 19684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19685
 19686
 19687     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19688     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19689
 19690
 19691* EXEC CICS READ
 19692*        UPDATE
 19693*        DATASET  (CRTT-ID)
 19694*        RIDFLD   (WS-ELCRTT-KEY)
 19695*        INTO     (CERTIFICATE-TRAILERS)
 19696*    END-EXEC.
 19697     MOVE LENGTH OF
 19698      CERTIFICATE-TRAILERS
 19699       TO DFHEIV11
 19700*    MOVE '&"IL       EU         (   #00018905' TO DFHEIV0
 19701     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19702     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19703     MOVE X'2020233030303138393035' TO DFHEIV0(25:11)
 19704     CALL 'kxdfhei1' USING DFHEIV0,
 19705           CRTT-ID,
 19706           CERTIFICATE-TRAILERS,
 19707           DFHEIV11,
 19708           WS-ELCRTT-KEY,
 19709           DFHEIV99,
 19710           DFHEIV99,
 19711           DFHEIV99
 19712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19713
 19714
 19715     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19716
 19717* EXEC CICS REWRITE
 19718*       DATASET  (CRTT-ID)
 19719*       FROM     (CERTIFICATE-TRAILERS)
 19720*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 364
* EL050.cbl
 19721     MOVE LENGTH OF
 19722      CERTIFICATE-TRAILERS
 19723       TO DFHEIV11
 19724*    MOVE '&& L                  %   #00018913' TO DFHEIV0
 19725     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19726     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19727     MOVE X'2020233030303138393133' TO DFHEIV0(25:11)
 19728     CALL 'kxdfhei1' USING DFHEIV0,
 19729           CRTT-ID,
 19730           CERTIFICATE-TRAILERS,
 19731           DFHEIV11,
 19732           DFHEIV99
 19733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19734
 19735
 19736     GO TO 8190-EXIT.
 19737
 19738 8190-NOTFND.
 19739
 19740     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19741     MOVE 'CS'         TO CS-RECORD-ID.
 19742     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19743     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19744     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19745     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19746
 19747* EXEC CICS WRITE
 19748*       DATASET  (CRTT-ID)
 19749*       RIDFLD   (WS-ELCRTT-KEY)
 19750*       FROM     (CERTIFICATE-TRAILERS)
 19751*    END-EXEC.
 19752     MOVE LENGTH OF
 19753      CERTIFICATE-TRAILERS
 19754       TO DFHEIV11
 19755*    MOVE '&$ L                  ''   #00018928' TO DFHEIV0
 19756     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19757     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19758     MOVE X'2020233030303138393238' TO DFHEIV0(25:11)
 19759     CALL 'kxdfhei1' USING DFHEIV0,
 19760           CRTT-ID,
 19761           CERTIFICATE-TRAILERS,
 19762           DFHEIV11,
 19763           WS-ELCRTT-KEY,
 19764           DFHEIV99,
 19765           DFHEIV99
 19766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19767
 19768
 19769 8190-EXIT.
 19770     EXIT.
 19771
 19772 8195-UPDATE-AGE-FLAGS.
 19773
 19774* EXEC CICS HANDLE CONDITION
 19775*        NOTFND   (8195-NOTFND)
 19776*    END-EXEC.
 19777*    MOVE '"$I                   ! 1 #00018938' TO DFHEIV0
 19778     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 365
* EL050.cbl
 19779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19780     MOVE X'3120233030303138393338' TO DFHEIV0(25:11)
 19781     CALL 'kxdfhei1' USING DFHEIV0
 19782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19783
 19784
 19785     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19786     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19787
 19788
 19789* EXEC CICS READ
 19790*        UPDATE
 19791*        DATASET  (CRTT-ID)
 19792*        RIDFLD   (WS-ELCRTT-KEY)
 19793*        INTO     (CERTIFICATE-TRAILERS)
 19794*    END-EXEC.
 19795     MOVE LENGTH OF
 19796      CERTIFICATE-TRAILERS
 19797       TO DFHEIV11
 19798*    MOVE '&"IL       EU         (   #00018945' TO DFHEIV0
 19799     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19800     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19801     MOVE X'2020233030303138393435' TO DFHEIV0(25:11)
 19802     CALL 'kxdfhei1' USING DFHEIV0,
 19803           CRTT-ID,
 19804           CERTIFICATE-TRAILERS,
 19805           DFHEIV11,
 19806           WS-ELCRTT-KEY,
 19807           DFHEIV99,
 19808           DFHEIV99,
 19809           DFHEIV99
 19810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19811
 19812
 19813     IF WS-INS-AGE-SET = 'Y'
 19814        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19815     END-IF
 19816     IF WS-JNT-AGE-SET = 'Y'
 19817        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19818     END-IF
 19819
 19820
 19821* EXEC CICS REWRITE
 19822*       DATASET  (CRTT-ID)
 19823*       FROM     (CERTIFICATE-TRAILERS)
 19824*    END-EXEC.
 19825     MOVE LENGTH OF
 19826      CERTIFICATE-TRAILERS
 19827       TO DFHEIV11
 19828*    MOVE '&& L                  %   #00018959' TO DFHEIV0
 19829     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19830     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19831     MOVE X'2020233030303138393539' TO DFHEIV0(25:11)
 19832     CALL 'kxdfhei1' USING DFHEIV0,
 19833           CRTT-ID,
 19834           CERTIFICATE-TRAILERS,
 19835           DFHEIV11,
 19836           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 366
* EL050.cbl
 19837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19838
 19839
 19840     GO TO 8195-EXIT.
 19841
 19842 8195-NOTFND.
 19843
 19844     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19845     MOVE 'CS'         TO CS-RECORD-ID.
 19846     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19847     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19848     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19849     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 19850     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19851
 19852* EXEC CICS WRITE
 19853*       DATASET  (CRTT-ID)
 19854*       RIDFLD   (WS-ELCRTT-KEY)
 19855*       FROM     (CERTIFICATE-TRAILERS)
 19856*    END-EXEC.
 19857     MOVE LENGTH OF
 19858      CERTIFICATE-TRAILERS
 19859       TO DFHEIV11
 19860*    MOVE '&$ L                  ''   #00018975' TO DFHEIV0
 19861     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19862     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19863     MOVE X'2020233030303138393735' TO DFHEIV0(25:11)
 19864     CALL 'kxdfhei1' USING DFHEIV0,
 19865           CRTT-ID,
 19866           CERTIFICATE-TRAILERS,
 19867           DFHEIV11,
 19868           WS-ELCRTT-KEY,
 19869           DFHEIV99,
 19870           DFHEIV99
 19871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19872
 19873
 19874 8195-EXIT.
 19875     EXIT.
 19876
 19877 8200-READ-REIN-TABLE.
 19878
 19879* EXEC CICS HANDLE CONDITION
 19880*         NOTFND   (8200-NOTFND)
 19881*    END-EXEC.
 19882*    MOVE '"$I                   ! 2 #00018985' TO DFHEIV0
 19883     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19885     MOVE X'3220233030303138393835' TO DFHEIV0(25:11)
 19886     CALL 'kxdfhei1' USING DFHEIV0
 19887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19888
 19889
 19890
 19891* EXEC CICS READ
 19892*        DATASET     (REIN-ID)
 19893*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19894*        RIDFLD      (ERREIN-KEY)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 367
* EL050.cbl
 19895*    END-EXEC.
 19896*    MOVE '&"S        E          (   #00018989' TO DFHEIV0
 19897     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19898     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19899     MOVE X'2020233030303138393839' TO DFHEIV0(25:11)
 19900     CALL 'kxdfhei1' USING DFHEIV0,
 19901           REIN-ID,
 19902           DFHEIV20,
 19903           DFHEIV99,
 19904           ERREIN-KEY,
 19905           DFHEIV99,
 19906           DFHEIV99,
 19907           DFHEIV99
 19908     SET ADDRESS OF REINSURANCE-RECORD TO
 19909         DFHEIV20
 19910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19911
 19912
 19913     GO TO 8200-EXIT.
 19914
 19915 8200-NOTFND.
 19916     MOVE 'N'             TO WS-REIN-READ-SW.
 19917
 19918 8200-EXIT.
 19919      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 368
* EL050.cbl
 19921
 19922 8300-READ-CTBL-TABLE.
 19923
 19924* EXEC CICS HANDLE CONDITION
 19925*        NOTFND    (8300-NOTFND)
 19926*        DISABLED  (8300-ERRESS-PROBLEM)
 19927*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19928*        ENDFILE   (8300-NOTFND)
 19929*    END-EXEC.
 19930*    MOVE '"$IcJ''                ! 3 #00019005' TO DFHEIV0
 19931     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19932     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19933     MOVE X'3320233030303139303035' TO DFHEIV0(25:11)
 19934     CALL 'kxdfhei1' USING DFHEIV0
 19935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19936
 19937
 19938
 19939* EXEC CICS READ
 19940*        DATASET     (CTBL-ID)
 19941*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19942*        RIDFLD      (ERCTBL-KEY)
 19943*    END-EXEC.
 19944*    MOVE '&"S        E          (   #00019012' TO DFHEIV0
 19945     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19946     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19947     MOVE X'2020233030303139303132' TO DFHEIV0(25:11)
 19948     CALL 'kxdfhei1' USING DFHEIV0,
 19949           CTBL-ID,
 19950           DFHEIV20,
 19951           DFHEIV99,
 19952           ERCTBL-KEY,
 19953           DFHEIV99,
 19954           DFHEIV99,
 19955           DFHEIV99
 19956     SET ADDRESS OF COMM-TABLE-RECORD TO
 19957         DFHEIV20
 19958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19959
 19960
 19961     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19962
 19963     GO TO 8300-EXIT.
 19964
 19965 8300-NOTFND.
 19966
 19967     IF CTBL-SW = '0530'
 19968         MOVE 'AA'                     TO WS-AH-COMP-CD
 19969         MOVE '0550'                   TO CTBL-SW
 19970         MOVE '1'                      TO WS-CTBL-READ-SW
 19971         GO TO 8300-EXIT.
 19972
 19973     IF CTBL-SW = '0540'
 19974         MOVE 'AA'                     TO WS-LF-COMP-CD
 19975         MOVE '0550'                   TO CTBL-SW
 19976         MOVE '1'                      TO WS-CTBL-READ-SW
 19977         GO TO 8300-EXIT.
 19978
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 369
* EL050.cbl
 19979     IF CTBL-SW = '0550'
 19980         MOVE '2'                      TO WS-CTBL-READ-SW
 19981         GO TO 8300-EXIT.
 19982
 19983     GO TO 8300-EXIT.
 19984
 19985 8300-ERRESS-PROBLEM.
 19986
 19987      MOVE ER-8050              TO WS-ERROR.
 19988      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19989
 19990     GO TO 8300-EXIT.
 19991
 19992 8300-EXIT.
 19993      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 370
* EL050.cbl
 19995
 19996
 19997 8400-GETMAIN-ERFORM.
 19998
 19999
 20000* EXEC CICS   GETMAIN
 20001*        LENGTH  (500)
 20002*        SET     (ADDRESS OF FORM-MASTER)
 20003*    END-EXEC.
 20004     MOVE 500
 20005       TO DFHEIV11
 20006*    MOVE '," L                  $   #00019056' TO DFHEIV0
 20007     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20008     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20009     MOVE X'2020233030303139303536' TO DFHEIV0(25:11)
 20010     CALL 'kxdfhei1' USING DFHEIV0,
 20011           DFHEIV20,
 20012           DFHEIV11,
 20013           DFHEIV99
 20014     SET ADDRESS OF FORM-MASTER TO
 20015         DFHEIV20
 20016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20017
 20018
 20019     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20020
 20021 8400-EXIT.
 20022      EXIT.
 20023
 20024 8450-READ-FORM-MASTER.
 20025
 20026
 20027* EXEC CICS  HANDLE CONDITION
 20028*        NOTFND   (8450-FORM-NOT-FOUND)
 20029*        ENDFILE  (8450-FORM-NOT-FOUND)
 20030*    END-EXEC.
 20031*    MOVE '"$I''                  ! 4 #00019068' TO DFHEIV0
 20032     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20034     MOVE X'3420233030303139303638' TO DFHEIV0(25:11)
 20035     CALL 'kxdfhei1' USING DFHEIV0
 20036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20037
 20038
 20039
 20040* EXEC CICS   READ
 20041*        DATASET   (FORM-ID)
 20042*        RIDFLD    (ERFORM-KEY)
 20043*        INTO      (FORM-MASTER)
 20044*        GTEQ
 20045*    END-EXEC.
 20046     MOVE LENGTH OF
 20047      FORM-MASTER
 20048       TO DFHEIV11
 20049*    MOVE '&"IL       G          (   #00019073' TO DFHEIV0
 20050     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20051     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20052     MOVE X'2020233030303139303733' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 371
* EL050.cbl
 20053     CALL 'kxdfhei1' USING DFHEIV0,
 20054           FORM-ID,
 20055           FORM-MASTER,
 20056           DFHEIV11,
 20057           ERFORM-KEY,
 20058           DFHEIV99,
 20059           DFHEIV99,
 20060           DFHEIV99
 20061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20062
 20063
 20064     MOVE  'Y'           TO  FORM-MASTER-SW.
 20065
 20066     GO TO  8450-EXIT.
 20067
 20068 8450-FORM-NOT-FOUND.
 20069
 20070     MOVE  'N'           TO  FORM-MASTER-SW.
 20071
 20072 8450-EXIT.
 20073      EXIT.
 20074
 20075 8500-DATE-CONVERT.
 20076
 20077* EXEC CICS LINK
 20078*        PROGRAM    ('ELDATCV')
 20079*        COMMAREA   (DATE-CONVERSION-DATA)
 20080*        LENGTH     (DC-COMM-LENGTH)
 20081*    END-EXEC.
 20082     MOVE 'ELDATCV' TO DFHEIV1
 20083*    MOVE '."C                   (   #00019092' TO DFHEIV0
 20084     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20085     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20086     MOVE X'2020233030303139303932' TO DFHEIV0(25:11)
 20087     CALL 'kxdfhei1' USING DFHEIV0,
 20088           DFHEIV1,
 20089           DATE-CONVERSION-DATA,
 20090           DC-COMM-LENGTH,
 20091           DFHEIV99,
 20092           DFHEIV99,
 20093           DFHEIV99,
 20094           DFHEIV99
 20095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20096
 20097
 20098 8500-EXIT.
 20099     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 372
* EL050.cbl
 20101
 20102 8555-RELOAD-CONTROL-FILE.
 20103     CONTINUE.
 20104
 20105 8555-EXIT.
 20106     EXIT.
 20107
 20108 8557-GETMAIN-ERPLAN.
 20109
 20110
 20111* EXEC CICS GETMAIN
 20112*        LENGTH    (840)
 20113*        SET       (ADDRESS OF PLAN-RECORDS)
 20114*    END-EXEC.
 20115     MOVE 840
 20116       TO DFHEIV11
 20117*    MOVE '," L                  $   #00019110' TO DFHEIV0
 20118     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20119     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20120     MOVE X'2020233030303139313130' TO DFHEIV0(25:11)
 20121     CALL 'kxdfhei1' USING DFHEIV0,
 20122           DFHEIV20,
 20123           DFHEIV11,
 20124           DFHEIV99
 20125     SET ADDRESS OF PLAN-RECORDS TO
 20126         DFHEIV20
 20127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20128
 20129
 20130     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20131
 20132 8557-EXIT.
 20133     EXIT.
 20134
 20135 8560-GETMAIN.
 20136
 20137* EXEC CICS GETMAIN
 20138*        LENGTH    (2000)
 20139*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20140*    END-EXEC.
 20141     MOVE 2000
 20142       TO DFHEIV11
 20143*    MOVE '," L                  $   #00019121' TO DFHEIV0
 20144     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20145     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20146     MOVE X'2020233030303139313231' TO DFHEIV0(25:11)
 20147     CALL 'kxdfhei1' USING DFHEIV0,
 20148           DFHEIV20,
 20149           DFHEIV11,
 20150           DFHEIV99
 20151     SET ADDRESS OF ACCOUNT-MASTER TO
 20152         DFHEIV20
 20153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20154
 20155
 20156     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20157
 20158 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 373
* EL050.cbl
 20159     EXIT.
 20160
 20161 8570-START-ACCOUNT-MASTER.
 20162
 20163* EXEC CICS HANDLE CONDITION
 20164*        NOTFND    (0199-ACCT-NOT-FOUND)
 20165*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20166*    END-EXEC.
 20167*    MOVE '"$I''                  ! 5 #00019132' TO DFHEIV0
 20168     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20169     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20170     MOVE X'3520233030303139313332' TO DFHEIV0(25:11)
 20171     CALL 'kxdfhei1' USING DFHEIV0
 20172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20173
 20174
 20175
 20176* EXEC CICS STARTBR
 20177*        DATASET    (ACCT-ID)
 20178*        RIDFLD     (ERACCT-KEY)
 20179*        GTEQ
 20180*    END-EXEC.
 20181     MOVE 0
 20182       TO DFHEIV11
 20183*    MOVE '&,         G          &   #00019137' TO DFHEIV0
 20184     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20185     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20186     MOVE X'2020233030303139313337' TO DFHEIV0(25:11)
 20187     CALL 'kxdfhei1' USING DFHEIV0,
 20188           ACCT-ID,
 20189           ERACCT-KEY,
 20190           DFHEIV99,
 20191           DFHEIV11,
 20192           DFHEIV99
 20193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20194
 20195
 20196 8570-EXIT.
 20197     EXIT.
 20198
 20199 8580-READ-ACCOUNT-MASTER.
 20200
 20201* EXEC CICS HANDLE CONDITION
 20202*        NOTFND    (0199-ACCT-NOT-FOUND)
 20203*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20204*    END-EXEC.
 20205*    MOVE '"$I''                  ! 6 #00019147' TO DFHEIV0
 20206     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20208     MOVE X'3620233030303139313437' TO DFHEIV0(25:11)
 20209     CALL 'kxdfhei1' USING DFHEIV0
 20210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20211
 20212
 20213
 20214* EXEC CICS READNEXT
 20215*        DATASET     (ACCT-ID)
 20216*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 374
* EL050.cbl
 20217*        RIDFLD      (ERACCT-KEY)
 20218*    END-EXEC.
 20219     MOVE LENGTH OF
 20220      ACCOUNT-MASTER
 20221       TO DFHEIV12
 20222     MOVE 0
 20223       TO DFHEIV11
 20224*    MOVE '&.IL                  )   #00019152' TO DFHEIV0
 20225     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20226     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20227     MOVE X'2020233030303139313532' TO DFHEIV0(25:11)
 20228     CALL 'kxdfhei1' USING DFHEIV0,
 20229           ACCT-ID,
 20230           ACCOUNT-MASTER,
 20231           DFHEIV12,
 20232           ERACCT-KEY,
 20233           DFHEIV99,
 20234           DFHEIV11,
 20235           DFHEIV99,
 20236           DFHEIV99
 20237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20238
 20239
 20240 8580-EXIT.
 20241     EXIT.
 20242
 20243 8582-READ-COMPENSATION-MASTER.
 20244
 20245* EXEC CICS HANDLE CONDITION
 20246*        NOTFND    (8582-COMP-NOT-FOUND)
 20247*        ENDFILE   (8582-COMP-NOT-FOUND)
 20248*    END-EXEC.
 20249*    MOVE '"$I''                  ! 7 #00019162' TO DFHEIV0
 20250     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20252     MOVE X'3720233030303139313632' TO DFHEIV0(25:11)
 20253     CALL 'kxdfhei1' USING DFHEIV0
 20254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20255
 20256
 20257
 20258* EXEC CICS READ
 20259*        DATASET     (COMP-ID)
 20260*        INTO        (COMPENSATION-MASTER)
 20261*        RIDFLD      (ERCOMP-KEY)
 20262*    END-EXEC.
 20263     MOVE LENGTH OF
 20264      COMPENSATION-MASTER
 20265       TO DFHEIV11
 20266*    MOVE '&"IL       E          (   #00019167' TO DFHEIV0
 20267     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20268     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20269     MOVE X'2020233030303139313637' TO DFHEIV0(25:11)
 20270     CALL 'kxdfhei1' USING DFHEIV0,
 20271           COMP-ID,
 20272           COMPENSATION-MASTER,
 20273           DFHEIV11,
 20274           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 375
* EL050.cbl
 20275           DFHEIV99,
 20276           DFHEIV99,
 20277           DFHEIV99
 20278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20279
 20280
 20281     MOVE 'Y'                    TO COMP-MASTER-SW
 20282
 20283     GO TO 8582-EXIT
 20284     .
 20285 8582-COMP-NOT-FOUND.
 20286
 20287     MOVE 'N'                    TO COMP-MASTER-SW.
 20288
 20289 8582-EXIT.
 20290     EXIT.
 20291
 20292 8583-READ-ERAGTC.
 20293
 20294* EXEC CICS HANDLE CONDITION
 20295*        NOTFND    (8583-AGTC-NOT-FOUND)
 20296*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20297*    END-EXEC.
 20298*    MOVE '"$I''                  ! 8 #00019185' TO DFHEIV0
 20299     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20301     MOVE X'3820233030303139313835' TO DFHEIV0(25:11)
 20302     CALL 'kxdfhei1' USING DFHEIV0
 20303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20304
 20305
 20306
 20307* EXEC CICS STARTBR
 20308*        DATASET    (AGTC-ID)
 20309*        RIDFLD     (ERAGTC-KEY)
 20310*        GTEQ
 20311*    END-EXEC.
 20312     MOVE 0
 20313       TO DFHEIV11
 20314*    MOVE '&,         G          &   #00019190' TO DFHEIV0
 20315     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20316     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20317     MOVE X'2020233030303139313930' TO DFHEIV0(25:11)
 20318     CALL 'kxdfhei1' USING DFHEIV0,
 20319           AGTC-ID,
 20320           ERAGTC-KEY,
 20321           DFHEIV99,
 20322           DFHEIV11,
 20323           DFHEIV99
 20324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20325
 20326
 20327 8583-READ-ERAGTC-NEXT.
 20328
 20329* EXEC CICS READNEXT
 20330*        DATASET     (AGTC-ID)
 20331*        INTO        (AGENT-COMMISSIONS)
 20332*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 376
* EL050.cbl
 20333*    END-EXEC.
 20334     MOVE LENGTH OF
 20335      AGENT-COMMISSIONS
 20336       TO DFHEIV12
 20337     MOVE 0
 20338       TO DFHEIV11
 20339*    MOVE '&.IL                  )   #00019197' TO DFHEIV0
 20340     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20341     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20342     MOVE X'2020233030303139313937' TO DFHEIV0(25:11)
 20343     CALL 'kxdfhei1' USING DFHEIV0,
 20344           AGTC-ID,
 20345           AGENT-COMMISSIONS,
 20346           DFHEIV12,
 20347           ERAGTC-KEY,
 20348           DFHEIV99,
 20349           DFHEIV11,
 20350           DFHEIV99,
 20351           DFHEIV99
 20352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20353
 20354
 20355*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20356
 20357     GO TO 8583-EXIT
 20358     .
 20359 8583-AGTC-NOT-FOUND.
 20360
 20361     MOVE 'N'                    TO AGTC-MASTER-SW.
 20362
 20363 8583-EXIT.
 20364     EXIT.
 20365
 20366 8584-READ-BANK-CROSS-REF.
 20367
 20368* EXEC CICS HANDLE CONDITION
 20369*        NOTFND    (8584-BXRF-NOT-FOUND)
 20370*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20371*    END-EXEC.
 20372*    MOVE '"$I''                  ! 9 #00019215' TO DFHEIV0
 20373     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20375     MOVE X'3920233030303139323135' TO DFHEIV0(25:11)
 20376     CALL 'kxdfhei1' USING DFHEIV0
 20377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20378
 20379
 20380
 20381* EXEC CICS READ
 20382*        DATASET     (BXRF-ID)
 20383*        INTO        (BANK-CROSS-REFERENCE)
 20384*        RIDFLD      (ERBXRF-KEY)
 20385*        LENGTH      (BXRF-REC-LENGTH)
 20386*    END-EXEC.
 20387*    MOVE '&"IL       E          (   #00019220' TO DFHEIV0
 20388     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20389     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20390     MOVE X'2020233030303139323230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 377
* EL050.cbl
 20391     CALL 'kxdfhei1' USING DFHEIV0,
 20392           BXRF-ID,
 20393           BANK-CROSS-REFERENCE,
 20394           BXRF-REC-LENGTH,
 20395           ERBXRF-KEY,
 20396           DFHEIV99,
 20397           DFHEIV99,
 20398           DFHEIV99
 20399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20400
 20401
 20402     MOVE 'Y'                    TO BXRF-MASTER-SW
 20403
 20404     GO TO 8584-EXIT
 20405     .
 20406 8584-BXRF-NOT-FOUND.
 20407
 20408     MOVE 'N'                    TO BXRF-MASTER-SW.
 20409
 20410 8584-EXIT.
 20411     EXIT.
 20412
 20413 8585-READ-PLAN-MASTER.
 20414
 20415
 20416* EXEC CICS HANDLE CONDITION
 20417*        NOTFND    (8585-PLAN-NOT-FOUND)
 20418*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20419*    END-EXEC.
 20420*    MOVE '"$I''                  ! : #00019240' TO DFHEIV0
 20421     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20422     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20423     MOVE X'3A20233030303139323430' TO DFHEIV0(25:11)
 20424     CALL 'kxdfhei1' USING DFHEIV0
 20425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20426
 20427
 20428
 20429* EXEC CICS READ
 20430*        DATASET     (PLAN-ID)
 20431*        INTO        (PLAN-MASTER)
 20432*        RIDFLD      (ERPLAN-KEY)
 20433*    END-EXEC.
 20434     MOVE LENGTH OF
 20435      PLAN-MASTER
 20436       TO DFHEIV11
 20437*    MOVE '&"IL       E          (   #00019245' TO DFHEIV0
 20438     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20439     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20440     MOVE X'2020233030303139323435' TO DFHEIV0(25:11)
 20441     CALL 'kxdfhei1' USING DFHEIV0,
 20442           PLAN-ID,
 20443           PLAN-MASTER,
 20444           DFHEIV11,
 20445           ERPLAN-KEY,
 20446           DFHEIV99,
 20447           DFHEIV99,
 20448           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 378
* EL050.cbl
 20449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20450
 20451
 20452     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20453
 20454     GO TO 8585-EXIT.
 20455
 20456 8585-PLAN-NOT-FOUND.
 20457
 20458     MOVE 'N'                    TO PLAN-MASTER-SW.
 20459
 20460 8585-EXIT.
 20461     EXIT.
 20462
 20463 8586-READ-LOAN-OFFICER.
 20464
 20465* EXEC CICS READ
 20466*        DATASET     (LOFC-ID)
 20467*        INTO        (LOAN-OFFICER-MASTER)
 20468*        RIDFLD      (ERLOFC-KEY)
 20469*        RESP        (WS-RESPONSE)
 20470*    END-EXEC
 20471     MOVE LENGTH OF
 20472      LOAN-OFFICER-MASTER
 20473       TO DFHEIV11
 20474*    MOVE '&"IL       E          (  N#00019263' TO DFHEIV0
 20475     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20476     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20477     MOVE X'204E233030303139323633' TO DFHEIV0(25:11)
 20478     CALL 'kxdfhei1' USING DFHEIV0,
 20479           LOFC-ID,
 20480           LOAN-OFFICER-MASTER,
 20481           DFHEIV11,
 20482           ERLOFC-KEY,
 20483           DFHEIV99,
 20484           DFHEIV99,
 20485           DFHEIV99
 20486     MOVE EIBRESP  TO WS-RESPONSE
 20487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20488
 20489     IF WS-RESP-NORMAL
 20490        MOVE 'Y'                 TO LOFC-MASTER-SW
 20491     ELSE
 20492        MOVE 'N'                 TO LOFC-MASTER-SW
 20493     END-IF
 20494     .
 20495 8586-EXIT.
 20496     EXIT.
 20497 8587-START-ERPDEF.
 20498
 20499* EXEC CICS STARTBR
 20500*       DATASET   (PDEF-ID)
 20501*       RIDFLD    (ERPDEF-KEY)
 20502*       GTEQ
 20503*       RESP      (WS-RESPONSE)
 20504*    END-EXEC
 20505     MOVE 0
 20506       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 379
* EL050.cbl
 20507*    MOVE '&,         G          &  N#00019279' TO DFHEIV0
 20508     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20509     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20510     MOVE X'204E233030303139323739' TO DFHEIV0(25:11)
 20511     CALL 'kxdfhei1' USING DFHEIV0,
 20512           PDEF-ID,
 20513           ERPDEF-KEY,
 20514           DFHEIV99,
 20515           DFHEIV11,
 20516           DFHEIV99
 20517     MOVE EIBRESP  TO WS-RESPONSE
 20518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20519     IF WS-RESP-NORMAL
 20520        MOVE 'Y'                 TO PDEF-MASTER-SW
 20521     ELSE
 20522        MOVE 'N'                 TO PDEF-MASTER-SW
 20523     END-IF
 20524     .
 20525 8587-EXIT.
 20526     EXIT.
 20527 8588-READ-ERPDEF.
 20528
 20529* EXEC CICS READNEXT
 20530*       DATASET   (PDEF-ID)
 20531*       RIDFLD    (ERPDEF-KEY)
 20532*       INTO      (PRODUCT-MASTER)
 20533*       RESP      (WS-RESPONSE)
 20534*    END-EXEC
 20535     MOVE LENGTH OF
 20536      PRODUCT-MASTER
 20537       TO DFHEIV12
 20538     MOVE 0
 20539       TO DFHEIV11
 20540*    MOVE '&.IL                  )  N#00019294' TO DFHEIV0
 20541     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20542     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20543     MOVE X'204E233030303139323934' TO DFHEIV0(25:11)
 20544     CALL 'kxdfhei1' USING DFHEIV0,
 20545           PDEF-ID,
 20546           PRODUCT-MASTER,
 20547           DFHEIV12,
 20548           ERPDEF-KEY,
 20549           DFHEIV99,
 20550           DFHEIV11,
 20551           DFHEIV99,
 20552           DFHEIV99
 20553     MOVE EIBRESP  TO WS-RESPONSE
 20554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20555     IF WS-RESP-NORMAL
 20556        MOVE 'Y'                 TO PDEF-MASTER-SW
 20557     ELSE
 20558        MOVE 'N'                 TO PDEF-MASTER-SW
 20559     END-IF
 20560     .
 20561 8588-EXIT.
 20562     EXIT.
 20563 8589-ENDBR-ERPDEF.
 20564
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 380
* EL050.cbl
 20565* EXEC CICS ENDBR
 20566*       DATASET   (PDEF-ID)
 20567*    END-EXEC
 20568     MOVE 0
 20569       TO DFHEIV11
 20570*    MOVE '&2                    $   #00019309' TO DFHEIV0
 20571     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20572     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20573     MOVE X'2020233030303139333039' TO DFHEIV0(25:11)
 20574     CALL 'kxdfhei1' USING DFHEIV0,
 20575           PDEF-ID,
 20576           DFHEIV11,
 20577           DFHEIV99
 20578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20579     .
 20580 8589-EXIT.
 20581     EXIT.
 20582 8590-READ-CERT-MASTER.
 20583     IF PB-COMPANY-ID = 'UCL'
 20584         GO TO 8690-READ-CERT-MASTER-UCL.
 20585
 20586
 20587* EXEC CICS HANDLE CONDITION
 20588*         NOTFND    (0299-CERT-NOT-FOUND)
 20589*    END-EXEC.
 20590*    MOVE '"$I                   ! ; #00019319' TO DFHEIV0
 20591     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20592     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20593     MOVE X'3B20233030303139333139' TO DFHEIV0(25:11)
 20594     CALL 'kxdfhei1' USING DFHEIV0
 20595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20596
 20597
 20598
 20599* EXEC CICS READ
 20600*        DATASET     (CERT-ID)
 20601*        INTO        (CERTIFICATE-MASTER)
 20602*        RIDFLD      (ELCERT-KEY)
 20603*        UPDATE
 20604*    END-EXEC.
 20605     MOVE LENGTH OF
 20606      CERTIFICATE-MASTER
 20607       TO DFHEIV11
 20608*    MOVE '&"IL       EU         (   #00019323' TO DFHEIV0
 20609     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20610     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20611     MOVE X'2020233030303139333233' TO DFHEIV0(25:11)
 20612     CALL 'kxdfhei1' USING DFHEIV0,
 20613           CERT-ID,
 20614           CERTIFICATE-MASTER,
 20615           DFHEIV11,
 20616           ELCERT-KEY,
 20617           DFHEIV99,
 20618           DFHEIV99,
 20619           DFHEIV99
 20620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20621
 20622
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 381
* EL050.cbl
 20623 8590-EXIT.
 20624     EXIT.
 20625
 20626 8690-READ-CERT-MASTER-UCL.
 20627
 20628* EXEC CICS HANDLE CONDITION
 20629*         NOTFND    (8700-READ-CERT-MASTER)
 20630*    END-EXEC.
 20631*    MOVE '"$I                   ! < #00019334' TO DFHEIV0
 20632     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20633     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20634     MOVE X'3C20233030303139333334' TO DFHEIV0(25:11)
 20635     CALL 'kxdfhei1' USING DFHEIV0
 20636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20637
 20638
 20639 8690-READ-CERT-CONT.
 20640
 20641* EXEC CICS READ
 20642*        DATASET     (CERT-ID)
 20643*        INTO        (CERTIFICATE-MASTER)
 20644*        RIDFLD      (ELCERT-KEY)
 20645*        UPDATE
 20646*    END-EXEC.
 20647     MOVE LENGTH OF
 20648      CERTIFICATE-MASTER
 20649       TO DFHEIV11
 20650*    MOVE '&"IL       EU         (   #00019339' TO DFHEIV0
 20651     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20652     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20653     MOVE X'2020233030303139333339' TO DFHEIV0(25:11)
 20654     CALL 'kxdfhei1' USING DFHEIV0,
 20655           CERT-ID,
 20656           CERTIFICATE-MASTER,
 20657           DFHEIV11,
 20658           ELCERT-KEY,
 20659           DFHEIV99,
 20660           DFHEIV99,
 20661           DFHEIV99
 20662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20663
 20664
 20665     GO TO 8590-EXIT.
 20666
 20667 8700-READ-CERT-MASTER.
 20668     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20669     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20670
 20671* EXEC CICS HANDLE CONDITION
 20672*         DUPKEY    (8720-COMP-ACCOUNTS)
 20673*         ENDFILE   (8730-END-BROWSE)
 20674*         NOTFND    (8740-NOT-FOUND)
 20675*    END-EXEC.
 20676*    MOVE '"$$''I                 ! = #00019351' TO DFHEIV0
 20677     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20679     MOVE X'3D20233030303139333531' TO DFHEIV0(25:11)
 20680     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 382
* EL050.cbl
 20681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20682
 20683
 20684
 20685* EXEC CICS STARTBR
 20686*        DATASET     ('ELCERT5')
 20687*        RIDFLD      (ELCERT2-KEY)
 20688*        EQUAL
 20689*    END-EXEC.
 20690     MOVE 'ELCERT5' TO DFHEIV1
 20691     MOVE 0
 20692       TO DFHEIV11
 20693*    MOVE '&,         E          &   #00019357' TO DFHEIV0
 20694     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20695     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20696     MOVE X'2020233030303139333537' TO DFHEIV0(25:11)
 20697     CALL 'kxdfhei1' USING DFHEIV0,
 20698           DFHEIV1,
 20699           ELCERT2-KEY,
 20700           DFHEIV99,
 20701           DFHEIV11,
 20702           DFHEIV99
 20703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20704
 20705
 20706 8710-READ-NEXT.
 20707
 20708* EXEC CICS READNEXT
 20709*        DATASET     ('ELCERT5')
 20710*        INTO        (CERTIFICATE-MASTER)
 20711*        RIDFLD      (ELCERT2-KEY)
 20712*    END-EXEC.
 20713     MOVE LENGTH OF
 20714      CERTIFICATE-MASTER
 20715       TO DFHEIV12
 20716     MOVE 'ELCERT5' TO DFHEIV1
 20717     MOVE 0
 20718       TO DFHEIV11
 20719*    MOVE '&.IL                  )   #00019364' TO DFHEIV0
 20720     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20721     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20722     MOVE X'2020233030303139333634' TO DFHEIV0(25:11)
 20723     CALL 'kxdfhei1' USING DFHEIV0,
 20724           DFHEIV1,
 20725           CERTIFICATE-MASTER,
 20726           DFHEIV12,
 20727           ELCERT2-KEY,
 20728           DFHEIV99,
 20729           DFHEIV11,
 20730           DFHEIV99,
 20731           DFHEIV99
 20732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20733
 20734
 20735 8720-COMP-ACCOUNTS.
 20736
 20737* EXEC CICS ENTER
 20738*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 383
* EL050.cbl
 20739*         FROM (PB-C-LAST-NAME)
 20740*    END-EXEC.
 20741     MOVE 001
 20742       TO DFHEIV11
 20743*    MOVE ':$F                   %   #00019371' TO DFHEIV0
 20744     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20745     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20746     MOVE X'2020233030303139333731' TO DFHEIV0(25:11)
 20747     CALL 'kxdfhei1' USING DFHEIV0,
 20748           DFHEIV11,
 20749           PB-C-LAST-NAME,
 20750           DFHEIV99,
 20751           DFHEIV99
 20752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20753
 20754
 20755
 20756* EXEC CICS ENTER
 20757*         TRACEID (002)
 20758*         FROM (CM-INSURED-LAST-NAME)
 20759*    END-EXEC.
 20760     MOVE 002
 20761       TO DFHEIV11
 20762*    MOVE ':$F                   %   #00019376' TO DFHEIV0
 20763     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20764     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20765     MOVE X'2020233030303139333736' TO DFHEIV0(25:11)
 20766     CALL 'kxdfhei1' USING DFHEIV0,
 20767           DFHEIV11,
 20768           CM-INSURED-LAST-NAME,
 20769           DFHEIV99,
 20770           DFHEIV99
 20771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20772
 20773
 20774     IF PB-CERT-NO NOT = CM-CERT-NO
 20775         GO TO 8730-END-BROWSE.
 20776
 20777     IF PB-ACCOUNT = CM-ACCOUNT
 20778         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20779             MOVE ER-2799        TO WS-ERROR
 20780             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20781             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20782             GO TO 8730-END-BROWSE.
 20783
 20784     GO TO 8710-READ-NEXT.
 20785
 20786 8730-END-BROWSE.
 20787
 20788* EXEC CICS ENDBR
 20789*         DATASET    ('ELCERT5')
 20790*    END-EXEC.
 20791     MOVE 'ELCERT5' TO DFHEIV1
 20792     MOVE 0
 20793       TO DFHEIV11
 20794*    MOVE '&2                    $   #00019394' TO DFHEIV0
 20795     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20796     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 384
* EL050.cbl
 20797     MOVE X'2020233030303139333934' TO DFHEIV0(25:11)
 20798     CALL 'kxdfhei1' USING DFHEIV0,
 20799           DFHEIV1,
 20800           DFHEIV11,
 20801           DFHEIV99
 20802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20803
 20804
 20805 8740-NOT-FOUND.
 20806     GO TO 0299-CERT-NOT-FOUND.
 20807
 20808 8750-START-ELSTAT.
 20809
 20810* EXEC CICS STARTBR
 20811*       DATASET   (STAT-ID)
 20812*       RIDFLD    (ELSTAT-KEY)
 20813*       GTEQ
 20814*       RESP      (WS-RESPONSE)
 20815*    END-EXEC
 20816     MOVE 0
 20817       TO DFHEIV11
 20818*    MOVE '&,         G          &  N#00019402' TO DFHEIV0
 20819     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20820     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20821     MOVE X'204E233030303139343032' TO DFHEIV0(25:11)
 20822     CALL 'kxdfhei1' USING DFHEIV0,
 20823           STAT-ID,
 20824           ELSTAT-KEY,
 20825           DFHEIV99,
 20826           DFHEIV11,
 20827           DFHEIV99
 20828     MOVE EIBRESP  TO WS-RESPONSE
 20829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20830     IF WS-RESP-NORMAL
 20831        MOVE 'Y'                 TO STAT-MASTER-SW
 20832     ELSE
 20833        MOVE 'N'                 TO STAT-MASTER-SW
 20834     END-IF
 20835     .
 20836 8750-EXIT.
 20837     EXIT.
 20838 8752-READ-ELSTAT.
 20839
 20840* EXEC CICS READNEXT
 20841*       DATASET   (STAT-ID)
 20842*       RIDFLD    (ELSTAT-KEY)
 20843*       INTO      (STATE-FILE)
 20844*       RESP      (WS-RESPONSE)
 20845*    END-EXEC
 20846     MOVE LENGTH OF
 20847      STATE-FILE
 20848       TO DFHEIV12
 20849     MOVE 0
 20850       TO DFHEIV11
 20851*    MOVE '&.IL                  )  N#00019417' TO DFHEIV0
 20852     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20853     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20854     MOVE X'204E233030303139343137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 385
* EL050.cbl
 20855     CALL 'kxdfhei1' USING DFHEIV0,
 20856           STAT-ID,
 20857           STATE-FILE,
 20858           DFHEIV12,
 20859           ELSTAT-KEY,
 20860           DFHEIV99,
 20861           DFHEIV11,
 20862           DFHEIV99,
 20863           DFHEIV99
 20864     MOVE EIBRESP  TO WS-RESPONSE
 20865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20866     IF WS-RESP-NORMAL
 20867        MOVE 'Y'                 TO STAT-MASTER-SW
 20868     ELSE
 20869        MOVE 'N'                 TO STAT-MASTER-SW
 20870     END-IF
 20871     .
 20872 8752-EXIT.
 20873     EXIT.
 20874 8800-GET-COMP-RATE.
 20875     MOVE +1 TO IB.
 20876     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20877         ADD +9 TO IB
 20878         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20879             ADD +9 TO IB
 20880             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20881                MOVE ZEROS       TO WS-WK-RATE
 20882                GO TO 8800-EXIT.
 20883
 20884     IF PB-I-AGE GREATER CT-AGE (1)
 20885         ADD +3 TO IB
 20886         IF PB-I-AGE GREATER CT-AGE (2)
 20887             ADD +3 TO IB
 20888             IF PB-I-AGE GREATER CT-AGE (3)
 20889                MOVE ZEROS       TO WS-WK-RATE
 20890                GO TO 8800-EXIT.
 20891
 20892     IF WS-WORK-TERM GREATER CT-TRM (1)
 20893         ADD +1 TO IB
 20894         IF WS-WORK-TERM GREATER CT-TRM (2)
 20895             ADD +1 TO IB
 20896             IF WS-WORK-TERM GREATER CT-TRM (3)
 20897                MOVE ZEROS       TO WS-WK-RATE
 20898                GO TO 8800-EXIT.
 20899
 20900     IF CT-RT (IB) NOT NUMERIC
 20901         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20902         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20903         GO TO 8800-GET-COMP-RATE.
 20904
 20905     MOVE CT-RT (IB) TO WS-WK-RATE.
 20906
 20907 8800-EXIT.
 20908     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 386
* EL050.cbl
 20910 8900-ADDRESS-FILE.
 20911     IF ERACCT-FILE-ADDRESSED
 20912         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20913         GO TO 8900-ADDRESS-EXIT.
 20914
 20915     IF ELCNTL-FILE-ADDRESSED
 20916         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20917         GO TO 8900-ADDRESS-EXIT.
 20918
 20919     IF ERPLAN-FILE-ADDRESSED
 20920         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20921         GO TO 8900-ADDRESS-EXIT.
 20922
 20923     IF ERFORM-FILE-ADDRESSED
 20924         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20925         GO TO 8900-ADDRESS-EXIT.
 20926
 20927 8900-ADDRESS-EXIT.
 20928     EXIT.
 20929
 20930 9000-READ-CONTROL.
 20931
 20932* EXEC CICS HANDLE CONDITION
 20933*        NOTFND    (9000-NOTFND)
 20934*    END-EXEC.
 20935*    MOVE '"$I                   ! > #00019488' TO DFHEIV0
 20936     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20938     MOVE X'3E20233030303139343838' TO DFHEIV0(25:11)
 20939     CALL 'kxdfhei1' USING DFHEIV0
 20940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20941
 20942
 20943
 20944* EXEC CICS READ
 20945*        DATASET     (CNTL-ID)
 20946*        SET         (ADDRESS OF CONTROL-FILE)
 20947*        RIDFLD      (ELCNTL-KEY)
 20948*        GTEQ
 20949*    END-EXEC.
 20950*    MOVE '&"S        G          (   #00019492' TO DFHEIV0
 20951     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20953     MOVE X'2020233030303139343932' TO DFHEIV0(25:11)
 20954     CALL 'kxdfhei1' USING DFHEIV0,
 20955           CNTL-ID,
 20956           DFHEIV20,
 20957           DFHEIV99,
 20958           ELCNTL-KEY,
 20959           DFHEIV99,
 20960           DFHEIV99,
 20961           DFHEIV99
 20962     SET ADDRESS OF CONTROL-FILE TO
 20963         DFHEIV20
 20964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20965
 20966
 20967     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 387
* EL050.cbl
 20968
 20969 9000-NOTFND.
 20970     IF RC-SW-1 = '1'
 20971        MOVE ER-2616              TO WS-ERROR
 20972        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20973        GO TO 9000-EXIT.
 20974
 20975     IF RC-SW-1 = '2'
 20976        MOVE ER-2602              TO WS-ERROR
 20977        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20978
 20979 9000-EXIT.
 20980      EXIT.
 20981
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 388
* EL050.cbl
 20983 9100-READ-CONTROL.
 20984
 20985* EXEC CICS HANDLE CONDITION
 20986*        NOTFND  (9100-NOTFND)
 20987*        ENDFILE (9100-NOTFND)
 20988*    END-EXEC.
 20989*    MOVE '"$I''                  ! ? #00019516' TO DFHEIV0
 20990     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20991     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20992     MOVE X'3F20233030303139353136' TO DFHEIV0(25:11)
 20993     CALL 'kxdfhei1' USING DFHEIV0
 20994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20995
 20996
 20997
 20998* EXEC CICS READ
 20999*        DATASET     (CNTL-ID)
 21000*        INTO        (CONTROL-FILE)
 21001*        RIDFLD      (ELCNTL-KEY)
 21002*        GTEQ
 21003*    END-EXEC.
 21004     MOVE LENGTH OF
 21005      CONTROL-FILE
 21006       TO DFHEIV11
 21007*    MOVE '&"IL       G          (   #00019521' TO DFHEIV0
 21008     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21009     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21010     MOVE X'2020233030303139353231' TO DFHEIV0(25:11)
 21011     CALL 'kxdfhei1' USING DFHEIV0,
 21012           CNTL-ID,
 21013           CONTROL-FILE,
 21014           DFHEIV11,
 21015           ELCNTL-KEY,
 21016           DFHEIV99,
 21017           DFHEIV99,
 21018           DFHEIV99
 21019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21020
 21021
 21022     GO TO 9100-EXIT.
 21023
 21024 9100-NOTFND.
 21025     IF RC-SW-2 = '0'
 21026        MOVE '1'                  TO STATE-RECORD-ERROR
 21027        GO TO 9100-EXIT
 21028     END-IF
 21029     IF RC-SW-2 = '1'
 21030        MOVE '1'                  TO LF-BENEFIT-ERROR
 21031        MOVE ER-2604              TO WS-ERROR
 21032        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21033        GO TO 9100-EXIT.
 21034
 21035     IF RC-SW-2 = '2'
 21036        MOVE '1'                  TO AH-BENEFIT-ERROR
 21037        MOVE ER-2605              TO WS-ERROR
 21038        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21039        GO TO 9100-EXIT.
 21040
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 389
* EL050.cbl
 21041     IF RC-SW-2 = '3'
 21042         MOVE ER-2603           TO WS-ERROR
 21043         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21044         GO TO 9100-EXIT.
 21045
 21046     IF RC-SW-2 = '4'
 21047         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21048         GO TO 9100-EXIT.
 21049
 21050     IF RC-SW-2 = '5'
 21051         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21052         IF WS-AH-INPUT-CD-1 = SPACE
 21053             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21054         ELSE
 21055             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21056
 21057 9100-EXIT.
 21058      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 390
* EL050.cbl
 21060 9200-CONTROL-GETMAIN.
 21061
 21062* EXEC CICS GETMAIN
 21063*         LENGTH   (750)
 21064*         SET      (ADDRESS OF CONTROL-FILE)
 21065*    END-EXEC.
 21066     MOVE 750
 21067       TO DFHEIV11
 21068*    MOVE '," L                  $   #00019567' TO DFHEIV0
 21069     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21070     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21071     MOVE X'2020233030303139353637' TO DFHEIV0(25:11)
 21072     CALL 'kxdfhei1' USING DFHEIV0,
 21073           DFHEIV20,
 21074           DFHEIV11,
 21075           DFHEIV99
 21076     SET ADDRESS OF CONTROL-FILE TO
 21077         DFHEIV20
 21078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21079
 21080
 21081     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21082
 21083 9200-EXIT.
 21084     EXIT.
 21085
 21086 9250-UNLOCK-RETURN.
 21087
 21088* EXEC CICS UNLOCK
 21089*        DATASET   (CERT-ID)
 21090*    END-EXEC.
 21091*    MOVE '&*                    #   #00019578' TO DFHEIV0
 21092     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21093     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21094     MOVE X'2020233030303139353738' TO DFHEIV0(25:11)
 21095     CALL 'kxdfhei1' USING DFHEIV0,
 21096           CERT-ID,
 21097           DFHEIV99
 21098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21099
 21100
 21101 9300-ABEND.
 21102     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21103
 21104
 21105* EXEC CICS LINK
 21106*        PROGRAM   ('EL004')
 21107*        COMMAREA  (WS-ERROR-LINE)
 21108*        LENGTH    (72)
 21109*    END-EXEC.
 21110     MOVE 'EL004' TO DFHEIV1
 21111     MOVE 72
 21112       TO DFHEIV11
 21113*    MOVE '."C                   (   #00019585' TO DFHEIV0
 21114     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21115     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21116     MOVE X'2020233030303139353835' TO DFHEIV0(25:11)
 21117     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 391
* EL050.cbl
 21118           DFHEIV1,
 21119           WS-ERROR-LINE,
 21120           DFHEIV11,
 21121           DFHEIV99,
 21122           DFHEIV99,
 21123           DFHEIV99,
 21124           DFHEIV99
 21125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21126
 21127
 21128     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21129
 21130
 21131* EXEC CICS ABEND
 21132*        ABCODE ('EL50')
 21133*    END-EXEC.
 21134     MOVE 'EL50' TO DFHEIV5
 21135*    MOVE '.,A                   "   #00019593' TO DFHEIV0
 21136     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21137     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21138     MOVE X'2020233030303139353933' TO DFHEIV0(25:11)
 21139     CALL 'kxdfhei1' USING DFHEIV0,
 21140           DFHEIV5
 21141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21142
 21143
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 392
* EL050.cbl
 21145
 21146******************************************************************
 21147*                                                                *
 21148*            E R R O R   F O R M A T   R O U T I N E             *
 21149*                                                                *
 21150******************************************************************
 21151
 21152 9900-ERROR-FORMAT.
 21153
 21154     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21155                    PB-COMMON-ERROR (2) OR
 21156                    PB-COMMON-ERROR (3) OR
 21157                    PB-COMMON-ERROR (4) OR
 21158                    PB-COMMON-ERROR (5) OR
 21159                    PB-COMMON-ERROR (6) OR
 21160                    PB-COMMON-ERROR (7) OR
 21161                    PB-COMMON-ERROR (8) OR
 21162                    PB-COMMON-ERROR (9) OR
 21163                    PB-COMMON-ERROR (10)
 21164        GO TO 9900-EXIT.
 21165
 21166     IF PB-NO-OF-ERRORS = +10
 21167        GO TO 9900-EXIT.
 21168
 21169     ADD +1  TO PB-NO-OF-ERRORS.
 21170     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21171                                       (PB-NO-OF-ERRORS).
 21172 9900-EXIT.
 21173     EXIT.
 21174
 21175 9990-RETURN.
 21176     IF BROWSE-STARTED
 21177
 21178* EXEC CICS ENDBR
 21179*            DATASET  (ACCT-ID)
 21180*       END-EXEC.
 21181     MOVE 0
 21182       TO DFHEIV11
 21183*    MOVE '&2                    $   #00019630' TO DFHEIV0
 21184     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21185     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21186     MOVE X'2020233030303139363330' TO DFHEIV0(25:11)
 21187     CALL 'kxdfhei1' USING DFHEIV0,
 21188           ACCT-ID,
 21189           DFHEIV11,
 21190           DFHEIV99
 21191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21192
 21193
 21194 9990-EXIT.
 21195     EXIT.
 21196
 21197
 21198****Check for CRTO record, add one if not found.
 21199 9991-CHECK-FOR-ELCRTO.
 21200
 21201* EXEC CICS HANDLE CONDITION
 21202*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 393
* EL050.cbl
 21203*         ENDFILE (9991-CRTO-NOT-FOUND)
 21204*     END-EXEC.
 21205*    MOVE '"$I''                  ! @ #00019640' TO DFHEIV0
 21206     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21208     MOVE X'4020233030303139363430' TO DFHEIV0(25:11)
 21209     CALL 'kxdfhei1' USING DFHEIV0
 21210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21211
 21212     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21213     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21214     MOVE +0                     TO ELCRTO-SEQ-NO
 21215
 21216
 21217* EXEC CICS READ
 21218*       DATASET   ('ELCRTO')
 21219*       INTO      (ORIGINAL-CERTIFICATE)
 21220*       RIDFLD    (ELCRTO-KEY)
 21221*       GTEQ
 21222*       RESP      (WS-RESPONSE)
 21223*    END-EXEC
 21224     MOVE LENGTH OF
 21225      ORIGINAL-CERTIFICATE
 21226       TO DFHEIV11
 21227     MOVE 'ELCRTO' TO DFHEIV1
 21228*    MOVE '&"IL       G          (  N#00019648' TO DFHEIV0
 21229     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21230     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21231     MOVE X'204E233030303139363438' TO DFHEIV0(25:11)
 21232     CALL 'kxdfhei1' USING DFHEIV0,
 21233           DFHEIV1,
 21234           ORIGINAL-CERTIFICATE,
 21235           DFHEIV11,
 21236           ELCRTO-KEY,
 21237           DFHEIV99,
 21238           DFHEIV99,
 21239           DFHEIV99
 21240     MOVE EIBRESP  TO WS-RESPONSE
 21241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21242
 21243     IF WS-RESP-NORMAL
 21244        AND (OC-CONTROL-PRIMARY (1:33) =
 21245                 PB-CONTROL-BY-ACCOUNT (1:33))
 21246        AND (OC-RECORD-TYPE =  'I')
 21247           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21248               GO TO 9991-CHECK-INDICATORS
 21249           ELSE
 21250               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21251               GO TO 9991-CRTO-ADD-REC
 21252           END-IF
 21253     END-IF.
 21254
 21255 9991-CRTO-NOT-FOUND.
 21256
 21257     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21258     MOVE 'OC'                TO OC-RECORD-ID
 21259     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21260                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 394
* EL050.cbl
 21261     MOVE +4096               TO OC-KEY-SEQ-NO.
 21262
 21263 9991-CRTO-ADD-REC.
 21264
 21265     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21266     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21267     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21268     MOVE 'I'                 TO OC-RECORD-TYPE
 21269     IF PB-ISSUE
 21270         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21271         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21272         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21273         MOVE PB-I-AGE               TO OC-INS-AGE
 21274         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21275         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21276         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21277         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21278         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21279         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21280         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21281         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21282         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21283         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21284         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21285         IF PB-I-JOINT-COMMISSION > +0
 21286             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21287         ELSE
 21288             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21289         END-IF
 21290         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21291         MOVE +0                     TO OC-LF-CANCEL-AMT
 21292                                        OC-LF-ITD-CANCEL-AMT
 21293         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21294         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21295         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21296         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21297         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21298         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21299         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21300         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21301         MOVE +0                     TO OC-AH-CANCEL-AMT
 21302                                        OC-AH-ITD-CANCEL-AMT
 21303         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21304         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21305         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21306     ELSE
 21307         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21308         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21309         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21310         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21311         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21312         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21313         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21314         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21315         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21316          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21317             MOVE SPACES             TO OC-LF-BENCD
 21318             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 395
* EL050.cbl
 21319                                        OC-LF-BEN-AMT
 21320                                        OC-LF-PRM-AMT
 21321                                        OC-LF-ALT-BEN-AMT
 21322                                        OC-LF-ALT-PRM-AMT
 21323                                        OC-LF-COMM-PCT
 21324                                        OC-LF-CANCEL-AMT
 21325             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21326             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21327         ELSE
 21328             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21329             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21330             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21331             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21332             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21333             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21334             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21335             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21336             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21337             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21338         END-IF
 21339         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21340         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21341          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21342             MOVE SPACES             TO OC-AH-BENCD
 21343             MOVE ZEROS              TO OC-AH-TERM
 21344                                        OC-AH-BEN-AMT
 21345                                        OC-AH-PRM-AMT
 21346                                        OC-AH-COMM-PCT
 21347                                        OC-AH-CANCEL-AMT
 21348                                        OC-AH-CP
 21349             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21350             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21351         ELSE
 21352             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21353             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21354             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21355             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21356             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21357             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21358             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21359             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21360             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21361         END-IF
 21362         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21363         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21364         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21365         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21366     END-IF
 21367     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21368
 21369     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21370
 21371
 21372* EXEC CICS READ
 21373*         DATASET   (FILE-ERMAIL)
 21374*         RIDFLD    (MA-CONTROL-PRIMARY)
 21375*         INTO      (MAILING-DATA)
 21376*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 396
* EL050.cbl
 21377*    END-EXEC
 21378     MOVE LENGTH OF
 21379      MAILING-DATA
 21380       TO DFHEIV11
 21381*    MOVE '&"IL       E          (  N#00019784' TO DFHEIV0
 21382     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21383     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21384     MOVE X'204E233030303139373834' TO DFHEIV0(25:11)
 21385     CALL 'kxdfhei1' USING DFHEIV0,
 21386           FILE-ERMAIL,
 21387           MAILING-DATA,
 21388           DFHEIV11,
 21389           MA-CONTROL-PRIMARY,
 21390           DFHEIV99,
 21391           DFHEIV99,
 21392           DFHEIV99
 21393     MOVE EIBRESP  TO WS-RESPONSE
 21394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21395
 21396     IF WS-RESP-NORMAL
 21397         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21398     END-IF.
 21399
 21400     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21401     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21402
 21403
 21404* EXEC CICS READ
 21405*         DATASET  (CRTT-ID)
 21406*         RIDFLD   (WS-ELCRTT-KEY)
 21407*         INTO     (CERTIFICATE-TRAILERS)
 21408*         RESP     (WS-RESPONSE)
 21409*    END-EXEC
 21410     MOVE LENGTH OF
 21411      CERTIFICATE-TRAILERS
 21412       TO DFHEIV11
 21413*    MOVE '&"IL       E          (  N#00019798' TO DFHEIV0
 21414     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21416     MOVE X'204E233030303139373938' TO DFHEIV0(25:11)
 21417     CALL 'kxdfhei1' USING DFHEIV0,
 21418           CRTT-ID,
 21419           CERTIFICATE-TRAILERS,
 21420           DFHEIV11,
 21421           WS-ELCRTT-KEY,
 21422           DFHEIV99,
 21423           DFHEIV99,
 21424           DFHEIV99
 21425     MOVE EIBRESP  TO WS-RESPONSE
 21426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21427
 21428     IF WS-RESP-NORMAL
 21429         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21430         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21431     END-IF.
 21432
 21433
 21434* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 397
* EL050.cbl
 21435*       DATASET   ('ELCRTO')
 21436*       FROM      (ORIGINAL-CERTIFICATE)
 21437*       RIDFLD    (OC-CONTROL-PRIMARY)
 21438*       RESP      (WS-RESPONSE)
 21439*    END-EXEC.
 21440     MOVE LENGTH OF
 21441      ORIGINAL-CERTIFICATE
 21442       TO DFHEIV11
 21443     MOVE 'ELCRTO' TO DFHEIV1
 21444*    MOVE '&$ L                  ''  N#00019810' TO DFHEIV0
 21445     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21446     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21447     MOVE X'204E233030303139383130' TO DFHEIV0(25:11)
 21448     CALL 'kxdfhei1' USING DFHEIV0,
 21449           DFHEIV1,
 21450           ORIGINAL-CERTIFICATE,
 21451           DFHEIV11,
 21452           OC-CONTROL-PRIMARY,
 21453           DFHEIV99,
 21454           DFHEIV99
 21455     MOVE EIBRESP  TO WS-RESPONSE
 21456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21457
 21458
 21459     GO TO 9991-EXIT.
 21460
 21461 9991-CHECK-INDICATORS.
 21462
 21463     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21464         GO TO 9991-EXIT
 21465     END-IF.
 21466
 21467     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21468         GO TO 9991-EXIT
 21469     END-IF.
 21470
 21471
 21472* EXEC CICS READ
 21473*       DATASET   ('ELCRTO')
 21474*       INTO      (ORIGINAL-CERTIFICATE)
 21475*       RIDFLD    (OC-CONTROL-PRIMARY)
 21476*       UPDATE
 21477*       RESP      (WS-RESPONSE)
 21478*    END-EXEC
 21479     MOVE LENGTH OF
 21480      ORIGINAL-CERTIFICATE
 21481       TO DFHEIV11
 21482     MOVE 'ELCRTO' TO DFHEIV1
 21483*    MOVE '&"IL       EU         (  N#00019829' TO DFHEIV0
 21484     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21485     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21486     MOVE X'204E233030303139383239' TO DFHEIV0(25:11)
 21487     CALL 'kxdfhei1' USING DFHEIV0,
 21488           DFHEIV1,
 21489           ORIGINAL-CERTIFICATE,
 21490           DFHEIV11,
 21491           OC-CONTROL-PRIMARY,
 21492           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 398
* EL050.cbl
 21493           DFHEIV99,
 21494           DFHEIV99
 21495     MOVE EIBRESP  TO WS-RESPONSE
 21496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21497     IF WS-RESP-NORMAL
 21498        IF PB-ISSUE
 21499          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21500          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21501          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21502          MOVE PB-I-AGE               TO OC-INS-AGE
 21503          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21504          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21505          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21506          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21507          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21508          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21509          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21510          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21511          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21512          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21513          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21514          IF PB-I-JOINT-COMMISSION > +0
 21515              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21516          ELSE
 21517              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21518          END-IF
 21519          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21520          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21521          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21522          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21523          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21524          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21525          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21526          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21527          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21528
 21529          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21530
 21531* EXEC CICS READ
 21532*             DATASET   (FILE-ERMAIL)
 21533*             RIDFLD    (MA-CONTROL-PRIMARY)
 21534*             INTO      (MAILING-DATA)
 21535*             RESP      (WS-RESPONSE)
 21536*         END-EXEC
 21537     MOVE LENGTH OF
 21538      MAILING-DATA
 21539       TO DFHEIV11
 21540*    MOVE '&"IL       E          (  N#00019869' TO DFHEIV0
 21541     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21542     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21543     MOVE X'204E233030303139383639' TO DFHEIV0(25:11)
 21544     CALL 'kxdfhei1' USING DFHEIV0,
 21545           FILE-ERMAIL,
 21546           MAILING-DATA,
 21547           DFHEIV11,
 21548           MA-CONTROL-PRIMARY,
 21549           DFHEIV99,
 21550           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 399
* EL050.cbl
 21551           DFHEIV99
 21552     MOVE EIBRESP  TO WS-RESPONSE
 21553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21554          IF WS-RESP-NORMAL
 21555             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21556          END-IF
 21557
 21558          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21559          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21560
 21561* EXEC CICS READ
 21562*             DATASET  (CRTT-ID)
 21563*             RIDFLD   (WS-ELCRTT-KEY)
 21564*             INTO     (CERTIFICATE-TRAILERS)
 21565*             RESP     (WS-RESPONSE)
 21566*         END-EXEC
 21567     MOVE LENGTH OF
 21568      CERTIFICATE-TRAILERS
 21569       TO DFHEIV11
 21570*    MOVE '&"IL       E          (  N#00019881' TO DFHEIV0
 21571     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21572     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21573     MOVE X'204E233030303139383831' TO DFHEIV0(25:11)
 21574     CALL 'kxdfhei1' USING DFHEIV0,
 21575           CRTT-ID,
 21576           CERTIFICATE-TRAILERS,
 21577           DFHEIV11,
 21578           WS-ELCRTT-KEY,
 21579           DFHEIV99,
 21580           DFHEIV99,
 21581           DFHEIV99
 21582     MOVE EIBRESP  TO WS-RESPONSE
 21583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21584          IF WS-RESP-NORMAL
 21585             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21586                               OC-INS-AGE-DEFAULT-FLAG
 21587             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21588                               OC-JNT-AGE-DEFAULT-FLAG
 21589          END-IF
 21590
 21591        ELSE
 21592          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21593             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21594             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21595             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21596          END-IF
 21597          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21598             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21599             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21600             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21601          END-IF
 21602          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21603        END-IF
 21604
 21605* EXEC CICS REWRITE
 21606*          DATASET   ('ELCRTO')
 21607*          FROM      (ORIGINAL-CERTIFICATE)
 21608*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 400
* EL050.cbl
 21609*       END-EXEC
 21610     MOVE LENGTH OF
 21611      ORIGINAL-CERTIFICATE
 21612       TO DFHEIV11
 21613     MOVE 'ELCRTO' TO DFHEIV1
 21614*    MOVE '&& L                  %  N#00019907' TO DFHEIV0
 21615     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21616     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21617     MOVE X'204E233030303139393037' TO DFHEIV0(25:11)
 21618     CALL 'kxdfhei1' USING DFHEIV0,
 21619           DFHEIV1,
 21620           ORIGINAL-CERTIFICATE,
 21621           DFHEIV11,
 21622           DFHEIV99
 21623     MOVE EIBRESP  TO WS-RESPONSE
 21624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21625     END-IF.
 21626
 21627 9991-EXIT.
 21628     EXIT.
 21629
 21630
 21631 9999-RETURN.
 21632     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21633
 21634
 21635* EXEC CICS RETURN
 21636*    END-EXEC.
 21637*    MOVE '.(                    ''   #00019921' TO DFHEIV0
 21638     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21639     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21640     MOVE X'2020233030303139393231' TO DFHEIV0(25:11)
 21641     CALL 'kxdfhei1' USING DFHEIV0,
 21642           DFHEIV99,
 21643           DFHEIV99,
 21644           DFHEIV99,
 21645           DFHEIV99,
 21646           DFHEIV99,
 21647           DFHEIV99
 21648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21649
 21650
 21651
 21652* GOBACK.
 21653     MOVE '9%                    "   ' TO DFHEIV0
 21654     MOVE 'EL050' TO DFHEIV1
 21655     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21656     GOBACK.
 21657
 21658 9999-DFHBACK SECTION.
 21659     MOVE '9%                    "   ' TO DFHEIV0
 21660     MOVE 'EL050' TO DFHEIV1
 21661     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21662     GOBACK.
 21663 9999-DFHEXIT.
 21664     IF DFHEIGDJ EQUAL 0001
 21665         NEXT SENTENCE
 21666     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 401
* EL050.cbl
 21667         GO TO 9300-ABEND,
 21668               3990-FILES-NOT-OPEN
 21669         DEPENDING ON DFHEIGDI
 21670     ELSE IF DFHEIGDJ EQUAL 3
 21671         GO TO 6610-START-BROWSE,
 21672               6630-ERRESS-PROBLEM,
 21673               6630-END-OF-FILE
 21674         DEPENDING ON DFHEIGDI
 21675     ELSE IF DFHEIGDJ EQUAL 4
 21676         GO TO 6630-END-OF-FILE,
 21677               6630-ERRESS-PROBLEM,
 21678               6630-ERRESS-PROBLEM,
 21679               6630-END-OF-FILE
 21680         DEPENDING ON DFHEIGDI
 21681     ELSE IF DFHEIGDJ EQUAL 5
 21682         GO TO 6630-END-OF-FILE,
 21683               6630-END-OF-FILE,
 21684               6630-ERRESS-PROBLEM,
 21685               6630-ERRESS-PROBLEM
 21686         DEPENDING ON DFHEIGDI
 21687     ELSE IF DFHEIGDJ EQUAL 6
 21688         GO TO 6660-START-BROWSE,
 21689               6690-ERRESC-PROBLEM,
 21690               6690-ERRESC-PROBLEM,
 21691               6690-END-OF-FILE
 21692         DEPENDING ON DFHEIGDI
 21693     ELSE IF DFHEIGDJ EQUAL 7
 21694         GO TO 6690-END-OF-FILE,
 21695               6690-ERRESC-PROBLEM,
 21696               6690-ERRESC-PROBLEM,
 21697               6690-END-OF-FILE
 21698         DEPENDING ON DFHEIGDI
 21699     ELSE IF DFHEIGDJ EQUAL 8
 21700         GO TO 6690-END-OF-FILE,
 21701               6690-ERRESC-PROBLEM,
 21702               6690-ERRESC-PROBLEM,
 21703               6690-END-OF-FILE
 21704         DEPENDING ON DFHEIGDI
 21705     ELSE IF DFHEIGDJ EQUAL 9
 21706         GO TO 7250-CONTINUE,
 21707               7250-CONTINUE
 21708         DEPENDING ON DFHEIGDI
 21709     ELSE IF DFHEIGDJ EQUAL 10
 21710         GO TO 7300-CONTINUE,
 21711               7300-CONTINUE
 21712         DEPENDING ON DFHEIGDI
 21713     ELSE IF DFHEIGDJ EQUAL 11
 21714         GO TO 8000-FREE-MAIN
 21715         DEPENDING ON DFHEIGDI
 21716     ELSE IF DFHEIGDJ EQUAL 12
 21717         GO TO 8100-NOTFND,
 21718               8100-NOTFND
 21719         DEPENDING ON DFHEIGDI
 21720     ELSE IF DFHEIGDJ EQUAL 13
 21721         GO TO 8110-NOTFND,
 21722               8110-NOTFND
 21723         DEPENDING ON DFHEIGDI
 21724     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 402
* EL050.cbl
 21725         GO TO 8130-EXIT
 21726         DEPENDING ON DFHEIGDI
 21727     ELSE IF DFHEIGDJ EQUAL 15
 21728         GO TO 8180-NOTFND
 21729         DEPENDING ON DFHEIGDI
 21730     ELSE IF DFHEIGDJ EQUAL 16
 21731         GO TO 8190-NOTFND
 21732         DEPENDING ON DFHEIGDI
 21733     ELSE IF DFHEIGDJ EQUAL 17
 21734         GO TO 8195-NOTFND
 21735         DEPENDING ON DFHEIGDI
 21736     ELSE IF DFHEIGDJ EQUAL 18
 21737         GO TO 8200-NOTFND
 21738         DEPENDING ON DFHEIGDI
 21739     ELSE IF DFHEIGDJ EQUAL 19
 21740         GO TO 8300-NOTFND,
 21741               8300-ERRESS-PROBLEM,
 21742               8300-ERRESS-PROBLEM,
 21743               8300-NOTFND
 21744         DEPENDING ON DFHEIGDI
 21745     ELSE IF DFHEIGDJ EQUAL 20
 21746         GO TO 8450-FORM-NOT-FOUND,
 21747               8450-FORM-NOT-FOUND
 21748         DEPENDING ON DFHEIGDI
 21749     ELSE IF DFHEIGDJ EQUAL 21
 21750         GO TO 0199-ACCT-NOT-FOUND,
 21751               0199-ACCT-NOT-FOUND
 21752         DEPENDING ON DFHEIGDI
 21753     ELSE IF DFHEIGDJ EQUAL 22
 21754         GO TO 0199-ACCT-NOT-FOUND,
 21755               0199-ACCT-NOT-FOUND
 21756         DEPENDING ON DFHEIGDI
 21757     ELSE IF DFHEIGDJ EQUAL 23
 21758         GO TO 8582-COMP-NOT-FOUND,
 21759               8582-COMP-NOT-FOUND
 21760         DEPENDING ON DFHEIGDI
 21761     ELSE IF DFHEIGDJ EQUAL 24
 21762         GO TO 8583-AGTC-NOT-FOUND,
 21763               8583-AGTC-NOT-FOUND
 21764         DEPENDING ON DFHEIGDI
 21765     ELSE IF DFHEIGDJ EQUAL 25
 21766         GO TO 8584-BXRF-NOT-FOUND,
 21767               8584-BXRF-NOT-FOUND
 21768         DEPENDING ON DFHEIGDI
 21769     ELSE IF DFHEIGDJ EQUAL 26
 21770         GO TO 8585-PLAN-NOT-FOUND,
 21771               8585-PLAN-NOT-FOUND
 21772         DEPENDING ON DFHEIGDI
 21773     ELSE IF DFHEIGDJ EQUAL 27
 21774         GO TO 0299-CERT-NOT-FOUND
 21775         DEPENDING ON DFHEIGDI
 21776     ELSE IF DFHEIGDJ EQUAL 28
 21777         GO TO 8700-READ-CERT-MASTER
 21778         DEPENDING ON DFHEIGDI
 21779     ELSE IF DFHEIGDJ EQUAL 29
 21780         GO TO 8720-COMP-ACCOUNTS,
 21781               8730-END-BROWSE,
 21782               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:51 Page 403
* EL050.cbl
 21783         DEPENDING ON DFHEIGDI
 21784     ELSE IF DFHEIGDJ EQUAL 30
 21785         GO TO 9000-NOTFND
 21786         DEPENDING ON DFHEIGDI
 21787     ELSE IF DFHEIGDJ EQUAL 31
 21788         GO TO 9100-NOTFND,
 21789               9100-NOTFND
 21790         DEPENDING ON DFHEIGDI
 21791     ELSE IF DFHEIGDJ EQUAL 32
 21792         GO TO 9991-CRTO-NOT-FOUND,
 21793               9991-CRTO-NOT-FOUND
 21794         DEPENDING ON DFHEIGDI.
 21795     MOVE '9%                    "   ' TO DFHEIV0
 21796     MOVE 'EL050' TO DFHEIV1
 21797     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21798     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39992     Code:       87839
