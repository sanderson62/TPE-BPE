* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL652.cbl
* Options: int("EL652.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL652.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL652.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL652.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL652 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 09/14/94 07:57:28.
     7*                            VMOD=2.059
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11*
    12*REMARKS.
    13*        TRANSACTION - EXD4 - COMPENSATION MASTER MAINT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL652.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    24* 102202    2002032200002  SMVA  ADD PF8 KEY FOR COMP MSTR NOTES
    25* 111103    2003080800002  PEMA  ADD BANKFEE,CLPST,MAXFEE  & PF10
    26*                                FOR SECURE PAY
    27* 111204    2004110300005  PEMA  SPLIT AGENT COMMISSION CHANGES
    28* 033105    2005031100003  PEMA  ADD VALID TYPE OF 'B' (BANK)
    29* 042005    2005031100004  PEMA  ALLOW UPDATES TO PCONT FOR 'B'
    30* 042005                         AND 'G' RECORD TYPES.
    31* 092205    2005050300006  PEMA  ADD LEASE FEES
    32* 041106    2006022800001  AJRA  INIT CO-FIRST-WRITTEN-DT ON ADD
    33* 060506    2002061100007  PEMA  ADD CODES TO ERCOMP FILE
    34* 072406    2006022400001  PEMA  ADD REFUND ONLY EDIT
    35* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    36* 043007  IR2007042600002  PEMA  TURN OFF YTDCOMM ATTR
    37* 102908  CR2007052100005  PEMA  UNPROT PCONT ATTRB
    38* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    39* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    40* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    41******************************************************************
    42
    43 ENVIRONMENT DIVISION.
    44 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL652.cbl
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL652 WORKING STORAGE     *'.
    50 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.059 *********'.
    51 77  WS-TOT-FEES                 PIC S9(3)V99 COMP-3 VALUE +0.
    52 77  S1                          PIC S999 VALUE +0 COMP-3.
    53
    54 01  WS-DATE-AREA.
    55     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    56     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    57
    58 01  STANDARD-AREAS.
    59     12  WS-RESPONSE             PIC S9(8)   COMP.
    60         88  RESP-NORMAL                  VALUE +00.
    61         88  RESP-NOTFND                  VALUE +13.
    62         88  RESP-NOTOPEN                 VALUE +19.
    63         88  RESP-ENDFILE                 VALUE +20.
    64     12  RETURNED-FROM       PIC X(8)        VALUE SPACES.
    65     12  QID-PI.
    66         16  QID-TERM        PIC X(4).
    67         16  FILLER          PIC X(4)        VALUE '652A'.
    68     12  QID-ITEM            PIC S9(4) COMP  VALUE +0001.
    69     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
    70     12  MAP-NAME            PIC  X(8)       VALUE 'EL652A'.
    71     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL652S'.
    72     12  TRANS-ID            PIC  X(4)       VALUE 'EXD4'.
    73     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
    74     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
    75     12  EL633-TRANS-ID      PIC  X(4)       VALUE 'EXB7'.
    76     12  EL633DMD-TRANS-ID   PIC  X(4)       VALUE 'EX1F'.
    77     12  EL635-TRANS-ID      PIC  X(4)       VALUE 'EXJ4'.
    78     12  EL6501-TRANS-ID     PIC  X(4)       VALUE 'EXC5'.
    79     12  EL6592-TRANS-ID     PIC  X(4)       VALUE 'EX66'.
    80     12  EL856-TRANS-ID      PIC  X(4)       VALUE 'EXJ8'.
    81     12  EM6508-TRANS-ID     PIC  X(4)       VALUE 'MXG8'.
    82     12  THIS-PGM            PIC  X(8)       VALUE 'EL652'.
    83     12  PGM-NAME            PIC  X(8).
    84     12  WS-COMP-CD-R.
    85         16  FILLER          PIC  X.
    86         16  WS-COMP-CD-X    PIC  X.
    87     12  WS-COMP-CD  REDEFINES
    88         WS-COMP-CD-R        PIC S9(4)                  COMP.
    89     12  TIME-IN             PIC S9(7).
    90     12  TIME-OUT-R  REDEFINES  TIME-IN.
    91         16  FILLER          PIC  X.
    92         16  TIME-OUT        PIC  99V99.
    93         16  FILLER          PIC  XX.
    94     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
    95     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
    96     12  XCTL-126            PIC  X(8)       VALUE 'EL126'.
    97     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
    98     12  XCTL-633            PIC  X(8)       VALUE 'EL633'.
    99     12  XCTL-633DMD         PIC  X(8)       VALUE 'EL633DMD'.
   100     12  XCTL-635            PIC  X(8)       VALUE 'EL635'.
   101     12  XCTL-650            PIC  X(8)       VALUE 'EL650'.
   102     12  XCTL-6521           PIC  X(8)       VALUE 'EL6521'.
   103     12  XCTL-6522           PIC  X(8)       VALUE 'EL6522'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL652.cbl
   104     12  XCTL-6523           PIC  X(8)       VALUE 'EL6523'.
   105     12  XCTL-6524           PIC  X(8)       VALUE 'EL6524'.
   106     12  XCTL-689            PIC  X(8)       VALUE 'EL689'.
   107     12  XCTL-690            PIC  X(8)       VALUE 'EL690'.
   108     12  XCTL-856            PIC  X(8)       VALUE 'EL856'.
   109     12  XCTL-EM626          PIC  X(8)       VALUE 'EM626'.
   110     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   111     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   112     12  LINK-ELDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   113     12  FILE-ID             PIC  X(8)       VALUE SPACES.
   114     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   115     12  NAME-FILE-ID        PIC  X(8)       VALUE 'ERNAME'.
   116     12  CNTL-FILE-ID        PIC  X(8)       VALUE 'ELCNTL'.
   117     12  SUMM-FILE-ID        PIC  X(8)       VALUE 'ERSUMM'.
   118     12  RQST-FILE-ID        PIC  X(8)       VALUE 'ERRQST'.
   119     12  RQST-FILE-ID-3      PIC  X(8)       VALUE 'ERRQST3'.
   120
   121 01  MISC-WORK-AREAS.
   122     12  WS-SRCH-STATE       PIC X(30)  VALUE SPACES.
   123     12  STNDX               PIC S999   COMP-3 VALUE +0.
   124     12  W-APPL-SCRTY-NDX    PIC S9(04) COMP   VALUE +35.
   125     12  WS-PHONE-IN         PIC  9(10).
   126     12  WS-PHONE-IN-R  REDEFINES  WS-PHONE-IN.
   127         16  WSPI-AREA       PIC  X(3).
   128         16  WSPI-PFX        PIC  X(3).
   129         16  WSPI-SFX        PIC  X(4).
   130     12  WS-PHONE-OUT.
   131         16  WSPO-AREA       PIC  X(3).
   132         16  FILLER          PIC  X            VALUE '-'.
   133         16  WSPO-PFX        PIC  X(3).
   134         16  FILLER          PIC  X            VALUE '-'.
   135         16  WSPO-SFX        PIC  X(4).
   136     12  DEEDIT-FIELD        PIC  X(15).
   137     12  DEEDIT-FIELD-V0  REDEFINES
   138         DEEDIT-FIELD        PIC S9(15).
   139     12  DEEDIT-FIELD-V1  REDEFINES
   140         DEEDIT-FIELD        PIC S9(13)V99.
   141     12  SUB1                PIC S9(4)         VALUE +0   COMP.
   142     12  SUB2                PIC S9(4)         VALUE +0   COMP.
   143     12  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   144     12  ERCOMP-LENGTH       PIC S9(4)         VALUE +700 COMP.
   145     12  ERSUMM-LENGTH       PIC S9(4)         VALUE +150 COMP.
   146     12  ERNAME-LENGTH       PIC S9(4)         VALUE +160 COMP.
   147     12  SV-CLMTOL           PIC  9(3)V99      VALUE ZEROS.
   148     12  WK-DATE.
   149         16  WK-MO           PIC  99.
   150         16  WK-DA           PIC  99.
   151         16  WK-YR           PIC  99.
   152     12  DATE-TEST-AREA      PIC  9(6).
   153     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   154         16  DATE-TEST-MM    PIC  99.
   155         16  DATE-TEST-DD    PIC  99.
   156         16  DATE-TEST-YY    PIC  99.
   157     12  DIVIDE-RESULT       PIC  99.
   158     12  DIVIDE-REMAINDER    PIC  9.
   159     12  WS-ZERO             PIC  X            VALUE '0'.
   160     12  WS-ONE              PIC  X            VALUE '1'.
   161     12  WS-TWO              PIC  X            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL652.cbl
   162     12  WS-ACCESS.
   163         16  FILLER          PIC  X(3)         VALUE SPACES.
   164         16  WS-CARRIER      PIC  X.
   165     12  BIN-CURRENT-SAVE    PIC  XX.
   166     12  WS-BROWSE-SW        PIC  X.
   167         88  BROWSE-STARTED                    VALUE 'Y'.
   168     12  WS-SAVE-KEY         PIC  X(29)        VALUE SPACES.
   169     12  WS-SAVE-SUMM        PIC  X(6)         VALUE SPACES.
   170     12  WS-SUMM-FOR-RQST    PIC  X(6)         VALUE SPACES.
   171     12  WS-SAVE-RQST        PIC X(46)         VALUE SPACES.
   172     12  WS-SHOW-SAVE-TOTALS PIC  X            VALUE SPACE.
   173         88  SHOW-SAVE-TOTALS                  VALUE 'Y'.
   174     12  ELCNTL-KEY.
   175         16  CNTL-COMP-ID    PIC  X(3)         VALUE SPACES.
   176         16  CNTL-REC-TYPE   PIC  X            VALUE SPACES.
   177         16  CNTL-ACCESS     PIC  X(4)         VALUE SPACES.
   178         16  CNTL-SEQ-NO     PIC S9(4)         VALUE +0   COMP.
   179     12  ELCNTL-KEY2.
   180         16  CNTL-COMP-ID-2  PIC  X(3)         VALUE SPACES.
   181         16  CNTL-REC-TYPE-2 PIC  X            VALUE SPACES.
   182         16  CNTL-STATE-2    PIC  X(2)         VALUE SPACES.
   183         16  FILLER          PIC  X(2)         VALUE SPACES.
   184         16  CNTL-SEQ-NO-2   PIC S9(4)         VALUE +0   COMP.
   185     12  ERSUMM-KEY.
   186         16  SUMM-COMP-ID    PIC  X            VALUE SPACES.
   187         16  SUMM-SUMMARY    PIC  X(6)         VALUE SPACES.
   188         16  SUMM-CARRIER    PIC  X            VALUE SPACES.
   189         16  SUMM-GROUP      PIC  X(6)         VALUE SPACES.
   190         16  SUMM-FIN-RESP   PIC  X(10)        VALUE SPACES.
   191         16  SUMM-ACCT-AGENT PIC  X(10)        VALUE SPACES.
   192     12  ERRQST-KEY.
   193         16  RQST-COMP-ID-PC PIC  X            VALUE SPACES.
   194         16  RQST-BATCH-PC   PIC  X(6)         VALUE SPACES.
   195     12  ERRQST-KEY-3.
   196         16  RQST-COMP-ID    PIC  X            VALUE SPACES.
   197         16  RQST-CARRIER    PIC  X            VALUE SPACES.
   198         16  RQST-GROUP      PIC  X(6)         VALUE SPACES.
   199         16  RQST-FIN-RESP   PIC  X(10)        VALUE SPACES.
   200         16  RQST-ACCT-AGENT PIC  X(10)        VALUE SPACES.
   201         16  RQST-REFERENCE  PIC  X(12)        VALUE SPACES.
   202         16  RQST-BATCH      PIC  X(06)        VALUE SPACES.
   203     12  WS-DATE-MDY-8.
   204         16  WS-DMDY8-MM     PIC  XX.
   205         16  WS-DMDY8-SL1    PIC  X.
   206         16  WS-DMDY8-DD     PIC  XX.
   207         16  WS-DMDY8-SL2    PIC  X.
   208         16  WS-DMDY8-YY     PIC  XX.
   209     12  WS-DATE-MDY-6  REDEFINES  WS-DATE-MDY-8.
   210         16  WS-DMDY6-MM     PIC  XX.
   211         16  WS-DMDY6-DD     PIC  XX.
   212         16  WS-DMDY6-YY     PIC  XX.
   213         16  WS-DMDY6-BLNK   PIC  XX.
   214     12  WS-YMD-DATE.
   215         16  WS-YMD-YY       PIC  XX.
   216         16  WS-YMD-MM       PIC  XX.
   217         16  WS-YMD-DD       PIC  XX.
   218     12  WS-YMD-DATE-NUM  REDEFINES
   219         WS-YMD-DATE         PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL652.cbl
   220     12  WS-SAVE-SUMMARY     PIC X(6)          VALUE SPACES.
   221     12  WS-SAVE-NAME        PIC X(30)         VALUE SPACES.
   222     12  WS-SAVE-BALFWD      PIC S9(7)V99      VALUE +0   COMP-3.
   223     12  WS-SAVE-CURCOM      PIC S9(7)V99      VALUE +0   COMP-3.
   224     12  WS-SAVE-CURCHG      PIC S9(7)V99      VALUE +0   COMP-3.
   225     12  WS-SAVE-CURPMT      PIC S9(7)V99      VALUE +0   COMP-3.
   226     12  WS-SAVE-ENDBAL      PIC S9(7)V99      VALUE +0   COMP-3.
   227     12  WS-SAVE-YTDCOM      PIC S9(7)V99      VALUE +0   COMP-3.
   228     12  WS-SOC-SEC-WORK-FIELD.
   229         16  WS-SS-TYPE          PIC X.
   230         16  WS-SOC-SEC          PIC X(12).
   231
   232     12  WS-ZIP-CODE.
   233         16  WS-ZIP-1            PIC X.
   234             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   235         16  WS-ZIP-2-3          PIC XX.
   236         16  WS-ZIP-4            PIC X.
   237         16  WS-ZIP-5            PIC X.
   238         16  WS-ZIP-6            PIC X.
   239         16  FILLER              PIC X(4).
   240     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   241         16  WS-ZIP-AM-1-CODE    PIC X(5).
   242         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   243         16  FILLER              PIC X.
   244     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   245         16  WS-ZIP-AM-2-CODE    PIC X(5).
   246         16  WS-ZIP-AM-2-DASH    PIC X.
   247         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   248     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   249         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   250         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   251         16  FILLER              PIC X(4).
   252     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   253         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   254         16  FILLER              PIC X.
   255         16  WS-ZIP-CAN-2-POST2  PIC XXX.
   256         16  FILLER              PIC XXX.
   257
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL652.cbl
   259 01  ERROR-NUMBERS.
   260     12  ER-0000             PIC  X(4)       VALUE '0000'.
   261     12  ER-0002             PIC  X(4)       VALUE '0002'.
   262     12  ER-0004             PIC  X(4)       VALUE '0004'.
   263     12  ER-0008             PIC  X(4)       VALUE '0008'.
   264     12  ER-0029             PIC  X(4)       VALUE '0029'.
   265     12  ER-0033             PIC  X(4)       VALUE '0033'.
   266     12  ER-0035             PIC  X(4)       VALUE '0035'.
   267     12  ER-0046             PIC  X(4)       VALUE '0046'.
   268     12  ER-0068             PIC  X(4)       VALUE '0068'.
   269     12  ER-0070             PIC  X(4)       VALUE '0070'.
   270     12  ER-0142             PIC  X(4)       VALUE '0142'.
   271     12  ER-0144             PIC  X(4)       VALUE '0144'.
   272     12  ER-0187             PIC  X(4)       VALUE '0187'.
   273     12  ER-0193             PIC  X(4)       VALUE '0193'.
   274     12  ER-0314             PIC  X(4)       VALUE '0314'.
   275     12  ER-0584             PIC  X(4)       VALUE '0584'.
   276     12  ER-0829             PIC  X(4)       VALUE '0829'.
   277     12  ER-1299             PIC  X(4)       VALUE '1299'.
   278     12  ER-1778             PIC  X(4)       VALUE '1778'.
   279     12  ER-1883             PIC  X(4)       VALUE '1883'.
   280     12  ER-2039             PIC  X(4)       VALUE '2039'.
   281     12  ER-2042             PIC  X(4)       VALUE '2042'.
   282     12  ER-2045             PIC  X(4)       VALUE '2045'.
   283     12  ER-2046             PIC  X(4)       VALUE '2046'.
   284     12  ER-2047             PIC  X(4)       VALUE '2047'.
   285     12  ER-2048             PIC  X(4)       VALUE '2048'.
   286     12  ER-2049             PIC  X(4)       VALUE '2049'.
   287     12  ER-2050             PIC  X(4)       VALUE '2050'.
   288     12  ER-2055             PIC  X(4)       VALUE '2055'.
   289     12  ER-2056             PIC  X(4)       VALUE '2056'.
   290     12  ER-2057             PIC  X(4)       VALUE '2057'.
   291     12  ER-2067             PIC  X(4)       VALUE '2067'.
   292     12  ER-2088             PIC  X(4)       VALUE '2088'.
   293     12  ER-2089             PIC  X(4)       VALUE '2089'.
   294     12  ER-2091             PIC  X(4)       VALUE '2091'.
   295     12  ER-2092             PIC  X(4)       VALUE '2092'.
   296     12  ER-2093             PIC  X(4)       VALUE '2093'.
   297     12  ER-2094             PIC  X(4)       VALUE '2094'.
   298     12  ER-2095             PIC  X(4)       VALUE '2095'.
   299     12  ER-2096             PIC  X(4)       VALUE '2096'.
   300     12  ER-2097             PIC  X(4)       VALUE '2097'.
   301     12  ER-2209             PIC  X(4)       VALUE '2209'.
   302     12  ER-2238             PIC  X(4)       VALUE '2238'.
   303     12  ER-2370             PIC  X(4)       VALUE '2370'.
   304     12  ER-2572             PIC  X(4)       VALUE '2572'.
   305     12  ER-2717             PIC  X(4)       VALUE '2717'.
   306     12  ER-2790             PIC  X(4)       VALUE '2790'.
   307     12  ER-2872             PIC  X(4)       VALUE '2872'.
   308     12  ER-3021             PIC  X(4)       VALUE '3021'.
   309     12  ER-3053             PIC  X(4)       VALUE '3053'.
   310     12  ER-3055             PIC  X(4)       VALUE '3055'.
   311     12  ER-3056             PIC  X(4)       VALUE '3056'.
   312     12  ER-3150             PIC  X(4)       VALUE '3150'.
   313     12  ER-3151             PIC  X(4)       VALUE '3151'.
   314     12  ER-3152             PIC  X(4)       VALUE '3152'.
   315     12  ER-3153             PIC  X(4)       VALUE '3153'.
   316     12  ER-3154             PIC  X(4)       VALUE '3154'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL652.cbl
   317     12  ER-3168             PIC  X(4)       VALUE '3168'.
   318     12  ER-3170             PIC  X(4)       VALUE '3170'.
   319     12  ER-3174             PIC  X(4)       VALUE '3174'.
   320     12  ER-3261             PIC  X(4)       VALUE '3261'.
   321     12  ER-9096             PIC  X(4)       VALUE '9096'.
   322     12  ER-9097             PIC  X(4)       VALUE '9097'.
   323     12  ER-9999             PIC  X(4)       VALUE '9999'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL652.cbl
   325*                          COPY ELCSCTM.
   326******************************************************************
   327*                                                                *
   328*                                                                *
   329*                            ELCSCTM                             *
   330*                            VMOD=2.001                          *
   331*                                                                *
   332*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   333*                                                                *
   334******************************************************************
   335 01  SECURITY-MESSAGE.
   336     12  FILLER                          PIC X(30)
   337            VALUE '** LOGIC SECURITY VIOLATION -'.
   338     12  SM-READ                         PIC X(6).
   339     12  FILLER                          PIC X(5)
   340            VALUE ' PGM='.
   341     12  SM-PGM                          PIC X(6).
   342     12  FILLER                          PIC X(5)
   343            VALUE ' OPR='.
   344     12  SM-PROCESSOR-ID                 PIC X(4).
   345     12  FILLER                          PIC X(6)
   346            VALUE ' TERM='.
   347     12  SM-TERMID                       PIC X(4).
   348     12  FILLER                          PIC XX   VALUE SPACE.
   349     12  SM-JUL-DATE                     PIC 9(5).
   350     12  FILLER                          PIC X    VALUE SPACE.
   351     12  SM-TIME                         PIC 99.99.
   352
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL652.cbl
   354*                          COPY ELCSCRTY.
   355******************************************************************
   356*                                                                *
   357*                                                                *
   358*                            ELCSCRTY                            *
   359*                            VMOD=2.001                          *
   360*                                                                *
   361*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   362*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   363*        SAVED IN PI-SECURITY-ADDRESS.                           *
   364*                                                                *
   365******************************************************************
   366 01  SECURITY-CONTROL.
   367     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   368     12  FILLER                       PIC XX    VALUE 'SC'.
   369     12  SC-CREDIT-CODES.
   370         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   371             20  SC-CREDIT-DISPLAY    PIC X.
   372             20  SC-CREDIT-UPDATE     PIC X.
   373     12  SC-CLAIMS-CODES.
   374         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   375             20  SC-CLAIMS-DISPLAY    PIC X.
   376             20  SC-CLAIMS-UPDATE     PIC X.
   377*                          COPY MPCSCRT.
   378******************************************************************
   379*                                                                *
   380*                            MPCSCRT                             *
   381*                            VMOD=1.001                          *
   382*                                                                *
   383*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   384*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   385*                                      (MP MORTGAGE PROTECTION)  *
   386*                                                                *
   387******************************************************************
   388*
   389 01  SECURITY-CONTROL-E.
   390     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   391     12  FILLER                       PIC  X(02) VALUE 'SC'.
   392     12  SC-QUID-KEY.
   393         16  SC-QUID-TERMINAL         PIC  X(04).
   394         16  SC-QUID-SYSTEM           PIC  X(04).
   395     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   396     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   397     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   398         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   399         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   400     12  SC-MP-CODES.
   401         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   402             20  SC-MP-DISPLAY        PIC  X(01).
   403             20  SC-MP-UPDATE         PIC  X(01).
   404     12  FILLER                       PIC  X(40).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL652.cbl
   406 01  FILLER                  PIC X(16)  VALUE ALL 'A'.
   407*                          COPY ELCDATE.
   408******************************************************************
   409*                                                                *
   410*                                                                *
   411*                            ELCDATE.                            *
   412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   413*                            VMOD=2.003
   414*                                                                *
   415*                                                                *
   416*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   417*                 LENGTH = 200                                   *
   418******************************************************************
   419
   420 01  DATE-CONVERSION-DATA.
   421     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   422     12  DC-OPTION-CODE                PIC X.
   423         88  BIN-TO-GREG                VALUE ' '.
   424         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   425         88  EDIT-GREG-TO-BIN           VALUE '2'.
   426         88  YMD-GREG-TO-BIN            VALUE '3'.
   427         88  MDY-GREG-TO-BIN            VALUE '4'.
   428         88  JULIAN-TO-BIN              VALUE '5'.
   429         88  BIN-PLUS-ELAPSED           VALUE '6'.
   430         88  FIND-CENTURY               VALUE '7'.
   431         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   432         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   433         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   434         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   435         88  JULIAN-TO-BIN-3            VALUE 'C'.
   436         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   437         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   438         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   439         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   440         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   441         88  CHECK-LEAP-YEAR            VALUE 'H'.
   442         88  BIN-3-TO-GREG              VALUE 'I'.
   443         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   444         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   445         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   446         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   447         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   448         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   449         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   450         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   451         88  THREE-CHARACTER-BIN
   452                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   453         88  GREGORIAN-TO-BIN
   454                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   455         88  BIN-TO-GREGORIAN
   456                  VALUES ' ' '1' 'I' '8' 'G'.
   457         88  JULIAN-TO-BINARY
   458                  VALUES '5' 'C' 'E' 'F'.
   459     12  DC-ERROR-CODE                 PIC X.
   460         88  NO-CONVERSION-ERROR        VALUE ' '.
   461         88  DATE-CONVERSION-ERROR
   462                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   463         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL652.cbl
   464         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   465         88  DATE-IS-INVALID            VALUE '3'.
   466         88  DATE1-GREATER-DATE2        VALUE '4'.
   467         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   468         88  DATE-INVALID-OPTION        VALUE '9'.
   469         88  INVALID-CENTURY            VALUE 'A'.
   470         88  ONLY-CENTURY               VALUE 'B'.
   471         88  ONLY-LEAP-YEAR             VALUE 'C'.
   472         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   473     12  DC-END-OF-MONTH               PIC X.
   474         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   475     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   476         88  USE-NORMAL-PROCESS         VALUE ' '.
   477         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   478         88  ADJUST-UP-100-YRS          VALUE '2'.
   479     12  FILLER                        PIC X.
   480     12  DC-CONVERSION-DATES.
   481         16  DC-BIN-DATE-1             PIC XX.
   482         16  DC-BIN-DATE-2             PIC XX.
   483         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   484         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   485                       DC-GREG-DATE-1-EDIT.
   486             20  DC-EDIT1-MONTH        PIC 99.
   487             20  SLASH1-1              PIC X.
   488             20  DC-EDIT1-DAY          PIC 99.
   489             20  SLASH1-2              PIC X.
   490             20  DC-EDIT1-YEAR         PIC 99.
   491         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   492         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   493                     DC-GREG-DATE-2-EDIT.
   494             20  DC-EDIT2-MONTH        PIC 99.
   495             20  SLASH2-1              PIC X.
   496             20  DC-EDIT2-DAY          PIC 99.
   497             20  SLASH2-2              PIC X.
   498             20  DC-EDIT2-YEAR         PIC 99.
   499         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   500         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   501                     DC-GREG-DATE-1-YMD.
   502             20  DC-YMD-YEAR           PIC 99.
   503             20  DC-YMD-MONTH          PIC 99.
   504             20  DC-YMD-DAY            PIC 99.
   505         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   506         16  DC-GREG-DATE-1-MDY-R REDEFINES
   507                      DC-GREG-DATE-1-MDY.
   508             20  DC-MDY-MONTH          PIC 99.
   509             20  DC-MDY-DAY            PIC 99.
   510             20  DC-MDY-YEAR           PIC 99.
   511         16  DC-GREG-DATE-1-ALPHA.
   512             20  DC-ALPHA-MONTH        PIC X(10).
   513             20  DC-ALPHA-DAY          PIC 99.
   514             20  FILLER                PIC XX.
   515             20  DC-ALPHA-CENTURY.
   516                 24 DC-ALPHA-CEN-N     PIC 99.
   517             20  DC-ALPHA-YEAR         PIC 99.
   518         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   519         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   520         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   521         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL652.cbl
   522         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   523                                       PIC 9(05).
   524         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   525             20  DC-JULIAN-YEAR        PIC 99.
   526             20  DC-JULIAN-DAYS        PIC 999.
   527         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   528         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   529         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   530     12  DATE-CONVERSION-VARIBLES.
   531         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   532         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   533             20  FILLER                PIC 9(3).
   534             20  HOLD-CEN-1-CCYY.
   535                 24  HOLD-CEN-1-CC     PIC 99.
   536                 24  HOLD-CEN-1-YY     PIC 99.
   537             20  HOLD-CEN-1-MO         PIC 99.
   538             20  HOLD-CEN-1-DA         PIC 99.
   539         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   540             20  HOLD-CEN-1-R-MO       PIC 99.
   541             20  HOLD-CEN-1-R-DA       PIC 99.
   542             20  HOLD-CEN-1-R-CCYY.
   543                 24  HOLD-CEN-1-R-CC   PIC 99.
   544                 24  HOLD-CEN-1-R-YY   PIC 99.
   545             20  FILLER                PIC 9(3).
   546         16  HOLD-CENTURY-1-X.
   547             20  FILLER                PIC X(3)  VALUE SPACES.
   548             20  HOLD-CEN-1-X-CCYY.
   549                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   550                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   551             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   552             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   553         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   554             20  HOLD-CEN-1-R-X-MO     PIC XX.
   555             20  HOLD-CEN-1-R-X-DA     PIC XX.
   556             20  HOLD-CEN-1-R-X-CCYY.
   557                 24  HOLD-CEN-1-R-X-CC PIC XX.
   558                 24  HOLD-CEN-1-R-X-YY PIC XX.
   559             20  FILLER                PIC XXX.
   560         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   561         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   562         16  DC-JULIAN-DATE-1          PIC 9(07).
   563         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   564             20  DC-JULIAN-1-CCYY.
   565                 24  DC-JULIAN-1-CC    PIC 99.
   566                 24  DC-JULIAN-1-YR    PIC 99.
   567             20  DC-JULIAN-DA-1        PIC 999.
   568         16  DC-JULIAN-DATE-2          PIC 9(07).
   569         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   570             20  DC-JULIAN-2-CCYY.
   571                 24  DC-JULIAN-2-CC    PIC 99.
   572                 24  DC-JULIAN-2-YR    PIC 99.
   573             20  DC-JULIAN-DA-2        PIC 999.
   574         16  DC-GREG-DATE-A-EDIT.
   575             20  DC-EDITA-MONTH        PIC 99.
   576             20  SLASHA-1              PIC X VALUE '/'.
   577             20  DC-EDITA-DAY          PIC 99.
   578             20  SLASHA-2              PIC X VALUE '/'.
   579             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL652.cbl
   580                 24  DC-EDITA-CENT     PIC 99.
   581                 24  DC-EDITA-YEAR     PIC 99.
   582         16  DC-GREG-DATE-B-EDIT.
   583             20  DC-EDITB-MONTH        PIC 99.
   584             20  SLASHB-1              PIC X VALUE '/'.
   585             20  DC-EDITB-DAY          PIC 99.
   586             20  SLASHB-2              PIC X VALUE '/'.
   587             20  DC-EDITB-CCYY.
   588                 24  DC-EDITB-CENT     PIC 99.
   589                 24  DC-EDITB-YEAR     PIC 99.
   590         16  DC-GREG-DATE-CYMD         PIC 9(08).
   591         16  DC-GREG-DATE-CYMD-R REDEFINES
   592                              DC-GREG-DATE-CYMD.
   593             20  DC-CYMD-CEN           PIC 99.
   594             20  DC-CYMD-YEAR          PIC 99.
   595             20  DC-CYMD-MONTH         PIC 99.
   596             20  DC-CYMD-DAY           PIC 99.
   597         16  DC-GREG-DATE-MDCY         PIC 9(08).
   598         16  DC-GREG-DATE-MDCY-R REDEFINES
   599                              DC-GREG-DATE-MDCY.
   600             20  DC-MDCY-MONTH         PIC 99.
   601             20  DC-MDCY-DAY           PIC 99.
   602             20  DC-MDCY-CEN           PIC 99.
   603             20  DC-MDCY-YEAR          PIC 99.
   604    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   605        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   606    12  DC-EL310-DATE                  PIC X(21).
   607    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL652.cbl
   609*                          COPY ELCLOGOF.
   610******************************************************************
   611*                                                                *
   612*                                                                *
   613*                            ELCLOGOF.                           *
   614*                            VMOD=2.001                          *
   615*                                                                *
   616*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   617*                                                                *
   618******************************************************************
   619 01  CLASIC-LOGOFF.
   620     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   621     12  LOGOFF-TEXT.
   622         16  FILLER          PIC X(5)    VALUE SPACES.
   623         16  LOGOFF-MSG.
   624             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   625             20  FILLER      PIC X       VALUE SPACES.
   626             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   627         16  FILLER          PIC X(80)
   628           VALUE '* YOU ARE NOW LOGGED OFF'.
   629         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   630         16  FILLER          PIC X       VALUE QUOTE.
   631         16  LOGOFF-SYS-MSG  PIC X(17)
   632           VALUE 'S CLAS-IC SYSTEM '.
   633     12  TEXT-MESSAGES.
   634         16  UNACCESS-MSG    PIC X(29)
   635             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   636         16  PGMIDERR-MSG    PIC X(17)
   637             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL652.cbl
   639*                          COPY ELCATTR.
   640******************************************************************
   641*                                                                *
   642*                            ELCATTR.                            *
   643*                            VMOD=2.001                          *
   644*                                                                *
   645*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   646*                                                                *
   647*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   648*                                                                *
   649*                   POS 1   P=PROTECTED                          *
   650*                           U=UNPROTECTED                        *
   651*                           S=ASKIP                              *
   652*                   POS 2   A=ALPHA/NUMERIC                      *
   653*                           N=NUMERIC                            *
   654*                   POS 3   N=NORMAL                             *
   655*                           B=BRIGHT                             *
   656*                           D=DARK                               *
   657*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   658*                           OF=MODIFIED DATA TAG OFF             *
   659*                                                                *
   660*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   661******************************************************************
   662 01  ATTRIBUTE-LIST.
   663     12  AL-PABOF            PIC X       VALUE 'Y'.
   664     12  AL-PABON            PIC X       VALUE 'Z'.
   665     12  AL-PADOF            PIC X       VALUE '%'.
   666     12  AL-PADON            PIC X       VALUE '_'.
   667     12  AL-PANOF            PIC X       VALUE '-'.
   668     12  AL-PANON            PIC X       VALUE '/'.
   669     12  AL-SABOF            PIC X       VALUE '8'.
   670     12  AL-SABON            PIC X       VALUE '9'.
   671     12  AL-SADOF            PIC X       VALUE '@'.
   672     12  AL-SADON            PIC X       VALUE QUOTE.
   673     12  AL-SANOF            PIC X       VALUE '0'.
   674     12  AL-SANON            PIC X       VALUE '1'.
   675     12  AL-UABOF            PIC X       VALUE 'H'.
   676     12  AL-UABON            PIC X       VALUE 'I'.
   677     12  AL-UADOF            PIC X       VALUE '<'.
   678     12  AL-UADON            PIC X       VALUE '('.
   679     12  AL-UANOF            PIC X       VALUE ' '.
   680     12  AL-UANON            PIC X       VALUE 'A'.
   681     12  AL-UNBOF            PIC X       VALUE 'Q'.
   682     12  AL-UNBON            PIC X       VALUE 'R'.
   683     12  AL-UNDOF            PIC X       VALUE '*'.
   684     12  AL-UNDON            PIC X       VALUE ')'.
   685     12  AL-UNNOF            PIC X       VALUE '&'.
   686     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL652.cbl
   688*                          COPY ELCEMIB.
   689******************************************************************
   690*                                                                *
   691*                                                                *
   692*                            ELCEMIB.                            *
   693*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   694*                            VMOD=2.005                          *
   695*                                                                *
   696*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   697*                                                                *
   698******************************************************************
   699 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   700     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   701     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   702     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   703     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   704     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   705     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   706     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   707     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   708     12  EMI-SWITCH1             PIC X        VALUE '1'.
   709         88  EMI-NO-ERRORS                    VALUE '1'.
   710         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   711         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   712     12  EMI-SWITCH2             PIC X        VALUE '1'.
   713         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   714     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   715         88  EMI-AREA1-EMPTY                  VALUE '1'.
   716         88  EMI-AREA1-FULL                   VALUE '2'.
   717     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   718         88  EMI-AREA2-EMPTY                  VALUE '1'.
   719         88  EMI-AREA2-FULL                   VALUE '2'.
   720     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   721         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   722         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   723         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   724         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   725         88  EMI-BYPASS-FATALS                VALUE 'X'.
   726     12  EMI-ERROR-LINES.
   727         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   728         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   729         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   730         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   731             20  EMI-ERR-CODES OCCURS 10 TIMES.
   732                 24  EMI-ERR-NUM         PIC X(4).
   733                 24  EMI-FILLER          PIC X.
   734                 24  EMI-SEV             PIC X.
   735                 24  FILLER              PIC X.
   736             20  FILLER                  PIC X(02).
   737     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   738         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   739             20  EMI-ERROR-NUMBER    PIC X(4).
   740             20  EMI-FILL            PIC X.
   741             20  EMI-SEVERITY        PIC X.
   742             20  FILLER              PIC X.
   743             20  EMI-ERROR-TEXT.
   744                 24  EMI-TEXT-VARIABLE   PIC X(10).
   745                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL652.cbl
   746     12  EMI-SEVERITY-SAVE           PIC X.
   747         88  EMI-NOTE                    VALUE 'N'.
   748         88  EMI-WARNING                 VALUE 'W'.
   749         88  EMI-FORCABLE                VALUE 'F'.
   750         88  EMI-FATAL                   VALUE 'X'.
   751     12  EMI-MESSAGE-FLAG            PIC X.
   752         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   753         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   754     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   755     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   756         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   757         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   758         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   759     12  FILLER                      PIC X(137)  VALUE SPACES.
   760     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   761     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   762     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   763     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL652.cbl
   765 01  FILLER                  PIC X(16)  VALUE ALL 'B'.
   766*                          COPY ELCINTF.
   767******************************************************************
   768*                                                                *
   769*                                                                *
   770*                            ELCINTF.                            *
   771*                            VMOD=2.017                          *
   772*                                                                *
   773*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   774*                                                                *
   775*       LENGTH = 1024                                            *
   776*                                                                *
   777******************************************************************
   778 01  PROGRAM-INTERFACE-BLOCK.
   779     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   780     12  PI-CALLING-PROGRAM              PIC X(8).
   781     12  PI-SAVED-PROGRAM-1              PIC X(8).
   782     12  PI-SAVED-PROGRAM-2              PIC X(8).
   783     12  PI-SAVED-PROGRAM-3              PIC X(8).
   784     12  PI-SAVED-PROGRAM-4              PIC X(8).
   785     12  PI-SAVED-PROGRAM-5              PIC X(8).
   786     12  PI-SAVED-PROGRAM-6              PIC X(8).
   787     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   788     12  PI-COMPANY-ID                   PIC XXX.
   789     12  PI-COMPANY-CD                   PIC X.
   790
   791     12  PI-COMPANY-PASSWORD             PIC X(8).
   792
   793     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   794
   795     12  PI-CONTROL-IN-PROGRESS.
   796         16  PI-CARRIER                  PIC X.
   797         16  PI-GROUPING                 PIC X(6).
   798         16  PI-STATE                    PIC XX.
   799         16  PI-ACCOUNT                  PIC X(10).
   800         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   801                                         PIC X(10).
   802         16  PI-CLAIM-CERT-GRP.
   803             20  PI-CLAIM-NO             PIC X(7).
   804             20  PI-CERT-NO.
   805                 25  PI-CERT-PRIME       PIC X(10).
   806                 25  PI-CERT-SFX         PIC X.
   807             20  PI-CERT-EFF-DT          PIC XX.
   808         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   809             20  PI-PLAN-CODE            PIC X(2).
   810             20  PI-REVISION-NUMBER      PIC X(3).
   811             20  PI-PLAN-EFF-DT          PIC X(2).
   812             20  PI-PLAN-EXP-DT          PIC X(2).
   813             20  FILLER                  PIC X(11).
   814         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   815             20  PI-OE-REFERENCE-1.
   816                 25  PI-OE-REF-1-PRIME   PIC X(18).
   817                 25  PI-OE-REF-1-SUFF    PIC XX.
   818
   819     12  PI-SESSION-IN-PROGRESS          PIC X.
   820         88  CLAIM-SESSION                   VALUE '1'.
   821         88  CREDIT-SESSION                  VALUE '2'.
   822         88  WARRANTY-SESSION                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL652.cbl
   823         88  MORTGAGE-SESSION                VALUE '4'.
   824         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   825
   826
   827*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   828
   829     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   830     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   831
   832     12  PI-CREDIT-USER                  PIC X.
   833         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   834         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   835
   836     12  PI-CLAIM-USER                   PIC X.
   837         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   838         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   839
   840     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   841         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   842         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   843         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   844         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   845         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   846
   847     12  PI-PROCESSOR-ID                 PIC X(4).
   848
   849     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   850
   851     12  PI-MEMBER-CAPTION               PIC X(10).
   852
   853     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   854         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   855
   856     12  PI-LIFE-OVERRIDE-L1             PIC X.
   857     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   858     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   859     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   860
   861     12  PI-AH-OVERRIDE-L1               PIC X.
   862     12  PI-AH-OVERRIDE-L2               PIC XX.
   863     12  PI-AH-OVERRIDE-L6               PIC X(6).
   864     12  PI-AH-OVERRIDE-L12              PIC X(12).
   865
   866     12  PI-NEW-SYSTEM                   PIC X(2).
   867
   868     12  PI-PRIMARY-CERT-NO              PIC X(11).
   869     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   870         88  PI-USES-PAID-TO                 VALUE '1'.
   871     12  PI-CRDTCRD-SYSTEM.
   872         16  PI-CRDTCRD-USER             PIC X.
   873             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   874             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   875         16  PI-CC-MONTH-END-DT          PIC XX.
   876     12  PI-PROCESSOR-PRINTER            PIC X(4).
   877
   878     12  PI-OE-REFERENCE-2.
   879         16  PI-OE-REF-2-PRIME           PIC X(10).
   880         16  PI-OE-REF-2-SUFF            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL652.cbl
   881
   882     12  PI-REM-TRM-CALC-OPTION          PIC X.
   883
   884     12  PI-LANGUAGE-TYPE                PIC X.
   885             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   886             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   887             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   888
   889     12  PI-POLICY-LINKAGE-IND           PIC X.
   890         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   891         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   892                                                   LOW-VALUES.
   893
   894     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   895     12  PI-CLAIM-PW-SESSION             PIC X(1).
   896         88  PI-CLAIM-CREDIT                 VALUE '1'.
   897         88  PI-CLAIM-CONVEN                 VALUE '2'.
   898     12  FILLER                          PIC X(4).
   899
   900     12  PI-SYSTEM-LEVEL                 PIC X(145).
   901
   902     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   903         PI-SYSTEM-LEVEL.
   904
   905         16  PI-ENTRY-CODES.
   906             20  PI-ENTRY-CD-1           PIC X.
   907             20  PI-ENTRY-CD-2           PIC X.
   908
   909         16  PI-RETURN-CODES.
   910             20  PI-RETURN-CD-1          PIC X.
   911             20  PI-RETURN-CD-2          PIC X.
   912
   913         16  PI-UPDATE-STATUS-SAVE.
   914             20  PI-UPDATE-BY            PIC X(4).
   915             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   916
   917         16  PI-LOWER-CASE-LETTERS       PIC X.
   918             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   919
   920*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   921*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   922*            88  CARRIER-CLM-CNTL            VALUE '2'.
   923
   924         16  PI-CERT-ACCESS-CONTROL      PIC X.
   925             88  ST-ACCNT-CNTL               VALUE ' '.
   926             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   927             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   928             88  ACCNT-CNTL                  VALUE '3'.
   929             88  CARR-ACCNT-CNTL             VALUE '4'.
   930
   931         16  PI-PROCESSOR-CAP-LIST.
   932             20  PI-SYSTEM-CONTROLS.
   933                24 PI-SYSTEM-DISPLAY     PIC X.
   934                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   935                24 PI-SYSTEM-MODIFY      PIC X.
   936                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   937             20  FILLER                  PIC XX.
   938             20  PI-DISPLAY-CAP          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL652.cbl
   939                 88  DISPLAY-CAP             VALUE 'Y'.
   940             20  PI-MODIFY-CAP           PIC X.
   941                 88  MODIFY-CAP              VALUE 'Y'.
   942             20  PI-MSG-AT-LOGON-CAP     PIC X.
   943                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   944             20  PI-FORCE-CAP            PIC X.
   945                 88  FORCE-CAP               VALUE 'Y'.
   946
   947         16  PI-PROGRAM-CONTROLS.
   948             20  PI-PGM-PRINT-OPT        PIC X.
   949             20  PI-PGM-FORMAT-OPT       PIC X.
   950             20  PI-PGM-PROCESS-OPT      PIC X.
   951             20  PI-PGM-TOTALS-OPT       PIC X.
   952
   953         16  PI-HELP-INTERFACE.
   954             20  PI-LAST-ERROR-NO        PIC X(4).
   955             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   956
   957         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   958             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   959
   960         16  PI-CR-CONTROL-IN-PROGRESS.
   961             20  PI-CR-CARRIER           PIC X.
   962             20  PI-CR-GROUPING          PIC X(6).
   963             20  PI-CR-STATE             PIC XX.
   964             20  PI-CR-ACCOUNT           PIC X(10).
   965             20  PI-CR-FIN-RESP          PIC X(10).
   966             20  PI-CR-TYPE              PIC X.
   967
   968         16  PI-CR-BATCH-NUMBER          PIC X(6).
   969
   970         16  PI-CR-MONTH-END-DT          PIC XX.
   971
   972         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   973             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   974             88  PI-ZERO-CARRIER             VALUE '1'.
   975             88  PI-ZERO-GROUPING            VALUE '2'.
   976             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   977
   978         16  PI-CARRIER-SECURITY         PIC X.
   979             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   980
   981         16  PI-ACCOUNT-SECURITY         PIC X(10).
   982             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   983             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   984
   985         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   986             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   987                                         INDEXED BY PI-ACCESS-NDX
   988                                         PIC X.
   989
   990         16  PI-GA-BILLING-CONTROL       PIC X.
   991             88  PI-GA-BILLING               VALUE '1'.
   992
   993         16  PI-MAIL-PROCESSING          PIC X.
   994             88  PI-MAIL-YES                 VALUE 'Y'.
   995
   996         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL652.cbl
   997
   998         16  PI-AR-SYSTEM.
   999             20  PI-AR-PROCESSING-CNTL   PIC X.
  1000                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1001             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1002             20  PI-AR-MONTH-END-DT      PIC XX.
  1003
  1004         16  PI-MP-SYSTEM.
  1005             20  PI-MORTGAGE-USER            PIC X.
  1006                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1007                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1008             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1009                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1010                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1011                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1012                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1013                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1014             20  PI-MP-MONTH-END-DT          PIC XX.
  1015             20  PI-MP-REFERENCE-NO.
  1016                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1017                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1018
  1019         16  PI-LABEL-CONTROL            PIC X(01).
  1020             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1021             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1022
  1023         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1024             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1025
  1026         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1027             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1028             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1029
  1030         16  FILLER                      PIC X(14).
  1031
  1032     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1033******************************************************************
  1034     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
  1035         16  PI-CHECK-MAINT-TYPE     PIC  X.
  1036             88  VALID-MAINT-TYPE            VALUE 'S' 'A'
  1037                                                   'C' 'D'.
  1038             88  ADD-FUNCTION                VALUE 'A'.
  1039             88  SHOW-FUNCTION               VALUE 'S'.
  1040             88  DELETE-FUNCTION             VALUE 'D'.
  1041             88  CHANGE-FUNCTION             VALUE 'C'.
  1042         16  PI-CHECK-TYPE           PIC  X.
  1043             88  VALID-TYPE                  VALUE 'A' 'B' 'C'
  1044                                                           'G'.
  1045         16  PI-CHECK-CARRY-BAL      PIC  X.
  1046             88  VALID-CARRY-BAL             VALUE 'Y' 'N'.
  1047         16  PI-FIRST-TIME-SW        PIC  X.
  1048             88  FIRST-TIME                  VALUE 'Y'.
  1049         16  PI-ERCOMP-EOF-SW        PIC  X.
  1050             88  ERCOMP-EOF                  VALUE 'Y'.
  1051         16  PI-SAVE-PHONE           PIC  X(10).
  1052         16  PI-SAVE-PHONE-RED REDEFINES PI-SAVE-PHONE  PIC 9(10).
  1053         16  PI-ERC-END-BAL          PIC S9(9)V99       COMP-3.
  1054         16  PI-ERCOMP-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL652.cbl
  1055             20  PI-ERC-COMPANY-CD   PIC  X.
  1056             20  PI-ERC-CARRIER      PIC  X.
  1057             20  PI-ERC-GROUP        PIC  X(6).
  1058             20  PI-ERC-RESP         PIC  X(10).
  1059             20  PI-ERC-ACCT         PIC  X(10).
  1060             20  PI-ERC-TYPE         PIC  X.
  1061         16  PI-SAVE-ERCOMP-KEY      PIC  X(29).
  1062         16  PI-SAVE-FAXNO           PIC  X(10).
  1063         16  PI-SAVE-FAXNO-RED REDEFINES PI-SAVE-FAXNO  PIC 9(10).
  1064         16  PI-SAVE-ADDR2           PIC X(30).
  1065         16  PI-SAVE-CITYST.
  1066             20  PI-SAVE-CITY        PIC X(28).
  1067             20  PI-SAVE-STATE       PIC XX.
  1068         16  PI-SAVE-ACCT-NAME       PIC X(30).
  1069         16  PI-EL652-DEL-SW         PIC X.
  1070         16  PI-UPDATE-SW            PIC X.
  1071         16  FILLER                  PIC  X(457).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL652.cbl
  1073*                            COPY ELCJPFX.
  1074******************************************************************
  1075*                                                                *
  1076*                                                                *
  1077*                            ELCJPFX.                            *
  1078*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1079*                            VMOD=2.002                          *
  1080*                                                                *
  1081*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1082*                                                                *
  1083*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1084*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1085*        ELCNTL - CONTROL FILE                                   *
  1086*        ELMSTR - CLAIM MASTERS                                  *
  1087*        ELTRLR - ACTIVITY TRAILERS                              *
  1088*        ELCHKQ - CHECK QUE                                      *
  1089******************************************************************
  1090 01  JOURNAL-RECORD.
  1091     12  JP-USER-ID                  PIC X(4).
  1092     12  JP-FILE-ID                  PIC X(8).
  1093     12  JP-PROGRAM-ID               PIC X(8).
  1094     12  JP-RECORD-TYPE              PIC X.
  1095         88 JP-ADD              VALUE 'A'.
  1096         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1097         88 JP-AFTER-CHANGE     VALUE 'C'.
  1098         88 JP-DELETE           VALUE 'D'.
  1099         88 JP-GENERIC-DELETE   VALUE 'G'.
  1100         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1101         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1102     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1103     12  JP-RECORD-AREA
  1104
  1105
  1106                             PIC  X(750).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL652.cbl
  1108*                            COPY ELCAID.
  1109******************************************************************
  1110*                                                                *
  1111*                            ELCAID.                             *
  1112*                            VMOD=2.001                          *
  1113*                                                                *
  1114*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1115*                                                                *
  1116*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1117*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1118******************************************************************
  1119
  1120 01  DFHAID.
  1121   02  DFHNULL   PIC  X  VALUE  ' '.
  1122   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1123   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1124   02  DFHPEN    PIC  X  VALUE  '='.
  1125   02  DFHOPID   PIC  X  VALUE  'W'.
  1126   02  DFHPA1    PIC  X  VALUE  '%'.
  1127   02  DFHPA2    PIC  X  VALUE  '>'.
  1128   02  DFHPA3    PIC  X  VALUE  ','.
  1129   02  DFHPF1    PIC  X  VALUE  '1'.
  1130   02  DFHPF2    PIC  X  VALUE  '2'.
  1131   02  DFHPF3    PIC  X  VALUE  '3'.
  1132   02  DFHPF4    PIC  X  VALUE  '4'.
  1133   02  DFHPF5    PIC  X  VALUE  '5'.
  1134   02  DFHPF6    PIC  X  VALUE  '6'.
  1135   02  DFHPF7    PIC  X  VALUE  '7'.
  1136   02  DFHPF8    PIC  X  VALUE  '8'.
  1137   02  DFHPF9    PIC  X  VALUE  '9'.
  1138   02  DFHPF10   PIC  X  VALUE  ':'.
  1139   02  DFHPF11   PIC  X  VALUE  '#'.
  1140   02  DFHPF12   PIC  X  VALUE  '@'.
  1141   02  DFHPF13   PIC  X  VALUE  'A'.
  1142   02  DFHPF14   PIC  X  VALUE  'B'.
  1143   02  DFHPF15   PIC  X  VALUE  'C'.
  1144   02  DFHPF16   PIC  X  VALUE  'D'.
  1145   02  DFHPF17   PIC  X  VALUE  'E'.
  1146   02  DFHPF18   PIC  X  VALUE  'F'.
  1147   02  DFHPF19   PIC  X  VALUE  'G'.
  1148   02  DFHPF20   PIC  X  VALUE  'H'.
  1149   02  DFHPF21   PIC  X  VALUE  'I'.
  1150*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1151   02  DFHPF22   PIC  X  VALUE  '['.
  1152   02  DFHPF23   PIC  X  VALUE  '.'.
  1153   02  DFHPF24   PIC  X  VALUE  '<'.
  1154   02  DFHMSRE   PIC  X  VALUE  'X'.
  1155   02  DFHSTRF   PIC  X  VALUE  'h'.
  1156   02  DFHTRIG   PIC  X  VALUE  '"'.
  1157
  1158 01  FILLER  REDEFINES  DFHAID.
  1159     12  FILLER              PIC  X(8).
  1160     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL652.cbl
  1162*                            COPY EL652S.
  1163 01  EL652AI.
  1164     05  FILLER            PIC  X(0012).
  1165*    -------------------------------
  1166     05  RUNDATEL PIC S9(0004) COMP.
  1167     05  RUNDATEF PIC  X(0001).
  1168     05  FILLER REDEFINES RUNDATEF.
  1169         10  RUNDATEA PIC  X(0001).
  1170     05  RUNDATEI PIC  X(0008).
  1171*    -------------------------------
  1172     05  RUNTIMEL PIC S9(0004) COMP.
  1173     05  RUNTIMEF PIC  X(0001).
  1174     05  FILLER REDEFINES RUNTIMEF.
  1175         10  RUNTIMEA PIC  X(0001).
  1176     05  RUNTIMEI PIC  X(0005).
  1177*    -------------------------------
  1178     05  CMPNYIDL PIC S9(0004) COMP.
  1179     05  CMPNYIDF PIC  X(0001).
  1180     05  FILLER REDEFINES CMPNYIDF.
  1181         10  CMPNYIDA PIC  X(0001).
  1182     05  CMPNYIDI PIC  X(0003).
  1183*    -------------------------------
  1184     05  USERIDL PIC S9(0004) COMP.
  1185     05  USERIDF PIC  X(0001).
  1186     05  FILLER REDEFINES USERIDF.
  1187         10  USERIDA PIC  X(0001).
  1188     05  USERIDI PIC  X(0004).
  1189*    -------------------------------
  1190     05  MAINTYPL PIC S9(0004) COMP.
  1191     05  MAINTYPF PIC  X(0001).
  1192     05  FILLER REDEFINES MAINTYPF.
  1193         10  MAINTYPA PIC  X(0001).
  1194     05  MAINTYPI PIC  X(0001).
  1195*    -------------------------------
  1196     05  SCDESCL PIC S9(0004) COMP.
  1197     05  SCDESCF PIC  X(0001).
  1198     05  FILLER REDEFINES SCDESCF.
  1199         10  SCDESCA PIC  X(0001).
  1200     05  SCDESCI PIC  X(0008).
  1201*    -------------------------------
  1202     05  FLITYPEL PIC S9(0004) COMP.
  1203     05  FLITYPEF PIC  X(0001).
  1204     05  FILLER REDEFINES FLITYPEF.
  1205         10  FLITYPEA PIC  X(0001).
  1206     05  FLITYPEI PIC  X(0004).
  1207*    -------------------------------
  1208     05  CARRIERL PIC S9(0004) COMP.
  1209     05  CARRIERF PIC  X(0001).
  1210     05  FILLER REDEFINES CARRIERF.
  1211         10  CARRIERA PIC  X(0001).
  1212     05  CARRIERI PIC  X(0001).
  1213*    -------------------------------
  1214     05  GROUPL PIC S9(0004) COMP.
  1215     05  GROUPF PIC  X(0001).
  1216     05  FILLER REDEFINES GROUPF.
  1217         10  GROUPA PIC  X(0001).
  1218     05  GROUPI PIC  X(0006).
  1219*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL652.cbl
  1220     05  TYPEL PIC S9(0004) COMP.
  1221     05  TYPEF PIC  X(0001).
  1222     05  FILLER REDEFINES TYPEF.
  1223         10  TYPEA PIC  X(0001).
  1224     05  TYPEI PIC  X(0001).
  1225*    -------------------------------
  1226     05  FINRESPL PIC S9(0004) COMP.
  1227     05  FINRESPF PIC  X(0001).
  1228     05  FILLER REDEFINES FINRESPF.
  1229         10  FINRESPA PIC  X(0001).
  1230     05  FINRESPI PIC  X(0010).
  1231*    -------------------------------
  1232     05  ACCTNOL PIC S9(0004) COMP.
  1233     05  ACCTNOF PIC  X(0001).
  1234     05  FILLER REDEFINES ACCTNOF.
  1235         10  ACCTNOA PIC  X(0001).
  1236     05  ACCTNOI PIC  X(0010).
  1237*    -------------------------------
  1238     05  SUMMNOL PIC S9(0004) COMP.
  1239     05  SUMMNOF PIC  X(0001).
  1240     05  FILLER REDEFINES SUMMNOF.
  1241         10  SUMMNOA PIC  X(0001).
  1242     05  SUMMNOI PIC  X(0006).
  1243*    -------------------------------
  1244     05  LSTMDTL PIC S9(0004) COMP.
  1245     05  LSTMDTF PIC  X(0001).
  1246     05  FILLER REDEFINES LSTMDTF.
  1247         10  LSTMDTA PIC  X(0001).
  1248     05  LSTMDTI PIC  X(0008).
  1249*    -------------------------------
  1250     05  FLITYPL PIC S9(0004) COMP.
  1251     05  FLITYPF PIC  X(0001).
  1252     05  FILLER REDEFINES FLITYPF.
  1253         10  FLITYPA PIC  X(0001).
  1254     05  FLITYPI PIC  X(0001).
  1255*    -------------------------------
  1256     05  PCONTL PIC S9(0004) COMP.
  1257     05  PCONTF PIC  X(0001).
  1258     05  FILLER REDEFINES PCONTF.
  1259         10  PCONTA PIC  X(0001).
  1260     05  PCONTI PIC  X(0030).
  1261*    -------------------------------
  1262     05  PNT1099L PIC S9(0004) COMP.
  1263     05  PNT1099F PIC  X(0001).
  1264     05  FILLER REDEFINES PNT1099F.
  1265         10  PNT1099A PIC  X(0001).
  1266     05  PNT1099I PIC  X(0001).
  1267*    -------------------------------
  1268     05  MAILNAML PIC S9(0004) COMP.
  1269     05  MAILNAMF PIC  X(0001).
  1270     05  FILLER REDEFINES MAILNAMF.
  1271         10  MAILNAMA PIC  X(0001).
  1272     05  MAILNAMI PIC  X(0030).
  1273*    -------------------------------
  1274     05  SSNL PIC S9(0004) COMP.
  1275     05  SSNF PIC  X(0001).
  1276     05  FILLER REDEFINES SSNF.
  1277         10  SSNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL652.cbl
  1278     05  SSNI PIC  X(0013).
  1279*    -------------------------------
  1280     05  ACCTNAML PIC S9(0004) COMP.
  1281     05  ACCTNAMF PIC  X(0001).
  1282     05  FILLER REDEFINES ACCTNAMF.
  1283         10  ACCTNAMA PIC  X(0001).
  1284     05  ACCTNAMI PIC  X(0030).
  1285*    -------------------------------
  1286     05  PHONEL PIC S9(0004) COMP.
  1287     05  PHONEF PIC  X(0001).
  1288     05  FILLER REDEFINES PHONEF.
  1289         10  PHONEA PIC  X(0001).
  1290     05  PHONEI PIC  X(0012).
  1291*    -------------------------------
  1292     05  ADDR1L PIC S9(0004) COMP.
  1293     05  ADDR1F PIC  X(0001).
  1294     05  FILLER REDEFINES ADDR1F.
  1295         10  ADDR1A PIC  X(0001).
  1296     05  ADDR1I PIC  X(0030).
  1297*    -------------------------------
  1298     05  FAXDESCL PIC S9(0004) COMP.
  1299     05  FAXDESCF PIC  X(0001).
  1300     05  FILLER REDEFINES FAXDESCF.
  1301         10  FAXDESCA PIC  X(0001).
  1302     05  FAXDESCI PIC  X(0016).
  1303*    -------------------------------
  1304     05  FAXNOL PIC S9(0004) COMP.
  1305     05  FAXNOF PIC  X(0001).
  1306     05  FILLER REDEFINES FAXNOF.
  1307         10  FAXNOA PIC  X(0001).
  1308     05  FAXNOI PIC  X(0012).
  1309*    -------------------------------
  1310     05  ADDR2L PIC S9(0004) COMP.
  1311     05  ADDR2F PIC  X(0001).
  1312     05  FILLER REDEFINES ADDR2F.
  1313         10  ADDR2A PIC  X(0001).
  1314     05  ADDR2I PIC  X(0030).
  1315*    -------------------------------
  1316     05  CARBALL PIC S9(0004) COMP.
  1317     05  CARBALF PIC  X(0001).
  1318     05  FILLER REDEFINES CARBALF.
  1319         10  CARBALA PIC  X(0001).
  1320     05  CARBALI PIC  X(0001).
  1321*    -------------------------------
  1322     05  CITYL PIC S9(0004) COMP.
  1323     05  CITYF PIC  X(0001).
  1324     05  FILLER REDEFINES CITYF.
  1325         10  CITYA PIC  X(0001).
  1326     05  CITYI PIC  X(0028).
  1327*    -------------------------------
  1328     05  STATEL PIC S9(0004) COMP.
  1329     05  STATEF PIC  X(0001).
  1330     05  FILLER REDEFINES STATEF.
  1331         10  STATEA PIC  X(0001).
  1332     05  STATEI PIC  X(0002).
  1333*    -------------------------------
  1334     05  REFEHL PIC S9(0004) COMP.
  1335     05  REFEHF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL652.cbl
  1336     05  FILLER REDEFINES REFEHF.
  1337         10  REFEHA PIC  X(0001).
  1338     05  REFEHI PIC  X(0013).
  1339*    -------------------------------
  1340     05  REFEL PIC S9(0004) COMP.
  1341     05  REFEF PIC  X(0001).
  1342     05  FILLER REDEFINES REFEF.
  1343         10  REFEA PIC  X(0001).
  1344     05  REFEI PIC  X(0001).
  1345*    -------------------------------
  1346     05  ZIPCODEL PIC S9(0004) COMP.
  1347     05  ZIPCODEF PIC  X(0001).
  1348     05  FILLER REDEFINES ZIPCODEF.
  1349         10  ZIPCODEA PIC  X(0001).
  1350     05  ZIPCODEI PIC  X(0010).
  1351*    -------------------------------
  1352     05  NGDESCL PIC S9(0004) COMP.
  1353     05  NGDESCF PIC  X(0001).
  1354     05  FILLER REDEFINES NGDESCF.
  1355         10  NGDESCA PIC  X(0001).
  1356     05  NGDESCI PIC  X(0012).
  1357*    -------------------------------
  1358     05  NETGRSL PIC S9(0004) COMP.
  1359     05  NETGRSF PIC  X(0001).
  1360     05  FILLER REDEFINES NETGRSF.
  1361         10  NETGRSA PIC  X(0001).
  1362     05  NETGRSI PIC  X(0001).
  1363*    -------------------------------
  1364     05  AHL120L PIC S9(0004) COMP.
  1365     05  AHL120F PIC  X(0001).
  1366     05  FILLER REDEFINES AHL120F.
  1367         10  AHL120A PIC  X(0001).
  1368     05  AHL120I PIC  X(0016).
  1369*    -------------------------------
  1370     05  OVER120L PIC S9(0004) COMP.
  1371     05  OVER120F PIC  X(0001).
  1372     05  FILLER REDEFINES OVER120F.
  1373         10  OVER120A PIC  X(0001).
  1374     05  OVER120I PIC  X(0013).
  1375*    -------------------------------
  1376     05  CSRL PIC S9(0004) COMP.
  1377     05  CSRF PIC  X(0001).
  1378     05  FILLER REDEFINES CSRF.
  1379         10  CSRA PIC  X(0001).
  1380     05  CSRI PIC  X(0004).
  1381*    -------------------------------
  1382     05  RPTCDDL PIC S9(0004) COMP.
  1383     05  RPTCDDF PIC  X(0001).
  1384     05  FILLER REDEFINES RPTCDDF.
  1385         10  RPTCDDA PIC  X(0001).
  1386     05  RPTCDDI PIC  X(0010).
  1387*    -------------------------------
  1388     05  RPTCD2L PIC S9(0004) COMP.
  1389     05  RPTCD2F PIC  X(0001).
  1390     05  FILLER REDEFINES RPTCD2F.
  1391         10  RPTCD2A PIC  X(0001).
  1392     05  RPTCD2I PIC  X(0010).
  1393*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL652.cbl
  1394     05  CKDESCL PIC S9(0004) COMP.
  1395     05  CKDESCF PIC  X(0001).
  1396     05  FILLER REDEFINES CKDESCF.
  1397         10  CKDESCA PIC  X(0001).
  1398     05  CKDESCI PIC  X(0016).
  1399*    -------------------------------
  1400     05  CKPULLL PIC S9(0004) COMP.
  1401     05  CKPULLF PIC  X(0001).
  1402     05  FILLER REDEFINES CKPULLF.
  1403         10  CKPULLA PIC  X(0001).
  1404     05  CKPULLI PIC  X(0001).
  1405*    -------------------------------
  1406     05  BILLPRTL PIC S9(0004) COMP.
  1407     05  BILLPRTF PIC  X(0001).
  1408     05  FILLER REDEFINES BILLPRTF.
  1409         10  BILLPRTA PIC  X(0001).
  1410     05  BILLPRTI PIC  X(0001).
  1411*    -------------------------------
  1412     05  LETDESCL PIC S9(0004) COMP.
  1413     05  LETDESCF PIC  X(0001).
  1414     05  FILLER REDEFINES LETDESCF.
  1415         10  LETDESCA PIC  X(0001).
  1416     05  LETDESCI PIC  X(0011).
  1417*    -------------------------------
  1418     05  LETRCDL PIC S9(0004) COMP.
  1419     05  LETRCDF PIC  X(0001).
  1420     05  FILLER REDEFINES LETRCDF.
  1421         10  LETRCDA PIC  X(0001).
  1422     05  LETRCDI PIC  X(0001).
  1423*    -------------------------------
  1424     05  BALPRTL PIC S9(0004) COMP.
  1425     05  BALPRTF PIC  X(0001).
  1426     05  FILLER REDEFINES BALPRTF.
  1427         10  BALPRTA PIC  X(0001).
  1428     05  BALPRTI PIC  X(0011).
  1429*    -------------------------------
  1430     05  BALCDL PIC S9(0004) COMP.
  1431     05  BALCDF PIC  X(0001).
  1432     05  FILLER REDEFINES BALCDF.
  1433         10  BALCDA PIC  X(0001).
  1434     05  BALCDI PIC  X(0001).
  1435*    -------------------------------
  1436     05  SPPDDHL PIC S9(0004) COMP.
  1437     05  SPPDDHF PIC  X(0001).
  1438     05  FILLER REDEFINES SPPDDHF.
  1439         10  SPPDDHA PIC  X(0001).
  1440     05  SPPDDHI PIC  X(0012).
  1441*    -------------------------------
  1442     05  SPPDDL PIC S9(0004) COMP.
  1443     05  SPPDDF PIC  X(0001).
  1444     05  FILLER REDEFINES SPPDDF.
  1445         10  SPPDDA PIC  X(0001).
  1446     05  SPPDDI PIC  X(0001).
  1447*    -------------------------------
  1448     05  MFLABLL PIC S9(0004) COMP.
  1449     05  MFLABLF PIC  X(0001).
  1450     05  FILLER REDEFINES MFLABLF.
  1451         10  MFLABLA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL652.cbl
  1452     05  MFLABLI PIC  X(0016).
  1453*    -------------------------------
  1454     05  MAXFEEL PIC S9(0004) COMP.
  1455     05  MAXFEEF PIC  X(0001).
  1456     05  FILLER REDEFINES MAXFEEF.
  1457         10  MAXFEEA PIC  X(0001).
  1458     05  MAXFEEI PIC  S9(04)V99.
  1459*    -------------------------------
  1460     05  CSLABLL PIC S9(0004) COMP.
  1461     05  CSLABLF PIC  X(0001).
  1462     05  FILLER REDEFINES CSLABLF.
  1463         10  CSLABLA PIC  X(0001).
  1464     05  CSLABLI PIC  X(0012).
  1465*    -------------------------------
  1466     05  CLPSTL PIC S9(0004) COMP.
  1467     05  CLPSTF PIC  X(0001).
  1468     05  FILLER REDEFINES CLPSTF.
  1469         10  CLPSTA PIC  X(0001).
  1470     05  CLPSTI PIC  X(0002).
  1471*    -------------------------------
  1472     05  LFLABLL PIC S9(0004) COMP.
  1473     05  LFLABLF PIC  X(0001).
  1474     05  FILLER REDEFINES LFLABLF.
  1475         10  LFLABLA PIC  X(0001).
  1476     05  LFLABLI PIC  X(0016).
  1477*    -------------------------------
  1478     05  MAXLFL PIC S9(0004) COMP.
  1479     05  MAXLFF PIC  X(0001).
  1480     05  FILLER REDEFINES MAXLFF.
  1481         10  MAXLFA PIC  X(0001).
  1482     05  MAXLFI PIC  S9(04)V99.
  1483*    -------------------------------
  1484     05  BALFWDL PIC S9(0004) COMP.
  1485     05  BALFWDF PIC  X(0001).
  1486     05  FILLER REDEFINES BALFWDF.
  1487         10  BALFWDA PIC  X(0001).
  1488     05  BALFWDI PIC  S9(11)V99.
  1489*    -------------------------------
  1490     05  CURCOML PIC S9(0004) COMP.
  1491     05  CURCOMF PIC  X(0001).
  1492     05  FILLER REDEFINES CURCOMF.
  1493         10  CURCOMA PIC  X(0001).
  1494     05  CURCOMI PIC  S9(11)V99.
  1495*    -------------------------------
  1496     05  CURCHGL PIC S9(0004) COMP.
  1497     05  CURCHGF PIC  X(0001).
  1498     05  FILLER REDEFINES CURCHGF.
  1499         10  CURCHGA PIC  X(0001).
  1500     05  CURCHGI PIC  S9(11)V99.
  1501*    -------------------------------
  1502     05  CURPMTL PIC S9(0004) COMP.
  1503     05  CURPMTF PIC  X(0001).
  1504     05  FILLER REDEFINES CURPMTF.
  1505         10  CURPMTA PIC  X(0001).
  1506     05  CURPMTI PIC  S9(11)V99.
  1507*    -------------------------------
  1508     05  ENDBALL PIC S9(0004) COMP.
  1509     05  ENDBALF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL652.cbl
  1510     05  FILLER REDEFINES ENDBALF.
  1511         10  ENDBALA PIC  X(0001).
  1512     05  ENDBALI PIC  S9(11)V99.
  1513*    -------------------------------
  1514     05  CURRENTL PIC S9(0004) COMP.
  1515     05  CURRENTF PIC  X(0001).
  1516     05  FILLER REDEFINES CURRENTF.
  1517         10  CURRENTA PIC  X(0001).
  1518     05  CURRENTI PIC  X(0013).
  1519*    -------------------------------
  1520     05  OVER30L PIC S9(0004) COMP.
  1521     05  OVER30F PIC  X(0001).
  1522     05  FILLER REDEFINES OVER30F.
  1523         10  OVER30A PIC  X(0001).
  1524     05  OVER30I PIC  X(0013).
  1525*    -------------------------------
  1526     05  OVER60L PIC S9(0004) COMP.
  1527     05  OVER60F PIC  X(0001).
  1528     05  FILLER REDEFINES OVER60F.
  1529         10  OVER60A PIC  X(0001).
  1530     05  OVER60I PIC  X(0013).
  1531*    -------------------------------
  1532     05  OVER90L PIC S9(0004) COMP.
  1533     05  OVER90F PIC  X(0001).
  1534     05  FILLER REDEFINES OVER90F.
  1535         10  OVER90A PIC  X(0001).
  1536     05  OVER90I PIC  X(0013).
  1537*    -------------------------------
  1538     05  YTDCOML PIC S9(0004) COMP.
  1539     05  YTDCOMF PIC  X(0001).
  1540     05  FILLER REDEFINES YTDCOMF.
  1541         10  YTDCOMA PIC  X(0001).
  1542     05  YTDCOMI PIC  S9(11)V99.
  1543*    -------------------------------
  1544     05  LSTDTEL PIC S9(0004) COMP.
  1545     05  LSTDTEF PIC  X(0001).
  1546     05  FILLER REDEFINES LSTDTEF.
  1547         10  LSTDTEA PIC  X(0001).
  1548     05  LSTDTEI PIC  X(0008).
  1549*    -------------------------------
  1550     05  LSTTIMEL PIC S9(0004) COMP.
  1551     05  LSTTIMEF PIC  X(0001).
  1552     05  FILLER REDEFINES LSTTIMEF.
  1553         10  LSTTIMEA PIC  X(0001).
  1554     05  LSTTIMEI PIC  X(0005).
  1555*    -------------------------------
  1556     05  LSTUSRL PIC S9(0004) COMP.
  1557     05  LSTUSRF PIC  X(0001).
  1558     05  FILLER REDEFINES LSTUSRF.
  1559         10  LSTUSRA PIC  X(0001).
  1560     05  LSTUSRI PIC  X(0004).
  1561*    -------------------------------
  1562     05  ERRMSG1L PIC S9(0004) COMP.
  1563     05  ERRMSG1F PIC  X(0001).
  1564     05  FILLER REDEFINES ERRMSG1F.
  1565         10  ERRMSG1A PIC  X(0001).
  1566     05  ERRMSG1I PIC  X(0072).
  1567*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL652.cbl
  1568     05  PFKEYL PIC S9(0004) COMP.
  1569     05  PFKEYF PIC  X(0001).
  1570     05  FILLER REDEFINES PFKEYF.
  1571         10  PFKEYA PIC  X(0001).
  1572     05  PFKEYI PIC  99.
  1573*    -------------------------------
  1574     05  PFK5L PIC S9(0004) COMP.
  1575     05  PFK5F PIC  X(0001).
  1576     05  FILLER REDEFINES PFK5F.
  1577         10  PFK5A PIC  X(0001).
  1578     05  PFK5I PIC  X(0011).
  1579*    -------------------------------
  1580     05  PFK7L PIC S9(0004) COMP.
  1581     05  PFK7F PIC  X(0001).
  1582     05  FILLER REDEFINES PFK7F.
  1583         10  PFK7A PIC  X(0001).
  1584     05  PFK7I PIC  X(0012).
  1585*    -------------------------------
  1586     05  PFK9L PIC S9(0004) COMP.
  1587     05  PFK9F PIC  X(0001).
  1588     05  FILLER REDEFINES PFK9F.
  1589         10  PFK9A PIC  X(0001).
  1590     05  PFK9I PIC  X(0012).
  1591*    -------------------------------
  1592     05  PFK13L PIC S9(0004) COMP.
  1593     05  PFK13F PIC  X(0001).
  1594     05  FILLER REDEFINES PFK13F.
  1595         10  PFK13A PIC  X(0001).
  1596     05  PFK13I PIC  X(0011).
  1597*    -------------------------------
  1598     05  PFK4L PIC S9(0004) COMP.
  1599     05  PFK4F PIC  X(0001).
  1600     05  FILLER REDEFINES PFK4F.
  1601         10  PFK4A PIC  X(0001).
  1602     05  PFK4I PIC  X(0012).
  1603*    -------------------------------
  1604     05  PFK6L PIC S9(0004) COMP.
  1605     05  PFK6F PIC  X(0001).
  1606     05  FILLER REDEFINES PFK6F.
  1607         10  PFK6A PIC  X(0001).
  1608     05  PFK6I PIC  X(0011).
  1609*    -------------------------------
  1610     05  PFK10L PIC S9(0004) COMP.
  1611     05  PFK10F PIC  X(0001).
  1612     05  FILLER REDEFINES PFK10F.
  1613         10  PFK10A PIC  X(0001).
  1614     05  PFK10I PIC  X(0014).
  1615 01  EL652AO REDEFINES EL652AI.
  1616     05  FILLER            PIC  X(0012).
  1617*    -------------------------------
  1618     05  FILLER            PIC  X(0003).
  1619     05  RUNDATEO PIC  X(0008).
  1620*    -------------------------------
  1621     05  FILLER            PIC  X(0003).
  1622     05  RUNTIMEO PIC  99.99.
  1623*    -------------------------------
  1624     05  FILLER            PIC  X(0003).
  1625     05  CMPNYIDO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL652.cbl
  1626*    -------------------------------
  1627     05  FILLER            PIC  X(0003).
  1628     05  USERIDO PIC  X(0004).
  1629*    -------------------------------
  1630     05  FILLER            PIC  X(0003).
  1631     05  MAINTYPO PIC  X(0001).
  1632*    -------------------------------
  1633     05  FILLER            PIC  X(0003).
  1634     05  SCDESCO PIC  X(0008).
  1635*    -------------------------------
  1636     05  FILLER            PIC  X(0003).
  1637     05  FLITYPEO PIC  X(0004).
  1638*    -------------------------------
  1639     05  FILLER            PIC  X(0003).
  1640     05  CARRIERO PIC  X(0001).
  1641*    -------------------------------
  1642     05  FILLER            PIC  X(0003).
  1643     05  GROUPO PIC  X(0006).
  1644*    -------------------------------
  1645     05  FILLER            PIC  X(0003).
  1646     05  TYPEO PIC  X(0001).
  1647*    -------------------------------
  1648     05  FILLER            PIC  X(0003).
  1649     05  FINRESPO PIC  X(0010).
  1650*    -------------------------------
  1651     05  FILLER            PIC  X(0003).
  1652     05  ACCTNOO PIC  X(0010).
  1653*    -------------------------------
  1654     05  FILLER            PIC  X(0003).
  1655     05  SUMMNOO PIC  X(0006).
  1656*    -------------------------------
  1657     05  FILLER            PIC  X(0003).
  1658     05  LSTMDTO PIC  X(0008).
  1659*    -------------------------------
  1660     05  FILLER            PIC  X(0003).
  1661     05  FLITYPO PIC  X(0001).
  1662*    -------------------------------
  1663     05  FILLER            PIC  X(0003).
  1664     05  PCONTO PIC  X(0030).
  1665*    -------------------------------
  1666     05  FILLER            PIC  X(0003).
  1667     05  PNT1099O PIC  X(0001).
  1668*    -------------------------------
  1669     05  FILLER            PIC  X(0003).
  1670     05  MAILNAMO PIC  X(0030).
  1671*    -------------------------------
  1672     05  FILLER            PIC  X(0003).
  1673     05  SSNO PIC  X(0013).
  1674*    -------------------------------
  1675     05  FILLER            PIC  X(0003).
  1676     05  ACCTNAMO PIC  X(0030).
  1677*    -------------------------------
  1678     05  FILLER            PIC  X(0003).
  1679     05  PHONEO PIC  X(0012).
  1680*    -------------------------------
  1681     05  FILLER            PIC  X(0003).
  1682     05  ADDR1O PIC  X(0030).
  1683*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL652.cbl
  1684     05  FILLER            PIC  X(0003).
  1685     05  FAXDESCO PIC  X(0016).
  1686*    -------------------------------
  1687     05  FILLER            PIC  X(0003).
  1688     05  FAXNOO PIC  X(0012).
  1689*    -------------------------------
  1690     05  FILLER            PIC  X(0003).
  1691     05  ADDR2O PIC  X(0030).
  1692*    -------------------------------
  1693     05  FILLER            PIC  X(0003).
  1694     05  CARBALO PIC  X(0001).
  1695*    -------------------------------
  1696     05  FILLER            PIC  X(0003).
  1697     05  CITYO PIC  X(0028).
  1698*    -------------------------------
  1699     05  FILLER            PIC  X(0003).
  1700     05  STATEO PIC  X(0002).
  1701*    -------------------------------
  1702     05  FILLER            PIC  X(0003).
  1703     05  REFEHO PIC  X(0013).
  1704*    -------------------------------
  1705     05  FILLER            PIC  X(0003).
  1706     05  REFEO PIC  X(0001).
  1707*    -------------------------------
  1708     05  FILLER            PIC  X(0003).
  1709     05  ZIPCODEO PIC  X(0010).
  1710*    -------------------------------
  1711     05  FILLER            PIC  X(0003).
  1712     05  NGDESCO PIC  X(0012).
  1713*    -------------------------------
  1714     05  FILLER            PIC  X(0003).
  1715     05  NETGRSO PIC  X(0001).
  1716*    -------------------------------
  1717     05  FILLER            PIC  X(0003).
  1718     05  AHL120O PIC  X(0016).
  1719*    -------------------------------
  1720     05  FILLER            PIC  X(0003).
  1721     05  OVER120O PIC  Z,ZZZ,ZZZ.99-.
  1722*    -------------------------------
  1723     05  FILLER            PIC  X(0003).
  1724     05  CSRO PIC  X(0004).
  1725*    -------------------------------
  1726     05  FILLER            PIC  X(0003).
  1727     05  RPTCDDO PIC  X(0010).
  1728*    -------------------------------
  1729     05  FILLER            PIC  X(0003).
  1730     05  RPTCD2O PIC  X(0010).
  1731*    -------------------------------
  1732     05  FILLER            PIC  X(0003).
  1733     05  CKDESCO PIC  X(0016).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  CKPULLO PIC  X(0001).
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  BILLPRTO PIC  X(0001).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL652.cbl
  1742     05  LETDESCO PIC  X(0011).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  LETRCDO PIC  X(0001).
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  BALPRTO PIC  X(0011).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  BALCDO PIC  X(0001).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
  1754     05  SPPDDHO PIC  X(0012).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  SPPDDO PIC  X(0001).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  MFLABLO PIC  X(0016).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  MAXFEEO PIC  Z99.99.
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  CSLABLO PIC  X(0012).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  CLPSTO PIC  X(0002).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  LFLABLO PIC  X(0016).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  MAXLFO PIC  Z99.99.
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  BALFWDO PIC  Z,ZZZ,ZZZ.99-.
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  CURCOMO PIC  Z,ZZZ,ZZZ.99-.
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  CURCHGO PIC  Z,ZZZ,ZZZ.99-.
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  CURPMTO PIC  Z,ZZZ,ZZZ.99-.
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  ENDBALO PIC  Z,ZZZ,ZZZ.99-.
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  CURRENTO PIC  Z,ZZZ,ZZZ.99-.
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  OVER30O PIC  Z,ZZZ,ZZZ.99-.
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  OVER60O PIC  Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL652.cbl
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  OVER90O PIC  Z,ZZZ,ZZZ.99-.
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  YTDCOMO PIC  Z,ZZZ,ZZZ.99-.
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  LSTDTEO PIC  X(0008).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  LSTTIMEO PIC  99.99.
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  LSTUSRO PIC  X(0004).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  ERRMSG1O PIC  X(0072).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  PFKEYO PIC  X(0002).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  PFK5O PIC  X(0011).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  PFK7O PIC  X(0012).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  PFK9O PIC  X(0012).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  PFK13O PIC  X(0011).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  PFK4O PIC  X(0012).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  PFK6O PIC  X(0011).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  PFK10O PIC  X(0014).
  1842*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL652.cbl
  1844****************************************************************
  1845*
  1846* Copyright (c) 2007 by Clerity Solutions, Inc.
  1847* All rights reserved.
  1848*
  1849****************************************************************
  1850 01  DFHEIV.
  1851   02  DFHEIV0               PIC X(35).
  1852   02  DFHEIV1               PIC X(08).
  1853   02  DFHEIV2               PIC X(08).
  1854   02  DFHEIV3               PIC X(08).
  1855   02  DFHEIV4               PIC X(06).
  1856   02  DFHEIV5               PIC X(04).
  1857   02  DFHEIV6               PIC X(04).
  1858   02  DFHEIV7               PIC X(02).
  1859   02  DFHEIV8               PIC X(02).
  1860   02  DFHEIV9               PIC X(01).
  1861   02  DFHEIV10              PIC S9(7) COMP-3.
  1862   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1863   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1864   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1865   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1866   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1867   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1868   02  DFHEIV17              PIC X(04).
  1869   02  DFHEIV18              PIC X(04).
  1870   02  DFHEIV19              PIC X(04).
  1871   02  DFHEIV20              USAGE IS POINTER.
  1872   02  DFHEIV21              USAGE IS POINTER.
  1873   02  DFHEIV22              USAGE IS POINTER.
  1874   02  DFHEIV23              USAGE IS POINTER.
  1875   02  DFHEIV24              USAGE IS POINTER.
  1876   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1877   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1878   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1879   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1880   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1881   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1882   02  FILLER                PIC X(02).
  1883   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1884   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1885   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1886   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1887   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1888 LINKAGE  SECTION.
  1889*****************************************************************
  1890*                                                               *
  1891* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1892* All rights reserved.                                          *
  1893*                                                               *
  1894*****************************************************************
  1895 01  dfheiblk.
  1896     02  eibtime          pic s9(7) comp-3.
  1897     02  eibdate          pic s9(7) comp-3.
  1898     02  eibtrnid         pic x(4).
  1899     02  eibtaskn         pic s9(7) comp-3.
  1900     02  eibtrmid         pic x(4).
  1901     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL652.cbl
  1902     02  eibcposn         pic s9(4) comp.
  1903     02  eibcalen         pic s9(4) comp.
  1904     02  eibaid           pic x(1).
  1905     02  eibfiller1       pic x(1).
  1906     02  eibfn            pic x(2).
  1907     02  eibfiller2       pic x(2).
  1908     02  eibrcode         pic x(6).
  1909     02  eibfiller3       pic x(2).
  1910     02  eibds            pic x(8).
  1911     02  eibreqid         pic x(8).
  1912     02  eibrsrce         pic x(8).
  1913     02  eibsync          pic x(1).
  1914     02  eibfree          pic x(1).
  1915     02  eibrecv          pic x(1).
  1916     02  eibsend          pic x(1).
  1917     02  eibatt           pic x(1).
  1918     02  eibeoc           pic x(1).
  1919     02  eibfmh           pic x(1).
  1920     02  eibcompl         pic x(1).
  1921     02  eibsig           pic x(1).
  1922     02  eibconf          pic x(1).
  1923     02  eiberr           pic x(1).
  1924     02  eibrldbk         pic x(1).
  1925     02  eiberrcd         pic x(4).
  1926     02  eibsynrb         pic x(1).
  1927     02  eibnodat         pic x(1).
  1928     02  eibfiller5       pic x(2).
  1929     02  eibresp          pic 9(09) comp.
  1930     02  eibresp2         pic 9(09) comp.
  1931     02  dfheigdj         pic s9(4) comp.
  1932     02  dfheigdk         pic s9(4) comp.
  1933
  1934 01  DFHCOMMAREA             PIC  X(1024).
  1935
  1936*01 PARMLIST .
  1937*    12  FILLER              PIC S9(8)                  COMP.
  1938*    12  ERCOMP-POINTER      PIC S9(8)                  COMP.
  1939*    12  ERNAME-POINTER      PIC S9(8)                  COMP.
  1940*    12  ELCNTL-POINTER      PIC S9(8)                  COMP.
  1941*    12  ERSUMM-POINTER      PIC S9(8)                  COMP.
  1942*    12  ERRQST-POINTER      PIC S9(8)                  COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL652.cbl
  1944*                            COPY ERCCOMP.
  1945******************************************************************
  1946*                                                                *
  1947*                                                                *
  1948*                            ERCCOMP                             *
  1949*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1950*                            VMOD=2.019                          *
  1951*                                                                *
  1952*   ONLINE CREDIT SYSTEM                                         *
  1953*                                                                *
  1954*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1955*                                                                *
  1956*   FILE TYPE = VSAM,KSDS                                        *
  1957*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1958*                                                                *
  1959*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1960*       ALTERNATE PATH = NONE                                    *
  1961*                                                                *
  1962*   LOG = NO                                                     *
  1963*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1964*                                                                *
  1965******************************************************************
  1966*                   C H A N G E   L O G
  1967*
  1968* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1969*-----------------------------------------------------------------
  1970*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1971* EFFECTIVE    NUMBER
  1972*-----------------------------------------------------------------
  1973* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1974* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1975* 092205    2005050300006  PEMA  ADD LEASE FEE
  1976* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1977* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1978* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1979* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1980* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1981* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1982******************************************************************
  1983
  1984 01  COMPENSATION-MASTER.
  1985     12  CO-RECORD-ID                          PIC XX.
  1986         88  VALID-CO-ID                          VALUE 'CO'.
  1987
  1988     12  CO-CONTROL-PRIMARY.
  1989         16  CO-COMPANY-CD                     PIC X.
  1990         16  CO-CONTROL.
  1991             20  CO-CTL-1.
  1992                 24  CO-CARR-GROUP.
  1993                     28  CO-CARRIER            PIC X.
  1994                     28  CO-GROUPING.
  1995                         32  CO-GROUP-PREFIX   PIC XXX.
  1996                         32  CO-GROUP-PRIME    PIC XXX.
  1997                 24  CO-RESP-NO.
  1998                     28  CO-RESP-PREFIX        PIC X(4).
  1999                     28  CO-RESP-PRIME         PIC X(6).
  2000             20  CO-CTL-2.
  2001                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL652.cbl
  2002                     28  CO-ACCT-PREFIX        PIC X(4).
  2003                     28  CO-ACCT-PRIME         PIC X(6).
  2004         16  CO-TYPE                           PIC X.
  2005             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2006             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2007             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2008
  2009     12  CO-MAINT-INFORMATION.
  2010         16  CO-LAST-MAINT-DT                  PIC XX.
  2011         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2012         16  CO-LAST-MAINT-USER                PIC X(4).
  2013     12  FILLER                                PIC XX.
  2014     12  CO-STMT-TYPE                          PIC XXX.
  2015     12  CO-COMP-TYPE                          PIC X.
  2016         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2017     12  CO-STMT-OWNER                         PIC X(4).
  2018     12  CO-BALANCE-CONTROL                    PIC X.
  2019         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2020         88  CO-NO-BALANCE                        VALUE 'N'.
  2021
  2022     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2023         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2024         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2025         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2026
  2027     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2028         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2029         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2030
  2031     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2032     12  CO-GA-DIRECT-DEP                      PIC X.
  2033     12  CO-FUTURE-SPACE                       PIC X.
  2034         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2035
  2036     12  CO-ACCT-NAME                          PIC X(30).
  2037     12  CO-MAIL-NAME                          PIC X(30).
  2038     12  CO-ADDR-1                             PIC X(30).
  2039     12  CO-ADDR-2                             PIC X(30).
  2040     12  CO-ADDR-3.
  2041         16  CO-ADDR-CITY                      PIC X(27).
  2042         16  CO-ADDR-STATE                     PIC XX.
  2043     12  CO-CSO-1099                           PIC X.
  2044     12  CO-ZIP.
  2045         16  CO-ZIP-PRIME.
  2046             20  CO-ZIP-PRI-1ST                PIC X.
  2047                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2048             20  FILLER                        PIC X(4).
  2049         16  CO-ZIP-PLUS4                      PIC X(4).
  2050     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2051         16  CO-CAN-POSTAL-1                   PIC XXX.
  2052         16  CO-CAN-POSTAL-2                   PIC XXX.
  2053         16  FILLER                            PIC XXX.
  2054     12  CO-SOC-SEC                            PIC X(13).
  2055     12  CO-TELEPHONE.
  2056         16  CO-AREA-CODE                      PIC XXX.
  2057         16  CO-PREFIX                         PIC XXX.
  2058         16  CO-PHONE                          PIC X(4).
  2059
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL652.cbl
  2060     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2061
  2062     12  CO-AR-BAL-LEVEL                       PIC X.
  2063         88  CO-AR-REF-LVL                        VALUE '1'.
  2064         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2065         88  CO-AR-BILL-LVL                       VALUE '2'.
  2066         88  CO-AR-AGT-LVL                        VALUE '3'.
  2067         88  CO-AR-FR-LVL                         VALUE '4'.
  2068
  2069     12  CO-AR-NORMAL-PRINT                    PIC X.
  2070         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2071         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2072
  2073     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2074
  2075     12  CO-AR-REPORTING                       PIC X.
  2076         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2077         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2078
  2079     12  CO-AR-PULL-CHECK                      PIC X.
  2080         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2081         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2082
  2083     12  CO-AR-BALANCE-PRINT                   PIC X.
  2084         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2085
  2086     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2087         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2088         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2089         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2090
  2091     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2092
  2093     12  CO-USER-CODE                          PIC X.
  2094     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2095
  2096******************************************************************
  2097*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2098*    THE LAST MONTH END RUN.
  2099******************************************************************
  2100
  2101     12  CO-LAST-ACTIVITY-DATE.
  2102         16  CO-ACT-YEAR                       PIC 99.
  2103         16  CO-ACT-MONTH                      PIC 99.
  2104         16  CO-ACT-DAY                        PIC 99.
  2105
  2106     12  CO-LAST-STMT-DT.
  2107         16  CO-LAST-STMT-YEAR                 PIC 99.
  2108         16  CO-LAST-STMT-MONTH                PIC 99.
  2109         16  CO-LAST-STMT-DAY                  PIC 99.
  2110
  2111     12  CO-MO-END-TOTALS.
  2112         16  CO-MONTHLY-TOTALS.
  2113             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2114             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2115             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2116             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2117             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL652.cbl
  2118
  2119         16  CO-AGING-TOTALS.
  2120             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2121             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2122             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2123             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2124
  2125         16  CO-YTD-TOTALS.
  2126             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2127             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2128
  2129         16  CO-OVER-UNDER-TOTALS.
  2130             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2131             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2132
  2133     12  CO-MISCELLANEOUS-TOTALS.
  2134         16  CO-FICA-TOTALS.
  2135             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2136             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2137
  2138         16  CO-CLAIM-TOTALS.
  2139             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2140             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2141
  2142******************************************************************
  2143*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2144*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2145******************************************************************
  2146
  2147     12  CO-CURRENT-TOTALS.
  2148         16  CO-CURRENT-LAST-STMT-DT.
  2149             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2150             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2151             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2152
  2153         16  CO-CURRENT-MONTHLY-TOTALS.
  2154             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2155             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2156             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2157             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2158             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2159
  2160         16  CO-CURRENT-AGING-TOTALS.
  2161             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2162             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2163             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2164             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2165
  2166         16  CO-CURRENT-YTD-TOTALS.
  2167             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2168             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2169
  2170     12  CO-PAID-COMM-TOTALS.
  2171         16  CO-YTD-PAID-COMMS.
  2172             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2173             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2174
  2175     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL652.cbl
  2176         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2177         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2178
  2179     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2180         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2181         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2182         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2183         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2184         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2185         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2186         88  CO-FINAL-LETTER                  VALUE 'F'.
  2187         88  CO-RECONCILING                   VALUE 'R'.
  2188         88  CO-PHONE-CALL                    VALUE 'P'.
  2189         88  CO-LEGAL                         VALUE 'L'.
  2190         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2191         88  CO-WRITE-OFF                     VALUE 'W'.
  2192         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2193
  2194     12  CO-CSR-CODE                       PIC X(4).
  2195
  2196     12  CO-GA-STATUS-INFO.
  2197         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2198         16  CO-GA-TERMINATION-DT          PIC XX.
  2199         16  CO-GA-STATUS-CODE             PIC X.
  2200             88  CO-GA-ACTIVE                 VALUE 'A'.
  2201             88  CO-GA-INACTIVE               VALUE 'I'.
  2202             88  CO-GA-PENDING                VALUE 'P'.
  2203         16  CO-GA-COMMENTS.
  2204             20  CO-GA-COMMENT-1           PIC X(40).
  2205             20  CO-GA-COMMENT-2           PIC X(40).
  2206             20  CO-GA-COMMENT-3           PIC X(40).
  2207             20  CO-GA-COMMENT-4           PIC X(40).
  2208
  2209     12  CO-RPTCD2                         PIC X(10).
  2210     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2211         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2212         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2213
  2214     12  CO-TYPE-AGENT                     PIC X(01).
  2215         88  CO-CORPORATION                   VALUE 'C'.
  2216         88  CO-PARTNERSHIP                   VALUE 'P'.
  2217         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2218         88  CO-TRUST                         VALUE 'T'.
  2219         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2220
  2221     12  CO-FAXNO.
  2222         16  CO-FAX-AREA-CODE                  PIC XXX.
  2223         16  CO-FAX-PREFIX                     PIC XXX.
  2224         16  CO-FAX-PHONE                      PIC X(4).
  2225
  2226     12  CO-BANK-INFORMATION.
  2227         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2228         16  CO-BANK-TRANSIT-NON REDEFINES
  2229             CO-BANK-TRANSIT-NO                PIC 9(8).
  2230
  2231         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2232     12  CO-MISC-DEDUCT-INFO REDEFINES
  2233                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL652.cbl
  2234         16  CO-MD-GL-ACCT                     PIC X(10).
  2235         16  CO-MD-DIV                         PIC XX.
  2236         16  CO-MD-CENTER                      PIC X(4).
  2237         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2238         16  CO-CREATE-AP-CHECK                PIC X.
  2239         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2240         16  FILLER                            PIC XXX.
  2241     12  CO-ACH-STATUS                         PIC X.
  2242         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2243         88  CO-ACH-PENDING                        VALUE 'P'.
  2244
  2245     12  CO-BILL-SW                            PIC X.
  2246     12  CO-CONTROL-NAME                       PIC X(30).
  2247     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2248     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2249     12  CO-CLP-STATE                          PIC XX.
  2250     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2251     12  CO-SPP-REFUND-EDIT                    PIC X.
  2252
  2253******************************************************************
  2254*                            COPY ERCAGTC.
  2255******************************************************************
  2256*                                                                *
  2257*                                                                *
  2258*                            ERCAGTC                             *
  2259*                            VMOD=2.001                          *
  2260*                                                                *
  2261*   ONLINE CREDIT SYSTEM                                         *
  2262*                                                                *
  2263*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2264*                                                                *
  2265*   FILE TYPE = VSAM,KSDS                                        *
  2266*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2267*                                                                *
  2268*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2269*       ALTERNATE PATH = NONE                                    *
  2270*                                                                *
  2271*   LOG = NO                                                     *
  2272*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2273*                                                                *
  2274******************************************************************
  2275*                   C H A N G E   L O G
  2276*
  2277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2278*-----------------------------------------------------------------
  2279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2280* EFFECTIVE    NUMBER
  2281*-----------------------------------------------------------------
  2282* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2283* 111004                         NEW FILE AND COPYBOOK
  2284* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2285******************************************************************
  2286 01  AGENT-COMMISSIONS.
  2287     12  AG-RECORD-ID                          PIC XX.
  2288         88  VALID-CO-ID                          VALUE 'AG'.
  2289     12  AG-CONTROL-PRIMARY.
  2290         16  AG-COMPANY-CD                     PIC X.
  2291         16  AG-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL652.cbl
  2292             20  AG-CTL-1.
  2293                 24  AG-CARR-GROUP.
  2294                     28  AG-CARRIER            PIC X.
  2295                     28  AG-GROUPING           PIC X(6).
  2296                 24  AG-BANK                   PIC X(10).
  2297             20  AG-CTL-2.
  2298                 24  AG-EXP-DT                 PIC XX.
  2299         16  AG-TYPE                           PIC X.
  2300             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2301             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2302     12  AG-MAINT-INFORMATION.
  2303         16  AG-LAST-MAINT-DT                  PIC XX.
  2304         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2305         16  AG-LAST-MAINT-USER                PIC X(4).
  2306         16  FILLER                            PIC X(10).
  2307     12  AG-EFF-DT                             PIC XX.
  2308     12  AG-COMM-STRUCTURE.
  2309         16  AG-AGT-COMMS OCCURS 10.
  2310             20  AG-AGT                PIC X(10).
  2311             20  AG-COM-TYP            PIC X.
  2312             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2313             20  AG-RECALC-LV-INDIC    PIC X.
  2314             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2315             20  AG-LRCALC-LV-INDIC    PIC X.
  2316             20  FILLER                PIC X(05).
  2317     12  FILLER                  PIC X(145).
  2318******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL652.cbl
  2320*                            COPY ERCNAME.
  2321******************************************************************
  2322*                                                                *
  2323*                                                                *
  2324*                            ERCNAME                             *
  2325*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2326*                            VMOD=2.003                          *
  2327*                                                                *
  2328*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  2329*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  2330*                                                                *
  2331*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  2332*                                                                *
  2333*   FILE TYPE = VSAM,KSDS                                        *
  2334*   RECORD SIZE = 160   RECFORM = FIX                            *
  2335*                                                                *
  2336*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  2337*                                                                *
  2338*   LOG = NO                                                     *
  2339*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2340*                                                                *
  2341*                                                                *
  2342******************************************************************
  2343
  2344 01  NAME-LOOKUP-MASTER.
  2345     12  NL-RECORD-ID                PIC  X(02).
  2346         88  VALID-NL-ID                         VALUE 'NL'.
  2347
  2348     12  NL-RECORD-KEY.
  2349         16  NL-CONTROL-PRIMARY.
  2350             20  NL-COMPANY-CD       PIC  X(01).
  2351             20  NL-NAME             PIC  X(30).
  2352             20  NL-RECORD-TYPE      PIC  X(01).
  2353                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  2354                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  2355                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  2356
  2357         16  NL-ACCOUNT-MASTER.
  2358             20  NL-AM-COMPANY-CD    PIC  X(01).
  2359             20  NL-AM-CARRIER       PIC  X(01).
  2360             20  NL-AM-GROUPING      PIC  X(06).
  2361             20  NL-AM-STATE         PIC  X(02).
  2362             20  NL-AM-ACCOUNT       PIC  X(10).
  2363             20  FILLER              PIC  X(09).
  2364
  2365         16  NL-COMPENSATION-MASTER
  2366                                 REDEFINES  NL-ACCOUNT-MASTER.
  2367             20  NL-CO-COMPANY-CD    PIC  X(01).
  2368             20  NL-CO-CARRIER       PIC  X(01).
  2369             20  NL-CO-GROUPING      PIC  X(06).
  2370             20  NL-CO-RESP-NO       PIC  X(10).
  2371             20  NL-CO-ACCOUNT       PIC  X(10).
  2372             20  NL-CO-TYPE          PIC  X(01).
  2373
  2374         16  NL-REINSURANCE-RECORD
  2375                                 REDEFINES  NL-ACCOUNT-MASTER.
  2376             20  NL-RE-COMPANY-CD    PIC  X(01).
  2377             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL652.cbl
  2378             20  NL-RE-COMPANY.
  2379                 24  NL-RE-COMP      PIC  X(03).
  2380                 24  NL-RE-CO-SUB    PIC  X(03).
  2381             20  NL-RE-TABLE         PIC  X(03).
  2382             20  FILLER              PIC  X(18).
  2383
  2384     12  NL-MAINT-INFORMATION.
  2385         16  NL-LAST-MAINT-DT        PIC  X(02).
  2386         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  2387         16  NL-LAST-MAINT-USER      PIC  X(04).
  2388         16  FILLER                  PIC  X(10).
  2389
  2390     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  2391         16  NL-RE-LEVEL             PIC  9(02).
  2392
  2393     12  NL-CITY                     PIC  X(15).
  2394     12  NL-ST                       PIC  XX.
  2395
  2396******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL652.cbl
  2398*                            COPY ELCCNTL.
  2399******************************************************************
  2400*                                                                *
  2401*                                                                *
  2402*                            ELCCNTL.                            *
  2403*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2404*                            VMOD=2.059                          *
  2405*                                                                *
  2406*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2407*                                                                *
  2408*   FILE TYPE = VSAM,KSDS                                        *
  2409*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2410*                                                                *
  2411*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2412*       ALTERNATE INDEX = NONE                                   *
  2413*                                                                *
  2414*   LOG = YES                                                    *
  2415*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2416******************************************************************
  2417*                   C H A N G E   L O G
  2418*
  2419* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2420*-----------------------------------------------------------------
  2421*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2422* EFFECTIVE    NUMBER
  2423*-----------------------------------------------------------------
  2424* 082503                   PEMA  ADD BENEFIT GROUP
  2425* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2426* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2427* 092705    2005050300006  PEMA  ADD SPP LEASES
  2428* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2429* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2430* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2431* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2432* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2433******************************************************************
  2434*
  2435 01  CONTROL-FILE.
  2436     12  CF-RECORD-ID                       PIC XX.
  2437         88  VALID-CF-ID                        VALUE 'CF'.
  2438
  2439     12  CF-CONTROL-PRIMARY.
  2440         16  CF-COMPANY-ID                  PIC XXX.
  2441         16  CF-RECORD-TYPE                 PIC X.
  2442             88  CF-COMPANY-MASTER              VALUE '1'.
  2443             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2444             88  CF-STATE-MASTER                VALUE '3'.
  2445             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2446             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2447             88  CF-CARRIER-MASTER              VALUE '6'.
  2448             88  CF-MORTALITY-MASTER            VALUE '7'.
  2449             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2450             88  CF-TERMINAL-MASTER             VALUE '9'.
  2451             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2452             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2453             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2454             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2455             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL652.cbl
  2456             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2457             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2458             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2459             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2460         16  CF-ACCESS-CD-GENL              PIC X(4).
  2461         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2462             20  CF-PROCESSOR               PIC X(4).
  2463         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2464             20  CF-STATE-CODE              PIC XX.
  2465             20  FILLER                     PIC XX.
  2466         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2467             20  FILLER                     PIC XX.
  2468             20  CF-HI-BEN-IN-REC           PIC XX.
  2469         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2470             20  FILLER                     PIC XXX.
  2471             20  CF-CARRIER-CNTL            PIC X.
  2472         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2473             20  FILLER                     PIC XX.
  2474             20  CF-HI-TYPE-IN-REC          PIC 99.
  2475         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2476             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2477                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2478             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2479             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2480         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2481             20  FILLER                     PIC X.
  2482             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2483         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2484             20  FILLER                     PIC XX.
  2485             20  CF-MORTGAGE-PLAN           PIC XX.
  2486         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2487
  2488     12  CF-LAST-MAINT-DT                   PIC XX.
  2489     12  CF-LAST-MAINT-BY                   PIC X(4).
  2490     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2491
  2492     12  CF-RECORD-BODY                     PIC X(728).
  2493
  2494
  2495****************************************************************
  2496*             COMPANY MASTER RECORD                            *
  2497****************************************************************
  2498
  2499     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2500         16  CF-COMPANY-ADDRESS.
  2501             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2502             20  CF-CL-IN-CARE-OF           PIC X(30).
  2503             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2504             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2505             20  CF-CL-CITY-STATE           PIC X(30).
  2506             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2507             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2508         16  CF-COMPANY-CD                  PIC X.
  2509         16  CF-COMPANY-PASSWORD            PIC X(8).
  2510         16  CF-SECURITY-OPTION             PIC X.
  2511             88  ALL-SECURITY                   VALUE '1'.
  2512             88  COMPANY-VERIFY                 VALUE '2'.
  2513             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL652.cbl
  2514             88  NO-SECURITY                    VALUE '4'.
  2515             88  ALL-BUT-TERM                   VALUE '5'.
  2516         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2517             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2518         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2519             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2520         16  CF-INFORCE-LOCATION            PIC X.
  2521             88  CERTS-ARE-ONLINE               VALUE '1'.
  2522             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2523             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2524         16  CF-LOWER-CASE-LETTERS          PIC X.
  2525         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2526             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2527             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2528             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2529             88  CF-ACCNT-CNTL                  VALUE '3'.
  2530             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2531
  2532         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2533         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2534
  2535         16  CF-LGX-CREDIT-USER             PIC X.
  2536             88  CO-IS-NOT-USER                 VALUE 'N'.
  2537             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2538
  2539         16 CF-CREDIT-CALC-CODES.
  2540             20  CF-CR-REM-TERM-CALC PIC X.
  2541               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2542               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2543               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2544               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2545               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2546               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2547               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2548             20  CF-CR-R78-METHOD           PIC X.
  2549               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2550               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2551
  2552         16  CF-CLAIM-CONTROL-COUNTS.
  2553             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2554                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2555
  2556             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2557                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2558
  2559             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2560                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2561
  2562             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2563                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2564
  2565         16  CF-CURRENT-MONTH-END           PIC XX.
  2566
  2567         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2568             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2569             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2570             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2571             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL652.cbl
  2572                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2573                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2574             20  CF-CO-PREM-REJECT-SW       PIC X.
  2575                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2576                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2577             20  CF-CO-REF-REJECT-SW        PIC X.
  2578                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2579                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2580
  2581         16  CF-CO-REPORTING-DT             PIC XX.
  2582         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2583         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2584           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2585           88  CF-CO-MONTH-END                  VALUE '1'.
  2586
  2587         16  CF-LGX-CLAIM-USER              PIC X.
  2588             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2589             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2590
  2591         16  CF-CREDIT-EDIT-CONTROLS.
  2592             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2593             20  CF-MIN-AGE                 PIC 99.
  2594             20  CF-DEFAULT-AGE             PIC 99.
  2595             20  CF-MIN-TERM                PIC S999      COMP-3.
  2596             20  CF-MAX-TERM                PIC S999      COMP-3.
  2597             20  CF-DEFAULT-SEX             PIC X.
  2598             20  CF-JOINT-AGE-INPUT         PIC X.
  2599                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2600             20  CF-BIRTH-DATE-INPUT        PIC X.
  2601                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2602             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2603                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2604                 88  CF-ZERO-CARRIER            VALUE '1'.
  2605                 88  CF-ZERO-GROUPING           VALUE '2'.
  2606                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2607             20  CF-EDIT-SW                 PIC X.
  2608                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2609             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2610             20  CF-CR-PR-METHOD            PIC X.
  2611               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2612               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2613             20  FILLER                     PIC X.
  2614
  2615         16  CF-CREDIT-MISC-CONTROLS.
  2616             20  CF-REIN-TABLE-SW           PIC X.
  2617                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2618             20  CF-COMP-TABLE-SW           PIC X.
  2619                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2620             20  CF-EXPERIENCE-RETENTION-AGE
  2621                                            PIC S9        COMP-3.
  2622             20  CF-CONVERSION-DT           PIC XX.
  2623             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2624             20  CF-RUN-FREQUENCY-SW        PIC X.
  2625                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2626                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2627
  2628             20  CF-CR-CHECK-NO-CONTROL.
  2629                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL652.cbl
  2630                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2631                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2632                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2633                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2634                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2635
  2636                 24  CF-CR-CHECK-COUNT       REDEFINES
  2637                     CF-CR-CHECK-COUNTER      PIC X(4).
  2638
  2639                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2640                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2641
  2642                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2643                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2644                 24  CF-MAIL-PROCESSING       PIC X.
  2645                     88  MAIL-PROCESSING          VALUE 'Y'.
  2646
  2647         16  CF-MISC-SYSTEM-CONTROL.
  2648             20  CF-SYSTEM-C                 PIC X.
  2649                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2650             20  CF-SYSTEM-D                 PIC X.
  2651                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2652             20  CF-SOC-SEC-NO-SW            PIC X.
  2653                 88  SOC-SEC-NO-USED             VALUE '1'.
  2654             20  CF-MEMBER-NO-SW             PIC X.
  2655                 88  MEMBER-NO-USED              VALUE '1'.
  2656             20  CF-TAX-ID-NUMBER            PIC X(11).
  2657             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2658             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2659                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2660                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2661                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2662                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2663             20  CF-SYSTEM-E                 PIC X.
  2664                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2665
  2666         16  CF-LGX-LIFE-USER               PIC X.
  2667             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2668             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2669
  2670         16  CF-CR-MONTH-END-DT             PIC XX.
  2671
  2672         16  CF-FILE-MAINT-DATES.
  2673             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2674                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2675             20  CF-LAST-BATCH       REDEFINES
  2676                 CF-LAST-BATCH-NO               PIC X(4).
  2677             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2678             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2679             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2680             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2681             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2682             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2683             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2684             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2685             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2686             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2687
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL652.cbl
  2688         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2689         16  FILLER                         PIC X.
  2690
  2691         16  CF-ALT-MORT-CODE               PIC X(4).
  2692         16  CF-MEMBER-CAPTION              PIC X(10).
  2693
  2694         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2695             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2696             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2697             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2698             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2699             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2700
  2701         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2702
  2703         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2704         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2705         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2706         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2707
  2708         16  CF-AH-OVERRIDE-L1              PIC X.
  2709         16  CF-AH-OVERRIDE-L2              PIC XX.
  2710         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2711         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2712
  2713         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2714         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2715
  2716         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2717         16  CF-AR-LAST-EL860-DT            PIC XX.
  2718         16  CF-MP-MONTH-END-DT             PIC XX.
  2719
  2720         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2721         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2722             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2723
  2724         16  CF-AR-MONTH-END-DT             PIC XX.
  2725
  2726         16  CF-CRDTCRD-USER                PIC X.
  2727             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2728             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2729
  2730         16  CF-CC-MONTH-END-DT             PIC XX.
  2731
  2732         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2733
  2734         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2735             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2736             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2737             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2738         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2739         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2740         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2741         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2742             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2743             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2744         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2745         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL652.cbl
  2746         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2747             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2748         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2749
  2750         16  CF-CL-ZIP-CODE.
  2751             20  CF-CL-ZIP-PRIME.
  2752                 24  CF-CL-ZIP-1ST          PIC X.
  2753                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2754                 24  FILLER                 PIC X(4).
  2755             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2756         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2757             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2758             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2759             20  FILLER                     PIC XXX.
  2760
  2761         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2762         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2763         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2764         16  CF-CO-OPTION-START-DATE        PIC XX.
  2765         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2766           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2767                                                      '3' '4'.
  2768           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2769           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2770           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2771           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2772           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2773           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2774
  2775         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2776
  2777         16  CF-PAYMENT-APPROVAL-LEVELS.
  2778             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2779             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2780             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2781             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2782             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2783             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2784
  2785         16  CF-END-USER-REPORTING-USER     PIC X.
  2786             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2787             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2788
  2789         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2790             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2791             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2792
  2793         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2794
  2795         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2796         16  FILLER                         PIC X.
  2797
  2798         16  CF-CREDIT-ARCHIVE-CNTL.
  2799             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2800             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2801             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2802
  2803         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL652.cbl
  2804
  2805         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2806             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2807             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2808
  2809         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2810             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2811             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2812
  2813         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2814
  2815         16  CF-CO-ACH-ID-CODE              PIC  X.
  2816             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2817             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2818             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2819         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2820         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2821         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2822         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2823         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2824         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2825         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2826         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2827         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2828                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2829         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2830                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2831
  2832         16  CF-CO-OVER-SHORT.
  2833             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2834             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2835
  2836*         16  FILLER                         PIC X(102).
  2837         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2838             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2839             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2840
  2841         16  CF-AH-APPROVAL-DAYS.
  2842             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2843             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2844             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2845             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2846
  2847         16  FILLER                         PIC X(82).
  2848****************************************************************
  2849*             PROCESSOR/USER RECORD                            *
  2850****************************************************************
  2851
  2852     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2853         16  CF-PROCESSOR-NAME              PIC X(30).
  2854         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2855         16  CF-PROCESSOR-TITLE             PIC X(26).
  2856         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2857                 88  MESSAGE-YES                VALUE 'Y'.
  2858                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2859
  2860*****************************************************
  2861****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL652.cbl
  2862****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2863****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2864****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2865*****************************************************
  2866
  2867         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2868             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2869             20  CF-APPLICATION-FORCE       PIC X.
  2870             20  CF-INDIVIDUAL-APP.
  2871                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2872                     28  CF-BROWSE-APP      PIC X.
  2873                     28  CF-UPDATE-APP      PIC X.
  2874
  2875         16  CF-CURRENT-TERM-ON             PIC X(4).
  2876         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2877             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2878             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2879             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2880             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2881             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2882             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2883             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2884         16  CF-PROCESSOR-CARRIER           PIC X.
  2885             88  NO-CARRIER-SECURITY            VALUE ' '.
  2886         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2887             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2888         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2889             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2890         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2891             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2892
  2893         16  CF-PROC-SYS-ACCESS-SW.
  2894             20  CF-PROC-CREDIT-CLAIMS-SW.
  2895                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2896                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2897                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2898                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2899             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2900                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2901                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2902             20  CF-PROC-LIFE-GNRLDGR-SW.
  2903                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2904                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2905                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2906                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2907             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2908                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2909                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2910         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2911             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2912             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2913         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2914
  2915         16  CF-APPROVAL-LEVEL                  PIC X.
  2916             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2917             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2918             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2919             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL652.cbl
  2920
  2921         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2922
  2923         16  CF-LANGUAGE-TYPE                   PIC X.
  2924             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2925             88  CF-LANG-IS-FR                      VALUE 'F'.
  2926         16  FILLER                             PIC  X(240).
  2927
  2928****************************************************************
  2929*             PROCESSOR/REMINDERS RECORD                       *
  2930****************************************************************
  2931
  2932     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2933         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2934             20  CF-START-REMIND-DT         PIC XX.
  2935             20  CF-END-REMIND-DT           PIC XX.
  2936             20  CF-REMINDER-TEXT           PIC X(50).
  2937         16  FILLER                         PIC X(296).
  2938
  2939
  2940****************************************************************
  2941*             STATE MASTER RECORD                              *
  2942****************************************************************
  2943
  2944     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2945         16  CF-STATE-ABBREVIATION          PIC XX.
  2946         16  CF-STATE-NAME                  PIC X(25).
  2947         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2948         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2949             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2950             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2951             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2952             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2953                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2954                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2955             20  CF-ST-PREM-REJECT-SW       PIC X.
  2956                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2957                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2958             20  CF-ST-REF-REJECT-SW        PIC X.
  2959                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2960                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2961         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2962         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2963         16  CF-ST-REFUND-RULES.
  2964             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2965             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2966             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2967         16  CF-ST-FST-PMT-EXTENSION.
  2968             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2969             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2970                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2971                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2972                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2973                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2974         16  CF-ST-STATE-CALL.
  2975             20  CF-ST-CALL-UNEARNED        PIC X.
  2976             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2977             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL652.cbl
  2978         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2979             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2980             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2981         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2982         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2983         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2984         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2985         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2986         16  FILLER                         PIC X.
  2987         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2988             20  CF-ST-BENEFIT-CD           PIC XX.
  2989             20  CF-ST-BENEFIT-KIND         PIC X.
  2990                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2991                 88  CF-ST-AH-KIND              VALUE 'A'.
  2992             20  CF-ST-REM-TERM-CALC        PIC X.
  2993                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2994                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2995                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2996                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2997                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2998                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2999                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3000                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3001
  3002             20  CF-ST-REFUND-CALC          PIC X.
  3003                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3004                 88  ST-REFD-BY-R78             VALUE '1'.
  3005                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3006                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3007                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3008                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3009                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3010                 88  ST-REFD-UTAH               VALUE '7'.
  3011                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3012                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3013                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3014
  3015             20  CF-ST-EARNING-CALC         PIC X.
  3016                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3017                 88  ST-EARN-BY-R78             VALUE '1'.
  3018                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3019                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3020                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3021                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3022                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3023                 88  ST-EARN-MEAN               VALUE '8'.
  3024                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3025
  3026             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3027                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3028                 88  ST-OVRD-BY-R78             VALUE '1'.
  3029                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3030                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3031                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3032                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3033                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3034                 88  ST-OVRD-MEAN               VALUE '8'.
  3035                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL652.cbl
  3036             20  FILLER                     PIC X.
  3037
  3038         16  CF-ST-COMMISSION-CAPS.
  3039             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3040             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3041             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3042             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3043         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3044                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3045
  3046         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3047
  3048         16  CF-ST-STATUTORY-INTEREST.
  3049             20  CF-ST-STAT-DATE-FROM       PIC X.
  3050                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3051                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3052             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3053             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3054             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3055             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3056             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3057
  3058         16  CF-ST-OVER-SHORT.
  3059             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3060             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3061
  3062         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3063
  3064         16  CF-ST-RT-CALC                  PIC X.
  3065
  3066         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3067         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3068         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3069         16  CF-ST-RF-LR-CALC               PIC X.
  3070         16  CF-ST-RF-LL-CALC               PIC X.
  3071         16  CF-ST-RF-LN-CALC               PIC X.
  3072         16  CF-ST-RF-AH-CALC               PIC X.
  3073         16  CF-ST-RF-CP-CALC               PIC X.
  3074*        16  FILLER                         PIC X(206).
  3075*CIDMOD         16  FILLER                         PIC X(192).
  3076         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3077             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3078         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3079         16  CF-ST-VFY-2ND-BENE             PIC X.
  3080         16  FILLER                         PIC X(186).
  3081
  3082****************************************************************
  3083*             BENEFIT MASTER RECORD                            *
  3084****************************************************************
  3085
  3086     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3087         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3088             20  CF-BENEFIT-CODE            PIC XX.
  3089             20  CF-BENEFIT-NUMERIC  REDEFINES
  3090                 CF-BENEFIT-CODE            PIC XX.
  3091             20  CF-BENEFIT-ALPHA           PIC XXX.
  3092             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3093             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL652.cbl
  3094
  3095             20  CF-LF-COVERAGE-TYPE        PIC X.
  3096                 88  CF-REDUCING                VALUE 'R'.
  3097                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3098
  3099             20  CF-SPECIAL-CALC-CD         PIC X.
  3100                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3101                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3102                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3103                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3104                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3105                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3106                 88  CF-FARM-PLAN               VALUE 'F'.
  3107                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3108                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3109                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3110                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3111                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3112                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3113                 88  CF-PRUDENTIAL              VALUE 'P'.
  3114                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3115                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3116                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3117                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3118                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3119                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3120
  3121             20  CF-JOINT-INDICATOR         PIC X.
  3122                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3123
  3124*            20  FILLER                     PIC X(12).
  3125             20  FILLER                     PIC X(11).
  3126             20  CF-BENEFIT-CATEGORY        PIC X.
  3127             20  CF-LOAN-TYPE               PIC X(8).
  3128
  3129             20  CF-CO-REM-TERM-CALC        PIC X.
  3130                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3131                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3132                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3133                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3134                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3135
  3136             20  CF-CO-EARNINGS-CALC        PIC X.
  3137                 88  CO-EARN-BY-R78             VALUE '1'.
  3138                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3139                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3140                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3141                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3142                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3143                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3144                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3145
  3146             20  CF-CO-REFUND-CALC          PIC X.
  3147                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3148                 88  CO-REFD-BY-R78             VALUE '1'.
  3149                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3150                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3151                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL652.cbl
  3152                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3153                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3154                 88  CO-REFD-MEAN               VALUE '8'.
  3155                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3156                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3157                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3158
  3159             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3160                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3161                 88  CO-OVRD-BY-R78             VALUE '1'.
  3162                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3163                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3164                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3165                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3166                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3167                 88  CO-OVRD-MEAN               VALUE '8'.
  3168                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3169
  3170             20  CF-CO-BEN-I-G-CD           PIC X.
  3171                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3172                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3173                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3174
  3175         16  FILLER                         PIC X(304).
  3176
  3177
  3178****************************************************************
  3179*             CARRIER MASTER RECORD                            *
  3180****************************************************************
  3181
  3182     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3183         16  CF-ADDRESS-DATA.
  3184             20  CF-MAIL-TO-NAME            PIC X(30).
  3185             20  CF-IN-CARE-OF              PIC X(30).
  3186             20  CF-ADDRESS-LINE-1          PIC X(30).
  3187             20  CF-ADDRESS-LINE-2          PIC X(30).
  3188             20  CF-CITY-STATE              PIC X(30).
  3189             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3190             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3191
  3192         16  CF-CLAIM-NO-CONTROL.
  3193             20  CF-CLAIM-NO-METHOD         PIC X.
  3194                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3195                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3196                 88  CLAIM-NO-SEQ               VALUE '3'.
  3197                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3198             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3199                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3200                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3201                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3202
  3203         16  CF-CHECK-NO-CONTROL.
  3204             20  CF-CHECK-NO-METHOD         PIC X.
  3205                 88  CHECK-NO-MANUAL            VALUE '1'.
  3206                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3207                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3208                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3209             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL652.cbl
  3210                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3211
  3212         16  CF-DOMICILE-STATE              PIC XX.
  3213
  3214         16  CF-EXPENSE-CONTROLS.
  3215             20  CF-EXPENSE-METHOD          PIC X.
  3216                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3217                 88  DOLLARS-PER-PMT            VALUE '2'.
  3218                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3219                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3220             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3221             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3222
  3223         16  CF-CORRESPONDENCE-CONTROL.
  3224             20  CF-LETTER-RESEND-OPT       PIC X.
  3225                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3226                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3227             20  FILLER                     PIC X(4).
  3228
  3229         16  CF-RESERVE-CONTROLS.
  3230             20  CF-MANUAL-SW               PIC X.
  3231                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3232             20  CF-FUTURE-SW               PIC X.
  3233                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3234             20  CF-PTC-SW                  PIC X.
  3235                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3236             20  CF-IBNR-SW                 PIC X.
  3237                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3238             20  CF-PTC-LF-SW               PIC X.
  3239                 88  CF-LF-PTC-USED             VALUE '1'.
  3240             20  CF-CDT-ACCESS-METHOD       PIC X.
  3241                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3242                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3243                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3244             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3245
  3246         16  CF-CLAIM-CALC-METHOD           PIC X.
  3247             88  360-PLUS-MONTHS                VALUE '1'.
  3248             88  365-PLUS-MONTHS                VALUE '2'.
  3249             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3250             88  360-DAILY                      VALUE '4'.
  3251             88  365-DAILY                      VALUE '5'.
  3252
  3253         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3254         16  FILLER                         PIC X(11).
  3255
  3256         16  CF-LIMIT-AMOUNTS.
  3257             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3258             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3259             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3260             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3261             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3262             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3263             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3264             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3265             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3266             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3267
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL652.cbl
  3268         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3269         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3270         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3271
  3272         16  CF-ZIP-CODE.
  3273             20  CF-ZIP-PRIME.
  3274                 24  CF-ZIP-1ST             PIC X.
  3275                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3276                 24  FILLER                 PIC X(4).
  3277             20  CF-ZIP-PLUS4               PIC X(4).
  3278         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3279             20  CF-CAN-POSTAL-1            PIC XXX.
  3280             20  CF-CAN-POSTAL-2            PIC XXX.
  3281             20  FILLER                     PIC XXX.
  3282
  3283         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3284         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3285         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3286
  3287         16  CF-RATING-SWITCH               PIC X.
  3288             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3289             88  CF-NO-RATING                   VALUE 'N'.
  3290
  3291         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3292
  3293         16  CF-CARRIER-OVER-SHORT.
  3294             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3295             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3296
  3297         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3298         16  CF-SECPAY-SWITCH               PIC X.
  3299             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3300             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3301         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3302         16  FILLER                         PIC X(448).
  3303*        16  FILLER                         PIC X(452).
  3304
  3305
  3306****************************************************************
  3307*             MORTALITY MASTER RECORD                          *
  3308****************************************************************
  3309
  3310     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3311         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3312                                INDEXED BY CF-MORT-NDX.
  3313             20  CF-MORT-TABLE              PIC X(5).
  3314             20  CF-MORT-TABLE-TYPE         PIC X.
  3315                 88  CF-MORT-JOINT              VALUE 'J'.
  3316                 88  CF-MORT-SINGLE             VALUE 'S'.
  3317                 88  CF-MORT-COMBINED           VALUE 'C'.
  3318                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3319                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3320             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3321             20  CF-MORT-AGE-METHOD         PIC XX.
  3322                 88  CF-AGE-LAST                VALUE 'AL'.
  3323                 88  CF-AGE-NEAR                VALUE 'AN'.
  3324             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3325             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL652.cbl
  3326                                            PIC X.
  3327                 88  CF-MINUS                   VALUE '-'.
  3328                 88  CF-PLUS                    VALUE '+'.
  3329             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3330             20  CF-MORT-JOINT-CODE         PIC X.
  3331                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3332             20  CF-MORT-PC-Q               PIC X.
  3333                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3334             20  CF-MORT-TABLE-CODE         PIC X(4).
  3335             20  CF-MORT-COMMENTS           PIC X(15).
  3336             20  FILLER                     PIC X(14).
  3337
  3338         16  FILLER                         PIC X(251).
  3339
  3340
  3341****************************************************************
  3342*             BUSSINESS TYPE MASTER RECORD                     *
  3343****************************************************************
  3344
  3345     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3346* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3347* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3348* AND RECORD 05 IS TYPES 81-99
  3349         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3350             20  CF-BUSINESS-TITLE          PIC  X(19).
  3351             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3352                                            PIC S9V9(4) COMP-3.
  3353             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3354             20  FILLER                     PIC  X.
  3355         16  FILLER                         PIC  X(248).
  3356
  3357
  3358****************************************************************
  3359*             TERMINAL MASTER RECORD                           *
  3360****************************************************************
  3361
  3362     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3363
  3364         16  CF-COMPANY-TERMINALS.
  3365             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3366                                  PIC X(4).
  3367         16  FILLER               PIC X(248).
  3368
  3369
  3370****************************************************************
  3371*             LIFE EDIT MASTER RECORD                          *
  3372****************************************************************
  3373
  3374     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3375         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3376             20  CF-LIFE-CODE-IN            PIC XX.
  3377             20  CF-LIFE-CODE-OUT           PIC XX.
  3378         16  FILLER                         PIC X(248).
  3379
  3380
  3381****************************************************************
  3382*             AH EDIT MASTER RECORD                            *
  3383****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL652.cbl
  3384
  3385     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3386         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3387             20  CF-AH-CODE-IN              PIC XXX.
  3388             20  CF-AH-CODE-OUT             PIC XX.
  3389         16  FILLER                         PIC X(248).
  3390
  3391
  3392****************************************************************
  3393*             CREDIBILITY TABLES                               *
  3394****************************************************************
  3395
  3396     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3397         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3398                             INDEXED BY CF-CRDB-NDX.
  3399             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3400             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3401             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3402         16  FILLER                         PIC  X(332).
  3403
  3404
  3405****************************************************************
  3406*             REPORT CUSTOMIZATION RECORD                      *
  3407****************************************************************
  3408
  3409     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3410         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3411             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3412             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3413             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3414**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3415****       A T-TRANSFER.                                   ****
  3416             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3417
  3418         16  FILLER                         PIC XX.
  3419
  3420         16  CF-CARRIER-CNTL-OPT.
  3421             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3422                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3423                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3424             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3425                                            PIC X.
  3426         16  CF-GROUP-CNTL-OPT.
  3427             20  CF-GROUP-OPT-SEQ           PIC 9.
  3428                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3429                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3430             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3431                                            PIC X(6).
  3432         16  CF-STATE-CNTL-OPT.
  3433             20  CF-STATE-OPT-SEQ           PIC 9.
  3434                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3435                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3436             20  CF-STATE-SELECT OCCURS 3 TIMES
  3437                                            PIC XX.
  3438         16  CF-ACCOUNT-CNTL-OPT.
  3439             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3440                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3441                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL652.cbl
  3442             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3443                                            PIC X(10).
  3444         16  CF-BUS-TYP-CNTL-OPT.
  3445             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3446                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3447                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3448             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3449                                            PIC XX.
  3450         16  CF-LF-TYP-CNTL-OPT.
  3451             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3452                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3453                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3454             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3455                                            PIC XX.
  3456         16  CF-AH-TYP-CNTL-OPT.
  3457             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3458                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3459                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3460             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3461                                            PIC XX.
  3462         16  CF-REPTCD1-CNTL-OPT.
  3463             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3464                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3465                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3466             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3467                                            PIC X(10).
  3468         16  CF-REPTCD2-CNTL-OPT.
  3469             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3470                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3471                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3472             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3473                                            PIC X(10).
  3474         16  CF-USER1-CNTL-OPT.
  3475             20  CF-USER1-OPT-SEQ           PIC 9.
  3476                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3477                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3478             20  CF-USER1-SELECT OCCURS 3 TIMES
  3479                                            PIC X(10).
  3480         16  CF-USER2-CNTL-OPT.
  3481             20  CF-USER2-OPT-SEQ           PIC 9.
  3482                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3483                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3484             20  CF-USER2-SELECT OCCURS 3 TIMES
  3485                                            PIC X(10).
  3486         16  CF-USER3-CNTL-OPT.
  3487             20  CF-USER3-OPT-SEQ           PIC 9.
  3488                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3489                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3490             20  CF-USER3-SELECT OCCURS 3 TIMES
  3491                                            PIC X(10).
  3492         16  CF-USER4-CNTL-OPT.
  3493             20  CF-USER4-OPT-SEQ           PIC 9.
  3494                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3495                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3496             20  CF-USER4-SELECT OCCURS 3 TIMES
  3497                                            PIC X(10).
  3498         16  CF-USER5-CNTL-OPT.
  3499             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL652.cbl
  3500                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3501                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3502             20  CF-USER5-SELECT OCCURS 3 TIMES
  3503                                            PIC X(10).
  3504         16  CF-REINS-CNTL-OPT.
  3505             20  CF-REINS-OPT-SEQ           PIC 9.
  3506                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3507                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3508             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3509                 24  CF-REINS-PRIME         PIC XXX.
  3510                 24  CF-REINS-SUB           PIC XXX.
  3511
  3512         16  CF-AGENT-CNTL-OPT.
  3513             20  CF-AGENT-OPT-SEQ           PIC 9.
  3514                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3515                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3516             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3517                                            PIC X(10).
  3518
  3519         16  FILLER                         PIC X(43).
  3520
  3521         16  CF-LOSS-RATIO-SELECT.
  3522             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3523             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3524         16  CF-ENTRY-DATE-SELECT.
  3525             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3526             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3527         16  CF-EFFECTIVE-DATE-SELECT.
  3528             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3529             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3530
  3531         16  CF-EXCEPTION-LIST-IND          PIC X.
  3532             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3533
  3534         16  FILLER                         PIC X(318).
  3535
  3536****************************************************************
  3537*                  EXCEPTION REPORTING RECORD                  *
  3538****************************************************************
  3539
  3540     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3541         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3542             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3543
  3544         16  CF-COMBINED-LIFE-AH-OPT.
  3545             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3546             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3547             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3548             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3549
  3550         16  CF-LIFE-OPT.
  3551             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3552             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3553             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3554             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3555             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3556             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3557             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL652.cbl
  3558             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3559             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3560             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3561
  3562         16  CF-AH-OPT.
  3563             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3564             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3565             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3566             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3567             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3568             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3569             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3570             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3571             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3572             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3573
  3574         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3575             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3576             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3577             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3578
  3579         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3580
  3581         16  FILLER                         PIC X(673).
  3582
  3583
  3584****************************************************************
  3585*             MORTGAGE SYSTEM PLAN RECORD                      *
  3586****************************************************************
  3587
  3588     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3589         16  CF-PLAN-TYPE                   PIC X.
  3590             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3591             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3592             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3593         16  CF-PLAN-ABBREV                 PIC XXX.
  3594         16  CF-PLAN-DESCRIPT               PIC X(10).
  3595         16  CF-PLAN-NOTES                  PIC X(20).
  3596         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3597         16  CF-PLAN-UNDERWRITING.
  3598             20  CF-PLAN-TERM-DATA.
  3599                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3600                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3601             20  CF-PLAN-AGE-DATA.
  3602                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3603                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3604                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3605             20  CF-PLAN-BENEFIT-DATA.
  3606                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3607                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3608                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3609                                            PIC S9(7)V99  COMP-3.
  3610         16  CF-PLAN-POLICY-FORMS.
  3611             20  CF-POLICY-FORM             PIC X(12).
  3612             20  CF-MASTER-APPLICATION      PIC X(12).
  3613             20  CF-MASTER-POLICY           PIC X(12).
  3614         16  CF-PLAN-RATING.
  3615             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL652.cbl
  3616             20  CF-SEX-RATING              PIC X.
  3617                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3618                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3619             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3620             20  CF-SUB-STD-TYPE            PIC X.
  3621                 88  CF-PCT-OF-PREM            VALUE '1'.
  3622                 88  CF-PCT-OF-BENE            VALUE '2'.
  3623         16  CF-PLAN-PREM-TOLERANCES.
  3624             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3625             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3626         16  CF-PLAN-PYMT-TOLERANCES.
  3627             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3628             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3629         16  CF-PLAN-MISC-DATA.
  3630             20  FILLER                     PIC X.
  3631             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3632             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3633         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3634         16  CF-PLAN-IND-GRP                PIC X.
  3635             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3636                                                     '1'.
  3637             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3638                                                     '2'.
  3639         16  CF-MIB-SEARCH-SW               PIC X.
  3640             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3641             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3642             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3643             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3644         16  CF-ALPHA-SEARCH-SW             PIC X.
  3645             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3646             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3647             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3648             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3649             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3650             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3651             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3652             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3653             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3654             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3655                                                     'A' 'B' 'C'
  3656                                                     'X' 'Y' 'Z'.
  3657         16  CF-EFF-DT-RULE-SW              PIC X.
  3658             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3659             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3660             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3661             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3662             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3663         16  FILLER                         PIC X(4).
  3664         16  CF-HEALTH-QUESTIONS            PIC X.
  3665             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3666         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3667         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3668         16  CF-PLAN-SNGL-JNT               PIC X.
  3669             88  CF-COMBINED-PLAN              VALUE 'C'.
  3670             88  CF-JNT-PLAN                   VALUE 'J'.
  3671             88  CF-SNGL-PLAN                  VALUE 'S'.
  3672         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3673         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL652.cbl
  3674         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3675         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3676         16  CF-RERATE-CNTL                 PIC  X.
  3677             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3678             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3679             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3680             88  CF-AUTO-RECALC                 VALUE '4'.
  3681         16  CF-BENEFIT-TYPE                PIC  X.
  3682             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3683             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3684         16  CF-POLICY-FEE                  PIC S999V99
  3685                                                    COMP-3.
  3686         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3687         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3688         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3689         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3690         16  FILLER                         PIC  X(32).
  3691         16  CF-TERMINATION-FORM            PIC  X(04).
  3692         16  FILLER                         PIC  X(08).
  3693         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3694                                                       COMP-3.
  3695         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3696         16  CF-ISSUE-LETTER                PIC  X(4).
  3697         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3698         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3699             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3700             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3701         16  CF-MP-REFUND-CALC              PIC X.
  3702             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3703             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3704             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3705             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3706             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3707             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3708             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3709             88  CF-MP-REFD-MEAN                VALUE '8'.
  3710         16  CF-ALT-RATE-CODE               PIC  X(5).
  3711
  3712
  3713         16  FILLER                         PIC X(498).
  3714****************************************************************
  3715*             MORTGAGE COMPANY MASTER RECORD                   *
  3716****************************************************************
  3717
  3718     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3719         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3720         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3721             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3722             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3723             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3724             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3725             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3726
  3727         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3728         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3729         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3730         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3731         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL652.cbl
  3732
  3733         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3734             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3735         16  CF-MP-RECON-USE-IND            PIC X(1).
  3736             88  CF-MP-USE-RECON             VALUE 'Y'.
  3737         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3738             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3739         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3740             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3741             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3742         16  FILLER                         PIC X(1).
  3743         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3744             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3745         16  CF-MORTG-MIB-VERSION           PIC X.
  3746             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3747             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3748             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3749         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3750             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3751                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3752             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3753                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3754             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3755                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3756             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3757                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3758             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3759                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3760             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3761                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3762         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3763         16  FILLER                         PIC X(7).
  3764         16  CF-MORTG-DESTINATION-SYMBOL.
  3765             20  CF-MORTG-MIB-COMM          PIC X(5).
  3766             20  CF-MORTG-MIB-TERM          PIC X(5).
  3767         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3768             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3769         16  FILLER                         PIC X(03).
  3770         16  CF-MP-CHECK-NO-CONTROL.
  3771             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3772                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3773                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3774                                                ' ' LOW-VALUES.
  3775                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3776                                               VALUE '3'.
  3777         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3778         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3779         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3780             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3781                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3782             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3783                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3784             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3785                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3786             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3787                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3788             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3789                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL652.cbl
  3790             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3791                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3792         16  CF-MORTG-BILLING-AREA.
  3793             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3794                                            PIC X.
  3795         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3796         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3797         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3798         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3799             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3800             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3801         16  FILLER                         PIC X.
  3802         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3803             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3804             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3805         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3806         16  FILLER                         PIC X(8).
  3807         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3808         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3809         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3810         16  CF-ACH-COMPANY-ID.
  3811             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3812                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3813                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3814                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3815             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3816         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3817             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3818         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3819             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3820             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3821         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3822         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3823         16  FILLER                         PIC X(536).
  3824
  3825****************************************************************
  3826*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3827****************************************************************
  3828
  3829     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3830         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3831             20  CF-FEMALE-HEIGHT.
  3832                 24  CF-FEMALE-FT           PIC 99.
  3833                 24  CF-FEMALE-IN           PIC 99.
  3834             20  CF-FEMALE-MIN-WT           PIC 999.
  3835             20  CF-FEMALE-MAX-WT           PIC 999.
  3836         16  FILLER                         PIC X(428).
  3837
  3838     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3839         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3840             20  CF-MALE-HEIGHT.
  3841                 24  CF-MALE-FT             PIC 99.
  3842                 24  CF-MALE-IN             PIC 99.
  3843             20  CF-MALE-MIN-WT             PIC 999.
  3844             20  CF-MALE-MAX-WT             PIC 999.
  3845         16  FILLER                         PIC X(428).
  3846******************************************************************
  3847*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL652.cbl
  3848******************************************************************
  3849     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3850         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3851             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3852             20  CF-SYS-LETTER-ID           PIC X(04).
  3853             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3854             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3855             20  CF-SYS-RESET-SW            PIC X(01).
  3856             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3857             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3858
  3859         16  FILLER                         PIC X(50).
  3860
  3861         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3862             20  CF-USER-ACTIVE-SW          PIC X(01).
  3863             20  CF-USER-LETTER-ID          PIC X(04).
  3864             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3865             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3866             20  CF-USER-RESET-SW           PIC X(01).
  3867             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3868             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3869             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3870
  3871         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL652.cbl
  3873*                            COPY ERCSUMM.
  3874******************************************************************
  3875*                                                                *
  3876*                                                                *
  3877*                            ERCSUMM                             *
  3878*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3879*                            VMOD=2.002                          *
  3880*                                                                *
  3881*   ONLINE CREDIT SYSTEM                                         *
  3882*                                                                *
  3883*   FILE DESCRIPTION = AR SUMMARY CROSS REFERENCE                *
  3884*                                                                *
  3885*   FILE TYPE = VSAM,KSDS                                        *
  3886*   RECORD SIZE = 150           RECFORM = FIXED                  *
  3887*                                                                *
  3888*   BASE CLUSTER NAME = ERSUMM                   RKP=2,LEN=34    *
  3889*                                                                *
  3890*       ALTERNATE PATH1 = ERSUMM2  (BY CO SUMMARY CARR           *
  3891*                                      GROUP F.R. AGENT)         *
  3892*                                                 RKP=36 ,LEN=34 *
  3893*                                                                *
  3894*   LOG = NO                                                     *
  3895*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3896*                                                                *
  3897******************************************************************
  3898
  3899 01  SUMM-CROSS-REFERENCE.
  3900     12  SX-RECORD-ID                PIC XX.
  3901         88  VALID-SX-ID             VALUE 'SX'.
  3902
  3903     12  SX-CONTROL-PRIMARY.
  3904         16  SX-COMPANY-CD           PIC X.
  3905         16  SX-SUMMARY              PIC X(6).
  3906         16  SX-CARRIER              PIC X.
  3907         16  SX-GROUP                PIC X(6).
  3908         16  SX-FIN-RESP             PIC X(10).
  3909         16  SX-ACCT-AGENT           PIC X(10).
  3910
  3911     12  SX-CONTROL-A1.
  3912         16  SX-COMPANY-A1           PIC X.
  3913         16  SX-ACCT-AGENT-A1        PIC X(10).
  3914         16  SX-SUMMARY-A1           PIC X(6).
  3915         16  SX-CARR-A1              PIC X.
  3916         16  SX-GROUP-A1             PIC X(6).
  3917         16  SX-FIN-RESP-A1          PIC X(10).
  3918
  3919     12  SX-MAINT-INFORMATION.
  3920         16  SX-LAST-MAINT-DT        PIC XX.
  3921         16  SX-LAST-MAINT-BY        PIC X(4).
  3922         16  SX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  3923
  3924     12  SX-SUMM-OR-AGT-NAME         PIC X(30).
  3925
  3926     12  FILLER                      PIC X(40).
  3927
  3928******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL652.cbl
  3930*                            COPY ERCRQST.
  3931******************************************************************
  3932*                                                                *
  3933*                                                                *
  3934*                            ERCRQST.                            *
  3935*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3936*                            VMOD=2.002                          *
  3937*                                                                *
  3938*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  3939*                                                                *
  3940*   FILE TYPE = VSAM,KSDS                                        *
  3941*   RECORD SIZE = 200  RECFORM = FIXED                           *
  3942*                                                                *
  3943*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  3944*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  3945*                                   ACCOUNT, REF, BATCH)         *
  3946*                                                RKP=9, LEN=38   *
  3947*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  3948*                                   ACCOUNT, REF, BATCH)         *
  3949*                                                RKP=47, LEN=46  *
  3950*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  3951*                                   BATCH)                       *
  3952*                                                RKP=93, LEN=24  *
  3953*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  3954*                                   REF, BATCH)                  *
  3955*                                                RKP=117, LEN=35 *
  3956*   LOG = NO                                                     *
  3957*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3958******************************************************************
  3959
  3960 01  AR-REQUEST-RECORD.
  3961     12  RQ-RECORD-ID                     PIC XX.
  3962         88  VALID-RQ-ID                        VALUE 'RQ'.
  3963
  3964     12  RQ-CONTROL-PRIMARY.
  3965         16  RQ-COMPANY-CD                PIC X.
  3966         16  RQ-ENTRY-BATCH               PIC X(6).
  3967
  3968     12  RQ-CONTROL-BY-ACCT-REF.
  3969         16  RQ-COMPANY-CD-A1             PIC X.
  3970         16  RQ-CARRIER-A1                PIC X.
  3971         16  RQ-GROUPING-A1               PIC X(6).
  3972         16  RQ-STATE-A1                  PIC XX.
  3973         16  RQ-ACCOUNT-A1                PIC X(10).
  3974         16  RQ-REFERENCE-A1              PIC X(12).
  3975         16  RQ-BATCH-A1                  PIC X(6).
  3976
  3977     12  RQ-CONTROL-BY-FIN-RESP.
  3978         16  RQ-COMPANY-CD-A2             PIC X.
  3979         16  RQ-CARRIER-A2                PIC X.
  3980         16  RQ-GROUPING-A2               PIC X(6).
  3981         16  RQ-FIN-RESP-A2               PIC X(10).
  3982         16  RQ-ACCT-AGENT-A2             PIC X(10).
  3983         16  RQ-REFERENCE-A2              PIC X(12).
  3984         16  RQ-BATCH-A2                  PIC X(6).
  3985
  3986     12  RQ-CONTROL-BY-ACCT-AGENT.
  3987         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL652.cbl
  3988         16  RQ-CARRIER-A3                PIC X.
  3989         16  RQ-GROUPING-A3               PIC X(6).
  3990         16  RQ-ACCT-AGENT-A3             PIC X(10).
  3991         16  RQ-BATCH-A3                  PIC X(6).
  3992
  3993     12  RQ-CONTROL-BY-SUMMARY.
  3994         16  RQ-COMPANY-CD-A4             PIC X.
  3995         16  RQ-SUMMARY-CODE              PIC X(6).
  3996         16  RQ-ACCOUNT-A4                PIC X(10).
  3997         16  RQ-REFERENCE-A4              PIC X(12).
  3998         16  RQ-BATCH-A4                  PIC X(6).
  3999
  4000     12  RQ-REQUEST-METHOD                PIC X.
  4001         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  4002         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  4003         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  4004         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  4005     12  FILLER                           PIC X.
  4006     12  RQ-STATUS                        PIC X.
  4007         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  4008         88  RQ-RESUBMIT                      VALUE 'R'.
  4009     12  RQ-PROCESSOR-ID                  PIC X(4).
  4010     12  RQ-ENTRY-DT                      PIC XX.
  4011     12  RQ-MO-END-DT                     PIC XX.
  4012     12  RQ-REQUEST-DT                    PIC XX.
  4013     12  RQ-STMT-DT                       PIC XX.
  4014     12  RQ-REVERSAL-DT                   PIC XX.
  4015     12  RQ-CREDIT-SELECT-DT              PIC XX.
  4016     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  4017
  4018     12  FILLER                           PIC X(27).
  4019
  4020******************************************************************
  4021
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL652.cbl
  4023 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  4024                          COMPENSATION-MASTER AGENT-COMMISSIONS
  4025                          NAME-LOOKUP-MASTER CONTROL-FILE
  4026                          SUMM-CROSS-REFERENCE
  4027                          AR-REQUEST-RECORD.
  4028 0000-DFHEXIT SECTION.
  4029     MOVE '9#                    $   ' TO DFHEIV0.
  4030     MOVE 'EL652' TO DFHEIV1.
  4031     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4032
  4033     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4034     MOVE '5'                    TO  DC-OPTION-CODE.
  4035     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  4036     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4037     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4038
  4039     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4040     MOVE EIBTRMID               TO  QID-TERM.
  4041
  4042 1000-START.
  4043     IF EIBCALEN = ZERO
  4044         GO TO 8800-UNAUTHORIZED-ACCESS.
  4045
  4046     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4047         MOVE PI-CALLING-PROGRAM        TO  RETURNED-FROM.
  4048
  4049     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  4050         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  4051             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4052             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  4053             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  4054             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  4055             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  4056             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  4057             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  4058             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  4059             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  4060         ELSE
  4061             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  4062             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  4063             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  4064             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  4065             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  4066             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  4067             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  4068             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  4069
  4070     IF  RETURNED-FROM = XCTL-633
  4071             OR
  4072         RETURNED-FROM = XCTL-633DMD
  4073             OR
  4074         RETURNED-FROM = XCTL-635
  4075             OR
  4076         RETURNED-FROM = XCTL-6521
  4077             OR
  4078         RETURNED-FROM = XCTL-6522
  4079             OR
  4080         RETURNED-FROM = XCTL-6523
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL652.cbl
  4081             OR
  4082         RETURNED-FROM = XCTL-6524
  4083             OR
  4084         RETURNED-FROM = XCTL-689
  4085             OR
  4086         RETURNED-FROM = XCTL-690
  4087             OR
  4088         RETURNED-FROM = XCTL-650
  4089         GO TO 3475-RECOVER-TEMP-STOR-PI.
  4090
  4091
  4092* EXEC CICS HANDLE CONDITION
  4093*        NOTOPEN   (9990-ABEND)
  4094*        NOTFND    (8880-NOT-FOUND)
  4095*        PGMIDERR  (9600-PGMID-ERROR)
  4096*        ERROR     (9990-ABEND)
  4097*    END-EXEC.
  4098*    MOVE '"$JIL.                ! " #00004087' TO DFHEIV0
  4099     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  4100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4101     MOVE X'2220233030303034303837' TO DFHEIV0(25:11)
  4102     CALL 'kxdfhei1' USING DFHEIV0
  4103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4104
  4105
  4106     IF  EIBTRNID NOT = TRANS-ID
  4107         MOVE LOW-VALUES         TO  EL652AI
  4108         IF  EIBTRNID = EM6508-TRANS-ID
  4109             MOVE DFHENTER       TO  EIBAID
  4110             MOVE 'S'            TO  MAINTYPI
  4111             MOVE PI-CARRIER     TO  CARRIERI
  4112             MOVE PI-GROUPING    TO  GROUPI
  4113             MOVE 'A'            TO  TYPEI
  4114             MOVE PI-CR-FIN-RESP TO  FINRESPI
  4115             MOVE PI-CR-ACCOUNT  TO  ACCTNOI
  4116             MOVE 1              TO  CARRIERL TYPEL MAINTYPL
  4117             MOVE 6              TO  GROUPL
  4118             MOVE 10             TO  FINRESPL  ACCTNOL
  4119             GO TO 4000-EDIT-MAINT
  4120         ELSE
  4121             IF  (EIBTRNID NOT = EL640-TRANS-ID AND
  4122                                 EL633-TRANS-ID AND
  4123                                 EL633DMD-TRANS-ID AND
  4124                                 EL635-TRANS-ID AND
  4125                                 EL642-TRANS-ID AND
  4126                                 EL6501-TRANS-ID AND
  4127                                 EL6592-TRANS-ID AND
  4128                                 EL856-TRANS-ID)
  4129                 OR PI-CR-FIN-RESP = SPACES
  4130                 GO TO 8100-SEND-INITIAL-MAP
  4131             ELSE
  4132                 MOVE DFHENTER   TO  EIBAID
  4133                 MOVE 'S'        TO  MAINTYPI
  4134                 MOVE PI-CR-CARRIER  TO  CARRIERI
  4135                 MOVE PI-CR-GROUPING TO  GROUPI
  4136                 MOVE PI-CR-TYPE     TO  TYPEI
  4137                 MOVE PI-CR-FIN-RESP TO  FINRESPI
  4138                 MOVE PI-CR-ACCOUNT  TO  ACCTNOI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL652.cbl
  4139                 MOVE 1              TO  CARRIERL
  4140                                         TYPEL
  4141                                         MAINTYPL
  4142                 MOVE 6              TO  GROUPL
  4143                 MOVE 10             TO  FINRESPL
  4144                                         ACCTNOL
  4145                 GO TO 4000-EDIT-MAINT.
  4146
  4147     IF  EIBAID = DFHCLEAR
  4148             OR
  4149         NOT DISPLAY-CAP
  4150         GO TO 9400-CLEAR.
  4151
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL652.cbl
  4153 2000-RECEIVE.
  4154     MOVE LOW-VALUES             TO  EL652AI.
  4155
  4156     IF EIBAID = DFHPA1 OR  DFHPA2  OR  DFHPA3
  4157         MOVE ER-0008            TO  EMI-ERROR
  4158         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4159         MOVE -1                 TO  MAINTYPL
  4160         GO TO 8200-SEND-DATAONLY.
  4161
  4162
  4163* EXEC CICS RECEIVE
  4164*        MAP     (MAP-NAME)
  4165*        MAPSET  (MAPSET-NAME)
  4166*        INTO    (EL652AI)
  4167*    END-EXEC.
  4168     MOVE LENGTH OF
  4169      EL652AI
  4170       TO DFHEIV11
  4171*    MOVE '8"T I  L              ''   #00004150' TO DFHEIV0
  4172     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4173     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4174     MOVE X'2020233030303034313530' TO DFHEIV0(25:11)
  4175     CALL 'kxdfhei1' USING DFHEIV0,
  4176           MAP-NAME,
  4177           EL652AI,
  4178           DFHEIV11,
  4179           MAPSET-NAME,
  4180           DFHEIV99,
  4181           DFHEIV99
  4182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4183
  4184
  4185     IF PFKEYL = ZERO
  4186         GO TO 3000-CHECK-PFKEYS.
  4187
  4188     IF EIBAID NOT = DFHENTER
  4189         MOVE ER-0004            TO EMI-ERROR
  4190         GO TO 3100-INPUT-ERROR.
  4191
  4192     IF (PFKEYI NUMERIC) AND (PFKEYI > 0 AND < 25)
  4193         MOVE PF-VALUES (PFKEYI)  TO  EIBAID
  4194     ELSE
  4195         MOVE ER-0029             TO  EMI-ERROR
  4196         GO TO 3100-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL652.cbl
  4198 3000-CHECK-PFKEYS.
  4199     IF EIBAID = DFHPF23
  4200         GO TO 8810-PF23.
  4201
  4202     IF EIBAID = DFHPF24
  4203         GO TO 9200-RETURN-MAIN-MENU.
  4204
  4205     IF EIBAID = DFHPF12
  4206         GO TO 9500-PF12.
  4207
  4208     if (maintypl not = zeros)
  4209        and (maintypi not = 'D')
  4210        move spaces              to pi-el652-del-sw
  4211     end-if
  4212     IF EIBAID = DFHPF1
  4213         IF PI-CHECK-MAINT-TYPE = 'C' OR 'D'
  4214             MOVE 'S'            TO  MAINTYPO
  4215             MOVE AL-UANON       TO  MAINTYPA
  4216             MOVE 1              TO  MAINTYPL
  4217             GO TO 7250-PAGE-FORWARD
  4218         ELSE
  4219             GO TO 7250-PAGE-FORWARD.
  4220
  4221     IF EIBAID = DFHPF2
  4222         IF PI-CHECK-MAINT-TYPE = 'C' OR 'D'
  4223             MOVE 'S'            TO  MAINTYPO
  4224             MOVE AL-UANON       TO  MAINTYPA
  4225             MOVE 1              TO  MAINTYPL
  4226             GO TO 7300-PAGE-BACKWARD
  4227         ELSE
  4228             GO TO 7300-PAGE-BACKWARD.
  4229
  4230     IF EIBAID = DFHPF3
  4231        IF PI-AR-PROCESSING
  4232            IF PI-ERCOMP-KEY  NOT =       SPACES
  4233                MOVE PI-ERC-CARRIER TO  PI-CR-CARRIER
  4234                MOVE PI-ERC-GROUP   TO  PI-CR-GROUPING
  4235                MOVE PI-ERC-RESP    TO  PI-CR-FIN-RESP
  4236                MOVE PI-ERC-ACCT    TO  PI-CR-ACCOUNT
  4237                MOVE PI-ERC-TYPE    TO  PI-CR-TYPE
  4238                IF PI-CR-ACCOUNT =  LOW-VALUES
  4239                   MOVE 'G'         TO  PI-CR-TYPE
  4240                                        PI-ERC-TYPE
  4241                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4242                   MOVE XCTL-635    TO PGM-NAME
  4243                   GO TO 9300-XCTL
  4244                ELSE
  4245                   MOVE 'A'         TO  PI-CR-TYPE
  4246                                        PI-ERC-TYPE
  4247                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4248                   MOVE XCTL-635    TO PGM-NAME
  4249                   GO TO 9300-XCTL
  4250            ELSE
  4251                MOVE ER-3021        TO  EMI-ERROR
  4252                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4253                GO TO 8100-SEND-INITIAL-MAP
  4254        ELSE
  4255            IF PI-ERCOMP-KEY NOT = SPACES AND LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL652.cbl
  4256                MOVE PI-ERC-CARRIER TO  PI-CR-CARRIER
  4257                MOVE PI-ERC-GROUP   TO  PI-CR-GROUPING
  4258                MOVE PI-ERC-RESP    TO  PI-CR-FIN-RESP
  4259                MOVE PI-ERC-ACCT    TO  PI-CR-ACCOUNT
  4260                MOVE PI-ERC-TYPE    TO  PI-CR-TYPE
  4261                IF PI-CR-ACCOUNT =  LOW-VALUES
  4262*                  MOVE 'G'         TO  PI-CR-TYPE
  4263*                                       PI-ERC-TYPE
  4264                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4265                   IF PI-COMPANY-ID = 'DMD'
  4266                      MOVE XCTL-633DMD TO PGM-NAME
  4267                      GO TO 9300-XCTL
  4268                   ELSE
  4269                      MOVE XCTL-633    TO PGM-NAME
  4270                      GO TO 9300-XCTL
  4271                ELSE
  4272                   MOVE 'A'         TO  PI-CR-TYPE
  4273                                        PI-ERC-TYPE
  4274                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4275                   IF PI-COMPANY-ID = 'DMD'
  4276                      MOVE XCTL-633DMD TO PGM-NAME
  4277                      GO TO 9300-XCTL
  4278                   ELSE
  4279                      MOVE XCTL-633    TO PGM-NAME
  4280                      GO TO 9300-XCTL
  4281            ELSE
  4282                MOVE ER-3021        TO  EMI-ERROR
  4283                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4284                GO TO 8100-SEND-INITIAL-MAP.
  4285
  4286     IF EIBAID = DFHPF4
  4287         IF PI-ERC-TYPE = 'G' OR 'A' OR 'B'
  4288             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4289             MOVE XCTL-6521      TO PGM-NAME
  4290             GO TO 9300-XCTL
  4291         ELSE
  4292             MOVE ER-2872        TO  EMI-ERROR
  4293             GO TO 3100-INPUT-ERROR.
  4294
  4295     IF  EIBAID = DFHPF5
  4296         MOVE XCTL-689           TO PGM-NAME
  4297         IF  PI-ERCOMP-KEY NOT = SPACES
  4298             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4299             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4300             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4301             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4302             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4303
  4304             IF  PI-CR-ACCOUNT =  LOW-VALUES
  4305*                MOVE 'G'        TO PI-CR-TYPE, PI-ERC-TYPE
  4306                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4307                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4308                 GO TO 9300-XCTL
  4309
  4310             ELSE
  4311                 MOVE 'A'        TO PI-CR-TYPE, PI-ERC-TYPE
  4312                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4313                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL652.cbl
  4314                 GO TO 9300-XCTL
  4315
  4316         ELSE
  4317             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4318             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  4319             GO TO 9300-XCTL.
  4320
  4321     IF  EIBAID = DFHPF6
  4322
  4323         MOVE XCTL-690           TO PGM-NAME
  4324
  4325         IF  PI-ERCOMP-KEY NOT = SPACES
  4326             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4327             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4328             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4329             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4330             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4331
  4332             IF  PI-CR-ACCOUNT =  LOW-VALUES
  4333*                MOVE 'G'        TO PI-CR-TYPE, PI-ERC-TYPE
  4334                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4335                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4336                 GO TO 9300-XCTL
  4337
  4338             ELSE
  4339                 MOVE 'A'        TO PI-CR-TYPE, PI-ERC-TYPE
  4340                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4341                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4342                 GO TO 9300-XCTL
  4343
  4344         ELSE
  4345             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4346             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  4347             GO TO 9300-XCTL.
  4348
  4349     IF EIBAID = DFHPF7
  4350         IF PI-ERC-TYPE = 'A'
  4351            MOVE PI-ERC-CARRIER  TO PI-CR-CARRIER
  4352            MOVE PI-ERC-GROUP    TO PI-CR-GROUPING
  4353            MOVE PI-ERC-ACCT     TO PI-CR-ACCOUNT
  4354*           PERFORM 3200-FIND-STATE
  4355*                                THRU 3200-EXIT
  4356            MOVE PI-SAVE-STATE   TO PI-CR-STATE
  4357            PERFORM 3400-CREATE-TS-PI
  4358                                 THRU 3400-EXIT
  4359            MOVE XCTL-650        TO PGM-NAME
  4360            GO TO 9300-XCTL
  4361         ELSE
  4362            MOVE ER-0035         TO EMI-ERROR
  4363            GO TO 3100-INPUT-ERROR
  4364         END-IF
  4365     END-IF.
  4366
  4367     IF EIBAID = DFHPF8
  4368         IF PI-ERCOMP-KEY NOT = SPACES
  4369             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4370             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4371             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL652.cbl
  4372             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4373             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4374             PERFORM 3400-CREATE-TS-PI  THRU 3400-EXIT
  4375             MOVE XCTL-6522             TO PGM-NAME
  4376             GO TO 9300-XCTL
  4377         ELSE
  4378            MOVE ER-0187                TO EMI-ERROR
  4379            GO TO 3100-INPUT-ERROR
  4380         END-IF
  4381     END-IF.
  4382
  4383*****************************************************************
  4384*  SPECIAL CODE - ENABLES DISPLAY OF PRIOR MONTH-END TOTALS*
  4385*  PF9 AVAILABLE TO A/R USERS                                   *
  4386*****************************************************************
  4387
  4388     IF PI-AR-PROCESSING OR PI-PROCESSOR-ID = 'LGXX'
  4389         IF EIBAID = DFHPF9
  4390             MOVE 'Y'            TO  WS-SHOW-SAVE-TOTALS
  4391             GO TO 4000-EDIT-MAINT.
  4392
  4393     IF EIBAID = DFHPF10
  4394        IF PI-ERC-TYPE = 'B'
  4395         IF PI-ERCOMP-KEY NOT = SPACES
  4396             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4397             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4398             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4399             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4400             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4401             PERFORM 3400-CREATE-TS-PI  THRU 3400-EXIT
  4402             MOVE XCTL-6523             TO PGM-NAME
  4403             GO TO 9300-XCTL
  4404         ELSE
  4405            MOVE ER-0187                TO EMI-ERROR
  4406            GO TO 3100-INPUT-ERROR
  4407         END-IF
  4408        ELSE
  4409           MOVE ER-0035          TO EMI-ERROR
  4410           GO TO 3100-INPUT-ERROR
  4411        END-IF
  4412     END-IF
  4413     IF EIBAID = DFHPF13
  4414        IF PI-ERC-TYPE = 'B'
  4415           IF PI-ERCOMP-KEY NOT = SPACES
  4416              MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4417              MOVE PI-ERC-GROUP  TO PI-CR-GROUPING
  4418              MOVE PI-ERC-RESP   TO PI-CR-FIN-RESP
  4419              MOVE PI-ERC-ACCT   TO PI-CR-ACCOUNT
  4420              MOVE PI-ERC-TYPE   TO PI-CR-TYPE
  4421              PERFORM 3400-CREATE-TS-PI
  4422                                 THRU 3400-EXIT
  4423              MOVE XCTL-6524     TO PGM-NAME
  4424              GO TO 9300-XCTL
  4425           ELSE
  4426              MOVE ER-0187       TO EMI-ERROR
  4427              GO TO 3100-INPUT-ERROR
  4428           END-IF
  4429        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL652.cbl
  4430           MOVE ER-0035          TO EMI-ERROR
  4431           GO TO 3100-INPUT-ERROR
  4432        END-IF
  4433     END-IF
  4434     IF EIBAID = DFHENTER
  4435         GO TO 4000-EDIT-MAINT.
  4436
  4437     MOVE ER-0029                TO  EMI-ERROR.
  4438
  4439 3100-INPUT-ERROR.
  4440     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4441
  4442     MOVE AL-UNBON               TO  PFKEYA.
  4443     MOVE -1                     TO  PFKEYL.
  4444
  4445     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL652.cbl
  4447 3200-FIND-STATE.
  4448
  4449     IF PI-SAVE-CITYST NOT = SPACES
  4450        MOVE PI-SAVE-CITYST       TO WS-SRCH-STATE
  4451     ELSE
  4452        IF PI-SAVE-ADDR2 NOT = SPACES
  4453           MOVE PI-SAVE-ADDR2     TO WS-SRCH-STATE
  4454        END-IF
  4455     END-IF
  4456
  4457     PERFORM VARYING STNDX FROM +29 BY -1 UNTIL
  4458          (STNDX < +1) OR
  4459          ((WS-SRCH-STATE (STNDX:2) ALPHABETIC) AND
  4460          (WS-SRCH-STATE (STNDX:2) NOT = SPACES AND LOW-VALUES)
  4461          AND
  4462          (WS-SRCH-STATE (STNDX + 1:1) NOT = ' ' AND ',' AND
  4463                   '.' AND LOW-VALUES) AND
  4464          (WS-SRCH-STATE (STNDX:1) NOT = ' ' AND ',' AND
  4465                   '.' AND LOW-VALUES))
  4466     END-PERFORM
  4467
  4468     IF STNDX NOT < +1
  4469        MOVE WS-SRCH-STATE (STNDX:2)
  4470                                 TO PI-SAVE-STATE
  4471     ELSE
  4472        MOVE SPACES              TO PI-SAVE-STATE
  4473     END-IF
  4474
  4475     .
  4476 3200-EXIT.
  4477     EXIT.
  4478 3400-CREATE-TS-PI.
  4479
  4480     PERFORM 3450-DELETE-TEMP-STOR-PI THRU 3450-EXIT.
  4481
  4482
  4483* EXEC CICS HANDLE CONDITION
  4484*        QIDERR  (3400-EXIT)
  4485*    END-EXEC.
  4486*    MOVE '"$N                   ! # #00004453' TO DFHEIV0
  4487     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4489     MOVE X'2320233030303034343533' TO DFHEIV0(25:11)
  4490     CALL 'kxdfhei1' USING DFHEIV0
  4491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4492
  4493
  4494
  4495* EXEC CICS WRITEQ TS
  4496*        QUEUE   (QID-PI)
  4497*        FROM    (PROGRAM-INTERFACE-BLOCK)
  4498*        LENGTH  (PI-COMM-LENGTH)
  4499*        ITEM    (QID-ITEM)
  4500*    END-EXEC.
  4501*    MOVE '*" I                  ''   #00004457' TO DFHEIV0
  4502     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  4503     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4504     MOVE X'2020233030303034343537' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL652.cbl
  4505     CALL 'kxdfhei1' USING DFHEIV0,
  4506           QID-PI,
  4507           PROGRAM-INTERFACE-BLOCK,
  4508           PI-COMM-LENGTH,
  4509           QID-ITEM,
  4510           DFHEIV99,
  4511           DFHEIV99
  4512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4513
  4514
  4515 3400-EXIT.
  4516      EXIT.
  4517
  4518 3450-DELETE-TEMP-STOR-PI.
  4519
  4520
  4521* EXEC CICS HANDLE CONDITION
  4522*        QIDERR  (3450-EXIT)
  4523*    END-EXEC.
  4524*    MOVE '"$N                   ! $ #00004469' TO DFHEIV0
  4525     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4527     MOVE X'2420233030303034343639' TO DFHEIV0(25:11)
  4528     CALL 'kxdfhei1' USING DFHEIV0
  4529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4530
  4531
  4532
  4533* EXEC CICS DELETEQ TS
  4534*        QUEUE  (QID-PI)
  4535*    END-EXEC.
  4536*    MOVE '*&                    #   #00004473' TO DFHEIV0
  4537     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  4538     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4539     MOVE X'2020233030303034343733' TO DFHEIV0(25:11)
  4540     CALL 'kxdfhei1' USING DFHEIV0,
  4541           QID-PI,
  4542           DFHEIV99
  4543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4544
  4545
  4546
  4547* EXEC CICS SYNCPOINT
  4548*    END-EXEC.
  4549*    MOVE '6"                    !   #00004477' TO DFHEIV0
  4550     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  4551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4552     MOVE X'2020233030303034343737' TO DFHEIV0(25:11)
  4553     CALL 'kxdfhei1' USING DFHEIV0
  4554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4555
  4556
  4557 3450-EXIT.
  4558      EXIT.
  4559
  4560 3475-RECOVER-TEMP-STOR-PI.
  4561
  4562     MOVE LOW-VALUES            TO  EL652AI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL652.cbl
  4563
  4564
  4565* EXEC CICS HANDLE CONDITION
  4566*        NOTOPEN   (9990-ABEND)
  4567*        NOTFND    (8880-NOT-FOUND)
  4568*        PGMIDERR  (9600-PGMID-ERROR)
  4569*        ERROR     (9990-ABEND)
  4570*    END-EXEC.
  4571*    MOVE '"$JIL.                ! % #00004487' TO DFHEIV0
  4572     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  4573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4574     MOVE X'2520233030303034343837' TO DFHEIV0(25:11)
  4575     CALL 'kxdfhei1' USING DFHEIV0
  4576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4577
  4578
  4579
  4580* EXEC CICS HANDLE CONDITION
  4581*        QIDERR  (3475-EXIT)
  4582*    END-EXEC.
  4583*    MOVE '"$N                   ! & #00004494' TO DFHEIV0
  4584     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4585     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4586     MOVE X'2620233030303034343934' TO DFHEIV0(25:11)
  4587     CALL 'kxdfhei1' USING DFHEIV0
  4588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4589
  4590
  4591
  4592* EXEC CICS READQ TS
  4593*        QUEUE   (QID-PI)
  4594*        ITEM    (1)
  4595*        INTO    (PROGRAM-INTERFACE-BLOCK)
  4596*        LENGTH  (PI-COMM-LENGTH)
  4597*    END-EXEC.
  4598     MOVE 1
  4599       TO DFHEIV11
  4600*    MOVE '*$II   L              ''   #00004498' TO DFHEIV0
  4601     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4602     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4603     MOVE X'2020233030303034343938' TO DFHEIV0(25:11)
  4604     CALL 'kxdfhei1' USING DFHEIV0,
  4605           QID-PI,
  4606           PROGRAM-INTERFACE-BLOCK,
  4607           PI-COMM-LENGTH,
  4608           DFHEIV11,
  4609           DFHEIV99,
  4610           DFHEIV99
  4611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4612
  4613
  4614     PERFORM 3450-DELETE-TEMP-STOR-PI THRU 3450-EXIT.
  4615
  4616     IF  PI-ERCOMP-KEY = SPACES OR LOW-VALUES
  4617         GO TO 8100-SEND-INITIAL-MAP.
  4618
  4619     IF  PI-ERC-CARRIER > LOW-VALUES
  4620         MOVE +1                 TO CARRIERL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL652.cbl
  4621         MOVE PI-ERC-CARRIER     TO CARRIERI.
  4622
  4623     IF  PI-ERC-GROUP > LOW-VALUES
  4624         MOVE +6                 TO GROUPL
  4625         MOVE PI-ERC-GROUP       TO GROUPI.
  4626
  4627     IF  PI-ERC-RESP > LOW-VALUES
  4628         MOVE +10                TO FINRESPL
  4629         MOVE PI-ERC-RESP        TO FINRESPI.
  4630
  4631     IF  PI-ERC-ACCT > LOW-VALUES
  4632         MOVE +1                 TO ACCTNOL
  4633         MOVE PI-ERC-ACCT        TO ACCTNOI.
  4634
  4635     IF  PI-ERC-TYPE > LOW-VALUES
  4636         MOVE +1                 TO TYPEL
  4637         MOVE PI-ERC-TYPE        TO TYPEI.
  4638
  4639     MOVE 'S'                    TO MAINTYPI.
  4640     MOVE 1                      TO MAINTYPL.
  4641     GO TO 4000-EDIT-MAINT.
  4642
  4643 3475-EXIT.
  4644      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL652.cbl
  4646 4000-EDIT-MAINT.
  4647     IF MAINTYPL > ZERO
  4648         MOVE MAINTYPI           TO  PI-CHECK-MAINT-TYPE
  4649         IF VALID-MAINT-TYPE
  4650             MOVE AL-UANON       TO  MAINTYPA
  4651             IF MAINTYPI NOT = 'S'
  4652                 MOVE SPACES     TO  WS-ACCESS
  4653                 MOVE '1'        TO  CNTL-REC-TYPE
  4654                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
  4655             ELSE
  4656                 NEXT SENTENCE
  4657         ELSE
  4658             MOVE -1             TO  MAINTYPL
  4659             MOVE AL-UABON       TO  MAINTYPA
  4660             MOVE ER-2039        TO  EMI-ERROR
  4661             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4662     ELSE
  4663         MOVE -1                 TO  MAINTYPL
  4664         MOVE AL-UABON           TO  MAINTYPA
  4665         MOVE ER-2039            TO  EMI-ERROR
  4666         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4667
  4668     IF  NOT MODIFY-CAP
  4669             AND
  4670         NOT SHOW-FUNCTION
  4671         MOVE 'UPDATE'           TO SM-READ
  4672         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4673         IF  MORTGAGE-SESSION
  4674             MOVE ER-9096        TO  EMI-ERROR
  4675             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4676             GO TO 8100-SEND-INITIAL-MAP
  4677         ELSE
  4678             MOVE ER-0070        TO  EMI-ERROR
  4679             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4680             GO TO 8100-SEND-INITIAL-MAP.
  4681
  4682     IF CARRIERL > ZERO
  4683         IF PI-CARRIER-SECURITY > SPACES
  4684             IF CARRIERI = PI-CARRIER-SECURITY
  4685                 NEXT SENTENCE
  4686             ELSE
  4687                 MOVE -1            TO  CARRIERL
  4688                 MOVE ER-2370       TO  EMI-ERROR
  4689                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4690                 MOVE AL-UABON      TO  CARRIERA
  4691                 GO TO 8200-SEND-DATAONLY.
  4692
  4693     IF CARRIERL > ZERO
  4694         IF ADD-FUNCTION
  4695             IF PI-ZERO-CARRIER
  4696               OR PI-ZERO-CAR-GROUP
  4697                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4698                                     CARRIERI
  4699                 MOVE AL-UANON   TO  CARRIERA
  4700             ELSE
  4701                 MOVE CARRIERI   TO  WS-CARRIER
  4702                 MOVE '6'        TO  CNTL-REC-TYPE
  4703                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL652.cbl
  4704         ELSE
  4705             IF PI-ZERO-CARRIER
  4706               OR PI-ZERO-CAR-GROUP
  4707                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4708                                     CARRIERI
  4709                 MOVE AL-UANON   TO  CARRIERA
  4710             ELSE
  4711                 MOVE AL-UANON   TO  CARRIERA
  4712                 MOVE CARRIERI   TO  PI-ERC-CARRIER
  4713     ELSE
  4714         IF ADD-FUNCTION
  4715             IF PI-ZERO-CARRIER
  4716               OR PI-ZERO-CAR-GROUP
  4717                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4718                                     CARRIERI
  4719                 MOVE AL-UANON   TO  CARRIERA
  4720             ELSE
  4721                 MOVE -1         TO  CARRIERL
  4722                 MOVE AL-UABON   TO  CARRIERA
  4723                 MOVE ER-0193    TO  EMI-ERROR
  4724                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4725         ELSE
  4726             MOVE -1             TO  CARRIERL
  4727             MOVE AL-UABON       TO  CARRIERA
  4728             MOVE ER-0193        TO  EMI-ERROR
  4729             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4730
  4731     IF GROUPL > ZERO
  4732         IF PI-ZERO-GROUPING
  4733           OR PI-ZERO-CAR-GROUP
  4734             MOVE ZEROS          TO  PI-ERC-GROUP
  4735                                     GROUPI
  4736             MOVE AL-UANON       TO  GROUPA
  4737         ELSE
  4738             MOVE AL-UANON       TO  GROUPA
  4739             MOVE GROUPI         TO  PI-ERC-GROUP
  4740     ELSE
  4741         IF ADD-FUNCTION
  4742             IF PI-ZERO-GROUPING
  4743               OR PI-ZERO-CAR-GROUP
  4744                 MOVE ZEROS      TO  PI-ERC-GROUP
  4745                                     GROUPI
  4746                 MOVE AL-UANON   TO  GROUPA
  4747             ELSE
  4748                 MOVE LOW-VALUES  TO  PI-ERC-GROUP
  4749         ELSE
  4750             MOVE LOW-VALUES     TO  PI-ERC-GROUP.
  4751
  4752     IF TYPEL > ZERO
  4753         MOVE TYPEI              TO  PI-CHECK-TYPE
  4754         IF VALID-TYPE
  4755             MOVE AL-UANON       TO  TYPEA
  4756             MOVE TYPEI          TO  PI-ERC-TYPE
  4757         ELSE
  4758             MOVE -1             TO  TYPEL
  4759             MOVE AL-UABON       TO  TYPEA
  4760             MOVE ER-2042        TO  EMI-ERROR
  4761             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL652.cbl
  4762     ELSE
  4763         MOVE -1                 TO  TYPEL
  4764         MOVE AL-UABON           TO  TYPEA
  4765         MOVE ER-2042            TO  EMI-ERROR
  4766         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4767
  4768     IF FINRESPL >        ZERO
  4769         MOVE AL-UANON           TO  FINRESPA
  4770         IF FINRESPI = SPACES
  4771             MOVE LOW-VALUES     TO  PI-ERC-RESP
  4772         ELSE
  4773             MOVE FINRESPI       TO  PI-ERC-RESP
  4774     ELSE
  4775         MOVE LOW-VALUES         TO  PI-ERC-RESP.
  4776
  4777     IF ACCTNOL > ZERO
  4778         MOVE AL-UANON           TO  ACCTNOA
  4779         IF ACCTNOI = SPACES
  4780             MOVE LOW-VALUES     TO  PI-ERC-ACCT
  4781         ELSE
  4782             MOVE ACCTNOI        TO  PI-ERC-ACCT
  4783     ELSE
  4784         MOVE LOW-VALUES         TO  PI-ERC-ACCT.
  4785
  4786     IF ADDR2L > ZERO
  4787        MOVE AL-UANON            TO ADDR2A
  4788        IF ADDR2I = SPACES
  4789           MOVE LOW-VALUES       TO PI-SAVE-ADDR2
  4790        ELSE
  4791           MOVE ADDR2I           TO PI-SAVE-ADDR2
  4792        END-IF
  4793     ELSE
  4794        MOVE LOW-VALUES          TO PI-SAVE-ADDR2
  4795     END-IF
  4796
  4797     IF CITYL > ZERO
  4798        MOVE AL-UANON            TO CITYA
  4799        IF CITYI = SPACES
  4800           MOVE LOW-VALUES       TO PI-SAVE-CITY
  4801        ELSE
  4802           MOVE CITYI            TO PI-SAVE-CITY
  4803        END-IF
  4804     ELSE
  4805        MOVE LOW-VALUES          TO PI-SAVE-CITY
  4806     END-IF
  4807
  4808     IF STATEL > ZERO
  4809        MOVE AL-UANON            TO STATEA
  4810        IF STATEI = SPACES
  4811           MOVE LOW-VALUES       TO PI-SAVE-STATE
  4812        ELSE
  4813           MOVE STATEI           TO PI-SAVE-STATE
  4814        END-IF
  4815     ELSE
  4816        MOVE LOW-VALUES          TO PI-SAVE-STATE
  4817     END-IF
  4818
  4819     IF NOT MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL652.cbl
  4820         IF SHOW-FUNCTION
  4821             GO TO 5000-BUILD-INITIAL-SCREEN
  4822         ELSE
  4823             MOVE 'UPDATE'       TO SM-READ
  4824             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4825             MOVE ER-0070        TO  EMI-ERROR
  4826             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4827             GO TO 8100-SEND-INITIAL-MAP.
  4828
  4829     IF EMI-NO-ERRORS
  4830         NEXT SENTENCE
  4831     ELSE
  4832        IF EIBTRNID NOT = TRANS-ID
  4833            GO TO 8100-SEND-INITIAL-MAP
  4834         ELSE
  4835            GO TO 8200-SEND-DATAONLY.
  4836
  4837     IF CHANGE-FUNCTION
  4838         GO TO 4400-CHANGE.
  4839
  4840     IF DELETE-FUNCTION
  4841         GO TO 4600-DELETE.
  4842
  4843     IF SHOW-FUNCTION
  4844         GO TO 5000-BUILD-INITIAL-SCREEN.
  4845
  4846     IF TYPEI = 'C'
  4847         IF FINRESPI NOT = LOW-VALUES OR
  4848            ACCTNOI  NOT = LOW-VALUES
  4849               MOVE -1           TO  FINRESPL
  4850               MOVE AL-UABON     TO  FINRESPA
  4851                                     ACCTNOA
  4852               MOVE ER-2088      TO  EMI-ERROR
  4853               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4854
  4855     IF TYPEI = 'A'
  4856         IF FINRESPI = LOW-VALUES OR
  4857             ACCTNOI = LOW-VALUES
  4858               MOVE -1           TO  FINRESPL
  4859               MOVE AL-UABON     TO  FINRESPA
  4860                                     ACCTNOA
  4861               MOVE ER-2089      TO  EMI-ERROR
  4862               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4863
  4864     IF TYPEI = 'G' OR 'B'
  4865         IF ACCTNOI NOT = LOW-VALUES
  4866             MOVE -1             TO  ACCTNOL
  4867             MOVE AL-UABON       TO  ACCTNOA
  4868             MOVE ER-2091        TO  EMI-ERROR
  4869             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4870         ELSE
  4871             IF FINRESPI = LOW-VALUES
  4872                 MOVE -1         TO  FINRESPL
  4873                 MOVE AL-UABON   TO  FINRESPA
  4874                 MOVE ER-2097    TO  EMI-ERROR
  4875                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4876
  4877     IF TYPEI = 'G' OR 'B'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL652.cbl
  4878         IF SUMMNOI NOT = LOW-VALUES
  4879             MOVE -1             TO  SUMMNOL
  4880             MOVE AL-UABON       TO  SUMMNOA
  4881             MOVE ER-3153        TO  EMI-ERROR
  4882             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4883
  4884     IF TYPEI = 'G' OR 'B'
  4885         IF NETGRSI NOT = LOW-VALUES
  4886             MOVE -1             TO  NETGRSL
  4887             MOVE AL-UABON       TO  NETGRSA
  4888             MOVE ER-3154        TO  EMI-ERROR
  4889             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4890
  4891     IF EMI-NO-ERRORS
  4892         NEXT SENTENCE
  4893     ELSE
  4894         GO TO 8200-SEND-DATAONLY.
  4895
  4896     IF ADD-FUNCTION
  4897         GO TO 4200-ADD.
  4898
  4899     MOVE -1                     TO  MAINTYPL.
  4900     MOVE ER-2056                TO  EMI-ERROR.
  4901     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4902
  4903     GO TO 8200-SEND-DATAONLY.
  4904
  4905 4000-EXIT.
  4906     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL652.cbl
  4908 4200-ADD.
  4909     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  4910         MOVE ER-2057            TO  EMI-ERROR
  4911         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4912         MOVE -1                 TO  MAINTYPL
  4913         GO TO 8200-SEND-DATAONLY.
  4914
  4915     PERFORM 7000-EDIT  THRU  7000-EXIT.
  4916
  4917     IF EMI-NO-ERRORS
  4918         NEXT SENTENCE
  4919     ELSE
  4920         GO TO 8200-SEND-DATAONLY.
  4921
  4922
  4923* EXEC CICS HANDLE CONDITION
  4924*        NOTOPEN  (9990-ABEND)
  4925*        NOTFND   (4250-CONT)
  4926*    END-EXEC.
  4927*    MOVE '"$JI                  ! '' #00004813' TO DFHEIV0
  4928     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4930     MOVE X'2720233030303034383133' TO DFHEIV0(25:11)
  4931     CALL 'kxdfhei1' USING DFHEIV0
  4932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4933
  4934
  4935     PERFORM 7050-READ-ERCOMP  THRU  7050-EXIT.
  4936
  4937     MOVE ER-2057                TO  EMI-ERROR.
  4938     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4939
  4940     MOVE LOW-VALUES             TO  PI-SAVE-ERCOMP-KEY.
  4941
  4942     MOVE -1                     TO  MAINTYPL.
  4943
  4944     GO TO 8200-SEND-DATAONLY.
  4945
  4946 4250-CONT.
  4947     PERFORM 7150-ERCOMP-GETMAIN  THRU  7150-EXIT.
  4948
  4949     MOVE SPACES                 TO  COMPENSATION-MASTER.
  4950     MOVE ZEROS                  TO  CO-LF-CLM-AMT
  4951                                     CO-AH-CLM-AMT
  4952                                     CO-CUR-FICA
  4953                                     CO-YTD-FICA
  4954                                     CO-CUR-OVR-UNDR
  4955                                     CO-YTD-OVR-UNDR
  4956                                     CO-MAX-BANK-FEE-LEASE
  4957                                     CO-MAX-BANK-FEE
  4958                                     CO-BAL-FWD
  4959                                     CO-CUR-COM
  4960                                     CO-CUR-CHG
  4961                                     CO-CUR-PMT
  4962                                     CO-END-BAL
  4963                                     CO-CUR
  4964                                     CO-OV30
  4965                                     CO-OV60
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL652.cbl
  4966                                     CO-OV90
  4967                                     co-ov120
  4968                                     CO-YTD-COM
  4969                                     CO-YTD-OV
  4970                                     CO-YTD-PAID-COM
  4971                                     CO-YTD-PAID-OV
  4972                                     CO-CURRENT-BAL-FWD
  4973                                     CO-CURRENT-CUR-COM
  4974                                     CO-CURRENT-CUR-CHG
  4975                                     CO-CURRENT-CUR-PMT
  4976                                     CO-CURRENT-END-BAL
  4977                                     CO-CURRENT-CUR
  4978                                     CO-CURRENT-OV30
  4979                                     CO-CURRENT-OV60
  4980                                     CO-CURRENT-OV90
  4981                                     co-current-ov120
  4982                                     CO-CURRENT-YTD-COM
  4983                                     CO-CURRENT-YTD-OV
  4984                                     CO-ACT-YEAR
  4985                                     CO-ACT-MONTH
  4986                                     CO-ACT-DAY.
  4987     MOVE LOW-VALUES             TO  CO-LAST-ACTIVITY-DATE
  4988                                     CO-LAST-STMT-DT
  4989                                     CO-CURRENT-LAST-STMT-DT
  4990                                     CO-GA-EFFECTIVE-DT
  4991                                     CO-GA-TERMINATION-DT.
  4992     MOVE LOW-VALUES             TO  CO-FIRST-WRITTEN-DT.
  4993
  4994     MOVE 'N'                    TO  CO-INTERNAL-CONTROL-1
  4995                                     CO-INTERNAL-CONTROL-2.
  4996     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6099-EXIT.
  4997
  4998     MOVE PI-PROCESSOR-ID        TO  CO-LAST-MAINT-USER.
  4999     MOVE EIBTIME                TO  CO-LAST-MAINT-HHMMSS.
  5000     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5001     MOVE '5'                    TO  DC-OPTION-CODE.
  5002     MOVE LINK-ELDATCV           TO  PGM-NAME.
  5003
  5004
  5005* EXEC CICS LINK
  5006*        PROGRAM   (PGM-NAME)
  5007*        COMMAREA  (DATE-CONVERSION-DATA)
  5008*        LENGTH    (DC-COMM-LENGTH)
  5009*    END-EXEC.
  5010*    MOVE '."C                   ''   #00004887' TO DFHEIV0
  5011     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5012     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5013     MOVE X'2020233030303034383837' TO DFHEIV0(25:11)
  5014     CALL 'kxdfhei1' USING DFHEIV0,
  5015           PGM-NAME,
  5016           DATE-CONVERSION-DATA,
  5017           DC-COMM-LENGTH,
  5018           DFHEIV99,
  5019           DFHEIV99,
  5020           DFHEIV99
  5021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5022
  5023
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL652.cbl
  5024     MOVE DC-BIN-DATE-1          TO  CO-LAST-MAINT-DT
  5025                                     BIN-CURRENT-SAVE.
  5026     MOVE PI-CR-MONTH-END-DT     TO  CO-ROLADEX-PRINT-DT.
  5027     MOVE PI-CR-MONTH-END-DT     TO  DC-BIN-DATE-1
  5028     MOVE SPACE                  TO  DC-OPTION-CODE.
  5029
  5030
  5031* EXEC CICS LINK
  5032*        PROGRAM   (PGM-NAME)
  5033*        COMMAREA  (DATE-CONVERSION-DATA)
  5034*        LENGTH    (DC-COMM-LENGTH)
  5035*    END-EXEC.
  5036*    MOVE '."C                   ''   #00004899' TO DFHEIV0
  5037     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5038     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5039     MOVE X'2020233030303034383939' TO DFHEIV0(25:11)
  5040     CALL 'kxdfhei1' USING DFHEIV0,
  5041           PGM-NAME,
  5042           DATE-CONVERSION-DATA,
  5043           DC-COMM-LENGTH,
  5044           DFHEIV99,
  5045           DFHEIV99,
  5046           DFHEIV99
  5047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5048
  5049
  5050     MOVE PI-COMPANY-CD          TO  CO-COMPANY-CD.
  5051     MOVE 'CO'                   TO  CO-RECORD-ID.
  5052     MOVE 'A'                    TO  JP-RECORD-TYPE.
  5053     MOVE COMP-FILE-ID           TO  FILE-ID.
  5054     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5055
  5056     PERFORM 4300-ADD-COMPENSATION-NAME  THRU  4300-EXIT.
  5057
  5058
  5059* EXEC CICS WRITE
  5060*        DATASET  (COMP-FILE-ID)
  5061*        FROM     (COMPENSATION-MASTER)
  5062*        RIDFLD   (CO-CONTROL-PRIMARY)
  5063*    END-EXEC.
  5064     MOVE LENGTH OF
  5065      COMPENSATION-MASTER
  5066       TO DFHEIV11
  5067*    MOVE '&$ L                  ''   #00004913' TO DFHEIV0
  5068     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5069     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5070     MOVE X'2020233030303034393133' TO DFHEIV0(25:11)
  5071     CALL 'kxdfhei1' USING DFHEIV0,
  5072           COMP-FILE-ID,
  5073           COMPENSATION-MASTER,
  5074           DFHEIV11,
  5075           CO-CONTROL-PRIMARY,
  5076           DFHEIV99,
  5077           DFHEIV99
  5078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5079
  5080
  5081     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL652.cbl
  5082
  5083     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  5084
  5085     IF PI-AR-PROCESSING
  5086         IF SUMMNOL > ZERO
  5087             MOVE SUMMNOI        TO PI-AR-SUMMARY-CODE
  5088             PERFORM 7500-UPDATE-SUMM  THRU  7599-EXIT
  5089             MOVE PI-AR-SUMMARY-CODE
  5090                                 TO  WS-SUMM-FOR-RQST
  5091             PERFORM 6500-UPDATE-RQST  THRU  6599-EXIT.
  5092
  5093     MOVE ER-0000                TO  EMI-ERROR.
  5094     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5095
  5096     MOVE LOW-VALUES             TO  EL652AO.
  5097     MOVE PI-ERC-CARRIER         TO  CARRIERO.
  5098     MOVE PI-ERC-TYPE            TO  TYPEO.
  5099     MOVE AL-UANON               TO  CARRIERA
  5100                                     TYPEA.
  5101
  5102     IF PI-ERC-GROUP NOT = SPACES
  5103         MOVE PI-ERC-GROUP       TO  GROUPO
  5104         MOVE AL-UANON           TO  GROUPA.
  5105
  5106     IF PI-ERC-RESP NOT = SPACES
  5107         MOVE PI-ERC-RESP        TO  FINRESPO
  5108         MOVE AL-UANON           TO  FINRESPA.
  5109
  5110     IF PI-ERC-ACCT NOT = SPACES
  5111         MOVE PI-ERC-ACCT        TO  ACCTNOO
  5112         MOVE AL-UANON           TO  ACCTNOA.
  5113
  5114     GO TO 5000-BUILD-INITIAL-SCREEN.
  5115
  5116 4200-EXIT.
  5117     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL652.cbl
  5119 4300-ADD-COMPENSATION-NAME.
  5120
  5121* EXEC CICS HANDLE CONDITION
  5122*         DUPREC   (4300-EXIT)
  5123*    END-EXEC.
  5124*    MOVE '"$%                   ! ( #00004958' TO DFHEIV0
  5125     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  5126     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5127     MOVE X'2820233030303034393538' TO DFHEIV0(25:11)
  5128     CALL 'kxdfhei1' USING DFHEIV0
  5129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5130
  5131
  5132
  5133* EXEC CICS GETMAIN
  5134*         LENGTH   (ERNAME-LENGTH)
  5135*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  5136*         INITIMG  (GETMAIN-SPACE)
  5137*    END-EXEC.
  5138*    MOVE ',"IL                  $   #00004962' TO DFHEIV0
  5139     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5140     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5141     MOVE X'2020233030303034393632' TO DFHEIV0(25:11)
  5142     CALL 'kxdfhei1' USING DFHEIV0,
  5143           DFHEIV20,
  5144           ERNAME-LENGTH,
  5145           GETMAIN-SPACE
  5146     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  5147         DFHEIV20
  5148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5149
  5150
  5151     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  5152     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  5153     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  5154     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  5155     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  5156     MOVE CO-ACCT-NAME           TO  NL-NAME.
  5157     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  5158        MOVE NL-NAME (5:26)      TO NL-NAME
  5159     END-IF
  5160     MOVE CO-ADDR-CITY           TO  NL-CITY.
  5161     MOVE CO-ADDR-STATE          TO  NL-ST
  5162     MOVE 'C'                    TO  NL-RECORD-TYPE.
  5163     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  5164     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  5165     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  5166     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  5167     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  5168     MOVE CO-TYPE                TO  NL-CO-TYPE.
  5169
  5170
  5171* EXEC CICS WRITE
  5172*        FROM      (NAME-LOOKUP-MASTER)
  5173*        RIDFLD    (NL-CONTROL-PRIMARY)
  5174*        DATASET   (NAME-FILE-ID)
  5175*    END-EXEC.
  5176     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL652.cbl
  5177      NAME-LOOKUP-MASTER
  5178       TO DFHEIV11
  5179*    MOVE '&$ L                  ''   #00004987' TO DFHEIV0
  5180     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5181     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5182     MOVE X'2020233030303034393837' TO DFHEIV0(25:11)
  5183     CALL 'kxdfhei1' USING DFHEIV0,
  5184           NAME-FILE-ID,
  5185           NAME-LOOKUP-MASTER,
  5186           DFHEIV11,
  5187           NL-CONTROL-PRIMARY,
  5188           DFHEIV99,
  5189           DFHEIV99
  5190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5191
  5192
  5193 4300-EXIT.
  5194     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL652.cbl
  5196 4400-CHANGE.
  5197     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  5198         NEXT SENTENCE
  5199     ELSE
  5200**** MUST SHOW RECORD FIRST
  5201         MOVE ER-2056            TO  EMI-ERROR
  5202         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5203         MOVE -1                 TO  MAINTYPL
  5204         GO TO 8200-SEND-DATAONLY.
  5205
  5206     PERFORM 7000-EDIT  THRU  7000-EXIT.
  5207
  5208     IF EMI-NO-ERRORS
  5209         NEXT SENTENCE
  5210     ELSE
  5211         GO TO 8200-SEND-DATAONLY.
  5212
  5213     PERFORM 7200-READ-ERCOMP-UPDATE  THRU  7200-EXIT.
  5214
  5215     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5216     MOVE CO-AR-SUMMARY-CODE     TO  WS-SAVE-SUMM.
  5217
  5218     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6099-EXIT.
  5219
  5220     IF (CO-LAST-MAINT-USER   = PI-UPDATE-BY)
  5221        OR (CO-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  5222        CONTINUE
  5223     ELSE
  5224
  5225* EXEC CICS UNLOCK
  5226*            DATASET  (COMP-FILE-ID)
  5227*       END-EXEC
  5228*    MOVE '&*                    #   #00005024' TO DFHEIV0
  5229     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5230     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5231     MOVE X'2020233030303035303234' TO DFHEIV0(25:11)
  5232     CALL 'kxdfhei1' USING DFHEIV0,
  5233           COMP-FILE-ID,
  5234           DFHEIV99
  5235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5236        MOVE ER-0068             TO EMI-ERROR
  5237        PERFORM 9900-ERROR-FORMAT
  5238                                 THRU 9900-EXIT
  5239        GO TO 8200-SEND-DATAONLY
  5240     END-IF
  5241
  5242     MOVE PI-PROCESSOR-ID        TO  CO-LAST-MAINT-USER.
  5243     MOVE EIBTIME                TO  CO-LAST-MAINT-HHMMSS.
  5244     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5245     MOVE '5'                    TO  DC-OPTION-CODE.
  5246     MOVE LINK-ELDATCV           TO  PGM-NAME.
  5247
  5248
  5249* EXEC CICS LINK
  5250*        PROGRAM   (PGM-NAME)
  5251*        COMMAREA  (DATE-CONVERSION-DATA)
  5252*        LENGTH    (DC-COMM-LENGTH)
  5253*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL652.cbl
  5254*    MOVE '."C                   ''   #00005039' TO DFHEIV0
  5255     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5256     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5257     MOVE X'2020233030303035303339' TO DFHEIV0(25:11)
  5258     CALL 'kxdfhei1' USING DFHEIV0,
  5259           PGM-NAME,
  5260           DATE-CONVERSION-DATA,
  5261           DC-COMM-LENGTH,
  5262           DFHEIV99,
  5263           DFHEIV99,
  5264           DFHEIV99
  5265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5266
  5267
  5268     MOVE DC-BIN-DATE-1          TO  CO-LAST-MAINT-DT
  5269                                     BIN-CURRENT-SAVE.
  5270     MOVE SPACE                  TO  DC-OPTION-CODE.
  5271     MOVE PI-CR-MONTH-END-DT     TO  CO-ROLADEX-PRINT-DT.
  5272     MOVE PI-CR-MONTH-END-DT     TO  DC-BIN-DATE-1
  5273
  5274
  5275* EXEC CICS LINK
  5276*        PROGRAM   (PGM-NAME)
  5277*        COMMAREA  (DATE-CONVERSION-DATA)
  5278*        LENGTH    (DC-COMM-LENGTH)
  5279*    END-EXEC.
  5280*    MOVE '."C                   ''   #00005051' TO DFHEIV0
  5281     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5282     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5283     MOVE X'2020233030303035303531' TO DFHEIV0(25:11)
  5284     CALL 'kxdfhei1' USING DFHEIV0,
  5285           PGM-NAME,
  5286           DATE-CONVERSION-DATA,
  5287           DC-COMM-LENGTH,
  5288           DFHEIV99,
  5289           DFHEIV99,
  5290           DFHEIV99
  5291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5292
  5293
  5294     MOVE 'N'                    TO  CO-INTERNAL-CONTROL-1.
  5295     MOVE 'B'                    TO  JP-RECORD-TYPE.
  5296     MOVE COMP-FILE-ID           TO  FILE-ID.
  5297
  5298     PERFORM 8400-LOG-JOURNAL-RECORD.
  5299
  5300     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5301
  5302     PERFORM 4300-ADD-COMPENSATION-NAME  THRU  4300-EXIT.
  5303
  5304
  5305* EXEC CICS REWRITE
  5306*        DATASET  (COMP-FILE-ID)
  5307*        FROM     (COMPENSATION-MASTER)
  5308*    END-EXEC.
  5309     MOVE LENGTH OF
  5310      COMPENSATION-MASTER
  5311       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL652.cbl
  5312*    MOVE '&& L                  %   #00005067' TO DFHEIV0
  5313     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5314     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5315     MOVE X'2020233030303035303637' TO DFHEIV0(25:11)
  5316     CALL 'kxdfhei1' USING DFHEIV0,
  5317           COMP-FILE-ID,
  5318           COMPENSATION-MASTER,
  5319           DFHEIV11,
  5320           DFHEIV99
  5321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5322
  5323
  5324     MOVE 'C'                    TO  JP-RECORD-TYPE.
  5325
  5326     PERFORM 8400-LOG-JOURNAL-RECORD.
  5327
  5328     IF NOT PI-AR-PROCESSING
  5329         GO TO 4400-CONT.
  5330
  5331     IF SUMMNOL NOT > ZERO
  5332         GO TO 4400-CONT.
  5333
  5334     IF SUMMNOI  = WS-SAVE-SUMM
  5335         GO TO 4400-CONT
  5336     ELSE
  5337         PERFORM 7600-DELETE-SUMM  THRU  7699-EXIT.
  5338
  5339     MOVE SUMMNOI                 TO WS-SUMM-FOR-RQST.
  5340     PERFORM 6500-UPDATE-RQST  THRU  6599-EXIT.
  5341
  5342     IF SUMMNOI = SPACES
  5343         GO TO 4400-CONT.
  5344
  5345     MOVE SUMMNOI                 TO PI-AR-SUMMARY-CODE.
  5346     PERFORM 7500-UPDATE-SUMM  THRU  7599-EXIT.
  5347
  5348 4400-CONT.
  5349     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  5350
  5351     MOVE ER-0000                TO  EMI-ERROR.
  5352     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5353
  5354     MOVE LOW-VALUES             TO  EL652AO.
  5355     MOVE PI-ERC-CARRIER         TO  CARRIERO.
  5356     MOVE PI-ERC-TYPE            TO  TYPEO.
  5357     MOVE AL-UANON               TO  CARRIERA
  5358                                     TYPEA.
  5359
  5360     IF PI-ERC-GROUP NOT = SPACES
  5361         MOVE PI-ERC-GROUP       TO  GROUPO
  5362         MOVE AL-UANON           TO  GROUPA.
  5363
  5364     IF PI-ERC-RESP NOT = SPACES
  5365         MOVE PI-ERC-RESP        TO  FINRESPO
  5366         MOVE AL-UANON           TO  FINRESPA.
  5367
  5368     IF PI-ERC-ACCT NOT = SPACES
  5369         MOVE PI-ERC-ACCT        TO  ACCTNOO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL652.cbl
  5370         MOVE AL-UANON           TO  ACCTNOA.
  5371
  5372     GO TO 5000-BUILD-INITIAL-SCREEN.
  5373
  5374 4400-EXIT.
  5375     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL652.cbl
  5377 4600-DELETE.
  5378     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  5379         NEXT SENTENCE
  5380     ELSE
  5381         MOVE ER-2056            TO  EMI-ERROR
  5382         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5383         MOVE -1                 TO  MAINTYPL
  5384         GO TO 8200-SEND-DATAONLY.
  5385
  5386     PERFORM 7200-READ-ERCOMP-UPDATE  THRU  7200-EXIT.
  5387
  5388     MOVE CO-AR-SUMMARY-CODE     TO  WS-SAVE-SUMM.
  5389
  5390     IF (CO-YTD-COM NOT = ZERO) OR
  5391        (CO-END-BAL NOT = ZERO)
  5392
  5393* EXEC CICS UNLOCK
  5394*            DATASET  (COMP-FILE-ID)
  5395*        END-EXEC
  5396*    MOVE '&*                    #   #00005140' TO DFHEIV0
  5397     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5398     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5399     MOVE X'2020233030303035313430' TO DFHEIV0(25:11)
  5400     CALL 'kxdfhei1' USING DFHEIV0,
  5401           COMP-FILE-ID,
  5402           DFHEIV99
  5403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5404         MOVE ER-2092            TO  EMI-ERROR
  5405         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5406         MOVE -1                 TO  MAINTYPL
  5407         GO TO 8200-SEND-DATAONLY.
  5408
  5409     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5410     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5411     MOVE COMP-FILE-ID           TO  FILE-ID.
  5412
  5413     IF CO-LAST-MAINT-USER   = PI-UPDATE-BY OR
  5414        CO-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS
  5415         continue
  5416     ELSE
  5417
  5418* EXEC CICS UNLOCK
  5419*            DATASET  (COMP-FILE-ID)
  5420*        END-EXEC
  5421*    MOVE '&*                    #   #00005156' TO DFHEIV0
  5422     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5423     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5424     MOVE X'2020233030303035313536' TO DFHEIV0(25:11)
  5425     CALL 'kxdfhei1' USING DFHEIV0,
  5426           COMP-FILE-ID,
  5427           DFHEIV99
  5428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5429         MOVE ER-0068            TO  EMI-ERROR
  5430         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5431         GO TO 8200-SEND-DATAONLY
  5432     end-if
  5433     if pi-el652-del-sw = 'Y'
  5434        continue
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL652.cbl
  5435     else
  5436        move 'Y'                 to pi-el652-del-sw
  5437        move er-1299             to emi-error
  5438        perform 9900-error-format thru 9900-exit
  5439        move spaces              to maintypo
  5440        MOVE -1                  TO MAINTypL
  5441        GO TO 8200-send-dataonly
  5442     end-if
  5443
  5444* EXEC CICS DELETE
  5445*        DATASET  (COMP-FILE-ID)
  5446*    END-EXEC
  5447*    MOVE '&(                    &   #00005173' TO DFHEIV0
  5448     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5449     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5450     MOVE X'2020233030303035313733' TO DFHEIV0(25:11)
  5451     CALL 'kxdfhei1' USING DFHEIV0,
  5452           COMP-FILE-ID,
  5453           DFHEIV99,
  5454           DFHEIV99,
  5455           DFHEIV99,
  5456           DFHEIV99
  5457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5458
  5459     PERFORM 8400-LOG-JOURNAL-RECORD
  5460     MOVE EIBDATE                TO  DC-JULIAN-YYDDD
  5461     MOVE '5'                    TO  DC-OPTION-CODE
  5462     MOVE LINK-ELDATCV           TO  PGM-NAME
  5463
  5464
  5465* EXEC CICS LINK
  5466*        PROGRAM   (PGM-NAME)
  5467*        COMMAREA  (DATE-CONVERSION-DATA)
  5468*        LENGTH    (DC-COMM-LENGTH)
  5469*    END-EXEC
  5470*    MOVE '."C                   ''   #00005182' TO DFHEIV0
  5471     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5472     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5473     MOVE X'2020233030303035313832' TO DFHEIV0(25:11)
  5474     CALL 'kxdfhei1' USING DFHEIV0,
  5475           PGM-NAME,
  5476           DATE-CONVERSION-DATA,
  5477           DC-COMM-LENGTH,
  5478           DFHEIV99,
  5479           DFHEIV99,
  5480           DFHEIV99
  5481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5482
  5483     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE
  5484
  5485     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT
  5486
  5487     MOVE ER-0000                TO  EMI-ERROR
  5488     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5489
  5490     IF PI-AR-PROCESSING
  5491         IF WS-SAVE-SUMM NOT = SPACES
  5492             PERFORM 7600-DELETE-SUMM  THRU  7699-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL652.cbl
  5493             MOVE SPACES         TO  WS-SUMM-FOR-RQST
  5494             PERFORM  6500-UPDATE-RQST  THRU  6599-EXIT
  5495         end-if
  5496     end-if
  5497
  5498     MOVE LOW-VALUES             TO  EL652AO
  5499     MOVE PI-ERC-CARRIER         TO  CARRIERO
  5500     MOVE PI-ERC-TYPE            TO  TYPEO
  5501     MOVE AL-UANON               TO  CARRIERA
  5502                                     TYPEA
  5503
  5504     IF PI-ERC-GROUP NOT = SPACES
  5505         MOVE PI-ERC-GROUP       TO  GROUPO
  5506         MOVE AL-UANON           TO  GROUPA
  5507     end-if
  5508
  5509     IF PI-ERC-RESP NOT = SPACES
  5510         MOVE PI-ERC-RESP        TO  FINRESPO
  5511         MOVE AL-UANON           TO  FINRESPA
  5512     end-if
  5513
  5514     IF PI-ERC-ACCT NOT = SPACES
  5515         MOVE PI-ERC-ACCT        TO  ACCTNOO
  5516         MOVE AL-UANON           TO  ACCTNOA
  5517     end-if
  5518
  5519     MOVE LOW-VALUES             TO  PI-SAVE-ERCOMP-KEY
  5520
  5521     GO TO 8100-SEND-INITIAL-MAP
  5522     .
  5523 4600-EXIT.
  5524     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL652.cbl
  5526
  5527 4700-CHECK-STATE.
  5528     IF CLPSTI =  SPACES
  5529         GO TO 4799-EXIT
  5530     END-IF.
  5531
  5532     MOVE SPACES                 TO  ELCNTL-KEY2.
  5533     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID-2.
  5534     MOVE '3'                    TO  CNTL-REC-TYPE-2.
  5535     MOVE CLPSTI                 TO  CNTL-STATE-2.
  5536     MOVE +0                     TO  CNTL-SEQ-NO-2.
  5537
  5538
  5539* EXEC CICS  HANDLE CONDITION
  5540*        NOTFND  (4750-NO-STATE)
  5541*    END-EXEC.
  5542*    MOVE '"$I                   ! ) #00005243' TO DFHEIV0
  5543     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5544     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5545     MOVE X'2920233030303035323433' TO DFHEIV0(25:11)
  5546     CALL 'kxdfhei1' USING DFHEIV0
  5547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5548
  5549
  5550
  5551* EXEC CICS  READ
  5552*        DATASET  (CNTL-FILE-ID)
  5553*        SET      (ADDRESS OF CONTROL-FILE)
  5554*        RIDFLD   (ELCNTL-KEY2)
  5555*    END-EXEC.
  5556*    MOVE '&"S        E          (   #00005247' TO DFHEIV0
  5557     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5558     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5559     MOVE X'2020233030303035323437' TO DFHEIV0(25:11)
  5560     CALL 'kxdfhei1' USING DFHEIV0,
  5561           CNTL-FILE-ID,
  5562           DFHEIV20,
  5563           DFHEIV99,
  5564           ELCNTL-KEY2,
  5565           DFHEIV99,
  5566           DFHEIV99,
  5567           DFHEIV99
  5568     SET ADDRESS OF CONTROL-FILE TO
  5569         DFHEIV20
  5570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5571
  5572
  5573     GO TO 4799-EXIT.
  5574
  5575 4750-NO-STATE.
  5576     MOVE ER-0144                TO  EMI-ERROR.
  5577     MOVE -1                     TO  CLPSTL.
  5578     MOVE AL-UABON               TO  CLPSTA.
  5579
  5580     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5581
  5582 4799-EXIT.
  5583     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL652.cbl
  5584
  5585 5000-BUILD-INITIAL-SCREEN.
  5586     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  5587
  5588     PERFORM 7050-READ-ERCOMP  THRU  7050-EXIT.
  5589
  5590     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  5591     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  5592
  5593     IF CO-LAST-MAINT-HHMMSS NUMERIC
  5594        MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS
  5595        ELSE
  5596        MOVE ZEROS                  TO  PI-UPDATE-HHMMSS.
  5597
  5598 5050-SET-UP-SCREEN.
  5599     MOVE CO-CONTROL-NAME        TO  PCONTO.
  5600     MOVE CO-MAIL-NAME           TO  MAILNAMO.
  5601     MOVE CO-ACCT-NAME           TO  ACCTNAMO.
  5602     MOVE CO-ACCT-NAME           TO  PI-SAVE-ACCT-NAME.
  5603     MOVE CO-ADDR-1              TO  ADDR1O.
  5604     MOVE CO-ADDR-2              TO  ADDR2O
  5605                                     PI-SAVE-ADDR2
  5606     MOVE CO-ADDR-CITY           TO  CITYO
  5607                                     PI-SAVE-CITY
  5608     MOVE CO-ADDR-STATE          TO  STATEO
  5609                                     PI-SAVE-STATE
  5610     MOVE SPACES                 TO  WS-ZIP-CODE.
  5611
  5612     IF CO-CANADIAN-POST-CODE
  5613         MOVE CO-CAN-POSTAL-1    TO  WS-ZIP-CAN-2-POST1
  5614         MOVE CO-CAN-POSTAL-2    TO  WS-ZIP-CAN-2-POST2
  5615     ELSE
  5616         MOVE CO-ZIP-PRIME       TO  WS-ZIP-AM-2-CODE
  5617         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  5618             MOVE '-'            TO  WS-ZIP-AM-2-DASH
  5619             MOVE CO-ZIP-PLUS4   TO  WS-ZIP-AM-2-PLUS4.
  5620
  5621     MOVE WS-ZIP-CODE            TO  ZIPCODEO.
  5622
  5623     IF CO-BILL-SW = ' ' OR 'B' OR 'R' OR 'T' OR 'S'
  5624        OR 'O' OR 'E' OR 'C'
  5625         MOVE AL-UANON           TO  BILLPRTA
  5626         MOVE CO-BILL-SW         TO  BILLPRTO
  5627     END-IF.
  5628
  5629     MOVE CO-CSO-1099            TO  PNT1099O.
  5630
  5631     MOVE CO-CSR-CODE            TO  CSRO.
  5632
  5633     IF (PI-COMPANY-ID = 'DCC')
  5634        AND (CO-TYPE = 'A')
  5635        IF CO-COMP-TYPE = '1'
  5636           MOVE 'Y'              TO SPPDDO
  5637        ELSE
  5638           MOVE 'N'              TO SPPDDO
  5639        END-IF
  5640     END-IF
  5641     MOVE CO-SOC-SEC             TO  SSNO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL652.cbl
  5642
  5643     MOVE CO-BALANCE-CONTROL     TO  CARBALO.
  5644
  5645     IF PI-AR-PROCESSING
  5646         IF CO-AR-SUMMARY-CODE > SPACES
  5647             MOVE AL-UANON       TO  SUMMNOA
  5648             MOVE CO-AR-SUMMARY-CODE
  5649                                 TO  SUMMNOO
  5650         ELSE
  5651             MOVE LOW-VALUES     TO  SUMMNOO.
  5652
  5653     IF PI-AR-PROCESSING
  5654        IF NOT CO-ACCOUNT-TYPE
  5655           MOVE AL-SADOF         TO SCDESCA
  5656           MOVE AL-SANOF         TO SUMMNOA
  5657        ELSE
  5658           MOVE AL-UANOF         TO SUMMNOA.
  5659
  5660     IF PI-AR-PROCESSING
  5661*        MOVE CO-AR-BAL-LEVEL    TO  ARBALO
  5662         MOVE CO-AR-PULL-CHECK   TO  CKPULLO.
  5663
  5664     IF PI-AR-PROCESSING
  5665         IF CO-ACCOUNT-TYPE
  5666             MOVE CO-AR-REPORTING
  5667                                 TO  NETGRSO
  5668         ELSE
  5669             MOVE SPACES         TO  NETGRSO.
  5670
  5671     MOVE SPACES                 TO  FLITYPO.
  5672
  5673     IF CO-COMPANY-TYPE
  5674         MOVE SPACES             TO  RPTCD2O
  5675         MOVE AL-SADOF           TO  RPTCDDA.
  5676
  5677     MOVE SPACES                 TO  LETRCDO.
  5678     MOVE AL-SADOF               TO  LETDESCA.
  5679     MOVE SPACES                 TO  BALCDO.
  5680     MOVE AL-SADOF               TO  BALPRTA.
  5681     MOVE CO-CLP-STATE           TO  CLPSTO.
  5682     MOVE CO-MAX-BANK-FEE        TO  MAXFEEO
  5683     MOVE CO-SPP-REFUND-EDIT     TO  REFEO
  5684     IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  5685        MOVE +0                  TO CO-MAX-BANK-FEE-LEASE
  5686     END-IF
  5687     MOVE CO-MAX-BANK-FEE-LEASE  TO  MAXLFO
  5688     .
  5689 5060-BUILD-TOTALS.
  5690     IF SHOW-SAVE-TOTALS
  5691         NEXT SENTENCE
  5692     ELSE
  5693         GO TO 5070-BUILD-CURRENT-TOTALS.
  5694
  5695     IF CO-LAST-STMT-DT = SPACES
  5696         MOVE SPACES             TO  LSTMDTO
  5697         GO TO 5060-LST-STMT-OK.
  5698
  5699     MOVE CO-LAST-STMT-MONTH     TO  WS-YMD-MM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL652.cbl
  5700     MOVE CO-LAST-STMT-DAY       TO  WS-YMD-DD.
  5701     MOVE CO-LAST-STMT-YEAR      TO  WS-YMD-YY.
  5702
  5703     IF WS-YMD-DATE-NUM NUMERIC
  5704         NEXT SENTENCE
  5705     ELSE
  5706         MOVE SPACES             TO  LSTMDTO
  5707         GO TO 5060-LST-STMT-OK.
  5708
  5709     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  5710     MOVE '3'                    TO  DC-OPTION-CODE.
  5711
  5712     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5713
  5714     IF NO-CONVERSION-ERROR
  5715         NEXT SENTENCE
  5716     ELSE
  5717         MOVE SPACES             TO  LSTMDTO
  5718         GO TO 5060-LST-STMT-OK.
  5719
  5720     MOVE CO-LAST-STMT-MONTH     TO  WS-DMDY8-MM.
  5721     MOVE CO-LAST-STMT-DAY       TO  WS-DMDY8-DD.
  5722     MOVE CO-LAST-STMT-YEAR      TO  WS-DMDY8-YY.
  5723     MOVE '/'                    TO  WS-DMDY8-SL1
  5724                                     WS-DMDY8-SL2.
  5725     MOVE WS-DATE-MDY-8          TO  LSTMDTO.
  5726
  5727 5060-LST-STMT-OK.
  5728     MOVE CO-BAL-FWD             TO  BALFWDO.
  5729     MOVE CO-CUR-COM             TO  CURCOMO.
  5730     MOVE CO-CUR-PMT             TO  CURPMTO.
  5731     MOVE CO-CUR-CHG             TO  CURCHGO.
  5732     MOVE CO-END-BAL             TO  ENDBALO.
  5733     MOVE CO-CUR                 TO  CURRENTO.
  5734     MOVE CO-OV30                TO  OVER30O.
  5735     MOVE CO-OV60                TO  OVER60O.
  5736     MOVE CO-OV90                TO  OVER90O.
  5737     if pi-company-id = 'AHL'
  5738        if co-ov120 not numeric
  5739           move zeros            to co-ov120
  5740        end-if
  5741        move co-ov120            to over120o
  5742     end-if
  5743     IF CO-ACCOUNT-TYPE
  5744        MOVE CO-YTD-COM          TO YTDCOMO
  5745     ELSE
  5746        MOVE CO-YTD-OV           TO YTDCOMO
  5747     END-IF
  5748
  5749     MOVE AL-SADOF               TO  PFK9A.
  5750     MOVE 'PREV. END-OF-MONTH TOTALS DISPLAYED'
  5751                                 TO  EMI-MESSAGE-AREA (1).
  5752
  5753     GO TO 5090-CONTD.
  5754
  5755 5070-BUILD-CURRENT-TOTALS.
  5756     IF CO-CURRENT-LAST-STMT-DT = SPACES
  5757         MOVE SPACES             TO  LSTMDTO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL652.cbl
  5758         GO TO 5070-LST-STMT-OK.
  5759
  5760     MOVE CO-CURRENT-LAST-STMT-MONTH
  5761                                 TO WS-YMD-MM.
  5762     MOVE CO-CURRENT-LAST-STMT-DAY
  5763                                 TO  WS-YMD-DD.
  5764     MOVE CO-CURRENT-LAST-STMT-YEAR
  5765                                 TO  WS-YMD-YY.
  5766
  5767     IF WS-YMD-DATE-NUM NUMERIC
  5768         NEXT SENTENCE
  5769     ELSE
  5770         MOVE SPACES             TO  LSTMDTO
  5771         GO TO 5070-LST-STMT-OK.
  5772
  5773     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  5774     MOVE '3'                    TO  DC-OPTION-CODE.
  5775
  5776     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5777
  5778     IF NO-CONVERSION-ERROR
  5779         NEXT SENTENCE
  5780     ELSE
  5781         MOVE SPACES             TO  LSTMDTO
  5782         GO TO 5070-LST-STMT-OK.
  5783
  5784     MOVE CO-CURRENT-LAST-STMT-MONTH
  5785                                 TO  WS-DMDY8-MM.
  5786     MOVE CO-CURRENT-LAST-STMT-DAY
  5787                                 TO  WS-DMDY8-DD.
  5788     MOVE CO-CURRENT-LAST-STMT-YEAR
  5789                                 TO  WS-DMDY8-YY.
  5790     MOVE '/'                    TO  WS-DMDY8-SL1
  5791                                     WS-DMDY8-SL2.
  5792     MOVE WS-DATE-MDY-8          TO  LSTMDTO.
  5793
  5794 5070-LST-STMT-OK.
  5795     MOVE CO-CURRENT-BAL-FWD     TO  BALFWDO.
  5796     MOVE CO-CURRENT-CUR-COM     TO  CURCOMO.
  5797     MOVE CO-CURRENT-CUR-PMT     TO  CURPMTO.
  5798     MOVE CO-CURRENT-CUR-CHG     TO  CURCHGO.
  5799     MOVE CO-CURRENT-END-BAL     TO  ENDBALO
  5800                                     PI-ERC-END-BAL.
  5801     MOVE CO-CURRENT-CUR         TO  CURRENTO.
  5802     MOVE CO-CURRENT-OV30        TO  OVER30O.
  5803     MOVE CO-CURRENT-OV60        TO  OVER60O.
  5804     MOVE CO-CURRENT-OV90        TO  OVER90O.
  5805     if pi-company-id = 'AHL'
  5806        if co-current-ov120 not numeric
  5807           move zeros            to co-current-ov120
  5808        end-if
  5809        move co-current-ov120    to over120o
  5810     end-if
  5811     IF CO-ACCOUNT-TYPE
  5812        MOVE CO-CURRENT-YTD-COM  TO YTDCOMO
  5813     ELSE
  5814        MOVE CO-CURRENT-YTD-OV   TO YTDCOMO
  5815     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL652.cbl
  5816     .
  5817 5090-CONTD.
  5818
  5819     MOVE CO-LAST-MAINT-USER     TO LSTUSRO.
  5820
  5821     MOVE ' '              TO DC-OPTION-CODE.
  5822     MOVE CO-LAST-MAINT-DT TO DC-BIN-DATE-1.
  5823
  5824     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5825
  5826     MOVE DC-GREG-DATE-1-EDIT    TO LSTDTEO.
  5827
  5828     IF CO-LAST-MAINT-HHMMSS NUMERIC
  5829         MOVE CO-LAST-MAINT-HHMMSS
  5830                                 TO TIME-IN
  5831         MOVE TIME-OUT           TO LSTTIMEO
  5832     ELSE
  5833         MOVE ZEROS              TO TIME-IN
  5834         MOVE TIME-OUT           TO LSTTIMEO.
  5835
  5836     IF PI-COMPANY-ID =  'FLI'  OR  'FLU'  OR  'UCL'
  5837         MOVE AL-SANOF           TO  FLITYPEA
  5838         MOVE AL-UANON           TO  FLITYPA
  5839     ELSE
  5840         MOVE AL-SANON           TO  FLITYPA.
  5841
  5842     IF PI-COMPANY-ID = 'NCL'
  5843         IF CO-ACCOUNT-TYPE
  5844             MOVE AL-SANOF       TO  RPTCD2A
  5845         ELSE
  5846             IF CO-COMPANY-TYPE
  5847                MOVE AL-SANOF    TO  RPTCD2A
  5848                MOVE AL-SADOF    TO  RPTCDDA.
  5849
  5850     IF PI-COMPANY-ID = 'NCL'
  5851         IF CO-GEN-AGENT-TYPE
  5852            MOVE AL-UANON       TO  RPTCD2A.
  5853
  5854     IF PI-COMPANY-ID = 'NCL'
  5855         MOVE AL-UANON           TO  LETRCDA
  5856     ELSE
  5857         MOVE AL-SANOF           TO  LETRCDA
  5858         MOVE AL-SADOF           TO  LETDESCA.
  5859
  5860     IF PI-COMPANY-ID  NOT =  'DDB' AND 'ANT' AND 'ASL' AND
  5861                              'AN1' AND 'TFS'
  5862         MOVE AL-SANOF           TO  BALCDA
  5863         MOVE AL-SADOF           TO  BALPRTA.
  5864
  5865     IF PI-AR-PROCESSING
  5866         IF CO-ACCOUNT-TYPE
  5867             MOVE AL-SANOF       TO  SCDESCA
  5868             MOVE AL-SANOF       TO  NGDESCA
  5869             MOVE AL-UANON       TO  NETGRSA
  5870             IF PI-COMPANY-ID  =  'DDB' OR 'ANT' OR 'ASL' OR
  5871                                  'AN1' OR 'TFS'
  5872                 MOVE AL-SANOF   TO  BALPRTA
  5873                 MOVE AL-UANON   TO  BALCDA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL652.cbl
  5874
  5875     IF PI-AR-PROCESSING
  5876*            MOVE AL-SANOF       TO  BALDESCA
  5877             move al-sanof       to  CKDESCA
  5878*            MOVE AL-UANON       TO  ARBALA
  5879             move al-uanon       to  CKPULLA.
  5880
  5881
  5882     MOVE AL-UANON               TO  MAILNAMA
  5883                                     ACCTNAMA
  5884                                     ADDR1A
  5885                                     ADDR2A
  5886                                     CITYA
  5887                                     STATEA
  5888                                     SSNA
  5889                                     ZIPCODEA
  5890                                     BILLPRTA
  5891                                     PNT1099A
  5892                                     CARBALA.
  5893
  5894     IF NOT SHOW-SAVE-TOTALS
  5895         IF PI-PROCESSOR-ID = 'LGXX'
  5896             GO TO 5100-CONTD.
  5897
  5898     MOVE AL-SANOF               TO  BALFWDA
  5899                                     CURCOMA
  5900                                     CURPMTA
  5901                                     CURCHGA
  5902                                     ENDBALA.
  5903
  5904 5100-CONTD.
  5905     IF CO-TELEPHONE NUMERIC
  5906         MOVE CO-TELEPHONE       TO  WS-PHONE-IN
  5907                                     PI-SAVE-PHONE
  5908         MOVE WSPI-AREA          TO  WSPO-AREA
  5909         MOVE WSPI-PFX           TO  WSPO-PFX
  5910         MOVE WSPI-SFX           TO  WSPO-SFX
  5911         MOVE WS-PHONE-OUT       TO  PHONEO
  5912         MOVE AL-UNNON           TO  PHONEA
  5913     ELSE
  5914         MOVE SPACES             TO  PHONEO.
  5915
  5916     IF CO-FAXNO NUMERIC
  5917         MOVE CO-FAXNO           TO  WS-PHONE-IN
  5918                                     PI-SAVE-FAXNO
  5919         MOVE WSPI-AREA          TO  WSPO-AREA
  5920         MOVE WSPI-PFX           TO  WSPO-PFX
  5921         MOVE WSPI-SFX           TO  WSPO-SFX
  5922         MOVE WS-PHONE-OUT       TO  FAXNOO
  5923         MOVE AL-UNNON           TO  FAXNOA
  5924     ELSE
  5925         MOVE SPACES             TO  FAXNOO.
  5926
  5927     MOVE 'S'                    TO  MAINTYPO
  5928                                     PI-CHECK-MAINT-TYPE.
  5929     MOVE AL-UANON               TO  MAINTYPA.
  5930     MOVE -1                     TO  MAINTYPL.
  5931
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL652.cbl
  5932     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL652.cbl
  5934 6000-CHECK-FOR-UPDATE.
  5935     IF CHANGE-FUNCTION
  5936         GO TO 6010-CONT.
  5937
  5938     IF CARRIERL > ZERO
  5939         MOVE CARRIERI           TO  CO-CARRIER.
  5940
  5941     IF GROUPL > ZERO
  5942         MOVE GROUPI             TO  CO-GROUPING
  5943     ELSE
  5944         MOVE LOW-VALUES         TO  CO-GROUPING.
  5945
  5946     IF FINRESPL > ZERO
  5947         MOVE FINRESPI           TO  CO-RESP-NO
  5948     ELSE
  5949         MOVE LOW-VALUES         TO  CO-RESP-NO.
  5950
  5951     IF ACCTNOL > ZERO
  5952         MOVE ACCTNOI            TO  CO-ACCOUNT
  5953     ELSE
  5954         MOVE LOW-VALUES         TO  CO-ACCOUNT.
  5955
  5956     IF TYPEL > ZERO
  5957         MOVE TYPEI              TO  CO-TYPE.
  5958
  5959 6010-CONT.
  5960     IF PI-PROCESSOR-ID = 'LGXX'
  5961         IF LSTMDTL > ZERO
  5962             MOVE WS-YMD-YY      TO  CO-CURRENT-LAST-STMT-YEAR
  5963                                     WS-DMDY8-YY
  5964             MOVE WS-YMD-MM      TO  CO-CURRENT-LAST-STMT-MONTH
  5965                                     WS-DMDY8-MM
  5966             MOVE WS-YMD-DD      TO  CO-CURRENT-LAST-STMT-DAY
  5967                                     WS-DMDY8-DD
  5968             MOVE '/'            TO  WS-DMDY8-SL1  WS-DMDY8-SL2
  5969             MOVE WS-DATE-MDY-8  TO  LSTMDTO.
  5970
  5971     IF PI-AR-PROCESSING
  5972         IF TYPEI = 'A'
  5973             IF SUMMNOL > ZERO
  5974                 MOVE SUMMNOI   TO  CO-AR-SUMMARY-CODE
  5975                                    WS-SAVE-SUMMARY.
  5976
  5977     IF PI-AR-PROCESSING
  5978         IF TYPEI = 'A'
  5979             IF NETGRSL > ZERO
  5980                 MOVE NETGRSI   TO  CO-AR-REPORTING
  5981             ELSE
  5982                 IF ADD-FUNCTION
  5983                     MOVE 'G'   TO  CO-AR-REPORTING.
  5984
  5985     IF PI-AR-PROCESSING
  5986*        IF ARBALL > ZERO
  5987*            MOVE ARBALI        TO  CO-AR-BAL-LEVEL
  5988*        ELSE
  5989             IF ADD-FUNCTION
  5990                 MOVE '1'       TO  CO-AR-BAL-LEVEL.
  5991
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL652.cbl
  5992     IF PI-AR-PROCESSING
  5993         IF CKPULLL > ZERO
  5994             MOVE CKPULLI       TO  CO-AR-PULL-CHECK
  5995         ELSE
  5996             IF ADD-FUNCTION
  5997                 MOVE 'Y'       TO  CO-AR-PULL-CHECK.
  5998
  5999     IF MAILNAML > ZERO
  6000         MOVE MAILNAMI           TO  CO-MAIL-NAME
  6001                                     WS-SAVE-NAME.
  6002
  6003     IF ACCTNAML > ZERO
  6004         MOVE ACCTNAMI           TO  CO-ACCT-NAME.
  6005
  6006     IF ADDR1L > ZERO
  6007         MOVE ADDR1I             TO  CO-ADDR-1.
  6008
  6009     IF ADDR2L > ZERO
  6010         MOVE ADDR2I             TO  CO-ADDR-2.
  6011
  6012     IF CITYL > ZERO
  6013         MOVE CITYI              TO  CO-ADDR-CITY.
  6014     IF STATEL > ZERO
  6015         MOVE STATEI             TO  CO-ADDR-STATE.
  6016
  6017     IF ZIPCODEL NOT > ZERO
  6018         GO TO 6015-CONT.
  6019
  6020     MOVE ZIPCODEI               TO  WS-ZIP-CODE.
  6021
  6022     IF WS-CANADIAN-ZIP
  6023         IF WS-ZIP-4 = SPACE  OR  '-'
  6024             MOVE WS-ZIP-CAN-2-POST1     TO  CO-CAN-POSTAL-1
  6025             MOVE WS-ZIP-CAN-2-POST2     TO  CO-CAN-POSTAL-2
  6026         ELSE
  6027             MOVE WS-ZIP-CAN-1-POST1     TO  CO-CAN-POSTAL-1
  6028             MOVE WS-ZIP-CAN-1-POST2     TO  CO-CAN-POSTAL-2
  6029     ELSE
  6030         IF WS-ZIP-6 = SPACE  OR  '-'
  6031             MOVE WS-ZIP-AM-2-CODE       TO  CO-ZIP-PRIME
  6032             MOVE WS-ZIP-AM-2-PLUS4      TO  CO-ZIP-PLUS4
  6033         ELSE
  6034             MOVE WS-ZIP-AM-1-CODE       TO  CO-ZIP-PRIME
  6035             MOVE WS-ZIP-AM-1-PLUS4      TO  CO-ZIP-PLUS4.
  6036
  6037 6015-CONT.
  6038     IF BILLPRTL > ZERO
  6039         IF BILLPRTI = ' ' OR 'B' OR 'R' OR 'T' OR 'S'
  6040            OR 'O' OR 'E' OR 'C'
  6041             MOVE  BILLPRTI          TO  CO-BILL-SW
  6042         ELSE
  6043             MOVE SPACES         TO  CO-BILL-SW
  6044                                     BILLPRTO
  6045         END-IF
  6046     END-IF.
  6047     IF SPPDDL > ZERO
  6048        IF SPPDDI = 'Y'
  6049           MOVE '1'              TO CO-COMP-TYPE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL652.cbl
  6050        ELSE
  6051           MOVE ' '              TO CO-COMP-TYPE
  6052        END-IF
  6053     END-IF
  6054     IF PNT1099L > ZERO
  6055         IF PNT1099I = 'N' OR 'Y'
  6056             MOVE  PNT1099I      TO  CO-CSO-1099
  6057         ELSE
  6058             MOVE 'N'            TO  CO-CSO-1099
  6059                                     PNT1099O
  6060         END-IF
  6061     END-IF.
  6062
  6063     IF CSRL > ZERO
  6064         MOVE CSRI               TO  CO-CSR-CODE.
  6065
  6066     IF SSNL > ZERO
  6067         MOVE SSNI               TO  CO-SOC-SEC.
  6068
  6069     IF PHONEL > ZERO
  6070         MOVE PI-SAVE-PHONE      TO  CO-TELEPHONE
  6071         MOVE ZEROS              TO  PI-SAVE-PHONE.
  6072
  6073     IF FAXNOL > ZERO
  6074         MOVE PI-SAVE-FAXNO      TO  CO-FAXNO
  6075         MOVE ZEROS              TO  PI-SAVE-FAXNO.
  6076
  6077     IF PCONTL > ZEROS
  6078        MOVE PCONTI              TO CO-CONTROL-NAME
  6079     END-IF
  6080     IF CLPSTL > ZERO
  6081         MOVE CLPSTI             TO  CO-CLP-STATE
  6082     END-IF
  6083     IF REFEL > ZERO
  6084        MOVE REFEI               TO CO-SPP-REFUND-EDIT
  6085     END-IF
  6086     IF MAXFEEL > ZERO
  6087         MOVE MAXFEEI            TO  CO-MAX-BANK-FEE
  6088*        IF ADD-FUNCTION
  6089*           MOVE CO-MAX-BANK-FEE TO  CO-BANK-FEE
  6090*        ELSE
  6091*           IF CHANGE-FUNCTION
  6092*              PERFORM 6100-EDIT-ERAGTC
  6093*                                THRU 6100-EXIT
  6094*              IF WS-TOT-FEES > CO-MAX-BANK-FEE
  6095*                 MOVE ER-2717   TO EMI-ERROR
  6096*                 MOVE -1        TO MAXFEEL
  6097*                 MOVE AL-UABON  TO MAXFEEA
  6098*                 PERFORM 9900-ERROR-FORMAT
  6099*                                THRU 9900-EXIT
  6100*              ELSE
  6101*                 COMPUTE CO-BANK-FEE = CO-MAX-BANK-FEE
  6102*                    - WS-TOT-FEES
  6103*              END-IF
  6104*           END-IF
  6105*        END-IF
  6106     END-IF
  6107
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL652.cbl
  6108     IF MAXLFL > ZERO
  6109         MOVE MAXLFI             TO CO-MAX-BANK-FEE-LEASE
  6110     END-IF
  6111     IF CARBALL > ZERO
  6112         MOVE CARBALI            TO  CO-BALANCE-CONTROL
  6113         GO TO 6020-CONT.
  6114
  6115     IF NOT PI-AR-PROCESSING
  6116         GO TO 6020-CONT.
  6117
  6118     IF ADD-FUNCTION
  6119        AND (TYPEI = 'G' OR 'B')
  6120         MOVE 'Y'                TO  CO-BALANCE-CONTROL
  6121         GO TO 6020-CONT.
  6122
  6123     IF ADD-FUNCTION
  6124         IF TYPEI = 'A'
  6125             IF FINRESPI = ACCTNOI
  6126                 MOVE 'Y'        TO  CO-BALANCE-CONTROL
  6127             ELSE
  6128                 MOVE 'N'        TO  CO-BALANCE-CONTROL.
  6129
  6130     IF ADD-FUNCTION AND TYPEI = 'C'
  6131         MOVE 'N'                TO  CO-BALANCE-CONTROL.
  6132
  6133 6020-CONT.
  6134     IF BALFWDL > ZERO
  6135         MOVE WS-SAVE-BALFWD     TO  CO-CURRENT-BAL-FWD.
  6136
  6137     IF CURCOML > ZERO
  6138         MOVE WS-SAVE-CURCOM     TO  CO-CURRENT-CUR-COM.
  6139
  6140     IF CURCHGL > ZERO
  6141         MOVE WS-SAVE-CURCHG     TO  CO-CURRENT-CUR-CHG.
  6142
  6143     IF CURPMTL > ZERO
  6144         MOVE WS-SAVE-CURPMT     TO  CO-CURRENT-CUR-PMT.
  6145
  6146     IF ENDBALL > ZERO
  6147         MOVE WS-SAVE-ENDBAL     TO  CO-CURRENT-END-BAL.
  6148
  6149*    IF YTDCOML > ZERO
  6150*       IF CO-ACCOUNT-TYPE
  6151*          MOVE WS-SAVE-YTDCOM   TO CO-CURRENT-YTD-COM
  6152*       ELSE
  6153*          MOVE WS-SAVE-YTDCOM   TO CO-CURRENT-YTD-OV
  6154*       END-IF
  6155*    END-IF
  6156     .
  6157 6099-EXIT.
  6158     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL652.cbl
  6160 6100-EDIT-ERAGTC.
  6161
  6162* EXEC CICS READ
  6163*         SET     (ADDRESS OF AGENT-COMMISSIONS)
  6164*         DATASET ('ERAGTC')
  6165*         RIDFLD  (PI-ERCOMP-KEY)
  6166*         RESP    (WS-RESPONSE)
  6167*    END-EXEC
  6168     MOVE 'ERAGTC' TO DFHEIV1
  6169*    MOVE '&"S        E          (  N#00005841' TO DFHEIV0
  6170     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6172     MOVE X'204E233030303035383431' TO DFHEIV0(25:11)
  6173     CALL 'kxdfhei1' USING DFHEIV0,
  6174           DFHEIV1,
  6175           DFHEIV20,
  6176           DFHEIV99,
  6177           PI-ERCOMP-KEY,
  6178           DFHEIV99,
  6179           DFHEIV99,
  6180           DFHEIV99
  6181     SET ADDRESS OF AGENT-COMMISSIONS TO
  6182         DFHEIV20
  6183     MOVE EIBRESP  TO WS-RESPONSE
  6184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6185     MOVE +0                     TO WS-TOT-FEES
  6186     IF RESP-NORMAL
  6187        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6188           (S1 > +10)
  6189           COMPUTE WS-TOT-FEES = WS-TOT-FEES
  6190              + AG-SPP-FEES (S1)
  6191        END-PERFORM
  6192     END-IF
  6193     .
  6194 6100-EXIT.
  6195     EXIT.
  6196 6500-UPDATE-RQST.
  6197
  6198     MOVE LOW-VALUES             TO  ERRQST-KEY-3.
  6199     MOVE PI-ERC-COMPANY-CD      TO  RQST-COMP-ID.
  6200     MOVE PI-ERC-CARRIER         TO  RQST-CARRIER.
  6201     MOVE PI-ERC-GROUP           TO  RQST-GROUP.
  6202     MOVE PI-ERC-RESP            TO  RQST-FIN-RESP.
  6203     MOVE PI-ERC-ACCT            TO  RQST-ACCT-AGENT.
  6204
  6205
  6206* EXEC CICS HANDLE CONDITION
  6207*        ENDFILE  (6550-END-BROWSE)
  6208*        NOTFND   (6550-END-BROWSE)
  6209*    END-EXEC.
  6210*    MOVE '"$''I                  ! * #00005867' TO DFHEIV0
  6211     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6213     MOVE X'2A20233030303035383637' TO DFHEIV0(25:11)
  6214     CALL 'kxdfhei1' USING DFHEIV0
  6215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6216
  6217
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL652.cbl
  6218
  6219* EXEC CICS STARTBR
  6220*        DATASET  (RQST-FILE-ID-3)
  6221*        RIDFLD   (ERRQST-KEY-3)
  6222*    END-EXEC.
  6223     MOVE 0
  6224       TO DFHEIV11
  6225*    MOVE '&,         G          &   #00005872' TO DFHEIV0
  6226     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6227     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6228     MOVE X'2020233030303035383732' TO DFHEIV0(25:11)
  6229     CALL 'kxdfhei1' USING DFHEIV0,
  6230           RQST-FILE-ID-3,
  6231           ERRQST-KEY-3,
  6232           DFHEIV99,
  6233           DFHEIV11,
  6234           DFHEIV99
  6235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6236
  6237
  6238 6525-READ-LOOP.
  6239
  6240* EXEC CICS HANDLE CONDITION
  6241*        ENDFILE  (6550-END-BROWSE)
  6242*        NOTFND   (6550-END-BROWSE)
  6243*    END-EXEC.
  6244*    MOVE '"$''I                  ! + #00005878' TO DFHEIV0
  6245     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6246     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6247     MOVE X'2B20233030303035383738' TO DFHEIV0(25:11)
  6248     CALL 'kxdfhei1' USING DFHEIV0
  6249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6250
  6251
  6252
  6253* EXEC CICS READNEXT
  6254*        DATASET  (RQST-FILE-ID-3)
  6255*        SET      (ADDRESS OF AR-REQUEST-RECORD)
  6256*        RIDFLD   (ERRQST-KEY-3)
  6257*    END-EXEC.
  6258     MOVE 0
  6259       TO DFHEIV11
  6260*    MOVE '&.S                   )   #00005883' TO DFHEIV0
  6261     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6262     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6263     MOVE X'2020233030303035383833' TO DFHEIV0(25:11)
  6264     CALL 'kxdfhei1' USING DFHEIV0,
  6265           RQST-FILE-ID-3,
  6266           DFHEIV20,
  6267           DFHEIV99,
  6268           ERRQST-KEY-3,
  6269           DFHEIV99,
  6270           DFHEIV11,
  6271           DFHEIV99,
  6272           DFHEIV99
  6273     SET ADDRESS OF AR-REQUEST-RECORD TO
  6274         DFHEIV20
  6275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL652.cbl
  6276
  6277
  6278     IF RQ-CONTROL-BY-FIN-RESP = WS-SAVE-RQST
  6279         GO TO 6525-READ-LOOP.
  6280
  6281     IF RQ-COMPANY-CD-A2 =  PI-ERC-COMPANY-CD AND
  6282        RQ-CARRIER-A2    =  PI-ERC-CARRIER    AND
  6283        RQ-GROUPING-A2   =  PI-ERC-GROUP      AND
  6284        RQ-FIN-RESP-A2   =  PI-ERC-RESP       AND
  6285        RQ-ACCT-AGENT-A2 =  PI-ERC-ACCT
  6286         NEXT SENTENCE
  6287     ELSE
  6288         GO TO 6550-END-BROWSE.
  6289
  6290     IF WS-SUMM-FOR-RQST = RQ-SUMMARY-CODE
  6291         GO TO 6525-READ-LOOP.
  6292
  6293     MOVE RQ-CONTROL-BY-FIN-RESP TO  WS-SAVE-RQST.
  6294     MOVE RQ-CONTROL-PRIMARY     TO  ERRQST-KEY.
  6295
  6296
  6297* EXEC CICS ENDBR
  6298*        DATASET  (RQST-FILE-ID-3)
  6299*    END-EXEC.
  6300     MOVE 0
  6301       TO DFHEIV11
  6302*    MOVE '&2                    $   #00005907' TO DFHEIV0
  6303     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6304     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6305     MOVE X'2020233030303035393037' TO DFHEIV0(25:11)
  6306     CALL 'kxdfhei1' USING DFHEIV0,
  6307           RQST-FILE-ID-3,
  6308           DFHEIV11,
  6309           DFHEIV99
  6310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6311
  6312
  6313
  6314* EXEC CICS HANDLE CONDITION
  6315*        ENDFILE  (6599-EXIT)
  6316*        NOTFND   (6599-EXIT)
  6317*    END-EXEC.
  6318*    MOVE '"$''I                  ! , #00005911' TO DFHEIV0
  6319     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6320     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6321     MOVE X'2C20233030303035393131' TO DFHEIV0(25:11)
  6322     CALL 'kxdfhei1' USING DFHEIV0
  6323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6324
  6325
  6326
  6327* EXEC CICS READ
  6328*        DATASET  (RQST-FILE-ID)
  6329*        SET      (ADDRESS OF AR-REQUEST-RECORD)
  6330*        RIDFLD   (ERRQST-KEY)
  6331*        UPDATE
  6332*    END-EXEC.
  6333*    MOVE '&"S        EU         (   #00005916' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL652.cbl
  6334     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6335     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6336     MOVE X'2020233030303035393136' TO DFHEIV0(25:11)
  6337     CALL 'kxdfhei1' USING DFHEIV0,
  6338           RQST-FILE-ID,
  6339           DFHEIV20,
  6340           DFHEIV99,
  6341           ERRQST-KEY,
  6342           DFHEIV99,
  6343           DFHEIV99,
  6344           DFHEIV99
  6345     SET ADDRESS OF AR-REQUEST-RECORD TO
  6346         DFHEIV20
  6347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6348
  6349
  6350     MOVE WS-SUMM-FOR-RQST       TO  RQ-SUMMARY-CODE.
  6351
  6352
  6353* EXEC CICS REWRITE
  6354*        DATASET  (RQST-FILE-ID)
  6355*        FROM     (AR-REQUEST-RECORD)
  6356*    END-EXEC.
  6357     MOVE LENGTH OF
  6358      AR-REQUEST-RECORD
  6359       TO DFHEIV11
  6360*    MOVE '&& L                  %   #00005925' TO DFHEIV0
  6361     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6362     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6363     MOVE X'2020233030303035393235' TO DFHEIV0(25:11)
  6364     CALL 'kxdfhei1' USING DFHEIV0,
  6365           RQST-FILE-ID,
  6366           AR-REQUEST-RECORD,
  6367           DFHEIV11,
  6368           DFHEIV99
  6369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6370
  6371
  6372     GO TO 6500-UPDATE-RQST.
  6373
  6374 6550-END-BROWSE.
  6375
  6376
  6377* EXEC CICS ENDBR
  6378*        DATASET  (RQST-FILE-ID-3)
  6379*    END-EXEC.
  6380     MOVE 0
  6381       TO DFHEIV11
  6382*    MOVE '&2                    $   #00005934' TO DFHEIV0
  6383     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6384     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6385     MOVE X'2020233030303035393334' TO DFHEIV0(25:11)
  6386     CALL 'kxdfhei1' USING DFHEIV0,
  6387           RQST-FILE-ID-3,
  6388           DFHEIV11,
  6389           DFHEIV99
  6390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6391
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL652.cbl
  6392
  6393 6599-EXIT.
  6394     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL652.cbl
  6396
  6397 7000-EDIT.
  6398     MOVE LSTMDTI                TO  WS-DATE-MDY-8.
  6399
  6400     IF LSTMDTL > ZERO
  6401         NEXT SENTENCE
  6402     ELSE
  6403         GO TO 7100-EDIT-CONTD.
  6404
  6405     IF LSTMDTI = SPACES
  6406         GO TO 7100-EDIT-CONTD.
  6407
  6408     IF WS-DMDY8-SL1 = '/'  AND
  6409        WS-DMDY8-SL2 = '/'
  6410         MOVE WS-DMDY8-MM        TO  WS-YMD-MM
  6411         MOVE WS-DMDY8-DD        TO  WS-YMD-DD
  6412         MOVE WS-DMDY8-YY        TO  WS-YMD-YY
  6413     ELSE
  6414         MOVE WS-DMDY6-MM        TO  WS-YMD-MM
  6415         MOVE WS-DMDY6-DD        TO  WS-YMD-DD
  6416         MOVE WS-DMDY6-YY        TO  WS-YMD-YY.
  6417
  6418     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  6419     MOVE '3'                    TO  DC-OPTION-CODE.
  6420
  6421     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  6422
  6423     IF NO-CONVERSION-ERROR
  6424         NEXT SENTENCE
  6425     ELSE
  6426         GO TO 7090-DATE-ERROR.
  6427
  6428     IF DC-BIN-DATE-1 > PI-CR-MONTH-END-DT
  6429         NEXT SENTENCE
  6430     ELSE
  6431         GO TO 7100-EDIT-CONTD.
  6432
  6433 7090-DATE-ERROR.
  6434     MOVE -1                     TO  LSTMDTL.
  6435     MOVE AL-UABON               TO  LSTMDTA.
  6436     MOVE ER-0314                TO  EMI-ERROR.
  6437
  6438     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6439
  6440 7100-EDIT-CONTD.
  6441
  6442     IF CSRL > ZEROS
  6443         MOVE AL-UANON           TO  CSRA
  6444     END-IF
  6445
  6446     IF MAILNAML > ZERO
  6447         MOVE AL-UANON           TO  MAILNAMA.
  6448
  6449     IF SSNL > ZERO
  6450         MOVE AL-UANON           TO  SSNA.
  6451
  6452     IF ACCTNAML > ZERO
  6453         MOVE AL-UANON           TO  ACCTNAMA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL652.cbl
  6454     ELSE
  6455         IF ADD-FUNCTION
  6456             MOVE -1             TO  ACCTNAML
  6457             MOVE AL-UABON       TO  ACCTNAMA
  6458             MOVE ER-2045        TO  EMI-ERROR
  6459             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6460
  6461     IF PHONEL > ZERO
  6462         MOVE PHONEI               TO  DEEDIT-FIELD
  6463         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  6464         IF DEEDIT-FIELD-V0 = ZEROS
  6465             MOVE SPACES               TO  PHONEO
  6466                                           PI-SAVE-PHONE
  6467         ELSE
  6468             IF (DEEDIT-FIELD-V0 > 9999999999
  6469               OR < 2000000000)
  6470                 MOVE -1               TO  PHONEL
  6471                 MOVE AL-UNBON         TO  PHONEA
  6472                 MOVE ER-2046          TO  EMI-ERROR
  6473                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6474             ELSE
  6475                 MOVE DEEDIT-FIELD-V0  TO  WS-PHONE-IN
  6476                                           PI-SAVE-PHONE-RED
  6477                 MOVE WSPI-AREA        TO  WSPO-AREA
  6478                 MOVE WSPI-PFX         TO  WSPO-PFX
  6479                 MOVE WSPI-SFX         TO  WSPO-SFX
  6480                 MOVE WS-PHONE-OUT     TO  PHONEO
  6481                 MOVE AL-UNNON         TO  PHONEA.
  6482
  6483     IF FAXNOL > ZERO
  6484         MOVE FAXNOI               TO  DEEDIT-FIELD
  6485         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  6486         IF DEEDIT-FIELD-V0 = ZEROS
  6487             MOVE SPACES               TO  FAXNOO
  6488                                           PI-SAVE-FAXNO
  6489         ELSE
  6490             IF (DEEDIT-FIELD-V0 > 9999999999
  6491               OR < 2000000000)
  6492                 MOVE -1               TO  FAXNOL
  6493                 MOVE AL-UNBON         TO  FAXNOA
  6494                 MOVE ER-3055          TO  EMI-ERROR
  6495                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6496             ELSE
  6497                 MOVE DEEDIT-FIELD-V0  TO  WS-PHONE-IN
  6498                                           PI-SAVE-FAXNO-RED
  6499                 MOVE WSPI-AREA        TO  WSPO-AREA
  6500                 MOVE WSPI-PFX         TO  WSPO-PFX
  6501                 MOVE WSPI-SFX         TO  WSPO-SFX
  6502                 MOVE WS-PHONE-OUT     TO  FAXNOO
  6503                 MOVE AL-UNNON         TO  FAXNOA.
  6504
  6505     IF ADDR1L > ZERO
  6506         MOVE AL-UANON           TO  ADDR1A
  6507     ELSE
  6508         IF ADD-FUNCTION
  6509             MOVE -1             TO  ADDR1L
  6510             MOVE AL-UABON       TO  ADDR1A
  6511             MOVE ER-2047        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL652.cbl
  6512             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6513
  6514     IF ADDR2L > ZERO
  6515         MOVE AL-UANON           TO  ADDR2A.
  6516
  6517     IF CARBALL > ZERO OR CHANGE-FUNCTION
  6518         MOVE CARBALI            TO  PI-CHECK-CARRY-BAL
  6519         IF VALID-CARRY-BAL
  6520             PERFORM 7010-EDIT-CARBAL  THRU  7010-EXIT
  6521         ELSE
  6522             MOVE -1             TO  CARBALL
  6523             MOVE AL-UABON       TO  CARBALA
  6524             MOVE ER-2048        TO  EMI-ERROR
  6525             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6526     ELSE
  6527         IF ADD-FUNCTION AND NOT PI-AR-PROCESSING
  6528             MOVE -1             TO  CARBALL
  6529             MOVE AL-UABON       TO  CARBALA
  6530             MOVE ER-2048        TO  EMI-ERROR
  6531             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6532
  6533     IF PI-AR-PROCESSING
  6534         IF TYPEI = 'A'
  6535            IF NETGRSL > ZERO OR CHANGE-FUNCTION
  6536                 IF NETGRSI = 'N' OR 'G'
  6537                    MOVE AL-UANON    TO  NETGRSA
  6538                 ELSE
  6539                     MOVE -1         TO  NETGRSL
  6540                     MOVE AL-UABON   TO  NETGRSA
  6541                     MOVE ER-3151    TO  EMI-ERROR
  6542                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6543
  6544     IF CITYL > ZERO
  6545         MOVE AL-UANON           TO  CITYA
  6546     ELSE
  6547         IF ADD-FUNCTION
  6548             MOVE -1             TO  CITYL
  6549             MOVE AL-UABON       TO  CITYA
  6550             MOVE ER-2049        TO  EMI-ERROR
  6551             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6552
  6553     IF STATEL   > ZERO
  6554        MOVE AL-UANON            TO STATEA
  6555        MOVE SPACES              TO ELCNTL-KEY
  6556        MOVE PI-COMPANY-ID       TO CNTL-COMP-ID
  6557        MOVE '3'                 TO CNTL-REC-TYPE
  6558        MOVE STATEI              TO CNTL-ACCESS
  6559        MOVE +0                  TO CNTL-SEQ-NO
  6560
  6561* EXEC CICS READ
  6562*          DATASET   (CNTL-FILE-ID)
  6563*          SET       (ADDRESS OF CONTROL-FILE)
  6564*          RIDFLD    (ELCNTL-KEY)
  6565*          RESP      (WS-RESPONSE)
  6566*       END-EXEC
  6567*    MOVE '&"S        E          (  N#00006105' TO DFHEIV0
  6568     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6569     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL652.cbl
  6570     MOVE X'204E233030303036313035' TO DFHEIV0(25:11)
  6571     CALL 'kxdfhei1' USING DFHEIV0,
  6572           CNTL-FILE-ID,
  6573           DFHEIV20,
  6574           DFHEIV99,
  6575           ELCNTL-KEY,
  6576           DFHEIV99,
  6577           DFHEIV99,
  6578           DFHEIV99
  6579     SET ADDRESS OF CONTROL-FILE TO
  6580         DFHEIV20
  6581     MOVE EIBRESP  TO WS-RESPONSE
  6582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6583        IF RESP-NORMAL
  6584           CONTINUE
  6585        ELSE
  6586           MOVE ER-2209          TO EMI-ERROR
  6587           MOVE -1               TO STATEL
  6588           MOVE AL-UABON         TO STATEA
  6589           PERFORM 9900-ERROR-FORMAT
  6590                                 THRU 9900-EXIT
  6591        END-IF
  6592     ELSE
  6593         IF ADD-FUNCTION
  6594             MOVE -1             TO  STATEL
  6595             MOVE AL-UABON       TO  STATEA
  6596             MOVE ER-2049        TO  EMI-ERROR
  6597             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6598
  6599*     IF PI-AR-PROCESSING
  6600*         IF ARBALL > ZERO OR CHANGE-FUNCTION
  6601*             IF ARBALI = '1' OR '2' OR '3' OR '4'
  6602*                 MOVE AL-UANON   TO  ARBALA
  6603*             ELSE
  6604*                 MOVE -1         TO  ARBALL
  6605*                 MOVE AL-UABON   TO  ARBALA
  6606*                 MOVE ER-3150    TO  EMI-ERROR
  6607*                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6608
  6609     IF PI-AR-PROCESSING
  6610         IF CKPULLL > ZERO OR CHANGE-FUNCTION
  6611             IF CKPULLI = 'Y' OR 'N'
  6612                 MOVE AL-UANON   TO  CKPULLA
  6613             ELSE
  6614                 MOVE -1         TO  CKPULLL
  6615                 MOVE AL-UABON   TO  CKPULLA
  6616                 MOVE ER-3170    TO  EMI-ERROR
  6617                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6618
  6619     IF ZIPCODEL > ZERO
  6620         MOVE AL-UANON           TO  ZIPCODEA.
  6621
  6622     IF PI-COMPANY-ID = 'CID' OR 'AHL'
  6623        CONTINUE
  6624     ELSE
  6625        IF PI-ERC-TYPE = 'B'
  6626           IF CLPSTL > ZERO
  6627              PERFORM 4700-CHECK-STATE       THRU 4799-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL652.cbl
  6628              IF CLPSTI = SPACES
  6629                 MOVE -1         TO  CLPSTL
  6630                 MOVE AL-UABON   TO  CLPSTA
  6631                 MOVE ER-0144    TO  EMI-ERROR
  6632                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6633              ELSE
  6634                 MOVE AL-UANON   TO  CLPSTA
  6635              END-IF
  6636           ELSE
  6637              IF ADD-FUNCTION
  6638                 MOVE -1         TO  CLPSTL
  6639                 MOVE AL-UABON   TO  CLPSTA
  6640                 MOVE ER-0144    TO  EMI-ERROR
  6641                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6642              END-IF
  6643           END-IF
  6644
  6645           IF MAXFEEL  > ZERO
  6646
  6647* EXEC CICS BIF
  6648*                  DEEDIT
  6649*                  FIELD   (MAXFEEI)
  6650*                  LENGTH  (6)
  6651*             END-EXEC
  6652     MOVE 6
  6653       TO DFHEIV11
  6654*    MOVE '@"L                   #   #00006174' TO DFHEIV0
  6655     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6656     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6657     MOVE X'2020233030303036313734' TO DFHEIV0(25:11)
  6658     CALL 'kxdfhei1' USING DFHEIV0,
  6659           MAXFEEI,
  6660           DFHEIV11
  6661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6662              IF MAXFEEI NUMERIC
  6663                 MOVE AL-UNNON   TO  MAXFEEA
  6664              ELSE
  6665                 MOVE -1         TO  MAXFEEL
  6666                 MOVE AL-UABON   TO  MAXFEEA
  6667                 MOVE ER-3261    TO  EMI-ERROR
  6668                 PERFORM 9900-ERROR-FORMAT
  6669                                 THRU  9900-EXIT
  6670              END-IF
  6671           ELSE
  6672              IF ADD-FUNCTION
  6673                 MOVE -1         TO  MAXFEEL
  6674                 MOVE AL-UABON   TO  MAXFEEA
  6675                 MOVE ER-3261    TO  EMI-ERROR
  6676                 PERFORM 9900-ERROR-FORMAT
  6677                                 THRU  9900-EXIT
  6678              END-IF
  6679           END-IF
  6680           IF MAXLFL  > ZERO
  6681
  6682* EXEC CICS BIF
  6683*                  DEEDIT
  6684*                  FIELD   (MAXLFI)
  6685*                  LENGTH  (6)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL652.cbl
  6686*             END-EXEC
  6687     MOVE 6
  6688       TO DFHEIV11
  6689*    MOVE '@"L                   #   #00006198' TO DFHEIV0
  6690     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6691     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6692     MOVE X'2020233030303036313938' TO DFHEIV0(25:11)
  6693     CALL 'kxdfhei1' USING DFHEIV0,
  6694           MAXLFI,
  6695           DFHEIV11
  6696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6697              IF MAXLFI NUMERIC
  6698                 MOVE AL-UNNON   TO  MAXLFA
  6699              ELSE
  6700                 MOVE -1         TO  MAXLFL
  6701                 MOVE AL-UABON   TO  MAXLFA
  6702                 MOVE ER-3261    TO  EMI-ERROR
  6703                 PERFORM 9900-ERROR-FORMAT
  6704                                 THRU  9900-EXIT
  6705              END-IF
  6706           ELSE
  6707              IF ADD-FUNCTION
  6708                 MOVE -1         TO  MAXLFL
  6709                 MOVE AL-UABON   TO  MAXLFA
  6710                 MOVE ER-3261    TO  EMI-ERROR
  6711                 PERFORM 9900-ERROR-FORMAT
  6712                                 THRU  9900-EXIT
  6713              END-IF
  6714           END-IF
  6715           IF REFEL > ZERO
  6716              IF REFEI = ' ' OR 'R' OR 'N' OR 'B'
  6717                 MOVE AL-UANON   TO REFEA
  6718              ELSE
  6719                 MOVE -1         TO REFEL
  6720                 MOVE AL-UABON   TO REFEA
  6721                 MOVE ER-2790    TO EMI-ERROR
  6722                 PERFORM 9900-ERROR-FORMAT
  6723                                 THRU  9900-EXIT
  6724              END-IF
  6725           END-IF
  6726        END-IF
  6727     END-IF
  6728
  6729     IF BALFWDL > ZERO
  6730
  6731* EXEC CICS BIF
  6732*            DEEDIT
  6733*            FIELD   (BALFWDI)
  6734*            LENGTH  (13)
  6735*        END-EXEC
  6736     MOVE 13
  6737       TO DFHEIV11
  6738*    MOVE '@"L                   #   #00006236' TO DFHEIV0
  6739     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6740     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6741     MOVE X'2020233030303036323336' TO DFHEIV0(25:11)
  6742     CALL 'kxdfhei1' USING DFHEIV0,
  6743           BALFWDI,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL652.cbl
  6744           DFHEIV11
  6745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6746         MOVE AL-UNNON           TO  BALFWDA
  6747         MOVE BALFWDI            TO  WS-SAVE-BALFWD.
  6748
  6749     IF CURCOML >        ZERO
  6750
  6751* EXEC CICS BIF
  6752*            DEEDIT
  6753*            FIELD   (CURCOMI)
  6754*            LENGTH  (13)
  6755*        END-EXEC
  6756     MOVE 13
  6757       TO DFHEIV11
  6758*    MOVE '@"L                   #   #00006245' TO DFHEIV0
  6759     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6760     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6761     MOVE X'2020233030303036323435' TO DFHEIV0(25:11)
  6762     CALL 'kxdfhei1' USING DFHEIV0,
  6763           CURCOMI,
  6764           DFHEIV11
  6765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6766         MOVE AL-UNNON           TO  CURCOMA
  6767         MOVE CURCOMI            TO  WS-SAVE-CURCOM.
  6768
  6769     IF CURCHGL > ZERO
  6770
  6771* EXEC CICS BIF
  6772*            DEEDIT
  6773*            FIELD   (CURCHGI)
  6774*            LENGTH  (13)
  6775*        END-EXEC
  6776     MOVE 13
  6777       TO DFHEIV11
  6778*    MOVE '@"L                   #   #00006254' TO DFHEIV0
  6779     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6780     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6781     MOVE X'2020233030303036323534' TO DFHEIV0(25:11)
  6782     CALL 'kxdfhei1' USING DFHEIV0,
  6783           CURCHGI,
  6784           DFHEIV11
  6785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6786         MOVE AL-UNNON           TO  CURCHGA
  6787         MOVE CURCHGI            TO  WS-SAVE-CURCHG.
  6788
  6789     IF CURPMTL > ZERO
  6790
  6791* EXEC CICS BIF
  6792*            DEEDIT
  6793*            FIELD   (CURPMTI)
  6794*            LENGTH  (13)
  6795*        END-EXEC
  6796     MOVE 13
  6797       TO DFHEIV11
  6798*    MOVE '@"L                   #   #00006263' TO DFHEIV0
  6799     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6800     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6801     MOVE X'2020233030303036323633' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL652.cbl
  6802     CALL 'kxdfhei1' USING DFHEIV0,
  6803           CURPMTI,
  6804           DFHEIV11
  6805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6806         MOVE AL-UNNON           TO  CURPMTA
  6807         MOVE CURPMTI            TO  WS-SAVE-CURPMT.
  6808
  6809     IF ENDBALL > ZERO
  6810
  6811* EXEC CICS BIF
  6812*            DEEDIT
  6813*            FIELD   (ENDBALI)
  6814*            LENGTH  (13)
  6815*        END-EXEC
  6816     MOVE 13
  6817       TO DFHEIV11
  6818*    MOVE '@"L                   #   #00006272' TO DFHEIV0
  6819     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6820     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6821     MOVE X'2020233030303036323732' TO DFHEIV0(25:11)
  6822     CALL 'kxdfhei1' USING DFHEIV0,
  6823           ENDBALI,
  6824           DFHEIV11
  6825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6826         MOVE AL-UNNON           TO  ENDBALA
  6827         MOVE ENDBALI            TO  WS-SAVE-ENDBAL.
  6828
  6829*    IF YTDCOML > ZERO
  6830*       EXEC CICS BIF
  6831*            DEEDIT
  6832*            FIELD   (YTDCOMI)
  6833*            LENGTH  (13)
  6834*       END-EXEC
  6835*       MOVE AL-UNNON            TO YTDCOMA
  6836*       MOVE YTDCOMI             TO WS-SAVE-YTDCOM
  6837*    END-IF
  6838     .
  6839 7000-EXIT.
  6840     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL652.cbl
  6842 7010-EDIT-CARBAL.
  6843     IF TYPEI = 'G' OR 'B'
  6844         IF CARBALI NOT = 'Y'
  6845             MOVE -1             TO  CARBALL
  6846             MOVE AL-UABON       TO  CARBALA
  6847             MOVE ER-2093        TO  EMI-ERROR
  6848             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6849             GO TO 7010-EXIT.
  6850
  6851     IF TYPEI = 'A'
  6852         IF FINRESPI = ACCTNOI
  6853             IF CARBALI NOT = 'Y'
  6854                 MOVE -1         TO  CARBALL
  6855                 MOVE AL-UABON   TO  CARBALA
  6856                 MOVE ER-2094    TO  EMI-ERROR
  6857                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6858                 GO TO 7010-EXIT.
  6859
  6860     IF PI-PROCESSOR-ID = 'E864'
  6861         NEXT SENTENCE
  6862     ELSE
  6863        IF TYPEI = 'A'
  6864           IF PI-AR-PROCESSING
  6865               IF FINRESPI NOT = ACCTNOI
  6866                    IF CARBALI = 'Y'
  6867                       MOVE -1             TO  CARBALL
  6868                       MOVE AL-UABON       TO  CARBALA
  6869                       MOVE ER-3174        TO  EMI-ERROR
  6870                       PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6871
  6872     IF TYPEI = 'C'
  6873         IF CARBALI NOT = 'N'
  6874             MOVE -1             TO  CARBALL
  6875             MOVE AL-UABON       TO  CARBALA
  6876             MOVE ER-2096        TO  EMI-ERROR
  6877             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6878             GO TO 7010-EXIT.
  6879
  6880     IF PI-PROCESSOR-ID = 'E864'
  6881         NEXT SENTENCE
  6882     ELSE
  6883        IF CHANGE-FUNCTION
  6884            IF PI-ERC-END-BAL NOT = ZERO
  6885                IF CARBALI = 'N'
  6886                    MOVE -1         TO  CARBALL
  6887                    MOVE AL-UABON   TO  CARBALA
  6888                    MOVE ER-2095    TO  EMI-ERROR
  6889                    PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6890                    GO TO 7010-EXIT.
  6891
  6892     MOVE AL-UANON               TO  CARBALA.
  6893
  6894 7010-EXIT.
  6895     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL652.cbl
  6897 7050-READ-ERCOMP.
  6898     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  6899
  6900
  6901* EXEC CICS READ
  6902*        DATASET  (COMP-FILE-ID)
  6903*        SET      (ADDRESS OF COMPENSATION-MASTER)
  6904*        RIDFLD   (PI-ERCOMP-KEY)
  6905*    END-EXEC.
  6906*    MOVE '&"S        E          (   #00006351' TO DFHEIV0
  6907     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6908     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6909     MOVE X'2020233030303036333531' TO DFHEIV0(25:11)
  6910     CALL 'kxdfhei1' USING DFHEIV0,
  6911           COMP-FILE-ID,
  6912           DFHEIV20,
  6913           DFHEIV99,
  6914           PI-ERCOMP-KEY,
  6915           DFHEIV99,
  6916           DFHEIV99,
  6917           DFHEIV99
  6918     SET ADDRESS OF COMPENSATION-MASTER TO
  6919         DFHEIV20
  6920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6921
  6922
  6923     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  6924
  6925 7050-EXIT.
  6926     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL652.cbl
  6928 7100-DEEDIT.
  6929
  6930* EXEC CICS BIF
  6931*        DEEDIT
  6932*        FIELD   (DEEDIT-FIELD)
  6933*        LENGTH  (15)
  6934*    END-EXEC.
  6935     MOVE 15
  6936       TO DFHEIV11
  6937*    MOVE '@"L                   #   #00006363' TO DFHEIV0
  6938     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6939     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6940     MOVE X'2020233030303036333633' TO DFHEIV0(25:11)
  6941     CALL 'kxdfhei1' USING DFHEIV0,
  6942           DEEDIT-FIELD,
  6943           DFHEIV11
  6944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6945
  6946
  6947 7100-EXIT.
  6948     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL652.cbl
  6950 7150-ERCOMP-GETMAIN.
  6951
  6952* EXEC CICS GETMAIN
  6953*        SET      (ADDRESS OF COMPENSATION-MASTER)
  6954*        LENGTH   (ERCOMP-LENGTH)
  6955*        INITIMG  (GETMAIN-SPACE)
  6956*    END-EXEC.
  6957*    MOVE ',"IL                  $   #00006373' TO DFHEIV0
  6958     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6959     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6960     MOVE X'2020233030303036333733' TO DFHEIV0(25:11)
  6961     CALL 'kxdfhei1' USING DFHEIV0,
  6962           DFHEIV20,
  6963           ERCOMP-LENGTH,
  6964           GETMAIN-SPACE
  6965     SET ADDRESS OF COMPENSATION-MASTER TO
  6966         DFHEIV20
  6967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6968
  6969
  6970 7150-EXIT.
  6971     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL652.cbl
  6973 7200-READ-ERCOMP-UPDATE.
  6974     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  6975
  6976
  6977* EXEC CICS READ
  6978*        DATASET  (COMP-FILE-ID)
  6979*        SET      (ADDRESS OF COMPENSATION-MASTER)
  6980*        RIDFLD   (PI-ERCOMP-KEY)
  6981*        UPDATE
  6982*    END-EXEC.
  6983*    MOVE '&"S        EU         (   #00006385' TO DFHEIV0
  6984     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6985     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6986     MOVE X'2020233030303036333835' TO DFHEIV0(25:11)
  6987     CALL 'kxdfhei1' USING DFHEIV0,
  6988           COMP-FILE-ID,
  6989           DFHEIV20,
  6990           DFHEIV99,
  6991           PI-ERCOMP-KEY,
  6992           DFHEIV99,
  6993           DFHEIV99,
  6994           DFHEIV99
  6995     SET ADDRESS OF COMPENSATION-MASTER TO
  6996         DFHEIV20
  6997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6998
  6999
  7000 7200-EXIT.
  7001     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL652.cbl
  7003 7250-PAGE-FORWARD.
  7004     MOVE SPACES                 TO  PI-ERCOMP-EOF-SW.
  7005
  7006     IF MAINTYPL > ZERO
  7007         MOVE GROUPI             TO  PI-ERC-GROUP
  7008         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7009         MOVE FINRESPI           TO  PI-ERC-RESP
  7010         MOVE ACCTNOI            TO  PI-ERC-ACCT
  7011         MOVE TYPEI              TO  PI-ERC-TYPE
  7012     ELSE
  7013         MOVE LOW-VALUES         TO  PI-ERCOMP-KEY
  7014         MOVE 'Y'                TO  PI-FIRST-TIME-SW.
  7015
  7016     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  7017     MOVE PI-ERCOMP-KEY          TO  WS-SAVE-KEY.
  7018
  7019
  7020* EXEC CICS HANDLE CONDITION
  7021*        ENDFILE  (7250-ENDFILE)
  7022*        NOTFND   (7250-ENDFILE)
  7023*        ERROR    (9990-ABEND)
  7024*    END-EXEC.
  7025*    MOVE '"$''I.                 ! - #00006411' TO DFHEIV0
  7026     MOVE X'222427492E20202020202020' TO DFHEIV0(1:12)
  7027     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7028     MOVE X'2D20233030303036343131' TO DFHEIV0(25:11)
  7029     CALL 'kxdfhei1' USING DFHEIV0
  7030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7031
  7032
  7033     PERFORM 7850-START-BROWSE  THRU  7850-EXIT.
  7034
  7035 7250-READ-NEXT.
  7036
  7037* EXEC CICS HANDLE CONDITION
  7038*        ENDFILE  (7250-ENDFILE)
  7039*        NOTFND   (7275-NOTFOUND)
  7040*    END-EXEC.
  7041*    MOVE '"$''I                  ! . #00006420' TO DFHEIV0
  7042     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7043     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7044     MOVE X'2E20233030303036343230' TO DFHEIV0(25:11)
  7045     CALL 'kxdfhei1' USING DFHEIV0
  7046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7047
  7048
  7049     PERFORM 7900-READNEXT  THRU  7900-EXIT.
  7050
  7051     IF PI-CARRIER-SECURITY > SPACES
  7052         IF PI-ERC-CARRIER = PI-CARRIER-SECURITY
  7053             NEXT SENTENCE
  7054         ELSE
  7055             GO TO 7250-READ-NEXT.
  7056
  7057     IF ERCOMP-EOF
  7058         IF FIRST-TIME
  7059             MOVE LOW-VALUES     TO  EL652AO
  7060             MOVE ER-0584        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL652.cbl
  7061             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7062             GO TO 8100-SEND-INITIAL-MAP
  7063         ELSE
  7064             MOVE LOW-VALUES     TO  EL652AO
  7065             MOVE ER-2067        TO  EMI-ERROR
  7066             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7067             PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  7068             GO TO 7250-PAGE-FORWARD.
  7069
  7070     IF PI-ERCOMP-KEY = WS-SAVE-KEY
  7071         GO TO 7250-READ-NEXT.
  7072
  7073     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  7074     MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  7075     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  7076     MOVE LOW-VALUES             TO  EL652AO.
  7077     MOVE CO-CARRIER             TO  CARRIERO.
  7078     MOVE CO-GROUPING            TO  GROUPO.
  7079     MOVE CO-RESP-NO             TO  FINRESPO.
  7080     MOVE CO-ACCOUNT             TO  ACCTNOO.
  7081     MOVE CO-TYPE                TO  TYPEO.
  7082     MOVE AL-UANON               TO  CARRIERA
  7083                                     GROUPA
  7084                                     TYPEA
  7085                                     FINRESPA
  7086                                     ACCTNOA
  7087                                     MAINTYPA.
  7088     MOVE 'S'                    TO  MAINTYPO
  7089                                     PI-CHECK-MAINT-TYPE.
  7090
  7091     GO TO 5050-SET-UP-SCREEN.
  7092
  7093 7250-ENDFILE.
  7094     IF FIRST-TIME
  7095         MOVE LOW-VALUES         TO  EL652AO
  7096         MOVE ER-0584            TO  EMI-ERROR
  7097         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7098         GO TO 8100-SEND-INITIAL-MAP.
  7099
  7100     IF BROWSE-STARTED
  7101         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7102
  7103     MOVE ER-2067                TO  EMI-ERROR.
  7104     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7105
  7106     MOVE LOW-VALUES             TO  EL652AO.
  7107
  7108     GO TO 7250-PAGE-FORWARD.
  7109
  7110 7275-NOTFOUND.
  7111     IF BROWSE-STARTED
  7112         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7113
  7114     GO TO 8880-NOT-FOUND.
  7115
  7116 7299-EXIT.
  7117     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL652.cbl
  7119 7300-PAGE-BACKWARD.
  7120     MOVE SPACES                 TO  PI-ERCOMP-EOF-SW.
  7121
  7122     IF MAINTYPL > ZERO
  7123         MOVE GROUPI             TO  PI-ERC-GROUP
  7124         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7125         MOVE FINRESPI           TO  PI-ERC-RESP
  7126         MOVE ACCTNOI            TO  PI-ERC-ACCT
  7127         MOVE TYPEI              TO  PI-ERC-TYPE
  7128     ELSE
  7129         MOVE LOW-VALUES         TO  PI-ERCOMP-KEY.
  7130
  7131     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  7132
  7133
  7134* EXEC CICS HANDLE CONDITION
  7135*        ENDFILE  (7375-ENDFILE)
  7136*        NOTFND   (7375-ENDFILE)
  7137*        ERROR    (9990-ABEND)
  7138*    END-EXEC.
  7139*    MOVE '"$''I.                 ! / #00006509' TO DFHEIV0
  7140     MOVE X'222427492E20202020202020' TO DFHEIV0(1:12)
  7141     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7142     MOVE X'2F20233030303036353039' TO DFHEIV0(25:11)
  7143     CALL 'kxdfhei1' USING DFHEIV0
  7144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7145
  7146
  7147     PERFORM 7850-START-BROWSE  THRU  7850-EXIT.
  7148
  7149     PERFORM 8050-READPREV  THRU  8050-EXIT.
  7150
  7151 7350-READ-PREV.
  7152
  7153* EXEC CICS HANDLE CONDITION
  7154*        ENDFILE  (7375-ENDFILE)
  7155*        NOTFND   (7275-NOTFOUND)
  7156*    END-EXEC.
  7157*    MOVE '"$''I                  ! 0 #00006520' TO DFHEIV0
  7158     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7160     MOVE X'3020233030303036353230' TO DFHEIV0(25:11)
  7161     CALL 'kxdfhei1' USING DFHEIV0
  7162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7163
  7164
  7165     PERFORM 8050-READPREV  THRU  8050-EXIT.
  7166
  7167     IF PI-CARRIER-SECURITY > SPACES
  7168         IF PI-ERC-CARRIER = PI-CARRIER-SECURITY
  7169             NEXT SENTENCE
  7170         ELSE
  7171             GO TO 7350-READ-PREV.
  7172
  7173     IF PI-COMPANY-CD NOT = CO-COMPANY-CD
  7174         GO TO 7375-ENDFILE.
  7175
  7176     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL652.cbl
  7177     MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  7178     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  7179     MOVE LOW-VALUES             TO  EL652AO.
  7180     MOVE CO-CARRIER             TO  CARRIERO.
  7181     MOVE CO-GROUPING            TO  GROUPO.
  7182     MOVE CO-RESP-NO             TO  FINRESPO.
  7183     MOVE CO-ACCOUNT             TO  ACCTNOO.
  7184     MOVE CO-TYPE                TO  TYPEO.
  7185     MOVE AL-UANON               TO  CARRIERA
  7186                                     GROUPA
  7187                                     TYPEA
  7188                                     FINRESPA
  7189                                     ACCTNOA
  7190                                     MAINTYPA.
  7191     MOVE 'S'                    TO  MAINTYPO
  7192                                     PI-CHECK-MAINT-TYPE.
  7193
  7194     GO TO 5050-SET-UP-SCREEN.
  7195
  7196 7375-ENDFILE.
  7197     IF BROWSE-STARTED
  7198         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7199
  7200     MOVE ER-2238                TO  EMI-ERROR.
  7201     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7202
  7203     MOVE -1                     TO  MAINTYPL.
  7204
  7205     GO TO 8200-SEND-DATAONLY.
  7206
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL652.cbl
  7208 7400-READ-CONTROL-FILE.
  7209     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7210     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  7211
  7212
  7213* EXEC CICS HANDLE CONDITION
  7214*        NOTFND  (7490-NOT-FOUND)
  7215*        ERROR   (9990-ABEND)
  7216*    END-EXEC.
  7217*    MOVE '"$I.                  ! 1 #00006572' TO DFHEIV0
  7218     MOVE X'2224492E2020202020202020' TO DFHEIV0(1:12)
  7219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7220     MOVE X'3120233030303036353732' TO DFHEIV0(25:11)
  7221     CALL 'kxdfhei1' USING DFHEIV0
  7222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7223
  7224
  7225
  7226* EXEC CICS READ
  7227*        DATASET  (CNTL-FILE-ID)
  7228*        SET      (ADDRESS OF CONTROL-FILE)
  7229*        RIDFLD   (ELCNTL-KEY)
  7230*    END-EXEC.
  7231*    MOVE '&"S        E          (   #00006577' TO DFHEIV0
  7232     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7234     MOVE X'2020233030303036353737' TO DFHEIV0(25:11)
  7235     CALL 'kxdfhei1' USING DFHEIV0,
  7236           CNTL-FILE-ID,
  7237           DFHEIV20,
  7238           DFHEIV99,
  7239           ELCNTL-KEY,
  7240           DFHEIV99,
  7241           DFHEIV99,
  7242           DFHEIV99
  7243     SET ADDRESS OF CONTROL-FILE TO
  7244         DFHEIV20
  7245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7246
  7247
  7248     IF CNTL-REC-TYPE = '6'
  7249         MOVE AL-UANON           TO  CARRIERA
  7250         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7251         GO TO 7499-EXIT.
  7252
  7253     IF CF-COMPENSATION-MSTR-MAINT-DT NOT = LOW-VALUES
  7254         GO TO 7499-EXIT
  7255     ELSE
  7256         MOVE -1                 TO  MAINTYPL
  7257         MOVE ER-2572            TO  EMI-ERROR
  7258         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7259         GO TO 7499-EXIT.
  7260
  7261 7490-NOT-FOUND.
  7262     IF CNTL-REC-TYPE = '6'
  7263         MOVE -1                 TO  CARRIERL
  7264         MOVE AL-UABON           TO  CARRIERA
  7265         MOVE ER-0193            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL652.cbl
  7266     ELSE
  7267         IF CNTL-REC-TYPE = '2'
  7268             MOVE -1                TO  CSRL
  7269             MOVE AL-UABON          TO  CSRA
  7270             MOVE ER-1883           TO  EMI-ERROR
  7271         ELSE
  7272            MOVE ER-0002            TO  EMI-ERROR
  7273            MOVE -1                 TO  PFKEYL.
  7274
  7275     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7276
  7277 7499-EXIT.
  7278     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL652.cbl
  7280
  7281 7500-UPDATE-SUMM.
  7282
  7283     PERFORM 7700-ERSUMM-GETMAIN  THRU  7700-EXIT.
  7284
  7285     MOVE 'SX'                   TO SX-RECORD-ID.
  7286     MOVE PI-COMPANY-CD          TO SX-COMPANY-CD.
  7287     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY.
  7288     MOVE PI-ERC-CARRIER         TO SX-CARRIER.
  7289     MOVE PI-ERC-GROUP           TO SX-GROUP.
  7290     MOVE PI-ERC-RESP            TO SX-FIN-RESP.
  7291     MOVE PI-ERC-ACCT            TO SX-ACCT-AGENT.
  7292     MOVE WS-SAVE-NAME           TO SX-SUMM-OR-AGT-NAME.
  7293     MOVE PI-PROCESSOR-ID        TO SX-LAST-MAINT-BY.
  7294     MOVE EIBTIME                TO SX-LAST-MAINT-HHMMSS.
  7295     MOVE BIN-CURRENT-SAVE       TO SX-LAST-MAINT-DT.
  7296     MOVE PI-COMPANY-CD          TO SX-COMPANY-A1.
  7297     MOVE PI-ERC-ACCT            TO SX-ACCT-AGENT-A1.
  7298     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY-A1.
  7299     MOVE PI-ERC-CARRIER         TO SX-CARR-A1.
  7300     MOVE PI-ERC-GROUP           TO SX-GROUP-A1.
  7301     MOVE PI-ERC-RESP            TO SX-FIN-RESP-A1.
  7302
  7303
  7304* EXEC CICS HANDLE CONDITION
  7305*        DUPREC  (7550-DUP)
  7306*    END-EXEC.
  7307*    MOVE '"$%                   ! 2 #00006638' TO DFHEIV0
  7308     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7310     MOVE X'3220233030303036363338' TO DFHEIV0(25:11)
  7311     CALL 'kxdfhei1' USING DFHEIV0
  7312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7313
  7314
  7315
  7316* EXEC CICS WRITE
  7317*        DATASET  (SUMM-FILE-ID)
  7318*        FROM     (SUMM-CROSS-REFERENCE)
  7319*        RIDFLD   (SX-CONTROL-PRIMARY)
  7320*    END-EXEC.
  7321     MOVE LENGTH OF
  7322      SUMM-CROSS-REFERENCE
  7323       TO DFHEIV11
  7324*    MOVE '&$ L                  ''   #00006642' TO DFHEIV0
  7325     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7326     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7327     MOVE X'2020233030303036363432' TO DFHEIV0(25:11)
  7328     CALL 'kxdfhei1' USING DFHEIV0,
  7329           SUMM-FILE-ID,
  7330           SUMM-CROSS-REFERENCE,
  7331           DFHEIV11,
  7332           SX-CONTROL-PRIMARY,
  7333           DFHEIV99,
  7334           DFHEIV99
  7335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7336
  7337
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL652.cbl
  7338     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7339     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7340     MOVE PI-AR-SUMMARY-CODE     TO SUMM-SUMMARY.
  7341
  7342
  7343* EXEC CICS HANDLE CONDITION
  7344*        NOTFND  (7540-WRITE)
  7345*    END-EXEC.
  7346*    MOVE '"$I                   ! 3 #00006652' TO DFHEIV0
  7347     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7348     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7349     MOVE X'3320233030303036363532' TO DFHEIV0(25:11)
  7350     CALL 'kxdfhei1' USING DFHEIV0
  7351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7352
  7353
  7354
  7355* EXEC CICS READ
  7356*        DATASET  (SUMM-FILE-ID)
  7357*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7358*        RIDFLD   (ERSUMM-KEY)
  7359*    END-EXEC.
  7360*    MOVE '&"S        E          (   #00006656' TO DFHEIV0
  7361     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7362     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7363     MOVE X'2020233030303036363536' TO DFHEIV0(25:11)
  7364     CALL 'kxdfhei1' USING DFHEIV0,
  7365           SUMM-FILE-ID,
  7366           DFHEIV20,
  7367           DFHEIV99,
  7368           ERSUMM-KEY,
  7369           DFHEIV99,
  7370           DFHEIV99,
  7371           DFHEIV99
  7372     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7373         DFHEIV20
  7374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7375
  7376     GO TO 7599-EXIT.
  7377
  7378 7540-WRITE.
  7379
  7380     MOVE ERSUMM-KEY             TO SX-CONTROL-PRIMARY.
  7381     MOVE LOW-VALUES             TO SX-CONTROL-A1.
  7382     MOVE PI-COMPANY-CD          TO SX-COMPANY-A1.
  7383     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY-A1.
  7384     MOVE SPACES                 TO SX-SUMM-OR-AGT-NAME.
  7385     MOVE 'LGXX'                 TO SX-LAST-MAINT-BY.
  7386
  7387
  7388* EXEC CICS WRITE
  7389*        DATASET  (SUMM-FILE-ID)
  7390*        FROM     (SUMM-CROSS-REFERENCE)
  7391*        RIDFLD   (SX-CONTROL-PRIMARY)
  7392*    END-EXEC.
  7393     MOVE LENGTH OF
  7394      SUMM-CROSS-REFERENCE
  7395       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL652.cbl
  7396*    MOVE '&$ L                  ''   #00006672' TO DFHEIV0
  7397     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7398     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7399     MOVE X'2020233030303036363732' TO DFHEIV0(25:11)
  7400     CALL 'kxdfhei1' USING DFHEIV0,
  7401           SUMM-FILE-ID,
  7402           SUMM-CROSS-REFERENCE,
  7403           DFHEIV11,
  7404           SX-CONTROL-PRIMARY,
  7405           DFHEIV99,
  7406           DFHEIV99
  7407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7408
  7409
  7410     MOVE PI-ERC-CARRIER         TO PI-CR-CARRIER.
  7411     MOVE PI-ERC-GROUP           TO PI-CR-GROUPING.
  7412     MOVE PI-ERC-TYPE            TO PI-CR-TYPE.
  7413     MOVE PI-ERC-RESP            TO PI-CR-FIN-RESP.
  7414     MOVE PI-ERC-ACCT            TO PI-CR-ACCOUNT.
  7415
  7416     MOVE XCTL-856               TO PGM-NAME.
  7417     GO TO 9300-XCTL.
  7418
  7419 7550-DUP.
  7420
  7421     MOVE ER-3152                TO EMI-ERROR.
  7422     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7423
  7424     MOVE -1                     TO MAINTYPL.
  7425
  7426     GO TO 8200-SEND-DATAONLY.
  7427
  7428 7599-EXIT.
  7429     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL652.cbl
  7431
  7432 7600-DELETE-SUMM.
  7433
  7434     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7435     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7436     MOVE PI-ERC-CARRIER         TO SUMM-CARRIER.
  7437     MOVE PI-ERC-GROUP           TO SUMM-GROUP.
  7438     MOVE PI-ERC-RESP            TO SUMM-FIN-RESP.
  7439     MOVE PI-ERC-ACCT            TO SUMM-ACCT-AGENT.
  7440
  7441 7620-READ-ERSUMM.
  7442
  7443* EXEC CICS HANDLE CONDITION
  7444*        NOTFND  (7699-EXIT)
  7445*    END-EXEC.
  7446*    MOVE '"$I                   ! 4 #00006710' TO DFHEIV0
  7447     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7449     MOVE X'3420233030303036373130' TO DFHEIV0(25:11)
  7450     CALL 'kxdfhei1' USING DFHEIV0
  7451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7452
  7453
  7454
  7455* EXEC CICS READ
  7456*        DATASET  (SUMM-FILE-ID)
  7457*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7458*        RIDFLD   (ERSUMM-KEY)
  7459*        UPDATE
  7460*    END-EXEC.
  7461*    MOVE '&"S        EU         (   #00006714' TO DFHEIV0
  7462     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7463     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7464     MOVE X'2020233030303036373134' TO DFHEIV0(25:11)
  7465     CALL 'kxdfhei1' USING DFHEIV0,
  7466           SUMM-FILE-ID,
  7467           DFHEIV20,
  7468           DFHEIV99,
  7469           ERSUMM-KEY,
  7470           DFHEIV99,
  7471           DFHEIV99,
  7472           DFHEIV99
  7473     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7474         DFHEIV20
  7475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7476
  7477
  7478
  7479* EXEC CICS DELETE
  7480*        DATASET  (SUMM-FILE-ID)
  7481*    END-EXEC.
  7482*    MOVE '&(                    &   #00006721' TO DFHEIV0
  7483     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7484     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7485     MOVE X'2020233030303036373231' TO DFHEIV0(25:11)
  7486     CALL 'kxdfhei1' USING DFHEIV0,
  7487           SUMM-FILE-ID,
  7488           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL652.cbl
  7489           DFHEIV99,
  7490           DFHEIV99,
  7491           DFHEIV99
  7492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7493
  7494
  7495     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7496     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7497     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7498
  7499
  7500* EXEC CICS STARTBR
  7501*        DATASET  (SUMM-FILE-ID)
  7502*        RIDFLD   (ERSUMM-KEY)
  7503*    END-EXEC.
  7504     MOVE 0
  7505       TO DFHEIV11
  7506*    MOVE '&,         G          &   #00006729' TO DFHEIV0
  7507     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7508     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7509     MOVE X'2020233030303036373239' TO DFHEIV0(25:11)
  7510     CALL 'kxdfhei1' USING DFHEIV0,
  7511           SUMM-FILE-ID,
  7512           ERSUMM-KEY,
  7513           DFHEIV99,
  7514           DFHEIV11,
  7515           DFHEIV99
  7516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7517
  7518
  7519
  7520* EXEC CICS READNEXT
  7521*        DATASET  (SUMM-FILE-ID)
  7522*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7523*        RIDFLD   (ERSUMM-KEY)
  7524*    END-EXEC.
  7525     MOVE 0
  7526       TO DFHEIV11
  7527*    MOVE '&.S                   )   #00006734' TO DFHEIV0
  7528     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7529     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7530     MOVE X'2020233030303036373334' TO DFHEIV0(25:11)
  7531     CALL 'kxdfhei1' USING DFHEIV0,
  7532           SUMM-FILE-ID,
  7533           DFHEIV20,
  7534           DFHEIV99,
  7535           ERSUMM-KEY,
  7536           DFHEIV99,
  7537           DFHEIV11,
  7538           DFHEIV99,
  7539           DFHEIV99
  7540     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7541         DFHEIV20
  7542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7543
  7544
  7545     IF SX-CARRIER = LOW-VALUES
  7546         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL652.cbl
  7547     ELSE
  7548         GO TO 7640-END-BROWSE.
  7549
  7550
  7551* EXEC CICS HANDLE CONDITION
  7552*        ENDFILE  (7630-DELETE)
  7553*    END-EXEC.
  7554*    MOVE '"$''                   ! 5 #00006745' TO DFHEIV0
  7555     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7557     MOVE X'3520233030303036373435' TO DFHEIV0(25:11)
  7558     CALL 'kxdfhei1' USING DFHEIV0
  7559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7560
  7561
  7562
  7563* EXEC CICS READNEXT
  7564*        DATASET  (SUMM-FILE-ID)
  7565*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7566*        RIDFLD   (ERSUMM-KEY)
  7567*    END-EXEC.
  7568     MOVE 0
  7569       TO DFHEIV11
  7570*    MOVE '&.S                   )   #00006749' TO DFHEIV0
  7571     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7572     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7573     MOVE X'2020233030303036373439' TO DFHEIV0(25:11)
  7574     CALL 'kxdfhei1' USING DFHEIV0,
  7575           SUMM-FILE-ID,
  7576           DFHEIV20,
  7577           DFHEIV99,
  7578           ERSUMM-KEY,
  7579           DFHEIV99,
  7580           DFHEIV11,
  7581           DFHEIV99,
  7582           DFHEIV99
  7583     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7584         DFHEIV20
  7585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7586
  7587
  7588     IF SX-SUMMARY = WS-SAVE-SUMM
  7589         GO TO 7640-END-BROWSE.
  7590
  7591 7630-DELETE.
  7592
  7593* EXEC CICS ENDBR
  7594*        DATASET  (SUMM-FILE-ID)
  7595*    END-EXEC.
  7596     MOVE 0
  7597       TO DFHEIV11
  7598*    MOVE '&2                    $   #00006759' TO DFHEIV0
  7599     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7600     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7601     MOVE X'2020233030303036373539' TO DFHEIV0(25:11)
  7602     CALL 'kxdfhei1' USING DFHEIV0,
  7603           SUMM-FILE-ID,
  7604           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL652.cbl
  7605           DFHEIV99
  7606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7607
  7608
  7609     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7610     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7611     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7612
  7613
  7614* EXEC CICS READ
  7615*        DATASET  (SUMM-FILE-ID)
  7616*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7617*        RIDFLD   (ERSUMM-KEY)
  7618*        UPDATE
  7619*    END-EXEC.
  7620*    MOVE '&"S        EU         (   #00006767' TO DFHEIV0
  7621     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7622     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7623     MOVE X'2020233030303036373637' TO DFHEIV0(25:11)
  7624     CALL 'kxdfhei1' USING DFHEIV0,
  7625           SUMM-FILE-ID,
  7626           DFHEIV20,
  7627           DFHEIV99,
  7628           ERSUMM-KEY,
  7629           DFHEIV99,
  7630           DFHEIV99,
  7631           DFHEIV99
  7632     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7633         DFHEIV20
  7634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7635
  7636
  7637
  7638* EXEC CICS DELETE
  7639*        DATASET  (SUMM-FILE-ID)
  7640*    END-EXEC.
  7641*    MOVE '&(                    &   #00006774' TO DFHEIV0
  7642     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7643     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7644     MOVE X'2020233030303036373734' TO DFHEIV0(25:11)
  7645     CALL 'kxdfhei1' USING DFHEIV0,
  7646           SUMM-FILE-ID,
  7647           DFHEIV99,
  7648           DFHEIV99,
  7649           DFHEIV99,
  7650           DFHEIV99
  7651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7652
  7653
  7654     GO TO 7699-EXIT.
  7655
  7656 7640-END-BROWSE.
  7657
  7658* EXEC CICS ENDBR
  7659*        DATASET  (SUMM-FILE-ID)
  7660*    END-EXEC.
  7661     MOVE 0
  7662       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL652.cbl
  7663*    MOVE '&2                    $   #00006781' TO DFHEIV0
  7664     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7665     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7666     MOVE X'2020233030303036373831' TO DFHEIV0(25:11)
  7667     CALL 'kxdfhei1' USING DFHEIV0,
  7668           SUMM-FILE-ID,
  7669           DFHEIV11,
  7670           DFHEIV99
  7671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7672
  7673
  7674 7699-EXIT.
  7675     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL652.cbl
  7677
  7678 7700-ERSUMM-GETMAIN.
  7679
  7680* EXEC CICS GETMAIN
  7681*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7682*        LENGTH   (ERSUMM-LENGTH)
  7683*        INITIMG  (GETMAIN-SPACE)
  7684*    END-EXEC.
  7685*    MOVE ',"IL                  $   #00006790' TO DFHEIV0
  7686     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7687     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7688     MOVE X'2020233030303036373930' TO DFHEIV0(25:11)
  7689     CALL 'kxdfhei1' USING DFHEIV0,
  7690           DFHEIV20,
  7691           ERSUMM-LENGTH,
  7692           GETMAIN-SPACE
  7693     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7694         DFHEIV20
  7695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7696
  7697
  7698 7700-EXIT.
  7699     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL652.cbl
  7701
  7702 7850-START-BROWSE.
  7703
  7704* EXEC CICS STARTBR
  7705*        DATASET  (COMP-FILE-ID)
  7706*        RIDFLD   (PI-ERCOMP-KEY)
  7707*    END-EXEC.
  7708     MOVE 0
  7709       TO DFHEIV11
  7710*    MOVE '&,         G          &   #00006801' TO DFHEIV0
  7711     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7712     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7713     MOVE X'2020233030303036383031' TO DFHEIV0(25:11)
  7714     CALL 'kxdfhei1' USING DFHEIV0,
  7715           COMP-FILE-ID,
  7716           PI-ERCOMP-KEY,
  7717           DFHEIV99,
  7718           DFHEIV11,
  7719           DFHEIV99
  7720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7721
  7722
  7723     MOVE 'Y'                    TO  WS-BROWSE-SW.
  7724
  7725 7850-EXIT.
  7726     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL652.cbl
  7728 7900-READNEXT.
  7729
  7730* EXEC CICS READNEXT
  7731*        DATASET  (COMP-FILE-ID)
  7732*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7733*        RIDFLD   (PI-ERCOMP-KEY)
  7734*    END-EXEC.
  7735     MOVE 0
  7736       TO DFHEIV11
  7737*    MOVE '&.S                   )   #00006812' TO DFHEIV0
  7738     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7739     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7740     MOVE X'2020233030303036383132' TO DFHEIV0(25:11)
  7741     CALL 'kxdfhei1' USING DFHEIV0,
  7742           COMP-FILE-ID,
  7743           DFHEIV20,
  7744           DFHEIV99,
  7745           PI-ERCOMP-KEY,
  7746           DFHEIV99,
  7747           DFHEIV11,
  7748           DFHEIV99,
  7749           DFHEIV99
  7750     SET ADDRESS OF COMPENSATION-MASTER TO
  7751         DFHEIV20
  7752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7753
  7754
  7755     IF PI-COMPANY-CD NOT = CO-COMPANY-CD
  7756         MOVE 'Y'                TO  PI-ERCOMP-EOF-SW
  7757     ELSE
  7758         MOVE SPACE              TO  PI-FIRST-TIME-SW.
  7759
  7760 7900-EXIT.
  7761     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL652.cbl
  7763 7950-END-BROWSE.
  7764
  7765* EXEC CICS ENDBR
  7766*        DATASET  (COMP-FILE-ID)
  7767*    END-EXEC.
  7768     MOVE 0
  7769       TO DFHEIV11
  7770*    MOVE '&2                    $   #00006827' TO DFHEIV0
  7771     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7772     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7773     MOVE X'2020233030303036383237' TO DFHEIV0(25:11)
  7774     CALL 'kxdfhei1' USING DFHEIV0,
  7775           COMP-FILE-ID,
  7776           DFHEIV11,
  7777           DFHEIV99
  7778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7779
  7780
  7781     MOVE 'N'                    TO  WS-BROWSE-SW.
  7782
  7783 7950-EXIT.
  7784     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL652.cbl
  7786 8000-UPDATE-MAINT-DATE.
  7787     MOVE SPACES                 TO  ELCNTL-KEY.
  7788     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7789     MOVE '1'                    TO  CNTL-REC-TYPE.
  7790     MOVE +0                     TO  CNTL-SEQ-NO.
  7791
  7792
  7793* EXEC CICS HANDLE CONDITION
  7794*        NOTFND  (8000-EXIT)
  7795*    END-EXEC.
  7796*    MOVE '"$I                   ! 6 #00006842' TO DFHEIV0
  7797     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7798     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7799     MOVE X'3620233030303036383432' TO DFHEIV0(25:11)
  7800     CALL 'kxdfhei1' USING DFHEIV0
  7801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7802
  7803
  7804
  7805* EXEC CICS READ
  7806*        UPDATE
  7807*        DATASET  (CNTL-FILE-ID)
  7808*        SET      (ADDRESS OF CONTROL-FILE)
  7809*        RIDFLD   (ELCNTL-KEY)
  7810*    END-EXEC.
  7811*    MOVE '&"S        EU         (   #00006846' TO DFHEIV0
  7812     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7813     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7814     MOVE X'2020233030303036383436' TO DFHEIV0(25:11)
  7815     CALL 'kxdfhei1' USING DFHEIV0,
  7816           CNTL-FILE-ID,
  7817           DFHEIV20,
  7818           DFHEIV99,
  7819           ELCNTL-KEY,
  7820           DFHEIV99,
  7821           DFHEIV99,
  7822           DFHEIV99
  7823     SET ADDRESS OF CONTROL-FILE TO
  7824         DFHEIV20
  7825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7826
  7827
  7828     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  7829     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7830     MOVE CNTL-FILE-ID           TO  FILE-ID.
  7831
  7832     PERFORM 8400-LOG-JOURNAL-RECORD.
  7833
  7834     MOVE BIN-CURRENT-SAVE  TO  CF-COMPENSATION-MSTR-MAINT-DT.
  7835     MOVE CONTROL-FILE      TO  JP-RECORD-AREA.
  7836     MOVE 'C'               TO  JP-RECORD-TYPE.
  7837     MOVE CNTL-FILE-ID      TO  FILE-ID.
  7838
  7839
  7840* EXEC CICS REWRITE
  7841*        DATASET  (CNTL-FILE-ID)
  7842*        FROM     (CONTROL-FILE)
  7843*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL652.cbl
  7844     MOVE LENGTH OF
  7845      CONTROL-FILE
  7846       TO DFHEIV11
  7847*    MOVE '&& L                  %   #00006864' TO DFHEIV0
  7848     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7849     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7850     MOVE X'2020233030303036383634' TO DFHEIV0(25:11)
  7851     CALL 'kxdfhei1' USING DFHEIV0,
  7852           CNTL-FILE-ID,
  7853           CONTROL-FILE,
  7854           DFHEIV11,
  7855           DFHEIV99
  7856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7857
  7858
  7859     PERFORM 8400-LOG-JOURNAL-RECORD.
  7860
  7861 8000-EXIT.
  7862      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL652.cbl
  7864 8050-READPREV.
  7865
  7866* EXEC CICS READPREV
  7867*        DATASET  (COMP-FILE-ID)
  7868*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7869*        RIDFLD   (PI-ERCOMP-KEY)
  7870*    END-EXEC.
  7871     MOVE 0
  7872       TO DFHEIV11
  7873*    MOVE '&0S                   )   #00006875' TO DFHEIV0
  7874     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7875     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7876     MOVE X'2020233030303036383735' TO DFHEIV0(25:11)
  7877     CALL 'kxdfhei1' USING DFHEIV0,
  7878           COMP-FILE-ID,
  7879           DFHEIV20,
  7880           DFHEIV99,
  7881           PI-ERCOMP-KEY,
  7882           DFHEIV99,
  7883           DFHEIV11,
  7884           DFHEIV99,
  7885           DFHEIV99
  7886     SET ADDRESS OF COMPENSATION-MASTER TO
  7887         DFHEIV20
  7888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7889
  7890
  7891 8050-EXIT.
  7892     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL652.cbl
  7894 8100-SEND-INITIAL-MAP.
  7895
  7896     IF  NOT CREDIT-SESSION
  7897         MOVE AL-SADOF           TO PFK5A
  7898                                    PFK6A.
  7899
  7900     IF PI-COMPANY-ID NOT = 'NCL'
  7901         MOVE AL-SANOF           TO  LETRCDA
  7902         MOVE AL-SADOF           TO  LETDESCA.
  7903
  7904     IF PI-COMPANY-ID  NOT = 'DDB' AND 'ANT' AND 'ASL' AND
  7905                             'AN1' AND 'TFS'
  7906         MOVE AL-SANOF           TO  BALCDA
  7907         MOVE AL-SADOF           TO  BALPRTA.
  7908
  7909     IF PI-COMPANY-ID   = 'NCL'
  7910        IF TYPEI =  'G' OR 'B'
  7911           MOVE AL-UNNOF         TO  RPTCD2A
  7912           MOVE AL-SANOF         TO  RPTCDDA.
  7913
  7914     IF PI-COMPANY-ID = 'DCC'
  7915        IF TYPEI = 'A'
  7916           MOVE AL-SANOF         TO SPPDDHA
  7917           MOVE AL-UANON         TO SPPDDA
  7918        END-IF
  7919     END-IF
  7920     MOVE AL-SANON               TO  FLITYPA.
  7921
  7922     IF EIBTRNID NOT = TRANS-ID
  7923        IF PI-AR-PROCESSING
  7924             MOVE AL-SANOF       TO  SCDESCA
  7925                                     NGDESCA
  7926*                                    BALDESCA
  7927                                     CKDESCA
  7928             MOVE AL-UANON       TO  SUMMNOA
  7929                                     NETGRSA
  7930*                                    ARBALA
  7931                                     CKPULLA.
  7932
  7933     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  7934         MOVE AL-UANOF           TO  LSTMDTA
  7935         MOVE AL-SANOF           TO  PFK9A
  7936     ELSE
  7937         IF PI-AR-PROCESSING
  7938             MOVE AL-SANOF       TO  PFK9A
  7939         ELSE
  7940             MOVE AL-SANOF       TO  LSTMDTA
  7941             MOVE AL-SADOF       TO  PFK9A.
  7942
  7943*    IF (PI-ERC-TYPE NOT = 'G' AND SPACE)
  7944*       OR (PI-COMPANY-ID NOT = 'DCC')
  7945     IF PI-ERC-TYPE = 'A'
  7946        MOVE AL-SANOF            TO PCONTA
  7947     END-IF
  7948     IF PI-ERC-TYPE NOT = 'B' AND SPACE
  7949         MOVE AL-SADOF           TO  PFK10A
  7950                                     PFK13A
  7951         MOVE AL-SADOF           TO  CSLABLA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL652.cbl
  7952         MOVE AL-SADOF           TO  CLPSTA
  7953         MOVE AL-SADOF           TO  MFLABLA
  7954         MOVE AL-SADOF           TO  MAXFEEA
  7955         MOVE AL-SADOF           TO  LFLABLA
  7956         MOVE AL-SADOF           TO  MAXLFA
  7957         MOVE AL-SADOF           TO  REFEHA
  7958                                     REFEA
  7959     END-IF
  7960     if pi-company-id = 'AHL'
  7961        move al-sanof            to ahl120a
  7962                                    over120a
  7963     end-if
  7964     MOVE SAVE-DATE              TO  RUNDATEO.
  7965     MOVE EIBTIME                TO  TIME-IN.
  7966     MOVE TIME-OUT               TO  RUNTIMEO.
  7967     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  7968     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  7969     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  7970     MOVE -1                     TO  MAINTYPL.
  7971
  7972
  7973* EXEC CICS SEND
  7974*        MAP     (MAP-NAME)
  7975*        MAPSET  (MAPSET-NAME)
  7976*        FROM    (EL652AO)
  7977*        ERASE
  7978*        CURSOR
  7979*    END-EXEC.
  7980     MOVE LENGTH OF
  7981      EL652AO
  7982       TO DFHEIV12
  7983     MOVE -1
  7984       TO DFHEIV11
  7985*    MOVE '8$     CT  E    H L F ,   #00006962' TO DFHEIV0
  7986     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  7987     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7988     MOVE X'2020233030303036393632' TO DFHEIV0(25:11)
  7989     CALL 'kxdfhei1' USING DFHEIV0,
  7990           MAP-NAME,
  7991           EL652AO,
  7992           DFHEIV12,
  7993           MAPSET-NAME,
  7994           DFHEIV99,
  7995           DFHEIV99,
  7996           DFHEIV99,
  7997           DFHEIV11,
  7998           DFHEIV99,
  7999           DFHEIV99,
  8000           DFHEIV99
  8001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8002
  8003
  8004     GO TO 9100-RETURN-TRAN.
  8005
  8006 8200-SEND-DATAONLY.
  8007
  8008     IF  NOT CREDIT-SESSION
  8009         MOVE AL-SADOF           TO PFK5A
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL652.cbl
  8010                                    PFK6A.
  8011
  8012     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  8013         MOVE AL-UANOF           TO  LSTMDTA
  8014         MOVE AL-SANOF           TO  PFK9A
  8015     ELSE
  8016         IF PI-AR-PROCESSING
  8017             MOVE AL-SANOF       TO  PFK9A
  8018         ELSE
  8019             MOVE AL-SANOF       TO  LSTMDTA
  8020             MOVE AL-SADOF       TO  PFK9A.
  8021     IF PI-ERC-TYPE = 'A'
  8022        MOVE AL-SANOF            TO PCONTA
  8023     END-IF
  8024
  8025     IF PI-COMPANY-ID = 'DCC'
  8026        IF TYPEI = 'A'
  8027           MOVE AL-SANOF         TO SPPDDHA
  8028           MOVE AL-UANON         TO SPPDDA
  8029        END-IF
  8030     END-IF
  8031*    IF (PI-ERC-TYPE NOT = 'G')
  8032*       OR (PI-COMPANY-ID NOT = 'DCC')
  8033     IF PI-ERC-TYPE NOT = 'B'
  8034         MOVE AL-SADOF           TO  PFK10A
  8035                                     PFK13A
  8036         MOVE AL-SADOF           TO  CSLABLA
  8037         MOVE AL-SADOF           TO  CLPSTA
  8038         MOVE AL-SADOF           TO  MFLABLA
  8039         MOVE AL-SADOF           TO  MAXFEEA
  8040         MOVE AL-SADOF           TO  LFLABLA
  8041         MOVE AL-SADOF           TO  MAXLFA
  8042     END-IF.
  8043
  8044     MOVE SAVE-DATE              TO  RUNDATEO.
  8045     MOVE EIBTIME                TO  TIME-IN.
  8046     MOVE TIME-OUT               TO  RUNTIMEO.
  8047     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  8048     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  8049     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  8050
  8051
  8052* EXEC CICS SEND
  8053*        MAP     (MAP-NAME)
  8054*        MAPSET  (MAPSET-NAME)
  8055*        FROM    (EL652AO)
  8056*        DATAONLY
  8057*        CURSOR
  8058*    END-EXEC.
  8059     MOVE LENGTH OF
  8060      EL652AO
  8061       TO DFHEIV12
  8062     MOVE -1
  8063       TO DFHEIV11
  8064*    MOVE '8$D    CT       H L F ,   #00007017' TO DFHEIV0
  8065     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  8066     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8067     MOVE X'2020233030303037303137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL652.cbl
  8068     CALL 'kxdfhei1' USING DFHEIV0,
  8069           MAP-NAME,
  8070           EL652AO,
  8071           DFHEIV12,
  8072           MAPSET-NAME,
  8073           DFHEIV99,
  8074           DFHEIV99,
  8075           DFHEIV99,
  8076           DFHEIV11,
  8077           DFHEIV99,
  8078           DFHEIV99,
  8079           DFHEIV99
  8080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8081
  8082
  8083     GO TO 9100-RETURN-TRAN.
  8084
  8085 8300-SEND-TEXT.
  8086
  8087* EXEC CICS SEND TEXT
  8088*        FROM    (LOGOFF-TEXT)
  8089*        LENGTH  (LOGOFF-LENGTH)
  8090*        ERASE
  8091*        FREEKB
  8092*    END-EXEC.
  8093*    MOVE '8&      T  E F  H   F -   #00007028' TO DFHEIV0
  8094     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8095     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8096     MOVE X'2020233030303037303238' TO DFHEIV0(25:11)
  8097     CALL 'kxdfhei1' USING DFHEIV0,
  8098           LOGOFF-TEXT,
  8099           LOGOFF-LENGTH,
  8100           DFHEIV99,
  8101           DFHEIV99,
  8102           DFHEIV99,
  8103           DFHEIV99,
  8104           DFHEIV99,
  8105           DFHEIV99,
  8106           DFHEIV99,
  8107           DFHEIV99,
  8108           DFHEIV99,
  8109           DFHEIV99
  8110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8111
  8112
  8113
  8114* EXEC CICS RETURN
  8115*    END-EXEC.
  8116*    MOVE '.(                    &   #00007035' TO DFHEIV0
  8117     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8118     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8119     MOVE X'2020233030303037303335' TO DFHEIV0(25:11)
  8120     CALL 'kxdfhei1' USING DFHEIV0,
  8121           DFHEIV99,
  8122           DFHEIV99,
  8123           DFHEIV99,
  8124           DFHEIV99,
  8125           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL652.cbl
  8126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8127
  8128
  8129 8400-LOG-JOURNAL-RECORD.
  8130     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  8131     MOVE FILE-ID                TO  JP-FILE-ID.
  8132     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  8133
  8134*    EXEC CICS JOURNAL
  8135*        JFILEID  (PI-JOURNAL-FILE-ID)
  8136*        JTYPEID  ('EL')
  8137*        FROM     (JOURNAL-RECORD)
  8138*        LENGTH   (473)
  8139*    END-EXEC.
  8140
  8141 8800-UNAUTHORIZED-ACCESS.
  8142     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  8143
  8144     GO TO 8300-SEND-TEXT.
  8145
  8146 8810-PF23.
  8147     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  8148     MOVE XCTL-005               TO  PGM-NAME.
  8149
  8150     GO TO 9300-XCTL.
  8151
  8152 8880-NOT-FOUND.
  8153     MOVE ER-0142                TO  EMI-ERROR.
  8154     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8155
  8156     MOVE SPACE                  TO  PI-ERC-TYPE.
  8157     MOVE -1                     TO  MAINTYPL.
  8158
  8159     IF EIBTRNID NOT = TRANS-ID
  8160         GO TO 8100-SEND-INITIAL-MAP.
  8161
  8162     GO TO 8200-SEND-DATAONLY.
  8163
  8164 9100-RETURN-TRAN.
  8165     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  8166     MOVE '652A'                 TO  PI-CURRENT-SCREEN-NO.
  8167
  8168
  8169* EXEC CICS RETURN
  8170*        TRANSID   (TRANS-ID)
  8171*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8172*        LENGTH    (PI-COMM-LENGTH)
  8173*    END-EXEC.
  8174*    MOVE '.(CT                  &   #00007077' TO DFHEIV0
  8175     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8176     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8177     MOVE X'2020233030303037303737' TO DFHEIV0(25:11)
  8178     CALL 'kxdfhei1' USING DFHEIV0,
  8179           TRANS-ID,
  8180           PROGRAM-INTERFACE-BLOCK,
  8181           PI-COMM-LENGTH,
  8182           DFHEIV99,
  8183           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL652.cbl
  8184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8185
  8186
  8187 9200-RETURN-MAIN-MENU.
  8188
  8189     IF  MORTGAGE-SESSION
  8190         MOVE XCTL-EM626         TO PGM-NAME
  8191     ELSE
  8192         IF  CREDIT-SESSION
  8193             MOVE XCTL-626       TO PGM-NAME
  8194         ELSE
  8195             MOVE XCTL-126       TO PGM-NAME.
  8196
  8197     GO TO 9300-XCTL.
  8198
  8199 9300-XCTL.
  8200
  8201* EXEC CICS XCTL
  8202*        PROGRAM   (PGM-NAME)
  8203*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8204*        LENGTH    (PI-COMM-LENGTH)
  8205*    END-EXEC.
  8206*    MOVE '.$C                   $   #00007096' TO DFHEIV0
  8207     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8208     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8209     MOVE X'2020233030303037303936' TO DFHEIV0(25:11)
  8210     CALL 'kxdfhei1' USING DFHEIV0,
  8211           PGM-NAME,
  8212           PROGRAM-INTERFACE-BLOCK,
  8213           PI-COMM-LENGTH
  8214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8215
  8216
  8217 9400-CLEAR.
  8218     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  8219
  8220     GO TO 9300-XCTL.
  8221
  8222 9500-PF12.
  8223     MOVE XCTL-010               TO  PGM-NAME.
  8224
  8225     GO TO 9300-XCTL.
  8226
  8227 9600-PGMID-ERROR.
  8228
  8229* EXEC CICS HANDLE CONDITION
  8230*        PGMIDERR  (8300-SEND-TEXT)
  8231*    END-EXEC.
  8232*    MOVE '"$L                   ! 7 #00007113' TO DFHEIV0
  8233     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8234     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8235     MOVE X'3720233030303037313133' TO DFHEIV0(25:11)
  8236     CALL 'kxdfhei1' USING DFHEIV0
  8237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8238
  8239
  8240     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  8241     MOVE ' '                    TO  PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL652.cbl
  8242     MOVE XCTL-005               TO  PGM-NAME.
  8243     MOVE PGM-NAME               TO  LOGOFF-PGM.
  8244     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  8245
  8246     GO TO 9300-XCTL.
  8247
  8248 9700-LINK-DATE-CONVERT.
  8249
  8250* EXEC CICS LINK
  8251*        PROGRAM   ('ELDATCV')
  8252*        COMMAREA  (DATE-CONVERSION-DATA)
  8253*        LENGTH    (DC-COMM-LENGTH)
  8254*    END-EXEC.
  8255     MOVE 'ELDATCV' TO DFHEIV1
  8256*    MOVE '."C                   ''   #00007126' TO DFHEIV0
  8257     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8258     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8259     MOVE X'2020233030303037313236' TO DFHEIV0(25:11)
  8260     CALL 'kxdfhei1' USING DFHEIV0,
  8261           DFHEIV1,
  8262           DATE-CONVERSION-DATA,
  8263           DC-COMM-LENGTH,
  8264           DFHEIV99,
  8265           DFHEIV99,
  8266           DFHEIV99
  8267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8268
  8269
  8270 9700-EXIT.
  8271     EXIT.
  8272
  8273 9900-ERROR-FORMAT.
  8274     IF NOT EMI-ERRORS-COMPLETE
  8275         MOVE LINK-001           TO  PGM-NAME
  8276
  8277* EXEC CICS LINK
  8278*            PROGRAM   (PGM-NAME)
  8279*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  8280*            LENGTH    (EMI-COMM-LENGTH)
  8281*        END-EXEC.
  8282*    MOVE '."C                   ''   #00007138' TO DFHEIV0
  8283     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8284     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8285     MOVE X'2020233030303037313338' TO DFHEIV0(25:11)
  8286     CALL 'kxdfhei1' USING DFHEIV0,
  8287           PGM-NAME,
  8288           ERROR-MESSAGE-INTERFACE-BLOCK,
  8289           EMI-COMM-LENGTH,
  8290           DFHEIV99,
  8291           DFHEIV99,
  8292           DFHEIV99
  8293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8294
  8295
  8296 9900-EXIT.
  8297     EXIT.
  8298
  8299 9910-INITIALIZE-SECURITY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL652.cbl
  8300******************************************************************
  8301*                                                                *
  8302*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  8303*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  8304*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  8305*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  8306*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  8307*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  8308*                                                                *
  8309******************************************************************
  8310
  8311     IF  PI-PROCESSOR-ID NOT = 'LGXX'
  8312
  8313         IF  MORTGAGE-SESSION
  8314             MOVE '125E'             TO SC-QUID-SYSTEM
  8315             MOVE EIBTRMID           TO SC-QUID-TERMINAL
  8316
  8317
  8318* EXEC CICS READQ TS
  8319*                QUEUE  (SC-QUID-KEY)
  8320*                INTO   (SECURITY-CONTROL-E)
  8321*                LENGTH (SC-COMM-LENGTH-E)
  8322*                ITEM   (SC-ITEM)
  8323*            END-EXEC
  8324*    MOVE '*$II   L              ''   #00007165' TO DFHEIV0
  8325     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8326     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8327     MOVE X'2020233030303037313635' TO DFHEIV0(25:11)
  8328     CALL 'kxdfhei1' USING DFHEIV0,
  8329           SC-QUID-KEY,
  8330           SECURITY-CONTROL-E,
  8331           SC-COMM-LENGTH-E,
  8332           SC-ITEM,
  8333           DFHEIV99,
  8334           DFHEIV99
  8335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8336
  8337             MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  8338                                     TO PI-DISPLAY-CAP
  8339             MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  8340                                     TO PI-MODIFY-CAP
  8341
  8342             IF  NOT DISPLAY-CAP
  8343                 MOVE 'READ'         TO SM-READ
  8344                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8345                 MOVE ER-9097        TO EMI-ERROR
  8346                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8347                 GO TO 8100-SEND-INITIAL-MAP
  8348             ELSE
  8349                 GO TO 9910-EXIT
  8350         ELSE
  8351
  8352* EXEC CICS  READQ TS
  8353*                QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8354*                INTO    (SECURITY-CONTROL)
  8355*                LENGTH  (SC-COMM-LENGTH)
  8356*                ITEM    (SC-ITEM-CL-CR)
  8357*                END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL652.cbl
  8358*    MOVE '*$II   L              ''   #00007186' TO DFHEIV0
  8359     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8360     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8361     MOVE X'2020233030303037313836' TO DFHEIV0(25:11)
  8362     CALL 'kxdfhei1' USING DFHEIV0,
  8363           PI-SECURITY-TEMP-STORE-ID,
  8364           SECURITY-CONTROL,
  8365           SC-COMM-LENGTH,
  8366           SC-ITEM-CL-CR,
  8367           DFHEIV99,
  8368           DFHEIV99
  8369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8370
  8371             MOVE SC-CREDIT-DISPLAY (05)
  8372                                 TO PI-DISPLAY-CAP
  8373             MOVE SC-CREDIT-UPDATE  (05)
  8374                                 TO PI-MODIFY-CAP
  8375
  8376             IF  NOT DISPLAY-CAP
  8377                 MOVE 'READ'     TO SM-READ
  8378                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8379                 MOVE ER-0070    TO  EMI-ERROR
  8380                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8381                 GO TO 8100-SEND-INITIAL-MAP.
  8382
  8383 9910-EXIT.
  8384     EXIT.
  8385
  8386 9990-ABEND.
  8387     MOVE LINK-004               TO  PGM-NAME.
  8388     MOVE DFHEIBLK               TO  EMI-LINE1.
  8389
  8390
  8391* EXEC CICS LINK
  8392*        PROGRAM   (PGM-NAME)
  8393*        COMMAREA  (EMI-LINE1)
  8394*        LENGTH    (72)
  8395*    END-EXEC.
  8396     MOVE 72
  8397       TO DFHEIV11
  8398*    MOVE '."C                   ''   #00007212' TO DFHEIV0
  8399     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8400     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8401     MOVE X'2020233030303037323132' TO DFHEIV0(25:11)
  8402     CALL 'kxdfhei1' USING DFHEIV0,
  8403           PGM-NAME,
  8404           EMI-LINE1,
  8405           DFHEIV11,
  8406           DFHEIV99,
  8407           DFHEIV99,
  8408           DFHEIV99
  8409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8410
  8411
  8412     GO TO 8200-SEND-DATAONLY.
  8413
  8414 9995-SECURITY-VIOLATION.
  8415*           COPY ELCSCTP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL652.cbl
  8416******************************************************************
  8417*                                                                *
  8418*                            ELCSCTP                             *
  8419*                            VMOD=2.001                          *
  8420*                                                                *
  8421*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8422******************************************************************
  8423
  8424
  8425     MOVE EIBDATE          TO SM-JUL-DATE.
  8426     MOVE EIBTRMID         TO SM-TERMID.
  8427     MOVE THIS-PGM         TO SM-PGM.
  8428     MOVE EIBTIME          TO TIME-IN.
  8429     MOVE TIME-OUT         TO SM-TIME.
  8430     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8431
  8432
  8433* EXEC CICS LINK
  8434*         PROGRAM  ('EL003')
  8435*         COMMAREA (SECURITY-MESSAGE)
  8436*         LENGTH   (80)
  8437*    END-EXEC.
  8438     MOVE 'EL003' TO DFHEIV1
  8439     MOVE 80
  8440       TO DFHEIV11
  8441*    MOVE '."C                   ''   #00007238' TO DFHEIV0
  8442     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8443     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8444     MOVE X'2020233030303037323338' TO DFHEIV0(25:11)
  8445     CALL 'kxdfhei1' USING DFHEIV0,
  8446           DFHEIV1,
  8447           SECURITY-MESSAGE,
  8448           DFHEIV11,
  8449           DFHEIV99,
  8450           DFHEIV99,
  8451           DFHEIV99
  8452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8453
  8454
  8455******************************************************************
  8456
  8457 9995-EXIT.
  8458      EXIT.
  8459
  8460 9999-DFHBACK SECTION.
  8461     MOVE '9%                    "   ' TO DFHEIV0
  8462     MOVE 'EL652' TO DFHEIV1
  8463     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8464     GOBACK.
  8465 9999-DFHEXIT.
  8466     IF DFHEIGDJ EQUAL 0001
  8467         NEXT SENTENCE
  8468     ELSE IF DFHEIGDJ EQUAL 2
  8469         GO TO 9990-ABEND,
  8470               8880-NOT-FOUND,
  8471               9600-PGMID-ERROR,
  8472               9990-ABEND
  8473         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL652.cbl
  8474     ELSE IF DFHEIGDJ EQUAL 3
  8475         GO TO 3400-EXIT
  8476         DEPENDING ON DFHEIGDI
  8477     ELSE IF DFHEIGDJ EQUAL 4
  8478         GO TO 3450-EXIT
  8479         DEPENDING ON DFHEIGDI
  8480     ELSE IF DFHEIGDJ EQUAL 5
  8481         GO TO 9990-ABEND,
  8482               8880-NOT-FOUND,
  8483               9600-PGMID-ERROR,
  8484               9990-ABEND
  8485         DEPENDING ON DFHEIGDI
  8486     ELSE IF DFHEIGDJ EQUAL 6
  8487         GO TO 3475-EXIT
  8488         DEPENDING ON DFHEIGDI
  8489     ELSE IF DFHEIGDJ EQUAL 7
  8490         GO TO 9990-ABEND,
  8491               4250-CONT
  8492         DEPENDING ON DFHEIGDI
  8493     ELSE IF DFHEIGDJ EQUAL 8
  8494         GO TO 4300-EXIT
  8495         DEPENDING ON DFHEIGDI
  8496     ELSE IF DFHEIGDJ EQUAL 9
  8497         GO TO 4750-NO-STATE
  8498         DEPENDING ON DFHEIGDI
  8499     ELSE IF DFHEIGDJ EQUAL 10
  8500         GO TO 6550-END-BROWSE,
  8501               6550-END-BROWSE
  8502         DEPENDING ON DFHEIGDI
  8503     ELSE IF DFHEIGDJ EQUAL 11
  8504         GO TO 6550-END-BROWSE,
  8505               6550-END-BROWSE
  8506         DEPENDING ON DFHEIGDI
  8507     ELSE IF DFHEIGDJ EQUAL 12
  8508         GO TO 6599-EXIT,
  8509               6599-EXIT
  8510         DEPENDING ON DFHEIGDI
  8511     ELSE IF DFHEIGDJ EQUAL 13
  8512         GO TO 7250-ENDFILE,
  8513               7250-ENDFILE,
  8514               9990-ABEND
  8515         DEPENDING ON DFHEIGDI
  8516     ELSE IF DFHEIGDJ EQUAL 14
  8517         GO TO 7250-ENDFILE,
  8518               7275-NOTFOUND
  8519         DEPENDING ON DFHEIGDI
  8520     ELSE IF DFHEIGDJ EQUAL 15
  8521         GO TO 7375-ENDFILE,
  8522               7375-ENDFILE,
  8523               9990-ABEND
  8524         DEPENDING ON DFHEIGDI
  8525     ELSE IF DFHEIGDJ EQUAL 16
  8526         GO TO 7375-ENDFILE,
  8527               7275-NOTFOUND
  8528         DEPENDING ON DFHEIGDI
  8529     ELSE IF DFHEIGDJ EQUAL 17
  8530         GO TO 7490-NOT-FOUND,
  8531               9990-ABEND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL652.cbl
  8532         DEPENDING ON DFHEIGDI
  8533     ELSE IF DFHEIGDJ EQUAL 18
  8534         GO TO 7550-DUP
  8535         DEPENDING ON DFHEIGDI
  8536     ELSE IF DFHEIGDJ EQUAL 19
  8537         GO TO 7540-WRITE
  8538         DEPENDING ON DFHEIGDI
  8539     ELSE IF DFHEIGDJ EQUAL 20
  8540         GO TO 7699-EXIT
  8541         DEPENDING ON DFHEIGDI
  8542     ELSE IF DFHEIGDJ EQUAL 21
  8543         GO TO 7630-DELETE
  8544         DEPENDING ON DFHEIGDI
  8545     ELSE IF DFHEIGDJ EQUAL 22
  8546         GO TO 8000-EXIT
  8547         DEPENDING ON DFHEIGDI
  8548     ELSE IF DFHEIGDJ EQUAL 23
  8549         GO TO 8300-SEND-TEXT
  8550         DEPENDING ON DFHEIGDI.
  8551     MOVE '9%                    "   ' TO DFHEIV0
  8552     MOVE 'EL652' TO DFHEIV1
  8553     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8554     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6268     Code:       25459
