* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46******************************************************************
    47 ENVIRONMENT DIVISION.
    48
    49 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   3
* EL050.cbl
    51 WORKING-STORAGE SECTION.
    52 01  DFH-START PIC X(04).
    53
    54 77  FILLER   PIC X(32) VALUE '********************************'.
    55 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    56 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    57
    58 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    59 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    60                                   USAGE POINTER.
    61 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    62 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    63 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    64                                   USAGE IS POINTER.
    65 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    67                                   USAGE IS POINTER.
    68 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    69 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    70                                   USAGE IS POINTER.
    71
    72 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    73 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    74                                   USAGE IS POINTER.
    75
    76*    COPY ELC50WS.
    77*****************************************************************
    78*                                                               *
    79*                            ELC50WS.                           *
    80*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    81*                            VMOD=2.061.                        *
    82*                                                               *
    83*   THIS IS THE WORKING STORAGE FOR EL050                       *
    84*                                   EL517                       *
    85*****************************************************************
    86******************************************************************
    87*                   C H A N G E   L O G
    88*
    89* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    90*-----------------------------------------------------------------
    91*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    92* EFFECTIVE    NUMBER
    93*-----------------------------------------------------------------
    94* 123102                   PEMA  ADD DCC PROCESSING
    95* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    96* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    97* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    98* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    99* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   100* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   101* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   102* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   103* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   104* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   105* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   106* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   107* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   108* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   4
* EL050.cbl
   109* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   110* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   111* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   112* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   113* 030309  CR2009021700001  PEMA  ADD ER-2883
   114* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   115* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   116* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   117* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   118* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   119* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   120* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   121* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   122* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   123* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   124* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   125* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   126* 061412  CR2011022800001  AJRA  NAPERSOFT
   127* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   128* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   129* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   130* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   131* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   132*-----------------------------------------------------------------
   133
   134 01  WORK-AREAS.
   135
   136*****************************************************************
   137*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   138*****************************************************************
   139
   140     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   141     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   142     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   143     12  WS-NAME-EDIT-WORK-AREA.
   144         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   145         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   146             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   147         16  WS-WORK-NAME.
   148             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   149             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   150             20  FILLER           PIC X(10)     VALUE SPACES.
   151         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   152             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   153
   154*****************************************************************
   155*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   156*****************************************************************
   157
   158     12  WS-ERRESC-KEY.
   159         16 WS-ERRESC-SEARCH-KEY.
   160             20  WS-ERRESC-COMPANY-CD PIC  X.
   161             20  WS-ERRESC-CARRIER    PIC  X.
   162             20  WS-ERRESC-GROUP      PIC X(6).
   163             20  WS-ERRESC-STATE      PIC XX.
   164             20  WS-ERRESC-ACCOUNT    PIC X(10).
   165         16 WS-ERRESC-RESIDUAL-KEY.
   166             20  WS-ERRESC-AGENT      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   5
* EL050.cbl
   167             20  WS-ERRESC-RES-STATE  PIC XX.
   168             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   169*                                          YYYYMMDD
   170     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   171     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   172
   173*RESIDENT STATE TAX MASTER(ERRESS)
   174*
   175     12  WS-ERRESS-KEY.
   176         16  WS-ERRESS-COMPANY-CD      PIC  X.
   177         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   178         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   179         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   180*                                          YYYYMMDD
   181
   182     12  WS-CONTRACT-DATE              PIC 9(8).
   183*                                          YYYYMMDD
   184     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   185     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   186         16 WS-YEAR-YY                 PIC   9999.
   187         16 FILLER                     PIC 9(4).
   188*                                          YYYYMMDD
   189     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   190     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   191     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   192     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   193
   194     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   195         88  DPRB-1ST-TIME                      VALUE ' '.
   196
   197*****************************************************************
   198*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   199*****************************************************************
   200
   201     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   202     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   203     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   204     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   205     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   206     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   207     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   208     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   209     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   210     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   211         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   212         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   213     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   214         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   215         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   216     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   217
   218     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   219     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   220
   221     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   222     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   6
* EL050.cbl
   225     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   227     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   228     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   231     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   232     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   233     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   234     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   235     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   236     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   249     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   253     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   254     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   255     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   256     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   257     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   258     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   259     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   260     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   261     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   262     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   264     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   265     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   266     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   267     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   268     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   269     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   270     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   271     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   272     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   273     12  WS-2671-SW               PIC X         VALUE SPACE.
   274     12  WS-2672-SW               PIC X         VALUE SPACE.
   275     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   276         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   277     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   278         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   279     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   280
   281     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   282         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   7
* EL050.cbl
   283         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   284         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   285         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   286
   287     12  WS-CREDIT-EDIT-CONTROLS.
   288         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   289         16  WS-MIN-AGE           PIC 99                VALUE  0.
   290         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   291         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   292         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   293         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   294
   295     12  WS-AGE-FIELDS.
   296         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   297         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   298         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   299         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   300
   301     12  WS-SAVE-ALLOWABLE-BENEFIT.
   302         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   303         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   304         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   305         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   306         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   307         16  FILLER                      PIC XX.
   308
   309     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   310     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   311     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   312     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   313     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   314     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   315     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   316     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   317     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   318     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   319
   320     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   321     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   322     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   323     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   324     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   325     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   326     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   327     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   328         88  WS-REDUCING              VALUE 'R'.
   329         88  WS-LEVEL                 VALUE 'L' 'P'.
   330     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   331
   332     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   333     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   334     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   335     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   336     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   337     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   338     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   339     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   340     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   8
* EL050.cbl
   341
   342     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   343     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   344     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   345     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   346     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   347     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   348     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   349     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   350     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   351     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   352     12  WS-ACCT-SIG-SW.
   353         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   354         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   355     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   356     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   357     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   358     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   359     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   360     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   361     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   362     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   363     12  WS-INITIALS.
   364         16  WS-INIT-1            PIC X         VALUE SPACES.
   365         16  WS-INIT-2            PIC X         VALUE SPACES.
   366
   367     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   368     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   369     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   370     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   371     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   372*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   373     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   374     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   375     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   376     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   377     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   378     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   379     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   380     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   381     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   382     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   383     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   384     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   385     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   386     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   387     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   388     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   389     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   390     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   391     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   392     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   393     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   394     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   395******** FLA
   396     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   397     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   398     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page   9
* EL050.cbl
   399     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   400     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   401********
   402     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   403     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   404     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   405     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   406     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   407     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   408     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   409     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   410     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   411     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   412
   413     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   414         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   415                                         '0' THRU '9'.
   416
   417     12  NUMBER-OF-MONTHS.
   418         16  SK-MO OCCURS 12 TIMES PIC X.
   419
   420     12  WS-WORK-DATE.
   421         16  WS-YEAR            PIC 99    VALUE 00.
   422         16  WS-MONTH           PIC 99    VALUE 00.
   423         16  WS-DAY             PIC 99    VALUE 00.
   424
   425     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   426     12  WS-WORK-CRIT-DEV       REDEFINES
   427         WS-WORK-LF-CRIT-PER    PIC X(03).
   428
   429     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   430     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   431
   432     12  WS-WORK-DATE-FROM.
   433         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   434         16  FILLER             PIC X  VALUE SPACE.
   435         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   436         16  FILLER             PIC X         VALUE SPACE.
   437         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   438
   439     12  WS-WORK-DATE-THRU.
   440         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   441         16  FILLER             PIC X         VALUE SPACE.
   442         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   443         16  FILLER             PIC X         VALUE SPACE.
   444         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   445
   446     12  WS-LF-INPUT-CD.
   447         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   448         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   449
   450     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   451     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   452         16  WS-AH-INPUT-CD-1   PIC X.
   453         16  WS-AH-INPUT-CD-2-3 PIC XX.
   454
   455     12  WS-SWITCHES.
   456         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  10
* EL050.cbl
   457         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   458             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   459         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   460             88  BANK-ACCT-FOUND          VALUE 'Y'.
   461         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   462             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   463         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   464             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   465         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   466             88  COMP-MASTER-FOUND        VALUE 'Y'.
   467         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   468             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   469         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   470             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   471         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   472             88  STAT-MASTER-FOUND        VALUE 'Y'.
   473         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   474             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   475         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   476             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   477         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   478             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   479         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   480             88  FORM-MASTER-FOUND        VALUE 'Y'.
   481         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   482             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   483         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   484             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   485         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   486             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   487         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   488             88  NO-BENEFIT-FOUND         VALUE 'N'.
   489         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   490             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   491         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   492             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   493         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   494             88  AH-BENEFIT-FOUND         VALUE ' '.
   495             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   496         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   497             88  LF-BENEFIT-FOUND         VALUE ' '.
   498             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   499         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   500             88  NO-STATE-RECORD          VALUE '1'.
   501         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   502             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   503         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   504             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   505         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   506             88  CERT-WAS-FOUND           VALUE ' '.
   507             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   508         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   509             88  BROWSE-STARTED           VALUE 'Y'.
   510         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   511             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   512         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   513             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   514         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  11
* EL050.cbl
   515             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   516         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   517             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   518         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   519             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   520         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   521             88  APP-CERT-USED            VALUE 'Y' 'A'.
   522         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   523             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   524             88  FIRST-TIME-THROUGH       VALUE '1'.
   525             88  CTBL-NOT-FOUND           VALUE '2'.
   526
   527         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   528             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   529
   530         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   531             88  DLO-ERROR-FOUND          VALUE 'Y'.
   532
   533********FLA
   534     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   535     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   536********
   537     12  RC-SW-1                  PIC X           VALUE '0'.
   538     12  RC-SW-2                  PIC X           VALUE '0'.
   539     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   540     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   541     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   542     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   543     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   544     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   545     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   546     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   547     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   548     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   549     12  LIT-SPACES               PIC X           VALUE SPACES.
   550     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   551     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   552     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   553     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   554     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   555     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   556     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   557         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   558         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   559     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   560         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   561
   562 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   563     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   564     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   565 01  WS-CRI-SSN-WORK-AREA.
   566     05  WS-CRI-SOC-SEC-NO.
   567         10  WS-SS-REPT-CD       PIC X(5).
   568         10  WS-SS-LAST-NAME     PIC X(5).
   569         10  WS-SS-INITIAL       PIC X.
   570
   571     05  WS-CRI-REPORT-CODE.
   572         10  FILLER              PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  12
* EL050.cbl
   573         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   574
   575     05  WS-CRI-LAST-NAME.
   576         10  WS-CRI-NAME-MOVE    PIC X(5).
   577         10  FILLER              PIC X(10).
   578
   579 01  WS-NUM-TABLE                PIC X(26)  VALUE
   580     '12345678012345070923456789'.
   581 01  FILLER REDEFINES WS-NUM-TABLE.
   582     05  WS-NUM OCCURS 26        PIC 9.
   583 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   584 01  V1                          PIC S999 COMP-3.
   585 01  V2                          PIC S999 COMP-3.
   586 01  V3                          PIC S999 COMP-3.
   587 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   588 01  FILLER REDEFINES WS-WORK-VIN.
   589     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   590 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   591 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   592 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   593 01  WS-HEX-WORK.
   594     05  FILLER                  PIC X  VALUE LOW-VALUES.
   595     05  WS-HEX-BYTE             PIC X.
   596 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   597 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   598 01  WS-WORK-HIN-ROW-B.
   599     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   600
   601 01  ws-benefit-cd-chg-sw      pic x value spaces.
   602     88  benefit-code-chg           value 'Y'.
   603 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   604 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   605     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   606 01  WS-ROW-D-TABLE.
   607     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   608
   609 01  WS-HIN-TABLE-B.
   610     05  F                       PIC XX VALUE 'A2'.
   611     05  F                       PIC XX VALUE 'B3'.
   612     05  F                       PIC XX VALUE 'C4'.
   613     05  F                       PIC XX VALUE 'D5'.
   614     05  F                       PIC XX VALUE 'E6'.
   615     05  F                       PIC XX VALUE 'F7'.
   616     05  F                       PIC XX VALUE 'G8'.
   617     05  F                       PIC XX VALUE 'H9'.
   618     05  F                       PIC XX VALUE 'I1'.
   619     05  F                       PIC XX VALUE 'J2'.
   620     05  F                       PIC XX VALUE 'K3'.
   621     05  F                       PIC XX VALUE 'L4'.
   622     05  F                       PIC XX VALUE 'M5'.
   623     05  F                       PIC XX VALUE 'N6'.
   624     05  F                       PIC XX VALUE 'O0'.
   625     05  F                       PIC XX VALUE 'P7'.
   626     05  F                       PIC XX VALUE 'Q0'.
   627     05  F                       PIC XX VALUE 'R8'.
   628     05  F                       PIC XX VALUE 'S9'.
   629     05  F                       PIC XX VALUE 'T2'.
   630     05  F                       PIC XX VALUE 'U3'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  13
* EL050.cbl
   631     05  F                       PIC XX VALUE 'V4'.
   632     05  F                       PIC XX VALUE 'W5'.
   633     05  F                       PIC XX VALUE 'X6'.
   634     05  F                       PIC XX VALUE 'Y7'.
   635     05  F                       PIC XX VALUE 'Z8'.
   636 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   637     05  WS-VAL-IN               PIC X.
   638     05  WS-VAL-OUT              PIC 9.
   639 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   640 01  WS-COMPARE-BINARY-DATES.
   641     05  WS-971231                PIC XX VALUE X'92FF'.
   642     05  WS-931231                PIC XX VALUE X'8CFF'.
   643     05  WS-791231                PIC XX VALUE X'77FF'.
   644     05  WS-771001                PIC XX VALUE X'74A1'.
   645     05  WS-820301                PIC XX VALUE X'7B41'.
   646     05  WS-831031                PIC XX VALUE X'7DBF'.
   647     05  WS-831231                PIC XX VALUE X'7DFF'.
   648     05  WS-810831                PIC XX VALUE X'7A7F'.
   649     05  WS-830901                PIC XX VALUE X'7D81'.
   650
   651 01  FILE-ACCESS-IDS.
   652     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   653     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   654     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   655     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   656     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   657     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   658     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   659     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   660     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   661     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   662     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   663     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   664     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   665     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   666     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   667     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   668     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   669 01  DD-IU-SW                    PIC X   VALUE ' '.
   670     88  DD-IU-PRESENT                 VALUE 'Y'.
   671
   672 01  ACCESS-KEYS.
   673     12  ELMSTR-KEY.
   674         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   675         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   676     12  W-CLAIM-KEY.
   677         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   678         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   679
   680     12  ELCNTL-KEY.
   681         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   682         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   683         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   684         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   685
   686     12  ELCERT-KEY.
   687         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   688         16  CERT-CARRIER         PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  14
* EL050.cbl
   689         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   690         16  CERT-STATE           PIC XX      VALUE SPACES.
   691         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   692         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   693         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   694
   695     12  ELCERT2-KEY.
   696         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   697         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   698
   699     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   700
   701     12  ELCERT-SAVE.
   702         16  FILLER                      PIC XX    VALUE SPACES.
   703
   704         16  WCS-CONTROL-PRIMARY.
   705             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   706             20  WCS-CARRIER             PIC X     VALUE SPACE.
   707             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   708             20  WCS-STATE               PIC XX    VALUE SPACES.
   709             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   710             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   711             20  WCS-CERT-NO.
   712                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   713                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   714
   715         16  CS-CONTROL-BY-NAME.
   716             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   717             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   718             20  CS-INSURED-INITIALS.
   719                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   720                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   721
   722         16  CS-CONTROL-BY-SSN.
   723             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   724             20  CS-SOC-SEC-NO.
   725                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   726                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   727                 24  CS-SSN-LN3.
   728                     28 CS-INSURED-INITIALS-A2   PIC XX
   729                                     VALUE SPACES.
   730                     28 CS-PART-LAST-NAME-A2     PIC X
   731                                     VALUE SPACE.
   732
   733         16  CS-CONTROL-BY-CERT-NO.
   734             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   735             20  CS-CERT-NO-A4           PIC X(11)
   736                                     VALUE SPACES.
   737
   738         16  CS-CONTROL-BY-MEMB.
   739             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   740             20  CS-MEMBER-NO.
   741                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   742                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   743                 24  CS-MEMB-LN4.
   744                     28 CS-INSURED-INITIALS-A5   PIC XX
   745                                      VALUE SPACES.
   746                     28 CS-PART-LAST-NAME-A5     PIC XX
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  15
* EL050.cbl
   747                                      VALUE SPACES.
   748
   749         16  FILLER              PIC X(360) VALUE SPACES.
   750
   751     12  ERACCT-KEY.
   752         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   753         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   754         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   755         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   756         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   757         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   758
   759     12  ERCOMP-KEY.
   760         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   761         16  COMP-CARRIER         PIC X     VALUE SPACES.
   762         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   763         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   764         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   765         16  COMP-TYPE            PIC X     VALUE SPACES.
   766
   767     12  ERLOFC-KEY.
   768         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   769         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   770         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   771         16  LOFC-STATE           PIC XX    VALUE SPACES.
   772         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   773         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   774
   775     12  WS-ELCRTT-KEY.
   776         16  WS-ELCRTT-PRIMARY       PIC X(33).
   777         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   778
   779     12  ERBXRF-KEY.
   780         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   781         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   782         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   783         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   784
   785     12  ERAGTC-KEY.
   786         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   787         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   788         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   789         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   790         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   791         16  AGTC-TYPE            PIC X     VALUE SPACES.
   792
   793     12  ERPLAN-KEY.
   794         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   795         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   796         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   797         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   798         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   799         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   800         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   801         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   802
   803     12  ERFORM-KEY.
   804         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  16
* EL050.cbl
   805         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   806         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   807         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   808
   809     12  ERREIN-KEY.
   810         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   811         16  REIN-TYPE            PIC X     VALUE SPACES.
   812         16  REIN-TABLE-CO.
   813             20  REIN-CODE-1      PIC X     VALUE SPACE.
   814             20  REIN-CODE-2      PIC X     VALUE SPACE.
   815             20  REIN-CODE-3      PIC X     VALUE SPACE.
   816         16  FILLER               PIC X(3)  VALUE SPACES.
   817
   818     12  ERCTBL-KEY.
   819         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   820         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   821         16  CTBL-CNTRL-2.
   822             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   823             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   824
   825     12  ELCRTO-KEY.
   826         16  ELCRTO-COMPANY-CD       PIC X.
   827         16  ELCRTO-CARRIER          PIC X.
   828         16  ELCRTO-GROUPING         PIC X(6).
   829         16  ELCRTO-STATE            PIC XX.
   830         16  ELCRTO-ACCOUNT          PIC X(10).
   831         16  ELCRTO-CERT-EFF-DT      PIC XX.
   832         16  ELCRTO-CERT-NO.
   833             20  ELCRTO-CERT-PRIME   PIC X(10).
   834             20  ELCRTO-CERT-SFX     PIC X.
   835         16  ELCRTO-RECORD-TYPE      PIC X.
   836         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   837
   838
   839     12  WS-ACCESS.
   840         16  FILLER               PIC XX    VALUE SPACES.
   841         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   842
   843     12  WS-CARR-ACCESS.
   844         16  FILLER               PIC X(3)  VALUE SPACES.
   845         16  WS-CARR              PIC X     VALUE SPACE.
   846*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   847*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   848     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   849         88  WS-DMD-LF-RATING   VALUE 'Y'.
   850         88  WS-DMD-AH-RATING   VALUE 'Y'.
   851         88  WS-DMD-NO-RATING   VALUE 'N'.
   852
   853     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   854         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   855                                         'NJ' 'NL'
   856                                         'PJ' 'PL'
   857                                         'SJ' 'SL'.
   858     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   859         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   860                                         'NI' 'NJ' 'NL' 'NU'
   861                                         'PJ' 'PL' 'PI' 'PU'
   862                                         'SI' 'SJ' 'SL' 'SU'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  17
* EL050.cbl
   863                                         'MX' 'MY' 'MZ'.
   864 01  ERPDEF-KEY-SAVE             PIC X(18).
   865 01  ERPDEF-KEY.
   866     12  ERPDEF-COMPANY-CD       PIC X.
   867     12  ERPDEF-STATE            PIC XX.
   868     12  ERPDEF-PROD-CD          PIC XXX.
   869     12  F                       PIC X(7).
   870     12  ERPDEF-BEN-TYPE         PIC X.
   871     12  ERPDEF-BEN-CODE         PIC XX.
   872     12  ERPDEF-EXP-DT           PIC XX.
   873
   874 01  ELSTAT-KEY-SAVE             PIC X(20).
   875 01  ELSTAT-KEY.
   876     12  ELSTAT-COMPANY-ID       PIC XXX.
   877     12  ELSTAT-CARRIER          PIC X.
   878     12  ELSTAT-GROUP            PIC X(6).
   879     12  ELSTAT-STATE            PIC XX.
   880     12  ELSTAT-EXP-DT           PIC 9(8).
   881 01  WS-ERROR-VALUES.
   882     12  ER-1570                     PIC S9(4)   VALUE +1570.
   883     12  ER-1571                     PIC S9(4)   VALUE +1571.
   884     12  er-1572                     pic s9(4)   value +1572.
   885     12  ER-1575                     PIC S9(4)   VALUE +1575.
   886     12  ER-1891                     PIC S9(4)   VALUE +1891.
   887     12  ER-1892                     PIC S9(4)   VALUE +1892.
   888     12  ER-1893                     PIC S9(4)   VALUE +1893.
   889     12  ER-1894                     PIC S9(4)   VALUE +1894.
   890     12  ER-1895                     PIC S9(4)   VALUE +1895.
   891     12  ER-1896                     PIC S9(4)   VALUE +1896.
   892     12  ER-1897                     PIC S9(4)   VALUE +1897.
   893     12  ER-1898                     PIC S9(4)   VALUE +1898.
   894     12  ER-1899                     PIC S9(4)   VALUE +1899.
   895     12  ER-1900                     PIC S9(4)   VALUE +1900.
   896     12  ER-1901                     PIC S9(4)   VALUE +1901.
   897     12  ER-1902                     PIC S9(4)   VALUE +1902.
   898     12  ER-1903                     PIC S9(4)   VALUE +1903.
   899     12  ER-1904                     PIC S9(4)   VALUE +1904.
   900     12  ER-1905                     PIC S9(4)   VALUE +1905.
   901     12  ER-1906                     PIC S9(4)   VALUE +1906.
   902     12  ER-1907                     PIC S9(4)   VALUE +1907.
   903     12  ER-1909                     PIC S9(4)   VALUE +1909.
   904     12  ER-1910                     PIC S9(4)   VALUE +1910.
   905     12  ER-1911                     PIC S9(4)   VALUE +1911.
   906     12  ER-1912                     PIC S9(4)   VALUE +1912.
   907     12  ER-1913                     PIC S9(4)   VALUE +1913.
   908     12  ER-1914                     PIC S9(4)   VALUE +1914.
   909     12  ER-1915                     PIC S9(4)   VALUE +1915.
   910     12  ER-1916                     PIC S9(4)   VALUE +1916.
   911     12  ER-1917                     PIC S9(4)   VALUE +1917.
   912     12  ER-1918                     PIC S9(4)   VALUE +1918.
   913     12  ER-1919                     PIC S9(4)   VALUE +1919.
   914     12  ER-1920                     PIC S9(4)   VALUE +1920.
   915     12  ER-1921                     PIC S9(4)   VALUE +1921.
   916     12  ER-1922                     PIC S9(4)   VALUE +1922.
   917     12  ER-1923                     PIC S9(4)   VALUE +1923.
   918     12  ER-1924                     PIC S9(4)   VALUE +1924.
   919     12  ER-1925                     PIC S9(4)   VALUE +1925.
   920     12  ER-1926                     PIC S9(4)   VALUE +1926.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  18
* EL050.cbl
   921     12  ER-1927                     PIC S9(4)   VALUE +1927.
   922     12  ER-2393                     PIC S9(4)   VALUE +2393.
   923     12  ER-2600                     PIC S9(4)   VALUE +2600.
   924     12  ER-2601                     PIC S9(4)   VALUE +2601.
   925     12  ER-2602                     PIC S9(4)   VALUE +2602.
   926     12  ER-2603                     PIC S9(4)   VALUE +2603.
   927     12  ER-2604                     PIC S9(4)   VALUE +2604.
   928     12  ER-2605                     PIC S9(4)   VALUE +2605.
   929     12  ER-2606                     PIC S9(4)   VALUE +2606.
   930     12  ER-2607                     PIC S9(4)   VALUE +2607.
   931     12  ER-2608                     PIC S9(4)   VALUE +2608.
   932     12  ER-2609                     PIC S9(4)   VALUE +2609.
   933     12  ER-2610                     PIC S9(4)   VALUE +2610.
   934     12  ER-2611                     PIC S9(4)   VALUE +2611.
   935     12  ER-2612                     PIC S9(4)   VALUE +2612.
   936     12  ER-2613                     PIC S9(4)   VALUE +2613.
   937     12  ER-2614                     PIC S9(4)   VALUE +2614.
   938     12  ER-2615                     PIC S9(4)   VALUE +2615.
   939     12  ER-2616                     PIC S9(4)   VALUE +2616.
   940     12  ER-2617                     PIC S9(4)   VALUE +2617.
   941     12  ER-2618                     PIC S9(4)   VALUE +2618.
   942     12  ER-2619                     PIC S9(4)   VALUE +2619.
   943     12  ER-2620                     PIC S9(4)   VALUE +2620.
   944     12  ER-2621                     PIC S9(4)   VALUE +2621.
   945     12  ER-2622                     PIC S9(4)   VALUE +2622.
   946     12  ER-2623                     PIC S9(4)   VALUE +2623.
   947     12  ER-2624                     PIC S9(4)   VALUE +2624.
   948     12  ER-2625                     PIC S9(4)   VALUE +2625.
   949     12  ER-2626                     PIC S9(4)   VALUE +2626.
   950     12  ER-2627                     PIC S9(4)   VALUE +2627.
   951     12  ER-2628                     PIC S9(4)   VALUE +2628.
   952     12  ER-2629                     PIC S9(4)   VALUE +2629.
   953     12  ER-2630                     PIC S9(4)   VALUE +2630.
   954     12  ER-2631                     PIC S9(4)   VALUE +2631.
   955     12  ER-2632                     PIC S9(4)   VALUE +2632.
   956     12  ER-2633                     PIC S9(4)   VALUE +2633.
   957     12  ER-2634                     PIC S9(4)   VALUE +2634.
   958     12  ER-2635                     PIC S9(4)   VALUE +2635.
   959     12  ER-2636                     PIC S9(4)   VALUE +2636.
   960     12  ER-2637                     PIC S9(4)   VALUE +2637.
   961     12  ER-2638                     PIC S9(4)   VALUE +2638.
   962     12  ER-2639                     PIC S9(4)   VALUE +2639.
   963     12  ER-2640                     PIC S9(4)   VALUE +2640.
   964     12  ER-2641                     PIC S9(4)   VALUE +2641.
   965     12  ER-2642                     PIC S9(4)   VALUE +2642.
   966     12  ER-2643                     PIC S9(4)   VALUE +2643.
   967     12  ER-2644                     PIC S9(4)   VALUE +2644.
   968     12  ER-2645                     PIC S9(4)   VALUE +2645.
   969     12  ER-2646                     PIC S9(4)   VALUE +2646.
   970     12  ER-2647                     PIC S9(4)   VALUE +2647.
   971     12  ER-2648                     PIC S9(4)   VALUE +2648.
   972     12  ER-2649                     PIC S9(4)   VALUE +2649.
   973     12  ER-2650                     PIC S9(4)   VALUE +2650.
   974     12  ER-2651                     PIC S9(4)   VALUE +2651.
   975     12  ER-2652                     PIC S9(4)   VALUE +2652.
   976     12  ER-2653                     PIC S9(4)   VALUE +2653.
   977     12  ER-2654                     PIC S9(4)   VALUE +2654.
   978     12  ER-2655                     PIC S9(4)   VALUE +2655.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  19
* EL050.cbl
   979     12  ER-2656                     PIC S9(4)   VALUE +2656.
   980     12  ER-2657                     PIC S9(4)   VALUE +2657.
   981     12  ER-2658                     PIC S9(4)   VALUE +2658.
   982     12  ER-2659                     PIC S9(4)   VALUE +2659.
   983     12  ER-2660                     PIC S9(4)   VALUE +2660.
   984     12  ER-2661                     PIC S9(4)   VALUE +2661.
   985     12  ER-2662                     PIC S9(4)   VALUE +2662.
   986     12  ER-2663                     PIC S9(4)   VALUE +2663.
   987     12  ER-2664                     PIC S9(4)   VALUE +2664.
   988     12  ER-2665                     PIC S9(4)   VALUE +2665.
   989     12  ER-2666                     PIC S9(4)   VALUE +2666.
   990     12  ER-2667                     PIC S9(4)   VALUE +2667.
   991     12  ER-2668                     PIC S9(4)   VALUE +2668.
   992     12  ER-2669                     PIC S9(4)   VALUE +2669.
   993     12  ER-2670                     PIC S9(4)   VALUE +2670.
   994     12  ER-2671                     PIC S9(4)   VALUE +2671.
   995     12  ER-2672                     PIC S9(4)   VALUE +2672.
   996     12  ER-2673                     PIC S9(4)   VALUE +2673.
   997     12  ER-2674                     PIC S9(4)   VALUE +2674.
   998     12  ER-2675                     PIC S9(4)   VALUE +2675.
   999     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1000     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1001     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1002     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1003     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1004     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1005     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1006     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1007     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1008     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1009     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1010     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1011     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1012     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1013     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1014     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1015     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1016     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1017     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1018     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1019     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1020     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1021     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1022     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1023     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1024     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1025     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1026     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1027     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1028     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1029     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1030     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1031     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1032     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1033     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1034     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1035     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1036     12  ER-2723                     PIC S9(4)   VALUE +2723.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  20
* EL050.cbl
  1037     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1038     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1039     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1040     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1041     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1042     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1043     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1044     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1045     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1046     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1047     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1048     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1049     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1050     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1051     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1052     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1053     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1054     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1055     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1056     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1057     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1058     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1059     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1060     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1061     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1062     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1063     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1064     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1065     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1066     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1067     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1068     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1069     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1070     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1071     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1072     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1073     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1074     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1075     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1076     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1077     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1078     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1079     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1080     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1081     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1082     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1083     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1084     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1085     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1086     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1087     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1088     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1089     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1090     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1091     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1092     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1093     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1094     12  ER-2781                     PIC S9(4)   VALUE +2781.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  21
* EL050.cbl
  1095     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1096     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1097     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1098     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1099     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1100     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1101     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1102     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1103     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1104     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1105     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1106     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1107     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1108     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1109     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1110     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1111     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1112     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1113     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1114     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1115     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1116     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1117     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1118     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1119     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1120     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1121     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1122     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1123     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1124     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1125     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1126     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1127     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1128     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1129     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1130     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1131     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1132     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1133     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1134     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1135     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1136     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1137     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1138     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1139     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1140     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1141     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1142     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1143     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1144     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1145     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1146     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1147     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1148     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1149     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1150     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1151     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1152     12  ER-8002                     PIC S9(4)   VALUE +8002.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  22
* EL050.cbl
  1153     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1154     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1155     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1156     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1157     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1158     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1159     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1160     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1161     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1162     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1163     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1164     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1165     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1166     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1167     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1168     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1169     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1170     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1171     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1172     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1173     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1174     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1175     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1176     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1177     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1178     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1179     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1180     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1181     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1182     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1183     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1184     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1185     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1186     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1187     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1188     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1189     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1190     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1191     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1192     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1193     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1194     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1195     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1196     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1197     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1198     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1199     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1200     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1201     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1202     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1203     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1204     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1205     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1206     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1207     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1208     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1209     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1210     12  ER-8303                     PIC S9(4)   VALUE +8303.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  23
* EL050.cbl
  1211     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1212     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1213     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1214     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1215     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1216     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1217     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1218     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1219     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1220     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1221     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1222     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1223     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1224     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1225******************************************************************
  1226***************   END OF ELC50WS     ****************************
  1227******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  24
* EL050.cbl
  1230 01  WORKING-STORAGE-WORK-AREAS.
  1231     12  WS-RESPONSE             PIC S9(8)  COMP.
  1232         88  WS-RESP-NORMAL           VALUE +00.
  1233         88  WS-RESP-ERROR            VALUE +01.
  1234         88  WS-RESP-NOTFND           VALUE +13.
  1235         88  WS-RESP-DUPREC           VALUE +14.
  1236         88  WS-RESP-ENDFILE          VALUE +20.
  1237     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1238     12  WORK-AREAS.
  1239         16  WK-CONV-GREG.
  1240             24  WCG-CENT             PIC XX.
  1241             24  WCG-REST             PIC X(4).
  1242         16  WORK-GREGORIAN-DATE.
  1243             24  WK-GREG-CENT         PIC XX.
  1244             24  WK-GREG-DATE-YYMMDD.
  1245                 28  WK-GREG-YYMM     PIC X(4).
  1246                 28  WK-GREG-DD       PIC XX.
  1247
  1248         16  WORK-SELECT-DATE.
  1249             24  WK-SELECT-CENT            PIC XX.
  1250             24  WK-SELECT-DATE-YYMMDD.
  1251                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1252                 28  FILLER                PIC XX.
  1253
  1254         16  WK-FORM-NO.
  1255             24  WK-FORM-BANK-ID       PIC X(5).
  1256             24  WK-FORM-UNDRWRTR      PIC X(1).
  1257             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1258
  1259         16  WK-MEMBER-NO.
  1260             24  WK-MEMBER-1-6        PIC X(6).
  1261             24  WK-MEMBER-7-12       PIC X(6).
  1262
  1263         16  WK-FULL-CERT-NO.
  1264             24  WK-CERT-POS-1-2      PIC X(2).
  1265             24  WK-CERT-POS-3        PIC X(1).
  1266             24  WK-CERT-POS-4        PIC X(1).
  1267             24  WK-CERT-POS-5-6      PIC X(2).
  1268             24  WK-CERT-POS-7        PIC X(1).
  1269             24  WK-CERT-POS-8-11     PIC X(4).
  1270
  1271         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1272             88  VALID-RATE-CODE        VALUE 'Y'.
  1273             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1274
  1275         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1276         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1277         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1278         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1279         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1280         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1281         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1282         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1283         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1284         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1285
  1286* DLO001
  1287 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  25
* EL050.cbl
  1288     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1289     12  DMPF-RETURN-CODE          PIC XX.
  1290         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1291         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1292         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1293         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1294         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1295         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1296
  1297* DLO002
  1298 01  WS-DLO-INTERNAL-POLICY-FORM.
  1299     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1300     12  DIPF-RETURN-CODE          PIC XX.
  1301         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1302         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1303         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1304         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1305         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1306         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1307
  1308* DLO003
  1309 01  WS-DLO-VALID-BANK-ID.
  1310     12  DVBI-BANK-ID              PIC X(5).
  1311     12  DVBI-BANK-ID-TYPE         PIC X.
  1312         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1313         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1314         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1315         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1316         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1317     12  DVBI-RETURN-CODE          PIC XX.
  1318         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1319         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1320         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1321         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1322         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1323         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1324         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1325         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1326         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1327
  1328* DLO007
  1329 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1330     12  DCUA-RES-STATE            PIC XX.
  1331     12  DCUA-BEN-TYPE             PIC XX.
  1332     12  DCUA-SYS-IDENT            PIC X.
  1333         88  DCUA-CLAIM                        VALUE 'C'.
  1334         88  DCUA-PREMIUM                      VALUE 'P'.
  1335     12  DCUA-COVERAGE-RULE        PIC X.
  1336     12  DCUA-CLIENT-ID            PIC X(10).
  1337     12  DCUA-EFF-DATE             PIC X(8).
  1338     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1339     12  DCUA-RETURN-CODE          PIC XX.
  1340         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1341     12  DCUA-CERT-NUMBER          PIC X(11).
  1342     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1343     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1344
  1345* DLO011
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  26
* EL050.cbl
  1346 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1347     12  DPRB-RATE-CODE            PIC X(4).
  1348     12  DPRB-COVERAGE-CATEG       PIC X.
  1349     12  DPRB-RETURN-CODE          PIC XX.
  1350         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1351         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1352         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1353         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1354         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1355         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1356         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1357         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1358         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1359     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1360     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1361     12  DPRB-BEN-TYPE             PIC XX.
  1362
  1363* DLO017
  1364 01  WS-DLO-VALID-RATE-CODE.
  1365     12  DVRC-RATE-CODE            PIC X(4).
  1366     12  DVRC-RETURN-CODE          PIC XX.
  1367         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1368         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1369         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1370         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1371         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1372         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1373
  1374* DLO019
  1375 01  WS-DLO-ORIG-COV-CAT.
  1376     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1377     12  DOCC-RETURN-CODE          PIC XX.
  1378     12  DOCC-ORIG-COV-CAT         PIC X.
  1379     12  DOCC-UNDERWITER           PIC XX.
  1380     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1381     12  DOCC-FILLER               PIC X(6).
  1382
  1383* DLO021
  1384 01  WS-DLO-VALID-LOAN-OFFICER.
  1385     12  DVLO-LOAN-OFFICER.
  1386         16  DVLO-BILL-TYPE        PIC X.
  1387         16  DVLO-BILL-SOURCE      PIC X.
  1388         16  DVLO-BATCH-TYPE       PIC X.
  1389     12  DVLO-RETURN-CODE          PIC XX.
  1390         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1391         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1392         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1393         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1394         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1395         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1396
  1397* DLO022
  1398 01  WS-DLO-VALID-STATE-CODE.
  1399     12  DVSC-STATE-CODE           PIC XX.
  1400     12  DVSC-RETURN-CODE          PIC XX.
  1401         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1402
  1403* DLO023
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  27
* EL050.cbl
  1404 01  WS-DLO-VALID-CODE-VALUES.
  1405     12  DVCV-SYSTEM-ID            PIC XX.
  1406         88  DVCV-CLAIMS                       VALUE 'CL'.
  1407         88  DVCV-CREDIT                       VALUE 'CR'.
  1408     12  DVCV-RECORD-TYPE          PIC XX.
  1409         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1410         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1411         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1412         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1413         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1414         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1415         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1416         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1417     12  DVCV-RECORD-KEY           PIC X(6).
  1418     12  DVCV-RETURN-CODE          PIC XX.
  1419         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1420         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1421         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1422         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1423         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1424         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1425         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1426     12  DVCV-CODE-DESC            PIC X(60).
  1427     12  DVCV-GEN-DESC-1           PIC X(20).
  1428     12  DVCV-GEN-DESC-2           PIC X(20).
  1429     12  DVCV-GEN-DESC-3           PIC X(20).
  1430
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  28
* EL050.cbl
  1432*    COPY ERCBXRF.
  1433******************************************************************
  1434*                                                                *
  1435*                                                                *
  1436*                            ERCBXRF                             *
  1437*                                                                *
  1438*   ONLINE CREDIT SYSTEM                                         *
  1439*                                                                *
  1440*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1441*                                                                *
  1442*   FILE TYPE = VSAM,KSDS                                        *
  1443*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1444*                                                                *
  1445*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1446*       ALTERNATE PATH = NONE                                    *
  1447*                                                                *
  1448*   LOG = NO                                                     *
  1449*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1450*                                                                *
  1451******************************************************************
  1452
  1453 01  BANK-CROSS-REFERENCE.
  1454     12  BK-RECORD-ID                PIC XX.
  1455         88  VALID-BK-ID             VALUE 'BK'.
  1456
  1457     12  BK-CONTROL-PRIMARY.
  1458         16  BK-COMPANY-CD           PIC X.
  1459         16  BK-CARRIER              PIC X.
  1460         16  BK-GROUPING             PIC X(6).
  1461         16  BK-BANK-NO              PIC X(10).
  1462
  1463     12  BK-MAINT-INFORMATION.
  1464         16  BK-LAST-MAINT-DT        PIC XX.
  1465         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1466         16  BK-LAST-MAINT-USER      PIC X(4).
  1467         16  FILLER                  PIC X(9).
  1468
  1469     12  FILLER                      PIC X(37).
  1470
  1471     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1472
  1473     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1474                            DEPENDING ON BK-BANK-POINTER-CNT.
  1475         16  BK-AM-ACCOUNT           PIC X(10).
  1476         16  BK-AM-EXP-DT            PIC XX.
  1477         16  BK-AM-EFF-DT            PIC XX.
  1478         16  BK-AM-STATE             PIC XX.
  1479         16  FILLER                  PIC X(20).
  1480
  1481******************************************************************
  1482
  1483*    COPY ERCCOMP.
  1484******************************************************************
  1485*                                                                *
  1486*                                                                *
  1487*                            ERCCOMP                             *
  1488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1489*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  29
* EL050.cbl
  1490*                                                                *
  1491*   ONLINE CREDIT SYSTEM                                         *
  1492*                                                                *
  1493*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1494*                                                                *
  1495*   FILE TYPE = VSAM,KSDS                                        *
  1496*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1497*                                                                *
  1498*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1499*       ALTERNATE PATH = NONE                                    *
  1500*                                                                *
  1501*   LOG = NO                                                     *
  1502*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1503*                                                                *
  1504******************************************************************
  1505*                   C H A N G E   L O G
  1506*
  1507* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1508*-----------------------------------------------------------------
  1509*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1510* EFFECTIVE    NUMBER
  1511*-----------------------------------------------------------------
  1512* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1513* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1514* 092205    2005050300006  PEMA  ADD LEASE FEE
  1515* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1516* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1517* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1518* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1519* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1520* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1521******************************************************************
  1522
  1523 01  COMPENSATION-MASTER.
  1524     12  CO-RECORD-ID                          PIC XX.
  1525         88  VALID-CO-ID                          VALUE 'CO'.
  1526
  1527     12  CO-CONTROL-PRIMARY.
  1528         16  CO-COMPANY-CD                     PIC X.
  1529         16  CO-CONTROL.
  1530             20  CO-CTL-1.
  1531                 24  CO-CARR-GROUP.
  1532                     28  CO-CARRIER            PIC X.
  1533                     28  CO-GROUPING.
  1534                         32  CO-GROUP-PREFIX   PIC XXX.
  1535                         32  CO-GROUP-PRIME    PIC XXX.
  1536                 24  CO-RESP-NO.
  1537                     28  CO-RESP-PREFIX        PIC X(4).
  1538                     28  CO-RESP-PRIME         PIC X(6).
  1539             20  CO-CTL-2.
  1540                 24  CO-ACCOUNT.
  1541                     28  CO-ACCT-PREFIX        PIC X(4).
  1542                     28  CO-ACCT-PRIME         PIC X(6).
  1543         16  CO-TYPE                           PIC X.
  1544             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1545             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1546             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1547
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  30
* EL050.cbl
  1548     12  CO-MAINT-INFORMATION.
  1549         16  CO-LAST-MAINT-DT                  PIC XX.
  1550         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1551         16  CO-LAST-MAINT-USER                PIC X(4).
  1552     12  FILLER                                PIC XX.
  1553     12  CO-STMT-TYPE                          PIC XXX.
  1554     12  CO-COMP-TYPE                          PIC X.
  1555         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1556     12  CO-STMT-OWNER                         PIC X(4).
  1557     12  CO-BALANCE-CONTROL                    PIC X.
  1558         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1559         88  CO-NO-BALANCE                        VALUE 'N'.
  1560
  1561     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1562         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1563         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1564         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1565
  1566     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1567         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1568         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1569
  1570     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1571     12  CO-GA-DIRECT-DEP                      PIC X.
  1572     12  CO-FUTURE-SPACE                       PIC X.
  1573         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1574
  1575     12  CO-ACCT-NAME                          PIC X(30).
  1576     12  CO-MAIL-NAME                          PIC X(30).
  1577     12  CO-ADDR-1                             PIC X(30).
  1578     12  CO-ADDR-2                             PIC X(30).
  1579     12  CO-ADDR-3.
  1580         16  CO-ADDR-CITY                      PIC X(27).
  1581         16  CO-ADDR-STATE                     PIC XX.
  1582     12  CO-CSO-1099                           PIC X.
  1583     12  CO-ZIP.
  1584         16  CO-ZIP-PRIME.
  1585             20  CO-ZIP-PRI-1ST                PIC X.
  1586                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1587             20  FILLER                        PIC X(4).
  1588         16  CO-ZIP-PLUS4                      PIC X(4).
  1589     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1590         16  CO-CAN-POSTAL-1                   PIC XXX.
  1591         16  CO-CAN-POSTAL-2                   PIC XXX.
  1592         16  FILLER                            PIC XXX.
  1593     12  CO-SOC-SEC                            PIC X(13).
  1594     12  CO-TELEPHONE.
  1595         16  CO-AREA-CODE                      PIC XXX.
  1596         16  CO-PREFIX                         PIC XXX.
  1597         16  CO-PHONE                          PIC X(4).
  1598
  1599     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1600
  1601     12  CO-AR-BAL-LEVEL                       PIC X.
  1602         88  CO-AR-REF-LVL                        VALUE '1'.
  1603         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1604         88  CO-AR-BILL-LVL                       VALUE '2'.
  1605         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  31
* EL050.cbl
  1606         88  CO-AR-FR-LVL                         VALUE '4'.
  1607
  1608     12  CO-AR-NORMAL-PRINT                    PIC X.
  1609         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1610         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1611
  1612     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1613
  1614     12  CO-AR-REPORTING                       PIC X.
  1615         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1616         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1617
  1618     12  CO-AR-PULL-CHECK                      PIC X.
  1619         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1620         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1621
  1622     12  CO-AR-BALANCE-PRINT                   PIC X.
  1623         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1624
  1625     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1626         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1627         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1628         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1629
  1630     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1631
  1632     12  CO-USER-CODE                          PIC X.
  1633     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1634
  1635******************************************************************
  1636*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1637*    THE LAST MONTH END RUN.
  1638******************************************************************
  1639
  1640     12  CO-LAST-ACTIVITY-DATE.
  1641         16  CO-ACT-YEAR                       PIC 99.
  1642         16  CO-ACT-MONTH                      PIC 99.
  1643         16  CO-ACT-DAY                        PIC 99.
  1644
  1645     12  CO-LAST-STMT-DT.
  1646         16  CO-LAST-STMT-YEAR                 PIC 99.
  1647         16  CO-LAST-STMT-MONTH                PIC 99.
  1648         16  CO-LAST-STMT-DAY                  PIC 99.
  1649
  1650     12  CO-MO-END-TOTALS.
  1651         16  CO-MONTHLY-TOTALS.
  1652             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1653             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1654             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1655             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1656             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1657
  1658         16  CO-AGING-TOTALS.
  1659             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1660             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1661             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1662             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1663
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  32
* EL050.cbl
  1664         16  CO-YTD-TOTALS.
  1665             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1666             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1667
  1668         16  CO-OVER-UNDER-TOTALS.
  1669             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1670             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1671
  1672     12  CO-MISCELLANEOUS-TOTALS.
  1673         16  CO-FICA-TOTALS.
  1674             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1675             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1676
  1677         16  CO-CLAIM-TOTALS.
  1678             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1679             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1680
  1681******************************************************************
  1682*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1683*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1684******************************************************************
  1685
  1686     12  CO-CURRENT-TOTALS.
  1687         16  CO-CURRENT-LAST-STMT-DT.
  1688             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1689             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1690             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1691
  1692         16  CO-CURRENT-MONTHLY-TOTALS.
  1693             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1694             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1695             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1696             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1697             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1698
  1699         16  CO-CURRENT-AGING-TOTALS.
  1700             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1701             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1702             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1703             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1704
  1705         16  CO-CURRENT-YTD-TOTALS.
  1706             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1707             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1708
  1709     12  CO-PAID-COMM-TOTALS.
  1710         16  CO-YTD-PAID-COMMS.
  1711             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1712             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1713
  1714     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1715         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1716         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1717
  1718     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1719         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1720         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1721         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  33
* EL050.cbl
  1722         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1723         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1724         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1725         88  CO-FINAL-LETTER                  VALUE 'F'.
  1726         88  CO-RECONCILING                   VALUE 'R'.
  1727         88  CO-PHONE-CALL                    VALUE 'P'.
  1728         88  CO-LEGAL                         VALUE 'L'.
  1729         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1730         88  CO-WRITE-OFF                     VALUE 'W'.
  1731         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1732
  1733     12  CO-CSR-CODE                       PIC X(4).
  1734
  1735     12  CO-GA-STATUS-INFO.
  1736         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1737         16  CO-GA-TERMINATION-DT          PIC XX.
  1738         16  CO-GA-STATUS-CODE             PIC X.
  1739             88  CO-GA-ACTIVE                 VALUE 'A'.
  1740             88  CO-GA-INACTIVE               VALUE 'I'.
  1741             88  CO-GA-PENDING                VALUE 'P'.
  1742         16  CO-GA-COMMENTS.
  1743             20  CO-GA-COMMENT-1           PIC X(40).
  1744             20  CO-GA-COMMENT-2           PIC X(40).
  1745             20  CO-GA-COMMENT-3           PIC X(40).
  1746             20  CO-GA-COMMENT-4           PIC X(40).
  1747
  1748     12  CO-RPTCD2                         PIC X(10).
  1749     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1750         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1751         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1752
  1753     12  CO-TYPE-AGENT                     PIC X(01).
  1754         88  CO-CORPORATION                   VALUE 'C'.
  1755         88  CO-PARTNERSHIP                   VALUE 'P'.
  1756         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1757         88  CO-TRUST                         VALUE 'T'.
  1758         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1759
  1760     12  CO-FAXNO.
  1761         16  CO-FAX-AREA-CODE                  PIC XXX.
  1762         16  CO-FAX-PREFIX                     PIC XXX.
  1763         16  CO-FAX-PHONE                      PIC X(4).
  1764
  1765     12  CO-BANK-INFORMATION.
  1766         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1767         16  CO-BANK-TRANSIT-NON REDEFINES
  1768             CO-BANK-TRANSIT-NO                PIC 9(8).
  1769
  1770         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1771     12  CO-MISC-DEDUCT-INFO REDEFINES
  1772                  CO-BANK-INFORMATION.
  1773         16  CO-MD-GL-ACCT                     PIC X(10).
  1774         16  CO-MD-DIV                         PIC XX.
  1775         16  CO-MD-CENTER                      PIC X(4).
  1776         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1777         16  CO-CREATE-AP-CHECK                PIC X.
  1778         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1779         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  34
* EL050.cbl
  1780     12  CO-ACH-STATUS                         PIC X.
  1781         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1782         88  CO-ACH-PENDING                        VALUE 'P'.
  1783
  1784     12  CO-BILL-SW                            PIC X.
  1785     12  CO-CONTROL-NAME                       PIC X(30).
  1786     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1787     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1788     12  CO-CLP-STATE                          PIC XX.
  1789     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1790     12  CO-SPP-REFUND-EDIT                    PIC X.
  1791
  1792******************************************************************
  1793
  1794*    COPY ERCAGTC.
  1795******************************************************************
  1796*                                                                *
  1797*                                                                *
  1798*                            ERCAGTC                             *
  1799*                            VMOD=2.001                          *
  1800*                                                                *
  1801*   ONLINE CREDIT SYSTEM                                         *
  1802*                                                                *
  1803*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1804*                                                                *
  1805*   FILE TYPE = VSAM,KSDS                                        *
  1806*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1807*                                                                *
  1808*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1809*       ALTERNATE PATH = NONE                                    *
  1810*                                                                *
  1811*   LOG = NO                                                     *
  1812*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1813*                                                                *
  1814******************************************************************
  1815*                   C H A N G E   L O G
  1816*
  1817* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1818*-----------------------------------------------------------------
  1819*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1820* EFFECTIVE    NUMBER
  1821*-----------------------------------------------------------------
  1822* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1823* 111004                         NEW FILE AND COPYBOOK
  1824* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1825******************************************************************
  1826 01  AGENT-COMMISSIONS.
  1827     12  AG-RECORD-ID                          PIC XX.
  1828         88  VALID-CO-ID                          VALUE 'AG'.
  1829     12  AG-CONTROL-PRIMARY.
  1830         16  AG-COMPANY-CD                     PIC X.
  1831         16  AG-CONTROL.
  1832             20  AG-CTL-1.
  1833                 24  AG-CARR-GROUP.
  1834                     28  AG-CARRIER            PIC X.
  1835                     28  AG-GROUPING           PIC X(6).
  1836                 24  AG-BANK                   PIC X(10).
  1837             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  35
* EL050.cbl
  1838                 24  AG-EXP-DT                 PIC XX.
  1839         16  AG-TYPE                           PIC X.
  1840             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1841             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1842     12  AG-MAINT-INFORMATION.
  1843         16  AG-LAST-MAINT-DT                  PIC XX.
  1844         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1845         16  AG-LAST-MAINT-USER                PIC X(4).
  1846         16  FILLER                            PIC X(10).
  1847     12  AG-EFF-DT                             PIC XX.
  1848     12  AG-COMM-STRUCTURE.
  1849         16  AG-AGT-COMMS OCCURS 10.
  1850             20  AG-AGT                PIC X(10).
  1851             20  AG-COM-TYP            PIC X.
  1852             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1853             20  AG-RECALC-LV-INDIC    PIC X.
  1854             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1855             20  AG-LRCALC-LV-INDIC    PIC X.
  1856             20  FILLER                PIC X(05).
  1857     12  FILLER                  PIC X(145).
  1858******************************************************************
  1859*    COPY ERCRESS.
  1860******************************************************************
  1861*                                                                *
  1862*                            ERCRESS                             *
  1863*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1864*                            VMOD=2.002                          *
  1865*                                                                *
  1866*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1867*                                                                *
  1868*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1869*   VSAM RESIDENT STATE TAX MASTER                              *
  1870*                                                                *
  1871*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1872*                                                                *
  1873*   FILE TYPE = VSAM,KSDS                                        *
  1874*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1875*                                                                *
  1876*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1877*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1878*                                                                *
  1879*   LOG = NO                                                     *
  1880*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1881*                                                                *
  1882*                                                                *
  1883******************************************************************
  1884
  1885 01  RESIDENT-STATE-TAX-MASTER.
  1886
  1887     10  ERRESS-PRIMARY-KEY.
  1888         15  RES-COMPANY-CD        PIC X.
  1889         15  RES-RESIDENT-STATE    PIC XX.
  1890         15  RES-COVERAGE-CATEGORY PIC X.
  1891         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1892*                                      YYYYMMDD
  1893*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1894
  1895     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  36
* EL050.cbl
  1896
  1897         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1898         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1899         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1900         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1901
  1902     10 RES-RECALC-SW              PIC   X.
  1903         88 RECALC                VALUE 'Y'.
  1904         88 NO-RECALC             VALUE 'N'.
  1905     10  RES-MAINT-BY              PIC X(4).
  1906     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1907     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1908*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  37
* EL050.cbl
  1910*    COPY ERCRESC.
  1911******************************************************************
  1912*                                                                *
  1913*                            ERCRESC                             *
  1914*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1915*                            VMOD=2.003                          *
  1916*                                                                *
  1917*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1918*                                                                *
  1919*   FILE TYPE = VSAM,KSDS                                        *
  1920*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1921*                                                                *
  1922*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1923*       ALTERNATE PATH1 = NONE                                   *
  1924*                                                                *
  1925*   LOG = NO                                                     *
  1926*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1927*                                                                *
  1928******************************************************************
  1929
  1930 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1931
  1932     10  ERRESC-RECORD-KEY.
  1933         15  RESC-COMPANY-CD           PIC   X.
  1934         15  RESC-CARRIER              PIC   X.
  1935         15  RESC-GROUP                PIC   X(6).
  1936         15  RESC-STATE                PIC   XX.
  1937         15  RESC-ACCOUNT              PIC   X(10).
  1938         15  RESC-AGENT                PIC   X(10).
  1939         15  RESC-RESIDENT-STATE       PIC   XX.
  1940         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1941*                                           YYYYMMDD
  1942     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1943
  1944     10  RESC-COMM-RECORD-DATA.
  1945         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1946             20 RESC-COVERAGE-CAT      PIC    X.
  1947             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1948             20 RESC-COMMISSION-TAB REDEFINES
  1949                RESC-COMMISSION-PER    PIC  XXX.
  1950
  1951     10  RESC-MAINT-BY                 PIC X(4).
  1952     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1953     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1954*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  38
* EL050.cbl
  1956*    COPY ERCPLAN.
  1957******************************************************************
  1958*                                                                *
  1959*                                                                *
  1960*                            ERCPLAN                             *
  1961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1962*                            VMOD=2.003                          *
  1963*                                                                *
  1964*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1965*                                                                *
  1966*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1967*   PLAN MASTER                                                  *
  1968*                                                                *
  1969*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1970*                                                                *
  1971*   FILE TYPE = VSAM,KSDS                                        *
  1972*   RECORD SIZE = 420   RECFORM = FIX                            *
  1973*                                                                *
  1974*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1975*       ALTERNATE PATH1 = N/A                                    *
  1976*                                                                *
  1977*   LOG = NO                                                     *
  1978*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1979*                                                                *
  1980*                                                                *
  1981******************************************************************
  1982
  1983 01  PLAN-MASTER.
  1984     12  PL-RECORD-ID                      PIC XX.
  1985         88  VALID-PL-ID                      VALUE 'PL'.
  1986
  1987     12  PL-CONTROL-PRIMARY.
  1988         16  PL-COMPANY-CD                 PIC X.
  1989         16  PL-MSTR-CNTRL.
  1990             20  PL-CONTROL-A.
  1991                 24  PL-CARRIER            PIC X.
  1992                 24  PL-GROUPING           PIC X(6).
  1993                 24  PL-STATE              PIC XX.
  1994                 24  PL-ACCOUNT            PIC X(10).
  1995             20  PL-BENEFIT-TYPE           PIC X.
  1996             20  PL-BENEFIT-CODE           PIC XX.
  1997             20  PL-REVISION-NO            PIC X(3).
  1998
  1999     12  PL-CONTROL-BY-VAR-GRP.
  2000         16  PL-COMPANY-CD-A1              PIC X.
  2001         16  PL-VG-CARRIER                 PIC X.
  2002         16  PL-VG-GROUPING                PIC X(6).
  2003         16  PL-VG-STATE                   PIC XX.
  2004         16  PL-VG-ACCOUNT                 PIC X(10).
  2005         16  PL-BENEFIT-TYPE-A1            PIC X.
  2006         16  PL-BENEFIT-CODE-A1            PIC XX.
  2007         16  PL-REVISION-NO-A1             PIC 999.
  2008
  2009     12  PL-MAINT-INFORMATION.
  2010         16  PL-LAST-MAINT-DT              PIC XX.
  2011         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2012         16  PL-LAST-MAINT-USER            PIC X(4).
  2013         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  39
* EL050.cbl
  2014
  2015     12  PL-LIABILITY-LIMITS.
  2016         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2017         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2018             20  PL-LM-AGE                 PIC S99        COMP-3.
  2019             20  PL-LM-DUR                 PIC S999       COMP-3.
  2020             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2021             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2022
  2023     12  FILLER                            PIC X(30).
  2024
  2025     12  PL-GL-ACCOUNT-NOS.
  2026         16  PL-PREMIUM-GL                 PIC X(8).
  2027         16  PL-COMM-GL                    PIC X(8).
  2028         16  PL-CLAIM-GL                   PIC X(8).
  2029     12  FILLER                            PIC X(24).
  2030     12  PL-TOLERANCES.
  2031         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2032         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2033         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2034         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2035         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2036         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2037     12  PL-OVER-SHORT.
  2038         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2039         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2040     12  FILLER                            PIC X(24).
  2041     12  PLAN-MISC.
  2042         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2043         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2044         16  PL-IG                         PIC X.
  2045         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2046         16  PL-POLICY-FORM                PIC X(12).
  2047         16  PL-EDIT-FOR-FORM              PIC X(01).
  2048         16  PL-DEV-CODE                   PIC XXX.
  2049         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2050         16  PL-CALC-METHOD                PIC X.
  2051         16  PL-BENEFIT-GROUP              PIC X(05).
  2052         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2053
  2054         16  FILLER                        PIC X(99).
  2055******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  40
* EL050.cbl
  2057*    COPY ELCCERT.
  2058******************************************************************
  2059*                                                                *
  2060*                            ELCCERT.                            *
  2061*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2062*                            VMOD=2.013                          *
  2063*                                                                *
  2064*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2065*                                                                *
  2066*   FILE TYPE = VSAM,KSDS                                        *
  2067*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2068*                                                                *
  2069*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2070*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2071*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2072*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2073*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2074*                                                                *
  2075*   LOG = YES                                                    *
  2076*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2077******************************************************************
  2078*                   C H A N G E   L O G
  2079*
  2080* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2081*-----------------------------------------------------------------
  2082*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2083* EFFECTIVE    NUMBER
  2084*-----------------------------------------------------------------
  2085* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2086* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2087* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2088* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2089* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2090* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2091* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2092* 032612  CR2011110200001  PEMA  AHL CHANGES
  2093******************************************************************
  2094
  2095 01  CERTIFICATE-MASTER.
  2096     12  CM-RECORD-ID                      PIC XX.
  2097         88  VALID-CM-ID                      VALUE 'CM'.
  2098
  2099     12  CM-CONTROL-PRIMARY.
  2100         16  CM-COMPANY-CD                 PIC X.
  2101         16  CM-CARRIER                    PIC X.
  2102         16  CM-GROUPING.
  2103             20  CM-GROUPING-PREFIX        PIC X(3).
  2104             20  CM-GROUPING-PRIME         PIC X(3).
  2105         16  CM-STATE                      PIC XX.
  2106         16  CM-ACCOUNT.
  2107             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2108             20  CM-ACCOUNT-PRIME          PIC X(6).
  2109         16  CM-CERT-EFF-DT                PIC XX.
  2110         16  CM-CERT-NO.
  2111             20  CM-CERT-PRIME             PIC X(10).
  2112             20  CM-CERT-SFX               PIC X.
  2113
  2114     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  41
* EL050.cbl
  2115         16  CM-COMPANY-CD-A1              PIC X.
  2116         16  CM-INSURED-LAST-NAME          PIC X(15).
  2117         16  CM-INSURED-INITIALS.
  2118             20  CM-INSURED-INITIAL1       PIC X.
  2119             20  CM-INSURED-INITIAL2       PIC X.
  2120
  2121     12  CM-CONTROL-BY-SSN.
  2122         16  CM-COMPANY-CD-A2              PIC X.
  2123         16  CM-SOC-SEC-NO.
  2124             20  CM-SSN-STATE              PIC XX.
  2125             20  CM-SSN-ACCOUNT            PIC X(6).
  2126             20  CM-SSN-LN3.
  2127                 25  CM-INSURED-INITIALS-A2.
  2128                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2129                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2130                 25 CM-PART-LAST-NAME-A2         PIC X.
  2131
  2132     12  CM-CONTROL-BY-CERT-NO.
  2133         16  CM-COMPANY-CD-A4              PIC X.
  2134         16  CM-CERT-NO-A4                 PIC X(11).
  2135
  2136     12  CM-CONTROL-BY-MEMB.
  2137         16  CM-COMPANY-CD-A5              PIC X.
  2138         16  CM-MEMBER-NO.
  2139             20  CM-MEMB-STATE             PIC XX.
  2140             20  CM-MEMB-ACCOUNT           PIC X(6).
  2141             20  CM-MEMB-LN4.
  2142                 25  CM-INSURED-INITIALS-A5.
  2143                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2144                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2145                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2146
  2147     12  CM-INSURED-PROFILE-DATA.
  2148         16  CM-INSURED-FIRST-NAME.
  2149             20  CM-INSURED-1ST-INIT       PIC X.
  2150             20  FILLER                    PIC X(9).
  2151         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2152         16  CM-INSURED-SEX                PIC X.
  2153             88  CM-SEX-MALE                  VALUE 'M'.
  2154             88  CM-SEX-FEMAL                 VALUE 'F'.
  2155         16  CM-INSURED-JOINT-AGE          PIC 99.
  2156         16  CM-JOINT-INSURED-NAME.
  2157             20  CM-JT-LAST-NAME           PIC X(15).
  2158             20  CM-JT-FIRST-NAME.
  2159                 24  CM-JT-1ST-INIT        PIC X.
  2160                 24  FILLER                PIC X(9).
  2161             20  CM-JT-INITIAL             PIC X.
  2162
  2163     12  CM-LIFE-DATA.
  2164         16  CM-LF-BENEFIT-CD              PIC XX.
  2165         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2166         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2167         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2168         16  CM-LF-DEV-CODE                PIC XXX.
  2169         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2170         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2171         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2172         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  42
* EL050.cbl
  2173         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2174         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2175         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2176         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2177         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2178         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2179         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2180         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2181         16  FILLER                        PIC XX.
  2182
  2183     12  CM-AH-DATA.
  2184         16  CM-AH-BENEFIT-CD              PIC XX.
  2185         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2186         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2187         16  CM-AH-DEV-CODE                PIC XXX.
  2188         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2189         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2190         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2191         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2192         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2193         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2194         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2195         16  CM-AH-PAID-THRU-DT            PIC XX.
  2196             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2197         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2198         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2199         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2200         16  FILLER                        PIC X.
  2201
  2202     12  CM-LOAN-INFORMATION.
  2203         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2204         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2205                                           PIC S9(5)V99  COMP-3.
  2206         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2207         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2208         16  CM-PAY-FREQUENCY              PIC S99.
  2209         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2210         16  CM-RATE-CLASS                 PIC XX.
  2211         16  CM-BENEFICIARY                PIC X(25).
  2212         16  CM-POLICY-FORM-NO             PIC X(12).
  2213         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2214         16  CM-LAST-ADD-ON-DT             PIC XX.
  2215         16  CM-DEDUCTIBLE-AMOUNTS.
  2216             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2217             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2218         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2219             20  CM-RESIDENT-STATE         PIC XX.
  2220             20  CM-RATE-CODE              PIC X(4).
  2221             20  FILLER                    PIC XX.
  2222         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2223             20  CM-LOAN-OFFICER           PIC X(5).
  2224             20  FILLER                    PIC XXX.
  2225         16  CM-CSR-CODE                   PIC XXX.
  2226         16  CM-UNDERWRITING-CODE          PIC X.
  2227             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2228         16  CM-POST-CARD-IND              PIC X.
  2229         16  CM-NH-INTERFACE-SW            PIC X.
  2230         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  43
* EL050.cbl
  2231             88  CM-SING-PRM                  VALUE '1'.
  2232             88  CM-O-B-COVERAGE              VALUE '2'.
  2233             88  CM-OPEN-END                  VALUE '3'.
  2234         16  CM-IND-GRP-TYPE               PIC X.
  2235             88  CM-INDIVIDUAL                VALUE 'I'.
  2236             88  CM-GROUP                     VALUE 'G'.
  2237         16  CM-SKIP-CODE                  PIC X.
  2238             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2239             88  SKIP-JULY                    VALUE '1'.
  2240             88  SKIP-AUGUST                  VALUE '2'.
  2241             88  SKIP-SEPTEMBER               VALUE '3'.
  2242             88  SKIP-JULY-AUG                VALUE '4'.
  2243             88  SKIP-AUG-SEPT                VALUE '5'.
  2244             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2245             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2246             88  SKIP-JUNE                    VALUE '8'.
  2247             88  SKIP-JUNE-JULY               VALUE '9'.
  2248             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2249             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2250         16  CM-PAYMENT-MODE               PIC X.
  2251             88  PAY-MONTHLY                  VALUE SPACE.
  2252             88  PAY-WEEKLY                   VALUE '1'.
  2253             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2254             88  PAY-BI-WEEKLY                VALUE '3'.
  2255             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2256         16  CM-LOAN-NUMBER                PIC X(8).
  2257         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2258         16  CM-OLD-LOF                    PIC XXX.
  2259*        16  CM-LOAN-OFFICER               PIC XXX.
  2260         16  CM-REIN-TABLE                 PIC XXX.
  2261         16  CM-SPECIAL-REIN-CODE          PIC X.
  2262         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2263         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2264         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2265
  2266     12  CM-STATUS-DATA.
  2267         16  CM-ENTRY-STATUS               PIC X.
  2268         16  CM-ENTRY-DT                   PIC XX.
  2269
  2270         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2271         16  CM-LF-CANCEL-DT               PIC XX.
  2272         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2273
  2274         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2275         16  CM-LF-DEATH-DT                PIC XX.
  2276         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2277
  2278         16  CM-LF-CURRENT-STATUS          PIC X.
  2279             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2280                                                'M' '4' '5' '9'.
  2281             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2282             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2283             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2284             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2285             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2286             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2287             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2288             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  44
* EL050.cbl
  2289             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2290             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2291             88  CM-LF-DECLINED               VALUE 'D'.
  2292             88  CM-LF-VOIDED                 VALUE 'V'.
  2293
  2294         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2295         16  CM-AH-CANCEL-DT               PIC XX.
  2296         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2297
  2298         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2299         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2300         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2301
  2302         16  CM-AH-CURRENT-STATUS          PIC X.
  2303             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2304                                                'M' '4' '5' '9'.
  2305             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2306             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2307             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2308             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2309             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2310             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2311             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2312             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2313             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2314             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2315             88  CM-AH-DECLINED               VALUE 'D'.
  2316             88  CM-AH-VOIDED                 VALUE 'V'.
  2317
  2318         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2319             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2320             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2321             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2322         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2323
  2324         16  CM-ENTRY-BATCH                PIC X(6).
  2325         16  CM-LF-EXIT-BATCH              PIC X(6).
  2326         16  CM-AH-EXIT-BATCH              PIC X(6).
  2327         16  CM-LAST-MONTH-END             PIC XX.
  2328
  2329     12  CM-NOTE-SW                        PIC X.
  2330         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2331         88  CERT-NOTES-PRESENT               VALUE '1'.
  2332         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2333         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2334         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2335         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2336         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2337         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2338     12  CM-COMP-EXCP-SW                   PIC X.
  2339         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2340         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2341     12  CM-INSURED-ADDRESS-SW             PIC X.
  2342         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2343         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2344
  2345*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2346     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  45
* EL050.cbl
  2347     12  FILLER                            PIC X.
  2348
  2349*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2350     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2351     12  FILLER                            PIC X.
  2352*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2353     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2354
  2355     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2356         88  CERT-ADDED-BATCH                 VALUE ' '.
  2357         88  CERT-ADDED-ONLINE                VALUE '1'.
  2358         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2359         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2360         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2361     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2362         88  CERT-AS-LOADED                   VALUE ' '.
  2363         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2364         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2365         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2366         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2367         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2368         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2369         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2370
  2371     12  CM-ACCOUNT-COMM-PCTS.
  2372         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2373         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2374
  2375     12  CM-USER-FIELD                     PIC X.
  2376     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2377     12  CM-CLP-STATE                      PIC XX.
  2378     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2379     12  CM-USER-RESERVED                  PIC XXX.
  2380     12  FILLER REDEFINES CM-USER-RESERVED.
  2381         16  CM-AH-CLASS-CD                PIC XX.
  2382         16  F                             PIC X.
  2383******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  46
* EL050.cbl
  2385*    COPY ERCMAIL.
  2386******************************************************************
  2387*                                                                *
  2388*                                                                *
  2389*                            ERCMAIL                             *
  2390*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2391*                            VMOD=2.003                          *
  2392*                                                                *
  2393*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2394*                                                                *
  2395*   FILE TYPE = VSAM,KSDS                                        *
  2396*   RECORD SIZE = 374   RECFORM = FIX                            *
  2397*                                                                *
  2398*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2399*   ALTERNATE PATH    = NOT USED                                 *
  2400*                                                                *
  2401*   LOG = YES                                                    *
  2402*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2403******************************************************************
  2404*                   C H A N G E   L O G
  2405*
  2406* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2407*-----------------------------------------------------------------
  2408*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2409* EFFECTIVE    NUMBER
  2410*-----------------------------------------------------------------
  2411* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2412* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2413* 111108                   PEMA  ADD CRED BENE ADDR2
  2414******************************************************************
  2415
  2416 01  MAILING-DATA.
  2417     12  MA-RECORD-ID                      PIC XX.
  2418         88  VALID-MA-ID                       VALUE 'MA'.
  2419
  2420     12  MA-CONTROL-PRIMARY.
  2421         16  MA-COMPANY-CD                 PIC X.
  2422         16  MA-CARRIER                    PIC X.
  2423         16  MA-GROUPING.
  2424             20  MA-GROUPING-PREFIX        PIC XXX.
  2425             20  MA-GROUPING-PRIME         PIC XXX.
  2426         16  MA-STATE                      PIC XX.
  2427         16  MA-ACCOUNT.
  2428             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2429             20  MA-ACCOUNT-PRIME          PIC X(6).
  2430         16  MA-CERT-EFF-DT                PIC XX.
  2431         16  MA-CERT-NO.
  2432             20  MA-CERT-PRIME             PIC X(10).
  2433             20  MA-CERT-SFX               PIC X.
  2434
  2435     12  FILLER                            PIC XX.
  2436
  2437     12  MA-ACCESS-CONTROL.
  2438         16  MA-SOURCE-SYSTEM              PIC XX.
  2439             88  MA-FROM-CREDIT                VALUE 'CR'.
  2440             88  MA-FROM-VSI                   VALUE 'VS'.
  2441             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2442             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  47
* EL050.cbl
  2443         16  MA-RECORD-ADD-DT              PIC XX.
  2444         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2445         16  MA-LAST-MAINT-DT              PIC XX.
  2446         16  MA-LAST-MAINT-BY              PIC XXXX.
  2447         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2448
  2449     12  MA-PROFILE-INFO.
  2450         16  MA-QUALIFY-CODE-1             PIC XX.
  2451         16  MA-QUALIFY-CODE-2             PIC XX.
  2452         16  MA-QUALIFY-CODE-3             PIC XX.
  2453         16  MA-QUALIFY-CODE-4             PIC XX.
  2454         16  MA-QUALIFY-CODE-5             PIC XX.
  2455
  2456         16  MA-INSURED-LAST-NAME          PIC X(15).
  2457         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2458         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2459         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2460         16  MA-INSURED-BIRTH-DT           PIC XX.
  2461         16  MA-INSURED-SEX                PIC X.
  2462             88  MA-SEX-MALE                   VALUE 'M'.
  2463             88  MA-SEX-FEMALE                 VALUE 'F'.
  2464         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2465
  2466         16  MA-ADDRESS-CORRECTED          PIC X.
  2467         16  MA-JOINT-BIRTH-DT             PIC XX.
  2468*        16  FILLER                        PIC X(12).
  2469
  2470         16  MA-ADDRESS-LINE-1             PIC X(30).
  2471         16  MA-ADDRESS-LINE-2             PIC X(30).
  2472         16  MA-CITY-STATE.
  2473             20  MA-CITY                   PIC X(28).
  2474             20  MA-ADDR-STATE             PIC XX.
  2475         16  MA-ZIP.
  2476             20  MA-ZIP-CODE.
  2477                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2478                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2479                 24  FILLER                PIC X(4).
  2480             20  MA-ZIP-PLUS4              PIC X(4).
  2481         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2482             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2483             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2484             20  FILLER                    PIC X(3).
  2485
  2486         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2487
  2488         16  FILLER                        PIC XXX.
  2489*        16  FILLER                        PIC X(10).
  2490
  2491     12  MA-CRED-BENE-INFO.
  2492         16  MA-CRED-BENE-NAME                 PIC X(25).
  2493         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2494         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2495         16  MA-CRED-BENE-CTYST.
  2496             20  MA-CRED-BENE-CITY             PIC X(28).
  2497             20  MA-CRED-BENE-STATE            PIC XX.
  2498         16  MA-CRED-BENE-ZIP.
  2499             20  MA-CB-ZIP-CODE.
  2500                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  48
* EL050.cbl
  2501                     88  MA-CB-CANADIAN-POST-CODE
  2502                                           VALUE 'A' THRU 'Z'.
  2503                 24  FILLER                    PIC X(4).
  2504             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2505         16  MA-CB-CANADIAN-POSTAL-CODE
  2506                            REDEFINES MA-CRED-BENE-ZIP.
  2507             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2508             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2509             20  FILLER                        PIC X(3).
  2510     12  MA-POST-CARD-MAIL-DATA.
  2511         16  MA-MAIL-DATA OCCURS 7.
  2512             20  MA-MAIL-TYPE              PIC X.
  2513                 88  MA-12MO-MAILING           VALUE '1'.
  2514                 88  MA-EXP-MAILING            VALUE '2'.
  2515             20  MA-MAIL-STATUS            PIC X.
  2516                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2517                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2518                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2519             20  MA-MAIL-DATE              PIC XX.
  2520     12  FILLER                            PIC XX.
  2521     12  FILLER                            PIC XX.
  2522*    12  FILLER                            PIC X(30).
  2523******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  49
* EL050.cbl
  2525*    COPY ERCPNDM.
  2526******************************************************************
  2527*                                                                *
  2528*                                                                *
  2529*                            ERCPNDM                             *
  2530*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2531*                            VMOD=2.003                          *
  2532*                                                                *
  2533*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2534*                                                                *
  2535*   FILE TYPE = VSAM,KSDS                                        *
  2536*   RECORD SIZE = 374   RECFORM = FIX                            *
  2537*                                                                *
  2538*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2539*   ALTERNATE PATH    = NOT USED                                 *
  2540*                                                                *
  2541*   LOG = YES                                                    *
  2542*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2543******************************************************************
  2544*                   C H A N G E   L O G
  2545*
  2546* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2547*-----------------------------------------------------------------
  2548*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2549* EFFECTIVE    NUMBER
  2550*-----------------------------------------------------------------
  2551* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2552* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2553* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2554******************************************************************
  2555
  2556 01  PENDING-MAILING-DATA.
  2557     12  PM-RECORD-ID                      PIC XX.
  2558         88  VALID-MA-ID                       VALUE 'PM'.
  2559
  2560     12  PM-CONTROL-PRIMARY.
  2561         16  PM-COMPANY-CD                 PIC X.
  2562         16  PM-ENTRY-BATCH                PIC X(6).
  2563         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2564         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2565
  2566     12  FILLER                            PIC X(14).
  2567
  2568     12  PM-ACCESS-CONTROL.
  2569         16  PM-SOURCE-SYSTEM              PIC XX.
  2570             88  PM-FROM-CREDIT                VALUE 'CR'.
  2571             88  PM-FROM-VSI                   VALUE 'VS'.
  2572             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2573             88  PM-FROM-OTHER                 VALUE 'OT'.
  2574         16  PM-RECORD-ADD-DT              PIC XX.
  2575         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2576         16  PM-LAST-MAINT-DT              PIC XX.
  2577         16  PM-LAST-MAINT-BY              PIC XXXX.
  2578         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2579
  2580     12  PM-PROFILE-INFO.
  2581         16  PM-QUALIFY-CODE-1             PIC XX.
  2582         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  50
* EL050.cbl
  2583         16  PM-QUALIFY-CODE-3             PIC XX.
  2584         16  PM-QUALIFY-CODE-4             PIC XX.
  2585         16  PM-QUALIFY-CODE-5             PIC XX.
  2586
  2587         16  PM-INSURED-LAST-NAME          PIC X(15).
  2588         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2589         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2590         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2591         16  PM-INSURED-BIRTH-DT           PIC XX.
  2592         16  PM-INSURED-SEX                PIC X.
  2593             88  PM-SEX-MALE                   VALUE 'M'.
  2594             88  PM-SEX-FEMALE                 VALUE 'F'.
  2595         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2596
  2597         16  PM-ADDRESS-CORRECTED          PIC X.
  2598         16  PM-JOINT-BIRTH-DT             PIC XX.
  2599*        16  FILLER                        PIC X(12).
  2600
  2601         16  PM-ADDRESS-LINE-1             PIC X(30).
  2602         16  PM-ADDRESS-LINE-2             PIC X(30).
  2603         16  PM-CITY-STATE.
  2604             20  PM-CITY                   PIC X(28).
  2605             20  PM-STATE                  PIC XX.
  2606         16  PM-ZIP.
  2607             20  PM-ZIP-CODE.
  2608                 24  PM-ZIP-1              PIC X.
  2609                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2610                 24  FILLER                PIC X(4).
  2611             20  PM-ZIP-PLUS4              PIC X(4).
  2612         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2613             20  PM-CAN-POST1              PIC XXX.
  2614             20  PM-CAN-POST2              PIC XXX.
  2615             20  FILLER                    PIC XXX.
  2616
  2617         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2618
  2619         16  FILLER                        PIC X(03).
  2620
  2621     12  PM-CRED-BENE-INFO.
  2622         16  PM-CRED-BENE-NAME             PIC X(25).
  2623         16  PM-CRED-BENE-ADDR             PIC X(30).
  2624         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2625         16  PM-CRED-BENE-CTYST.
  2626             20  PM-CRED-BENE-CITY         PIC X(28).
  2627             20  PM-CRED-BENE-STATE        PIC XX.
  2628         16  PM-CRED-BENE-ZIP.
  2629             20  PM-CB-ZIP-CODE.
  2630                 24  PM-CB-ZIP-1           PIC X.
  2631                     88  PM-CB-CANADIAN-POST-CODE
  2632                                  VALUE 'A' THRU 'Z'.
  2633                 24  FILLER                PIC X(4).
  2634             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2635         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2636             20  PM-CB-CAN-POST1           PIC XXX.
  2637             20  PM-CB-CAN-POST2           PIC XXX.
  2638             20  FILLER                    PIC XXX.
  2639     12  PM-POST-CARD-MAIL-DATA.
  2640         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  51
* EL050.cbl
  2641             20  PM-MAIL-TYPE              PIC X.
  2642                 88  PM-12MO-MAILING           VALUE '1'.
  2643                 88  PM-EXP-MAILING            VALUE '2'.
  2644             20  PM-MAIL-STATUS            PIC X.
  2645                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2646                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2647                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2648             20  PM-MAIL-DATE              PIC XX.
  2649     12  FILLER                            PIC XX.
  2650     12  FILLER                            PIC X(12).
  2651*    12  FILLER                            PIC X(30).
  2652
  2653******************************************************************
  2654*                                COPY ERCLOFC.
  2655******************************************************************
  2656*                                                                *
  2657*                                                                *
  2658*                            ERCLOFC                             *
  2659*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2660*                            VMOD=2.003                          *
  2661*                                                                *
  2662*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2663*                                                                *
  2664*   FILE TYPE = VSAM,KSDS                                        *
  2665*   RECORD SIZE = 670   RECFORM = FIX                            *
  2666*                                                                *
  2667*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2668*                                                                *
  2669*   LOG = YES                                                    *
  2670*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2671*                                                                *
  2672******************************************************************
  2673
  2674 01  LOAN-OFFICER-MASTER.
  2675     12  LO-RECORD-ID                PIC XX.
  2676         88  VALID-LO-ID                VALUE 'LO'.
  2677
  2678     12  LO-CONTROL-PRIMARY.
  2679         16  LO-COMPANY-CD           PIC X.
  2680         16  LO-CARRIER              PIC X.
  2681         16  LO-GROUPING.
  2682             20  LO-GROUPING-PREFIX  PIC XXX.
  2683             20  LO-GROUPING-PRIME   PIC XXX.
  2684         16  LO-STATE                PIC XX.
  2685         16  LO-ACCOUNT.
  2686             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2687             20  LO-ACCOUNT-PRIME    PIC X(6).
  2688         16  LO-OFFICER-CODE         PIC X(5).
  2689
  2690     12  LO-OFFICER-NAME             PIC X(30).
  2691
  2692     12  LO-LAST-MAINT-DT            PIC XX.
  2693     12  LO-LAST-USER                PIC X(4).
  2694     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2695
  2696     12  LO-COMP-CONTROL             PIC X.
  2697             88  LO-SHOW-COMP           VALUE 'Y'.
  2698             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  52
* EL050.cbl
  2699     12  LO-DETAIL-CONTROL           PIC X.
  2700             88  LO-PRINT-DETAIL        VALUE 'D'.
  2701             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2702
  2703     12  LO-SV-CARRIER               PIC X.
  2704     12  LO-SV-GROUPING              PIC X(6).
  2705     12  LO-SV-STATE                 PIC XX.
  2706
  2707     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2708     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2709
  2710     12  LO-OFFICER-INFO.
  2711         16  FILLER OCCURS 12 TIMES.
  2712             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2713             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2714             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2715             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2716             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2717             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2718             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2719             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2720     12  FILLER                      PIC X(198).
  2721******************************************************************
  2722*                                COPY ERCPDEF.
  2723******************************************************************
  2724*                                                                *
  2725*                                                                *
  2726*                            ERCPDEF.                            *
  2727*                                                                *
  2728*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2729*                                                                *
  2730*    FILE TYPE = VSAM,KSDS                                       *
  2731*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2732*                                                                *
  2733*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2734*                                                                *
  2735*    LOG = YES                                                   *
  2736*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2737******************************************************************
  2738 01  PRODUCT-MASTER.
  2739    12  PD-RECORD-ID                 PIC X(02).
  2740        88  VALID-PD-ID                  VALUE 'PD'.
  2741    12  PD-CONTROL-PRIMARY.
  2742        16  PD-COMPANY-CD            PIC X.
  2743        16  PD-STATE                 PIC XX.
  2744        16  PD-PRODUCT-CD            PIC XXX.
  2745        16  PD-FILLER                PIC X(7).
  2746        16  PD-BEN-TYPE              PIC X.
  2747        16  PD-BEN-CODE              PIC XX.
  2748        16  PD-PROD-EXP-DT           PIC XX.
  2749    12  FILLER                       PIC X(50).
  2750    12  PD-PRODUCT-DATA OCCURS 8.
  2751        16  PD-PROD-CODE             PIC X.
  2752            88  PD-PROD-LIFE           VALUE 'L'.
  2753            88  PD-PROD-PROP           VALUE 'P'.
  2754            88  PD-PROD-AH             VALUE 'A'.
  2755            88  PD-PROD-IU             VALUE 'I'.
  2756            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  53
* EL050.cbl
  2757        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2758        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2759        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2760        16  PD-MAX-TERM              PIC S999        COMP-3.
  2761        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2762        16  FILLER                   PIC X.
  2763        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2764        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2765        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2766        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2767        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2768        16  PD-REC-CRIT-PERIOD       PIC X.
  2769        16  PD-RTW-MOS               PIC 99.
  2770        16  FILLER                   PIC X(5).
  2771    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2772    12  PD-TERM-LIMITS OCCURS 15.
  2773        16  PD-LOW-TERM              PIC S999        COMP-3.
  2774        16  PD-HI-TERM               PIC S999        COMP-3.
  2775*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2776    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2777        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2778        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2779    12  PD-EARN-FACTORS.
  2780        16  FILLER OCCURS 15.
  2781            20  FILLER OCCURS 15.
  2782                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2783    12  PD-PRODUCT-DESC              PIC X(80).
  2784    12  PD-TRUNCATED                 PIC X.
  2785    12  FILLER                       PIC X(59).
  2786    12  PD-MAINT-INFORMATION.
  2787        16  PD-LAST-MAINT-DT         PIC X(02).
  2788        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2789        16  PD-LAST-MAINT-BY         PIC X(04).
  2790*                                COPY ELCSTATE.
  2791******************************************************************
  2792*                                                                *
  2793*                                                                *
  2794*                            ELCSTATE.                           *
  2795*                                                                *
  2796*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2797*                                                                *
  2798*   FILE TYPE = VSAM,KSDS                                        *
  2799*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2800*                                                                *
  2801*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2802*       ALTERNATE INDEX = NONE                                   *
  2803*                                                                *
  2804*   LOG = YES                                                    *
  2805*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2806******************************************************************
  2807*                   C H A N G E   L O G
  2808*
  2809* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2810*-----------------------------------------------------------------
  2811*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2812* EFFECTIVE    NUMBER
  2813*-----------------------------------------------------------------
  2814* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  54
* EL050.cbl
  2815******************************************************************
  2816*
  2817 01  STATE-FILE.
  2818     12  SF-RECORD-ID                       PIC XX.
  2819         88  VALID-CF-ID                        VALUE 'SF'.
  2820     12  SF-CONTROL-PRIMARY.
  2821         16  SF-COMPANY-ID                  PIC XXX.
  2822         16  SF-CARRIER-CODE                PIC X.
  2823         16  SF-GROUPING                    PIC X(6).
  2824         16  SF-STATE-CODE                  PIC XX.
  2825         16  SF-EXPIRE-DATE                 PIC 9(8).
  2826****************************************************************
  2827*             STATE CONTROLS
  2828****************************************************************
  2829     12  SF-LAST-MAINT-DT                   PIC XX.
  2830     12  SF-LAST-MAINT-BY                   PIC X(4).
  2831     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2832     12  SF-STATE-RT-CONTROLS.
  2833         16  SF-ST-RT-CALC                  PIC X.
  2834     12  SF-ST-TAX-CONTROLS.
  2835         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2836         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2837         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2838     12  SF-ST-REFUND-OPTIONS.
  2839         16  SF-ST-RF-LR-CALC               PIC X.
  2840         16  SF-ST-RF-LL-CALC               PIC X.
  2841         16  SF-ST-RF-LN-CALC               PIC X.
  2842         16  SF-ST-RF-AH-CALC               PIC X.
  2843         16  SF-ST-RF-CP-CALC               PIC X.
  2844     12  SF-ST-UNEARN-PREM-OPTIONS.
  2845         16  SF-ST-LUEP-R78                 PIC X.
  2846         16  SF-ST-LUEP-PRO                 PIC X.
  2847         16  SF-ST-LUEP-ST                  PIC X.
  2848         16  SF-ST-LUEP-DOM                 PIC X.
  2849         16  SF-ST-AUEP-R78                 PIC X.
  2850         16  SF-ST-AUEP-PRO                 PIC X.
  2851         16  SF-ST-AUEP-ST                  PIC X.
  2852         16  SF-ST-AUEP-DOM                 PIC X.
  2853         16  SF-ST-CUEP-R78                 PIC X.
  2854         16  SF-ST-CUEP-PRO                 PIC X.
  2855         16  SF-ST-CUEP-ST                  PIC X.
  2856         16  SF-ST-CUEP-DOM                 PIC X.
  2857     12  SF-ST-EARN-PREM-OPTIONS.
  2858         16  SF-ST-LEP-R78                  PIC X.
  2859         16  SF-ST-LEP-PRO                  PIC X.
  2860         16  SF-ST-LEP-ST                   PIC X.
  2861         16  SF-ST-LEP-DOM                  PIC X.
  2862         16  SF-ST-AEP-R78                  PIC X.
  2863         16  SF-ST-AEP-PRO                  PIC X.
  2864         16  SF-ST-AEP-ST                   PIC X.
  2865         16  SF-ST-AEP-DOM                  PIC X.
  2866         16  SF-ST-CEP-R78                  PIC X.
  2867         16  SF-ST-CEP-PRO                  PIC X.
  2868         16  SF-ST-CEP-ST                   PIC X.
  2869         16  SF-ST-CEP-DOM                  PIC X.
  2870     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  55
* EL050.cbl
  2872*    COPY ELCCRTT.
  2873******************************************************************
  2874*                                                                *
  2875*                            ELCCRTT.                            *
  2876*                                                                *
  2877*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2878*                                                                *
  2879*   FILE TYPE = VSAM,KSDS                                        *
  2880*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2881*                                                                *
  2882*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2883*                                                                *
  2884*   LOG = YES                                                    *
  2885*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2886******************************************************************
  2887*                   C H A N G E   L O G
  2888*
  2889* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2890*-----------------------------------------------------------------
  2891*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2892* EFFECTIVE    NUMBER
  2893*-----------------------------------------------------------------
  2894* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2895* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2896* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2897* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2898* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2899******************************************************************
  2900
  2901 01  CERTIFICATE-TRAILERS.
  2902     12  CS-RECORD-ID                      PIC XX.
  2903         88  VALID-CS-ID                      VALUE 'CS'.
  2904
  2905     12  CS-CONTROL-PRIMARY.
  2906         16  CS-COMPANY-CD                 PIC X.
  2907         16  CS-CARRIER                    PIC X.
  2908         16  CS-GROUPING                   PIC X(6).
  2909         16  CS-STATE                      PIC XX.
  2910         16  CS-ACCOUNT                    PIC X(10).
  2911         16  CS-CERT-EFF-DT                PIC XX.
  2912         16  CS-CERT-NO.
  2913             20  CS-CERT-PRIME             PIC X(10).
  2914             20  CS-CERT-SFX               PIC X.
  2915         16  CS-TRAILER-TYPE               PIC X.
  2916             88  COMM-TRLR           VALUE 'A'.
  2917             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2918             88  CERT-DATA-TRLR      VALUE 'C'.
  2919
  2920     12  CS-DATA-AREA                      PIC X(516).
  2921
  2922     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2923         16  CS-BANK-COMMISSION-AREA.
  2924             20  CS-BANK-COMMS       OCCURS 10.
  2925                 24  CS-AGT                PIC X(10).
  2926                 24  CS-COM-TYP            PIC X.
  2927                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2928                 24  CS-RECALC-LV-INDIC    PIC X.
  2929                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  56
* EL050.cbl
  2930         16  FILLER                        PIC X(256).
  2931
  2932     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2933****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2934****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2935         16  CS-MB-CLAIM-DATA OCCURS 2.
  2936             20  FILLER OCCURS 10.
  2937                 24  CS-CLAIM-TYPE         PIC X.
  2938                     88  CS-AH-CLM           VALUE 'A'.
  2939                     88  CS-IU-CLM           VALUE 'I'.
  2940                     88  CS-GP-CLM           VALUE 'G'.
  2941                     88  CS-LF-CLM           VALUE 'L'.
  2942                     88  CS-PR-CLM           VALUE 'P'.
  2943                 24  CS-BANK               PIC S999 COMP-3.
  2944                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2945                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2946                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2947         16  FILLER                        PIC X(216).
  2948     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2949         16  CS-VIN-NUMBER                 PIC X(17).
  2950         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2951         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2952         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2953         16  FILLER                        PIC X(496).
  2954******************************************************************
  2955*    COPY ELCCRTO.
  2956******************************************************************
  2957*                                                                *
  2958*                            ELCCRTO.                            *
  2959*                                                                *
  2960*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2961*                                                                *
  2962*   FILE TYPE = VSAM,KSDS                                        *
  2963*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2964*                                                                *
  2965*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2966*                                                                *
  2967*   LOG = YES                                                    *
  2968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2969******************************************************************
  2970*                   C H A N G E   L O G
  2971*
  2972* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2973*-----------------------------------------------------------------
  2974*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2975* EFFECTIVE    NUMBER
  2976*-----------------------------------------------------------------
  2977* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2978* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2979* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2980* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2981* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2982******************************************************************
  2983 01  ORIGINAL-CERTIFICATE.
  2984     12  OC-RECORD-ID                      PIC XX.
  2985         88  VALID-OC-ID                      VALUE 'OC'.
  2986     12  OC-CONTROL-PRIMARY.
  2987         16  OC-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  57
* EL050.cbl
  2988         16  OC-CARRIER                    PIC X.
  2989         16  OC-GROUPING                   PIC X(6).
  2990         16  OC-STATE                      PIC XX.
  2991         16  OC-ACCOUNT                    PIC X(10).
  2992         16  OC-CERT-EFF-DT                PIC XX.
  2993         16  OC-CERT-NO.
  2994             20  OC-CERT-PRIME             PIC X(10).
  2995             20  OC-CERT-SFX               PIC X.
  2996         16  OC-RECORD-TYPE                PIC X.
  2997         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2998     12  OC-LAST-MAINT-DT                  PIC XX.
  2999     12  OC-LAST-MAINT-BY                  PIC X(4).
  3000     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3001     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3002     12  FILLER                            PIC X(49).
  3003     12  OC-ORIG-REC.
  3004         16  OC-INS-LAST-NAME              PIC X(15).
  3005         16  OC-INS-FIRST-NAME             PIC X(10).
  3006         16  OC-INS-MIDDLE-INIT            PIC X.
  3007         16  OC-INS-AGE                    PIC S999     COMP-3.
  3008         16  OC-JNT-LAST-NAME              PIC X(15).
  3009         16  OC-JNT-FIRST-NAME             PIC X(10).
  3010         16  OC-JNT-MIDDLE-INIT            PIC X.
  3011         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3012         16  OC-LF-BENCD                   PIC XX.
  3013         16  OC-LF-TERM                    PIC S999      COMP-3.
  3014         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3015         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3016         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3017         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3018         16  OC-LF-EXP-DT                  PIC XX.
  3019         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3020         16  OC-LF-CANCEL-DT               PIC XX.
  3021         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3022         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3023         16  OC-AH-BENCD                   PIC XX.
  3024         16  OC-AH-TERM                    PIC S999      COMP-3.
  3025         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3026         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3027         16  OC-AH-EXP-DT                  PIC XX.
  3028         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3029         16  OC-AH-CP                      PIC 99.
  3030         16  OC-AH-CANCEL-DT               PIC XX.
  3031         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3032         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3033         16  OC-CRED-BENE-NAME             PIC X(25).
  3034         16  OC-1ST-PMT-DT                 PIC XX.
  3035         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3036         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3037         16  OC-ISSUE-TRAN-IND             PIC X.
  3038         16  OC-CANCEL-TRAN-IND            PIC X.
  3039         16  FILLER                        PIC X(211).
  3040
  3041     12  FILLER                            PIC X(50).
  3042******************************************************************
  3043
  3044*    COPY ELCDATE.
  3045******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  58
* EL050.cbl
  3046*                                                                *
  3047*                                                                *
  3048*                            ELCDATE.                            *
  3049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3050*                            VMOD=2.003
  3051*                                                                *
  3052*                                                                *
  3053*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3054*                 LENGTH = 200                                   *
  3055******************************************************************
  3056
  3057 01  DATE-CONVERSION-DATA.
  3058     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3059     12  DC-OPTION-CODE                PIC X.
  3060         88  BIN-TO-GREG                VALUE ' '.
  3061         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3062         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3063         88  YMD-GREG-TO-BIN            VALUE '3'.
  3064         88  MDY-GREG-TO-BIN            VALUE '4'.
  3065         88  JULIAN-TO-BIN              VALUE '5'.
  3066         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3067         88  FIND-CENTURY               VALUE '7'.
  3068         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3069         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3070         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3071         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3072         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3073         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3074         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3075         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3076         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3077         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3078         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3079         88  BIN-3-TO-GREG              VALUE 'I'.
  3080         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3081         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3082         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3083         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3084         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3085         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3086         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3087         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3088         88  THREE-CHARACTER-BIN
  3089                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3090         88  GREGORIAN-TO-BIN
  3091                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3092         88  BIN-TO-GREGORIAN
  3093                  VALUES ' ' '1' 'I' '8' 'G'.
  3094         88  JULIAN-TO-BINARY
  3095                  VALUES '5' 'C' 'E' 'F'.
  3096     12  DC-ERROR-CODE                 PIC X.
  3097         88  NO-CONVERSION-ERROR        VALUE ' '.
  3098         88  DATE-CONVERSION-ERROR
  3099                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3100         88  DATE-IS-ZERO               VALUE '1'.
  3101         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3102         88  DATE-IS-INVALID            VALUE '3'.
  3103         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  59
* EL050.cbl
  3104         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3105         88  DATE-INVALID-OPTION        VALUE '9'.
  3106         88  INVALID-CENTURY            VALUE 'A'.
  3107         88  ONLY-CENTURY               VALUE 'B'.
  3108         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3109         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3110     12  DC-END-OF-MONTH               PIC X.
  3111         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3112     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3113         88  USE-NORMAL-PROCESS         VALUE ' '.
  3114         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3115         88  ADJUST-UP-100-YRS          VALUE '2'.
  3116     12  FILLER                        PIC X.
  3117     12  DC-CONVERSION-DATES.
  3118         16  DC-BIN-DATE-1             PIC XX.
  3119         16  DC-BIN-DATE-2             PIC XX.
  3120         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3121         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3122                       DC-GREG-DATE-1-EDIT.
  3123             20  DC-EDIT1-MONTH        PIC 99.
  3124             20  SLASH1-1              PIC X.
  3125             20  DC-EDIT1-DAY          PIC 99.
  3126             20  SLASH1-2              PIC X.
  3127             20  DC-EDIT1-YEAR         PIC 99.
  3128         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3129         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3130                     DC-GREG-DATE-2-EDIT.
  3131             20  DC-EDIT2-MONTH        PIC 99.
  3132             20  SLASH2-1              PIC X.
  3133             20  DC-EDIT2-DAY          PIC 99.
  3134             20  SLASH2-2              PIC X.
  3135             20  DC-EDIT2-YEAR         PIC 99.
  3136         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3137         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3138                     DC-GREG-DATE-1-YMD.
  3139             20  DC-YMD-YEAR           PIC 99.
  3140             20  DC-YMD-MONTH          PIC 99.
  3141             20  DC-YMD-DAY            PIC 99.
  3142         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3143         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3144                      DC-GREG-DATE-1-MDY.
  3145             20  DC-MDY-MONTH          PIC 99.
  3146             20  DC-MDY-DAY            PIC 99.
  3147             20  DC-MDY-YEAR           PIC 99.
  3148         16  DC-GREG-DATE-1-ALPHA.
  3149             20  DC-ALPHA-MONTH        PIC X(10).
  3150             20  DC-ALPHA-DAY          PIC 99.
  3151             20  FILLER                PIC XX.
  3152             20  DC-ALPHA-CENTURY.
  3153                 24 DC-ALPHA-CEN-N     PIC 99.
  3154             20  DC-ALPHA-YEAR         PIC 99.
  3155         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3156         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3157         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3158         16  DC-JULIAN-DATE            PIC 9(05).
  3159         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3160                                       PIC 9(05).
  3161         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  60
* EL050.cbl
  3162             20  DC-JULIAN-YEAR        PIC 99.
  3163             20  DC-JULIAN-DAYS        PIC 999.
  3164         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3165         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3166         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3167     12  DATE-CONVERSION-VARIBLES.
  3168         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3169         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3170             20  FILLER                PIC 9(3).
  3171             20  HOLD-CEN-1-CCYY.
  3172                 24  HOLD-CEN-1-CC     PIC 99.
  3173                 24  HOLD-CEN-1-YY     PIC 99.
  3174             20  HOLD-CEN-1-MO         PIC 99.
  3175             20  HOLD-CEN-1-DA         PIC 99.
  3176         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3177             20  HOLD-CEN-1-R-MO       PIC 99.
  3178             20  HOLD-CEN-1-R-DA       PIC 99.
  3179             20  HOLD-CEN-1-R-CCYY.
  3180                 24  HOLD-CEN-1-R-CC   PIC 99.
  3181                 24  HOLD-CEN-1-R-YY   PIC 99.
  3182             20  FILLER                PIC 9(3).
  3183         16  HOLD-CENTURY-1-X.
  3184             20  FILLER                PIC X(3)  VALUE SPACES.
  3185             20  HOLD-CEN-1-X-CCYY.
  3186                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3187                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3188             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3189             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3190         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3191             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3192             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3193             20  HOLD-CEN-1-R-X-CCYY.
  3194                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3195                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3196             20  FILLER                PIC XXX.
  3197         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3198         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3199         16  DC-JULIAN-DATE-1          PIC 9(07).
  3200         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3201             20  DC-JULIAN-1-CCYY.
  3202                 24  DC-JULIAN-1-CC    PIC 99.
  3203                 24  DC-JULIAN-1-YR    PIC 99.
  3204             20  DC-JULIAN-DA-1        PIC 999.
  3205         16  DC-JULIAN-DATE-2          PIC 9(07).
  3206         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3207             20  DC-JULIAN-2-CCYY.
  3208                 24  DC-JULIAN-2-CC    PIC 99.
  3209                 24  DC-JULIAN-2-YR    PIC 99.
  3210             20  DC-JULIAN-DA-2        PIC 999.
  3211         16  DC-GREG-DATE-A-EDIT.
  3212             20  DC-EDITA-MONTH        PIC 99.
  3213             20  SLASHA-1              PIC X VALUE '/'.
  3214             20  DC-EDITA-DAY          PIC 99.
  3215             20  SLASHA-2              PIC X VALUE '/'.
  3216             20  DC-EDITA-CCYY.
  3217                 24  DC-EDITA-CENT     PIC 99.
  3218                 24  DC-EDITA-YEAR     PIC 99.
  3219         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  61
* EL050.cbl
  3220             20  DC-EDITB-MONTH        PIC 99.
  3221             20  SLASHB-1              PIC X VALUE '/'.
  3222             20  DC-EDITB-DAY          PIC 99.
  3223             20  SLASHB-2              PIC X VALUE '/'.
  3224             20  DC-EDITB-CCYY.
  3225                 24  DC-EDITB-CENT     PIC 99.
  3226                 24  DC-EDITB-YEAR     PIC 99.
  3227         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3228         16  DC-GREG-DATE-CYMD-R REDEFINES
  3229                              DC-GREG-DATE-CYMD.
  3230             20  DC-CYMD-CEN           PIC 99.
  3231             20  DC-CYMD-YEAR          PIC 99.
  3232             20  DC-CYMD-MONTH         PIC 99.
  3233             20  DC-CYMD-DAY           PIC 99.
  3234         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3235         16  DC-GREG-DATE-MDCY-R REDEFINES
  3236                              DC-GREG-DATE-MDCY.
  3237             20  DC-MDCY-MONTH         PIC 99.
  3238             20  DC-MDCY-DAY           PIC 99.
  3239             20  DC-MDCY-CEN           PIC 99.
  3240             20  DC-MDCY-YEAR          PIC 99.
  3241    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3242        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3243    12  DC-EL310-DATE                  PIC X(21).
  3244    12  FILLER                         PIC X(28).
  3245
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  62
* EL050.cbl
  3247*    COPY ELCCALC.
  3248******************************************************************
  3249*                                                                *
  3250*                           ELCCALC.                            *
  3251*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3252*                            VMOD=2.025                          *
  3253*                                                                *
  3254*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3255*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3256*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3257*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3258*                                                                *
  3259*  PASSED TO ELRTRM                                              *
  3260*  -----------------                                             *
  3261*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3262*  ORIGINAL TERM                                                 *
  3263*  BEGINNING DATE                                                *
  3264*  ENDING DATE                                                   *
  3265*  COMPANY I.D.                                                  *
  3266*  ACCOUNT MASTER USER FIELD                                     *
  3267*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3268*  FREE LOOK DAYS                                                *
  3269*                                                                *
  3270*  RETURNED FROM ELRTRM                                          *
  3271*  ---------------------                                         *
  3272*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3273*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3274*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3275*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3276*----------------------------------------------------------------*
  3277*  PASSED TO ELRAMT                                              *
  3278*  ----------------                                              *
  3279*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3280*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3281*  ORIGINAL AMOUNT                                               *
  3282*  ALTERNATE BENEFIT (BALLON)                                    *
  3283*  A.P.R. - NET PAY ONLY                                         *
  3284*  METHOD
  3285*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3286*  COMPANY I.D.                                                  *
  3287*  BENEFIT TYPE                                                  *
  3288*                                                                *
  3289*  RETURNED FROM ELRAMT                                          *
  3290*  --------------------                                          *
  3291*  REMAINING AMOUNT 1 - CURRENT                                  *
  3292*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3293*  REMAINING AMOUNT FACTOR
  3294*----------------------------------------------------------------*
  3295*  PASSED TO ELRESV                                              *
  3296*  -----------------                                             *
  3297*  CERTIFICATE EFFECTIVE DATE                                    *
  3298*  VALUATION DATE                                                *
  3299*  PAID THRU DATE                                                *
  3300*  BENEFIT                                                       *
  3301*  INCURRED DATE                                                 *
  3302*  REPORTED DATE                                                 *
  3303*  ISSUE AGE                                                     *
  3304*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  63
* EL050.cbl
  3305*  CDT PERCENT                                                   *
  3306*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3307* *CLAIM TYPE (LIFE, A/H)                                        *
  3308* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3309* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3310*                                                                *
  3311*  RETURNED FROM ELRESV                                          *
  3312*  --------------------                                          *
  3313*  CDT TABLE USED                                                *
  3314*  CDT FACTOR USED                                               *
  3315*  PAY TO CURRENT RESERVE                                        *
  3316*  I.B.N.R. - A/H ONLY                                           *
  3317*  FUTURE (ACCRUED) AH ONLY                                      *
  3318*----------------------------------------------------------------*
  3319*  PASSED TO ELRATE                                              *
  3320*  ----------------                                              *
  3321*  CERT ISSUE DATE                                               *
  3322*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3323*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3324*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3325*  STATE CODE (CLIENT DEFINED)                                   *
  3326*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3327*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3328*  DEVIATION CODE                                                *
  3329*  ISSUE AGE                                                     *
  3330*  ORIGINAL BENEFIT AMOUNT                                       *
  3331*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3332*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3333*  BENEFIT KIND (LIFE OR A/H)                                    *
  3334*  A.P.R.                                                        *
  3335*  METHOD
  3336*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3337*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3338*  COMPANY I.D. (3 CHARACTER)                                    *
  3339*  BENEFIT CODE                                                  *
  3340*  BENEFIT OVERRIDE CODE                                         *
  3341*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3342*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3343*  JOINT INDICATOR (CSL ONLY)                                    *
  3344*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3345*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3346*                                                                *
  3347*  RETURNED FROM ELRATE                                          *
  3348*  --------------------                                          *
  3349*  CALCULATED PREMIUM                                            *
  3350*  PREMIUM RATE                                                  *
  3351*  MORTALITY CODE                                                *
  3352*  MAX ATTAINED AGE                                              *
  3353*  MAX AGE                                                       *
  3354*  MAX TERM                                                      *
  3355*  MAX MONTHLY BENEFIT                                           *
  3356*  MAX TOTAL BENIFIT                                             *
  3357*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3358*----------------------------------------------------------------*
  3359*  PASSED TO ELRFND                                              *
  3360*  ----------------                                              *
  3361*  CERT ISSUE DATE                                               *
  3362*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  64
* EL050.cbl
  3363*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3364*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3365*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3366*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3367*  STATE CODE (CLIENT DEFINED)                                   *
  3368*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3369*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3370*  DEVIATION CODE                                                *
  3371*  ISSUE AGE                                                     *
  3372*  ORIGINAL BENEFIT AMOUNT                                       *
  3373*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3374*  PROCESS TYPE (CANCEL)                                         *
  3375*  BENEFIT KIND (LIFE OR A/H)                                    *
  3376*  A.P.R.                                                        *
  3377*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3378*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3379*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3380*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3381*  COMPANY I.D. (3 CHARACTER)                                    *
  3382*  BENEFIT CODE                                                  *
  3383*  BENEFIT OVERRIDE CODE                                         *
  3384*                                                                *
  3385*  RETURNED FROM ELRFND                                          *
  3386*  --------------------                                          *
  3387*  CALCULATED REFUND                                             *
  3388*----------------------------------------------------------------*
  3389*  PASSED TO ELEARN                                              *
  3390*  ----------------                                              *
  3391*  CERT ISSUE DATE                                               *
  3392*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3393*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3394*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3395*  STATE CODE (CLIENT DEFINED)                                   *
  3396*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3397*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3398*  DEVIATION CODE                                                *
  3399*  ISSUE AGE                                                     *
  3400*  ORIGINAL BENEFIT AMOUNT                                       *
  3401*  BENEFIT KIND (LIFE OR A/H)                                    *
  3402*  A.P.R.                                                        *
  3403*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3404*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3405*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3406*  COMPANY I.D. (3 CHARACTER)                                    *
  3407*  BENEFIT CODE                                                  *
  3408*  BENEFIT OVERRIDE CODE                                         *
  3409*                                                                *
  3410*  RETURNED FROM ELEARN                                          *
  3411*  --------------------                                          *
  3412*  INDICATED  EARNINGS                                           *
  3413*----------------------------------------------------------------*
  3414*                 LENGTH = 450                                   *
  3415*                                                                *
  3416******************************************************************
  3417******************************************************************
  3418*                   C H A N G E   L O G
  3419*
  3420* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  65
* EL050.cbl
  3421*-----------------------------------------------------------------
  3422*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3423* EFFECTIVE    NUMBER
  3424*-----------------------------------------------------------------
  3425* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3426* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3427* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3428* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3429* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3430* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3431* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3432* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3433* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3434******************************************************************
  3435
  3436 01  CALCULATION-PASS-AREA.
  3437     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3438                                     COMP.
  3439
  3440     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3441       88  NO-CP-ERROR                             VALUE ZERO.
  3442       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3443                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3444       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3445       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3446       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3447       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3448       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3449       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3450       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3451       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3452       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3453       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3454       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3455       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3456       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3457       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3458       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3459       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3460       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3461
  3462     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3463       88  NO-CP-ERROR-2                           VALUE ZERO.
  3464***********************  INPUT AREAS ****************************
  3465
  3466     12  CP-CALCULATION-AREA.
  3467         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3468         16  CP-CERT-EFF-DT        PIC XX.
  3469         16  CP-VALUATION-DT       PIC XX.
  3470         16  CP-PAID-THRU-DT       PIC XX.
  3471         16  CP-BENEFIT-TYPE       PIC X.
  3472           88  CP-AH                               VALUE 'A' 'D'
  3473                                                   'I' 'U'.
  3474           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3475           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3476         16  CP-INCURRED-DT        PIC XX.
  3477         16  CP-REPORTED-DT        PIC XX.
  3478         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  66
* EL050.cbl
  3479         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3480         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3481                                     COMP-3.
  3482         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3483                                     COMP-3.
  3484         16  CP-CDT-METHOD         PIC X.
  3485           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3486           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3487           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3488         16  CP-CLAIM-TYPE         PIC X.
  3489           88  CP-AH-CLAIM                         VALUE 'A'.
  3490           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3491         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3492                                     COMP-3.
  3493         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3494                                     COMP-3.
  3495         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3496                                     COMP-3.
  3497         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3498                                     COMP-3.
  3499         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3500                                     COMP-3.
  3501         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3502                                     COMP-3.
  3503         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3504                                     COMP-3.
  3505         16  CP-REM-TERM-METHOD    PIC X.
  3506           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3507           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3508           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3509           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3510           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3511           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3512           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3513         16  CP-EARNING-METHOD     PIC X.
  3514           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3515           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3516           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3517           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3518           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3519           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3520           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3521           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3522           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3523           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3524           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3525           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3526           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3527           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3528         16  CP-PROCESS-TYPE       PIC X.
  3529           88  CP-CLAIM                            VALUE '1'.
  3530           88  CP-CANCEL                           VALUE '2'.
  3531           88  CP-ISSUE                            VALUE '3'.
  3532         16  CP-SPECIAL-CALC-CD    PIC X.
  3533           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3534           88  CP-1-MTH-INTEREST               VALUE ' '.
  3535           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3536           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  67
* EL050.cbl
  3537           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3538           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3539           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3540           88  CP-FARM-PLAN                    VALUE 'F'.
  3541           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3542           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3543           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3544           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3545           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3546           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3547           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3548           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3549           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3550           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3551                                                     'W' 'X'.
  3552           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3553           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3554           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3555           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3556           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3557           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3558           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3559           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3560           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3561           88  CP-CSL-METH-1                   VALUE '5'.
  3562           88  CP-CSL-METH-2                   VALUE '6'.
  3563           88  CP-CSL-METH-3                   VALUE '7'.
  3564           88  CP-CSL-METH-4                   VALUE '8'.
  3565
  3566         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3567                                     COMP-3.
  3568         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3569         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3570         16  CP-STATE              PIC XX          VALUE SPACE.
  3571         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3572         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3573           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3574               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3575         16  CP-R78-OPTION         PIC X.
  3576           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3577           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3578
  3579         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3580         16  CP-IBNR-RESERVE-SW    PIC X.
  3581         16  CP-CLAIM-STATUS       PIC X.
  3582         16  CP-RATE-FILE          PIC X.
  3583         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3584                                     COMP-3.
  3585
  3586         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3587         16  CP-AH-OVERRIDE-CODE   PIC X.
  3588
  3589         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3592                                   PIC S9(5)V99 COMP-3.
  3593         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3594                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  68
* EL050.cbl
  3595         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3596                                     COMP-3.
  3597         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3598                                     COMP-3.
  3599         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3600                                  PIC S9(7)V99 COMP-3.
  3601
  3602         16  CP-PAID-FROM-DATE     PIC X(02).
  3603         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3604         16  CP-EXT-DAYS-CALC      PIC X.
  3605           88  CP-EXT-NO-CHG                   VALUE ' '.
  3606           88  CP-EXT-CHG-LF                   VALUE '1'.
  3607           88  CP-EXT-CHG-AH                   VALUE '2'.
  3608           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3609         16  CP-DOMICILE-STATE     PIC XX.
  3610         16  CP-CARRIER            PIC X.
  3611         16  CP-REIN-FLAG          PIC X.
  3612         16  CP-REM-TRM-CALC-OPTION PIC X.
  3613           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3614                      '2' '3' '4' '5'.
  3615           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3616           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3617           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3618           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3619           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3620           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3621           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3622           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3623         16  CP-SIG-SWITCH         PIC X.
  3624         16  CP-RATING-METHOD      PIC X.
  3625           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3626           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3627           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3628           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3629           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3630           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3631           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3632           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3633           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3634         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3635                                     COMP-3.
  3636         16  CP-BEN-CATEGORY       PIC X.
  3637         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3638         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3639                                   PIC S99V9(5) COMP-3.
  3640         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3641         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3642                                   PIC S99V9(5) COMP-3.
  3643         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3644         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3645         16  CP-EXPIRE-DT          PIC XX.
  3646         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3647         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3648         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3649         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3650         16  CP-DDF-SPEC-CALC      PIC X.
  3651             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3652             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  69
* EL050.cbl
  3653         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3654         16  CP-CANCEL-REASON      PIC X.
  3655         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3656         16  CP-PMT-MODE           PIC X.
  3657         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3658         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3659         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3660         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3661         16  FILLER                PIC X.
  3662
  3663***************    OUTPUT FROM ELRESV   ************************
  3664
  3665         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3666
  3667         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3668                                     COMP-3.
  3669         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3670                                     COMP-3.
  3671         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3672                                     COMP-3.
  3673         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3674                                     COMP-3.
  3675         16  FILLER                PIC X(09).
  3676***************    OUTPUT FROM ELRTRM   *************************
  3677
  3678         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3679                                     COMP-3.
  3680         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3681                                     COMP-3.
  3682         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3683                                     COMP-3.
  3684         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3685                                     COMP-3.
  3686         16  FILLER                PIC X(12).
  3687
  3688***************    OUTPUT FROM ELRAMT   *************************
  3689
  3690         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3691                                     COMP-3.
  3692         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3693                                     COMP-3.
  3694         16  FILLER                PIC X(12).
  3695
  3696***************    OUTPUT FROM ELRATE   *************************
  3697
  3698         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3699                                     COMP-3.
  3700         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3701                                     COMP-3.
  3702         16  CP-MORTALITY-CODE     PIC X(4).
  3703         16  CP-RATE-EDIT-FLAG     PIC X.
  3704             88  CP-RATES-NEED-APR                  VALUE '1'.
  3705         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3706                                     COMP-3.
  3707         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3708         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3709         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3710                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  70
* EL050.cbl
  3711         16  FILLER                PIC X(07).
  3712
  3713***************    OUTPUT FROM ELRFND   *************************
  3714
  3715         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3716                                     COMP-3.
  3717         16  CP-REFUND-TYPE-USED   PIC X.
  3718           88  CP-R-AS-R78                         VALUE '1'.
  3719           88  CP-R-AS-PRORATA                     VALUE '2'.
  3720           88  CP-R-AS-CALIF                       VALUE '3'.
  3721           88  CP-R-AS-TEXAS                       VALUE '4'.
  3722           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3723           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3724           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3725           88  CP-R-AS-MEAN                        VALUE '8'.
  3726           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3727           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3728           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3729           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3730           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3731           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3732         16  FILLER                PIC X(12).
  3733
  3734***************    OUTPUT FROM ELEARN   *************************
  3735
  3736         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3737                                     COMP-3.
  3738         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3739                                     COMP-3.
  3740         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3743                                     COMP-3.
  3744         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3745                                     COMP-3.
  3746         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3747                                     COMP-3.
  3748         16  CP-EARNING-TYPE-USED  PIC X.
  3749           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3750           88  CP-E-AS-R78                         VALUE '1'.
  3751           88  CP-E-AS-PRORATA                     VALUE '2'.
  3752           88  CP-E-AS-TEXAS                       VALUE '4'.
  3753           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3754           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3755           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3756           88  CP-E-AS-MEAN                        VALUE '8'.
  3757           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3758         16  FILLER                PIC X(12).
  3759
  3760***************    OUTPUT FROM ELPMNT   *************************
  3761
  3762         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3763                                     COMP-3.
  3764         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3765                                     COMP-3.
  3766         16  FILLER                PIC X(12).
  3767
  3768***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  71
* EL050.cbl
  3769         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3770                                     COMP-3.
  3771         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3772                                     COMP-3.
  3773         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3774                                     COMP-3.
  3775         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3776                                     COMP-3.
  3777         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3778                                     COMP-3.
  3779         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3780                                     COMP-3.
  3781         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3782             88  OPEN-RATE-FILE                   VALUE 'O'.
  3783             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3784             88  IO-ERROR                         VALUE 'E'.
  3785
  3786         16  CP-FIRST-PAY-DATE     PIC XX.
  3787
  3788         16  CP-JOINT-INDICATOR    PIC X.
  3789
  3790         16  CP-RESERVE-REMAINING-TERM
  3791                                   PIC S9(4)V9    VALUE ZERO
  3792                                     COMP-3.
  3793
  3794         16  CP-INSURED-BIRTH-DT   PIC XX.
  3795
  3796         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3797                                     COMP-3.
  3798
  3799         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3800                                     COMP-3.
  3801
  3802         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3803                                     COMP-3.
  3804
  3805         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3806                                     COMP-3.
  3807
  3808         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3809                                     COMP-3.
  3810
  3811         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3812                                     COMP-3.
  3813
  3814         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3815                                     COMP-3.
  3816
  3817         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3818             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3819
  3820         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3825         16  FILLER                PIC X(15).
  3826******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  72
* EL050.cbl
  3828******************************************************************
  3829*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3830*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3831*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3832*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3833*** MODIFICATION.                                              ***
  3834*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3835*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3836******************************************************************
  3837*    COPY ERCPNDB.
  3838******************************************************************
  3839*                                                                *
  3840*                                                                *
  3841*                            ERCPNDB.                            *
  3842*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3843*                            VMOD=2.025                          *
  3844*                                                                *
  3845*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3846*                                                                *
  3847******************************************************************
  3848*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3849*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3850******************************************************************
  3851*                                                                *
  3852*                                                                *
  3853*   FILE TYPE = VSAM,KSDS                                        *
  3854*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3855*                                                                *
  3856*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3857*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3858*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3859*                                                 RKP=13,LEN=36  *
  3860*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3861*                                      AND CHG-SEQ.)             *
  3862*                                                RKP=49,LEN=11   *
  3863*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3864*                                      AND CHG-SEQ.)             *
  3865*                                                RKP=60,LEN=15   *
  3866*                                                                *
  3867*   LOG = NO                                                     *
  3868*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3869******************************************************************
  3870******************************************************************
  3871*                   C H A N G E   L O G
  3872*
  3873* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3874*-----------------------------------------------------------------
  3875*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3876* EFFECTIVE    NUMBER
  3877*-----------------------------------------------------------------
  3878* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3879* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3880* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3881* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3882* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3883* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3884* 032306                   PEMA  ADD BOW LOAN NUMBER
  3885* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  73
* EL050.cbl
  3886* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3887* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3888* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3889* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3890* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3891* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3892* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3893******************************************************************
  3894
  3895 01  PENDING-BUSINESS.
  3896     12  PB-RECORD-ID                     PIC XX.
  3897         88  VALID-PB-ID                        VALUE 'PB'.
  3898
  3899     12  PB-CONTROL-PRIMARY.
  3900         16  PB-COMPANY-CD                PIC X.
  3901         16  PB-ENTRY-BATCH               PIC X(6).
  3902         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3903         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3904
  3905     12  PB-CONTROL-BY-ACCOUNT.
  3906         16  PB-COMPANY-CD-A1             PIC X.
  3907         16  PB-CARRIER                   PIC X.
  3908         16  PB-GROUPING.
  3909             20  PB-GROUPING-PREFIX       PIC XXX.
  3910             20  PB-GROUPING-PRIME        PIC XXX.
  3911         16  PB-STATE                     PIC XX.
  3912         16  PB-ACCOUNT.
  3913             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3914             20  PB-ACCOUNT-PRIME         PIC X(6).
  3915         16  PB-CERT-EFF-DT               PIC XX.
  3916         16  PB-CERT-NO.
  3917             20  PB-CERT-PRIME            PIC X(10).
  3918             20  PB-CERT-SFX              PIC X.
  3919         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3920
  3921         16  PB-RECORD-TYPE               PIC X.
  3922             88  PB-MAILING-DATA                VALUE '0'.
  3923             88  PB-ISSUE                       VALUE '1'.
  3924             88  PB-CANCELLATION                VALUE '2'.
  3925             88  PB-BATCH-TRAILER               VALUE '9'.
  3926
  3927     12  PB-CONTROL-BY-ORIG-BATCH.
  3928         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3929         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3930         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3931         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3932
  3933     12  PB-CONTROL-BY-CSR.
  3934         16  PB-CSR-COMPANY-CD            PIC X.
  3935         16  PB-CSR-ID                    PIC X(4).
  3936         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3937         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3938         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3939******************************************************************
  3940*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3941******************************************************************
  3942
  3943     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  74
* EL050.cbl
  3944     12  PB-LAST-MAINT-BY                 PIC X(4).
  3945     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3946
  3947     12  PB-RECORD-BODY                   PIC X(375).
  3948
  3949     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3950         16  PB-CERT-ORIGIN               PIC X.
  3951             88  CLASIC-CREATED-CERT         VALUE '1'.
  3952         16  PB-I-NAME.
  3953             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3954             20  PB-I-INSURED-FIRST-NAME.
  3955                 24  PB-I-INSURED-1ST-INIT PIC X.
  3956                 24  FILLER                PIC X(9).
  3957             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3958         16  PB-I-AGE                     PIC S99   COMP-3.
  3959         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3960         16  PB-I-BIRTHDAY                PIC XX.
  3961         16  PB-I-INSURED-SEX             PIC X.
  3962             88  PB-SEX-MALE     VALUE 'M'.
  3963             88  PB-SEX-FEMALE   VALUE 'F'.
  3964
  3965         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3966         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3967         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3968         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3969         16  PB-I-SKIP-CODE               PIC X.
  3970             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3971             88  PB-SKIP-JULY              VALUE '1'.
  3972             88  PB-SKIP-AUGUST            VALUE '2'.
  3973             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3974             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3975             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3976             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3977             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3978             88  PB-SKIP-JUNE              VALUE '8'.
  3979             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3980             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3981             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3982         16  PB-I-TERM-TYPE               PIC X.
  3983             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3984             88  PB-PAID-WEEKLY            VALUE 'W'.
  3985             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3986             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3987             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3988         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3989         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3990         16  PB-I-DATA-ENTRY-SW           PIC X.
  3991             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3992             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3993             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3994             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3995         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3996         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3997*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3998         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3999         16  FILLER                       PIC X.
  4000
  4001         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  75
* EL050.cbl
  4002             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4003             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4004                                                   '90' THRU '99'.
  4005         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4006                                          PIC XX.
  4007         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4008         16  PB-I-AMOUNT-FINANCED REDEFINES
  4009                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4010         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4011         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4012                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4013         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4014         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4015         16  PB-I-CLP-AMOUNT REDEFINES
  4016                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4017         16  PB-I-LF-CALC-FLAG            PIC X.
  4018             88 PB-COMP-LF-PREM               VALUE '?'.
  4019         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4020         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4021         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4022         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4023         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4024         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4025         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4026         16  PB-I-LF-ABBR                 PIC XXX.
  4027         16  PB-I-LF-INPUT-CD             PIC XX.
  4028
  4029         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4030             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4031             88  PB-INVALID-AH               VALUE '  ' '00'
  4032                                                   '90' THRU '99'.
  4033         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4034         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4035         16  PB-I-AH-CALC-FLAG            PIC X.
  4036             88 PB-COMP-AH-PREM                  VALUE '?'.
  4037         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4038         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4039         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4040         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4041         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4042         16  PB-I-AH-ABBR                 PIC XXX.
  4043         16  PB-I-AH-INPUT-CD             PIC XXX.
  4044
  4045         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4046         16  PB-I-REIN-TABLE              PIC XXX.
  4047         16  PB-I-BUSINESS-TYPE           PIC 99.
  4048         16  PB-I-INDV-GRP-CD             PIC X.
  4049         16  PB-I-MORT-CODE.
  4050             20  PB-I-TABLE               PIC X.
  4051             20  PB-I-INTEREST            PIC XX.
  4052             20  PB-I-MORT-TYP            PIC X.
  4053         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4054         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4055         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4056         16  PB-I-INDV-GRP-OVRD           PIC X.
  4057         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4058         16  PB-I-SIG-SW                  PIC X.
  4059             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  76
* EL050.cbl
  4060         16  PB-I-RATE-CLASS              PIC XX.
  4061         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4062         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4063         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4064         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4065         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4066         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4067         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4068         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4069         16  PB-I-OB-FLAG                 PIC X.
  4070             88  PB-I-OB                      VALUE 'B'.
  4071             88  PB-I-SUMMARY                 VALUE 'Z'.
  4072         16  PB-I-ENTRY-STATUS            PIC X.
  4073             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4074                                              'M' '5' '9' '2'.
  4075             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4076             88  PB-I-POLICY-PENDING          VALUE '2'.
  4077             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4078             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4079             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4080             88  PB-I-REIN-ONLY               VALUE '9'.
  4081             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4082             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4083             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4084             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4085         16  PB-I-INT-CODE                PIC X.
  4086             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4087             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4088         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4089         16  PB-I-SOC-SEC-NO              PIC X(11).
  4090         16  PB-I-MEMBER-NO               PIC X(12).
  4091         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4092*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4093         16  PB-I-OLD-LOF                 PIC XXX.
  4094         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4095         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4096         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4097         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4098         16  PB-I-LIFE-INDICATOR          PIC X.
  4099             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4100         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4101         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4102                                          PIC S9(5)V99    COMP-3.
  4103         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4104             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4105             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4106         16  PB-I-1ST-PMT-DT              PIC XX.
  4107         16  PB-I-JOINT-INSURED.
  4108             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4109             20 PB-I-JOINT-FIRST-NAME.
  4110                24  PB-I-JOINT-FIRST-INIT PIC X.
  4111                24  FILLER                PIC X(9).
  4112             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4113*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4114         16  PB-I-BENEFICIARY-NAME.
  4115             20  PB-I-BANK-NUMBER         PIC X(10).
  4116             20  FILLER                   PIC X(15).
  4117         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  77
* EL050.cbl
  4118         16  PB-I-REFERENCE               PIC X(12).
  4119         16  FILLER REDEFINES PB-I-REFERENCE.
  4120             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4121             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4122             20  PB-I-CLP-STATE           PIC XX.
  4123         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4124             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4125             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4126             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4127         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4128         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4129         16  PB-I-RESIDENT-STATE          PIC XX.
  4130         16  PB-I-RATE-CODE               PIC X(4).
  4131         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4132         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4133         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4134         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4135         16  PB-I-BANK-NOCHRGB            PIC 99.
  4136         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4137         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4138
  4139     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4140         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4141             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4142         16  PB-C-CANCEL-ORIGIN           PIC X.
  4143             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4144         16  PB-C-LF-CANCEL-DT            PIC XX.
  4145         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4146         16  PB-C-LF-CALC-REQ             PIC X.
  4147             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4148         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4149         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4150         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4151             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4152         16  PB-C-AH-CANCEL-DT            PIC XX.
  4153         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4154         16  PB-C-AH-CALC-REQ             PIC X.
  4155             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4156         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4157         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4158         16  PB-C-LAST-NAME               PIC X(15).
  4159         16  PB-C-REFUND-SW               PIC X.
  4160             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4161             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4162         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4163         16  PB-C-PAYEE-CODE              PIC X(6).
  4164         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4165         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4166         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4167         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4168         16  PB-C-REFERENCE               PIC X(12).
  4169         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4170         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4171         16  PB-C-POST-CARD-IND           PIC X.
  4172         16  PB-C-CANCEL-REASON           PIC X.
  4173         16  PB-C-REF-INTERFACE-SW        PIC X.
  4174         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4175         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  78
* EL050.cbl
  4176         16  FILLER                       PIC X(01).
  4177*        16  FILLER                       PIC X(18).
  4178         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4179*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4180         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4181         16  PB-CANCELED-CERT-DATA.
  4182             20  PB-CI-INSURED-NAME.
  4183                 24  PB-CI-LAST-NAME      PIC X(15).
  4184                 24  PB-CI-INITIALS       PIC XX.
  4185             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4186             20  PB-CI-INSURED-SEX        PIC X.
  4187             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4188             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4189             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4190             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4191             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4192             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4193             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4194             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4195             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4196             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4197             20  PB-CI-RATE-CLASS         PIC XX.
  4198             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4199             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4200             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4201             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4202             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4203             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4204             20  PB-CI-LF-ABBR            PIC X(3).
  4205             20  PB-CI-AH-ABBR            PIC X(3).
  4206             20  PB-CI-OB-FLAG            PIC X.
  4207                 88  PB-CI-OB                VALUE 'B'.
  4208             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4209                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4210                                           'M' '4' '5' '9' '2'.
  4211                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4212                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4213                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4214                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4215                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4216                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4217                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4218                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4219                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4220                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4221                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4222                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4223             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4224                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4225                                           'M' '4' '5' '9' '2'.
  4226                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4227                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4228                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4229                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4230                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4231                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4232                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4233                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  79
* EL050.cbl
  4234                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4235                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4236                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4237                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4238             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4239             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4240             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4241             20  PB-CI-MEMBER-NO          PIC X(12).
  4242             20  PB-CI-INT-CODE           PIC X.
  4243                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4244                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4245             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4246             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4247             20  PB-CI-COMP-EXCP-SW       PIC X.
  4248                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4249                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4250             20  PB-CI-ENTRY-STATUS       PIC X.
  4251             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4252             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4253             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4254             20  PB-CI-DEATH-DT           PIC XX.
  4255             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4256             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4257             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4258             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4259             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4260             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4261             20  PB-CI-ENTRY-DT              PIC XX.
  4262             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4263             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4264             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4265             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4266             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4267             20  PB-CI-OLD-LOF               PIC XXX.
  4268*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4269             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4270             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4271             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4272             20  PB-CI-INDV-GRP-CD           PIC X.
  4273             20  PB-CI-BENEFICIARY-NAME.
  4274                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4275                 24  FILLER                  PIC X(15).
  4276             20  PB-CI-NOTE-SW               PIC X.
  4277             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4278             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4279             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4280             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4281             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4282             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4283             20  PB-CI-FIRST-NAME            PIC X(10).
  4284             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4285
  4286         16  FILLER                       PIC X(13).
  4287*032306  16  FILLER                       PIC X(27).
  4288*        16  FILLER                       PIC X(46).
  4289
  4290     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4291         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  80
* EL050.cbl
  4292         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4293         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4294         16  PB-M-INSURED-MID-INIT        PIC X.
  4295         16  PB-M-INSURED-AGE             PIC 99.
  4296         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4297         16  PB-M-INSURED-SEX             PIC X.
  4298         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4299         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4300         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4301         16  PB-M-INSURED-CITY-STATE.
  4302             20  PB-M-INSURED-CITY        PIC X(28).
  4303             20  PB-M-INSURED-STATE       PIC XX.
  4304         16  PB-M-INSURED-ZIP-CODE.
  4305             20  PB-M-INSURED-ZIP-PRIME.
  4306                 24  PB-M-INSURED-ZIP-1   PIC X.
  4307                     88  PB-M-CANADIAN-POST-CODE
  4308                                             VALUE 'A' THRU 'Z'.
  4309                 24  FILLER               PIC X(4).
  4310             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4311         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4312                                        PB-M-INSURED-ZIP-CODE.
  4313             20  PM-M-INS-CAN-POST1       PIC XXX.
  4314             20  PM-M-INS-CAN-POST2       PIC XXX.
  4315             20  FILLER                   PIC XXX.
  4316         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4317         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4318         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4319         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4320         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4321         16  PB-M-CRED-BENE-CITYST.
  4322             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4323             20  PB-M-CRED-BENE-STATE     PIC XX.
  4324         16  FILLER                       PIC X(92).
  4325
  4326     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4327         16  FILLER                       PIC X(10).
  4328         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4329         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4330         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4331         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4332         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4333         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4334         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4335         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4336         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4337         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4338         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4339         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4340         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4341         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4342         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4343         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4344         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4345         16  PB-ACCOUNT-NAME              PIC X(30).
  4346         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4347         16  PB-REFERENCE                 PIC X(12).
  4348         16  PB-B-RECEIVED-DT             PIC XX.
  4349         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  81
* EL050.cbl
  4350
  4351     12  PB-RECORD-STATUS.
  4352         16  PB-CREDIT-SELECT-DT          PIC XX.
  4353         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4354         16  PB-BILLED-DT                 PIC XX.
  4355         16  PB-BILLING-STATUS            PIC X.
  4356             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4357             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4358             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4359         16  PB-RECORD-BILL               PIC X.
  4360             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4361             88  PB-RECORD-RETURNED           VALUE 'R'.
  4362             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4363             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4364             88  PB-OVERRIDE-AH               VALUE 'A'.
  4365             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4366         16  PB-BATCH-ENTRY               PIC X.
  4367             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4368             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4369             88  PB-REISSUED-CERT             VALUE 'E'.
  4370             88  PB-MONTHLY-CERT              VALUE 'M'.
  4371             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4372             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4373             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4374         16  PB-FORCE-CODE                PIC X.
  4375             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4376             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4377             88  PB-CANCEL-FORCE              VALUE '8'.
  4378             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4379             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4380             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4381             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4382             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4383             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4384             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4385         16  PB-FATAL-FLAG                PIC X.
  4386             88  PB-FATAL-ERRORS              VALUE 'X'.
  4387         16  PB-FORCE-ER-CD               PIC X.
  4388             88  PB-FORCE-ERRORS              VALUE 'F'.
  4389             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4390         16  PB-WARN-ER-CD                PIC X.
  4391             88  PB-WARNING-ERRORS            VALUE 'W'.
  4392         16  FILLER                       PIC X.
  4393         16  PB-OUT-BAL-CD                PIC X.
  4394             88  PB-OUT-OF-BAL                VALUE 'O'.
  4395         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4396         16  PB-AH-OVERRIDE-L1            PIC X.
  4397         16  PB-INPUT-DT                  PIC XX.
  4398         16  PB-INPUT-BY                  PIC X(4).
  4399         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4400         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4401         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4402         16  PB-LF-EARNING-METHOD         PIC X.
  4403         16  PB-AH-EARNING-METHOD         PIC X.
  4404         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4405         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4406         16  PB-REIN-CD                   PIC XXX.
  4407         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  82
* EL050.cbl
  4408         16  PB-AH-REFUND-TYPE            PIC X.
  4409         16  PB-ACCT-EFF-DT               PIC XX.
  4410         16  PB-ACCT-EXP-DT               PIC XX.
  4411         16  PB-COMPANY-ID                PIC X(3).
  4412         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4413         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4414         16  PB-SV-CARRIER                PIC X.
  4415         16  PB-SV-GROUPING               PIC X(6).
  4416         16  PB-SV-STATE                  PIC XX.
  4417         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4418         16  PB-GA-BILLING-INFO.
  4419             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4420                                          PIC XX.
  4421         16  PB-SV-REMIT-TO  REDEFINES
  4422             PB-GA-BILLING-INFO           PIC X(10).
  4423         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4424         16  PB-I-LOAN-OFFICER            PIC X(5).
  4425         16  PB-I-VIN                     PIC X(17).
  4426
  4427         16  FILLER                       PIC X(04).
  4428         16  IMNET-BYPASS-SW              PIC X.
  4429
  4430******************************************************************
  4431*                COMMON EDIT ERRORS                              *
  4432******************************************************************
  4433
  4434     12  PB-COMMON-ERRORS.
  4435         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4436                                           PIC S9(4)     COMP.
  4437
  4438******************************************************************
  4439
  4440* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4441*    COPY ELC50W1.
  4442******************************************************************
  4443*                                                                *
  4444*                                                                *
  4445*                             ELC50W1                            *
  4446*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4447*                            VMOD=2.004                          *
  4448*                                                                *
  4449*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4450*                                                                *
  4451*                                                                *
  4452******************************************************************
  4453
  4454     12  WK-WORK-AREA.
  4455         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4456         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4457         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4458         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4459         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4460         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4461         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4462         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4463         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4464         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4465         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  83
* EL050.cbl
  4466         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4467         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4468         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4469         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4470         16  WK-CREDIT-EDIT-CONTROLS.
  4471             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4472             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4473             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4474             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4475             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4476             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4477         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4478         16  WK-SAVE-REIN-DATA.
  4479             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4480             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4481             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4482         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4483             88  ENTRY-FROM-EL6311       VALUE '6'.
  4484         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4485         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4486     12  WK-RECORD-ADDRESSES.
  4487         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4488         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4489         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4490         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4491         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4492         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4493         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4494         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4495     12  WK-OVER-SHORT-AREA.
  4496         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4497         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4498         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4499             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4500         16  FILLER                   PIC X(5) VALUE SPACES.
  4501
  4502*    COPY ELCEDITC.
  4503******************************************************************
  4504*                                                                *
  4505*                                                                *
  4506*                            ELCEDITC                            *
  4507*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4508*                            VMOD=2.012                          *
  4509*                                                                *
  4510*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4511*                     EL6313, EL050 AND EL517.                   *
  4512*                                                                *
  4513******************************************************************
  4514******************************************************************
  4515*                   C H A N G E   L O G
  4516*
  4517* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4518*-----------------------------------------------------------------
  4519*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4520* EFFECTIVE    NUMBER
  4521*-----------------------------------------------------------------
  4522* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4523******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  84
* EL050.cbl
  4524
  4525     12  EDIT-CRITERIA-DATA.
  4526         16  EC-CO-MONTH-END-DT       PIC XX.
  4527         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4528         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4529         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4530         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4531         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4532         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4533         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4534         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4535         16  EC-CO-REM-TERM-CALC      PIC X.
  4536               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4537               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4538               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4539               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4540
  4541         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4542               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4543               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4544               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4545               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4546               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4547               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4548               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4549               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4550               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4551               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4552
  4553         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4554               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4555               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4556               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4557               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4558               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4559               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4560               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4561               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4562
  4563         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4564                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4565                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4566
  4567         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4568                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4569                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4570                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4571                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4572                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4573                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4574                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4575                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4576
  4577         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4578               88  EC-BR-REDUCING                   VALUE 'R'.
  4579               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4580
  4581         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  85
* EL050.cbl
  4582         16  EC-BR-LF-DESC             PIC X(10).
  4583         16  EC-BR-AH-DESC             PIC X(10).
  4584         16  EC-BR-LF-COMMENT          PIC X(10).
  4585         16  EC-BR-AH-COMMENT          PIC X(10).
  4586
  4587         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4588               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4589               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4590               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4591               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4592
  4593         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4594               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4595               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4596               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4597               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4598
  4599         16  EC-BR-LF-REFUND-CALC      PIC X.
  4600                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4601                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4602                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4603                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4604                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4605                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4606                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4607
  4608         16  EC-BR-AH-REFUND-CALC      PIC X.
  4609                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4610                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4611                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4612                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4613                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4614                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4615                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4616                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4617
  4618         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4619                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4620                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4621                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4622
  4623         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4624                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4625                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4626                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4627
  4628         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4629         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4630         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4631         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4632
  4633         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4634         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4635                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4636                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4637                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4638                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4639
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  86
* EL050.cbl
  4640         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4641               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4642               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4643               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4644               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4645               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4646
  4647         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4648               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4649               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4650               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4651               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4652               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4653
  4654         16  EC-ST-LF-REFUND-CALC      PIC X.
  4655                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4656                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4657                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4658                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4659                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4660                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4661                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4662                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4663
  4664         16  EC-ST-AH-REFUND-CALC      PIC X.
  4665                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4666                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4667                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4668                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4669                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4670                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4671                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4672                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4673
  4674         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4675         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4676         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4677         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4678         16  EC-AM-EXPIRATION-DT       PIC XX.
  4679         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4680         16  EC-AM-CLASS-CD            PIC XX.
  4681         16  EC-AM-LF-DEVIATION        PIC XXX.
  4682         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4683         16  EC-AM-AH-DEVIATION        PIC XXX.
  4684         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4685         16  EC-AM-PHONE-NO            PIC X(10).
  4686
  4687         16  EC-AM-LF-REFUND-CALC      PIC X.
  4688                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4689                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4690                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4691                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4692                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4693                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4694                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4695
  4696         16  EC-AM-AH-REFUND-CALC      PIC X.
  4697                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  87
* EL050.cbl
  4698                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4699                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4700                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4701                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4702                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4703                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4704
  4705         16  EC-AM-BEN-I-G-CD          PIC X.
  4706                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4707                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4708                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4709
  4710         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4711         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4712         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4713         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4714         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4715         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4716         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4717         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4718         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4719
  4720         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4721         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4722         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4723         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4724         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4725         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4726         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4727         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4728         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4729         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4730         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4731         16  EC-RT-LF-NSP-ST           PIC XX.
  4732         16  EC-RT-AH-NSP-ST           PIC XX.
  4733         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4734         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4735
  4736         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4737             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4738                                             'M' '5' '9' '2'.
  4739             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4740             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4741             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4742             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4743             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4744             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4745             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4746             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4747             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4748             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4749
  4750         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4751             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4752                                             'M' '5' '9' '2'.
  4753             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4754             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4755             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  88
* EL050.cbl
  4756             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4757             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4758             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4759             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4760             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4761             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4762             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4763
  4764         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4765         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4766         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4767         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4768         16  EC-CM-DEATH-DT            PIC XX.
  4769
  4770*DMD CUSTOM CODING FIELDS BELOW
  4771*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4772         16  EC-BR-DMD-RATING-SW       PIC X.
  4773                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4774                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4775                 88  NO-DMD-RATING               VALUE 'N'.
  4776
  4777         16  EC-NEW-CERT               PIC X(11).
  4778         16  EC-NEW-STATE              PIC XX.
  4779         16  FILLER                    PIC X.
  4780*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4781         16  OVER-SHORT-EDIT-FIELDS.
  4782             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4783             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4784             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4785             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4786             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4787             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4788             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4789             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4790             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4791         16  FILLER                    PIC X(71).
  4792******************************************************************
  4793
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  89
* EL050.cbl
  4795*    COPY ELCDIFRD.
  4796******************************************************************
  4797*                                                                *
  4798*                                                                *
  4799*                            ELCDIFRD.                           *
  4800*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4801*                            VMOD=2.004                          *
  4802*                                                                *
  4803*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4804*                                                                *
  4805******************************************************************
  4806*
  4807  01  WS-DIFFERENCE-CALCULATION.
  4808        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4809        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4810        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4811        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4812        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4813        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4814        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4815        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4816        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4817        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4818        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4819
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  90
* EL050.cbl
  4821****************************************************************
  4822*
  4823* Copyright (c) 2007 by Clerity Solutions, Inc.
  4824* All rights reserved.
  4825*
  4826****************************************************************
  4827 01  DFHEIV.
  4828   02  DFHEIV0               PIC X(35).
  4829   02  DFHEIV1               PIC X(08).
  4830   02  DFHEIV2               PIC X(08).
  4831   02  DFHEIV3               PIC X(08).
  4832   02  DFHEIV4               PIC X(06).
  4833   02  DFHEIV5               PIC X(04).
  4834   02  DFHEIV6               PIC X(04).
  4835   02  DFHEIV7               PIC X(02).
  4836   02  DFHEIV8               PIC X(02).
  4837   02  DFHEIV9               PIC X(01).
  4838   02  DFHEIV10              PIC S9(7) COMP-3.
  4839   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4840   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4841   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4842   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4843   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4844   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4845   02  DFHEIV17              PIC X(04).
  4846   02  DFHEIV18              PIC X(04).
  4847   02  DFHEIV19              PIC X(04).
  4848   02  DFHEIV20              USAGE IS POINTER.
  4849   02  DFHEIV21              USAGE IS POINTER.
  4850   02  DFHEIV22              USAGE IS POINTER.
  4851   02  DFHEIV23              USAGE IS POINTER.
  4852   02  DFHEIV24              USAGE IS POINTER.
  4853   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4854   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4855   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4856   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4857   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4858   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4859   02  FILLER                PIC X(02).
  4860   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4861   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4862   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4863   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4864   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4865 LINKAGE  SECTION.
  4866*****************************************************************
  4867*                                                               *
  4868* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4869* All rights reserved.                                          *
  4870*                                                               *
  4871*****************************************************************
  4872 01  dfheiblk.
  4873     02  eibtime          pic s9(7) comp-3.
  4874     02  eibdate          pic s9(7) comp-3.
  4875     02  eibtrnid         pic x(4).
  4876     02  eibtaskn         pic s9(7) comp-3.
  4877     02  eibtrmid         pic x(4).
  4878     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  91
* EL050.cbl
  4879     02  eibcposn         pic s9(4) comp.
  4880     02  eibcalen         pic s9(4) comp.
  4881     02  eibaid           pic x(1).
  4882     02  eibfiller1       pic x(1).
  4883     02  eibfn            pic x(2).
  4884     02  eibfiller2       pic x(2).
  4885     02  eibrcode         pic x(6).
  4886     02  eibfiller3       pic x(2).
  4887     02  eibds            pic x(8).
  4888     02  eibreqid         pic x(8).
  4889     02  eibrsrce         pic x(8).
  4890     02  eibsync          pic x(1).
  4891     02  eibfree          pic x(1).
  4892     02  eibrecv          pic x(1).
  4893     02  eibsend          pic x(1).
  4894     02  eibatt           pic x(1).
  4895     02  eibeoc           pic x(1).
  4896     02  eibfmh           pic x(1).
  4897     02  eibcompl         pic x(1).
  4898     02  eibsig           pic x(1).
  4899     02  eibconf          pic x(1).
  4900     02  eiberr           pic x(1).
  4901     02  eibrldbk         pic x(1).
  4902     02  eiberrcd         pic x(4).
  4903     02  eibsynrb         pic x(1).
  4904     02  eibnodat         pic x(1).
  4905     02  eibfiller5       pic x(2).
  4906     02  eibresp          pic 9(09) comp.
  4907     02  eibresp2         pic 9(09) comp.
  4908     02  dfheigdj         pic s9(4) comp.
  4909     02  dfheigdk         pic s9(4) comp.
  4910
  4911 01  DFHCOMMAREA                   PIC X(1036).
  4912
  4913*01 PARMLIST .
  4914*    02  FILLER                    PIC S9(8)   COMP.
  4915*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4916*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4917*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4918*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4919*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4920*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4921*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4922
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  92
* EL050.cbl
  4924*    COPY ELCCNTL.
  4925******************************************************************
  4926*                                                                *
  4927*                                                                *
  4928*                            ELCCNTL.                            *
  4929*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4930*                            VMOD=2.059                          *
  4931*                                                                *
  4932*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4933*                                                                *
  4934*   FILE TYPE = VSAM,KSDS                                        *
  4935*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4936*                                                                *
  4937*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4938*       ALTERNATE INDEX = NONE                                   *
  4939*                                                                *
  4940*   LOG = YES                                                    *
  4941*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4942******************************************************************
  4943*                   C H A N G E   L O G
  4944*
  4945* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4946*-----------------------------------------------------------------
  4947*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4948* EFFECTIVE    NUMBER
  4949*-----------------------------------------------------------------
  4950* 082503                   PEMA  ADD BENEFIT GROUP
  4951* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4952* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4953* 092705    2005050300006  PEMA  ADD SPP LEASES
  4954* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4955* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4956* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4957* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4958* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4959* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4960* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4961* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4962* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4963******************************************************************
  4964*
  4965 01  CONTROL-FILE.
  4966     12  CF-RECORD-ID                       PIC XX.
  4967         88  VALID-CF-ID                        VALUE 'CF'.
  4968
  4969     12  CF-CONTROL-PRIMARY.
  4970         16  CF-COMPANY-ID                  PIC XXX.
  4971         16  CF-RECORD-TYPE                 PIC X.
  4972             88  CF-COMPANY-MASTER              VALUE '1'.
  4973             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4974             88  CF-STATE-MASTER                VALUE '3'.
  4975             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4976             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4977             88  CF-CARRIER-MASTER              VALUE '6'.
  4978             88  CF-MORTALITY-MASTER            VALUE '7'.
  4979             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4980             88  CF-TERMINAL-MASTER             VALUE '9'.
  4981             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  93
* EL050.cbl
  4982             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4983             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4984             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4985             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4986             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4987             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4988             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4989             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4990         16  CF-ACCESS-CD-GENL              PIC X(4).
  4991         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4992             20  CF-PROCESSOR               PIC X(4).
  4993         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4994             20  CF-STATE-CODE              PIC XX.
  4995             20  FILLER                     PIC XX.
  4996         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4997             20  FILLER                     PIC XX.
  4998             20  CF-HI-BEN-IN-REC           PIC XX.
  4999         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5000             20  FILLER                     PIC XXX.
  5001             20  CF-CARRIER-CNTL            PIC X.
  5002         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5003             20  FILLER                     PIC XX.
  5004             20  CF-HI-TYPE-IN-REC          PIC 99.
  5005         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5006             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5007                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5008             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5009             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5010         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5011             20  FILLER                     PIC X.
  5012             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5013         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5014             20  FILLER                     PIC XX.
  5015             20  CF-MORTGAGE-PLAN           PIC XX.
  5016         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5017
  5018     12  CF-LAST-MAINT-DT                   PIC XX.
  5019     12  CF-LAST-MAINT-BY                   PIC X(4).
  5020     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5021
  5022     12  CF-RECORD-BODY                     PIC X(728).
  5023
  5024
  5025****************************************************************
  5026*             COMPANY MASTER RECORD                            *
  5027****************************************************************
  5028
  5029     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5030         16  CF-COMPANY-ADDRESS.
  5031             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5032             20  CF-CL-IN-CARE-OF           PIC X(30).
  5033             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5034             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5035             20  CF-CL-CITY-STATE           PIC X(30).
  5036             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5037             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5038         16  CF-COMPANY-CD                  PIC X.
  5039         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  94
* EL050.cbl
  5040         16  CF-SECURITY-OPTION             PIC X.
  5041             88  ALL-SECURITY                   VALUE '1'.
  5042             88  COMPANY-VERIFY                 VALUE '2'.
  5043             88  PROCESSOR-VERIFY               VALUE '3'.
  5044             88  NO-SECURITY                    VALUE '4'.
  5045             88  ALL-BUT-TERM                   VALUE '5'.
  5046         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5047             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5048         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5049             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5050         16  CF-INFORCE-LOCATION            PIC X.
  5051             88  CERTS-ARE-ONLINE               VALUE '1'.
  5052             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5053             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5054         16  CF-LOWER-CASE-LETTERS          PIC X.
  5055         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5056             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5057             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5058             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5059             88  CF-ACCNT-CNTL                  VALUE '3'.
  5060             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5061
  5062         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5063         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5064
  5065         16  CF-LGX-CREDIT-USER             PIC X.
  5066             88  CO-IS-NOT-USER                 VALUE 'N'.
  5067             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5068
  5069         16 CF-CREDIT-CALC-CODES.
  5070             20  CF-CR-REM-TERM-CALC PIC X.
  5071               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5072               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5073               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5074               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5075               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5076               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5077               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5078             20  CF-CR-R78-METHOD           PIC X.
  5079               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5080               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5081
  5082         16  CF-CLAIM-CONTROL-COUNTS.
  5083             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5084                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5085
  5086             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5087                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5088
  5089             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5090                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5091
  5092             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5093                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5094
  5095         16  CF-CURRENT-MONTH-END           PIC XX.
  5096
  5097         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  95
* EL050.cbl
  5098             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5099             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5100             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5101             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5102                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5103                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5104             20  CF-CO-PREM-REJECT-SW       PIC X.
  5105                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5106                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5107             20  CF-CO-REF-REJECT-SW        PIC X.
  5108                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5109                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5110
  5111         16  CF-CO-REPORTING-DT             PIC XX.
  5112         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5113         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5114           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5115           88  CF-CO-MONTH-END                  VALUE '1'.
  5116
  5117         16  CF-LGX-CLAIM-USER              PIC X.
  5118             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5119             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5120
  5121         16  CF-CREDIT-EDIT-CONTROLS.
  5122             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5123             20  CF-MIN-AGE                 PIC 99.
  5124             20  CF-DEFAULT-AGE             PIC 99.
  5125             20  CF-MIN-TERM                PIC S999      COMP-3.
  5126             20  CF-MAX-TERM                PIC S999      COMP-3.
  5127             20  CF-DEFAULT-SEX             PIC X.
  5128             20  CF-JOINT-AGE-INPUT         PIC X.
  5129                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5130             20  CF-BIRTH-DATE-INPUT        PIC X.
  5131                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5132             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5133                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5134                 88  CF-ZERO-CARRIER            VALUE '1'.
  5135                 88  CF-ZERO-GROUPING           VALUE '2'.
  5136                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5137             20  CF-EDIT-SW                 PIC X.
  5138                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5139             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5140             20  CF-CR-PR-METHOD            PIC X.
  5141               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5142               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5143             20  FILLER                     PIC X.
  5144
  5145         16  CF-CREDIT-MISC-CONTROLS.
  5146             20  CF-REIN-TABLE-SW           PIC X.
  5147                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5148             20  CF-COMP-TABLE-SW           PIC X.
  5149                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5150             20  CF-EXPERIENCE-RETENTION-AGE
  5151                                            PIC S9        COMP-3.
  5152             20  CF-CONVERSION-DT           PIC XX.
  5153             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5154             20  CF-RUN-FREQUENCY-SW        PIC X.
  5155                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  96
* EL050.cbl
  5156                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5157
  5158             20  CF-CR-CHECK-NO-CONTROL.
  5159                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5160                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5161                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5162                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5163                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5164                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5165
  5166                 24  CF-CR-CHECK-COUNT       REDEFINES
  5167                     CF-CR-CHECK-COUNTER      PIC X(4).
  5168
  5169                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5170                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5171
  5172                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5173                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5174                 24  CF-MAIL-PROCESSING       PIC X.
  5175                     88  MAIL-PROCESSING          VALUE 'Y'.
  5176
  5177         16  CF-MISC-SYSTEM-CONTROL.
  5178             20  CF-SYSTEM-C                 PIC X.
  5179                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5180             20  CF-SYSTEM-D                 PIC X.
  5181                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5182             20  CF-SOC-SEC-NO-SW            PIC X.
  5183                 88  SOC-SEC-NO-USED             VALUE '1'.
  5184             20  CF-MEMBER-NO-SW             PIC X.
  5185                 88  MEMBER-NO-USED              VALUE '1'.
  5186             20  CF-TAX-ID-NUMBER            PIC X(11).
  5187             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5188             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5189                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5190                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5191                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5192                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5193             20  CF-SYSTEM-E                 PIC X.
  5194                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5195
  5196         16  CF-LGX-LIFE-USER               PIC X.
  5197             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5198             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5199
  5200         16  CF-CR-MONTH-END-DT             PIC XX.
  5201
  5202         16  CF-FILE-MAINT-DATES.
  5203             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5204                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5205             20  CF-LAST-BATCH       REDEFINES
  5206                 CF-LAST-BATCH-NO               PIC X(4).
  5207             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5208             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5209             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5210             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5211             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5212             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5213             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  97
* EL050.cbl
  5214             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5215             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5216             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5217
  5218         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5219         16  FILLER                         PIC X.
  5220
  5221         16  CF-ALT-MORT-CODE               PIC X(4).
  5222         16  CF-MEMBER-CAPTION              PIC X(10).
  5223
  5224         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5225             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5226             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5227             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5228             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5229             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5230
  5231         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5232
  5233         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5234         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5235         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5236         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5237
  5238         16  CF-AH-OVERRIDE-L1              PIC X.
  5239         16  CF-AH-OVERRIDE-L2              PIC XX.
  5240         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5241         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5242
  5243         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5244         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5245
  5246         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5247         16  CF-AR-LAST-EL860-DT            PIC XX.
  5248         16  CF-MP-MONTH-END-DT             PIC XX.
  5249
  5250         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5251         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5252             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5253
  5254         16  CF-AR-MONTH-END-DT             PIC XX.
  5255
  5256         16  CF-CRDTCRD-USER                PIC X.
  5257             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5258             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5259
  5260         16  CF-CC-MONTH-END-DT             PIC XX.
  5261
  5262         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5263
  5264         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5265             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5266             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5267             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5268         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5269         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5270         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5271         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  98
* EL050.cbl
  5272             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5273             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5274         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5275         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5276         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5277             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5278         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5279
  5280         16  CF-CL-ZIP-CODE.
  5281             20  CF-CL-ZIP-PRIME.
  5282                 24  CF-CL-ZIP-1ST          PIC X.
  5283                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5284                 24  FILLER                 PIC X(4).
  5285             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5286         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5287             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5288             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5289             20  FILLER                     PIC XXX.
  5290
  5291         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5292         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5293         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5294         16  CF-CO-OPTION-START-DATE        PIC XX.
  5295         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5296           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5297                                                      '3' '4'.
  5298           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5299           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5300           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5301           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5302           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5303           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5304
  5305         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5306
  5307         16  CF-PAYMENT-APPROVAL-LEVELS.
  5308             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5309             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5310             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5311             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5312             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5313             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5314
  5315         16  CF-END-USER-REPORTING-USER     PIC X.
  5316             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5317             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5318
  5319         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5320             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5321             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5322
  5323         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5324
  5325         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5326         16  FILLER                         PIC X.
  5327
  5328         16  CF-CREDIT-ARCHIVE-CNTL.
  5329             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page  99
* EL050.cbl
  5330             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5331             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5332
  5333         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5334
  5335         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5336             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5337             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5338
  5339         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5340             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5341             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5342
  5343         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5344
  5345         16  CF-CO-ACH-ID-CODE              PIC  X.
  5346             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5347             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5348             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5349         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5350         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5351         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5352         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5353         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5354         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5355         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5356         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5357         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5358                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5359         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5360                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5361
  5362         16  CF-CO-OVER-SHORT.
  5363             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5364             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5365
  5366*         16  FILLER                         PIC X(102).
  5367         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5368             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5369             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5370
  5371         16  CF-AH-APPROVAL-DAYS.
  5372             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5373             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5374             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5375             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5376
  5377         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5378
  5379         16  CF-APPROV-LEV-5.
  5380             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5381             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5382             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5383
  5384         16  FILLER                         PIC X(68).
  5385****************************************************************
  5386*             PROCESSOR/USER RECORD                            *
  5387****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 100
* EL050.cbl
  5388
  5389     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5390         16  CF-PROCESSOR-NAME              PIC X(30).
  5391         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5392         16  CF-PROCESSOR-TITLE             PIC X(26).
  5393         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5394                 88  MESSAGE-YES                VALUE 'Y'.
  5395                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5396
  5397*****************************************************
  5398****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5399****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5400****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5401****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5402*****************************************************
  5403
  5404         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5405             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5406             20  CF-APPLICATION-FORCE       PIC X.
  5407             20  CF-INDIVIDUAL-APP.
  5408                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5409                     28  CF-BROWSE-APP      PIC X.
  5410                     28  CF-UPDATE-APP      PIC X.
  5411
  5412         16  CF-CURRENT-TERM-ON             PIC X(4).
  5413         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5414             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5415             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5416             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5417             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5418             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5419             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5420             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5421         16  CF-PROCESSOR-CARRIER           PIC X.
  5422             88  NO-CARRIER-SECURITY            VALUE ' '.
  5423         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5424             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5425         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5426             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5427         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5428             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5429
  5430         16  CF-PROC-SYS-ACCESS-SW.
  5431             20  CF-PROC-CREDIT-CLAIMS-SW.
  5432                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5433                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5434                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5435                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5436             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5437                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5438                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5439             20  CF-PROC-LIFE-GNRLDGR-SW.
  5440                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5441                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5442                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5443                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5444             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5445                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 101
* EL050.cbl
  5446                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5447         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5448             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5449             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5450         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5451
  5452         16  CF-APPROVAL-LEVEL                  PIC X.
  5453             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5454             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5455             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5456             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5457             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5458
  5459         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5460
  5461         16  CF-LANGUAGE-TYPE                   PIC X.
  5462             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5463             88  CF-LANG-IS-FR                      VALUE 'F'.
  5464
  5465         16  CF-CSR-IND                         PIC X.
  5466         16  FILLER                             PIC X(239).
  5467
  5468****************************************************************
  5469*             PROCESSOR/REMINDERS RECORD                       *
  5470****************************************************************
  5471
  5472     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5473         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5474             20  CF-START-REMIND-DT         PIC XX.
  5475             20  CF-END-REMIND-DT           PIC XX.
  5476             20  CF-REMINDER-TEXT           PIC X(50).
  5477         16  FILLER                         PIC X(296).
  5478
  5479
  5480****************************************************************
  5481*             STATE MASTER RECORD                              *
  5482****************************************************************
  5483
  5484     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5485         16  CF-STATE-ABBREVIATION          PIC XX.
  5486         16  CF-STATE-NAME                  PIC X(25).
  5487         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5488         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5489             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5490             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5491             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5492             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5493                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5494                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5495             20  CF-ST-PREM-REJECT-SW       PIC X.
  5496                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5497                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5498             20  CF-ST-REF-REJECT-SW        PIC X.
  5499                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5500                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5501         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5502         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5503         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 102
* EL050.cbl
  5504             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5505             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5506             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5507         16  CF-ST-FST-PMT-EXTENSION.
  5508             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5509             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5510                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5511                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5512                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5513                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5514         16  CF-ST-STATE-CALL.
  5515             20  CF-ST-CALL-UNEARNED        PIC X.
  5516             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5517             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5518         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5519             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5520             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5521         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5522         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5523         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5524         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5525         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5526         16  FILLER                         PIC X.
  5527         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5528             20  CF-ST-BENEFIT-CD           PIC XX.
  5529             20  CF-ST-BENEFIT-KIND         PIC X.
  5530                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5531                 88  CF-ST-AH-KIND              VALUE 'A'.
  5532             20  CF-ST-REM-TERM-CALC        PIC X.
  5533                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5534                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5535                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5536                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5537                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5538                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5539                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5540                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5541
  5542             20  CF-ST-REFUND-CALC          PIC X.
  5543                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5544                 88  ST-REFD-BY-R78             VALUE '1'.
  5545                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5546                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5547                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5548                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5549                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5550                 88  ST-REFD-UTAH               VALUE '7'.
  5551                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5552                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5553                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5554
  5555             20  CF-ST-EARNING-CALC         PIC X.
  5556                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5557                 88  ST-EARN-BY-R78             VALUE '1'.
  5558                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5559                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5560                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5561                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 103
* EL050.cbl
  5562                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5563                 88  ST-EARN-MEAN               VALUE '8'.
  5564                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5565
  5566             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5567                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5568                 88  ST-OVRD-BY-R78             VALUE '1'.
  5569                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5570                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5571                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5572                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5573                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5574                 88  ST-OVRD-MEAN               VALUE '8'.
  5575                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5576             20  FILLER                     PIC X.
  5577
  5578         16  CF-ST-COMMISSION-CAPS.
  5579             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5580             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5581             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5582             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5583         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5584                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5585
  5586         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5587
  5588         16  CF-ST-STATUTORY-INTEREST.
  5589             20  CF-ST-STAT-DATE-FROM       PIC X.
  5590                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5591                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5592             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5593             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5594             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5595             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5596             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5597
  5598         16  CF-ST-OVER-SHORT.
  5599             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5600             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5601
  5602         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5603
  5604         16  CF-ST-RT-CALC                  PIC X.
  5605
  5606         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5607         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5608         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5609         16  CF-ST-RF-LR-CALC               PIC X.
  5610         16  CF-ST-RF-LL-CALC               PIC X.
  5611         16  CF-ST-RF-LN-CALC               PIC X.
  5612         16  CF-ST-RF-AH-CALC               PIC X.
  5613         16  CF-ST-RF-CP-CALC               PIC X.
  5614*        16  FILLER                         PIC X(206).
  5615*CIDMOD         16  FILLER                         PIC X(192).
  5616         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5617             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5618         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5619         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 104
* EL050.cbl
  5620         16  CF-ST-CAUSAL-STATE             PIC X.
  5621         16  FILLER                         PIC X(185).
  5622
  5623****************************************************************
  5624*             BENEFIT MASTER RECORD                            *
  5625****************************************************************
  5626
  5627     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5628         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5629             20  CF-BENEFIT-CODE            PIC XX.
  5630             20  CF-BENEFIT-NUMERIC  REDEFINES
  5631                 CF-BENEFIT-CODE            PIC XX.
  5632             20  CF-BENEFIT-ALPHA           PIC XXX.
  5633             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5634             20  CF-BENEFIT-COMMENT         PIC X(10).
  5635
  5636             20  CF-LF-COVERAGE-TYPE        PIC X.
  5637                 88  CF-REDUCING                VALUE 'R'.
  5638                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5639
  5640             20  CF-SPECIAL-CALC-CD         PIC X.
  5641                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5642                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5643                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5644                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5645                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5646                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5647                 88  CF-FARM-PLAN               VALUE 'F'.
  5648                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5649                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5650                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5651                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5652                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5653                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5654                 88  CF-PRUDENTIAL              VALUE 'P'.
  5655                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5656                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5657                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5658                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5659                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5660                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5661
  5662             20  CF-JOINT-INDICATOR         PIC X.
  5663                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5664
  5665*            20  FILLER                     PIC X(12).
  5666             20  FILLER                     PIC X(11).
  5667             20  CF-BENEFIT-CATEGORY        PIC X.
  5668             20  CF-LOAN-TYPE               PIC X(8).
  5669
  5670             20  CF-CO-REM-TERM-CALC        PIC X.
  5671                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5672                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5673                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5674                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5675                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5676
  5677             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 105
* EL050.cbl
  5678                 88  CO-EARN-BY-R78             VALUE '1'.
  5679                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5680                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5681                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5682                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5683                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5684                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5685                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5686
  5687             20  CF-CO-REFUND-CALC          PIC X.
  5688                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5689                 88  CO-REFD-BY-R78             VALUE '1'.
  5690                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5691                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5692                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5693                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5694                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5695                 88  CO-REFD-MEAN               VALUE '8'.
  5696                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5697                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5698                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5699
  5700             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5701                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5702                 88  CO-OVRD-BY-R78             VALUE '1'.
  5703                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5704                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5705                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5706                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5707                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5708                 88  CO-OVRD-MEAN               VALUE '8'.
  5709                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5710
  5711             20  CF-CO-BEN-I-G-CD           PIC X.
  5712                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5713                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5714                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5715
  5716         16  FILLER                         PIC X(304).
  5717
  5718
  5719****************************************************************
  5720*             CARRIER MASTER RECORD                            *
  5721****************************************************************
  5722
  5723     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5724         16  CF-ADDRESS-DATA.
  5725             20  CF-MAIL-TO-NAME            PIC X(30).
  5726             20  CF-IN-CARE-OF              PIC X(30).
  5727             20  CF-ADDRESS-LINE-1          PIC X(30).
  5728             20  CF-ADDRESS-LINE-2          PIC X(30).
  5729             20  CF-CITY-STATE              PIC X(30).
  5730             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5731             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5732
  5733         16  CF-CLAIM-NO-CONTROL.
  5734             20  CF-CLAIM-NO-METHOD         PIC X.
  5735                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 106
* EL050.cbl
  5736                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5737                 88  CLAIM-NO-SEQ               VALUE '3'.
  5738                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5739             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5740                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5741                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5742                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5743
  5744         16  CF-CHECK-NO-CONTROL.
  5745             20  CF-CHECK-NO-METHOD         PIC X.
  5746                 88  CHECK-NO-MANUAL            VALUE '1'.
  5747                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5748                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5749                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5750             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5751                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5752
  5753         16  CF-DOMICILE-STATE              PIC XX.
  5754
  5755         16  CF-EXPENSE-CONTROLS.
  5756             20  CF-EXPENSE-METHOD          PIC X.
  5757                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5758                 88  DOLLARS-PER-PMT            VALUE '2'.
  5759                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5760                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5761             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5762             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5763
  5764         16  CF-CORRESPONDENCE-CONTROL.
  5765             20  CF-LETTER-RESEND-OPT       PIC X.
  5766                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5767                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5768             20  FILLER                     PIC X(4).
  5769
  5770         16  CF-RESERVE-CONTROLS.
  5771             20  CF-MANUAL-SW               PIC X.
  5772                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5773             20  CF-FUTURE-SW               PIC X.
  5774                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5775             20  CF-PTC-SW                  PIC X.
  5776                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5777             20  CF-IBNR-SW                 PIC X.
  5778                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5779             20  CF-PTC-LF-SW               PIC X.
  5780                 88  CF-LF-PTC-USED             VALUE '1'.
  5781             20  CF-CDT-ACCESS-METHOD       PIC X.
  5782                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5783                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5784                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5785             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5786
  5787         16  CF-CLAIM-CALC-METHOD           PIC X.
  5788             88  360-PLUS-MONTHS                VALUE '1'.
  5789             88  365-PLUS-MONTHS                VALUE '2'.
  5790             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5791             88  360-DAILY                      VALUE '4'.
  5792             88  365-DAILY                      VALUE '5'.
  5793
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 107
* EL050.cbl
  5794         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5795         16  FILLER                         PIC X(11).
  5796
  5797         16  CF-LIMIT-AMOUNTS.
  5798             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5799             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5800             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5801             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5802             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5803             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5804             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5805             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5806             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5807             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5808
  5809         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5810         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5811         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5812
  5813         16  CF-ZIP-CODE.
  5814             20  CF-ZIP-PRIME.
  5815                 24  CF-ZIP-1ST             PIC X.
  5816                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5817                 24  FILLER                 PIC X(4).
  5818             20  CF-ZIP-PLUS4               PIC X(4).
  5819         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5820             20  CF-CAN-POSTAL-1            PIC XXX.
  5821             20  CF-CAN-POSTAL-2            PIC XXX.
  5822             20  FILLER                     PIC XXX.
  5823
  5824         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5825         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5826         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5827
  5828         16  CF-RATING-SWITCH               PIC X.
  5829             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5830             88  CF-NO-RATING                   VALUE 'N'.
  5831
  5832         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5833
  5834         16  CF-CARRIER-OVER-SHORT.
  5835             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5836             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5837
  5838         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5839         16  CF-SECPAY-SWITCH               PIC X.
  5840             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5841             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5842         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5843         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5844         16  FILLER                         PIC X(444).
  5845*        16  FILLER                         PIC X(452).
  5846
  5847
  5848****************************************************************
  5849*             MORTALITY MASTER RECORD                          *
  5850****************************************************************
  5851
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 108
* EL050.cbl
  5852     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5853         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5854                                INDEXED BY CF-MORT-NDX.
  5855             20  CF-MORT-TABLE              PIC X(5).
  5856             20  CF-MORT-TABLE-TYPE         PIC X.
  5857                 88  CF-MORT-JOINT              VALUE 'J'.
  5858                 88  CF-MORT-SINGLE             VALUE 'S'.
  5859                 88  CF-MORT-COMBINED           VALUE 'C'.
  5860                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5861                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5862             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5863             20  CF-MORT-AGE-METHOD         PIC XX.
  5864                 88  CF-AGE-LAST                VALUE 'AL'.
  5865                 88  CF-AGE-NEAR                VALUE 'AN'.
  5866             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5867             20  CF-MORT-ADJUSTMENT-DIRECTION
  5868                                            PIC X.
  5869                 88  CF-MINUS                   VALUE '-'.
  5870                 88  CF-PLUS                    VALUE '+'.
  5871             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5872             20  CF-MORT-JOINT-CODE         PIC X.
  5873                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5874             20  CF-MORT-PC-Q               PIC X.
  5875                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5876             20  CF-MORT-TABLE-CODE         PIC X(4).
  5877             20  CF-MORT-COMMENTS           PIC X(15).
  5878             20  FILLER                     PIC X(14).
  5879
  5880         16  FILLER                         PIC X(251).
  5881
  5882
  5883****************************************************************
  5884*             BUSSINESS TYPE MASTER RECORD                     *
  5885****************************************************************
  5886
  5887     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5888* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5889* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5890* AND RECORD 05 IS TYPES 81-99
  5891         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5892             20  CF-BUSINESS-TITLE          PIC  X(19).
  5893             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5894                                            PIC S9V9(4) COMP-3.
  5895             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5896             20  FILLER                     PIC  X.
  5897         16  FILLER                         PIC  X(248).
  5898
  5899
  5900****************************************************************
  5901*             TERMINAL MASTER RECORD                           *
  5902****************************************************************
  5903
  5904     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5905
  5906         16  CF-COMPANY-TERMINALS.
  5907             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5908                                  PIC X(4).
  5909         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 109
* EL050.cbl
  5910
  5911
  5912****************************************************************
  5913*             LIFE EDIT MASTER RECORD                          *
  5914****************************************************************
  5915
  5916     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5917         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5918             20  CF-LIFE-CODE-IN            PIC XX.
  5919             20  CF-LIFE-CODE-OUT           PIC XX.
  5920         16  FILLER                         PIC X(248).
  5921
  5922
  5923****************************************************************
  5924*             AH EDIT MASTER RECORD                            *
  5925****************************************************************
  5926
  5927     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5928         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5929             20  CF-AH-CODE-IN              PIC XXX.
  5930             20  CF-AH-CODE-OUT             PIC XX.
  5931         16  FILLER                         PIC X(248).
  5932
  5933
  5934****************************************************************
  5935*             CREDIBILITY TABLES                               *
  5936****************************************************************
  5937
  5938     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5939         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5940                             INDEXED BY CF-CRDB-NDX.
  5941             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5942             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5943             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5944         16  FILLER                         PIC  X(332).
  5945
  5946
  5947****************************************************************
  5948*             REPORT CUSTOMIZATION RECORD                      *
  5949****************************************************************
  5950
  5951     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5952         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5953             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5954             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5955             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5956**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5957****       A T-TRANSFER.                                   ****
  5958             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5959
  5960         16  FILLER                         PIC XX.
  5961
  5962         16  CF-CARRIER-CNTL-OPT.
  5963             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5964                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5965                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5966             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5967                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 110
* EL050.cbl
  5968         16  CF-GROUP-CNTL-OPT.
  5969             20  CF-GROUP-OPT-SEQ           PIC 9.
  5970                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5971                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5972             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5973                                            PIC X(6).
  5974         16  CF-STATE-CNTL-OPT.
  5975             20  CF-STATE-OPT-SEQ           PIC 9.
  5976                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5977                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5978             20  CF-STATE-SELECT OCCURS 3 TIMES
  5979                                            PIC XX.
  5980         16  CF-ACCOUNT-CNTL-OPT.
  5981             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5982                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5983                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5984             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5985                                            PIC X(10).
  5986         16  CF-BUS-TYP-CNTL-OPT.
  5987             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5988                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5989                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5990             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5991                                            PIC XX.
  5992         16  CF-LF-TYP-CNTL-OPT.
  5993             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5994                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5995                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5996             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5997                                            PIC XX.
  5998         16  CF-AH-TYP-CNTL-OPT.
  5999             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6000                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6001                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6002             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6003                                            PIC XX.
  6004         16  CF-REPTCD1-CNTL-OPT.
  6005             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6006                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6007                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6008             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6009                                            PIC X(10).
  6010         16  CF-REPTCD2-CNTL-OPT.
  6011             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6012                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6013                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6014             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6015                                            PIC X(10).
  6016         16  CF-USER1-CNTL-OPT.
  6017             20  CF-USER1-OPT-SEQ           PIC 9.
  6018                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6019                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6020             20  CF-USER1-SELECT OCCURS 3 TIMES
  6021                                            PIC X(10).
  6022         16  CF-USER2-CNTL-OPT.
  6023             20  CF-USER2-OPT-SEQ           PIC 9.
  6024                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6025                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 111
* EL050.cbl
  6026             20  CF-USER2-SELECT OCCURS 3 TIMES
  6027                                            PIC X(10).
  6028         16  CF-USER3-CNTL-OPT.
  6029             20  CF-USER3-OPT-SEQ           PIC 9.
  6030                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6031                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6032             20  CF-USER3-SELECT OCCURS 3 TIMES
  6033                                            PIC X(10).
  6034         16  CF-USER4-CNTL-OPT.
  6035             20  CF-USER4-OPT-SEQ           PIC 9.
  6036                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6037                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6038             20  CF-USER4-SELECT OCCURS 3 TIMES
  6039                                            PIC X(10).
  6040         16  CF-USER5-CNTL-OPT.
  6041             20  CF-USER5-OPT-SEQ           PIC 9.
  6042                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6043                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6044             20  CF-USER5-SELECT OCCURS 3 TIMES
  6045                                            PIC X(10).
  6046         16  CF-REINS-CNTL-OPT.
  6047             20  CF-REINS-OPT-SEQ           PIC 9.
  6048                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6049                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6050             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6051                 24  CF-REINS-PRIME         PIC XXX.
  6052                 24  CF-REINS-SUB           PIC XXX.
  6053
  6054         16  CF-AGENT-CNTL-OPT.
  6055             20  CF-AGENT-OPT-SEQ           PIC 9.
  6056                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6057                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6058             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6059                                            PIC X(10).
  6060
  6061         16  FILLER                         PIC X(43).
  6062
  6063         16  CF-LOSS-RATIO-SELECT.
  6064             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6065             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6066         16  CF-ENTRY-DATE-SELECT.
  6067             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6068             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6069         16  CF-EFFECTIVE-DATE-SELECT.
  6070             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6071             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6072
  6073         16  CF-EXCEPTION-LIST-IND          PIC X.
  6074             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6075
  6076         16  FILLER                         PIC X(318).
  6077
  6078****************************************************************
  6079*                  EXCEPTION REPORTING RECORD                  *
  6080****************************************************************
  6081
  6082     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6083         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 112
* EL050.cbl
  6084             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6085
  6086         16  CF-COMBINED-LIFE-AH-OPT.
  6087             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6088             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6089             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6090             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6091
  6092         16  CF-LIFE-OPT.
  6093             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6094             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6095             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6096             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6097             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6098             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6099             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6100             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6101             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6102             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6103
  6104         16  CF-AH-OPT.
  6105             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6106             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6107             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6108             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6109             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6110             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6111             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6112             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6113             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6114             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6115
  6116         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6117             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6118             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6119             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6120
  6121         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6122
  6123         16  FILLER                         PIC X(673).
  6124
  6125
  6126****************************************************************
  6127*             MORTGAGE SYSTEM PLAN RECORD                      *
  6128****************************************************************
  6129
  6130     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6131         16  CF-PLAN-TYPE                   PIC X.
  6132             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6133             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6134             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6135         16  CF-PLAN-ABBREV                 PIC XXX.
  6136         16  CF-PLAN-DESCRIPT               PIC X(10).
  6137         16  CF-PLAN-NOTES                  PIC X(20).
  6138         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6139         16  CF-PLAN-UNDERWRITING.
  6140             20  CF-PLAN-TERM-DATA.
  6141                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 113
* EL050.cbl
  6142                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6143             20  CF-PLAN-AGE-DATA.
  6144                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6145                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6146                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6147             20  CF-PLAN-BENEFIT-DATA.
  6148                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6149                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6150                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6151                                            PIC S9(7)V99  COMP-3.
  6152         16  CF-PLAN-POLICY-FORMS.
  6153             20  CF-POLICY-FORM             PIC X(12).
  6154             20  CF-MASTER-APPLICATION      PIC X(12).
  6155             20  CF-MASTER-POLICY           PIC X(12).
  6156         16  CF-PLAN-RATING.
  6157             20  CF-RATE-CODE               PIC X(5).
  6158             20  CF-SEX-RATING              PIC X.
  6159                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6160                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6161             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6162             20  CF-SUB-STD-TYPE            PIC X.
  6163                 88  CF-PCT-OF-PREM            VALUE '1'.
  6164                 88  CF-PCT-OF-BENE            VALUE '2'.
  6165         16  CF-PLAN-PREM-TOLERANCES.
  6166             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6167             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6168         16  CF-PLAN-PYMT-TOLERANCES.
  6169             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6170             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6171         16  CF-PLAN-MISC-DATA.
  6172             20  FILLER                     PIC X.
  6173             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6174             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6175         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6176         16  CF-PLAN-IND-GRP                PIC X.
  6177             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6178                                                     '1'.
  6179             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6180                                                     '2'.
  6181         16  CF-MIB-SEARCH-SW               PIC X.
  6182             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6183             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6184             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6185             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6186         16  CF-ALPHA-SEARCH-SW             PIC X.
  6187             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6188             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6189             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6190             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6191             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6192             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6193             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6194             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6195             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6196             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6197                                                     'A' 'B' 'C'
  6198                                                     'X' 'Y' 'Z'.
  6199         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 114
* EL050.cbl
  6200             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6201             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6202             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6203             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6204             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6205         16  FILLER                         PIC X(4).
  6206         16  CF-HEALTH-QUESTIONS            PIC X.
  6207             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6208         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6209         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6210         16  CF-PLAN-SNGL-JNT               PIC X.
  6211             88  CF-COMBINED-PLAN              VALUE 'C'.
  6212             88  CF-JNT-PLAN                   VALUE 'J'.
  6213             88  CF-SNGL-PLAN                  VALUE 'S'.
  6214         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6215         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6216         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6217         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6218         16  CF-RERATE-CNTL                 PIC  X.
  6219             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6220             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6221             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6222             88  CF-AUTO-RECALC                 VALUE '4'.
  6223         16  CF-BENEFIT-TYPE                PIC  X.
  6224             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6225             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6226         16  CF-POLICY-FEE                  PIC S999V99
  6227                                                    COMP-3.
  6228         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6229         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6230         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6231         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6232         16  FILLER                         PIC  X(32).
  6233         16  CF-TERMINATION-FORM            PIC  X(04).
  6234         16  FILLER                         PIC  X(08).
  6235         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6236                                                       COMP-3.
  6237         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6238         16  CF-ISSUE-LETTER                PIC  X(4).
  6239         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6240         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6241             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6242             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6243         16  CF-MP-REFUND-CALC              PIC X.
  6244             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6245             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6246             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6247             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6248             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6249             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6250             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6251             88  CF-MP-REFD-MEAN                VALUE '8'.
  6252         16  CF-ALT-RATE-CODE               PIC  X(5).
  6253
  6254
  6255         16  FILLER                         PIC X(498).
  6256****************************************************************
  6257*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 115
* EL050.cbl
  6258****************************************************************
  6259
  6260     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6261         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6262         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6263             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6264             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6265             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6266             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6267             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6268
  6269         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6270         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6271         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6272         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6273         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6274
  6275         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6276             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6277         16  CF-MP-RECON-USE-IND            PIC X(1).
  6278             88  CF-MP-USE-RECON             VALUE 'Y'.
  6279         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6280             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6281         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6282             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6283             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6284         16  FILLER                         PIC X(1).
  6285         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6286             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6287         16  CF-MORTG-MIB-VERSION           PIC X.
  6288             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6289             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6290             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6291         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6292             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6293                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6294             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6295                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6296             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6297                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6298             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6299                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6300             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6301                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6302             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6303                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6304         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6305         16  FILLER                         PIC X(7).
  6306         16  CF-MORTG-DESTINATION-SYMBOL.
  6307             20  CF-MORTG-MIB-COMM          PIC X(5).
  6308             20  CF-MORTG-MIB-TERM          PIC X(5).
  6309         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6310             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6311         16  FILLER                         PIC X(03).
  6312         16  CF-MP-CHECK-NO-CONTROL.
  6313             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6314                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6315                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 116
* EL050.cbl
  6316                                                ' ' LOW-VALUES.
  6317                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6318                                               VALUE '3'.
  6319         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6320         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6321         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6322             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6323                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6324             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6325                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6326             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6327                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6328             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6329                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6330             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6331                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6332             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6333                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6334         16  CF-MORTG-BILLING-AREA.
  6335             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6336                                            PIC X.
  6337         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6338         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6339         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6340         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6341             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6342             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6343         16  FILLER                         PIC X.
  6344         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6345             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6346             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6347         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6348         16  FILLER                         PIC X(8).
  6349         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6350         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6351         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6352         16  CF-ACH-COMPANY-ID.
  6353             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6354                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6355                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6356                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6357             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6358         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6359             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6360         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6361             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6362             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6363         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6364         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6365         16  FILLER                         PIC X(536).
  6366
  6367****************************************************************
  6368*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6369****************************************************************
  6370
  6371     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6372         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6373             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 117
* EL050.cbl
  6374                 24  CF-FEMALE-FT           PIC 99.
  6375                 24  CF-FEMALE-IN           PIC 99.
  6376             20  CF-FEMALE-MIN-WT           PIC 999.
  6377             20  CF-FEMALE-MAX-WT           PIC 999.
  6378         16  FILLER                         PIC X(428).
  6379
  6380     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6381         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6382             20  CF-MALE-HEIGHT.
  6383                 24  CF-MALE-FT             PIC 99.
  6384                 24  CF-MALE-IN             PIC 99.
  6385             20  CF-MALE-MIN-WT             PIC 999.
  6386             20  CF-MALE-MAX-WT             PIC 999.
  6387         16  FILLER                         PIC X(428).
  6388******************************************************************
  6389*             AUTOMATIC ACTIVITY RECORD                          *
  6390******************************************************************
  6391     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6392         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6393             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6394             20  CF-SYS-LETTER-ID           PIC X(04).
  6395             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6396             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6397             20  CF-SYS-RESET-SW            PIC X(01).
  6398             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6399             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6400
  6401         16  FILLER                         PIC X(50).
  6402
  6403         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6404             20  CF-USER-ACTIVE-SW          PIC X(01).
  6405             20  CF-USER-LETTER-ID          PIC X(04).
  6406             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6407             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6408             20  CF-USER-RESET-SW           PIC X(01).
  6409             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6410             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6411             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6412
  6413         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 118
* EL050.cbl
  6415*    COPY ERCACCT.
  6416******************************************************************
  6417*                                                                *
  6418*                                                                *
  6419*                            ERCACCT                             *
  6420*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6421*                            VMOD=2.031                          *
  6422*                                                                *
  6423*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6424*                                                                *
  6425*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6426*   VSAM ACCOUNT MASTER FILES.                                   *
  6427*                                                                *
  6428*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6429*                                                                *
  6430*   FILE TYPE = VSAM,KSDS                                        *
  6431*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6432*                                                                *
  6433*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6434*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6435*                                                                *
  6436*   LOG = NO                                                     *
  6437*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6438*                                                                *
  6439*                                                                *
  6440******************************************************************
  6441*                   C H A N G E   L O G
  6442*
  6443* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6444*-----------------------------------------------------------------
  6445*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6446* EFFECTIVE    NUMBER
  6447*-----------------------------------------------------------------
  6448* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6449* 092705    2005050300006  PEMA  ADD SPP LEASES
  6450* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6451* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6452* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6453* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6454* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6455******************************************************************
  6456
  6457 01  ACCOUNT-MASTER.
  6458     12  AM-RECORD-ID                      PIC XX.
  6459         88  VALID-AM-ID                      VALUE 'AM'.
  6460
  6461     12  AM-CONTROL-PRIMARY.
  6462         16  AM-COMPANY-CD                 PIC X.
  6463         16  AM-MSTR-CNTRL.
  6464             20  AM-CONTROL-A.
  6465                 24  AM-CARRIER            PIC X.
  6466                 24  AM-GROUPING.
  6467                     28 AM-GROUPING-PREFIX PIC XXX.
  6468                     28 AM-GROUPING-PRIME  PIC XXX.
  6469                 24  AM-STATE              PIC XX.
  6470                 24  AM-ACCOUNT.
  6471                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6472                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 119
* EL050.cbl
  6473             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6474                                           PIC X(19).
  6475             20  AM-CNTRL-B.
  6476                 24  AM-EXPIRATION-DT      PIC XX.
  6477                 24  FILLER                PIC X(4).
  6478             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6479                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6480
  6481     12  AM-CONTROL-BY-VAR-GRP.
  6482         16  AM-COMPANY-CD-A1              PIC X.
  6483         16  AM-VG-CARRIER                 PIC X.
  6484         16  AM-VG-GROUPING                PIC X(6).
  6485         16  AM-VG-STATE                   PIC XX.
  6486         16  AM-VG-ACCOUNT                 PIC X(10).
  6487         16  AM-VG-DATE.
  6488             20  AM-VG-EXPIRATION-DT       PIC XX.
  6489             20  FILLER                    PIC X(4).
  6490         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6491                                           PIC 9(11)      COMP-3.
  6492     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6493         16  FILLER                        PIC X(10).
  6494         16  AM-VG-KEY3.
  6495             20  AM-VG3-ACCOUNT            PIC X(10).
  6496             20  AM-VG3-EXP-DT             PIC XX.
  6497         16  FILLER                        PIC X(4).
  6498     12  AM-MAINT-INFORMATION.
  6499         16  AM-LAST-MAINT-DT              PIC XX.
  6500         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6501         16  AM-LAST-MAINT-USER            PIC X(4).
  6502         16  FILLER                        PIC XX.
  6503
  6504     12  AM-EFFECTIVE-DT                   PIC XX.
  6505     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6506
  6507     12  AM-PREV-DATES  COMP-3.
  6508         16  AM-PREV-EXP-DT                PIC 9(11).
  6509         16  AM-PREV-EFF-DT                PIC 9(11).
  6510
  6511     12  AM-REPORT-CODE-1                  PIC X(10).
  6512     12  AM-REPORT-CODE-2                  PIC X(10).
  6513
  6514     12  AM-CITY-CODE                      PIC X(4).
  6515     12  AM-COUNTY-PARISH                  PIC X(6).
  6516
  6517     12  AM-NAME                           PIC X(30).
  6518     12  AM-PERSON                         PIC X(30).
  6519     12  AM-ADDRS                          PIC X(30).
  6520     12  AM-CITY.
  6521         16  AM-ADDR-CITY                  PIC X(28).
  6522         16  AM-ADDR-STATE                 PIC XX.
  6523     12  AM-ZIP.
  6524         16  AM-ZIP-PRIME.
  6525             20  AM-ZIP-PRI-1ST            PIC X.
  6526                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6527             20  FILLER                    PIC X(4).
  6528         16  AM-ZIP-PLUS4                  PIC X(4).
  6529     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6530         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 120
* EL050.cbl
  6531         16  AM-CAN-POSTAL-2               PIC XXX.
  6532         16  FILLER                        PIC XXX.
  6533     12  AM-TEL-NO.
  6534         16  AM-AREA-CODE                  PIC 999.
  6535         16  AM-TEL-PRE                    PIC 999.
  6536         16  AM-TEL-NBR                    PIC 9(4).
  6537     12  AM-TEL-LOC                        PIC X.
  6538         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6539         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6540
  6541     12  AM-COMM-STRUCTURE.
  6542         16  AM-DEFN-1.
  6543             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6544                 24  AM-AGT.
  6545                     28  AM-AGT-PREFIX     PIC X(4).
  6546                     28  AM-AGT-PRIME      PIC X(6).
  6547                 24  AM-COM-TYP            PIC X.
  6548                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6549                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6550                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6551                 24  AM-RECALC-LV-INDIC    PIC X.
  6552                 24  AM-RETRO-LV-INDIC     PIC X.
  6553                 24  AM-GL-CODES           PIC X.
  6554                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6555                 24  FILLER                PIC X(01).
  6556         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6557             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6558                 24  FILLER                PIC X(11).
  6559                 24  AM-L-COMA             PIC XXX.
  6560                 24  AM-J-COMA             PIC XXX.
  6561                 24  AM-A-COMA             PIC XXX.
  6562                 24  FILLER                PIC X(6).
  6563
  6564     12  AM-COMM-CHANGE-STATUS             PIC X.
  6565         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6566
  6567     12  AM-CSR-CODE                       PIC X(4).
  6568
  6569     12  AM-BILLING-STATUS                 PIC X.
  6570         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6571         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6572     12  AM-AUTO-REFUND-SW                 PIC X.
  6573         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6574         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6575     12  AM-GPCD                           PIC 99.
  6576     12  AM-IG                             PIC X.
  6577         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6578         88  AM-HAS-GROUP                     VALUE '2'.
  6579     12  AM-STATUS                         PIC X.
  6580         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6581         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6582         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6583         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6584         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6585         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6586     12  AM-REMIT-TO                       PIC 99.
  6587     12  AM-ID-NO                          PIC X(11).
  6588
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 121
* EL050.cbl
  6589     12  AM-CAL-TABLE                      PIC XX.
  6590     12  AM-LF-DEVIATION                   PIC XXX.
  6591     12  AM-AH-DEVIATION                   PIC XXX.
  6592     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6593     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6594     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6595     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6596     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6597     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6598
  6599     12  AM-USER-FIELDS.
  6600         16  AM-FLD-1                      PIC XX.
  6601         16  AM-FLD-2                      PIC XX.
  6602         16  AM-FLD-3                      PIC XX.
  6603         16  AM-FLD-4                      PIC XX.
  6604         16  AM-FLD-5                      PIC XX.
  6605
  6606     12  AM-1ST-PROD-DATE.
  6607         16  AM-1ST-PROD-YR                PIC XX.
  6608         16  AM-1ST-PROD-MO                PIC XX.
  6609         16  AM-1ST-PROD-DA                PIC XX.
  6610     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6611     12  AM-CERTS-PURGED-DATE.
  6612         16  AM-PUR-YR                     PIC XX.
  6613         16  AM-PUR-MO                     PIC XX.
  6614         16  AM-PUR-DA                     PIC XX.
  6615     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6616     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6617     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6618     12  AM-INACTIVE-DATE.
  6619         16  AM-INA-MO                     PIC 99.
  6620         16  AM-INA-DA                     PIC 99.
  6621         16  AM-INA-YR                     PIC 99.
  6622     12  AM-AR-HI-CERT-DATE                PIC XX.
  6623
  6624     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6625     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6626
  6627     12  AM-OB-PAYMENT-MODE                PIC X.
  6628         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6629         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6630         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6631         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6632
  6633     12  AM-AH-ONLY-INDICATOR              PIC X.
  6634         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6635         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6636
  6637     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6638
  6639     12  AM-OVER-SHORT.
  6640         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6641         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6642
  6643     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6644     12  AM-DCC-CLP-STATE                  PIC XX.
  6645
  6646     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 122
* EL050.cbl
  6647     12  AM-RECALC-REIN                    PIC X.
  6648
  6649     12  AM-REI-TABLE                      PIC XXX.
  6650     12  AM-REI-ET-LF                      PIC X.
  6651     12  AM-REI-ET-AH                      PIC X.
  6652     12  AM-REI-PE-LF                      PIC X.
  6653     12  AM-REI-PE-AH                      PIC X.
  6654     12  AM-REI-PRT-ST                     PIC X.
  6655     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6656     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6657     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6658     12  AM-REI-GROUP-A                    PIC X(6).
  6659     12  AM-REI-MORT                       PIC X(4).
  6660     12  AM-REI-PRT-OW                     PIC X.
  6661     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6662     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6663     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6664     12  AM-REI-GROUP-B                    PIC X(6).
  6665
  6666     12  AM-TRUST-TYPE                     PIC X(2).
  6667
  6668     12  AM-EMPLOYER-STMT-USED             PIC X.
  6669     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6670
  6671     12  AM-STD-AH-TYPE                    PIC XX.
  6672     12  AM-EARN-METHODS.
  6673         16  AM-EARN-METHOD-R              PIC X.
  6674             88 AM-REF-RL-R78                 VALUE 'R'.
  6675             88 AM-REF-RL-PR                  VALUE 'P'.
  6676             88 AM-REF-RL-MEAN                VALUE 'M'.
  6677             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6678         16  AM-EARN-METHOD-L              PIC X.
  6679             88 AM-REF-LL-R78                 VALUE 'R'.
  6680             88 AM-REF-LL-PR                  VALUE 'P'.
  6681             88 AM-REF-LL-MEAN                VALUE 'M'.
  6682             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6683         16  AM-EARN-METHOD-A              PIC X.
  6684             88 AM-REF-AH-R78                 VALUE 'R'.
  6685             88 AM-REF-AH-PR                  VALUE 'P'.
  6686             88 AM-REF-AH-MEAN                VALUE 'M'.
  6687             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6688             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6689             88 AM-REF-AH-NET                 VALUE 'N'.
  6690
  6691     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6692     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6693     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6694
  6695     12  AM-RET-Y-N                        PIC X.
  6696     12  AM-RET-P-E                        PIC X.
  6697     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6698     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6699     12  AM-RET-GRP                        PIC X(6).
  6700     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6701         16  AM-POOL-PRIME                 PIC XXX.
  6702         16  AM-POOL-SUB                   PIC XXX.
  6703     12  AM-RETRO-EARNINGS.
  6704         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 123
* EL050.cbl
  6705         16  AM-RET-EARN-L                 PIC X.
  6706         16  AM-RET-EARN-A                 PIC X.
  6707     12  AM-RET-ST-TAX-USE                 PIC X.
  6708         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6709         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6710     12  AM-RETRO-BEG-EARNINGS.
  6711         16  AM-RET-BEG-EARN-R             PIC X.
  6712         16  AM-RET-BEG-EARN-L             PIC X.
  6713         16  AM-RET-BEG-EARN-A             PIC X.
  6714     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6715     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6716
  6717     12  AM-USER-SELECT-OPTIONS.
  6718         16  AM-USER-SELECT-1              PIC X(10).
  6719         16  AM-USER-SELECT-2              PIC X(10).
  6720         16  AM-USER-SELECT-3              PIC X(10).
  6721         16  AM-USER-SELECT-4              PIC X(10).
  6722         16  AM-USER-SELECT-5              PIC X(10).
  6723
  6724     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6725
  6726     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6727
  6728     12  AM-RPT045A-SWITCH                 PIC X.
  6729         88  RPT045A-OFF                   VALUE 'N'.
  6730
  6731     12  AM-INSURANCE-LIMITS.
  6732         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6733         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6734
  6735     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6736         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6737
  6738     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6739         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6740         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6741
  6742     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6743
  6744     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6745     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6746     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6747     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6748     12  AM-DCC-UEF-STATE                  PIC XX.
  6749     12  FILLER                            PIC XXX.
  6750     12  AM-REPORT-CODE-3                  PIC X(10).
  6751*    12  FILLER                            PIC X(22).
  6752
  6753     12  AM-RESERVE-DATE.
  6754         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6755         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6756         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6757
  6758     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6759     12  AM-NOTIFICATION-TYPES.
  6760         16  AM-NOTIF-OF-LETTERS           PIC X.
  6761         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6762         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 124
* EL050.cbl
  6763         16  AM-NOTIF-OF-STATUS            PIC X.
  6764
  6765     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6766         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6767         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6768         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6769         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6770
  6771     12  AM-BENEFIT-CONTROLS.
  6772         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6773             20  AM-BENEFIT-CODE           PIC XX.
  6774             20  AM-BENEFIT-TYPE           PIC X.
  6775             20  AM-BENEFIT-REVISION       PIC XXX.
  6776             20  AM-BENEFIT-REM-TERM       PIC X.
  6777             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6778             20  FILLER                    PIC XX.
  6779         16  FILLER                        PIC X(80).
  6780
  6781     12  AM-TRANSFER-DATA.
  6782         16  AM-TRANSFERRED-FROM.
  6783             20  AM-TRNFROM-CARRIER        PIC X.
  6784             20  AM-TRNFROM-GROUPING.
  6785                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6786                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6787             20  AM-TRNFROM-STATE          PIC XX.
  6788             20  AM-TRNFROM-ACCOUNT.
  6789                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6790                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6791             20  AM-TRNFROM-DTE            PIC XX.
  6792         16  AM-TRANSFERRED-TO.
  6793             20  AM-TRNTO-CARRIER          PIC X.
  6794             20  AM-TRNTO-GROUPING.
  6795                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6796                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6797             20  AM-TRNTO-STATE            PIC XX.
  6798             20  AM-TRNTO-ACCOUNT.
  6799                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6800                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6801             20  AM-TRNTO-DTE              PIC XX.
  6802         16  FILLER                        PIC X(10).
  6803
  6804     12  AM-SAVED-REMIT-TO                 PIC 99.
  6805
  6806     12  AM-COMM-STRUCTURE-SAVED.
  6807         16  AM-DEFN-1-SAVED.
  6808             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6809                 24  AM-AGT-SV             PIC X(10).
  6810                 24  AM-COM-TYP-SV         PIC X.
  6811                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6812                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6813                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6814                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6815                 24  FILLER                PIC X.
  6816                 24  AM-GL-CODES-SV        PIC X.
  6817                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6818                 24  FILLER                PIC X.
  6819         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6820             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 125
* EL050.cbl
  6821                 24  FILLER                PIC X(11).
  6822                 24  AM-L-COMA-SV          PIC XXX.
  6823                 24  AM-J-COMA-SV          PIC XXX.
  6824                 24  AM-A-COMA-SV          PIC XXX.
  6825                 24  FILLER                PIC X(6).
  6826
  6827     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6828         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6829            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6830            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6831            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6832
  6833     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6834     12  FILLER                            PIC X(120).
  6835
  6836     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6837         16  AM-CONTROL-NAME               PIC X(30).
  6838         16  AM-EXECUTIVE-ONE.
  6839             20  AM-EXEC1-NAME             PIC X(15).
  6840             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6841                                                          COMP-3.
  6842             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6843                                                          COMP-3.
  6844         16  AM-EXECUTIVE-TWO.
  6845             20  AM-EXEC2-NAME             PIC X(15).
  6846             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6847                                                          COMP-3.
  6848             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6849                                                          COMP-3.
  6850
  6851     12  AM-RETRO-ADDITIONAL-DATA.
  6852         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6853         16  AM-RETRO-PREM-P-E             PIC X.
  6854         16  AM-RETRO-CLMS-P-I             PIC X.
  6855         16  AM-RETRO-RET-BRACKET-LF.
  6856             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6857                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6858                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6859             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6860                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6861                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6862             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6863                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6864                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6865         16  AM-RETRO-RET-BRACKET-AH.
  6866             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6867                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6868                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6869                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6870             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6871                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6872                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6873             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6874                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6875                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6876
  6877     12  AM-COMMENTS.
  6878         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 126
* EL050.cbl
  6879
  6880     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6881         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6882         16  AM-FLI-BILLING-CODE           PIC X.
  6883         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6884         16  AM-FLI-UNITED-IDENT           PIC X.
  6885         16  AM-FLI-INTEREST-LOST-DATA.
  6886             20  AM-FLI-BANK-NO            PIC X(5).
  6887             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6888             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6889             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6890         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6891             20  AM-FLI-AGT                PIC X(9).
  6892             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6893             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6894         16  FILLER                        PIC X(102).
  6895
  6896     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6897         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6898             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6899             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6900             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6901             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6902             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6903         16  FILLER                          PIC X(10).
  6904******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 127
* EL050.cbl
  6906*    COPY ERCREIN.
  6907******************************************************************
  6908*                                                                *
  6909*                            ERCREIN                             *
  6910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6911*                            VMOD=2.010                          *
  6912*                                                                *
  6913*   ONLINE CREDIT SYSTEM                                         *
  6914*                                                                *
  6915*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6916*                                                                *
  6917*   FILE TYPE = VSAM,KSDS                                        *
  6918*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6919*                                                                *
  6920*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6921*       ALTERNATE PATH = NONE                                    *
  6922*                                                                *
  6923*   LOG = NO                                                     *
  6924*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6925*                                                                *
  6926******************************************************************
  6927*                   C H A N G E   L O G
  6928*
  6929* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6930*-----------------------------------------------------------------
  6931*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6932* EFFECTIVE    NUMBER
  6933*-----------------------------------------------------------------
  6934* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6935* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6936******************************************************************
  6937 01  REINSURANCE-RECORD.
  6938     12  RE-RECORD-ID                      PIC XX.
  6939         88  VALID-RE-ID                      VALUE 'RE'.
  6940
  6941     12  RE-CONTROL-PRIMARY.
  6942         16  RE-COMPANY-CD                 PIC X.
  6943         16  RE-KEY.
  6944             20  RE-CODE                   PIC X.
  6945                 88  RE-TABLE-RECORD          VALUE 'A'.
  6946                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6947             20  RE-TABLE                  PIC XXX.
  6948             20  FILLER                    PIC XXX.
  6949         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6950             20  FILLER                    PIC X.
  6951             20  RE-COMPANY.
  6952                 24  RE-COMP-PRIME         PIC XXX.
  6953                 24  RE-COMP-SUB           PIC XXX.
  6954
  6955     12  RE-MAINT-INFORMATION.
  6956         16  RE-LAST-MAINT-DT              PIC XX.
  6957         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6958         16  RE-LAST-MAINT-USER            PIC X(4).
  6959         16  FILLER                        PIC X(10).
  6960
  6961     12  RE-TABLE-DATA.
  6962         16  RE-100-COMP                   PIC 99.
  6963
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 128
* EL050.cbl
  6964         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6965             20  RE-REI-COMP-NO.
  6966                 24  RE-REI-COMP           PIC XXX.
  6967                 24  RE-REI-COMP-SUB       PIC XXX.
  6968             20  RE-LF-QC                  PIC X.
  6969             20  RE-AH-QC                  PIC X.
  6970             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6971             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6972             20  RE-LFAGE-LO               PIC 99.
  6973             20  RE-LFAGE-HI               PIC 99.
  6974             20  RE-AHAGE-LO               PIC 99.
  6975             20  RE-AHAGE-HI               PIC 99.
  6976             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6977             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6978             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6979             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6980             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6981             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6982             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6983             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6984             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6985             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6986             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6987             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6988             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6989             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6990             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6991             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6992             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6993             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6994             20  RE-LF-BEN-CODE            PIC X.
  6995             20  RE-AH-BEN-CODE            PIC X.
  6996             20  RE-INTERACTIVE            PIC X.
  6997             20  RE-REMAINING              PIC X.
  6998             20  RE-LF-RUNOFF-SW           PIC X.
  6999             20  RE-AH-RUNOFF-SW           PIC X.
  7000             20  FILLER                    PIC X(19).
  7001
  7002         16  RE-COMP-INFO-END              PIC X(6).
  7003         16  RE-NSP-ST-CD-LF               PIC XX.
  7004         16  RE-NSP-ST-CD-AH               PIC XX.
  7005         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7006             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7007
  7008         16  FILLER                        PIC X(27).
  7009
  7010     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7011         16  RE-NAME                       PIC X(30).
  7012         16  RE-LF-PE                      PIC X.
  7013         16  RE-AH-PE                      PIC X.
  7014         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7015         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7016         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7017         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7018         16  RE-PRT-ST                     PIC X.
  7019         16  RE-PRT-OW                     PIC X.
  7020         16  RE-MORT-CODE                  PIC X(4).
  7021         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 129
* EL050.cbl
  7022         16  RE-ZERO-LF-FEE                PIC X.
  7023         16  RE-ZERO-AH-FEE                PIC X.
  7024         16  RE-CEDE-NAME                  PIC X(30).
  7025         16  RE-LF-COMM                    PIC X.
  7026         16  RE-AH-COMM                    PIC X.
  7027         16  RE-LF-TAX                     PIC X.
  7028         16  RE-AH-TAX                     PIC X.
  7029         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7030         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7031         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7032
  7033         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7034             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7035
  7036         16  RE-LF-CEDING-FEE-BRACKETS.
  7037             20  RE-LF-FEE-METHOD          PIC X.
  7038                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7039                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7040                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7041                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7042             20  RE-LF-FEE-BASIS           PIC X.
  7043                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7044                 88  RE-LF-NET-CEDED               VALUE '2'.
  7045                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7046                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7047                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7048                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7049                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7050                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7051             20  FILLER                    PIC XXX.
  7052             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7053                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7054                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7055
  7056         16  RE-AH-CEDING-FEE-BRACKETS.
  7057             20  RE-AH-FEE-METHOD          PIC X.
  7058                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7059                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7060                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7061                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7062             20  RE-AH-FEE-BASIS           PIC X.
  7063                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7064                 88  RE-AH-NET-CEDED               VALUE '2'.
  7065                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7066                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7067                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7068                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7069                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7070                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7071             20  FILLER                    PIC XXX.
  7072             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7073                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7074                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7075
  7076         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7077
  7078         16  RE-OLD-CEDING-STMT            PIC X.
  7079
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 130
* EL050.cbl
  7080         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7081         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7082         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7083         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7084         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7085         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7086         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7087         16  RE-MORT-SW                    PIC X.
  7088         16  RE-CEDING-TYPE-FLAG           PIC X.
  7089             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7090             88  RE-CEDED                          VALUE 'C'.
  7091             88  RE-ASSUMED                        VALUE 'A'.
  7092             88  RE-PHANTOM                        VALUE 'P'.
  7093
  7094         16  RE-CEDING-STMT-OPT-A          PIC X.
  7095             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7096         16  RE-CEDING-STMT-OPT-B          PIC X.
  7097             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7098         16  RE-CEDING-STMT-OPT-C          PIC X.
  7099             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7100         16  RE-CEDING-STMT-OPT-D          PIC X.
  7101             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7102         16  RE-CEDING-STMT-OPT-E          PIC X.
  7103             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7104
  7105         16  RE-PRT-CRSV                   PIC X.
  7106
  7107         16  RE-GL-CENTER                  PIC X(4).
  7108
  7109         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7110
  7111         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7112
  7113         16  RE-EARN-STOP-CODE             PIC X.
  7114             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7115             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7116
  7117         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7118             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7119
  7120         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7121         16  FILLER                        PIC X(2281).
  7122
  7123         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7124
  7125******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 131
* EL050.cbl
  7127*    COPY ERCCTBL.
  7128******************************************************************
  7129*                                                                *
  7130*                                                                *
  7131*                            ERCCTBL                             *
  7132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7133*                            VMOD=2.003
  7134*                                                                *
  7135*   ONLINE CREDIT SYSTEM                                         *
  7136*                                                                *
  7137*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7138*                                                                *
  7139*   FILE TYPE = VSAM,KSDS                                        *
  7140*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7141*                                                                *
  7142*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7143*       ALTERNATE PATH = NONE                                    *
  7144*                                                                *
  7145*   LOG = NO                                                     *
  7146*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7147*                                                                *
  7148*                                                                *
  7149******************************************************************
  7150
  7151 01  COMM-TABLE-RECORD.
  7152     12  CT-RECORD-ID                      PIC XX.
  7153         88  VALID-CT-ID                      VALUE 'CT'.
  7154
  7155     12  CT-CONTROL-PRIMARY.
  7156         16  CT-COMPANY-CD                 PIC X.
  7157         16  CT-TABLE                      PIC XXX.
  7158         16  CT-CNTRL-2.
  7159             20  CT-BEN-TYPE               PIC X.
  7160             20  CT-BEN-CODE               PIC XX.
  7161
  7162     12  CT-MAINT-INFORMATION.
  7163         16  CT-LAST-MAINT-DT              PIC XX.
  7164         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7165         16  CT-LAST-MAINT-USER            PIC X(4).
  7166         16  FILLER                        PIC X(31).
  7167
  7168     12  CT-LIMITS.
  7169         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7170
  7171         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7172
  7173         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7174
  7175     12  CT-RATES.
  7176         16  CT-RTX          OCCURS 27 TIMES.
  7177             20  CT-RT                     PIC SV9(5)     COMP-3.
  7178             20  CT-RT-R   REDEFINES
  7179                 CT-RT                     PIC XXX.
  7180
  7181     12  FILLER                            PIC  X(42).
  7182
  7183******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 132
* EL050.cbl
  7185*    COPY ERCFORM.
  7186******************************************************************
  7187*                                                                *
  7188*                                                                *
  7189*                            ERCFORM.                            *
  7190*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7191*                            VMOD=2.003                          *
  7192*                                                                *
  7193*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7194*                                                                *
  7195*    FILE TYPE = VSAM,KSDS                                       *
  7196*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7197*                                                                *
  7198*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7199*                                                                *
  7200*    LOG = YES                                                   *
  7201*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7202******************************************************************
  7203 01  FORM-MASTER.
  7204    12  FO-RECORD-ID                 PIC X(02).
  7205        88  VALID-FO-ID                  VALUE 'FO'.
  7206
  7207    12  FO-CONTROL-PRIMARY.
  7208        16  FO-COMPANY-CD            PIC X(01).
  7209        16  FO-STATE                 PIC X(02).
  7210        16  FO-FORM-ID               PIC X(12).
  7211        16  FO-FORM-EXP-DT           PIC X(02).
  7212
  7213    12  FO-POLICY-FORM-DATA.
  7214        16  FO-IND-GRP-CD            PIC X(01).
  7215        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7216        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7217        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7218        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7219        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7220        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7221        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7222        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7223        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7224        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7225        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7226        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7227        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7228        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7229        16  FO-APP-CERT-USE-CD       PIC X(01).
  7230
  7231    12  FILLER                       PIC X(29).
  7232
  7233    12  FO-FORM-PLAN-TABLE.
  7234        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7235            20  FO-PLAN-TYPE         PIC X(01).
  7236            20  FO-PLAN-ID           PIC X(02).
  7237            20  FO-PLAN-TERM         PIC 9(03).
  7238            20  FO-PLAN-REFUND-METHOD
  7239                                     PIC X.
  7240
  7241    12  FILLER                       PIC X(30).
  7242
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 133
* EL050.cbl
  7243    12  FO-COMMENTS-AREA.
  7244        16  FO-COMMENT-LINE-1        PIC X(78).
  7245
  7246    12  FILLER                       PIC X(20).
  7247
  7248    12  FO-MAINT-INFORMATION.
  7249        16  FO-LAST-MAINT-DT         PIC X(02).
  7250        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7251        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 134
* EL050.cbl
  7253*    COPY ELCMSTR.
  7254******************************************************************
  7255*                                                                *
  7256*                            ELCMSTR.                            *
  7257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7258*                            VMOD=2.012                          *
  7259*                                                                *
  7260*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7261*                                                                *
  7262*   FILE TYPE = VSAM,KSDS                                        *
  7263*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7264*                                                                *
  7265*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7266*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7267*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7268*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7269*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7270*                                                 RKP=75,LEN=21  *
  7271*                                                                *
  7272*   **** NOTE ****                                               *
  7273*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7274*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7275*                                                                *
  7276*   LOG = YES                                                    *
  7277*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7278******************************************************************
  7279*                   C H A N G E   L O G
  7280*
  7281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7282*-----------------------------------------------------------------
  7283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7284* EFFECTIVE    NUMBER
  7285*-----------------------------------------------------------------
  7286* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7287* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7288* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7289******************************************************************
  7290 01  CLAIM-MASTER.
  7291     12  CL-RECORD-ID                PIC XX.
  7292         88  VALID-CL-ID         VALUE 'CL'.
  7293
  7294     12  CL-CONTROL-PRIMARY.
  7295         16  CL-COMPANY-CD           PIC X.
  7296         16  CL-CARRIER              PIC X.
  7297         16  CL-CLAIM-NO             PIC X(7).
  7298         16  CL-CERT-NO.
  7299             20  CL-CERT-PRIME       PIC X(10).
  7300             20  CL-CERT-SFX         PIC X.
  7301
  7302     12  CL-CONTROL-BY-NAME.
  7303         16  CL-COMPANY-CD-A1        PIC X.
  7304         16  CL-INSURED-LAST-NAME    PIC X(15).
  7305         16  CL-INSURED-NAME.
  7306             20  CL-INSURED-1ST-NAME PIC X(12).
  7307             20  CL-INSURED-MID-INIT PIC X.
  7308
  7309     12  CL-CONTROL-BY-SSN.
  7310         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 135
* EL050.cbl
  7311         16  CL-SOC-SEC-NO.
  7312             20  CL-SSN-STATE        PIC XX.
  7313             20  CL-SSN-ACCOUNT      PIC X(6).
  7314             20  CL-SSN-LN3          PIC X(3).
  7315
  7316     12  CL-CONTROL-BY-CERT-NO.
  7317         16  CL-COMPANY-CD-A4        PIC X.
  7318         16  CL-CERT-NO-A4.
  7319             20  CL-CERT-A4-PRIME    PIC X(10).
  7320             20  CL-CERT-A4-SFX      PIC X.
  7321
  7322     12  CL-CONTROL-BY-CCN.
  7323         16  CL-COMPANY-CD-A5        PIC X.
  7324         16  CL-CCN-A5.
  7325             20  CL-CCN.
  7326                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7327                 24  CL-CCN-PRIME-A5 PIC X(12).
  7328             20  CL-CCN-FILLER-A5    PIC X(4).
  7329
  7330     12  CL-INSURED-PROFILE-DATA.
  7331         16  CL-INSURED-BIRTH-DT     PIC XX.
  7332         16  CL-INSURED-SEX-CD       PIC X.
  7333             88  INSURED-IS-MALE        VALUE 'M'.
  7334             88  INSURED-IS-FEMALE      VALUE 'F'.
  7335             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7336         16  CL-INSURED-OCC-CD       PIC X(6).
  7337         16  FILLER                  PIC X(5).
  7338
  7339     12  CL-PROCESSING-INFO.
  7340         16  CL-PROCESSOR-ID         PIC X(4).
  7341         16  CL-CLAIM-STATUS         PIC X.
  7342             88  CLAIM-IS-OPEN          VALUE 'O'.
  7343             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7344         16  CL-CLAIM-TYPE           PIC X.
  7345*            88  AH-CLAIM               VALUE 'A'.
  7346*            88  LIFE-CLAIM             VALUE 'L'.
  7347*            88  PROPERTY-CLAIM         VALUE 'P'.
  7348*            88  IUI-CLAIM              VALUE 'I'.
  7349*            88  GAP-CLAIM              VALUE 'G'.
  7350         16  CL-CLAIM-PREM-TYPE      PIC X.
  7351             88  SINGLE-PREMIUM         VALUE '1'.
  7352             88  O-B-COVERAGE           VALUE '2'.
  7353             88  OPEN-END-COVERAGE      VALUE '3'.
  7354         16  CL-INCURRED-DT          PIC XX.
  7355         16  CL-REPORTED-DT          PIC XX.
  7356         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7357         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7358         16  CL-LAST-PMT-DT          PIC XX.
  7359         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7360         16  CL-PAID-THRU-DT         PIC XX.
  7361         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7362         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7363         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7364         16  CL-PMT-CALC-METHOD      PIC X.
  7365             88  CL-360-DAY-YR          VALUE '1'.
  7366             88  CL-365-DAY-YR          VALUE '2'.
  7367             88  CL-FULL-MONTHS         VALUE '3'.
  7368         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 136
* EL050.cbl
  7369
  7370         16  CL-PRIME-CERT-NO.
  7371             20  CL-PRIME-CERT-PRIME PIC X(10).
  7372             20  CL-PRIME-CERT-SFX   PIC X.
  7373
  7374         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7375             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7376             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7377
  7378         16  CL-MICROFILM-NO         PIC X(10).
  7379         16  CL-PROG-FORM-TYPE       PIC X.
  7380         16  CL-LAST-ADD-ON-DT       PIC XX.
  7381
  7382         16  CL-LAST-REOPEN-DT       PIC XX.
  7383         16  CL-LAST-CLOSE-DT        PIC XX.
  7384         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7385             88  FINAL-PAID             VALUE '1'.
  7386             88  CLAIM-DENIED           VALUE '2'.
  7387             88  AUTO-CLOSE             VALUE '3'.
  7388             88  MANUAL-CLOSE           VALUE '4'.
  7389             88  BENEFITS-CHANGED       VALUE 'C'.
  7390             88  SETUP-ERRORS           VALUE 'E'.
  7391         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7392         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7393         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7394             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7395         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7396         16  FILLER                  PIC X.
  7397
  7398     12  CL-CERTIFICATE-DATA.
  7399         16  CL-CERT-ORIGIN          PIC X.
  7400             88  CERT-WAS-ONLINE        VALUE '1'.
  7401             88  CERT-WAS-CREATED       VALUE '2'.
  7402             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7403         16  CL-CERT-KEY-DATA.
  7404             20  CL-CERT-CARRIER     PIC X.
  7405             20  CL-CERT-GROUPING    PIC X(6).
  7406             20  CL-CERT-STATE       PIC XX.
  7407             20  CL-CERT-ACCOUNT.
  7408                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7409                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7410             20  CL-CERT-EFF-DT      PIC XX.
  7411
  7412     12  CL-STATUS-CONTROLS.
  7413         16  CL-PRIORITY-CD          PIC X.
  7414             88  CONFIDENTIAL-DATA      VALUE '8'.
  7415             88  HIGHEST-PRIORITY       VALUE '9'.
  7416         16  CL-SUPV-ATTN-CD         PIC X.
  7417             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7418             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7419         16  CL-PURGED-DT            PIC XX.
  7420         16  CL-RESTORED-DT          PIC XX.
  7421         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7422         16  CL-NEXT-RESEND-DT       PIC XX.
  7423         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7424         16  CL-CRITICAL-PERIOD      PIC 99.
  7425*        16  FILLER                  PIC XX.
  7426         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 137
* EL050.cbl
  7427         16  CL-LAST-MAINT-USER      PIC X(4).
  7428         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7429         16  CL-LAST-MAINT-TYPE      PIC X.
  7430             88  CLAIM-SET-UP           VALUE ' '.
  7431             88  PAYMENT-MADE           VALUE '1'.
  7432             88  LETTER-SENT            VALUE '2'.
  7433             88  MASTER-WAS-ALTERED     VALUE '3'.
  7434             88  MASTER-WAS-RESTORED    VALUE '4'.
  7435             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7436             88  FILE-CONVERTED         VALUE '6'.
  7437             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7438             88  ERROR-CORRECTION       VALUE 'E'.
  7439         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7440         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7441         16  CL-BENEFICIARY          PIC X(10).
  7442         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7443         16  CL-DENIAL-TYPE          PIC X.
  7444             88  CL-TYPE-DENIAL          VALUE '1'.
  7445             88  CL-TYPE-RESCISSION      VALUE '2'.
  7446             88  CL-TYPE-REFORMATION     VALUE '3'.
  7447             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7448             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7449         16  CL-CRIT-PER-RECURRENT   PIC X.
  7450         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7451         16  CL-RTW-DT               PIC XX.
  7452
  7453     12  CL-TRAILER-CONTROLS.
  7454         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7455             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7456             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7457             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7458         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7459         16  FILLER                  PIC XX.
  7460         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7461         16  CL-ADDRESS-TRAILER-CNT.
  7462             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7463                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7464             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7465                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7466             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7467                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7468             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7469                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7470             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7471                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7472             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7473                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7474             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7475                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7476
  7477     12  CL-CV-REFERENCE-NO.
  7478         16  CL-CV-REFNO-PRIME       PIC X(18).
  7479         16  CL-CV-REFNO-SFX         PIC XX.
  7480
  7481     12  CL-FILE-LOCATION            PIC X(4).
  7482
  7483     12  CL-PROCESS-ERRORS.
  7484         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 138
* EL050.cbl
  7485             88  NO-FATAL-ERRORS        VALUE ZERO.
  7486         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7487             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7488
  7489     12  CL-PRODUCT-CD               PIC X.
  7490
  7491     12  CL-CURRENT-KEY-DATA.
  7492         16  CL-CURRENT-CARRIER      PIC X.
  7493         16  CL-CURRENT-GROUPING     PIC X(6).
  7494         16  CL-CURRENT-STATE        PIC XX.
  7495         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7496
  7497     12  CL-ASSOCIATES               PIC X.
  7498         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7499         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7500         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7501         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7502
  7503     12  CL-ACTIVITY-CODE            PIC 99.
  7504     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7505     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7506
  7507     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7508     12  CL-LAG-REPORT-CODE          PIC 9.
  7509     12  CL-LOAN-TYPE                PIC XX.
  7510     12  CL-LEGAL-STATE              PIC XX.
  7511
  7512     12  CL-YESNOSW                  PIC X.
  7513     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7514         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7515         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7516         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7517     12  cl-insured-claim            pic x.
  7518         88  cl-claim-on-primary         value 'P'.
  7519         88  cl-claim-on-secondary       value 'S'.
  7520     12  cl-benefit-expiration-dt    PIC XX.
  7521
  7522 01  PLAN-RECORDS.
  7523     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7524     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7525
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 139
* EL050.cbl
  7527 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7528                          ACCOUNT-MASTER REINSURANCE-RECORD
  7529                          COMM-TABLE-RECORD FORM-MASTER
  7530                          CLAIM-MASTER PLAN-RECORDS.
  7531 0000-DFHEXIT SECTION.
  7532     MOVE '9#                    $   ' TO DFHEIV0.
  7533     MOVE 'EL050' TO DFHEIV1.
  7534     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7535
  7536     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7537
  7538
  7539* EXEC CICS  HANDLE CONDITION
  7540*           ERROR    (9300-ABEND)
  7541*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7542*    END-EXEC.
  7543*    MOVE '"$.J                  ! " #00007534' TO DFHEIV0
  7544     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7545     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7546     MOVE X'2220233030303037353334' TO DFHEIV0(25:11)
  7547     CALL 'kxdfhei1' USING DFHEIV0
  7548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7549
  7550
  7551 0000-COPY-PROCEDURE-DIV.
  7552*                          COPY ELC50PD.
  7553******************************************************************
  7554*                                                                *
  7555*                            ELC50PD                             *
  7556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7557*                            VMOD=2.188                          *
  7558*                                                                *
  7559******************************************************************
  7560*                   C H A N G E   L O G
  7561*
  7562* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7563*-----------------------------------------------------------------
  7564*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7565* EFFECTIVE    NUMBER
  7566*-----------------------------------------------------------------
  7567* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7568* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7569* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7570*                             2709 AND 2718
  7571* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7572* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7573* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7574* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7575* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7576*                                IS OPEN OR CNC DT < PD THRU
  7577* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7578* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7579* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7580* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7581* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7582* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7583* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7584* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 140
* EL050.cbl
  7585* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7586* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7587* 020906                   PEMA  EXPAND LOAN OFFICER
  7588* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7589* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7590* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7591* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7592* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7593* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7594* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7595* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7596* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7597* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7598* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7599* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7600* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7601* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7602* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7603* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7604* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7605* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7606* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7607* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7608* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7609* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7610* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7611* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7612* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7613*                                UPDATE VIN ON CERT TRAILER
  7614* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7615* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7616* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7617* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7618* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7619* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7620* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7621* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7622* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7623* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7624* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7625* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7626* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7627* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7628* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7629* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7630* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7631* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7632* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7633* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7634* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7635* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7636* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7637* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7638* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7639* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7640* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7641* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7642* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 141
* EL050.cbl
  7643* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7644* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7645* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7646* 032912  CR2011110200001  PEMA  AHL CHANGES
  7647* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7648* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7649* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7650* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7651* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7652* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7653* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7654* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7655* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7656* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7657* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7658* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7659* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7660* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7661* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7662* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7663* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7664* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7665******************************************************************
  7666************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7667******************************************************************
  7668
  7669     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7670
  7671     MOVE SPACES                 TO PB-FATAL-FLAG
  7672                                    PB-FORCE-ER-CD
  7673                                    PB-WARN-ER-CD
  7674                                    PB-OUT-BAL-CD.
  7675
  7676     MOVE SPACE                  TO WS-IG-OVRD-AH
  7677                                    WS-IG-OVRD-LF
  7678                                    WS-IG-OVRD-AM
  7679                                    WS-IG-OVRD
  7680                                    WS-IG-OVRD-AH-PL
  7681                                    WS-IG-OVRD-LF-PL
  7682                                    WS-IG-OVRD-AH-BEN
  7683                                    WS-IG-OVRD-LF-BEN.
  7684
  7685******************************************************************
  7686*************       INITIALIZE COMMON ERRORS       ***************
  7687******************************************************************
  7688
  7689     MOVE +0                     TO PB-NO-OF-ERRORS.
  7690     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7691
  7692******************************************************************
  7693
  7694     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7695     SET JULIAN-TO-BIN           TO TRUE.
  7696*    MOVE 5                      TO DC-OPTION-CODE.
  7697     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7698     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7699
  7700     MOVE ZERO                   TO  SUB4.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 142
* EL050.cbl
  7701
  7702 0040-INITIALIZE-GA-BILL-DT.
  7703
  7704     ADD +1                      TO  SUB4.
  7705
  7706     IF  SUB4 GREATER THAN +5
  7707         GO TO 0050-CHECK-CNTL-FOUND.
  7708
  7709     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7710         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7711
  7712     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7713
  7714 0050-CHECK-CNTL-FOUND.
  7715
  7716     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7717        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7718                                         WS-AH-REM-TERM-CALC
  7719                                         EC-CO-REM-TERM-CALC
  7720        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7721        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7722        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7723                                         WS-TOL-AH-CLAIM
  7724        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7725                                         WS-TOL-AH-PREM
  7726                                         EC-CO-TOL-PREM
  7727        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7728                                         WS-TOL-AH-REFUND
  7729                                         EC-CO-TOL-REFUND
  7730        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7731                                         WS-AH-REFUND-OVS-AMT
  7732                                         EC-CO-OVR-SHT-AMT
  7733        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7734                                         WS-TOL-AH-PREM-PCT
  7735                                         EC-CO-TOL-PREM-PCT
  7736        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7737                                         WS-TOL-AH-REFUND-PCT
  7738                                         EC-CO-TOL-REFUND-PCT
  7739        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7740                                         WS-AH-REFUND-OVS-PCT
  7741                                         EC-CO-OVR-SHT-PCT
  7742        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7743        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7744        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7745        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7746        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7747        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7748        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7749        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7750        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7751        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7752        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7753        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7754                                         EC-CO-MONTH-END-DT
  7755        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7756          GO TO 0100-READ-ACCT.
  7757
  7758     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 143
* EL050.cbl
  7759     MOVE SPACES                 TO CNTL-ACCESS.
  7760     MOVE '1'                    TO CNTL-REC-TYPE.
  7761     MOVE +0                     TO CNTL-SEQ-NO.
  7762
  7763     MOVE '1' TO RC-SW-1.
  7764     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7765     IF NOT CF-COMPANY-MASTER
  7766         MOVE ZEROS             TO WK-CO-TOL-PREM
  7767                                   WK-CO-TOL-CLAIM
  7768                                   WK-CO-TOL-REFUND
  7769                                   WK-REFUND-OVS-AMT
  7770                                   WK-REFUND-OVS-PCT
  7771                                   WK-CO-TOL-PREM-PCT
  7772                                   WK-CO-TOL-REFUND-PCT
  7773                                   WK-DEFAULT-APR
  7774                                   WK-CO-MAX-CAP
  7775        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7776                                   WK-CR-R78-METHOD
  7777                                   WK-CO-REF-REJECT-SW
  7778                                   WK-CO-PREM-REJECT-SW
  7779                                   WK-REM-TRM-CALC-OPTION
  7780                                   WK-BIRTH-DATE-INPUT
  7781                                   WK-JOINT-AGE-INPUT
  7782        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7783        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7784        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7785        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7786          GO TO 0099-COMPANY-NOT-FOUND.
  7787
  7788     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7789        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7790     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7791        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7792     IF CF-CO-TOL-CAP NOT NUMERIC
  7793        MOVE +0                    TO CF-CO-TOL-CAP.
  7794     IF CF-DEFAULT-APR NOT NUMERIC
  7795        MOVE +0                    TO CF-DEFAULT-APR.
  7796
  7797     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7798     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7799     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7800     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7801     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7802     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7803     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7804     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7805     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7806     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7807     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7808     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7809
  7810     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7811          CF-CO-OVR-SHT-AMT > +0
  7812        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7813
  7814     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7815          CF-CO-OVR-SHT-PCT > +0
  7816        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 144
* EL050.cbl
  7817
  7818     IF CF-VALID-REM-TRM-OPTION
  7819         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7820     ELSE
  7821         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7822
  7823     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7824     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7825     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7826     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7827
  7828     GO TO 0050-CHECK-CNTL-FOUND.
  7829
  7830 0099-COMPANY-NOT-FOUND.
  7831
  7832     MOVE ER-2616                TO WS-ERROR.
  7833     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7834
  7835 0100-READ-ACCT.
  7836
  7837     MOVE SPACES                 TO DATE-RANGE-SW.
  7838
  7839     IF WK-ACCT-ADDR = ZEROS
  7840        GO TO 0102-ACCT-GETMAIN.
  7841
  7842     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7843     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7844     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7845
  7846     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7847        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7848        GO TO 0105-READ-ACCT
  7849     END-IF
  7850
  7851     IF PB-CARRIER NOT = SPACES
  7852        IF PB-CARRIER NOT = AM-VG-CARRIER
  7853           GO TO 0105-READ-ACCT.
  7854
  7855     IF PB-STATE NOT = SPACES
  7856        IF PB-STATE NOT = AM-VG-STATE
  7857           GO TO 0105-READ-ACCT.
  7858
  7859     IF PB-GROUPING NOT = SPACES
  7860        IF PB-GROUPING NOT = AM-VG-GROUPING
  7861           GO TO 0105-READ-ACCT.
  7862
  7863     MOVE 'X'                 TO DATE-RANGE-SW.
  7864
  7865     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7866        MOVE 'X'                 TO DATE-RANGE-SW
  7867        GO TO 0105-READ-ACCT.
  7868
  7869     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7870        GO TO 0105-READ-ACCT.
  7871
  7872     GO TO 0180-ACCOUNT-FOUND.
  7873
  7874 0102-ACCT-GETMAIN.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 145
* EL050.cbl
  7875     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7876     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7877
  7878 0105-READ-ACCT.
  7879     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7880     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7881     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7882     MOVE PB-STATE               TO ACCT-STATE.
  7883     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7884     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7885
  7886     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7887
  7888     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7889
  7890 0110-FIND-ACCT-TOLERANCES-LOOP.
  7891     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7892
  7893     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7894        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7895        GO TO 0199-ACCT-NOT-FOUND
  7896     END-IF
  7897     IF PB-CARRIER NOT = SPACES
  7898        IF PB-CARRIER NOT = AM-VG-CARRIER
  7899           GO TO 0199-ACCT-NOT-FOUND.
  7900
  7901     IF PB-STATE NOT = SPACES
  7902        IF PB-STATE NOT = AM-VG-STATE
  7903           GO TO 0199-ACCT-NOT-FOUND.
  7904
  7905     IF PB-GROUPING NOT = SPACES
  7906        IF PB-GROUPING NOT = AM-VG-GROUPING
  7907           GO TO 0199-ACCT-NOT-FOUND.
  7908
  7909     MOVE 'X'                    TO DATE-RANGE-SW.
  7910
  7911     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7912        MOVE 'X'                 TO DATE-RANGE-SW
  7913        GO TO 0199-ACCT-NOT-FOUND.
  7914
  7915     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7916        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7917
  7918 0180-ACCOUNT-FOUND.
  7919     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7920     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7921     MOVE AM-STATE               TO PB-SV-STATE.
  7922     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7923
  7924     IF AM-CANCEL-FEE  NOT NUMERIC
  7925        MOVE ZEROS TO AM-CANCEL-FEE.
  7926
  7927     IF AM-MAX-MON-BEN NOT NUMERIC
  7928        MOVE ZEROS TO AM-MAX-MON-BEN.
  7929
  7930     IF AM-MAX-TOT-BEN NOT NUMERIC
  7931        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7932
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 146
* EL050.cbl
  7933     IF AM-CLP-TOL-PCT NOT NUMERIC
  7934        MOVE +0                  TO AM-CLP-TOL-PCT
  7935     END-IF
  7936     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7937        MOVE +0                  TO AM-SPP-LEASE-COMM
  7938     END-IF
  7939     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7940        MOVE ER-2611             TO   WS-ERROR
  7941        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7942
  7943     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7944        MOVE ER-2621             TO   WS-ERROR
  7945        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7946
  7947     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7948        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7949        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7950        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7951         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7952
  7953     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7954     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7955     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7956     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7957     IF AM-CLP-TOL-PCT NOT = ZEROS
  7958        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7959     END-IF
  7960     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7961        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7962     END-IF
  7963*    IF PB-COMPANY-ID = 'DCC'
  7964*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7965*                                   WS-ADMIN-FEES
  7966*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7967*          (SUB5 > +10)
  7968*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7969*             AND (AM-A-COM (SUB5) NUMERIC)
  7970*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7971*                + (AM-A-COM (SUB5) * 1000)
  7972*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7973*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7974*                + (AM-A-COM (SUB5) * 1000)
  7975*             END-IF
  7976*             IF AM-COM-TYP (SUB5) = 'N'
  7977*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7978*                + (AM-A-COM (SUB5) * 1000)
  7979*             END-IF
  7980*          END-IF
  7981*       END-PERFORM
  7982*    END-IF
  7983     IF (PB-COMPANY-ID = 'DCC')
  7984        AND (PB-ISSUE)
  7985        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7986        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7987           (SUB5 > +10)
  7988           MOVE +0 TO WS-WK-RATE
  7989           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7990              IF (AM-A-COM (SUB5) NUMERIC)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 147
* EL050.cbl
  7991                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7992                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7993              ELSE
  7994                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7995                 IF PB-ISSUE
  7996                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7997                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7998                 ELSE
  7999                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8000                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8001                 END-IF
  8002                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8003                 MOVE ZEROS             TO WS-SUB1
  8004                                           WS-COMMISSION
  8005                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8006                 MOVE '0530'               TO CTBL-SW
  8007                 MOVE ' '                  TO WS-CTBL-READ-SW
  8008                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8009                 IF FIRST-TIME-THROUGH
  8010                    MOVE 'AA'              TO CTBL-BEN-CODE
  8011                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8012                 END-IF
  8013                 IF CTBL-TABLE-FOUND
  8014                    IF PB-ISSUE
  8015                       COMPUTE WS-COMM-CK-AMT =
  8016                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8017                    ELSE
  8018                       COMPUTE WS-COMM-CK-AMT =
  8019                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8020                    END-IF
  8021                    PERFORM 8800-GET-COMP-RATE
  8022                              THRU 8800-EXIT
  8023                 END-IF
  8024              END-IF
  8025              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8026                + (WS-WK-RATE * 1000)
  8027           END-IF
  8028        END-PERFORM
  8029     END-IF
  8030     IF PB-COMPANY-ID EQUAL 'CRI'
  8031         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8032
  8033     IF PB-COMPANY-ID EQUAL 'NCL'
  8034         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8035     END-IF
  8036
  8037     GO TO 0200-READ-CERT.
  8038
  8039 0199-ACCT-NOT-FOUND.
  8040
  8041     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8042
  8043     IF DATE-RANGE-SW NOT = SPACES
  8044        MOVE ER-2601             TO WS-ERROR
  8045        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8046     ELSE
  8047        MOVE ER-2619             TO WS-ERROR
  8048        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 148
* EL050.cbl
  8049
  8050     GO TO 9990-RETURN.
  8051
  8052 0200-READ-CERT.
  8053
  8054     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8055     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8056     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8057     MOVE PB-SV-STATE            TO CERT-STATE.
  8058     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8059     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8060     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8061
  8062     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8063
  8064     IF CERT-WAS-NOT-FOUND
  8065        GO TO 0299-CERT-NOT-FOUND.
  8066
  8067     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8068        MOVE ER-2759             TO WS-ERROR
  8069        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8070        GO TO 0298-UNLOCK-RETURN.
  8071
  8072     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8073         MOVE ER-2758            TO WS-ERROR
  8074         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8075         GO TO 0298-UNLOCK-RETURN.
  8076
  8077     IF PB-ISSUE
  8078        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8079           IF CERT-WAS-CREATED-FOR-CLAIM
  8080              NEXT SENTENCE
  8081            ELSE
  8082              MOVE ER-2626       TO WS-ERROR
  8083              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8084              GO TO 0298-UNLOCK-RETURN.
  8085
  8086     IF NOT PB-CANCELLATION
  8087        GO TO 0300-CONTINUE-EDIT.
  8088
  8089     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8090     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8091     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8092     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8093     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8094     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8095
  8096     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8097     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8098     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8099     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8100     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8101     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8102     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8103     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8104     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8105
  8106     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 149
* EL050.cbl
  8107     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8108     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8109     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8110     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8111     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8112     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8113
  8114     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8115     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8116
  8117     MOVE CM-CREDIT-INTERFACE-SW-1
  8118                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8119     MOVE CM-CREDIT-INTERFACE-SW-2
  8120                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8121
  8122     IF CM-O-B-COVERAGE
  8123         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8124
  8125     IF CM-LIVES NOT NUMERIC
  8126         MOVE ZERO                TO CM-LIVES.
  8127
  8128     IF CM-BILLED NOT NUMERIC
  8129         MOVE ZERO                TO CM-BILLED.
  8130
  8131     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8132         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8133         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8134         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8135         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8136         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8137         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8138         MOVE CM-LIVES             TO PB-CI-LIVES
  8139*The next line causes a problem with my change  I dont think it is
  8140*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8141
  8142     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8143     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8144     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8145     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8146     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8147     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8148
  8149     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8150     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8151     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8152     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8153
  8154     IF CM-LIFE-COMM-PCT NUMERIC
  8155         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8156     ELSE
  8157         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8158
  8159     IF CM-AH-COMM-PCT NUMERIC
  8160         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8161     ELSE
  8162         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8163
  8164     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 150
* EL050.cbl
  8165
  8166     IF CM-LOAN-APR       NOT NUMERIC
  8167           MOVE ZERO               TO CM-LOAN-APR.
  8168
  8169     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8170           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8171
  8172     IF CM-LOAN-TERM      NOT NUMERIC
  8173           MOVE ZERO               TO CM-LOAN-TERM.
  8174
  8175     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8176           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8177
  8178     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8179           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8180
  8181     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8182     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8183     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8184     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8185     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8186     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8187     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8188     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8189     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8190     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8191     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8192     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8193
  8194     IF CM-STATE = CM-SSN-STATE
  8195         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8196
  8197     IF CM-STATE NOT = CM-MEMB-STATE
  8198         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8199
  8200     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8201
  8202     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8203        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8204        IF CM-ADDL-CLP NOT NUMERIC
  8205           MOVE +0               TO CM-ADDL-CLP
  8206        END-IF
  8207        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8208        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8209           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8210        END-IF
  8211     END-IF
  8212     IF PB-COMPANY-ID = 'DCC'
  8213        MOVE +0                  TO WS-ADMIN-FEES
  8214                                    WS-CSO-ADMIN-FEE
  8215                                    WS-COMM-AND-MFEE
  8216                                    WS-1ST-YR-ALLOW
  8217        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8218           (SUB5 > +10)
  8219           MOVE +0 TO WS-WK-RATE
  8220           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8221              IF (AM-A-COM (SUB5) NUMERIC)
  8222                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 151
* EL050.cbl
  8223                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8224              ELSE
  8225                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8226                 IF PB-ISSUE
  8227                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8228                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8229                 ELSE
  8230                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8231                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8232                 END-IF
  8233                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8234                 MOVE ZEROS             TO WS-SUB1
  8235                                           WS-COMMISSION
  8236                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8237                 MOVE '0530'               TO CTBL-SW
  8238                 MOVE ' '                  TO WS-CTBL-READ-SW
  8239                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8240                 IF FIRST-TIME-THROUGH
  8241                    MOVE 'AA'              TO CTBL-BEN-CODE
  8242                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8243                 END-IF
  8244                 IF CTBL-TABLE-FOUND
  8245                    IF PB-ISSUE
  8246                       COMPUTE WS-COMM-CK-AMT =
  8247                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8248                    ELSE
  8249                       COMPUTE WS-COMM-CK-AMT =
  8250                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8251                    END-IF
  8252                    PERFORM 8800-GET-COMP-RATE
  8253                              THRU 8800-EXIT
  8254                 END-IF
  8255              END-IF
  8256              IF AM-COM-TYP (SUB5) = 'I'
  8257                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8258                   + (WS-WK-RATE * 1000)
  8259              END-IF
  8260              IF AM-COM-TYP (SUB5) = 'N'
  8261                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8262                   + (WS-WK-RATE * 1000)
  8263              END-IF
  8264              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8265                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8266                   + (WS-WK-RATE * 1000)
  8267              END-IF
  8268              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8269                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8270                   + (WS-WK-RATE * 1000)
  8271              END-IF
  8272           END-IF
  8273        END-PERFORM
  8274     END-IF
  8275     GO TO 0300-CONTINUE-EDIT.
  8276
  8277 0298-UNLOCK-RETURN.
  8278      PERFORM 9250-UNLOCK-RETURN
  8279      GO TO 9990-RETURN.
  8280
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 152
* EL050.cbl
  8281 0299-CERT-NOT-FOUND.
  8282
  8283     MOVE '1'                     TO CERT-STATUS-SW.
  8284
  8285     IF PB-COMPANY-ID = 'UCL'
  8286         IF WS-ERROR = ER-2799
  8287             GO TO 3000-CONTINUE-EDIT.
  8288
  8289     IF NOT PB-CANCELLATION
  8290         GO TO 0300-CONTINUE-EDIT.
  8291
  8292     MOVE ER-2726                  TO  WS-ERROR.
  8293     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8294     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8295     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8296                                    PB-CI-LF-TERM
  8297                                    PB-C-LF-REM-TERM
  8298                                    PB-CI-AH-TERM
  8299                                    PB-C-AH-REM-TERM
  8300                                    PB-CI-LF-BENEFIT-CD
  8301                                    PB-CI-LF-BENEFIT-AMT
  8302                                    PB-CI-LF-ALT-BENEFIT-AMT
  8303                                    PB-CI-LF-PREMIUM-AMT
  8304                                    PB-CI-LF-ALT-PREMIUM-AMT
  8305                                    PB-CI-AH-BENEFIT-CD
  8306                                    PB-CI-AH-BENEFIT-AMT
  8307                                    PB-CI-AH-PREMIUM-AMT
  8308                                    PB-CI-PAY-FREQUENCY
  8309                                    PB-CI-LOAN-APR
  8310                                    PB-CI-LOAN-TERM
  8311                                    PB-CI-LIFE-COMMISSION
  8312                                    PB-CI-AH-COMMISSION
  8313                                    PB-CI-CURR-SEQ
  8314                                    PB-CI-AH-CANCEL-AMT
  8315                                    PB-CI-LF-CANCEL-AMT
  8316                                    PB-CI-RATE-DEV-PCT-LF
  8317                                    PB-CI-RATE-DEV-PCT-AH
  8318                                    PB-CI-EXTENTION-DAYS
  8319                                    PB-CI-TERM-IN-DAYS
  8320                                    PB-CI-LIVES
  8321                                    PB-CI-LF-CRIT-PER
  8322                                    PB-CI-AH-CRIT-PER
  8323                                    PB-CI-ADDL-CLP
  8324                                    PB-CI-DDF-IU-RATE-UP.
  8325
  8326     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8327                                    PB-CI-AH-SETTLEMENT-DT
  8328                                    PB-CI-DEATH-DT
  8329                                    PB-CI-LF-PRIOR-CANCEL-DT
  8330                                    PB-CI-AH-PRIOR-CANCEL-DT
  8331                                    PB-CI-ENTRY-DT
  8332                                    PB-CI-LF-EXPIRE-DT
  8333                                    PB-CI-AH-EXPIRE-DT
  8334                                    PB-CI-LOAN-1ST-PMT-DT.
  8335
  8336     IF ACCOUNT-MAST-FOUND
  8337        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8338        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 153
* EL050.cbl
  8339
  8340     GO TO 3000-CONTINUE-EDIT.
  8341
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 154
* EL050.cbl
  8343
  8344 0300-CONTINUE-EDIT.
  8345
  8346     IF PB-ISSUE
  8347        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8348            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8349
  8350     IF PB-ISSUE
  8351        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8352            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8353
  8354     IF PB-ISSUE
  8355       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8356          (AM-NO-AH-ONLY)
  8357           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8358               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8359                   MOVE ER-2679 TO WS-ERROR
  8360                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8361
  8362     IF PB-ISSUE
  8363        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8364        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8365        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8366     ELSE
  8367        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8368        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8369        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8370
  8371     MOVE 'N'                    TO PLAN-MASTER-SW
  8372                                    PLAN-MASTER-LIFE-SW
  8373                                    FORM-MASTER-SW
  8374                                    WS-APP-CERT-SW.
  8375
  8376     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8377                                    WS-PL-TOL-LF-REFUND
  8378                                    WS-PL-REF-OVS-AMT
  8379                                    WS-PL-TOL-LF-PREM-PCT
  8380                                    WS-PL-TOL-LF-REFUND-PCT
  8381                                    WS-PL-REF-OVS-PCT
  8382                                    WS-PL-TOL-LF-CLAIM.
  8383
  8384     IF PB-COMPANY-ID = 'NCL'
  8385       IF PB-ISSUE
  8386         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8387             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8388             IF FORM-MASTER-FOUND
  8389                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8390
  8391     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8392        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8393
  8394********************** MON CODE **********************
  8395     IF PB-COMPANY-ID = 'MON'
  8396     IF PB-ISSUE
  8397     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8398        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8399             PB-I-LOAN-APR = ZERO)
  8400               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 155
* EL050.cbl
  8401******************************************************
  8402
  8403     IF PB-COMPANY-ID = 'NCL'
  8404       IF PB-ISSUE
  8405           IF FORM-MASTER-FOUND
  8406             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8407                AM-DISMBR-COVERAGE
  8408                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8409                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8410                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8411                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8412                                           PB-I-LIFE-BENEFIT-CD.
  8413
  8414     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8415
  8416     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8417         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8418         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8419         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8420         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8421         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8422           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8423             GO TO 0301-LIFE-BENEFIT-SEARCH
  8424         ELSE
  8425             NEXT SENTENCE
  8426     ELSE
  8427         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8428
  8429     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8430     MOVE '4'                    TO CNTL-REC-TYPE.
  8431     MOVE +0                     TO CNTL-SEQ-NO.
  8432     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8433
  8434     MOVE '1' TO RC-SW-2.
  8435     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8436
  8437     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8438        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8439         GO TO 0305-BENEFIT-NOT-FOUND.
  8440
  8441     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8442
  8443 0301-LIFE-BENEFIT-SEARCH.
  8444
  8445     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8446
  8447     IF NO-BENEFIT-FOUND
  8448        GO TO 0305-BENEFIT-NOT-FOUND.
  8449
  8450     IF WS-BEN-CD = '99'
  8451        GO TO 0305-BENEFIT-NOT-FOUND.
  8452
  8453     IF PB-COMPANY-ID = 'NCL'
  8454         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8455             GO TO 0304-LIFE-BENEFIT-FOUND.
  8456
  8457     MOVE +1                     TO SUB5.
  8458     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 156
* EL050.cbl
  8459
  8460* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8461* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8462     IF PB-COMPANY-ID = 'DMD'
  8463         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8464
  8465 0302-EDIT-ACCT-LF-BENEFITS.
  8466
  8467     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8468        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8469           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8470                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8471           GO TO 03XX-GET-LIFE-ERPLAN.
  8472
  8473     IF SUB5 LESS THAN +20
  8474        ADD +1                   TO SUB5
  8475        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8476
  8477     MOVE +1                     TO SUB5.
  8478
  8479     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8480        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8481
  8482 0303-EDIT-DMD-EXTRA-BENEFITS.
  8483
  8484     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8485        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8486           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8487                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8488           GO TO 03XX-GET-LIFE-ERPLAN.
  8489
  8490     IF SUB5 LESS THAN +30
  8491        ADD +1                   TO SUB5
  8492        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8493
  8494     MOVE +1                     TO SUB5.
  8495
  8496 03XX-EDIT-FOR-NINETY-LF.
  8497
  8498***************************************************************
  8499*                                                             *
  8500*    NINETY BENEFIT PLAN TYPES:                               *
  8501*                                                             *
  8502*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8503*      92 = ALL GROUP REDUCING BENEFITS                       *
  8504*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8505*      94 = ALL GROUP LEVEL BENEFITS                          *
  8506*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8507*           BENEFIT CONTROLS.                                 *
  8508*      99 = ALL BENEFITS                                      *
  8509*                                                             *
  8510***************************************************************
  8511
  8512     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8513                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8514
  8515     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8516       AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 157
* EL050.cbl
  8517        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8518        GO TO 03XX-GET-LIFE-ERPLAN.
  8519
  8520     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8521       AND
  8522        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8523        IF CF-REDUCING (SUB3)
  8524           IF (PB-I-INDV-GRP-OVRD = 'I')
  8525              OR
  8526           ((AM-IG = '1') AND
  8527           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8528              OR
  8529           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8530           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8531           (AM-IG NOT = '2'))
  8532              GO TO 03XX-GET-LIFE-ERPLAN.
  8533
  8534     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8535       AND
  8536        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8537        IF CF-REDUCING (SUB3)
  8538           IF (PB-I-INDV-GRP-OVRD = 'G')
  8539              OR
  8540           ((AM-IG = '2') AND
  8541           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8542              OR
  8543           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8544           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8545           (AM-IG NOT = '1'))
  8546              GO TO 03XX-GET-LIFE-ERPLAN.
  8547
  8548     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8549       AND
  8550        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8551        IF CF-LEVEL    (SUB3)
  8552           IF (PB-I-INDV-GRP-OVRD = 'I')
  8553              OR
  8554           ((AM-IG = '1') AND
  8555           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8556              OR
  8557           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8558           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8559            (AM-IG NOT = '2'))
  8560              GO TO 03XX-GET-LIFE-ERPLAN.
  8561
  8562     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8563       AND
  8564        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8565        IF CF-LEVEL    (SUB3)
  8566           IF (PB-I-INDV-GRP-OVRD = 'G')
  8567              OR
  8568           ((AM-IG = '2') AND
  8569           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8570              OR
  8571           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8572           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8573           (AM-IG NOT = '1'))
  8574              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 158
* EL050.cbl
  8575
  8576     IF SUB5 LESS THAN +20
  8577        ADD +1                   TO SUB5
  8578        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8579
  8580     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8581
  8582     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8583        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8584
  8585     MOVE +1                     TO SUB5.
  8586
  8587 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8588
  8589     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8590                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8591
  8592     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8593       AND
  8594        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8595        GO TO 03XX-GET-LIFE-ERPLAN.
  8596
  8597     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8598       AND
  8599        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8600        IF CF-REDUCING (SUB3)
  8601           IF (PB-I-INDV-GRP-OVRD = 'I')
  8602              OR
  8603           ((AM-IG = '1') AND
  8604           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8605              OR
  8606           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8607           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8608           (AM-IG NOT = '2'))
  8609              GO TO 03XX-GET-LIFE-ERPLAN.
  8610
  8611     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8612       AND
  8613        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8614        IF CF-REDUCING (SUB3)
  8615           IF (PB-I-INDV-GRP-OVRD = 'G')
  8616              OR
  8617           ((AM-IG = '2') AND
  8618           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8619              OR
  8620           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8621           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8622           (AM-IG NOT = '1'))
  8623              GO TO 03XX-GET-LIFE-ERPLAN.
  8624
  8625     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8626       AND
  8627        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8628        IF CF-LEVEL    (SUB3)
  8629           IF (PB-I-INDV-GRP-OVRD = 'I')
  8630              OR
  8631           ((AM-IG = '1') AND
  8632           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 159
* EL050.cbl
  8633              OR
  8634           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8635           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8636            (AM-IG NOT = '2'))
  8637              GO TO 03XX-GET-LIFE-ERPLAN.
  8638
  8639     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8640       AND
  8641        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8642        IF CF-LEVEL    (SUB3)
  8643           IF (PB-I-INDV-GRP-OVRD = 'G')
  8644              OR
  8645           ((AM-IG = '2') AND
  8646           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8647              OR
  8648           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8649           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8650           (AM-IG NOT = '1'))
  8651              GO TO 03XX-GET-LIFE-ERPLAN.
  8652
  8653     IF SUB5 LESS THAN +30
  8654        ADD +1                   TO SUB5
  8655        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8656
  8657     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8658
  8659 03XX-EDIT-FOR-NINETY-LF-CONT.
  8660
  8661     MOVE +99                    TO SUB5.
  8662
  8663     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8664        IF PB-ISSUE
  8665           MOVE ER-1924          TO  WS-ERROR
  8666           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8667
  8668     GO TO 0304-LIFE-BENEFIT-FOUND.
  8669
  8670 03XX-GET-LIFE-ERPLAN.
  8671
  8672     IF WK-PLAN-ADDR EQUAL +0
  8673        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8674
  8675     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8676     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8677     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8678     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8679     MOVE 'Y'                    TO PLAN-MASTER-SW
  8680                                    PLAN-MASTER-LIFE-SW.
  8681     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8682
  8683 03XX-ERPLAN-LIFE-GETMAIN.
  8684
  8685     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8686     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8687
  8688 03XX-ERPLAN-LIFE-READ.
  8689
  8690     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 160
* EL050.cbl
  8691     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8692     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8693     MOVE PB-SV-STATE            TO PLAN-STATE.
  8694     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8695     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8696     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8697     MOVE WS-SAVE-BENEFIT-REVISION
  8698                                 TO PLAN-REVISION-NO.
  8699
  8700     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8701     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8702
  8703     IF PB-COMPANY-ID = 'NCL'
  8704       IF NOT LF-PLAN-MASTER-FOUND
  8705         IF NOT PB-POLICY-IS-DECLINED  AND
  8706            NOT PB-POLICY-IS-VOIDED
  8707             MOVE  ER-1921         TO  WS-ERROR
  8708             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8709             GO TO 0304-LIFE-BENEFIT-FOUND.
  8710
  8711     IF NOT LF-PLAN-MASTER-FOUND
  8712        GO TO 0304-LIFE-BENEFIT-FOUND.
  8713
  8714 XXXX-CHECK-LF-PLAN-KEY.
  8715
  8716     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8717        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8718        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8719        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8720        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8721        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8722        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8723        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8724        MOVE 'N'                 TO PLAN-MASTER-SW
  8725          GO TO 03XX-ERPLAN-LIFE-READ.
  8726
  8727     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8728
  8729     IF  PB-CANCELLATION
  8730         GO TO  0303-LF-ACCT-BEN-FOUND.
  8731
  8732     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8733        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8734           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8735           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8736              MOVE ER-2644             TO WS-ERROR
  8737              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8738           ELSE
  8739              NEXT SENTENCE
  8740        ELSE
  8741           IF PB-COMPANY-ID NOT = 'NCL'
  8742              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8743                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8744
  8745 0303-LF-ACCT-BEN-FOUND.
  8746
  8747     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8748
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 161
* EL050.cbl
  8749     IF PL-DEV-CODE NOT = SPACES
  8750        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8751
  8752     IF PL-DEV-PCT NUMERIC AND
  8753        PL-DEV-PCT NOT = ZEROS
  8754        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8755
  8756     IF PL-TOL-PREM-AMT GREATER THAN +0
  8757        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8758
  8759     IF PL-TOL-REF-AMT GREATER THAN +0
  8760        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8761
  8762     IF PL-TOL-PREM-PCT GREATER THAN +0
  8763        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8764
  8765     IF PL-TOL-REF-PCT GREATER THAN +0
  8766        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8767
  8768     IF PL-TOL-CLM-AMT GREATER THAN +0
  8769        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8770
  8771     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8772                          PL-OVER-SHORT-AMT > +0
  8773        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8774
  8775     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8776                          PL-OVER-SHORT-PCT > +0
  8777        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8778
  8779     IF PL-SALES-TAX NUMERIC AND
  8780                          PL-SALES-TAX > +0
  8781         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8782
  8783     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8784        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8785                                    WS-IG-OVRD-AM.
  8786
  8787 0304-LIFE-BENEFIT-FOUND.
  8788
  8789     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8790
  8791     IF PB-ISSUE
  8792        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8793     ELSE
  8794        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8795
  8796     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8797     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8798     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8799     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8800     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8801                                         WS-LF-REFUND-CALC.
  8802     if (ws-lf-earnings-calc = '5')
  8803        and (pb-i-loan-apr = zeros)
  8804        and (benefit-code-chg)
  8805        move +99.9999 to pb-i-loan-apr
  8806     end-if
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 162
* EL050.cbl
  8807
  8808     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8809        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8810
  8811     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8812        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8813     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8814
  8815     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8816     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8817     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8818     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8819     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8820     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8821
  8822     IF PB-COMPANY-ID = 'NCL'  AND
  8823        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8824         NEXT SENTENCE
  8825     ELSE
  8826         IF SUB5 NOT GREATER THAN +20
  8827            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8828               MOVE WS-SAVE-BENEFIT-REM-TERM
  8829                                      TO WS-AM-LF-BENE-REM-TERM
  8830                                         EC-BR-LF-REM-TERM-CALC.
  8831
  8832     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8833     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8834
  8835     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8836
  8837 0305-BENEFIT-NOT-FOUND.
  8838
  8839     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8840     MOVE ER-2604                TO WS-ERROR.
  8841     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8842
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 163
* EL050.cbl
  8844
  8845 0310-FIND-AH-BENEFIT-RECORD.
  8846
  8847     MOVE 'N'                    TO PLAN-MASTER-SW
  8848                                    PLAN-MASTER-AH-SW.
  8849
  8850     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8851                                    WS-PL-TOL-AH-REFUND
  8852                                    WS-AH-PL-REF-OVS-AMT
  8853                                    WS-PL-TOL-AH-PREM-PCT
  8854                                    WS-PL-TOL-AH-REFUND-PCT
  8855                                    WS-AH-PL-REF-OVS-PCT
  8856                                    WS-PL-TOL-AH-CLAIM.
  8857     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8858
  8859
  8860     if pb-issue
  8861        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8862           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8863        end-if
  8864        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8865           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8866           GO TO 0399-BENEFIT-NOT-FOUND
  8867        end-if
  8868     end-if
  8869
  8870     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8871        GO TO 0400-FIND-CARRIER.
  8872
  8873     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8874
  8875     IF WK-AH-BEN-ADDR NOT = ZEROS
  8876         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8877         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8878         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8879         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8880           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8881             GO TO 0311-AH-BENEFIT-SEARCH
  8882         ELSE
  8883             NEXT SENTENCE
  8884     ELSE
  8885         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8886
  8887     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8888     MOVE '5'                    TO CNTL-REC-TYPE.
  8889     MOVE +0                     TO CNTL-SEQ-NO.
  8890     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8891
  8892     MOVE '2' TO RC-SW-2.
  8893     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8894
  8895     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8896        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8897          GO TO 0399-BENEFIT-NOT-FOUND.
  8898
  8899     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8900
  8901 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 164
* EL050.cbl
  8902
  8903     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8904
  8905     IF NO-BENEFIT-FOUND
  8906         GO TO 0399-BENEFIT-NOT-FOUND.
  8907
  8908     IF WS-BEN-CD = '99'
  8909        GO TO 0399-BENEFIT-NOT-FOUND.
  8910
  8911     IF PB-COMPANY-ID  =  'NCL'
  8912         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8913             GO TO 0314-A-H-BENEFIT-FOUND.
  8914
  8915     MOVE +1                     TO SUB5.
  8916     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8917
  8918* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8919* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8920     IF PB-COMPANY-ID = 'DMD'
  8921         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8922
  8923 0312-EDIT-ACCT-AH-BENEFITS.
  8924
  8925     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8926        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8927           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8928                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8929           GO TO 03XX-GET-AH-ERPLAN.
  8930
  8931     IF SUB5 LESS THAN +20
  8932        ADD +1                   TO SUB5
  8933        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8934
  8935     MOVE +1                     TO SUB5.
  8936
  8937     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8938        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8939
  8940 0313-EDIT-DMD-EXTRA-BENEFITS.
  8941
  8942     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8943        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8944           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8945                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8946           GO TO 03XX-GET-AH-ERPLAN.
  8947
  8948     IF SUB5 LESS THAN +30
  8949        ADD +1                   TO SUB5
  8950        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8951
  8952     MOVE +1                     TO SUB5.
  8953
  8954 03XX-EDIT-FOR-NINETY-AH.
  8955
  8956***************************************************************
  8957*                                                             *
  8958*    NINETY BENEFIT PLAN TYPES:                               *
  8959*                                                             *
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 165
* EL050.cbl
  8960*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8961*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8962*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8963*           BENEFIT CONTROLS.                                 *
  8964*      99 = ALL BENEFITS.                                     *
  8965*                                                             *
  8966***************************************************************
  8967
  8968     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8969                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8970
  8971     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8972       AND
  8973        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8974        GO TO 03XX-GET-AH-ERPLAN.
  8975
  8976     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8977       AND
  8978        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8979           IF (PB-I-INDV-GRP-OVRD = 'I')
  8980              OR
  8981           ((AM-IG = '1') AND
  8982           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8983              OR
  8984           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8985           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8986           (AM-IG NOT = '2'))
  8987              GO TO 03XX-GET-AH-ERPLAN.
  8988
  8989     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8990       AND
  8991        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8992           IF (PB-I-INDV-GRP-OVRD = 'G')
  8993              OR
  8994           ((AM-IG = '2') AND
  8995           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8996              OR
  8997           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8998           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8999           (AM-IG NOT = '1'))
  9000              GO TO 03XX-GET-AH-ERPLAN.
  9001
  9002     IF SUB5 LESS THAN +20
  9003        ADD +1                   TO SUB5
  9004        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9005
  9006     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9007        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9008
  9009     MOVE +1                    TO SUB5.
  9010
  9011 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9012
  9013     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9014                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9015
  9016     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9017       AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 166
* EL050.cbl
  9018        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9019        GO TO 03XX-GET-AH-ERPLAN.
  9020
  9021     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9022       AND
  9023        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9024           IF (PB-I-INDV-GRP-OVRD = 'I')
  9025              OR
  9026           ((AM-IG = '1') AND
  9027           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9028              OR
  9029           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9030           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9031           (AM-IG NOT = '2'))
  9032              GO TO 03XX-GET-AH-ERPLAN.
  9033
  9034     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9035       AND
  9036        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9037           IF (PB-I-INDV-GRP-OVRD = 'G')
  9038              OR
  9039           ((AM-IG = '2') AND
  9040           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9041              OR
  9042           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9043           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9044           (AM-IG NOT = '1'))
  9045              GO TO 03XX-GET-AH-ERPLAN.
  9046
  9047     IF SUB5 LESS THAN +30
  9048        ADD +1                   TO SUB5
  9049        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9050
  9051 03XX-EDIT-FOR-NINETY-AH-CONT.
  9052
  9053     MOVE +99                    TO SUB5.
  9054
  9055     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9056
  9057     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9058        IF PB-ISSUE
  9059           MOVE ER-1925          TO  WS-ERROR
  9060           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9061
  9062     GO TO 0314-A-H-BENEFIT-FOUND.
  9063
  9064 03XX-GET-AH-ERPLAN.
  9065
  9066     IF WK-PLAN-ADDR EQUAL +0
  9067         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9068
  9069     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9070     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9071     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9072     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9073     MOVE 'Y'                    TO PLAN-MASTER-SW
  9074                                    PLAN-MASTER-AH-SW.
  9075*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 167
* EL050.cbl
  9076     GO TO 03XX-ERPLAN-AH-READ.
  9077
  9078 03XX-ERPLAN-AH-GETMAIN.
  9079
  9080     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9081     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9082
  9083 03XX-ERPLAN-AH-READ.
  9084
  9085     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9086     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9087     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9088     MOVE PB-SV-STATE            TO PLAN-STATE.
  9089     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9090     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9091     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9092     MOVE WS-SAVE-BENEFIT-REVISION
  9093                                 TO PLAN-REVISION-NO.
  9094
  9095     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9096     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9097
  9098     IF PB-COMPANY-ID = 'NCL'
  9099       IF NOT AH-PLAN-MASTER-FOUND
  9100         IF NOT PB-POLICY-IS-DECLINED  AND
  9101            NOT PB-POLICY-IS-VOIDED
  9102             MOVE  ER-1922         TO  WS-ERROR
  9103             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9104             GO TO 0314-A-H-BENEFIT-FOUND.
  9105
  9106     IF NOT AH-PLAN-MASTER-FOUND
  9107        GO TO 0314-A-H-BENEFIT-FOUND.
  9108
  9109 XXXX-CHECK-AH-PLAN-KEY.
  9110
  9111     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9112        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9113        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9114        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9115        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9116        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9117        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9118        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9119        MOVE 'N'                 TO PLAN-MASTER-SW
  9120          GO TO 03XX-ERPLAN-AH-READ.
  9121
  9122     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9123
  9124     IF  PB-CANCELLATION
  9125         GO TO  0313-AH-ACCT-BEN-FOUND.
  9126
  9127     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9128       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9129          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9130          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9131             MOVE ER-2644             TO WS-ERROR
  9132             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9133          ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 168
* EL050.cbl
  9134             NEXT SENTENCE
  9135       ELSE
  9136          IF PB-COMPANY-ID NOT = 'NCL'
  9137             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9138                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9139
  9140 0313-AH-ACCT-BEN-FOUND.
  9141
  9142     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9143
  9144     IF PL-DEV-CODE NOT = SPACES
  9145        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9146
  9147     IF PL-DEV-PCT NUMERIC AND
  9148        PL-DEV-PCT NOT = ZEROS
  9149        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9150
  9151     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9152        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9153
  9154     IF PL-TOL-REF-AMT NOT EQUAL +0
  9155        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9156
  9157     IF PL-TOL-PREM-PCT GREATER THAN +0
  9158        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9159
  9160     IF PL-TOL-REF-PCT GREATER THAN +0
  9161        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9162
  9163     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9164        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9165
  9166     IF PL-OVER-SHORT-AMT NUMERIC AND
  9167                          PL-OVER-SHORT-AMT > +0
  9168        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9169
  9170     IF PL-OVER-SHORT-PCT NUMERIC AND
  9171                          PL-OVER-SHORT-PCT > +0
  9172        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9173
  9174     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9175        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9176        IF WS-IG-OVRD-AM EQUAL SPACES
  9177            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9178
  9179 0314-A-H-BENEFIT-FOUND.
  9180
  9181     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9182
  9183     IF PB-ISSUE
  9184        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9185       ELSE
  9186        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9187
  9188     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9189     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9190     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9191     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 169
* EL050.cbl
  9192                                         WS-AH-REFUND-CALC.
  9193
  9194     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9195        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9196
  9197     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9198        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9199     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9200
  9201     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9202     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9203     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9204     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9205     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9206     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9207
  9208     IF PB-COMPANY-ID = 'NCL'  AND
  9209        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9210         NEXT SENTENCE
  9211     ELSE
  9212         IF SUB5 NOT GREATER THAN +20
  9213            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9214                MOVE WS-SAVE-BENEFIT-REM-TERM
  9215                                      TO WS-AM-AH-BENE-REM-TERM
  9216                                         EC-BR-AH-REM-TERM-CALC.
  9217
  9218     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9219     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9220
  9221     GO TO 0400-FIND-CARRIER.
  9222
  9223 0399-BENEFIT-NOT-FOUND.
  9224
  9225     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9226     MOVE ER-2605                TO WS-ERROR.
  9227     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9228
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 170
* EL050.cbl
  9230
  9231 0400-FIND-CARRIER.
  9232
  9233     MOVE PB-SV-CARRIER          TO WS-CARR.
  9234
  9235     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9236     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9237     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9238     MOVE '6'                    TO CNTL-REC-TYPE.
  9239
  9240*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9241     MOVE SPACE                  TO WS-DMD-RATING-SW
  9242                                    EC-BR-DMD-RATING-SW.
  9243
  9244     MOVE '2'                    TO RC-SW-1.
  9245     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9246
  9247     IF NOT CF-CARRIER-MASTER
  9248        GO TO 0400-CARRIER-NOT-FOUND.
  9249
  9250 0400-BUILD-CARR-TOL.
  9251
  9252     IF CF-CR-TOL-PREM NUMERIC AND
  9253        CF-CR-TOL-PREM GREATER THAN +0
  9254        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9255                                    WS-TOL-AH-PREM.
  9256
  9257     IF CF-CR-TOL-REFUND NUMERIC AND
  9258        CF-CR-TOL-REFUND GREATER THAN +0
  9259        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9260                                    WS-TOL-AH-REFUND.
  9261
  9262     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9263        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9264        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9265                                    WS-AH-REFUND-OVS-AMT.
  9266
  9267     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9268        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9269        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9270                                    WS-AH-REFUND-OVS-PCT.
  9271
  9272     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9273        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9274        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9275                                    WS-TOL-AH-PREM-PCT.
  9276
  9277     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9278        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9279        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9280                                     WS-TOL-AH-REFUND-PCT.
  9281
  9282     IF CF-COMPANY-ID EQUAL 'DMD'
  9283         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9284                                    EC-BR-DMD-RATING-SW.
  9285
  9286     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9287     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 171
* EL050.cbl
  9288        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9289     END-IF
  9290     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9291        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9292     END-IF
  9293     IF WS-TOL-CLP-PCT = ZEROS
  9294        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9295     END-IF
  9296
  9297     IF WS-SPP-LEASE-COMM = ZEROS
  9298        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9299     END-IF
  9300     GO TO 0400-FIND-ERPDEF.
  9301
  9302 0400-CARRIER-NOT-FOUND.
  9303
  9304     MOVE ER-2602                TO WS-ERROR.
  9305     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9306
  9307 0400-FIND-ERPDEF.
  9308     IF PB-COMPANY-ID = 'DCC'
  9309        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9310        CONTINUE
  9311     ELSE
  9312        GO TO 0400-FIND-ERCOMP
  9313     END-IF
  9314     MOVE ' '                    TO PDEF-MASTER-SW
  9315     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9316     MOVE PB-STATE               TO ERPDEF-STATE
  9317     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9318     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9319     IF PB-ISSUE
  9320        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9321     ELSE
  9322        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9323     END-IF
  9324     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9325     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9326     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9327     IF PDEF-MASTER-FOUND
  9328        MOVE 'N'                 TO PDEF-MASTER-SW
  9329        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9330        IF PDEF-MASTER-FOUND
  9331           IF (ERPDEF-KEY-SAVE (1:16) =
  9332                        PD-CONTROL-PRIMARY (1:16))
  9333              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9334              CONTINUE
  9335           ELSE
  9336              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9337              IF (ERPDEF-KEY-SAVE (1:16) =
  9338                        PD-CONTROL-PRIMARY (1:16))
  9339                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9340                 CONTINUE
  9341              ELSE
  9342                 MOVE 'N'        TO PDEF-MASTER-SW
  9343              END-IF
  9344           END-IF
  9345        END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 172
* EL050.cbl
  9346        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9347     END-IF
  9348     IF PDEF-MASTER-FOUND
  9349        IF PD-TRUNCATED = 'Y'
  9350           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9351        END-IF
  9352     END-IF
  9353     .
  9354 0400-FIND-ERCOMP.
  9355     IF PB-COMPANY-ID = 'DCC'
  9356        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9357           (WS-SUB1 > +10)
  9358           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9359                 OR 'A' OR 'N'
  9360              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9361              MOVE PB-CARRIER    TO COMP-CARRIER
  9362              MOVE PB-GROUPING   TO COMP-GROUPING
  9363              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9364              MOVE AM-AGT (WS-SUB1)
  9365                                 TO COMP-FIN-RESP
  9366              MOVE 'G'           TO COMP-TYPE
  9367              PERFORM 8582-READ-COMPENSATION-MASTER
  9368                                 THRU 8582-EXIT
  9369              IF COMP-MASTER-FOUND
  9370                 IF CO-GA-INACTIVE
  9371                    MOVE ER-2763 TO WS-ERROR
  9372                    PERFORM 9900-ERROR-FORMAT
  9373                                 THRU 9900-EXIT
  9374                    MOVE +11     TO WS-SUB1
  9375                 END-IF
  9376                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9377                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9378                    MOVE ER-2788 TO WS-ERROR
  9379                    PERFORM 9900-ERROR-FORMAT
  9380                                 THRU 9900-EXIT
  9381                    MOVE +11     TO WS-SUB1
  9382                 END-IF
  9383              END-IF
  9384           END-IF
  9385        END-PERFORM
  9386     END-IF
  9387     IF PB-COMPANY-ID = 'DCC'
  9388        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9389           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9390                                    WS-CLP-STATE
  9391        ELSE
  9392           MOVE SPACES           TO PB-I-CLP-STATE
  9393                                    WS-CLP-STATE
  9394        END-IF
  9395     END-IF
  9396
  9397     IF (PB-COMPANY-ID = 'DCC')
  9398        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9399        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9400        CONTINUE
  9401     ELSE
  9402        GO TO 0400-FIND-STATE-RECORD
  9403     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 173
* EL050.cbl
  9404     MOVE SPACES                 TO WS-CLP-STATE
  9405     MOVE +0                     TO WS-BANK-FEE
  9406                                    WS-BANK-LFEE
  9407                                    WS-BANK-NOCHRGB
  9408
  9409     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9410     IF (PB-ISSUE)
  9411        AND (PB-I-BANK-NUMBER NOT =
  9412            SPACES AND ZEROS AND LOW-VALUES)
  9413        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9414     ELSE
  9415        IF (PB-CANCELLATION)
  9416           AND (PB-CI-BANK-NUMBER NOT =
  9417                SPACES AND ZEROS AND LOW-VALUES)
  9418           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9419        END-IF
  9420     END-IF
  9421     IF COMP-FIN-RESP NOT = LOW-VALUES
  9422        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9423        MOVE PB-CARRIER          TO COMP-CARRIER
  9424        MOVE PB-GROUPING         TO COMP-GROUPING
  9425        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9426        MOVE 'B'                 TO COMP-TYPE
  9427        PERFORM 8582-READ-COMPENSATION-MASTER
  9428                                 THRU 8582-EXIT
  9429        IF COMP-MASTER-FOUND
  9430           IF CO-MAX-BANK-FEE NOT NUMERIC
  9431              MOVE +0            TO CO-MAX-BANK-FEE
  9432           END-IF
  9433           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9434              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9435           END-IF
  9436           IF CO-GA-INACTIVE
  9437              MOVE ER-2763       TO WS-ERROR
  9438              PERFORM 9900-ERROR-FORMAT
  9439                                 THRU 9900-EXIT
  9440           END-IF
  9441           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9442              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9443              MOVE ER-2788 TO WS-ERROR
  9444              PERFORM 9900-ERROR-FORMAT
  9445                                 THRU 9900-EXIT
  9446              MOVE +11     TO WS-SUB1
  9447           END-IF
  9448           IF WS-AH-BEN-CATEGORY = 'G'
  9449              MOVE CO-MAX-BANK-FEE
  9450                                 TO WS-BANK-FEE
  9451                                    PB-I-BANK-FEE
  9452           ELSE
  9453              MOVE CO-MAX-BANK-FEE-LEASE
  9454                                 TO WS-BANK-LFEE
  9455                                    PB-I-BANK-FEE
  9456           END-IF
  9457           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9458              AND (WS-AH-REFUND-CALC = 'G'))
  9459                        OR
  9460              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9461              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 174
* EL050.cbl
  9462              CONTINUE
  9463           ELSE
  9464              MOVE ER-2789 TO WS-ERROR
  9465              PERFORM 9900-ERROR-FORMAT
  9466                                 THRU 9900-EXIT
  9467           END-IF
  9468           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9469                                    PB-I-CLP-STATE
  9470           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9471           MOVE CO-CARRIER       TO BXRF-CARRIER
  9472           MOVE CO-GROUPING      TO BXRF-GROUPING
  9473           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9474           MOVE BXRF-MAX-REC-LENGTH
  9475                                 TO BXRF-REC-LENGTH
  9476           PERFORM 8584-READ-BANK-CROSS-REF
  9477                                 THRU 8584-EXIT
  9478           IF BXRF-MASTER-FOUND
  9479              MOVE ' '           TO BANK-ACCT-SW
  9480              MOVE BK-BANK-POINTER-CNT
  9481                                 TO BK-BANK-POINTER-CNT
  9482              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9483                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9484                 OR (BANK-ACCT-FOUND)
  9485                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9486                    AND (BK-AM-EXP-DT (WS-SUB1)
  9487                                 > PB-CERT-EFF-DT)
  9488                    AND (BK-AM-EFF-DT (WS-SUB1)
  9489                                 NOT > PB-CERT-EFF-DT)
  9490                    SET BANK-ACCT-FOUND TO TRUE
  9491                 END-IF
  9492              END-PERFORM
  9493              IF NOT BANK-ACCT-FOUND
  9494                 MOVE ZEROS      TO WS-BANK-FEE
  9495                                    WS-BANK-LFEE
  9496                 MOVE ER-2869    TO WS-ERROR
  9497                 PERFORM 9900-ERROR-FORMAT
  9498                                 THRU 9900-EXIT
  9499              ELSE
  9500                 PERFORM 5000-PROCESS-REPS
  9501                                 THRU 5000-EXIT
  9502                 IF AGENT-MASTER-FOUND
  9503                    MOVE +0      TO WS-BANK-FEE
  9504                                    WS-BANK-LFEE
  9505*                   MOVE AG-SPP-FEES (1)
  9506*                                TO PB-I-BANK-FEE
  9507*                                   WS-BANK-FEE
  9508                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9509                       (WS-SUB1 > +10)
  9510                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9511                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9512                       END-IF
  9513                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9514                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9515                       END-IF
  9516                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9517                          AG-SPP-FEES (WS-SUB1)
  9518                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9519                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 175
* EL050.cbl
  9520                    END-PERFORM
  9521                    IF WS-AH-BEN-CATEGORY = 'G'
  9522                       MOVE WS-BANK-FEE
  9523                                 TO PB-I-BANK-FEE
  9524                    ELSE
  9525                       MOVE WS-BANK-LFEE
  9526                                 TO PB-I-BANK-FEE
  9527                    END-IF
  9528                 END-IF
  9529              END-IF
  9530           END-IF
  9531        ELSE
  9532           MOVE ER-2879          TO WS-ERROR
  9533           PERFORM 9900-ERROR-FORMAT
  9534                                 THRU 9900-EXIT
  9535        END-IF
  9536     ELSE
  9537        MOVE ER-2879             TO WS-ERROR
  9538        PERFORM 9900-ERROR-FORMAT
  9539                                 THRU 9900-EXIT
  9540     END-IF
  9541     IF WS-AH-BEN-CATEGORY = 'G'
  9542        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9543        + WS-BANK-FEE
  9544     ELSE
  9545        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9546        + WS-BANK-LFEE
  9547     END-IF
  9548     .
  9549 0400-FIND-STATE-RECORD.
  9550
  9551     IF WK-STATE-ADDR NOT = ZEROS
  9552         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9553         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9554         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9555         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9556         IF PB-SV-STATE = CF-STATE-CODE
  9557             GO TO 0405-CONTINUE-EDIT
  9558         ELSE
  9559             NEXT SENTENCE
  9560     ELSE
  9561         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9562
  9563     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9564     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9565     MOVE '3'                    TO CNTL-REC-TYPE.
  9566     MOVE +0                     TO CNTL-SEQ-NO.
  9567
  9568     MOVE '3'                    TO RC-SW-2.
  9569     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9570
  9571     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9572        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9573        PB-SV-STATE   NOT = CF-STATE-CODE)
  9574        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9575                                    WS-TOL-AH-CLAIM
  9576                                    WS-MINIMUM-REFUND
  9577                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 176
* EL050.cbl
  9578                                    WS-TOL-AH-PREM
  9579                                    WS-TOL-LF-REFUND
  9580                                    WS-TOL-AH-REFUND
  9581                                    EC-ST-TOL-PREM-PCT
  9582                                    WS-TOL-LF-PREM-PCT
  9583                                    WS-TOL-AH-PREM-PCT
  9584                                    EC-ST-TOL-REFUND-PCT
  9585                                    WS-TOL-LF-REFUND-PCT
  9586                                    WS-TOL-AH-REFUND-PCT
  9587                                    EC-ST-TOL-PREM
  9588                                    EC-ST-TOL-REFUND
  9589                                    EC-ST-FST-PMT-DAYS-MAX
  9590                                    WS-FREE-LOOK-PERIOD
  9591                                    WS-ST-LF-PREM-TAX
  9592                                    WS-ST-AH-PREM-TAX-I
  9593                                    WS-ST-AH-PREM-TAX-G
  9594                                    WS-BANK-FEE
  9595                                    WS-BANK-LFEE
  9596                                    WS-TOL-CLP-PCT
  9597                                    WS-SPP-LEASE-COMM
  9598        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9599                                    EC-ST-FST-PMT-DAYS-CHG
  9600                                    WS-LF-REM-TERM-CALC
  9601                                    WS-LF-REFUND-CALC
  9602                                    EC-ST-LF-REM-TERM-CALC
  9603                                    EC-ST-LF-REFUND-CALC
  9604                                    WS-AH-REM-TERM-CALC
  9605                                    WS-AH-REFUND-CALC
  9606                                    WS-LF-BEN-CATEGORY
  9607                                    WS-AH-BEN-CATEGORY
  9608                                    WS-CLP-STATE
  9609                                    WS-ST-REFUND-CLAIM-FLAG
  9610                                    EC-ST-AH-REM-TERM-CALC
  9611                                    EC-ST-AH-REFUND-CALC
  9612          GO TO 0499-STATE-NOT-FOUND.
  9613
  9614     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9615
  9616 0405-CONTINUE-EDIT.
  9617
  9618     if pb-company-id = 'AHL'
  9619        continue
  9620     else
  9621        IF PB-CERT-PRIME NOT NUMERIC
  9622           MOVE ER-2722          TO WS-ERROR
  9623           PERFORM 9900-ERROR-FORMAT
  9624                                 THRU 9900-EXIT
  9625        end-if
  9626     END-IF
  9627*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9628*       MOVE +0                  TO SUB3
  9629*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9630*       IF SUB3 > +0
  9631*          MOVE ER-2722          TO WS-ERROR
  9632*          PERFORM 9900-ERROR-FORMAT
  9633*                                THRU 9900-EXIT
  9634*       END-IF
  9635*    END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 177
* EL050.cbl
  9636*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9637*       IF PB-CERT-PRIME NOT NUMERIC
  9638*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9639*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9640*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9641*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9642*
  9643*          MOVE ER-2722          TO WS-ERROR
  9644*          PERFORM 9900-ERROR-FORMAT
  9645*                                THRU 9900-EXIT
  9646*       END-IF
  9647*    END-IF
  9648
  9649     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9650
  9651     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9652        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9653                                    WS-TOL-AH-CLAIM.
  9654
  9655     IF CF-ST-REFUND-MIN NOT NUMERIC
  9656        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9657
  9658     IF CF-ST-REFUND-MIN NOT = ZEROS
  9659        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9660
  9661     IF CF-ST-TOL-PREM  NOT = ZEROS
  9662        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9663                                    WS-TOL-AH-PREM
  9664        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9665
  9666     IF CF-ST-TOL-REFUND NOT = ZEROS
  9667        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9668                                    WS-TOL-AH-REFUND
  9669        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9670
  9671     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9672        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9673        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9674                                    WS-AH-REFUND-OVS-AMT
  9675                                    EC-ST-OVR-SHT-AMT.
  9676
  9677     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9678        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9679        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9680                                    WS-TOL-LF-PREM-PCT
  9681                                    WS-TOL-AH-PREM-PCT.
  9682
  9683     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9684        CF-ST-TOL-REF-PCT GREATER THAN +0
  9685        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9686                                    WS-TOL-LF-REFUND-PCT
  9687                                    WS-TOL-AH-REFUND-PCT.
  9688
  9689     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9690        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9691        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9692                                    WS-AH-REFUND-OVS-PCT
  9693                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 178
* EL050.cbl
  9694
  9695     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9696     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9697
  9698     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9699          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9700
  9701     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9702     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9703     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9704
  9705     IF CF-ST-LF-PREM-TAX NUMERIC
  9706        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9707     END-IF
  9708     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9709        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9710     END-IF
  9711     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9712        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9713     END-IF
  9714
  9715     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9716         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9717     END-IF.
  9718
  9719     IF WS-LF-BENEFIT-CD = ZEROS
  9720        GO TO 0410-CHECK-AH.
  9721
  9722     IF CF-ST-RT-CALC NOT = SPACES
  9723        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9724                                    EC-ST-LF-REM-TERM-CALC
  9725     END-IF
  9726
  9727     IF WS-LF-COVERAGE-TYPE = 'R'
  9728        IF WS-LF-EARNINGS-CALC = '5'
  9729           IF CF-ST-RF-LN-CALC > '0'
  9730              MOVE CF-ST-RF-LN-CALC
  9731                                 TO WS-LF-REFUND-CALC
  9732                                    EC-ST-LF-REFUND-CALC
  9733           END-IF
  9734        ELSE
  9735           IF CF-ST-RF-LR-CALC > '0'
  9736              MOVE CF-ST-RF-LR-CALC
  9737                                 TO WS-LF-REFUND-CALC
  9738                                    EC-ST-LF-REFUND-CALC
  9739           END-IF
  9740        END-IF
  9741     ELSE
  9742        IF CF-ST-RF-LL-CALC > '0'
  9743           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9744                                    EC-ST-LF-REFUND-CALC
  9745        END-IF
  9746     END-IF
  9747
  9748     IF CF-ST-RT-CALC NOT = SPACES
  9749        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9750                                    EC-ST-LF-REM-TERM-CALC
  9751     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 179
* EL050.cbl
  9752
  9753     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9754     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9755
  9756     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9757
  9758     IF NO-BENEFIT-FOUND
  9759        GO TO 0410-CHECK-AH.
  9760
  9761     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9762        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9763                                 TO EC-ST-LF-REM-TERM-CALC
  9764                                    WS-LF-REM-TERM-CALC
  9765     END-IF
  9766
  9767     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9768        MOVE CF-ST-REFUND-CALC (SUB3)
  9769                                 TO WS-LF-REFUND-CALC
  9770                                    EC-ST-LF-REFUND-CALC
  9771     END-IF
  9772*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9773
  9774     .
  9775 0410-CHECK-AH.
  9776
  9777     IF WS-AH-BENEFIT-CD = ZEROS
  9778        GO TO 0500-SET-ACCOUNT.
  9779
  9780     IF CF-ST-RT-CALC NOT = SPACES
  9781        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9782                                    EC-ST-AH-REM-TERM-CALC
  9783     END-IF
  9784
  9785     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9786        IF CF-ST-RF-CP-CALC > '0'
  9787           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9788                                    EC-ST-AH-REFUND-CALC
  9789        END-IF
  9790     ELSE
  9791        IF CF-ST-RF-AH-CALC > '0'
  9792           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9793                                    EC-ST-AH-REFUND-CALC
  9794        END-IF
  9795     END-IF
  9796     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9797     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9798
  9799     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9800
  9801     IF NO-BENEFIT-FOUND
  9802        GO TO 0500-SET-ACCOUNT.
  9803
  9804     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9805        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9806                                 TO WS-AH-REM-TERM-CALC
  9807                                    EC-ST-AH-REM-TERM-CALC
  9808     END-IF
  9809
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 180
* EL050.cbl
  9810     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9811        MOVE CF-ST-REFUND-CALC (SUB3)
  9812                                 TO WS-AH-REFUND-CALC
  9813                                    EC-ST-AH-REFUND-CALC
  9814     END-IF
  9815
  9816*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9817
  9818     GO TO 0500-SET-ACCOUNT.
  9819
  9820 0499-STATE-NOT-FOUND.
  9821
  9822     MOVE ER-2603                TO WS-ERROR.
  9823     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9824
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 181
* EL050.cbl
  9826
  9827 0500-SET-ACCOUNT.
  9828*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9829     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9830        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9831        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9832        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9833        MOVE '3'                 TO CNTL-REC-TYPE
  9834        MOVE +0                  TO CNTL-SEQ-NO
  9835
  9836        MOVE '3'                 TO RC-SW-2
  9837        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9838
  9839        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9840           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9841           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9842           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9843                                    WS-ST-AH-PREM-TAX-I
  9844                                    WS-ST-AH-PREM-TAX-G
  9845        ELSE
  9846           IF CF-ST-LF-PREM-TAX NUMERIC
  9847              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9848           END-IF
  9849           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9850              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9851           END-IF
  9852           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9853              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9854           END-IF
  9855        END-IF
  9856        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9857     END-IF
  9858*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9859*  FOR DCC ONLY
  9860     IF PB-COMPANY-ID = 'DCC'
  9861
  9862     MOVE ' '                    TO STAT-MASTER-SW
  9863     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9864     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9865     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9866     MOVE PB-STATE               TO ELSTAT-STATE
  9867     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9868        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9869     END-IF
  9870
  9871     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9872     SET BIN-TO-GREG             TO TRUE
  9873     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9874     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9875     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9876
  9877     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9878     IF STAT-MASTER-FOUND
  9879        MOVE 'N'                 TO STAT-MASTER-SW
  9880        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9881        IF STAT-MASTER-FOUND
  9882           IF (ELSTAT-KEY-SAVE (1:12) =
  9883                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 182
* EL050.cbl
  9884              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9885                 MOVE 'F'        TO STAT-MASTER-SW
  9886              ELSE
  9887                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9888                 IF (STAT-MASTER-FOUND)
  9889                    AND (ELSTAT-KEY-SAVE (1:12) =
  9890                        SF-CONTROL-PRIMARY (1:12))
  9891                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9892                    MOVE 'F'     TO STAT-MASTER-SW
  9893                 END-IF
  9894              END-IF
  9895           END-IF
  9896        END-IF
  9897     END-IF
  9898
  9899     IF STAT-MASTER-SW = 'F'
  9900        IF SF-ST-LF-PREM-TAX NUMERIC
  9901           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9902        END-IF
  9903        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9904           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9905        END-IF
  9906        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9907           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9908        END-IF
  9909     END-IF
  9910
  9911     END-IF
  9912     IF (PB-COMPANY-ID = 'DCC')
  9913        AND (PB-ISSUE)
  9914        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9915        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9916        AND (AM-GPCD = 06)
  9917        MOVE 'Y'                 TO WS-GOOD-HIN
  9918        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9919           MOVE PB-I-VIN         TO WS-WORK-VIN
  9920           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9921              (V1 > 16)
  9922              IF WS-WORK-VIN (V1:1) NUMERIC
  9923                 MOVE WS-WORK-VIN-N (V1)
  9924                                 TO WS-ROW-B-VAL (V1)
  9925              ELSE
  9926                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9927                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9928                    OR (V2 > 26)
  9929                 END-PERFORM
  9930                 IF V2 < 27
  9931                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9932                 ELSE
  9933                    MOVE 'N'     TO WS-GOOD-HIN
  9934                 END-IF
  9935              END-IF
  9936              COMPUTE WS-ROW-D-VAL (V1) =
  9937                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9938              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9939                 WS-ROW-D-VAL (V1)
  9940           END-PERFORM
  9941           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 183
* EL050.cbl
  9942           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9943             REMAINDER WS-VIN-REMAINDER
  9944           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9945              CONTINUE
  9946           ELSE
  9947              MOVE 'N'           TO WS-GOOD-HIN
  9948           END-IF
  9949        ELSE
  9950           MOVE 'N'              TO WS-GOOD-HIN
  9951        END-IF
  9952        IF WS-GOOD-HIN NOT = 'Y'
  9953           MOVE ER-3826           TO WS-ERROR
  9954           PERFORM 9900-ERROR-FORMAT
  9955                                 THRU 9900-EXIT
  9956        END-IF
  9957     END-IF
  9958     IF (PB-COMPANY-ID = 'DCC')
  9959        AND (PB-ISSUE)
  9960        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9961        AND (AM-GPCD NOT = 06)
  9962        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9963          MOVE PB-I-VIN          TO WS-WORK-VIN
  9964          MOVE +8                TO V2
  9965          MOVE ZEROS             TO WS-VIN-TOTAL
  9966          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9967           (V1 > 17)
  9968             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9969                MOVE ER-3825     TO WS-ERROR
  9970                PERFORM 9900-ERROR-FORMAT
  9971                                 THRU 9900-EXIT
  9972             ELSE
  9973                IF V1 = 8
  9974                   MOVE 10       TO V2
  9975                END-IF
  9976                IF V1 = 9
  9977                   MOVE 0        TO V2
  9978                END-IF
  9979                IF V1 = 10
  9980                   MOVE 9        TO V2
  9981                END-IF
  9982                IF WS-WORK-VIN (V1:1) NUMERIC
  9983                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9984                    + (WS-WORK-VIN-N (V1) * V2)
  9985                ELSE
  9986                   MOVE WS-WORK-VIN (V1:1)
  9987                                 TO WS-HEX-BYTE
  9988                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9989                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9990                    + (WS-NUM (V3) * V2)
  9991                END-IF
  9992                COMPUTE V2 = V2 - 1
  9993             END-IF
  9994          END-PERFORM
  9995          MOVE ZEROS TO WS-VIN-REMAINDER
  9996          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9997             REMAINDER WS-VIN-REMAINDER
  9998          IF ((WS-WORK-VIN (9:1) = 'X')
  9999             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 184
* EL050.cbl
 10000                     OR
 10001             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10002             CONTINUE
 10003          ELSE
 10004             MOVE ER-3826        TO WS-ERROR
 10005             PERFORM 9900-ERROR-FORMAT
 10006                                 THRU 9900-EXIT
 10007          END-IF
 10008        ELSE
 10009          MOVE ER-3826           TO WS-ERROR
 10010          PERFORM 9900-ERROR-FORMAT
 10011                                 THRU 9900-EXIT
 10012        END-IF
 10013     END-IF
 10014******************************************************************
 10015******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10016******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10017******* METHODS.
 10018******************************************************************
 10019     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10020        IF PB-CANCELLATION
 10021           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10022              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10023                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10024                IF FORM-MASTER-FOUND
 10025                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10026******************************************************************
 10027
 10028     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10029     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10030
 10031     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10032     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10033     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10034     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10035
 10036
 10037     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10038     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10039     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10040
 10041     IF AM-LF-OB-RATE NOT NUMERIC
 10042         MOVE ZERO               TO AM-LF-OB-RATE.
 10043
 10044     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10045         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10046
 10047     IF AM-AH-OB-RATE NOT NUMERIC
 10048         MOVE ZERO               TO AM-AH-OB-RATE.
 10049
 10050     IF WS-LF-JOINT-INDICATOR = 'J'
 10051         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10052     ELSE
 10053         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10054
 10055     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10056
 10057     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 185
* EL050.cbl
 10058         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10059
 10060     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10061         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10062                                       WS-IG-OVRD
 10063     ELSE
 10064         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10065             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10066                                       WS-IG-OVRD
 10067         ELSE
 10068             MOVE AM-IG             TO WS-IG-OVRD-AH
 10069                                       WS-IG-OVRD.
 10070
 10071     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10072         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10073                                       WS-IG-OVRD
 10074     ELSE
 10075         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10076             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10077                                       WS-IG-OVRD
 10078         ELSE
 10079             MOVE AM-IG             TO WS-IG-OVRD-LF
 10080                                       WS-IG-OVRD.
 10081
 10082     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10083     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10084     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10085     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10086     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10087
 10088     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10089     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10090     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10091     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10092
 10093     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10094     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10095     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10096     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10097     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10098     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10099     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10100
 10101     IF WS-ACCT-AH-DEV-PCT > +0
 10102        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10103     ELSE
 10104        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10105
 10106     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10107        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10108     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10109        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10110
 10111        IF AM-EARN-METHOD-L = 'S'
 10112            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10113                                        WS-LF-REFUND-CALC.
 10114
 10115        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 186
* EL050.cbl
 10116            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10117                                        WS-LF-REFUND-CALC.
 10118
 10119     IF WS-LF-COVERAGE-TYPE = 'R'
 10120         IF AM-EARN-METHOD-R = 'R'
 10121            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10122                                    WS-LF-REFUND-CALC.
 10123     IF WS-LF-COVERAGE-TYPE = 'R'
 10124         IF AM-EARN-METHOD-R = 'P'
 10125            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10126                                    WS-LF-REFUND-CALC.
 10127     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10128         IF AM-EARN-METHOD-L = 'R'
 10129            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10130                                    WS-LF-REFUND-CALC.
 10131     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10132         IF AM-EARN-METHOD-L = 'P'
 10133            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10134                                    WS-LF-REFUND-CALC.
 10135     IF WS-LF-COVERAGE-TYPE = 'R'
 10136         IF AM-EARN-METHOD-R = 'A'
 10137            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10138                                    WS-LF-REFUND-CALC.
 10139     IF WS-LF-COVERAGE-TYPE = 'R'
 10140         IF AM-EARN-METHOD-R = 'M'
 10141            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10142                                    WS-LF-REFUND-CALC.
 10143     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10144         IF AM-EARN-METHOD-L = 'A'
 10145            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10146                                    WS-LF-REFUND-CALC.
 10147     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10148         IF AM-EARN-METHOD-L = 'M'
 10149            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10150                                    WS-LF-REFUND-CALC.
 10151
 10152     IF AM-EARN-METHOD-A = 'R'
 10153        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10154                                    WS-AH-REFUND-CALC.
 10155     IF AM-EARN-METHOD-A = 'P'
 10156        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10157                                    WS-AH-REFUND-CALC.
 10158     IF AM-EARN-METHOD-A = 'C'
 10159        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10160                                    WS-AH-REFUND-CALC.
 10161     IF AM-EARN-METHOD-A = 'A'
 10162        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10163                                    WS-AH-REFUND-CALC.
 10164     IF AM-EARN-METHOD-A = 'M'
 10165        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10166                                    WS-AH-REFUND-CALC.
 10167     IF AM-EARN-METHOD-A = 'N'
 10168        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10169                                    WS-AH-REFUND-CALC.
 10170     IF AM-EARN-METHOD-A = 'S'
 10171        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10172                                    WS-AH-REFUND-CALC.
 10173
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 187
* EL050.cbl
 10174     IF AM-TOL-PREM NOT = ZEROS
 10175        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10176                                    WS-TOL-AH-PREM.
 10177
 10178     IF AM-OVR-SHT-AMT NUMERIC AND
 10179                  AM-OVR-SHT-AMT > 0
 10180        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10181                                    EC-AM-LF-OVR-SHT-AMT
 10182                                    WS-AH-REFUND-OVS-AMT
 10183                                    EC-AM-AH-OVR-SHT-AMT.
 10184
 10185     IF AM-OVR-SHT-PCT NUMERIC AND
 10186                    AM-OVR-SHT-PCT > 0
 10187        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10188                                    EC-AM-LF-OVR-SHT-PCT
 10189                                    WS-AH-REFUND-OVS-PCT
 10190                                    EC-AM-AH-OVR-SHT-PCT.
 10191
 10192     IF AM-TOL-REF-PCT NUMERIC AND
 10193                  AM-TOL-REF-PCT > 0
 10194        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10195                                    WS-TOL-AH-REFUND-PCT.
 10196
 10197     IF AM-TOL-REF  NOT = ZEROS  AND
 10198                  AM-TOL-REF NUMERIC
 10199        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10200                                    EC-AM-LF-TOL-REFUND
 10201                                    WS-TOL-AH-REFUND
 10202                                    EC-AM-AH-TOL-REFUND.
 10203
 10204     IF AM-TOL-CLM  NOT = ZEROS
 10205        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10206                                    WS-TOL-AH-CLAIM.
 10207
 10208     IF AM-CLP-TOL-PCT NOT NUMERIC
 10209        MOVE +0                  TO AM-CLP-TOL-PCT
 10210     END-IF
 10211
 10212     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10213        MOVE +0                  TO AM-SPP-LEASE-COMM
 10214     END-IF
 10215     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10216        MOVE WS-PL-TOL-LF-PREM-PCT
 10217                                 TO WS-TOL-LF-PREM-PCT.
 10218
 10219     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10220        MOVE WS-PL-TOL-AH-PREM-PCT
 10221                                 TO WS-TOL-AH-PREM-PCT.
 10222
 10223     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10224        MOVE WS-PL-TOL-LF-REFUND-PCT
 10225                                 TO WS-TOL-LF-REFUND-PCT.
 10226
 10227     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10228        MOVE WS-PL-TOL-AH-REFUND-PCT
 10229                                 TO WS-TOL-AH-REFUND-PCT.
 10230
 10231     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 188
* EL050.cbl
 10232        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10233
 10234     IF WS-PL-REF-OVS-PCT > +0
 10235        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10236
 10237     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10238        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10239     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10240        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10241     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10242        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10243     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10244        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10245     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10246        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10247     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10248        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10249
 10250     IF WS-AH-PL-REF-OVS-AMT > +0
 10251        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10252
 10253     IF WS-AH-PL-REF-OVS-PCT > +0
 10254        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10255
 10256     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10257     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10258
 10259     IF PB-CANCELLATION
 10260        GO TO 3000-CONTINUE-EDIT.
 10261
 10262     MOVE +1 TO SUB1.
 10263     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10264     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10265
 10266     IF CF-COMPANY-ID = 'DMD'
 10267       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10268         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10269        ELSE
 10270         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10271
 10272  0525-FIND-ACCT-COMM.
 10273     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10274        NEXT SENTENCE
 10275      ELSE
 10276         ADD +1 TO SUB1
 10277         IF SUB1 LESS +11
 10278            GO TO 0525-FIND-ACCT-COMM
 10279          ELSE
 10280             GO TO 0560-EDIT-CONTINUE.
 10281
 10282     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10283     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10284                                    PB-I-LIFE-COMMISSION.
 10285***  IF PB-COMPANY-ID = 'CRI'
 10286     IF PB-PREM-ACCTNG-ONLY
 10287         GO TO 0560-EDIT-CONTINUE.
 10288
 10289     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 189
* EL050.cbl
 10290     MOVE ' '    TO WS-CTBL-READ-SW.
 10291
 10292
 10293 0530-GET-AH-COMP.
 10294     IF NO-AH-COVERAGE  OR
 10295        NO-AH-BENEFIT-MATCH
 10296           GO TO 0540-NEXT-READ-STEP.
 10297
 10298     IF AM-A-COM (SUB1) NUMERIC
 10299        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10300         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10301         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10302         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10303         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10304     ELSE
 10305          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10306          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10307          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10308          MOVE ZEROS             TO WS-SUB1
 10309                                    WS-COMMISSION
 10310          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10311          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10312          IF WS-COMMISSION > ZEROS
 10313             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10314             GO TO 0540-NEXT-READ-STEP
 10315          END-IF
 10316          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10317          IF CTBL-TABLE-FOUND
 10318             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10319                                        PB-I-AH-TERM
 10320             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10321             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10322             GO TO 0540-NEXT-READ-STEP
 10323          ELSE
 10324             IF FIRST-TIME-THROUGH
 10325                 GO TO 0530-GET-AH-COMP
 10326             ELSE
 10327                 MOVE ER-2609                TO WS-ERROR
 10328                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10329
 10330 0540-NEXT-READ-STEP.
 10331     MOVE '0540' TO CTBL-SW.
 10332     MOVE ' '    TO WS-CTBL-READ-SW.
 10333
 10334 0540-GET-LF-COMP.
 10335     IF NO-LIFE-COVERAGE  OR
 10336        NO-LF-BENEFIT-MATCH
 10337           GO TO 0560-EDIT-CONTINUE.
 10338
 10339     IF WS-LF-JOINT-INDICATOR = 'J'
 10340        IF AM-J-COM (SUB1) NUMERIC
 10341           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10342           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10343           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10344           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10345           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10346        ELSE
 10347           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 190
* EL050.cbl
 10348           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10349           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10350           MOVE ZEROS                TO WS-SUB1
 10351                                        WS-COMMISSION
 10352           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10353           IF WS-COMMISSION > ZEROS
 10354              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10355              GO TO 0560-EDIT-CONTINUE
 10356           END-IF
 10357           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10358           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10359           IF CTBL-TABLE-FOUND
 10360              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10361              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10362              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10363              GO TO 0560-EDIT-CONTINUE
 10364           ELSE
 10365              IF FIRST-TIME-THROUGH
 10366                  GO TO 0540-GET-LF-COMP
 10367              ELSE
 10368                  MOVE ER-2609                TO WS-ERROR
 10369                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10370                  GO TO 0560-EDIT-CONTINUE.
 10371
 10372     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10373        IF AM-L-COM (SUB1) NUMERIC
 10374           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10375           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10376           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10377           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10378           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10379        ELSE
 10380           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10381           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10382           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10383           MOVE ZEROS                TO WS-SUB1
 10384                                        WS-COMMISSION
 10385           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10386           IF WS-COMMISSION IS GREATER THAN ZEROS
 10387              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10388              GO TO 0560-EDIT-CONTINUE
 10389           END-IF
 10390           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10391           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10392           IF CTBL-TABLE-FOUND
 10393              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10394              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10395              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10396              GO TO 0560-EDIT-CONTINUE
 10397           ELSE
 10398              IF FIRST-TIME-THROUGH
 10399                  GO TO 0540-GET-LF-COMP
 10400              ELSE
 10401                  MOVE ER-2609                TO WS-ERROR
 10402                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10403
 10404*    GO TO 0560-EDIT-CONTINUE.
 10405
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 191
* EL050.cbl
 10406 0560-EDIT-CONTINUE.
 10407     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10408                                    WS-AH-PMF-COMM
 10409*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10410*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10411     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10412        (SUB1 > +10)
 10413        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10414           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10415           MOVE '0530'           TO CTBL-SW
 10416           MOVE ' '              TO WS-CTBL-READ-SW
 10417           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10418           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10419           MOVE '0540'           TO CTBL-SW
 10420           MOVE ' '              TO WS-CTBL-READ-SW
 10421           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10422        END-IF
 10423     END-PERFORM
 10424     GO TO 0564-EDIT-CONTINUE
 10425     .
 10426 0561-CHECK-AH.
 10427     IF (NO-AH-COVERAGE)
 10428        OR (NO-AH-BENEFIT-MATCH)
 10429        CONTINUE
 10430     ELSE
 10431        IF (AM-A-COM (SUB1) NUMERIC)
 10432           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10433           IF (AM-COM-TYP (SUB1) = 'A')
 10434              AND (WS-AH-PMF-COMM = ZEROS)
 10435              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10436           END-IF
 10437           CONTINUE
 10438        ELSE
 10439           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10440           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10441           MOVE PB-AH-OVERRIDE-L1
 10442                                 TO CTBL-BEN-TYPE
 10443           MOVE ZEROS            TO WS-SUB1
 10444                                    WS-COMMISSION
 10445           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10446           PERFORM 8300-READ-CTBL-TABLE
 10447                                 THRU 8300-EXIT
 10448           IF CTBL-TABLE-FOUND
 10449              IF (AM-COM-TYP (SUB1) = 'A')
 10450                 AND (WS-AH-PMF-COMM = ZEROS)
 10451                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10452                                        PB-I-AH-TERM
 10453                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10454                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10455              END-IF
 10456              CONTINUE
 10457           ELSE
 10458              IF FIRST-TIME-THROUGH
 10459                 GO TO 0561-CHECK-AH
 10460              ELSE
 10461                 MOVE ER-2609    TO WS-ERROR
 10462                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10463              END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 192
* EL050.cbl
 10464           END-IF
 10465        END-IF
 10466     END-IF
 10467     .
 10468 0561-EXIT.
 10469     EXIT.
 10470 0563-CHECK-LF.
 10471     IF (NO-LIFE-COVERAGE)
 10472        OR (NO-LF-BENEFIT-MATCH)
 10473        CONTINUE
 10474     ELSE
 10475        IF WS-LF-JOINT-INDICATOR = 'J'
 10476           IF AM-J-COM (SUB1) NUMERIC
 10477              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10478              IF (AM-COM-TYP (SUB1) = 'A')
 10479                 AND (WS-LF-PMF-COMM = ZEROS)
 10480                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10481              END-IF
 10482              CONTINUE
 10483           ELSE
 10484              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10485              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10486              MOVE PB-LIFE-OVERRIDE-L1
 10487                                 TO CTBL-BEN-TYPE
 10488              MOVE ZEROS         TO WS-SUB1
 10489                                    WS-COMMISSION
 10490              MOVE AM-J-COMA (SUB1)
 10491                                 TO CTBL-TABLE
 10492              PERFORM 8300-READ-CTBL-TABLE
 10493                                 THRU 8300-EXIT
 10494              IF CTBL-TABLE-FOUND
 10495                 IF (AM-COM-TYP (SUB1) = 'A')
 10496                    AND (WS-LF-PMF-COMM = ZEROS)
 10497                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10498                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10499                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10500                 END-IF
 10501                 CONTINUE
 10502              ELSE
 10503                 IF FIRST-TIME-THROUGH
 10504                    GO TO 0563-CHECK-LF
 10505                 ELSE
 10506                    MOVE ER-2609 TO WS-ERROR
 10507                    PERFORM 9900-ERROR-FORMAT
 10508                                 THRU 9900-EXIT
 10509*                   GO TO 0560-EDIT-CONTINUE
 10510                 END-IF
 10511              END-IF
 10512           END-IF
 10513        ELSE
 10514           IF AM-L-COM (SUB1) NUMERIC
 10515              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10516              IF (AM-COM-TYP (SUB1) = 'A')
 10517                 AND (WS-LF-PMF-COMM = ZEROS)
 10518                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10519              END-IF
 10520              CONTINUE
 10521           ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 193
* EL050.cbl
 10522              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10523              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10524              MOVE PB-LIFE-OVERRIDE-L1
 10525                                 TO CTBL-BEN-TYPE
 10526              MOVE ZEROS         TO WS-SUB1
 10527                                    WS-COMMISSION
 10528              MOVE AM-L-COMA (SUB1)
 10529                                 TO CTBL-TABLE
 10530              PERFORM 8300-READ-CTBL-TABLE
 10531                                 THRU 8300-EXIT
 10532              IF CTBL-TABLE-FOUND
 10533                 CONTINUE
 10534              ELSE
 10535                 IF FIRST-TIME-THROUGH
 10536                    GO TO 0563-CHECK-LF
 10537                 ELSE
 10538                    MOVE ER-2609 TO WS-ERROR
 10539                    PERFORM 9900-ERROR-FORMAT
 10540                                 THRU 9900-EXIT
 10541                 END-IF
 10542              END-IF
 10543           END-IF
 10544        END-IF
 10545     END-IF
 10546     .
 10547 0563-EXIT.
 10548     EXIT.
 10549 0564-EDIT-CONTINUE.
 10550
 10551     IF  PB-COMPANY-ID EQUAL 'DMD'
 10552         IF PB-I-NUM-BILLED EQUAL ZEROS
 10553            MOVE ER-8148       TO WS-ERROR
 10554            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10555
 10556*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10557*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10558*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10559*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10560*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10561*         IF NO-CONVERSION-ERROR
 10562*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10563*         ELSE
 10564*             IF PB-COMPANY-ID EQUAL 'HAN'
 10565*                 MOVE ZEROS     TO PB-I-AGE.
 10566     IF PB-I-BIRTHDAY > LOW-VALUES
 10567        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10568        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10569        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10570        PERFORM 8500-DATE-CONVERT
 10571                                 THRU 8500-EXIT
 10572        IF NO-CONVERSION-ERROR
 10573           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10574           IF PB-I-AGE > ZEROS
 10575              IF WS-WORK-AGE NOT = PB-I-AGE
 10576                 MOVE ER-9501    TO WS-ERROR
 10577                 PERFORM 9900-ERROR-FORMAT
 10578                                 THRU 9900-EXIT
 10579              END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 194
* EL050.cbl
 10580           ELSE
 10581              MOVE WS-WORK-AGE   TO PB-I-AGE
 10582           END-IF
 10583        END-IF
 10584     END-IF
 10585     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10586                                   WS-INS-AGE-SET
 10587     IF PB-I-AGE = ZEROS
 10588        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10589           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10590                                   WS-INS-AGE-SET
 10591           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10592
 10593     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10594                                   WS-AH-EDIT-AGE.
 10595
 10596     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10597        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10598        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10599        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10600        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10601        IF NO-CONVERSION-ERROR
 10602           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10603           IF PB-I-JOINT-AGE > 0
 10604              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10605                 MOVE ER-9503    TO WS-ERROR
 10606                 PERFORM 9900-ERROR-FORMAT
 10607                                 THRU 9900-EXIT
 10608              END-IF
 10609           ELSE
 10610              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10611           END-IF
 10612        ELSE
 10613           MOVE ZEROS            TO PB-I-JOINT-AGE
 10614        END-IF
 10615     END-IF
 10616     IF PB-I-JOINT-AGE NOT NUMERIC
 10617        MOVE ZERO               TO PB-I-JOINT-AGE.
 10618
 10619     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10620                                   WS-JNT-AGE-SET
 10621     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10622        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10623           (WS-AH-JOINT-INDICATOR = 'J')
 10624           IF PB-I-JOINT-AGE = ZEROS
 10625               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10626                                          WS-JNT-AGE-SET
 10627               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10628           END-IF
 10629        END-IF
 10630     END-IF
 10631
 10632     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10633     IF WS-LF-JOINT-INDICATOR = 'J'
 10634        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10635        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10636            IF  PB-I-JOINT-AGE = ZERO
 10637                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 195
* EL050.cbl
 10638                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10639            ELSE
 10640                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10641                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10642                    IF PB-COMPANY-ID NOT = 'LBL'
 10643                        MOVE ER-2685    TO WS-ERROR
 10644                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10645
 10646     IF WS-AH-JOINT-INDICATOR = 'J'
 10647        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10648            IF  PB-I-JOINT-AGE = ZERO
 10649                MOVE ER-2686       TO WS-ERROR
 10650                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10651            ELSE
 10652                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10653                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10654                                           WS-EDIT-AGE
 10655                    IF PB-COMPANY-ID NOT = 'LBL'
 10656                        MOVE ER-2685    TO WS-ERROR
 10657                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10658
 10659******************************************************************
 10660*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10661******************************************************************
 10662
 10663     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10664        (WS-AH-SPECIAL-CALC-CD = 'O')
 10665        NEXT SENTENCE
 10666     ELSE
 10667        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10668          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10669           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10670            WS-AH-JOINT-INDICATOR = 'J')  AND
 10671           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10672            MOVE ER-2627             TO WS-ERROR
 10673            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10674
 10675     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10676        (WS-AH-SPECIAL-CALC-CD = 'O')
 10677         NEXT SENTENCE
 10678     ELSE
 10679         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10680            WS-AH-JOINT-INDICATOR = 'J'
 10681             IF PB-I-JOINT-INSURED = SPACES
 10682                 IF PB-COMPANY-ID NOT = 'JAL'
 10683                     MOVE ER-2696    TO WS-ERROR
 10684                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10685
 10686     IF PB-COMPANY-ID NOT = 'BOA'
 10687        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10688           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10689           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10690               PB-I-JOINT-INSURED NOT = SPACES)
 10691                MOVE ER-2691         TO WS-ERROR
 10692                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10693
 10694     IF PB-COMPANY-ID = 'BOA'
 10695        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 196
* EL050.cbl
 10696           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10697            IF PB-I-JOINT-AGE NOT = ZEROS
 10698                MOVE ER-2691         TO WS-ERROR
 10699                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10700
 10701     IF PB-COMPANY-ID = 'CRI'
 10702        IF PB-I-SIG-SW = 'J'
 10703           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10704              WS-AH-JOINT-INDICATOR NOT = 'J'
 10705              MOVE ER-2675       TO WS-ERROR
 10706              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10707
 10708     IF PB-COMPANY-ID = 'CRI'
 10709        IF PB-I-SIG-SW = 'S'
 10710           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10711              WS-AH-JOINT-INDICATOR = 'J'
 10712              MOVE ER-2676       TO WS-ERROR
 10713              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10714
 10715     IF PB-COMPANY-ID = 'CVL'
 10716         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10717            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10718              MOVE ER-2783           TO WS-ERROR
 10719              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10720     IF (WS-LF-JOINT-INDICATOR = 'J')
 10721        AND (WS-AH-JOINT-INDICATOR = 'J')
 10722        AND (PB-I-LF-TERM > 120)
 10723        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10724        MOVE ER-2783             TO WS-ERROR
 10725        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10726     END-IF
 10727     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10728
 10729     IF PB-I-INDV-GRP-OVRD = 'I'
 10730        MOVE ER-2666             TO WS-ERROR
 10731        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10732        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10733
 10734     IF PB-I-INDV-GRP-OVRD = 'G'
 10735        MOVE ER-2666             TO WS-ERROR
 10736        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10737        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10738
 10739     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10740        NEXT SENTENCE
 10741     ELSE
 10742        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10743
 10744     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10745        IF WS-ERROR = ER-2666
 10746           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10747           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10748
 10749     IF PB-COMPANY-ID = 'CID'
 10750        IF PB-STATE = 'UT' OR 'MO'
 10751           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10752                 OR '76' OR '77')
 10753                      OR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 197
* EL050.cbl
 10754               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10755                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10756                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10757                   OR '2K' OR '2L'))
 10758              AND PB-I-INDV-GRP-CD = 'I'
 10759              MOVE ER-2721             TO WS-ERROR
 10760              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10761           END-IF
 10762        END-IF
 10763     END-IF
 10764
 10765     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10766     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10767        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10768     ELSE
 10769        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10770     END-IF
 10771
 10772*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10773*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10774     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10775                                    ACCOUNT-AH-CK-SW.
 10776
 10777     IF PB-REISSUED-CERT       OR
 10778        PB-REIN-ONLY-CERT      OR
 10779        PB-POLICY-IS-DECLINED  OR
 10780        PB-POLICY-IS-VOIDED
 10781*       OR PB-MONTHLY-CERT
 10782         GO TO 3000-CONTINUE-EDIT.
 10783
 10784     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10785        IF WS-EDIT-AGE           > +65
 10786           MOVE ER-2709          TO WS-ERROR
 10787           PERFORM 9900-ERROR-FORMAT
 10788                                 THRU 9900-EXIT
 10789        ELSE
 10790           IF WS-EDIT-AGE        > +55
 10791              MOVE ER-2718       TO WS-ERROR
 10792              PERFORM 9900-ERROR-FORMAT
 10793                                 THRU 9900-EXIT
 10794           END-IF
 10795        END-IF
 10796     IF PB-COMPANY-ID = 'DCC'
 10797        IF WS-EDIT-AGE           > +65
 10798           MOVE ER-2709          TO WS-ERROR
 10799           PERFORM 9900-ERROR-FORMAT
 10800                                 THRU 9900-EXIT
 10801        END-IF
 10802     END-IF
 10803     .
 10804
 10805 0565-LIFE-PLAN-LIMIT-EDITS.
 10806
 10807     IF NOT LF-PLAN-MASTER-FOUND
 10808        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10809                                    EC-AM-LF-MAX-TOT-BEN
 10810        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10811
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 198
* EL050.cbl
 10812     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10813
 10814     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10815         IF PL-LM-AGE (1) = ZEROS
 10816             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10817
 10818     IF NO-LF-BENEFIT-MATCH          OR
 10819        WS-LF-BENEFIT-CD = ZEROS     OR
 10820        WS-LF-SPECIAL-CALC-CD = 'M'
 10821        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10822
 10823     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10824     MOVE +1                     TO SUB2.
 10825
 10826     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10827        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10828           MOVE +5   TO SUB2
 10829           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10830              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10831              (PL-LM-AGE (SUB2) EQUAL +0)
 10832              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10833              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10834
 10835     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10836
 10837     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10838                               + PB-I-LF-ALT-BENEFIT-AMT.
 10839
 10840 0568-CHECK-LIFE-ATT-AGE.
 10841
 10842     IF PL-ATT-AGE NUMERIC AND
 10843        PL-ATT-AGE > +0
 10844        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10845     END-IF
 10846*    IF PL-ATT-AGE NUMERIC AND
 10847*       PL-ATT-AGE > +0
 10848*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10849*       IF PB-I-BIRTHDAY > LOW-VALUES
 10850*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10851*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10852*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10853*          SET BIN-PLUS-ELAPSED  TO TRUE
 10854*          PERFORM 8500-DATE-CONVERT
 10855*                                THRU 8500-EXIT
 10856*          IF NO-CONVERSION-ERROR
 10857*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10858*             MOVE ER-2669       TO WS-ERROR
 10859*             PERFORM 9900-ERROR-FORMAT
 10860*                                THRU 9900-EXIT
 10861*          END-IF
 10862*       ELSE
 10863*          IF WS-ATT-AGE >= PL-ATT-AGE
 10864*             MOVE ER-2669       TO WS-ERROR
 10865*             PERFORM 9900-ERROR-FORMAT
 10866*                                THRU 9900-EXIT
 10867*          END-IF
 10868*       END-IF
 10869*    END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 199
* EL050.cbl
 10870     .
 10871 0570-CHECK-LIFE-LIMITS.
 10872
 10873     IF PB-COMPANY-ID EQUAL 'CRI'
 10874        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10875           IF SUB2 GREATER THAN +4
 10876              MOVE ER-2637 TO WS-ERROR
 10877              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10878              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10879
 10880     IF PB-COMPANY-ID  =  'NCL'
 10881        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10882            SUB2 GREATER THAN +8
 10883             MOVE 'U'         TO PB-BATCH-ENTRY
 10884             MOVE ER-2637     TO WS-ERROR
 10885             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10886             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10887
 10888     IF SUB2 > +8
 10889        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10890           AND (PB-I-SIG-SW = 'Y')
 10891           CONTINUE
 10892        ELSE
 10893           MOVE ER-2637          TO WS-ERROR
 10894           PERFORM 9900-ERROR-FORMAT
 10895                                 THRU 9900-EXIT
 10896        END-IF
 10897        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10898     END-IF
 10899     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10900     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10901     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10902
 10903     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10904        ADD +1  TO SUB2
 10905        GO TO 0570-CHECK-LIFE-LIMITS.
 10906
 10907     IF PB-COMPANY-ID = 'NCL'
 10908         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10909
 10910     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10911        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10912        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10913           AND (PB-I-SIG-SW = 'Y')
 10914           CONTINUE
 10915        ELSE
 10916           MOVE ER-2637          TO WS-ERROR
 10917           PERFORM 9900-ERROR-FORMAT
 10918                                 THRU 9900-EXIT
 10919        END-IF
 10920     END-IF
 10921     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10922
 10923
 10924 0570-CHECK-NCL-LIFE-LIMITS.
 10925
 10926     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10927        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 200
* EL050.cbl
 10928         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10929
 10930     IF APP-CERT-USED
 10931         IF SUB2  LESS THAN  +5
 10932             MOVE +5          TO SUB2
 10933             GO TO 0570-CHECK-LIFE-LIMITS.
 10934
 10935     MOVE ER-2637             TO WS-ERROR.
 10936     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10937
 10938     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10939
 10940 0575-CHECK-NCL-SIG-SWITCH.
 10941
 10942     IF NOT APP-CERT-USED
 10943         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10944
 10945     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10946        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10947        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10948        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10949         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10950
 10951     IF SUB2 GREATER THAN +4
 10952         IF PL-LM-AGE (5) = ZEROS  AND
 10953            PL-LM-AGE (6) = ZEROS  AND
 10954            PL-LM-AGE (7) = ZEROS  AND
 10955            PL-LM-AGE (8) = ZEROS
 10956             MOVE  ER-1927        TO WS-ERROR
 10957             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10958             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10959         ELSE
 10960             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10961                 MOVE  ER-1920    TO WS-ERROR
 10962                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10963
 10964     IF PB-I-SIG-SW  = 'Y'
 10965       IF NOT PB-I-POLICY-ACCEPTED  AND
 10966          NOT PB-I-POLICY-DECLINED
 10967           MOVE 'U'               TO PB-BATCH-ENTRY
 10968           MOVE  ER-1926          TO WS-ERROR
 10969           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10970
 10971
 10972 0580-AH-PLAN-LIMIT-EDITS.
 10973
 10974     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10975        IF PB-I-AH-BENEFIT-AMT > +1250
 10976           MOVE ER-2702          TO WS-ERROR
 10977           PERFORM 9900-ERROR-FORMAT
 10978                                 THRU 9900-EXIT
 10979        END-IF
 10980     END-IF
 10981
 10982     IF (PB-COMPANY-ID = 'DCC')
 10983        AND (PB-MONTHLY-CERT)
 10984        IF PB-I-AH-BENEFIT-AMT > +3000
 10985           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 201
* EL050.cbl
 10986           PERFORM 9900-ERROR-FORMAT
 10987                                 THRU 9900-EXIT
 10988        END-IF
 10989     END-IF
 10990     IF NOT AH-PLAN-MASTER-FOUND
 10991        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10992        GO TO 3000-CONTINUE-EDIT.
 10993
 10994     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10995
 10996     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10997         IF PL-LM-AGE (1) = ZEROS
 10998             GO TO 3000-CONTINUE-EDIT.
 10999
 11000     IF NO-AH-BENEFIT-MATCH          OR
 11001        WS-AH-BENEFIT-CD = ZEROS     OR
 11002        WS-AH-SPECIAL-CALC-CD = 'M'
 11003        GO TO 3000-CONTINUE-EDIT.
 11004
 11005     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11006     MOVE +1                     TO SUB2.
 11007
 11008     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11009        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11010           MOVE +5 TO SUB2
 11011           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11012              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11013              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11014              (PL-LM-AGE (SUB2) EQUAL +0)
 11015              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11016              GO TO 3000-CONTINUE-EDIT.
 11017
 11018     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11019
 11020 0590-CHECK-AH-ATT-AGE.
 11021
 11022     IF PL-ATT-AGE NUMERIC AND
 11023        PL-ATT-AGE GREATER THAN +0
 11024        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11025     END-IF
 11026*       IF WS-ATT-AGE >= PL-ATT-AGE
 11027*          MOVE ER-3054          TO WS-ERROR
 11028*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11029     .
 11030 0597-CHECK-AH-LIMITS.
 11031
 11032     IF PB-COMPANY-ID EQUAL 'CRI'
 11033        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11034           IF SUB2 GREATER THAN +4
 11035              MOVE ER-2638       TO WS-ERROR
 11036              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11037              GO TO 3000-CONTINUE-EDIT.
 11038
 11039     IF PB-COMPANY-ID  =  'NCL'
 11040        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11041            SUB2 GREATER THAN +8
 11042             MOVE 'U'            TO PB-BATCH-ENTRY
 11043             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 202
* EL050.cbl
 11044             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11045             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11046
 11047     IF SUB2 > +8
 11048        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11049           AND (PB-I-SIG-SW = 'Y')
 11050           CONTINUE
 11051        ELSE
 11052           MOVE ER-2638          TO WS-ERROR
 11053           PERFORM 9900-ERROR-FORMAT
 11054                                 THRU 9900-EXIT
 11055        END-IF
 11056        GO TO 3000-CONTINUE-EDIT
 11057     END-IF
 11058
 11059     IF PB-COMPANY-ID = 'CRI'
 11060        IF WS-ERROR = ER-2638
 11061           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11062
 11063     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11064     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11065     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11066     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11067
 11068     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11069        ADD +1                   TO SUB2
 11070        GO TO 0597-CHECK-AH-LIMITS.
 11071
 11072     IF PB-COMPANY-ID = 'NCL'
 11073         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11074
 11075     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11076        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11077        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11078                                 > PL-LM-AMT (SUB2))
 11079        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11080           AND (PB-I-SIG-SW = 'Y')
 11081           CONTINUE
 11082        ELSE
 11083           MOVE ER-2638          TO WS-ERROR
 11084           PERFORM 9900-ERROR-FORMAT
 11085                                 THRU 9900-EXIT
 11086        END-IF
 11087     END-IF
 11088
 11089     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11090         IF  WS-ERROR    EQUAL    ER-2638
 11091             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11092                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11093                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11094                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11095                MOVE  ER-1910    TO  WS-ERROR
 11096                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11097
 11098     IF PB-COMPANY-ID = 'CRI'
 11099        IF WS-ERROR = ER-2638
 11100            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11101            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 203
* EL050.cbl
 11102            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11103
 11104     GO TO 3000-CONTINUE-EDIT.
 11105
 11106 0597-CHECK-NCL-AH-LIMITS.
 11107
 11108     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11109        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11110        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11111                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11112         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11113
 11114     IF APP-CERT-USED
 11115         IF SUB2  LESS THAN  +5
 11116             MOVE +5             TO SUB2
 11117             GO TO 0597-CHECK-AH-LIMITS.
 11118
 11119     MOVE ER-2638                TO WS-ERROR.
 11120     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11121
 11122     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11123
 11124 0599-CHECK-NCL-SIG-SWITCH.
 11125
 11126     IF NOT APP-CERT-USED
 11127         GO TO 3000-CONTINUE-EDIT.
 11128
 11129     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11130        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11131        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11132        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11133         GO TO 3000-CONTINUE-EDIT.
 11134
 11135     IF SUB2 GREATER THAN +4
 11136         IF PL-LM-AGE (5) = ZEROS  AND
 11137            PL-LM-AGE (6) = ZEROS  AND
 11138            PL-LM-AGE (7) = ZEROS  AND
 11139            PL-LM-AGE (8) = ZEROS
 11140             MOVE  ER-1927        TO WS-ERROR
 11141             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11142             GO TO 3000-CONTINUE-EDIT
 11143         ELSE
 11144             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11145                 MOVE  ER-1920    TO WS-ERROR
 11146                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11147
 11148     IF PB-I-SIG-SW  = 'Y'
 11149       IF NOT PB-I-POLICY-ACCEPTED  AND
 11150          NOT PB-I-POLICY-DECLINED
 11151           MOVE 'U'               TO PB-BATCH-ENTRY
 11152           MOVE  ER-1926          TO WS-ERROR
 11153           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11154
 11155******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 204
* EL050.cbl
 11157
 11158 3000-CONTINUE-EDIT.
 11159
 11160     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11161     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11162     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11163     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11164     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11165
 11166     IF BROWSE-STARTED
 11167        PERFORM 9990-RETURN THRU 9990-EXIT
 11168        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11169
 11170     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11171        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11172        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11173        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11174*       MOVE 1                   TO DC-OPTION-CODE
 11175        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11176        IF DATE-CONVERSION-ERROR
 11177           MOVE ER-2622          TO WS-ERROR
 11178           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11179        ELSE
 11180           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11181              MOVE ER-2623       TO WS-ERROR
 11182              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11183           ELSE
 11184              MOVE ER-2622       TO WS-ERROR
 11185              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11186
 11187     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11188     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11189     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11190*    MOVE 1                      TO DC-OPTION-CODE.
 11191     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11192     IF DATE-CONVERSION-ERROR
 11193        GO TO 3005-EDIT-CONTINUE
 11194     ELSE
 11195        IF DC-ELAPSED-DAYS GREATER +180
 11196           MOVE ER-2613          TO WS-ERROR
 11197           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11198        ELSE
 11199           IF DC-ELAPSED-DAYS GREATER +90
 11200              MOVE ER-2612       TO WS-ERROR
 11201              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11202           ELSE
 11203             IF DC-ELAPSED-DAYS GREATER +60
 11204                MOVE ER-2614     TO WS-ERROR
 11205                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11206
 11207 3005-EDIT-CONTINUE.
 11208
 11209     IF PB-CANCELLATION
 11210         GO TO 3700-EDIT-CANCEL.
 11211
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 205
* EL050.cbl
 11213******************************************************************
 11214*                  E D I T   I S S U E                           *
 11215******************************************************************
 11216
 11217 3020-EDIT-ISSUE.
 11218
 11219      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11220      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11221      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11222      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11223      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11224
 11225     IF PB-ISSUE-FORCE
 11226        OR PB-ISSUE-DATE-FORCED
 11227        OR PB-FORCE-OFF
 11228        OR PB-OVERCHARGE-FORCE
 11229        CONTINUE
 11230     ELSE
 11231        MOVE ER-2670             TO WS-ERROR
 11232        PERFORM 9900-ERROR-FORMAT
 11233                                 THRU 9900-EXIT
 11234     END-IF
 11235     .
 11236 3022-SET-POLICY-STATUS.
 11237
 11238     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11239
 11240     IF (PB-REISSUED-CERT)
 11241             OR
 11242        ((PB-COMPANY-ID NOT = 'DCC')
 11243         AND (PB-MONTHLY-CERT))
 11244         MOVE '5'                TO PB-I-ENTRY-STATUS
 11245         MOVE 'E'                TO PB-BATCH-ENTRY
 11246     END-IF
 11247
 11248     IF PB-COMPANY-ID = 'DCC'
 11249        IF PB-MONTHLY-CERT
 11250           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11251        END-IF
 11252     END-IF
 11253     IF PB-POLICY-IS-DECLINED
 11254         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11255     IF PB-POLICY-IS-VOIDED
 11256         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11257     IF PB-NEEDS-UNDERWRITING
 11258         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11259     IF PB-REIN-ONLY-CERT
 11260         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11261     IF PB-PREM-ACCTNG-ONLY
 11262         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11263
 11264     MOVE SPACE                  TO PB-I-OB-FLAG.
 11265
 11266     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11267         MOVE ER-2665            TO WS-ERROR
 11268         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11269         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11270
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 206
* EL050.cbl
 11271     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11272        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11273           MOVE 'Z'             TO PB-I-OB-FLAG.
 11274
 11275     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11276        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11277           MOVE 'Z'             TO PB-I-OB-FLAG.
 11278
 11279     IF ACCOUNT-MAST-FOUND
 11280         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11281         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11282         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11283         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11284         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11285         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11286         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11287     END-IF
 11288
 11289     IF ACCOUNT-MAST-FOUND
 11290        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11291         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11292
 11293     IF (ACCOUNT-MAST-FOUND)
 11294        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11295        IF PB-REISSUED-CERT
 11296           CONTINUE
 11297        ELSE
 11298           MOVE ER-2608          TO WS-ERROR
 11299           PERFORM 9900-ERROR-FORMAT
 11300                                 THRU 9900-EXIT
 11301         END-IF
 11302     END-IF
 11303
 11304     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11305        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11306        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11307
 11308**********   DMD CUSTOM CODE FOLLOWS  **********
 11309 3024-EDIT-DMD-FIELDS.
 11310     IF PB-COMPANY-ID NOT = 'DMD'
 11311        GO TO 3025-EDIT-REINSURANCE.
 11312
 11313*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11314*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11315*** ERROR IF THEY ARE NOT EQUAL.
 11316
 11317     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11318     SET BIN-TO-GREG               TO TRUE.
 11319     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11320     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11321**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11322
 11323     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11324     SET BIN-TO-GREG               TO TRUE.
 11325     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11326     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11327**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11328
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 207
* EL050.cbl
 11329     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11330        MOVE ER-8116               TO WS-ERROR
 11331        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11332
 11333     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11334
 11335     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11336                                      WK-FULL-CERT-NO.
 11337     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11338
 11339     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11340
 11341     IF PB-VALID-LIFE
 11342        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11343     ELSE
 11344        IF PB-VALID-AH
 11345          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11346
 11347
 11348     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11349     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11350     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11351                                      DCUA-UNDRWRTR-CODE
 11352                                      DCUA-UNDRWRTR-GROUP-CODE
 11353                                      DCUA-RETURN-CODE.
 11354
 11355****************************************************************
 11356*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11357***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11358***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11359***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11360***   TO THIS RECORD.                                        ***
 11361****************************************************************
 11362     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11363     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11364     IF DCUA-SUCCESSFUL-PROCESS
 11365        GO TO 3024-EDIT-DL7-CONT.
 11366
 11367     IF DCUA-RETURN-CODE EQUAL '01'
 11368        MOVE ER-8110               TO WS-ERROR
 11369        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11370        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11371        GO TO 3024-EDIT-DL7-CONT.
 11372
 11373     IF DCUA-RETURN-CODE EQUAL '02'
 11374        MOVE ER-8111               TO WS-ERROR
 11375        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11377        GO TO 3024-EDIT-DL7-CONT.
 11378
 11379     IF DCUA-RETURN-CODE EQUAL '03'
 11380        MOVE ER-8074               TO WS-ERROR
 11381        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11382        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11383        GO TO 3024-EDIT-DL7-CONT.
 11384
 11385     IF DCUA-RETURN-CODE EQUAL '04'
 11386        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 208
* EL050.cbl
 11387        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11389        GO TO 3024-EDIT-DL7-CONT.
 11390
 11391     IF DCUA-RETURN-CODE EQUAL '05'
 11392        MOVE ER-8076               TO WS-ERROR
 11393        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11394        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11395        GO TO 3024-EDIT-DL7-CONT.
 11396
 11397     IF DCUA-RETURN-CODE EQUAL '06'
 11398        MOVE ER-8077               TO WS-ERROR
 11399        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11400        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11401        GO TO 3024-EDIT-DL7-CONT.
 11402
 11403     IF DCUA-RETURN-CODE EQUAL '07'
 11404        MOVE ER-8078               TO WS-ERROR
 11405        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11406        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11407        GO TO 3024-EDIT-DL7-CONT.
 11408
 11409     IF DCUA-RETURN-CODE EQUAL 'E1'
 11410        MOVE ER-8079               TO WS-ERROR
 11411        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11413        GO TO 3024-EDIT-DL7-CONT.
 11414
 11415     IF DCUA-RETURN-CODE EQUAL 'E2'
 11416        MOVE ER-8080               TO WS-ERROR
 11417        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11418        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11419        GO TO 3024-EDIT-DL7-CONT.
 11420
 11421     IF DCUA-RETURN-CODE EQUAL 'E3'
 11422        MOVE ER-8098               TO WS-ERROR
 11423        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11424        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11425        GO TO 3024-EDIT-DL7-CONT.
 11426
 11427     IF DCUA-RETURN-CODE EQUAL 'C1'
 11428        MOVE ER-8099               TO WS-ERROR
 11429        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11430        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11431        GO TO 3024-EDIT-DL7-CONT.
 11432
 11433     IF DCUA-RETURN-CODE EQUAL 'U1'
 11434        MOVE ER-8109               TO WS-ERROR
 11435        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11436        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11437        GO TO 3024-EDIT-DL7-CONT.
 11438
 11439     IF DCUA-RETURN-CODE EQUAL 'N1'
 11440        MOVE ER-8112               TO WS-ERROR
 11441        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11442        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11443        GO TO 3024-EDIT-DL7-CONT.
 11444
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 209
* EL050.cbl
 11445     IF DCUA-RETURN-CODE EQUAL 'N2'
 11446        MOVE ER-8113               TO WS-ERROR
 11447        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11449        GO TO 3024-EDIT-DL7-CONT.
 11450
 11451     IF DCUA-RETURN-CODE EQUAL 'N3'
 11452        MOVE ER-8114               TO WS-ERROR
 11453        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11455        GO TO 3024-EDIT-DL7-CONT.
 11456
 11457     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11458     MOVE ER-8097                  TO WS-ERROR.
 11459     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11460     GO TO 3024-EDIT-DL7-CONT.
 11461
 11462 3024-EDIT-DL7-CONT.
 11463
 11464     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11465     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11466     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11467        NEXT SENTENCE
 11468     ELSE
 11469        MOVE ER-9263               TO WS-ERROR
 11470        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11471
 11472******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11473******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11474     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11475        NEXT SENTENCE
 11476     ELSE
 11477        MOVE ER-8039               TO WS-ERROR
 11478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11479
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 210
* EL050.cbl
 11481****************************************************************
 11482*** VALIDATE STATE  : DLO022                                 ***
 11483****************************************************************
 11484     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11485     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11486
 11487     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11488     IF DVSC-SUCCESSFUL-EDIT
 11489        GO TO 3024-EDIT-DL22-CONT.
 11490
 11491     IF DVSC-RETURN-CODE EQUAL '01'
 11492        MOVE ER-8300               TO WS-ERROR
 11493        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11494        GO TO 3024-EDIT-DL22-CONT.
 11495
 11496     IF DVSC-RETURN-CODE EQUAL '02'
 11497        MOVE ER-8301               TO WS-ERROR
 11498        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11499        GO TO 3024-EDIT-DL22-CONT.
 11500
 11501     IF DVSC-RETURN-CODE EQUAL '03'
 11502        MOVE ER-8302               TO WS-ERROR
 11503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11504        GO TO 3024-EDIT-DL22-CONT.
 11505
 11506     IF DVSC-RETURN-CODE EQUAL 'N1'
 11507        MOVE ER-8304               TO WS-ERROR
 11508        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11509        GO TO 3024-EDIT-DL22-CONT.
 11510
 11511     MOVE ER-8303                  TO WS-ERROR
 11512     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11513
 11514 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 211
* EL050.cbl
 11516****************************************************************
 11517*** VALIDATE LOAN OFFICER : DLO021                           ***
 11518****************************************************************
 11519
 11520     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11521     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11522     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11523     IF DVLO-SUCCESSFUL-EDIT
 11524        GO TO 3024-EDIT-DL21-CONT.
 11525
 11526     IF DVLO-RETURN-CODE EQUAL '01'
 11527        MOVE ER-8081               TO WS-ERROR
 11528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11529        GO TO 3024-EDIT-DL21-CONT.
 11530
 11531     IF DVLO-RETURN-CODE EQUAL '02'
 11532        MOVE ER-8082               TO WS-ERROR
 11533        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11534        GO TO 3024-EDIT-DL21-CONT.
 11535
 11536     IF DVLO-RETURN-CODE EQUAL '03'
 11537        MOVE ER-8083               TO WS-ERROR
 11538        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11539        GO TO 3024-EDIT-DL21-CONT.
 11540
 11541     IF DVLO-RETURN-CODE EQUAL '04'
 11542        MOVE ER-8084               TO WS-ERROR
 11543        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11544        GO TO 3024-EDIT-DL21-CONT.
 11545
 11546     IF DVLO-RETURN-CODE EQUAL '05'
 11547        MOVE ER-8085               TO WS-ERROR
 11548        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11549        GO TO 3024-EDIT-DL21-CONT.
 11550
 11551     MOVE ER-7825                  TO WS-ERROR
 11552     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11553     GO TO 3024-EDIT-DL21-CONT.
 11554
 11555 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 212
* EL050.cbl
 11557
 11558****************************************************************
 11559*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11560****************************************************************
 11561
 11562     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11563     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11564     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11565     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11566     IF DIPF-SUCCESSFUL-EDIT
 11567        GO TO 3024-EDIT-DL02-CONT.
 11568
 11569     IF DIPF-RETURN-CODE EQUAL '01'
 11570        MOVE ER-8086               TO WS-ERROR
 11571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11572        GO TO 3024-EDIT-DL02-CONT.
 11573
 11574     IF DIPF-RETURN-CODE EQUAL '02'
 11575        MOVE ER-8087               TO WS-ERROR
 11576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11577        GO TO 3024-EDIT-DL02-CONT.
 11578
 11579     IF DIPF-RETURN-CODE EQUAL '03'
 11580        MOVE ER-8088               TO WS-ERROR
 11581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11582        GO TO 3024-EDIT-DL02-CONT.
 11583
 11584     MOVE ER-8095                  TO WS-ERROR
 11585     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11586     GO TO 3024-EDIT-DL02-CONT.
 11587
 11588 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 213
* EL050.cbl
 11590
 11591****************************************************************
 11592*** VALIDATE BANK ID : DLO003                                ***
 11593****************************************************************
 11594
 11595     MOVE WK-GREG-CENT           TO WCG-CENT.
 11596     MOVE WK-GREG-YYMM           TO WCG-REST.
 11597     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11598        MOVE ER-8040               TO WS-ERROR
 11599        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11600
 11601     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11602     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11603     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11604     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11605     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11606     IF DVBI-SUCCESSFUL-EDIT
 11607        GO TO 3024-EDIT-DL03-CONT.
 11608
 11609     IF DVBI-RETURN-CODE EQUAL '01'
 11610        MOVE ER-8089               TO WS-ERROR
 11611        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11612        GO TO 3024-EDIT-DL03-CONT.
 11613
 11614     IF DVBI-RETURN-CODE EQUAL '02'
 11615        MOVE ER-8090               TO WS-ERROR
 11616        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11617        GO TO 3024-EDIT-DL03-CONT.
 11618
 11619     IF DVBI-RETURN-CODE EQUAL '03'
 11620        MOVE ER-8091               TO WS-ERROR
 11621        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11622        GO TO 3024-EDIT-DL03-CONT.
 11623
 11624     IF DVBI-RETURN-CODE EQUAL '04'
 11625        MOVE ER-8092               TO WS-ERROR
 11626        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11627        GO TO 3024-EDIT-DL03-CONT.
 11628
 11629     IF DVBI-RETURN-CODE EQUAL '05'
 11630        MOVE ER-8093               TO WS-ERROR
 11631        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11632        GO TO 3024-EDIT-DL03-CONT.
 11633
 11634     IF DVBI-RETURN-CODE EQUAL '06'
 11635        MOVE ER-8094               TO WS-ERROR
 11636        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11637        GO TO 3024-EDIT-DL03-CONT.
 11638
 11639     MOVE ER-8096                  TO WS-ERROR
 11640     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11641     GO TO 3024-EDIT-DL03-CONT.
 11642
 11643 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 214
* EL050.cbl
 11645
 11646     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11647        NEXT SENTENCE
 11648     ELSE
 11649        MOVE ER-8042               TO WS-ERROR
 11650        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11651
 11652     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11653     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11654     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11655
 11656     IF DMPF-RETURN-CODE = '01'
 11657        MOVE ER-8067               TO WS-ERROR
 11658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11659        GO TO 3024-EDIT-DL01-CONT.
 11660
 11661     IF DMPF-RETURN-CODE = '02'
 11662        MOVE ER-8068               TO WS-ERROR
 11663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11664        GO TO 3024-EDIT-DL01-CONT.
 11665
 11666     IF DMPF-RETURN-CODE = '03'
 11667        MOVE ER-8069               TO WS-ERROR
 11668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11669        GO TO 3024-EDIT-DL01-CONT.
 11670
 11671     IF DMPF-RETURN-CODE = 'E1'
 11672        MOVE ER-8070               TO WS-ERROR
 11673        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11674        GO TO 3024-EDIT-DL01-CONT.
 11675
 11676     IF DMPF-RETURN-CODE = 'N1'
 11677        MOVE ER-8071               TO WS-ERROR
 11678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11679        GO TO 3024-EDIT-DL01-CONT.
 11680
 11681     IF DMPF-RETURN-CODE NOT = 'OK'
 11682        MOVE ER-8072               TO WS-ERROR
 11683        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11684
 11685 3024-EDIT-DL01-CONT.
 11686******************************************************************
 11687***  VALIDATES RATE CODES : DLO017                             ***
 11688******************************************************************
 11689
 11690      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11691      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11692      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11693      IF DVRC-SUCCESSFUL-EDIT
 11694        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11695        GO TO 3024-CHECK-VALID-RATE.
 11696
 11697      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11698
 11699      IF DVRC-RETURN-CODE EQUAL '01'
 11700         MOVE ER-7817                   TO WS-ERROR
 11701         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11702         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 215
* EL050.cbl
 11703
 11704      IF DVRC-RETURN-CODE EQUAL '02'
 11705         MOVE ER-7818                   TO WS-ERROR
 11706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11707         GO TO 3025-EDIT-REINSURANCE.
 11708
 11709      IF DVRC-RETURN-CODE EQUAL '03'
 11710         MOVE ER-7819                   TO WS-ERROR
 11711         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11712         GO TO 3025-EDIT-REINSURANCE.
 11713
 11714       MOVE ER-7820                     TO WS-ERROR.
 11715       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11716       GO TO 3025-EDIT-REINSURANCE.
 11717
 11718******************************************************************
 11719***  GET PREMIUM RATES : DLO011                                ***
 11720******************************************************************
 11721
 11722 3024-CHECK-VALID-RATE.
 11723
 11724     IF VALID-RATE-CODE
 11725        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11726        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11727        MOVE SPACES                TO DPRB-RETURN-CODE
 11728        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11729     ELSE
 11730         GO TO 3025-EDIT-REINSURANCE.
 11731
 11732      IF DPRB-SUCCESSFUL-PROCESS
 11733         IF PB-VALID-LIFE
 11734             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11735             GO TO 3025-EDIT-REINSURANCE
 11736         ELSE
 11737             IF PB-VALID-AH
 11738                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11739                 GO TO 3025-EDIT-REINSURANCE.
 11740
 11741      IF DPRB-RETURN-CODE EQUAL '01'
 11742         MOVE ER-7812                   TO WS-ERROR
 11743         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11744         GO TO 3025-EDIT-REINSURANCE.
 11745
 11746      IF DPRB-RETURN-CODE EQUAL '02'
 11747         MOVE ER-7813                   TO WS-ERROR
 11748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11749         GO TO 3025-EDIT-REINSURANCE.
 11750
 11751      IF DPRB-RETURN-CODE EQUAL '03'
 11752         MOVE ER-7814                   TO WS-ERROR
 11753         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11754         GO TO 3025-EDIT-REINSURANCE.
 11755
 11756      IF DPRB-RETURN-CODE EQUAL '04'
 11757         IF NOT DPRB-1ST-TIME
 11758            MOVE ER-7815                   TO WS-ERROR
 11759            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11760            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 216
* EL050.cbl
 11761          ELSE
 11762         IF PB-VALID-LIFE
 11763            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11764          ELSE
 11765            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11766         END-IF
 11767         MOVE SPACES                TO DOCC-RETURN-CODE
 11768         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11769         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11770         IF DOCC-RETURN-CODE = 'OK'
 11771             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11772             GO TO 3024-CHECK-VALID-RATE
 11773           ELSE
 11774             MOVE ER-7823               TO WS-ERROR
 11775             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11776             GO TO 3025-EDIT-REINSURANCE.
 11777
 11778       MOVE ER-7816                     TO WS-ERROR.
 11779       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11780       GO TO 3025-EDIT-REINSURANCE.
 11781
 11782**********   DMD CUSTOM CODE ABOVE    **********
 11783
 11784 3025-EDIT-REINSURANCE.
 11785     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11786         GO TO 3027-EDIT-CONTINUE.
 11787
 11788     MOVE LOW-VALUES               TO ERREIN-KEY.
 11789     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11790     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11791                                      REIN-CODE-2
 11792                                      REIN-CODE-3.
 11793     MOVE 'A'                      TO REIN-TYPE.
 11794
 11795     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11796
 11797     MOVE '3026' TO REIN-SW.
 11798     MOVE ' '                   TO WS-REIN-READ-SW.
 11799
 11800     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11801     IF REIN-TABLE-NOT-FOUND
 11802         GO TO 3026-NO-SPEC-TABLE.
 11803
 11804     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11805     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11806                                   WS-NSP-ST-CD-LF.
 11807     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11808                                   WS-NSP-ST-CD-AH.
 11809
 11810     GO TO 3040-EDIT-CONTINUE.
 11811
 11812 3026-NO-SPEC-TABLE.
 11813
 11814     MOVE ER-2664                TO WS-ERROR.
 11815     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11816     GO TO 3040-EDIT-CONTINUE.
 11817
 11818 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 217
* EL050.cbl
 11819
 11820     IF PB-I-REIN-TABLE = SPACES
 11821       GO TO 3040-EDIT-CONTINUE.
 11822
 11823     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11824          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11825          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11826           GO TO 3040-EDIT-CONTINUE.
 11827
 11828     MOVE LOW-VALUES            TO ERREIN-KEY.
 11829     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11830     MOVE 'A'                   TO REIN-TYPE.
 11831     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11832
 11833     MOVE '3028'                TO REIN-SW.
 11834     MOVE ' '                   TO WS-REIN-READ-SW.
 11835
 11836     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11837     IF REIN-TABLE-NOT-FOUND
 11838         GO TO 3028-NO-REIN-TABLE.
 11839
 11840     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11841     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11842                                   WS-NSP-ST-CD-LF.
 11843     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11844                                   WS-NSP-ST-CD-AH.
 11845
 11846     GO TO 3040-EDIT-CONTINUE.
 11847
 11848 3028-NO-REIN-TABLE.
 11849
 11850     MOVE ER-2615                TO WS-ERROR.
 11851     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11852     GO TO 3040-EDIT-CONTINUE.
 11853
 11854 3040-EDIT-CONTINUE.
 11855
 11856     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11857         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11858
 11859     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11860         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11861
 11862     IF (NOT PB-REISSUED-CERT)
 11863        AND (NOT PB-MONTHLY-CERT)
 11864        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11865            MOVE '001'           TO PB-I-LF-TERM
 11866            MOVE 'M'             TO PB-I-INSURED-SEX.
 11867
 11868     IF (NOT PB-REISSUED-CERT)
 11869        AND (NOT PB-MONTHLY-CERT)
 11870        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11871            MOVE '001'           TO PB-I-AH-TERM
 11872            MOVE 'M'             TO PB-I-INSURED-SEX.
 11873
 11874 3040-EDIT-1ST-PMT-DT.
 11875     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11876     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 218
* EL050.cbl
 11877         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11878
 11879******************************************************************
 11880*                                                                *
 11881*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11882*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11883*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11884*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11885*                                                                *
 11886******************************************************************
 11887
 11888     IF PB-EFF-DT-PROCESSING
 11889        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11890                                    PB-I-LF-EXPIRE-DT
 11891                                    PB-I-AH-EXPIRE-DT
 11892        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11893        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11894        MOVE ZERO                TO DC-ELAPSED-DAYS
 11895        MOVE +1                  TO DC-ELAPSED-MONTHS
 11896        SET BIN-PLUS-ELAPSED     TO TRUE
 11897*       MOVE 6                   TO DC-OPTION-CODE
 11898        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11899        IF NO-CONVERSION-ERROR
 11900           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11901
 11902******************************************************************
 11903*                                                                *
 11904*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11905*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11906*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11907*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11908*                                                                *
 11909******************************************************************
 11910
 11911     IF PB-EXT-DAYS-PROCESSING
 11912          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11913                                         PB-I-LF-EXPIRE-DT
 11914                                         PB-I-AH-EXPIRE-DT
 11915          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11916          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11917          MOVE +1                     TO DC-ELAPSED-MONTHS
 11918          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11919          SET BIN-PLUS-ELAPSED        TO TRUE
 11920*         MOVE 6                      TO DC-OPTION-CODE
 11921          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11922          IF NO-CONVERSION-ERROR
 11923             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11924
 11925******************************************************************
 11926*                                                                *
 11927*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11928*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11929*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11930*        (EXPIRE DATE - (TERM -1))  *  -1.
 11931*                                                                *
 11932******************************************************************
 11933
 11934     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 219
* EL050.cbl
 11935        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11936           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11937              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11938              MOVE PB-I-AH-TERM      TO WS-TERM
 11939           ELSE
 11940              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11941              MOVE PB-I-LF-TERM      TO WS-TERM
 11942        ELSE
 11943           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11944              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11945              MOVE PB-I-LF-TERM      TO WS-TERM
 11946           ELSE
 11947              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11948              MOVE PB-I-AH-TERM      TO WS-TERM.
 11949
 11950     IF PB-EXPIRE-DT-PROCESSING
 11951        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11952        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11953        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11954        MOVE ZERO                TO DC-ELAPSED-DAYS
 11955                                    DC-ODD-DAYS-OVER
 11956          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11957          SET BIN-PLUS-ELAPSED    TO TRUE
 11958*         MOVE 6                  TO DC-OPTION-CODE
 11959          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11960          IF NO-CONVERSION-ERROR
 11961             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11962
 11963******************************************************************
 11964*                                                                *
 11965*            1ST PAYMENT DATE PROCESSING                         *
 11966*                                                                *
 11967******************************************************************
 11968
 11969     IF PB-1ST-PMT-DT-PROCESSING
 11970        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11971                                    PB-I-AH-EXPIRE-DT
 11972        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11973
 11974     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11975         NEXT SENTENCE
 11976     ELSE
 11977         MOVE ER-2680                 TO WS-ERROR
 11978         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11979         GO TO 3060-ORIG-TERM-CHECK.
 11980
 11981     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11982     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11983     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11984*    MOVE 1                      TO DC-OPTION-CODE.
 11985     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11986                                    DC-ELAPSED-DAYS
 11987                                    DC-ODD-DAYS-OVER.
 11988
 11989     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11990
 11991     IF DATE-CONVERSION-ERROR
 11992        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 220
* EL050.cbl
 11993
 11994     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11995     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11996        AND (WS-LF-COVERAGE-TYPE = 'L')
 11997        IF (DC-ELAPSED-MONTHS > 1)
 11998                      OR
 11999           ((DC-ELAPSED-MONTHS = 1)
 12000           AND (DC-ODD-DAYS-OVER > 0))
 12001           MOVE ER-2882          TO WS-ERROR
 12002           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12003        END-IF
 12004     END-IF
 12005     if dc-elapsed-months > 0
 12006        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12007        + dc-odd-days-over
 12008     end-if
 12009     IF PB-EXT-DAYS-PROCESSING
 12010        CONTINUE
 12011     ELSE
 12012        IF DC-ELAPSED-MONTHS = +0
 12013           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12014        ELSE
 12015           IF (WS-LF-EARNINGS-CALC = '4')
 12016              AND (DC-ELAPSED-MONTHS > ZERO)
 12017              AND (DC-ELAPSED-DAYS > ZERO)
 12018              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12019           ELSE
 12020              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12021                                 THRU 6499-EXIT
 12022              MOVE WS-ODD-DAYS-OVER
 12023                                 TO PB-I-EXTENTION-DAYS
 12024           END-IF
 12025        END-IF
 12026     END-IF
 12027******************************************************************
 12028*                                                                *
 12029*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12030*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12031*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12032*            AND ANY ODD DAYS.                                   *
 12033*                                                                *
 12034******************************************************************
 12035
 12036     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12037                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12038     IF WS-LF-EARNINGS-CALC NOT = '4'
 12039        IF DC-ELAPSED-DAYS > ZEROS
 12040           MOVE ER-2681          TO WS-ERROR
 12041           PERFORM 9900-ERROR-FORMAT
 12042                                 THRU 9900-EXIT
 12043        END-IF
 12044     END-IF
 12045
 12046     IF WS-LF-EARNINGS-CALC NOT = '4'
 12047        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12048           MOVE ER-2681          TO WS-ERROR
 12049           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12050
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 221
* EL050.cbl
 12051     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12052        (PB-I-LF-TERM NOT = ZERO) AND
 12053         NOT NO-LIFE-COVERAGE
 12054          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12055          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12056          IF WS-LF-EARNINGS-CALC = '4'
 12057             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12058             PB-I-PAY-FREQUENCY
 12059          END-IF
 12060          MOVE ZERO              TO DC-ELAPSED-DAYS
 12061                                    DC-ODD-DAYS-OVER
 12062          MOVE 1                 TO DC-END-OF-MONTH
 12063          SET BIN-PLUS-ELAPSED        TO TRUE
 12064*         MOVE 6                 TO DC-OPTION-CODE
 12065          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12066          IF NO-CONVERSION-ERROR
 12067             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12068             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12069                (WS-LF-SPECIAL-CALC-CD = 'L')
 12070                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12071                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12072                  MOVE +1             TO DC-ELAPSED-MONTHS
 12073                  SET BIN-PLUS-ELAPSED  TO TRUE
 12074*                 MOVE 6              TO DC-OPTION-CODE
 12075                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12076                  IF NO-CONVERSION-ERROR
 12077                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12078
 12079* okay, i had to move the new att age edit down here because the
 12080* expiration date could get recalculated and i need the exp date
 12081     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12082        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12083        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12084        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12085           AND ZEROS
 12086           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12087           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12088           SET ELAPSED-BETWEEN-BIN TO TRUE
 12089           PERFORM 8500-DATE-CONVERT
 12090                                 THRU 8500-EXIT
 12091           IF NO-CONVERSION-ERROR
 12092              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12093                 MOVE ER-2669       TO WS-ERROR
 12094*                PERFORM 9900-ERROR-FORMAT
 12095*                                THRU 9900-EXIT
 12096              END-IF
 12097           END-IF
 12098        ELSE
 12099           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12100           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12101              MOVE ER-2669       TO WS-ERROR
 12102*             PERFORM 9900-ERROR-FORMAT
 12103*                                THRU 9900-EXIT
 12104           ELSE
 12105              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12106                 MOVE ER-1570    TO WS-ERROR
 12107                 PERFORM 9900-ERROR-FORMAT
 12108                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 222
* EL050.cbl
 12109              END-IF
 12110           END-IF
 12111        END-IF
 12112        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12113           AND ZEROS
 12114           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12115           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12116           SET ELAPSED-BETWEEN-BIN TO TRUE
 12117           PERFORM 8500-DATE-CONVERT
 12118                                 THRU 8500-EXIT
 12119           IF NO-CONVERSION-ERROR
 12120              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12121                 MOVE ER-2669       TO WS-ERROR
 12122*                PERFORM 9900-ERROR-FORMAT
 12123*                                THRU 9900-EXIT
 12124              END-IF
 12125           END-IF
 12126        ELSE
 12127           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12128             (PB-I-LF-TERM / 12)
 12129           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12130              MOVE ER-2669       TO WS-ERROR
 12131*             PERFORM 9900-ERROR-FORMAT
 12132*                                THRU 9900-EXIT
 12133           ELSE
 12134              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12135                 MOVE ER-1571    TO WS-ERROR
 12136                 PERFORM 9900-ERROR-FORMAT
 12137                                 THRU 9900-EXIT
 12138              END-IF
 12139           END-IF
 12140        END-IF
 12141        IF WS-ERROR = ER-2669
 12142           PERFORM 9900-ERROR-FORMAT
 12143                                 THRU 9900-EXIT
 12144        END-IF
 12145     END-IF
 12146     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12147        (PB-I-AH-TERM NOT = ZERO) AND
 12148         NOT NO-AH-COVERAGE
 12149          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12150             AND (PB-COMPANY-ID = 'DCC')
 12151             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12152             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12153          ELSE
 12154             IF WS-LF-EARNINGS-CALC = '4'
 12155                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12156                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12157                PB-I-PAY-FREQUENCY
 12158             ELSE
 12159                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12160                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12161             END-IF
 12162          END-IF
 12163          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12164                                         DC-ODD-DAYS-OVER
 12165          MOVE 1                      TO DC-END-OF-MONTH
 12166          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 223
* EL050.cbl
 12167*         MOVE 6                      TO DC-OPTION-CODE
 12168          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12169          IF NO-CONVERSION-ERROR
 12170             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12171     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12172        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12173        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12174        IF PB-I-BIRTHDAY > LOW-VALUES
 12175           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12176           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12177           SET ELAPSED-BETWEEN-BIN TO TRUE
 12178           PERFORM 8500-DATE-CONVERT
 12179                                 THRU 8500-EXIT
 12180           IF NO-CONVERSION-ERROR
 12181              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12182                 MOVE ER-3054       TO WS-ERROR
 12183*                PERFORM 9900-ERROR-FORMAT
 12184*                                THRU 9900-EXIT
 12185              END-IF
 12186           END-IF
 12187        ELSE
 12188           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12189           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12190              MOVE ER-3054       TO WS-ERROR
 12191*             PERFORM 9900-ERROR-FORMAT
 12192*                                THRU 9900-EXIT
 12193           END-IF
 12194        END-IF
 12195        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12196           AND ZEROS
 12197           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12198           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12199           SET ELAPSED-BETWEEN-BIN TO TRUE
 12200           PERFORM 8500-DATE-CONVERT
 12201                                 THRU 8500-EXIT
 12202           IF NO-CONVERSION-ERROR
 12203              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12204                 MOVE ER-3054       TO WS-ERROR
 12205*                PERFORM 9900-ERROR-FORMAT
 12206*                                THRU 9900-EXIT
 12207              END-IF
 12208           END-IF
 12209        ELSE
 12210           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12211             (PB-I-AH-TERM / 12)
 12212           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12213              MOVE ER-3054       TO WS-ERROR
 12214*             PERFORM 9900-ERROR-FORMAT
 12215*                                THRU 9900-EXIT
 12216           END-IF
 12217        END-IF
 12218        IF WS-ERROR = ER-3054
 12219           PERFORM 9900-ERROR-FORMAT
 12220                                 THRU 9900-EXIT
 12221        END-IF
 12222     END-IF
 12223     MOVE SPACE                       TO DC-END-OF-MONTH.
 12224
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 224
* EL050.cbl
 12225     IF PB-COMPANY-ID = 'NCB'
 12226        GO TO 3040-EDIT-EXTENSION-DAYS.
 12227
 12228     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12229       AND
 12230        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12231        NEXT SENTENCE
 12232     ELSE
 12233        GO TO 3040-EDIT-EXTENSION-DAYS.
 12234
 12235     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12236        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12237        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12238     ELSE
 12239        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12240        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12241
 12242     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12243*    MOVE '1'      TO DC-OPTION-CODE
 12244     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12245     IF (NO-CONVERSION-ERROR)
 12246        AND (DC-ELAPSED-MONTHS > +1)
 12247        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12248        MOVE ER-2668   TO WS-ERROR
 12249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12250
 12251 3040-EDIT-EXTENSION-DAYS.
 12252
 12253     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12254        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12255         GO TO 3050-EDIT-TERM-IN-DAYS
 12256     ELSE
 12257         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12258
 12259     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12260         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12261     ELSE
 12262        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12263           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12264           MOVE ER-2681         TO WS-ERROR
 12265           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12266
 12267     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12268        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12269        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12270         GO TO 3060-ORIG-TERM-CHECK.
 12271
 12272     GO TO 3060-ORIG-TERM-CHECK.
 12273
 12274 3050-EDIT-TERM-IN-DAYS.
 12275
 12276     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12277
 12278     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12279         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12280     ELSE
 12281         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12282            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 225
* EL050.cbl
 12283            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12284
 12285     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12286                                       REMAINDER WS-WORK-TERM.
 12287     IF WS-WORK-TERM GREATER THAN ZERO
 12288         ADD +1 TO PB-I-LF-TERM.
 12289
 12290     IF NOT NO-AH-COVERAGE
 12291         MOVE ER-2684            TO WS-ERROR
 12292         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12293
 12294
 12295 3060-ORIG-TERM-CHECK.
 12296
 12297******************************************************************
 12298*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12299******************************************************************
 12300
 12301     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12302        NEXT SENTENCE
 12303     ELSE
 12304        IF NOT NO-LIFE-COVERAGE
 12305           IF PB-I-LF-TERM NUMERIC
 12306              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12307              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12308              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12309                  NEXT SENTENCE
 12310           ELSE
 12311              MOVE ER-2647       TO WS-ERROR
 12312              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12313
 12314     IF NOT NO-AH-COVERAGE
 12315         IF PB-I-AH-TERM NUMERIC
 12316            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12317            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12318            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12319             NEXT SENTENCE
 12320          ELSE
 12321              MOVE ER-2658       TO WS-ERROR
 12322              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12323
 12324     IF PB-COMPANY-ID = 'NCB'
 12325        GO TO 3070-LOAN-TERM-CHECK.
 12326
 12327     IF POLICY-HAS-AH
 12328       AND
 12329        POLICY-HAS-LIFE
 12330       AND
 12331        PB-I-LF-TERM NUMERIC
 12332       AND
 12333        PB-I-AH-TERM NUMERIC
 12334        NEXT SENTENCE
 12335     ELSE
 12336        GO TO 3070-LOAN-TERM-CHECK.
 12337
 12338     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12339     IF WS-TEX-FACT-2 LESS THAN +0
 12340        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 226
* EL050.cbl
 12341
 12342     IF WS-TEX-FACT-2 GREATER THAN +1
 12343        MOVE ER-2668             TO WS-ERROR
 12344        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12345
 12346 3070-LOAN-TERM-CHECK.
 12347
 12348     IF (WS-LF-BENEFIT-CD = ZERO)
 12349         OR (NO-LF-BENEFIT-MATCH)
 12350            GO TO 3125-EDIT-PMT-FREQ.
 12351*    IF PB-COMPANY-ID NOT = 'DCC'
 12352*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12353*          AND 'V' AND 'W' AND 'X'
 12354*          GO TO 3125-EDIT-PMT-FREQ
 12355*       END-IF
 12356*    ELSE
 12357*       IF WS-AH-DCC-TRUNC = 'T'
 12358*          CONTINUE
 12359*       ELSE
 12360*          GO TO 3125-EDIT-PMT-FREQ
 12361*       END-IF
 12362*    END-IF
 12363     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12364                    OR
 12365        ((PB-COMPANY-ID = 'DCC')
 12366        AND (WS-AH-DCC-TRUNC = 'T'))
 12367        CONTINUE
 12368     ELSE
 12369        GO TO 3125-EDIT-PMT-FREQ
 12370     END-IF
 12371     IF PB-I-LOAN-TERM NOT NUMERIC
 12372         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12373
 12374     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12375        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12376*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12377        PB-I-LOAN-TERM NOT GREATER THAN +360
 12378         NEXT SENTENCE
 12379     ELSE
 12380         MOVE ER-2648            TO WS-ERROR
 12381         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12382
 12383     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12384        MOVE ER-3058             TO WS-ERROR
 12385        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12386     end-if
 12387
 12388     IF WS-STATE-ABBREVIATION = 'NC'
 12389        IF PB-I-LOAN-TERM > +59
 12390           CONTINUE
 12391        ELSE
 12392           MOVE ER-2792          TO WS-ERROR
 12393           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12394        END-IF
 12395     END-IF
 12396
 12397     .
 12398 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 227
* EL050.cbl
 12399     IF (WS-LF-BENEFIT-CD = ZERO)
 12400         OR (NO-LF-BENEFIT-MATCH)
 12401            GO TO 3127-EDIT-LOAN-OFFICER.
 12402     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12403                    OR
 12404        ((PB-COMPANY-ID = 'DCC')
 12405        AND (WS-AH-DCC-TRUNC = 'T'))
 12406                    OR
 12407         (PB-COMPANY-ID = 'AHL')
 12408        CONTINUE
 12409     ELSE
 12410        IF (PB-I-LOAN-TERM > ZEROS)
 12411           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12412           MOVE ER-1575          TO WS-ERROR
 12413           PERFORM 9900-ERROR-FORMAT
 12414                                 THRU 9900-EXIT
 12415        END-IF
 12416     END-IF
 12417     IF WS-LF-EARNINGS-CALC NOT = '4'
 12418         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12419            MOVE ER-2653         TO WS-ERROR
 12420            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12421            GO TO 3127-EDIT-LOAN-OFFICER
 12422         ELSE
 12423            GO TO 3127-EDIT-LOAN-OFFICER.
 12424
 12425     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12426         MOVE ER-2655            TO WS-ERROR
 12427         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12428         GO TO 3127-EDIT-LOAN-OFFICER.
 12429
 12430     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12431         MOVE ER-2654            TO WS-ERROR
 12432         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12433         GO TO 3127-EDIT-LOAN-OFFICER.
 12434
 12435     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12436         GIVING WS-TEX-FACT-2
 12437             REMAINDER WS-TEX-FACT-3.
 12438
 12439*    IF WS-TEX-FACT-3 NOT = ZERO
 12440*       MOVE ER-2654             TO WS-ERROR
 12441*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12442
 12443
 12444 3127-EDIT-LOAN-OFFICER.
 12445
 12446     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12447        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12448           MOVE ER-2690          TO WS-ERROR
 12449           PERFORM 9900-ERROR-FORMAT
 12450                                 THRU 9900-EXIT
 12451        ELSE
 12452           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12453           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12454           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12455           MOVE PB-SV-STATE      TO LOFC-STATE
 12456           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 228
* EL050.cbl
 12457           MOVE PB-I-LOAN-OFFICER
 12458                                 TO LOFC-CODE
 12459           PERFORM 8586-READ-LOAN-OFFICER
 12460                                 THRU 8586-EXIT
 12461           IF (NOT LOFC-MASTER-FOUND)
 12462              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12463              MOVE ER-3006       TO WS-ERROR
 12464              PERFORM 9900-ERROR-FORMAT
 12465                                 THRU 9900-EXIT
 12466           END-IF
 12467        END-IF
 12468     END-IF
 12469     .
 12470 3129-EDIT-APR.
 12471
 12472     IF (WS-LF-BENEFIT-CD = ZERO)
 12473        OR (NO-LF-BENEFIT-MATCH)
 12474        IF PB-COMPANY-ID NOT = 'DCC'
 12475           GO TO 3130-EDIT-AGE
 12476*       ELSE
 12477*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12478*             GO TO 3130-EDIT-AGE
 12479*          END-IF
 12480        END-IF
 12481     END-IF
 12482
 12483     IF (WS-STATE-ABBREVIATION = 'OH')
 12484         AND (PB-I-RATE-CLASS NOT = 'L ')
 12485         AND (PB-I-LF-TERM GREATER THAN 60)
 12486         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12487         GO TO 3129-APR-CONT.
 12488
 12489     IF (WS-STATE-ABBREVIATION = 'RI')
 12490         AND (PB-I-LF-TERM GREATER THAN 60)
 12491         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12492         GO TO 3129-APR-CONT.
 12493
 12494     IF (WS-STATE-ABBREVIATION = 'UT')
 12495         AND (PB-I-LF-TERM GREATER THAN 62)
 12496         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12497         AND (PB-CERT-EFF-DT LESS WS-830901)
 12498         GO TO 3129-APR-CONT.
 12499
 12500     IF PB-COMPANY-ID = 'LAP'
 12501        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12502           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12503              MOVE ER-2656         TO WS-ERROR
 12504              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12505              GO TO 3130-EDIT-AGE.
 12506
 12507     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12508        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12509        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12510        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12511        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12512        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12513         GO TO 3130-EDIT-AGE.
 12514
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 229
* EL050.cbl
 12515 3129-APR-CONT.
 12516     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12517         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12518         GO TO 3130-EDIT-AGE.
 12519
 12520     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12521         WS-AH-BENEFIT-CD (1:1) = 'S')
 12522        AND (PB-COMPANY-ID = 'DCC')
 12523        AND (PB-I-LOAN-APR = ZERO)
 12524        MOVE ER-2657             TO WS-ERROR
 12525        PERFORM 9900-ERROR-FORMAT
 12526                                 THRU 9900-EXIT
 12527        GO TO 3130-EDIT-AGE
 12528     END-IF
 12529*    IF PB-I-LOAN-APR = ZERO
 12530*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12531*    END-IF
 12532
 12533     if pb-i-loan-apr = +99.9999
 12534        move er-2656             to ws-error
 12535        PERFORM 9900-ERROR-FORMAT
 12536                                 THRU 9900-EXIT
 12537        GO TO 3130-EDIT-AGE
 12538     end-if
 12539*    IF PB-I-LOAN-APR = ZERO
 12540*       MOVE ER-2656             TO WS-ERROR
 12541*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12542*       GO TO 3130-EDIT-AGE.
 12543
 12544*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12545     if pb-i-loan-apr not = +99.9999
 12546        IF PB-I-LOAN-APR > +30.000
 12547           MOVE ER-2657          TO WS-ERROR
 12548           PERFORM 9900-ERROR-FORMAT
 12549                                 THRU 9900-EXIT
 12550        end-if
 12551     end-if
 12552     .
 12553 3130-EDIT-AGE.
 12554
 12555******************************************************************
 12556*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12557******************************************************************
 12558
 12559     IF NOT NO-LIFE-COVERAGE
 12560        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12561           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12562               MOVE ER-2628             TO WS-ERROR
 12563               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12564
 12565     IF NOT NO-AH-COVERAGE
 12566        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12567           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12568               MOVE ER-2628         TO WS-ERROR
 12569               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12570
 12571 3133-SEX-CODE.
 12572     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 230
* EL050.cbl
 12573         IF WS-DEFAULT-SEX = 'M'
 12574             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12575          ELSE
 12576             IF WS-DEFAULT-SEX = 'F'
 12577             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12578
 12579     IF PB-I-INSURED-SEX = '1'
 12580         MOVE 'M' TO PB-I-INSURED-SEX.
 12581
 12582     IF PB-I-INSURED-SEX = '2'
 12583         MOVE 'F' TO PB-I-INSURED-SEX.
 12584
 12585 3134-SIG-SW-EDIT.
 12586     IF PB-I-SIG-SW = SPACE
 12587         MOVE 'N'                TO  PB-I-SIG-SW.
 12588
 12589     IF PB-COMPANY-ID = 'NCL'
 12590         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12591             NEXT SENTENCE
 12592         ELSE
 12593             MOVE ER-1923        TO  WS-ERROR
 12594             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12595     ELSE
 12596     IF PB-COMPANY-ID = 'CRI'
 12597         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12598             NEXT SENTENCE
 12599         ELSE
 12600             MOVE ER-2606        TO  WS-ERROR
 12601             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12602     ELSE
 12603     IF PB-COMPANY-ID = 'TMS'
 12604         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12605             NEXT SENTENCE
 12606         ELSE
 12607             MOVE ER-2689        TO  WS-ERROR
 12608             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12609     ELSE
 12610         IF PB-I-SIG-SW = 'Y' OR 'N'
 12611             NEXT SENTENCE
 12612         ELSE
 12613             MOVE ER-2651        TO  WS-ERROR
 12614             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12615
 12616     IF PB-COMPANY-ID = 'FLA'
 12617         IF (WS-EDIT-AGE GREATER 54  OR
 12618             WS-AH-EDIT-AGE GREATER 54)  AND
 12619            PB-I-SIG-SW = 'N'
 12620            MOVE ER-2651         TO  WS-ERROR
 12621            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12622
 12623 3135-NAME-EDIT.
 12624
 12625     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12626        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12627        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12628           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12629                                 TO PB-I-JOINT-FIRST-NAME
 12630        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 231
* EL050.cbl
 12631     END-IF
 12632     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12633        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12634        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12635           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12636                                 TO PB-I-JOINT-LAST-NAME
 12637        END-PERFORM
 12638     END-IF
 12639     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12640        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12641        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12642           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12643                                 TO PB-I-INSURED-FIRST-NAME
 12644        END-PERFORM
 12645     END-IF
 12646     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12647        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12648        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12649           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12650                                 TO PB-I-INSURED-LAST-NAME
 12651        END-PERFORM
 12652     END-IF
 12653     IF PB-I-INSURED-LAST-NAME = SPACES
 12654       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12655       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12656           MOVE ER-2660    TO WS-ERROR
 12657           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12658
 12659 3136-EDIT-SEX.
 12660
 12661******************************************************************
 12662*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12663******************************************************************
 12664
 12665     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12666        (WS-AH-SPECIAL-CALC-CD = 'O')
 12667        NEXT SENTENCE
 12668     ELSE
 12669        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12670           NEXT SENTENCE
 12671        ELSE
 12672           MOVE ER-2629            TO WS-ERROR
 12673           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12674
 12675 3137-EDIT-EFF-DATE.
 12676
 12677     IF PB-REISSUED-CERT       OR
 12678        PB-POLICY-IS-DECLINED  OR
 12679        PB-POLICY-IS-VOIDED
 12680         GO TO 3139-EDIT-COVERAGE-CODES.
 12681
 12682     MOVE SPACE                  TO WS-2671-SW
 12683                                    WS-2672-SW.
 12684
 12685     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12686         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12687             MOVE ER-2703        TO WS-ERROR
 12688             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 232
* EL050.cbl
 12689             GO TO 3139-EDIT-COVERAGE-CODES.
 12690
 12691     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12692         GO TO 3139-EDIT-COVERAGE-CODES.
 12693
 12694     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12695     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12696*    MOVE '1'                    TO DC-OPTION-CODE.
 12697     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12698     MOVE +0                     TO DC-ELAPSED-MONTHS
 12699                                    DC-ELAPSED-DAYS.
 12700     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12701
 12702     IF DATE-CONVERSION-ERROR
 12703         GO TO 3139-EDIT-COVERAGE-CODES.
 12704
 12705     IF DC-ELAPSED-DAYS GREATER +180
 12706         MOVE ER-2672            TO WS-ERROR
 12707         MOVE 'Y'                TO WS-2672-SW
 12708         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12709     END-IF
 12710
 12711     IF WS-ERROR = ER-2671  AND
 12712        PB-COMPANY-ID  = 'LBL'
 12713        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12714        MOVE SPACE               TO WS-2671-SW
 12715        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12716
 12717     IF PB-ISSUE-DATE-FORCED  AND
 12718      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12719         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12720         MOVE ER-2673            TO WS-ERROR
 12721         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12722         MOVE SPACE              TO WS-2671-SW
 12723                                    WS-2672-SW.
 12724
 12725     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12726         IF PB-ISSUE-DATE-FORCED
 12727             MOVE ER-2600          TO  WS-ERROR
 12728             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12729         ELSE
 12730             MOVE ER-2692          TO  WS-ERROR
 12731             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12732
 12733
 12734 3139-EDIT-COVERAGE-CODES.
 12735
 12736     if pb-company-id not = 'AHL'
 12737        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12738           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12739           MOVE ER-2787          TO WS-ERROR
 12740           PERFORM 9900-ERROR-FORMAT
 12741                                 THRU 9900-EXIT
 12742        END-IF
 12743     end-if
 12744     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12745        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12746                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 233
* EL050.cbl
 12747           MOVE ER-2719          TO WS-ERROR
 12748           PERFORM 9900-ERROR-FORMAT
 12749                                 THRU 9900-EXIT
 12750        END-IF
 12751     END-IF
 12752
 12753     IF PB-POLICY-IS-DECLINED  OR
 12754        PB-POLICY-IS-VOIDED
 12755         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12756
 12757     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12758        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12759         MOVE ER-2630                TO WS-ERROR
 12760         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12761
 12762     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12763        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12764        PB-I-LF-PREMIUM-AMT = ZERO
 12765         GO TO 3140-CHECK-AH-FOR-ZERO.
 12766
 12767     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12768        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12769        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12770         GO TO 3140-CHECK-AH-FOR-ZERO.
 12771
 12772     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12773        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12774        MOVE ER-2631             TO WS-ERROR
 12775        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12776     END-IF
 12777
 12778
 12779******************************************************************
 12780*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12781******************************************************************
 12782
 12783     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12784        NEXT SENTENCE
 12785     ELSE
 12786        IF PB-I-LF-BENEFIT-AMT = ZERO
 12787           MOVE ER-2632             TO WS-ERROR
 12788           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12789
 12790
 12791******************************************************************
 12792*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12793******************************************************************
 12794
 12795     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12796        CONTINUE
 12797     ELSE
 12798        IF PB-I-LF-PREMIUM-AMT = ZERO
 12799           IF (NOT PB-COMP-LF-PREM)
 12800              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12801              MOVE ER-2633       TO WS-ERROR
 12802              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12803           END-IF
 12804        END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 234
* EL050.cbl
 12805     END-IF
 12806     .
 12807 3140-CHECK-AH-FOR-ZERO.
 12808
 12809     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12810        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12811        PB-I-AH-PREMIUM-AMT = ZERO
 12812         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12813
 12814     IF PB-COMPANY-ID = 'CSL'  AND
 12815        PB-I-AH-BENEFIT-CD = ZERO  AND
 12816        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12817        PB-I-AH-PREMIUM-AMT = ZERO
 12818         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12819
 12820     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12821        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12822        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12823         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12824
 12825     IF PB-I-AH-BENEFIT-CD = ZERO
 12826         MOVE ER-2634            TO WS-ERROR
 12827         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12828
 12829******************************************************************
 12830*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12831******************************************************************
 12832
 12833     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12834        NEXT SENTENCE
 12835     ELSE
 12836        IF PB-I-AH-BENEFIT-AMT = ZERO
 12837           MOVE ER-2635             TO WS-ERROR
 12838           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12839
 12840******************************************************************
 12841*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12842******************************************************************
 12843
 12844     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12845        NEXT SENTENCE
 12846     ELSE
 12847        IF PB-I-AH-PREMIUM-AMT = ZERO
 12848            IF NOT PB-COMP-AH-PREM
 12849                MOVE ER-2636    TO WS-ERROR
 12850                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12851
 12852
 12853 3140-EDIT-MAX-AMT-SIZES.
 12854* CUSTOM CODE FOR CLIENT    'DMD'
 12855     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12856                                     WS-RES-MUNI-TAX
 12857                                     PB-I-STATE-TAX
 12858                                     PB-I-MUNI-TAX.
 12859
 12860     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12861
 12862     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 235
* EL050.cbl
 12863        GO TO 3150-RATE-OUTSTAND-BAL.
 12864
 12865     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12866        GO TO 3150-RATE-OUTSTAND-BAL.
 12867
 12868     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12869        GO TO 3150-RATE-OUTSTAND-BAL.
 12870
 12871     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12872                             OR 'RIC')
 12873        GO TO 3150-RATE-OUTSTAND-BAL.
 12874
 12875     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12876        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12877            GO TO 3150-RATE-OUTSTAND-BAL
 12878        ELSE
 12879           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12880               GO TO 3150-RATE-OUTSTAND-BAL.
 12881
 12882     IF NOT PB-NO-MONTHS-SKIPPED
 12883        GO TO 3150-RATE-OUTSTAND-BAL.
 12884
 12885     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12886        GO TO 3150-RATE-OUTSTAND-BAL.
 12887
 12888     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12889        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12890           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12891             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12892           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12893           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12894              MOVE ER-2693     TO WS-ERROR
 12895              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12896              GO TO 3150-RATE-OUTSTAND-BAL
 12897           ELSE
 12898              GO TO 3150-RATE-OUTSTAND-BAL.
 12899
 12900 3150-RATE-OUTSTAND-BAL.
 12901
 12902* DMD RATING TEST
 12903     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12904         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12905         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12906         MOVE ER-2687                 TO WS-ERROR
 12907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12908         MOVE 'B'                     TO PB-I-OB-FLAG
 12909         GO TO 3260-EDIT-CONTINUE.
 12910
 12911     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12912         IF  WS-ERROR    EQUAL    ER-2693
 12913             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12914                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12915                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12916                 MOVE  +0            TO  WS-ERROR.
 12917
 12918     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12919         IF  WS-ERROR    EQUAL    ER-2693
 12920             IF WS-STATE-ABBREVIATION EQUAL 'NC'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 236
* EL050.cbl
 12921                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12922                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12923                 MOVE  +0            TO  WS-ERROR.
 12924
 12925     IF PLAN-MASTER-AH-SW = 'Y'
 12926        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12927            IF  WS-ERROR    EQUAL    ER-2693
 12928              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12929                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12930                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12931                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12932                 MOVE  ER-1910           TO  WS-ERROR
 12933                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12934
 12935     IF PLAN-MASTER-AH-SW = 'Y'
 12936        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12937            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12938               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12939               MOVE  ER-1910           TO  WS-ERROR
 12940               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12941
 12942     IF PLAN-MASTER-AH-SW = 'Y'
 12943        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12944            IF  WS-ERROR    EQUAL    ER-2693
 12945                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12946                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12947                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12948                 MOVE  +0       TO  WS-ERROR.
 12949
 12950     IF WS-ERROR = ER-2693
 12951        IF PB-COMPANY-ID = 'JAL' AND
 12952           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12953           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12954           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12955
 12956     IF WS-ERROR = ER-2693
 12957        IF PB-COMPANY-ID = 'NCL'  AND
 12958           PB-I-AH-BENEFIT-CD = 'OA'
 12959           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12960           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12961
 12962     IF WS-ERROR = ER-2693
 12963        IF PB-COMPANY-ID = 'CNL' AND
 12964           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12965           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12966           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12967
 12968     IF WS-ERROR = ER-2693
 12969        IF PB-COMPANY-ID = 'HER'
 12970           IF WS-LEVEL
 12971              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12972              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12973
 12974     IF ((LF-BENEFIT-FOUND) AND
 12975         (NOT NO-LIFE-COVERAGE)  AND
 12976         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12977       OR   ((AH-BENEFIT-FOUND) AND
 12978             (NOT NO-AH-COVERAGE)    AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 237
* EL050.cbl
 12979             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12980         NEXT SENTENCE
 12981     ELSE
 12982         GO TO 3215-EDIT-RATES.
 12983
 12984     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12985        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12986           MOVE ER-2674          TO WS-ERROR
 12987           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12988           GO TO 3215-EDIT-RATES.
 12989
 12990     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12991        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12992           MOVE ER-2674          TO WS-ERROR
 12993           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12994           GO TO 3215-EDIT-RATES.
 12995
 12996     MOVE 'B'                    TO PB-I-OB-FLAG.
 12997
 12998     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12999         NEXT SENTENCE
 13000     ELSE
 13001         IF NOT NO-LIFE-COVERAGE
 13002             IF WS-ACCT-LF-OB-RT = ZERO
 13003                MOVE ER-2641    TO WS-ERROR
 13004                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13005
 13006     IF PB-COMPANY-ID = 'CRI'
 13007       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13008         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13009         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13010         IF WS-ERROR = ER-2675
 13011            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13012            MOVE ER-2687              TO WS-ERROR
 13013            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13014         ELSE
 13015            MOVE ER-2687              TO WS-ERROR
 13016            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13017
 13018
 13019     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13020         NEXT SENTENCE
 13021     ELSE
 13022       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13023            NEXT SENTENCE
 13024       ELSE
 13025         IF NOT NO-AH-COVERAGE
 13026             IF WS-ACCT-AH-OB-RT = ZERO
 13027                MOVE ER-2642    TO WS-ERROR
 13028                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13029
 13030     IF PB-COMPANY-ID = 'CRI'
 13031       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13032         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13033         IF WS-ERROR = ER-2676
 13034            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13035            MOVE ER-2687              TO WS-ERROR
 13036            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 238
* EL050.cbl
 13037         ELSE
 13038            MOVE ER-2687              TO WS-ERROR
 13039            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13040
 13041     IF PB-COMPANY-ID NOT = 'GIC'
 13042         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13043            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13044     ELSE
 13045         IF PB-I-LF-PREM-CALC = ZEROS
 13046             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13047                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13048
 13049     IF PB-COMPANY-ID NOT = 'GIC'
 13050         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13051            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13052     ELSE
 13053         IF PB-I-AH-PREM-CALC = ZEROS
 13054             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13055                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13056
 13057     MOVE ZEROS TO PB-I-MORT-CODE.
 13058
 13059     GO TO 3260-EDIT-CONTINUE.
 13060
 13061
 13062 3215-EDIT-RATES.
 13063     IF ACCOUNT-MAST-FOUND
 13064         NEXT SENTENCE
 13065     ELSE
 13066         GO TO 3999-END-EDIT.
 13067
 13068 3220-CHECK-LF-RATES.
 13069
 13070     IF PB-COMPANY-ID = 'DCC'
 13071        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13072        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13073        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13074           AND (NOT WS-LF-CASH))
 13075                           OR
 13076           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13077           AND (NOT WS-AH-CASH)))
 13078                       AND
 13079           (PB-I-ENTRY-STATUS NOT = '5')
 13080           MOVE 'M'              TO PB-BATCH-ENTRY
 13081                                    PB-I-ENTRY-STATUS
 13082        END-IF
 13083     END-IF
 13084     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13085                                    PB-I-AH-PREM-CALC
 13086                                    PB-I-LF-ALT-PREM-CALC
 13087                                    PB-I-LF-ALT-RATE
 13088                                    PB-I-LF-REI-RATE
 13089                                    PB-I-LF-ALT-REI-RATE
 13090                                    PB-I-AH-REI-RATE
 13091                                    PB-I-TOT-FEES-CALC.
 13092
 13093     IF PB-COMPANY-ID EQUAL 'DMD'
 13094        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 239
* EL050.cbl
 13095     ELSE
 13096        MOVE ZEROS               TO PB-I-LF-RATE
 13097                                    PB-I-AH-RATE.
 13098
 13099     IF PB-I-TOT-FEES NOT NUMERIC
 13100        MOVE ZEROS               TO PB-I-TOT-FEES
 13101     END-IF
 13102     IF PB-I-LIVES NOT NUMERIC
 13103         MOVE ZERO               TO PB-I-LIVES.
 13104
 13105     IF PB-I-NUM-BILLED NOT NUMERIC
 13106         MOVE ZERO               TO PB-I-NUM-BILLED.
 13107
 13108     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13109        MOVE +0                  TO PB-I-LF-PREM-TAX
 13110     END-IF
 13111
 13112     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13113        MOVE +0                  TO PB-I-AH-PREM-TAX
 13114     END-IF
 13115
 13116     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13117        PB-I-PAY-FREQUENCY = ZEROS
 13118            MOVE 12 TO CP-PAY-FREQUENCY
 13119     ELSE
 13120            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13121
 13122     IF PB-I-STATE-TAX NOT NUMERIC
 13123         MOVE ZEROS               TO PB-I-STATE-TAX.
 13124
 13125     IF PB-I-MUNI-TAX NOT NUMERIC
 13126         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13127
 13128     MOVE SPACES                 TO CP-BEN-CATEGORY
 13129     IF PB-COMPANY-ID  = 'CSL'  AND
 13130        PB-I-LF-TERM NOT = ZERO
 13131        COMPUTE WS-PAYMENT-AMT =
 13132             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13133        COMPUTE WS-CSL-AMT1 =
 13134             PB-I-LF-TERM * AM-MAX-MON-BEN
 13135        COMPUTE WS-CSL-AMT2 =
 13136             WS-PAYMENT-AMT * PB-I-LF-TERM
 13137        IF CP-PAY-FREQUENCY NOT = 12
 13138           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13139           MOVE '8' TO WS-CSL-CALC-CD
 13140        ELSE
 13141           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13142              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13143               AM-MAX-TOT-BEN
 13144               MOVE '6' TO WS-CSL-CALC-CD
 13145           ELSE
 13146              IF (WS-CSL-AMT1  GREATER THAN
 13147                 AM-MAX-TOT-BEN) AND
 13148                 (WS-CSL-AMT2  GREATER THAN
 13149                 AM-MAX-TOT-BEN)
 13150                 MOVE '7' TO WS-CSL-CALC-CD
 13151              ELSE
 13152                 MOVE '5' TO WS-CSL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 240
* EL050.cbl
 13153
 13154     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13155         NEXT SENTENCE
 13156     ELSE
 13157         GO TO 3300-CHECK-AH-RATES.
 13158
 13159*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13160
 13161     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13162        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13163              OR
 13164           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13165           MOVE ER-2618          TO WS-ERROR
 13166           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13167           GO TO 3300-CHECK-AH-RATES.
 13168
 13169     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13170           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13171                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13172
 13173     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13174         MOVE ER-2687             TO WS-ERROR
 13175         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13176         MOVE 'Z000'              TO PB-I-MORT-CODE
 13177         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13178         GO TO 3300-CHECK-AH-RATES.
 13179
 13180     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13181        IF PB-I-LIVES = ZERO
 13182           MOVE ER-2688          TO WS-ERROR
 13183           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13184
 13185     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13186
 13187     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13188     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13189     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13190     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13191     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13192     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13193     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13194     MOVE '3'                    TO CP-PROCESS-TYPE.
 13195     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13196     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13197
 13198******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13199     IF PB-COMPANY-ID EQUAL 'CDL'
 13200         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13201            CP-EARN-AS-NET-PAY)
 13202             IF PB-CERT-EFF-DT GREATER  WS-931231
 13203                 MOVE '1'        TO CP-EARNING-METHOD.
 13204*******
 13205
 13206     MOVE PB-SV-STATE            TO CP-STATE.
 13207     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13208     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13209     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13210     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 241
* EL050.cbl
 13211     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13212                                    CP-RATING-BENEFIT-AMT.
 13213     IF CP-STATE-STD-ABBRV = 'OR'
 13214         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13215                                         PB-I-LF-ALT-BENEFIT-AMT.
 13216     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13217     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13218     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13219     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13220     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13221     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13222     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13223     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13224     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13225                                    CP-REMAINING-TERM
 13226                                    CP-LOAN-TERM.
 13227
 13228     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13229         NEXT SENTENCE
 13230     ELSE
 13231         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13232             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13233                                           PB-I-LF-PREMIUM-AMT.
 13234
 13235     IF PB-COMPANY-ID EQUAL 'CSL'
 13236        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13237           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13238                                         PB-I-LF-PREMIUM-AMT.
 13239
 13240     IF PB-COMPANY-ID EQUAL 'NCB'
 13241         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13242            CP-EARN-AS-NET-PAY
 13243             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13244                 PB-I-LF-PREMIUM-AMT.
 13245
 13246     IF (CP-TRUNCATED-LIFE)
 13247        or ((pb-company-id = 'AHL')
 13248           and (pb-i-loan-term > pb-i-lf-term))
 13249        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13250
 13251     IF PB-COMPANY-ID EQUAL 'CRI'
 13252        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13253
 13254     IF CP-TERM-IS-DAYS
 13255         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13256     ELSE
 13257         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13258     IF PB-COMPANY-ID = 'DCC'
 13259        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13260        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13261        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13262        IF WS-LF-BEN-CATEGORY = 'D'
 13263           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13264           MOVE PB-I-LIFE-COMMISSION
 13265                                 TO CP-DCC-ACT-COMM
 13266           MOVE WS-LF-BEN-CATEGORY
 13267                                 TO CP-BEN-CATEGORY
 13268        END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 242
* EL050.cbl
 13269        IF (CP-BENEFIT-CD (1:1) = 'P')
 13270           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13271           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13272           add pb-i-ah-premium-amt to cp-original-premium
 13273        END-IF
 13274     END-IF
 13275     IF PB-COMPANY-ID = 'CSL'
 13276         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13277         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13278         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13279
 13280     IF PB-COMPANY-ID = 'CSL'
 13281        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13282
 13283     IF (CP-SPECIAL-CALC-CD = 'H')
 13284        OR (PB-COMPANY-ID = 'DCC')
 13285         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13286                                    TO CP-ALTERNATE-BENEFIT
 13287         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13288
 13289     IF (PB-COMPANY-ID = 'CID')
 13290        AND (WS-LF-EARNINGS-CALC = 'B')
 13291        AND (CP-STATE-STD-ABBRV = 'MN')
 13292        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13293                                 TO CP-ALTERNATE-BENEFIT
 13294        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13295     END-IF
 13296     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13297     MOVE 'R'                   TO CP-RATE-FILE.
 13298     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13299
 13300     IF CP-ERROR-RATE-NOT-FOUND
 13301        MOVE ER-2641            TO WS-ERROR
 13302        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13303        GO TO 3300-CHECK-AH-RATES.
 13304
 13305     IF PB-COMPANY-ID EQUAL 'CRI'
 13306        IF CP-ERROR-NO-LIMITS-CRI
 13307           IF NOT ACCOUNT-LIFE-CHECKED
 13308              MOVE ER-2607      TO WS-ERROR
 13309              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13310
 13311******************************************************************
 13312*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13313*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13314******************************************************************
 13315
 13316* CALC LIFE AGE AT EXPIRATION.
 13317
 13318     COMPUTE WS-AGE-AT-EXPIRE =
 13319          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13320
 13321*    IF PB-STATE = 'CO' OR 'UT'
 13322*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13323*        MOVE 'F'            TO PB-FATAL-FLAG
 13324*        MOVE ER-2709        TO WS-ERROR
 13325*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13326*        GO TO PREMIUM-EDITING-IS-BYPASSED.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 243
* EL050.cbl
 13327
 13328*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13329*        MOVE 'X'            TO PB-FATAL-FLAG
 13330*        MOVE ER-2718        TO WS-ERROR
 13331*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13332*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13333
 13334* CALC A & H AGE AT EXPIRATION.
 13335
 13336     COMPUTE WS-AGE-AT-EXPIRE =
 13337          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13338
 13339*    IF PB-STATE = 'CO' OR 'UT'
 13340*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13341*        MOVE 'F'            TO PB-FATAL-FLAG
 13342*        MOVE ER-2709        TO WS-ERROR
 13343*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13344*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13345
 13346*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13347*        MOVE 'X'            TO PB-FATAL-FLAG
 13348*        MOVE ER-2718        TO WS-ERROR
 13349*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13350*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13351
 13352     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13353        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13354
 13355     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13356        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13357
 13358     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13359        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13360
 13361     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13362         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13363         MOVE ER-2639        TO WS-ERROR
 13364         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13365
 13366
 13367******************************************************************
 13368*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13369******************************************************************
 13370
 13371 PREMIUM-EDITING-IS-BYPASSED.
 13372     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13373        AND (CP-R-MAX-ATT-AGE > +0)
 13374        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13375        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13376           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13377           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13378           MOVE '1'              TO DC-OPTION-CODE
 13379           PERFORM 8500-DATE-CONVERT
 13380                                 THRU 8500-EXIT
 13381           IF NO-CONVERSION-ERROR
 13382              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13383                 MOVE ER-2661       TO WS-ERROR
 13384*                PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 244
* EL050.cbl
 13385*                                THRU 9900-EXIT
 13386              END-IF
 13387           END-IF
 13388        ELSE
 13389           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13390           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13391              MOVE ER-2661       TO WS-ERROR
 13392*             PERFORM 9900-ERROR-FORMAT
 13393*                                THRU 9900-EXIT
 13394           ELSE
 13395              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13396                 MOVE ER-1570    TO WS-ERROR
 13397                 PERFORM 9900-ERROR-FORMAT
 13398                                 THRU 9900-EXIT
 13399              END-IF
 13400           END-IF
 13401        END-IF
 13402        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13403           MOVE PB-I-JOINT-BIRTHDAY
 13404                                 TO DC-BIN-DATE-1
 13405           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13406           MOVE '1'              TO DC-OPTION-CODE
 13407           PERFORM 8500-DATE-CONVERT
 13408                                 THRU 8500-EXIT
 13409           IF NO-CONVERSION-ERROR
 13410              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13411                 MOVE ER-2661       TO WS-ERROR
 13412*                PERFORM 9900-ERROR-FORMAT
 13413*                                THRU 9900-EXIT
 13414              END-IF
 13415           ELSE
 13416              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13417           END-IF
 13418        ELSE
 13419           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13420             (PB-I-LF-TERM / 12)
 13421           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13422              MOVE ER-2661       TO WS-ERROR
 13423*             PERFORM 9900-ERROR-FORMAT
 13424*                                THRU 9900-EXIT
 13425           ELSE
 13426              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13427                 MOVE ER-1571    TO WS-ERROR
 13428                 PERFORM 9900-ERROR-FORMAT
 13429                                 THRU 9900-EXIT
 13430              END-IF
 13431           END-IF
 13432        END-IF
 13433        IF WS-ERROR = ER-2661
 13434           PERFORM 9900-ERROR-FORMAT
 13435                                 THRU 9900-EXIT
 13436        END-IF
 13437     END-IF
 13438*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13439*       MOVE ER-2661             TO WS-ERROR
 13440*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13441
 13442     IF CP-ERROR-AGE-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 245
* EL050.cbl
 13443        MOVE ER-2662             TO WS-ERROR
 13444        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13445
 13446     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13447        MOVE ER-2677             TO WS-ERROR
 13448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13449
 13450     IF CP-ERROR-LOAN-TERM
 13451        MOVE ER-2648             TO WS-ERROR
 13452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13453
 13454 3221-CHECK-ERROR-RATE-OPEN.
 13455
 13456     IF CP-ERROR-RATE-FILE-NOTOPEN
 13457         GO TO 3990-FILES-NOT-OPEN.
 13458
 13459     IF PB-COMPANY-ID NOT = 'DMD'
 13460        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13461     END-IF
 13462     .
 13463 3221-CONTINUE.
 13464     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13465                                    WS-DCC-AH-RATE
 13466     IF PB-COMPANY-ID = 'DCC'
 13467        IF WS-LF-BEN-CATEGORY = 'D'
 13468           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13469              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13470        END-IF
 13471     END-IF
 13472     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13473*   X'A4FF' = 12/31/2009
 13474     IF (PB-COMPANY-ID = 'CID')
 13475        AND (WS-LF-EARNINGS-CALC = 'B')
 13476        AND (CP-STATE-STD-ABBRV = 'MN')
 13477        AND (PB-CERT-EFF-DT > X'A4FF')
 13478        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13479     END-IF
 13480     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13481
 13482     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13483     IF (PB-COMPANY-ID = 'DCC')
 13484        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13485        AND (PB-I-POLICY-IS-MONTHLY)
 13486        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13487        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13488     END-IF
 13489     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13490     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13491     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13492     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13493     IF (PB-COMPANY-ID = 'DCC')
 13494        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13495        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13496        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13497        MOVE ER-2786             TO WS-ERROR
 13498        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13499     END-IF
 13500
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 246
* EL050.cbl
 13501     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13502
 13503******************************************************************
 13504*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13505******************************************************************
 13506     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13507        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13508
 13509     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13510        GO TO 3225-CHECK-ALT-LIFE-RATE
 13511     ELSE
 13512       IF PB-I-LF-RATE = ZERO
 13513          MOVE ER-2641          TO WS-ERROR
 13514          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13515
 13516 3225-CHECK-ALT-LIFE-RATE.
 13517
 13518     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13519        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13520        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13521         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13522
 13523     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13524         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13525             AND PB-COMPANY-ID NOT = 'DCC')
 13526                   OR
 13527              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13528              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13529              AND PB-COMPANY-ID NOT = 'DCC')
 13530             MOVE ER-2720        TO  WS-ERROR
 13531             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13532             GO TO 3225-RATING-CONT
 13533         ELSE
 13534             GO TO 3225-RATING-CONT.
 13535     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13536        AND (AM-GPCD = 01 OR 06 OR 15)
 13537        MOVE ER-2798             TO WS-ERROR
 13538        PERFORM 9900-ERROR-FORMAT
 13539                                 THRU 9900-EXIT
 13540*       GO TO 3225-RATING-CONT
 13541     END-IF
 13542     IF (PB-COMPANY-ID = 'CID')
 13543        AND (WS-LF-EARNINGS-CALC = 'B')
 13544        AND (CP-STATE-STD-ABBRV = 'MN')
 13545        AND (PB-CERT-EFF-DT > X'A4FF')
 13546        GO TO 3225-RATING-CONT
 13547     END-IF
 13548     IF PB-COMPANY-ID = 'DCC'
 13549        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13550           AND (PB-I-POLICY-IS-MONTHLY)
 13551           GO TO 3225-RATING-CONT
 13552        END-IF
 13553     END-IF
 13554
 13555     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13556        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13557        CP-EARN-AS-REG-BALLOON
 13558        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 247
* EL050.cbl
 13559     ELSE
 13560        MOVE '2'                 TO CP-EARNING-METHOD.
 13561
 13562 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13563
 13564     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13565
 13566     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13567        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13568        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13569         NEXT SENTENCE
 13570     ELSE
 13571         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13572
 13573     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13574     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13575     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13576                                     CP-RATING-BENEFIT-AMT.
 13577     IF CP-STATE-STD-ABBRV = 'OR'
 13578         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13579                                         PB-I-LF-ALT-BENEFIT-AMT.
 13580     IF PB-COMPANY-ID = 'DCC'
 13581        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13582     END-IF
 13583     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13584     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13585     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13586                                    CP-REMAINING-TERM
 13587                                    CP-LOAN-TERM.
 13588     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13589        ADD +1                   TO CP-ORIGINAL-TERM
 13590                                    CP-REMAINING-TERM
 13591                                    CP-LOAN-TERM.
 13592
 13593     MOVE 'R'                   TO CP-RATE-FILE.
 13594     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13595
 13596     IF CP-ERROR-RATE-NOT-FOUND
 13597         MOVE ER-2641            TO WS-ERROR
 13598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13599         GO TO 3300-CHECK-AH-RATES.
 13600
 13601     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13602     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13603
 13604     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13605         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13606
 13607     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13608                               + PB-I-LF-ALT-BENEFIT-AMT.
 13609
 13610     IF ACCOUNT-LIFE-CHECKED  OR
 13611        PB-POLICY-IS-VOIDED   OR
 13612        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13613        GO TO 3225-CONTINUE.
 13614
 13615     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13616        GO TO 3225-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 248
* EL050.cbl
 13617
 13618     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13619                             EC-RT-LF-MAX-TOT-BEN
 13620        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13621        MOVE ER-2639       TO WS-ERROR
 13622        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13623
 13624 3225-CONTINUE.
 13625     IF PB-I-LF-ALT-RATE = ZERO
 13626         MOVE ER-2659            TO WS-ERROR
 13627         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13628
 13629     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13630        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13631        MOVE ER-2698             TO WS-ERROR
 13632        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13633
 13634 3225-RATING-CONT.
 13635
 13636     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13637         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13638         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13639         IF (PB-COMPANY-ID = 'DCC')
 13640            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13641            CONTINUE
 13642         ELSE
 13643            MOVE ER-2687         TO WS-ERROR
 13644            PERFORM 9900-ERROR-FORMAT
 13645                                 THRU 9900-EXIT
 13646         END-IF
 13647         GO TO 3290-EDIT-LF-REIN-RATE
 13648     END-IF
 13649
 13650* DMD RATING TEST
 13651     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13652         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13653         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13654         MOVE ER-2687                 TO WS-ERROR
 13655         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13656         GO TO 3290-EDIT-LF-REIN-RATE.
 13657
 13658 3230-CLIENT-MORT-CD-SPECIALS.
 13659
 13660     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13661     SET BIN-TO-GREG          TO TRUE.
 13662*    MOVE ' '                 TO DC-OPTION-CODE.
 13663     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13664     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13665
 13666 C-POS-3230-MORT-CD.
 13667     IF PB-COMPANY-ID = 'POS' AND
 13668        PB-SV-CARRIER = '2'
 13669         NEXT SENTENCE
 13670     ELSE
 13671         GO TO C-POS-3240-MORT-CD.
 13672
 13673     IF PB-SV-GROUPING = '030'
 13674        AND PB-CERT-EFF-DT GREATER THAN WS-791231
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 249
* EL050.cbl
 13675         MOVE '2350' TO PB-I-MORT-CODE
 13676      ELSE
 13677         MOVE '3300' TO PB-I-MORT-CODE.
 13678
 13679
 13680 C-POS-3240-MORT-CD.
 13681     IF PB-COMPANY-ID = 'POS' AND
 13682        PB-SV-CARRIER = '1'
 13683         NEXT SENTENCE
 13684     ELSE
 13685         GO TO 3230-CONTINUE.
 13686
 13687     IF PB-SV-STATE = '45' OR '47'
 13688        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13689         MOVE '5200' TO PB-I-MORT-CODE
 13690     ELSE
 13691         MOVE '8300' TO PB-I-MORT-CODE.
 13692
 13693 3230-CONTINUE.
 13694
 13695     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13696        GO TO 3240-CONTINUE
 13697     END-IF
 13698
 13699     IF PB-CERT-EFF-DT > WS-971231
 13700        GO TO 3240-CONTINUE
 13701     END-IF
 13702
 13703     IF LF-BENEFIT-FOUND AND
 13704        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13705         MOVE 'F250'       TO PB-I-MORT-CODE
 13706     ELSE
 13707         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13708             MOVE '7250'   TO PB-I-MORT-CODE
 13709         ELSE
 13710             MOVE '4251'   TO PB-I-MORT-CODE
 13711         END-IF
 13712     END-IF
 13713
 13714     .
 13715 3240-CONTINUE.
 13716
 13717     IF PB-COMPANY-ID NOT = 'GNL'
 13718         GO TO 3256-CONTINUE.
 13719
 13720     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13721         MOVE 'A300' TO PB-I-MORT-CODE
 13722     ELSE
 13723         MOVE '8350' TO PB-I-MORT-CODE.
 13724
 13725 3256-CONTINUE.
 13726     IF PB-COMPANY-ID NOT = 'ABL'
 13727         GO TO 3260-EDIT-CONTINUE.
 13728
 13729     IF PB-I-LF-TERM GREATER THAN 59
 13730         MOVE 'F550' TO PB-I-MORT-CODE
 13731     ELSE
 13732         MOVE 'E550' TO PB-I-MORT-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 250
* EL050.cbl
 13733
 13734 3260-EDIT-CONTINUE.
 13735     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13736
 13737 3290-EDIT-LF-REIN-RATE.
 13738     IF LF-REIN-NSP-NOT-USED
 13739         GO TO 3290-RATING-CONT.
 13740
 13741     IF PB-COMPANY-ID = 'DCC'
 13742        GO TO 3290-RATING-CONT.
 13743     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13744     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13745     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13746     MOVE '3'                   TO CP-PROCESS-TYPE.
 13747     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13748
 13749******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13750     IF PB-COMPANY-ID EQUAL 'CDL'
 13751         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13752            CP-EARN-AS-NET-PAY)
 13753             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13754*            MOVE SPACE          TO DC-OPTION-CODE
 13755             SET BIN-TO-GREG     TO TRUE
 13756             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13757***  Y2K PROJ 7744
 13758             IF DC-GREG-DATE-CYMD GREATER 19931231
 13759                 MOVE '1'        TO CP-EARNING-METHOD.
 13760***  Y2K PROJ 7744
 13761*******
 13762
 13763     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13764     MOVE PB-SV-STATE           TO CP-STATE.
 13765     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13766     MOVE ZERO                  TO CP-DEVIATION-CODE
 13767                                   CP-RATE-DEV-PCT.
 13768     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13769     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13770                                   CP-RATING-BENEFIT-AMT.
 13771
 13772************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13773     IF PB-COMPANY-ID EQUAL 'NCB'
 13774         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13775            CP-EARN-AS-NET-PAY
 13776             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13777                 PB-I-LF-PREMIUM-AMT.
 13778************
 13779
 13780     IF CP-STATE-STD-ABBRV = 'OR'
 13781         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13782                                         PB-I-LF-ALT-BENEFIT-AMT.
 13783     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13784     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13785     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13786     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13787     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13788     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13789     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13790     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 251
* EL050.cbl
 13791                                   CP-REMAINING-TERM
 13792                                   CP-LOAN-TERM.
 13793     IF CP-TRUNCATED-LIFE
 13794        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13795
 13796     IF CP-TERM-IS-DAYS
 13797         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13798     ELSE
 13799         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13800
 13801     IF PB-COMPANY-ID = 'DCC'
 13802        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13803     END-IF
 13804     IF PB-COMPANY-ID NOT = 'TIC'
 13805          MOVE ZERO          TO CP-CLASS-CODE.
 13806
 13807     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13808
 13809     MOVE 'R'                   TO CP-RATE-FILE.
 13810     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13811
 13812     IF CP-ERROR-RATE-NOT-FOUND
 13813        IF PB-I-OB
 13814           MOVE ER-2625      TO WS-ERROR
 13815           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13816           GO TO 3299-EDIT-CONTINUE
 13817        ELSE
 13818           MOVE ER-2643      TO WS-ERROR
 13819           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13820           GO TO 3299-EDIT-CONTINUE.
 13821
 13822     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13823
 13824     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13825     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13826
 13827     IF PB-I-LF-REI-RATE = ZERO
 13828         MOVE ER-2643        TO WS-ERROR
 13829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13830
 13831 3290-CHECK-ALT-REIN-RATE.
 13832
 13833     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13834        GO TO 3290-RATING-CONT.
 13835
 13836     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13837     MOVE '2'                    TO CP-EARNING-METHOD.
 13838     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13839     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13840     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13841     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13842                                     CP-RATING-BENEFIT-AMT.
 13843     IF CP-STATE-STD-ABBRV = 'OR'
 13844         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13845                                         PB-I-LF-ALT-BENEFIT-AMT.
 13846     IF PB-COMPANY-ID = 'DCC'
 13847        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13848     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 252
* EL050.cbl
 13849     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13850     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13851     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13852                                    CP-REMAINING-TERM
 13853                                    CP-LOAN-TERM.
 13854     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13855        ADD +1                   TO CP-ORIGINAL-TERM
 13856                                    CP-REMAINING-TERM
 13857                                    CP-LOAN-TERM.
 13858
 13859     MOVE 'R'                   TO CP-RATE-FILE.
 13860     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13861
 13862     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13863
 13864     IF PB-I-LF-ALT-REI-RATE = ZERO
 13865         MOVE ER-2643            TO WS-ERROR
 13866         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13867
 13868 3290-RATING-CONT.
 13869
 13870     IF PB-I-OB
 13871*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13872        GO TO 3300-CHECK-AH-RATES.
 13873
 13874 3299-EDIT-CONTINUE.
 13875
 13876     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13877         NEXT SENTENCE
 13878     ELSE
 13879         MOVE ER-2620           TO WS-ERROR
 13880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13881
 13882 3300-CHECK-AH-RATES.
 13883     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13884         NEXT SENTENCE
 13885     ELSE
 13886         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13887
 13888     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13889        ((CF-COMPANY-ID = 'DMD') AND
 13890                (NO-DMD-RATING))
 13891         IF (PB-COMPANY-ID = 'DCC')
 13892            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13893            CONTINUE
 13894         ELSE
 13895            MOVE ER-2687         TO WS-ERROR
 13896            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13897         END-IF
 13898         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13899         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13900     END-IF
 13901
 13902     IF PB-I-OB
 13903        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13904
 13905     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13906         MOVE ER-2687             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 253
* EL050.cbl
 13907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13908         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13909         GO TO 3999-END-EDIT.
 13910
 13911*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13912
 13913     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13914        IF PB-I-AH-CRIT-PER = ZERO
 13915           IF PB-COMPANY-ID = 'DCC'
 13916              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13917              CONTINUE
 13918           ELSE
 13919              MOVE ER-2618       TO WS-ERROR
 13920              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13921              GO TO 3999-END-EDIT
 13922           END-IF
 13923        END-IF
 13924     END-IF
 13925     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13926     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13927     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13928     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13929     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13930     MOVE PB-SV-STATE            TO CP-STATE.
 13931     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13932     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13933     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13934*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13935     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13936     MOVE '3'                    TO CP-PROCESS-TYPE.
 13937     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13938     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13939                                    CP-RATING-BENEFIT-AMT.
 13940     IF PB-COMPANY-ID = 'CID'
 13941               OR
 13942        CP-STATE-STD-ABBRV = 'OR'
 13943         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13944                                         PB-I-AH-TERM.
 13945     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13946        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13947           AND (PB-I-POLICY-IS-MONTHLY)
 13948           MOVE PB-I-LF-BENEFIT-AMT
 13949                                 TO CP-NET-BENEFIT-AMT
 13950           move pb-i-ah-premium-amt to cp-original-premium
 13951           add pb-i-lf-premium-amt to cp-original-premium
 13952        END-IF
 13953     END-IF
 13954     MOVE SPACES                 TO CP-BEN-CATEGORY
 13955     IF PB-COMPANY-ID = 'DCC'
 13956        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13957        EVALUATE TRUE
 13958           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13959              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13960              MOVE PB-I-LF-BENEFIT-AMT
 13961                                 TO CP-RATING-BENEFIT-AMT
 13962              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13963           WHEN WS-AH-BEN-CATEGORY = 'G'
 13964              MOVE PB-I-UNPAID-CASH-PRICE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 254
* EL050.cbl
 13965                                 TO CP-RATING-BENEFIT-AMT
 13966           WHEN WS-AH-BEN-CATEGORY = 'D'
 13967              MOVE WS-AH-PMF-COMM
 13968                                 TO CP-DCC-PMF-COMM
 13969              MOVE PB-I-AH-COMMISSION
 13970                                 TO CP-DCC-ACT-COMM
 13971        END-EVALUATE
 13972     END-IF
 13973     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13974     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13975     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13976     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13977     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13978     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13979     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13980                                    CP-REMAINING-TERM
 13981                                    WS-WORK-TERM.
 13982     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13983
 13984     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13985     SET BIN-TO-GREG             TO TRUE.
 13986*    MOVE ' '                    TO DC-OPTION-CODE.
 13987     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13988     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13989
 13990     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13991     IF NOT VALID-SKIP-CODE
 13992         MOVE ER-2683            TO WS-ERROR
 13993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13994         GO TO 3320-RATE-CONTINUE.
 13995
 13996     IF PB-NO-MONTHS-SKIPPED
 13997         GO TO 3320-RATE-CONTINUE.
 13998
 13999     MOVE SPACE TO NUMBER-OF-MONTHS.
 14000
 14001     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14002         MOVE 'S'                TO SK-MO (6).
 14003     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14004         MOVE 'S'                TO SK-MO (7).
 14005     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14006         MOVE 'S'                TO SK-MO (8).
 14007     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14008         MOVE 'S'                TO SK-MO (9).
 14009     IF PB-I-SKIP-CODE = 'A'
 14010         MOVE 'S'                TO SK-MO (10).
 14011
 14012     MOVE 1                      TO SUB2.
 14013     MOVE PB-I-AH-TERM           TO SUB3.
 14014     MOVE WS-MONTH               TO SUB1.
 14015     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14016     GO TO 3320-RATE-CONTINUE.
 14017
 14018 3310-GET-SKIP-MO.
 14019     IF SUB1 = 13
 14020         MOVE 1                  TO SUB1.
 14021
 14022     IF SK-MO (SUB1) = 'S'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 255
* EL050.cbl
 14023         SUBTRACT 1 FROM WS-WORK-TERM.
 14024
 14025     ADD 1 TO SUB2
 14026              SUB1.
 14027
 14028 3320-RATE-CONTINUE.
 14029
 14030     IF WS-WORK-TERM = ZERO
 14031         MOVE 1                  TO WS-WORK-TERM.
 14032
 14033     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14034                                    CP-LOAN-TERM.
 14035
 14036     IF PB-COMPANY-ID EQUAL 'DMD'
 14037         NEXT SENTENCE
 14038     ELSE
 14039         MOVE ZERO               TO PB-I-AH-RATE
 14040                                    PB-I-AH-REI-RATE.
 14041
 14042
 14043     IF PB-COMPANY-ID EQUAL 'CRI'
 14044        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14045
 14046     IF PB-COMPANY-ID = 'CSL'
 14047         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14048         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14049         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14050         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14051
 14052     IF PB-COMPANY-ID = 'DCC'
 14053        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14054           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14055              PB-I-RATE-DEV-PCT-LF
 14056        END-IF
 14057        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14058                                 TO CP-ALTERNATE-BENEFIT
 14059        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14060        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14061        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14062     END-IF
 14063     IF (PB-COMPANY-ID = 'CID')
 14064        AND (WS-LF-EARNINGS-CALC = 'B')
 14065        AND (CP-STATE-STD-ABBRV = 'MN')
 14066        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14067     ELSE
 14068        MOVE ' '                 TO CP-AH-BALLOON-SW
 14069     END-IF
 14070     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14071     MOVE 'R'                   TO CP-RATE-FILE.
 14072     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14073
 14074     IF CP-ERROR-RATE-NOT-FOUND
 14075        IF PB-I-OB
 14076           MOVE ER-2624          TO WS-ERROR
 14077           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14078           GO TO 3340-CALCULATE-PREMIUM-AMT
 14079        ELSE
 14080          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 256
* EL050.cbl
 14081              NEXT SENTENCE
 14082          ELSE
 14083           MOVE ER-2642          TO WS-ERROR
 14084           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14085           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14086
 14087     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14088        CP-ERROR-DIV-BY-ZERO
 14089           MOVE ER-3782          TO WS-ERROR
 14090           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14091
 14092     IF PB-COMPANY-ID EQUAL 'CRI'
 14093        IF CP-ERROR-NO-LIMITS-CRI
 14094           IF NOT ACCOUNT-AH-CHECKED
 14095              MOVE ER-2607          TO WS-ERROR
 14096              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14097
 14098     IF ACCOUNT-AH-CHECKED
 14099        NEXT SENTENCE
 14100     ELSE
 14101       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14102          MOVE ER-2640           TO WS-ERROR
 14103          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14104
 14105     IF PB-COMPANY-ID = 'CRI'
 14106         IF WS-ERROR = ER-2640
 14107             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14108     IF ACCOUNT-AH-CHECKED
 14109        CONTINUE
 14110     ELSE
 14111        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14112           AND (CP-R-MAX-ATT-AGE > +0)
 14113           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14114           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14115              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14116              MOVE PB-I-AH-EXPIRE-DT
 14117                                 TO DC-BIN-DATE-2
 14118              MOVE '1'           TO DC-OPTION-CODE
 14119              PERFORM 8500-DATE-CONVERT
 14120                                 THRU 8500-EXIT
 14121              IF NO-CONVERSION-ERROR
 14122                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14123                    MOVE ER-2661       TO WS-ERROR
 14124*                   PERFORM 9900-ERROR-FORMAT
 14125*                                THRU 9900-EXIT
 14126                 END-IF
 14127              END-IF
 14128           ELSE
 14129              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14130              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14131                 MOVE ER-2661    TO WS-ERROR
 14132*                PERFORM 9900-ERROR-FORMAT
 14133*                                THRU 9900-EXIT
 14134              ELSE
 14135                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14136                    MOVE ER-1570 TO WS-ERROR
 14137                    PERFORM 9900-ERROR-FORMAT
 14138                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 257
* EL050.cbl
 14139                 END-IF
 14140              END-IF
 14141           END-IF
 14142           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14143              MOVE PB-I-JOINT-BIRTHDAY
 14144                                    TO DC-BIN-DATE-1
 14145              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14146              MOVE '1'              TO DC-OPTION-CODE
 14147              PERFORM 8500-DATE-CONVERT
 14148                                    THRU 8500-EXIT
 14149              IF NO-CONVERSION-ERROR
 14150                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14151                    MOVE ER-2661       TO WS-ERROR
 14152*                   PERFORM 9900-ERROR-FORMAT
 14153*                                   THRU 9900-EXIT
 14154                 END-IF
 14155              END-IF
 14156           ELSE
 14157              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14158                (PB-I-AH-TERM / 12)
 14159              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14160                 MOVE ER-2661       TO WS-ERROR
 14161*                PERFORM 9900-ERROR-FORMAT
 14162*                                   THRU 9900-EXIT
 14163              ELSE
 14164                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14165                    MOVE ER-1571 TO WS-ERROR
 14166                    PERFORM 9900-ERROR-FORMAT
 14167                                 THRU 9900-EXIT
 14168                 END-IF
 14169              END-IF
 14170           END-IF
 14171           IF WS-ERROR = ER-2661
 14172              PERFORM 9900-ERROR-FORMAT
 14173                                    THRU 9900-EXIT
 14174           END-IF
 14175        END-IF
 14176     END-IF
 14177*    IF ACCOUNT-AH-CHECKED
 14178*       NEXT SENTENCE
 14179*    ELSE
 14180*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14181*          MOVE ER-2661          TO WS-ERROR
 14182*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14183
 14184     IF ACCOUNT-AH-CHECKED
 14185        NEXT SENTENCE
 14186     ELSE
 14187        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14188           MOVE ER-2663          TO WS-ERROR
 14189           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14190
 14191     IF ACCOUNT-AH-CHECKED OR
 14192        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14193         PB-POLICY-IS-VOIDED
 14194        NEXT SENTENCE
 14195     ELSE
 14196        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 258
* EL050.cbl
 14197           MOVE ER-2667            TO WS-ERROR
 14198           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14199
 14200     IF PB-COMPANY-ID = 'CRI'
 14201         IF WS-ERROR = ER-2667
 14202             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14203
 14204     IF ACCOUNT-AH-CHECKED
 14205        NEXT SENTENCE
 14206     ELSE
 14207        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14208           MOVE ER-2678            TO WS-ERROR
 14209           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14210
 14211     IF CP-ERROR-RATE-FILE-NOTOPEN
 14212         GO TO 3990-FILES-NOT-OPEN.
 14213
 14214 3321-CONTINUE.
 14215     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14216     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14217     IF (PB-COMPANY-ID = 'DCC')
 14218        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14219        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14220                                    PB-I-LF-ALT-PREM-CALC
 14221        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14222        IF WS-AH-BEN-CATEGORY = 'G'
 14223           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14224           + PB-I-ADDL-CLP)
 14225           * (1 + WS-TOL-CLP-PCT)
 14226*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14227        ELSE
 14228           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14229           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14230*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14231        END-IF
 14232        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14233                                 TO PB-I-AH-PREM-CALC
 14234        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14235           MOVE ER-8152          TO WS-ERROR
 14236           PERFORM 9900-ERROR-FORMAT
 14237                                 THRU 9900-EXIT
 14238        ELSE
 14239           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14240                 PB-I-ADDL-CLP)
 14241              MOVE ER-8148       TO WS-ERROR
 14242              PERFORM 9900-ERROR-FORMAT
 14243                                 THRU 9900-EXIT
 14244           END-IF
 14245        END-IF
 14246     END-IF
 14247     IF (PB-COMPANY-ID = 'DCC')
 14248        AND (PB-I-POLICY-IS-MONTHLY)
 14249        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14250        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14251        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14252           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14253        END-IF
 14254     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 259
* EL050.cbl
 14255     IF (PB-COMPANY-ID = 'DCC')
 14256        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14257        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14258        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14259        MOVE ER-2786             TO WS-ERROR
 14260        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14261     END-IF
 14262     MOVE +0                     TO PB-I-AH-CLP
 14263     IF PB-COMPANY-ID = 'DCC'
 14264        IF WS-AH-BEN-CATEGORY = 'D'
 14265           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14266              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14267        ELSE
 14268           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14269              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14270           END-IF
 14271        END-IF
 14272     END-IF
 14273     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14274
 14275     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14276         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14277
 14278     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14279         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14280
 14281     IF PB-COMPANY-ID = 'CRI'
 14282         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14283            PB-I-PAYMENT-AMOUNT = ZERO
 14284             NEXT SENTENCE
 14285         ELSE
 14286             COMPUTE PB-I-AH-PREM-CALC =
 14287                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14288                 (CP-PREMIUM-RATE / 100)
 14289             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14290                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14291                                             PB-I-RATE-DEV-PCT-AH.
 14292
 14293     IF PB-I-AH-RATE  = ZERO
 14294       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14295           NEXT SENTENCE
 14296       ELSE
 14297         MOVE ER-2642            TO WS-ERROR
 14298         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14299
 14300     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14301     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14302     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14303     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14304     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14305     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14306
 14307     IF (PB-COMPANY-ID = 'DCC')
 14308        AND (WS-AH-BEN-CATEGORY = 'G')
 14309        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14310        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14311        IF CP-DEVIATION-CODE NOT = '000'
 14312           MOVE '000'            TO CP-DEVIATION-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 260
* EL050.cbl
 14313           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14314           IF NO-CP-ERROR
 14315              COMPUTE PB-I-DDF-IU-RATE-UP =
 14316              PB-I-AH-CLP - CP-CALC-PREMIUM
 14317           ELSE
 14318              MOVE ER-3057        TO WS-ERROR
 14319              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14320           END-IF
 14321        END-IF
 14322     END-IF
 14323     .
 14324 3335-EDIT-AH-REIN-NSP-RATE.
 14325     IF AH-REIN-NSP-NOT-USED
 14326         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14327
 14328     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14329     IF PB-COMPANY-ID = 'DCC'
 14330         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14331     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14332     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14333     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14334     MOVE PB-SV-STATE            TO CP-STATE.
 14335     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14336     MOVE ZERO                   TO CP-DEVIATION-CODE
 14337                                    CP-RATE-DEV-PCT.
 14338*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14339     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14340     MOVE '3'                    TO CP-PROCESS-TYPE.
 14341     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14342     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14343                                    CP-RATING-BENEFIT-AMT.
 14344     IF CP-STATE-STD-ABBRV = 'OR'
 14345         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14346                                         PB-I-AH-TERM.
 14347     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14348     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14349     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14350     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14351     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14352     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14353                                    CP-REMAINING-TERM
 14354                                    WS-WORK-TERM.
 14355     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14356     IF PB-COMPANY-ID = 'DCC'
 14357        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14358     END-IF
 14359     IF  PB-COMPANY-ID = 'TIC'
 14360         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14361            MOVE ZERO TO CP-CLASS-CODE.
 14362
 14363     IF PB-COMPANY-ID NOT = 'TIC'
 14364          MOVE ZERO          TO CP-CLASS-CODE.
 14365
 14366     MOVE ZERO               TO CP-DEVIATION-CODE.
 14367
 14368     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14369
 14370     MOVE ZERO               TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 261
* EL050.cbl
 14371
 14372     MOVE 'R'                   TO CP-RATE-FILE.
 14373     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14374
 14375     IF CP-ERROR-RATE-NOT-FOUND
 14376         MOVE ER-2645        TO WS-ERROR
 14377         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14378         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14379
 14380     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14381
 14382     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14383     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14384
 14385     IF PB-I-AH-REI-RATE = ZERO
 14386         MOVE ER-2645        TO WS-ERROR
 14387         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14388
 14389
 14390 3340-CALCULATE-PREMIUM-AMT.
 14391
 14392     IF PB-COMPANY-ID = 'NCL'
 14393         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14394             WS-AH-SPECIAL-CALC-CD = 'O')
 14395             GO TO 3999-END-EDIT.
 14396
 14397     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14398                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14399                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14400                         OR 'AHL'
 14401         NEXT SENTENCE
 14402     ELSE
 14403         IF WS-STATE-ABBREVIATION = 'CT'
 14404             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14405                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14406                 COMPUTE PB-I-LF-PREM-CALC =
 14407                                     PB-I-LF-PREM-CALC * .90
 14408                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14409                                     PB-I-LF-ALT-PREM-CALC * .90
 14410                 COMPUTE PB-I-AH-PREM-CALC =
 14411                                     PB-I-AH-PREM-CALC * .90.
 14412
 14413     IF PB-COMP-LF-PREM
 14414        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14415        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14416
 14417     IF PB-COMP-AH-PREM
 14418        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14419
 14420 3340-CHECK-DCC-TOT-FEES.
 14421     IF (PB-COMPANY-ID = 'DCC')
 14422        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14423        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14424        AND (PB-I-POLICY-IS-MONTHLY)
 14425        CONTINUE
 14426     ELSE
 14427        GO TO 3340-EDIT-LF-AH-TOL
 14428     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 262
* EL050.cbl
 14429     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14430     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14431     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14432        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14433           PB-I-RATE-DEV-PCT-LF
 14434     END-IF
 14435     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14436        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14437           PB-I-RATE-DEV-PCT-AH
 14438     END-IF
 14439     MOVE 'N'                    TO CP-BEN-CATEGORY
 14440     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14441
 14442     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14443     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14444     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14445     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14446     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14447     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14448     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14449     MOVE '3'                    TO CP-PROCESS-TYPE.
 14450     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14451     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14452
 14453     MOVE PB-SV-STATE            TO CP-STATE.
 14454     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14455     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14456     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14457     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14458     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14459                                    CP-RATING-BENEFIT-AMT.
 14460     IF CP-STATE-STD-ABBRV = 'OR'
 14461         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14462                                         PB-I-LF-ALT-BENEFIT-AMT.
 14463     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14464     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14465     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14466     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14467     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14468     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14469     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14470     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14471     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14472                                    CP-REMAINING-TERM
 14473                                    CP-LOAN-TERM.
 14474     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14475        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14476           PB-I-LF-PREMIUM-AMT
 14477     end-if
 14478
 14479     IF CP-TRUNCATED-LIFE
 14480        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14481
 14482     IF CP-TERM-IS-DAYS
 14483         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14484     ELSE
 14485         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14486
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 263
* EL050.cbl
 14487     IF PB-COMPANY-ID = 'DCC'
 14488        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14489     END-IF
 14490     IF CP-SPECIAL-CALC-CD = 'H'
 14491         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14492                                    TO CP-ALTERNATE-BENEFIT
 14493         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14494     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14495     MOVE 'R'                    TO CP-RATE-FILE
 14496     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14497     IF NOT CP-ERROR-RATE-NOT-FOUND
 14498        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14499        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14500           AND (CP-BENEFIT-CD (1:1) = 'S')
 14501           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14502                                    PB-I-LF-PREMIUM-AMT
 14503        END-IF
 14504     ELSE
 14505        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14506     END-IF
 14507     .
 14508 3340-EDIT-LF-AH-TOL.
 14509
 14510***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14511***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14512***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14513***
 14514     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14515         PB-I-AH-PREMIUM-AMT
 14516          GIVING WS-CALC-WORK.
 14517
 14518     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14519        AND WS-CALC-WORK NOT = ZERO
 14520         MOVE ER-2649            TO WS-ERROR
 14521         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14522
 14523     SUBTRACT PB-I-LF-PREM-CALC
 14524             FROM PB-I-LF-PREMIUM-AMT
 14525                 GIVING WS-UNSIGN-WRK1.
 14526
 14527     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14528             FROM PB-I-LF-ALT-PREMIUM-AMT
 14529                 GIVING WS-UNSIGN-WRK4.
 14530
 14531     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14532                                + WS-UNSIGN-WRK4.
 14533
 14534     SUBTRACT PB-I-AH-PREM-CALC
 14535             FROM PB-I-AH-PREMIUM-AMT
 14536                 GIVING WS-UNSIGN-WRK2.
 14537
 14538******************************************************************
 14539*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14540******************************************************************
 14541
 14542     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14543         MOVE ZERO TO WS-UNSIGN-WRK1.
 14544
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 264
* EL050.cbl
 14545     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14546         MOVE ZERO TO WS-UNSIGN-WRK2.
 14547
 14548     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14549             GIVING WS-UNSIGN-WRK3.
 14550
 14551 3342-CONTINUE.
 14552
 14553     IF (PB-I-LF-RATE = ZERO  AND
 14554         PB-I-AH-RATE = ZERO)
 14555         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14556            WS-AH-SPECIAL-CALC-CD = 'O'
 14557              NEXT SENTENCE
 14558         ELSE
 14559             GO TO 3345-EDIT-CONTINUE.
 14560
 14561     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14562         NEXT SENTENCE
 14563     ELSE
 14564     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14565        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14566           IF (PB-REISSUED-CERT         OR
 14567               PB-POLICY-IS-DECLINED    OR
 14568               PB-POLICY-IS-VOIDED)
 14569              NEXT SENTENCE
 14570           ELSE
 14571              IF WS-PREM-REJECT-SW = SPACE
 14572                 MOVE ER-2652    TO WS-ERROR
 14573                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14574                 GO TO 3344-CHECK-AH
 14575              ELSE
 14576                 MOVE ER-2650    TO WS-ERROR
 14577                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14578                 GO TO 3344-CHECK-AH.
 14579
 14580***
 14581***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14582***
 14583
 14584     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14585         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14586            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14587             (1 + WS-TOL-LF-PREM-PCT)
 14588         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14589            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14590             (1 - WS-TOL-LF-PREM-PCT)
 14591     ELSE
 14592         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14593         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14594
 14595***
 14596***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14597***
 14598
 14599     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14600         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14601          WS-TOL-LF-PREM.
 14602
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 265
* EL050.cbl
 14603     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14604         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14605          WS-TOL-LF-PREM.
 14606
 14607     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14608        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14609
 14610     IF PB-REISSUED-CERT
 14611        or PB-POLICY-IS-DECLINED
 14612        or PB-POLICY-IS-VOIDED
 14613        continue
 14614     ELSE
 14615        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14616              > WS-TOL-LF-HIGH-PREM-AMT)
 14617           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14618              < WS-TOL-LF-LOW-PREM-AMT))
 14619                      or
 14620           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14621              > WS-TOL-LF-HIGH-PREM-PCT)
 14622           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14623              < WS-TOL-LF-LOW-PREM-PCT))
 14624           IF WS-PREM-REJECT-SW = SPACE
 14625              MOVE ER-2652       TO WS-ERROR
 14626              PERFORM 9900-ERROR-FORMAT
 14627                                 THRU 9900-EXIT
 14628           ELSE
 14629              MOVE ER-2650       TO WS-ERROR
 14630              PERFORM 9900-ERROR-FORMAT
 14631                                 THRU 9900-EXIT
 14632           end-if
 14633        end-if
 14634     end-if
 14635
 14636*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14637*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14638*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14639*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14640
 14641     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14642        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14643                      OR
 14644           ((PB-COMPANY-ID = 'DCC')
 14645           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14646           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14647           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14648        END-IF
 14649     END-IF
 14650
 14651     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14652        IF WS-COMP-MAX-CAP GREATER THAN +0
 14653           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14654              IF (PB-REISSUED-CERT         OR
 14655                  PB-POLICY-IS-DECLINED    OR
 14656                  PB-POLICY-IS-VOIDED)
 14657                 NEXT SENTENCE
 14658              ELSE
 14659                  MOVE ER-2646   TO  WS-ERROR
 14660                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 266
* EL050.cbl
 14661
 14662 3344-CVL-TOLERANCE-CHECK.
 14663
 14664      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14665          GO TO 3344-CHECK-AH.
 14666
 14667      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14668          GO TO 3344-CHECK-AH.
 14669
 14670      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14671                                     WS-UNSIGN-WRK6.
 14672
 14673      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14674          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14675                                 + PB-I-LF-PREMIUM-AMT
 14676                                 - PB-I-LF-PREM-CALC.
 14677
 14678      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14679          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14680                                 + PB-I-LF-ALT-PREMIUM-AMT
 14681                                 - PB-I-LF-ALT-PREM-CALC.
 14682
 14683      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14684          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14685              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14686                 MOVE ER-2652    TO  WS-ERROR
 14687                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14688              ELSE
 14689                 MOVE ER-2650    TO  WS-ERROR
 14690                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14691
 14692      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14693          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14694              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14695                 MOVE ER-2652    TO  WS-ERROR
 14696                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14697              ELSE
 14698                 MOVE ER-2650    TO  WS-ERROR
 14699                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14700
 14701 3344-CHECK-AH.
 14702
 14703****************************************************************
 14704***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14705***
 14706
 14707     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14708         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14709             (1 + WS-TOL-AH-PREM-PCT)
 14710         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14711             (1 - WS-TOL-AH-PREM-PCT)
 14712     ELSE
 14713         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14714         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14715
 14716***
 14717***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14718***
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 267
* EL050.cbl
 14719
 14720     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14721         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14722
 14723     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14724         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14725
 14726     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14727        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14728
 14729     IF (PB-REISSUED-CERT)
 14730        OR (PB-POLICY-IS-DECLINED)
 14731        OR (PB-POLICY-IS-VOIDED)
 14732        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14733        CONTINUE
 14734     ELSE
 14735        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14736              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14737                          or
 14738           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14739              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14740           IF WS-PREM-REJECT-SW = SPACE
 14741              MOVE ER-3052       TO WS-ERROR
 14742              PERFORM 9900-ERROR-FORMAT
 14743                                 THRU 9900-EXIT
 14744           ELSE
 14745              MOVE ER-3050       TO WS-ERROR
 14746              PERFORM 9900-ERROR-FORMAT
 14747                                 THRU 9900-EXIT
 14748           END-IF
 14749        END-IF
 14750     END-IF
 14751     if (pb-company-id = 'DCC')
 14752        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14753        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14754        and (pb-i-policy-is-monthly)
 14755        compute ws-tol-ah-high-prem-amt =
 14756           pb-i-tot-fees-calc + ws-tol-ah-prem
 14757        compute ws-tol-ah-low-prem-amt =
 14758           pb-i-tot-fees-calc - ws-tol-ah-prem
 14759        if ws-tol-ah-prem-pct > zeros
 14760           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14761              (1 + ws-tol-ah-prem-pct)
 14762           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14763              (1 - ws-tol-ah-prem-pct)
 14764        else
 14765           move +9999999.99      to ws-tol-ah-high-prem-pct
 14766           move +0               to ws-tol-ah-low-prem-pct
 14767        end-if
 14768        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14769            or
 14770           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14771                          or
 14772           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14773           or
 14774           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14775            move er-3049         to ws-error
 14776           perform 9900-error-format
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 268
* EL050.cbl
 14777                                 thru 9900-exit
 14778
 14779        end-if
 14780     end-if
 14781     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14782         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14783             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14784             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14785
 14786     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14787        IF WS-COMP-MAX-CAP GREATER THAN +0
 14788           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14789              IF (PB-REISSUED-CERT         OR
 14790                  PB-POLICY-IS-DECLINED    OR
 14791                  PB-POLICY-IS-VOIDED)
 14792                 NEXT SENTENCE
 14793              ELSE
 14794                  MOVE ER-2646   TO  WS-ERROR
 14795                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14796
 14797     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14798        (WS-COMP-MAX-CAP EQUAL +0)
 14799           GO TO 3345-EDIT-CONTINUE.
 14800
 14801     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14802        GREATER THAN WS-COMP-MAX-CAP
 14803           MOVE ER-2646          TO  WS-ERROR
 14804           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14805
 14806 3345-EDIT-CONTINUE.
 14807
 14808*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14809*       IF PB-ENTRY-BATCH   NUMERIC
 14810*          IF PB-ISSUE
 14811*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14812*          ELSE
 14813*              IF PB-CANCELLATION
 14814*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14815
 14816*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14817*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14818*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14819*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14820*        ELSE
 14821*            MOVE  ER-1909            TO  WS-ERROR
 14822*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14823
 14824     IF PB-I-POLICY-ACCEPTED
 14825        IF PB-POLICY-IS-DECLINED  OR
 14826           PB-REISSUED-CERT  OR
 14827           PB-REIN-ONLY-CERT  OR
 14828           PB-POLICY-IS-VOIDED
 14829            MOVE  ER-1891         TO  WS-ERROR
 14830            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14831        ELSE
 14832            MOVE SPACE            TO  PB-BATCH-ENTRY
 14833            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14834
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 269
* EL050.cbl
 14835     IF PB-I-POLICY-DECLINED
 14836        IF PB-REISSUED-CERT  OR
 14837           PB-REIN-ONLY-CERT  OR
 14838           PB-POLICY-IS-VOIDED
 14839            MOVE  ER-1906         TO  WS-ERROR
 14840            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14841        ELSE
 14842            MOVE  'D'             TO  PB-BATCH-ENTRY
 14843                                      PB-I-ENTRY-STATUS.
 14844
 14845     IF PB-I-NEEDS-UNDERWRITING
 14846        IF PB-POLICY-IS-DECLINED OR
 14847           PB-REISSUED-CERT  OR
 14848           PB-REIN-ONLY-CERT  OR
 14849           PB-POLICY-IS-VOIDED
 14850            MOVE  ER-1907         TO  WS-ERROR
 14851            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14852        ELSE
 14853            MOVE 'U'              TO  PB-BATCH-ENTRY
 14854                                      PB-I-ENTRY-STATUS.
 14855
 14856     IF PB-NEEDS-UNDERWRITING
 14857        MOVE  ER-1901             TO  WS-ERROR
 14858        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14859     IF PB-COMPANY-ID = 'DCC'
 14860        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14861        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14862        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14863           AND (NOT WS-LF-CASH))
 14864                           OR
 14865           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14866           AND (NOT WS-AH-CASH)))
 14867                       AND
 14868           (PB-I-ENTRY-STATUS NOT = '5')
 14869           MOVE 'M'              TO PB-BATCH-ENTRY
 14870                                    PB-I-ENTRY-STATUS
 14871        END-IF
 14872     END-IF
 14873     IF  PB-COMPANY-ID NOT = 'NCL'
 14874         GO TO 3999-END-EDIT.
 14875
 14876     IF PB-REISSUED-CERT  OR
 14877        PB-POLICY-IS-DECLINED  OR
 14878        PB-POLICY-IS-VOIDED  OR
 14879        PB-I-OB
 14880         GO TO 3999-END-EDIT.
 14881
 14882     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14883         MOVE  ER-2644            TO  WS-ERROR
 14884         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14885         GO TO 3999-END-EDIT.
 14886
 14887     MOVE 'N'                     TO  FORM-MASTER-SW.
 14888     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14889
 14890     IF NOT FORM-MASTER-FOUND
 14891         GO TO 3999-END-EDIT.
 14892
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 270
* EL050.cbl
 14893     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14894                                      FORM-MASTER-AH-SW.
 14895
 14896     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14897         MOVE  +1                 TO SUB6
 14898         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14899
 14900     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14901         MOVE  +1                 TO SUB6
 14902         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14903
 14904     IF LF-FORM-MASTER-FOUND  OR
 14905        AH-FORM-MASTER-FOUND
 14906         GO TO 3360-CHECK-FORM-LIMITS
 14907     ELSE
 14908         GO TO 3999-END-EDIT.
 14909
 14910******************************************************************
 14911*                  3350-GET-ERFORM                               *
 14912*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14913*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14914******************************************************************
 14915
 14916 3350-GET-ERFORM.
 14917
 14918     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14919         GO TO  3350-ERFORM-GETMAIN.
 14920
 14921     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14922     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14923     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14924     MOVE 'Y'                     TO FORM-MASTER-SW.
 14925
 14926     IF PB-CANCELLATION
 14927         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14928            PB-SV-STATE          EQUAL   FO-STATE       AND
 14929            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14930              GO TO 3350-EXIT
 14931         ELSE
 14932             NEXT SENTENCE
 14933     ELSE
 14934         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14935            PB-SV-STATE          EQUAL   FO-STATE       AND
 14936            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14937              GO TO 3350-EXIT.
 14938
 14939 3350-ERFORM-GETMAIN.
 14940
 14941     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14942     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14943
 14944 3350-ERFORM-READ.
 14945
 14946     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14947     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14948     IF PB-CANCELLATION
 14949         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14950     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 271
* EL050.cbl
 14951         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14952     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14953
 14954     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14955
 14956     IF FORM-MASTER-FOUND
 14957       IF PB-CANCELLATION
 14958          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14959             PB-SV-STATE          EQUAL   FO-STATE       AND
 14960             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14961              GO  TO 3350-EXIT
 14962          ELSE
 14963              NEXT SENTENCE
 14964       ELSE
 14965          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14966             PB-SV-STATE          EQUAL   FO-STATE       AND
 14967             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14968              GO  TO 3350-EXIT.
 14969
 14970     MOVE  'N'                    TO  FORM-MASTER-SW.
 14971     MOVE  ER-1895                TO  WS-ERROR.
 14972     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14973
 14974 3350-EXIT.
 14975      EXIT.
 14976
 14977******************************************************************
 14978*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14979*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14980*   VALID FOR THE POLICY FORM USED.                              *
 14981******************************************************************
 14982
 14983 3355-EDIT-FORM-LF-BENEFITS.
 14984
 14985     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14986        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14987         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14988         GO TO   3355-EXIT.
 14989
 14990     IF  SUB6    LESS THAN   +40
 14991         ADD  +1      TO  SUB6
 14992         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14993
 14994     MOVE  ER-1896         TO  WS-ERROR.
 14995     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14996
 14997 3355-EXIT.
 14998      EXIT.
 14999
 15000******************************************************************
 15001*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15002*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15003*   VALID FOR THE POLICY FORM USED.                              *
 15004******************************************************************
 15005
 15006 3356-EDIT-FORM-AH-BENEFITS.
 15007
 15008     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 272
* EL050.cbl
 15009        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15010         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15011         GO TO  3356-EXIT.
 15012
 15013      IF  SUB6    LESS THAN     +40
 15014          ADD  +1      TO  SUB6
 15015          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15016
 15017     MOVE  ER-1897         TO  WS-ERROR.
 15018     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15019
 15020 3356-EXIT.
 15021      EXIT.
 15022
 15023******************************************************************
 15024*                  3357-BENEFIT-SEARCH                           *
 15025*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15026*   CANCELLATIONS ONLY.                                          *
 15027******************************************************************
 15028 3357-BENEFIT-SEARCH.
 15029     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15030         MOVE +1                          TO SUB6
 15031         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15032
 15033     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15034         MOVE +1                          TO SUB6
 15035         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15036
 15037 3357-EXIT.
 15038     EXIT.
 15039
 15040******************************************************************
 15041*                  3358-BENEFIT-LIFE-SEARCH                      *
 15042*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15043*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15044*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15045******************************************************************
 15046 3358-BENEFIT-LIFE-SEARCH.
 15047     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15048       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15049         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15050           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15051              IF FO-PLAN-REFUND-METHOD (SUB6)
 15052                     IS GREATER THAN SPACES
 15053                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15054                                          WS-LF-REFUND-CALC
 15055                 GO TO 3358-EXIT.
 15056
 15057     IF SUB6 LESS THAN +40
 15058         ADD +1                 TO SUB6
 15059         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15060
 15061 3358-EXIT.
 15062     EXIT.
 15063******************************************************************
 15064*                  3359-BENEFIT-AH-SEARCH                        *
 15065*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15066*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 273
* EL050.cbl
 15067*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15068******************************************************************
 15069 3359-BENEFIT-AH-SEARCH.
 15070     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15071       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15072         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15073           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15074              IF FO-PLAN-REFUND-METHOD (SUB6)
 15075                      IS GREATER THAN SPACES
 15076                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15077                                          WS-AH-REFUND-CALC
 15078                 GO TO 3359-EXIT.
 15079
 15080     IF SUB6 LESS THAN +40
 15081         ADD +1                 TO SUB6
 15082         GO TO 3359-BENEFIT-AH-SEARCH.
 15083
 15084 3359-EXIT.
 15085     EXIT.
 15086
 15087******************************************************************
 15088*                  3360-CHECK-FORM-LIMITS                        *
 15089*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15090*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15091******************************************************************
 15092
 15093 3360-CHECK-FORM-LIMITS.
 15094
 15095     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15096         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15097
 15098     IF NOT LF-FORM-MASTER-FOUND
 15099         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15100
 15101 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15102
 15103     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15104       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15105        WS-LF-JOINT-INDICATOR = 'J'  AND
 15106        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15107         IF PB-COMPANY-ID = 'NCL'
 15108            MOVE  ER-1911          TO  WS-ERROR
 15109            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15110         ELSE
 15111            MOVE  ER-1892          TO  WS-ERROR
 15112            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15113
 15114 3360-CHECK-FORM-LF-ATT-AGE.
 15115
 15116     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15117
 15118     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15119         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15120         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15121            IF PB-COMPANY-ID = 'NCL'
 15122                MOVE  ER-1913      TO  WS-ERROR
 15123                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15124            ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 274
* EL050.cbl
 15125                MOVE  ER-1894      TO  WS-ERROR
 15126                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15127
 15128 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15129
 15130     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15131         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15132         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15133            IF PB-COMPANY-ID = 'NCL'
 15134                MOVE  ER-1914      TO  WS-ERROR
 15135                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15136            ELSE
 15137                MOVE  ER-1899      TO  WS-ERROR
 15138                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15139
 15140 3360-CHECK-FORM-LF-TERM-BAMT.
 15141
 15142     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15143         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15144         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15145           IF  PB-COMPANY-ID = 'NCL'
 15146               MOVE  ER-1916       TO  WS-ERROR
 15147               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15148           ELSE
 15149               MOVE  ER-1902       TO  WS-ERROR
 15150               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15151
 15152     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15153                                    PB-I-LF-ALT-BENEFIT-AMT.
 15154
 15155     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15156         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15157         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15158             IF  PB-COMPANY-ID = 'NCL'
 15159                 MOVE  ER-1918     TO  WS-ERROR
 15160                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15161             ELSE
 15162                 MOVE  ER-1904     TO  WS-ERROR
 15163                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15164
 15165******************************************************************
 15166*                  3360-CHECK-FORM-AH-LIMITS                     *
 15167*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15168*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15169******************************************************************
 15170
 15171 3360-CHECK-FORM-AH-LIMITS.
 15172
 15173     IF NOT AH-FORM-MASTER-FOUND
 15174         GO TO 3999-END-EDIT.
 15175
 15176 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15177
 15178     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15179       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15180        WS-AH-JOINT-INDICATOR = 'J'  AND
 15181        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15182         IF PB-COMPANY-ID = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 275
* EL050.cbl
 15183            MOVE  ER-1912          TO  WS-ERROR
 15184            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15185         ELSE
 15186            MOVE  ER-1893          TO  WS-ERROR
 15187            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15188
 15189 3360-CHECK-FORM-AH-ATT-AGE.
 15190
 15191     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15192
 15193     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15194         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15195         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15196            IF PB-COMPANY-ID = 'NCL'
 15197                MOVE  ER-1913      TO  WS-ERROR
 15198                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15199            ELSE
 15200                MOVE  ER-1894      TO  WS-ERROR
 15201                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15202
 15203 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15204
 15205     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15206         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15207         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15208            IF PB-COMPANY-ID = 'NCL'
 15209                MOVE  ER-1915      TO  WS-ERROR
 15210                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15211            ELSE
 15212                MOVE  ER-1900      TO  WS-ERROR
 15213                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15214
 15215 3360-CHECK-FORM-AH-TERM-BAMT.
 15216
 15217     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15218         FO-AH-MAX-TERM    GREATER THAN  +0
 15219         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15220             IF  PB-COMPANY-ID = 'NCL'
 15221                 MOVE  ER-1917     TO  WS-ERROR
 15222                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15223             ELSE
 15224                  MOVE  ER-1903    TO  WS-ERROR
 15225                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15226
 15227     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15228         FO-MAX-AH-AMT    GREATER THAN  +0
 15229         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15230             IF  PB-COMPANY-ID = 'NCL'
 15231                 MOVE  ER-1919     TO  WS-ERROR
 15232                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15233             ELSE
 15234                 MOVE  ER-1905     TO  WS-ERROR
 15235                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15236
 15237     GO TO 3999-END-EDIT.
 15238
 15239******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 276
* EL050.cbl
 15241******************************************************************
 15242*                  E D I T   C A N C E L                         *
 15243******************************************************************
 15244
 15245 3700-EDIT-CANCEL.
 15246     IF PB-COMPANY-ID = 'DMD'
 15247         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15248                                         WS-RES-MUNI-TAX
 15249                                         PB-CI-STATE-TAX
 15250                                         PB-CI-MUNI-TAX
 15251         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15252
 15253*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15254*       IF PB-ENTRY-BATCH  NUMERIC
 15255*          IF PB-CANCELLATION
 15256*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15257*          ELSE
 15258*             IF PB-ISSUE
 15259*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15260
 15261     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15262        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15263     END-IF
 15264*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15265*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15266
 15267     IF CM-ENTRY-STATUS = 'V'
 15268        MOVE ER-2780             TO WS-ERROR
 15269        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15270        GO TO 3999-END-EDIT.
 15271
 15272     IF CM-ENTRY-STATUS = 'D'
 15273        MOVE ER-2781             TO WS-ERROR
 15274        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15275        GO TO 3999-END-EDIT.
 15276
 15277     IF CM-ENTRY-STATUS = 'U'
 15278        MOVE ER-2782             TO WS-ERROR
 15279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15280
 15281***************************************************************
 15282*                                                             *
 15283*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15284*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15285*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15286*   OF ANOTHER COVERAGE.                                      *
 15287*                                                             *
 15288***************************************************************
 15289
 15290     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15291                                    PB-C-AH-CANCEL-VOID-SW.
 15292
 15293     IF PB-C-LF-CANCEL-AMT = ZERO
 15294        NEXT SENTENCE
 15295     ELSE
 15296        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15297           AND
 15298           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 277
* EL050.cbl
 15299               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15300               MOVE ER-2745           TO WS-ERROR
 15301               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15302
 15303     IF PB-C-AH-CANCEL-AMT = ZERO
 15304        NEXT SENTENCE
 15305     ELSE
 15306        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15307           AND
 15308           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15309               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15310               MOVE ER-2745           TO WS-ERROR
 15311               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15312
 15313     IF WS-LF-EARNINGS-CALC = '4'
 15314        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15315
 15316     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15317     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15318     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15319     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15320     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15321     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15322
 15323     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15324                                      PB-C-AH-REF-CALC.
 15325     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15326
 15327******************************************************************
 15328*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15329*             TO VALIDATE COVERAGE.                              *
 15330******************************************************************
 15331
 15332     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15333        PB-C-LF-CANCEL-AMT = ZEROS
 15334          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15335      ELSE
 15336          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15337
 15338     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15339        PB-C-AH-CANCEL-AMT = ZEROS
 15340          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15341      ELSE
 15342          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15343
 15344     EVALUATE TRUE
 15345         WHEN PB-CANCEL-FORCE             OR
 15346              PB-CANCEL-DATE-FORCED       OR
 15347              PB-FORCE-OFF
 15348                  IF PB-COMPANY-ID = 'ACE'
 15349                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15350                  END-IF
 15351         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15352               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15353              (PB-COMPANY-ID = 'ACE' )
 15354                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15355         WHEN OTHER
 15356              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 278
* EL050.cbl
 15357                 MOVE ER-2794              TO WS-ERROR
 15358              ELSE
 15359                 MOVE ER-2749              TO WS-ERROR
 15360              END-IF
 15361              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15362     END-EVALUATE.
 15363
 15364
 15365*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15366*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15367*            MOVE  ER-1909            TO  WS-ERROR
 15368*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15369*        ELSE
 15370*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15371
 15372     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15373     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15374        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15375     ELSE
 15376        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15377     END-IF
 15378     .
 15379 3705-EDIT-CANCEL-DT.
 15380
 15381     IF LF-COVERAGE-CANCELLED
 15382        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15383         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15384         MOVE WS-CURRENT-MONTH-END
 15385                                 TO DC-BIN-DATE-2
 15386         SET ELAPSED-BETWEEN-BIN TO TRUE
 15387*        MOVE 1                  TO DC-OPTION-CODE
 15388         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15389         IF DATE-CONVERSION-ERROR
 15390            NEXT SENTENCE
 15391          ELSE
 15392             IF DC-ELAPSED-DAYS GREATER +180
 15393                IF PB-CANCEL-DATE-FORCED  OR
 15394                   PB-CANCEL-DATE-FORCED-NO-FEE
 15395                      MOVE ER-2751  TO WS-ERROR
 15396                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15397                 ELSE
 15398                   MOVE ER-2752  TO WS-ERROR
 15399                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15400
 15401     IF AH-COVERAGE-CANCELLED
 15402        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15403         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15404         MOVE WS-CURRENT-MONTH-END
 15405                                 TO DC-BIN-DATE-2
 15406         SET ELAPSED-BETWEEN-BIN TO TRUE
 15407*        MOVE 1                  TO DC-OPTION-CODE
 15408         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15409         IF DATE-CONVERSION-ERROR
 15410            NEXT SENTENCE
 15411          ELSE
 15412             IF DC-ELAPSED-DAYS GREATER +180
 15413                IF PB-CANCEL-DATE-FORCED OR
 15414                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 279
* EL050.cbl
 15415                      MOVE ER-2751  TO WS-ERROR
 15416                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15417                 ELSE
 15418                   MOVE ER-2752  TO WS-ERROR
 15419                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15420
 15421     IF WS-ERROR = ER-2752
 15422        AND (PB-COMPANY-ID = 'ABL'
 15423         OR  PB-COMPANY-ID = 'FGL'
 15424         OR  PB-COMPANY-ID = 'IST'
 15425         OR  PB-COMPANY-ID = 'JHL'
 15426         OR  PB-COMPANY-ID = 'LAP'
 15427         OR  PB-COMPANY-ID = 'LBL'
 15428         OR  PB-COMPANY-ID = 'NCB'
 15429         OR  PB-COMPANY-ID = 'NLI'
 15430         OR  PB-COMPANY-ID = 'OFI'
 15431         OR  PB-COMPANY-ID = 'PLI'
 15432         OR  PB-COMPANY-ID = 'TAO'
 15433         OR  PB-COMPANY-ID = 'TIC'
 15434         OR  PB-COMPANY-ID = 'HER'
 15435         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15436         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15437            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15438            MOVE ER-2762     TO WS-ERROR
 15439            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15440
 15441     IF LF-COVERAGE-CANCELLED
 15442        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15443        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15444             MOVE ER-2733         TO WS-ERROR
 15445             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15446
 15447     IF AH-COVERAGE-CANCELLED
 15448        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15449        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15450              MOVE ER-2733        TO WS-ERROR
 15451              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15452
 15453     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15454        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15455        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15456           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15457            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15458              IF PB-COMPANY-ID NOT = 'LAP'
 15459               MOVE ER-2704            TO WS-ERROR
 15460               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15461
 15462     IF CERT-WAS-NOT-FOUND
 15463         GO TO 3999-END-EDIT.
 15464
 15465     IF PB-COMPANY-ID EQUAL 'CDC'
 15466        IF LF-COVERAGE-CANCELLED
 15467           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15468            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15469            MOVE PB-C-LF-CANCEL-DT
 15470                                 TO DC-BIN-DATE-2
 15471            SET ELAPSED-BETWEEN-BIN TO TRUE
 15472*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 280
* EL050.cbl
 15473            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15474            IF DATE-CONVERSION-ERROR
 15475               NEXT SENTENCE
 15476             ELSE
 15477                IF DC-ELAPSED-DAYS GREATER +60
 15478                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15479
 15480     IF PB-COMPANY-ID EQUAL 'CDC'
 15481        IF AH-COVERAGE-CANCELLED
 15482           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15483            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15484            MOVE PB-C-AH-CANCEL-DT
 15485                                 TO DC-BIN-DATE-2
 15486            MOVE +0              TO DC-ELAPSED-DAYS
 15487                                    DC-ELAPSED-MONTHS
 15488            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15489*           MOVE 1               TO DC-OPTION-CODE
 15490            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15491            IF DATE-CONVERSION-ERROR
 15492               NEXT SENTENCE
 15493             ELSE
 15494                IF DC-ELAPSED-DAYS GREATER +60
 15495                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15496
 15497     MOVE +0                     TO DC-ELAPSED-DAYS
 15498                                    DC-ELAPSED-MONTHS.
 15499
 15500     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15501        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15502          MOVE 'Z'                TO PB-CI-OB-FLAG
 15503          MOVE ER-2767            TO WS-ERROR
 15504          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15505          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15506          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15507          GO TO 3775-OVER-REF-CHK
 15508        ELSE
 15509          MOVE ZEROS              TO PB-CI-LIVES
 15510                                     PB-C-LIVES
 15511          IF PB-CI-OB-FLAG NOT = 'B'
 15512             MOVE SPACE           TO PB-CI-OB-FLAG.
 15513
 15514     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15515         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15516     ELSE
 15517         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15518
 15519     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15520        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15521            MOVE ER-2760         TO WS-ERROR
 15522            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15523
 15524     IF LF-COVERAGE-CANCELLED
 15525        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15526         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15527            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15528               MOVE ER-2774       TO WS-ERROR
 15529               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15530
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 281
* EL050.cbl
 15531     IF AH-COVERAGE-CANCELLED
 15532        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15533         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15534            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15535               MOVE ER-2775       TO WS-ERROR
 15536               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15537
 15538     IF LF-COVERAGE-CANCELLED
 15539        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15540         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15541            MOVE ER-2776         TO WS-ERROR
 15542            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15543
 15544     IF AH-COVERAGE-CANCELLED
 15545        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15546         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15547            MOVE ER-2777         TO WS-ERROR
 15548            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15549     IF LF-COVERAGE-CANCELLED
 15550        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15551        if pb-ci-lf-expire-dt = low-values or spaces
 15552           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15553           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15554           MOVE PB-CI-EXTENTION-DAYS
 15555                                 TO DC-ELAPSED-DAYS
 15556           SET BIN-PLUS-ELAPSED  TO TRUE
 15557           PERFORM 8500-DATE-CONVERT
 15558                                 THRU 8500-EXIT
 15559           IF DATE-CONVERSION-ERROR
 15560              move low-values    to dc-bin-date-2
 15561           end-if
 15562        else
 15563           move pb-ci-lf-expire-dt
 15564                                 to dc-bin-date-2
 15565        end-if
 15566        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15567           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15568                             OR  'FIA'
 15569              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15570           ELSE
 15571              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15572              MOVE ER-2731       TO WS-ERROR
 15573              PERFORM 9900-ERROR-FORMAT
 15574                                 THRU 9900-EXIT
 15575           end-if
 15576        end-if
 15577     end-if
 15578*    IF LF-COVERAGE-CANCELLED
 15579*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15580*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15581*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15582*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15583*        SET BIN-PLUS-ELAPSED      TO TRUE
 15584*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15585*        IF DATE-CONVERSION-ERROR
 15586*           NEXT SENTENCE
 15587*         ELSE
 15588*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 282
* EL050.cbl
 15589*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15590*                            OR  'FIA'
 15591*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15592*              ELSE
 15593*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15594*               MOVE ER-2731       TO WS-ERROR
 15595*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15596     .
 15597 3705-EDIT-AH-CANCEL-DT.
 15598     IF AH-COVERAGE-CANCELLED
 15599        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15600        if pb-ci-AH-expire-dt = low-values or spaces
 15601           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15602           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15603           MOVE PB-CI-EXTENTION-DAYS
 15604                                 TO DC-ELAPSED-DAYS
 15605           SET BIN-PLUS-ELAPSED  TO TRUE
 15606           PERFORM 8500-DATE-CONVERT
 15607                                 THRU 8500-EXIT
 15608           IF DATE-CONVERSION-ERROR
 15609              move low-values    to dc-bin-date-2
 15610           end-if
 15611        else
 15612           move pb-ci-ah-expire-dt
 15613                                 to dc-bin-date-2
 15614        end-if
 15615        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15616           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15617                             OR  'FIA'
 15618              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15619           ELSE
 15620              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15621              MOVE ER-2771       TO WS-ERROR
 15622              PERFORM 9900-ERROR-FORMAT
 15623                                 THRU 9900-EXIT
 15624           end-if
 15625        end-if
 15626     end-if
 15627*    IF AH-COVERAGE-CANCELLED
 15628*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15629*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15630*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15631*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15632**       MOVE 6                    TO DC-OPTION-CODE
 15633*        SET BIN-PLUS-ELAPSED      TO TRUE
 15634*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15635*        IF DATE-CONVERSION-ERROR
 15636*           NEXT SENTENCE
 15637*         ELSE
 15638*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15639*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15640*                             OR 'FIA'
 15641*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15642*             ELSE
 15643*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15644*              MOVE ER-2771       TO WS-ERROR
 15645*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15646     .
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 283
* EL050.cbl
 15647 3705-EDIT-CONTINUED.
 15648
 15649*    IF LF-COVERAGE-CANCELLED
 15650*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15651*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15652*            MOVE ER-2727         TO WS-ERROR
 15653*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15654*
 15655*    IF AH-COVERAGE-CANCELLED
 15656*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15657*        IF PB-COMPANY-ID = 'ACE'
 15658*           MOVE ER-2727        TO WS-ERROR
 15659*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15660*        ELSE
 15661*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15662*              MOVE ER-2727     TO WS-ERROR
 15663*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15664
 15665     IF PB-COMPANY-ID = 'ACE'
 15666       IF AH-COVERAGE-CANCELLED
 15667         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15668           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15669              MOVE ER-2732      TO WS-ERROR
 15670              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15671
 15672     IF PB-COMPANY-ID      EQUAL   'HER'
 15673        IF WS-ERROR        EQUAL   ER-2727
 15674            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15675            MOVE  ER-2725          TO  WS-ERROR
 15676            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15677
 15678     IF PB-C-CLAIM-CREATED-CANCEL
 15679            MOVE ER-2748         TO WS-ERROR
 15680            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15681
 15682     IF PB-C-LAST-NAME NOT = SPACES
 15683         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15684            MOVE ER-2747         TO WS-ERROR
 15685            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15686
 15687 3710-EDIT-LUMP-SUM-PRIOR.
 15688
 15689     IF AH-COVERAGE-CANCELLED
 15690         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15691             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15692                MOVE ER-2735    TO WS-ERROR
 15693                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15694
 15695     IF LF-COVERAGE-CANCELLED
 15696         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15697             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15698                MOVE ER-2735    TO WS-ERROR
 15699                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15700
 15701 3710-EDIT-PRIOR-DEATH.
 15702
 15703*    IF LF-COVERAGE-CANCELLED
 15704*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 284
* EL050.cbl
 15705*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15706*           (NOT PB-CI-OB)
 15707*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15708*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15709*                   MOVE ER-2732  TO WS-ERROR
 15710*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15711*
 15712*    IF AH-COVERAGE-CANCELLED
 15713*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15714*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15715*           (NOT PB-CI-OB)
 15716*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15717*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15718*                   MOVE ER-2732  TO WS-ERROR
 15719*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15720
 15721     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15722         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15723            (NOT PB-COMP-LF-CANCEL)
 15724             NEXT SENTENCE
 15725         ELSE
 15726           IF PB-C-LF-CANCEL-VOIDED
 15727              NEXT SENTENCE
 15728           ELSE
 15729              MOVE ER-2753      TO WS-ERROR
 15730              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15731
 15732     IF CANCEL-FUTURE-DT
 15733         GO TO 3999-END-EDIT.
 15734
 15735 3715-GET-REMAIN-TERM-LF.
 15736
 15737     IF NO-LF-BENEFIT-MATCH  OR
 15738        WS-LF-BENEFIT-CD = ZEROS
 15739        GO TO 3730-GET-AH-REMAIN-TERM.
 15740
 15741     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15742     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15743     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15744     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15745     MOVE PB-SV-STATE            TO CP-STATE.
 15746     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15747     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15748     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15749     MOVE '2'                    TO CP-PROCESS-TYPE.
 15750     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15751     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15752     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15753     IF (PB-COMPANY-ID = 'CID')
 15754        AND (CP-STATE-STD-ABBRV = 'WI')
 15755        MOVE '7'                 TO CP-REM-TERM-METHOD
 15756        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15757     ELSE
 15758        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15759        MOVE WS-REM-TRM-CALC-OPTION
 15760                                 TO CP-REM-TRM-CALC-OPTION
 15761     END-IF
 15762**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 285
* EL050.cbl
 15763     IF (PB-COMPANY-ID = 'CID')
 15764        AND (CP-STATE-STD-ABBRV = 'MO')
 15765        AND (PB-CERT-EFF-DT >= X'9B41')
 15766        AND (PB-CERT-EFF-DT <= X'A2FB')
 15767        MOVE '7'                 TO CP-REM-TERM-METHOD
 15768        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15769     END-IF
 15770     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15771                                    CP-LOAN-TERM.
 15772     IF CP-TRUNCATED-LIFE
 15773        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15774
 15775     IF CP-TERM-IS-DAYS
 15776         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15777     ELSE
 15778         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15779
 15780     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15781
 15782     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15783
 15784     IF LF-COVERAGE-CANCELLED
 15785        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15786        NEXT SENTENCE
 15787      ELSE
 15788          GO TO 3730-GET-AH-REMAIN-TERM.
 15789
 15790 3720-GET-LF-REFUND.
 15791
 15792     IF PB-C-LF-CANCEL-VOIDED OR
 15793        PB-C-AH-CANCEL-VOIDED
 15794        GO TO 3780-UPDATE-CANCEL-CERT.
 15795
 15796     IF PB-COMPANY-ID EQUAL 'BOA'
 15797         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15798         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15799         GO TO 3730-GET-AH-REMAIN-TERM.
 15800
 15801     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15802        (WS-AH-SPECIAL-CALC-CD = 'M')
 15803         MOVE ER-2767            TO WS-ERROR
 15804         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15805         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15806         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15807         GO TO 3780-UPDATE-CANCEL-CERT.
 15808
 15809     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15810
 15811     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15812     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15813     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15814     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15815     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15816     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15817     IF (PB-COMPANY-ID = 'DCC')
 15818        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15819        IF PDEF-MASTER-FOUND
 15820           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 286
* EL050.cbl
 15821              (V1 > +8)
 15822              OR (PD-PROD-CODE (V1) = 'L')
 15823           END-PERFORM
 15824           IF V1 < +9
 15825              MOVE PD-MAX-AMT (V1)
 15826                           TO CP-R-MAX-TOT-BEN
 15827                              EC-AM-LF-MAX-TOT-BEN
 15828           END-IF
 15829        ELSE
 15830        MOVE ' '                 TO PDEF-MASTER-SW
 15831        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15832        MOVE PB-STATE            TO ERPDEF-STATE
 15833        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15834        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15835        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15836        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15837        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15838        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15839        IF PDEF-MASTER-FOUND
 15840           MOVE 'N'              TO PDEF-MASTER-SW
 15841           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15842           IF PDEF-MASTER-FOUND
 15843              IF (ERPDEF-KEY-SAVE (1:16) =
 15844                           PD-CONTROL-PRIMARY (1:16))
 15845                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15846                 CONTINUE
 15847              ELSE
 15848                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15849                 IF (ERPDEF-KEY-SAVE (1:16) =
 15850                           PD-CONTROL-PRIMARY (1:16))
 15851                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15852                    CONTINUE
 15853                 ELSE
 15854                    MOVE 'N'     TO PDEF-MASTER-SW
 15855                 END-IF
 15856              END-IF
 15857              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15858
 15859              IF PDEF-MASTER-FOUND
 15860                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15861                    (V1 > +8)
 15862                    OR (PD-PROD-CODE (V1) = 'L')
 15863                 END-PERFORM
 15864                 IF V1 < +9
 15865                    MOVE PD-MAX-AMT (V1)
 15866                                 TO CP-R-MAX-TOT-BEN
 15867                                    EC-AM-LF-MAX-TOT-BEN
 15868                 END-IF
 15869              END-IF
 15870           END-IF
 15871           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15872        END-IF
 15873        END-IF
 15874     END-IF
 15875     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15876
 15877     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15878
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 287
* EL050.cbl
 15879     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15880                                    PB-C-LF-REM-TERM.
 15881
 15882     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15883     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15884
 15885     IF PB-COMPANY-ID EQUAL 'FLC'
 15886        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15887           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15888           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15889                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15890                    - CM-LF-ITD-DEATH-AMT
 15891           IF PB-C-LF-REF-CALC LESS THAN +0
 15892              MOVE +0            TO PB-C-LF-REF-CALC
 15893              GO TO 3730-GET-AH-REMAIN-TERM
 15894           ELSE
 15895              GO TO 3730-GET-AH-REMAIN-TERM.
 15896
 15897     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15898                            OR '4' OR '5' OR '6' OR '8'
 15899                            OR '9' OR 'G'
 15900        MOVE PB-C-LF-REFUND-OVERRIDE
 15901                                 TO CP-EARNING-METHOD.
 15902
 15903     if pb-company-id = 'AHL'
 15904        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15905        if cp-class-code = spaces
 15906           move zeros            to cp-class-code
 15907        end-if
 15908     ELSE
 15909        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15910     END-IF
 15911*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15912     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15913     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15914                                    CP-RATING-BENEFIT-AMT.
 15915     IF CP-STATE-STD-ABBRV = 'OR'
 15916         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15917                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15918     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15919     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15920     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15921     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15922     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15923     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15924     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15925     IF WS-DEFAULT-APR NOT NUMERIC
 15926         MOVE ZEROS TO WS-DEFAULT-APR.
 15927****   N O T E   ****
 15928*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15929*      THE OH HARD CODING IN ELCRFNDP
 15930
 15931     IF PB-COMPANY-ID = 'CID'
 15932        IF CP-STATE-STD-ABBRV = 'OH'
 15933           MOVE WS-LF-EARNINGS-CALC
 15934                                 TO CP-EARNING-METHOD
 15935        END-IF
 15936     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 288
* EL050.cbl
 15937
 15938****   N O T E   ****
 15939
 15940     IF CP-EARN-AS-NET-PAY
 15941         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15942            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15943                MOVE WS-DEFAULT-APR
 15944                                 TO  CP-LOAN-APR
 15945                MOVE ER-3780     TO  WS-ERROR
 15946                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15947            ELSE
 15948                MOVE ER-3781     TO  WS-ERROR
 15949                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15950*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15951     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15952
 15953     IF CP-REFUND-TYPE-USED NOT = SPACE
 15954         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15955
 15956     IF CP-ERROR-RATE-IS-ZERO OR
 15957        CP-ERROR-RATE-NOT-FOUND
 15958        MOVE ER-2740             TO WS-ERROR
 15959        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15960
 15961     IF CP-ERROR-RATE-FILE-NOTOPEN
 15962        MOVE ER-2617             TO WS-ERROR
 15963        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15964
 15965     IF PB-COMPANY-ID = 'DCC'
 15966        AND PB-CI-ENTRY-STATUS = 'M'
 15967        MOVE +0                  TO PB-C-LF-REF-CALC
 15968     ELSE
 15969        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15970     END-IF
 15971
 15972     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15973         GO TO 3730-GET-AH-REMAIN-TERM.
 15974
 15975*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15976*       ADD +1                   TO PB-C-LF-REM-TERM
 15977*                                   CP-REMAINING-TERM
 15978*                                   CP-ORIGINAL-TERM.
 15979
 15980     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15981     MOVE '2'                    TO CP-EARNING-METHOD
 15982                                    CP-RATING-METHOD.
 15983     IF PB-COMPANY-ID = 'CID'
 15984        IF (CP-STATE-STD-ABBRV = 'MN')
 15985           AND (PB-CERT-EFF-DT > X'A4FF')
 15986           AND (WS-LF-EARNINGS-CALC = 'B')
 15987           MOVE '5'              TO CP-EARNING-METHOD
 15988           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15989        END-IF
 15990     END-IF
 15991     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15992                                        CP-REMAINING-BENEFIT
 15993                                        CP-RATING-BENEFIT-AMT.
 15994     IF CP-STATE-STD-ABBRV = 'OR'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 289
* EL050.cbl
 15995         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15996                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15997     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15998     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15999
 16000     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16001
 16002     IF CP-ERROR-RATE-IS-ZERO OR
 16003        CP-ERROR-RATE-NOT-FOUND
 16004        MOVE ER-2740             TO WS-ERROR
 16005        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16006
 16007     IF CP-ERROR-RATE-FILE-NOTOPEN
 16008        MOVE ER-2617             TO WS-ERROR
 16009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16010
 16011     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16012
 16013******************************************************************
 16014
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 290
* EL050.cbl
 16016 3730-GET-AH-REMAIN-TERM.
 16017     IF NO-AH-BENEFIT-MATCH  OR
 16018        WS-AH-BENEFIT-CD = ZEROS
 16019         GO TO 3770-CHECK-REFUNDS.
 16020
 16021     IF PB-CI-AH-LUMP-SUM-DISAB
 16022         IF  PB-C-AH-CANCEL-AMT = ZERO
 16023            IF NOT PB-COMP-AH-CANCEL
 16024             GO TO 3770-CHECK-REFUNDS.
 16025
 16026     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16027     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16028     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16029     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16030     MOVE PB-SV-STATE            TO CP-STATE.
 16031     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16032     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16033     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16034     MOVE '2'                    TO CP-PROCESS-TYPE.
 16035     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16036     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16037     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16038     IF (PB-COMPANY-ID = 'CID')
 16039        AND (CP-STATE-STD-ABBRV = 'WI')
 16040        MOVE '7'                 TO CP-REM-TERM-METHOD
 16041        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16042     ELSE
 16043        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16044        MOVE WS-REM-TRM-CALC-OPTION
 16045                                 TO CP-REM-TRM-CALC-OPTION
 16046     END-IF
 16047     IF (PB-COMPANY-ID = 'CID')
 16048        AND (CP-STATE-STD-ABBRV = 'MO')
 16049        AND (PB-CERT-EFF-DT >= X'9B41')
 16050        AND (PB-CERT-EFF-DT <= X'A2FB')
 16051        MOVE '7'                 TO CP-REM-TERM-METHOD
 16052        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16053     END-IF
 16054     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16055                                    CP-LOAN-TERM.
 16056     IF NOT CP-TERM-IS-DAYS
 16057         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16058
 16059     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16060
 16061     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16062
 16063     IF AH-COVERAGE-CANCELLED
 16064        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16065        NEXT SENTENCE
 16066      ELSE
 16067         GO TO 3770-CHECK-REFUNDS.
 16068
 16069 3740-GET-AH-REFUND.
 16070
 16071     IF PB-C-LF-CANCEL-VOIDED OR
 16072        PB-C-AH-CANCEL-VOIDED
 16073        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 291
* EL050.cbl
 16074
 16075     IF PB-COMPANY-ID = 'BOA'
 16076         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16077         GO TO 3770-CHECK-REFUNDS.
 16078
 16079     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16080*    MOVE ' '                    TO DC-OPTION-CODE
 16081     SET BIN-TO-GREG             TO TRUE
 16082     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16083     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16084                                    PB-C-AH-REM-TERM.
 16085     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16086     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16087
 16088     IF PB-COMPANY-ID EQUAL 'FLC'
 16089        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16090           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16091           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16092                    - CM-AH-ITD-AH-PMT)
 16093           IF PB-C-AH-REF-CALC LESS THAN +0
 16094              MOVE +0            TO PB-C-AH-REF-CALC
 16095              GO TO 3770-CHECK-REFUNDS
 16096           ELSE
 16097              GO TO 3770-CHECK-REFUNDS.
 16098
 16099     IF PB-COMPANY-ID = 'DCC'
 16100        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16101            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16102           MOVE 'S'              TO CP-EARNING-METHOD
 16103        END-IF
 16104     END-IF
 16105     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16106                            OR '4' OR '5' OR '6' OR '8'
 16107                            OR '9' OR 'G' OR 'S'
 16108        MOVE PB-C-AH-REFUND-OVERRIDE
 16109                                 TO CP-EARNING-METHOD.
 16110
 16111     if pb-company-id = 'AHL'
 16112        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16113        if cp-class-code = spaces
 16114           move zeros            to cp-class-code
 16115        end-if
 16116     ELSE
 16117        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16118     END-IF
 16119*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16120     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16121     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16122                                    CP-RATING-BENEFIT-AMT.
 16123     IF CP-STATE-STD-ABBRV = 'OR'
 16124         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16125                                         PB-CI-AH-TERM.
 16126     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16127     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16128     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16129     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16130     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16131     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 292
* EL050.cbl
 16132
 16133     IF CP-STATE-STD-ABBRV = 'OH'
 16134        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16135                                AND 'CID' AND 'DCC' AND 'AHL')
 16136           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16137              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16138              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16139              MOVE '6' TO CP-EARNING-METHOD
 16140           END-IF
 16141        END-IF
 16142        IF PB-COMPANY-ID = 'CID'
 16143           IF NO-LIFE-COVERAGE
 16144              IF CP-CRITICAL-PERIOD
 16145                 MOVE '2'       TO CP-EARNING-METHOD
 16146              ELSE
 16147                 MOVE '6'       TO CP-EARNING-METHOD
 16148              END-IF
 16149           ELSE
 16150              IF WS-LF-COVERAGE-TYPE = 'L'
 16151                 MOVE '2'       TO CP-EARNING-METHOD
 16152              ELSE
 16153                 IF (PB-CI-LF-TERM > +60) OR
 16154                    (WS-LF-EARNINGS-CALC = '5')
 16155                    IF CP-CRITICAL-PERIOD
 16156                       MOVE '2'  TO CP-EARNING-METHOD
 16157                    ELSE
 16158                       MOVE '6'  TO CP-EARNING-METHOD
 16159                    END-IF
 16160                 ELSE
 16161                    MOVE '1'     TO CP-EARNING-METHOD
 16162                 END-IF
 16163              END-IF
 16164           END-IF
 16165        END-IF
 16166     END-IF
 16167
 16168*    IF CP-STATE-STD-ABBRV = 'VA'
 16169*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16170*          IF CP-ORIGINAL-TERM GREATER 61
 16171*             MOVE '6' TO CP-EARNING-METHOD
 16172*          ELSE
 16173*             MOVE '1' TO CP-EARNING-METHOD.
 16174
 16175     IF WS-DEFAULT-APR NOT NUMERIC
 16176         MOVE ZEROS TO WS-DEFAULT-APR.
 16177     IF CP-EARN-AS-NET-PAY
 16178         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16179            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16180                MOVE WS-DEFAULT-APR
 16181                                 TO  CP-LOAN-APR
 16182                MOVE ER-3780     TO  WS-ERROR
 16183                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16184            ELSE
 16185                MOVE ER-3781     TO  WS-ERROR
 16186                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16187     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16188     IF PB-COMPANY-ID = 'DCC'
 16189        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 293
* EL050.cbl
 16190        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16191        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16192     END-IF
 16193     IF PB-COMPANY-ID = 'DCC'
 16194        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16195        AND (CP-EARNING-METHOD = 'D')
 16196        AND (CP-CANCEL-REASON NOT = 'R')
 16197        CONTINUE
 16198     ELSE
 16199        GO TO 3750-CONTINUE
 16200     END-IF
 16201     MOVE ' '                    TO DD-IU-SW
 16202     IF NOT PDEF-MASTER-FOUND
 16203        MOVE ' '                 TO PDEF-MASTER-SW
 16204        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16205        MOVE PB-STATE            TO ERPDEF-STATE
 16206        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16207        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16208        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16209        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16210        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16211        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16212        IF PDEF-MASTER-FOUND
 16213           MOVE 'N'              TO PDEF-MASTER-SW
 16214           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16215           IF PDEF-MASTER-FOUND
 16216              IF (ERPDEF-KEY-SAVE (1:16) =
 16217                           PD-CONTROL-PRIMARY (1:16))
 16218                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16219                 CONTINUE
 16220              ELSE
 16221                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16222                 IF (ERPDEF-KEY-SAVE (1:16) =
 16223                           PD-CONTROL-PRIMARY (1:16))
 16224                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16225                    CONTINUE
 16226                 ELSE
 16227                    MOVE ER-2740 TO WS-ERROR
 16228                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16229                    GO TO 3770-CHECK-REFUNDS
 16230                 END-IF
 16231              END-IF
 16232           END-IF
 16233           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16234        END-IF
 16235     END-IF
 16236     IF PDEF-MASTER-FOUND
 16237        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16238           (V1 > +8)
 16239           OR (PD-PROD-CODE (V1) = 'I')
 16240        END-PERFORM
 16241        IF V1 < +9
 16242           SET DD-IU-PRESENT        TO TRUE
 16243        END-IF
 16244        IF WS-AH-DCC-TRUNC = 'T'
 16245           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16246        ELSE
 16247           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 294
* EL050.cbl
 16248        END-IF
 16249        EVALUATE TRUE
 16250           WHEN WS-TERM > +168
 16251              MOVE 15               TO V1
 16252           WHEN WS-TERM > +156
 16253              MOVE 14               TO V1
 16254           WHEN WS-TERM > +144
 16255              MOVE 13               TO V1
 16256           WHEN WS-TERM > +132
 16257              MOVE 12               TO V1
 16258           WHEN WS-TERM > +120
 16259              MOVE 11               TO V1
 16260           WHEN WS-TERM > +108
 16261              MOVE 10               TO V1
 16262           WHEN WS-TERM > +96
 16263              MOVE 9                TO V1
 16264           WHEN WS-TERM > +84
 16265              MOVE 8                TO V1
 16266           WHEN WS-TERM > +72
 16267              MOVE 7                TO V1
 16268           WHEN WS-TERM > +60
 16269              MOVE 6                TO V1
 16270           WHEN WS-TERM > +48
 16271              MOVE 5                TO V1
 16272           WHEN WS-TERM > +36
 16273              MOVE 4                TO V1
 16274           WHEN WS-TERM > +24
 16275              MOVE 3                TO V1
 16276           WHEN WS-TERM > +12
 16277              MOVE 2                TO V1
 16278           WHEN OTHER
 16279              MOVE 1                TO V1
 16280        END-EVALUATE
 16281
 16282        EVALUATE TRUE
 16283*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16284*             < +13)
 16285*             AND (DD-IU-PRESENT)
 16286*             MOVE 2                TO V2
 16287*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16288*             MOVE 1                TO V2
 16289           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16290              MOVE 2                TO V2
 16291           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16292              MOVE 3                TO V2
 16293           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16294              MOVE 4                TO V2
 16295           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16296              MOVE 5                TO V2
 16297           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16298              MOVE 6                TO V2
 16299           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16300              MOVE 7                TO V2
 16301           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16302              MOVE 8                TO V2
 16303           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16304              MOVE 9                TO V2
 16305           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 295
* EL050.cbl
 16306              MOVE 10               TO V2
 16307           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16308              MOVE 11               TO V2
 16309           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16310              MOVE 12               TO V2
 16311           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16312              MOVE 13               TO V2
 16313           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16314              MOVE 14               TO V2
 16315           WHEN OTHER
 16316              MOVE 15               TO V2
 16317        END-EVALUATE
 16318
 16319        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16320                                 TO CP-DDF-LO-FACT
 16321        MOVE PD-UEP-FACTOR (V1 V2)
 16322                                 TO CP-DDF-HI-FACT
 16323
 16324        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16325        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16326        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16327           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16328        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16329        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16330        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16331           + PD-1ST-YR-ADMIN-ALLOW
 16332
 16333        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16334*       IF PI-CLP-YN = 'Y'
 16335*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16336*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16337*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16338*       END-IF
 16339
 16340        IF DD-IU-PRESENT
 16341           MOVE 'I'              TO CP-EARNING-METHOD
 16342        END-IF
 16343        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16344                                     CP-CLP-RATE-UP
 16345        IF CP-IU-RATE-UP NOT = ZEROS
 16346           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16347              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16348           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16349              / (1 - WS-WORK-FACT)
 16350        END-IF
 16351     END-IF
 16352     .
 16353 3750-CONTINUE.
 16354     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16355
 16356     IF CP-REFUND-TYPE-USED NOT = SPACE
 16357         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16358
 16359     IF CP-ERROR-RATE-IS-ZERO OR
 16360        CP-ERROR-RATE-NOT-FOUND
 16361        MOVE ER-2740             TO WS-ERROR
 16362        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16363
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 296
* EL050.cbl
 16364     IF CP-ERROR-RATE-FILE-NOTOPEN
 16365        MOVE ER-2617             TO WS-ERROR
 16366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16367     IF PB-COMPANY-ID = 'DCC'
 16368        AND PB-CI-ENTRY-STATUS = 'M'
 16369        MOVE +0                  TO PB-C-AH-REF-CALC
 16370     ELSE
 16371        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16372     END-IF
 16373     IF PB-COMPANY-ID = 'DCC'
 16374        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16375        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16376        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16377        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16378        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16379        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16380        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16381        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16382        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16383     END-IF
 16384     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 297
* EL050.cbl
 16386
 16387 3770-CHECK-REFUNDS.
 16388
 16389     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16390        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16391           MOVE ER-2766          TO WS-ERROR
 16392           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16393           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16394           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16395              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16396
 16397     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16398        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16399           MOVE ER-2766          TO WS-ERROR
 16400           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16401           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16402           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16403              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16404
 16405     IF PB-COMP-LF-CANCEL
 16406        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16407        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16408           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16409              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16410
 16411     IF PB-COMP-AH-CANCEL
 16412        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16413        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16414           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16415              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16416
 16417     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16418             GIVING WS-UNSIGN-WRK1
 16419     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16420             GIVING WS-UNSIGN-WRK2.
 16421
 16422     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16423         MOVE ZERO TO WS-UNSIGN-WRK1.
 16424
 16425     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16426         MOVE ZERO TO WS-UNSIGN-WRK2.
 16427
 16428     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16429
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 298
* EL050.cbl
 16431
 16432 3772-CONTINUE.
 16433
 16434**********************************
 16435*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16436*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16437*** DOUBLES THE TOLERANCE AMOUNT.
 16438***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16439**********************************
 16440     IF PB-COMPANY-ID = 'MON'
 16441     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16442         IF WS-REF-REJECT-SW = SPACE
 16443             MOVE ER-2754        TO WS-ERROR
 16444             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16445           ELSE
 16446             MOVE ER-2736        TO WS-ERROR
 16447             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16448**********************************
 16449
 16450 3773-CONTINUE.
 16451
 16452     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16453        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16454           MOVE ER-2723          TO WS-ERROR
 16455           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16456
 16457     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16458        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16459           MOVE ER-2724          TO WS-ERROR
 16460           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16461
 16462     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16463         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16464             (1 + WS-LF-REFUND-OVS-PCT)
 16465     ELSE
 16466         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16467
 16468     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16469         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16470             (1 - WS-TOL-LF-REFUND-PCT)
 16471     ELSE
 16472         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16473
 16474     IF (PB-COMPANY-ID = 'DCC')
 16475        AND (PB-CI-ENTRY-STATUS = 'M')
 16476        AND (PB-C-LF-CANCEL-AMT > +0)
 16477        MOVE ER-3843             TO WS-ERROR
 16478        PERFORM 9900-ERROR-FORMAT
 16479                                 THRU 9900-EXIT
 16480     END-IF
 16481     EVALUATE TRUE
 16482        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16483           CONTINUE
 16484        WHEN PB-C-LF-CANCEL-AMT = +0
 16485                 AND PB-C-LF-REF-CALC > +0
 16486           CONTINUE
 16487        WHEN WS-LF-REFUND-OVS-AMT = 0
 16488                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 299
* EL050.cbl
 16489           CONTINUE
 16490        WHEN OTHER
 16491           IF WS-TOL-LF-REFUND  = +0
 16492              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16493           END-IF
 16494           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16495                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16496                          (PB-C-LF-CANCEL-AMT))
 16497              CONTINUE
 16498           ELSE
 16499              IF WS-LF-REFUND-OVS-AMT = +0
 16500                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16501              END-IF
 16502              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16503                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16504                                       PB-C-LF-CANCEL-AMT)
 16505                 CONTINUE
 16506              ELSE
 16507                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16508                   MOVE ER-2754   TO  WS-ERROR
 16509                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16510                 ELSE
 16511                    MOVE ER-2736   TO  WS-ERROR
 16512                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16513                 END-IF
 16514              END-IF
 16515           END-IF
 16516     END-EVALUATE.
 16517
 16518     EVALUATE TRUE
 16519        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16520           CONTINUE
 16521        WHEN PB-C-LF-CANCEL-AMT = +0
 16522                 AND PB-C-LF-REF-CALC > +0
 16523           CONTINUE
 16524        WHEN OTHER
 16525           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16526               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16527              CONTINUE
 16528           ELSE
 16529              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16530               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16531                CONTINUE
 16532              ELSE
 16533                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16534                     MOVE ER-2754   TO  WS-ERROR
 16535                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16536                 ELSE
 16537                     MOVE ER-2736   TO  WS-ERROR
 16538                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16539                 END-IF
 16540              END-IF
 16541           END-IF
 16542     END-EVALUATE.
 16543
 16544     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16545         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16546             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 300
* EL050.cbl
 16547     ELSE
 16548         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16549
 16550     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16551         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16552             (1 - WS-TOL-AH-REFUND-PCT)
 16553     ELSE
 16554         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16555
 16556     IF (PB-COMPANY-ID = 'DCC')
 16557        AND (PB-CI-ENTRY-STATUS = 'M')
 16558        AND (PB-C-AH-CANCEL-AMT > +0)
 16559        MOVE ER-3843             TO WS-ERROR
 16560        PERFORM 9900-ERROR-FORMAT
 16561                                 THRU 9900-EXIT
 16562     END-IF
 16563     EVALUATE TRUE
 16564        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16565           CONTINUE
 16566*       WHEN PB-C-AH-REF-CALC = +0 AND
 16567*                  PB-C-AH-CANCEL-AMT > +0
 16568        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16569                   PB-C-AH-REF-CALC > +0
 16570           CONTINUE
 16571        WHEN WS-AH-REFUND-OVS-AMT = +0
 16572                AND WS-TOL-AH-REFUND = +0
 16573           CONTINUE
 16574        WHEN OTHER
 16575           IF WS-TOL-AH-REFUND = +0
 16576              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16577           END-IF
 16578           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16579               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16580                                         PB-C-AH-CANCEL-AMT)
 16581              CONTINUE
 16582           ELSE
 16583              IF WS-AH-REFUND-OVS-AMT = +0
 16584                 MOVE +9999999.99 TO
 16585                         WS-AH-REFUND-OVS-AMT
 16586              END-IF
 16587              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16588                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16589                                         PB-C-AH-CANCEL-AMT)
 16590                 CONTINUE
 16591              ELSE
 16592                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16593                    MOVE ER-2754   TO  WS-ERROR
 16594                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16595                 ELSE
 16596                    MOVE ER-2736   TO  WS-ERROR
 16597                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16598                 END-IF
 16599              END-IF
 16600           END-IF
 16601     END-EVALUATE.
 16602
 16603     EVALUATE TRUE
 16604        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 301
* EL050.cbl
 16605           CONTINUE
 16606*       WHEN PB-C-AH-REF-CALC > +0 AND
 16607*                  PB-C-AH-CANCEL-AMT = +0
 16608        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16609                   PB-C-AH-REF-CALC = +0
 16610           CONTINUE
 16611        WHEN OTHER
 16612           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16613               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16614              CONTINUE
 16615           ELSE
 16616              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16617                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16618                 CONTINUE
 16619              ELSE
 16620                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16621                     MOVE ER-2754   TO  WS-ERROR
 16622                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16623                 ELSE
 16624                     MOVE ER-2736   TO  WS-ERROR
 16625                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16626                 END-IF
 16627              END-IF
 16628           END-IF
 16629     END-EVALUATE.
 16630
 16631     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16632        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16633        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16634           AND  PB-C-LF-REF-CALC < +1.00
 16635           AND  PB-C-AH-REF-CALC < +1.00
 16636           CONTINUE
 16637        ELSE
 16638           IF (PB-COMPANY-ID = 'DCC')
 16639              AND (PB-CI-ENTRY-STATUS = 'M')
 16640              CONTINUE
 16641           ELSE
 16642              MOVE ER-2741       TO WS-ERROR
 16643              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16644           END-IF
 16645        END-IF
 16646     END-IF
 16647
 16648     IF (PB-C-LF-CANCEL-AMT = ZERO
 16649        AND WS-LF-BENEFIT-CD NOT = ZERO
 16650        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16651        AND PB-C-LF-REF-CALC NOT = ZERO)
 16652        OR
 16653        (PB-C-LF-CANCEL-AMT = ZERO
 16654        AND WS-LF-BENEFIT-CD NOT = ZERO
 16655        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16656             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16657                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16658                NEXT SENTENCE
 16659             ELSE
 16660                MOVE ER-2739        TO WS-ERROR
 16661                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16662
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 302
* EL050.cbl
 16663     IF (PB-C-AH-CANCEL-AMT = ZERO
 16664        AND WS-AH-BENEFIT-CD NOT = ZERO
 16665        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16666        AND PB-C-AH-REF-CALC NOT = ZERO)
 16667        OR
 16668        (PB-C-AH-CANCEL-AMT = ZERO
 16669        AND WS-AH-BENEFIT-CD NOT = ZERO
 16670        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16671             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16672                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16673                NEXT SENTENCE
 16674             ELSE
 16675                MOVE ER-2738        TO WS-ERROR
 16676                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16677
 16678 3775-OVER-REF-CHK.
 16679
 16680     IF PB-CI-ENTRY-STATUS = '5'
 16681        GO TO 3780-UPDATE-CANCEL-CERT.
 16682
 16683     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16684                              PB-CI-LF-ALT-PREMIUM-AMT.
 16685
 16686     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16687        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16688                                 PB-C-LF-REF-CALC
 16689      ELSE
 16690        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16691                                 PB-C-LF-CANCEL-AMT.
 16692
 16693     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16694        MOVE ER-2755             TO WS-ERROR
 16695        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16696
 16697     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16698
 16699     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16700        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16701                                 PB-C-AH-REF-CALC
 16702      ELSE
 16703        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16704                                 PB-C-AH-CANCEL-AMT.
 16705
 16706     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16707        MOVE ER-2778             TO WS-ERROR
 16708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16709
 16710     IF PB-CI-OB-FLAG NOT = 'Z'
 16711        NEXT SENTENCE
 16712       ELSE
 16713         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16714            MOVE ER-2757           TO WS-ERROR
 16715            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16716
 16717 3780-UPDATE-CANCEL-CERT.
 16718
 16719     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16720        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 303
* EL050.cbl
 16721        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16722
 16723     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16724         MOVE ER-2729              TO WS-ERROR
 16725         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16726
 16727     IF PB-CI-LF-BENEFIT-CD = ZERO
 16728         GO TO 3780-UPDATE-CONT-1.
 16729
 16730     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16731         GO TO 3780-UPDATE-CONT-1.
 16732
 16733     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16734       AND
 16735        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16736       AND
 16737        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16738       AND
 16739        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16740            NEXT SENTENCE
 16741       ELSE
 16742        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16743          AND
 16744***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16745***       AND
 16746           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16747            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16748               MOVE ER-2730      TO WS-ERROR
 16749               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16750               GO TO 3999-END-EDIT
 16751            ELSE
 16752               GO TO 3999-END-EDIT
 16753        ELSE
 16754            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16755               MOVE ER-2765           TO WS-ERROR
 16756               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16757               GO TO 3785-CHECK-NH.
 16758*              GO TO 3999-END-EDIT.
 16759
 16760 3780-UPDATE-CONT-1.
 16761     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16762
 16763     IF PB-CI-AH-BENEFIT-CD = ZERO
 16764         GO TO 3780-UPDATE-CONT-2.
 16765
 16766     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16767         GO TO 3780-UPDATE-CONT-2.
 16768
 16769     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16770
 16771     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16772       AND
 16773        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16774       AND
 16775        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16776       AND
 16777        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16778            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 304
* EL050.cbl
 16779       ELSE
 16780        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16781          AND
 16782***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16783***       AND
 16784           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16785           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16786            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16787               MOVE ER-2773      TO WS-ERROR
 16788               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16789               GO TO 3999-END-EDIT
 16790            ELSE
 16791               GO TO 3999-END-EDIT
 16792            END-IF
 16793           ELSE
 16794             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16795                MOVE ER-2890 TO WS-ERROR
 16796                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16797                GO TO 3999-END-EDIT
 16798             ELSE
 16799                GO TO 3785-CHECK-NH
 16800             END-IF
 16801           END-IF
 16802          ELSE
 16803            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16804              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16805                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16806                   MOVE ER-2890 TO WS-ERROR
 16807                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16808                   GO TO 3999-END-EDIT
 16809                ELSE
 16810                   MOVE ER-2765 TO WS-ERROR
 16811                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16812                   GO TO 3785-CHECK-NH
 16813                END-IF
 16814              ELSE
 16815               MOVE ER-2765      TO WS-ERROR
 16816               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16817               GO TO 3785-CHECK-NH.
 16818*              GO TO 3999-END-EDIT.
 16819
 16820 3780-UPDATE-CONT-2.
 16821
 16822     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16823        AND WS-LF-BENEFIT-CD = ZERO
 16824           MOVE ER-2743           TO WS-ERROR
 16825           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16826
 16827     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16828        AND WS-AH-BENEFIT-CD = ZERO
 16829           MOVE ER-2744           TO WS-ERROR
 16830           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16831
 16832     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16833        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16834        AND
 16835        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16836         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 305
* EL050.cbl
 16837           MOVE ER-2746           TO WS-ERROR
 16838           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16839
 16840     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16841       AND
 16842        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16843             MOVE ER-2737        TO WS-ERROR
 16844             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16845
 16846     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16847       AND
 16848        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16849             MOVE ER-2737        TO WS-ERROR
 16850             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16851
 16852     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16853         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16854             OR 'CID' OR 'DCC' OR 'AHL'
 16855             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16856         ELSE
 16857             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16858                 MOVE ER-2768    TO WS-ERROR
 16859                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16860             ELSE
 16861                 MOVE ER-2756    TO WS-ERROR
 16862                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16863
 16864     IF CERT-PEND-ISSUE-RETURNED
 16865        MOVE ER-2772             TO WS-ERROR
 16866        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16867 3785-CHECK-NH.
 16868     IF PB-STATE NOT = 'NH'
 16869        GO TO 3999-END-EDIT
 16870     END-IF
 16871
 16872     MOVE ER-2796                TO WS-ERROR
 16873     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16874     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16875        OR (CM-NH-INTERFACE-SW = 'Y')
 16876        MOVE ER-2793             TO WS-ERROR
 16877        PERFORM 9900-ERROR-FORMAT
 16878                                 THRU 9900-EXIT
 16879     END-IF
 16880     MOVE +0                     TO WS-PAYMENT-AMT
 16881     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16882        GO TO 3999-END-EDIT
 16883     END-IF
 16884     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16885        GO TO 3999-END-EDIT
 16886     END-IF
 16887     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16888     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16889     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16890        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16891     END-IF
 16892     MOVE '1'                    TO DC-OPTION-CODE
 16893     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16894     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 306
* EL050.cbl
 16895        IF DC-ELAPSED-DAYS < +16
 16896           GO TO 3999-END-EDIT
 16897        END-IF
 16898     END-IF
 16899     MOVE +0                     TO DC-ELAPSED-DAYS
 16900     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16901     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16902     MOVE '1'                    TO DC-OPTION-CODE
 16903     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16904     IF NO-CONVERSION-ERROR
 16905        IF DC-ELAPSED-DAYS > +30
 16906           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16907        ELSE
 16908           GO TO 3999-END-EDIT
 16909        END-IF
 16910     ELSE
 16911        GO TO 3999-END-EDIT
 16912     END-IF
 16913     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16914        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16915           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16916     IF WS-PAYMENT-AMT < 600.00
 16917        GO TO 3999-END-EDIT
 16918     END-IF
 16919     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16920
 16921     IF (ERMAIL-FOUND = ' ')
 16922         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16923         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16924        GO TO 3999-END-EDIT
 16925     END-IF
 16926     MOVE ER-2795                TO WS-ERROR
 16927     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16928
 16929     GO TO 3999-END-EDIT.
 16930******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 307
* EL050.cbl
 16932 3990-FILES-NOT-OPEN.
 16933
 16934     MOVE ER-2617                TO WS-ERROR.
 16935     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16936     GO TO 9990-RETURN.
 16937
 16938 3999-END-EDIT.
 16939
 16940     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16941
 16942     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16943         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16944         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16945             PERFORM 9250-UNLOCK-RETURN
 16946             GO TO 9990-RETURN
 16947          ELSE
 16948             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16949             GO TO 9990-RETURN.
 16950
 16951     IF PB-CANCELLATION
 16952          GO TO 9990-RETURN.
 16953
 16954     IF CERT-WAS-NOT-FOUND
 16955        MOVE SPACES              TO CERTIFICATE-MASTER.
 16956
 16957     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16958
 16959     IF CERT-WAS-FOUND
 16960         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16961             PERFORM 9250-UNLOCK-RETURN
 16962          ELSE
 16963            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16964      ELSE
 16965         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16966
 16967     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16968        IF PB-COMPANY-ID = 'DCC' AND
 16969           (PB-CARRIER = '2' OR '4' OR '6')
 16970              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16971        END-IF
 16972     END-IF.
 16973
 16974     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16975         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16976     END-IF.
 16977
 16978     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16979     IF ((PB-COMPANY-ID = 'DCC')
 16980        AND (WS-NO-SECURE-PAY))
 16981                  OR
 16982        (WS-LF-SPECIAL-CALC-CD = 'O'
 16983        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16984        SET SKIP-ADDR-EDIT       TO TRUE
 16985     END-IF
 16986     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16987        AND (NOT SKIP-ADDR-EDIT)
 16988        MOVE ER-2963             TO WS-ERROR
 16989        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 308
* EL050.cbl
 16990                                 THRU 9900-EXIT
 16991        GO TO 9990-RETURN
 16992     END-IF
 16993     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 16994     IF ERPNDM-FOUND NOT = 'X'
 16995        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16996           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16997           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16998           AND (NOT SKIP-ADDR-EDIT)
 16999           MOVE ER-2694          TO WS-ERROR
 17000           PERFORM 9900-ERROR-FORMAT
 17001                                 THRU 9900-EXIT
 17002        END-IF
 17003        MOVE ' '                 TO STATE-RECORD-ERROR
 17004        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17005        MOVE PM-STATE            TO CNTL-ACCESS
 17006        MOVE '3'                 TO CNTL-REC-TYPE
 17007        MOVE +0                  TO CNTL-SEQ-NO
 17008        MOVE '0'                 TO RC-SW-2
 17009        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17010        IF (NO-STATE-RECORD)
 17011           OR (CF-RECORD-TYPE NOT = '3')
 17012           OR (PM-STATE NOT = CF-STATE-CODE)
 17013           IF (PM-STATE = SPACES)
 17014              AND (SKIP-ADDR-EDIT)
 17015              CONTINUE
 17016           ELSE
 17017              MOVE ER-2963       TO WS-ERROR
 17018              PERFORM 9900-ERROR-FORMAT
 17019                                 THRU 9900-EXIT
 17020           END-IF
 17021        END-IF
 17022        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17023           MOVE ER-2883          TO WS-ERROR
 17024           PERFORM 9900-ERROR-FORMAT
 17025                                 THRU 9900-EXIT
 17026        END-IF
 17027        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17028           MOVE ' '                 TO STATE-RECORD-ERROR
 17029           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17030           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17031           MOVE '3'                 TO CNTL-REC-TYPE
 17032           MOVE +0                  TO CNTL-SEQ-NO
 17033           MOVE '0'                 TO RC-SW-2
 17034           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17035           IF NO-STATE-RECORD
 17036              OR (CF-RECORD-TYPE NOT = '3')
 17037              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17038              MOVE ER-2964          TO WS-ERROR
 17039              PERFORM 9900-ERROR-FORMAT
 17040                                    THRU 9900-EXIT
 17041           END-IF
 17042        END-IF
 17043     ELSE
 17044        IF NOT SKIP-ADDR-EDIT
 17045           MOVE ER-2393          TO WS-ERROR
 17046           PERFORM 9900-ERROR-FORMAT
 17047                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 309
* EL050.cbl
 17048        END-IF
 17049     END-IF
 17050
 17051     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17052
 17053     IF (ERMAIL-FOUND = ' ' AND
 17054        ERPNDM-FOUND = ' ')
 17055        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17056           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17057           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17058          OR
 17059           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17060          OR
 17061           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17062           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17063           GO TO 3999-UNLOCK-ERMAIL.
 17064
 17065     IF ERPNDM-FOUND = 'X'
 17066        GO TO 3999-UNLOCK-ERMAIL.
 17067
 17068     IF PM-INSURED-LAST-NAME      = SPACES
 17069        AND PM-INSURED-FIRST-NAME = SPACES
 17070        AND PM-ADDRESS-LINE-1     = SPACES
 17071        AND PM-ADDRESS-LINE-2     = SPACES
 17072        AND PM-CITY-STATE         = SPACES
 17073        AND PM-CRED-BENE-NAME     = SPACES
 17074        AND PM-CRED-BENE-ADDR     = SPACES
 17075        AND PM-CRED-BENE-CTYST    = SPACES
 17076        GO TO 3999-UNLOCK-ERMAIL
 17077     END-IF
 17078
 17079     MOVE SPACES                 TO MAILING-DATA.
 17080
 17081     MOVE 'MA'                   TO MA-RECORD-ID.
 17082     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17083     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17084     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17085     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17086     MOVE PB-SV-STATE            TO MA-STATE.
 17087     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17088     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17089
 17090     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17091     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17092
 17093     IF ERMAIL-FOUND = ' '
 17094        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17095     ELSE
 17096        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17097        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17098        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17099
 17100     GO TO 9990-RETURN.
 17101
 17102 3999-UNLOCK-ERMAIL.
 17103     IF ERMAIL-FOUND = ' '
 17104        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17105
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 310
* EL050.cbl
 17106     GO TO 9990-RETURN.
 17107******************************************************************
 17108
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 311
* EL050.cbl
 17110 4000-UPDATE-CANCELLED-CERT.
 17111     IF CERT-WAS-NOT-FOUND
 17112        GO TO 4299-EXIT.
 17113
 17114*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17115     IF PB-C-NH-INT-ON-REFS > ZEROS
 17116        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17117     END-IF
 17118     IF PB-C-REF-INTERFACE-SW = 'Y'
 17119        MOVE PB-C-REF-INTERFACE-SW
 17120                                 TO CM-NH-INTERFACE-SW
 17121     END-IF
 17122     IF PB-C-POST-CARD-IND = 'Y'
 17123        MOVE +8                  TO SUB
 17124        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17125        IF ERMAIL-FOUND = ' '
 17126           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17127              (SUB > +7)
 17128              OR (MA-MAIL-STATUS (SUB) = '1')
 17129           END-PERFORM
 17130        END-IF
 17131        IF (SUB > +7)
 17132           OR (ERMAIL-FOUND = 'X')
 17133           MOVE ER-3789          TO WS-ERROR
 17134           PERFORM 9900-ERROR-FORMAT
 17135                                 THRU 9900-EXIT
 17136        END-IF
 17137     ELSE
 17138        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17139     END-IF
 17140     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17141
 17142     IF PB-CI-OB-FLAG = 'Z'
 17143        GO TO 4150-SUMMARY-CERT-CANCEL.
 17144
 17145     IF PB-C-LF-CANCEL-VOIDED
 17146         PERFORM 4200-REVERSE-LF-CANCEL.
 17147     IF PB-C-AH-CANCEL-VOIDED
 17148         PERFORM 4200-REVERSE-AH-CANCEL.
 17149
 17150 4100-APPLY-LF-CANCEL.
 17151
 17152     MOVE +0                     TO WS-SUB.
 17153
 17154 4100-CHECK-LF-ERRORS.
 17155
 17156     ADD +1                       TO WS-SUB.
 17157
 17158     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17159        IF LF-COVERAGE-CANCELLED
 17160           GO TO 4100-LF-CANCEL-CONT
 17161        ELSE
 17162           GO TO 4100-UPDATE-LF-COVERAGE.
 17163
 17164     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17165                                   ER-2729 OR
 17166                                   ER-2730 OR
 17167                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 312
* EL050.cbl
 17168                                   ER-2732 OR
 17169                                   ER-2737 OR
 17170                                   ER-2740 OR
 17171                                   ER-2743 OR
 17172                                   ER-2749 OR
 17173                                   ER-2750 OR
 17174                                   ER-2755 OR
 17175                                   ER-2757 OR
 17176                                   ER-2760 OR
 17177                                   ER-2772 OR
 17178                                   ER-2774 OR
 17179                                   ER-2776 OR
 17180                                   ER-2794
 17181        GO TO 4100-UPDATE-LF-COVERAGE.
 17182
 17183     GO TO 4100-CHECK-LF-ERRORS.
 17184
 17185 4100-UPDATE-LF-COVERAGE.
 17186
 17187     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17188     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17189     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17190        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17191     END-IF
 17192     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17193                                      TO CM-CREDIT-INTERFACE-SW-2.
 17194     IF CM-LF-CANCEL-DT = LOW-VALUE
 17195         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17196
 17197     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17198         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17199                                         CM-LF-STATUS-AT-CANCEL.
 17200
 17201     GO TO 4100-APPLY-AH-CANCEL.
 17202
 17203 4100-LF-CANCEL-CONT.
 17204     IF PB-C-LF-CANCEL-VOIDED
 17205         GO TO 4100-APPLY-AH-CANCEL.
 17206
 17207     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17208         GO TO 4100-APPLY-AH-CANCEL.
 17209
 17210     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17211        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17212           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17213        ELSE
 17214           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17215
 17216     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17217     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17218
 17219     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17220         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17221
 17222     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17223        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17224         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17225         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 313
* EL050.cbl
 17226
 17227     IF PB-RECORD-RETURNED
 17228        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17229      ELSE
 17230        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17231
 17232 4100-APPLY-AH-CANCEL.
 17233
 17234     MOVE +0                      TO WS-SUB.
 17235
 17236 4100-CHECK-AH-ERRORS.
 17237
 17238     ADD +1                       TO WS-SUB.
 17239
 17240     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17241        IF AH-COVERAGE-CANCELLED
 17242           GO TO 4100-AH-CANCEL-CONT
 17243        ELSE
 17244           GO TO 4100-UPDATE-AH-COVERAGE.
 17245
 17246     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17247                                   ER-2729 OR
 17248                                   ER-2732 OR
 17249                                   ER-2737 OR
 17250                                   ER-2740 OR
 17251                                   ER-2744 OR
 17252                                   ER-2749 OR
 17253                                   ER-2750 OR
 17254                                   ER-2755 OR
 17255                                   ER-2757 OR
 17256                                   ER-2760 OR
 17257                                   ER-2771 OR
 17258                                   ER-2772 OR
 17259                                   ER-2773 OR
 17260                                   ER-2775 OR
 17261                                   ER-2777 OR
 17262                                   ER-2794
 17263        GO TO 4100-UPDATE-AH-COVERAGE.
 17264
 17265     GO TO 4100-CHECK-AH-ERRORS.
 17266
 17267 4100-UPDATE-AH-COVERAGE.
 17268
 17269     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17270     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17271     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17272     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17273                                      TO CM-CREDIT-INTERFACE-SW-2.
 17274     IF CM-AH-CANCEL-DT = LOW-VALUE
 17275         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17276
 17277     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17278         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17279                                         CM-AH-STATUS-AT-CANCEL.
 17280
 17281     IF LF-COVERAGE-CANCELLED
 17282         IF PB-RECORD-RETURNED
 17283              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 314
* EL050.cbl
 17284          ELSE
 17285              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17286
 17287     GO TO 4299-EXIT.
 17288
 17289 4100-AH-CANCEL-CONT.
 17290     IF PB-C-AH-CANCEL-VOIDED
 17291         GO TO 4299-EXIT.
 17292     if cm-credit-interface-sw-2 = ' '
 17293        if pb-fatal-errors or pb-unforced-errors
 17294           move '4'              to cm-credit-interface-sw-2
 17295        else
 17296           move '1'              to cm-credit-interface-sw-2
 17297        end-if
 17298     end-if
 17299     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17300         GO TO 4299-EXIT.
 17301
 17302     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17303        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17304           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17305        ELSE
 17306           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17307
 17308     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17309     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17310
 17311     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17312         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17313
 17314     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17315         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17316         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17317
 17318     IF PB-RECORD-RETURNED
 17319        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17320      ELSE
 17321        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17322
 17323     GO TO 4299-EXIT.
 17324
 17325 4150-SUMMARY-CERT-CANCEL.
 17326     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17327
 17328     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17329        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17330                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17331     ELSE
 17332        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17333                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17334
 17335     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17336        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17337                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17338     ELSE
 17339        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17340                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17341
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 315
* EL050.cbl
 17342     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17343        NEXT SENTENCE
 17344     ELSE
 17345        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17346
 17347     GO TO 4299-EXIT.
 17348
 17349 4200-REVERSE-LF-CANCEL.
 17350     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17351
 17352     IF CM-LF-CANCEL-APPLIED
 17353        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17354        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17355        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17356
 17357     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17358
 17359     IF PB-RECORD-RETURNED
 17360        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17361       ELSE
 17362        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17363
 17364 4200-REVERSE-LF-EXIT.
 17365       EXIT.
 17366
 17367 4200-REVERSE-AH-CANCEL.
 17368     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17369
 17370     IF CM-AH-CANCEL-APPLIED
 17371        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17372        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17373        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17374
 17375     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17376
 17377     IF PB-RECORD-RETURNED
 17378        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17379       ELSE
 17380        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17381
 17382 4200-REVERSE-AH-EXIT.
 17383       EXIT.
 17384
 17385 4299-EXIT.
 17386       EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 316
* EL050.cbl
 17388
 17389 4500-UPDATE-NEW-CERT.
 17390     IF CERT-WAS-FOUND
 17391         NEXT SENTENCE
 17392       ELSE
 17393         GO TO 4520-BUILD-NEW-KEY.
 17394
 17395     IF  CLASIC-CREATED-CERT
 17396         GO TO 4999-EXIT.
 17397
 17398     IF  CERT-WAS-CREATED-FOR-CLAIM
 17399         GO TO 4520-BUILD-NEW-KEY.
 17400
 17401     IF CERT-ADDED-BATCH
 17402        IF CM-RECORD-ID = 'CM'
 17403            GO TO 4999-EXIT.
 17404
 17405 4520-BUILD-NEW-KEY.
 17406* BUILD CONTROL PRIMARY
 17407
 17408     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17409                                       CM-COMPANY-CD-A1
 17410                                       CM-COMPANY-CD-A2
 17411                                       CM-COMPANY-CD-A4
 17412                                       CM-COMPANY-CD-A5.
 17413
 17414     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17415     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17416     MOVE PB-SV-STATE               TO CM-STATE.
 17417     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17418     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17419     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17420     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17421
 17422     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17423
 17424     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17425     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17426     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17427     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17428
 17429     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17430        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17431
 17432     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17433         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17434         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17435         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17436         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17437     ELSE
 17438         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17439
 17440     IF PB-COMPANY-ID   EQUAL  'CRI'
 17441         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17442         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17443         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17444         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17445         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 317
* EL050.cbl
 17446
 17447     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17448        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17449         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17450
 17451     IF PB-COMPANY-ID  = 'LBL'
 17452        IF PB-I-JOINT-COVERAGE
 17453            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17454                                           PB-I-MEMBER-NO
 17455            GO TO 4550-CONT-CERT-PROCESS.
 17456
 17457     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17458        NEXT SENTENCE
 17459     ELSE
 17460        GO TO 4540-BUILD-MEMBER-NO.
 17461
 17462******************************************************************
 17463*                                                                *
 17464*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17465*    FOR 'MON'.                                                  *
 17466*                                                                *
 17467******************************************************************
 17468
 17469     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17470     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17471     MOVE +1                     TO WS-SUB1
 17472                                    WS-SUB2.
 17473
 17474 4530-EDIT-MEMB-NAME.
 17475
 17476     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17477        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17478        ADD +1                       TO WS-SUB2.
 17479
 17480     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17481        ADD +1                       TO WS-SUB1
 17482        GO TO 4530-EDIT-MEMB-NAME.
 17483
 17484     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17485     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17486     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17487*    MOVE SPACE                      TO DC-OPTION-CODE.
 17488     SET  BIN-TO-GREG                TO TRUE.
 17489     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17490     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17491
 17492     GO TO 4550-CONT-CERT-PROCESS.
 17493
 17494******************************************************************
 17495*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17496******************************************************************
 17497
 17498 4540-BUILD-MEMBER-NO.
 17499
 17500     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17501         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17502         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17503         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 318
* EL050.cbl
 17504         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17505     ELSE
 17506         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17507
 17508     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17509        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17510         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17511
 17512 4550-CONT-CERT-PROCESS.
 17513
 17514*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17515*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17516*    ELSE
 17517*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17518
 17519     IF CERT-WAS-CREATED-FOR-CLAIM
 17520        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17521        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17522
 17523     IF CERT-AND-CLAIM-ONLINE
 17524        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17525        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17526
 17527     MOVE 'CM'                     TO CM-RECORD-ID.
 17528     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17529
 17530     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17531        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17532        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17533     ELSE
 17534        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17535        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17536
 17537     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17538     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17539     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17540     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17541     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17542     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17543     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17544                                      CM-LF-ITD-CANCEL-AMT
 17545                                      CM-LF-ITD-DEATH-AMT
 17546                                      CM-AH-ITD-AH-PMT
 17547                                      CM-AH-ITD-LUMP-PMT
 17548                                      CM-AH-ITD-CANCEL-AMT
 17549                                      CM-LF-NSP-PREMIUM-AMT
 17550                                      CM-AH-NSP-PREMIUM-AMT.
 17551*                                     CM-CLAIM-DEDUCT-WITHHELD
 17552*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17553     if pb-i-loan-apr = +99.9999
 17554        move zeros                 to cm-loan-apr
 17555     else
 17556        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17557     end-if
 17558     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17559     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17560     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17561     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 319
* EL050.cbl
 17562     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17563     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17564     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17565     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17566     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17567     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17568     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17569
 17570     IF PB-I-LIVES NOT NUMERIC
 17571         MOVE ZERO                 TO PB-I-LIVES.
 17572
 17573     IF PB-I-NUM-BILLED NOT NUMERIC
 17574         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17575
 17576     MOVE PB-I-LIVES               TO CM-LIVES.
 17577     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17578
 17579     IF PB-COMPANY-ID EQUAL  'DMD'
 17580         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17581         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17582
 17583     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17584     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17585     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17586     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17587     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17588     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17589
 17590     IF PB-I-LF-POLICY-FEE NUMERIC
 17591        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17592     ELSE
 17593        MOVE +0                    TO CM-LF-POLICY-FEE.
 17594
 17595     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17596        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17597        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17598     ELSE
 17599        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17600
 17601     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17602     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17603     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17604     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17605     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17606     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17607     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17608     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17609     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17610
 17611     IF PB-I-AH-POLICY-FEE NUMERIC
 17612        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17613     ELSE
 17614        MOVE +0                    TO CM-AH-POLICY-FEE.
 17615
 17616     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17617        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17618     ELSE
 17619        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 320
* EL050.cbl
 17620
 17621     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17622     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17623
 17624     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17625                                      CM-LF-DEATH-EXIT-DT
 17626                                      CM-AH-SETTLEMENT-EXIT-DT.
 17627
 17628*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17629*                       'TIH' OR 'OFL' OR 'FLA' OR
 17630*                       'TII' OR 'TMS' OR 'CRI' OR
 17631*                       'NCL'
 17632     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17633
 17634     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17635         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17636            MOVE '2'                TO CM-PREMIUM-TYPE.
 17637
 17638     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17639         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17640            MOVE '2'                TO CM-PREMIUM-TYPE.
 17641
 17642     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17643         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17644     ELSE
 17645         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17646         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17647
 17648     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17649     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17650     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17651     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17652     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17653     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17654     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17655     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17656
 17657     IF PB-NO-MONTHS-SKIPPED
 17658         MOVE SPACE                 TO CM-SKIP-CODE
 17659     ELSE
 17660         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17661
 17662     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17663     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17664                                       CM-LF-STATUS-AT-CANCEL.
 17665
 17666     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17667     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17668                                       CM-AH-STATUS-AT-CANCEL.
 17669
 17670     MOVE '1'                       TO CM-ENTRY-STATUS.
 17671
 17672     IF PB-REISSUED-CERT
 17673        MOVE '5'                    TO CM-ENTRY-STATUS.
 17674
 17675     IF PB-MONTHLY-CERT
 17676        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17677
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 321
* EL050.cbl
 17678     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17679     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17680     IF PB-POLICY-IS-DECLINED
 17681        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17682
 17683     IF PB-POLICY-IS-VOIDED
 17684        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17685
 17686     IF PB-NEEDS-UNDERWRITING
 17687        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17688
 17689     IF PB-REIN-ONLY-CERT
 17690        MOVE '9'                    TO CM-ENTRY-STATUS.
 17691
 17692     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17693         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17694     ELSE
 17695         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17696
 17697     IF PB-RECORD-RETURNED
 17698        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17699      ELSE
 17700        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17701
 17702     IF PB-I-MAIL-ADDRS-PRESENT
 17703        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17704
 17705     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17706                                       CM-ENTRY-DT.
 17707
 17708 4999-EXIT.
 17709     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 322
* EL050.cbl
 17711
 17712 5000-PROCESS-REPS.
 17713     MOVE ' '                    TO AGTC-MASTER-SW
 17714     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17715     MOVE CO-TYPE                TO AGTC-TYPE
 17716     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17717     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17718     IF (AGTC-MASTER-SW NOT = 'N')
 17719        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17720        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17721        PERFORM 8583-READ-ERAGTC-NEXT
 17722                                 THRU 8583-EXIT
 17723     END-IF
 17724     IF AGTC-MASTER-SW = 'N'
 17725        CONTINUE
 17726     ELSE
 17727        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17728           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17729              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17730              MOVE 'Y'           TO AGTC-MASTER-SW
 17731           END-IF
 17732        END-IF
 17733     END-IF
 17734     .
 17735 5000-EXIT.
 17736     EXIT.
 17737 6370-EDIT-INPUT-LF-CODE.
 17738     move ' ' to ws-benefit-cd-chg-sw
 17739     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17740        MOVE +1                  TO SUB
 17741        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17742        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17743        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17744        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17745        GO TO 6370-SEARCH-LOOP.
 17746
 17747     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17748
 17749     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17750     MOVE SPACES                 TO CNTL-ACCESS.
 17751*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17752     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17753     MOVE +0                     TO CNTL-SEQ-NO.
 17754     MOVE '4' TO RC-SW-2.
 17755     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17756
 17757     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17758        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17759        GO TO 6370-NO-LF-FOUND.
 17760
 17761     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17762     MOVE +1                     TO SUB.
 17763
 17764 6370-SEARCH-LOOP.
 17765     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17766         GO TO 6370-NO-LF-FOUND.
 17767
 17768     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 323
* EL050.cbl
 17769        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17770           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17771           set benefit-code-chg to true
 17772        end-if
 17773         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17774         GO TO 6370-HER-NET-PAY-CHECK.
 17775
 17776     ADD 1   TO SUB.
 17777*    IF SUB GREATER 120
 17778     IF SUB GREATER 200
 17779         GO TO 6370-NO-LF-FOUND.
 17780
 17781     GO TO 6370-SEARCH-LOOP.
 17782
 17783 6370-NO-LF-FOUND.
 17784
 17785     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17786        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17787        set benefit-code-chg to true
 17788     end-if
 17789     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17790
 17791 6370-HER-NET-PAY-CHECK.
 17792
 17793     IF PB-COMPANY-ID = 'CID'
 17794        IF PB-SV-STATE = 'CA' OR 'MN'
 17795           IF PB-I-LF-BENEFIT-CD = '02'
 17796              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17797           ELSE
 17798              IF PB-I-LF-BENEFIT-CD = '04'
 17799                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17800              END-IF
 17801           END-IF
 17802        END-IF
 17803     END-IF
 17804
 17805     IF PB-COMPANY-ID NOT = 'HER'
 17806         GO TO 6370-EXIT.
 17807
 17808     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17809         GO TO 6370-EXIT.
 17810
 17811     IF PB-I-LF-TERM NOT NUMERIC
 17812         MOVE ZEROS              TO PB-I-LF-TERM.
 17813
 17814     IF PB-I-LOAN-TERM NOT NUMERIC
 17815         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17816
 17817     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17818         GO TO 6370-EXIT.
 17819
 17820     IF PB-I-LF-BENEFIT-CD = '33'
 17821         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17822
 17823     IF PB-I-LF-BENEFIT-CD = '34'
 17824         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17825
 17826 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 324
* EL050.cbl
 17827     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 325
* EL050.cbl
 17829
 17830 6380-EDIT-INPUT-AH-CODE.
 17831     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17832        MOVE +1                  TO SUB
 17833        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17834        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17835        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17836        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17837        GO TO 6380-SEARCH-LOOP.
 17838
 17839     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17840
 17841     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17842     MOVE SPACES                 TO CNTL-ACCESS.
 17843     MOVE 'A'                    TO CNTL-REC-TYPE.
 17844*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17845     MOVE +0                     TO CNTL-SEQ-NO.
 17846     MOVE '5' TO RC-SW-2.
 17847     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17848
 17849     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17850        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17851        GO TO 6380-NO-AH-FOUND.
 17852
 17853     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17854     MOVE +1 TO SUB.
 17855
 17856 6380-SEARCH-LOOP.
 17857     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17858         GO TO 6380-NO-AH-FOUND.
 17859
 17860     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17861         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17862         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17863
 17864     ADD 1   TO SUB.
 17865     IF SUB GREATER THAN 96
 17866*    IF SUB GREATER THAN 300
 17867         GO TO 6380-NO-AH-FOUND.
 17868
 17869     GO TO 6380-SEARCH-LOOP.
 17870
 17871 6380-NO-AH-FOUND.
 17872
 17873     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17874
 17875     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17876         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17877     ELSE
 17878         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17879
 17880 6380-CSO-AH-ONLY-CHECKS.
 17881
 17882     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17883        NEXT SENTENCE
 17884      ELSE
 17885        GO TO 6380-EXIT.
 17886
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 326
* EL050.cbl
 17887     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17888         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17889
 17890
 17891     GO TO 6380-EXIT
 17892     .
 17893 6380-CSO-LIFE-WITH-AH-CHECKS.
 17894
 17895
 17896     .
 17897 6380-EXIT.
 17898     EXIT.
 17899
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 327
* EL050.cbl
 17901
 17902 6400-COMPUTE-EXTENSION-DAYS.
 17903
 17904******************************************************************
 17905*                                                                *
 17906*                   COMPUTE EXTENSION DAYS                       *
 17907*                                                                *
 17908*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17909*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17910*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17911*    THE EXTENSION DAYS.                                         *
 17912*                                                                *
 17913******************************************************************
 17914
 17915     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17916     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17917
 17918******************************************************************
 17919*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17920*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17921******************************************************************
 17922
 17923     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17924        COMPUTE WS-ODD-DAYS-OVER =
 17925               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17926     ELSE
 17927        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17928
 17929     IF WS-ODD-DAYS-OVER = ZEROS
 17930           GO TO 6499-EXIT
 17931     ELSE
 17932        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17933           IF WS-WDF-MONTH = 02
 17934              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17935              ADD 2       TO  WS-ODD-DAYS-OVER
 17936              GO TO 6499-EXIT
 17937           ELSE
 17938              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17939                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17940                 GO TO 6499-EXIT
 17941               ELSE
 17942                 GO TO 6499-EXIT
 17943        ELSE
 17944           GO TO 6499-EXIT.
 17945
 17946 6412-CHECK-TO-DAY.
 17947
 17948        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17949           IF WS-WDT-DAY = 28
 17950              ADD 2              TO WS-ODD-DAYS-OVER
 17951           ELSE
 17952              IF WS-WDT-DAY = 29
 17953                 ADD 1           TO WS-ODD-DAYS-OVER
 17954              ELSE
 17955                 NEXT SENTENCE
 17956        ELSE
 17957           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17958              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 328
* EL050.cbl
 17959
 17960     GO TO 6499-EXIT.
 17961
 17962
 17963 6415-CHECK-LEAP-YEAR.
 17964
 17965     IF DC-DAYS-IN-MONTH = 29
 17966        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17967
 17968 6415-EXIT.
 17969     EXIT.
 17970
 17971 6499-EXIT.
 17972      EXIT.
 17973
 17974 6500-END.
 17975     EXIT.
 17976
 17977
 17978******************************************************************
 17979************* PROCEDURE DIVISION FOR EL050 ***********************
 17980********************** ELC50PD END *******************************
 17981
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 329
* EL050.cbl
 17983
 17984**START***********************************************************
 17985*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17986*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17987******************************************************************
 17988*
 17989 6600-GET-STATE-MUNICIPAL-TAX.
 17990
 17991     IF PB-COMPANY-ID NOT = 'DMD'
 17992         GO TO 6640-EXIT.
 17993
 17994     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17995     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17996     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17997*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17998*
 17999***  Y2K PROJ 7744
 18000     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18001     SET BIN-TO-GREG          TO TRUE.
 18002     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18003
 18004     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18005
 18006     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18007     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18008
 18009
 18010* EXEC CICS HANDLE CONDITION
 18011*        INVREQ    (6610-START-BROWSE)
 18012*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18013*        NOTFND    (6630-END-OF-FILE)
 18014*    END-EXEC.
 18015*    MOVE '"$8JI                 ! # #00017997' TO DFHEIV0
 18016     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18017     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18018     MOVE X'2320233030303137393937' TO DFHEIV0(25:11)
 18019     CALL 'kxdfhei1' USING DFHEIV0
 18020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18021
 18022
 18023 6610-START-BROWSE.
 18024
 18025
 18026* EXEC CICS HANDLE CONDITION
 18027*        NOTFND    (6630-END-OF-FILE)
 18028*        DISABLED  (6630-ERRESS-PROBLEM)
 18029*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18030*        ENDFILE   (6630-END-OF-FILE)
 18031*    END-EXEC.
 18032*    MOVE '"$IcJ''                ! $ #00018005' TO DFHEIV0
 18033     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18034     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18035     MOVE X'2420233030303138303035' TO DFHEIV0(25:11)
 18036     CALL 'kxdfhei1' USING DFHEIV0
 18037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18038
 18039
 18040
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 330
* EL050.cbl
 18041* EXEC CICS STARTBR
 18042*        DATASET (FILE-ID-ERRESS)
 18043*        RIDFLD  (WS-ERRESS-KEY)
 18044*        GTEQ
 18045*    END-EXEC.
 18046     MOVE 0
 18047       TO DFHEIV11
 18048*    MOVE '&,         G          &   #00018012' TO DFHEIV0
 18049     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18050     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18051     MOVE X'2020233030303138303132' TO DFHEIV0(25:11)
 18052     CALL 'kxdfhei1' USING DFHEIV0,
 18053           FILE-ID-ERRESS,
 18054           WS-ERRESS-KEY,
 18055           DFHEIV99,
 18056           DFHEIV11,
 18057           DFHEIV99
 18058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18059
 18060
 18061 6620-READ-NEXT-ERRESS-MASTER.
 18062
 18063
 18064* EXEC CICS HANDLE CONDITION
 18065*        NOTFND    (6630-END-OF-FILE)
 18066*        ENDFILE   (6630-END-OF-FILE)
 18067*        DISABLED  (6630-ERRESS-PROBLEM)
 18068*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18069*    END-EXEC.
 18070*    MOVE '"$I''cJ                ! % #00018020' TO DFHEIV0
 18071     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18073     MOVE X'2520233030303138303230' TO DFHEIV0(25:11)
 18074     CALL 'kxdfhei1' USING DFHEIV0
 18075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18076
 18077
 18078
 18079* EXEC CICS READNEXT
 18080*        DATASET (FILE-ID-ERRESS)
 18081*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18082*        RIDFLD  (WS-ERRESS-KEY)
 18083*    END-EXEC.
 18084     MOVE LENGTH OF
 18085      RESIDENT-STATE-TAX-MASTER
 18086       TO DFHEIV12
 18087     MOVE 0
 18088       TO DFHEIV11
 18089*    MOVE '&.IL                  )   #00018027' TO DFHEIV0
 18090     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18091     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18092     MOVE X'2020233030303138303237' TO DFHEIV0(25:11)
 18093     CALL 'kxdfhei1' USING DFHEIV0,
 18094           FILE-ID-ERRESS,
 18095           RESIDENT-STATE-TAX-MASTER,
 18096           DFHEIV12,
 18097           WS-ERRESS-KEY,
 18098           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 331
* EL050.cbl
 18099           DFHEIV11,
 18100           DFHEIV99,
 18101           DFHEIV99
 18102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18103
 18104
 18105     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18106
 18107* EXEC CICS ENDBR
 18108*            DATASET (FILE-ID-ERRESS)
 18109*       END-EXEC
 18110     MOVE 0
 18111       TO DFHEIV11
 18112*    MOVE '&2                    $   #00018034' TO DFHEIV0
 18113     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18114     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18115     MOVE X'2020233030303138303334' TO DFHEIV0(25:11)
 18116     CALL 'kxdfhei1' USING DFHEIV0,
 18117           FILE-ID-ERRESS,
 18118           DFHEIV11,
 18119           DFHEIV99
 18120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18121        GO TO 6630-END-OF-FILE.
 18122
 18123     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18124        NEXT SENTENCE
 18125      ELSE
 18126        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18127
 18128*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18129*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18130*
 18131     MOVE +2                     TO WS-SUB1.
 18132
 18133     IF PB-ISSUE
 18134     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18135        MOVE +1                  TO WS-SUB1.
 18136
 18137     IF PB-CANCELLATION
 18138     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18139        MOVE +1                  TO WS-SUB1.
 18140*
 18141*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18142*
 18143***  Y2K PROJ 7744
 18144     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18145***  Y2K PROJ 7744
 18146
 18147*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18148* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18149* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18150
 18151     ADD 1                    TO WS-YEAR-YY.
 18152
 18153     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18154         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18155                              TO WS-RES-STATE-TAX
 18156         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 332
* EL050.cbl
 18157                              TO WS-RES-MUNI-TAX
 18158     ELSE
 18159         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18160                              TO WS-RES-STATE-TAX
 18161         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18162                              TO WS-RES-MUNI-TAX.
 18163
 18164*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18165
 18166     IF PB-CANCELLATION
 18167         GO TO 6640-CANCEL-TAX.
 18168
 18169     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18170         COMPUTE PB-I-STATE-TAX ROUNDED =
 18171                                   PB-I-LF-PREMIUM-AMT
 18172                                 * WS-RES-STATE-TAX
 18173         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18174                                   PB-I-LF-PREMIUM-AMT
 18175                                 * WS-RES-MUNI-TAX
 18176     ELSE
 18177     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18178         COMPUTE PB-I-STATE-TAX ROUNDED =
 18179                                   PB-I-AH-PREMIUM-AMT
 18180                                 * WS-RES-STATE-TAX
 18181         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18182                                   PB-I-AH-PREMIUM-AMT
 18183                                 * WS-RES-MUNI-TAX.
 18184
 18185
 18186* EXEC CICS ENDBR
 18187*         DATASET (FILE-ID-ERRESS)
 18188*    END-EXEC.
 18189     MOVE 0
 18190       TO DFHEIV11
 18191*    MOVE '&2                    $   #00018101' TO DFHEIV0
 18192     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18193     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18194     MOVE X'2020233030303138313031' TO DFHEIV0(25:11)
 18195     CALL 'kxdfhei1' USING DFHEIV0,
 18196           FILE-ID-ERRESS,
 18197           DFHEIV11,
 18198           DFHEIV99
 18199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18200
 18201
 18202     GO TO 6640-EXIT.
 18203
 18204 6640-CANCEL-TAX.
 18205     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18206
 18207     IF PB-C-LF-CANCEL-AMT > ZEROS
 18208         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18209                                   PB-C-LF-CANCEL-AMT
 18210                                 * WS-RES-STATE-TAX
 18211         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18212                                   PB-C-LF-CANCEL-AMT
 18213                                *  WS-RES-MUNI-TAX
 18214     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 333
* EL050.cbl
 18215     IF PB-C-AH-CANCEL-AMT > ZEROS
 18216         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18217                                   PB-C-AH-CANCEL-AMT
 18218                                 * WS-RES-STATE-TAX
 18219         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18220                                   PB-C-AH-CANCEL-AMT
 18221                                *  WS-RES-MUNI-TAX.
 18222
 18223
 18224* EXEC CICS ENDBR
 18225*         DATASET (FILE-ID-ERRESS)
 18226*    END-EXEC.
 18227     MOVE 0
 18228       TO DFHEIV11
 18229*    MOVE '&2                    $   #00018126' TO DFHEIV0
 18230     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18231     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18232     MOVE X'2020233030303138313236' TO DFHEIV0(25:11)
 18233     CALL 'kxdfhei1' USING DFHEIV0,
 18234           FILE-ID-ERRESS,
 18235           DFHEIV11,
 18236           DFHEIV99
 18237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18238
 18239
 18240     GO TO 6640-EXIT.
 18241
 18242 6630-END-OF-FILE.
 18243     MOVE ER-8002              TO WS-ERROR.
 18244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18245
 18246     GO TO 6640-EXIT.
 18247
 18248 6630-ERRESS-PROBLEM.
 18249     MOVE ER-8044              TO WS-ERROR.
 18250     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18251
 18252 6640-EXIT.
 18253     EXIT.
 18254
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 334
* EL050.cbl
 18256 6650-GET-RES-STATE-COMM.
 18257
 18258     IF PB-COMPANY-ID NOT = 'DMD'
 18259         GO TO 6700-COMM-EXIT.
 18260
 18261     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18262     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18263     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18264     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18265     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18266     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18267     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18268
 18269*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18270*
 18271***  Y2K PROJ 7744
 18272     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18273     SET BIN-TO-GREG          TO TRUE.
 18274     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18275
 18276     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18277***  Y2K PROJ 7744
 18278
 18279     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18280
 18281
 18282* EXEC CICS HANDLE CONDITION
 18283*        INVREQ    (6660-START-BROWSE)
 18284*        DISABLED  (6690-ERRESC-PROBLEM)
 18285*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18286*        NOTFND    (6690-END-OF-FILE)
 18287*    END-EXEC.
 18288*    MOVE '"$8cJI                ! & #00018171' TO DFHEIV0
 18289     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18290     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18291     MOVE X'2620233030303138313731' TO DFHEIV0(25:11)
 18292     CALL 'kxdfhei1' USING DFHEIV0
 18293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18294
 18295
 18296
 18297* EXEC CICS RESETBR
 18298*        DATASET (FILE-ID-ERRESC)
 18299*        RIDFLD  (WS-ERRESC-KEY)
 18300*    END-EXEC.
 18301     MOVE 0
 18302       TO DFHEIV11
 18303*    MOVE '&4         G          &   #00018178' TO DFHEIV0
 18304     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18305     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18306     MOVE X'2020233030303138313738' TO DFHEIV0(25:11)
 18307     CALL 'kxdfhei1' USING DFHEIV0,
 18308           FILE-ID-ERRESC,
 18309           WS-ERRESC-KEY,
 18310           DFHEIV99,
 18311           DFHEIV11,
 18312           DFHEIV99
 18313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 335
* EL050.cbl
 18314
 18315
 18316 6660-START-BROWSE.
 18317
 18318
 18319* EXEC CICS HANDLE CONDITION
 18320*        NOTFND    (6690-END-OF-FILE)
 18321*        DISABLED  (6690-ERRESC-PROBLEM)
 18322*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18323*        ENDFILE   (6690-END-OF-FILE)
 18324*    END-EXEC.
 18325*    MOVE '"$IcJ''                ! '' #00018185' TO DFHEIV0
 18326     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18328     MOVE X'2720233030303138313835' TO DFHEIV0(25:11)
 18329     CALL 'kxdfhei1' USING DFHEIV0
 18330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18331
 18332
 18333
 18334* EXEC CICS STARTBR
 18335*        DATASET (FILE-ID-ERRESC)
 18336*        RIDFLD  (WS-ERRESC-KEY)
 18337*        GTEQ
 18338*    END-EXEC.
 18339     MOVE 0
 18340       TO DFHEIV11
 18341*    MOVE '&,         G          &   #00018192' TO DFHEIV0
 18342     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18343     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18344     MOVE X'2020233030303138313932' TO DFHEIV0(25:11)
 18345     CALL 'kxdfhei1' USING DFHEIV0,
 18346           FILE-ID-ERRESC,
 18347           WS-ERRESC-KEY,
 18348           DFHEIV99,
 18349           DFHEIV11,
 18350           DFHEIV99
 18351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18352
 18353
 18354     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18355
 18356 6670-READ-NEXT-ERRESC-MASTER.
 18357
 18358
 18359* EXEC CICS HANDLE CONDITION
 18360*        NOTFND    (6690-END-OF-FILE)
 18361*        DISABLED  (6690-ERRESC-PROBLEM)
 18362*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18363*        ENDFILE   (6690-END-OF-FILE)
 18364*    END-EXEC.
 18365*    MOVE '"$IcJ''                ! ( #00018202' TO DFHEIV0
 18366     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18367     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18368     MOVE X'2820233030303138323032' TO DFHEIV0(25:11)
 18369     CALL 'kxdfhei1' USING DFHEIV0
 18370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18371
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 336
* EL050.cbl
 18372
 18373
 18374* EXEC CICS READNEXT
 18375*        DATASET (FILE-ID-ERRESC)
 18376*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18377*        RIDFLD  (ERRESC-RECORD-KEY)
 18378*    END-EXEC.
 18379     MOVE LENGTH OF
 18380      ACCOUNT-RESIDENT-ST-COMMISSION
 18381       TO DFHEIV12
 18382     MOVE 0
 18383       TO DFHEIV11
 18384*    MOVE '&.IL                  )   #00018209' TO DFHEIV0
 18385     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18386     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18387     MOVE X'2020233030303138323039' TO DFHEIV0(25:11)
 18388     CALL 'kxdfhei1' USING DFHEIV0,
 18389           FILE-ID-ERRESC,
 18390           ACCOUNT-RESIDENT-ST-COMMISSION,
 18391           DFHEIV12,
 18392           ERRESC-RECORD-KEY,
 18393           DFHEIV99,
 18394           DFHEIV11,
 18395           DFHEIV99,
 18396           DFHEIV99
 18397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18398
 18399
 18400     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18401        NEXT SENTENCE
 18402     ELSE
 18403
 18404* EXEC CICS ENDBR
 18405*            DATASET (FILE-ID-ERRESC)
 18406*       END-EXEC
 18407     MOVE 0
 18408       TO DFHEIV11
 18409*    MOVE '&2                    $   #00018218' TO DFHEIV0
 18410     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18411     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18412     MOVE X'2020233030303138323138' TO DFHEIV0(25:11)
 18413     CALL 'kxdfhei1' USING DFHEIV0,
 18414           FILE-ID-ERRESC,
 18415           DFHEIV11,
 18416           DFHEIV99
 18417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18418        GO TO 6690-END-OF-FILE.
 18419
 18420     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18421
 18422* EXEC CICS ENDBR
 18423*            DATASET (FILE-ID-ERRESC)
 18424*       END-EXEC
 18425     MOVE 0
 18426       TO DFHEIV11
 18427*    MOVE '&2                    $   #00018224' TO DFHEIV0
 18428     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18429     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 337
* EL050.cbl
 18430     MOVE X'2020233030303138323234' TO DFHEIV0(25:11)
 18431     CALL 'kxdfhei1' USING DFHEIV0,
 18432           FILE-ID-ERRESC,
 18433           DFHEIV11,
 18434           DFHEIV99
 18435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18436        GO TO 6690-END-OF-FILE.
 18437
 18438     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18439        NEXT SENTENCE
 18440      ELSE
 18441        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18442
 18443* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18444*
 18445     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18446
 18447     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18448
 18449     IF WS-SUB1 > ZERO
 18450         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18451             PERFORM 6680-SET-COMMISSION
 18452         ELSE
 18453             PERFORM 6680-SET-TABLE-CODE.
 18454
 18455
 18456* EXEC CICS ENDBR
 18457*         DATASET (FILE-ID-ERRESC)
 18458*    END-EXEC.
 18459     MOVE 0
 18460       TO DFHEIV11
 18461*    MOVE '&2                    $   #00018246' TO DFHEIV0
 18462     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18463     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18464     MOVE X'2020233030303138323436' TO DFHEIV0(25:11)
 18465     CALL 'kxdfhei1' USING DFHEIV0,
 18466           FILE-ID-ERRESC,
 18467           DFHEIV11,
 18468           DFHEIV99
 18469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18470
 18471
 18472     GO TO 6700-COMM-EXIT.
 18473
 18474 6680-SET-TABLE-CODE.
 18475     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18476        MOVE ZEROS             TO WS-SUB1
 18477     ELSE
 18478* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18479* TO COMPUTE AH COMMISSION.
 18480        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18481        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18482        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18483        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18484        PERFORM 6680-READ-CTBL-TABLE
 18485        IF WS-CTBL-READ-SW NOT = 'Y'
 18486           MOVE ZEROS          TO WS-SUB1.
 18487
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 338
* EL050.cbl
 18488 6680-READ-CTBL-TABLE.
 18489*
 18490* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18491* TO COMPUTE LIFE COMMISSION
 18492
 18493     IF CTBL-SW = '0540'
 18494        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18495        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18496        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18497
 18498     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18499
 18500     IF CTBL-TABLE-FOUND
 18501        IF CTBL-SW = '0530'
 18502             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18503                                    * PB-I-AH-TERM
 18504             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18505             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18506        ELSE
 18507             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18508             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18509             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18510     ELSE
 18511        IF FIRST-TIME-THROUGH
 18512            GO TO 6680-READ-CTBL-TABLE
 18513        ELSE
 18514            MOVE ZEROS         TO WS-SUB1.
 18515
 18516 6680-SET-COMMISSION.
 18517     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18518           MOVE ZEROS          TO WS-SUB1
 18519       ELSE
 18520           MOVE RESC-COMMISSION-PER (WS-SUB)
 18521                               TO WS-COMMISSION
 18522           IF CTBL-SW = '0530'
 18523               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18524           ELSE
 18525               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18526
 18527 6680-SEARCH-CATEGORY.
 18528     ADD +1                   TO WS-SUB.
 18529     IF WS-SUB > +12
 18530         GO TO 6680-EXIT.
 18531
 18532     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18533          MOVE WS-SUB         TO WS-SUB1
 18534          GO TO 6680-EXIT.
 18535
 18536     GO TO 6680-SEARCH-CATEGORY.
 18537
 18538 6680-EXIT.
 18539     EXIT.
 18540
 18541 6690-END-OF-FILE.
 18542     GO TO 6700-COMM-EXIT.
 18543
 18544 6690-ERRESC-PROBLEM.
 18545      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 339
* EL050.cbl
 18546      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18547
 18548      GO TO 6700-COMM-EXIT.
 18549
 18550 6700-COMM-EXIT.
 18551     EXIT.
 18552
 18553 7000-GET-RATE.
 18554
 18555* EXEC CICS LINK
 18556*        PROGRAM    ('ELRATE')
 18557*        COMMAREA   (CALCULATION-PASS-AREA)
 18558*        LENGTH     (CP-COMM-LENGTH)
 18559*    END-EXEC.
 18560     MOVE 'ELRATE' TO DFHEIV1
 18561*    MOVE '."C                   (   #00018332' TO DFHEIV0
 18562     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18564     MOVE X'2020233030303138333332' TO DFHEIV0(25:11)
 18565     CALL 'kxdfhei1' USING DFHEIV0,
 18566           DFHEIV1,
 18567           CALCULATION-PASS-AREA,
 18568           CP-COMM-LENGTH,
 18569           DFHEIV99,
 18570           DFHEIV99,
 18571           DFHEIV99,
 18572           DFHEIV99
 18573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18574
 18575
 18576 7000-EXIT.
 18577     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 340
* EL050.cbl
 18579 7100-FIND-BENEFIT-IN-STATE.
 18580     MOVE 'N'                    TO BEN-SEARCH-SW.
 18581
 18582     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18583         VARYING SUB3 FROM 1 BY 1 UNTIL
 18584            ((SUB3 GREATER 50) OR
 18585              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18586               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18587
 18588     IF SUB3 NOT = 51
 18589         MOVE 'Y'                TO BEN-SEARCH-SW.
 18590
 18591     GO TO 7199-EXIT.
 18592
 18593 7100-BENEFIT-DUMMY.
 18594
 18595 7100-DUMMY-EXIT.
 18596     EXIT.
 18597
 18598 7199-EXIT.
 18599     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 341
* EL050.cbl
 18601 7200-FIND-BENEFIT.
 18602     MOVE 'N'                    TO BEN-SEARCH-SW.
 18603
 18604     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18605         VARYING SUB3 FROM 1 BY 1 UNTIL
 18606            ((SUB3 GREATER 8) OR
 18607            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18608
 18609     IF SUB3 NOT = 9
 18610         MOVE 'Y'                TO BEN-SEARCH-SW.
 18611
 18612     GO TO 7200-EXIT.
 18613
 18614 7200-BENEFIT-DUMMY.
 18615
 18616 7200-DUMMY-EXIT.
 18617     EXIT.
 18618
 18619 7200-EXIT.
 18620     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 342
* EL050.cbl
 18622 7250-LOOK-FOR-RESCINDED-CLAIM.
 18623     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18624                                    W-CL-COMP-CD.
 18625     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18626                                    W-CL-CERT-NO.
 18627
 18628
 18629* EXEC CICS HANDLE CONDITION
 18630*        NOTFND  (7250-CONTINUE)
 18631*        ENDFILE (7250-CONTINUE)
 18632*    END-EXEC.
 18633*    MOVE '"$I''                  ! ) #00018390' TO DFHEIV0
 18634     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18636     MOVE X'2920233030303138333930' TO DFHEIV0(25:11)
 18637     CALL 'kxdfhei1' USING DFHEIV0
 18638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18639
 18640
 18641
 18642* EXEC CICS IGNORE CONDITION
 18643*        DUPKEY
 18644*    END-EXEC.
 18645*    MOVE '"*$                   !   #00018395' TO DFHEIV0
 18646     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18647     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18648     MOVE X'2020233030303138333935' TO DFHEIV0(25:11)
 18649     CALL 'kxdfhei1' USING DFHEIV0
 18650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18651
 18652
 18653
 18654* EXEC CICS STARTBR
 18655*        DATASET   (CLMS-ID)
 18656*        RIDFLD    (ELMSTR-KEY)
 18657*        GENERIC   EQUAL
 18658*        KEYLENGTH (ELMSTR-LENGTH)
 18659*    END-EXEC.
 18660     MOVE 0
 18661       TO DFHEIV11
 18662*    MOVE '&,   KG    E          &   #00018399' TO DFHEIV0
 18663     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18664     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18665     MOVE X'2020233030303138333939' TO DFHEIV0(25:11)
 18666     CALL 'kxdfhei1' USING DFHEIV0,
 18667           CLMS-ID,
 18668           ELMSTR-KEY,
 18669           ELMSTR-LENGTH,
 18670           DFHEIV11,
 18671           DFHEIV99
 18672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18673
 18674
 18675     MOVE 'Y'                    TO W-BROWSE-SW.
 18676
 18677 7250-NEXT-CLAIM.
 18678
 18679
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 343
* EL050.cbl
 18680* EXEC CICS READNEXT
 18681*        DATASET   (CLMS-ID)
 18682*        RIDFLD    (ELMSTR-KEY)
 18683*        SET       (ADDRESS OF CLAIM-MASTER)
 18684*    END-EXEC.
 18685     MOVE 0
 18686       TO DFHEIV11
 18687*    MOVE '&.S                   )   #00018410' TO DFHEIV0
 18688     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18689     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18690     MOVE X'2020233030303138343130' TO DFHEIV0(25:11)
 18691     CALL 'kxdfhei1' USING DFHEIV0,
 18692           CLMS-ID,
 18693           DFHEIV20,
 18694           DFHEIV99,
 18695           ELMSTR-KEY,
 18696           DFHEIV99,
 18697           DFHEIV11,
 18698           DFHEIV99,
 18699           DFHEIV99
 18700     SET ADDRESS OF CLAIM-MASTER TO
 18701         DFHEIV20
 18702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18703
 18704
 18705     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18706        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18707         GO TO 7250-CONTINUE
 18708     END-IF.
 18709
 18710     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18711        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18712        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18713        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18714        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18715         GO TO 7250-NEXT-CLAIM
 18716     END-IF.
 18717
 18718     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18719        OR (CL-CLAIM-TYPE = 'I')
 18720        OR (CL-CLAIM-TYPE = 'G')
 18721          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18722              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18723              GO TO 7250-CONTINUE
 18724          END-IF
 18725     END-IF.
 18726
 18727     GO TO 7250-NEXT-CLAIM.
 18728
 18729 7250-CONTINUE.
 18730
 18731     IF W-BROWSE-SW = 'Y'
 18732
 18733* EXEC CICS ENDBR
 18734*            DATASET   (CLMS-ID)
 18735*        END-EXEC
 18736     MOVE 0
 18737       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 344
* EL050.cbl
 18738*    MOVE '&2                    $   #00018443' TO DFHEIV0
 18739     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18740     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18741     MOVE X'2020233030303138343433' TO DFHEIV0(25:11)
 18742     CALL 'kxdfhei1' USING DFHEIV0,
 18743           CLMS-ID,
 18744           DFHEIV11,
 18745           DFHEIV99
 18746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18747         MOVE 'N' TO W-BROWSE-SW
 18748     END-IF.
 18749
 18750 7250-EXIT.
 18751     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 345
* EL050.cbl
 18753 7300-CHECK-FOR-OPEN-CLMS.
 18754
 18755*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18756*    MOVE SPACES                 TO CNTL-ACCESS.
 18757*    MOVE '1'                    TO CNTL-REC-TYPE.
 18758*    MOVE +0                     TO CNTL-SEQ-NO.
 18759
 18760*    MOVE '3'                    TO RC-SW-1.
 18761*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18762
 18763*    IF NOT CF-COMPANY-MASTER
 18764*         PERFORM 0099-COMPANY-NOT-FOUND
 18765*         GO TO 7300-EXIT.
 18766
 18767     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18768                                    W-CL-COMP-CD.
 18769     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18770                                    W-CL-CERT-NO.
 18771
 18772
 18773* EXEC CICS HANDLE CONDITION
 18774*        NOTFND  (7300-CONTINUE)
 18775*        ENDFILE (7300-CONTINUE)
 18776*    END-EXEC.
 18777*    MOVE '"$I''                  ! * #00018471' TO DFHEIV0
 18778     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18780     MOVE X'2A20233030303138343731' TO DFHEIV0(25:11)
 18781     CALL 'kxdfhei1' USING DFHEIV0
 18782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18783
 18784
 18785
 18786* EXEC CICS IGNORE CONDITION
 18787*        DUPKEY
 18788*    END-EXEC.
 18789*    MOVE '"*$                   !   #00018476' TO DFHEIV0
 18790     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18792     MOVE X'2020233030303138343736' TO DFHEIV0(25:11)
 18793     CALL 'kxdfhei1' USING DFHEIV0
 18794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18795
 18796
 18797
 18798* EXEC CICS STARTBR
 18799*        DATASET   (CLMS-ID)
 18800*        RIDFLD    (ELMSTR-KEY)
 18801*        GENERIC   EQUAL
 18802*        KEYLENGTH (ELMSTR-LENGTH)
 18803*    END-EXEC.
 18804     MOVE 0
 18805       TO DFHEIV11
 18806*    MOVE '&,   KG    E          &   #00018480' TO DFHEIV0
 18807     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18808     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18809     MOVE X'2020233030303138343830' TO DFHEIV0(25:11)
 18810     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 346
* EL050.cbl
 18811           CLMS-ID,
 18812           ELMSTR-KEY,
 18813           ELMSTR-LENGTH,
 18814           DFHEIV11,
 18815           DFHEIV99
 18816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18817
 18818
 18819     MOVE 'Y'                    TO W-BROWSE-SW.
 18820
 18821 7300-NEXT-CLAIM.
 18822
 18823
 18824* EXEC CICS READNEXT
 18825*        DATASET   (CLMS-ID)
 18826*        RIDFLD    (ELMSTR-KEY)
 18827*        SET       (ADDRESS OF CLAIM-MASTER)
 18828*    END-EXEC.
 18829     MOVE 0
 18830       TO DFHEIV11
 18831*    MOVE '&.S                   )   #00018491' TO DFHEIV0
 18832     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18833     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18834     MOVE X'2020233030303138343931' TO DFHEIV0(25:11)
 18835     CALL 'kxdfhei1' USING DFHEIV0,
 18836           CLMS-ID,
 18837           DFHEIV20,
 18838           DFHEIV99,
 18839           ELMSTR-KEY,
 18840           DFHEIV99,
 18841           DFHEIV11,
 18842           DFHEIV99,
 18843           DFHEIV99
 18844     SET ADDRESS OF CLAIM-MASTER TO
 18845         DFHEIV20
 18846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18847
 18848
 18849     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18850        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18851         GO TO 7300-CONTINUE.
 18852
 18853     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18854        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18855        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18856        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18857        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18858         GO TO 7300-NEXT-CLAIM.
 18859
 18860*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18861     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18862        OR (CL-CLAIM-TYPE = 'I')
 18863        OR (CL-CLAIM-TYPE = 'G')
 18864        IF CLAIM-IS-OPEN
 18865           EVALUATE TRUE
 18866             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18867                 MOVE ER-2884      TO WS-ERROR
 18868             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 347
* EL050.cbl
 18869                 MOVE ER-2887      TO WS-ERROR
 18870             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18871                 MOVE ER-2886      TO WS-ERROR
 18872             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18873                 MOVE ER-2888      TO WS-ERROR
 18874             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18875                 MOVE ER-2885      TO WS-ERROR
 18876             WHEN OTHER
 18877                 MOVE ER-2768      TO WS-ERROR
 18878           END-EVALUATE
 18879           IF PB-C-AH-CANCEL-VOIDED OR
 18880              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18881                NOT AH-COVERAGE-CANCELLED)
 18882               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18883               MOVE ER-2768      TO WS-ERROR
 18884           END-IF
 18885           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18886           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18887              PB-FORCE-CODE NOT EQUAL '8'
 18888               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18889           END-IF
 18890           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18891           GO TO 7300-CONTINUE
 18892        ELSE
 18893           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18894*****THIS IS A RESCISSION OR REFORMATION
 18895              IF (AH-COVERAGE-CANCELLED AND
 18896                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18897                    MOVE ER-2890 TO WS-ERROR
 18898                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18899                    GO TO 7300-CONTINUE
 18900              END-IF
 18901           ELSE
 18902              IF CL-DENIAL-TYPE = '1'  AND
 18903                 CL-TOTAL-PAID-AMT = 0
 18904                    GO TO 7300-NEXT-CLAIM
 18905              END-IF
 18906              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18907               AND PB-C-AH-CANCEL-DT > SPACES
 18908                 MOVE ER-2756        TO WS-ERROR
 18909                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18910                 GO TO 7300-CONTINUE
 18911              END-IF
 18912           END-IF
 18913        END-IF
 18914     ELSE
 18915*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18916        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18917           IF CLAIM-IS-OPEN
 18918              MOVE ER-2889      TO WS-ERROR
 18919              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18920              GO TO 7300-CONTINUE
 18921           ELSE
 18922              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18923*****THIS IS A RESCISSION OR REFORMATION
 18924                 IF (LF-COVERAGE-CANCELLED AND
 18925                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18926                       MOVE ER-2890 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 348
* EL050.cbl
 18927                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18928                       GO TO 7300-CONTINUE
 18929                 END-IF
 18930              ELSE
 18931                 IF CL-DENIAL-TYPE = '1'  AND
 18932                    CL-TOTAL-PAID-AMT = 0
 18933                       GO TO 7300-NEXT-CLAIM
 18934                 END-IF
 18935                 IF (AH-COVERAGE-CANCELLED AND
 18936                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18937                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18938                    (LF-COVERAGE-CANCELLED AND
 18939                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18940                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18941                       MOVE ER-2965 TO WS-ERROR
 18942                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18943                       GO TO 7300-CONTINUE
 18944                 END-IF
 18945                 IF LF-COVERAGE-CANCELLED
 18946                  IF CL-TOTAL-PAID-AMT > 0
 18947                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18948                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18949                        MOVE ER-2891 TO WS-ERROR
 18950                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18951                        GO TO 7300-CONTINUE
 18952                      END-IF
 18953                    ELSE
 18954                      MOVE ER-2892 TO WS-ERROR
 18955                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18956                      GO TO 7300-CONTINUE
 18957                    END-IF
 18958                  END-IF
 18959                 END-IF
 18960              END-IF
 18961           END-IF
 18962        END-IF
 18963     END-IF
 18964
 18965     GO TO 7300-NEXT-CLAIM.
 18966
 18967 7300-CONTINUE.
 18968
 18969     IF W-BROWSE-SW = 'Y'
 18970
 18971* EXEC CICS ENDBR
 18972*            DATASET   (CLMS-ID)
 18973*        END-EXEC.
 18974     MOVE 0
 18975       TO DFHEIV11
 18976*    MOVE '&2                    $   #00018618' TO DFHEIV0
 18977     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18978     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18979     MOVE X'2020233030303138363138' TO DFHEIV0(25:11)
 18980     CALL 'kxdfhei1' USING DFHEIV0,
 18981           CLMS-ID,
 18982           DFHEIV11,
 18983           DFHEIV99
 18984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 349
* EL050.cbl
 18985
 18986
 18987 7300-EXIT.
 18988     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 350
* EL050.cbl
 18990
 18991 7400-GET-REMAIN-TERM.
 18992
 18993* EXEC CICS LINK
 18994*        PROGRAM    ('ELRTRM')
 18995*        COMMAREA   (CALCULATION-PASS-AREA)
 18996*        LENGTH     (CP-COMM-LENGTH)
 18997*    END-EXEC.
 18998     MOVE 'ELRTRM' TO DFHEIV1
 18999*    MOVE '."C                   (   #00018627' TO DFHEIV0
 19000     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19001     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19002     MOVE X'2020233030303138363237' TO DFHEIV0(25:11)
 19003     CALL 'kxdfhei1' USING DFHEIV0,
 19004           DFHEIV1,
 19005           CALCULATION-PASS-AREA,
 19006           CP-COMM-LENGTH,
 19007           DFHEIV99,
 19008           DFHEIV99,
 19009           DFHEIV99,
 19010           DFHEIV99
 19011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19012
 19013
 19014 7400-EXIT.
 19015     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 351
* EL050.cbl
 19017
 19018 7500-GET-REMAIN-AMOUNT.
 19019
 19020* EXEC CICS LINK
 19021*        PROGRAM    ('ELRAMT')
 19022*        COMMAREA   (CALCULATION-PASS-AREA)
 19023*        LENGTH     (CP-COMM-LENGTH)
 19024*    END-EXEC.
 19025     MOVE 'ELRAMT' TO DFHEIV1
 19026*    MOVE '."C                   (   #00018638' TO DFHEIV0
 19027     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19029     MOVE X'2020233030303138363338' TO DFHEIV0(25:11)
 19030     CALL 'kxdfhei1' USING DFHEIV0,
 19031           DFHEIV1,
 19032           CALCULATION-PASS-AREA,
 19033           CP-COMM-LENGTH,
 19034           DFHEIV99,
 19035           DFHEIV99,
 19036           DFHEIV99,
 19037           DFHEIV99
 19038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19039
 19040
 19041 7500-EXIT.
 19042     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 352
* EL050.cbl
 19044
 19045 7600-GET-REFUND.
 19046
 19047* EXEC CICS LINK
 19048*        PROGRAM    ('ELRFND')
 19049*        COMMAREA   (CALCULATION-PASS-AREA)
 19050*        LENGTH     (CP-COMM-LENGTH)
 19051*    END-EXEC.
 19052     MOVE 'ELRFND' TO DFHEIV1
 19053*    MOVE '."C                   (   #00018649' TO DFHEIV0
 19054     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19055     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19056     MOVE X'2020233030303138363439' TO DFHEIV0(25:11)
 19057     CALL 'kxdfhei1' USING DFHEIV0,
 19058           DFHEIV1,
 19059           CALCULATION-PASS-AREA,
 19060           CP-COMM-LENGTH,
 19061           DFHEIV99,
 19062           DFHEIV99,
 19063           DFHEIV99,
 19064           DFHEIV99
 19065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19066
 19067
 19068 7600-EXIT.
 19069     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 353
* EL050.cbl
 19071 7700-CALL-DL1.
 19072
 19073* EXEC CICS LINK
 19074*        PROGRAM    ('DLO001')
 19075*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19076*        LENGTH     (DLO001-COMM-LENGTH)
 19077*    END-EXEC.
 19078     MOVE 'DLO001' TO DFHEIV1
 19079*    MOVE '."C                   (   #00018659' TO DFHEIV0
 19080     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19081     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19082     MOVE X'2020233030303138363539' TO DFHEIV0(25:11)
 19083     CALL 'kxdfhei1' USING DFHEIV0,
 19084           DFHEIV1,
 19085           WS-DLO-MASTER-POLICY-FORM,
 19086           DLO001-COMM-LENGTH,
 19087           DFHEIV99,
 19088           DFHEIV99,
 19089           DFHEIV99,
 19090           DFHEIV99
 19091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19092
 19093
 19094 7700-EXIT.
 19095     EXIT.
 19096
 19097 7710-CALL-DL2.
 19098
 19099* EXEC CICS LINK
 19100*        PROGRAM    ('DLO002')
 19101*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19102*        LENGTH     (DLO002-COMM-LENGTH)
 19103*    END-EXEC.
 19104     MOVE 'DLO002' TO DFHEIV1
 19105*    MOVE '."C                   (   #00018669' TO DFHEIV0
 19106     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19107     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19108     MOVE X'2020233030303138363639' TO DFHEIV0(25:11)
 19109     CALL 'kxdfhei1' USING DFHEIV0,
 19110           DFHEIV1,
 19111           WS-DLO-INTERNAL-POLICY-FORM,
 19112           DLO002-COMM-LENGTH,
 19113           DFHEIV99,
 19114           DFHEIV99,
 19115           DFHEIV99,
 19116           DFHEIV99
 19117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19118
 19119
 19120 7710-EXIT.
 19121     EXIT.
 19122
 19123 7720-CALL-DL3.
 19124
 19125* EXEC CICS LINK
 19126*        PROGRAM    ('DLO003')
 19127*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19128*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 354
* EL050.cbl
 19129*    END-EXEC.
 19130     MOVE 'DLO003' TO DFHEIV1
 19131*    MOVE '."C                   (   #00018679' TO DFHEIV0
 19132     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19133     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19134     MOVE X'2020233030303138363739' TO DFHEIV0(25:11)
 19135     CALL 'kxdfhei1' USING DFHEIV0,
 19136           DFHEIV1,
 19137           WS-DLO-VALID-BANK-ID,
 19138           DLO003-COMM-LENGTH,
 19139           DFHEIV99,
 19140           DFHEIV99,
 19141           DFHEIV99,
 19142           DFHEIV99
 19143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19144
 19145
 19146 7720-EXIT.
 19147     EXIT.
 19148
 19149 7730-CALL-DL7.
 19150
 19151* EXEC CICS LINK
 19152*        PROGRAM    ('DLO007')
 19153*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19154*        LENGTH     (DLO007-COMM-LENGTH)
 19155*    END-EXEC.
 19156     MOVE 'DLO007' TO DFHEIV1
 19157*    MOVE '."C                   (   #00018689' TO DFHEIV0
 19158     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19160     MOVE X'2020233030303138363839' TO DFHEIV0(25:11)
 19161     CALL 'kxdfhei1' USING DFHEIV0,
 19162           DFHEIV1,
 19163           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19164           DLO007-COMM-LENGTH,
 19165           DFHEIV99,
 19166           DFHEIV99,
 19167           DFHEIV99,
 19168           DFHEIV99
 19169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19170
 19171
 19172 7730-EXIT.
 19173     EXIT.
 19174
 19175 7740-CALL-DL11.
 19176
 19177* EXEC CICS LINK
 19178*        PROGRAM    ('DLO011')
 19179*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19180*        LENGTH     (DLO011-COMM-LENGTH)
 19181*    END-EXEC.
 19182     MOVE 'DLO011' TO DFHEIV1
 19183*    MOVE '."C                   (   #00018699' TO DFHEIV0
 19184     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19186     MOVE X'2020233030303138363939' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 355
* EL050.cbl
 19187     CALL 'kxdfhei1' USING DFHEIV0,
 19188           DFHEIV1,
 19189           WS-DLO-PREM-RATES-BEN-TYPE,
 19190           DLO011-COMM-LENGTH,
 19191           DFHEIV99,
 19192           DFHEIV99,
 19193           DFHEIV99,
 19194           DFHEIV99
 19195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19196
 19197
 19198 7740-EXIT.
 19199     EXIT.
 19200
 19201 7750-CALL-DL17.
 19202
 19203* EXEC CICS LINK
 19204*        PROGRAM    ('DLO017')
 19205*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19206*        LENGTH     (DLO017-COMM-LENGTH)
 19207*    END-EXEC.
 19208     MOVE 'DLO017' TO DFHEIV1
 19209*    MOVE '."C                   (   #00018709' TO DFHEIV0
 19210     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19212     MOVE X'2020233030303138373039' TO DFHEIV0(25:11)
 19213     CALL 'kxdfhei1' USING DFHEIV0,
 19214           DFHEIV1,
 19215           WS-DLO-VALID-RATE-CODE,
 19216           DLO017-COMM-LENGTH,
 19217           DFHEIV99,
 19218           DFHEIV99,
 19219           DFHEIV99,
 19220           DFHEIV99
 19221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19222
 19223
 19224 7750-EXIT.
 19225     EXIT.
 19226
 19227 7755-CALL-DL19.
 19228
 19229* EXEC CICS LINK
 19230*        PROGRAM    ('DLO019')
 19231*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19232*        LENGTH     (DLO019-COMM-LENGTH)
 19233*    END-EXEC.
 19234     MOVE 'DLO019' TO DFHEIV1
 19235*    MOVE '."C                   (   #00018719' TO DFHEIV0
 19236     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19237     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19238     MOVE X'2020233030303138373139' TO DFHEIV0(25:11)
 19239     CALL 'kxdfhei1' USING DFHEIV0,
 19240           DFHEIV1,
 19241           WS-DLO-ORIG-COV-CAT,
 19242           DLO019-COMM-LENGTH,
 19243           DFHEIV99,
 19244           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 356
* EL050.cbl
 19245           DFHEIV99,
 19246           DFHEIV99
 19247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19248
 19249
 19250 7755-EXIT.
 19251     EXIT.
 19252
 19253 7760-CALL-DL21.
 19254
 19255* EXEC CICS LINK
 19256*        PROGRAM    ('DLO021')
 19257*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19258*        LENGTH     (DLO021-COMM-LENGTH)
 19259*    END-EXEC.
 19260     MOVE 'DLO021' TO DFHEIV1
 19261*    MOVE '."C                   (   #00018729' TO DFHEIV0
 19262     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19263     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19264     MOVE X'2020233030303138373239' TO DFHEIV0(25:11)
 19265     CALL 'kxdfhei1' USING DFHEIV0,
 19266           DFHEIV1,
 19267           WS-DLO-VALID-LOAN-OFFICER,
 19268           DLO021-COMM-LENGTH,
 19269           DFHEIV99,
 19270           DFHEIV99,
 19271           DFHEIV99,
 19272           DFHEIV99
 19273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19274
 19275
 19276 7760-EXIT.
 19277     EXIT.
 19278
 19279 7770-CALL-DL22.
 19280
 19281* EXEC CICS LINK
 19282*        PROGRAM    ('DLO022')
 19283*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19284*        LENGTH     (DLO022-COMM-LENGTH)
 19285*    END-EXEC.
 19286     MOVE 'DLO022' TO DFHEIV1
 19287*    MOVE '."C                   (   #00018739' TO DFHEIV0
 19288     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19289     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19290     MOVE X'2020233030303138373339' TO DFHEIV0(25:11)
 19291     CALL 'kxdfhei1' USING DFHEIV0,
 19292           DFHEIV1,
 19293           WS-DLO-VALID-STATE-CODE,
 19294           DLO022-COMM-LENGTH,
 19295           DFHEIV99,
 19296           DFHEIV99,
 19297           DFHEIV99,
 19298           DFHEIV99
 19299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19300
 19301
 19302 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 357
* EL050.cbl
 19303     EXIT.
 19304
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 358
* EL050.cbl
 19306
 19307 7800-REWRITE-CERT.
 19308******************************************************************
 19309*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19310*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19311******************************************************************
 19312
 19313     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19314        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19315        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19316        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19317
 19318* EXEC CICS REWRITE
 19319*                  DATASET (CERT-ID)
 19320*                  FROM    (CERTIFICATE-MASTER)
 19321*              END-EXEC
 19322     MOVE LENGTH OF
 19323      CERTIFICATE-MASTER
 19324       TO DFHEIV11
 19325*    MOVE '&& L                  %   #00018760' TO DFHEIV0
 19326     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19327     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19328     MOVE X'2020233030303138373630' TO DFHEIV0(25:11)
 19329     CALL 'kxdfhei1' USING DFHEIV0,
 19330           CERT-ID,
 19331           CERTIFICATE-MASTER,
 19332           DFHEIV11,
 19333           DFHEIV99
 19334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19335        GO TO 7800-EXIT.
 19336
 19337       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19338       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19339
 19340 7800-EXIT.
 19341      EXIT.
 19342
 19343 7900-DELETE-CERT.
 19344
 19345* EXEC CICS DELETE
 19346*        DATASET (CERT-ID)
 19347*    END-EXEC.
 19348*    MOVE '&(                    &   #00018773' TO DFHEIV0
 19349     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19350     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19351     MOVE X'2020233030303138373733' TO DFHEIV0(25:11)
 19352     CALL 'kxdfhei1' USING DFHEIV0,
 19353           CERT-ID,
 19354           DFHEIV99,
 19355           DFHEIV99,
 19356           DFHEIV99,
 19357           DFHEIV99
 19358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19359
 19360
 19361 7900-EXIT.
 19362     EXIT.
 19363
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 359
* EL050.cbl
 19364 8000-WRITE-CERT.
 19365
 19366* EXEC CICS HANDLE CONDITION
 19367*        DUPKEY    (8000-FREE-MAIN)
 19368*    END-EXEC.
 19369*    MOVE '"$$                   ! + #00018781' TO DFHEIV0
 19370     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19371     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19372     MOVE X'2B20233030303138373831' TO DFHEIV0(25:11)
 19373     CALL 'kxdfhei1' USING DFHEIV0
 19374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19375
 19376
 19377
 19378* EXEC CICS WRITE
 19379*        DATASET     (CERT-ID)
 19380*        FROM        (CERTIFICATE-MASTER)
 19381*        RIDFLD      (ELCERT-KEY)
 19382*    END-EXEC.
 19383     MOVE LENGTH OF
 19384      CERTIFICATE-MASTER
 19385       TO DFHEIV11
 19386*    MOVE '&$ L                  ''   #00018785' TO DFHEIV0
 19387     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19388     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19389     MOVE X'2020233030303138373835' TO DFHEIV0(25:11)
 19390     CALL 'kxdfhei1' USING DFHEIV0,
 19391           CERT-ID,
 19392           CERTIFICATE-MASTER,
 19393           DFHEIV11,
 19394           ELCERT-KEY,
 19395           DFHEIV99,
 19396           DFHEIV99
 19397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19398
 19399
 19400 8000-FREE-MAIN.
 19401
 19402 8000-EXIT.
 19403      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 360
* EL050.cbl
 19405
 19406 8100-READ-ERPNDM.
 19407
 19408* EXEC CICS HANDLE CONDITION
 19409*         NOTFND     (8100-NOTFND)
 19410*         ENDFILE    (8100-NOTFND)
 19411*    END-EXEC.
 19412*    MOVE '"$I''                  ! , #00018798' TO DFHEIV0
 19413     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19414     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19415     MOVE X'2C20233030303138373938' TO DFHEIV0(25:11)
 19416     CALL 'kxdfhei1' USING DFHEIV0
 19417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19418
 19419
 19420     MOVE SPACES                 TO ERPNDM-FOUND.
 19421     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19422
 19423
 19424* EXEC CICS READ
 19425*         DATASET   (FILE-ERPNDM)
 19426*         RIDFLD    (PM-CONTROL-PRIMARY)
 19427*         INTO      (PENDING-MAILING-DATA)
 19428*    END-EXEC.
 19429     MOVE LENGTH OF
 19430      PENDING-MAILING-DATA
 19431       TO DFHEIV11
 19432*    MOVE '&"IL       E          (   #00018806' TO DFHEIV0
 19433     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19434     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19435     MOVE X'2020233030303138383036' TO DFHEIV0(25:11)
 19436     CALL 'kxdfhei1' USING DFHEIV0,
 19437           FILE-ERPNDM,
 19438           PENDING-MAILING-DATA,
 19439           DFHEIV11,
 19440           PM-CONTROL-PRIMARY,
 19441           DFHEIV99,
 19442           DFHEIV99,
 19443           DFHEIV99
 19444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19445
 19446
 19447     GO TO 8100-EXIT.
 19448
 19449 8100-NOTFND.
 19450
 19451     MOVE 'X'                    TO ERPNDM-FOUND.
 19452     MOVE ER-2694                TO WS-ERROR.
 19453     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19454     MOVE ER-2883                TO WS-ERROR
 19455     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19456     .
 19457 8100-EXIT.
 19458     EXIT.
 19459
 19460 8110-READ-ERMAIL.
 19461
 19462* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 361
* EL050.cbl
 19463*         NOTFND     (8110-NOTFND)
 19464*         ENDFILE    (8110-NOTFND)
 19465*    END-EXEC.
 19466*    MOVE '"$I''                  ! - #00018826' TO DFHEIV0
 19467     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19468     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19469     MOVE X'2D20233030303138383236' TO DFHEIV0(25:11)
 19470     CALL 'kxdfhei1' USING DFHEIV0
 19471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19472
 19473
 19474     MOVE SPACES                 TO ERMAIL-FOUND.
 19475     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19476     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19477     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19478     MOVE PB-SV-STATE            TO MA-STATE.
 19479
 19480
 19481* EXEC CICS READ
 19482*         UPDATE
 19483*         DATASET   (FILE-ERMAIL)
 19484*         RIDFLD    (MA-CONTROL-PRIMARY)
 19485*         INTO      (MAILING-DATA)
 19486*    END-EXEC.
 19487     MOVE LENGTH OF
 19488      MAILING-DATA
 19489       TO DFHEIV11
 19490*    MOVE '&"IL       EU         (   #00018837' TO DFHEIV0
 19491     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19492     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19493     MOVE X'2020233030303138383337' TO DFHEIV0(25:11)
 19494     CALL 'kxdfhei1' USING DFHEIV0,
 19495           FILE-ERMAIL,
 19496           MAILING-DATA,
 19497           DFHEIV11,
 19498           MA-CONTROL-PRIMARY,
 19499           DFHEIV99,
 19500           DFHEIV99,
 19501           DFHEIV99
 19502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19503
 19504
 19505     GO TO 8110-EXIT.
 19506
 19507 8110-NOTFND.
 19508     MOVE 'X'                    TO ERMAIL-FOUND.
 19509
 19510 8110-EXIT.
 19511     EXIT.
 19512
 19513 8120-REWRITE-ERMAIL.
 19514
 19515* EXEC CICS REWRITE
 19516*         DATASET    (FILE-ERMAIL)
 19517*         FROM       (MAILING-DATA)
 19518*    END-EXEC.
 19519     MOVE LENGTH OF
 19520      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 362
* EL050.cbl
 19521       TO DFHEIV11
 19522*    MOVE '&& L                  %   #00018853' TO DFHEIV0
 19523     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19524     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19525     MOVE X'2020233030303138383533' TO DFHEIV0(25:11)
 19526     CALL 'kxdfhei1' USING DFHEIV0,
 19527           FILE-ERMAIL,
 19528           MAILING-DATA,
 19529           DFHEIV11,
 19530           DFHEIV99
 19531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19532
 19533
 19534 8120-EXIT.
 19535     EXIT.
 19536
 19537 8130-WRITE-ERMAIL.
 19538
 19539* EXEC CICS HANDLE CONDITION
 19540*         DUPKEY   (8130-EXIT)
 19541*    END-EXEC.
 19542*    MOVE '"$$                   ! . #00018862' TO DFHEIV0
 19543     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19544     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19545     MOVE X'2E20233030303138383632' TO DFHEIV0(25:11)
 19546     CALL 'kxdfhei1' USING DFHEIV0
 19547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19548
 19549
 19550
 19551* EXEC CICS WRITE
 19552*         DATASET     (FILE-ERMAIL)
 19553*         RIDFLD      (MA-CONTROL-PRIMARY)
 19554*         FROM        (MAILING-DATA)
 19555*    END-EXEC.
 19556     MOVE LENGTH OF
 19557      MAILING-DATA
 19558       TO DFHEIV11
 19559*    MOVE '&$ L                  ''   #00018866' TO DFHEIV0
 19560     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19561     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19562     MOVE X'2020233030303138383636' TO DFHEIV0(25:11)
 19563     CALL 'kxdfhei1' USING DFHEIV0,
 19564           FILE-ERMAIL,
 19565           MAILING-DATA,
 19566           DFHEIV11,
 19567           MA-CONTROL-PRIMARY,
 19568           DFHEIV99,
 19569           DFHEIV99
 19570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19571
 19572
 19573 8130-EXIT.
 19574     EXIT.
 19575
 19576 8140-UNLOCK-ERMAIL.
 19577
 19578* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 363
* EL050.cbl
 19579*         DATASET   (FILE-ERMAIL)
 19580*    END-EXEC.
 19581*    MOVE '&*                    #   #00018876' TO DFHEIV0
 19582     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19583     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19584     MOVE X'2020233030303138383736' TO DFHEIV0(25:11)
 19585     CALL 'kxdfhei1' USING DFHEIV0,
 19586           FILE-ERMAIL,
 19587           DFHEIV99
 19588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19589
 19590
 19591 8140-EXIT.
 19592     EXIT.
 19593
 19594 8180-UPDATE-VIN-NUMBER.
 19595
 19596* EXEC CICS HANDLE CONDITION
 19597*        NOTFND   (8180-NOTFND)
 19598*    END-EXEC.
 19599*    MOVE '"$I                   ! / #00018884' TO DFHEIV0
 19600     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19602     MOVE X'2F20233030303138383834' TO DFHEIV0(25:11)
 19603     CALL 'kxdfhei1' USING DFHEIV0
 19604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19605
 19606
 19607     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19608     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19609
 19610
 19611* EXEC CICS READ
 19612*        UPDATE
 19613*        DATASET  (CRTT-ID)
 19614*        RIDFLD   (WS-ELCRTT-KEY)
 19615*        INTO     (CERTIFICATE-TRAILERS)
 19616*    END-EXEC.
 19617     MOVE LENGTH OF
 19618      CERTIFICATE-TRAILERS
 19619       TO DFHEIV11
 19620*    MOVE '&"IL       EU         (   #00018891' TO DFHEIV0
 19621     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19622     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19623     MOVE X'2020233030303138383931' TO DFHEIV0(25:11)
 19624     CALL 'kxdfhei1' USING DFHEIV0,
 19625           CRTT-ID,
 19626           CERTIFICATE-TRAILERS,
 19627           DFHEIV11,
 19628           WS-ELCRTT-KEY,
 19629           DFHEIV99,
 19630           DFHEIV99,
 19631           DFHEIV99
 19632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19633
 19634
 19635     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19636         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 364
* EL050.cbl
 19637
 19638* EXEC CICS REWRITE
 19639*           DATASET  (CRTT-ID)
 19640*           FROM     (CERTIFICATE-TRAILERS)
 19641*        END-EXEC
 19642     MOVE LENGTH OF
 19643      CERTIFICATE-TRAILERS
 19644       TO DFHEIV11
 19645*    MOVE '&& L                  %   #00018900' TO DFHEIV0
 19646     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19647     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19648     MOVE X'2020233030303138393030' TO DFHEIV0(25:11)
 19649     CALL 'kxdfhei1' USING DFHEIV0,
 19650           CRTT-ID,
 19651           CERTIFICATE-TRAILERS,
 19652           DFHEIV11,
 19653           DFHEIV99
 19654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19655     ELSE
 19656
 19657* EXEC CICS UNLOCK
 19658*          DATASET  (CRTT-ID)
 19659*       END-EXEC
 19660*    MOVE '&*                    #   #00018905' TO DFHEIV0
 19661     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19662     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19663     MOVE X'2020233030303138393035' TO DFHEIV0(25:11)
 19664     CALL 'kxdfhei1' USING DFHEIV0,
 19665           CRTT-ID,
 19666           DFHEIV99
 19667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19668     END-IF.
 19669
 19670     GO TO 8180-EXIT.
 19671
 19672 8180-NOTFND.
 19673
 19674     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19675     MOVE 'CS'         TO CS-RECORD-ID.
 19676     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19677     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19678     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19679     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19680
 19681* EXEC CICS WRITE
 19682*       DATASET  (CRTT-ID)
 19683*       RIDFLD   (WS-ELCRTT-KEY)
 19684*       FROM     (CERTIFICATE-TRAILERS)
 19685*    END-EXEC.
 19686     MOVE LENGTH OF
 19687      CERTIFICATE-TRAILERS
 19688       TO DFHEIV11
 19689*    MOVE '&$ L                  ''   #00018920' TO DFHEIV0
 19690     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19691     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19692     MOVE X'2020233030303138393230' TO DFHEIV0(25:11)
 19693     CALL 'kxdfhei1' USING DFHEIV0,
 19694           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 365
* EL050.cbl
 19695           CERTIFICATE-TRAILERS,
 19696           DFHEIV11,
 19697           WS-ELCRTT-KEY,
 19698           DFHEIV99,
 19699           DFHEIV99
 19700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19701
 19702
 19703 8180-EXIT.
 19704     EXIT.
 19705
 19706 8190-UPDATE-REFUND-CLAIM-FLAG.
 19707
 19708* EXEC CICS HANDLE CONDITION
 19709*        NOTFND   (8190-NOTFND)
 19710*    END-EXEC.
 19711*    MOVE '"$I                   ! 0 #00018930' TO DFHEIV0
 19712     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19714     MOVE X'3020233030303138393330' TO DFHEIV0(25:11)
 19715     CALL 'kxdfhei1' USING DFHEIV0
 19716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19717
 19718
 19719     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19720     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19721
 19722
 19723* EXEC CICS READ
 19724*        UPDATE
 19725*        DATASET  (CRTT-ID)
 19726*        RIDFLD   (WS-ELCRTT-KEY)
 19727*        INTO     (CERTIFICATE-TRAILERS)
 19728*    END-EXEC.
 19729     MOVE LENGTH OF
 19730      CERTIFICATE-TRAILERS
 19731       TO DFHEIV11
 19732*    MOVE '&"IL       EU         (   #00018937' TO DFHEIV0
 19733     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19734     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19735     MOVE X'2020233030303138393337' TO DFHEIV0(25:11)
 19736     CALL 'kxdfhei1' USING DFHEIV0,
 19737           CRTT-ID,
 19738           CERTIFICATE-TRAILERS,
 19739           DFHEIV11,
 19740           WS-ELCRTT-KEY,
 19741           DFHEIV99,
 19742           DFHEIV99,
 19743           DFHEIV99
 19744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19745
 19746
 19747     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19748
 19749* EXEC CICS REWRITE
 19750*       DATASET  (CRTT-ID)
 19751*       FROM     (CERTIFICATE-TRAILERS)
 19752*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 366
* EL050.cbl
 19753     MOVE LENGTH OF
 19754      CERTIFICATE-TRAILERS
 19755       TO DFHEIV11
 19756*    MOVE '&& L                  %   #00018945' TO DFHEIV0
 19757     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19758     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19759     MOVE X'2020233030303138393435' TO DFHEIV0(25:11)
 19760     CALL 'kxdfhei1' USING DFHEIV0,
 19761           CRTT-ID,
 19762           CERTIFICATE-TRAILERS,
 19763           DFHEIV11,
 19764           DFHEIV99
 19765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19766
 19767
 19768     GO TO 8190-EXIT.
 19769
 19770 8190-NOTFND.
 19771
 19772     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19773     MOVE 'CS'         TO CS-RECORD-ID.
 19774     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19775     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19776     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19777     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19778
 19779* EXEC CICS WRITE
 19780*       DATASET  (CRTT-ID)
 19781*       RIDFLD   (WS-ELCRTT-KEY)
 19782*       FROM     (CERTIFICATE-TRAILERS)
 19783*    END-EXEC.
 19784     MOVE LENGTH OF
 19785      CERTIFICATE-TRAILERS
 19786       TO DFHEIV11
 19787*    MOVE '&$ L                  ''   #00018960' TO DFHEIV0
 19788     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19789     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19790     MOVE X'2020233030303138393630' TO DFHEIV0(25:11)
 19791     CALL 'kxdfhei1' USING DFHEIV0,
 19792           CRTT-ID,
 19793           CERTIFICATE-TRAILERS,
 19794           DFHEIV11,
 19795           WS-ELCRTT-KEY,
 19796           DFHEIV99,
 19797           DFHEIV99
 19798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19799
 19800
 19801 8190-EXIT.
 19802     EXIT.
 19803
 19804 8195-UPDATE-AGE-FLAGS.
 19805
 19806* EXEC CICS HANDLE CONDITION
 19807*        NOTFND   (8195-NOTFND)
 19808*    END-EXEC.
 19809*    MOVE '"$I                   ! 1 #00018970' TO DFHEIV0
 19810     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 367
* EL050.cbl
 19811     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19812     MOVE X'3120233030303138393730' TO DFHEIV0(25:11)
 19813     CALL 'kxdfhei1' USING DFHEIV0
 19814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19815
 19816
 19817     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19818     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19819
 19820
 19821* EXEC CICS READ
 19822*        UPDATE
 19823*        DATASET  (CRTT-ID)
 19824*        RIDFLD   (WS-ELCRTT-KEY)
 19825*        INTO     (CERTIFICATE-TRAILERS)
 19826*    END-EXEC.
 19827     MOVE LENGTH OF
 19828      CERTIFICATE-TRAILERS
 19829       TO DFHEIV11
 19830*    MOVE '&"IL       EU         (   #00018977' TO DFHEIV0
 19831     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19832     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19833     MOVE X'2020233030303138393737' TO DFHEIV0(25:11)
 19834     CALL 'kxdfhei1' USING DFHEIV0,
 19835           CRTT-ID,
 19836           CERTIFICATE-TRAILERS,
 19837           DFHEIV11,
 19838           WS-ELCRTT-KEY,
 19839           DFHEIV99,
 19840           DFHEIV99,
 19841           DFHEIV99
 19842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19843
 19844
 19845     IF WS-INS-AGE-SET = 'Y'
 19846        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19847     END-IF
 19848     IF WS-JNT-AGE-SET = 'Y'
 19849        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19850     END-IF
 19851
 19852
 19853* EXEC CICS REWRITE
 19854*       DATASET  (CRTT-ID)
 19855*       FROM     (CERTIFICATE-TRAILERS)
 19856*    END-EXEC.
 19857     MOVE LENGTH OF
 19858      CERTIFICATE-TRAILERS
 19859       TO DFHEIV11
 19860*    MOVE '&& L                  %   #00018991' TO DFHEIV0
 19861     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19862     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19863     MOVE X'2020233030303138393931' TO DFHEIV0(25:11)
 19864     CALL 'kxdfhei1' USING DFHEIV0,
 19865           CRTT-ID,
 19866           CERTIFICATE-TRAILERS,
 19867           DFHEIV11,
 19868           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 368
* EL050.cbl
 19869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19870
 19871
 19872     GO TO 8195-EXIT.
 19873
 19874 8195-NOTFND.
 19875
 19876     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19877     MOVE 'CS'         TO CS-RECORD-ID.
 19878     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19879     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19880     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19881     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 19882     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19883
 19884* EXEC CICS WRITE
 19885*       DATASET  (CRTT-ID)
 19886*       RIDFLD   (WS-ELCRTT-KEY)
 19887*       FROM     (CERTIFICATE-TRAILERS)
 19888*    END-EXEC.
 19889     MOVE LENGTH OF
 19890      CERTIFICATE-TRAILERS
 19891       TO DFHEIV11
 19892*    MOVE '&$ L                  ''   #00019007' TO DFHEIV0
 19893     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19894     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19895     MOVE X'2020233030303139303037' TO DFHEIV0(25:11)
 19896     CALL 'kxdfhei1' USING DFHEIV0,
 19897           CRTT-ID,
 19898           CERTIFICATE-TRAILERS,
 19899           DFHEIV11,
 19900           WS-ELCRTT-KEY,
 19901           DFHEIV99,
 19902           DFHEIV99
 19903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19904
 19905
 19906 8195-EXIT.
 19907     EXIT.
 19908
 19909 8200-READ-REIN-TABLE.
 19910
 19911* EXEC CICS HANDLE CONDITION
 19912*         NOTFND   (8200-NOTFND)
 19913*    END-EXEC.
 19914*    MOVE '"$I                   ! 2 #00019017' TO DFHEIV0
 19915     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19916     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19917     MOVE X'3220233030303139303137' TO DFHEIV0(25:11)
 19918     CALL 'kxdfhei1' USING DFHEIV0
 19919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19920
 19921
 19922
 19923* EXEC CICS READ
 19924*        DATASET     (REIN-ID)
 19925*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19926*        RIDFLD      (ERREIN-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 369
* EL050.cbl
 19927*    END-EXEC.
 19928*    MOVE '&"S        E          (   #00019021' TO DFHEIV0
 19929     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19930     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19931     MOVE X'2020233030303139303231' TO DFHEIV0(25:11)
 19932     CALL 'kxdfhei1' USING DFHEIV0,
 19933           REIN-ID,
 19934           DFHEIV20,
 19935           DFHEIV99,
 19936           ERREIN-KEY,
 19937           DFHEIV99,
 19938           DFHEIV99,
 19939           DFHEIV99
 19940     SET ADDRESS OF REINSURANCE-RECORD TO
 19941         DFHEIV20
 19942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19943
 19944
 19945     GO TO 8200-EXIT.
 19946
 19947 8200-NOTFND.
 19948     MOVE 'N'             TO WS-REIN-READ-SW.
 19949
 19950 8200-EXIT.
 19951      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 370
* EL050.cbl
 19953
 19954 8300-READ-CTBL-TABLE.
 19955
 19956* EXEC CICS HANDLE CONDITION
 19957*        NOTFND    (8300-NOTFND)
 19958*        DISABLED  (8300-ERRESS-PROBLEM)
 19959*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19960*        ENDFILE   (8300-NOTFND)
 19961*    END-EXEC.
 19962*    MOVE '"$IcJ''                ! 3 #00019037' TO DFHEIV0
 19963     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19964     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19965     MOVE X'3320233030303139303337' TO DFHEIV0(25:11)
 19966     CALL 'kxdfhei1' USING DFHEIV0
 19967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19968
 19969
 19970
 19971* EXEC CICS READ
 19972*        DATASET     (CTBL-ID)
 19973*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19974*        RIDFLD      (ERCTBL-KEY)
 19975*    END-EXEC.
 19976*    MOVE '&"S        E          (   #00019044' TO DFHEIV0
 19977     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19978     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19979     MOVE X'2020233030303139303434' TO DFHEIV0(25:11)
 19980     CALL 'kxdfhei1' USING DFHEIV0,
 19981           CTBL-ID,
 19982           DFHEIV20,
 19983           DFHEIV99,
 19984           ERCTBL-KEY,
 19985           DFHEIV99,
 19986           DFHEIV99,
 19987           DFHEIV99
 19988     SET ADDRESS OF COMM-TABLE-RECORD TO
 19989         DFHEIV20
 19990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19991
 19992
 19993     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19994
 19995     GO TO 8300-EXIT.
 19996
 19997 8300-NOTFND.
 19998
 19999     IF CTBL-SW = '0530'
 20000         MOVE 'AA'                     TO WS-AH-COMP-CD
 20001         MOVE '0550'                   TO CTBL-SW
 20002         MOVE '1'                      TO WS-CTBL-READ-SW
 20003         GO TO 8300-EXIT.
 20004
 20005     IF CTBL-SW = '0540'
 20006         MOVE 'AA'                     TO WS-LF-COMP-CD
 20007         MOVE '0550'                   TO CTBL-SW
 20008         MOVE '1'                      TO WS-CTBL-READ-SW
 20009         GO TO 8300-EXIT.
 20010
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 371
* EL050.cbl
 20011     IF CTBL-SW = '0550'
 20012         MOVE '2'                      TO WS-CTBL-READ-SW
 20013         GO TO 8300-EXIT.
 20014
 20015     GO TO 8300-EXIT.
 20016
 20017 8300-ERRESS-PROBLEM.
 20018
 20019      MOVE ER-8050              TO WS-ERROR.
 20020      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20021
 20022     GO TO 8300-EXIT.
 20023
 20024 8300-EXIT.
 20025      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 372
* EL050.cbl
 20027
 20028
 20029 8400-GETMAIN-ERFORM.
 20030
 20031
 20032* EXEC CICS   GETMAIN
 20033*        LENGTH  (500)
 20034*        SET     (ADDRESS OF FORM-MASTER)
 20035*    END-EXEC.
 20036     MOVE 500
 20037       TO DFHEIV11
 20038*    MOVE '," L                  $   #00019088' TO DFHEIV0
 20039     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20040     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20041     MOVE X'2020233030303139303838' TO DFHEIV0(25:11)
 20042     CALL 'kxdfhei1' USING DFHEIV0,
 20043           DFHEIV20,
 20044           DFHEIV11,
 20045           DFHEIV99
 20046     SET ADDRESS OF FORM-MASTER TO
 20047         DFHEIV20
 20048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20049
 20050
 20051     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20052
 20053 8400-EXIT.
 20054      EXIT.
 20055
 20056 8450-READ-FORM-MASTER.
 20057
 20058
 20059* EXEC CICS  HANDLE CONDITION
 20060*        NOTFND   (8450-FORM-NOT-FOUND)
 20061*        ENDFILE  (8450-FORM-NOT-FOUND)
 20062*    END-EXEC.
 20063*    MOVE '"$I''                  ! 4 #00019100' TO DFHEIV0
 20064     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20065     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20066     MOVE X'3420233030303139313030' TO DFHEIV0(25:11)
 20067     CALL 'kxdfhei1' USING DFHEIV0
 20068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20069
 20070
 20071
 20072* EXEC CICS   READ
 20073*        DATASET   (FORM-ID)
 20074*        RIDFLD    (ERFORM-KEY)
 20075*        INTO      (FORM-MASTER)
 20076*        GTEQ
 20077*    END-EXEC.
 20078     MOVE LENGTH OF
 20079      FORM-MASTER
 20080       TO DFHEIV11
 20081*    MOVE '&"IL       G          (   #00019105' TO DFHEIV0
 20082     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20083     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20084     MOVE X'2020233030303139313035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 373
* EL050.cbl
 20085     CALL 'kxdfhei1' USING DFHEIV0,
 20086           FORM-ID,
 20087           FORM-MASTER,
 20088           DFHEIV11,
 20089           ERFORM-KEY,
 20090           DFHEIV99,
 20091           DFHEIV99,
 20092           DFHEIV99
 20093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20094
 20095
 20096     MOVE  'Y'           TO  FORM-MASTER-SW.
 20097
 20098     GO TO  8450-EXIT.
 20099
 20100 8450-FORM-NOT-FOUND.
 20101
 20102     MOVE  'N'           TO  FORM-MASTER-SW.
 20103
 20104 8450-EXIT.
 20105      EXIT.
 20106
 20107 8500-DATE-CONVERT.
 20108
 20109* EXEC CICS LINK
 20110*        PROGRAM    ('ELDATCV')
 20111*        COMMAREA   (DATE-CONVERSION-DATA)
 20112*        LENGTH     (DC-COMM-LENGTH)
 20113*    END-EXEC.
 20114     MOVE 'ELDATCV' TO DFHEIV1
 20115*    MOVE '."C                   (   #00019124' TO DFHEIV0
 20116     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20117     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20118     MOVE X'2020233030303139313234' TO DFHEIV0(25:11)
 20119     CALL 'kxdfhei1' USING DFHEIV0,
 20120           DFHEIV1,
 20121           DATE-CONVERSION-DATA,
 20122           DC-COMM-LENGTH,
 20123           DFHEIV99,
 20124           DFHEIV99,
 20125           DFHEIV99,
 20126           DFHEIV99
 20127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20128
 20129
 20130 8500-EXIT.
 20131     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 374
* EL050.cbl
 20133
 20134 8555-RELOAD-CONTROL-FILE.
 20135     CONTINUE.
 20136
 20137 8555-EXIT.
 20138     EXIT.
 20139
 20140 8557-GETMAIN-ERPLAN.
 20141
 20142
 20143* EXEC CICS GETMAIN
 20144*        LENGTH    (840)
 20145*        SET       (ADDRESS OF PLAN-RECORDS)
 20146*    END-EXEC.
 20147     MOVE 840
 20148       TO DFHEIV11
 20149*    MOVE '," L                  $   #00019142' TO DFHEIV0
 20150     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20151     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20152     MOVE X'2020233030303139313432' TO DFHEIV0(25:11)
 20153     CALL 'kxdfhei1' USING DFHEIV0,
 20154           DFHEIV20,
 20155           DFHEIV11,
 20156           DFHEIV99
 20157     SET ADDRESS OF PLAN-RECORDS TO
 20158         DFHEIV20
 20159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20160
 20161
 20162     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20163
 20164 8557-EXIT.
 20165     EXIT.
 20166
 20167 8560-GETMAIN.
 20168
 20169* EXEC CICS GETMAIN
 20170*        LENGTH    (2000)
 20171*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20172*    END-EXEC.
 20173     MOVE 2000
 20174       TO DFHEIV11
 20175*    MOVE '," L                  $   #00019153' TO DFHEIV0
 20176     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20177     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20178     MOVE X'2020233030303139313533' TO DFHEIV0(25:11)
 20179     CALL 'kxdfhei1' USING DFHEIV0,
 20180           DFHEIV20,
 20181           DFHEIV11,
 20182           DFHEIV99
 20183     SET ADDRESS OF ACCOUNT-MASTER TO
 20184         DFHEIV20
 20185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20186
 20187
 20188     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20189
 20190 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 375
* EL050.cbl
 20191     EXIT.
 20192
 20193 8570-START-ACCOUNT-MASTER.
 20194
 20195* EXEC CICS HANDLE CONDITION
 20196*        NOTFND    (0199-ACCT-NOT-FOUND)
 20197*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20198*    END-EXEC.
 20199*    MOVE '"$I''                  ! 5 #00019164' TO DFHEIV0
 20200     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20201     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20202     MOVE X'3520233030303139313634' TO DFHEIV0(25:11)
 20203     CALL 'kxdfhei1' USING DFHEIV0
 20204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20205
 20206
 20207
 20208* EXEC CICS STARTBR
 20209*        DATASET    (ACCT-ID)
 20210*        RIDFLD     (ERACCT-KEY)
 20211*        GTEQ
 20212*    END-EXEC.
 20213     MOVE 0
 20214       TO DFHEIV11
 20215*    MOVE '&,         G          &   #00019169' TO DFHEIV0
 20216     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20217     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20218     MOVE X'2020233030303139313639' TO DFHEIV0(25:11)
 20219     CALL 'kxdfhei1' USING DFHEIV0,
 20220           ACCT-ID,
 20221           ERACCT-KEY,
 20222           DFHEIV99,
 20223           DFHEIV11,
 20224           DFHEIV99
 20225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20226
 20227
 20228 8570-EXIT.
 20229     EXIT.
 20230
 20231 8580-READ-ACCOUNT-MASTER.
 20232
 20233* EXEC CICS HANDLE CONDITION
 20234*        NOTFND    (0199-ACCT-NOT-FOUND)
 20235*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20236*    END-EXEC.
 20237*    MOVE '"$I''                  ! 6 #00019179' TO DFHEIV0
 20238     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20239     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20240     MOVE X'3620233030303139313739' TO DFHEIV0(25:11)
 20241     CALL 'kxdfhei1' USING DFHEIV0
 20242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20243
 20244
 20245
 20246* EXEC CICS READNEXT
 20247*        DATASET     (ACCT-ID)
 20248*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 376
* EL050.cbl
 20249*        RIDFLD      (ERACCT-KEY)
 20250*    END-EXEC.
 20251     MOVE LENGTH OF
 20252      ACCOUNT-MASTER
 20253       TO DFHEIV12
 20254     MOVE 0
 20255       TO DFHEIV11
 20256*    MOVE '&.IL                  )   #00019184' TO DFHEIV0
 20257     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20258     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20259     MOVE X'2020233030303139313834' TO DFHEIV0(25:11)
 20260     CALL 'kxdfhei1' USING DFHEIV0,
 20261           ACCT-ID,
 20262           ACCOUNT-MASTER,
 20263           DFHEIV12,
 20264           ERACCT-KEY,
 20265           DFHEIV99,
 20266           DFHEIV11,
 20267           DFHEIV99,
 20268           DFHEIV99
 20269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20270
 20271
 20272 8580-EXIT.
 20273     EXIT.
 20274
 20275 8582-READ-COMPENSATION-MASTER.
 20276
 20277* EXEC CICS HANDLE CONDITION
 20278*        NOTFND    (8582-COMP-NOT-FOUND)
 20279*        ENDFILE   (8582-COMP-NOT-FOUND)
 20280*    END-EXEC.
 20281*    MOVE '"$I''                  ! 7 #00019194' TO DFHEIV0
 20282     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20283     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20284     MOVE X'3720233030303139313934' TO DFHEIV0(25:11)
 20285     CALL 'kxdfhei1' USING DFHEIV0
 20286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20287
 20288
 20289
 20290* EXEC CICS READ
 20291*        DATASET     (COMP-ID)
 20292*        INTO        (COMPENSATION-MASTER)
 20293*        RIDFLD      (ERCOMP-KEY)
 20294*    END-EXEC.
 20295     MOVE LENGTH OF
 20296      COMPENSATION-MASTER
 20297       TO DFHEIV11
 20298*    MOVE '&"IL       E          (   #00019199' TO DFHEIV0
 20299     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20300     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20301     MOVE X'2020233030303139313939' TO DFHEIV0(25:11)
 20302     CALL 'kxdfhei1' USING DFHEIV0,
 20303           COMP-ID,
 20304           COMPENSATION-MASTER,
 20305           DFHEIV11,
 20306           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 377
* EL050.cbl
 20307           DFHEIV99,
 20308           DFHEIV99,
 20309           DFHEIV99
 20310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20311
 20312
 20313     MOVE 'Y'                    TO COMP-MASTER-SW
 20314
 20315     GO TO 8582-EXIT
 20316     .
 20317 8582-COMP-NOT-FOUND.
 20318
 20319     MOVE 'N'                    TO COMP-MASTER-SW.
 20320
 20321 8582-EXIT.
 20322     EXIT.
 20323
 20324 8583-READ-ERAGTC.
 20325
 20326* EXEC CICS HANDLE CONDITION
 20327*        NOTFND    (8583-AGTC-NOT-FOUND)
 20328*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20329*    END-EXEC.
 20330*    MOVE '"$I''                  ! 8 #00019217' TO DFHEIV0
 20331     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20332     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20333     MOVE X'3820233030303139323137' TO DFHEIV0(25:11)
 20334     CALL 'kxdfhei1' USING DFHEIV0
 20335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20336
 20337
 20338
 20339* EXEC CICS STARTBR
 20340*        DATASET    (AGTC-ID)
 20341*        RIDFLD     (ERAGTC-KEY)
 20342*        GTEQ
 20343*    END-EXEC.
 20344     MOVE 0
 20345       TO DFHEIV11
 20346*    MOVE '&,         G          &   #00019222' TO DFHEIV0
 20347     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20348     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20349     MOVE X'2020233030303139323232' TO DFHEIV0(25:11)
 20350     CALL 'kxdfhei1' USING DFHEIV0,
 20351           AGTC-ID,
 20352           ERAGTC-KEY,
 20353           DFHEIV99,
 20354           DFHEIV11,
 20355           DFHEIV99
 20356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20357
 20358
 20359 8583-READ-ERAGTC-NEXT.
 20360
 20361* EXEC CICS READNEXT
 20362*        DATASET     (AGTC-ID)
 20363*        INTO        (AGENT-COMMISSIONS)
 20364*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 378
* EL050.cbl
 20365*    END-EXEC.
 20366     MOVE LENGTH OF
 20367      AGENT-COMMISSIONS
 20368       TO DFHEIV12
 20369     MOVE 0
 20370       TO DFHEIV11
 20371*    MOVE '&.IL                  )   #00019229' TO DFHEIV0
 20372     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20373     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20374     MOVE X'2020233030303139323239' TO DFHEIV0(25:11)
 20375     CALL 'kxdfhei1' USING DFHEIV0,
 20376           AGTC-ID,
 20377           AGENT-COMMISSIONS,
 20378           DFHEIV12,
 20379           ERAGTC-KEY,
 20380           DFHEIV99,
 20381           DFHEIV11,
 20382           DFHEIV99,
 20383           DFHEIV99
 20384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20385
 20386
 20387*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20388
 20389     GO TO 8583-EXIT
 20390     .
 20391 8583-AGTC-NOT-FOUND.
 20392
 20393     MOVE 'N'                    TO AGTC-MASTER-SW.
 20394
 20395 8583-EXIT.
 20396     EXIT.
 20397
 20398 8584-READ-BANK-CROSS-REF.
 20399
 20400* EXEC CICS HANDLE CONDITION
 20401*        NOTFND    (8584-BXRF-NOT-FOUND)
 20402*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20403*    END-EXEC.
 20404*    MOVE '"$I''                  ! 9 #00019247' TO DFHEIV0
 20405     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20407     MOVE X'3920233030303139323437' TO DFHEIV0(25:11)
 20408     CALL 'kxdfhei1' USING DFHEIV0
 20409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20410
 20411
 20412
 20413* EXEC CICS READ
 20414*        DATASET     (BXRF-ID)
 20415*        INTO        (BANK-CROSS-REFERENCE)
 20416*        RIDFLD      (ERBXRF-KEY)
 20417*        LENGTH      (BXRF-REC-LENGTH)
 20418*    END-EXEC.
 20419*    MOVE '&"IL       E          (   #00019252' TO DFHEIV0
 20420     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20421     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20422     MOVE X'2020233030303139323532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 379
* EL050.cbl
 20423     CALL 'kxdfhei1' USING DFHEIV0,
 20424           BXRF-ID,
 20425           BANK-CROSS-REFERENCE,
 20426           BXRF-REC-LENGTH,
 20427           ERBXRF-KEY,
 20428           DFHEIV99,
 20429           DFHEIV99,
 20430           DFHEIV99
 20431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20432
 20433
 20434     MOVE 'Y'                    TO BXRF-MASTER-SW
 20435
 20436     GO TO 8584-EXIT
 20437     .
 20438 8584-BXRF-NOT-FOUND.
 20439
 20440     MOVE 'N'                    TO BXRF-MASTER-SW.
 20441
 20442 8584-EXIT.
 20443     EXIT.
 20444
 20445 8585-READ-PLAN-MASTER.
 20446
 20447
 20448* EXEC CICS HANDLE CONDITION
 20449*        NOTFND    (8585-PLAN-NOT-FOUND)
 20450*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20451*    END-EXEC.
 20452*    MOVE '"$I''                  ! : #00019272' TO DFHEIV0
 20453     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20455     MOVE X'3A20233030303139323732' TO DFHEIV0(25:11)
 20456     CALL 'kxdfhei1' USING DFHEIV0
 20457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20458
 20459
 20460
 20461* EXEC CICS READ
 20462*        DATASET     (PLAN-ID)
 20463*        INTO        (PLAN-MASTER)
 20464*        RIDFLD      (ERPLAN-KEY)
 20465*    END-EXEC.
 20466     MOVE LENGTH OF
 20467      PLAN-MASTER
 20468       TO DFHEIV11
 20469*    MOVE '&"IL       E          (   #00019277' TO DFHEIV0
 20470     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20472     MOVE X'2020233030303139323737' TO DFHEIV0(25:11)
 20473     CALL 'kxdfhei1' USING DFHEIV0,
 20474           PLAN-ID,
 20475           PLAN-MASTER,
 20476           DFHEIV11,
 20477           ERPLAN-KEY,
 20478           DFHEIV99,
 20479           DFHEIV99,
 20480           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 380
* EL050.cbl
 20481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20482
 20483
 20484     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20485
 20486     GO TO 8585-EXIT.
 20487
 20488 8585-PLAN-NOT-FOUND.
 20489
 20490     MOVE 'N'                    TO PLAN-MASTER-SW.
 20491
 20492 8585-EXIT.
 20493     EXIT.
 20494
 20495 8586-READ-LOAN-OFFICER.
 20496
 20497* EXEC CICS READ
 20498*        DATASET     (LOFC-ID)
 20499*        INTO        (LOAN-OFFICER-MASTER)
 20500*        RIDFLD      (ERLOFC-KEY)
 20501*        RESP        (WS-RESPONSE)
 20502*    END-EXEC
 20503     MOVE LENGTH OF
 20504      LOAN-OFFICER-MASTER
 20505       TO DFHEIV11
 20506*    MOVE '&"IL       E          (  N#00019295' TO DFHEIV0
 20507     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20508     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20509     MOVE X'204E233030303139323935' TO DFHEIV0(25:11)
 20510     CALL 'kxdfhei1' USING DFHEIV0,
 20511           LOFC-ID,
 20512           LOAN-OFFICER-MASTER,
 20513           DFHEIV11,
 20514           ERLOFC-KEY,
 20515           DFHEIV99,
 20516           DFHEIV99,
 20517           DFHEIV99
 20518     MOVE EIBRESP  TO WS-RESPONSE
 20519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20520
 20521     IF WS-RESP-NORMAL
 20522        MOVE 'Y'                 TO LOFC-MASTER-SW
 20523     ELSE
 20524        MOVE 'N'                 TO LOFC-MASTER-SW
 20525     END-IF
 20526     .
 20527 8586-EXIT.
 20528     EXIT.
 20529 8587-START-ERPDEF.
 20530
 20531* EXEC CICS STARTBR
 20532*       DATASET   (PDEF-ID)
 20533*       RIDFLD    (ERPDEF-KEY)
 20534*       GTEQ
 20535*       RESP      (WS-RESPONSE)
 20536*    END-EXEC
 20537     MOVE 0
 20538       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 381
* EL050.cbl
 20539*    MOVE '&,         G          &  N#00019311' TO DFHEIV0
 20540     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20541     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20542     MOVE X'204E233030303139333131' TO DFHEIV0(25:11)
 20543     CALL 'kxdfhei1' USING DFHEIV0,
 20544           PDEF-ID,
 20545           ERPDEF-KEY,
 20546           DFHEIV99,
 20547           DFHEIV11,
 20548           DFHEIV99
 20549     MOVE EIBRESP  TO WS-RESPONSE
 20550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20551     IF WS-RESP-NORMAL
 20552        MOVE 'Y'                 TO PDEF-MASTER-SW
 20553     ELSE
 20554        MOVE 'N'                 TO PDEF-MASTER-SW
 20555     END-IF
 20556     .
 20557 8587-EXIT.
 20558     EXIT.
 20559 8588-READ-ERPDEF.
 20560
 20561* EXEC CICS READNEXT
 20562*       DATASET   (PDEF-ID)
 20563*       RIDFLD    (ERPDEF-KEY)
 20564*       INTO      (PRODUCT-MASTER)
 20565*       RESP      (WS-RESPONSE)
 20566*    END-EXEC
 20567     MOVE LENGTH OF
 20568      PRODUCT-MASTER
 20569       TO DFHEIV12
 20570     MOVE 0
 20571       TO DFHEIV11
 20572*    MOVE '&.IL                  )  N#00019326' TO DFHEIV0
 20573     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20574     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20575     MOVE X'204E233030303139333236' TO DFHEIV0(25:11)
 20576     CALL 'kxdfhei1' USING DFHEIV0,
 20577           PDEF-ID,
 20578           PRODUCT-MASTER,
 20579           DFHEIV12,
 20580           ERPDEF-KEY,
 20581           DFHEIV99,
 20582           DFHEIV11,
 20583           DFHEIV99,
 20584           DFHEIV99
 20585     MOVE EIBRESP  TO WS-RESPONSE
 20586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20587     IF WS-RESP-NORMAL
 20588        MOVE 'Y'                 TO PDEF-MASTER-SW
 20589     ELSE
 20590        MOVE 'N'                 TO PDEF-MASTER-SW
 20591     END-IF
 20592     .
 20593 8588-EXIT.
 20594     EXIT.
 20595 8589-ENDBR-ERPDEF.
 20596
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 382
* EL050.cbl
 20597* EXEC CICS ENDBR
 20598*       DATASET   (PDEF-ID)
 20599*    END-EXEC
 20600     MOVE 0
 20601       TO DFHEIV11
 20602*    MOVE '&2                    $   #00019341' TO DFHEIV0
 20603     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20604     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20605     MOVE X'2020233030303139333431' TO DFHEIV0(25:11)
 20606     CALL 'kxdfhei1' USING DFHEIV0,
 20607           PDEF-ID,
 20608           DFHEIV11,
 20609           DFHEIV99
 20610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20611     .
 20612 8589-EXIT.
 20613     EXIT.
 20614 8590-READ-CERT-MASTER.
 20615     IF PB-COMPANY-ID = 'UCL'
 20616         GO TO 8690-READ-CERT-MASTER-UCL.
 20617
 20618
 20619* EXEC CICS HANDLE CONDITION
 20620*         NOTFND    (0299-CERT-NOT-FOUND)
 20621*    END-EXEC.
 20622*    MOVE '"$I                   ! ; #00019351' TO DFHEIV0
 20623     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20624     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20625     MOVE X'3B20233030303139333531' TO DFHEIV0(25:11)
 20626     CALL 'kxdfhei1' USING DFHEIV0
 20627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20628
 20629
 20630
 20631* EXEC CICS READ
 20632*        DATASET     (CERT-ID)
 20633*        INTO        (CERTIFICATE-MASTER)
 20634*        RIDFLD      (ELCERT-KEY)
 20635*        UPDATE
 20636*    END-EXEC.
 20637     MOVE LENGTH OF
 20638      CERTIFICATE-MASTER
 20639       TO DFHEIV11
 20640*    MOVE '&"IL       EU         (   #00019355' TO DFHEIV0
 20641     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20642     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20643     MOVE X'2020233030303139333535' TO DFHEIV0(25:11)
 20644     CALL 'kxdfhei1' USING DFHEIV0,
 20645           CERT-ID,
 20646           CERTIFICATE-MASTER,
 20647           DFHEIV11,
 20648           ELCERT-KEY,
 20649           DFHEIV99,
 20650           DFHEIV99,
 20651           DFHEIV99
 20652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20653
 20654
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 383
* EL050.cbl
 20655 8590-EXIT.
 20656     EXIT.
 20657
 20658 8690-READ-CERT-MASTER-UCL.
 20659
 20660* EXEC CICS HANDLE CONDITION
 20661*         NOTFND    (8700-READ-CERT-MASTER)
 20662*    END-EXEC.
 20663*    MOVE '"$I                   ! < #00019366' TO DFHEIV0
 20664     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20666     MOVE X'3C20233030303139333636' TO DFHEIV0(25:11)
 20667     CALL 'kxdfhei1' USING DFHEIV0
 20668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20669
 20670
 20671 8690-READ-CERT-CONT.
 20672
 20673* EXEC CICS READ
 20674*        DATASET     (CERT-ID)
 20675*        INTO        (CERTIFICATE-MASTER)
 20676*        RIDFLD      (ELCERT-KEY)
 20677*        UPDATE
 20678*    END-EXEC.
 20679     MOVE LENGTH OF
 20680      CERTIFICATE-MASTER
 20681       TO DFHEIV11
 20682*    MOVE '&"IL       EU         (   #00019371' TO DFHEIV0
 20683     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20684     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20685     MOVE X'2020233030303139333731' TO DFHEIV0(25:11)
 20686     CALL 'kxdfhei1' USING DFHEIV0,
 20687           CERT-ID,
 20688           CERTIFICATE-MASTER,
 20689           DFHEIV11,
 20690           ELCERT-KEY,
 20691           DFHEIV99,
 20692           DFHEIV99,
 20693           DFHEIV99
 20694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20695
 20696
 20697     GO TO 8590-EXIT.
 20698
 20699 8700-READ-CERT-MASTER.
 20700     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20701     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20702
 20703* EXEC CICS HANDLE CONDITION
 20704*         DUPKEY    (8720-COMP-ACCOUNTS)
 20705*         ENDFILE   (8730-END-BROWSE)
 20706*         NOTFND    (8740-NOT-FOUND)
 20707*    END-EXEC.
 20708*    MOVE '"$$''I                 ! = #00019383' TO DFHEIV0
 20709     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20711     MOVE X'3D20233030303139333833' TO DFHEIV0(25:11)
 20712     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 384
* EL050.cbl
 20713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20714
 20715
 20716
 20717* EXEC CICS STARTBR
 20718*        DATASET     ('ELCERT5')
 20719*        RIDFLD      (ELCERT2-KEY)
 20720*        EQUAL
 20721*    END-EXEC.
 20722     MOVE 'ELCERT5' TO DFHEIV1
 20723     MOVE 0
 20724       TO DFHEIV11
 20725*    MOVE '&,         E          &   #00019389' TO DFHEIV0
 20726     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20727     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20728     MOVE X'2020233030303139333839' TO DFHEIV0(25:11)
 20729     CALL 'kxdfhei1' USING DFHEIV0,
 20730           DFHEIV1,
 20731           ELCERT2-KEY,
 20732           DFHEIV99,
 20733           DFHEIV11,
 20734           DFHEIV99
 20735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20736
 20737
 20738 8710-READ-NEXT.
 20739
 20740* EXEC CICS READNEXT
 20741*        DATASET     ('ELCERT5')
 20742*        INTO        (CERTIFICATE-MASTER)
 20743*        RIDFLD      (ELCERT2-KEY)
 20744*    END-EXEC.
 20745     MOVE LENGTH OF
 20746      CERTIFICATE-MASTER
 20747       TO DFHEIV12
 20748     MOVE 'ELCERT5' TO DFHEIV1
 20749     MOVE 0
 20750       TO DFHEIV11
 20751*    MOVE '&.IL                  )   #00019396' TO DFHEIV0
 20752     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20753     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20754     MOVE X'2020233030303139333936' TO DFHEIV0(25:11)
 20755     CALL 'kxdfhei1' USING DFHEIV0,
 20756           DFHEIV1,
 20757           CERTIFICATE-MASTER,
 20758           DFHEIV12,
 20759           ELCERT2-KEY,
 20760           DFHEIV99,
 20761           DFHEIV11,
 20762           DFHEIV99,
 20763           DFHEIV99
 20764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20765
 20766
 20767 8720-COMP-ACCOUNTS.
 20768
 20769* EXEC CICS ENTER
 20770*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 385
* EL050.cbl
 20771*         FROM (PB-C-LAST-NAME)
 20772*    END-EXEC.
 20773     MOVE 001
 20774       TO DFHEIV11
 20775*    MOVE ':$F                   %   #00019403' TO DFHEIV0
 20776     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20777     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20778     MOVE X'2020233030303139343033' TO DFHEIV0(25:11)
 20779     CALL 'kxdfhei1' USING DFHEIV0,
 20780           DFHEIV11,
 20781           PB-C-LAST-NAME,
 20782           DFHEIV99,
 20783           DFHEIV99
 20784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20785
 20786
 20787
 20788* EXEC CICS ENTER
 20789*         TRACEID (002)
 20790*         FROM (CM-INSURED-LAST-NAME)
 20791*    END-EXEC.
 20792     MOVE 002
 20793       TO DFHEIV11
 20794*    MOVE ':$F                   %   #00019408' TO DFHEIV0
 20795     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20796     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20797     MOVE X'2020233030303139343038' TO DFHEIV0(25:11)
 20798     CALL 'kxdfhei1' USING DFHEIV0,
 20799           DFHEIV11,
 20800           CM-INSURED-LAST-NAME,
 20801           DFHEIV99,
 20802           DFHEIV99
 20803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20804
 20805
 20806     IF PB-CERT-NO NOT = CM-CERT-NO
 20807         GO TO 8730-END-BROWSE.
 20808
 20809     IF PB-ACCOUNT = CM-ACCOUNT
 20810         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20811             MOVE ER-2799        TO WS-ERROR
 20812             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20813             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20814             GO TO 8730-END-BROWSE.
 20815
 20816     GO TO 8710-READ-NEXT.
 20817
 20818 8730-END-BROWSE.
 20819
 20820* EXEC CICS ENDBR
 20821*         DATASET    ('ELCERT5')
 20822*    END-EXEC.
 20823     MOVE 'ELCERT5' TO DFHEIV1
 20824     MOVE 0
 20825       TO DFHEIV11
 20826*    MOVE '&2                    $   #00019426' TO DFHEIV0
 20827     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20828     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 386
* EL050.cbl
 20829     MOVE X'2020233030303139343236' TO DFHEIV0(25:11)
 20830     CALL 'kxdfhei1' USING DFHEIV0,
 20831           DFHEIV1,
 20832           DFHEIV11,
 20833           DFHEIV99
 20834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20835
 20836
 20837 8740-NOT-FOUND.
 20838     GO TO 0299-CERT-NOT-FOUND.
 20839
 20840 8750-START-ELSTAT.
 20841
 20842* EXEC CICS STARTBR
 20843*       DATASET   (STAT-ID)
 20844*       RIDFLD    (ELSTAT-KEY)
 20845*       GTEQ
 20846*       RESP      (WS-RESPONSE)
 20847*    END-EXEC
 20848     MOVE 0
 20849       TO DFHEIV11
 20850*    MOVE '&,         G          &  N#00019434' TO DFHEIV0
 20851     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20852     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20853     MOVE X'204E233030303139343334' TO DFHEIV0(25:11)
 20854     CALL 'kxdfhei1' USING DFHEIV0,
 20855           STAT-ID,
 20856           ELSTAT-KEY,
 20857           DFHEIV99,
 20858           DFHEIV11,
 20859           DFHEIV99
 20860     MOVE EIBRESP  TO WS-RESPONSE
 20861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20862     IF WS-RESP-NORMAL
 20863        MOVE 'Y'                 TO STAT-MASTER-SW
 20864     ELSE
 20865        MOVE 'N'                 TO STAT-MASTER-SW
 20866     END-IF
 20867     .
 20868 8750-EXIT.
 20869     EXIT.
 20870 8752-READ-ELSTAT.
 20871
 20872* EXEC CICS READNEXT
 20873*       DATASET   (STAT-ID)
 20874*       RIDFLD    (ELSTAT-KEY)
 20875*       INTO      (STATE-FILE)
 20876*       RESP      (WS-RESPONSE)
 20877*    END-EXEC
 20878     MOVE LENGTH OF
 20879      STATE-FILE
 20880       TO DFHEIV12
 20881     MOVE 0
 20882       TO DFHEIV11
 20883*    MOVE '&.IL                  )  N#00019449' TO DFHEIV0
 20884     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20885     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20886     MOVE X'204E233030303139343439' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 387
* EL050.cbl
 20887     CALL 'kxdfhei1' USING DFHEIV0,
 20888           STAT-ID,
 20889           STATE-FILE,
 20890           DFHEIV12,
 20891           ELSTAT-KEY,
 20892           DFHEIV99,
 20893           DFHEIV11,
 20894           DFHEIV99,
 20895           DFHEIV99
 20896     MOVE EIBRESP  TO WS-RESPONSE
 20897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20898     IF WS-RESP-NORMAL
 20899        MOVE 'Y'                 TO STAT-MASTER-SW
 20900     ELSE
 20901        MOVE 'N'                 TO STAT-MASTER-SW
 20902     END-IF
 20903     .
 20904 8752-EXIT.
 20905     EXIT.
 20906 8800-GET-COMP-RATE.
 20907     MOVE +1 TO IB.
 20908     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20909         ADD +9 TO IB
 20910         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20911             ADD +9 TO IB
 20912             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20913                MOVE ZEROS       TO WS-WK-RATE
 20914                GO TO 8800-EXIT.
 20915
 20916     IF PB-I-AGE GREATER CT-AGE (1)
 20917         ADD +3 TO IB
 20918         IF PB-I-AGE GREATER CT-AGE (2)
 20919             ADD +3 TO IB
 20920             IF PB-I-AGE GREATER CT-AGE (3)
 20921                MOVE ZEROS       TO WS-WK-RATE
 20922                GO TO 8800-EXIT.
 20923
 20924     IF WS-WORK-TERM GREATER CT-TRM (1)
 20925         ADD +1 TO IB
 20926         IF WS-WORK-TERM GREATER CT-TRM (2)
 20927             ADD +1 TO IB
 20928             IF WS-WORK-TERM GREATER CT-TRM (3)
 20929                MOVE ZEROS       TO WS-WK-RATE
 20930                GO TO 8800-EXIT.
 20931
 20932     IF CT-RT (IB) NOT NUMERIC
 20933         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20934         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20935         GO TO 8800-GET-COMP-RATE.
 20936
 20937     MOVE CT-RT (IB) TO WS-WK-RATE.
 20938
 20939 8800-EXIT.
 20940     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 388
* EL050.cbl
 20942 8900-ADDRESS-FILE.
 20943     IF ERACCT-FILE-ADDRESSED
 20944         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20945         GO TO 8900-ADDRESS-EXIT.
 20946
 20947     IF ELCNTL-FILE-ADDRESSED
 20948         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20949         GO TO 8900-ADDRESS-EXIT.
 20950
 20951     IF ERPLAN-FILE-ADDRESSED
 20952         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20953         GO TO 8900-ADDRESS-EXIT.
 20954
 20955     IF ERFORM-FILE-ADDRESSED
 20956         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20957         GO TO 8900-ADDRESS-EXIT.
 20958
 20959 8900-ADDRESS-EXIT.
 20960     EXIT.
 20961
 20962 9000-READ-CONTROL.
 20963
 20964* EXEC CICS HANDLE CONDITION
 20965*        NOTFND    (9000-NOTFND)
 20966*    END-EXEC.
 20967*    MOVE '"$I                   ! > #00019520' TO DFHEIV0
 20968     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20969     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20970     MOVE X'3E20233030303139353230' TO DFHEIV0(25:11)
 20971     CALL 'kxdfhei1' USING DFHEIV0
 20972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20973
 20974
 20975
 20976* EXEC CICS READ
 20977*        DATASET     (CNTL-ID)
 20978*        SET         (ADDRESS OF CONTROL-FILE)
 20979*        RIDFLD      (ELCNTL-KEY)
 20980*        GTEQ
 20981*    END-EXEC.
 20982*    MOVE '&"S        G          (   #00019524' TO DFHEIV0
 20983     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20985     MOVE X'2020233030303139353234' TO DFHEIV0(25:11)
 20986     CALL 'kxdfhei1' USING DFHEIV0,
 20987           CNTL-ID,
 20988           DFHEIV20,
 20989           DFHEIV99,
 20990           ELCNTL-KEY,
 20991           DFHEIV99,
 20992           DFHEIV99,
 20993           DFHEIV99
 20994     SET ADDRESS OF CONTROL-FILE TO
 20995         DFHEIV20
 20996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20997
 20998
 20999     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 389
* EL050.cbl
 21000
 21001 9000-NOTFND.
 21002     IF RC-SW-1 = '1'
 21003        MOVE ER-2616              TO WS-ERROR
 21004        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21005        GO TO 9000-EXIT.
 21006
 21007     IF RC-SW-1 = '2'
 21008        MOVE ER-2602              TO WS-ERROR
 21009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21010
 21011 9000-EXIT.
 21012      EXIT.
 21013
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 390
* EL050.cbl
 21015 9100-READ-CONTROL.
 21016
 21017* EXEC CICS HANDLE CONDITION
 21018*        NOTFND  (9100-NOTFND)
 21019*        ENDFILE (9100-NOTFND)
 21020*    END-EXEC.
 21021*    MOVE '"$I''                  ! ? #00019548' TO DFHEIV0
 21022     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21023     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21024     MOVE X'3F20233030303139353438' TO DFHEIV0(25:11)
 21025     CALL 'kxdfhei1' USING DFHEIV0
 21026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21027
 21028
 21029
 21030* EXEC CICS READ
 21031*        DATASET     (CNTL-ID)
 21032*        INTO        (CONTROL-FILE)
 21033*        RIDFLD      (ELCNTL-KEY)
 21034*        GTEQ
 21035*    END-EXEC.
 21036     MOVE LENGTH OF
 21037      CONTROL-FILE
 21038       TO DFHEIV11
 21039*    MOVE '&"IL       G          (   #00019553' TO DFHEIV0
 21040     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21041     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21042     MOVE X'2020233030303139353533' TO DFHEIV0(25:11)
 21043     CALL 'kxdfhei1' USING DFHEIV0,
 21044           CNTL-ID,
 21045           CONTROL-FILE,
 21046           DFHEIV11,
 21047           ELCNTL-KEY,
 21048           DFHEIV99,
 21049           DFHEIV99,
 21050           DFHEIV99
 21051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21052
 21053
 21054     GO TO 9100-EXIT.
 21055
 21056 9100-NOTFND.
 21057     IF RC-SW-2 = '0'
 21058        MOVE '1'                  TO STATE-RECORD-ERROR
 21059        GO TO 9100-EXIT
 21060     END-IF
 21061     IF RC-SW-2 = '1'
 21062        MOVE '1'                  TO LF-BENEFIT-ERROR
 21063        MOVE ER-2604              TO WS-ERROR
 21064        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21065        GO TO 9100-EXIT.
 21066
 21067     IF RC-SW-2 = '2'
 21068        MOVE '1'                  TO AH-BENEFIT-ERROR
 21069        MOVE ER-2605              TO WS-ERROR
 21070        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21071        GO TO 9100-EXIT.
 21072
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 391
* EL050.cbl
 21073     IF RC-SW-2 = '3'
 21074         MOVE ER-2603           TO WS-ERROR
 21075         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21076         GO TO 9100-EXIT.
 21077
 21078     IF RC-SW-2 = '4'
 21079         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21080         GO TO 9100-EXIT.
 21081
 21082     IF RC-SW-2 = '5'
 21083         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21084         IF WS-AH-INPUT-CD-1 = SPACE
 21085             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21086         ELSE
 21087             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21088
 21089 9100-EXIT.
 21090      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 392
* EL050.cbl
 21092 9200-CONTROL-GETMAIN.
 21093
 21094* EXEC CICS GETMAIN
 21095*         LENGTH   (750)
 21096*         SET      (ADDRESS OF CONTROL-FILE)
 21097*    END-EXEC.
 21098     MOVE 750
 21099       TO DFHEIV11
 21100*    MOVE '," L                  $   #00019599' TO DFHEIV0
 21101     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21102     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21103     MOVE X'2020233030303139353939' TO DFHEIV0(25:11)
 21104     CALL 'kxdfhei1' USING DFHEIV0,
 21105           DFHEIV20,
 21106           DFHEIV11,
 21107           DFHEIV99
 21108     SET ADDRESS OF CONTROL-FILE TO
 21109         DFHEIV20
 21110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21111
 21112
 21113     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21114
 21115 9200-EXIT.
 21116     EXIT.
 21117
 21118 9250-UNLOCK-RETURN.
 21119
 21120* EXEC CICS UNLOCK
 21121*        DATASET   (CERT-ID)
 21122*    END-EXEC.
 21123*    MOVE '&*                    #   #00019610' TO DFHEIV0
 21124     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21125     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21126     MOVE X'2020233030303139363130' TO DFHEIV0(25:11)
 21127     CALL 'kxdfhei1' USING DFHEIV0,
 21128           CERT-ID,
 21129           DFHEIV99
 21130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21131
 21132
 21133 9300-ABEND.
 21134     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21135
 21136
 21137* EXEC CICS LINK
 21138*        PROGRAM   ('EL004')
 21139*        COMMAREA  (WS-ERROR-LINE)
 21140*        LENGTH    (72)
 21141*    END-EXEC.
 21142     MOVE 'EL004' TO DFHEIV1
 21143     MOVE 72
 21144       TO DFHEIV11
 21145*    MOVE '."C                   (   #00019617' TO DFHEIV0
 21146     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21148     MOVE X'2020233030303139363137' TO DFHEIV0(25:11)
 21149     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 393
* EL050.cbl
 21150           DFHEIV1,
 21151           WS-ERROR-LINE,
 21152           DFHEIV11,
 21153           DFHEIV99,
 21154           DFHEIV99,
 21155           DFHEIV99,
 21156           DFHEIV99
 21157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21158
 21159
 21160     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21161
 21162
 21163* EXEC CICS ABEND
 21164*        ABCODE ('EL50')
 21165*    END-EXEC.
 21166     MOVE 'EL50' TO DFHEIV5
 21167*    MOVE '.,A                   "   #00019625' TO DFHEIV0
 21168     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21169     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21170     MOVE X'2020233030303139363235' TO DFHEIV0(25:11)
 21171     CALL 'kxdfhei1' USING DFHEIV0,
 21172           DFHEIV5
 21173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21174
 21175
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 394
* EL050.cbl
 21177
 21178******************************************************************
 21179*                                                                *
 21180*            E R R O R   F O R M A T   R O U T I N E             *
 21181*                                                                *
 21182******************************************************************
 21183
 21184 9900-ERROR-FORMAT.
 21185
 21186     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21187                    PB-COMMON-ERROR (2) OR
 21188                    PB-COMMON-ERROR (3) OR
 21189                    PB-COMMON-ERROR (4) OR
 21190                    PB-COMMON-ERROR (5) OR
 21191                    PB-COMMON-ERROR (6) OR
 21192                    PB-COMMON-ERROR (7) OR
 21193                    PB-COMMON-ERROR (8) OR
 21194                    PB-COMMON-ERROR (9) OR
 21195                    PB-COMMON-ERROR (10)
 21196        GO TO 9900-EXIT.
 21197
 21198     IF PB-NO-OF-ERRORS = +10
 21199        GO TO 9900-EXIT.
 21200
 21201     ADD +1  TO PB-NO-OF-ERRORS.
 21202     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21203                                       (PB-NO-OF-ERRORS).
 21204 9900-EXIT.
 21205     EXIT.
 21206
 21207 9990-RETURN.
 21208     IF BROWSE-STARTED
 21209
 21210* EXEC CICS ENDBR
 21211*            DATASET  (ACCT-ID)
 21212*       END-EXEC.
 21213     MOVE 0
 21214       TO DFHEIV11
 21215*    MOVE '&2                    $   #00019662' TO DFHEIV0
 21216     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21217     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21218     MOVE X'2020233030303139363632' TO DFHEIV0(25:11)
 21219     CALL 'kxdfhei1' USING DFHEIV0,
 21220           ACCT-ID,
 21221           DFHEIV11,
 21222           DFHEIV99
 21223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21224
 21225
 21226 9990-EXIT.
 21227     EXIT.
 21228
 21229
 21230****Check for CRTO record, add one if not found.
 21231 9991-CHECK-FOR-ELCRTO.
 21232
 21233* EXEC CICS HANDLE CONDITION
 21234*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 395
* EL050.cbl
 21235*         ENDFILE (9991-CRTO-NOT-FOUND)
 21236*     END-EXEC.
 21237*    MOVE '"$I''                  ! @ #00019672' TO DFHEIV0
 21238     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21239     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21240     MOVE X'4020233030303139363732' TO DFHEIV0(25:11)
 21241     CALL 'kxdfhei1' USING DFHEIV0
 21242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21243
 21244     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21245     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21246     MOVE +0                     TO ELCRTO-SEQ-NO
 21247
 21248
 21249* EXEC CICS READ
 21250*       DATASET   ('ELCRTO')
 21251*       INTO      (ORIGINAL-CERTIFICATE)
 21252*       RIDFLD    (ELCRTO-KEY)
 21253*       GTEQ
 21254*       RESP      (WS-RESPONSE)
 21255*    END-EXEC
 21256     MOVE LENGTH OF
 21257      ORIGINAL-CERTIFICATE
 21258       TO DFHEIV11
 21259     MOVE 'ELCRTO' TO DFHEIV1
 21260*    MOVE '&"IL       G          (  N#00019680' TO DFHEIV0
 21261     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21262     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21263     MOVE X'204E233030303139363830' TO DFHEIV0(25:11)
 21264     CALL 'kxdfhei1' USING DFHEIV0,
 21265           DFHEIV1,
 21266           ORIGINAL-CERTIFICATE,
 21267           DFHEIV11,
 21268           ELCRTO-KEY,
 21269           DFHEIV99,
 21270           DFHEIV99,
 21271           DFHEIV99
 21272     MOVE EIBRESP  TO WS-RESPONSE
 21273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21274
 21275     IF WS-RESP-NORMAL
 21276        AND (OC-CONTROL-PRIMARY (1:33) =
 21277                 PB-CONTROL-BY-ACCOUNT (1:33))
 21278        AND (OC-RECORD-TYPE =  'I')
 21279           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21280               GO TO 9991-CHECK-INDICATORS
 21281           ELSE
 21282               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21283               GO TO 9991-CRTO-ADD-REC
 21284           END-IF
 21285     END-IF.
 21286
 21287 9991-CRTO-NOT-FOUND.
 21288
 21289     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21290     MOVE 'OC'                TO OC-RECORD-ID
 21291     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21292                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 396
* EL050.cbl
 21293     MOVE +4096               TO OC-KEY-SEQ-NO.
 21294
 21295 9991-CRTO-ADD-REC.
 21296
 21297     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21298     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21299     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21300     MOVE 'I'                 TO OC-RECORD-TYPE
 21301     IF PB-ISSUE
 21302         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21303         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21304         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21305         MOVE PB-I-AGE               TO OC-INS-AGE
 21306         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21307         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21308         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21309         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21310         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21311         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21312         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21313         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21314         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21315         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21316         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21317         IF PB-I-JOINT-COMMISSION > +0
 21318             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21319         ELSE
 21320             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21321         END-IF
 21322         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21323         MOVE +0                     TO OC-LF-CANCEL-AMT
 21324                                        OC-LF-ITD-CANCEL-AMT
 21325         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21326         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21327         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21328         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21329         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21330         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21331         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21332         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21333         MOVE +0                     TO OC-AH-CANCEL-AMT
 21334                                        OC-AH-ITD-CANCEL-AMT
 21335         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21336         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21337         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21338     ELSE
 21339         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21340         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21341         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21342         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21343         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21344         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21345         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21346         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21347         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21348          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21349             MOVE SPACES             TO OC-LF-BENCD
 21350             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 397
* EL050.cbl
 21351                                        OC-LF-BEN-AMT
 21352                                        OC-LF-PRM-AMT
 21353                                        OC-LF-ALT-BEN-AMT
 21354                                        OC-LF-ALT-PRM-AMT
 21355                                        OC-LF-COMM-PCT
 21356                                        OC-LF-CANCEL-AMT
 21357             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21358             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21359         ELSE
 21360             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21361             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21362             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21363             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21364             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21365             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21366             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21367             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21368             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21369             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21370         END-IF
 21371         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21372         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21373          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21374             MOVE SPACES             TO OC-AH-BENCD
 21375             MOVE ZEROS              TO OC-AH-TERM
 21376                                        OC-AH-BEN-AMT
 21377                                        OC-AH-PRM-AMT
 21378                                        OC-AH-COMM-PCT
 21379                                        OC-AH-CANCEL-AMT
 21380                                        OC-AH-CP
 21381             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21382             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21383         ELSE
 21384             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21385             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21386             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21387             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21388             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21389             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21390             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21391             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21392             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21393         END-IF
 21394         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21395         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21396         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21397         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21398     END-IF
 21399     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21400
 21401     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21402
 21403
 21404* EXEC CICS READ
 21405*         DATASET   (FILE-ERMAIL)
 21406*         RIDFLD    (MA-CONTROL-PRIMARY)
 21407*         INTO      (MAILING-DATA)
 21408*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 398
* EL050.cbl
 21409*    END-EXEC
 21410     MOVE LENGTH OF
 21411      MAILING-DATA
 21412       TO DFHEIV11
 21413*    MOVE '&"IL       E          (  N#00019816' TO DFHEIV0
 21414     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21416     MOVE X'204E233030303139383136' TO DFHEIV0(25:11)
 21417     CALL 'kxdfhei1' USING DFHEIV0,
 21418           FILE-ERMAIL,
 21419           MAILING-DATA,
 21420           DFHEIV11,
 21421           MA-CONTROL-PRIMARY,
 21422           DFHEIV99,
 21423           DFHEIV99,
 21424           DFHEIV99
 21425     MOVE EIBRESP  TO WS-RESPONSE
 21426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21427
 21428     IF WS-RESP-NORMAL
 21429         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21430     END-IF.
 21431
 21432     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21433     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21434
 21435
 21436* EXEC CICS READ
 21437*         DATASET  (CRTT-ID)
 21438*         RIDFLD   (WS-ELCRTT-KEY)
 21439*         INTO     (CERTIFICATE-TRAILERS)
 21440*         RESP     (WS-RESPONSE)
 21441*    END-EXEC
 21442     MOVE LENGTH OF
 21443      CERTIFICATE-TRAILERS
 21444       TO DFHEIV11
 21445*    MOVE '&"IL       E          (  N#00019830' TO DFHEIV0
 21446     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21448     MOVE X'204E233030303139383330' TO DFHEIV0(25:11)
 21449     CALL 'kxdfhei1' USING DFHEIV0,
 21450           CRTT-ID,
 21451           CERTIFICATE-TRAILERS,
 21452           DFHEIV11,
 21453           WS-ELCRTT-KEY,
 21454           DFHEIV99,
 21455           DFHEIV99,
 21456           DFHEIV99
 21457     MOVE EIBRESP  TO WS-RESPONSE
 21458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21459
 21460     IF WS-RESP-NORMAL
 21461         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21462         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21463     END-IF.
 21464
 21465
 21466* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 399
* EL050.cbl
 21467*       DATASET   ('ELCRTO')
 21468*       FROM      (ORIGINAL-CERTIFICATE)
 21469*       RIDFLD    (OC-CONTROL-PRIMARY)
 21470*       RESP      (WS-RESPONSE)
 21471*    END-EXEC.
 21472     MOVE LENGTH OF
 21473      ORIGINAL-CERTIFICATE
 21474       TO DFHEIV11
 21475     MOVE 'ELCRTO' TO DFHEIV1
 21476*    MOVE '&$ L                  ''  N#00019842' TO DFHEIV0
 21477     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21478     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21479     MOVE X'204E233030303139383432' TO DFHEIV0(25:11)
 21480     CALL 'kxdfhei1' USING DFHEIV0,
 21481           DFHEIV1,
 21482           ORIGINAL-CERTIFICATE,
 21483           DFHEIV11,
 21484           OC-CONTROL-PRIMARY,
 21485           DFHEIV99,
 21486           DFHEIV99
 21487     MOVE EIBRESP  TO WS-RESPONSE
 21488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21489
 21490
 21491     GO TO 9991-EXIT.
 21492
 21493 9991-CHECK-INDICATORS.
 21494
 21495     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21496         GO TO 9991-EXIT
 21497     END-IF.
 21498
 21499     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21500         GO TO 9991-EXIT
 21501     END-IF.
 21502
 21503
 21504* EXEC CICS READ
 21505*       DATASET   ('ELCRTO')
 21506*       INTO      (ORIGINAL-CERTIFICATE)
 21507*       RIDFLD    (OC-CONTROL-PRIMARY)
 21508*       UPDATE
 21509*       RESP      (WS-RESPONSE)
 21510*    END-EXEC
 21511     MOVE LENGTH OF
 21512      ORIGINAL-CERTIFICATE
 21513       TO DFHEIV11
 21514     MOVE 'ELCRTO' TO DFHEIV1
 21515*    MOVE '&"IL       EU         (  N#00019861' TO DFHEIV0
 21516     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21517     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21518     MOVE X'204E233030303139383631' TO DFHEIV0(25:11)
 21519     CALL 'kxdfhei1' USING DFHEIV0,
 21520           DFHEIV1,
 21521           ORIGINAL-CERTIFICATE,
 21522           DFHEIV11,
 21523           OC-CONTROL-PRIMARY,
 21524           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 400
* EL050.cbl
 21525           DFHEIV99,
 21526           DFHEIV99
 21527     MOVE EIBRESP  TO WS-RESPONSE
 21528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21529     IF WS-RESP-NORMAL
 21530        IF PB-ISSUE
 21531          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21532          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21533          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21534          MOVE PB-I-AGE               TO OC-INS-AGE
 21535          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21536          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21537          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21538          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21539          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21540          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21541          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21542          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21543          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21544          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21545          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21546          IF PB-I-JOINT-COMMISSION > +0
 21547              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21548          ELSE
 21549              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21550          END-IF
 21551          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21552          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21553          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21554          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21555          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21556          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21557          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21558          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21559          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21560
 21561          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21562
 21563* EXEC CICS READ
 21564*             DATASET   (FILE-ERMAIL)
 21565*             RIDFLD    (MA-CONTROL-PRIMARY)
 21566*             INTO      (MAILING-DATA)
 21567*             RESP      (WS-RESPONSE)
 21568*         END-EXEC
 21569     MOVE LENGTH OF
 21570      MAILING-DATA
 21571       TO DFHEIV11
 21572*    MOVE '&"IL       E          (  N#00019901' TO DFHEIV0
 21573     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21574     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21575     MOVE X'204E233030303139393031' TO DFHEIV0(25:11)
 21576     CALL 'kxdfhei1' USING DFHEIV0,
 21577           FILE-ERMAIL,
 21578           MAILING-DATA,
 21579           DFHEIV11,
 21580           MA-CONTROL-PRIMARY,
 21581           DFHEIV99,
 21582           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 401
* EL050.cbl
 21583           DFHEIV99
 21584     MOVE EIBRESP  TO WS-RESPONSE
 21585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21586          IF WS-RESP-NORMAL
 21587             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21588          END-IF
 21589
 21590          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21591          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21592
 21593* EXEC CICS READ
 21594*             DATASET  (CRTT-ID)
 21595*             RIDFLD   (WS-ELCRTT-KEY)
 21596*             INTO     (CERTIFICATE-TRAILERS)
 21597*             RESP     (WS-RESPONSE)
 21598*         END-EXEC
 21599     MOVE LENGTH OF
 21600      CERTIFICATE-TRAILERS
 21601       TO DFHEIV11
 21602*    MOVE '&"IL       E          (  N#00019913' TO DFHEIV0
 21603     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21604     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21605     MOVE X'204E233030303139393133' TO DFHEIV0(25:11)
 21606     CALL 'kxdfhei1' USING DFHEIV0,
 21607           CRTT-ID,
 21608           CERTIFICATE-TRAILERS,
 21609           DFHEIV11,
 21610           WS-ELCRTT-KEY,
 21611           DFHEIV99,
 21612           DFHEIV99,
 21613           DFHEIV99
 21614     MOVE EIBRESP  TO WS-RESPONSE
 21615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21616          IF WS-RESP-NORMAL
 21617             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21618                               OC-INS-AGE-DEFAULT-FLAG
 21619             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21620                               OC-JNT-AGE-DEFAULT-FLAG
 21621          END-IF
 21622
 21623        ELSE
 21624          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21625             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21626             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21627             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21628          END-IF
 21629          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21630             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21631             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21632             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21633          END-IF
 21634          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21635        END-IF
 21636
 21637* EXEC CICS REWRITE
 21638*          DATASET   ('ELCRTO')
 21639*          FROM      (ORIGINAL-CERTIFICATE)
 21640*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 402
* EL050.cbl
 21641*       END-EXEC
 21642     MOVE LENGTH OF
 21643      ORIGINAL-CERTIFICATE
 21644       TO DFHEIV11
 21645     MOVE 'ELCRTO' TO DFHEIV1
 21646*    MOVE '&& L                  %  N#00019939' TO DFHEIV0
 21647     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21648     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21649     MOVE X'204E233030303139393339' TO DFHEIV0(25:11)
 21650     CALL 'kxdfhei1' USING DFHEIV0,
 21651           DFHEIV1,
 21652           ORIGINAL-CERTIFICATE,
 21653           DFHEIV11,
 21654           DFHEIV99
 21655     MOVE EIBRESP  TO WS-RESPONSE
 21656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21657     END-IF.
 21658
 21659 9991-EXIT.
 21660     EXIT.
 21661
 21662
 21663 9999-RETURN.
 21664     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21665
 21666
 21667* EXEC CICS RETURN
 21668*    END-EXEC.
 21669*    MOVE '.(                    ''   #00019953' TO DFHEIV0
 21670     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21671     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21672     MOVE X'2020233030303139393533' TO DFHEIV0(25:11)
 21673     CALL 'kxdfhei1' USING DFHEIV0,
 21674           DFHEIV99,
 21675           DFHEIV99,
 21676           DFHEIV99,
 21677           DFHEIV99,
 21678           DFHEIV99,
 21679           DFHEIV99
 21680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21681
 21682
 21683
 21684* GOBACK.
 21685     MOVE '9%                    "   ' TO DFHEIV0
 21686     MOVE 'EL050' TO DFHEIV1
 21687     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21688     GOBACK.
 21689
 21690 9999-DFHBACK SECTION.
 21691     MOVE '9%                    "   ' TO DFHEIV0
 21692     MOVE 'EL050' TO DFHEIV1
 21693     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21694     GOBACK.
 21695 9999-DFHEXIT.
 21696     IF DFHEIGDJ EQUAL 0001
 21697         NEXT SENTENCE
 21698     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 403
* EL050.cbl
 21699         GO TO 9300-ABEND,
 21700               3990-FILES-NOT-OPEN
 21701         DEPENDING ON DFHEIGDI
 21702     ELSE IF DFHEIGDJ EQUAL 3
 21703         GO TO 6610-START-BROWSE,
 21704               6630-ERRESS-PROBLEM,
 21705               6630-END-OF-FILE
 21706         DEPENDING ON DFHEIGDI
 21707     ELSE IF DFHEIGDJ EQUAL 4
 21708         GO TO 6630-END-OF-FILE,
 21709               6630-ERRESS-PROBLEM,
 21710               6630-ERRESS-PROBLEM,
 21711               6630-END-OF-FILE
 21712         DEPENDING ON DFHEIGDI
 21713     ELSE IF DFHEIGDJ EQUAL 5
 21714         GO TO 6630-END-OF-FILE,
 21715               6630-END-OF-FILE,
 21716               6630-ERRESS-PROBLEM,
 21717               6630-ERRESS-PROBLEM
 21718         DEPENDING ON DFHEIGDI
 21719     ELSE IF DFHEIGDJ EQUAL 6
 21720         GO TO 6660-START-BROWSE,
 21721               6690-ERRESC-PROBLEM,
 21722               6690-ERRESC-PROBLEM,
 21723               6690-END-OF-FILE
 21724         DEPENDING ON DFHEIGDI
 21725     ELSE IF DFHEIGDJ EQUAL 7
 21726         GO TO 6690-END-OF-FILE,
 21727               6690-ERRESC-PROBLEM,
 21728               6690-ERRESC-PROBLEM,
 21729               6690-END-OF-FILE
 21730         DEPENDING ON DFHEIGDI
 21731     ELSE IF DFHEIGDJ EQUAL 8
 21732         GO TO 6690-END-OF-FILE,
 21733               6690-ERRESC-PROBLEM,
 21734               6690-ERRESC-PROBLEM,
 21735               6690-END-OF-FILE
 21736         DEPENDING ON DFHEIGDI
 21737     ELSE IF DFHEIGDJ EQUAL 9
 21738         GO TO 7250-CONTINUE,
 21739               7250-CONTINUE
 21740         DEPENDING ON DFHEIGDI
 21741     ELSE IF DFHEIGDJ EQUAL 10
 21742         GO TO 7300-CONTINUE,
 21743               7300-CONTINUE
 21744         DEPENDING ON DFHEIGDI
 21745     ELSE IF DFHEIGDJ EQUAL 11
 21746         GO TO 8000-FREE-MAIN
 21747         DEPENDING ON DFHEIGDI
 21748     ELSE IF DFHEIGDJ EQUAL 12
 21749         GO TO 8100-NOTFND,
 21750               8100-NOTFND
 21751         DEPENDING ON DFHEIGDI
 21752     ELSE IF DFHEIGDJ EQUAL 13
 21753         GO TO 8110-NOTFND,
 21754               8110-NOTFND
 21755         DEPENDING ON DFHEIGDI
 21756     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 404
* EL050.cbl
 21757         GO TO 8130-EXIT
 21758         DEPENDING ON DFHEIGDI
 21759     ELSE IF DFHEIGDJ EQUAL 15
 21760         GO TO 8180-NOTFND
 21761         DEPENDING ON DFHEIGDI
 21762     ELSE IF DFHEIGDJ EQUAL 16
 21763         GO TO 8190-NOTFND
 21764         DEPENDING ON DFHEIGDI
 21765     ELSE IF DFHEIGDJ EQUAL 17
 21766         GO TO 8195-NOTFND
 21767         DEPENDING ON DFHEIGDI
 21768     ELSE IF DFHEIGDJ EQUAL 18
 21769         GO TO 8200-NOTFND
 21770         DEPENDING ON DFHEIGDI
 21771     ELSE IF DFHEIGDJ EQUAL 19
 21772         GO TO 8300-NOTFND,
 21773               8300-ERRESS-PROBLEM,
 21774               8300-ERRESS-PROBLEM,
 21775               8300-NOTFND
 21776         DEPENDING ON DFHEIGDI
 21777     ELSE IF DFHEIGDJ EQUAL 20
 21778         GO TO 8450-FORM-NOT-FOUND,
 21779               8450-FORM-NOT-FOUND
 21780         DEPENDING ON DFHEIGDI
 21781     ELSE IF DFHEIGDJ EQUAL 21
 21782         GO TO 0199-ACCT-NOT-FOUND,
 21783               0199-ACCT-NOT-FOUND
 21784         DEPENDING ON DFHEIGDI
 21785     ELSE IF DFHEIGDJ EQUAL 22
 21786         GO TO 0199-ACCT-NOT-FOUND,
 21787               0199-ACCT-NOT-FOUND
 21788         DEPENDING ON DFHEIGDI
 21789     ELSE IF DFHEIGDJ EQUAL 23
 21790         GO TO 8582-COMP-NOT-FOUND,
 21791               8582-COMP-NOT-FOUND
 21792         DEPENDING ON DFHEIGDI
 21793     ELSE IF DFHEIGDJ EQUAL 24
 21794         GO TO 8583-AGTC-NOT-FOUND,
 21795               8583-AGTC-NOT-FOUND
 21796         DEPENDING ON DFHEIGDI
 21797     ELSE IF DFHEIGDJ EQUAL 25
 21798         GO TO 8584-BXRF-NOT-FOUND,
 21799               8584-BXRF-NOT-FOUND
 21800         DEPENDING ON DFHEIGDI
 21801     ELSE IF DFHEIGDJ EQUAL 26
 21802         GO TO 8585-PLAN-NOT-FOUND,
 21803               8585-PLAN-NOT-FOUND
 21804         DEPENDING ON DFHEIGDI
 21805     ELSE IF DFHEIGDJ EQUAL 27
 21806         GO TO 0299-CERT-NOT-FOUND
 21807         DEPENDING ON DFHEIGDI
 21808     ELSE IF DFHEIGDJ EQUAL 28
 21809         GO TO 8700-READ-CERT-MASTER
 21810         DEPENDING ON DFHEIGDI
 21811     ELSE IF DFHEIGDJ EQUAL 29
 21812         GO TO 8720-COMP-ACCOUNTS,
 21813               8730-END-BROWSE,
 21814               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:38 Page 405
* EL050.cbl
 21815         DEPENDING ON DFHEIGDI
 21816     ELSE IF DFHEIGDJ EQUAL 30
 21817         GO TO 9000-NOTFND
 21818         DEPENDING ON DFHEIGDI
 21819     ELSE IF DFHEIGDJ EQUAL 31
 21820         GO TO 9100-NOTFND,
 21821               9100-NOTFND
 21822         DEPENDING ON DFHEIGDI
 21823     ELSE IF DFHEIGDJ EQUAL 32
 21824         GO TO 9991-CRTO-NOT-FOUND,
 21825               9991-CRTO-NOT-FOUND
 21826         DEPENDING ON DFHEIGDI.
 21827     MOVE '9%                    "   ' TO DFHEIV0
 21828     MOVE 'EL050' TO DFHEIV1
 21829     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21830     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40008     Code:       87925
