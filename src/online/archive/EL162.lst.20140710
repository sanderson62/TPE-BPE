* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL162.cbl
* Options: int("EL162.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL162.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL162.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL162.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL162 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/02/95 14:07:28.
     7*                            VMOD=2.015
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EX17 - RECORD MAIL RECEIVED
    13*            USED TO REVIEW PENDING MAIL AND TO RECORD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL162.cbl
    14*            INCOMING MAIL.
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    24* 121406    2006081100001  PEMA  ADD RECEIVE DATE EDIT
    25* 051107    2006052500001  AJRA  POPULATE UBY WITH USER ID
    26* 100610    2009122800001  AJRA  BYPASS LETTER W/ RESEND PRINTED D
    27* 102610    2009122800001  AJRA    REPLACE VERIFY W/ STOP DATE
    28******************************************************************
    29
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL162.cbl
    31 ENVIRONMENT DIVISION.
    32 DATA DIVISION.
    33 WORKING-STORAGE SECTION.
    34 01  DFH-START PIC X(04).
    35 77  FILLER  PIC X(32)  VALUE '********************************'.
    36 77  FILLER  PIC X(32)  VALUE '*    EL162 WORKING STORAGE     *'.
    37 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.015 *********'.
    38
    39*                            COPY ELCSCTM.
    40******************************************************************
    41*                                                                *
    42*                                                                *
    43*                            ELCSCTM                             *
    44*                            VMOD=2.001                          *
    45*                                                                *
    46*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    47*                                                                *
    48******************************************************************
    49 01  SECURITY-MESSAGE.
    50     12  FILLER                          PIC X(30)
    51            VALUE '** LOGIC SECURITY VIOLATION -'.
    52     12  SM-READ                         PIC X(6).
    53     12  FILLER                          PIC X(5)
    54            VALUE ' PGM='.
    55     12  SM-PGM                          PIC X(6).
    56     12  FILLER                          PIC X(5)
    57            VALUE ' OPR='.
    58     12  SM-PROCESSOR-ID                 PIC X(4).
    59     12  FILLER                          PIC X(6)
    60            VALUE ' TERM='.
    61     12  SM-TERMID                       PIC X(4).
    62     12  FILLER                          PIC XX   VALUE SPACE.
    63     12  SM-JUL-DATE                     PIC 9(5).
    64     12  FILLER                          PIC X    VALUE SPACE.
    65     12  SM-TIME                         PIC 99.99.
    66
    67
    68*                            COPY ELCSCRTY.
    69******************************************************************
    70*                                                                *
    71*                                                                *
    72*                            ELCSCRTY                            *
    73*                            VMOD=2.001                          *
    74*                                                                *
    75*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    76*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    77*        SAVED IN PI-SECURITY-ADDRESS.                           *
    78*                                                                *
    79******************************************************************
    80 01  SECURITY-CONTROL.
    81     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    82     12  FILLER                       PIC XX    VALUE 'SC'.
    83     12  SC-CREDIT-CODES.
    84         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    85             20  SC-CREDIT-DISPLAY    PIC X.
    86             20  SC-CREDIT-UPDATE     PIC X.
    87     12  SC-CLAIMS-CODES.
    88         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL162.cbl
    89             20  SC-CLAIMS-DISPLAY    PIC X.
    90             20  SC-CLAIMS-UPDATE     PIC X.
    91
    92 01  WS-DATE-AREA.
    93     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    94     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
    95     05  CURRENT-MINUS1-SAVE PIC XX      VALUE SPACES.
    96
    97 01  STANDARD-AREAS.
    98     12  SC-ITEM                 PIC S9(4)   VALUE +1  COMP.
    99     12  MAP-NAME.
   100         16  MAP-PRE             PIC XX      VALUE 'EL'.
   101         16  MAP-NUMBER          PIC X(4)    VALUE '162A'.
   102         16  FILLER              PIC XX      VALUE SPACES.
   103     12  MAPSET-NAME             PIC X(8)    VALUE 'EL162S'.
   104     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   105     12  TRANS-ID                PIC X(4)    VALUE 'EX17'.
   106     12  PGM-NAME                PIC X(8).
   107     12  TIME-IN                 PIC S9(7).
   108     12  TIME-OUT-R  REDEFINES TIME-IN.
   109         16  FILLER              PIC X.
   110         16  TIME-OUT            PIC 99V99.
   111         16  FILLER              PIC XX.
   112     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   113     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   114     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   115     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   116     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   117     12  LINK-ELDATCV            PIC X(7)    VALUE 'ELDATCV'.
   118     12  THIS-PGM                PIC X(8)    VALUE 'EL162'.
   119     12  PGM-EL141               PIC X(8)    VALUE 'EL141'.
   120     12  PGM-EL132               PIC X(8)    VALUE 'EL132'.
   121     12  PGM-EL150               PIC X(8)    VALUE 'EL150'.
   122     12  ELMSTR-FILE-ID          PIC X(8)    VALUE 'ELMSTR'.
   123     12  ELTRLR-FILE-ID          PIC X(8)    VALUE 'ELTRLR'.
   124     12  ERACCT-FILE-ID          PIC X(8)    VALUE 'ERACCT'.
   125     12  SUB                     PIC S999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL162.cbl
   127 01  ERROR-MESSAGES.
   128     12  ER-ZEROS                PIC X(4)    VALUE '0000'.
   129     12  ER-0004                 PIC X(4)    VALUE '0004'.
   130     12  ER-0008                 PIC X(4)    VALUE '0008'.
   131     12  ER-0029                 PIC X(4)    VALUE '0029'.
   132     12  ER-0050                 PIC X(4)    VALUE '0050'.
   133     12  ER-0021                 PIC X(4)    VALUE '0021'.
   134     12  ER-0042                 PIC X(4)    VALUE '0042'.
   135     12  ER-0066                 PIC X(4)    VALUE '0066'.
   136     12  ER-0067                 PIC X(4)    VALUE '0067'.
   137     12  ER-0070                 PIC X(4)    VALUE '0070'.
   138     12  ER-0133                 PIC X(4)    VALUE '0133'.
   139     12  ER-0168                 PIC X(4)    VALUE '0168'.
   140     12  ER-0172                 PIC X(4)    VALUE '0172'.
   141     12  ER-0179                 PIC X(4)    VALUE '0179'.
   142     12  ER-0318                 PIC X(4)    VALUE '0318'.
   143     12  ER-0319                 PIC X(4)    VALUE '0319'.
   144     12  ER-0320                 PIC X(4)    VALUE '0320'.
   145     12  ER-0321                 PIC X(4)    VALUE '0321'.
   146     12  ER-0322                 PIC X(4)    VALUE '0322'.
   147     12  ER-0514                 PIC X(4)    VALUE '0514'.
   148     12  ER-0539                 PIC X(4)    VALUE '0539'.
   149     12  ER-0895                 PIC X(4)    VALUE '0895'.
   150     12  ER-0896                 PIC X(4)    VALUE '0896'.
   151     12  ER-7839                 PIC X(4)    VALUE '7839'.
   152
   153     12  BIN-CURRENT-DATE        PIC XX.
   154     12  INDX-WORK               PIC 9(4).
   155     12  REC-DATA-SW             PIC X       VALUE ' '.
   156         88  REC-DATA                        VALUE '1'.
   157     12  VER-DATA-SW             PIC X       VALUE ' '.
   158         88  VER-DATA                        VALUE '1'.
   159     12  UNSOL-DATA-SW           PIC X       VALUE ' '.
   160         88  UNSOL-DATA                      VALUE '1'.
   161         88  FILE-DATA                       VALUE '2'.
   162     12  ADDR-TYPE               PIC X.
   163     12  ADDR-SEQ                PIC S9(4) COMP.
   164     12  ACTV-LENGTH             PIC S9(4) COMP VALUE +200.
   165     12  USENT-SAVE              PIC XX    VALUE LOW-VALUES.
   166     12  URECDTE-SAVE            PIC XX    VALUE LOW-VALUES.
   167     12  REC-DATE-SAVE OCCURS 4 TIMES INDEXED BY INDX     PIC XX.
   168     12  STOP-DATE-SAVE OCCURS 4 TIMES INDEXED BY INDX2   PIC XX.
   169     12  DEEDIT-FIELD            PIC X(15).
   170     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   171
   172     12  ACCT-KEY.
   173         16  ACCT-PARTIAL-KEY.
   174             20  ACCT-CO         PIC X.
   175             20  ACCT-CARRIER    PIC X.
   176             20  ACCT-GROUPING   PIC X(6).
   177             20  ACCT-STATE      PIC XX.
   178             20  ACCT-ACCOUNT    PIC X(10).
   179         16  ACCT-EXP-DATE       PIC XX.
   180     12  FILLER                  PIC S9(9)  VALUE +0 COMP.
   181     12  ACCT-SAVE-KEY           PIC X(20).
   182     12  WS-ZIP.
   183         16  WS-ZIP-CODE         PIC X(5).
   184         16  WS-DASH             PIC X     VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL162.cbl
   185         16  WS-ZIP-PLUS4        PIC X(4).
   186     12  WS-CANADIAN-POSTAL-CODES REDEFINES WS-ZIP.
   187         16  WS-CAN-POSTAL-CD-1  PIC X(3).
   188         16  WS-DASH-CAN         PIC X.
   189         16  WS-CAN-POSTAL-CD-2  PIC X(3).
   190         16  WS-CAN-FILLER       PIC X(3).
   191     12  WS-WORK-PHONE           PIC X(10)  VALUE ZEROS.
   192     12  WS-NUMERIC-PHONE REDEFINES WS-WORK-PHONE
   193                                 PIC 9(10).
   194     12  WS-REASON               PIC X(70).
   195
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL162.cbl
   197*                            COPY ELCDATE.
   198******************************************************************
   199*                                                                *
   200*                                                                *
   201*                            ELCDATE.                            *
   202*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   203*                            VMOD=2.003
   204*                                                                *
   205*                                                                *
   206*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   207*                 LENGTH = 200                                   *
   208******************************************************************
   209
   210 01  DATE-CONVERSION-DATA.
   211     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   212     12  DC-OPTION-CODE                PIC X.
   213         88  BIN-TO-GREG                VALUE ' '.
   214         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   215         88  EDIT-GREG-TO-BIN           VALUE '2'.
   216         88  YMD-GREG-TO-BIN            VALUE '3'.
   217         88  MDY-GREG-TO-BIN            VALUE '4'.
   218         88  JULIAN-TO-BIN              VALUE '5'.
   219         88  BIN-PLUS-ELAPSED           VALUE '6'.
   220         88  FIND-CENTURY               VALUE '7'.
   221         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   222         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   223         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   224         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   225         88  JULIAN-TO-BIN-3            VALUE 'C'.
   226         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   227         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   228         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   229         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   230         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   231         88  CHECK-LEAP-YEAR            VALUE 'H'.
   232         88  BIN-3-TO-GREG              VALUE 'I'.
   233         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   234         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   235         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   236         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   237         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   238         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   239         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   240         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   241         88  THREE-CHARACTER-BIN
   242                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   243         88  GREGORIAN-TO-BIN
   244                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   245         88  BIN-TO-GREGORIAN
   246                  VALUES ' ' '1' 'I' '8' 'G'.
   247         88  JULIAN-TO-BINARY
   248                  VALUES '5' 'C' 'E' 'F'.
   249     12  DC-ERROR-CODE                 PIC X.
   250         88  NO-CONVERSION-ERROR        VALUE ' '.
   251         88  DATE-CONVERSION-ERROR
   252                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   253         88  DATE-IS-ZERO               VALUE '1'.
   254         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL162.cbl
   255         88  DATE-IS-INVALID            VALUE '3'.
   256         88  DATE1-GREATER-DATE2        VALUE '4'.
   257         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   258         88  DATE-INVALID-OPTION        VALUE '9'.
   259         88  INVALID-CENTURY            VALUE 'A'.
   260         88  ONLY-CENTURY               VALUE 'B'.
   261         88  ONLY-LEAP-YEAR             VALUE 'C'.
   262         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   263     12  DC-END-OF-MONTH               PIC X.
   264         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   265     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   266         88  USE-NORMAL-PROCESS         VALUE ' '.
   267         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   268         88  ADJUST-UP-100-YRS          VALUE '2'.
   269     12  FILLER                        PIC X.
   270     12  DC-CONVERSION-DATES.
   271         16  DC-BIN-DATE-1             PIC XX.
   272         16  DC-BIN-DATE-2             PIC XX.
   273         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   274         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   275                       DC-GREG-DATE-1-EDIT.
   276             20  DC-EDIT1-MONTH        PIC 99.
   277             20  SLASH1-1              PIC X.
   278             20  DC-EDIT1-DAY          PIC 99.
   279             20  SLASH1-2              PIC X.
   280             20  DC-EDIT1-YEAR         PIC 99.
   281         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   282         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   283                     DC-GREG-DATE-2-EDIT.
   284             20  DC-EDIT2-MONTH        PIC 99.
   285             20  SLASH2-1              PIC X.
   286             20  DC-EDIT2-DAY          PIC 99.
   287             20  SLASH2-2              PIC X.
   288             20  DC-EDIT2-YEAR         PIC 99.
   289         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   290         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   291                     DC-GREG-DATE-1-YMD.
   292             20  DC-YMD-YEAR           PIC 99.
   293             20  DC-YMD-MONTH          PIC 99.
   294             20  DC-YMD-DAY            PIC 99.
   295         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   296         16  DC-GREG-DATE-1-MDY-R REDEFINES
   297                      DC-GREG-DATE-1-MDY.
   298             20  DC-MDY-MONTH          PIC 99.
   299             20  DC-MDY-DAY            PIC 99.
   300             20  DC-MDY-YEAR           PIC 99.
   301         16  DC-GREG-DATE-1-ALPHA.
   302             20  DC-ALPHA-MONTH        PIC X(10).
   303             20  DC-ALPHA-DAY          PIC 99.
   304             20  FILLER                PIC XX.
   305             20  DC-ALPHA-CENTURY.
   306                 24 DC-ALPHA-CEN-N     PIC 99.
   307             20  DC-ALPHA-YEAR         PIC 99.
   308         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   309         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   310         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   311         16  DC-JULIAN-DATE            PIC 9(05).
   312         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL162.cbl
   313                                       PIC 9(05).
   314         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   315             20  DC-JULIAN-YEAR        PIC 99.
   316             20  DC-JULIAN-DAYS        PIC 999.
   317         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   318         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   319         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   320     12  DATE-CONVERSION-VARIBLES.
   321         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   322         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   323             20  FILLER                PIC 9(3).
   324             20  HOLD-CEN-1-CCYY.
   325                 24  HOLD-CEN-1-CC     PIC 99.
   326                 24  HOLD-CEN-1-YY     PIC 99.
   327             20  HOLD-CEN-1-MO         PIC 99.
   328             20  HOLD-CEN-1-DA         PIC 99.
   329         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   330             20  HOLD-CEN-1-R-MO       PIC 99.
   331             20  HOLD-CEN-1-R-DA       PIC 99.
   332             20  HOLD-CEN-1-R-CCYY.
   333                 24  HOLD-CEN-1-R-CC   PIC 99.
   334                 24  HOLD-CEN-1-R-YY   PIC 99.
   335             20  FILLER                PIC 9(3).
   336         16  HOLD-CENTURY-1-X.
   337             20  FILLER                PIC X(3)  VALUE SPACES.
   338             20  HOLD-CEN-1-X-CCYY.
   339                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   340                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   341             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   342             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   343         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   344             20  HOLD-CEN-1-R-X-MO     PIC XX.
   345             20  HOLD-CEN-1-R-X-DA     PIC XX.
   346             20  HOLD-CEN-1-R-X-CCYY.
   347                 24  HOLD-CEN-1-R-X-CC PIC XX.
   348                 24  HOLD-CEN-1-R-X-YY PIC XX.
   349             20  FILLER                PIC XXX.
   350         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   351         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   352         16  DC-JULIAN-DATE-1          PIC 9(07).
   353         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   354             20  DC-JULIAN-1-CCYY.
   355                 24  DC-JULIAN-1-CC    PIC 99.
   356                 24  DC-JULIAN-1-YR    PIC 99.
   357             20  DC-JULIAN-DA-1        PIC 999.
   358         16  DC-JULIAN-DATE-2          PIC 9(07).
   359         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   360             20  DC-JULIAN-2-CCYY.
   361                 24  DC-JULIAN-2-CC    PIC 99.
   362                 24  DC-JULIAN-2-YR    PIC 99.
   363             20  DC-JULIAN-DA-2        PIC 999.
   364         16  DC-GREG-DATE-A-EDIT.
   365             20  DC-EDITA-MONTH        PIC 99.
   366             20  SLASHA-1              PIC X VALUE '/'.
   367             20  DC-EDITA-DAY          PIC 99.
   368             20  SLASHA-2              PIC X VALUE '/'.
   369             20  DC-EDITA-CCYY.
   370                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL162.cbl
   371                 24  DC-EDITA-YEAR     PIC 99.
   372         16  DC-GREG-DATE-B-EDIT.
   373             20  DC-EDITB-MONTH        PIC 99.
   374             20  SLASHB-1              PIC X VALUE '/'.
   375             20  DC-EDITB-DAY          PIC 99.
   376             20  SLASHB-2              PIC X VALUE '/'.
   377             20  DC-EDITB-CCYY.
   378                 24  DC-EDITB-CENT     PIC 99.
   379                 24  DC-EDITB-YEAR     PIC 99.
   380         16  DC-GREG-DATE-CYMD         PIC 9(08).
   381         16  DC-GREG-DATE-CYMD-R REDEFINES
   382                              DC-GREG-DATE-CYMD.
   383             20  DC-CYMD-CEN           PIC 99.
   384             20  DC-CYMD-YEAR          PIC 99.
   385             20  DC-CYMD-MONTH         PIC 99.
   386             20  DC-CYMD-DAY           PIC 99.
   387         16  DC-GREG-DATE-MDCY         PIC 9(08).
   388         16  DC-GREG-DATE-MDCY-R REDEFINES
   389                              DC-GREG-DATE-MDCY.
   390             20  DC-MDCY-MONTH         PIC 99.
   391             20  DC-MDCY-DAY           PIC 99.
   392             20  DC-MDCY-CEN           PIC 99.
   393             20  DC-MDCY-YEAR          PIC 99.
   394    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   395        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   396    12  DC-EL310-DATE                  PIC X(21).
   397    12  FILLER                         PIC X(28).
   398
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL162.cbl
   400*                            COPY ELCLOGOF.
   401******************************************************************
   402*                                                                *
   403*                                                                *
   404*                            ELCLOGOF.                           *
   405*                            VMOD=2.001                          *
   406*                                                                *
   407*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   408*                                                                *
   409******************************************************************
   410 01  CLASIC-LOGOFF.
   411     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   412     12  LOGOFF-TEXT.
   413         16  FILLER          PIC X(5)    VALUE SPACES.
   414         16  LOGOFF-MSG.
   415             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   416             20  FILLER      PIC X       VALUE SPACES.
   417             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   418         16  FILLER          PIC X(80)
   419           VALUE '* YOU ARE NOW LOGGED OFF'.
   420         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   421         16  FILLER          PIC X       VALUE QUOTE.
   422         16  LOGOFF-SYS-MSG  PIC X(17)
   423           VALUE 'S CLAS-IC SYSTEM '.
   424     12  TEXT-MESSAGES.
   425         16  UNACCESS-MSG    PIC X(29)
   426             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   427         16  PGMIDERR-MSG    PIC X(17)
   428             VALUE 'PROGRAM NOT FOUND'.
   429
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL162.cbl
   431*                            COPY ELCATTR.
   432******************************************************************
   433*                                                                *
   434*                            ELCATTR.                            *
   435*                            VMOD=2.001                          *
   436*                                                                *
   437*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   438*                                                                *
   439*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   440*                                                                *
   441*                   POS 1   P=PROTECTED                          *
   442*                           U=UNPROTECTED                        *
   443*                           S=ASKIP                              *
   444*                   POS 2   A=ALPHA/NUMERIC                      *
   445*                           N=NUMERIC                            *
   446*                   POS 3   N=NORMAL                             *
   447*                           B=BRIGHT                             *
   448*                           D=DARK                               *
   449*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   450*                           OF=MODIFIED DATA TAG OFF             *
   451*                                                                *
   452*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   453******************************************************************
   454 01  ATTRIBUTE-LIST.
   455     12  AL-PABOF            PIC X       VALUE 'Y'.
   456     12  AL-PABON            PIC X       VALUE 'Z'.
   457     12  AL-PADOF            PIC X       VALUE '%'.
   458     12  AL-PADON            PIC X       VALUE '_'.
   459     12  AL-PANOF            PIC X       VALUE '-'.
   460     12  AL-PANON            PIC X       VALUE '/'.
   461     12  AL-SABOF            PIC X       VALUE '8'.
   462     12  AL-SABON            PIC X       VALUE '9'.
   463     12  AL-SADOF            PIC X       VALUE '@'.
   464     12  AL-SADON            PIC X       VALUE QUOTE.
   465     12  AL-SANOF            PIC X       VALUE '0'.
   466     12  AL-SANON            PIC X       VALUE '1'.
   467     12  AL-UABOF            PIC X       VALUE 'H'.
   468     12  AL-UABON            PIC X       VALUE 'I'.
   469     12  AL-UADOF            PIC X       VALUE '<'.
   470     12  AL-UADON            PIC X       VALUE '('.
   471     12  AL-UANOF            PIC X       VALUE ' '.
   472     12  AL-UANON            PIC X       VALUE 'A'.
   473     12  AL-UNBOF            PIC X       VALUE 'Q'.
   474     12  AL-UNBON            PIC X       VALUE 'R'.
   475     12  AL-UNDOF            PIC X       VALUE '*'.
   476     12  AL-UNDON            PIC X       VALUE ')'.
   477     12  AL-UNNOF            PIC X       VALUE '&'.
   478     12  AL-UNNON            PIC X       VALUE 'J'.
   479
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL162.cbl
   481*                            COPY ELCEMIB.
   482******************************************************************
   483*                                                                *
   484*                                                                *
   485*                            ELCEMIB.                            *
   486*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   487*                            VMOD=2.005                          *
   488*                                                                *
   489*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   490*                                                                *
   491******************************************************************
   492 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   493     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   494     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   495     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   496     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   497     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   498     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   499     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   500     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   501     12  EMI-SWITCH1             PIC X        VALUE '1'.
   502         88  EMI-NO-ERRORS                    VALUE '1'.
   503         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   504         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   505     12  EMI-SWITCH2             PIC X        VALUE '1'.
   506         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   507     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   508         88  EMI-AREA1-EMPTY                  VALUE '1'.
   509         88  EMI-AREA1-FULL                   VALUE '2'.
   510     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   511         88  EMI-AREA2-EMPTY                  VALUE '1'.
   512         88  EMI-AREA2-FULL                   VALUE '2'.
   513     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   514         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   515         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   516         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   517         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   518         88  EMI-BYPASS-FATALS                VALUE 'X'.
   519     12  EMI-ERROR-LINES.
   520         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   521         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   522         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   523         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   524             20  EMI-ERR-CODES OCCURS 10 TIMES.
   525                 24  EMI-ERR-NUM         PIC X(4).
   526                 24  EMI-FILLER          PIC X.
   527                 24  EMI-SEV             PIC X.
   528                 24  FILLER              PIC X.
   529             20  FILLER                  PIC X(02).
   530     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   531         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   532             20  EMI-ERROR-NUMBER    PIC X(4).
   533             20  EMI-FILL            PIC X.
   534             20  EMI-SEVERITY        PIC X.
   535             20  FILLER              PIC X.
   536             20  EMI-ERROR-TEXT.
   537                 24  EMI-TEXT-VARIABLE   PIC X(10).
   538                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL162.cbl
   539     12  EMI-SEVERITY-SAVE           PIC X.
   540         88  EMI-NOTE                    VALUE 'N'.
   541         88  EMI-WARNING                 VALUE 'W'.
   542         88  EMI-FORCABLE                VALUE 'F'.
   543         88  EMI-FATAL                   VALUE 'X'.
   544     12  EMI-MESSAGE-FLAG            PIC X.
   545         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   546         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   547     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   548     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   549         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   550         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   551         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   552     12  FILLER                      PIC X(137)  VALUE SPACES.
   553     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   554     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   555     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   556     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL162.cbl
   558*                            COPY ELCINTF.
   559******************************************************************
   560*                                                                *
   561*                                                                *
   562*                            ELCINTF.                            *
   563*                            VMOD=2.017                          *
   564*                                                                *
   565*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   566*                                                                *
   567*       LENGTH = 1024                                            *
   568*                                                                *
   569******************************************************************
   570 01  PROGRAM-INTERFACE-BLOCK.
   571     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   572     12  PI-CALLING-PROGRAM              PIC X(8).
   573     12  PI-SAVED-PROGRAM-1              PIC X(8).
   574     12  PI-SAVED-PROGRAM-2              PIC X(8).
   575     12  PI-SAVED-PROGRAM-3              PIC X(8).
   576     12  PI-SAVED-PROGRAM-4              PIC X(8).
   577     12  PI-SAVED-PROGRAM-5              PIC X(8).
   578     12  PI-SAVED-PROGRAM-6              PIC X(8).
   579     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   580     12  PI-COMPANY-ID                   PIC XXX.
   581     12  PI-COMPANY-CD                   PIC X.
   582
   583     12  PI-COMPANY-PASSWORD             PIC X(8).
   584
   585     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   586
   587     12  PI-CONTROL-IN-PROGRESS.
   588         16  PI-CARRIER                  PIC X.
   589         16  PI-GROUPING                 PIC X(6).
   590         16  PI-STATE                    PIC XX.
   591         16  PI-ACCOUNT                  PIC X(10).
   592         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   593                                         PIC X(10).
   594         16  PI-CLAIM-CERT-GRP.
   595             20  PI-CLAIM-NO             PIC X(7).
   596             20  PI-CERT-NO.
   597                 25  PI-CERT-PRIME       PIC X(10).
   598                 25  PI-CERT-SFX         PIC X.
   599             20  PI-CERT-EFF-DT          PIC XX.
   600         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   601             20  PI-PLAN-CODE            PIC X(2).
   602             20  PI-REVISION-NUMBER      PIC X(3).
   603             20  PI-PLAN-EFF-DT          PIC X(2).
   604             20  PI-PLAN-EXP-DT          PIC X(2).
   605             20  FILLER                  PIC X(11).
   606         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   607             20  PI-OE-REFERENCE-1.
   608                 25  PI-OE-REF-1-PRIME   PIC X(18).
   609                 25  PI-OE-REF-1-SUFF    PIC XX.
   610
   611     12  PI-SESSION-IN-PROGRESS          PIC X.
   612         88  CLAIM-SESSION                   VALUE '1'.
   613         88  CREDIT-SESSION                  VALUE '2'.
   614         88  WARRANTY-SESSION                VALUE '3'.
   615         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL162.cbl
   616         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   617
   618
   619*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   620
   621     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   622     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   623
   624     12  PI-CREDIT-USER                  PIC X.
   625         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   626         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   627
   628     12  PI-CLAIM-USER                   PIC X.
   629         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   630         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   631
   632     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   633         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   634         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   635         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   636         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   637         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   638
   639     12  PI-PROCESSOR-ID                 PIC X(4).
   640
   641     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   642
   643     12  PI-MEMBER-CAPTION               PIC X(10).
   644
   645     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   646         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   647
   648     12  PI-LIFE-OVERRIDE-L1             PIC X.
   649     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   650     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   651     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   652
   653     12  PI-AH-OVERRIDE-L1               PIC X.
   654     12  PI-AH-OVERRIDE-L2               PIC XX.
   655     12  PI-AH-OVERRIDE-L6               PIC X(6).
   656     12  PI-AH-OVERRIDE-L12              PIC X(12).
   657
   658     12  PI-NEW-SYSTEM                   PIC X(2).
   659
   660     12  PI-PRIMARY-CERT-NO              PIC X(11).
   661     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   662         88  PI-USES-PAID-TO                 VALUE '1'.
   663     12  PI-CRDTCRD-SYSTEM.
   664         16  PI-CRDTCRD-USER             PIC X.
   665             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   666             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   667         16  PI-CC-MONTH-END-DT          PIC XX.
   668     12  PI-PROCESSOR-PRINTER            PIC X(4).
   669
   670     12  PI-OE-REFERENCE-2.
   671         16  PI-OE-REF-2-PRIME           PIC X(10).
   672         16  PI-OE-REF-2-SUFF            PIC X.
   673
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL162.cbl
   674     12  PI-REM-TRM-CALC-OPTION          PIC X.
   675
   676     12  PI-LANGUAGE-TYPE                PIC X.
   677             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   678             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   679             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   680
   681     12  PI-POLICY-LINKAGE-IND           PIC X.
   682         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   683         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   684                                                   LOW-VALUES.
   685
   686     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   687     12  PI-CLAIM-PW-SESSION             PIC X(1).
   688         88  PI-CLAIM-CREDIT                 VALUE '1'.
   689         88  PI-CLAIM-CONVEN                 VALUE '2'.
   690     12  FILLER                          PIC X(4).
   691
   692     12  PI-SYSTEM-LEVEL                 PIC X(145).
   693
   694     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   695         PI-SYSTEM-LEVEL.
   696
   697         16  PI-ENTRY-CODES.
   698             20  PI-ENTRY-CD-1           PIC X.
   699             20  PI-ENTRY-CD-2           PIC X.
   700
   701         16  PI-RETURN-CODES.
   702             20  PI-RETURN-CD-1          PIC X.
   703             20  PI-RETURN-CD-2          PIC X.
   704
   705         16  PI-UPDATE-STATUS-SAVE.
   706             20  PI-UPDATE-BY            PIC X(4).
   707             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   708
   709         16  PI-LOWER-CASE-LETTERS       PIC X.
   710             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   711
   712*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   713*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   714*            88  CARRIER-CLM-CNTL            VALUE '2'.
   715
   716         16  PI-CERT-ACCESS-CONTROL      PIC X.
   717             88  ST-ACCNT-CNTL               VALUE ' '.
   718             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   719             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   720             88  ACCNT-CNTL                  VALUE '3'.
   721             88  CARR-ACCNT-CNTL             VALUE '4'.
   722
   723         16  PI-PROCESSOR-CAP-LIST.
   724             20  PI-SYSTEM-CONTROLS.
   725                24 PI-SYSTEM-DISPLAY     PIC X.
   726                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   727                24 PI-SYSTEM-MODIFY      PIC X.
   728                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   729             20  FILLER                  PIC XX.
   730             20  PI-DISPLAY-CAP          PIC X.
   731                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL162.cbl
   732             20  PI-MODIFY-CAP           PIC X.
   733                 88  MODIFY-CAP              VALUE 'Y'.
   734             20  PI-MSG-AT-LOGON-CAP     PIC X.
   735                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   736             20  PI-FORCE-CAP            PIC X.
   737                 88  FORCE-CAP               VALUE 'Y'.
   738
   739         16  PI-PROGRAM-CONTROLS.
   740             20  PI-PGM-PRINT-OPT        PIC X.
   741             20  PI-PGM-FORMAT-OPT       PIC X.
   742             20  PI-PGM-PROCESS-OPT      PIC X.
   743             20  PI-PGM-TOTALS-OPT       PIC X.
   744
   745         16  PI-HELP-INTERFACE.
   746             20  PI-LAST-ERROR-NO        PIC X(4).
   747             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   748
   749         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   750             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   751
   752         16  PI-CR-CONTROL-IN-PROGRESS.
   753             20  PI-CR-CARRIER           PIC X.
   754             20  PI-CR-GROUPING          PIC X(6).
   755             20  PI-CR-STATE             PIC XX.
   756             20  PI-CR-ACCOUNT           PIC X(10).
   757             20  PI-CR-FIN-RESP          PIC X(10).
   758             20  PI-CR-TYPE              PIC X.
   759
   760         16  PI-CR-BATCH-NUMBER          PIC X(6).
   761
   762         16  PI-CR-MONTH-END-DT          PIC XX.
   763
   764         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   765             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   766             88  PI-ZERO-CARRIER             VALUE '1'.
   767             88  PI-ZERO-GROUPING            VALUE '2'.
   768             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   769
   770         16  PI-CARRIER-SECURITY         PIC X.
   771             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   772
   773         16  PI-ACCOUNT-SECURITY         PIC X(10).
   774             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   775             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   776
   777         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   778             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   779                                         INDEXED BY PI-ACCESS-NDX
   780                                         PIC X.
   781
   782         16  PI-GA-BILLING-CONTROL       PIC X.
   783             88  PI-GA-BILLING               VALUE '1'.
   784
   785         16  PI-MAIL-PROCESSING          PIC X.
   786             88  PI-MAIL-YES                 VALUE 'Y'.
   787
   788         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   789
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL162.cbl
   790         16  PI-AR-SYSTEM.
   791             20  PI-AR-PROCESSING-CNTL   PIC X.
   792                 88  PI-AR-PROCESSING        VALUE 'Y'.
   793             20  PI-AR-SUMMARY-CODE      PIC X(6).
   794             20  PI-AR-MONTH-END-DT      PIC XX.
   795
   796         16  PI-MP-SYSTEM.
   797             20  PI-MORTGAGE-USER            PIC X.
   798                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   799                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   800             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   801                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   802                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   803                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   804                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   805                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   806             20  PI-MP-MONTH-END-DT          PIC XX.
   807             20  PI-MP-REFERENCE-NO.
   808                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   809                 24  PI-MP-REFERENCE-SFX     PIC XX.
   810
   811         16  PI-LABEL-CONTROL            PIC X(01).
   812             88  PI-CREATE-LABELS                    VALUE 'Y'.
   813             88  PI-BYPASS-LABELS                    VALUE 'N'.
   814
   815         16  PI-BILL-GROUPING-CODE       PIC X(01).
   816             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   817
   818         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   819             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   820             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   821
   822         16  FILLER                      PIC X(14).
   823
   824     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   825******************************************************************
   826     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   827         16  PI-NEXT-TRLR-SUB    PIC S999  COMP-3.
   828         16  PI-ACTV-SAVE        PIC X(20).
   829         16  PI-ACTV-SAVE-SEQ    PIC S9(04) COMP.
   830         16  PI-ACTV-KEY.
   831           18  PI-ACTV-PARTIAL.
   832             20  PI-ACTV-COMP-CD     PIC X.
   833             20  PI-ACTV-CARRIER     PIC X.
   834             20  PI-ACTV-CLAIM       PIC X(7).
   835             20  PI-ACTV-CERT-NO.
   836                 22  PI-ACTV-CERT-NO-PRIME PIC X(10).
   837                 22  PI-ACTV-CERT-NO-SUFX  PIC X.
   838           18  PI-ACTV-SEQ           PIC S9(4) COMP.
   839
   840         16  PI-DISPLAYED-TRAILER-CODES.
   841             18  PI-TRLRS OCCURS 50 TIMES    PIC S9(4) COMP.
   842         16  PI-CLAM-KEY.
   843             20  PI-CLAM-COMP-CD     PIC X.
   844             20  PI-CLAM-CARRIER     PIC X.
   845             20  PI-CLAM-CLAIM       PIC X(7).
   846             20  PI-CLAM-CERT-NO.
   847                 24  PI-CLAM-CERT-NO-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL162.cbl
   848                 24  PI-CLAM-CERT-NO-SUFX   PIC X.
   849         16  PI-DMD-FORCE-ERROR      PIC X.
   850             88  PI-DMD-FORCED             VALUE 'X'.
   851         16  FILLER                  PIC X(473).
   852
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL162.cbl
   854*                            COPY ELCAID.
   855******************************************************************
   856*                                                                *
   857*                            ELCAID.                             *
   858*                            VMOD=2.001                          *
   859*                                                                *
   860*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   861*                                                                *
   862*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   863*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   864******************************************************************
   865
   866 01  DFHAID.
   867   02  DFHNULL   PIC  X  VALUE  ' '.
   868   02  DFHENTER  PIC  X  VALUE  QUOTE.
   869   02  DFHCLEAR  PIC  X  VALUE  '_'.
   870   02  DFHPEN    PIC  X  VALUE  '='.
   871   02  DFHOPID   PIC  X  VALUE  'W'.
   872   02  DFHPA1    PIC  X  VALUE  '%'.
   873   02  DFHPA2    PIC  X  VALUE  '>'.
   874   02  DFHPA3    PIC  X  VALUE  ','.
   875   02  DFHPF1    PIC  X  VALUE  '1'.
   876   02  DFHPF2    PIC  X  VALUE  '2'.
   877   02  DFHPF3    PIC  X  VALUE  '3'.
   878   02  DFHPF4    PIC  X  VALUE  '4'.
   879   02  DFHPF5    PIC  X  VALUE  '5'.
   880   02  DFHPF6    PIC  X  VALUE  '6'.
   881   02  DFHPF7    PIC  X  VALUE  '7'.
   882   02  DFHPF8    PIC  X  VALUE  '8'.
   883   02  DFHPF9    PIC  X  VALUE  '9'.
   884   02  DFHPF10   PIC  X  VALUE  ':'.
   885   02  DFHPF11   PIC  X  VALUE  '#'.
   886   02  DFHPF12   PIC  X  VALUE  '@'.
   887   02  DFHPF13   PIC  X  VALUE  'A'.
   888   02  DFHPF14   PIC  X  VALUE  'B'.
   889   02  DFHPF15   PIC  X  VALUE  'C'.
   890   02  DFHPF16   PIC  X  VALUE  'D'.
   891   02  DFHPF17   PIC  X  VALUE  'E'.
   892   02  DFHPF18   PIC  X  VALUE  'F'.
   893   02  DFHPF19   PIC  X  VALUE  'G'.
   894   02  DFHPF20   PIC  X  VALUE  'H'.
   895   02  DFHPF21   PIC  X  VALUE  'I'.
   896*00039    02  DFHPF22   PIC  X  VALUE  ''.
   897   02  DFHPF22   PIC  X  VALUE  '['.
   898   02  DFHPF23   PIC  X  VALUE  '.'.
   899   02  DFHPF24   PIC  X  VALUE  '<'.
   900   02  DFHMSRE   PIC  X  VALUE  'X'.
   901   02  DFHSTRF   PIC  X  VALUE  'h'.
   902   02  DFHTRIG   PIC  X  VALUE  '"'.
   903 01  FILLER    REDEFINES DFHAID.
   904     12  FILLER              PIC X(8).
   905     12  PF-VALUES           PIC X       OCCURS 2.
   906
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL162.cbl
   908*                            COPY EL162S.
   909 01  EL162AI.
   910     05  FILLER            PIC  X(0012).
   911*    -------------------------------
   912     05  RUNDTEL PIC S9(0004) COMP.
   913     05  RUNDTEF PIC  X(0001).
   914     05  FILLER REDEFINES RUNDTEF.
   915         10  RUNDTEA PIC  X(0001).
   916     05  RUNDTEI PIC  X(0008).
   917*    -------------------------------
   918     05  RUNTIMEL PIC S9(0004) COMP.
   919     05  RUNTIMEF PIC  X(0001).
   920     05  FILLER REDEFINES RUNTIMEF.
   921         10  RUNTIMEA PIC  X(0001).
   922     05  RUNTIMEI PIC  X(0005).
   923*    -------------------------------
   924     05  CLAIMNOL PIC S9(0004) COMP.
   925     05  CLAIMNOF PIC  X(0001).
   926     05  FILLER REDEFINES CLAIMNOF.
   927         10  CLAIMNOA PIC  X(0001).
   928     05  CLAIMNOI PIC  X(0007).
   929*    -------------------------------
   930     05  TYPEL PIC S9(0004) COMP.
   931     05  TYPEF PIC  X(0001).
   932     05  FILLER REDEFINES TYPEF.
   933         10  TYPEA PIC  X(0001).
   934     05  TYPEI PIC  X(0006).
   935*    -------------------------------
   936     05  CARRL PIC S9(0004) COMP.
   937     05  CARRF PIC  X(0001).
   938     05  FILLER REDEFINES CARRF.
   939         10  CARRA PIC  X(0001).
   940     05  CARRI PIC  X(0001).
   941*    -------------------------------
   942     05  CERTNOL PIC S9(0004) COMP.
   943     05  CERTNOF PIC  X(0001).
   944     05  FILLER REDEFINES CERTNOF.
   945         10  CERTNOA PIC  X(0001).
   946     05  CERTNOI PIC  X(0011).
   947*    -------------------------------
   948     05  LASTNMEL PIC S9(0004) COMP.
   949     05  LASTNMEF PIC  X(0001).
   950     05  FILLER REDEFINES LASTNMEF.
   951         10  LASTNMEA PIC  X(0001).
   952     05  LASTNMEI PIC  X(0015).
   953*    -------------------------------
   954     05  FILEL PIC S9(0004) COMP.
   955     05  FILEF PIC  X(0001).
   956     05  FILLER REDEFINES FILEF.
   957         10  FILEA PIC  X(0001).
   958     05  FILEI PIC  X(0004).
   959*    -------------------------------
   960     05  RECDTE1L PIC S9(0004) COMP.
   961     05  RECDTE1F PIC  X(0001).
   962     05  FILLER REDEFINES RECDTE1F.
   963         10  RECDTE1A PIC  X(0001).
   964     05  RECDTE1I PIC  X(0008).
   965*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL162.cbl
   966     05  STOPDT1L PIC S9(0004) COMP.
   967     05  STOPDT1F PIC  X(0001).
   968     05  FILLER REDEFINES STOPDT1F.
   969         10  STOPDT1A PIC  X(0001).
   970     05  STOPDT1I PIC  X(0008).
   971*    -------------------------------
   972     05  SENT1L PIC S9(0004) COMP.
   973     05  SENT1F PIC  X(0001).
   974     05  FILLER REDEFINES SENT1F.
   975         10  SENT1A PIC  X(0001).
   976     05  SENT1I PIC  X(0008).
   977*    -------------------------------
   978     05  BY1L PIC S9(0004) COMP.
   979     05  BY1F PIC  X(0001).
   980     05  FILLER REDEFINES BY1F.
   981         10  BY1A PIC  X(0001).
   982     05  BY1I PIC  X(0004).
   983*    -------------------------------
   984     05  RESEND1L PIC S9(0004) COMP.
   985     05  RESEND1F PIC  X(0001).
   986     05  FILLER REDEFINES RESEND1F.
   987         10  RESEND1A PIC  X(0001).
   988     05  RESEND1I PIC  X(0008).
   989*    -------------------------------
   990     05  FOLLOW1L PIC S9(0004) COMP.
   991     05  FOLLOW1F PIC  X(0001).
   992     05  FILLER REDEFINES FOLLOW1F.
   993         10  FOLLOW1A PIC  X(0001).
   994     05  FOLLOW1I PIC  X(0008).
   995*    -------------------------------
   996     05  FORM1L PIC S9(0004) COMP.
   997     05  FORM1F PIC  X(0001).
   998     05  FILLER REDEFINES FORM1F.
   999         10  FORM1A PIC  X(0001).
  1000     05  FORM1I PIC  X(0004).
  1001*    -------------------------------
  1002     05  TO1L PIC S9(0004) COMP.
  1003     05  TO1F PIC  X(0001).
  1004     05  FILLER REDEFINES TO1F.
  1005         10  TO1A PIC  X(0001).
  1006     05  TO1I PIC  X(0008).
  1007*    -------------------------------
  1008     05  ARCH1L PIC S9(0004) COMP.
  1009     05  ARCH1F PIC  X(0001).
  1010     05  FILLER REDEFINES ARCH1F.
  1011         10  ARCH1A PIC  X(0001).
  1012     05  ARCH1I PIC  X(0008).
  1013*    -------------------------------
  1014     05  TRLR1L PIC S9(0004) COMP.
  1015     05  TRLR1F PIC  X(0001).
  1016     05  FILLER REDEFINES TRLR1F.
  1017         10  TRLR1A PIC  X(0001).
  1018     05  TRLR1I PIC  X(0004).
  1019*    -------------------------------
  1020     05  TYPE1L PIC S9(0004) COMP.
  1021     05  TYPE1F PIC  X(0001).
  1022     05  FILLER REDEFINES TYPE1F.
  1023         10  TYPE1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL162.cbl
  1024     05  TYPE1I PIC  X(0001).
  1025*    -------------------------------
  1026     05  RE1L PIC S9(0004) COMP.
  1027     05  RE1F PIC  X(0001).
  1028     05  FILLER REDEFINES RE1F.
  1029         10  RE1A PIC  X(0001).
  1030     05  RE1I PIC  X(0070).
  1031*    -------------------------------
  1032     05  RECDTE2L PIC S9(0004) COMP.
  1033     05  RECDTE2F PIC  X(0001).
  1034     05  FILLER REDEFINES RECDTE2F.
  1035         10  RECDTE2A PIC  X(0001).
  1036     05  RECDTE2I PIC  X(0008).
  1037*    -------------------------------
  1038     05  STOPDT2L PIC S9(0004) COMP.
  1039     05  STOPDT2F PIC  X(0001).
  1040     05  FILLER REDEFINES STOPDT2F.
  1041         10  STOPDT2A PIC  X(0001).
  1042     05  STOPDT2I PIC  X(0008).
  1043*    -------------------------------
  1044     05  SENT2L PIC S9(0004) COMP.
  1045     05  SENT2F PIC  X(0001).
  1046     05  FILLER REDEFINES SENT2F.
  1047         10  SENT2A PIC  X(0001).
  1048     05  SENT2I PIC  X(0008).
  1049*    -------------------------------
  1050     05  BY2L PIC S9(0004) COMP.
  1051     05  BY2F PIC  X(0001).
  1052     05  FILLER REDEFINES BY2F.
  1053         10  BY2A PIC  X(0001).
  1054     05  BY2I PIC  X(0004).
  1055*    -------------------------------
  1056     05  RESEND2L PIC S9(0004) COMP.
  1057     05  RESEND2F PIC  X(0001).
  1058     05  FILLER REDEFINES RESEND2F.
  1059         10  RESEND2A PIC  X(0001).
  1060     05  RESEND2I PIC  X(0008).
  1061*    -------------------------------
  1062     05  FOLLOW2L PIC S9(0004) COMP.
  1063     05  FOLLOW2F PIC  X(0001).
  1064     05  FILLER REDEFINES FOLLOW2F.
  1065         10  FOLLOW2A PIC  X(0001).
  1066     05  FOLLOW2I PIC  X(0008).
  1067*    -------------------------------
  1068     05  FORM2L PIC S9(0004) COMP.
  1069     05  FORM2F PIC  X(0001).
  1070     05  FILLER REDEFINES FORM2F.
  1071         10  FORM2A PIC  X(0001).
  1072     05  FORM2I PIC  X(0004).
  1073*    -------------------------------
  1074     05  TO2L PIC S9(0004) COMP.
  1075     05  TO2F PIC  X(0001).
  1076     05  FILLER REDEFINES TO2F.
  1077         10  TO2A PIC  X(0001).
  1078     05  TO2I PIC  X(0008).
  1079*    -------------------------------
  1080     05  ARCH2L PIC S9(0004) COMP.
  1081     05  ARCH2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL162.cbl
  1082     05  FILLER REDEFINES ARCH2F.
  1083         10  ARCH2A PIC  X(0001).
  1084     05  ARCH2I PIC  X(0008).
  1085*    -------------------------------
  1086     05  TRLR2L PIC S9(0004) COMP.
  1087     05  TRLR2F PIC  X(0001).
  1088     05  FILLER REDEFINES TRLR2F.
  1089         10  TRLR2A PIC  X(0001).
  1090     05  TRLR2I PIC  X(0004).
  1091*    -------------------------------
  1092     05  TYPE2L PIC S9(0004) COMP.
  1093     05  TYPE2F PIC  X(0001).
  1094     05  FILLER REDEFINES TYPE2F.
  1095         10  TYPE2A PIC  X(0001).
  1096     05  TYPE2I PIC  X(0001).
  1097*    -------------------------------
  1098     05  RE2L PIC S9(0004) COMP.
  1099     05  RE2F PIC  X(0001).
  1100     05  FILLER REDEFINES RE2F.
  1101         10  RE2A PIC  X(0001).
  1102     05  RE2I PIC  X(0070).
  1103*    -------------------------------
  1104     05  RECDTE3L PIC S9(0004) COMP.
  1105     05  RECDTE3F PIC  X(0001).
  1106     05  FILLER REDEFINES RECDTE3F.
  1107         10  RECDTE3A PIC  X(0001).
  1108     05  RECDTE3I PIC  X(0008).
  1109*    -------------------------------
  1110     05  STOPDT3L PIC S9(0004) COMP.
  1111     05  STOPDT3F PIC  X(0001).
  1112     05  FILLER REDEFINES STOPDT3F.
  1113         10  STOPDT3A PIC  X(0001).
  1114     05  STOPDT3I PIC  X(0008).
  1115*    -------------------------------
  1116     05  SENT3L PIC S9(0004) COMP.
  1117     05  SENT3F PIC  X(0001).
  1118     05  FILLER REDEFINES SENT3F.
  1119         10  SENT3A PIC  X(0001).
  1120     05  SENT3I PIC  X(0008).
  1121*    -------------------------------
  1122     05  BY3L PIC S9(0004) COMP.
  1123     05  BY3F PIC  X(0001).
  1124     05  FILLER REDEFINES BY3F.
  1125         10  BY3A PIC  X(0001).
  1126     05  BY3I PIC  X(0004).
  1127*    -------------------------------
  1128     05  RESEND3L PIC S9(0004) COMP.
  1129     05  RESEND3F PIC  X(0001).
  1130     05  FILLER REDEFINES RESEND3F.
  1131         10  RESEND3A PIC  X(0001).
  1132     05  RESEND3I PIC  X(0008).
  1133*    -------------------------------
  1134     05  FOLLOW3L PIC S9(0004) COMP.
  1135     05  FOLLOW3F PIC  X(0001).
  1136     05  FILLER REDEFINES FOLLOW3F.
  1137         10  FOLLOW3A PIC  X(0001).
  1138     05  FOLLOW3I PIC  X(0008).
  1139*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL162.cbl
  1140     05  FORM3L PIC S9(0004) COMP.
  1141     05  FORM3F PIC  X(0001).
  1142     05  FILLER REDEFINES FORM3F.
  1143         10  FORM3A PIC  X(0001).
  1144     05  FORM3I PIC  X(0004).
  1145*    -------------------------------
  1146     05  TO3L PIC S9(0004) COMP.
  1147     05  TO3F PIC  X(0001).
  1148     05  FILLER REDEFINES TO3F.
  1149         10  TO3A PIC  X(0001).
  1150     05  TO3I PIC  X(0008).
  1151*    -------------------------------
  1152     05  ARCH3L PIC S9(0004) COMP.
  1153     05  ARCH3F PIC  X(0001).
  1154     05  FILLER REDEFINES ARCH3F.
  1155         10  ARCH3A PIC  X(0001).
  1156     05  ARCH3I PIC  X(0008).
  1157*    -------------------------------
  1158     05  TRLR3L PIC S9(0004) COMP.
  1159     05  TRLR3F PIC  X(0001).
  1160     05  FILLER REDEFINES TRLR3F.
  1161         10  TRLR3A PIC  X(0001).
  1162     05  TRLR3I PIC  X(0004).
  1163*    -------------------------------
  1164     05  TYPE3L PIC S9(0004) COMP.
  1165     05  TYPE3F PIC  X(0001).
  1166     05  FILLER REDEFINES TYPE3F.
  1167         10  TYPE3A PIC  X(0001).
  1168     05  TYPE3I PIC  X(0001).
  1169*    -------------------------------
  1170     05  RE3L PIC S9(0004) COMP.
  1171     05  RE3F PIC  X(0001).
  1172     05  FILLER REDEFINES RE3F.
  1173         10  RE3A PIC  X(0001).
  1174     05  RE3I PIC  X(0070).
  1175*    -------------------------------
  1176     05  RECDTE4L PIC S9(0004) COMP.
  1177     05  RECDTE4F PIC  X(0001).
  1178     05  FILLER REDEFINES RECDTE4F.
  1179         10  RECDTE4A PIC  X(0001).
  1180     05  RECDTE4I PIC  X(0008).
  1181*    -------------------------------
  1182     05  STOPDT4L PIC S9(0004) COMP.
  1183     05  STOPDT4F PIC  X(0001).
  1184     05  FILLER REDEFINES STOPDT4F.
  1185         10  STOPDT4A PIC  X(0001).
  1186     05  STOPDT4I PIC  X(0008).
  1187*    -------------------------------
  1188     05  SENT4L PIC S9(0004) COMP.
  1189     05  SENT4F PIC  X(0001).
  1190     05  FILLER REDEFINES SENT4F.
  1191         10  SENT4A PIC  X(0001).
  1192     05  SENT4I PIC  X(0008).
  1193*    -------------------------------
  1194     05  BY4L PIC S9(0004) COMP.
  1195     05  BY4F PIC  X(0001).
  1196     05  FILLER REDEFINES BY4F.
  1197         10  BY4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL162.cbl
  1198     05  BY4I PIC  X(0004).
  1199*    -------------------------------
  1200     05  RESEND4L PIC S9(0004) COMP.
  1201     05  RESEND4F PIC  X(0001).
  1202     05  FILLER REDEFINES RESEND4F.
  1203         10  RESEND4A PIC  X(0001).
  1204     05  RESEND4I PIC  X(0008).
  1205*    -------------------------------
  1206     05  FOLLOW4L PIC S9(0004) COMP.
  1207     05  FOLLOW4F PIC  X(0001).
  1208     05  FILLER REDEFINES FOLLOW4F.
  1209         10  FOLLOW4A PIC  X(0001).
  1210     05  FOLLOW4I PIC  X(0008).
  1211*    -------------------------------
  1212     05  FORM4L PIC S9(0004) COMP.
  1213     05  FORM4F PIC  X(0001).
  1214     05  FILLER REDEFINES FORM4F.
  1215         10  FORM4A PIC  X(0001).
  1216     05  FORM4I PIC  X(0004).
  1217*    -------------------------------
  1218     05  TO4L PIC S9(0004) COMP.
  1219     05  TO4F PIC  X(0001).
  1220     05  FILLER REDEFINES TO4F.
  1221         10  TO4A PIC  X(0001).
  1222     05  TO4I PIC  X(0008).
  1223*    -------------------------------
  1224     05  ARCH4L PIC S9(0004) COMP.
  1225     05  ARCH4F PIC  X(0001).
  1226     05  FILLER REDEFINES ARCH4F.
  1227         10  ARCH4A PIC  X(0001).
  1228     05  ARCH4I PIC  X(0008).
  1229*    -------------------------------
  1230     05  TRLR4L PIC S9(0004) COMP.
  1231     05  TRLR4F PIC  X(0001).
  1232     05  FILLER REDEFINES TRLR4F.
  1233         10  TRLR4A PIC  X(0001).
  1234     05  TRLR4I PIC  X(0004).
  1235*    -------------------------------
  1236     05  TYPE4L PIC S9(0004) COMP.
  1237     05  TYPE4F PIC  X(0001).
  1238     05  FILLER REDEFINES TYPE4F.
  1239         10  TYPE4A PIC  X(0001).
  1240     05  TYPE4I PIC  X(0001).
  1241*    -------------------------------
  1242     05  RE4L PIC S9(0004) COMP.
  1243     05  RE4F PIC  X(0001).
  1244     05  FILLER REDEFINES RE4F.
  1245         10  RE4A PIC  X(0001).
  1246     05  RE4I PIC  X(0070).
  1247*    -------------------------------
  1248     05  URECDTEL PIC S9(0004) COMP.
  1249     05  URECDTEF PIC  X(0001).
  1250     05  FILLER REDEFINES URECDTEF.
  1251         10  URECDTEA PIC  X(0001).
  1252     05  URECDTEI PIC  X(0008).
  1253*    -------------------------------
  1254     05  USENTL PIC S9(0004) COMP.
  1255     05  USENTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL162.cbl
  1256     05  FILLER REDEFINES USENTF.
  1257         10  USENTA PIC  X(0001).
  1258     05  USENTI PIC  X(0008).
  1259*    -------------------------------
  1260     05  UBYL PIC S9(0004) COMP.
  1261     05  UBYF PIC  X(0001).
  1262     05  FILLER REDEFINES UBYF.
  1263         10  UBYA PIC  X(0001).
  1264     05  UBYI PIC  X(0004).
  1265*    -------------------------------
  1266     05  UFORML PIC S9(0004) COMP.
  1267     05  UFORMF PIC  X(0001).
  1268     05  FILLER REDEFINES UFORMF.
  1269         10  UFORMA PIC  X(0001).
  1270     05  UFORMI PIC  X(0004).
  1271*    -------------------------------
  1272     05  UREL PIC S9(0004) COMP.
  1273     05  UREF PIC  X(0001).
  1274     05  FILLER REDEFINES UREF.
  1275         10  UREA PIC  X(0001).
  1276     05  UREI PIC  X(0070).
  1277*    -------------------------------
  1278     05  ADDR1L PIC S9(0004) COMP.
  1279     05  ADDR1F PIC  X(0001).
  1280     05  FILLER REDEFINES ADDR1F.
  1281         10  ADDR1A PIC  X(0001).
  1282     05  ADDR1I PIC  X(0030).
  1283*    -------------------------------
  1284     05  ADDR2L PIC S9(0004) COMP.
  1285     05  ADDR2F PIC  X(0001).
  1286     05  FILLER REDEFINES ADDR2F.
  1287         10  ADDR2A PIC  X(0001).
  1288     05  ADDR2I PIC  X(0030).
  1289*    -------------------------------
  1290     05  ADDR3L PIC S9(0004) COMP.
  1291     05  ADDR3F PIC  X(0001).
  1292     05  FILLER REDEFINES ADDR3F.
  1293         10  ADDR3A PIC  X(0001).
  1294     05  ADDR3I PIC  X(0030).
  1295*    -------------------------------
  1296     05  ADDR4L PIC S9(0004) COMP.
  1297     05  ADDR4F PIC  X(0001).
  1298     05  FILLER REDEFINES ADDR4F.
  1299         10  ADDR4A PIC  X(0001).
  1300     05  ADDR4I PIC  X(0030).
  1301*    -------------------------------
  1302     05  ZIPL PIC S9(0004) COMP.
  1303     05  ZIPF PIC  X(0001).
  1304     05  FILLER REDEFINES ZIPF.
  1305         10  ZIPA PIC  X(0001).
  1306     05  ZIPI PIC  X(0010).
  1307*    -------------------------------
  1308     05  PHONEL PIC S9(0004) COMP.
  1309     05  PHONEF PIC  X(0001).
  1310     05  FILLER REDEFINES PHONEF.
  1311         10  PHONEA PIC  X(0001).
  1312     05  PHONEI PIC  X(0012).
  1313*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL162.cbl
  1314     05  TRLRL PIC S9(0004) COMP.
  1315     05  TRLRF PIC  X(0001).
  1316     05  FILLER REDEFINES TRLRF.
  1317         10  TRLRA PIC  X(0001).
  1318     05  TRLRI PIC  X(0004).
  1319*    -------------------------------
  1320     05  ERRMSG1L PIC S9(0004) COMP.
  1321     05  ERRMSG1F PIC  X(0001).
  1322     05  FILLER REDEFINES ERRMSG1F.
  1323         10  ERRMSG1A PIC  X(0001).
  1324     05  ERRMSG1I PIC  X(0072).
  1325*    -------------------------------
  1326     05  ENTERPFL PIC S9(0004) COMP.
  1327     05  ENTERPFF PIC  X(0001).
  1328     05  FILLER REDEFINES ENTERPFF.
  1329         10  ENTERPFA PIC  X(0001).
  1330     05  ENTERPFI PIC  99.
  1331*    -------------------------------
  1332     05  PF4KEYL PIC S9(0004) COMP.
  1333     05  PF4KEYF PIC  X(0001).
  1334     05  FILLER REDEFINES PF4KEYF.
  1335         10  PF4KEYA PIC  X(0001).
  1336     05  PF4KEYI PIC  X(0015).
  1337*    -------------------------------
  1338     05  PF5KEYL PIC S9(0004) COMP.
  1339     05  PF5KEYF PIC  X(0001).
  1340     05  FILLER REDEFINES PF5KEYF.
  1341         10  PF5KEYA PIC  X(0001).
  1342     05  PF5KEYI PIC  X(0014).
  1343 01  EL162AO REDEFINES EL162AI.
  1344     05  FILLER            PIC  X(0012).
  1345*    -------------------------------
  1346     05  FILLER            PIC  X(0003).
  1347     05  RUNDTEO PIC  X(0008).
  1348*    -------------------------------
  1349     05  FILLER            PIC  X(0003).
  1350     05  RUNTIMEO PIC  99.99.
  1351*    -------------------------------
  1352     05  FILLER            PIC  X(0003).
  1353     05  CLAIMNOO PIC  X(0007).
  1354*    -------------------------------
  1355     05  FILLER            PIC  X(0003).
  1356     05  TYPEO PIC  X(0006).
  1357*    -------------------------------
  1358     05  FILLER            PIC  X(0003).
  1359     05  CARRO PIC  X(0001).
  1360*    -------------------------------
  1361     05  FILLER            PIC  X(0003).
  1362     05  CERTNOO PIC  X(0011).
  1363*    -------------------------------
  1364     05  FILLER            PIC  X(0003).
  1365     05  LASTNMEO PIC  X(0015).
  1366*    -------------------------------
  1367     05  FILLER            PIC  X(0003).
  1368     05  FILEO PIC  X(0004).
  1369*    -------------------------------
  1370     05  FILLER            PIC  X(0003).
  1371     05  RECDTE1O PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL162.cbl
  1372*    -------------------------------
  1373     05  FILLER            PIC  X(0003).
  1374     05  STOPDT1O PIC  X(0008).
  1375*    -------------------------------
  1376     05  FILLER            PIC  X(0003).
  1377     05  SENT1O PIC  X(0008).
  1378*    -------------------------------
  1379     05  FILLER            PIC  X(0003).
  1380     05  BY1O PIC  X(0004).
  1381*    -------------------------------
  1382     05  FILLER            PIC  X(0003).
  1383     05  RESEND1O PIC  X(0008).
  1384*    -------------------------------
  1385     05  FILLER            PIC  X(0003).
  1386     05  FOLLOW1O PIC  X(0008).
  1387*    -------------------------------
  1388     05  FILLER            PIC  X(0003).
  1389     05  FORM1O PIC  X(0004).
  1390*    -------------------------------
  1391     05  FILLER            PIC  X(0003).
  1392     05  TO1O PIC  X(0008).
  1393*    -------------------------------
  1394     05  FILLER            PIC  X(0003).
  1395     05  ARCH1O PIC  X(0008).
  1396*    -------------------------------
  1397     05  FILLER            PIC  X(0003).
  1398     05  TRLR1O PIC  9999.
  1399*    -------------------------------
  1400     05  FILLER            PIC  X(0003).
  1401     05  TYPE1O PIC  X(0001).
  1402*    -------------------------------
  1403     05  FILLER            PIC  X(0003).
  1404     05  RE1O PIC  X(0070).
  1405*    -------------------------------
  1406     05  FILLER            PIC  X(0003).
  1407     05  RECDTE2O PIC  X(0008).
  1408*    -------------------------------
  1409     05  FILLER            PIC  X(0003).
  1410     05  STOPDT2O PIC  X(0008).
  1411*    -------------------------------
  1412     05  FILLER            PIC  X(0003).
  1413     05  SENT2O PIC  X(0008).
  1414*    -------------------------------
  1415     05  FILLER            PIC  X(0003).
  1416     05  BY2O PIC  X(0004).
  1417*    -------------------------------
  1418     05  FILLER            PIC  X(0003).
  1419     05  RESEND2O PIC  X(0008).
  1420*    -------------------------------
  1421     05  FILLER            PIC  X(0003).
  1422     05  FOLLOW2O PIC  X(0008).
  1423*    -------------------------------
  1424     05  FILLER            PIC  X(0003).
  1425     05  FORM2O PIC  X(0004).
  1426*    -------------------------------
  1427     05  FILLER            PIC  X(0003).
  1428     05  TO2O PIC  X(0008).
  1429*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL162.cbl
  1430     05  FILLER            PIC  X(0003).
  1431     05  ARCH2O PIC  X(0008).
  1432*    -------------------------------
  1433     05  FILLER            PIC  X(0003).
  1434     05  TRLR2O PIC  9999.
  1435*    -------------------------------
  1436     05  FILLER            PIC  X(0003).
  1437     05  TYPE2O PIC  X(0001).
  1438*    -------------------------------
  1439     05  FILLER            PIC  X(0003).
  1440     05  RE2O PIC  X(0070).
  1441*    -------------------------------
  1442     05  FILLER            PIC  X(0003).
  1443     05  RECDTE3O PIC  X(0008).
  1444*    -------------------------------
  1445     05  FILLER            PIC  X(0003).
  1446     05  STOPDT3O PIC  X(0008).
  1447*    -------------------------------
  1448     05  FILLER            PIC  X(0003).
  1449     05  SENT3O PIC  X(0008).
  1450*    -------------------------------
  1451     05  FILLER            PIC  X(0003).
  1452     05  BY3O PIC  X(0004).
  1453*    -------------------------------
  1454     05  FILLER            PIC  X(0003).
  1455     05  RESEND3O PIC  X(0008).
  1456*    -------------------------------
  1457     05  FILLER            PIC  X(0003).
  1458     05  FOLLOW3O PIC  X(0008).
  1459*    -------------------------------
  1460     05  FILLER            PIC  X(0003).
  1461     05  FORM3O PIC  X(0004).
  1462*    -------------------------------
  1463     05  FILLER            PIC  X(0003).
  1464     05  TO3O PIC  X(0008).
  1465*    -------------------------------
  1466     05  FILLER            PIC  X(0003).
  1467     05  ARCH3O PIC  X(0008).
  1468*    -------------------------------
  1469     05  FILLER            PIC  X(0003).
  1470     05  TRLR3O PIC  9999.
  1471*    -------------------------------
  1472     05  FILLER            PIC  X(0003).
  1473     05  TYPE3O PIC  X(0001).
  1474*    -------------------------------
  1475     05  FILLER            PIC  X(0003).
  1476     05  RE3O PIC  X(0070).
  1477*    -------------------------------
  1478     05  FILLER            PIC  X(0003).
  1479     05  RECDTE4O PIC  X(0008).
  1480*    -------------------------------
  1481     05  FILLER            PIC  X(0003).
  1482     05  STOPDT4O PIC  X(0008).
  1483*    -------------------------------
  1484     05  FILLER            PIC  X(0003).
  1485     05  SENT4O PIC  X(0008).
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL162.cbl
  1488     05  BY4O PIC  X(0004).
  1489*    -------------------------------
  1490     05  FILLER            PIC  X(0003).
  1491     05  RESEND4O PIC  X(0008).
  1492*    -------------------------------
  1493     05  FILLER            PIC  X(0003).
  1494     05  FOLLOW4O PIC  X(0008).
  1495*    -------------------------------
  1496     05  FILLER            PIC  X(0003).
  1497     05  FORM4O PIC  X(0004).
  1498*    -------------------------------
  1499     05  FILLER            PIC  X(0003).
  1500     05  TO4O PIC  X(0008).
  1501*    -------------------------------
  1502     05  FILLER            PIC  X(0003).
  1503     05  ARCH4O PIC  X(0008).
  1504*    -------------------------------
  1505     05  FILLER            PIC  X(0003).
  1506     05  TRLR4O PIC  9999.
  1507*    -------------------------------
  1508     05  FILLER            PIC  X(0003).
  1509     05  TYPE4O PIC  X(0001).
  1510*    -------------------------------
  1511     05  FILLER            PIC  X(0003).
  1512     05  RE4O PIC  X(0070).
  1513*    -------------------------------
  1514     05  FILLER            PIC  X(0003).
  1515     05  URECDTEO PIC  99B99B99.
  1516*    -------------------------------
  1517     05  FILLER            PIC  X(0003).
  1518     05  USENTO PIC  99B99B99.
  1519*    -------------------------------
  1520     05  FILLER            PIC  X(0003).
  1521     05  UBYO PIC  X(0004).
  1522*    -------------------------------
  1523     05  FILLER            PIC  X(0003).
  1524     05  UFORMO PIC  X(0004).
  1525*    -------------------------------
  1526     05  FILLER            PIC  X(0003).
  1527     05  UREO PIC  X(0070).
  1528*    -------------------------------
  1529     05  FILLER            PIC  X(0003).
  1530     05  ADDR1O PIC  X(0030).
  1531*    -------------------------------
  1532     05  FILLER            PIC  X(0003).
  1533     05  ADDR2O PIC  X(0030).
  1534*    -------------------------------
  1535     05  FILLER            PIC  X(0003).
  1536     05  ADDR3O PIC  X(0030).
  1537*    -------------------------------
  1538     05  FILLER            PIC  X(0003).
  1539     05  ADDR4O PIC  X(0030).
  1540*    -------------------------------
  1541     05  FILLER            PIC  X(0003).
  1542     05  ZIPO PIC  X(0010).
  1543*    -------------------------------
  1544     05  FILLER            PIC  X(0003).
  1545     05  PHONEO PIC  999B999B9999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL162.cbl
  1546*    -------------------------------
  1547     05  FILLER            PIC  X(0003).
  1548     05  TRLRO PIC  9999.
  1549*    -------------------------------
  1550     05  FILLER            PIC  X(0003).
  1551     05  ERRMSG1O PIC  X(0072).
  1552*    -------------------------------
  1553     05  FILLER            PIC  X(0003).
  1554     05  ENTERPFO PIC  X(0002).
  1555*    -------------------------------
  1556     05  FILLER            PIC  X(0003).
  1557     05  PF4KEYO PIC  X(0015).
  1558*    -------------------------------
  1559     05  FILLER            PIC  X(0003).
  1560     05  PF5KEYO PIC  X(0014).
  1561*    -------------------------------
  1562
  1563 01  MAP-REDEF REDEFINES EL162AI.
  1564     12  FILLER              PIC X(93).
  1565     12  TRL-LINES.
  1566       14  TRAILER-LINES  OCCURS 4 TIMES INDEXED BY SC-INDX.
  1567         16  SC-RECL         PIC S9(4)  COMP.
  1568         16  SC-RECA         PIC X.
  1569         16  SC-REC          PIC X(8).
  1570         16  SC-REC-O REDEFINES SC-REC PIC 99B99B99.
  1571         16  SC-STOPL        PIC S9(4)  COMP.
  1572         16  SC-STOPA        PIC X.
  1573         16  SC-STOP         PIC X(8).
  1574         16  SC-STOP-O REDEFINES SC-STOP PIC 99B99B99.
  1575         16  FILLER          PIC X(3).
  1576         16  SC-SENT         PIC X(8).
  1577         16  FILLER          PIC X(3).
  1578         16  SC-BY           PIC X(4).
  1579         16  FILLER          PIC X(3).
  1580         16  SC-RESEND       PIC X(8).
  1581         16  FILLER          PIC X(3).
  1582         16  SC-FOLLOWUP     PIC X(8).
  1583         16  FILLER          PIC X(3).
  1584         16  SC-FORM         PIC X(4).
  1585         16  FILLER          PIC X(3).
  1586         16  SC-TO           PIC X(8).
  1587         16  FILLER          PIC X(3).
  1588         16  SC-ARCHIVE      PIC X(8).
  1589         16  FILLER          PIC X(3).
  1590         16  SC-TRLRNO       PIC 9(4).
  1591         16  FILLER          PIC X(3).
  1592         16  SC-TYPE         PIC X.
  1593         16  FILLER          PIC X(3).
  1594         16  SC-REASON       PIC X(70).
  1595
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL162.cbl
  1597****************************************************************
  1598*
  1599* Copyright (c) 2007 by Clerity Solutions, Inc.
  1600* All rights reserved.
  1601*
  1602****************************************************************
  1603 01  DFHEIV.
  1604   02  DFHEIV0               PIC X(35).
  1605   02  DFHEIV1               PIC X(08).
  1606   02  DFHEIV2               PIC X(08).
  1607   02  DFHEIV3               PIC X(08).
  1608   02  DFHEIV4               PIC X(06).
  1609   02  DFHEIV5               PIC X(04).
  1610   02  DFHEIV6               PIC X(04).
  1611   02  DFHEIV7               PIC X(02).
  1612   02  DFHEIV8               PIC X(02).
  1613   02  DFHEIV9               PIC X(01).
  1614   02  DFHEIV10              PIC S9(7) COMP-3.
  1615   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1616   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1617   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1618   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1619   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1620   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1621   02  DFHEIV17              PIC X(04).
  1622   02  DFHEIV18              PIC X(04).
  1623   02  DFHEIV19              PIC X(04).
  1624   02  DFHEIV20              USAGE IS POINTER.
  1625   02  DFHEIV21              USAGE IS POINTER.
  1626   02  DFHEIV22              USAGE IS POINTER.
  1627   02  DFHEIV23              USAGE IS POINTER.
  1628   02  DFHEIV24              USAGE IS POINTER.
  1629   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1630   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1631   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1632   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1633   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1634   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1635   02  FILLER                PIC X(02).
  1636   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1637   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1638   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1639   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1640   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1641 LINKAGE  SECTION.
  1642*****************************************************************
  1643*                                                               *
  1644* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1645* All rights reserved.                                          *
  1646*                                                               *
  1647*****************************************************************
  1648 01  dfheiblk.
  1649     02  eibtime          pic s9(7) comp-3.
  1650     02  eibdate          pic s9(7) comp-3.
  1651     02  eibtrnid         pic x(4).
  1652     02  eibtaskn         pic s9(7) comp-3.
  1653     02  eibtrmid         pic x(4).
  1654     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL162.cbl
  1655     02  eibcposn         pic s9(4) comp.
  1656     02  eibcalen         pic s9(4) comp.
  1657     02  eibaid           pic x(1).
  1658     02  eibfiller1       pic x(1).
  1659     02  eibfn            pic x(2).
  1660     02  eibfiller2       pic x(2).
  1661     02  eibrcode         pic x(6).
  1662     02  eibfiller3       pic x(2).
  1663     02  eibds            pic x(8).
  1664     02  eibreqid         pic x(8).
  1665     02  eibrsrce         pic x(8).
  1666     02  eibsync          pic x(1).
  1667     02  eibfree          pic x(1).
  1668     02  eibrecv          pic x(1).
  1669     02  eibsend          pic x(1).
  1670     02  eibatt           pic x(1).
  1671     02  eibeoc           pic x(1).
  1672     02  eibfmh           pic x(1).
  1673     02  eibcompl         pic x(1).
  1674     02  eibsig           pic x(1).
  1675     02  eibconf          pic x(1).
  1676     02  eiberr           pic x(1).
  1677     02  eibrldbk         pic x(1).
  1678     02  eiberrcd         pic x(4).
  1679     02  eibsynrb         pic x(1).
  1680     02  eibnodat         pic x(1).
  1681     02  eibfiller5       pic x(2).
  1682     02  eibresp          pic 9(09) comp.
  1683     02  eibresp2         pic 9(09) comp.
  1684     02  dfheigdj         pic s9(4) comp.
  1685     02  dfheigdk         pic s9(4) comp.
  1686
  1687 01  DFHCOMMAREA             PIC X(1024).
  1688
  1689*01 PARMLIST .
  1690*    02  FILLER              PIC S9(8)   COMP.
  1691*    02  CLAM-POINTER        PIC S9(8)   COMP.
  1692*    02  ACTV-POINTER        PIC S9(8)   COMP.
  1693*    02  ACCT-POINTER        PIC S9(8)   COMP.
  1694
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL162.cbl
  1696*                            COPY ELCMSTR.
  1697******************************************************************
  1698*                                                                *
  1699*                            ELCMSTR.                            *
  1700*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1701*                            VMOD=2.012                          *
  1702*                                                                *
  1703*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1704*                                                                *
  1705*   FILE TYPE = VSAM,KSDS                                        *
  1706*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1707*                                                                *
  1708*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1709*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1710*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1711*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1712*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1713*                                                 RKP=75,LEN=21  *
  1714*                                                                *
  1715*   **** NOTE ****                                               *
  1716*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1717*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1718*                                                                *
  1719*   LOG = YES                                                    *
  1720*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1721******************************************************************
  1722*                   C H A N G E   L O G
  1723*
  1724* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1725*-----------------------------------------------------------------
  1726*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1727* EFFECTIVE    NUMBER
  1728*-----------------------------------------------------------------
  1729* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1730* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1731******************************************************************
  1732 01  CLAIM-MASTER.
  1733     12  CL-RECORD-ID                PIC XX.
  1734         88  VALID-CL-ID         VALUE 'CL'.
  1735
  1736     12  CL-CONTROL-PRIMARY.
  1737         16  CL-COMPANY-CD           PIC X.
  1738         16  CL-CARRIER              PIC X.
  1739         16  CL-CLAIM-NO             PIC X(7).
  1740         16  CL-CERT-NO.
  1741             20  CL-CERT-PRIME       PIC X(10).
  1742             20  CL-CERT-SFX         PIC X.
  1743
  1744     12  CL-CONTROL-BY-NAME.
  1745         16  CL-COMPANY-CD-A1        PIC X.
  1746         16  CL-INSURED-LAST-NAME    PIC X(15).
  1747         16  CL-INSURED-NAME.
  1748             20  CL-INSURED-1ST-NAME PIC X(12).
  1749             20  CL-INSURED-MID-INIT PIC X.
  1750
  1751     12  CL-CONTROL-BY-SSN.
  1752         16  CL-COMPANY-CD-A2        PIC X.
  1753         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL162.cbl
  1754             20  CL-SSN-STATE        PIC XX.
  1755             20  CL-SSN-ACCOUNT      PIC X(6).
  1756             20  CL-SSN-LN3          PIC X(3).
  1757
  1758     12  CL-CONTROL-BY-CERT-NO.
  1759         16  CL-COMPANY-CD-A4        PIC X.
  1760         16  CL-CERT-NO-A4.
  1761             20  CL-CERT-A4-PRIME    PIC X(10).
  1762             20  CL-CERT-A4-SFX      PIC X.
  1763
  1764     12  CL-CONTROL-BY-CCN.
  1765         16  CL-COMPANY-CD-A5        PIC X.
  1766         16  CL-CCN-A5.
  1767             20  CL-CCN.
  1768                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1769                 24  CL-CCN-PRIME-A5 PIC X(12).
  1770             20  CL-CCN-FILLER-A5    PIC X(4).
  1771
  1772     12  CL-INSURED-PROFILE-DATA.
  1773         16  CL-INSURED-BIRTH-DT     PIC XX.
  1774         16  CL-INSURED-SEX-CD       PIC X.
  1775             88  INSURED-IS-MALE        VALUE 'M'.
  1776             88  INSURED-IS-FEMALE      VALUE 'F'.
  1777             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1778         16  CL-INSURED-OCC-CD       PIC X(6).
  1779         16  FILLER                  PIC X(5).
  1780
  1781     12  CL-PROCESSING-INFO.
  1782         16  CL-PROCESSOR-ID         PIC X(4).
  1783         16  CL-CLAIM-STATUS         PIC X.
  1784             88  CLAIM-IS-OPEN          VALUE 'O'.
  1785             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1786         16  CL-CLAIM-TYPE           PIC X.
  1787*            88  AH-CLAIM               VALUE 'A'.
  1788*            88  LIFE-CLAIM             VALUE 'L'.
  1789*            88  PROPERTY-CLAIM         VALUE 'P'.
  1790*            88  IUI-CLAIM              VALUE 'I'.
  1791*            88  GAP-CLAIM              VALUE 'G'.
  1792         16  CL-CLAIM-PREM-TYPE      PIC X.
  1793             88  SINGLE-PREMIUM         VALUE '1'.
  1794             88  O-B-COVERAGE           VALUE '2'.
  1795             88  OPEN-END-COVERAGE      VALUE '3'.
  1796         16  CL-INCURRED-DT          PIC XX.
  1797         16  CL-REPORTED-DT          PIC XX.
  1798         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1799         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1800         16  CL-LAST-PMT-DT          PIC XX.
  1801         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1802         16  CL-PAID-THRU-DT         PIC XX.
  1803         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1804         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1805         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1806         16  CL-PMT-CALC-METHOD      PIC X.
  1807             88  CL-360-DAY-YR          VALUE '1'.
  1808             88  CL-365-DAY-YR          VALUE '2'.
  1809             88  CL-FULL-MONTHS         VALUE '3'.
  1810         16  CL-CAUSE-CD             PIC X(6).
  1811
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL162.cbl
  1812         16  CL-PRIME-CERT-NO.
  1813             20  CL-PRIME-CERT-PRIME PIC X(10).
  1814             20  CL-PRIME-CERT-SFX   PIC X.
  1815
  1816         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1817             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1818             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1819
  1820         16  CL-MICROFILM-NO         PIC X(10).
  1821         16  CL-PROG-FORM-TYPE       PIC X.
  1822         16  CL-LAST-ADD-ON-DT       PIC XX.
  1823
  1824         16  CL-LAST-REOPEN-DT       PIC XX.
  1825         16  CL-LAST-CLOSE-DT        PIC XX.
  1826         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1827             88  FINAL-PAID             VALUE '1'.
  1828             88  CLAIM-DENIED           VALUE '2'.
  1829             88  AUTO-CLOSE             VALUE '3'.
  1830             88  MANUAL-CLOSE           VALUE '4'.
  1831             88  BENEFITS-CHANGED       VALUE 'C'.
  1832             88  SETUP-ERRORS           VALUE 'E'.
  1833         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1834         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1835         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1836             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1837         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1838         16  FILLER                  PIC X.
  1839
  1840     12  CL-CERTIFICATE-DATA.
  1841         16  CL-CERT-ORIGIN          PIC X.
  1842             88  CERT-WAS-ONLINE        VALUE '1'.
  1843             88  CERT-WAS-CREATED       VALUE '2'.
  1844             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1845         16  CL-CERT-KEY-DATA.
  1846             20  CL-CERT-CARRIER     PIC X.
  1847             20  CL-CERT-GROUPING    PIC X(6).
  1848             20  CL-CERT-STATE       PIC XX.
  1849             20  CL-CERT-ACCOUNT.
  1850                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1851                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1852             20  CL-CERT-EFF-DT      PIC XX.
  1853
  1854     12  CL-STATUS-CONTROLS.
  1855         16  CL-PRIORITY-CD          PIC X.
  1856             88  CONFIDENTIAL-DATA      VALUE '8'.
  1857             88  HIGHEST-PRIORITY       VALUE '9'.
  1858         16  CL-SUPV-ATTN-CD         PIC X.
  1859             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1860             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1861         16  CL-PURGED-DT            PIC XX.
  1862         16  CL-RESTORED-DT          PIC XX.
  1863         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1864         16  CL-NEXT-RESEND-DT       PIC XX.
  1865         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1866         16  FILLER                  PIC XX.
  1867         16  CL-LAST-MAINT-DT        PIC XX.
  1868         16  CL-LAST-MAINT-USER      PIC X(4).
  1869         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL162.cbl
  1870         16  CL-LAST-MAINT-TYPE      PIC X.
  1871             88  CLAIM-SET-UP           VALUE ' '.
  1872             88  PAYMENT-MADE           VALUE '1'.
  1873             88  LETTER-SENT            VALUE '2'.
  1874             88  MASTER-WAS-ALTERED     VALUE '3'.
  1875             88  MASTER-WAS-RESTORED    VALUE '4'.
  1876             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1877             88  FILE-CONVERTED         VALUE '6'.
  1878             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1879             88  ERROR-CORRECTION       VALUE 'E'.
  1880         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1881         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1882         16  CL-BENEFICIARY          PIC X(10).
  1883         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1884         16  CL-DENIAL-TYPE          PIC X.
  1885             88  CL-TYPE-DENIAL          VALUE '1'.
  1886             88  CL-TYPE-RESCISSION      VALUE '2'.
  1887             88  CL-TYPE-REFORMATION     VALUE '3'.
  1888             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1889             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1890         16  FILLER                  PIC X(5).
  1891
  1892     12  CL-TRAILER-CONTROLS.
  1893         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1894             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1895             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1896             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1897         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1898         16  FILLER                  PIC XX.
  1899         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1900         16  CL-ADDRESS-TRAILER-CNT.
  1901             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1902                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1903             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1904                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1905             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1906                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1907             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1908                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1909             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1910                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1911             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1912                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  1913             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1914                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1915
  1916     12  CL-CV-REFERENCE-NO.
  1917         16  CL-CV-REFNO-PRIME       PIC X(18).
  1918         16  CL-CV-REFNO-SFX         PIC XX.
  1919
  1920     12  CL-FILE-LOCATION            PIC X(4).
  1921
  1922     12  CL-PROCESS-ERRORS.
  1923         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1924             88  NO-FATAL-ERRORS        VALUE ZERO.
  1925         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1926             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1927
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL162.cbl
  1928     12  CL-PRODUCT-CD               PIC X.
  1929
  1930     12  CL-CURRENT-KEY-DATA.
  1931         16  CL-CURRENT-CARRIER      PIC X.
  1932         16  CL-CURRENT-GROUPING     PIC X(6).
  1933         16  CL-CURRENT-STATE        PIC XX.
  1934         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1935
  1936     12  CL-ASSOCIATES               PIC X.
  1937         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1938         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1939         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1940         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1941
  1942     12  CL-ACTIVITY-CODE            PIC 99.
  1943     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1944     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1945
  1946     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1947     12  CL-LAG-REPORT-CODE          PIC 9.
  1948     12  CL-LOAN-TYPE                PIC XX.
  1949     12  CL-LEGAL-STATE              PIC XX.
  1950
  1951*    12  FILLER                      PIC X(5).
  1952     12  CL-YESNOSW                  PIC X.
  1953     12  FILLER                      PIC X(4).
  1954
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL162.cbl
  1956*                            COPY ELCTRLR.
  1957******************************************************************
  1958*                                                                *
  1959*                            ELCTRLR.                            *
  1960*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1961*                            VMOD=2.014                          *
  1962*                                                                *
  1963*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  1964*                                                                *
  1965*   FILE TYPE = VSAM,KSDS                                        *
  1966*   RECORD SIZE = 200    RECFORM = FIXED                         *
  1967*                                                                *
  1968*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  1969*       ALTERNATE INDEX = NONE                                   *
  1970*                                                                *
  1971*   LOG = YES                                                    *
  1972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1973******************************************************************
  1974*                   C H A N G E   L O G
  1975*
  1976* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1977*-----------------------------------------------------------------
  1978*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1979* EFFECTIVE    NUMBER
  1980*-----------------------------------------------------------------
  1981* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1982* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  1983* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  1984* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  1985* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  1986* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  1987* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  1988* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  1989* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  1990* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  1991* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  1992* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  1993******************************************************************
  1994 01  ACTIVITY-TRAILERS.
  1995     12  AT-RECORD-ID                    PIC XX.
  1996         88  VALID-AT-ID                       VALUE 'AT'.
  1997
  1998     12  AT-CONTROL-PRIMARY.
  1999         16  AT-COMPANY-CD               PIC X.
  2000         16  AT-CARRIER                  PIC X.
  2001         16  AT-CLAIM-NO                 PIC X(7).
  2002         16  AT-CERT-NO.
  2003             20  AT-CERT-PRIME           PIC X(10).
  2004             20  AT-CERT-SFX             PIC X.
  2005         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  2006             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  2007             88  AT-LAST-TRL-AVAIL            VALUE +100.
  2008             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  2009             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  2010             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  2011             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  2012             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  2013             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL162.cbl
  2014             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  2015             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  2016             88  AT-DIAGNOSIS-TRL             VALUE +90.
  2017             88  AT-BENEFICIARY-TRL           VALUE +91.
  2018             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  2019
  2020     12  AT-TRAILER-TYPE                 PIC X.
  2021         88  RESERVE-EXPENSE-TR               VALUE '1'.
  2022         88  PAYMENT-TR                       VALUE '2'.
  2023         88  AUTO-PAY-TR                      VALUE '3'.
  2024         88  CORRESPONDENCE-TR                VALUE '4'.
  2025         88  ADDRESS-TR                       VALUE '5'.
  2026         88  GENERAL-INFO-TR                  VALUE '6'.
  2027         88  AUTO-PROMPT-TR                   VALUE '7'.
  2028         88  DENIAL-TR                        VALUE '8'.
  2029         88  INCURRED-CHG-TR                  VALUE '9'.
  2030         88  FORM-CONTROL-TR                  VALUE 'A'.
  2031
  2032     12  AT-RECORDED-DT                  PIC XX.
  2033     12  AT-RECORDED-BY                  PIC X(4).
  2034     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  2035
  2036     12  AT-TRAILER-BODY                 PIC X(165).
  2037
  2038     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  2039         16  AT-RESERVE-CONTROLS.
  2040             20  AT-MANUAL-SW            PIC X.
  2041                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  2042             20  AT-FUTURE-SW            PIC X.
  2043                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  2044             20  AT-PTC-SW               PIC X.
  2045                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  2046             20  AT-IBNR-SW              PIC X.
  2047                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  2048             20  AT-PTC-LF-SW            PIC X.
  2049                 88  AT-LF-PTC-USED          VALUE '1'.
  2050             20  AT-CDT-ACCESS-METHOD    PIC X.
  2051                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  2052                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  2053                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  2054             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  2055         16  AT-LAST-COMPUTED-DT         PIC XX.
  2056         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  2057         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  2058         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  2059         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  2060         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  2061         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  2062         16  AT-EXPENSE-CONTROLS.
  2063             20  AT-EXPENSE-METHOD       PIC X.
  2064                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  2065                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  2066                 88  PERCENT-OF-PMT           VALUE '3'.
  2067                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  2068             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  2069             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  2070         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  2071         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL162.cbl
  2072
  2073         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  2074         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  2075
  2076*        16  FILLER                      PIC X(53).
  2077         16  FILLER                      PIC X(47).
  2078
  2079         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  2080         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  2081
  2082         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  2083             20  AT-OPEN-CLOSE-DATE      PIC XX.
  2084             20  AT-OPEN-CLOSE-TYPE      PIC X.
  2085*                    C = CLOSED
  2086*                    O = OPEN
  2087             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  2088*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  2089
  2090     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  2091         16  AT-PAYMENT-TYPE             PIC X.
  2092             88  PARTIAL-PAYMENT                VALUE '1'.
  2093             88  FINAL-PAYMENT                  VALUE '2'.
  2094             88  LUMP-SUM-PAYMENT               VALUE '3'.
  2095             88  ADDITIONAL-PAYMENT             VALUE '4'.
  2096             88  CHARGEABLE-EXPENSE             VALUE '5'.
  2097             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  2098             88  VOIDED-PAYMENT                 VALUE '9'.
  2099             88  TRANSFER                       VALUE 'T'.
  2100             88  LIFE-INTEREST                  VALUE 'I'.
  2101
  2102         16  AT-CLAIM-TYPE               PIC X.
  2103             88  PAID-FOR-AH                    VALUE 'A'.
  2104             88  PAID-FOR-LIFE                  VALUE 'L'.
  2105             88  PAID-FOR-IUI                   VALUE 'I'.
  2106             88  PAID-FOR-GAP                   VALUE 'G'.
  2107         16  AT-CLAIM-PREM-TYPE          PIC X.
  2108             88  AT-SINGLE-PREMIUM              VALUE '1'.
  2109             88  AT-O-B-COVERAGE                VALUE '2'.
  2110             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  2111         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  2112         16  AT-CHECK-NO                 PIC X(7).
  2113         16  AT-PAID-FROM-DT             PIC XX.
  2114         16  AT-PAID-THRU-DT             PIC XX.
  2115         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  2116         16  FILLER                      PIC X.
  2117         16  AT-PAYEES-NAME              PIC X(30).
  2118         16  AT-PAYMENT-ORIGIN           PIC X.
  2119             88  ONLINE-MANUAL-PMT              VALUE '1'.
  2120             88  ONLINE-AUTO-PMT                VALUE '2'.
  2121             88  OFFLINE-PMT                    VALUE '3'.
  2122         16  AT-CHECK-WRITTEN-DT         PIC XX.
  2123         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  2124         16  AT-VOID-DATA.
  2125             20  AT-VOID-DT              PIC XX.
  2126*00144       20  AT-VOID-REASON          PIC X(30).
  2127             20  AT-VOID-REASON          PIC X(26).
  2128         16  AT-PMT-APPROVED-BY          PIC X(04).
  2129         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL162.cbl
  2130         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  2131         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  2132                                         PIC S99V9(5)  COMP-3.
  2133         16  AT-CREDIT-INTERFACE.
  2134             20  AT-PMT-SELECT-DT        PIC XX.
  2135                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  2136             20  AT-PMT-ACCEPT-DT        PIC XX.
  2137                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  2138             20  AT-VOID-SELECT-DT       PIC XX.
  2139                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  2140             20  AT-VOID-ACCEPT-DT       PIC XX.
  2141                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  2142
  2143         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  2144                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  2145                 88  CONVERSION-PAYMENT           VALUE +99999999.
  2146         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  2147
  2148         16  AT-FORCE-CONTROL            PIC X.
  2149             88  PAYMENT-WAS-FORCED           VALUE '1'.
  2150         16  AT-PREV-LAST-PMT-DT         PIC XX.
  2151         16  AT-PREV-PAID-THRU-DT        PIC XX.
  2152         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  2153         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  2154         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  2155         16  AT-BENEFIT-TYPE             PIC X.
  2156
  2157         16  AT-EXPENSE-TYPE             PIC X.
  2158         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  2159
  2160         16  AT-PAYEE-TYPE-CD.
  2161             20  AT-PAYEE-TYPE           PIC X.
  2162                 88  INSURED-PAID           VALUE 'I'.
  2163                 88  BENEFICIARY-PAID       VALUE 'B'.
  2164                 88  ACCOUNT-PAID           VALUE 'A'.
  2165                 88  OTHER-1-PAID           VALUE 'O'.
  2166                 88  OTHER-2-PAID           VALUE 'Q'.
  2167                 88  DOCTOR-PAID            VALUE 'P'.
  2168                 88  EMPLOYER-PAID          VALUE 'E'.
  2169             20  AT-PAYEE-SEQ            PIC X.
  2170
  2171         16  AT-CASH-PAYMENT             PIC X.
  2172         16  AT-GROUPED-PAYMENT          PIC X.
  2173         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  2174         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  2175         16  AT-APPROVED-LEVEL           PIC X.
  2176         16  AT-VOID-TYPE                PIC X.
  2177             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  2178             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  2179         16  AT-AIG-UNEMP-IND            PIC X.
  2180             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  2181         16  AT-ASSOCIATES               PIC X.
  2182             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  2183             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  2184
  2185         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  2186         16  AT-CV-PMT-CODE              PIC X.
  2187             88  FULL-DEATH-PAYMENT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL162.cbl
  2188             88  HALF-DEATH-PAYMENT         VALUE '2'.
  2189             88  FULL-ADD-PAYMENT           VALUE '3'.
  2190             88  HALF-ADD-PAYMENT           VALUE '4'.
  2191             88  FULL-RIDER-PAYMENT         VALUE '5'.
  2192             88  HALF-RIDER-PAYMENT         VALUE '6'.
  2193             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  2194             88  ADDL-PAYMENT               VALUE '8'.
  2195
  2196         16  AT-EOB-CODE1                PIC XXX.
  2197         16  AT-EOB-CODE2                PIC XXX.
  2198         16  AT-EOB-CODE3                PIC XXX.
  2199         16  AT-EOB-CODE4                PIC XXX.
  2200         16  FILLER REDEFINES AT-EOB-CODE4.
  2201             20  AT-INT-PMT-SELECT-DT    PIC XX.
  2202             20  FILLER                  PIC X.
  2203         16  AT-EOB-CODE5                PIC XXX.
  2204         16  FILLER REDEFINES AT-EOB-CODE5.
  2205             20  AT-PMT-PROOF-DT         PIC XX.
  2206             20  FILLER                  PIC X.
  2207
  2208         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  2209             88  AT-PRINT-EOB            VALUE 'Y'.
  2210
  2211         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  2212         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  2213
  2214     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  2215         16  AT-SCHEDULE-START-DT        PIC XX.
  2216         16  AT-SCHEDULE-END-DT          PIC XX.
  2217         16  AT-TERMINATED-DT            PIC XX.
  2218         16  AT-LAST-PMT-TYPE            PIC X.
  2219             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  2220             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  2221         16  AT-FIRST-PMT-DATA.
  2222             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  2223             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  2224             20  AT-1ST-PAY-THRU-DT      PIC XX.
  2225         16  AT-REGULAR-PMT-DATA.
  2226             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  2227             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  2228             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  2229         16  AT-AUTO-PAYEE-CD.
  2230             20  AT-AUTO-PAYEE-TYPE      PIC X.
  2231                 88  INSURED-PAID-AUTO      VALUE 'I'.
  2232                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  2233                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  2234                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  2235                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  2236             20  AT-AUTO-PAYEE-SEQ       PIC X.
  2237         16  AT-AUTO-PAY-DAY             PIC 99.
  2238         16  AT-AUTO-CASH                PIC X.
  2239             88  AT-CASH                      VALUE 'Y'.
  2240             88  AT-NON-CASH                  VALUE 'N'.
  2241*        16  FILLER                      PIC X(129).
  2242         16  AT-AUTO-END-LETTER          PIC X(4).
  2243         16  FILLER                      PIC X(125).
  2244
  2245         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL162.cbl
  2246         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  2247
  2248     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  2249         16  AT-LETTER-SENT-DT           PIC XX.
  2250         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  2251         16  AT-AUTO-RE-SEND-DT          PIC XX.
  2252         16  AT-LETTER-ANSWERED-DT       PIC XX.
  2253         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  2254         16  AT-LETTER-ORIGIN            PIC X.
  2255             88  ONLINE-CREATION              VALUE '1' '3'.
  2256             88  OFFLINE-CREATION             VALUE '2' '4'.
  2257             88  NAPER-ONLINE-CREATION        VALUE '3'.
  2258             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  2259         16  AT-STD-LETTER-FORM          PIC X(4).
  2260         16  AT-REASON-TEXT              PIC X(70).
  2261         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  2262         16  AT-ADDRESEE-TYPE            PIC X.
  2263              88  INSURED-ADDRESEE            VALUE 'I'.
  2264              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  2265              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  2266              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  2267              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  2268              88  OTHER-ADDRESEE-1            VALUE 'O'.
  2269              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  2270         16  AT-ADDRESSEE-NAME           PIC X(30).
  2271         16  AT-INITIAL-PRINT-DATE       PIC XX.
  2272         16  AT-RESEND-PRINT-DATE        PIC XX.
  2273         16  AT-CORR-SOL-UNSOL           PIC X.
  2274         16  AT-LETTER-PURGED-DT         PIC XX.
  2275*
  2276*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  2277*
  2278         16  AT-CSO-REDEFINITION.
  2279             20  AT-RESEND-LETTER-FORM   PIC X(4).
  2280             20  AT-AUTO-CLOSE-IND       PIC X(1).
  2281             20  AT-LETTER-TO-BENE       PIC X(1).
  2282             20  AT-STOP-LETTER-DT       PIC X(2).
  2283             20  FILLER                  PIC X(19).
  2284*             20  FILLER                  PIC X(27).
  2285             20  AT-CSO-LETTER-STATUS    PIC X.
  2286                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  2287                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  2288                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  2289             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  2290             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  2291*
  2292*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  2293*
  2294*        16  FILLER                      PIC X(26).
  2295*
  2296*        16  AT-DMD-BSR-CODE             PIC X.
  2297*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  2298*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  2299*
  2300*        16  AT-DMD-LETTER-STATUS        PIC X.
  2301*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  2302*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  2303*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL162.cbl
  2304*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  2305*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  2306
  2307         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  2308         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  2309
  2310     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  2311         16  AT-ADDRESS-TYPE             PIC X.
  2312             88  INSURED-ADDRESS               VALUE 'I'.
  2313             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  2314             88  ACCOUNT-ADDRESS               VALUE 'A'.
  2315             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  2316             88  EMPLOYER-ADDRESS              VALUE 'E'.
  2317             88  OTHER-ADDRESS-1               VALUE 'O'.
  2318             88  OTHER-ADDRESS-2               VALUE 'Q'.
  2319         16  AT-MAIL-TO-NAME             PIC X(30).
  2320         16  AT-ADDRESS-LINE-1           PIC X(30).
  2321         16  AT-ADDRESS-LINE-2           PIC X(30).
  2322         16  AT-CITY-STATE.
  2323             20  AT-CITY                 PIC X(28).
  2324             20  AT-STATE                PIC XX.
  2325         16  AT-ZIP.
  2326             20  AT-ZIP-CODE.
  2327                 24  AT-ZIP-1ST          PIC X.
  2328                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2329                 24  FILLER              PIC X(4).
  2330             20  AT-ZIP-PLUS4            PIC X(4).
  2331         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  2332             20  AT-CAN-POSTAL-1         PIC XXX.
  2333             20  AT-CAN-POSTAL-2         PIC XXX.
  2334             20  FILLER                  PIC XXX.
  2335         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  2336         16  FILLER                      PIC X(23).
  2337         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  2338         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  2339
  2340     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2341         16  AT-INFO-LINE-1              PIC X(60).
  2342         16  AT-INFO-LINE-2              PIC X(60).
  2343         16  AT-INFO-TRAILER-TYPE        PIC X.
  2344             88  AT-PAYMENT-NOTE         VALUE 'P'.
  2345             88  AT-CALL-NOTE            VALUE 'C'.
  2346             88  AT-MAINT-NOTE           VALUE 'M'.
  2347             88  AT-CERT-CHANGE          VALUE 'X'.
  2348             88  AT-APPROVAL-NOTE        VALUE 'R'.
  2349             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  2350         16  AT-CALL-TYPE                PIC X.
  2351             88  AT-PHONE-CALL-IN        VALUE 'I'.
  2352             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  2353         16  AT-NOTE-CONTINUATION        PIC X.
  2354             88  AT-CONTINUED-NOTE       VALUE 'X'.
  2355         16  AT-EOB-CODES-EXIST          PIC X.
  2356             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  2357         16  FILLER                      PIC X(35).
  2358         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  2359         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  2360
  2361     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL162.cbl
  2362         16  AT-PROMPT-LINE-1            PIC X(60).
  2363         16  AT-PROMPT-LINE-2            PIC X(60).
  2364         16  AT-PROMPT-START-DT          PIC XX.
  2365         16  AT-PROMPT-END-DT            PIC XX.
  2366         16  FILLER                      PIC X(35).
  2367         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  2368         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  2369
  2370     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2371         16  AT-DENIAL-INFO-1            PIC X(60).
  2372         16  AT-DENIAL-INFO-2            PIC X(60).
  2373         16  AT-DENIAL-DT                PIC XX.
  2374         16  AT-RETRACTION-DT            PIC XX.
  2375         16  AT-DENIAL-REASON-CODE       PIC X(4).
  2376*         16  FILLER                      PIC X(31).
  2377         16  AT-DENIAL-PROOF-DT          PIC XX.
  2378         16  FILLER                      PIC X(29).
  2379         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  2380         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  2381
  2382     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  2383         16  AT-OLD-INCURRED-DT          PIC XX.
  2384         16  AT-OLD-REPORTED-DT          PIC XX.
  2385         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  2386         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  2387         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  2388         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  2389         16  AT-OLD-PAID-THRU-DT         PIC XX.
  2390         16  AT-LAST-PMT-MADE-DT         PIC XX.
  2391         16  FILLER                      PIC X(26).
  2392         16  AT-OLD-DIAG-CODE            PIC X(6).
  2393         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  2394         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  2395         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  2396         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  2397         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  2398         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  2399         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  2400         16  FILLER                      PIC X(25).
  2401         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  2402
  2403     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  2404         16  AT-FORM-SEND-ON-DT          PIC XX.
  2405         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  2406         16  AT-FORM-RE-SEND-DT          PIC XX.
  2407         16  AT-FORM-ANSWERED-DT         PIC XX.
  2408         16  AT-FORM-PRINTED-DT          PIC XX.
  2409         16  AT-FORM-REPRINT-DT          PIC XX.
  2410         16  AT-FORM-TYPE                PIC X.
  2411             88  INITIAL-FORM                  VALUE '1'.
  2412             88  PROGRESS-FORM                 VALUE '2'.
  2413         16  AT-INSTRUCT-LN-1            PIC X(28).
  2414         16  AT-INSTRUCT-LN-2            PIC X(28).
  2415         16  AT-INSTRUCT-LN-3            PIC X(28).
  2416         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  2417         16  AT-FORM-ADDRESS             PIC X.
  2418             88  FORM-TO-INSURED              VALUE 'I'.
  2419             88  FORM-TO-ACCOUNT              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL162.cbl
  2420             88  FORM-TO-OTHER-1              VALUE 'O'.
  2421             88  FORM-TO-OTHER-2              VALUE 'Q'.
  2422         16  AT-RELATED-1.
  2423             20 AT-REL-CARR-1            PIC X.
  2424             20 AT-REL-CLAIM-1           PIC X(7).
  2425             20 AT-REL-CERT-1            PIC X(11).
  2426         16  AT-RELATED-2.
  2427             20 AT-REL-CARR-2            PIC X.
  2428             20 AT-REL-CLAIM-2           PIC X(7).
  2429             20 AT-REL-CERT-2            PIC X(11).
  2430         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  2431         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  2432         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  2433         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  2434         16  AT-FORM-REM-PRINT-DT        PIC XX.
  2435         16  AT-STOP-FORM-DT             PIC X(2).
  2436
  2437         16  FILLER                      PIC X(09).
  2438         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  2439         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  2440******************************************************************
  2441
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL162.cbl
  2443*                            COPY ERCACCT.
  2444******************************************************************
  2445*                                                                *
  2446*                                                                *
  2447*                            ERCACCT                             *
  2448*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2449*                            VMOD=2.031                          *
  2450*                                                                *
  2451*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2452*                                                                *
  2453*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2454*   VSAM ACCOUNT MASTER FILES.                                   *
  2455*                                                                *
  2456*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2457*                                                                *
  2458*   FILE TYPE = VSAM,KSDS                                        *
  2459*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2460*                                                                *
  2461*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2462*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2463*                                                                *
  2464*   LOG = NO                                                     *
  2465*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2466*                                                                *
  2467*                                                                *
  2468******************************************************************
  2469*                   C H A N G E   L O G
  2470*
  2471* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2472*-----------------------------------------------------------------
  2473*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2474* EFFECTIVE    NUMBER
  2475*-----------------------------------------------------------------
  2476* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2477* 092705    2005050300006  PEMA  ADD SPP LEASES
  2478* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2479* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2480******************************************************************
  2481
  2482 01  ACCOUNT-MASTER.
  2483     12  AM-RECORD-ID                      PIC XX.
  2484         88  VALID-AM-ID                      VALUE 'AM'.
  2485
  2486     12  AM-CONTROL-PRIMARY.
  2487         16  AM-COMPANY-CD                 PIC X.
  2488         16  AM-MSTR-CNTRL.
  2489             20  AM-CONTROL-A.
  2490                 24  AM-CARRIER            PIC X.
  2491                 24  AM-GROUPING.
  2492                     28 AM-GROUPING-PREFIX PIC XXX.
  2493                     28 AM-GROUPING-PRIME  PIC XXX.
  2494                 24  AM-STATE              PIC XX.
  2495                 24  AM-ACCOUNT.
  2496                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2497                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2498             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2499                                           PIC X(19).
  2500             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL162.cbl
  2501                 24  AM-EXPIRATION-DT      PIC XX.
  2502                 24  FILLER                PIC X(4).
  2503             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2504                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2505
  2506     12  AM-CONTROL-BY-VAR-GRP.
  2507         16  AM-COMPANY-CD-A1              PIC X.
  2508         16  AM-VG-CARRIER                 PIC X.
  2509         16  AM-VG-GROUPING                PIC X(6).
  2510         16  AM-VG-STATE                   PIC XX.
  2511         16  AM-VG-ACCOUNT                 PIC X(10).
  2512         16  AM-VG-DATE.
  2513             20  AM-VG-EXPIRATION-DT       PIC XX.
  2514             20  FILLER                    PIC X(4).
  2515         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2516                                           PIC 9(11)      COMP-3.
  2517     12  AM-MAINT-INFORMATION.
  2518         16  AM-LAST-MAINT-DT              PIC XX.
  2519         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2520         16  AM-LAST-MAINT-USER            PIC X(4).
  2521         16  FILLER                        PIC XX.
  2522
  2523     12  AM-EFFECTIVE-DT                   PIC XX.
  2524     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2525
  2526     12  AM-PREV-DATES  COMP-3.
  2527         16  AM-PREV-EXP-DT                PIC 9(11).
  2528         16  AM-PREV-EFF-DT                PIC 9(11).
  2529
  2530     12  AM-REPORT-CODE-1                  PIC X(10).
  2531     12  AM-REPORT-CODE-2                  PIC X(10).
  2532
  2533     12  AM-CITY-CODE                      PIC X(4).
  2534     12  AM-COUNTY-PARISH                  PIC X(6).
  2535
  2536     12  AM-NAME                           PIC X(30).
  2537     12  AM-PERSON                         PIC X(30).
  2538     12  AM-ADDRS                          PIC X(30).
  2539     12  AM-CITY.
  2540         16  AM-ADDR-CITY                  PIC X(28).
  2541         16  AM-ADDR-STATE                 PIC XX.
  2542     12  AM-ZIP.
  2543         16  AM-ZIP-PRIME.
  2544             20  AM-ZIP-PRI-1ST            PIC X.
  2545                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2546             20  FILLER                    PIC X(4).
  2547         16  AM-ZIP-PLUS4                  PIC X(4).
  2548     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2549         16  AM-CAN-POSTAL-1               PIC XXX.
  2550         16  AM-CAN-POSTAL-2               PIC XXX.
  2551         16  FILLER                        PIC XXX.
  2552     12  AM-TEL-NO.
  2553         16  AM-AREA-CODE                  PIC 999.
  2554         16  AM-TEL-PRE                    PIC 999.
  2555         16  AM-TEL-NBR                    PIC 9(4).
  2556     12  AM-TEL-LOC                        PIC X.
  2557         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2558         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL162.cbl
  2559
  2560     12  AM-COMM-STRUCTURE.
  2561         16  AM-DEFN-1.
  2562             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2563                 24  AM-AGT.
  2564                     28  AM-AGT-PREFIX     PIC X(4).
  2565                     28  AM-AGT-PRIME      PIC X(6).
  2566                 24  AM-COM-TYP            PIC X.
  2567                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2568                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2569                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2570                 24  AM-RECALC-LV-INDIC    PIC X.
  2571                 24  AM-RETRO-LV-INDIC     PIC X.
  2572                 24  AM-GL-CODES           PIC X.
  2573                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2574                 24  FILLER                PIC X(01).
  2575         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2576             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2577                 24  FILLER                PIC X(11).
  2578                 24  AM-L-COMA             PIC XXX.
  2579                 24  AM-J-COMA             PIC XXX.
  2580                 24  AM-A-COMA             PIC XXX.
  2581                 24  FILLER                PIC X(6).
  2582
  2583     12  AM-COMM-CHANGE-STATUS             PIC X.
  2584         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2585
  2586     12  AM-CSR-CODE                       PIC X(4).
  2587
  2588     12  AM-BILLING-STATUS                 PIC X.
  2589         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2590         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2591     12  AM-AUTO-REFUND-SW                 PIC X.
  2592         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2593         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2594     12  AM-GPCD                           PIC 99.
  2595     12  AM-IG                             PIC X.
  2596         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2597         88  AM-HAS-GROUP                     VALUE '2'.
  2598     12  AM-STATUS                         PIC X.
  2599         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2600         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2601         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2602         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2603         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2604     12  AM-REMIT-TO                       PIC 99.
  2605     12  AM-ID-NO                          PIC X(11).
  2606
  2607     12  AM-CAL-TABLE                      PIC XX.
  2608     12  AM-LF-DEVIATION                   PIC XXX.
  2609     12  AM-AH-DEVIATION                   PIC XXX.
  2610     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2611     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2612     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2613     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2614     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2615     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2616
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL162.cbl
  2617     12  AM-USER-FIELDS.
  2618         16  AM-FLD-1                      PIC XX.
  2619         16  AM-FLD-2                      PIC XX.
  2620         16  AM-FLD-3                      PIC XX.
  2621         16  AM-FLD-4                      PIC XX.
  2622         16  AM-FLD-5                      PIC XX.
  2623
  2624     12  AM-1ST-PROD-DATE.
  2625         16  AM-1ST-PROD-YR                PIC XX.
  2626         16  AM-1ST-PROD-MO                PIC XX.
  2627         16  AM-1ST-PROD-DA                PIC XX.
  2628     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2629     12  AM-CERTS-PURGED-DATE.
  2630         16  AM-PUR-YR                     PIC XX.
  2631         16  AM-PUR-MO                     PIC XX.
  2632         16  AM-PUR-DA                     PIC XX.
  2633     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2634     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2635     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2636     12  AM-INACTIVE-DATE.
  2637         16  AM-INA-MO                     PIC 99.
  2638         16  AM-INA-DA                     PIC 99.
  2639         16  AM-INA-YR                     PIC 99.
  2640     12  AM-AR-HI-CERT-DATE                PIC XX.
  2641
  2642     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2643     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2644
  2645     12  AM-OB-PAYMENT-MODE                PIC X.
  2646         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2647         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2648         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2649         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2650
  2651     12  AM-AH-ONLY-INDICATOR              PIC X.
  2652         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2653         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2654
  2655     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2656
  2657     12  AM-OVER-SHORT.
  2658         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2659         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2660
  2661     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2662     12  AM-DCC-CLP-STATE                  PIC XX.
  2663
  2664     12  AM-RECALC-COMM                    PIC X.
  2665     12  AM-RECALC-REIN                    PIC X.
  2666
  2667     12  AM-REI-TABLE                      PIC XXX.
  2668     12  AM-REI-ET-LF                      PIC X.
  2669     12  AM-REI-ET-AH                      PIC X.
  2670     12  AM-REI-PE-LF                      PIC X.
  2671     12  AM-REI-PE-AH                      PIC X.
  2672     12  AM-REI-PRT-ST                     PIC X.
  2673     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2674     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL162.cbl
  2675     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2676     12  AM-REI-GROUP-A                    PIC X(6).
  2677     12  AM-REI-MORT                       PIC X(4).
  2678     12  AM-REI-PRT-OW                     PIC X.
  2679     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2680     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2681     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2682     12  AM-REI-GROUP-B                    PIC X(6).
  2683
  2684     12  AM-TRUST-TYPE                     PIC X(2).
  2685
  2686     12  AM-EMPLOYER-STMT-USED             PIC X.
  2687     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2688
  2689     12  AM-STD-AH-TYPE                    PIC XX.
  2690     12  AM-EARN-METHODS.
  2691         16  AM-EARN-METHOD-R              PIC X.
  2692             88 AM-REF-RL-R78                 VALUE 'R'.
  2693             88 AM-REF-RL-PR                  VALUE 'P'.
  2694             88 AM-REF-RL-MEAN                VALUE 'M'.
  2695             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2696         16  AM-EARN-METHOD-L              PIC X.
  2697             88 AM-REF-LL-R78                 VALUE 'R'.
  2698             88 AM-REF-LL-PR                  VALUE 'P'.
  2699             88 AM-REF-LL-MEAN                VALUE 'M'.
  2700             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2701         16  AM-EARN-METHOD-A              PIC X.
  2702             88 AM-REF-AH-R78                 VALUE 'R'.
  2703             88 AM-REF-AH-PR                  VALUE 'P'.
  2704             88 AM-REF-AH-MEAN                VALUE 'M'.
  2705             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2706             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2707             88 AM-REF-AH-NET                 VALUE 'N'.
  2708
  2709     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2710     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2711     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2712
  2713     12  AM-RET-Y-N                        PIC X.
  2714     12  AM-RET-P-E                        PIC X.
  2715     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2716     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2717     12  AM-RET-GRP                        PIC X(6).
  2718     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2719         16  AM-POOL-PRIME                 PIC XXX.
  2720         16  AM-POOL-SUB                   PIC XXX.
  2721     12  AM-RETRO-EARNINGS.
  2722         16  AM-RET-EARN-R                 PIC X.
  2723         16  AM-RET-EARN-L                 PIC X.
  2724         16  AM-RET-EARN-A                 PIC X.
  2725     12  AM-RET-ST-TAX-USE                 PIC X.
  2726         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2727         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2728     12  AM-RETRO-BEG-EARNINGS.
  2729         16  AM-RET-BEG-EARN-R             PIC X.
  2730         16  AM-RET-BEG-EARN-L             PIC X.
  2731         16  AM-RET-BEG-EARN-A             PIC X.
  2732     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL162.cbl
  2733     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2734
  2735     12  AM-USER-SELECT-OPTIONS.
  2736         16  AM-USER-SELECT-1              PIC X(10).
  2737         16  AM-USER-SELECT-2              PIC X(10).
  2738         16  AM-USER-SELECT-3              PIC X(10).
  2739         16  AM-USER-SELECT-4              PIC X(10).
  2740         16  AM-USER-SELECT-5              PIC X(10).
  2741
  2742     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2743
  2744     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2745
  2746     12  AM-RPT045A-SWITCH                 PIC X.
  2747         88  RPT045A-OFF                   VALUE 'N'.
  2748
  2749     12  AM-INSURANCE-LIMITS.
  2750         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2751         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2752
  2753     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2754         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2755
  2756     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2757         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2758         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2759
  2760     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2761
  2762     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2763     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2764     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2765     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2766     12  FILLER                            PIC X(5).
  2767     12  AM-REPORT-CODE-3                  PIC X(10).
  2768*    12  FILLER                            PIC X(22).
  2769
  2770     12  AM-RESERVE-DATE.
  2771         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2772         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2773         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2774
  2775     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2776     12  AM-NOTIFICATION-TYPES.
  2777         16  AM-NOTIF-OF-LETTERS           PIC X.
  2778         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2779         16  AM-NOTIF-OF-REPORTS           PIC X.
  2780         16  AM-NOTIF-OF-STATUS            PIC X.
  2781
  2782     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2783         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2784         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2785         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2786         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2787
  2788     12  AM-BENEFIT-CONTROLS.
  2789         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2790             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL162.cbl
  2791             20  AM-BENEFIT-TYPE           PIC X.
  2792             20  AM-BENEFIT-REVISION       PIC XXX.
  2793             20  AM-BENEFIT-REM-TERM       PIC X.
  2794             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2795             20  FILLER                    PIC XX.
  2796         16  FILLER                        PIC X(80).
  2797
  2798     12  AM-TRANSFER-DATA.
  2799         16  AM-TRANSFERRED-FROM.
  2800             20  AM-TRNFROM-CARRIER        PIC X.
  2801             20  AM-TRNFROM-GROUPING.
  2802                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2803                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2804             20  AM-TRNFROM-STATE          PIC XX.
  2805             20  AM-TRNFROM-ACCOUNT.
  2806                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2807                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2808             20  AM-TRNFROM-DTE            PIC XX.
  2809         16  AM-TRANSFERRED-TO.
  2810             20  AM-TRNTO-CARRIER          PIC X.
  2811             20  AM-TRNTO-GROUPING.
  2812                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2813                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2814             20  AM-TRNTO-STATE            PIC XX.
  2815             20  AM-TRNTO-ACCOUNT.
  2816                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2817                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2818             20  AM-TRNTO-DTE              PIC XX.
  2819         16  FILLER                        PIC X(10).
  2820
  2821     12  AM-SAVED-REMIT-TO                 PIC 99.
  2822
  2823     12  AM-COMM-STRUCTURE-SAVED.
  2824         16  AM-DEFN-1-SAVED.
  2825             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2826                 24  AM-AGT-SV             PIC X(10).
  2827                 24  AM-COM-TYP-SV         PIC X.
  2828                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2829                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2830                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2831                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2832                 24  FILLER                PIC X.
  2833                 24  AM-GL-CODES-SV        PIC X.
  2834                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2835                 24  FILLER                PIC X.
  2836         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2837             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2838                 24  FILLER                PIC X(11).
  2839                 24  AM-L-COMA-SV          PIC XXX.
  2840                 24  AM-J-COMA-SV          PIC XXX.
  2841                 24  AM-A-COMA-SV          PIC XXX.
  2842                 24  FILLER                PIC X(6).
  2843
  2844     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2845         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2846            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2847            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2848            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL162.cbl
  2849
  2850     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2851     12  FILLER                            PIC X(120).
  2852
  2853     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2854         16  AM-CONTROL-NAME               PIC X(30).
  2855         16  AM-EXECUTIVE-ONE.
  2856             20  AM-EXEC1-NAME             PIC X(15).
  2857             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2858                                                          COMP-3.
  2859             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2860                                                          COMP-3.
  2861         16  AM-EXECUTIVE-TWO.
  2862             20  AM-EXEC2-NAME             PIC X(15).
  2863             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2864                                                          COMP-3.
  2865             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2866                                                          COMP-3.
  2867
  2868     12  AM-RETRO-ADDITIONAL-DATA.
  2869         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2870         16  AM-RETRO-PREM-P-E             PIC X.
  2871         16  AM-RETRO-CLMS-P-I             PIC X.
  2872         16  AM-RETRO-RET-BRACKET-LF.
  2873             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2874                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2875                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2876             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2877                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2878                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2879             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2880                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2881                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2882         16  AM-RETRO-RET-BRACKET-AH.
  2883             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2884                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2885                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2886                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2887             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2888                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2889                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2890             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2891                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2892                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2893
  2894     12  AM-COMMENTS.
  2895         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2896
  2897     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2898         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2899         16  AM-FLI-BILLING-CODE           PIC X.
  2900         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2901         16  AM-FLI-UNITED-IDENT           PIC X.
  2902         16  AM-FLI-INTEREST-LOST-DATA.
  2903             20  AM-FLI-BANK-NO            PIC X(5).
  2904             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2905             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2906             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL162.cbl
  2907         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2908             20  AM-FLI-AGT                PIC X(9).
  2909             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2910             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2911         16  FILLER                        PIC X(102).
  2912
  2913     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2914         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2915             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2916             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2917             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2918             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2919             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2920         16  FILLER                          PIC X(10).
  2921******************************************************************
  2922
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL162.cbl
  2924 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  2925                          ACTIVITY-TRAILERS ACCOUNT-MASTER.
  2926 0000-DFHEXIT SECTION.
  2927     MOVE '9#                    $   ' TO DFHEIV0.
  2928     MOVE 'EL162' TO DFHEIV1.
  2929     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2930
  2931     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  2932     MOVE '5'                   TO DC-OPTION-CODE.
  2933     PERFORM 9700-DATE-LINK.
  2934     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  2935     MOVE DC-BIN-DATE-1         TO  BIN-CURRENT-DATE.
  2936
  2937     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2938
  2939     IF PI-COMPANY-ID = 'DMD'
  2940         MOVE -1                TO  DC-ELAPSED-MONTHS
  2941         MOVE +0                TO  DC-ELAPSED-DAYS
  2942         MOVE '6'               TO  DC-OPTION-CODE
  2943         PERFORM 9700-DATE-LINK
  2944         MOVE DC-BIN-DATE-2     TO  CURRENT-MINUS1-SAVE.
  2945
  2946     IF EIBCALEN NOT GREATER THAN ZERO
  2947         GO TO 8800-UNAUTHORIZED-ACCESS.
  2948
  2949     IF PI-CALLING-PROGRAM = PGM-EL150
  2950         MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2951         MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2952         MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2953         MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2954         MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2955         MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2956         MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2957         MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  2958         MOVE +1                   TO SUB
  2959         PERFORM  2000-ZERO-PI-TRLR-TABLE THRU 2010-EXIT
  2960         MOVE LOW-VALUES           TO EL162AO
  2961                                      PI-DISPLAYED-TRAILER-CODES
  2962         MOVE 1                    TO PI-ACTV-SEQ
  2963                                      PI-NEXT-TRLR-SUB
  2964         GO TO 7000-BUILD-SCREEN.
  2965
  2966     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2967         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2968************ FIRST TIME IN FROM MENU, FORCE THE CLAIM
  2969************ TO BE DESIGNATED THRU EL132.
  2970             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2971             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2972             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2973             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2974             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2975             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2976             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2977             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  2978             MOVE PGM-EL132            TO PGM-NAME
  2979             GO TO 9300-XCTL
  2980         ELSE
  2981             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL162.cbl
  2982             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2983             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2984             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2985             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2986             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2987             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2988             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  2989             MOVE +1                   TO SUB
  2990             PERFORM  2000-ZERO-PI-TRLR-TABLE THRU 2010-EXIT
  2991             MOVE LOW-VALUES           TO EL162AO
  2992                                       PI-DISPLAYED-TRAILER-CODES
  2993             MOVE 1                    TO PI-ACTV-SEQ
  2994                                          PI-NEXT-TRLR-SUB
  2995             GO TO 7000-BUILD-SCREEN.
  2996
  2997     IF EIBAID = DFHCLEAR
  2998         GO TO 9400-CLEAR.
  2999
  3000
  3001* EXEC CICS HANDLE CONDITION
  3002*        PGMIDERR(9600-PGMID-ERROR)
  3003*        ERROR   (9990-ABEND)
  3004*    END-EXEC.
  3005*    MOVE '"$L.                  ! " #00002996' TO DFHEIV0
  3006     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3007     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3008     MOVE X'2220233030303032393936' TO DFHEIV0(25:11)
  3009     CALL 'kxdfhei1' USING DFHEIV0
  3010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3011
  3012
  3013     IF PI-PROCESSOR-ID = 'LGXX'
  3014         GO TO 0200-RECEIVE.
  3015
  3016
  3017* EXEC CICS READQ TS
  3018*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  3019*        INTO    (SECURITY-CONTROL)
  3020*        LENGTH  (SC-COMM-LENGTH)
  3021*        ITEM    (SC-ITEM)
  3022*    END-EXEC.
  3023*    MOVE '*$II   L              ''   #00003004' TO DFHEIV0
  3024     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3025     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3026     MOVE X'2020233030303033303034' TO DFHEIV0(25:11)
  3027     CALL 'kxdfhei1' USING DFHEIV0,
  3028           PI-SECURITY-TEMP-STORE-ID,
  3029           SECURITY-CONTROL,
  3030           SC-COMM-LENGTH,
  3031           SC-ITEM,
  3032           DFHEIV99,
  3033           DFHEIV99
  3034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3035
  3036
  3037     MOVE SC-CLAIMS-DISPLAY (2)    TO  PI-DISPLAY-CAP.
  3038     MOVE SC-CLAIMS-UPDATE  (2)    TO  PI-MODIFY-CAP.
  3039
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL162.cbl
  3040     IF NOT MODIFY-CAP
  3041         MOVE 'UPDATE'             TO  SM-READ
  3042         PERFORM 9995-SECURITY-VIOLATION
  3043         MOVE ER-0070              TO  EMI-ERROR
  3044         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3045         GO TO 8100-SEND-INITIAL-MAP.
  3046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL162.cbl
  3048 0200-RECEIVE.
  3049
  3050     MOVE LOW-VALUES TO EL162AI.
  3051
  3052     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3053         MOVE ER-0008            TO EMI-ERROR
  3054         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3055         GO TO 8200-SEND-DATAONLY.
  3056
  3057
  3058* EXEC CICS RECEIVE
  3059*        MAP   (MAP-NAME)
  3060*        MAPSET(MAPSET-NAME)
  3061*        INTO  (EL162AI)
  3062*    END-EXEC.
  3063     MOVE LENGTH OF
  3064      EL162AI
  3065       TO DFHEIV11
  3066*    MOVE '8"T I  L              ''   #00003031' TO DFHEIV0
  3067     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3068     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3069     MOVE X'2020233030303033303331' TO DFHEIV0(25:11)
  3070     CALL 'kxdfhei1' USING DFHEIV0,
  3071           MAP-NAME,
  3072           EL162AI,
  3073           DFHEIV11,
  3074           MAPSET-NAME,
  3075           DFHEIV99,
  3076           DFHEIV99
  3077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3078
  3079
  3080     IF ENTERPFL = ZERO
  3081         GO TO 0300-CHECK-PFKEYS.
  3082
  3083     IF EIBAID NOT = DFHENTER
  3084         MOVE ER-0004            TO EMI-ERROR
  3085         GO TO 0320-INPUT-ERROR.
  3086
  3087     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  3088         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  3089     ELSE
  3090         MOVE ER-0029            TO EMI-ERROR
  3091         GO TO 0320-INPUT-ERROR.
  3092
  3093 0300-CHECK-PFKEYS.
  3094     IF EIBAID = DFHPF23
  3095         GO TO 8810-PF23.
  3096
  3097     IF EIBAID = DFHPF24
  3098         GO TO 9200-RETURN-MAIN-MENU.
  3099
  3100     IF EIBAID = DFHPF12
  3101         GO TO 9500-PF12.
  3102
  3103     IF PI-COMPANY-ID = 'DMD'
  3104         MOVE SPACE              TO PI-DMD-FORCE-ERROR.
  3105
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL162.cbl
  3106     IF EIBAID = DFHPF4
  3107         IF PI-COMPANY-ID NOT = 'DMD'
  3108             MOVE ER-0029        TO EMI-ERROR
  3109             GO TO 0320-INPUT-ERROR
  3110         ELSE
  3111             MOVE 'X'            TO PI-DMD-FORCE-ERROR
  3112             MOVE DFHENTER       TO EIBAID
  3113             GO TO 0330-EDIT-DATA.
  3114
  3115     IF EIBAID = DFHPF5
  3116         IF PI-RETURN-TO-PROGRAM = 'EL150'
  3117             MOVE ER-0029        TO EMI-ERROR
  3118             GO TO 0320-INPUT-ERROR
  3119         ELSE
  3120             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  3121             MOVE PGM-EL132      TO PGM-NAME
  3122             GO TO 9300-XCTL.
  3123
  3124     IF PI-CLAIM-NO = SPACES
  3125        MOVE ER-0319             TO EMI-ERROR
  3126        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3127        GO TO 8100-SEND-INITIAL-MAP.
  3128
  3129     IF SC-RECL (1) > 0 OR SC-STOPL (1) > 0 OR
  3130        SC-RECL (2) > 0 OR SC-STOPL (2) > 0 OR
  3131        SC-RECL (3) > 0 OR SC-STOPL (3) > 0 OR
  3132        SC-RECL (4) > 0 OR SC-STOPL (4) > 0 OR
  3133        UREL > 0  OR USENTL > 0  OR
  3134*00409         UBYL > 0  OR UFORML > 0  OR URECDTEL > 0
  3135        UFORML > 0  OR URECDTEL > 0
  3136          IF EIBAID NOT = DFHENTER
  3137             MOVE ER-0050            TO EMI-ERROR
  3138             GO TO 0320-INPUT-ERROR.
  3139
  3140     IF EIBAID = DFHPF1
  3141         GO TO 6000-BROWSE-FORWARD.
  3142
  3143     IF EIBAID = DFHPF2
  3144         GO TO 6100-BROWSE-BACKWARD.
  3145
  3146     IF EIBAID = DFHPF6
  3147         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  3148         MOVE PGM-EL141          TO PGM-NAME
  3149         GO TO 9300-XCTL.
  3150
  3151     IF EIBAID = DFHENTER
  3152         GO TO 0330-EDIT-DATA.
  3153
  3154     MOVE ER-0029                TO EMI-ERROR.
  3155
  3156 0320-INPUT-ERROR.
  3157     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3158
  3159     MOVE AL-UNBON        TO ENTERPFA.
  3160
  3161     IF ENTERPFL = 0
  3162         MOVE -1          TO URECDTEL
  3163     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL162.cbl
  3164         MOVE -1          TO ENTERPFL.
  3165
  3166     GO TO 8200-SEND-DATAONLY.
  3167
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL162.cbl
  3169 0330-EDIT-DATA.
  3170     SET SC-INDX  INDX           TO 1.
  3171     SET INDX2                   TO 1.
  3172
  3173 0331-LOOP.
  3174     IF SC-RECL (SC-INDX) > ZERO
  3175        MOVE SC-REC (SC-INDX)    TO DEEDIT-FIELD
  3176        PERFORM 8600-DEEDIT
  3177        MOVE '1'                 TO REC-DATA-SW
  3178        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3179        MOVE '4'                 TO DC-OPTION-CODE
  3180        PERFORM 9700-DATE-LINK
  3181        IF DATE-CONVERSION-ERROR
  3182           MOVE ER-0021          TO EMI-ERROR
  3183           MOVE -1               TO SC-RECL (SC-INDX)
  3184           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3185           PERFORM 9900-ERROR-FORMAT
  3186                                 THRU 9900-EXIT
  3187        ELSE
  3188           IF DC-BIN-DATE-1 > BIN-CURRENT-DATE
  3189              MOVE ER-0539       TO EMI-ERROR
  3190              MOVE -1            TO SC-RECL (SC-INDX)
  3191              MOVE AL-UABON      TO SC-RECA (SC-INDX)
  3192              PERFORM 9900-ERROR-FORMAT
  3193                                 THRU 9900-EXIT
  3194           ELSE
  3195              MOVE DC-BIN-DATE-1 TO REC-DATE-SAVE (INDX)
  3196              MOVE DEEDIT-FIELD-V0
  3197                                 TO SC-REC-O (SC-INDX)
  3198              INSPECT SC-REC (SC-INDX) CONVERTING ' ' TO '/'
  3199           END-IF
  3200        END-IF
  3201     ELSE
  3202        MOVE LOW-VALUES          TO REC-DATE-SAVE (INDX)
  3203     END-IF
  3204     IF PI-COMPANY-ID = 'DMD'
  3205       IF SC-RECL (SC-INDX) > 0
  3206         IF REC-DATE-SAVE (INDX) < CURRENT-MINUS1-SAVE
  3207         IF NOT PI-DMD-FORCED
  3208           MOVE ER-7839        TO EMI-ERROR
  3209           MOVE -1             TO SC-RECL (SC-INDX)
  3210           MOVE AL-UABON       TO SC-RECA (SC-INDX)
  3211           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3212         END-IF
  3213         ELSE
  3214         IF REC-DATE-SAVE (INDX) > BIN-CURRENT-DATE
  3215           MOVE ER-0539          TO EMI-ERROR
  3216           MOVE -1               TO SC-RECL (SC-INDX)
  3217           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3218           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3219
  3220     IF SC-STOPL (SC-INDX) > ZERO
  3221        MOVE SC-STOP (SC-INDX)    TO DEEDIT-FIELD
  3222        PERFORM 8600-DEEDIT
  3223        MOVE '1'                 TO REC-DATA-SW
  3224        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3225        MOVE '4'                 TO DC-OPTION-CODE
  3226        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL162.cbl
  3227        IF DATE-CONVERSION-ERROR
  3228           MOVE ER-0021          TO EMI-ERROR
  3229           MOVE -1               TO SC-STOPL (SC-INDX)
  3230           MOVE AL-UABON         TO SC-STOPA (SC-INDX)
  3231           PERFORM 9900-ERROR-FORMAT
  3232                                 THRU 9900-EXIT
  3233        ELSE
  3234           IF DC-BIN-DATE-1 > BIN-CURRENT-DATE
  3235              MOVE ER-0895       TO EMI-ERROR
  3236              MOVE -1            TO SC-STOPL (SC-INDX)
  3237              MOVE AL-UABON      TO SC-STOPA (SC-INDX)
  3238              PERFORM 9900-ERROR-FORMAT
  3239                                 THRU 9900-EXIT
  3240           ELSE
  3241              MOVE DC-BIN-DATE-1 TO STOP-DATE-SAVE (INDX2)
  3242              MOVE DEEDIT-FIELD-V0 TO SC-STOP-O (SC-INDX)
  3243              INSPECT SC-STOP (SC-INDX) CONVERTING ' ' TO '/'
  3244           END-IF
  3245        END-IF
  3246     ELSE
  3247        MOVE LOW-VALUES          TO STOP-DATE-SAVE (INDX2)
  3248     END-IF.
  3249
  3250     SET SC-INDX
  3251            INDX2
  3252            INDX UP BY 1.
  3253
  3254     IF SC-INDX NOT = 5
  3255        GO TO 0331-LOOP.
  3256
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL162.cbl
  3258
  3259     IF URECDTEL > 0
  3260        MOVE URECDTEI            TO DEEDIT-FIELD
  3261        PERFORM 8600-DEEDIT
  3262        MOVE '1'                 TO UNSOL-DATA-SW
  3263        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3264        MOVE '4'                 TO DC-OPTION-CODE
  3265        PERFORM 9700-DATE-LINK
  3266        IF DATE-CONVERSION-ERROR
  3267           MOVE ER-0021          TO EMI-ERROR
  3268           MOVE -1               TO URECDTEL
  3269           MOVE AL-UABON         TO URECDTEA
  3270           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3271        ELSE
  3272           MOVE DC-BIN-DATE-1    TO URECDTE-SAVE
  3273           MOVE DEEDIT-FIELD-V0  TO URECDTEO
  3274           INSPECT URECDTEI CONVERTING ' ' TO '/'.
  3275
  3276     IF PI-COMPANY-ID = 'DMD'
  3277       IF URECDTEL > 0
  3278         IF URECDTE-SAVE < CURRENT-MINUS1-SAVE
  3279         IF NOT PI-DMD-FORCED
  3280           MOVE ER-7839        TO EMI-ERROR
  3281           MOVE -1             TO URECDTEL
  3282           MOVE AL-UABON       TO URECDTEA
  3283           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3284         END-IF
  3285         ELSE
  3286         IF URECDTE-SAVE > BIN-CURRENT-DATE
  3287           MOVE ER-0539          TO EMI-ERROR
  3288           MOVE -1               TO URECDTEL
  3289           MOVE AL-UABON         TO URECDTEA
  3290           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3291
  3292     IF USENTL > 0
  3293        MOVE USENTI              TO DEEDIT-FIELD
  3294        PERFORM 8600-DEEDIT
  3295        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3296        MOVE '4'                 TO DC-OPTION-CODE
  3297        PERFORM 9700-DATE-LINK
  3298        IF DATE-CONVERSION-ERROR
  3299           MOVE ER-0021          TO EMI-ERROR
  3300           MOVE -1               TO USENTL
  3301           MOVE AL-UABON         TO USENTA
  3302           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3303          ELSE
  3304           MOVE DC-BIN-DATE-1    TO USENT-SAVE
  3305           MOVE DEEDIT-FIELD-V0  TO USENTO
  3306           INSPECT USENTI CONVERTING ' ' TO '/'
  3307        ELSE
  3308           MOVE LOW-VALUES       TO USENT-SAVE.
  3309
  3310     IF USENT-SAVE   NOT = LOW-VALUES AND
  3311        URECDTE-SAVE NOT = LOW-VALUES
  3312          IF USENT-SAVE GREATER THAN URECDTE-SAVE
  3313             MOVE ER-0514        TO EMI-ERROR
  3314             MOVE -1             TO URECDTEL
  3315             MOVE AL-UABON       TO URECDTEA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL162.cbl
  3316             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3317
  3318     IF URECDTE-SAVE NOT = LOW-VALUES
  3319          IF URECDTE-SAVE GREATER THAN BIN-CURRENT-DATE
  3320             MOVE ER-0539        TO EMI-ERROR
  3321             MOVE -1             TO URECDTEL
  3322             MOVE AL-UABON       TO URECDTEA
  3323             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3324
  3325     IF URECDTEL = ZEROS
  3326        IF USENTL > ZEROS  OR
  3327*00570            UBYL   > ZEROS  OR
  3328           UFORML > ZEROS  OR
  3329           UREL   > ZEROS
  3330              MOVE ER-0321          TO EMI-ERROR
  3331              MOVE -1               TO URECDTEL
  3332              PERFORM 9900-ERROR-FORMAT THRU  9900-EXIT.
  3333
  3334     IF NOT EMI-NO-ERRORS
  3335        GO TO 8200-SEND-DATAONLY.
  3336
  3337     IF NOT MODIFY-CAP
  3338         MOVE ER-0070            TO EMI-ERROR
  3339         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3340         MOVE LOW-VALUES TO EL162AO
  3341         GO TO 8100-SEND-INITIAL-MAP.
  3342
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL162.cbl
  3344     PERFORM 3000-BUILD-KEYS.
  3345
  3346     IF REC-DATA
  3347        PERFORM 4000-UPDATE-RECEIVE-DATES THRU 4099-EXIT
  3348                VARYING SC-INDX FROM 1 BY 1 UNTIL
  3349                SC-INDX = 5.
  3350
  3351     PERFORM 4100-CREATE-NEW-TRLR THRU 4199-EXIT.
  3352
  3353     MOVE ER-ZEROS               TO EMI-ERROR.
  3354     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  3355                                    ZIPI PHONEI.
  3356
  3357     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3358
  3359     MOVE -1                     TO SC-RECL (1).
  3360     GO TO 8200-SEND-DATAONLY.
  3361
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL162.cbl
  3363 2000-ZERO-PI-TRLR-TABLE.
  3364
  3365     MOVE +0                     TO PI-TRLRS (SUB).
  3366     ADD +1 TO SUB.
  3367
  3368     IF SUB > +50
  3369        MOVE +0                  TO SUB
  3370        GO TO 2010-EXIT.
  3371
  3372     GO TO 2000-ZERO-PI-TRLR-TABLE.
  3373
  3374 2010-EXIT.
  3375     EXIT.
  3376
  3377 3000-BUILD-KEYS.
  3378     MOVE PI-CLAIM-NO            TO PI-CLAM-CLAIM
  3379                                    PI-ACTV-CLAIM
  3380                                    CLAIMNOI.
  3381
  3382     MOVE PI-CERT-NO             TO PI-CLAM-CERT-NO
  3383                                    PI-ACTV-CERT-NO
  3384                                    CERTNOI.
  3385
  3386     MOVE PI-COMPANY-CD          TO PI-CLAM-COMP-CD
  3387                                    PI-ACTV-COMP-CD.
  3388
  3389     MOVE PI-CARRIER             TO PI-CLAM-CARRIER
  3390                                    PI-ACTV-CARRIER
  3391                                    CARRI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL162.cbl
  3393 4000-UPDATE-RECEIVE-DATES.
  3394
  3395     IF SC-RECL (SC-INDX) = ZERO AND SC-STOPL (SC-INDX)
  3396        GO TO 4099-EXIT.
  3397
  3398     MOVE SC-TRLRNO (SC-INDX)    TO PI-ACTV-SEQ.
  3399
  3400*00648      IF SC-RECL (SC-INDX) = ZERO
  3401*00649          EXEC CICS READ
  3402*00650               DATASET (ELTRLR-FILE-ID)
  3403*00651               RIDFLD  (PI-ACTV-KEY)
  3404*00652               SET     (ADDRESS OF ACTIVITY-TRAILERS)
  3405*00653          END-EXEC
  3406*00654         ELSE
  3407
  3408* EXEC CICS READ
  3409*             DATASET(ELTRLR-FILE-ID)
  3410*             RIDFLD (PI-ACTV-KEY)
  3411*             SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3412*             UPDATE
  3413*        END-EXEC.
  3414*    MOVE '&"S        EU         (   #00003364' TO DFHEIV0
  3415     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3416     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3417     MOVE X'2020233030303033333634' TO DFHEIV0(25:11)
  3418     CALL 'kxdfhei1' USING DFHEIV0,
  3419           ELTRLR-FILE-ID,
  3420           DFHEIV20,
  3421           DFHEIV99,
  3422           PI-ACTV-KEY,
  3423           DFHEIV99,
  3424           DFHEIV99,
  3425           DFHEIV99
  3426     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3427         DFHEIV20
  3428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3429
  3430
  3431     SET INDX2 TO SC-INDX.
  3432
  3433     IF SC-STOPL (SC-INDX) = ZEROS
  3434         GO TO 4000-BYPASS-STOP-DATE
  3435     END-IF.
  3436
  3437     IF (CORRESPONDENCE-TR AND
  3438         STOP-DATE-SAVE (INDX2) LESS THAN AT-LETTER-SENT-DT)
  3439              OR
  3440        (FORM-CONTROL-TR AND
  3441         STOP-DATE-SAVE (INDX2) LESS THAN AT-FORM-SEND-ON-DT)
  3442           MOVE ER-0896          TO EMI-ERROR
  3443           MOVE -1               TO SC-STOPL (SC-INDX)
  3444           MOVE AL-UABON         TO SC-STOPA (SC-INDX)
  3445           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3446
  3447* EXEC CICS SYNCPOINT
  3448*               ROLLBACK
  3449*          END-EXEC
  3450*    MOVE '6"R                   !   #00003386' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL162.cbl
  3451     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  3452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3453     MOVE X'2020233030303033333836' TO DFHEIV0(25:11)
  3454     CALL 'kxdfhei1' USING DFHEIV0
  3455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3456           GO TO 8200-SEND-DATAONLY
  3457     END-IF.
  3458
  3459     IF CORRESPONDENCE-TR
  3460        MOVE STOP-DATE-SAVE (INDX2) TO AT-STOP-LETTER-DT
  3461        MOVE PI-PROCESSOR-ID     TO AT-CORR-LAST-UPDATED-BY
  3462        MOVE BIN-CURRENT-DATE    TO AT-CORR-LAST-MAINT-DT
  3463     END-IF.
  3464
  3465     IF FORM-CONTROL-TR
  3466        MOVE STOP-DATE-SAVE (INDX2) TO AT-STOP-FORM-DT
  3467        MOVE PI-PROCESSOR-ID     TO AT-FORM-LAST-UPDATED-BY
  3468        MOVE BIN-CURRENT-DATE    TO AT-FORM-LAST-MAINT-DT
  3469     END-IF.
  3470     MOVE AL-UANOF               TO SC-STOPA (SC-INDX).
  3471
  3472 4000-BYPASS-STOP-DATE.
  3473
  3474     IF SC-RECL (SC-INDX) = ZEROS
  3475*00673         GO TO 4099-EXIT.
  3476        GO TO 4090-REWRITE
  3477     END-IF.
  3478
  3479     SET INDX TO SC-INDX.
  3480
  3481     IF (CORRESPONDENCE-TR AND
  3482         REC-DATE-SAVE (INDX)  LESS THAN AT-LETTER-SENT-DT)
  3483              OR
  3484        (FORM-CONTROL-TR AND
  3485         REC-DATE-SAVE (INDX)  LESS THAN AT-FORM-SEND-ON-DT)
  3486           MOVE ER-0514          TO EMI-ERROR
  3487           MOVE -1               TO SC-RECL (SC-INDX)
  3488           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3489           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3490
  3491* EXEC CICS SYNCPOINT
  3492*               ROLLBACK
  3493*          END-EXEC
  3494*    MOVE '6"R                   !   #00003423' TO DFHEIV0
  3495     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  3496     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3497     MOVE X'2020233030303033343233' TO DFHEIV0(25:11)
  3498     CALL 'kxdfhei1' USING DFHEIV0
  3499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3500           GO TO 8200-SEND-DATAONLY.
  3501
  3502     IF CORRESPONDENCE-TR
  3503        MOVE REC-DATE-SAVE (INDX)   TO AT-LETTER-ANSWERED-DT
  3504        MOVE PI-PROCESSOR-ID        TO AT-CORR-LAST-UPDATED-BY
  3505        MOVE BIN-CURRENT-DATE       TO AT-CORR-LAST-MAINT-DT.
  3506
  3507     IF FORM-CONTROL-TR
  3508        MOVE PI-PROCESSOR-ID        TO AT-FORM-LAST-UPDATED-BY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL162.cbl
  3509        MOVE BIN-CURRENT-DATE       TO AT-FORM-LAST-MAINT-DT
  3510        IF SC-TYPE (SC-INDX) = 'C'
  3511           MOVE REC-DATE-SAVE (INDX)   TO AT-FORM-ANSWERED-DT
  3512        ELSE
  3513        IF SC-TYPE (SC-INDX) = 'E'
  3514           MOVE REC-DATE-SAVE (INDX)   TO AT-EMP-FORM-ANSWERED-DT
  3515        ELSE
  3516        IF SC-TYPE (SC-INDX) = 'P'
  3517           MOVE REC-DATE-SAVE (INDX)   TO AT-PHY-FORM-ANSWERED-DT.
  3518
  3519     MOVE AL-UANOF               TO SC-RECA (SC-INDX).
  3520
  3521 4090-REWRITE.
  3522
  3523     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  3524
  3525     IF PI-COMPANY-ID = 'DMD'
  3526         MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY.
  3527
  3528
  3529* EXEC CICS REWRITE
  3530*         FROM   (ACTIVITY-TRAILERS)
  3531*         DATASET(ELTRLR-FILE-ID)
  3532*    END-EXEC.
  3533     MOVE LENGTH OF
  3534      ACTIVITY-TRAILERS
  3535       TO DFHEIV11
  3536*    MOVE '&& L                  %   #00003454' TO DFHEIV0
  3537     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3538     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3539     MOVE X'2020233030303033343534' TO DFHEIV0(25:11)
  3540     CALL 'kxdfhei1' USING DFHEIV0,
  3541           ELTRLR-FILE-ID,
  3542           ACTIVITY-TRAILERS,
  3543           DFHEIV11,
  3544           DFHEIV99
  3545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3546
  3547
  3548 4099-EXIT.
  3549      EXIT.
  3550
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL162.cbl
  3552 4100-CREATE-NEW-TRLR.
  3553
  3554
  3555* EXEC CICS READ
  3556*         DATASET(ELMSTR-FILE-ID)
  3557*         SET    (ADDRESS OF CLAIM-MASTER)
  3558*         RIDFLD (PI-CLAM-KEY)
  3559*         UPDATE
  3560*    END-EXEC.
  3561*    MOVE '&"S        EU         (   #00003465' TO DFHEIV0
  3562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3563     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3564     MOVE X'2020233030303033343635' TO DFHEIV0(25:11)
  3565     CALL 'kxdfhei1' USING DFHEIV0,
  3566           ELMSTR-FILE-ID,
  3567           DFHEIV20,
  3568           DFHEIV99,
  3569           PI-CLAM-KEY,
  3570           DFHEIV99,
  3571           DFHEIV99,
  3572           DFHEIV99
  3573     SET ADDRESS OF CLAIM-MASTER TO
  3574         DFHEIV20
  3575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3576
  3577
  3578     IF FILEL > ZEROS
  3579        MOVE FILEI               TO CL-FILE-LOCATION.
  3580
  3581     IF NOT UNSOL-DATA
  3582        GO TO 4150-REWRITE-CLAIM.
  3583
  3584     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  3585
  3586
  3587* EXEC CICS GETMAIN
  3588*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3589*         INITIMG(GETMAIN-SPACE)
  3590*         LENGTH (ACTV-LENGTH)
  3591*    END-EXEC.
  3592*    MOVE ',"IL                  $   #00003480' TO DFHEIV0
  3593     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3594     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3595     MOVE X'2020233030303033343830' TO DFHEIV0(25:11)
  3596     CALL 'kxdfhei1' USING DFHEIV0,
  3597           DFHEIV20,
  3598           ACTV-LENGTH,
  3599           GETMAIN-SPACE
  3600     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3601         DFHEIV20
  3602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3603
  3604
  3605     MOVE 'AT'                   TO AT-RECORD-ID.
  3606     MOVE  4                     TO AT-TRAILER-TYPE.
  3607     MOVE BIN-CURRENT-DATE       TO AT-RECORDED-DT
  3608                                    AT-CORR-LAST-MAINT-DT
  3609
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL162.cbl
  3610     IF UBYL > +0
  3611        MOVE UBYI                TO AT-RECORDED-BY
  3612                                    AT-CORR-LAST-UPDATED-BY
  3613     ELSE
  3614        MOVE PI-PROCESSOR-ID     TO AT-RECORDED-BY
  3615                                    AT-CORR-LAST-UPDATED-BY.
  3616
  3617     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  3618     MOVE PI-ACTV-KEY            TO AT-CONTROL-PRIMARY.
  3619     MOVE PI-CLAIM-NO            TO AT-CLAIM-NO.
  3620     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
  3621     MOVE USENT-SAVE             TO AT-LETTER-SENT-DT.
  3622     MOVE LOW-VALUES             TO AT-RECEIPT-FOLLOW-UP
  3623                                    AT-AUTO-RE-SEND-DT
  3624                                    AT-INITIAL-PRINT-DATE
  3625                                    AT-RESEND-PRINT-DATE.
  3626     MOVE URECDTE-SAVE           TO AT-LETTER-ANSWERED-DT.
  3627     MOVE ZEROS                  TO AT-LETTER-ARCHIVE-NO.
  3628     MOVE '1'                    TO AT-LETTER-ORIGIN.
  3629
  3630     IF UFORML > 0
  3631        MOVE UFORMI              TO AT-STD-LETTER-FORM
  3632       ELSE
  3633        MOVE SPACES              TO AT-STD-LETTER-FORM.
  3634
  3635     IF UREL > 0
  3636        MOVE UREI                TO AT-REASON-TEXT
  3637       ELSE
  3638        MOVE SPACES              TO AT-REASON-TEXT.
  3639
  3640     MOVE SPACES                 TO AT-ADDRESSEE-NAME
  3641                                    AT-ADDRESEE-TYPE.
  3642     MOVE ZEROS                  TO AT-ADDRESS-REC-SEQ-NO.
  3643     MOVE 'U'                    TO AT-CORR-SOL-UNSOL.
  3644
  3645
  3646* EXEC CICS WRITE
  3647*         DATASET(ELTRLR-FILE-ID)
  3648*         FROM   (ACTIVITY-TRAILERS)
  3649*         RIDFLD (AT-CONTROL-PRIMARY)
  3650*    END-EXEC.
  3651     MOVE LENGTH OF
  3652      ACTIVITY-TRAILERS
  3653       TO DFHEIV11
  3654*    MOVE '&$ L                  ''   #00003526' TO DFHEIV0
  3655     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3656     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3657     MOVE X'2020233030303033353236' TO DFHEIV0(25:11)
  3658     CALL 'kxdfhei1' USING DFHEIV0,
  3659           ELTRLR-FILE-ID,
  3660           ACTIVITY-TRAILERS,
  3661           DFHEIV11,
  3662           AT-CONTROL-PRIMARY,
  3663           DFHEIV99,
  3664           DFHEIV99
  3665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3666
  3667
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL162.cbl
  3668     MOVE SPACES                 TO URECDTEI
  3669                                    USENTI
  3670*00795                                     UBYI
  3671                                    UFORMI
  3672                                    UREI.
  3673
  3674     MOVE AL-UANOF               TO URECDTEA
  3675                                    USENTA
  3676*00801                                     UBYA
  3677                                    UFORMA
  3678                                    UREA.
  3679
  3680     MOVE PI-PROCESSOR-ID        TO UBYI.
  3681
  3682 4150-REWRITE-CLAIM.
  3683
  3684* EXEC CICS HANDLE CONDITION
  3685*        DUPKEY (4199-EXIT)
  3686*    END-EXEC.
  3687*    MOVE '"$$                   ! # #00003547' TO DFHEIV0
  3688     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  3689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3690     MOVE X'2320233030303033353437' TO DFHEIV0(25:11)
  3691     CALL 'kxdfhei1' USING DFHEIV0
  3692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3693
  3694
  3695     MOVE PI-PROCESSOR-ID   TO  CL-LAST-MAINT-USER.
  3696     MOVE EIBTIME           TO  CL-LAST-MAINT-HHMMSS.
  3697     MOVE BIN-CURRENT-DATE  TO  CL-LAST-MAINT-DT.
  3698     MOVE '2'               TO  CL-LAST-MAINT-TYPE.
  3699
  3700     IF PI-COMPANY-ID = 'DMD'
  3701         MOVE 11                 TO CL-ACTIVITY-CODE
  3702         MOVE BIN-CURRENT-DATE   TO CL-ACTIVITY-MAINT-DT
  3703         MOVE 'CORR'             TO CL-ACTIVITY-MAINT-TYPE
  3704         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID.
  3705
  3706
  3707* EXEC CICS REWRITE
  3708*         DATASET(ELMSTR-FILE-ID)
  3709*         FROM   (CLAIM-MASTER)
  3710*    END-EXEC.
  3711     MOVE LENGTH OF
  3712      CLAIM-MASTER
  3713       TO DFHEIV11
  3714*    MOVE '&& L                  %   #00003562' TO DFHEIV0
  3715     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3716     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3717     MOVE X'2020233030303033353632' TO DFHEIV0(25:11)
  3718     CALL 'kxdfhei1' USING DFHEIV0,
  3719           ELMSTR-FILE-ID,
  3720           CLAIM-MASTER,
  3721           DFHEIV11,
  3722           DFHEIV99
  3723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3724
  3725
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL162.cbl
  3726 4199-EXIT.
  3727      EXIT.
  3728
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL162.cbl
  3730 4200-LOCATE-ADDRESS.
  3731     IF ADDR-TYPE = '3' AND ADDR-SEQ = ZEROS
  3732        GO TO 4210-READ-ACCOUNT.
  3733
  3734     IF ADDR-TYPE = SPACES OR ADDR-SEQ = ZEROS
  3735        GO TO 4290-ERROR.
  3736
  3737     MOVE ADDR-SEQ               TO PI-ACTV-SEQ.
  3738
  3739
  3740* EXEC CICS HANDLE CONDITION
  3741*         NOTFND(4290-ERROR)
  3742*    END-EXEC.
  3743*    MOVE '"$I                   ! $ #00003580' TO DFHEIV0
  3744     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3746     MOVE X'2420233030303033353830' TO DFHEIV0(25:11)
  3747     CALL 'kxdfhei1' USING DFHEIV0
  3748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3749
  3750
  3751
  3752* EXEC CICS READ
  3753*         DATASET(ELTRLR-FILE-ID)
  3754*         RIDFLD (PI-ACTV-KEY)
  3755*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3756*    END-EXEC.
  3757*    MOVE '&"S        E          (   #00003584' TO DFHEIV0
  3758     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3759     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3760     MOVE X'2020233030303033353834' TO DFHEIV0(25:11)
  3761     CALL 'kxdfhei1' USING DFHEIV0,
  3762           ELTRLR-FILE-ID,
  3763           DFHEIV20,
  3764           DFHEIV99,
  3765           PI-ACTV-KEY,
  3766           DFHEIV99,
  3767           DFHEIV99,
  3768           DFHEIV99
  3769     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3770         DFHEIV20
  3771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3772
  3773
  3774     MOVE AT-MAIL-TO-NAME        TO ADDR1O.
  3775     MOVE AT-ADDRESS-LINE-1      TO ADDR2O.
  3776     MOVE AT-ADDRESS-LINE-2      TO ADDR3O.
  3777*    MOVE AT-CITY-STATE          TO ADDR4O.
  3778     STRING AT-CITY ' ' AT-STATE
  3779        DELIMITED BY '  ' INTO ADDR4O
  3780     END-STRING
  3781     MOVE AT-PHONE-NO            TO PHONEO.
  3782     INSPECT PHONEI CONVERTING ' ' TO '-'.
  3783
  3784     IF AT-CANADIAN-POST-CODE
  3785         MOVE AT-CAN-POSTAL-1    TO WS-CAN-POSTAL-CD-1
  3786         MOVE AT-CAN-POSTAL-2    TO WS-CAN-POSTAL-CD-2
  3787         MOVE SPACES             TO WS-DASH-CAN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL162.cbl
  3788                                    WS-CAN-FILLER
  3789         MOVE WS-CANADIAN-POSTAL-CODES
  3790                                 TO ZIPO
  3791     ELSE
  3792         MOVE AT-ZIP-CODE        TO WS-ZIP-CODE
  3793         IF AT-ZIP-PLUS4 = SPACES OR ZEROS
  3794             MOVE SPACES         TO WS-ZIP-PLUS4
  3795                                    WS-DASH
  3796             MOVE WS-ZIP         TO ZIPO
  3797         ELSE
  3798             MOVE AT-ZIP-PLUS4   TO WS-ZIP-PLUS4
  3799             MOVE '-'            TO WS-DASH
  3800             MOVE WS-ZIP         TO ZIPO.
  3801
  3802     GO TO 4299-EXIT.
  3803
  3804 4210-READ-ACCOUNT.
  3805     MOVE PI-COMPANY-CD          TO ACCT-CO.
  3806     MOVE PI-CARRIER             TO ACCT-CARRIER.
  3807     MOVE PI-GROUPING            TO ACCT-GROUPING.
  3808     MOVE PI-STATE               TO ACCT-STATE.
  3809     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  3810     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DATE.
  3811
  3812
  3813* EXEC CICS HANDLE CONDITION
  3814*         NOTOPEN(8880-ACCT-NOT-OPEN)
  3815*         NOTFND (4250-ACCT-NOT-FOUND)
  3816*    END-EXEC.
  3817*    MOVE '"$JI                  ! % #00003628' TO DFHEIV0
  3818     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  3819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3820     MOVE X'2520233030303033363238' TO DFHEIV0(25:11)
  3821     CALL 'kxdfhei1' USING DFHEIV0
  3822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3823
  3824
  3825
  3826* EXEC CICS STARTBR
  3827*         RIDFLD   (ACCT-KEY)
  3828*         DATASET  (ERACCT-FILE-ID)
  3829*         KEYLENGTH(13)
  3830*         GENERIC
  3831*    END-EXEC.
  3832     MOVE 13
  3833       TO DFHEIV11
  3834     MOVE 0
  3835       TO DFHEIV12
  3836*    MOVE '&,   KG    G          &   #00003633' TO DFHEIV0
  3837     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3838     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3839     MOVE X'2020233030303033363333' TO DFHEIV0(25:11)
  3840     CALL 'kxdfhei1' USING DFHEIV0,
  3841           ERACCT-FILE-ID,
  3842           ACCT-KEY,
  3843           DFHEIV11,
  3844           DFHEIV12,
  3845           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL162.cbl
  3846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3847
  3848
  3849     MOVE ACCT-PARTIAL-KEY       TO ACCT-SAVE-KEY.
  3850
  3851 4230-READNEXT.
  3852
  3853* EXEC CICS READNEXT
  3854*         DATASET(ERACCT-FILE-ID)
  3855*         SET    (ADDRESS OF ACCOUNT-MASTER)
  3856*         RIDFLD (ACCT-KEY)
  3857*    END-EXEC.
  3858     MOVE 0
  3859       TO DFHEIV11
  3860*    MOVE '&.S                   )   #00003643' TO DFHEIV0
  3861     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3862     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3863     MOVE X'2020233030303033363433' TO DFHEIV0(25:11)
  3864     CALL 'kxdfhei1' USING DFHEIV0,
  3865           ERACCT-FILE-ID,
  3866           DFHEIV20,
  3867           DFHEIV99,
  3868           ACCT-KEY,
  3869           DFHEIV99,
  3870           DFHEIV11,
  3871           DFHEIV99,
  3872           DFHEIV99
  3873     SET ADDRESS OF ACCOUNT-MASTER TO
  3874         DFHEIV20
  3875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3876
  3877
  3878     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
  3879        GO TO 4250-ACCT-NOT-FOUND.
  3880
  3881     IF PI-CERT-EFF-DT NOT LESS THAN AM-EFFECTIVE-DT AND
  3882        PI-CERT-EFF-DT     LESS THAN AM-EXPIRATION-DT
  3883        NEXT SENTENCE
  3884      ELSE
  3885        GO TO 4230-READNEXT.
  3886
  3887     MOVE AM-NAME                TO ADDR1O.
  3888     MOVE AM-PERSON              TO ADDR2O.
  3889     MOVE AM-ADDRS               TO ADDR3O.
  3890*    MOVE AM-CITY                TO ADDR4O.
  3891     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3892        DELIMITED BY '  ' INTO ADDR4O
  3893     END-STRING
  3894
  3895     MOVE AM-TEL-NO              TO WS-WORK-PHONE.
  3896     INSPECT WS-WORK-PHONE CONVERTING ' ' TO '0'.
  3897     MOVE WS-NUMERIC-PHONE       TO PHONEO.
  3898     INSPECT PHONEI CONVERTING ' ' TO '-'.
  3899
  3900     IF AM-CANADIAN-POST-CODE
  3901         MOVE AM-CAN-POSTAL-1    TO WS-CAN-POSTAL-CD-1
  3902         MOVE AM-CAN-POSTAL-2    TO WS-CAN-POSTAL-CD-2
  3903         MOVE SPACES             TO WS-DASH-CAN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL162.cbl
  3904                                    WS-CAN-FILLER
  3905         MOVE WS-CANADIAN-POSTAL-CODES
  3906                                 TO ZIPO
  3907     ELSE
  3908         MOVE AM-ZIP-PRIME       TO WS-ZIP-CODE
  3909         IF AM-ZIP-PLUS4 = SPACES OR ZEROS
  3910             MOVE SPACES         TO WS-ZIP-PLUS4
  3911                                    WS-DASH
  3912             MOVE WS-ZIP         TO ZIPO
  3913         ELSE
  3914             MOVE AM-ZIP-PLUS4   TO WS-ZIP-PLUS4
  3915             MOVE '-'            TO WS-DASH
  3916             MOVE WS-ZIP         TO ZIPO.
  3917
  3918     PERFORM 4240-ENDBR.
  3919
  3920     GO TO 4299-EXIT.
  3921
  3922 4240-ENDBR.
  3923
  3924* EXEC CICS ENDBR
  3925*         DATASET(ERACCT-FILE-ID)
  3926*    END-EXEC.
  3927     MOVE 0
  3928       TO DFHEIV11
  3929*    MOVE '&2                    $   #00003694' TO DFHEIV0
  3930     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3931     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3932     MOVE X'2020233030303033363934' TO DFHEIV0(25:11)
  3933     CALL 'kxdfhei1' USING DFHEIV0,
  3934           ERACCT-FILE-ID,
  3935           DFHEIV11,
  3936           DFHEIV99
  3937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3938
  3939
  3940 4250-ACCT-NOT-FOUND.
  3941     PERFORM 4240-ENDBR.
  3942     MOVE ER-0179                TO EMI-ERROR.
  3943     MOVE -1                     TO SC-RECL (1).
  3944     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  3945                                    ZIPI PHONEI.
  3946
  3947     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3948
  3949 4290-ERROR.
  3950     MOVE ER-0322                TO EMI-ERROR.
  3951     MOVE -1                     TO SC-RECL (1).
  3952     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  3953                                    ZIPI PHONEI.
  3954
  3955     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3956
  3957 4299-EXIT.
  3958      EXIT.
  3959
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL162.cbl
  3961 6000-BROWSE-FORWARD.
  3962     IF PI-ACTV-SAVE NOT = PI-ACTV-PARTIAL
  3963        MOVE ER-0066             TO EMI-ERROR
  3964        MOVE -1                  TO SC-RECL (1)
  3965        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3966        GO TO 8200-SEND-DATAONLY.
  3967
  3968     MOVE LOW-VALUES             TO EL162AI.
  3969     ADD 1 TO PI-ACTV-SEQ.
  3970
  3971     GO TO 7000-BUILD-SCREEN.
  3972
  3973 6100-BROWSE-BACKWARD.
  3974
  3975     IF PI-NEXT-TRLR-SUB > 8
  3976        SUBTRACT 4 FROM PI-NEXT-TRLR-SUB.
  3977
  3978     MOVE PI-NEXT-TRLR-SUB       TO SUB.
  3979
  3980     IF SUB = 1 OR 5
  3981        MOVE ER-0067             TO EMI-ERROR
  3982        MOVE -1                  TO SC-RECL (1)
  3983        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3984        MOVE  1                  TO SUB
  3985        MOVE  +1                 TO PI-NEXT-TRLR-SUB
  3986     ELSE
  3987        SUBTRACT 4 FROM SUB
  3988        MOVE SUB                 TO PI-NEXT-TRLR-SUB.
  3989
  3990     MOVE LOW-VALUES             TO EL162AI
  3991                                    TRL-LINES.
  3992     MOVE PI-ACTV-SAVE           TO PI-ACTV-PARTIAL.
  3993
  3994     MOVE PI-TRLRS (SUB)         TO PI-ACTV-SEQ.
  3995
  3996     GO TO 7000-BUILD-SCREEN.
  3997
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL162.cbl
  3999 6200-FORMAT-DATA.
  4000
  4001     IF FORM-CONTROL-TR
  4002        GO TO 6250-FORMAT-FORM.
  4003
  4004     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES
  4005        MOVE AT-LETTER-ANSWERED-DT TO DC-BIN-DATE-1
  4006        MOVE SPACES                TO DC-OPTION-CODE
  4007        PERFORM 9700-DATE-LINK
  4008        MOVE DC-GREG-DATE-1-EDIT   TO SC-REC (SC-INDX).
  4009
  4010     IF AT-STOP-LETTER-DT NOT = LOW-VALUES AND SPACES
  4011        MOVE AT-STOP-LETTER-DT     TO DC-BIN-DATE-1
  4012        MOVE SPACES                TO DC-OPTION-CODE
  4013        PERFORM 9700-DATE-LINK
  4014        MOVE DC-GREG-DATE-1-EDIT   TO SC-STOP (SC-INDX)
  4015     END-IF.
  4016
  4017     IF AT-LETTER-SENT-DT NOT = LOW-VALUES
  4018        MOVE AT-LETTER-SENT-DT   TO DC-BIN-DATE-1
  4019        MOVE SPACES              TO DC-OPTION-CODE
  4020        PERFORM 9700-DATE-LINK
  4021        MOVE DC-GREG-DATE-1-EDIT TO SC-SENT (SC-INDX).
  4022
  4023     IF AT-AUTO-RE-SEND-DT NOT = LOW-VALUES
  4024        MOVE AT-AUTO-RE-SEND-DT  TO DC-BIN-DATE-1
  4025        MOVE SPACES              TO DC-OPTION-CODE
  4026        PERFORM 9700-DATE-LINK
  4027        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4028
  4029     IF AT-RECEIPT-FOLLOW-UP NOT = LOW-VALUES
  4030        MOVE AT-RECEIPT-FOLLOW-UP TO DC-BIN-DATE-1
  4031        MOVE SPACES               TO DC-OPTION-CODE
  4032        PERFORM 9700-DATE-LINK
  4033        MOVE DC-GREG-DATE-1-EDIT  TO SC-FOLLOWUP (SC-INDX).
  4034
  4035     MOVE AT-STD-LETTER-FORM     TO SC-FORM (SC-INDX).
  4036
  4037     IF INSURED-ADDRESEE
  4038        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4039     ELSE
  4040     IF BENEFICIARY-ADDRESEE
  4041        MOVE 'BENEFI '           TO SC-TO (SC-INDX)
  4042     ELSE
  4043     IF ACCOUNT-ADDRESEE
  4044        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4045     ELSE
  4046     IF PHYSICIAN-ADDRESEE
  4047        MOVE 'DOCTOR'            TO SC-TO (SC-INDX)
  4048     ELSE
  4049     IF EMPLOYER-ADDRESEE
  4050        MOVE 'EMPLOYER'          TO SC-TO (SC-INDX)
  4051     ELSE
  4052     IF OTHER-ADDRESEE-1
  4053        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4054     ELSE
  4055        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4056
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL162.cbl
  4057     IF AT-LETTER-ARCHIVE-NO NOT = +0
  4058        MOVE AT-LETTER-ARCHIVE-NO TO SC-ARCHIVE (SC-INDX)
  4059     ELSE
  4060        MOVE SPACES              TO SC-ARCHIVE (SC-INDX).
  4061
  4062     MOVE 'L'                    TO SC-TYPE   (SC-INDX).
  4063
  4064     MOVE AT-REASON-TEXT         TO SC-REASON (SC-INDX).
  4065
  4066*    IF PI-COMPANY-ID = 'DMD'
  4067*       IF AT-DMD-LETTER-PURGED
  4068*          MOVE AT-REASON-TEXT          TO WS-REASON
  4069*          MOVE AT-DMD-LETTER-PURGE-DT  TO DC-BIN-DATE-1
  4070*          MOVE SPACES                  TO DC-OPTION-CODE
  4071*          PERFORM 9700-DATE-LINK
  4072*          MOVE 'PURGED -'              TO WS-REASON (51:9)
  4073*          MOVE DC-GREG-DATE-1-EDIT     TO WS-REASON (60:11)
  4074*          MOVE WS-REASON               TO SC-REASON (SC-INDX).
  4075*
  4076     MOVE AT-RECORDED-BY         TO SC-BY     (SC-INDX).
  4077     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO (SC-INDX).
  4078     MOVE AL-UANOF               TO SC-RECA   (SC-INDX)
  4079                                    SC-STOPA  (SC-INDX).
  4080
  4081     GO TO 6299-EXIT.
  4082
  4083 6250-FORMAT-FORM.
  4084
  4085     IF AT-STOP-FORM-DT NOT = LOW-VALUES AND SPACES
  4086        MOVE AT-STOP-FORM-DT       TO DC-BIN-DATE-1
  4087        MOVE SPACES                TO DC-OPTION-CODE
  4088        PERFORM 9700-DATE-LINK
  4089        MOVE DC-GREG-DATE-1-EDIT   TO SC-STOP (SC-INDX)
  4090     END-IF.
  4091
  4092     IF AT-FORM-SEND-ON-DT NOT = LOW-VALUES
  4093        IF (AT-FORM-ANSWERED-DT = LOW-VALUES)
  4094                         OR
  4095           (AT-FORM-ANSWERED-DT NOT = LOW-VALUES  AND
  4096            AT-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4097             NEXT SENTENCE
  4098         ELSE
  4099             GO TO 6260-CHECK-EMPLOYER-FORM
  4100     ELSE
  4101        GO TO 6260-CHECK-EMPLOYER-FORM.
  4102
  4103     IF AT-FORM-ANSWERED-DT NOT = LOW-VALUES
  4104        MOVE AT-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4105        MOVE SPACES              TO DC-OPTION-CODE
  4106        PERFORM 9700-DATE-LINK
  4107        MOVE DC-GREG-DATE-1-EDIT TO SC-REC (SC-INDX).
  4108
  4109     IF AT-FORM-SEND-ON-DT NOT = LOW-VALUES
  4110        MOVE AT-FORM-SEND-ON-DT  TO DC-BIN-DATE-1
  4111        MOVE SPACES              TO DC-OPTION-CODE
  4112        PERFORM 9700-DATE-LINK
  4113        MOVE DC-GREG-DATE-1-EDIT TO SC-SENT (SC-INDX).
  4114
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL162.cbl
  4115     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4116        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4117        MOVE SPACES              TO DC-OPTION-CODE
  4118        PERFORM 9700-DATE-LINK
  4119        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4120
  4121     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4122        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4123        MOVE SPACES                 TO DC-OPTION-CODE
  4124        PERFORM 9700-DATE-LINK
  4125        MOVE DC-GREG-DATE-1-EDIT TO SC-FOLLOWUP (SC-INDX).
  4126
  4127     IF AT-FORM-TYPE = '1'
  4128        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4129     ELSE
  4130        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4131
  4132     IF FORM-TO-INSURED
  4133        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4134     ELSE
  4135     IF FORM-TO-ACCOUNT
  4136        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4137     ELSE
  4138     IF FORM-TO-OTHER-1
  4139        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4140     ELSE
  4141     IF FORM-TO-OTHER-2
  4142        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4143
  4144     MOVE 'CLAIMANT'             TO SC-ARCHIVE (SC-INDX).
  4145     MOVE 'C'                    TO SC-TYPE    (SC-INDX).
  4146     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4147     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4148     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4149     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4150     MOVE AL-UANOF               TO SC-RECA    (SC-INDX).
  4151     MOVE AL-UANOF               TO SC-STOPA   (SC-INDX).
  4152
  4153 6260-CHECK-EMPLOYER-FORM.
  4154
  4155     IF AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES
  4156        IF (AT-EMP-FORM-ANSWERED-DT = LOW-VALUES)
  4157                          OR
  4158           (AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4159            AT-EMP-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4160              NEXT SENTENCE
  4161          ELSE
  4162              GO TO 6280-CHECK-PHYSICIAN-FORM
  4163     ELSE
  4164        GO TO 6280-CHECK-PHYSICIAN-FORM.
  4165
  4166     IF SC-TYPE (SC-INDX) = 'C'
  4167        SET SC-INDX UP BY 1
  4168        ADD +1 TO PI-NEXT-TRLR-SUB.
  4169
  4170     IF AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES
  4171        MOVE AT-EMP-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4172        MOVE SPACES                  TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL162.cbl
  4173        PERFORM 9700-DATE-LINK
  4174        MOVE DC-GREG-DATE-1-EDIT     TO SC-REC (SC-INDX).
  4175
  4176     IF AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES
  4177        MOVE AT-EMP-FORM-SEND-ON-DT TO DC-BIN-DATE-1
  4178        MOVE SPACES                 TO DC-OPTION-CODE
  4179        PERFORM 9700-DATE-LINK
  4180        MOVE DC-GREG-DATE-1-EDIT    TO SC-SENT (SC-INDX).
  4181
  4182     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4183        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4184        MOVE SPACES              TO DC-OPTION-CODE
  4185        PERFORM 9700-DATE-LINK
  4186        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4187
  4188     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4189        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4190        MOVE SPACES                 TO DC-OPTION-CODE
  4191        PERFORM 9700-DATE-LINK
  4192        MOVE DC-GREG-DATE-1-EDIT    TO SC-FOLLOWUP (SC-INDX).
  4193
  4194     IF AT-FORM-TYPE = '1'
  4195        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4196     ELSE
  4197        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4198
  4199     IF FORM-TO-INSURED
  4200        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4201     ELSE
  4202     IF FORM-TO-ACCOUNT
  4203        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4204     ELSE
  4205     IF FORM-TO-OTHER-1
  4206        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4207     ELSE
  4208     IF FORM-TO-OTHER-2
  4209        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4210
  4211     MOVE 'EMPLOYER'             TO SC-ARCHIVE (SC-INDX).
  4212     MOVE 'E'                    TO SC-TYPE    (SC-INDX).
  4213     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4214     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4215     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4216     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4217     MOVE AL-UANOF               TO SC-RECA    (SC-INDX)
  4218                                    SC-STOPA   (SC-INDX).
  4219
  4220 6280-CHECK-PHYSICIAN-FORM.
  4221
  4222     IF AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES
  4223        IF (AT-PHY-FORM-ANSWERED-DT = LOW-VALUES)
  4224                         OR
  4225           (AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4226            AT-PHY-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4227              NEXT SENTENCE
  4228          ELSE
  4229              GO TO 6299-EXIT
  4230     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL162.cbl
  4231        GO TO 6299-EXIT.
  4232
  4233     IF SC-TYPE (SC-INDX) = 'C' OR 'E'
  4234        SET SC-INDX UP BY 1
  4235        ADD +1 TO PI-NEXT-TRLR-SUB.
  4236
  4237     IF AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES
  4238        MOVE AT-PHY-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4239        MOVE SPACES                  TO DC-OPTION-CODE
  4240        PERFORM 9700-DATE-LINK
  4241        MOVE DC-GREG-DATE-1-EDIT     TO SC-REC (SC-INDX).
  4242
  4243     IF AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES
  4244        MOVE AT-PHY-FORM-SEND-ON-DT TO DC-BIN-DATE-1
  4245        MOVE SPACES                 TO DC-OPTION-CODE
  4246        PERFORM 9700-DATE-LINK
  4247        MOVE DC-GREG-DATE-1-EDIT    TO SC-SENT (SC-INDX).
  4248
  4249     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4250        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4251        MOVE SPACES              TO DC-OPTION-CODE
  4252        PERFORM 9700-DATE-LINK
  4253        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4254
  4255     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4256        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4257        MOVE SPACES                 TO DC-OPTION-CODE
  4258        PERFORM 9700-DATE-LINK
  4259        MOVE DC-GREG-DATE-1-EDIT    TO SC-FOLLOWUP (SC-INDX).
  4260
  4261     IF AT-FORM-TYPE = '1'
  4262        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4263     ELSE
  4264        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4265
  4266     IF FORM-TO-INSURED
  4267        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4268     ELSE
  4269     IF FORM-TO-ACCOUNT
  4270        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4271     ELSE
  4272     IF FORM-TO-OTHER-1
  4273        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4274     ELSE
  4275     IF FORM-TO-OTHER-2
  4276        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4277
  4278     MOVE ' DOCTOR '             TO SC-ARCHIVE (SC-INDX).
  4279     MOVE 'P'                    TO SC-TYPE    (SC-INDX).
  4280     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4281     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4282     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4283     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4284     MOVE AL-UANOF               TO SC-RECA    (SC-INDX)
  4285                                    SC-STOPA   (SC-INDX).
  4286
  4287 6299-EXIT.
  4288      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL162.cbl
  4289
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL162.cbl
  4291 7000-BUILD-SCREEN.
  4292
  4293     IF PI-CLAIM-NO = SPACES
  4294        MOVE ER-0319             TO EMI-ERROR
  4295        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4296        GO TO 8100-SEND-INITIAL-MAP.
  4297
  4298     PERFORM 3000-BUILD-KEYS.
  4299
  4300     MOVE PI-PROCESSOR-ID        TO UBYI.
  4301
  4302
  4303* EXEC CICS HANDLE CONDITION
  4304*         NOTOPEN(8870-CLAIM-NOT-OPEN)
  4305*         NOTFND (8860-CLAIM-NOT-FOUND)
  4306*    END-EXEC.
  4307*    MOVE '"$JI                  ! & #00004060' TO DFHEIV0
  4308     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4310     MOVE X'2620233030303034303630' TO DFHEIV0(25:11)
  4311     CALL 'kxdfhei1' USING DFHEIV0
  4312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4313
  4314
  4315
  4316* EXEC CICS READ
  4317*         DATASET(ELMSTR-FILE-ID)
  4318*         RIDFLD (PI-CLAM-KEY)
  4319*         SET    (ADDRESS OF CLAIM-MASTER)
  4320*    END-EXEC.
  4321*    MOVE '&"S        E          (   #00004065' TO DFHEIV0
  4322     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4323     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4324     MOVE X'2020233030303034303635' TO DFHEIV0(25:11)
  4325     CALL 'kxdfhei1' USING DFHEIV0,
  4326           ELMSTR-FILE-ID,
  4327           DFHEIV20,
  4328           DFHEIV99,
  4329           PI-CLAM-KEY,
  4330           DFHEIV99,
  4331           DFHEIV99,
  4332           DFHEIV99
  4333     SET ADDRESS OF CLAIM-MASTER TO
  4334         DFHEIV20
  4335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4336
  4337
  4338     EVALUATE TRUE
  4339     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  4340        MOVE PI-LIFE-OVERRIDE-L6 TO TYPEI
  4341     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
  4342        MOVE PI-AH-OVERRIDE-L6   TO TYPEI
  4343     WHEN CL-CLAIM-TYPE = 'I'
  4344        MOVE ' IU   '            TO TYPEI
  4345     WHEN CL-CLAIM-TYPE = 'G'
  4346        MOVE ' GAP  '            TO TYPEI
  4347     END-EVALUATE
  4348
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL162.cbl
  4349     MOVE CL-INSURED-LAST-NAME   TO LASTNMEI.
  4350     MOVE CL-FILE-LOCATION       TO FILEI.
  4351     MOVE PI-ACTV-PARTIAL        TO PI-ACTV-SAVE.
  4352
  4353     IF CL-1ST-TRL-AVAIL
  4354        GO TO 7100-NOT-FOUND.
  4355
  4356 7010-START-BROWSE.
  4357
  4358
  4359* EXEC CICS HANDLE CONDITION
  4360*         NOTOPEN(8820-ACTV-NOT-OPEN)
  4361*         NOTFND (7100-NOT-FOUND)
  4362*         ENDFILE(7100-NOT-FOUND)
  4363*    END-EXEC.
  4364*    MOVE '"$JI''                 ! '' #00004091' TO DFHEIV0
  4365     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4367     MOVE X'2720233030303034303931' TO DFHEIV0(25:11)
  4368     CALL 'kxdfhei1' USING DFHEIV0
  4369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4370
  4371
  4372
  4373* EXEC CICS STARTBR
  4374*         DATASET(ELTRLR-FILE-ID)
  4375*         RIDFLD (PI-ACTV-KEY)
  4376*         GTEQ
  4377*    END-EXEC.
  4378     MOVE 0
  4379       TO DFHEIV11
  4380*    MOVE '&,         G          &   #00004097' TO DFHEIV0
  4381     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4382     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4383     MOVE X'2020233030303034303937' TO DFHEIV0(25:11)
  4384     CALL 'kxdfhei1' USING DFHEIV0,
  4385           ELTRLR-FILE-ID,
  4386           PI-ACTV-KEY,
  4387           DFHEIV99,
  4388           DFHEIV11,
  4389           DFHEIV99
  4390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4391
  4392
  4393     SET SC-INDX TO 1.
  4394
  4395 7020-READ-NEXT.
  4396
  4397
  4398* EXEC CICS READNEXT
  4399*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  4400*         RIDFLD   (PI-ACTV-KEY)
  4401*         DATASET  (ELTRLR-FILE-ID)
  4402*    END-EXEC.
  4403     MOVE 0
  4404       TO DFHEIV11
  4405*    MOVE '&.S                   )   #00004107' TO DFHEIV0
  4406     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL162.cbl
  4407     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4408     MOVE X'2020233030303034313037' TO DFHEIV0(25:11)
  4409     CALL 'kxdfhei1' USING DFHEIV0,
  4410           ELTRLR-FILE-ID,
  4411           DFHEIV20,
  4412           DFHEIV99,
  4413           PI-ACTV-KEY,
  4414           DFHEIV99,
  4415           DFHEIV11,
  4416           DFHEIV99,
  4417           DFHEIV99
  4418     SET ADDRESS OF ACTIVITY-TRAILERS TO
  4419         DFHEIV20
  4420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4421
  4422
  4423     IF PI-ACTV-PARTIAL NOT = PI-ACTV-SAVE
  4424        GO TO 7100-NOT-FOUND.
  4425
  4426     IF AT-TRAILER-TYPE = '4' OR  'A'
  4427        NEXT SENTENCE
  4428     ELSE
  4429        GO TO 7020-READ-NEXT.
  4430
  4431     IF CORRESPONDENCE-TR
  4432        IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND
  4433           AT-LETTER-ANSWERED-DT NOT = BIN-CURRENT-DATE
  4434             GO TO 7020-READ-NEXT.
  4435
  4436     IF CORRESPONDENCE-TR AND
  4437        AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND
  4438        AT-RESEND-LETTER-FORM NOT = LOW-VALUES
  4439             GO TO 7020-READ-NEXT
  4440     END-IF.
  4441
  4442     IF CORRESPONDENCE-TR AND
  4443        AT-STOP-LETTER-DT NOT = LOW-VALUES AND
  4444        AT-STOP-LETTER-DT NOT = SPACES AND
  4445        AT-STOP-LETTER-DT NOT = BIN-CURRENT-DATE
  4446*        AT-STOP-LETTER-DT = AT-LETTER-SENT-DT
  4447             GO TO 7020-READ-NEXT
  4448     END-IF.
  4449
  4450     IF NOT FORM-CONTROL-TR
  4451        GO TO 7030-CONTINUE.
  4452
  4453     IF ((AT-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4454          AT-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4455          AT-FORM-SEND-ON-DT = LOW-VALUES)
  4456       AND
  4457        ((AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4458          AT-EMP-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4459          AT-EMP-FORM-SEND-ON-DT = LOW-VALUES)
  4460       AND
  4461        ((AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4462          AT-PHY-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4463          AT-PHY-FORM-SEND-ON-DT = LOW-VALUES)
  4464             GO TO 7020-READ-NEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL162.cbl
  4465
  4466     IF (AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES) AND
  4467        (AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES)
  4468        IF SC-INDX > 2
  4469           MOVE PI-ACTV-SAVE-SEQ TO PI-ACTV-SEQ
  4470           GO TO 7040-END-BUILD-SCREEN.
  4471
  4472     IF (AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES) OR
  4473        (AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES)
  4474        IF SC-INDX > 3
  4475           MOVE PI-ACTV-SAVE-SEQ TO PI-ACTV-SEQ
  4476           GO TO 7040-END-BUILD-SCREEN.
  4477
  4478 7030-CONTINUE.
  4479
  4480     PERFORM 6200-FORMAT-DATA THRU 6299-EXIT.
  4481
  4482     MOVE PI-ACTV-SEQ             TO PI-ACTV-SAVE-SEQ.
  4483
  4484     MOVE AT-SEQUENCE-NO          TO PI-TRLRS (PI-NEXT-TRLR-SUB).
  4485
  4486     ADD 1   TO PI-NEXT-TRLR-SUB.
  4487     SET SC-INDX UP BY 1.
  4488
  4489     IF SC-INDX NOT = 5
  4490        GO TO 7020-READ-NEXT.
  4491
  4492 7040-END-BUILD-SCREEN.
  4493
  4494     IF SC-INDX = +2
  4495        ADD +3 TO PI-NEXT-TRLR-SUB
  4496     ELSE
  4497     IF SC-INDX = +3
  4498        ADD +2 TO PI-NEXT-TRLR-SUB
  4499     ELSE
  4500     IF SC-INDX = +4
  4501        ADD +1 TO PI-NEXT-TRLR-SUB.
  4502
  4503     MOVE -1                     TO SC-RECL (1).
  4504     GO TO 8100-SEND-INITIAL-MAP.
  4505
  4506 7100-NOT-FOUND.
  4507     IF PI-NEXT-TRLR-SUB = 1
  4508        MOVE ER-0320             TO EMI-ERROR
  4509        MOVE -1                  TO URECDTEL
  4510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4511        GO TO 8100-SEND-INITIAL-MAP.
  4512
  4513     MOVE -1                     TO SC-RECL (1).
  4514
  4515*    IF ANY LINES WERE PRINTED THEN
  4516*    SET THE SUB TO ALWAYS BE 1 GREATER THAN A MULTIPLE OF 4.
  4517
  4518     SET INDX-WORK TO SC-INDX.
  4519
  4520     IF SC-INDX NOT = 1
  4521        COMPUTE PI-NEXT-TRLR-SUB = (4 - INDX-WORK) + 1 +
  4522                                    PI-NEXT-TRLR-SUB.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL162.cbl
  4523
  4524     IF EIBAID NOT = DFHPF1
  4525        GO TO 8100-SEND-INITIAL-MAP.
  4526
  4527     MOVE ER-0066                TO EMI-ERROR.
  4528     MOVE -1                     TO SC-RECL (1).
  4529
  4530     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4531
  4532     GO TO 8100-SEND-INITIAL-MAP.
  4533
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL162.cbl
  4535 8100-SEND-INITIAL-MAP.
  4536     MOVE SAVE-DATE    TO RUNDTEO.
  4537     MOVE EIBTIME      TO TIME-IN.
  4538     MOVE TIME-OUT     TO RUNTIMEO.
  4539
  4540     IF NOT EMI-NO-ERRORS
  4541         SET EMI-INDX TO 1
  4542         MOVE EMI-MESSAGE-AREA (EMI-INDX) TO ERRMSG1O.
  4543
  4544     IF PI-COMPANY-ID NOT = 'DMD'
  4545         MOVE SPACES             TO PF4KEYO.
  4546
  4547     IF PI-RETURN-TO-PROGRAM = 'EL150'
  4548         MOVE SPACES             TO PF5KEYO.
  4549
  4550
  4551* EXEC CICS SEND
  4552*        MAP   (MAP-NAME)
  4553*        MAPSET(MAPSET-NAME)
  4554*        FROM  (EL162AO)
  4555*        ERASE
  4556*        CURSOR
  4557*    END-EXEC.
  4558     MOVE LENGTH OF
  4559      EL162AO
  4560       TO DFHEIV12
  4561     MOVE -1
  4562       TO DFHEIV11
  4563*    MOVE '8$     CT  E    H L F ,   #00004240' TO DFHEIV0
  4564     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4565     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4566     MOVE X'2020233030303034323430' TO DFHEIV0(25:11)
  4567     CALL 'kxdfhei1' USING DFHEIV0,
  4568           MAP-NAME,
  4569           EL162AO,
  4570           DFHEIV12,
  4571           MAPSET-NAME,
  4572           DFHEIV99,
  4573           DFHEIV99,
  4574           DFHEIV99,
  4575           DFHEIV11,
  4576           DFHEIV99,
  4577           DFHEIV99,
  4578           DFHEIV99
  4579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4580
  4581
  4582     GO TO 9100-RETURN-TRAN.
  4583
  4584 8200-SEND-DATAONLY.
  4585     MOVE SAVE-DATE            TO RUNDTEO.
  4586     MOVE EIBTIME              TO TIME-IN.
  4587     MOVE TIME-OUT             TO RUNTIMEO.
  4588     MOVE EMI-MESSAGE-AREA (1) TO ERRMSG1O.
  4589
  4590     IF PI-COMPANY-ID NOT = 'DMD'
  4591         MOVE SPACES             TO PF4KEYO.
  4592
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL162.cbl
  4593     IF PI-RETURN-TO-PROGRAM = 'EL150'
  4594         MOVE SPACES             TO PF5KEYO.
  4595
  4596
  4597* EXEC CICS SEND
  4598*        MAP   (MAP-NAME)
  4599*        MAPSET(MAPSET-NAME)
  4600*        FROM  (EL162AO)
  4601*        DATAONLY
  4602*        CURSOR
  4603*    END-EXEC.
  4604     MOVE LENGTH OF
  4605      EL162AO
  4606       TO DFHEIV12
  4607     MOVE -1
  4608       TO DFHEIV11
  4609*    MOVE '8$D    CT       H L F ,   #00004262' TO DFHEIV0
  4610     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4611     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4612     MOVE X'2020233030303034323632' TO DFHEIV0(25:11)
  4613     CALL 'kxdfhei1' USING DFHEIV0,
  4614           MAP-NAME,
  4615           EL162AO,
  4616           DFHEIV12,
  4617           MAPSET-NAME,
  4618           DFHEIV99,
  4619           DFHEIV99,
  4620           DFHEIV99,
  4621           DFHEIV11,
  4622           DFHEIV99,
  4623           DFHEIV99,
  4624           DFHEIV99
  4625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4626
  4627
  4628     GO TO 9100-RETURN-TRAN.
  4629
  4630 8300-SEND-TEXT.
  4631
  4632* EXEC CICS SEND TEXT
  4633*        FROM  (LOGOFF-TEXT)
  4634*        LENGTH(LOGOFF-LENGTH)
  4635*        ERASE
  4636*        FREEKB
  4637*    END-EXEC.
  4638*    MOVE '8&      T  E F  H   F -   #00004273' TO DFHEIV0
  4639     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4640     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4641     MOVE X'2020233030303034323733' TO DFHEIV0(25:11)
  4642     CALL 'kxdfhei1' USING DFHEIV0,
  4643           LOGOFF-TEXT,
  4644           LOGOFF-LENGTH,
  4645           DFHEIV99,
  4646           DFHEIV99,
  4647           DFHEIV99,
  4648           DFHEIV99,
  4649           DFHEIV99,
  4650           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL162.cbl
  4651           DFHEIV99,
  4652           DFHEIV99,
  4653           DFHEIV99,
  4654           DFHEIV99
  4655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4656
  4657
  4658
  4659* EXEC CICS RETURN
  4660*    END-EXEC.
  4661*    MOVE '.(                    &   #00004280' TO DFHEIV0
  4662     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4663     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4664     MOVE X'2020233030303034323830' TO DFHEIV0(25:11)
  4665     CALL 'kxdfhei1' USING DFHEIV0,
  4666           DFHEIV99,
  4667           DFHEIV99,
  4668           DFHEIV99,
  4669           DFHEIV99,
  4670           DFHEIV99
  4671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4672
  4673
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL162.cbl
  4675 8600-DEEDIT.
  4676
  4677* EXEC CICS BIF DEEDIT
  4678*        FIELD (DEEDIT-FIELD)
  4679*        LENGTH(15)
  4680*    END-EXEC.
  4681     MOVE 15
  4682       TO DFHEIV11
  4683*    MOVE '@"L                   #   #00004285' TO DFHEIV0
  4684     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4685     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4686     MOVE X'2020233030303034323835' TO DFHEIV0(25:11)
  4687     CALL 'kxdfhei1' USING DFHEIV0,
  4688           DEEDIT-FIELD,
  4689           DFHEIV11
  4690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4691
  4692
  4693 8800-UNAUTHORIZED-ACCESS.
  4694     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  4695     GO TO 8300-SEND-TEXT.
  4696
  4697 8810-PF23.
  4698     MOVE EIBAID                   TO PI-ENTRY-CD-1.
  4699     MOVE XCTL-005 TO PGM-NAME.
  4700     GO TO 9300-XCTL.
  4701
  4702 8820-ACTV-NOT-OPEN.
  4703     MOVE ER-0172                TO EMI-ERROR.
  4704     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4705     GO TO 8200-SEND-DATAONLY.
  4706
  4707 8860-CLAIM-NOT-FOUND.
  4708     MOVE ER-0319                TO EMI-ERROR.
  4709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4710     GO TO 8100-SEND-INITIAL-MAP.
  4711
  4712 8870-CLAIM-NOT-OPEN.
  4713     MOVE ER-0042                TO EMI-ERROR.
  4714     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4715     GO TO 8200-SEND-DATAONLY.
  4716
  4717 8880-ACCT-NOT-OPEN.
  4718     MOVE ER-0168                TO EMI-ERROR
  4719     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4720     GO TO 8200-SEND-DATAONLY.
  4721
  4722 9100-RETURN-TRAN.
  4723     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  4724     MOVE MAP-NUMBER           TO PI-CURRENT-SCREEN-NO.
  4725
  4726* EXEC CICS RETURN
  4727*        TRANSID(TRANS-ID)
  4728*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4729*        LENGTH(PI-COMM-LENGTH)
  4730*    END-EXEC.
  4731*    MOVE '.(CT                  &   #00004322' TO DFHEIV0
  4732     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL162.cbl
  4733     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4734     MOVE X'2020233030303034333232' TO DFHEIV0(25:11)
  4735     CALL 'kxdfhei1' USING DFHEIV0,
  4736           TRANS-ID,
  4737           PROGRAM-INTERFACE-BLOCK,
  4738           PI-COMM-LENGTH,
  4739           DFHEIV99,
  4740           DFHEIV99
  4741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4742
  4743
  4744 9200-RETURN-MAIN-MENU.
  4745     MOVE XCTL-126 TO PGM-NAME.
  4746     GO TO 9300-XCTL.
  4747
  4748 9300-XCTL.
  4749
  4750* EXEC CICS XCTL
  4751*        PROGRAM(PGM-NAME)
  4752*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4753*        LENGTH(PI-COMM-LENGTH)
  4754*    END-EXEC.
  4755*    MOVE '.$C                   $   #00004333' TO DFHEIV0
  4756     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4757     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4758     MOVE X'2020233030303034333333' TO DFHEIV0(25:11)
  4759     CALL 'kxdfhei1' USING DFHEIV0,
  4760           PGM-NAME,
  4761           PROGRAM-INTERFACE-BLOCK,
  4762           PI-COMM-LENGTH
  4763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4764
  4765
  4766 9400-CLEAR.
  4767     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  4768     GO TO 9300-XCTL.
  4769
  4770 9500-PF12.
  4771     MOVE XCTL-010 TO PGM-NAME.
  4772     GO TO 9300-XCTL.
  4773
  4774 9600-PGMID-ERROR.
  4775
  4776* EXEC CICS HANDLE CONDITION
  4777*        PGMIDERR(8300-SEND-TEXT)
  4778*    END-EXEC.
  4779*    MOVE '"$L                   ! ( #00004348' TO DFHEIV0
  4780     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4782     MOVE X'2820233030303034333438' TO DFHEIV0(25:11)
  4783     CALL 'kxdfhei1' USING DFHEIV0
  4784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4785
  4786
  4787     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  4788     MOVE ' '          TO PI-ENTRY-CD-1.
  4789     MOVE XCTL-005     TO PGM-NAME.
  4790     MOVE PGM-NAME     TO LOGOFF-PGM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL162.cbl
  4791     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  4792     GO TO 9300-XCTL.
  4793
  4794 9700-DATE-LINK.
  4795     MOVE LINK-ELDATCV           TO PGM-NAME.
  4796
  4797
  4798* EXEC CICS LINK
  4799*         PROGRAM (PGM-NAME)
  4800*         COMMAREA(DATE-CONVERSION-DATA)
  4801*         LENGTH  (DC-COMM-LENGTH)
  4802*    END-EXEC.
  4803*    MOVE '."C                   ''   #00004362' TO DFHEIV0
  4804     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4805     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4806     MOVE X'2020233030303034333632' TO DFHEIV0(25:11)
  4807     CALL 'kxdfhei1' USING DFHEIV0,
  4808           PGM-NAME,
  4809           DATE-CONVERSION-DATA,
  4810           DC-COMM-LENGTH,
  4811           DFHEIV99,
  4812           DFHEIV99,
  4813           DFHEIV99
  4814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4815
  4816
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL162.cbl
  4818 9900-ERROR-FORMAT.
  4819     IF NOT EMI-ERRORS-COMPLETE
  4820         MOVE LINK-001 TO PGM-NAME
  4821
  4822* EXEC CICS LINK
  4823*            PROGRAM (PGM-NAME)
  4824*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  4825*            LENGTH  (EMI-COMM-LENGTH)
  4826*        END-EXEC.
  4827*    MOVE '."C                   ''   #00004372' TO DFHEIV0
  4828     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4829     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4830     MOVE X'2020233030303034333732' TO DFHEIV0(25:11)
  4831     CALL 'kxdfhei1' USING DFHEIV0,
  4832           PGM-NAME,
  4833           ERROR-MESSAGE-INTERFACE-BLOCK,
  4834           EMI-COMM-LENGTH,
  4835           DFHEIV99,
  4836           DFHEIV99,
  4837           DFHEIV99
  4838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4839
  4840
  4841 9900-EXIT.
  4842     EXIT.
  4843
  4844 9990-ABEND.
  4845     MOVE LINK-004 TO PGM-NAME.
  4846     MOVE DFHEIBLK TO EMI-LINE1.
  4847
  4848
  4849* EXEC CICS LINK
  4850*        PROGRAM (PGM-NAME)
  4851*        COMMAREA(EMI-LINE1)
  4852*        LENGTH  (72)
  4853*    END-EXEC.
  4854     MOVE 72
  4855       TO DFHEIV11
  4856*    MOVE '."C                   ''   #00004385' TO DFHEIV0
  4857     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4858     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4859     MOVE X'2020233030303034333835' TO DFHEIV0(25:11)
  4860     CALL 'kxdfhei1' USING DFHEIV0,
  4861           PGM-NAME,
  4862           EMI-LINE1,
  4863           DFHEIV11,
  4864           DFHEIV99,
  4865           DFHEIV99,
  4866           DFHEIV99
  4867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4868
  4869
  4870     GO TO 8200-SEND-DATAONLY.
  4871
  4872 9995-SECURITY-VIOLATION.
  4873*                            COPY ELCSCTP.
  4874******************************************************************
  4875*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL162.cbl
  4876*                            ELCSCTP                             *
  4877*                            VMOD=2.001                          *
  4878*                                                                *
  4879*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  4880******************************************************************
  4881
  4882
  4883     MOVE EIBDATE          TO SM-JUL-DATE.
  4884     MOVE EIBTRMID         TO SM-TERMID.
  4885     MOVE THIS-PGM         TO SM-PGM.
  4886     MOVE EIBTIME          TO TIME-IN.
  4887     MOVE TIME-OUT         TO SM-TIME.
  4888     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  4889
  4890
  4891* EXEC CICS LINK
  4892*         PROGRAM  ('EL003')
  4893*         COMMAREA (SECURITY-MESSAGE)
  4894*         LENGTH   (80)
  4895*    END-EXEC.
  4896     MOVE 'EL003' TO DFHEIV1
  4897     MOVE 80
  4898       TO DFHEIV11
  4899*    MOVE '."C                   ''   #00004411' TO DFHEIV0
  4900     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4901     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4902     MOVE X'2020233030303034343131' TO DFHEIV0(25:11)
  4903     CALL 'kxdfhei1' USING DFHEIV0,
  4904           DFHEIV1,
  4905           SECURITY-MESSAGE,
  4906           DFHEIV11,
  4907           DFHEIV99,
  4908           DFHEIV99,
  4909           DFHEIV99
  4910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4911
  4912
  4913******************************************************************
  4914
  4915
  4916
  4917 9999-DFHBACK SECTION.
  4918     MOVE '9%                    "   ' TO DFHEIV0
  4919     MOVE 'EL162' TO DFHEIV1
  4920     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4921     GOBACK.
  4922 9999-DFHEXIT.
  4923     IF DFHEIGDJ EQUAL 0001
  4924         NEXT SENTENCE
  4925     ELSE IF DFHEIGDJ EQUAL 2
  4926         GO TO 9600-PGMID-ERROR,
  4927               9990-ABEND
  4928         DEPENDING ON DFHEIGDI
  4929     ELSE IF DFHEIGDJ EQUAL 3
  4930         GO TO 4199-EXIT
  4931         DEPENDING ON DFHEIGDI
  4932     ELSE IF DFHEIGDJ EQUAL 4
  4933         GO TO 4290-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL162.cbl
  4934         DEPENDING ON DFHEIGDI
  4935     ELSE IF DFHEIGDJ EQUAL 5
  4936         GO TO 8880-ACCT-NOT-OPEN,
  4937               4250-ACCT-NOT-FOUND
  4938         DEPENDING ON DFHEIGDI
  4939     ELSE IF DFHEIGDJ EQUAL 6
  4940         GO TO 8870-CLAIM-NOT-OPEN,
  4941               8860-CLAIM-NOT-FOUND
  4942         DEPENDING ON DFHEIGDI
  4943     ELSE IF DFHEIGDJ EQUAL 7
  4944         GO TO 8820-ACTV-NOT-OPEN,
  4945               7100-NOT-FOUND,
  4946               7100-NOT-FOUND
  4947         DEPENDING ON DFHEIGDI
  4948     ELSE IF DFHEIGDJ EQUAL 8
  4949         GO TO 8300-SEND-TEXT
  4950         DEPENDING ON DFHEIGDI.
  4951     MOVE '9%                    "   ' TO DFHEIV0
  4952     MOVE 'EL162' TO DFHEIV1
  4953     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4954     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4868     Code:       13873
