* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1041.cbl
* Options: int("EL1041.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1041.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1041.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1041.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL1041.
     3*
     4*AUTHOR.     PABLO
     5*            OMAHA NE
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
    12*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    13*            *   CENTRAL STATES                                  *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1041.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE Z LETTER CONTROLS
    19*    SCREENS     - EL104Z - LETTER (Z) CONTROL MAINTENANCE
    20*    ENTERED BY  - EL1042 - TEXT MAINT
    21*    EXIT TO     - EL1042 - TEXT MAINT
    22*    INPUT FILE  - ELLETR -              - LETTER TEXT
    23*    OUTPUT FILE - ELLETR -              - LETTER TEXT
    24*    COMMAREA    - PASSED
    25*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL1042. ON
    26*                  FIRST ENTRY, WE READ THE ELLETR FILE USING THE
    27*                  LETTER ID PASSED FROM EL1042.     ON SUBSEQUENT
    28*                  ENTRIES (XCTL FROM CICS VIA     ) THE SCREEN
    29*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    30*                  MAINTENANCE TYPE INDICATED.
    31 ENVIRONMENT DIVISION.
    32 DATA DIVISION.
    33 WORKING-STORAGE SECTION.
    34 01  DFH-START PIC X(04).
    35 77  FILLER  PIC X(32)  VALUE '********************************'.
    36 77  FILLER  PIC X(32)  VALUE '*   EL1041 WORKING STORAGE     *'.
    37 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    38 77  M1                          PIC S999 COMP-3 VALUE +0.
    39 77  M2                          PIC S999 COMP-3 VALUE +0.
    40 77  WS-STOP-SW                  PIC X  VALUE ' '.
    41     88  I-SAY-TO-STOP              VALUE 'Y'.
    42 77  WS-FIND-SW                  PIC X  VALUE ' '.
    43     88  WE-FOUND-IT                VALUE 'Y'.
    44 77  WS-SEQ-NO-TO-USE            PIC S9(4) COMP VALUE +0.
    45 01  ACCESS-KEYS.
    46     12  ELLETR-KEY.
    47         16  ELLETR-COMPANY-CD   PIC X.
    48         16  ELLETR-ACCESS-CD    PIC X(12).
    49         16  ELLETR-SEQ-NO       PIC S9(4) COMP.
    50 01  WS-DATE-AREA.
    51     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
    52     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
    53 01  MISC-WORK-AREAS.
    54     12  WS-RESPONSE             PIC S9(8)   COMP.
    55         88  RESP-NORMAL              VALUE +00.
    56         88  RESP-ERROR               VALUE +01.
    57         88  RESP-NOTFND              VALUE +13.
    58         88  RESP-NOTOPEN             VALUE +19.
    59         88  RESP-ENDFILE             VALUE +20.
    60     12  WS-NUMVAL.
    61         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
    62         16  WS-9V999-OF-DEEDIT REDEFINES
    63             WS-NUMVAL-OF-DEEDIT     PIC 9(8)V999.
    64     12  DEEDIT-FIELD                PIC X(11).
    65     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    66                                     PIC S9(11).
    67     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    68                                     PIC S9(09)V99.
    69 01  STANDARD-AREAS.
    70     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
    71     12  TRANS-ID                    PIC X(04)   VALUE 'EX1E'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1041.cbl
    72     12  PGM-NAME                    PIC X(08).
    73     12  TIME-IN                     PIC S9(07).
    74     12  TIME-OUT-R  REDEFINES TIME-IN.
    75         16  FILLER                  PIC X(01).
    76         16  TIME-OUT                PIC 99V99.
    77         16  FILLER                  PIC X(02).
    78     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
    79     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
    80     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
    81     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
    82     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
    83     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
    84     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
    85     12  THIS-PGM                    PIC X(08)   VALUE 'EL1041'.
    86     12  ELLETR-FILE-ID              PIC X(08)   VALUE 'ELLETR'.
    87     12  ELLETR-LENGTH               PIC S9(04)  VALUE +100  COMP.
    88     12  SUB                         PIC 9(02).
    89     12  SUB-1                       PIC 9(02).
    90     12  SUB2                        PIC 9(02).
    91     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
    92     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL1041S'.
    93     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL104Z'.
    94     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
    95 01  W-Z-CONTROL-DATA.
    96     05  W-NUMBER-OF-COPIES      PIC  9.
    97     05  FILLER                  PIC  X.
    98     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
    99     05  FILLER                  PIC  X.
   100     05  W-DAYS-TO-RESEND-1      PIC  999.
   101     05  FILLER                  PIC  X.
   102     05  W-FORM-TO-RESEND        PIC  X(4).
   103     05  FILLER                  PIC  X.
   104     05  W-PROMPT-LETTER         PIC  X.
   105     05  FILLER                  PIC  X.
   106     05  W-ENCLOSURE-CD          PIC  XXX.
   107     05  FILLER                  PIC  X.
   108     05  W-AUTO-CLOSE-IND        PIC  X.
   109     05  FILLER                  PIC  X.
   110     05  W-LETTER-TO-BENE        PIC  X.
   111*                                    COPY ELCSCTM.
   112******************************************************************
   113*                                                                *
   114*                                                                *
   115*                            ELCSCTM                             *
   116*                            VMOD=2.001                          *
   117*                                                                *
   118*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   119*                                                                *
   120******************************************************************
   121 01  SECURITY-MESSAGE.
   122     12  FILLER                          PIC X(30)
   123            VALUE '** LOGIC SECURITY VIOLATION -'.
   124     12  SM-READ                         PIC X(6).
   125     12  FILLER                          PIC X(5)
   126            VALUE ' PGM='.
   127     12  SM-PGM                          PIC X(6).
   128     12  FILLER                          PIC X(5)
   129            VALUE ' OPR='.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1041.cbl
   130     12  SM-PROCESSOR-ID                 PIC X(4).
   131     12  FILLER                          PIC X(6)
   132            VALUE ' TERM='.
   133     12  SM-TERMID                       PIC X(4).
   134     12  FILLER                          PIC XX   VALUE SPACE.
   135     12  SM-JUL-DATE                     PIC 9(5).
   136     12  FILLER                          PIC X    VALUE SPACE.
   137     12  SM-TIME                         PIC 99.99.
   138
   139*                                    COPY ELCSCRTY.
   140******************************************************************
   141*                                                                *
   142*                                                                *
   143*                            ELCSCRTY                            *
   144*                            VMOD=2.001                          *
   145*                                                                *
   146*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   147*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   148*        SAVED IN PI-SECURITY-ADDRESS.                           *
   149*                                                                *
   150******************************************************************
   151 01  SECURITY-CONTROL.
   152     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   153     12  FILLER                       PIC XX    VALUE 'SC'.
   154     12  SC-CREDIT-CODES.
   155         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   156             20  SC-CREDIT-DISPLAY    PIC X.
   157             20  SC-CREDIT-UPDATE     PIC X.
   158     12  SC-CLAIMS-CODES.
   159         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   160             20  SC-CLAIMS-DISPLAY    PIC X.
   161             20  SC-CLAIMS-UPDATE     PIC X.
   162 01  ERROR-MESSAGES.
   163     12  ER-0000                     PIC X(04)   VALUE '0000'.
   164     12  ER-0005                     PIC X(04)   VALUE '0005'.
   165     12  ER-0023                     PIC X(04)   VALUE '0023'.
   166     12  ER-0029                     PIC X(04)   VALUE '0029'.
   167     12  ER-0050                     PIC X(04)   VALUE '0050'.
   168     12  ER-0068                     PIC X(04)   VALUE '0068'.
   169     12  ER-0070                     PIC X(04)   VALUE '0070'.
   170     12  ER-0130                     PIC X(04)   VALUE '0130'.
   171     12  ER-0131                     PIC X(04)   VALUE '0131'.
   172     12  ER-0132                     PIC X(04)   VALUE '0132'.
   173     12  ER-0138                     PIC X(04)   VALUE '0138'.
   174     12  ER-0144                     PIC X(04)   VALUE '0144'.
   175     12  ER-0145                     PIC X(04)   VALUE '0145'.
   176     12  ER-0184                     PIC X(04)   VALUE '0184'.
   177     12  ER-0418                     PIC X(04)   VALUE '0418'.
   178     12  ER-0491                     PIC X(04)   VALUE '0491'.
   179     12  ER-0582                     PIC X(04)   VALUE '0582'.
   180     12  ER-0627                     PIC X(04)   VALUE '0627'.
   181     12  ER-0701                     PIC X(04)   VALUE '0701'.
   182     12  ER-0702                     PIC X(04)   VALUE '0702'.
   183     12  ER-0703                     PIC X(04)   VALUE '0703'.
   184     12  ER-0704                     PIC X(04)   VALUE '0704'.
   185     12  ER-0705                     PIC X(04)   VALUE '0705'.
   186     12  ER-0706                     PIC X(04)   VALUE '0706'.
   187     12  ER-0707                     PIC X(04)   VALUE '0707'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1041.cbl
   188     12  ER-0708                     PIC X(04)   VALUE '0708'.
   189     12  ER-0709                     PIC X(04)   VALUE '0709'.
   190     12  ER-0710                     PIC X(04)   VALUE '0710'.
   191     12  ER-0711                     PIC X(04)   VALUE '0711'.
   192     12  ER-0712                     PIC X(04)   VALUE '0712'.
   193     12  ER-0713                     PIC X(04)   VALUE '0713'.
   194     12  ER-0717                     PIC X(04)   VALUE '0717'.
   195     12  ER-0718                     PIC X(04)   VALUE '0718'.
   196     12  ER-0719                     PIC X(04)   VALUE '0719'.
   197     12  ER-0720                     PIC X(04)   VALUE '0720'.
   198     12  ER-0721                     PIC X(04)   VALUE '0721'.
   199     12  ER-0722                     PIC X(04)   VALUE '0722'.
   200     12  ER-0723                     PIC X(04)   VALUE '0723'.
   201     12  ER-0724                     PIC X(04)   VALUE '0724'.
   202     12  ER-0725                     PIC X(04)   VALUE '0725'.
   203     12  ER-0726                     PIC X(04)   VALUE '0726'.
   204     12  ER-0727                     PIC X(04)   VALUE '0727'.
   205     12  ER-0729                     PIC X(04)   VALUE '0729'.
   206     12  ER-0754                     PIC X(04)   VALUE '0754'.
   207     12  ER-1560                     PIC X(04)   VALUE '1560'.
   208     12  ER-1562                     PIC X(04)   VALUE '1562'.
   209     12  ER-2241                     PIC X(04)   VALUE '2241'.
   210     12  ER-2276                     PIC X(04)   VALUE '2276'.
   211     12  ER-7008                     PIC X(04)   VALUE '7008'.
   212     12  ER-7031                     PIC X(04)   VALUE '7031'.
   213     12  ER-7123                     PIC X(04)   VALUE '7123'.
   214     12  ER-8150                     PIC X(04)   VALUE '8150'.
   215     12  ER-9999                     PIC XXXX    VALUE '9999'.
   216*                                    COPY ELCDATE.
   217******************************************************************
   218*                                                                *
   219*                                                                *
   220*                            ELCDATE.                            *
   221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   222*                            VMOD=2.003
   223*                                                                *
   224*                                                                *
   225*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   226*                 LENGTH = 200                                   *
   227******************************************************************
   228
   229 01  DATE-CONVERSION-DATA.
   230     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   231     12  DC-OPTION-CODE                PIC X.
   232         88  BIN-TO-GREG                VALUE ' '.
   233         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   234         88  EDIT-GREG-TO-BIN           VALUE '2'.
   235         88  YMD-GREG-TO-BIN            VALUE '3'.
   236         88  MDY-GREG-TO-BIN            VALUE '4'.
   237         88  JULIAN-TO-BIN              VALUE '5'.
   238         88  BIN-PLUS-ELAPSED           VALUE '6'.
   239         88  FIND-CENTURY               VALUE '7'.
   240         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   241         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   242         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   243         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   244         88  JULIAN-TO-BIN-3            VALUE 'C'.
   245         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1041.cbl
   246         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   247         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   248         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   249         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   250         88  CHECK-LEAP-YEAR            VALUE 'H'.
   251         88  BIN-3-TO-GREG              VALUE 'I'.
   252         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   253         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   254         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   255         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   256         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   257         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   258         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   259         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   260         88  THREE-CHARACTER-BIN
   261                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   262         88  GREGORIAN-TO-BIN
   263                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   264         88  BIN-TO-GREGORIAN
   265                  VALUES ' ' '1' 'I' '8' 'G'.
   266         88  JULIAN-TO-BINARY
   267                  VALUES '5' 'C' 'E' 'F'.
   268     12  DC-ERROR-CODE                 PIC X.
   269         88  NO-CONVERSION-ERROR        VALUE ' '.
   270         88  DATE-CONVERSION-ERROR
   271                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   272         88  DATE-IS-ZERO               VALUE '1'.
   273         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   274         88  DATE-IS-INVALID            VALUE '3'.
   275         88  DATE1-GREATER-DATE2        VALUE '4'.
   276         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   277         88  DATE-INVALID-OPTION        VALUE '9'.
   278         88  INVALID-CENTURY            VALUE 'A'.
   279         88  ONLY-CENTURY               VALUE 'B'.
   280         88  ONLY-LEAP-YEAR             VALUE 'C'.
   281         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   282     12  DC-END-OF-MONTH               PIC X.
   283         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   284     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   285         88  USE-NORMAL-PROCESS         VALUE ' '.
   286         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   287         88  ADJUST-UP-100-YRS          VALUE '2'.
   288     12  FILLER                        PIC X.
   289     12  DC-CONVERSION-DATES.
   290         16  DC-BIN-DATE-1             PIC XX.
   291         16  DC-BIN-DATE-2             PIC XX.
   292         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   293         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   294                       DC-GREG-DATE-1-EDIT.
   295             20  DC-EDIT1-MONTH        PIC 99.
   296             20  SLASH1-1              PIC X.
   297             20  DC-EDIT1-DAY          PIC 99.
   298             20  SLASH1-2              PIC X.
   299             20  DC-EDIT1-YEAR         PIC 99.
   300         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   301         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   302                     DC-GREG-DATE-2-EDIT.
   303             20  DC-EDIT2-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1041.cbl
   304             20  SLASH2-1              PIC X.
   305             20  DC-EDIT2-DAY          PIC 99.
   306             20  SLASH2-2              PIC X.
   307             20  DC-EDIT2-YEAR         PIC 99.
   308         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   309         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   310                     DC-GREG-DATE-1-YMD.
   311             20  DC-YMD-YEAR           PIC 99.
   312             20  DC-YMD-MONTH          PIC 99.
   313             20  DC-YMD-DAY            PIC 99.
   314         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   315         16  DC-GREG-DATE-1-MDY-R REDEFINES
   316                      DC-GREG-DATE-1-MDY.
   317             20  DC-MDY-MONTH          PIC 99.
   318             20  DC-MDY-DAY            PIC 99.
   319             20  DC-MDY-YEAR           PIC 99.
   320         16  DC-GREG-DATE-1-ALPHA.
   321             20  DC-ALPHA-MONTH        PIC X(10).
   322             20  DC-ALPHA-DAY          PIC 99.
   323             20  FILLER                PIC XX.
   324             20  DC-ALPHA-CENTURY.
   325                 24 DC-ALPHA-CEN-N     PIC 99.
   326             20  DC-ALPHA-YEAR         PIC 99.
   327         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   328         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   329         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   330         16  DC-JULIAN-DATE            PIC 9(05).
   331         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   332                                       PIC 9(05).
   333         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   334             20  DC-JULIAN-YEAR        PIC 99.
   335             20  DC-JULIAN-DAYS        PIC 999.
   336         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   337         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   338         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   339     12  DATE-CONVERSION-VARIBLES.
   340         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   341         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   342             20  FILLER                PIC 9(3).
   343             20  HOLD-CEN-1-CCYY.
   344                 24  HOLD-CEN-1-CC     PIC 99.
   345                 24  HOLD-CEN-1-YY     PIC 99.
   346             20  HOLD-CEN-1-MO         PIC 99.
   347             20  HOLD-CEN-1-DA         PIC 99.
   348         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   349             20  HOLD-CEN-1-R-MO       PIC 99.
   350             20  HOLD-CEN-1-R-DA       PIC 99.
   351             20  HOLD-CEN-1-R-CCYY.
   352                 24  HOLD-CEN-1-R-CC   PIC 99.
   353                 24  HOLD-CEN-1-R-YY   PIC 99.
   354             20  FILLER                PIC 9(3).
   355         16  HOLD-CENTURY-1-X.
   356             20  FILLER                PIC X(3)  VALUE SPACES.
   357             20  HOLD-CEN-1-X-CCYY.
   358                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   359                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   360             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   361             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1041.cbl
   362         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   363             20  HOLD-CEN-1-R-X-MO     PIC XX.
   364             20  HOLD-CEN-1-R-X-DA     PIC XX.
   365             20  HOLD-CEN-1-R-X-CCYY.
   366                 24  HOLD-CEN-1-R-X-CC PIC XX.
   367                 24  HOLD-CEN-1-R-X-YY PIC XX.
   368             20  FILLER                PIC XXX.
   369         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   370         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   371         16  DC-JULIAN-DATE-1          PIC 9(07).
   372         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   373             20  DC-JULIAN-1-CCYY.
   374                 24  DC-JULIAN-1-CC    PIC 99.
   375                 24  DC-JULIAN-1-YR    PIC 99.
   376             20  DC-JULIAN-DA-1        PIC 999.
   377         16  DC-JULIAN-DATE-2          PIC 9(07).
   378         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   379             20  DC-JULIAN-2-CCYY.
   380                 24  DC-JULIAN-2-CC    PIC 99.
   381                 24  DC-JULIAN-2-YR    PIC 99.
   382             20  DC-JULIAN-DA-2        PIC 999.
   383         16  DC-GREG-DATE-A-EDIT.
   384             20  DC-EDITA-MONTH        PIC 99.
   385             20  SLASHA-1              PIC X VALUE '/'.
   386             20  DC-EDITA-DAY          PIC 99.
   387             20  SLASHA-2              PIC X VALUE '/'.
   388             20  DC-EDITA-CCYY.
   389                 24  DC-EDITA-CENT     PIC 99.
   390                 24  DC-EDITA-YEAR     PIC 99.
   391         16  DC-GREG-DATE-B-EDIT.
   392             20  DC-EDITB-MONTH        PIC 99.
   393             20  SLASHB-1              PIC X VALUE '/'.
   394             20  DC-EDITB-DAY          PIC 99.
   395             20  SLASHB-2              PIC X VALUE '/'.
   396             20  DC-EDITB-CCYY.
   397                 24  DC-EDITB-CENT     PIC 99.
   398                 24  DC-EDITB-YEAR     PIC 99.
   399         16  DC-GREG-DATE-CYMD         PIC 9(08).
   400         16  DC-GREG-DATE-CYMD-R REDEFINES
   401                              DC-GREG-DATE-CYMD.
   402             20  DC-CYMD-CEN           PIC 99.
   403             20  DC-CYMD-YEAR          PIC 99.
   404             20  DC-CYMD-MONTH         PIC 99.
   405             20  DC-CYMD-DAY           PIC 99.
   406         16  DC-GREG-DATE-MDCY         PIC 9(08).
   407         16  DC-GREG-DATE-MDCY-R REDEFINES
   408                              DC-GREG-DATE-MDCY.
   409             20  DC-MDCY-MONTH         PIC 99.
   410             20  DC-MDCY-DAY           PIC 99.
   411             20  DC-MDCY-CEN           PIC 99.
   412             20  DC-MDCY-YEAR          PIC 99.
   413    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   414        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   415    12  DC-EL310-DATE                  PIC X(21).
   416    12  FILLER                         PIC X(28).
   417*                                    COPY ELCLOGOF.
   418******************************************************************
   419*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1041.cbl
   420*                                                                *
   421*                            ELCLOGOF.                           *
   422*                            VMOD=2.001                          *
   423*                                                                *
   424*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   425*                                                                *
   426******************************************************************
   427 01  CLASIC-LOGOFF.
   428     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   429     12  LOGOFF-TEXT.
   430         16  FILLER          PIC X(5)    VALUE SPACES.
   431         16  LOGOFF-MSG.
   432             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   433             20  FILLER      PIC X       VALUE SPACES.
   434             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   435         16  FILLER          PIC X(80)
   436           VALUE '* YOU ARE NOW LOGGED OFF'.
   437         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   438         16  FILLER          PIC X       VALUE QUOTE.
   439         16  LOGOFF-SYS-MSG  PIC X(17)
   440           VALUE 'S CLAS-IC SYSTEM '.
   441     12  TEXT-MESSAGES.
   442         16  UNACCESS-MSG    PIC X(29)
   443             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   444         16  PGMIDERR-MSG    PIC X(17)
   445             VALUE 'PROGRAM NOT FOUND'.
   446*                                    COPY ELCATTR.
   447******************************************************************
   448*                                                                *
   449*                            ELCATTR.                            *
   450*                            VMOD=2.001                          *
   451*                                                                *
   452*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   453*                                                                *
   454*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   455*                                                                *
   456*                   POS 1   P=PROTECTED                          *
   457*                           U=UNPROTECTED                        *
   458*                           S=ASKIP                              *
   459*                   POS 2   A=ALPHA/NUMERIC                      *
   460*                           N=NUMERIC                            *
   461*                   POS 3   N=NORMAL                             *
   462*                           B=BRIGHT                             *
   463*                           D=DARK                               *
   464*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   465*                           OF=MODIFIED DATA TAG OFF             *
   466*                                                                *
   467*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   468******************************************************************
   469 01  ATTRIBUTE-LIST.
   470     12  AL-PABOF            PIC X       VALUE 'Y'.
   471     12  AL-PABON            PIC X       VALUE 'Z'.
   472     12  AL-PADOF            PIC X       VALUE '%'.
   473     12  AL-PADON            PIC X       VALUE '_'.
   474     12  AL-PANOF            PIC X       VALUE '-'.
   475     12  AL-PANON            PIC X       VALUE '/'.
   476     12  AL-SABOF            PIC X       VALUE '8'.
   477     12  AL-SABON            PIC X       VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1041.cbl
   478     12  AL-SADOF            PIC X       VALUE '@'.
   479     12  AL-SADON            PIC X       VALUE QUOTE.
   480     12  AL-SANOF            PIC X       VALUE '0'.
   481     12  AL-SANON            PIC X       VALUE '1'.
   482     12  AL-UABOF            PIC X       VALUE 'H'.
   483     12  AL-UABON            PIC X       VALUE 'I'.
   484     12  AL-UADOF            PIC X       VALUE '<'.
   485     12  AL-UADON            PIC X       VALUE '('.
   486     12  AL-UANOF            PIC X       VALUE ' '.
   487     12  AL-UANON            PIC X       VALUE 'A'.
   488     12  AL-UNBOF            PIC X       VALUE 'Q'.
   489     12  AL-UNBON            PIC X       VALUE 'R'.
   490     12  AL-UNDOF            PIC X       VALUE '*'.
   491     12  AL-UNDON            PIC X       VALUE ')'.
   492     12  AL-UNNOF            PIC X       VALUE '&'.
   493     12  AL-UNNON            PIC X       VALUE 'J'.
   494*                                    COPY ELCEMIB.
   495******************************************************************
   496*                                                                *
   497*                                                                *
   498*                            ELCEMIB.                            *
   499*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   500*                            VMOD=2.005                          *
   501*                                                                *
   502*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   503*                                                                *
   504******************************************************************
   505 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   506     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   507     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   508     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   509     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   510     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   511     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   512     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   513     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   514     12  EMI-SWITCH1             PIC X        VALUE '1'.
   515         88  EMI-NO-ERRORS                    VALUE '1'.
   516         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   517         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   518     12  EMI-SWITCH2             PIC X        VALUE '1'.
   519         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   520     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   521         88  EMI-AREA1-EMPTY                  VALUE '1'.
   522         88  EMI-AREA1-FULL                   VALUE '2'.
   523     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   524         88  EMI-AREA2-EMPTY                  VALUE '1'.
   525         88  EMI-AREA2-FULL                   VALUE '2'.
   526     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   527         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   528         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   529         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   530         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   531         88  EMI-BYPASS-FATALS                VALUE 'X'.
   532     12  EMI-ERROR-LINES.
   533         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   534         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   535         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1041.cbl
   536         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   537             20  EMI-ERR-CODES OCCURS 10 TIMES.
   538                 24  EMI-ERR-NUM         PIC X(4).
   539                 24  EMI-FILLER          PIC X.
   540                 24  EMI-SEV             PIC X.
   541                 24  FILLER              PIC X.
   542             20  FILLER                  PIC X(02).
   543     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   544         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   545             20  EMI-ERROR-NUMBER    PIC X(4).
   546             20  EMI-FILL            PIC X.
   547             20  EMI-SEVERITY        PIC X.
   548             20  FILLER              PIC X.
   549             20  EMI-ERROR-TEXT.
   550                 24  EMI-TEXT-VARIABLE   PIC X(10).
   551                 24  FILLER          PIC X(55).
   552     12  EMI-SEVERITY-SAVE           PIC X.
   553         88  EMI-NOTE                    VALUE 'N'.
   554         88  EMI-WARNING                 VALUE 'W'.
   555         88  EMI-FORCABLE                VALUE 'F'.
   556         88  EMI-FATAL                   VALUE 'X'.
   557     12  EMI-MESSAGE-FLAG            PIC X.
   558         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   559         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   560     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   561     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   562         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   563         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   564         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   565     12  FILLER                      PIC X(137)  VALUE SPACES.
   566     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   567     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   568     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   569     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   570*                                    COPY ELCJPFX.
   571******************************************************************
   572*                                                                *
   573*                                                                *
   574*                            ELCJPFX.                            *
   575*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   576*                            VMOD=2.002                          *
   577*                                                                *
   578*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   579*                                                                *
   580*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   581*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   582*        ELCNTL - CONTROL FILE                                   *
   583*        ELMSTR - CLAIM MASTERS                                  *
   584*        ELTRLR - ACTIVITY TRAILERS                              *
   585*        ELCHKQ - CHECK QUE                                      *
   586******************************************************************
   587 01  JOURNAL-RECORD.
   588     12  JP-USER-ID                  PIC X(4).
   589     12  JP-FILE-ID                  PIC X(8).
   590     12  JP-PROGRAM-ID               PIC X(8).
   591     12  JP-RECORD-TYPE              PIC X.
   592         88 JP-ADD              VALUE 'A'.
   593         88 JP-BEFORE-CHANGE    VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1041.cbl
   594         88 JP-AFTER-CHANGE     VALUE 'C'.
   595         88 JP-DELETE           VALUE 'D'.
   596         88 JP-GENERIC-DELETE   VALUE 'G'.
   597         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   598         88 JP-KEY-CHG-ADD      VALUE 'N'.
   599     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   600     12  JP-RECORD-AREA
   601
   602
   603                                     PIC X(530).
   604*                                    COPY ELCINTF.
   605******************************************************************
   606*                                                                *
   607*                                                                *
   608*                            ELCINTF.                            *
   609*                            VMOD=2.017                          *
   610*                                                                *
   611*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   612*                                                                *
   613*       LENGTH = 1024                                            *
   614*                                                                *
   615******************************************************************
   616 01  PROGRAM-INTERFACE-BLOCK.
   617     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   618     12  PI-CALLING-PROGRAM              PIC X(8).
   619     12  PI-SAVED-PROGRAM-1              PIC X(8).
   620     12  PI-SAVED-PROGRAM-2              PIC X(8).
   621     12  PI-SAVED-PROGRAM-3              PIC X(8).
   622     12  PI-SAVED-PROGRAM-4              PIC X(8).
   623     12  PI-SAVED-PROGRAM-5              PIC X(8).
   624     12  PI-SAVED-PROGRAM-6              PIC X(8).
   625     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   626     12  PI-COMPANY-ID                   PIC XXX.
   627     12  PI-COMPANY-CD                   PIC X.
   628
   629     12  PI-COMPANY-PASSWORD             PIC X(8).
   630
   631     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   632
   633     12  PI-CONTROL-IN-PROGRESS.
   634         16  PI-CARRIER                  PIC X.
   635         16  PI-GROUPING                 PIC X(6).
   636         16  PI-STATE                    PIC XX.
   637         16  PI-ACCOUNT                  PIC X(10).
   638         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   639                                         PIC X(10).
   640         16  PI-CLAIM-CERT-GRP.
   641             20  PI-CLAIM-NO             PIC X(7).
   642             20  PI-CERT-NO.
   643                 25  PI-CERT-PRIME       PIC X(10).
   644                 25  PI-CERT-SFX         PIC X.
   645             20  PI-CERT-EFF-DT          PIC XX.
   646         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   647             20  PI-PLAN-CODE            PIC X(2).
   648             20  PI-REVISION-NUMBER      PIC X(3).
   649             20  PI-PLAN-EFF-DT          PIC X(2).
   650             20  PI-PLAN-EXP-DT          PIC X(2).
   651             20  FILLER                  PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1041.cbl
   652         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   653             20  PI-OE-REFERENCE-1.
   654                 25  PI-OE-REF-1-PRIME   PIC X(18).
   655                 25  PI-OE-REF-1-SUFF    PIC XX.
   656
   657     12  PI-SESSION-IN-PROGRESS          PIC X.
   658         88  CLAIM-SESSION                   VALUE '1'.
   659         88  CREDIT-SESSION                  VALUE '2'.
   660         88  WARRANTY-SESSION                VALUE '3'.
   661         88  MORTGAGE-SESSION                VALUE '4'.
   662         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   663
   664
   665*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   666
   667     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   668     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   669
   670     12  PI-CREDIT-USER                  PIC X.
   671         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   672         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   673
   674     12  PI-CLAIM-USER                   PIC X.
   675         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   676         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   677
   678     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   679         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   680         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   681         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   682         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   683         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   684
   685     12  PI-PROCESSOR-ID                 PIC X(4).
   686
   687     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   688
   689     12  PI-MEMBER-CAPTION               PIC X(10).
   690
   691     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   692         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   693
   694     12  PI-LIFE-OVERRIDE-L1             PIC X.
   695     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   696     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   697     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   698
   699     12  PI-AH-OVERRIDE-L1               PIC X.
   700     12  PI-AH-OVERRIDE-L2               PIC XX.
   701     12  PI-AH-OVERRIDE-L6               PIC X(6).
   702     12  PI-AH-OVERRIDE-L12              PIC X(12).
   703
   704     12  PI-NEW-SYSTEM                   PIC X(2).
   705
   706     12  PI-PRIMARY-CERT-NO              PIC X(11).
   707     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   708         88  PI-USES-PAID-TO                 VALUE '1'.
   709     12  PI-CRDTCRD-SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1041.cbl
   710         16  PI-CRDTCRD-USER             PIC X.
   711             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   712             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   713         16  PI-CC-MONTH-END-DT          PIC XX.
   714     12  PI-PROCESSOR-PRINTER            PIC X(4).
   715
   716     12  PI-OE-REFERENCE-2.
   717         16  PI-OE-REF-2-PRIME           PIC X(10).
   718         16  PI-OE-REF-2-SUFF            PIC X.
   719
   720     12  PI-REM-TRM-CALC-OPTION          PIC X.
   721
   722     12  PI-LANGUAGE-TYPE                PIC X.
   723             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   724             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   725             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   726
   727     12  PI-POLICY-LINKAGE-IND           PIC X.
   728         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   729         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   730                                                   LOW-VALUES.
   731
   732     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   733     12  PI-CLAIM-PW-SESSION             PIC X(1).
   734         88  PI-CLAIM-CREDIT                 VALUE '1'.
   735         88  PI-CLAIM-CONVEN                 VALUE '2'.
   736     12  FILLER                          PIC X(4).
   737
   738     12  PI-SYSTEM-LEVEL                 PIC X(145).
   739
   740     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   741         PI-SYSTEM-LEVEL.
   742
   743         16  PI-ENTRY-CODES.
   744             20  PI-ENTRY-CD-1           PIC X.
   745             20  PI-ENTRY-CD-2           PIC X.
   746
   747         16  PI-RETURN-CODES.
   748             20  PI-RETURN-CD-1          PIC X.
   749             20  PI-RETURN-CD-2          PIC X.
   750
   751         16  PI-UPDATE-STATUS-SAVE.
   752             20  PI-UPDATE-BY            PIC X(4).
   753             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   754
   755         16  PI-LOWER-CASE-LETTERS       PIC X.
   756             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   757
   758*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   759*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   760*            88  CARRIER-CLM-CNTL            VALUE '2'.
   761
   762         16  PI-CERT-ACCESS-CONTROL      PIC X.
   763             88  ST-ACCNT-CNTL               VALUE ' '.
   764             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   765             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   766             88  ACCNT-CNTL                  VALUE '3'.
   767             88  CARR-ACCNT-CNTL             VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1041.cbl
   768
   769         16  PI-PROCESSOR-CAP-LIST.
   770             20  PI-SYSTEM-CONTROLS.
   771                24 PI-SYSTEM-DISPLAY     PIC X.
   772                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   773                24 PI-SYSTEM-MODIFY      PIC X.
   774                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   775             20  FILLER                  PIC XX.
   776             20  PI-DISPLAY-CAP          PIC X.
   777                 88  DISPLAY-CAP             VALUE 'Y'.
   778             20  PI-MODIFY-CAP           PIC X.
   779                 88  MODIFY-CAP              VALUE 'Y'.
   780             20  PI-MSG-AT-LOGON-CAP     PIC X.
   781                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   782             20  PI-FORCE-CAP            PIC X.
   783                 88  FORCE-CAP               VALUE 'Y'.
   784
   785         16  PI-PROGRAM-CONTROLS.
   786             20  PI-PGM-PRINT-OPT        PIC X.
   787             20  PI-PGM-FORMAT-OPT       PIC X.
   788             20  PI-PGM-PROCESS-OPT      PIC X.
   789             20  PI-PGM-TOTALS-OPT       PIC X.
   790
   791         16  PI-HELP-INTERFACE.
   792             20  PI-LAST-ERROR-NO        PIC X(4).
   793             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   794
   795         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   796             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   797
   798         16  PI-CR-CONTROL-IN-PROGRESS.
   799             20  PI-CR-CARRIER           PIC X.
   800             20  PI-CR-GROUPING          PIC X(6).
   801             20  PI-CR-STATE             PIC XX.
   802             20  PI-CR-ACCOUNT           PIC X(10).
   803             20  PI-CR-FIN-RESP          PIC X(10).
   804             20  PI-CR-TYPE              PIC X.
   805
   806         16  PI-CR-BATCH-NUMBER          PIC X(6).
   807
   808         16  PI-CR-MONTH-END-DT          PIC XX.
   809
   810         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   811             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   812             88  PI-ZERO-CARRIER             VALUE '1'.
   813             88  PI-ZERO-GROUPING            VALUE '2'.
   814             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   815
   816         16  PI-CARRIER-SECURITY         PIC X.
   817             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   818
   819         16  PI-ACCOUNT-SECURITY         PIC X(10).
   820             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   821             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   822
   823         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   824             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   825                                         INDEXED BY PI-ACCESS-NDX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1041.cbl
   826                                         PIC X.
   827
   828         16  PI-GA-BILLING-CONTROL       PIC X.
   829             88  PI-GA-BILLING               VALUE '1'.
   830
   831         16  PI-MAIL-PROCESSING          PIC X.
   832             88  PI-MAIL-YES                 VALUE 'Y'.
   833
   834         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   835
   836         16  PI-AR-SYSTEM.
   837             20  PI-AR-PROCESSING-CNTL   PIC X.
   838                 88  PI-AR-PROCESSING        VALUE 'Y'.
   839             20  PI-AR-SUMMARY-CODE      PIC X(6).
   840             20  PI-AR-MONTH-END-DT      PIC XX.
   841
   842         16  PI-MP-SYSTEM.
   843             20  PI-MORTGAGE-USER            PIC X.
   844                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   845                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   846             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   847                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   848                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   849                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   850                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   851                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   852             20  PI-MP-MONTH-END-DT          PIC XX.
   853             20  PI-MP-REFERENCE-NO.
   854                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   855                 24  PI-MP-REFERENCE-SFX     PIC XX.
   856
   857         16  PI-LABEL-CONTROL            PIC X(01).
   858             88  PI-CREATE-LABELS                    VALUE 'Y'.
   859             88  PI-BYPASS-LABELS                    VALUE 'N'.
   860
   861         16  PI-BILL-GROUPING-CODE       PIC X(01).
   862             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   863
   864         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   865             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   866             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   867
   868         16  FILLER                      PIC X(14).
   869
   870     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   871******************************************************************
   872     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   873*                                    COPY ELC1042.
   874******************************************************************
   875*                                                                *
   876*                                                                *
   877*                           ELC1042                              *
   878*                            VMOD=2.002                          *
   879*                                                                *
   880*    NOTE                                                        *
   881*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   882*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   883*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1041.cbl
   884*        TO THESE PROGRAMS.                                      *
   885*                                                                *
   886*    NOTE                                                        *
   887*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   888*        USE ONLY!                                               *
   889*                                                                *
   890******************************************************************
   891
   892         16  PI-1042-WA.
   893             20  PI-ACTION       PIC  X(01).
   894                 88 PI-SHOW-MODE           VALUE '1'.
   895                 88 PI-CLEAR-MODE          VALUE '2'.
   896                 88 PI-CREATE-MODE         VALUE '3'.
   897             20  PI-COMM-CONTROL PIC  X(12).
   898             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   899             20  PI-EOF-SW       PIC  X(01).
   900                 88  PI-FILE-EOF           VALUE 'Y'.
   901             20  PI-FILETYP      PIC  X(01).
   902             20  PI-FORM-SQUEEZE-CONTROL
   903                                 PIC  X(01).
   904                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   905                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   906             20  PI-LAST-CONTROL PIC  X(12).
   907             20  PI-TEMP-STOR-ITEMS
   908                                 PIC S9(04) COMP.
   909             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   910             20  PI-UPDATE-SW    PIC  9(01).
   911                 88 ANY-UPDATES            VALUE 1.
   912             20  PI-104-SCREEN-SENT-IND
   913                                 PIC  X(01).
   914                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   915                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   916             20  PI-1042-SCREEN-SENT-IND
   917                                 PIC  X(01).
   918                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   919                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   920             20  PI-1042-ARCHIVE-IND
   921                                 PIC  X(01).
   922                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   923             20  FILLER          PIC  X(29).
   924         16  PI-PREV-LETR-KEY        PIC X(15).
   925         16  PI-CURR-LETR-KEY        PIC X(15).
   926         16  PI-UPDATE-DT            PIC XX.
   927         16  FILLER                  PIC X(556).
   928*                                    COPY ELCAID.
   929******************************************************************
   930*                                                                *
   931*                            ELCAID.                             *
   932*                            VMOD=2.001                          *
   933*                                                                *
   934*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   935*                                                                *
   936*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   937*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   938******************************************************************
   939
   940 01  DFHAID.
   941   02  DFHNULL   PIC  X  VALUE  ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1041.cbl
   942   02  DFHENTER  PIC  X  VALUE  QUOTE.
   943   02  DFHCLEAR  PIC  X  VALUE  '_'.
   944   02  DFHPEN    PIC  X  VALUE  '='.
   945   02  DFHOPID   PIC  X  VALUE  'W'.
   946   02  DFHPA1    PIC  X  VALUE  '%'.
   947   02  DFHPA2    PIC  X  VALUE  '>'.
   948   02  DFHPA3    PIC  X  VALUE  ','.
   949   02  DFHPF1    PIC  X  VALUE  '1'.
   950   02  DFHPF2    PIC  X  VALUE  '2'.
   951   02  DFHPF3    PIC  X  VALUE  '3'.
   952   02  DFHPF4    PIC  X  VALUE  '4'.
   953   02  DFHPF5    PIC  X  VALUE  '5'.
   954   02  DFHPF6    PIC  X  VALUE  '6'.
   955   02  DFHPF7    PIC  X  VALUE  '7'.
   956   02  DFHPF8    PIC  X  VALUE  '8'.
   957   02  DFHPF9    PIC  X  VALUE  '9'.
   958   02  DFHPF10   PIC  X  VALUE  ':'.
   959   02  DFHPF11   PIC  X  VALUE  '#'.
   960   02  DFHPF12   PIC  X  VALUE  '@'.
   961   02  DFHPF13   PIC  X  VALUE  'A'.
   962   02  DFHPF14   PIC  X  VALUE  'B'.
   963   02  DFHPF15   PIC  X  VALUE  'C'.
   964   02  DFHPF16   PIC  X  VALUE  'D'.
   965   02  DFHPF17   PIC  X  VALUE  'E'.
   966   02  DFHPF18   PIC  X  VALUE  'F'.
   967   02  DFHPF19   PIC  X  VALUE  'G'.
   968   02  DFHPF20   PIC  X  VALUE  'H'.
   969   02  DFHPF21   PIC  X  VALUE  'I'.
   970*00039    02  DFHPF22   PIC  X  VALUE  ''.
   971   02  DFHPF22   PIC  X  VALUE  '['.
   972   02  DFHPF23   PIC  X  VALUE  '.'.
   973   02  DFHPF24   PIC  X  VALUE  '<'.
   974   02  DFHMSRE   PIC  X  VALUE  'X'.
   975   02  DFHSTRF   PIC  X  VALUE  'h'.
   976   02  DFHTRIG   PIC  X  VALUE  '"'.
   977 01  FILLER    REDEFINES DFHAID.
   978     12  FILLER                      PIC X(08).
   979     12  PF-VALUES                   PIC X         OCCURS 24.
   980*                                    COPY EL1041S.
   981 01  EL104ZI.
   982     05  FILLER            PIC  X(0012).
   983*    -------------------------------
   984     05  DATEL PIC S9(0004) COMP.
   985     05  DATEF PIC  X(0001).
   986     05  FILLER REDEFINES DATEF.
   987         10  DATEA PIC  X(0001).
   988     05  FILLER            PIC  X(3).
   989     05  DATEI PIC  X(0008).
   990*    -------------------------------
   991     05  TIMEL PIC S9(0004) COMP.
   992     05  TIMEF PIC  X(0001).
   993     05  FILLER REDEFINES TIMEF.
   994         10  TIMEA PIC  X(0001).
   995     05  FILLER            PIC  X(3).
   996     05  TIMEI PIC  X(0005).
   997*    -------------------------------
   998     05  CMPNYIDL PIC S9(0004) COMP.
   999     05  CMPNYIDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1041.cbl
  1000     05  FILLER REDEFINES CMPNYIDF.
  1001         10  CMPNYIDA PIC  X(0001).
  1002     05  FILLER            PIC  X(3).
  1003     05  CMPNYIDI PIC  X(0003).
  1004*    -------------------------------
  1005     05  USERIDL PIC S9(0004) COMP.
  1006     05  USERIDF PIC  X(0001).
  1007     05  FILLER REDEFINES USERIDF.
  1008         10  USERIDA PIC  X(0001).
  1009     05  FILLER            PIC  X(3).
  1010     05  USERIDI PIC  X(0004).
  1011*    -------------------------------
  1012     05  MAINTL PIC S9(0004) COMP.
  1013     05  MAINTF PIC  X(0001).
  1014     05  FILLER REDEFINES MAINTF.
  1015         10  MAINTA PIC  X(0001).
  1016     05  FILLER            PIC  X(3).
  1017     05  MAINTI PIC  X(0001).
  1018*    -------------------------------
  1019     05  LSTUSRL PIC S9(0004) COMP.
  1020     05  LSTUSRF PIC  X(0001).
  1021     05  FILLER REDEFINES LSTUSRF.
  1022         10  LSTUSRA PIC  X(0001).
  1023     05  FILLER            PIC  X(3).
  1024     05  LSTUSRI PIC  X(0004).
  1025*    -------------------------------
  1026     05  LSTDTEL PIC S9(0004) COMP.
  1027     05  LSTDTEF PIC  X(0001).
  1028     05  FILLER REDEFINES LSTDTEF.
  1029         10  LSTDTEA PIC  X(0001).
  1030     05  FILLER            PIC  X(3).
  1031     05  LSTDTEI PIC  X(0008).
  1032*    -------------------------------
  1033     05  LSTTIMEL PIC S9(0004) COMP.
  1034     05  LSTTIMEF PIC  X(0001).
  1035     05  FILLER REDEFINES LSTTIMEF.
  1036         10  LSTTIMEA PIC  X(0001).
  1037     05  FILLER            PIC  X(3).
  1038     05  LSTTIMEI PIC  X(0005).
  1039*    -------------------------------
  1040     05  ZLETRL PIC S9(0004) COMP.
  1041     05  ZLETRF PIC  X(0001).
  1042     05  FILLER REDEFINES ZLETRF.
  1043         10  ZLETRA PIC  X(0001).
  1044     05  FILLER            PIC  X(3).
  1045     05  ZLETRI PIC  X(0004).
  1046*    -------------------------------
  1047     05  ZCOPIESL PIC S9(0004) COMP.
  1048     05  ZCOPIESF PIC  X(0001).
  1049     05  FILLER REDEFINES ZCOPIESF.
  1050         10  ZCOPIESA PIC  X(0001).
  1051     05  FILLER            PIC  X(3).
  1052     05  ZCOPIESI PIC  X(0001).
  1053*    -------------------------------
  1054     05  ZPROMPTL PIC S9(0004) COMP.
  1055     05  ZPROMPTF PIC  X(0001).
  1056     05  FILLER REDEFINES ZPROMPTF.
  1057         10  ZPROMPTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1041.cbl
  1058     05  FILLER            PIC  X(3).
  1059     05  ZPROMPTI PIC  X(0001).
  1060*    -------------------------------
  1061     05  ZENCCDL PIC S9(0004) COMP.
  1062     05  ZENCCDF PIC  X(0001).
  1063     05  FILLER REDEFINES ZENCCDF.
  1064         10  ZENCCDA PIC  X(0001).
  1065     05  FILLER            PIC  X(3).
  1066     05  ZENCCDI PIC  X(0003).
  1067*    -------------------------------
  1068     05  ZRDAYSL PIC S9(0004) COMP.
  1069     05  ZRDAYSF PIC  X(0001).
  1070     05  FILLER REDEFINES ZRDAYSF.
  1071         10  ZRDAYSA PIC  X(0001).
  1072     05  FILLER            PIC  X(3).
  1073     05  ZRDAYSI PIC  X(0003).
  1074*    -------------------------------
  1075     05  ZFORML PIC S9(0004) COMP.
  1076     05  ZFORMF PIC  X(0001).
  1077     05  FILLER REDEFINES ZFORMF.
  1078         10  ZFORMA PIC  X(0001).
  1079     05  FILLER            PIC  X(3).
  1080     05  ZFORMI PIC  X(0004).
  1081*    -------------------------------
  1082     05  ZBENEL PIC S9(0004) COMP.
  1083     05  ZBENEF PIC  X(0001).
  1084     05  FILLER REDEFINES ZBENEF.
  1085         10  ZBENEA PIC  X(0001).
  1086     05  FILLER            PIC  X(3).
  1087     05  ZBENEI PIC  X(0001).
  1088*    -------------------------------
  1089     05  DCCOPTL PIC S9(0004) COMP.
  1090     05  DCCOPTF PIC  X(0001).
  1091     05  FILLER REDEFINES DCCOPTF.
  1092         10  DCCOPTA PIC  X(0001).
  1093     05  FILLER            PIC  X(3).
  1094     05  DCCOPTI PIC  X(0030).
  1095*    -------------------------------
  1096     05  ZFADAYSL PIC S9(0004) COMP.
  1097     05  ZFADAYSF PIC  X(0001).
  1098     05  FILLER REDEFINES ZFADAYSF.
  1099         10  ZFADAYSA PIC  X(0001).
  1100     05  FILLER            PIC  X(3).
  1101     05  ZFADAYSI PIC  X(0003).
  1102*    -------------------------------
  1103     05  ZACLOSEL PIC S9(0004) COMP.
  1104     05  ZACLOSEF PIC  X(0001).
  1105     05  FILLER REDEFINES ZACLOSEF.
  1106         10  ZACLOSEA PIC  X(0001).
  1107     05  FILLER            PIC  X(3).
  1108     05  ZACLOSEI PIC  X(0001).
  1109*    -------------------------------
  1110     05  ERRMSGL PIC S9(0004) COMP.
  1111     05  ERRMSGF PIC  X(0001).
  1112     05  FILLER REDEFINES ERRMSGF.
  1113         10  ERRMSGA PIC  X(0001).
  1114     05  FILLER            PIC  X(3).
  1115     05  ERRMSGI PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1041.cbl
  1116*    -------------------------------
  1117     05  PFKEYL PIC S9(0004) COMP.
  1118     05  PFKEYF PIC  X(0001).
  1119     05  FILLER REDEFINES PFKEYF.
  1120         10  PFKEYA PIC  X(0001).
  1121     05  FILLER            PIC  X(3).
  1122     05  PFKEYI PIC  99.
  1123 01  EL104ZO REDEFINES EL104ZI.
  1124     05  FILLER            PIC  X(0012).
  1125*    -------------------------------
  1126     05  FILLER            PIC  X(3).
  1127     05  DATEC PIC  X(0001).
  1128     05  DATEH PIC  X(0001).
  1129     05  DATEU PIC  X(0001).
  1130     05  DATEO PIC  X(0008).
  1131*    -------------------------------
  1132     05  FILLER            PIC  X(3).
  1133     05  TIMEC PIC  X(0001).
  1134     05  TIMEH PIC  X(0001).
  1135     05  TIMEU PIC  X(0001).
  1136     05  TIMEO PIC  99.99.
  1137*    -------------------------------
  1138     05  FILLER            PIC  X(3).
  1139     05  CMPNYIDC PIC  X(0001).
  1140     05  CMPNYIDH PIC  X(0001).
  1141     05  CMPNYIDU PIC  X(0001).
  1142     05  CMPNYIDO PIC  X(0003).
  1143*    -------------------------------
  1144     05  FILLER            PIC  X(3).
  1145     05  USERIDC PIC  X(0001).
  1146     05  USERIDH PIC  X(0001).
  1147     05  USERIDU PIC  X(0001).
  1148     05  USERIDO PIC  X(0004).
  1149*    -------------------------------
  1150     05  FILLER            PIC  X(3).
  1151     05  MAINTC PIC  X(0001).
  1152     05  MAINTH PIC  X(0001).
  1153     05  MAINTU PIC  X(0001).
  1154     05  MAINTO PIC  X(0001).
  1155*    -------------------------------
  1156     05  FILLER            PIC  X(3).
  1157     05  LSTUSRC PIC  X(0001).
  1158     05  LSTUSRH PIC  X(0001).
  1159     05  LSTUSRU PIC  X(0001).
  1160     05  LSTUSRO PIC  X(0004).
  1161*    -------------------------------
  1162     05  FILLER            PIC  X(3).
  1163     05  LSTDTEC PIC  X(0001).
  1164     05  LSTDTEH PIC  X(0001).
  1165     05  LSTDTEU PIC  X(0001).
  1166     05  LSTDTEO PIC  X(0008).
  1167*    -------------------------------
  1168     05  FILLER            PIC  X(3).
  1169     05  LSTTIMEC PIC  X(0001).
  1170     05  LSTTIMEH PIC  X(0001).
  1171     05  LSTTIMEU PIC  X(0001).
  1172     05  LSTTIMEO PIC  99.99.
  1173*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1041.cbl
  1174     05  FILLER            PIC  X(3).
  1175     05  ZLETRC PIC  X(0001).
  1176     05  ZLETRH PIC  X(0001).
  1177     05  ZLETRU PIC  X(0001).
  1178     05  ZLETRO PIC  X(0004).
  1179*    -------------------------------
  1180     05  FILLER            PIC  X(3).
  1181     05  ZCOPIESC PIC  X(0001).
  1182     05  ZCOPIESH PIC  X(0001).
  1183     05  ZCOPIESU PIC  X(0001).
  1184     05  ZCOPIESO PIC  9.
  1185*    -------------------------------
  1186     05  FILLER            PIC  X(3).
  1187     05  ZPROMPTC PIC  X(0001).
  1188     05  ZPROMPTH PIC  X(0001).
  1189     05  ZPROMPTU PIC  X(0001).
  1190     05  ZPROMPTO PIC  X(0001).
  1191*    -------------------------------
  1192     05  FILLER            PIC  X(3).
  1193     05  ZENCCDC PIC  X(0001).
  1194     05  ZENCCDH PIC  X(0001).
  1195     05  ZENCCDU PIC  X(0001).
  1196     05  ZENCCDO PIC  X(0003).
  1197*    -------------------------------
  1198     05  FILLER            PIC  X(3).
  1199     05  ZRDAYSC PIC  X(0001).
  1200     05  ZRDAYSH PIC  X(0001).
  1201     05  ZRDAYSU PIC  X(0001).
  1202     05  ZRDAYSO PIC  999.
  1203*    -------------------------------
  1204     05  FILLER            PIC  X(3).
  1205     05  ZFORMC PIC  X(0001).
  1206     05  ZFORMH PIC  X(0001).
  1207     05  ZFORMU PIC  X(0001).
  1208     05  ZFORMO PIC  X(0004).
  1209*    -------------------------------
  1210     05  FILLER            PIC  X(3).
  1211     05  ZBENEC PIC  X(0001).
  1212     05  ZBENEH PIC  X(0001).
  1213     05  ZBENEU PIC  X(0001).
  1214     05  ZBENEO PIC  X(0001).
  1215*    -------------------------------
  1216     05  FILLER            PIC  X(3).
  1217     05  DCCOPTC PIC  X(0001).
  1218     05  DCCOPTH PIC  X(0001).
  1219     05  DCCOPTU PIC  X(0001).
  1220     05  DCCOPTO PIC  X(0030).
  1221*    -------------------------------
  1222     05  FILLER            PIC  X(3).
  1223     05  ZFADAYSC PIC  X(0001).
  1224     05  ZFADAYSH PIC  X(0001).
  1225     05  ZFADAYSU PIC  X(0001).
  1226     05  ZFADAYSO PIC  999.
  1227*    -------------------------------
  1228     05  FILLER            PIC  X(3).
  1229     05  ZACLOSEC PIC  X(0001).
  1230     05  ZACLOSEH PIC  X(0001).
  1231     05  ZACLOSEU PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1041.cbl
  1232     05  ZACLOSEO PIC  X(0001).
  1233*    -------------------------------
  1234     05  FILLER            PIC  X(3).
  1235     05  ERRMSGC PIC  X(0001).
  1236     05  ERRMSGH PIC  X(0001).
  1237     05  ERRMSGU PIC  X(0001).
  1238     05  ERRMSGO PIC  X(0072).
  1239*    -------------------------------
  1240     05  FILLER            PIC  X(3).
  1241     05  PFKEYC PIC  X(0001).
  1242     05  PFKEYH PIC  X(0001).
  1243     05  PFKEYU PIC  X(0001).
  1244     05  PFKEYO PIC  99.
  1245*    -------------------------------
  1246****************************************************************
  1247*
  1248* Copyright (c) 2007 by Clerity Solutions, Inc.
  1249* All rights reserved.
  1250*
  1251****************************************************************
  1252 01  DFHEIV.
  1253   02  DFHEIV0               PIC X(35).
  1254   02  DFHEIV1               PIC X(08).
  1255   02  DFHEIV2               PIC X(08).
  1256   02  DFHEIV3               PIC X(08).
  1257   02  DFHEIV4               PIC X(06).
  1258   02  DFHEIV5               PIC X(04).
  1259   02  DFHEIV6               PIC X(04).
  1260   02  DFHEIV7               PIC X(02).
  1261   02  DFHEIV8               PIC X(02).
  1262   02  DFHEIV9               PIC X(01).
  1263   02  DFHEIV10              PIC S9(7) COMP-3.
  1264   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1265   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1266   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1267   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1268   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1269   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1270   02  DFHEIV17              PIC X(04).
  1271   02  DFHEIV18              PIC X(04).
  1272   02  DFHEIV19              PIC X(04).
  1273   02  DFHEIV20              USAGE IS POINTER.
  1274   02  DFHEIV21              USAGE IS POINTER.
  1275   02  DFHEIV22              USAGE IS POINTER.
  1276   02  DFHEIV23              USAGE IS POINTER.
  1277   02  DFHEIV24              USAGE IS POINTER.
  1278   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1279   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1280   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1281   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1282   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1283   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1284   02  FILLER                PIC X(02).
  1285   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1286   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1287   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1288   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1289   02  DFHEIVL3              PIC X(48) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1041.cbl
  1290 LINKAGE  SECTION.
  1291*****************************************************************
  1292*                                                               *
  1293* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1294* All rights reserved.                                          *
  1295*                                                               *
  1296*****************************************************************
  1297 01  dfheiblk.
  1298     02  eibtime          pic s9(7) comp-3.
  1299     02  eibdate          pic s9(7) comp-3.
  1300     02  eibtrnid         pic x(4).
  1301     02  eibtaskn         pic s9(7) comp-3.
  1302     02  eibtrmid         pic x(4).
  1303     02  dfheigdi         pic s9(4) comp.
  1304     02  eibcposn         pic s9(4) comp.
  1305     02  eibcalen         pic s9(4) comp.
  1306     02  eibaid           pic x(1).
  1307     02  eibfiller1       pic x(1).
  1308     02  eibfn            pic x(2).
  1309     02  eibfiller2       pic x(2).
  1310     02  eibrcode         pic x(6).
  1311     02  eibfiller3       pic x(2).
  1312     02  eibds            pic x(8).
  1313     02  eibreqid         pic x(8).
  1314     02  eibrsrce         pic x(8).
  1315     02  eibsync          pic x(1).
  1316     02  eibfree          pic x(1).
  1317     02  eibrecv          pic x(1).
  1318     02  eibsend          pic x(1).
  1319     02  eibatt           pic x(1).
  1320     02  eibeoc           pic x(1).
  1321     02  eibfmh           pic x(1).
  1322     02  eibcompl         pic x(1).
  1323     02  eibsig           pic x(1).
  1324     02  eibconf          pic x(1).
  1325     02  eiberr           pic x(1).
  1326     02  eibrldbk         pic x(1).
  1327     02  eiberrcd         pic x(4).
  1328     02  eibsynrb         pic x(1).
  1329     02  eibnodat         pic x(1).
  1330     02  eibfiller5       pic x(2).
  1331     02  eibresp          pic 9(09) comp.
  1332     02  eibresp2         pic 9(09) comp.
  1333     02  dfheigdj         pic s9(4) comp.
  1334     02  dfheigdk         pic s9(4) comp.
  1335 01  DFHCOMMAREA                     PIC X(1024).
  1336*                                    COPY ELCTEXT.
  1337******************************************************************
  1338*                                                                *
  1339*                                                                *
  1340*                            ELCTEXT.                            *
  1341*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1342*                            VMOD=2.008                          *
  1343*                                                                *
  1344*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1345*                                     FORM LETTERS,              *
  1346*                                     CERT FORM DISPLAY.
  1347*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1041.cbl
  1348*   FILE TYPE = VSAM,KSDS                                        *
  1349*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1350*                                                                *
  1351*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1352*       ALTERNATE INDEX = NONE                                   *
  1353*                                                                *
  1354*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1355*       ALTERNATE INDEX = NONE                                   *
  1356*                                                                *
  1357*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1358*       ALTERNATE INDEX = NONE                                   *
  1359*                                                                *
  1360*   LOG = NO                                                     *
  1361*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1362******************************************************************
  1363 01  TEXT-FILES.
  1364     12  TEXT-FILE-ID                PIC XX.
  1365         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1366         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1367         88  HELP-FILE-TEXT             VALUE 'TH'.
  1368
  1369     12  TX-CONTROL-PRIMARY.
  1370         16  TX-COMPANY-CD           PIC X.
  1371             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1372         16  TX-ACCESS-CD-GENL       PIC X(12).
  1373
  1374         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1375             20  TX-LETTER-NO        PIC X(4).
  1376             20  FILLER              PIC X(8).
  1377
  1378         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1379             20  TX-FORM-NO          PIC X(12).
  1380
  1381         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1382             20  TX-HELP-TYPE        PIC X.
  1383                 88  HELP-FOR-GENERAL   VALUE ' '.
  1384                 88  HELP-BY-SCREEN     VALUE 'S'.
  1385                 88  HELP-BY-ERROR      VALUE 'E'.
  1386             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1387                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1388             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1389                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1390             20  FILLER              PIC X(4).
  1391
  1392         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1393
  1394     12  TX-PROCESS-CONTROL          PIC XX.
  1395         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1396
  1397     12  TX-TEXT-LINE                PIC X(70).
  1398
  1399     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1400         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1401         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1402         88  TX-VALID-FORM-SQUEEZE-VALUE
  1403                                        VALUE 'Y' ' '.
  1404
  1405     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1041.cbl
  1406         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1407         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1408         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1409         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1410         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1411         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1412         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1413                                              'K' 'N' ' '
  1414                                              'Z'.
  1415
  1416     12  TX-ARCHIVE-SW               PIC X.
  1417         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1418         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1419         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1420
  1421     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1422     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1423
  1424     12  TX-BSR-CODE                 PIC X.
  1425         88  TX-BSR-LETTER              VALUE 'B'.
  1426         88  TX-NON-BSR-LETTER          VALUE ' '.
  1427
  1428     12  FILLER                      PIC X.
  1429*****************************************************************
  1430 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES.
  1431 0000-DFHEXIT SECTION.
  1432     MOVE '9#                    $   ' TO DFHEIV0.
  1433     MOVE 'EL1041' TO DFHEIV1.
  1434     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1435     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1436     MOVE '5'                    TO DC-OPTION-CODE
  1437     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1438     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1439     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1440     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1441     IF EIBCALEN = 0
  1442        GO TO 8800-UNAUTHORIZED-ACCESS.
  1443     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  1444     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  1445     MOVE 1                      TO EMI-NUMBER-OF-LINES
  1446
  1447* EXEC CICS HANDLE CONDITION
  1448*        DUPREC     (8850-DUPREC)
  1449*        NOTOPEN    (8870-NOTOPEN)
  1450*        NOTFND     (8880-NOT-FOUND)
  1451*        PGMIDERR   (9600-PGMID-ERROR)
  1452*        ERROR      (9990-ABEND)
  1453*    END-EXEC.
  1454*    MOVE '"$%JIL.               ! " #00001442' TO DFHEIV0
  1455     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  1456     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1457     MOVE X'2220233030303031343432' TO DFHEIV0(25:11)
  1458     CALL 'kxdfhei1' USING DFHEIV0
  1459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1460
  1461     .
  1462 0150-SET-PROGRAM-SAVES.
  1463     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1041.cbl
  1464         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  1465             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1466             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1467             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1468             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1469             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1470             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1471             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1472             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1473         ELSE
  1474             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1475             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1476             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1477             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1478             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1479             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1480             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1481             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1482     ELSE
  1483         GO TO 0200-RECEIVE.
  1484     DISPLAY ' COMM KEY PASSED ' PI-COMM-CONTROL
  1485     MOVE PI-COMPANY-CD          TO ELLETR-KEY
  1486     MOVE PI-COMM-CONTROL        TO ELLETR-KEY (2:12)
  1487     MOVE ZEROS                  TO ELLETR-SEQ-NO
  1488     MOVE ELLETR-KEY             TO PI-CURR-LETR-KEY
  1489                                    PI-PREV-LETR-KEY
  1490     GO TO 1000-SHOW-LETR-RECORD
  1491     .
  1492 0200-RECEIVE.
  1493     IF EIBAID = DFHCLEAR
  1494        GO TO 9400-CLEAR.
  1495     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1496         MOVE LOW-VALUES             TO  EL104ZI
  1497         MOVE ER-7008                TO  EMI-ERROR
  1498         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1499         MOVE -1                     TO  MAINTL
  1500         GO TO 8200-SEND-DATAONLY.
  1501     IF PI-PROCESSOR-ID EQUAL 'LGXX'
  1502         NEXT SENTENCE
  1503     ELSE
  1504
  1505* EXEC CICS READQ TS
  1506*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1507*            INTO   (SECURITY-CONTROL)
  1508*            LENGTH (SC-COMM-LENGTH)
  1509*            ITEM   (SC-ITEM)
  1510*        END-EXEC
  1511*    MOVE '*$II   L              ''   #00001492' TO DFHEIV0
  1512     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1513     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1514     MOVE X'2020233030303031343932' TO DFHEIV0(25:11)
  1515     CALL 'kxdfhei1' USING DFHEIV0,
  1516           PI-SECURITY-TEMP-STORE-ID,
  1517           SECURITY-CONTROL,
  1518           SC-COMM-LENGTH,
  1519           SC-ITEM,
  1520           DFHEIV99,
  1521           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1041.cbl
  1522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1523         MOVE SC-CLAIMS-DISPLAY (4)  TO  PI-DISPLAY-CAP
  1524         MOVE SC-CLAIMS-UPDATE  (4)  TO  PI-MODIFY-CAP.
  1525
  1526* EXEC CICS RECEIVE
  1527*        MAP      (WS-MAP-NAME)
  1528*        MAPSET   (MAPSET-NAME)
  1529*        INTO     (EL104ZI)
  1530*    END-EXEC
  1531     MOVE LENGTH OF
  1532      EL104ZI
  1533       TO DFHEIV11
  1534*    MOVE '8"T I  L              ''   #00001500' TO DFHEIV0
  1535     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1536     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1537     MOVE X'2020233030303031353030' TO DFHEIV0(25:11)
  1538     CALL 'kxdfhei1' USING DFHEIV0,
  1539           WS-MAP-NAME,
  1540           EL104ZI,
  1541           DFHEIV11,
  1542           MAPSET-NAME,
  1543           DFHEIV99,
  1544           DFHEIV99
  1545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1546     IF PFKEYL = +0
  1547         GO TO 0300-CHECK-PFKEYS.
  1548     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
  1549         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  1550     ELSE
  1551         MOVE ER-0029                TO  EMI-ERROR
  1552         GO TO 0320-INPUT-ERROR.
  1553 0300-CHECK-PFKEYS.
  1554     DISPLAY ' MADE IT TO 0300 '
  1555     IF EIBAID EQUAL DFHPF23
  1556         GO TO 8810-PF23.
  1557     IF EIBAID EQUAL DFHPF24
  1558         GO TO 9200-RETURN-MAIN-MENU.
  1559     IF EIBAID EQUAL DFHPF12
  1560         GO TO 9500-PF12.
  1561     IF (MAINTL <> 0) AND (EIBAID <> DFHENTER)
  1562         MOVE ER-0050            TO EMI-ERROR
  1563         GO TO 0320-INPUT-ERROR.
  1564     IF EIBAID EQUAL DFHENTER
  1565         GO TO 0330-EDIT-DATA.
  1566     MOVE ER-0029                    TO  EMI-ERROR.
  1567 0320-INPUT-ERROR.
  1568     DISPLAY ' MADE IT TO 0320 '
  1569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1570     MOVE AL-UNBON                   TO  PFKEYA.
  1571     MOVE -1                         TO  PFKEYL.
  1572     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1041.cbl
  1574 0330-EDIT-DATA.
  1575     IF NOT DISPLAY-CAP
  1576         MOVE 'READ'                 TO  SM-READ
  1577         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1578         MOVE ER-0070                TO  EMI-ERROR
  1579         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1580         MOVE -1                     TO  MAINTL
  1581         GO TO 8100-SEND-INITIAL-MAP.
  1582     IF MAINTI EQUAL 'S'
  1583        GO TO 1000-SHOW-LETR-RECORD.
  1584     IF MAINTI = 'C' OR 'A'
  1585        IF NOT MODIFY-CAP
  1586           PERFORM 9995-SECURITY-VIOLATION
  1587                                 THRU 9995-EXIT
  1588           MOVE ER-0070          TO EMI-ERROR
  1589           PERFORM 9900-ERROR-FORMAT
  1590                                 THRU 9900-EXIT
  1591           MOVE LOW-VALUES       TO EL104ZO
  1592           MOVE -1               TO MAINTL
  1593           GO TO 8100-SEND-INITIAL-MAP
  1594        END-IF
  1595     END-IF
  1596     IF MAINTI = 'C'
  1597        GO TO 2000-CHANGE-LETR-RECORD
  1598     END-IF
  1599     IF MAINTI = 'A'
  1600        GO TO 3000-ADD-LETR-RECORD
  1601     END-IF
  1602     MOVE ER-0023                    TO  EMI-ERROR.
  1603     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1604     MOVE -1                         TO  MAINTL.
  1605     MOVE AL-UABON                   TO  MAINTA.
  1606     GO TO 8200-SEND-DATAONLY.
  1607 1000-SHOW-LETR-RECORD.
  1608     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1609
  1610* EXEC CICS STARTBR
  1611*        DATASET   (ELLETR-FILE-ID)
  1612*        RIDFLD    (ELLETR-KEY)
  1613*        GTEQ
  1614*        RESP      (WS-RESPONSE)
  1615*    END-EXEC
  1616     MOVE 0
  1617       TO DFHEIV11
  1618*    MOVE '&,         G          &  N#00001568' TO DFHEIV0
  1619     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1620     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1621     MOVE X'204E233030303031353638' TO DFHEIV0(25:11)
  1622     CALL 'kxdfhei1' USING DFHEIV0,
  1623           ELLETR-FILE-ID,
  1624           ELLETR-KEY,
  1625           DFHEIV99,
  1626           DFHEIV11,
  1627           DFHEIV99
  1628     MOVE EIBRESP  TO WS-RESPONSE
  1629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1630     IF RESP-NORMAL
  1631        PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1041.cbl
  1632           OR WE-FOUND-IT
  1633
  1634* EXEC CICS READNEXT
  1635*              DATASET    (ELLETR-FILE-ID)
  1636*              SET        (ADDRESS OF TEXT-FILES)
  1637*              RIDFLD     (ELLETR-KEY)
  1638*              RESP       (WS-RESPONSE)
  1639*          END-EXEC
  1640     MOVE 0
  1641       TO DFHEIV11
  1642*    MOVE '&.S                   )  N#00001577' TO DFHEIV0
  1643     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1644     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1645     MOVE X'204E233030303031353737' TO DFHEIV0(25:11)
  1646     CALL 'kxdfhei1' USING DFHEIV0,
  1647           ELLETR-FILE-ID,
  1648           DFHEIV20,
  1649           DFHEIV99,
  1650           ELLETR-KEY,
  1651           DFHEIV99,
  1652           DFHEIV11,
  1653           DFHEIV99,
  1654           DFHEIV99
  1655     SET ADDRESS OF TEXT-FILES TO
  1656         DFHEIV20
  1657     MOVE EIBRESP  TO WS-RESPONSE
  1658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1659           IF (RESP-NORMAL)
  1660              AND (TX-LETTER-NO = PI-COMM-CONTROL (1:4))
  1661              IF (TX-LINE-SQUEEZE-CONTROL = 'Z')
  1662                 SET WE-FOUND-IT   TO TRUE
  1663              END-IF
  1664           ELSE
  1665              SET I-SAY-TO-STOP  TO TRUE
  1666           END-IF
  1667        END-PERFORM
  1668     END-IF
  1669     IF WE-FOUND-IT
  1670        MOVE TX-CONTROL-PRIMARY  TO PI-CURR-LETR-KEY
  1671                                    PI-PREV-LETR-KEY
  1672        GO TO 7000-BUILD-OUTPUT-MAP
  1673     END-IF
  1674     MOVE ER-0418                TO EMI-ERROR.
  1675     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1676     MOVE -1                     TO MAINTL
  1677     MOVE 'A'                    TO MAINTI
  1678     MOVE AL-UANON               TO MAINTA
  1679     MOVE PI-COMM-CONTROL (1:4)  TO ZLETRI
  1680     MOVE +4                     TO ZLETRL
  1681     MOVE AL-UANON               TO ZLETRA
  1682     GO TO 8100-SEND-INITIAL-MAP
  1683     .
  1684 2000-CHANGE-LETR-RECORD.
  1685     display ' made it to 2000 '
  1686     display ' curr   ' pi-curr-letr-key
  1687     display ' prev   ' pi-prev-letr-key
  1688     IF PI-CURR-LETR-KEY NOT = PI-PREV-LETR-KEY
  1689        MOVE ER-0145             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1041.cbl
  1690        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1691        MOVE -1                  TO MAINTL
  1692        GO TO 8200-SEND-DATAONLY
  1693     END-IF
  1694     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1695     IF NOT EMI-NO-ERRORS
  1696         GO TO 8200-SEND-DATAONLY.
  1697     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1698     .
  1699 2000-CHANGE-CONTINUE.
  1700
  1701* EXEC CICS READ
  1702*        DATASET    (ELLETR-FILE-ID)
  1703*        SET        (ADDRESS OF TEXT-FILES)
  1704*        RIDFLD     (ELLETR-KEY)
  1705*        UPDATE
  1706*        RESP       (WS-RESPONSE)
  1707*    END-EXEC
  1708*    MOVE '&"S        EU         (  N#00001624' TO DFHEIV0
  1709     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1710     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1711     MOVE X'204E233030303031363234' TO DFHEIV0(25:11)
  1712     CALL 'kxdfhei1' USING DFHEIV0,
  1713           ELLETR-FILE-ID,
  1714           DFHEIV20,
  1715           DFHEIV99,
  1716           ELLETR-KEY,
  1717           DFHEIV99,
  1718           DFHEIV99,
  1719           DFHEIV99
  1720     SET ADDRESS OF TEXT-FILES TO
  1721         DFHEIV20
  1722     MOVE EIBRESP  TO WS-RESPONSE
  1723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1724     IF RESP-NOTFND
  1725        IF ELLETR-SEQ-NO = +0
  1726           GO TO 3000-CONTINUE-ADD
  1727        END-IF
  1728     END-IF
  1729     IF TX-LAST-MAINTENANCED-BY NOT = PI-UPDATE-BY OR
  1730        TX-LAST-MAINTENANCED-DT NOT = PI-UPDATE-DT
  1731
  1732* EXEC CICS UNLOCK
  1733*            DATASET   (ELLETR-FILE-ID)
  1734*        END-EXEC
  1735*    MOVE '&*                    #   #00001638' TO DFHEIV0
  1736     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  1737     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1738     MOVE X'2020233030303031363338' TO DFHEIV0(25:11)
  1739     CALL 'kxdfhei1' USING DFHEIV0,
  1740           ELLETR-FILE-ID,
  1741           DFHEIV99
  1742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1743         MOVE ER-0068                TO  EMI-ERROR
  1744         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1745         GO TO 1000-SHOW-LETR-RECORD.
  1746     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  1747     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL1041.cbl
  1748     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  1749     IF ZCOPIESL > +0
  1750        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  1751     END-IF
  1752     IF ZFADAYSL > +0
  1753        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  1754     END-IF
  1755     IF ZRDAYSL > +0
  1756        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND-1
  1757     END-IF
  1758     IF ZFORML > +0
  1759        MOVE ZFORMI              TO W-FORM-TO-RESEND
  1760     END-IF
  1761     IF ZPROMPTL > +0
  1762        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  1763     END-IF
  1764     IF ZENCCDL > +0
  1765        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  1766     END-IF
  1767     IF ZACLOSEL > +0
  1768        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  1769     END-IF
  1770     IF ZBENEL > +0
  1771        MOVE ZBENEI              TO W-LETTER-TO-BENE
  1772     END-IF
  1773     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  1774     .
  1775 2000-CONTINUE-CHANGE.
  1776     DISPLAY ' ABOUT TO REWRITE '
  1777
  1778* EXEC CICS REWRITE
  1779*        DATASET   (ELLETR-FILE-ID)
  1780*        FROM      (TEXT-FILES)
  1781*    END-EXEC.
  1782     MOVE LENGTH OF
  1783      TEXT-FILES
  1784       TO DFHEIV11
  1785*    MOVE '&& L                  %   #00001675' TO DFHEIV0
  1786     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1787     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1788     MOVE X'2020233030303031363735' TO DFHEIV0(25:11)
  1789     CALL 'kxdfhei1' USING DFHEIV0,
  1790           ELLETR-FILE-ID,
  1791           TEXT-FILES,
  1792           DFHEIV11,
  1793           DFHEIV99
  1794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1795
  1796     MOVE ER-0000                    TO  EMI-ERROR.
  1797     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1798     GO TO 1000-SHOW-LETR-RECORD
  1799     .
  1800 3000-ADD-LETR-RECORD.
  1801     display ' made it to 3000 '
  1802     display ' curr   ' pi-curr-letr-key
  1803     display ' prev   ' pi-prev-letr-key
  1804     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1805     .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL1041.cbl
  1806 3000-CONTINUE-ADD.
  1807     IF NOT EMI-NO-ERRORS
  1808        GO TO 8200-SEND-DATAONLY
  1809     END-IF
  1810     MOVE SPACES                 TO ELLETR-KEY
  1811     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD
  1812     MOVE ZLETRI                 TO ELLETR-ACCESS-CD
  1813     MOVE +0                     TO ELLETR-SEQ-NO
  1814
  1815* EXEC CICS READ
  1816*        DATASET    (ELLETR-FILE-ID)
  1817*        SET        (ADDRESS OF TEXT-FILES)
  1818*        RIDFLD     (ELLETR-KEY)
  1819*        GTEQ
  1820*        RESP       (WS-RESPONSE)
  1821*    END-EXEC
  1822*    MOVE '&"S        G          (  N#00001697' TO DFHEIV0
  1823     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  1824     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1825     MOVE X'204E233030303031363937' TO DFHEIV0(25:11)
  1826     CALL 'kxdfhei1' USING DFHEIV0,
  1827           ELLETR-FILE-ID,
  1828           DFHEIV20,
  1829           DFHEIV99,
  1830           ELLETR-KEY,
  1831           DFHEIV99,
  1832           DFHEIV99,
  1833           DFHEIV99
  1834     SET ADDRESS OF TEXT-FILES TO
  1835         DFHEIV20
  1836     MOVE EIBRESP  TO WS-RESPONSE
  1837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1838     IF RESP-NORMAL
  1839        IF TX-LETTER-NO = ZLETRI
  1840           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  1841              MOVE ER-0132       TO EMI-ERROR
  1842              PERFORM 9900-ERROR-FORMAT
  1843                                 THRU 9900-EXIT
  1844              MOVE -1            TO ZLETRL
  1845              MOVE AL-UABON      TO ZLETRA
  1846              GO TO 8200-SEND-DATAONLY
  1847           ELSE
  1848              MOVE +0            TO WS-SEQ-NO-TO-USE
  1849           END-IF
  1850        ELSE
  1851           MOVE +1               TO WS-SEQ-NO-TO-USE
  1852        END-IF
  1853     ELSE
  1854        MOVE +1                  TO WS-SEQ-NO-TO-USE
  1855     END-IF
  1856
  1857* EXEC CICS GETMAIN
  1858*       SET(ADDRESS OF TEXT-FILES)
  1859*       LENGTH(ELLETR-LENGTH)
  1860*    END-EXEC
  1861*    MOVE '," L                  $   #00001722' TO DFHEIV0
  1862     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  1863     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL1041.cbl
  1864     MOVE X'2020233030303031373232' TO DFHEIV0(25:11)
  1865     CALL 'kxdfhei1' USING DFHEIV0,
  1866           DFHEIV20,
  1867           ELLETR-LENGTH,
  1868           DFHEIV99
  1869     SET ADDRESS OF TEXT-FILES TO
  1870         DFHEIV20
  1871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1872     MOVE SPACES                 TO TEXT-FILES
  1873     MOVE 'TL'                   TO TEXT-FILE-ID
  1874     MOVE PI-COMPANY-CD          TO TX-COMPANY-CD
  1875     MOVE ZLETRI                 TO TX-LETTER-NO
  1876     MOVE WS-SEQ-NO-TO-USE       TO TX-LINE-SEQUENCE
  1877     MOVE 'Z'                    TO TX-LINE-SQUEEZE-CONTROL
  1878     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  1879     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  1880     MOVE SPACES                 TO W-Z-CONTROL-DATA
  1881     IF ZCOPIESL > +0
  1882        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  1883     ELSE
  1884        MOVE 1                   TO W-NUMBER-OF-COPIES
  1885     END-IF
  1886     IF ZFADAYSL > +0
  1887        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  1888     ELSE
  1889        MOVE ZEROS               TO W-DAYS-TO-FOLLOW-UP
  1890     END-IF
  1891     IF ZRDAYSL > +0
  1892        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND-1
  1893     ELSE
  1894        MOVE ZEROS               TO W-DAYS-TO-RESEND-1
  1895     END-IF
  1896     IF ZFORML > +0
  1897        MOVE ZFORMI              TO W-FORM-TO-RESEND
  1898     END-IF
  1899     IF ZPROMPTL > +0
  1900        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  1901     END-IF
  1902     IF ZENCCDL > +0
  1903        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  1904     END-IF
  1905     IF ZACLOSEL > +0
  1906        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  1907     END-IF
  1908     IF ZBENEL > +0
  1909        MOVE ZBENEI              TO W-LETTER-TO-BENE
  1910     END-IF
  1911     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  1912     DISPLAY ' ABOUT TO WRITE '
  1913     MOVE TX-CONTROL-PRIMARY     TO ELLETR-KEY
  1914                                    PI-CURR-LETR-KEY
  1915                                    PI-PREV-LETR-KEY
  1916
  1917* EXEC CICS WRITE
  1918*       DATASET (ELLETR-FILE-ID)
  1919*       FROM    (TEXT-FILES)
  1920*       RIDFLD  (ELLETR-KEY)
  1921*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL1041.cbl
  1922     MOVE LENGTH OF
  1923      TEXT-FILES
  1924       TO DFHEIV11
  1925*    MOVE '&$ L                  ''   #00001770' TO DFHEIV0
  1926     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  1927     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1928     MOVE X'2020233030303031373730' TO DFHEIV0(25:11)
  1929     CALL 'kxdfhei1' USING DFHEIV0,
  1930           ELLETR-FILE-ID,
  1931           TEXT-FILES,
  1932           DFHEIV11,
  1933           ELLETR-KEY,
  1934           DFHEIV99,
  1935           DFHEIV99
  1936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1937     MOVE ER-0000                    TO  EMI-ERROR.
  1938     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1939     GO TO 1000-SHOW-LETR-RECORD
  1940     .
  1941 5000-FIND-NEXT-PROD-RECORD.
  1942*    MOVE PI-PROD-KEY            TO ELLETR-KEY
  1943*
  1944*    EXEC CICS STARTBR
  1945*        DATASET   (ELLETR-FILE-ID)
  1946*        RIDFLD    (ELLETR-KEY)
  1947*        GTEQ
  1948*        RESP      (WS-RESPONSE)
  1949*    END-EXEC
  1950*
  1951*    IF NOT RESP-NORMAL
  1952*       MOVE -1                  TO PFKEYL
  1953*       MOVE ER-0130             TO EMI-ERROR
  1954*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1955*       GO TO 8200-SEND-DATAONLY
  1956*    END-IF
  1957     .
  1958 5000-READNEXT-LOOP.
  1959*    EXEC CICS READNEXT
  1960*        DATASET   (ELLETR-FILE-ID)
  1961*        SET       (ADDRESS OF PRODUCT-MASTER)
  1962*        RIDFLD    (ELLETR-KEY)
  1963*        RESP      (WS-RESPONSE)
  1964*    END-EXEC
  1965*
  1966*    IF (NOT RESP-NORMAL)
  1967*       OR (PD-COMPANY-CD NOT = PI-COMPANY-CD)
  1968*       PERFORM 5000-END-BROWSE
  1969*       MOVE -1                  TO PFKEYL
  1970*       MOVE ER-0130             TO EMI-ERROR
  1971*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1972*       GO TO 1000-SHOW-LETR-RECORD
  1973*    END-IF
  1974*
  1975*    IF ELLETR-KEY = PI-PREV-LETR-KEY
  1976*       GO TO 5000-READNEXT-LOOP
  1977*    END-IF
  1978*
  1979*    MOVE ELLETR-KEY             TO PI-PROD-KEY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL1041.cbl
  1980*
  1981*    PERFORM 5000-END-BROWSE
  1982*    GO TO 7000-BUILD-OUTPUT-MAP
  1983     .
  1984 5000-END-BROWSE.
  1985*    EXEC CICS ENDBR
  1986*        DATASET   (ELLETR-FILE-ID)
  1987*    END-EXEC
  1988     .
  1989 5100-FIND-PREV-PROD-RECORD.
  1990*    MOVE PI-PREV-LETR-KEY       TO ELLETR-KEY
  1991*    IF STATEL > +0
  1992*       MOVE STATEI              TO ELLETR-STATE
  1993*    END-IF
  1994*    IF PRODCDL > +0
  1995*       MOVE PRODCDI             TO ELLETR-PROD-CD
  1996*    END-IF
  1997*    IF BENTYPL > +0
  1998*        MOVE BENTYPI                TO  ELLETR-BEN-TYPE.
  1999*    IF BENCODEL > +0
  2000*        MOVE BENCODEI               TO  ELLETR-BEN-CODE.
  2001*    IF EXPDTL IS GREATER THAN +0
  2002*        MOVE EXPDTI                 TO  DEEDIT-FIELD
  2003*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  2004*        IF WS-NUMVAL-OF-DEEDIT >= 999999
  2005*            MOVE HIGH-VALUES        TO  ELLETR-EXP-DT
  2006*        ELSE
  2007*          STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:12)
  2008*             DELIMITED BY SIZE INTO DC-GREG-DATE-CYMD
  2009*          END-STRING
  2010*           MOVE 'L'                    TO  DC-OPTION-CODE
  2011*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2012*            IF NO-CONVERSION-ERROR
  2013*                MOVE DC-BIN-DATE-1  TO  ELLETR-EXP-DT
  2014*            ELSE
  2015*                MOVE LOW-VALUES     TO  ELLETR-EXP-DT.
  2016*
  2017*    EXEC CICS HANDLE CONDITION
  2018*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  2019*    END-EXEC.
  2020*
  2021*    EXEC CICS STARTBR
  2022*        DATASET   (ELLETR-FILE-ID)
  2023*        RIDFLD    (ELLETR-KEY)
  2024*        GTEQ
  2025*    END-EXEC.
  2026 5100-READPREV-LOOP.
  2027*    EXEC CICS READPREV
  2028*        DATASET   (ELLETR-FILE-ID)
  2029*        SET       (ADDRESS OF PRODUCT-MASTER)
  2030*        RIDFLD    (ELLETR-KEY)
  2031*    END-EXEC.
  2032*
  2033*    IF PD-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  2034*        GO TO 5100-UNSUCCESSFUL-SEARCH.
  2035*
  2036*    IF ELLETR-KEY IS EQUAL TO PI-PREV-LETR-KEY
  2037*        GO TO 5100-READPREV-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL1041.cbl
  2038*
  2039*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2040*
  2041*    GO TO 7000-BUILD-OUTPUT-MAP.
  2042 5100-END-BROWSE.
  2043*    EXEC CICS ENDBR
  2044*        DATASET   (ELLETR-FILE-ID)
  2045*    END-EXEC.
  2046 5100-UNSUCCESSFUL-SEARCH.
  2047     PERFORM 5100-END-BROWSE.
  2048     MOVE ER-0131                    TO  EMI-ERROR.
  2049     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2050     GO TO 1000-SHOW-LETR-RECORD.
  2051     .
  2052 6000-EDIT-INPUT-DATA.
  2053     IF MAINTI = 'A'
  2054        IF ZLETRL > +0
  2055           AND ZLETRI NOT = SPACES
  2056           CONTINUE
  2057        ELSE
  2058           MOVE AL-UNBON         TO ZCOPIESA
  2059           MOVE -1               TO ZCOPIESL
  2060           MOVE ER-0005          TO EMI-ERROR
  2061           PERFORM 9900-ERROR-FORMAT
  2062                                 THRU 9900-EXIT
  2063        END-IF
  2064     END-IF
  2065     IF ZCOPIESL > +0
  2066        IF ZCOPIESI NUMERIC
  2067           CONTINUE
  2068        ELSE
  2069           MOVE AL-UNBON         TO ZCOPIESA
  2070           MOVE -1               TO ZCOPIESL
  2071           MOVE ER-0184          TO EMI-ERROR
  2072           PERFORM 9900-ERROR-FORMAT
  2073                                 THRU 9900-EXIT
  2074        END-IF
  2075     END-IF
  2076     IF ZFADAYSL > +0
  2077        IF ZFADAYSI NUMERIC
  2078           CONTINUE
  2079        ELSE
  2080           MOVE AL-UNBON         TO ZFADAYSA
  2081           MOVE -1               TO ZFADAYSL
  2082           MOVE ER-0491          TO EMI-ERROR
  2083           PERFORM 9900-ERROR-FORMAT
  2084                                 THRU 9900-EXIT
  2085        END-IF
  2086     END-IF
  2087     IF ZRDAYSL > +0
  2088        IF ZRDAYSI NUMERIC
  2089           CONTINUE
  2090        ELSE
  2091           MOVE AL-UNBON         TO ZRDAYSA
  2092           MOVE -1               TO ZRDAYSL
  2093           MOVE ER-0491          TO EMI-ERROR
  2094           PERFORM 9900-ERROR-FORMAT
  2095                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL1041.cbl
  2096        END-IF
  2097     END-IF
  2098     IF ZPROMPTL > +0
  2099        IF ZPROMPTI = 'Y' OR 'N' OR ' '
  2100           CONTINUE
  2101        ELSE
  2102           MOVE AL-UABON         TO ZPROMPTA
  2103           MOVE -1               TO ZPROMPTL
  2104           MOVE ER-0627          TO EMI-ERROR
  2105           PERFORM 9900-ERROR-FORMAT
  2106                                 THRU 9900-EXIT
  2107        END-IF
  2108     END-IF
  2109     IF MAINTI = 'A'
  2110        AND ZENCCDL <= 0
  2111        MOVE AL-UABON            TO ZENCCDA
  2112        MOVE -1                  TO ZENCCDL
  2113        MOVE ER-1560             TO EMI-ERROR
  2114        PERFORM 9900-ERROR-FORMAT
  2115                                 THRU 9900-EXIT
  2116     END-IF
  2117     IF ZENCCDL > +0
  2118        IF ZENCCDI = ('1'  OR '1P' OR '2' OR '3'  OR '4'
  2119           OR '5' OR 'A'  OR 'C'  OR 'E' OR 'EP' OR 'ENV' OR 'I'
  2120           OR '0' OR '4P' OR '5P' OR '@')
  2121                        OR
  2122           ((PI-COMPANY-ID = 'DCC')
  2123           AND (ZENCCDI = '6'  OR '7' OR '8' OR '9'))
  2124           CONTINUE
  2125        ELSE
  2126           MOVE AL-UABON         TO ZENCCDA
  2127           MOVE -1               TO ZENCCDL
  2128           MOVE ER-1560          TO EMI-ERROR
  2129           PERFORM 9900-ERROR-FORMAT
  2130                                 THRU 9900-EXIT
  2131        END-IF
  2132     END-IF
  2133     IF ZACLOSEL > +0
  2134        IF ZACLOSEI = 'S' OR 'C' OR 'B' OR ' '
  2135           CONTINUE
  2136        ELSE
  2137           MOVE -1               TO ZACLOSEL
  2138           MOVE AL-UABON         TO ZACLOSEA
  2139           MOVE ER-1562          TO EMI-ERROR
  2140           PERFORM 9900-ERROR-FORMAT
  2141                                 THRU 9900-EXIT
  2142        END-IF
  2143     END-IF
  2144     IF ZBENEL > +0
  2145        IF ZBENEI = 'Y' OR 'N' OR ' '
  2146           CONTINUE
  2147        ELSE
  2148           MOVE AL-UABON         TO ZBENEA
  2149           MOVE -1               TO ZBENEL
  2150           MOVE ER-0627          TO EMI-ERROR
  2151           PERFORM 9900-ERROR-FORMAT
  2152                                 THRU 9900-EXIT
  2153        END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL1041.cbl
  2154     END-IF
  2155     .
  2156 6000-EXIT.
  2157     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL1041.cbl
  2159 7000-BUILD-OUTPUT-MAP.
  2160     MOVE LOW-VALUES             TO EL104ZO
  2161     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2162     MOVE TX-LETTER-NO           TO ZLETRO
  2163     MOVE W-NUMBER-OF-COPIES     TO ZCOPIESO
  2164     MOVE W-DAYS-TO-FOLLOW-UP    TO ZFADAYSO
  2165     MOVE W-DAYS-TO-RESEND-1     TO ZRDAYSO
  2166     MOVE W-FORM-TO-RESEND       TO ZFORMO
  2167     MOVE W-PROMPT-LETTER        TO ZPROMPTO
  2168     MOVE W-ENCLOSURE-CD         TO ZENCCDO
  2169     MOVE W-AUTO-CLOSE-IND       TO ZACLOSEO
  2170     MOVE W-LETTER-TO-BENE       TO ZBENEO
  2171     MOVE TX-LAST-MAINTENANCED-BY TO LSTUSRO
  2172                                    PI-UPDATE-BY
  2173     MOVE TX-LAST-MAINTENANCED-DT TO PI-UPDATE-DT
  2174                                    DC-BIN-DATE-1
  2175     MOVE ' '                    TO DC-OPTION-CODE
  2176     MOVE +0                     TO DC-ELAPSED-DAYS
  2177                                     DC-ELAPSED-MONTHS.
  2178     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2179     IF NO-CONVERSION-ERROR
  2180        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2181     ELSE
  2182        MOVE LOW-VALUES          TO LSTDTEO
  2183     END-IF
  2184     MOVE -1                     TO MAINTL
  2185     .
  2186 8100-SEND-INITIAL-MAP.
  2187     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2188     MOVE EIBTIME                    TO  TIME-IN.
  2189     MOVE SAVE-DATE                  TO  DATEO.
  2190     MOVE TIME-OUT                   TO  TIMEO
  2191     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2192     MOVE PI-PROCESSOR-ID        TO USERIDO
  2193     IF PI-COMPANY-ID = 'DCC'
  2194        MOVE AL-SANOF            TO DCCOPTA
  2195     END-IF
  2196
  2197* EXEC CICS SEND
  2198*        MAP      (WS-MAP-NAME)
  2199*        MAPSET   (MAPSET-NAME)
  2200*        FROM     (EL104ZO)
  2201*        ERASE
  2202*        CURSOR
  2203*    END-EXEC.
  2204     MOVE LENGTH OF
  2205      EL104ZO
  2206       TO DFHEIV12
  2207     MOVE -1
  2208       TO DFHEIV11
  2209*    MOVE '8$     CT  E    H L F ,   #00002034' TO DFHEIV0
  2210     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2211     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2212     MOVE X'2020233030303032303334' TO DFHEIV0(25:11)
  2213     CALL 'kxdfhei1' USING DFHEIV0,
  2214           WS-MAP-NAME,
  2215           EL104ZO,
  2216           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL1041.cbl
  2217           MAPSET-NAME,
  2218           DFHEIV99,
  2219           DFHEIV99,
  2220           DFHEIV99,
  2221           DFHEIV11,
  2222           DFHEIV99,
  2223           DFHEIV99,
  2224           DFHEIV99
  2225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2226
  2227     MOVE '104Z'                 TO PI-CURRENT-SCREEN-NO
  2228     GO TO 9100-RETURN-TRAN
  2229     .
  2230 8200-SEND-DATAONLY.
  2231     DISPLAY ' MADE IT TO 8200 '
  2232     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2233     MOVE EIBTIME                    TO  TIME-IN.
  2234     MOVE SAVE-DATE                  TO  DATEO.
  2235     MOVE TIME-OUT                   TO  TIMEO.
  2236     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2237     MOVE PI-PROCESSOR-ID        TO USERIDO
  2238
  2239* EXEC CICS SEND
  2240*        MAP      (WS-MAP-NAME)
  2241*        MAPSET   (MAPSET-NAME)
  2242*        FROM     (EL104ZO)
  2243*        DATAONLY
  2244*        CURSOR
  2245*    END-EXEC.
  2246     MOVE LENGTH OF
  2247      EL104ZO
  2248       TO DFHEIV12
  2249     MOVE -1
  2250       TO DFHEIV11
  2251*    MOVE '8$D    CT       H L F ,   #00002052' TO DFHEIV0
  2252     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2253     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2254     MOVE X'2020233030303032303532' TO DFHEIV0(25:11)
  2255     CALL 'kxdfhei1' USING DFHEIV0,
  2256           WS-MAP-NAME,
  2257           EL104ZO,
  2258           DFHEIV12,
  2259           MAPSET-NAME,
  2260           DFHEIV99,
  2261           DFHEIV99,
  2262           DFHEIV99,
  2263           DFHEIV11,
  2264           DFHEIV99,
  2265           DFHEIV99,
  2266           DFHEIV99
  2267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2268
  2269     GO TO 9100-RETURN-TRAN
  2270     .
  2271 8300-SEND-TEXT.
  2272
  2273* EXEC CICS SEND TEXT
  2274*        FROM  (LOGOFF-TEXT)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL1041.cbl
  2275*        LENGTH(LOGOFF-LENGTH)
  2276*        ERASE
  2277*        FREEKB
  2278*    END-EXEC.
  2279*    MOVE '8&      T  E F  H   F -   #00002062' TO DFHEIV0
  2280     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2281     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2282     MOVE X'2020233030303032303632' TO DFHEIV0(25:11)
  2283     CALL 'kxdfhei1' USING DFHEIV0,
  2284           LOGOFF-TEXT,
  2285           LOGOFF-LENGTH,
  2286           DFHEIV99,
  2287           DFHEIV99,
  2288           DFHEIV99,
  2289           DFHEIV99,
  2290           DFHEIV99,
  2291           DFHEIV99,
  2292           DFHEIV99,
  2293           DFHEIV99,
  2294           DFHEIV99,
  2295           DFHEIV99
  2296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2297
  2298
  2299* EXEC CICS RETURN
  2300*        END-EXEC.
  2301*    MOVE '.(                    &   #00002068' TO DFHEIV0
  2302     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2303     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2304     MOVE X'2020233030303032303638' TO DFHEIV0(25:11)
  2305     CALL 'kxdfhei1' USING DFHEIV0,
  2306           DFHEIV99,
  2307           DFHEIV99,
  2308           DFHEIV99,
  2309           DFHEIV99,
  2310           DFHEIV99
  2311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2312
  2313     .
  2314 8500-DEEDIT.
  2315     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2316                                 TO WS-9V999-OF-DEEDIT
  2317     .
  2318 8500-EXIT.
  2319     EXIT.
  2320 8600-DEEDIT.
  2321     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2322                                 TO WS-NUMVAL-OF-DEEDIT
  2323     .
  2324 8600-EXIT.
  2325     EXIT.
  2326 8800-UNAUTHORIZED-ACCESS.
  2327     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  2328     GO TO 8300-SEND-TEXT.
  2329 8810-PF23.
  2330     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  2331     MOVE XCTL-005                   TO  PGM-NAME.
  2332     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL1041.cbl
  2333 8850-DUPREC.
  2334     MOVE ER-0132                    TO  EMI-ERROR.
  2335     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2336     MOVE -1                         TO  MAINTL
  2337     MOVE AL-UABON                   TO  ZLETRA
  2338     GO TO 8100-SEND-INITIAL-MAP.
  2339 8870-NOTOPEN.
  2340     MOVE LOW-VALUES                 TO  EL104ZO.
  2341     MOVE -1                         TO  MAINTL.
  2342     MOVE ER-0701                    TO  EMI-ERROR.
  2343     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2344     GO TO 8100-SEND-INITIAL-MAP.
  2345 8880-NOT-FOUND.
  2346     MOVE ER-0702                    TO  EMI-ERROR.
  2347     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2348     MOVE -1                         TO  MAINTL
  2349     MOVE AL-UABON                   TO  ZLETRA
  2350     GO TO 8100-SEND-INITIAL-MAP.
  2351     .
  2352 9100-RETURN-TRAN.
  2353     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  2354
  2355* EXEC CICS RETURN
  2356*        TRANSID    (TRANS-ID)
  2357*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2358*        LENGTH     (PI-COMM-LENGTH)
  2359*    END-EXEC.
  2360*    MOVE '.(CT                  &   #00002111' TO DFHEIV0
  2361     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2362     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2363     MOVE X'2020233030303032313131' TO DFHEIV0(25:11)
  2364     CALL 'kxdfhei1' USING DFHEIV0,
  2365           TRANS-ID,
  2366           PROGRAM-INTERFACE-BLOCK,
  2367           PI-COMM-LENGTH,
  2368           DFHEIV99,
  2369           DFHEIV99
  2370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2371
  2372 9200-RETURN-MAIN-MENU.
  2373     MOVE XCTL-626                   TO  PGM-NAME.
  2374     GO TO 9300-XCTL.
  2375 9300-XCTL.
  2376
  2377* EXEC CICS XCTL
  2378*        PROGRAM    (PGM-NAME)
  2379*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2380*        LENGTH     (PI-COMM-LENGTH)
  2381*    END-EXEC.
  2382*    MOVE '.$C                   $   #00002120' TO DFHEIV0
  2383     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2384     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2385     MOVE X'2020233030303032313230' TO DFHEIV0(25:11)
  2386     CALL 'kxdfhei1' USING DFHEIV0,
  2387           PGM-NAME,
  2388           PROGRAM-INTERFACE-BLOCK,
  2389           PI-COMM-LENGTH
  2390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL1041.cbl
  2391
  2392 9400-CLEAR.
  2393     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  2394     GO TO 9300-XCTL.
  2395 9500-PF12.
  2396     MOVE XCTL-010                   TO  PGM-NAME.
  2397     GO TO 9300-XCTL.
  2398 9600-PGMID-ERROR.
  2399
  2400* EXEC CICS HANDLE CONDITION
  2401*        PGMIDERR   (8300-SEND-TEXT)
  2402*    END-EXEC.
  2403*    MOVE '"$L                   ! # #00002132' TO DFHEIV0
  2404     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2406     MOVE X'2320233030303032313332' TO DFHEIV0(25:11)
  2407     CALL 'kxdfhei1' USING DFHEIV0
  2408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2409
  2410     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  2411     MOVE ' '                        TO  PI-ENTRY-CD-1.
  2412     MOVE XCTL-005                   TO  PGM-NAME.
  2413     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  2414     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  2415     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL1041.cbl
  2417 9700-LINK-DATE-CONVERT.
  2418
  2419* EXEC CICS LINK
  2420*        PROGRAM    ('ELDATCV')
  2421*        COMMAREA   (DATE-CONVERSION-DATA)
  2422*        LENGTH     (DC-COMM-LENGTH)
  2423*    END-EXEC.
  2424     MOVE 'ELDATCV' TO DFHEIV1
  2425*    MOVE '."C                   ''   #00002143' TO DFHEIV0
  2426     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2427     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2428     MOVE X'2020233030303032313433' TO DFHEIV0(25:11)
  2429     CALL 'kxdfhei1' USING DFHEIV0,
  2430           DFHEIV1,
  2431           DATE-CONVERSION-DATA,
  2432           DC-COMM-LENGTH,
  2433           DFHEIV99,
  2434           DFHEIV99,
  2435           DFHEIV99
  2436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2437
  2438 9700-EXIT.
  2439     EXIT.
  2440 9900-ERROR-FORMAT.
  2441     IF NOT EMI-ERRORS-COMPLETE
  2442         MOVE LINK-001               TO  PGM-NAME
  2443
  2444* EXEC CICS LINK
  2445*            PROGRAM    (PGM-NAME)
  2446*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2447*            LENGTH     (EMI-COMM-LENGTH)
  2448*        END-EXEC.
  2449*    MOVE '."C                   ''   #00002153' TO DFHEIV0
  2450     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2451     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2452     MOVE X'2020233030303032313533' TO DFHEIV0(25:11)
  2453     CALL 'kxdfhei1' USING DFHEIV0,
  2454           PGM-NAME,
  2455           ERROR-MESSAGE-INTERFACE-BLOCK,
  2456           EMI-COMM-LENGTH,
  2457           DFHEIV99,
  2458           DFHEIV99,
  2459           DFHEIV99
  2460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2461
  2462 9900-EXIT.
  2463     EXIT.
  2464 9990-ABEND.
  2465     MOVE LINK-004                   TO  PGM-NAME.
  2466     MOVE DFHEIBLK                   TO  EMI-LINE1.
  2467
  2468* EXEC CICS LINK
  2469*        PROGRAM   (PGM-NAME)
  2470*        COMMAREA  (EMI-LINE1)
  2471*        LENGTH    (72)
  2472*    END-EXEC.
  2473     MOVE 72
  2474       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL1041.cbl
  2475*    MOVE '."C                   ''   #00002163' TO DFHEIV0
  2476     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2477     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2478     MOVE X'2020233030303032313633' TO DFHEIV0(25:11)
  2479     CALL 'kxdfhei1' USING DFHEIV0,
  2480           PGM-NAME,
  2481           EMI-LINE1,
  2482           DFHEIV11,
  2483           DFHEIV99,
  2484           DFHEIV99,
  2485           DFHEIV99
  2486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2487
  2488     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL1041.cbl
  2490 9995-SECURITY-VIOLATION.
  2491*                            COPY ELCSCTP.
  2492******************************************************************
  2493*                                                                *
  2494*                            ELCSCTP                             *
  2495*                            VMOD=2.001                          *
  2496*                                                                *
  2497*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2498******************************************************************
  2499
  2500
  2501     MOVE EIBDATE          TO SM-JUL-DATE.
  2502     MOVE EIBTRMID         TO SM-TERMID.
  2503     MOVE THIS-PGM         TO SM-PGM.
  2504     MOVE EIBTIME          TO TIME-IN.
  2505     MOVE TIME-OUT         TO SM-TIME.
  2506     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2507
  2508
  2509* EXEC CICS LINK
  2510*         PROGRAM  ('EL003')
  2511*         COMMAREA (SECURITY-MESSAGE)
  2512*         LENGTH   (80)
  2513*    END-EXEC.
  2514     MOVE 'EL003' TO DFHEIV1
  2515     MOVE 80
  2516       TO DFHEIV11
  2517*    MOVE '."C                   ''   #00002188' TO DFHEIV0
  2518     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2519     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2520     MOVE X'2020233030303032313838' TO DFHEIV0(25:11)
  2521     CALL 'kxdfhei1' USING DFHEIV0,
  2522           DFHEIV1,
  2523           SECURITY-MESSAGE,
  2524           DFHEIV11,
  2525           DFHEIV99,
  2526           DFHEIV99,
  2527           DFHEIV99
  2528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2529
  2530
  2531******************************************************************
  2532
  2533 9995-EXIT.
  2534     EXIT.
  2535
  2536 9999-DFHBACK SECTION.
  2537     MOVE '9%                    "   ' TO DFHEIV0
  2538     MOVE 'EL1041' TO DFHEIV1
  2539     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2540     GOBACK.
  2541 9999-DFHEXIT.
  2542     IF DFHEIGDJ EQUAL 0001
  2543         NEXT SENTENCE
  2544     ELSE IF DFHEIGDJ EQUAL 2
  2545         GO TO 8850-DUPREC,
  2546               8870-NOTOPEN,
  2547               8880-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL1041.cbl
  2548               9600-PGMID-ERROR,
  2549               9990-ABEND
  2550         DEPENDING ON DFHEIGDI
  2551     ELSE IF DFHEIGDJ EQUAL 3
  2552         GO TO 8300-SEND-TEXT
  2553         DEPENDING ON DFHEIGDI.
  2554     MOVE '9%                    "   ' TO DFHEIV0
  2555     MOVE 'EL1041' TO DFHEIV1
  2556     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2557     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4544     Code:        6390
