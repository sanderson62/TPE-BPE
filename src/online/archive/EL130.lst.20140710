* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41******************************************************************
    42
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page   3
* EL130.cbl
    44 ENVIRONMENT DIVISION.
    45 DATA DIVISION.
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    50 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    51 77  A1                          PIC S999 COMP-3 VALUE +0.
    52 77  E1                          PIC S999 COMP-3 VALUE +0.
    53 77  s1                          pic s999 comp-3 value +0.
    54 77  s2                          pic s999 comp-3 value +0.
    55 77  P1                          PIC S999 COMP-3 VALUE +0.
    56 77  P2                          PIC S999 COMP-3 VALUE +0.
    57 77  WS-CRIT-PER-RECURRENT       PIC 99    VALUE zeros.
    58 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    59 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    60 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    61 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    62 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    63 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    64 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    65     88  ERPDEF-FOUND                 VALUE 'Y'.
    66 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    67 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    68 77  ws-dcc-product-code         pic xxx value spaces.
    69 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    70 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    71 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    72 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    73 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    74 77  ws-zero-bens-avail          pic x value ' '.
    75*    COPY ELCSCTM.
    76******************************************************************
    77*                                                                *
    78*                                                                *
    79*                            ELCSCTM                             *
    80*                            VMOD=2.001                          *
    81*                                                                *
    82*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    83*                                                                *
    84******************************************************************
    85 01  SECURITY-MESSAGE.
    86     12  FILLER                          PIC X(30)
    87            VALUE '** LOGIC SECURITY VIOLATION -'.
    88     12  SM-READ                         PIC X(6).
    89     12  FILLER                          PIC X(5)
    90            VALUE ' PGM='.
    91     12  SM-PGM                          PIC X(6).
    92     12  FILLER                          PIC X(5)
    93            VALUE ' OPR='.
    94     12  SM-PROCESSOR-ID                 PIC X(4).
    95     12  FILLER                          PIC X(6)
    96            VALUE ' TERM='.
    97     12  SM-TERMID                       PIC X(4).
    98     12  FILLER                          PIC XX   VALUE SPACE.
    99     12  SM-JUL-DATE                     PIC 9(5).
   100     12  FILLER                          PIC X    VALUE SPACE.
   101     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page   4
* EL130.cbl
   102
   103
   104*    COPY ELCSCRTY.
   105******************************************************************
   106*                                                                *
   107*                                                                *
   108*                            ELCSCRTY                            *
   109*                            VMOD=2.001                          *
   110*                                                                *
   111*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   112*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   113*        SAVED IN PI-SECURITY-ADDRESS.                           *
   114*                                                                *
   115******************************************************************
   116 01  SECURITY-CONTROL.
   117     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   118     12  FILLER                       PIC XX    VALUE 'SC'.
   119     12  SC-CREDIT-CODES.
   120         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   121             20  SC-CREDIT-DISPLAY    PIC X.
   122             20  SC-CREDIT-UPDATE     PIC X.
   123     12  SC-CLAIMS-CODES.
   124         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   125             20  SC-CLAIMS-DISPLAY    PIC X.
   126             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page   5
* EL130.cbl
   128 01  WS-DATE-AREA.
   129     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   130     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   131     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   132
   133 01  ws-dcc-error-line.
   134     05  filler occurs 15.
   135         10  ws-error-no        pic x(4).
   136 01  WS-CRI-SSN-WORK-AREA.
   137     05  WS-CRI-SOC-SEC-NO.
   138         10  WS-SS-REPT-CD       PIC X(5).
   139         10  WS-SS-LAST-NAME     PIC X(5).
   140         10  WS-SS-INITIAL       PIC X.
   141
   142     05  WS-CRI-REPORT-CODE.
   143         10  FILLER              PIC X(5).
   144         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   145
   146     05  WS-CRI-LAST-NAME.
   147         10  WS-CRI-NAME-MOVE    PIC X(5).
   148         10  FILLER              PIC X(10).
   149
   150 01  STANDARD-AREAS.
   151     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   152     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   153     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   154     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   155     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   156     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   157     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   158     12  PGM-NAME            PIC X(8).
   159     12  TIME-IN             PIC S9(7).
   160     12  TIME-OUT-R  REDEFINES TIME-IN.
   161         16  FILLER          PIC X.
   162         16  TIME-OUT        PIC 99V99.
   163         16  FILLER          PIC X(2).
   164     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   165     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   166     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   167     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   168     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   169     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   170     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   171     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   172     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   173     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   174     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   175     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   176     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   177     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   178     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   179     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   180     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   181     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   182     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   183     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   184     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   185     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page   6
* EL130.cbl
   186     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   187     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   188     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   189     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   190     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   191     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   192     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   193     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   194     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   195     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   196     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   197     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   198     12  FILE-ID             PIC X(8).
   199     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   200     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   201     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   202     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   203     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   204     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   205     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   206     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   207     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   208
   209 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   210     12  M                   PIC S9(7)V99           VALUE ZEROS.
   211     12  L                   PIC S9(7)V99           VALUE ZEROS.
   212     12  N                   PIC S9(3)              VALUE ZEROS.
   213     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   214     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   215     12  I                   PIC S99V9(5)           VALUE ZEROS.
   216     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   217     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   218     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   219     12  R                   PIC S9(3)              VALUE ZEROS.
   220     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   221     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   222     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   223     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   224     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   225     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   226     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   227     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   228     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   229
   230 01  TERM-CALC-WORK-AREA.
   231     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   232     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   233     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   234     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   235     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   236     12  V-EXPONENTS.
   237        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   238     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   239
   240 01  MISC-WORK-AREAS.
   241     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   242     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   243     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page   7
* EL130.cbl
   244     12  QID.
   245         16  QID-TERM        PIC X(4).
   246         16  FILLER          PIC X(4)    VALUE '130A'.
   247     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   248     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   249     12  WS-GROUP-NO.
   250         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   251         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   252
   253     12  WS-RESPONSE         PIC S9(8)   COMP.
   254         88  WS-RESP-NORMAL              VALUE +00.
   255         88  WS-RESP-ERROR               VALUE +01.
   256         88  WS-RESP-NOTFND              VALUE +13.
   257         88  WS-RESP-DUPKEY              VALUE +15.
   258         88  WS-RESP-NOTOPEN             VALUE +19.
   259         88  WS-RESP-ENDFILE             VALUE +20.
   260
   261***************************************************************
   262*                                                             *
   263*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   264*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   265*    CHANGES WITH IN MAP EL130A.                              *
   266*                                                             *
   267***************************************************************
   268
   269     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   270     12  WS-SAVE-CLAIM-MASTER.
   271         16  FILLER                    PIC XX.
   272         16  WS-SAVE-CLAIM-KEY.
   273             20  WS-SAVE-COMPANY-CD    PIC X.
   274             20  WS-SAVE-CARRIER       PIC X.
   275             20  WS-SAVE-CLAIM-NO      PIC X(7).
   276             20  WS-SAVE-CERT-NO       PIC X(11).
   277         16  FILLER                    PIC X(328).
   278     12  SAVE-CURRENT-DATE         PIC XX.
   279     12  SAVE-CONTROL              PIC X(39).
   280     12  SAVE-ERACCT-KEY           PIC X(26).
   281     12  SAVE-COUNTER              PIC S9(8)   COMP.
   282     12  SAVE-METHOD               PIC X.
   283     12  SAVE-COMPANY-ID           PIC XXX.
   284     12  SAVE-COMPANY-CD           PIC X.
   285     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   286     12  SAVE-CREDIT-USER          PIC X.
   287     12  SAVE-CLAIM-USER           PIC X.
   288     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   289     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   290     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   291     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   292     12  SAVE-AH-OVERRIDE-L1       PIC X.
   293     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   294     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   295     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   296     12  FILLER                    PIC X.
   297*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   298     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   299     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   300     12  SAVE-EL127-TO-EL130-CNTRL.
   301         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page   8
* EL130.cbl
   302         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   303         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   304             20  SAVE-EL127-CARRIER  PIC X.
   305             20  SAVE-EL127-GROUPING PIC X(6).
   306             20  SAVE-EL127-STATE    PIC X(2).
   307             20  SAVE-EL127-ACCOUNT  PIC X(10).
   308             20  SAVE-EL127-CERT-NO  PIC X(11).
   309             20  SAVE-EL127-EFF-DT   PIC XX.
   310     12  SAVE-EL659-TO-EL130-CNTRL.
   311         16  SAVE-EL659-CARRIER    PIC X.
   312         16  SAVE-EL659-GROUPING   PIC X(6).
   313         16  SAVE-EL659-STATE      PIC XX.
   314         16  SAVE-EL659-ACCOUNT    PIC X(10).
   315     12  DIVIDE-QUOT               PIC 999.
   316     12  DIVIDE-REM                PIC 999.
   317     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   318     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   319     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   320     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   321     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   322     12  WS-RESERVE-CONTROLS       PIC X(9).
   323     12  WS-EXPENSE-CONTROLS       PIC X(7).
   324     12  WS-REIN-TABLE.
   325         16  WS-REIN-1             PIC X            VALUE SPACE.
   326         16  WS-REIN-2             PIC X            VALUE SPACE.
   327         16  WS-REIN-3             PIC X            VALUE SPACE.
   328     12  WS-BENE-CALC-METHOD       PIC X.
   329     12  ws-lf-joint-indicator     pic x.
   330     12  ws-ah-joint-indicator     pic x.
   331     12  WS-EARNINGS-CALC          PIC X.
   332     12  WS-LF-EARNINGS-CALC       PIC X.
   333         88 TEX-REG                VALUE '4'.
   334         88 NET-PAY                VALUE '5'.
   335     12  WS-AH-EARNINGS-CALC       PIC X.
   336     12  WS-SPECIAL-CALC-CD        PIC X(01).
   337     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   338     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   339     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   340     12  WS-ICD-CODE-1             PIC X(8).
   341     12  WS-ICD-CODE-2             PIC X(8).
   342     12  WS-CLAIM-NUMBER.
   343         16  WS-CN-PREFIX.
   344             20  WS-CN-PRF-A PIC X.
   345             20  WS-CN-PRF-B PIC X.
   346         16  WS-CN-NUMBER    PIC 9(5).
   347     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   348     12  WS-CLAIM-SEQU.
   349         16  FILLER          PIC X    VALUE '('.
   350         16  WS-CURRENT-SEQU PIC Z9.
   351         16  FILLER          PIC X(4) VALUE ' OF '.
   352         16  WS-OF-SEQU      PIC Z9.
   353         16  FILLER          PIC X    VALUE ')'.
   354     12  DATE-WORK.
   355       14  FILLER                PIC XX.
   356       14  DATE-MM               PIC XX.
   357       14  DATE-DD               PIC XX.
   358       14  DATE-YY               PIC XX.
   359     12  CURR-DATE REDEFINES DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page   9
* EL130.cbl
   360         16  CURR-MM.
   361           18  CURR-M1           PIC 9.
   362           18  CURR-M2           PIC 9.
   363         16  FILLER              PIC X(5).
   364         16  CURR-YEAR           PIC 9.
   365     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   366     12  SUB                     PIC 99.
   367     12  MY-DATE.
   368         16  MY-MM               PIC XX.
   369         16  FILLER              PIC X VALUE '/'.
   370         16  MY-YY               PIC XX.
   371
   372     12  WS-EDIT-BEN-CODE        PIC XX.
   373         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   374                                          '90' THRU '99'.
   375
   376     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   377     12  WS-BEN-HOLD             PIC XX.
   378     12  WS-BEN-ALPHA-HOLD.
   379         15  WS-BEN-ALPHA-2      PIC XX.
   380         15  WS-BEN-ALPHA-1      PIC X.
   381     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   382     12  WS-REC-TYPE             PIC X.
   383     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   384     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   385     12  ARCH-NUMBER             PIC S9(8)   COMP.
   386     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   387         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   388         88  REIN-REC-FOUND                  VALUE 'Y'.
   389
   390     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   391     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   392
   393
   394 01  CSO-WORK-FIELDS.
   395     12  WS-BLANK            PIC X       VALUE ' '.
   396
   397     12  WS-MA-CONTROL-PRIMARY.
   398         16  WS-MA-COMPANY-CD        PIC  X.
   399         16  WS-MA-CARRIER           PIC  X.
   400         16  WS-MA-GROUPING          PIC  X(6).
   401         16  WS-MA-STATE             PIC  XX.
   402         16  WS-MA-ACCOUNT           PIC  X(10).
   403         16  WS-MA-CERT-EFF-DT       PIC  XX.
   404         16  WS-MA-CERT-NO.
   405             20  WS-MA-CERT-PRIME    PIC  X(10).
   406             20  WS-MA-CERT-SFX      PIC  X.
   407
   408     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   409     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   410     12  WS-SOC-SEC-NUMBER.
   411         16  WS-SOC-SEC-NO       PIC 9(9).
   412         16  WS-SOC-SEC-BLANK    PIC X(2).
   413     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   414         16  WS-SSN-1-3          PIC 9(3).
   415         16  WS-SSN-DASH1        PIC X(1).
   416         16  WS-SSN-4-5          PIC 9(2).
   417         16  WS-SSN-DASH2        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  10
* EL130.cbl
   418         16  WS-SSN-6-9          PIC 9(4).
   419
   420     12  WS-DIAG-VIN-MSG.
   421         16  FILLER          PIC X(11)
   422             VALUE 'VIN NUMBER '.
   423         16  WS-DIAG-VIN     PIC X(17).
   424
   425     12  WS-VERIFY-NOTE      PIC X(34)
   426         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   427
   428     12  WS-CAUSAL-NOTE      PIC X(40)
   429         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   430
   431     12  WS-VFY-SSN-NOTE     PIC X(25)
   432         VALUE 'SSN VERIFICATION REQUIRED'.
   433
   434 01  MAP-DATE-AREAS.
   435     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   436     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   437     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   438     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   439     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   440     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   441     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   442     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   443     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   444     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   445     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   446     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   447     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   448     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   449     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   450     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   451     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   452     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   453     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   454         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   455     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   456     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   457     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   458     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   459
   460 01  ACCESS-KEYS.
   461     12  ELACTQ-KEY.
   462         16  ELACTQ-COMPANY-CD       PIC X.
   463         16  ELACTQ-CARRIER          PIC X.
   464         16  ELACTQ-CLAIM-NO         PIC X(7).
   465         16  ELACTQ-CERT-NO          PIC X(11).
   466     12  ELMSTR-KEY.
   467         16  MSTR-COMP-CD            PIC X.
   468         16  MSTR-CARRIER            PIC X.
   469         16  MSTR-CLAIM-NO           PIC X(7).
   470         16  MSTR-CERT-NO.
   471             20  MSTR-CERT-NO-PRIME  PIC X(10).
   472             20  MSTR-CERT-NO-SUFX   PIC X.
   473     12  SAVE-ELMSTR-KEY.
   474         16  SAVE-COMP-CD            PIC X.
   475         16  SAVE-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  11
* EL130.cbl
   476         16  SAVE-CLAIM-NO           PIC X(7).
   477         16  SAVE-CERT-NO.
   478             20  SAVE-CERT-NO-PRIME  PIC X(10).
   479             20  SAVE-CERT-NO-SUFX   PIC X.
   480     12  ELMSTR5-KEY.
   481         16  MSTR5-COMP-CD           PIC X.
   482         16  MSTR5-CERT-NO.
   483             20  MSTR5-CERT-NO-PRIME PIC X(10).
   484             20  MSTR5-CERT-NO-SUFX  PIC X.
   485     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   486         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   487         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   488         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   489     12  ELCNTL-KEY.
   490         16  CNTL-COMP-ID    PIC X(3).
   491         16  CNTL-REC-TYPE   PIC X.
   492         16  CNTL-ACCESS.
   493             20  FILLER      PIC XX.
   494             20  CNTL-BENEFIT.
   495                 24  FILLER  PIC X.
   496                 24  CNTL-CARRIER PIC X.
   497         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   498     12  ELCERT-KEY.
   499         16  CERT-COMP-CD    PIC X.
   500         16  CERT-CARRIER    PIC X.
   501         16  CERT-GROUPING   PIC X(6).
   502         16  CERT-STATE      PIC X(2).
   503         16  CERT-ACCOUNT.
   504             20  CERT-ACCOUNT-PREFIX PIC X(4).
   505             20  CERT-ACCOUNT-PRIME  PIC X(6).
   506         16  CERT-EFF-DT     PIC XX.
   507         16  CERT-CERT-NO.
   508             20  CERT-CERT-NO-PRIME  PIC X(10).
   509             20  CERT-CERT-NO-SUFX   PIC X.
   510     12  ELCERT-KEY-5.
   511         16  CERT-COMP-CD-5      PIC X.
   512         16  CERT-CERT-5.
   513             20  CERT-CERT-5-PRIME   PIC X(10).
   514             20  CERT-CERT-5-SUFX    PIC X.
   515     12  ERACCT-KEY.
   516         16  ACCT-COMP-CD    PIC X.
   517         16  ACCT-CARRIER    PIC X.
   518         16  ACCT-GROUPING   PIC X(6).
   519         16  ACCT-STATE      PIC X(2).
   520         16  ACCT-ACCOUNT    PIC X(10).
   521         16  ACCT-EXP-DT     PIC XX.
   522     12  ELTRLR-KEY.
   523         16  TRLR-COMP-CD    PIC X.
   524         16  TRLR-CARRIER    PIC X.
   525         16  TRLR-CLAIM-NO   PIC X(7).
   526         16  TRLR-CERT-NO.
   527             20  TRLR-CERT-NO-PRIME  PIC X(10).
   528             20  TRLR-CERT-NO-SUFX   PIC X.
   529         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   530         16  TRLR-TYPE       PIC X.
   531     12  ELBENE-KEY.
   532         16  BENE-COMP-CD    PIC X.
   533         16  BENE-RCD-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  12
* EL130.cbl
   534         16  BENE-CODE       PIC X(10).
   535     12  ERREIN-KEY.
   536         16  REIN-COMP-CD        PIC X(01).
   537         16  REIN-TYPE           PIC X(01).
   538         16  REIN-TABLE-CO.
   539             20  REIN-CODE-1     PIC X(01).
   540             20  REIN-CODE-2     PIC X(01).
   541             20  REIN-CODE-3     PIC X(01).
   542         16  FILLER              PIC X(03).
   543     12  ELCRTT-KEY.
   544         16  CTRLR-COMP-CD       PIC X.
   545         16  CTRLR-CARRIER       PIC X.
   546         16  CTRLR-GROUPING      PIC X(6).
   547         16  CTRLR-STATE         PIC X(2).
   548         16  CTRLR-ACCOUNT       PIC X(10).
   549         16  CTRLR-EFF-DT        PIC XX.
   550         16  CTRLR-CERT-NO       PIC X(11).
   551         16  CTRLR-REC-TYPE      PIC X.
   552 01  ws-acct-found-sw            pic x value ' '.
   553     88  acct-found                value 'Y'.
   554 01  ERPDEF-KEY-SAVE             PIC X(18).
   555 01  ERPDEF-KEY.
   556     12  ERPDEF-COMPANY-CD       PIC X.
   557     12  ERPDEF-STATE            PIC XX.
   558     12  ERPDEF-PROD-CD          PIC XXX.
   559     12  F                       PIC X(7).
   560     12  ERPDEF-BEN-TYPE         PIC X.
   561     12  ERPDEF-BEN-CODE         PIC XX.
   562     12  ERPDEF-EXP-DT           PIC XX.
   563 01  ERROR-MESSAGES.
   564     12  ER-0000                 PIC X(4)  VALUE '0000'.
   565     12  ER-0004                 PIC X(4)  VALUE '0004'.
   566     12  ER-0019                 PIC X(4)  VALUE '0019'.
   567     12  ER-0023                 PIC X(4)  VALUE '0023'.
   568     12  ER-0029                 PIC X(4)  VALUE '0029'.
   569     12  ER-0033                 PIC X(4)  VALUE '0033'.
   570     12  ER-0068                 PIC X(4)  VALUE '0068'.
   571     12  ER-0070                 PIC X(4)  VALUE '0070'.
   572     12  ER-0194                 PIC X(4)  VALUE '0194'.
   573     12  ER-0202                 PIC X(4)  VALUE '0202'.
   574     12  ER-0203                 PIC X(4)  VALUE '0203'.
   575     12  ER-0204                 PIC X(4)  VALUE '0204'.
   576     12  ER-0205                 PIC X(4)  VALUE '0205'.
   577     12  ER-0206                 PIC X(4)  VALUE '0206'.
   578     12  ER-0207                 PIC X(4)  VALUE '0207'.
   579     12  ER-0213                 PIC X(4)  VALUE '0213'.
   580     12  ER-0214                 PIC X(4)  VALUE '0214'.
   581     12  ER-0217                 PIC X(4)  VALUE '0217'.
   582     12  ER-0219                 PIC X(4)  VALUE '0219'.
   583     12  ER-0220                 PIC X(4)  VALUE '0220'.
   584     12  ER-0221                 PIC X(4)  VALUE '0221'.
   585     12  ER-0222                 PIC X(4)  VALUE '0222'.
   586     12  ER-0223                 PIC X(4)  VALUE '0223'.
   587     12  ER-0224                 PIC X(4)  VALUE '0224'.
   588     12  ER-0225                 PIC X(4)  VALUE '0225'.
   589     12  ER-0226                 PIC X(4)  VALUE '0226'.
   590     12  ER-0227                 PIC X(4)  VALUE '0227'.
   591     12  ER-0229                 PIC X(4)  VALUE '0229'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  13
* EL130.cbl
   592     12  ER-0230                 PIC X(4)  VALUE '0230'.
   593     12  ER-0231                 PIC X(4)  VALUE '0231'.
   594     12  ER-0232                 PIC X(4)  VALUE '0232'.
   595     12  ER-0233                 PIC X(4)  VALUE '0233'.
   596     12  ER-0234                 PIC X(4)  VALUE '0234'.
   597     12  ER-0235                 PIC X(4)  VALUE '0235'.
   598     12  ER-0236                 PIC X(4)  VALUE '0236'.
   599     12  ER-0237                 PIC X(4)  VALUE '0237'.
   600     12  ER-0238                 PIC X(4)  VALUE '0238'.
   601     12  ER-0239                 PIC X(4)  VALUE '0239'.
   602     12  ER-0240                 PIC X(4)  VALUE '0240'.
   603     12  ER-0241                 PIC X(4)  VALUE '0241'.
   604     12  ER-0243                 PIC X(4)  VALUE '0243'.
   605     12  ER-0244                 PIC X(4)  VALUE '0244'.
   606     12  ER-0245                 PIC X(4)  VALUE '0245'.
   607     12  ER-0246                 PIC X(4)  VALUE '0246'.
   608     12  ER-0247                 PIC X(4)  VALUE '0247'.
   609     12  ER-0248                 PIC X(4)  VALUE '0248'.
   610     12  ER-0250                 PIC X(4)  VALUE '0250'.
   611     12  ER-0251                 PIC X(4)  VALUE '0251'.
   612     12  ER-0252                 PIC X(4)  VALUE '0252'.
   613     12  ER-0253                 PIC X(4)  VALUE '0253'.
   614     12  ER-0254                 PIC X(4)  VALUE '0254'.
   615     12  ER-0257                 PIC X(4)  VALUE '0257'.
   616     12  ER-0258                 PIC X(4)  VALUE '0258'.
   617     12  ER-0260                 PIC X(4)  VALUE '0260'.
   618     12  ER-0261                 PIC X(4)  VALUE '0261'.
   619     12  ER-0263                 PIC X(4)  VALUE '0263'.
   620     12  ER-0264                 PIC X(4)  VALUE '0264'.
   621     12  ER-0265                 PIC X(4)  VALUE '0265'.
   622     12  ER-0266                 PIC X(4)  VALUE '0266'.
   623     12  ER-0267                 PIC X(4)  VALUE '0267'.
   624     12  ER-0334                 PIC X(4)  VALUE '0334'.
   625     12  ER-0337                 PIC X(4)  VALUE '0337'.
   626     12  ER-0412                 PIC X(4)  VALUE '0412'.
   627     12  ER-0413                 PIC X(4)  VALUE '0413'.
   628     12  ER-0428                 PIC X(4)  VALUE '0428'.
   629     12  ER-0429                 PIC X(4)  VALUE '0429'.
   630     12  ER-0430                 PIC X(4)  VALUE '0430'.
   631     12  ER-0433                 PIC X(4)  VALUE '0433'.
   632     12  ER-0434                 PIC X(4)  VALUE '0434'.
   633     12  ER-0458                 PIC X(4)  VALUE '0458'.
   634     12  ER-0489                 PIC X(4)  VALUE '0489'.
   635     12  ER-0509                 PIC X(4)  VALUE '0509'.
   636     12  ER-0510                 PIC X(4)  VALUE '0510'.
   637     12  ER-0511                 PIC X(4)  VALUE '0511'.
   638     12  ER-0512                 PIC X(4)  VALUE '0512'.
   639     12  ER-0516                 PIC X(4)  VALUE '0516'.
   640     12  ER-0517                 PIC X(4)  VALUE '0517'.
   641     12  ER-0518                 PIC X(4)  VALUE '0518'.
   642     12  ER-0519                 PIC X(4)  VALUE '0519'.
   643     12  ER-0520                 PIC X(4)  VALUE '0520'.
   644     12  ER-0521                 PIC X(4)  VALUE '0521'.
   645     12  ER-0522                 PIC X(4)  VALUE '0522'.
   646     12  ER-0523                 PIC X(4)  VALUE '0523'.
   647     12  ER-0544                 PIC X(4)  VALUE '0544'.
   648     12  ER-0546                 PIC X(4)  VALUE '0546'.
   649     12  ER-0558                 PIC X(4)  VALUE '0558'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  14
* EL130.cbl
   650     12  ER-0560                 PIC X(4)  VALUE '0560'.
   651     12  ER-0562                 PIC X(4)  VALUE '0562'.
   652     12  ER-0565                 PIC X(4)  VALUE '0565'.
   653     12  ER-0569                 PIC X(4)  VALUE '0569'.
   654     12  ER-0693                 PIC X(4)  VALUE '0693'.
   655     12  ER-0715                 PIC X(4)  VALUE '0715'.
   656     12  ER-0840                 PIC X(4)  VALUE '0840'.
   657     12  ER-0841                 PIC X(4)  VALUE '0841'.
   658     12  ER-0842                 PIC X(4)  VALUE '0842'.
   659     12  ER-0843                 PIC X(4)  VALUE '0843'.
   660     12  ER-0878                 PIC X(4)  VALUE '0878'.
   661     12  ER-0887                 PIC X(4)  VALUE '0887'.
   662     12  ER-0992                 PIC X(4)  VALUE '0992'.
   663     12  ER-1651                 PIC X(4)  VALUE '1651'.
   664     12  ER-1652                 PIC X(4)  VALUE '1652'.
   665     12  ER-1653                 PIC X(4)  VALUE '1653'.
   666     12  ER-1654                 PIC X(4)  VALUE '1654'.
   667     12  ER-1655                 PIC X(4)  VALUE '1655'.
   668     12  er-1659                 pic x(4)  value '1659'.
   669     12  er-1660                 pic x(4)  value '1660'.
   670     12  er-1661                 pic x(4)  value '1661'.
   671     12  er-1671                 pic x(4)  value '1671'.
   672     12  er-1672                 pic x(4)  value '1672'.
   673     12  er-1673                 pic x(4)  value '1673'.
   674     12  er-1675                 pic x(4)  value '1675'.
   675     12  er-1676                 pic x(4)  value '1676'.
   676     12  ER-2280                 PIC X(4)  VALUE '2280'.
   677     12  ER-2370                 PIC X(4)  VALUE '2370'.
   678     12  ER-2371                 PIC X(4)  VALUE '2371'.
   679     12  ER-2378                 PIC X(4)  VALUE '2378'.
   680     12  ER-2380                 PIC X(4)  VALUE '2380'.
   681     12  ER-2566                 PIC X(4)  VALUE '2566'.
   682     12  ER-2848                 PIC X(4)  VALUE '2848'.
   683     12  ER-3548                 PIC X(4)  VALUE '3548'.
   684     12  ER-7008                 PIC X(4)  VALUE '7008'.
   685     12  ER-7319                 PIC X(4)  VALUE '7319'.
   686     12  ER-7321                 PIC X(4)  VALUE '7321'.
   687     12  ER-7352                 PIC X(4)  VALUE '7352'.
   688     12  ER-7353                 PIC X(4)  VALUE '7353'.
   689     12  ER-7575                 PIC X(4)  VALUE '7575'.
   690     12  ER-7577                 PIC X(4)  VALUE '7577'.
   691     12  ER-7582                 PIC X(4)  VALUE '7582'.
   692     12  ER-7634                 PIC X(4)  VALUE '7634'.
   693     12  ER-7635                 PIC X(4)  VALUE '7635'.
   694     12  ER-7636                 PIC X(4)  VALUE '7636'.
   695     12  ER-7637                 PIC X(4)  VALUE '7637'.
   696     12  ER-7638                 PIC X(4)  VALUE '7638'.
   697     12  ER-7639                 PIC X(4)  VALUE '7639'.
   698     12  ER-7640                 PIC X(4)  VALUE '7640'.
   699     12  ER-7641                 PIC X(4)  VALUE '7641'.
   700     12  ER-7642                 PIC X(4)  VALUE '7642'.
   701     12  ER-7643                 PIC X(4)  VALUE '7643'.
   702     12  ER-7646                 PIC X(4)  VALUE '7646'.
   703     12  ER-7647                 PIC X(4)  VALUE '7647'.
   704     12  ER-7648                 PIC X(4)  VALUE '7648'.
   705     12  ER-7649                 PIC X(4)  VALUE '7649'.
   706     12  ER-7651                 PIC X(4)  VALUE '7651'.
   707     12  ER-7670                 PIC X(4)  VALUE '7670'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  15
* EL130.cbl
   708     12  ER-7671                 PIC X(4)  VALUE '7671'.
   709     12  ER-7686                 PIC X(4)  VALUE '7686'.
   710     12  ER-7688                 PIC X(4)  VALUE '7688'.
   711     12  ER-7689                 PIC X(4)  VALUE '7689'.
   712     12  ER-7691                 PIC X(4)  VALUE '7691'.
   713*    COPY ERCPDEF.
   714******************************************************************
   715*                                                                *
   716*                                                                *
   717*                            ERCPDEF.                            *
   718*                                                                *
   719*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   720*                                                                *
   721*    FILE TYPE = VSAM,KSDS                                       *
   722*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   723*                                                                *
   724*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   725*                                                                *
   726*    LOG = YES                                                   *
   727*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   728******************************************************************
   729*                   C H A N G E   L O G
   730*
   731* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   732*-----------------------------------------------------------------
   733*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   734* EFFECTIVE    NUMBER
   735*-----------------------------------------------------------------
   736* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   737******************************************************************
   738 01  PRODUCT-MASTER.
   739    12  PD-RECORD-ID                 PIC X(02).
   740        88  VALID-PD-ID                  VALUE 'PD'.
   741    12  PD-CONTROL-PRIMARY.
   742        16  PD-COMPANY-CD            PIC X.
   743        16  PD-STATE                 PIC XX.
   744        16  PD-PRODUCT-CD            PIC XXX.
   745        16  PD-FILLER                PIC X(7).
   746        16  PD-BEN-TYPE              PIC X.
   747        16  PD-BEN-CODE              PIC XX.
   748        16  PD-PROD-EXP-DT           PIC XX.
   749    12  FILLER                       PIC X(50).
   750    12  PD-PRODUCT-DATA OCCURS 8.
   751        16  PD-PROD-CODE             PIC X.
   752            88  PD-PROD-LIFE           VALUE 'L'.
   753            88  PD-PROD-PROP           VALUE 'P'.
   754            88  PD-PROD-AH             VALUE 'A'.
   755            88  PD-PROD-IU             VALUE 'I'.
   756            88  PD-PROD-GAP            VALUE 'G'.
   757            88  PD-PROD-FMLA           VALUE 'F'.
   758        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   759        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   760        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   761        16  PD-MAX-TERM              PIC S999        COMP-3.
   762        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   763        16  FILLER                   PIC X.
   764        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   765        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  16
* EL130.cbl
   766        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   767        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   768        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   769        16  PD-REC-CRIT-PERIOD       PIC 99.
   770        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   771            20  PD-RECURRING-YN      PIC X.
   772            20  FILLER               PIC X.
   773        16  PD-RTW-MOS               PIC 99.
   774        16  PD-MAX-EXTENSION         PIC 99.
   775        16  FILLER                   PIC XX.
   776    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   777    12  PD-TERM-LIMITS OCCURS 15.
   778        16  PD-LOW-TERM              PIC S999        COMP-3.
   779        16  PD-HI-TERM               PIC S999        COMP-3.
   780*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   781    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   782        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   783        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   784    12  PD-EARN-FACTORS.
   785        16  FILLER OCCURS 15.
   786            20  FILLER OCCURS 15.
   787                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   788    12  PD-PRODUCT-DESC              PIC X(80).
   789    12  PD-TRUNCATED                 PIC X.
   790    12  FILLER                       PIC X(59).
   791    12  PD-MAINT-INFORMATION.
   792        16  PD-LAST-MAINT-DT         PIC X(02).
   793        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   794        16  PD-LAST-MAINT-BY         PIC X(04).
   795*    COPY ELCLNKLT.
   796******************************************************************
   797*                                                                *
   798*                                                                *
   799*                           ELCLNKLT                             *
   800*                            VMOD=2.003                          *
   801*                                                                *
   802*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   803*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   804*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   805*                                                                *
   806*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   807*   COMPLETING THE REQUIRED FIELDS.                              *
   808*                                                                *
   809*   THE CALLING PROGRAM SHOULD CHECK:                            *
   810*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   811*                              9999 INDICATES AN UNKNOWN ABEND   *
   812*                                   WAS DETECTED.                *
   813*                              ALL OTHER VALUES ARE NORMAL ERROR *
   814*                              CODES FOUND IN THE ERROR FILE.    *
   815******************************************************************
   816 01  W-1523-LINKDATA.
   817     12  W-1523-COMMON-PI-DATA.
   818         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   819         16  FILLER              PIC  X(67).
   820         16  W-1523-COMPANY-CD   PIC  X(01).
   821         16  FILLER              PIC  X(10).
   822         16  W-1523-CONTROL-IN-PROGRESS.
   823             20  W-1523-CARRIER  PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  17
* EL130.cbl
   824             20  W-1523-GROUPING PIC  X(06).
   825             20  W-1523-STATE    PIC  X(02).
   826             20  W-1523-ACCOUNT  PIC  X(10).
   827             20  W-1523-CLAIM-CERT-GRP.
   828                 24  W-1523-CLAIM-NO
   829                                 PIC  X(07).
   830                 24  W-1523-CERT-NO.
   831                     28  W-1523-CERT-PRIME
   832                                 PIC  X(10).
   833                     28  W-1523-CERT-SFX
   834                                 PIC  X(01).
   835                 24  W-1523-CERT-EFF-DT
   836                                 PIC  X(02).
   837         16  FILLER              PIC X(265).
   838
   839     12  W-1523-WORK-AREA.
   840         16  W-1523-FORM-NUMBER  PIC  X(04).
   841         16  W-1523-NUMBER-COPIES
   842                                 PIC  9(01).
   843         16  W-1523-ADDR-TYPE    PIC  X(02).
   844         16  W-1523-FOLLOW-UP-DATE
   845                                 PIC  X(02).
   846         16  W-1523-RESEND-DATE  PIC  X(02).
   847         16  W-1523-ERROR-CODE   PIC  9(04).
   848             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   849             88  W-1523-FATAL-ERROR
   850                                    VALUES  0006 0013 0042
   851                                            0154 0168 0169
   852                                            0176 9999 0172
   853                                            0179 0186 0281
   854                                            0332 2055 3697
   855                                            3698 3699 3770
   856                                            3771 3772 7675
   857                                            9106 9808 9883
   858                                            9887.
   859             88  W-1523-STOP-ERRORS
   860                                    VALUES  0013 0042 0154
   861                                            0168 0169 0172
   862                                            0281 0332 2055
   863                                            3698 3699 7675
   864                                            9106 9808 9883
   865                                            9999.
   866         16  W-1523-REASON       PIC  X(70).
   867         16  W-1523-ARCHIVE-NUMBER
   868                                 PIC  9(08).
   869     12  W-1523-POINTER-AREA.
   870         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   871         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   872         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   873         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   874         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  18
* EL130.cbl
   876*    COPY ELCINTF.
   877******************************************************************
   878*                                                                *
   879*                                                                *
   880*                            ELCINTF.                            *
   881*                            VMOD=2.017                          *
   882*                                                                *
   883*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   884*                                                                *
   885*       LENGTH = 1024                                            *
   886*                                                                *
   887******************************************************************
   888*                   C H A N G E   L O G
   889*
   890* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   891*-----------------------------------------------------------------
   892*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   893* EFFECTIVE    NUMBER
   894*-----------------------------------------------------------------
   895* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   896******************************************************************
   897 01  PROGRAM-INTERFACE-BLOCK.
   898     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   899     12  PI-CALLING-PROGRAM              PIC X(8).
   900     12  PI-SAVED-PROGRAM-1              PIC X(8).
   901     12  PI-SAVED-PROGRAM-2              PIC X(8).
   902     12  PI-SAVED-PROGRAM-3              PIC X(8).
   903     12  PI-SAVED-PROGRAM-4              PIC X(8).
   904     12  PI-SAVED-PROGRAM-5              PIC X(8).
   905     12  PI-SAVED-PROGRAM-6              PIC X(8).
   906     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   907     12  PI-COMPANY-ID                   PIC XXX.
   908     12  PI-COMPANY-CD                   PIC X.
   909
   910     12  PI-COMPANY-PASSWORD             PIC X(8).
   911
   912     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   913
   914     12  PI-CONTROL-IN-PROGRESS.
   915         16  PI-CARRIER                  PIC X.
   916         16  PI-GROUPING                 PIC X(6).
   917         16  PI-STATE                    PIC XX.
   918         16  PI-ACCOUNT                  PIC X(10).
   919         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   920                                         PIC X(10).
   921         16  PI-CLAIM-CERT-GRP.
   922             20  PI-CLAIM-NO             PIC X(7).
   923             20  PI-CERT-NO.
   924                 25  PI-CERT-PRIME       PIC X(10).
   925                 25  PI-CERT-SFX         PIC X.
   926             20  PI-CERT-EFF-DT          PIC XX.
   927         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   928             20  PI-PLAN-CODE            PIC X(2).
   929             20  PI-REVISION-NUMBER      PIC X(3).
   930             20  PI-PLAN-EFF-DT          PIC X(2).
   931             20  PI-PLAN-EXP-DT          PIC X(2).
   932             20  FILLER                  PIC X(11).
   933         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  19
* EL130.cbl
   934             20  PI-OE-REFERENCE-1.
   935                 25  PI-OE-REF-1-PRIME   PIC X(18).
   936                 25  PI-OE-REF-1-SUFF    PIC XX.
   937
   938     12  PI-SESSION-IN-PROGRESS          PIC X.
   939         88  CLAIM-SESSION                   VALUE '1'.
   940         88  CREDIT-SESSION                  VALUE '2'.
   941         88  WARRANTY-SESSION                VALUE '3'.
   942         88  MORTGAGE-SESSION                VALUE '4'.
   943         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   944
   945
   946*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   947
   948     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   949     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   950
   951     12  PI-CREDIT-USER                  PIC X.
   952         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   953         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   954
   955     12  PI-CLAIM-USER                   PIC X.
   956         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   957         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   958
   959     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   960         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   961         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   962         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   963         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   964         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   965
   966     12  PI-PROCESSOR-ID                 PIC X(4).
   967
   968     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   969
   970     12  PI-MEMBER-CAPTION               PIC X(10).
   971
   972     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   973         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   974
   975     12  PI-LIFE-OVERRIDE-L1             PIC X.
   976     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   977     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   978     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   979
   980     12  PI-AH-OVERRIDE-L1               PIC X.
   981     12  PI-AH-OVERRIDE-L2               PIC XX.
   982     12  PI-AH-OVERRIDE-L6               PIC X(6).
   983     12  PI-AH-OVERRIDE-L12              PIC X(12).
   984
   985     12  PI-NEW-SYSTEM                   PIC X(2).
   986
   987     12  PI-PRIMARY-CERT-NO              PIC X(11).
   988     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   989         88  PI-USES-PAID-TO                 VALUE '1'.
   990     12  PI-CRDTCRD-SYSTEM.
   991         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  20
* EL130.cbl
   992             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   993             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   994         16  PI-CC-MONTH-END-DT          PIC XX.
   995     12  PI-PROCESSOR-PRINTER            PIC X(4).
   996
   997     12  PI-OE-REFERENCE-2.
   998         16  PI-OE-REF-2-PRIME           PIC X(10).
   999         16  PI-OE-REF-2-SUFF            PIC X.
  1000
  1001     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1002
  1003     12  PI-LANGUAGE-TYPE                PIC X.
  1004             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1005             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1006             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1007
  1008     12  PI-POLICY-LINKAGE-IND           PIC X.
  1009         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1010         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1011                                                   LOW-VALUES.
  1012
  1013     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1014     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1015         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1016         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1017
  1018     12  PI-PROCESSOR-CSR-IND            PIC X.
  1019         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1020         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1021
  1022     12  FILLER                          PIC X(3).
  1023
  1024     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1025
  1026     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1027         PI-SYSTEM-LEVEL.
  1028
  1029         16  PI-ENTRY-CODES.
  1030             20  PI-ENTRY-CD-1           PIC X.
  1031             20  PI-ENTRY-CD-2           PIC X.
  1032
  1033         16  PI-RETURN-CODES.
  1034             20  PI-RETURN-CD-1          PIC X.
  1035             20  PI-RETURN-CD-2          PIC X.
  1036
  1037         16  PI-UPDATE-STATUS-SAVE.
  1038             20  PI-UPDATE-BY            PIC X(4).
  1039             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1040
  1041         16  PI-LOWER-CASE-LETTERS       PIC X.
  1042             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1043
  1044*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1045*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1046*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1047
  1048         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1049             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  21
* EL130.cbl
  1050             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1051             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1052             88  ACCNT-CNTL                  VALUE '3'.
  1053             88  CARR-ACCNT-CNTL             VALUE '4'.
  1054
  1055         16  PI-PROCESSOR-CAP-LIST.
  1056             20  PI-SYSTEM-CONTROLS.
  1057                24 PI-SYSTEM-DISPLAY     PIC X.
  1058                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1059                24 PI-SYSTEM-MODIFY      PIC X.
  1060                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1061             20  FILLER                  PIC XX.
  1062             20  PI-DISPLAY-CAP          PIC X.
  1063                 88  DISPLAY-CAP             VALUE 'Y'.
  1064             20  PI-MODIFY-CAP           PIC X.
  1065                 88  MODIFY-CAP              VALUE 'Y'.
  1066             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1067                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1068             20  PI-FORCE-CAP            PIC X.
  1069                 88  FORCE-CAP               VALUE 'Y'.
  1070
  1071         16  PI-PROGRAM-CONTROLS.
  1072             20  PI-PGM-PRINT-OPT        PIC X.
  1073             20  PI-PGM-FORMAT-OPT       PIC X.
  1074             20  PI-PGM-PROCESS-OPT      PIC X.
  1075             20  PI-PGM-TOTALS-OPT       PIC X.
  1076
  1077         16  PI-HELP-INTERFACE.
  1078             20  PI-LAST-ERROR-NO        PIC X(4).
  1079             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1080
  1081         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1082             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1083
  1084         16  PI-CR-CONTROL-IN-PROGRESS.
  1085             20  PI-CR-CARRIER           PIC X.
  1086             20  PI-CR-GROUPING          PIC X(6).
  1087             20  PI-CR-STATE             PIC XX.
  1088             20  PI-CR-ACCOUNT           PIC X(10).
  1089             20  PI-CR-FIN-RESP          PIC X(10).
  1090             20  PI-CR-TYPE              PIC X.
  1091
  1092         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1093
  1094         16  PI-CR-MONTH-END-DT          PIC XX.
  1095
  1096         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1097             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1098             88  PI-ZERO-CARRIER             VALUE '1'.
  1099             88  PI-ZERO-GROUPING            VALUE '2'.
  1100             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1101
  1102         16  PI-CARRIER-SECURITY         PIC X.
  1103             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1104
  1105         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1106             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1107             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  22
* EL130.cbl
  1108
  1109         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1110             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1111                                         INDEXED BY PI-ACCESS-NDX
  1112                                         PIC X.
  1113
  1114         16  PI-GA-BILLING-CONTROL       PIC X.
  1115             88  PI-GA-BILLING               VALUE '1'.
  1116
  1117         16  PI-MAIL-PROCESSING          PIC X.
  1118             88  PI-MAIL-YES                 VALUE 'Y'.
  1119
  1120         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1121
  1122         16  PI-AR-SYSTEM.
  1123             20  PI-AR-PROCESSING-CNTL   PIC X.
  1124                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1125             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1126             20  PI-AR-MONTH-END-DT      PIC XX.
  1127
  1128         16  PI-MP-SYSTEM.
  1129             20  PI-MORTGAGE-USER            PIC X.
  1130                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1131                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1132             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1133                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1134                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1135                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1136                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1137                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1138             20  PI-MP-MONTH-END-DT          PIC XX.
  1139             20  PI-MP-REFERENCE-NO.
  1140                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1141                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1142
  1143         16  PI-LABEL-CONTROL            PIC X(01).
  1144             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1145             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1146
  1147         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1148             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1149
  1150         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1151             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1152             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1153
  1154         16  FILLER                      PIC X(14).
  1155
  1156     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1157******************************************************************
  1158     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1159         16  PI-MSTR-DT               PIC XX.
  1160         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1161         16  PI-TRLR-DT               PIC XX.
  1162         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1163         16  PI-LAST-CLAIM            PIC X(7).
  1164         16  PI-LAST-CARR             PIC X.
  1165         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  23
* EL130.cbl
  1166             20  PI-LAST-CERT-PRIME   PIC X(10).
  1167             20  PI-LAST-CERT-SUFX    PIC X.
  1168         16  PI-LAST-CLAIM-TYPE       PIC X.
  1169         16  PI-CURSOR                PIC S9(4)   COMP.
  1170         16  PI-SAVE-CERT.
  1171             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1172             20  PI-SAVE-CERT-SUFX    PIC X.
  1173         16  PI-SAVE-EFFDT            PIC X(2).
  1174         16  PI-SAVE-ACCOUNT          PIC X(10).
  1175         16  PI-INCURR-SW             PIC X.
  1176         16  PI-PRT-OPT               PIC X.
  1177         16  PI-ALT-PRT               PIC X(4).
  1178         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1179             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1180         16  FILLER                   PIC X(272).
  1181         16  PI-EL127-TO-EL130-CNTRL.
  1182             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1183             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1184             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1185                 24  PI-EL127-CARRIER        PIC X.
  1186                 24  PI-EL127-GROUPING       PIC X(6).
  1187                 24  PI-EL127-STATE          PIC X(2).
  1188                 24  PI-EL127-ACCOUNT        PIC X(10).
  1189                 24  PI-EL127-CERT-NO.
  1190                     28  PI-EL127-CERT-PRIME PIC X(10).
  1191                     28  PI-EL127-CERT-SUFX  PIC X.
  1192                 24  PI-EL127-EFF-DT         PIC XX.
  1193*        16  FILLER                          PIC X(50).
  1194         16  FILLER                          PIC X(31).
  1195         16  PI-EL659-TO-EL130-CNTRL.
  1196             20  PI-EL659-CARRIER            PIC X.
  1197             20  PI-EL659-GROUPING           PIC X(6).
  1198             20  PI-EL659-STATE              PIC XX.
  1199             20  PI-EL659-ACCOUNT            PIC X(10).
  1200
  1201         16  FILLER                          PIC X(19).
  1202
  1203         16  PI-SAVE-INCUR-DT                PIC X(02).
  1204         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1205*         16  FILLER                          PIC X(65).
  1206         16  PI-ST-VFY-2ND-BENE              PIC X.
  1207         16  PI-ST-CAUSAL-STATE              PIC X.
  1208         16  pi-dcc-max-benefits             pic s999 comp-3.
  1209         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1210         16  pi-emi-sub                      pic 99.
  1211         16  FILLER                          PIC X(53).
  1212
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  24
* EL130.cbl
  1214*    COPY EL130S.
  1215 01  EL130AI.
  1216     05  FILLER            PIC  X(0012).
  1217*    -------------------------------
  1218     05  RUNDTEL PIC S9(0004) COMP.
  1219     05  RUNDTEF PIC  X(0001).
  1220     05  FILLER REDEFINES RUNDTEF.
  1221         10  RUNDTEA PIC  X(0001).
  1222     05  RUNDTEI PIC  X(0008).
  1223*    -------------------------------
  1224     05  RUNTIMEL PIC S9(0004) COMP.
  1225     05  RUNTIMEF PIC  X(0001).
  1226     05  FILLER REDEFINES RUNTIMEF.
  1227         10  RUNTIMEA PIC  X(0001).
  1228     05  RUNTIMEI PIC  X(0005).
  1229*    -------------------------------
  1230     05  COMPL PIC S9(0004) COMP.
  1231     05  COMPF PIC  X(0001).
  1232     05  FILLER REDEFINES COMPF.
  1233         10  COMPA PIC  X(0001).
  1234     05  COMPI PIC  X(0003).
  1235*    -------------------------------
  1236     05  SEQUL PIC S9(0004) COMP.
  1237     05  SEQUF PIC  X(0001).
  1238     05  FILLER REDEFINES SEQUF.
  1239         10  SEQUA PIC  X(0001).
  1240     05  SEQUI PIC  X(0010).
  1241*    -------------------------------
  1242     05  MAINTL PIC S9(0004) COMP.
  1243     05  MAINTF PIC  X(0001).
  1244     05  FILLER REDEFINES MAINTF.
  1245         10  MAINTA PIC  X(0001).
  1246     05  MAINTI PIC  X(0001).
  1247*    -------------------------------
  1248     05  CLMNOL PIC S9(0004) COMP.
  1249     05  CLMNOF PIC  X(0001).
  1250     05  FILLER REDEFINES CLMNOF.
  1251         10  CLMNOA PIC  X(0001).
  1252     05  CLMNOI PIC  X(0007).
  1253*    -------------------------------
  1254     05  CLMCARRL PIC S9(0004) COMP.
  1255     05  CLMCARRF PIC  X(0001).
  1256     05  FILLER REDEFINES CLMCARRF.
  1257         10  CLMCARRA PIC  X(0001).
  1258     05  CLMCARRI PIC  X(0001).
  1259*    -------------------------------
  1260     05  CLMTYPEL PIC S9(0004) COMP.
  1261     05  CLMTYPEF PIC  X(0001).
  1262     05  FILLER REDEFINES CLMTYPEF.
  1263         10  CLMTYPEA PIC  X(0001).
  1264     05  CLMTYPEI PIC  X(0001).
  1265*    -------------------------------
  1266     05  CERTNOL PIC S9(0004) COMP.
  1267     05  CERTNOF PIC  X(0001).
  1268     05  FILLER REDEFINES CERTNOF.
  1269         10  CERTNOA PIC  X(0001).
  1270     05  CERTNOI PIC  X(0010).
  1271*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  25
* EL130.cbl
  1272     05  SUFXL PIC S9(0004) COMP.
  1273     05  SUFXF PIC  X(0001).
  1274     05  FILLER REDEFINES SUFXF.
  1275         10  SUFXA PIC  X(0001).
  1276     05  SUFXI PIC  X(0001).
  1277*    -------------------------------
  1278     05  PCERTNOL PIC S9(0004) COMP.
  1279     05  PCERTNOF PIC  X(0001).
  1280     05  FILLER REDEFINES PCERTNOF.
  1281         10  PCERTNOA PIC  X(0001).
  1282     05  PCERTNOI PIC  X(0010).
  1283*    -------------------------------
  1284     05  PSUFXL PIC S9(0004) COMP.
  1285     05  PSUFXF PIC  X(0001).
  1286     05  FILLER REDEFINES PSUFXF.
  1287         10  PSUFXA PIC  X(0001).
  1288     05  PSUFXI PIC  X(0001).
  1289*    -------------------------------
  1290     05  INCURL PIC S9(0004) COMP.
  1291     05  INCURF PIC  X(0001).
  1292     05  FILLER REDEFINES INCURF.
  1293         10  INCURA PIC  X(0001).
  1294     05  INCURI PIC  X(0008).
  1295*    -------------------------------
  1296     05  REPORTL PIC S9(0004) COMP.
  1297     05  REPORTF PIC  X(0001).
  1298     05  FILLER REDEFINES REPORTF.
  1299         10  REPORTA PIC  X(0001).
  1300     05  REPORTI PIC  X(0008).
  1301*    -------------------------------
  1302     05  ICD1L PIC S9(0004) COMP.
  1303     05  ICD1F PIC  X(0001).
  1304     05  FILLER REDEFINES ICD1F.
  1305         10  ICD1A PIC  X(0001).
  1306     05  ICD1I PIC  X(0008).
  1307*    -------------------------------
  1308     05  ICD2L PIC S9(0004) COMP.
  1309     05  ICD2F PIC  X(0001).
  1310     05  FILLER REDEFINES ICD2F.
  1311         10  ICD2A PIC  X(0001).
  1312     05  ICD2I PIC  X(0008).
  1313*    -------------------------------
  1314     05  DIAGL PIC S9(0004) COMP.
  1315     05  DIAGF PIC  X(0001).
  1316     05  FILLER REDEFINES DIAGF.
  1317         10  DIAGA PIC  X(0001).
  1318     05  DIAGI PIC  X(0060).
  1319*    -------------------------------
  1320     05  BENECDL PIC S9(0004) COMP.
  1321     05  BENECDF PIC  X(0001).
  1322     05  FILLER REDEFINES BENECDF.
  1323         10  BENECDA PIC  X(0001).
  1324     05  BENECDI PIC  X(0010).
  1325*    -------------------------------
  1326     05  BIRTHDTL PIC S9(0004) COMP.
  1327     05  BIRTHDTF PIC  X(0001).
  1328     05  FILLER REDEFINES BIRTHDTF.
  1329         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  26
* EL130.cbl
  1330     05  BIRTHDTI PIC  X(0008).
  1331*    -------------------------------
  1332     05  SSNL PIC S9(0004) COMP.
  1333     05  SSNF PIC  X(0001).
  1334     05  FILLER REDEFINES SSNF.
  1335         10  SSNA PIC  X(0001).
  1336     05  SSNI PIC  X(0011).
  1337*    -------------------------------
  1338     05  SEXL PIC S9(0004) COMP.
  1339     05  SEXF PIC  X(0001).
  1340     05  FILLER REDEFINES SEXF.
  1341         10  SEXA PIC  X(0001).
  1342     05  SEXI PIC  X(0001).
  1343*    -------------------------------
  1344     05  INSTYPEL PIC S9(0004) COMP.
  1345     05  INSTYPEF PIC  X(0001).
  1346     05  FILLER REDEFINES INSTYPEF.
  1347         10  INSTYPEA PIC  X(0001).
  1348     05  INSTYPEI PIC  X(0001).
  1349*    -------------------------------
  1350     05  LSTNMEL PIC S9(0004) COMP.
  1351     05  LSTNMEF PIC  X(0001).
  1352     05  FILLER REDEFINES LSTNMEF.
  1353         10  LSTNMEA PIC  X(0001).
  1354     05  LSTNMEI PIC  X(0015).
  1355*    -------------------------------
  1356     05  FSTNMEL PIC S9(0004) COMP.
  1357     05  FSTNMEF PIC  X(0001).
  1358     05  FILLER REDEFINES FSTNMEF.
  1359         10  FSTNMEA PIC  X(0001).
  1360     05  FSTNMEI PIC  X(0012).
  1361*    -------------------------------
  1362     05  INITL PIC S9(0004) COMP.
  1363     05  INITF PIC  X(0001).
  1364     05  FILLER REDEFINES INITF.
  1365         10  INITA PIC  X(0001).
  1366     05  INITI PIC  X(0001).
  1367*    -------------------------------
  1368     05  LOANNOL PIC S9(0004) COMP.
  1369     05  LOANNOF PIC  X(0001).
  1370     05  FILLER REDEFINES LOANNOF.
  1371         10  LOANNOA PIC  X(0001).
  1372     05  LOANNOI PIC  X(0008).
  1373*    -------------------------------
  1374     05  CRTLNMEL PIC S9(0004) COMP.
  1375     05  CRTLNMEF PIC  X(0001).
  1376     05  FILLER REDEFINES CRTLNMEF.
  1377         10  CRTLNMEA PIC  X(0001).
  1378     05  CRTLNMEI PIC  X(0015).
  1379*    -------------------------------
  1380     05  CRTFNMEL PIC S9(0004) COMP.
  1381     05  CRTFNMEF PIC  X(0001).
  1382     05  FILLER REDEFINES CRTFNMEF.
  1383         10  CRTFNMEA PIC  X(0001).
  1384     05  CRTFNMEI PIC  X(0012).
  1385*    -------------------------------
  1386     05  CRTINITL PIC S9(0004) COMP.
  1387     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  27
* EL130.cbl
  1388     05  FILLER REDEFINES CRTINITF.
  1389         10  CRTINITA PIC  X(0001).
  1390     05  CRTINITI PIC  X(0001).
  1391*    -------------------------------
  1392     05  LOANBALL PIC S9(0004) COMP.
  1393     05  LOANBALF PIC  X(0001).
  1394     05  FILLER REDEFINES LOANBALF.
  1395         10  LOANBALA PIC  X(0001).
  1396     05  LOANBALI PIC  9(7)V99.
  1397*    -------------------------------
  1398     05  MANRSVL PIC S9(0004) COMP.
  1399     05  MANRSVF PIC  X(0001).
  1400     05  FILLER REDEFINES MANRSVF.
  1401         10  MANRSVA PIC  X(0001).
  1402     05  MANRSVI PIC  9(7)V99.
  1403*    -------------------------------
  1404     05  SUPVL PIC S9(0004) COMP.
  1405     05  SUPVF PIC  X(0001).
  1406     05  FILLER REDEFINES SUPVF.
  1407         10  SUPVA PIC  X(0001).
  1408     05  SUPVI PIC  X(0001).
  1409*    -------------------------------
  1410     05  PRICDL PIC S9(0004) COMP.
  1411     05  PRICDF PIC  X(0001).
  1412     05  FILLER REDEFINES PRICDF.
  1413         10  PRICDA PIC  X(0001).
  1414     05  PRICDI PIC  X(0001).
  1415*    -------------------------------
  1416     05  PRODL PIC S9(0004) COMP.
  1417     05  PRODF PIC  X(0001).
  1418     05  FILLER REDEFINES PRODF.
  1419         10  PRODA PIC  X(0001).
  1420     05  PRODI PIC  X(0008).
  1421*    -------------------------------
  1422     05  PRODCDL PIC S9(0004) COMP.
  1423     05  PRODCDF PIC  X(0001).
  1424     05  FILLER REDEFINES PRODCDF.
  1425         10  PRODCDA PIC  X(0001).
  1426     05  PRODCDI PIC  X(0001).
  1427*    -------------------------------
  1428     05  FILETOL PIC S9(0004) COMP.
  1429     05  FILETOF PIC  X(0001).
  1430     05  FILLER REDEFINES FILETOF.
  1431         10  FILETOA PIC  X(0001).
  1432     05  FILETOI PIC  X(0004).
  1433*    -------------------------------
  1434     05  PROCCDL PIC S9(0004) COMP.
  1435     05  PROCCDF PIC  X(0001).
  1436     05  FILLER REDEFINES PROCCDF.
  1437         10  PROCCDA PIC  X(0001).
  1438     05  PROCCDI PIC  X(0004).
  1439*    -------------------------------
  1440     05  RELCLML PIC S9(0004) COMP.
  1441     05  RELCLMF PIC  X(0001).
  1442     05  FILLER REDEFINES RELCLMF.
  1443         10  RELCLMA PIC  X(0001).
  1444     05  RELCLMI PIC  X(0007).
  1445*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  28
* EL130.cbl
  1446     05  PRTOPTL PIC S9(0004) COMP.
  1447     05  PRTOPTF PIC  X(0001).
  1448     05  FILLER REDEFINES PRTOPTF.
  1449         10  PRTOPTA PIC  X(0001).
  1450     05  PRTOPTI PIC  X(0001).
  1451*    -------------------------------
  1452     05  ALTPRTL PIC S9(0004) COMP.
  1453     05  ALTPRTF PIC  X(0001).
  1454     05  FILLER REDEFINES ALTPRTF.
  1455         10  ALTPRTA PIC  X(0001).
  1456     05  ALTPRTI PIC  X(0004).
  1457*    -------------------------------
  1458     05  CERTMTL PIC S9(0004) COMP.
  1459     05  CERTMTF PIC  X(0001).
  1460     05  FILLER REDEFINES CERTMTF.
  1461         10  CERTMTA PIC  X(0001).
  1462     05  CERTMTI PIC  X(0001).
  1463*    -------------------------------
  1464     05  CRTCARRL PIC S9(0004) COMP.
  1465     05  CRTCARRF PIC  X(0001).
  1466     05  FILLER REDEFINES CRTCARRF.
  1467         10  CRTCARRA PIC  X(0001).
  1468     05  CRTCARRI PIC  X(0001).
  1469*    -------------------------------
  1470     05  GROUPL PIC S9(0004) COMP.
  1471     05  GROUPF PIC  X(0001).
  1472     05  FILLER REDEFINES GROUPF.
  1473         10  GROUPA PIC  X(0001).
  1474     05  GROUPI PIC  X(0006).
  1475*    -------------------------------
  1476     05  STATEL PIC S9(0004) COMP.
  1477     05  STATEF PIC  X(0001).
  1478     05  FILLER REDEFINES STATEF.
  1479         10  STATEA PIC  X(0001).
  1480     05  STATEI PIC  X(0002).
  1481*    -------------------------------
  1482     05  ACCOUNTL PIC S9(0004) COMP.
  1483     05  ACCOUNTF PIC  X(0001).
  1484     05  FILLER REDEFINES ACCOUNTF.
  1485         10  ACCOUNTA PIC  X(0001).
  1486     05  ACCOUNTI PIC  X(0010).
  1487*    -------------------------------
  1488     05  EFFDTL PIC S9(0004) COMP.
  1489     05  EFFDTF PIC  X(0001).
  1490     05  FILLER REDEFINES EFFDTF.
  1491         10  EFFDTA PIC  X(0001).
  1492     05  EFFDTI PIC  X(0008).
  1493*    -------------------------------
  1494     05  CRTSSNL PIC S9(0004) COMP.
  1495     05  CRTSSNF PIC  X(0001).
  1496     05  FILLER REDEFINES CRTSSNF.
  1497         10  CRTSSNA PIC  X(0001).
  1498     05  CRTSSNI PIC  X(0011).
  1499*    -------------------------------
  1500     05  MEMCAPL PIC S9(0004) COMP.
  1501     05  MEMCAPF PIC  X(0001).
  1502     05  FILLER REDEFINES MEMCAPF.
  1503         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  29
* EL130.cbl
  1504     05  MEMCAPI PIC  X(0010).
  1505*    -------------------------------
  1506     05  MEMBERL PIC S9(0004) COMP.
  1507     05  MEMBERF PIC  X(0001).
  1508     05  FILLER REDEFINES MEMBERF.
  1509         10  MEMBERA PIC  X(0001).
  1510     05  MEMBERI PIC  X(0012).
  1511*    -------------------------------
  1512     05  REINCDL PIC S9(0004) COMP.
  1513     05  REINCDF PIC  X(0001).
  1514     05  FILLER REDEFINES REINCDF.
  1515         10  REINCDA PIC  X(0001).
  1516     05  REINCDI PIC  X(0001).
  1517*    -------------------------------
  1518     05  ISSAGEL PIC S9(0004) COMP.
  1519     05  ISSAGEF PIC  X(0001).
  1520     05  FILLER REDEFINES ISSAGEF.
  1521         10  ISSAGEA PIC  X(0001).
  1522     05  ISSAGEI PIC  X(0002).
  1523*    -------------------------------
  1524     05  APRL PIC S9(0004) COMP.
  1525     05  APRF PIC  X(0001).
  1526     05  FILLER REDEFINES APRF.
  1527         10  APRA PIC  X(0001).
  1528     05  APRI PIC  9(4)V9(4).
  1529*    -------------------------------
  1530     05  PMTFREQL PIC S9(0004) COMP.
  1531     05  PMTFREQF PIC  X(0001).
  1532     05  FILLER REDEFINES PMTFREQF.
  1533         10  PMTFREQA PIC  X(0001).
  1534     05  PMTFREQI PIC  99.
  1535*    -------------------------------
  1536     05  INDGRPL PIC S9(0004) COMP.
  1537     05  INDGRPF PIC  X(0001).
  1538     05  FILLER REDEFINES INDGRPF.
  1539         10  INDGRPA PIC  X(0001).
  1540     05  INDGRPI PIC  X(0001).
  1541*    -------------------------------
  1542     05  PREMTYPL PIC S9(0004) COMP.
  1543     05  PREMTYPF PIC  X(0001).
  1544     05  FILLER REDEFINES PREMTYPF.
  1545         10  PREMTYPA PIC  X(0001).
  1546     05  PREMTYPI PIC  X(0001).
  1547*    -------------------------------
  1548     05  ADDONDTL PIC S9(0004) COMP.
  1549     05  ADDONDTF PIC  X(0001).
  1550     05  FILLER REDEFINES ADDONDTF.
  1551         10  ADDONDTA PIC  X(0001).
  1552     05  ADDONDTI PIC  X(0008).
  1553*    -------------------------------
  1554     05  JNTLNMEL PIC S9(0004) COMP.
  1555     05  JNTLNMEF PIC  X(0001).
  1556     05  FILLER REDEFINES JNTLNMEF.
  1557         10  JNTLNMEA PIC  X(0001).
  1558     05  JNTLNMEI PIC  X(0015).
  1559*    -------------------------------
  1560     05  JNTFNMEL PIC S9(0004) COMP.
  1561     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  30
* EL130.cbl
  1562     05  FILLER REDEFINES JNTFNMEF.
  1563         10  JNTFNMEA PIC  X(0001).
  1564     05  JNTFNMEI PIC  X(0002).
  1565*    -------------------------------
  1566     05  JNTINITL PIC S9(0004) COMP.
  1567     05  JNTINITF PIC  X(0001).
  1568     05  FILLER REDEFINES JNTINITF.
  1569         10  JNTINITA PIC  X(0001).
  1570     05  JNTINITI PIC  X(0001).
  1571*    -------------------------------
  1572     05  JNTAGEL PIC S9(0004) COMP.
  1573     05  JNTAGEF PIC  X(0001).
  1574     05  FILLER REDEFINES JNTAGEF.
  1575         10  JNTAGEA PIC  X(0001).
  1576     05  JNTAGEI PIC  X(0002).
  1577*    -------------------------------
  1578     05  LCVDSCRL PIC S9(0004) COMP.
  1579     05  LCVDSCRF PIC  X(0001).
  1580     05  FILLER REDEFINES LCVDSCRF.
  1581         10  LCVDSCRA PIC  X(0001).
  1582     05  LCVDSCRI PIC  X(0006).
  1583*    -------------------------------
  1584     05  LCVKINDL PIC S9(0004) COMP.
  1585     05  LCVKINDF PIC  X(0001).
  1586     05  FILLER REDEFINES LCVKINDF.
  1587         10  LCVKINDA PIC  X(0001).
  1588     05  LCVKINDI PIC  X(0003).
  1589*    -------------------------------
  1590     05  LCVCDL PIC S9(0004) COMP.
  1591     05  LCVCDF PIC  X(0001).
  1592     05  FILLER REDEFINES LCVCDF.
  1593         10  LCVCDA PIC  X(0001).
  1594     05  LCVCDI PIC  X(0002).
  1595*    -------------------------------
  1596     05  LCVOTRML PIC S9(0004) COMP.
  1597     05  LCVOTRMF PIC  X(0001).
  1598     05  FILLER REDEFINES LCVOTRMF.
  1599         10  LCVOTRMA PIC  X(0001).
  1600     05  LCVOTRMI PIC  999.
  1601*    -------------------------------
  1602     05  LCVRTRML PIC S9(0004) COMP.
  1603     05  LCVRTRMF PIC  X(0001).
  1604     05  FILLER REDEFINES LCVRTRMF.
  1605         10  LCVRTRMA PIC  X(0001).
  1606     05  LCVRTRMI PIC  X(0003).
  1607*    -------------------------------
  1608     05  LCVRATEL PIC S9(0004) COMP.
  1609     05  LCVRATEF PIC  X(0001).
  1610     05  FILLER REDEFINES LCVRATEF.
  1611         10  LCVRATEA PIC  X(0001).
  1612     05  LCVRATEI PIC  9999V99.
  1613*    -------------------------------
  1614     05  LCVBENEL PIC S9(0004) COMP.
  1615     05  LCVBENEF PIC  X(0001).
  1616     05  FILLER REDEFINES LCVBENEF.
  1617         10  LCVBENEA PIC  X(0001).
  1618     05  LCVBENEI PIC  9(9)V99.
  1619*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  31
* EL130.cbl
  1620     05  LCVFORML PIC S9(0004) COMP.
  1621     05  LCVFORMF PIC  X(0001).
  1622     05  FILLER REDEFINES LCVFORMF.
  1623         10  LCVFORMA PIC  X(0001).
  1624     05  LCVFORMI PIC  X(0012).
  1625*    -------------------------------
  1626     05  LCVCNDTL PIC S9(0004) COMP.
  1627     05  LCVCNDTF PIC  X(0001).
  1628     05  FILLER REDEFINES LCVCNDTF.
  1629         10  LCVCNDTA PIC  X(0001).
  1630     05  LCVCNDTI PIC  X(0008).
  1631*    -------------------------------
  1632     05  LCVEXITL PIC S9(0004) COMP.
  1633     05  LCVEXITF PIC  X(0001).
  1634     05  FILLER REDEFINES LCVEXITF.
  1635         10  LCVEXITA PIC  X(0001).
  1636     05  LCVEXITI PIC  X(0008).
  1637*    -------------------------------
  1638     05  LCVSTATL PIC S9(0004) COMP.
  1639     05  LCVSTATF PIC  X(0001).
  1640     05  FILLER REDEFINES LCVSTATF.
  1641         10  LCVSTATA PIC  X(0001).
  1642     05  LCVSTATI PIC  X(0006).
  1643*    -------------------------------
  1644     05  ACVDSCRL PIC S9(0004) COMP.
  1645     05  ACVDSCRF PIC  X(0001).
  1646     05  FILLER REDEFINES ACVDSCRF.
  1647         10  ACVDSCRA PIC  X(0001).
  1648     05  ACVDSCRI PIC  X(0006).
  1649*    -------------------------------
  1650     05  ACVKINDL PIC S9(0004) COMP.
  1651     05  ACVKINDF PIC  X(0001).
  1652     05  FILLER REDEFINES ACVKINDF.
  1653         10  ACVKINDA PIC  X(0001).
  1654     05  ACVKINDI PIC  X(0003).
  1655*    -------------------------------
  1656     05  ACVCDL PIC S9(0004) COMP.
  1657     05  ACVCDF PIC  X(0001).
  1658     05  FILLER REDEFINES ACVCDF.
  1659         10  ACVCDA PIC  X(0001).
  1660     05  ACVCDI PIC  X(0002).
  1661*    -------------------------------
  1662     05  ACVOTRML PIC S9(0004) COMP.
  1663     05  ACVOTRMF PIC  X(0001).
  1664     05  FILLER REDEFINES ACVOTRMF.
  1665         10  ACVOTRMA PIC  X(0001).
  1666     05  ACVOTRMI PIC  999.
  1667*    -------------------------------
  1668     05  ACVRTRML PIC S9(0004) COMP.
  1669     05  ACVRTRMF PIC  X(0001).
  1670     05  FILLER REDEFINES ACVRTRMF.
  1671         10  ACVRTRMA PIC  X(0001).
  1672     05  ACVRTRMI PIC  X(0003).
  1673*    -------------------------------
  1674     05  ACVRATEL PIC S9(0004) COMP.
  1675     05  ACVRATEF PIC  X(0001).
  1676     05  FILLER REDEFINES ACVRATEF.
  1677         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  32
* EL130.cbl
  1678     05  ACVRATEI PIC  9999V99.
  1679*    -------------------------------
  1680     05  ACVBENEL PIC S9(0004) COMP.
  1681     05  ACVBENEF PIC  X(0001).
  1682     05  FILLER REDEFINES ACVBENEF.
  1683         10  ACVBENEA PIC  X(0001).
  1684     05  ACVBENEI PIC  9(9)V99.
  1685*    -------------------------------
  1686     05  ACVFORML PIC S9(0004) COMP.
  1687     05  ACVFORMF PIC  X(0001).
  1688     05  FILLER REDEFINES ACVFORMF.
  1689         10  ACVFORMA PIC  X(0001).
  1690     05  ACVFORMI PIC  X(0012).
  1691*    -------------------------------
  1692     05  ACVCNDTL PIC S9(0004) COMP.
  1693     05  ACVCNDTF PIC  X(0001).
  1694     05  FILLER REDEFINES ACVCNDTF.
  1695         10  ACVCNDTA PIC  X(0001).
  1696     05  ACVCNDTI PIC  X(0008).
  1697*    -------------------------------
  1698     05  ACVEXITL PIC S9(0004) COMP.
  1699     05  ACVEXITF PIC  X(0001).
  1700     05  FILLER REDEFINES ACVEXITF.
  1701         10  ACVEXITA PIC  X(0001).
  1702     05  ACVEXITI PIC  X(0008).
  1703*    -------------------------------
  1704     05  ACVSTATL PIC S9(0004) COMP.
  1705     05  ACVSTATF PIC  X(0001).
  1706     05  FILLER REDEFINES ACVSTATF.
  1707         10  ACVSTATA PIC  X(0001).
  1708     05  ACVSTATI PIC  X(0006).
  1709*    -------------------------------
  1710     05  ERRMSG1L PIC S9(0004) COMP.
  1711     05  ERRMSG1F PIC  X(0001).
  1712     05  FILLER REDEFINES ERRMSG1F.
  1713         10  ERRMSG1A PIC  X(0001).
  1714     05  ERRMSG1I PIC  X(0072).
  1715*    -------------------------------
  1716     05  ERRMSG2L PIC S9(0004) COMP.
  1717     05  ERRMSG2F PIC  X(0001).
  1718     05  FILLER REDEFINES ERRMSG2F.
  1719         10  ERRMSG2A PIC  X(0001).
  1720     05  ERRMSG2I PIC  X(0072).
  1721*    -------------------------------
  1722     05  BCERT1L PIC S9(0004) COMP.
  1723     05  BCERT1F PIC  X(0001).
  1724     05  FILLER REDEFINES BCERT1F.
  1725         10  BCERT1A PIC  X(0001).
  1726     05  BCERT1I PIC  X(0010).
  1727*    -------------------------------
  1728     05  BSUFX1L PIC S9(0004) COMP.
  1729     05  BSUFX1F PIC  X(0001).
  1730     05  FILLER REDEFINES BSUFX1F.
  1731         10  BSUFX1A PIC  X(0001).
  1732     05  BSUFX1I PIC  X(0001).
  1733*    -------------------------------
  1734     05  BCERT2L PIC S9(0004) COMP.
  1735     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  33
* EL130.cbl
  1736     05  FILLER REDEFINES BCERT2F.
  1737         10  BCERT2A PIC  X(0001).
  1738     05  BCERT2I PIC  X(0010).
  1739*    -------------------------------
  1740     05  BSUFX2L PIC S9(0004) COMP.
  1741     05  BSUFX2F PIC  X(0001).
  1742     05  FILLER REDEFINES BSUFX2F.
  1743         10  BSUFX2A PIC  X(0001).
  1744     05  BSUFX2I PIC  X(0001).
  1745*    -------------------------------
  1746     05  BCERT3L PIC S9(0004) COMP.
  1747     05  BCERT3F PIC  X(0001).
  1748     05  FILLER REDEFINES BCERT3F.
  1749         10  BCERT3A PIC  X(0001).
  1750     05  BCERT3I PIC  X(0010).
  1751*    -------------------------------
  1752     05  BSUFX3L PIC S9(0004) COMP.
  1753     05  BSUFX3F PIC  X(0001).
  1754     05  FILLER REDEFINES BSUFX3F.
  1755         10  BSUFX3A PIC  X(0001).
  1756     05  BSUFX3I PIC  X(0001).
  1757*    -------------------------------
  1758     05  BCERT4L PIC S9(0004) COMP.
  1759     05  BCERT4F PIC  X(0001).
  1760     05  FILLER REDEFINES BCERT4F.
  1761         10  BCERT4A PIC  X(0001).
  1762     05  BCERT4I PIC  X(0010).
  1763*    -------------------------------
  1764     05  BSUFX4L PIC S9(0004) COMP.
  1765     05  BSUFX4F PIC  X(0001).
  1766     05  FILLER REDEFINES BSUFX4F.
  1767         10  BSUFX4A PIC  X(0001).
  1768     05  BSUFX4I PIC  X(0001).
  1769*    -------------------------------
  1770     05  BCERT5L PIC S9(0004) COMP.
  1771     05  BCERT5F PIC  X(0001).
  1772     05  FILLER REDEFINES BCERT5F.
  1773         10  BCERT5A PIC  X(0001).
  1774     05  BCERT5I PIC  X(0010).
  1775*    -------------------------------
  1776     05  BSUFX5L PIC S9(0004) COMP.
  1777     05  BSUFX5F PIC  X(0001).
  1778     05  FILLER REDEFINES BSUFX5F.
  1779         10  BSUFX5A PIC  X(0001).
  1780     05  BSUFX5I PIC  X(0001).
  1781*    -------------------------------
  1782     05  ENTERPFL PIC S9(0004) COMP.
  1783     05  ENTERPFF PIC  X(0001).
  1784     05  FILLER REDEFINES ENTERPFF.
  1785         10  ENTERPFA PIC  X(0001).
  1786     05  ENTERPFI PIC  99.
  1787*    -------------------------------
  1788     05  PF5L PIC S9(0004) COMP.
  1789     05  PF5F PIC  X(0001).
  1790     05  FILLER REDEFINES PF5F.
  1791         10  PF5A PIC  X(0001).
  1792     05  PF5I PIC  X(0013).
  1793 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  34
* EL130.cbl
  1794     05  FILLER            PIC  X(0012).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  RUNDTEO PIC  X(0008).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  RUNTIMEO PIC  99.99.
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  COMPO PIC  X(0003).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  SEQUO PIC  X(0010).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  MAINTO PIC  X(0001).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  CLMNOO PIC  X(0007).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  CLMCARRO PIC  X(0001).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  CLMTYPEO PIC  X(0001).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  CERTNOO PIC  X(0010).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  SUFXO PIC  X(0001).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  PCERTNOO PIC  X(0010).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  PSUFXO PIC  X(0001).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  INCURO PIC  X(0008).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  REPORTO PIC  X(0008).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  ICD1O PIC  X(0008).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  ICD2O PIC  X(0008).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  DIAGO PIC  X(0060).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  BENECDO PIC  X(0010).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  35
* EL130.cbl
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  SSNO PIC  X(0011).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  SEXO PIC  X(0001).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  INSTYPEO PIC  X(0001).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  LSTNMEO PIC  X(0015).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  FSTNMEO PIC  X(0012).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  INITO PIC  X(0001).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  LOANNOO PIC  X(0008).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  CRTLNMEO PIC  X(0015).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  CRTFNMEO PIC  X(0012).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  CRTINITO PIC  X(0001).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  LOANBALO PIC  ZZZZZ9.99.
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  MANRSVO PIC  Z(5)9.99.
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  SUPVO PIC  X(0001).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  PRICDO PIC  X(0001).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  PRODO PIC  X(0008).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  PRODCDO PIC  X(0001).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  FILETOO PIC  X(0004).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  PROCCDO PIC  X(0004).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  RELCLMO PIC  X(0007).
  1909*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  36
* EL130.cbl
  1910     05  FILLER            PIC  X(0003).
  1911     05  PRTOPTO PIC  X(0001).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  ALTPRTO PIC  X(0004).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  CERTMTO PIC  X(0001).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  CRTCARRO PIC  X(0001).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  GROUPO PIC  X(0006).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  STATEO PIC  X(0002).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  ACCOUNTO PIC  X(0010).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  EFFDTO PIC  X(0008).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  CRTSSNO PIC  X(0011).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  MEMCAPO PIC  X(0010).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  MEMBERO PIC  X(0012).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  REINCDO PIC  X(0001).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  ISSAGEO PIC  X(0002).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  APRO PIC  9(3).9(4).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  PMTFREQO PIC  99.
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  INDGRPO PIC  X(0001).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  PREMTYPO PIC  X(0001).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  ADDONDTO PIC  X(0008).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  JNTLNMEO PIC  X(0015).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  37
* EL130.cbl
  1968     05  JNTFNMEO PIC  X(0002).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  JNTINITO PIC  X(0001).
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  JNTAGEO PIC  X(0002).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  LCVDSCRO PIC  X(0006).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  LCVKINDO PIC  X(0003).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  LCVCDO PIC  X(0002).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  LCVOTRMO PIC  999.
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  LCVRTRMO PIC  ZZZ.
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  LCVRATEO PIC  ZZZ.ZZ.
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  LCVFORMO PIC  X(0012).
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  LCVCNDTO PIC  X(0008).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  LCVEXITO PIC  X(0008).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  LCVSTATO PIC  X(0006).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  ACVDSCRO PIC  X(0006).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  ACVKINDO PIC  X(0003).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  ACVCDO PIC  X(0002).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  ACVOTRMO PIC  999.
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  ACVRTRMO PIC  ZZZ.
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  38
* EL130.cbl
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  ACVFORMO PIC  X(0012).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  ACVCNDTO PIC  X(0008).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  ACVEXITO PIC  X(0008).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  ACVSTATO PIC  X(0006).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  ERRMSG1O PIC  X(0072).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  ERRMSG2O PIC  X(0072).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  BCERT1O PIC  X(0010).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  BSUFX1O PIC  X(0001).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  BCERT2O PIC  X(0010).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  BSUFX2O PIC  X(0001).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  BCERT3O PIC  X(0010).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  BSUFX3O PIC  X(0001).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  BCERT4O PIC  X(0010).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  BSUFX4O PIC  X(0001).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  BCERT5O PIC  X(0010).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  BSUFX5O PIC  X(0001).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  ENTERPFO PIC  X(0002).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  PF5O PIC  X(0013).
  2083*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  39
* EL130.cbl
  2085*    COPY ELCDATE.
  2086******************************************************************
  2087*                                                                *
  2088*                                                                *
  2089*                            ELCDATE.                            *
  2090*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2091*                            VMOD=2.003
  2092*                                                                *
  2093*                                                                *
  2094*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2095*                 LENGTH = 200                                   *
  2096******************************************************************
  2097
  2098 01  DATE-CONVERSION-DATA.
  2099     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2100     12  DC-OPTION-CODE                PIC X.
  2101         88  BIN-TO-GREG                VALUE ' '.
  2102         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2103         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2104         88  YMD-GREG-TO-BIN            VALUE '3'.
  2105         88  MDY-GREG-TO-BIN            VALUE '4'.
  2106         88  JULIAN-TO-BIN              VALUE '5'.
  2107         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2108         88  FIND-CENTURY               VALUE '7'.
  2109         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2110         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2111         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2112         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2113         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2114         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2115         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2116         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2117         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2118         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2119         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2120         88  BIN-3-TO-GREG              VALUE 'I'.
  2121         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2122         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2123         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2124         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2125         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2126         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2127         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2128         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2129         88  THREE-CHARACTER-BIN
  2130                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2131         88  GREGORIAN-TO-BIN
  2132                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2133         88  BIN-TO-GREGORIAN
  2134                  VALUES ' ' '1' 'I' '8' 'G'.
  2135         88  JULIAN-TO-BINARY
  2136                  VALUES '5' 'C' 'E' 'F'.
  2137     12  DC-ERROR-CODE                 PIC X.
  2138         88  NO-CONVERSION-ERROR        VALUE ' '.
  2139         88  DATE-CONVERSION-ERROR
  2140                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2141         88  DATE-IS-ZERO               VALUE '1'.
  2142         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  40
* EL130.cbl
  2143         88  DATE-IS-INVALID            VALUE '3'.
  2144         88  DATE1-GREATER-DATE2        VALUE '4'.
  2145         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2146         88  DATE-INVALID-OPTION        VALUE '9'.
  2147         88  INVALID-CENTURY            VALUE 'A'.
  2148         88  ONLY-CENTURY               VALUE 'B'.
  2149         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2150         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2151     12  DC-END-OF-MONTH               PIC X.
  2152         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2153     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2154         88  USE-NORMAL-PROCESS         VALUE ' '.
  2155         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2156         88  ADJUST-UP-100-YRS          VALUE '2'.
  2157     12  FILLER                        PIC X.
  2158     12  DC-CONVERSION-DATES.
  2159         16  DC-BIN-DATE-1             PIC XX.
  2160         16  DC-BIN-DATE-2             PIC XX.
  2161         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2162         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2163                       DC-GREG-DATE-1-EDIT.
  2164             20  DC-EDIT1-MONTH        PIC 99.
  2165             20  SLASH1-1              PIC X.
  2166             20  DC-EDIT1-DAY          PIC 99.
  2167             20  SLASH1-2              PIC X.
  2168             20  DC-EDIT1-YEAR         PIC 99.
  2169         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2170         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2171                     DC-GREG-DATE-2-EDIT.
  2172             20  DC-EDIT2-MONTH        PIC 99.
  2173             20  SLASH2-1              PIC X.
  2174             20  DC-EDIT2-DAY          PIC 99.
  2175             20  SLASH2-2              PIC X.
  2176             20  DC-EDIT2-YEAR         PIC 99.
  2177         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2178         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2179                     DC-GREG-DATE-1-YMD.
  2180             20  DC-YMD-YEAR           PIC 99.
  2181             20  DC-YMD-MONTH          PIC 99.
  2182             20  DC-YMD-DAY            PIC 99.
  2183         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2184         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2185                      DC-GREG-DATE-1-MDY.
  2186             20  DC-MDY-MONTH          PIC 99.
  2187             20  DC-MDY-DAY            PIC 99.
  2188             20  DC-MDY-YEAR           PIC 99.
  2189         16  DC-GREG-DATE-1-ALPHA.
  2190             20  DC-ALPHA-MONTH        PIC X(10).
  2191             20  DC-ALPHA-DAY          PIC 99.
  2192             20  FILLER                PIC XX.
  2193             20  DC-ALPHA-CENTURY.
  2194                 24 DC-ALPHA-CEN-N     PIC 99.
  2195             20  DC-ALPHA-YEAR         PIC 99.
  2196         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2197         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2198         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2199         16  DC-JULIAN-DATE            PIC 9(05).
  2200         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  41
* EL130.cbl
  2201                                       PIC 9(05).
  2202         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2203             20  DC-JULIAN-YEAR        PIC 99.
  2204             20  DC-JULIAN-DAYS        PIC 999.
  2205         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2206         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2207         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2208     12  DATE-CONVERSION-VARIBLES.
  2209         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2210         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2211             20  FILLER                PIC 9(3).
  2212             20  HOLD-CEN-1-CCYY.
  2213                 24  HOLD-CEN-1-CC     PIC 99.
  2214                 24  HOLD-CEN-1-YY     PIC 99.
  2215             20  HOLD-CEN-1-MO         PIC 99.
  2216             20  HOLD-CEN-1-DA         PIC 99.
  2217         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2218             20  HOLD-CEN-1-R-MO       PIC 99.
  2219             20  HOLD-CEN-1-R-DA       PIC 99.
  2220             20  HOLD-CEN-1-R-CCYY.
  2221                 24  HOLD-CEN-1-R-CC   PIC 99.
  2222                 24  HOLD-CEN-1-R-YY   PIC 99.
  2223             20  FILLER                PIC 9(3).
  2224         16  HOLD-CENTURY-1-X.
  2225             20  FILLER                PIC X(3)  VALUE SPACES.
  2226             20  HOLD-CEN-1-X-CCYY.
  2227                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2228                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2229             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2230             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2231         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2232             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2233             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2234             20  HOLD-CEN-1-R-X-CCYY.
  2235                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2236                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2237             20  FILLER                PIC XXX.
  2238         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2239         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2240         16  DC-JULIAN-DATE-1          PIC 9(07).
  2241         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2242             20  DC-JULIAN-1-CCYY.
  2243                 24  DC-JULIAN-1-CC    PIC 99.
  2244                 24  DC-JULIAN-1-YR    PIC 99.
  2245             20  DC-JULIAN-DA-1        PIC 999.
  2246         16  DC-JULIAN-DATE-2          PIC 9(07).
  2247         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2248             20  DC-JULIAN-2-CCYY.
  2249                 24  DC-JULIAN-2-CC    PIC 99.
  2250                 24  DC-JULIAN-2-YR    PIC 99.
  2251             20  DC-JULIAN-DA-2        PIC 999.
  2252         16  DC-GREG-DATE-A-EDIT.
  2253             20  DC-EDITA-MONTH        PIC 99.
  2254             20  SLASHA-1              PIC X VALUE '/'.
  2255             20  DC-EDITA-DAY          PIC 99.
  2256             20  SLASHA-2              PIC X VALUE '/'.
  2257             20  DC-EDITA-CCYY.
  2258                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  42
* EL130.cbl
  2259                 24  DC-EDITA-YEAR     PIC 99.
  2260         16  DC-GREG-DATE-B-EDIT.
  2261             20  DC-EDITB-MONTH        PIC 99.
  2262             20  SLASHB-1              PIC X VALUE '/'.
  2263             20  DC-EDITB-DAY          PIC 99.
  2264             20  SLASHB-2              PIC X VALUE '/'.
  2265             20  DC-EDITB-CCYY.
  2266                 24  DC-EDITB-CENT     PIC 99.
  2267                 24  DC-EDITB-YEAR     PIC 99.
  2268         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2269         16  DC-GREG-DATE-CYMD-R REDEFINES
  2270                              DC-GREG-DATE-CYMD.
  2271             20  DC-CYMD-CEN           PIC 99.
  2272             20  DC-CYMD-YEAR          PIC 99.
  2273             20  DC-CYMD-MONTH         PIC 99.
  2274             20  DC-CYMD-DAY           PIC 99.
  2275         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2276         16  DC-GREG-DATE-MDCY-R REDEFINES
  2277                              DC-GREG-DATE-MDCY.
  2278             20  DC-MDCY-MONTH         PIC 99.
  2279             20  DC-MDCY-DAY           PIC 99.
  2280             20  DC-MDCY-CEN           PIC 99.
  2281             20  DC-MDCY-YEAR          PIC 99.
  2282    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2283        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2284    12  DC-EL310-DATE                  PIC X(21).
  2285    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  43
* EL130.cbl
  2287*    COPY ELCCALC.
  2288******************************************************************
  2289*                                                                *
  2290*                           ELCCALC.                            *
  2291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2292*                            VMOD=2.025                          *
  2293*                                                                *
  2294*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2295*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2296*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2297*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2298*                                                                *
  2299*  PASSED TO ELRTRM                                              *
  2300*  -----------------                                             *
  2301*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2302*  ORIGINAL TERM                                                 *
  2303*  BEGINNING DATE                                                *
  2304*  ENDING DATE                                                   *
  2305*  COMPANY I.D.                                                  *
  2306*  ACCOUNT MASTER USER FIELD                                     *
  2307*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2308*  FREE LOOK DAYS                                                *
  2309*                                                                *
  2310*  RETURNED FROM ELRTRM                                          *
  2311*  ---------------------                                         *
  2312*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2313*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2314*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2315*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2316*----------------------------------------------------------------*
  2317*  PASSED TO ELRAMT                                              *
  2318*  ----------------                                              *
  2319*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2320*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2321*  ORIGINAL AMOUNT                                               *
  2322*  ALTERNATE BENEFIT (BALLON)                                    *
  2323*  A.P.R. - NET PAY ONLY                                         *
  2324*  METHOD
  2325*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2326*  COMPANY I.D.                                                  *
  2327*  BENEFIT TYPE                                                  *
  2328*                                                                *
  2329*  RETURNED FROM ELRAMT                                          *
  2330*  --------------------                                          *
  2331*  REMAINING AMOUNT 1 - CURRENT                                  *
  2332*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2333*  REMAINING AMOUNT FACTOR
  2334*----------------------------------------------------------------*
  2335*  PASSED TO ELRESV                                              *
  2336*  -----------------                                             *
  2337*  CERTIFICATE EFFECTIVE DATE                                    *
  2338*  VALUATION DATE                                                *
  2339*  PAID THRU DATE                                                *
  2340*  BENEFIT                                                       *
  2341*  INCURRED DATE                                                 *
  2342*  REPORTED DATE                                                 *
  2343*  ISSUE AGE                                                     *
  2344*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  44
* EL130.cbl
  2345*  CDT PERCENT                                                   *
  2346*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2347* *CLAIM TYPE (LIFE, A/H)                                        *
  2348* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2349* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2350*                                                                *
  2351*  RETURNED FROM ELRESV                                          *
  2352*  --------------------                                          *
  2353*  CDT TABLE USED                                                *
  2354*  CDT FACTOR USED                                               *
  2355*  PAY TO CURRENT RESERVE                                        *
  2356*  I.B.N.R. - A/H ONLY                                           *
  2357*  FUTURE (ACCRUED) AH ONLY                                      *
  2358*----------------------------------------------------------------*
  2359*  PASSED TO ELRATE                                              *
  2360*  ----------------                                              *
  2361*  CERT ISSUE DATE                                               *
  2362*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2363*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2364*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2365*  STATE CODE (CLIENT DEFINED)                                   *
  2366*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2367*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2368*  DEVIATION CODE                                                *
  2369*  ISSUE AGE                                                     *
  2370*  ORIGINAL BENEFIT AMOUNT                                       *
  2371*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2372*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2373*  BENEFIT KIND (LIFE OR A/H)                                    *
  2374*  A.P.R.                                                        *
  2375*  METHOD
  2376*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2377*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2378*  COMPANY I.D. (3 CHARACTER)                                    *
  2379*  BENEFIT CODE                                                  *
  2380*  BENEFIT OVERRIDE CODE                                         *
  2381*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2382*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2383*  JOINT INDICATOR (CSL ONLY)                                    *
  2384*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2385*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2386*                                                                *
  2387*  RETURNED FROM ELRATE                                          *
  2388*  --------------------                                          *
  2389*  CALCULATED PREMIUM                                            *
  2390*  PREMIUM RATE                                                  *
  2391*  MORTALITY CODE                                                *
  2392*  MAX ATTAINED AGE                                              *
  2393*  MAX AGE                                                       *
  2394*  MAX TERM                                                      *
  2395*  MAX MONTHLY BENEFIT                                           *
  2396*  MAX TOTAL BENIFIT                                             *
  2397*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2398*----------------------------------------------------------------*
  2399*  PASSED TO ELRFND                                              *
  2400*  ----------------                                              *
  2401*  CERT ISSUE DATE                                               *
  2402*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  45
* EL130.cbl
  2403*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2404*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2405*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2406*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2407*  STATE CODE (CLIENT DEFINED)                                   *
  2408*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2409*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2410*  DEVIATION CODE                                                *
  2411*  ISSUE AGE                                                     *
  2412*  ORIGINAL BENEFIT AMOUNT                                       *
  2413*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2414*  PROCESS TYPE (CANCEL)                                         *
  2415*  BENEFIT KIND (LIFE OR A/H)                                    *
  2416*  A.P.R.                                                        *
  2417*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2418*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2419*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2420*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2421*  COMPANY I.D. (3 CHARACTER)                                    *
  2422*  BENEFIT CODE                                                  *
  2423*  BENEFIT OVERRIDE CODE                                         *
  2424*                                                                *
  2425*  RETURNED FROM ELRFND                                          *
  2426*  --------------------                                          *
  2427*  CALCULATED REFUND                                             *
  2428*----------------------------------------------------------------*
  2429*  PASSED TO ELEARN                                              *
  2430*  ----------------                                              *
  2431*  CERT ISSUE DATE                                               *
  2432*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2433*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2434*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2435*  STATE CODE (CLIENT DEFINED)                                   *
  2436*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2437*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2438*  DEVIATION CODE                                                *
  2439*  ISSUE AGE                                                     *
  2440*  ORIGINAL BENEFIT AMOUNT                                       *
  2441*  BENEFIT KIND (LIFE OR A/H)                                    *
  2442*  A.P.R.                                                        *
  2443*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2444*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2445*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2446*  COMPANY I.D. (3 CHARACTER)                                    *
  2447*  BENEFIT CODE                                                  *
  2448*  BENEFIT OVERRIDE CODE                                         *
  2449*                                                                *
  2450*  RETURNED FROM ELEARN                                          *
  2451*  --------------------                                          *
  2452*  INDICATED  EARNINGS                                           *
  2453*----------------------------------------------------------------*
  2454*                 LENGTH = 450                                   *
  2455*                                                                *
  2456******************************************************************
  2457******************************************************************
  2458*                   C H A N G E   L O G
  2459*
  2460* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  46
* EL130.cbl
  2461*-----------------------------------------------------------------
  2462*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2463* EFFECTIVE    NUMBER
  2464*-----------------------------------------------------------------
  2465* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2466* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2467* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2468* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2469* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2470* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2471* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2472* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2473* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2474******************************************************************
  2475
  2476 01  CALCULATION-PASS-AREA.
  2477     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2478                                     COMP.
  2479
  2480     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2481       88  NO-CP-ERROR                             VALUE ZERO.
  2482       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2483                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2484       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2485       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2486       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2487       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2488       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2489       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2490       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2491       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2492       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2493       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2494       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2495       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2496       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2497       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2498       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2499       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2500       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2501
  2502     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2503       88  NO-CP-ERROR-2                           VALUE ZERO.
  2504***********************  INPUT AREAS ****************************
  2505
  2506     12  CP-CALCULATION-AREA.
  2507         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2508         16  CP-CERT-EFF-DT        PIC XX.
  2509         16  CP-VALUATION-DT       PIC XX.
  2510         16  CP-PAID-THRU-DT       PIC XX.
  2511         16  CP-BENEFIT-TYPE       PIC X.
  2512           88  CP-AH                               VALUE 'A' 'D'
  2513                                                   'I' 'U'.
  2514           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2515           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2516         16  CP-INCURRED-DT        PIC XX.
  2517         16  CP-REPORTED-DT        PIC XX.
  2518         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  47
* EL130.cbl
  2519         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2520         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2521                                     COMP-3.
  2522         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2523                                     COMP-3.
  2524         16  CP-CDT-METHOD         PIC X.
  2525           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2526           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2527           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2528         16  CP-CLAIM-TYPE         PIC X.
  2529           88  CP-AH-CLAIM                         VALUE 'A'.
  2530           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2531         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2532                                     COMP-3.
  2533         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2534                                     COMP-3.
  2535         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2536                                     COMP-3.
  2537         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2538                                     COMP-3.
  2539         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2540                                     COMP-3.
  2541         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2542                                     COMP-3.
  2543         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2544                                     COMP-3.
  2545         16  CP-REM-TERM-METHOD    PIC X.
  2546           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2547           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2548           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2549           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2550           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2551           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2552           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2553         16  CP-EARNING-METHOD     PIC X.
  2554           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2555           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2556           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2557           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2558           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2559           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2560           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2561           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2562           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2563           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2564           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2565           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2566           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2567           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2568         16  CP-PROCESS-TYPE       PIC X.
  2569           88  CP-CLAIM                            VALUE '1'.
  2570           88  CP-CANCEL                           VALUE '2'.
  2571           88  CP-ISSUE                            VALUE '3'.
  2572         16  CP-SPECIAL-CALC-CD    PIC X.
  2573           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2574           88  CP-1-MTH-INTEREST               VALUE ' '.
  2575           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2576           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  48
* EL130.cbl
  2577           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2578           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2579           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2580           88  CP-FARM-PLAN                    VALUE 'F'.
  2581           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2582           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2583           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2584           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2585           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2586           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2587           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2588           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2589           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2590           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2591                                                     'W' 'X'.
  2592           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2593           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2594           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2595           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2596           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2597           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2598           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2599           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2600           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2601           88  CP-CSL-METH-1                   VALUE '5'.
  2602           88  CP-CSL-METH-2                   VALUE '6'.
  2603           88  CP-CSL-METH-3                   VALUE '7'.
  2604           88  CP-CSL-METH-4                   VALUE '8'.
  2605
  2606         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2607                                     COMP-3.
  2608         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2609         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2610         16  CP-STATE              PIC XX          VALUE SPACE.
  2611         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2612         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2613           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2614               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2615         16  CP-R78-OPTION         PIC X.
  2616           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2617           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2618
  2619         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2620         16  CP-IBNR-RESERVE-SW    PIC X.
  2621         16  CP-CLAIM-STATUS       PIC X.
  2622         16  CP-RATE-FILE          PIC X.
  2623         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2624                                     COMP-3.
  2625
  2626         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2627         16  CP-AH-OVERRIDE-CODE   PIC X.
  2628
  2629         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2630                                     COMP-3.
  2631         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2632                                   PIC S9(5)V99 COMP-3.
  2633         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2634                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  49
* EL130.cbl
  2635         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2636                                     COMP-3.
  2637         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2638                                     COMP-3.
  2639         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2640                                  PIC S9(7)V99 COMP-3.
  2641
  2642         16  CP-PAID-FROM-DATE     PIC X(02).
  2643         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2644         16  CP-EXT-DAYS-CALC      PIC X.
  2645           88  CP-EXT-NO-CHG                   VALUE ' '.
  2646           88  CP-EXT-CHG-LF                   VALUE '1'.
  2647           88  CP-EXT-CHG-AH                   VALUE '2'.
  2648           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2649         16  CP-DOMICILE-STATE     PIC XX.
  2650         16  CP-CARRIER            PIC X.
  2651         16  CP-REIN-FLAG          PIC X.
  2652         16  CP-REM-TRM-CALC-OPTION PIC X.
  2653           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2654                      '2' '3' '4' '5'.
  2655           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2656           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2657           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2658           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2659           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2660           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2661           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2662           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2663         16  CP-SIG-SWITCH         PIC X.
  2664         16  CP-RATING-METHOD      PIC X.
  2665           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2666           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2667           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2668           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2669           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2670           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2671           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2672           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2673           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2674         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2675                                     COMP-3.
  2676         16  CP-BEN-CATEGORY       PIC X.
  2677         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2678         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2679                                   PIC S99V9(5) COMP-3.
  2680         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2681         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2682                                   PIC S99V9(5) COMP-3.
  2683         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2684         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2685         16  CP-EXPIRE-DT          PIC XX.
  2686         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2687         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2688         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2689         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2690         16  CP-DDF-SPEC-CALC      PIC X.
  2691             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2692             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  50
* EL130.cbl
  2693         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2694         16  CP-CANCEL-REASON      PIC X.
  2695         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2696         16  CP-PMT-MODE           PIC X.
  2697         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2698         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2699         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2700         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2701         16  FILLER                PIC X.
  2702
  2703***************    OUTPUT FROM ELRESV   ************************
  2704
  2705         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2706
  2707         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2708                                     COMP-3.
  2709         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2710                                     COMP-3.
  2711         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2712                                     COMP-3.
  2713         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2714                                     COMP-3.
  2715         16  FILLER                PIC X(09).
  2716***************    OUTPUT FROM ELRTRM   *************************
  2717
  2718         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2719                                     COMP-3.
  2720         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2721                                     COMP-3.
  2722         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2723                                     COMP-3.
  2724         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2725                                     COMP-3.
  2726         16  FILLER                PIC X(12).
  2727
  2728***************    OUTPUT FROM ELRAMT   *************************
  2729
  2730         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2731                                     COMP-3.
  2732         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2733                                     COMP-3.
  2734         16  FILLER                PIC X(12).
  2735
  2736***************    OUTPUT FROM ELRATE   *************************
  2737
  2738         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2739                                     COMP-3.
  2740         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2741                                     COMP-3.
  2742         16  CP-MORTALITY-CODE     PIC X(4).
  2743         16  CP-RATE-EDIT-FLAG     PIC X.
  2744             88  CP-RATES-NEED-APR                  VALUE '1'.
  2745         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2746                                     COMP-3.
  2747         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2748         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2749         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2750                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  51
* EL130.cbl
  2751         16  FILLER                PIC X(07).
  2752
  2753***************    OUTPUT FROM ELRFND   *************************
  2754
  2755         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2756                                     COMP-3.
  2757         16  CP-REFUND-TYPE-USED   PIC X.
  2758           88  CP-R-AS-R78                         VALUE '1'.
  2759           88  CP-R-AS-PRORATA                     VALUE '2'.
  2760           88  CP-R-AS-CALIF                       VALUE '3'.
  2761           88  CP-R-AS-TEXAS                       VALUE '4'.
  2762           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2763           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2764           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2765           88  CP-R-AS-MEAN                        VALUE '8'.
  2766           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2767           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2768           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2769           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2770           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2771           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2772         16  FILLER                PIC X(12).
  2773
  2774***************    OUTPUT FROM ELEARN   *************************
  2775
  2776         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2777                                     COMP-3.
  2778         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2779                                     COMP-3.
  2780         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2781                                     COMP-3.
  2782         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2783                                     COMP-3.
  2784         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2785                                     COMP-3.
  2786         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2787                                     COMP-3.
  2788         16  CP-EARNING-TYPE-USED  PIC X.
  2789           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2790           88  CP-E-AS-R78                         VALUE '1'.
  2791           88  CP-E-AS-PRORATA                     VALUE '2'.
  2792           88  CP-E-AS-TEXAS                       VALUE '4'.
  2793           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2794           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2795           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2796           88  CP-E-AS-MEAN                        VALUE '8'.
  2797           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2798         16  FILLER                PIC X(12).
  2799
  2800***************    OUTPUT FROM ELPMNT   *************************
  2801
  2802         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2803                                     COMP-3.
  2804         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2805                                     COMP-3.
  2806         16  FILLER                PIC X(12).
  2807
  2808***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  52
* EL130.cbl
  2809         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2810                                     COMP-3.
  2811         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2812                                     COMP-3.
  2813         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2814                                     COMP-3.
  2815         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2816                                     COMP-3.
  2817         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2818                                     COMP-3.
  2819         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2820                                     COMP-3.
  2821         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2822             88  OPEN-RATE-FILE                   VALUE 'O'.
  2823             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2824             88  IO-ERROR                         VALUE 'E'.
  2825
  2826         16  CP-FIRST-PAY-DATE     PIC XX.
  2827
  2828         16  CP-JOINT-INDICATOR    PIC X.
  2829
  2830         16  CP-RESERVE-REMAINING-TERM
  2831                                   PIC S9(4)V9    VALUE ZERO
  2832                                     COMP-3.
  2833
  2834         16  CP-INSURED-BIRTH-DT   PIC XX.
  2835
  2836         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2837                                     COMP-3.
  2838
  2839         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2840                                     COMP-3.
  2841
  2842         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2843                                     COMP-3.
  2844
  2845         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2846                                     COMP-3.
  2847
  2848         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2849                                     COMP-3.
  2850
  2851         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2852                                     COMP-3.
  2853
  2854         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2855                                     COMP-3.
  2856
  2857         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2858             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2859
  2860         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2861                                     COMP-3.
  2862         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2863                                     COMP-3.
  2864         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2865         16  FILLER                PIC X(15).
  2866******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  53
* EL130.cbl
  2868*    COPY ELCLOGOF.
  2869******************************************************************
  2870*                                                                *
  2871*                                                                *
  2872*                            ELCLOGOF.                           *
  2873*                            VMOD=2.001                          *
  2874*                                                                *
  2875*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2876*                                                                *
  2877******************************************************************
  2878 01  CLASIC-LOGOFF.
  2879     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2880     12  LOGOFF-TEXT.
  2881         16  FILLER          PIC X(5)    VALUE SPACES.
  2882         16  LOGOFF-MSG.
  2883             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2884             20  FILLER      PIC X       VALUE SPACES.
  2885             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2886         16  FILLER          PIC X(80)
  2887           VALUE '* YOU ARE NOW LOGGED OFF'.
  2888         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2889         16  FILLER          PIC X       VALUE QUOTE.
  2890         16  LOGOFF-SYS-MSG  PIC X(17)
  2891           VALUE 'S CLAS-IC SYSTEM '.
  2892     12  TEXT-MESSAGES.
  2893         16  UNACCESS-MSG    PIC X(29)
  2894             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2895         16  PGMIDERR-MSG    PIC X(17)
  2896             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  54
* EL130.cbl
  2898*    COPY ELCATTR.
  2899******************************************************************
  2900*                                                                *
  2901*                            ELCATTR.                            *
  2902*                            VMOD=2.001                          *
  2903*                                                                *
  2904*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2905*                                                                *
  2906*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2907*                                                                *
  2908*                   POS 1   P=PROTECTED                          *
  2909*                           U=UNPROTECTED                        *
  2910*                           S=ASKIP                              *
  2911*                   POS 2   A=ALPHA/NUMERIC                      *
  2912*                           N=NUMERIC                            *
  2913*                   POS 3   N=NORMAL                             *
  2914*                           B=BRIGHT                             *
  2915*                           D=DARK                               *
  2916*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2917*                           OF=MODIFIED DATA TAG OFF             *
  2918*                                                                *
  2919*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2920******************************************************************
  2921 01  ATTRIBUTE-LIST.
  2922     12  AL-PABOF            PIC X       VALUE 'Y'.
  2923     12  AL-PABON            PIC X       VALUE 'Z'.
  2924     12  AL-PADOF            PIC X       VALUE '%'.
  2925     12  AL-PADON            PIC X       VALUE '_'.
  2926     12  AL-PANOF            PIC X       VALUE '-'.
  2927     12  AL-PANON            PIC X       VALUE '/'.
  2928     12  AL-SABOF            PIC X       VALUE '8'.
  2929     12  AL-SABON            PIC X       VALUE '9'.
  2930     12  AL-SADOF            PIC X       VALUE '@'.
  2931     12  AL-SADON            PIC X       VALUE QUOTE.
  2932     12  AL-SANOF            PIC X       VALUE '0'.
  2933     12  AL-SANON            PIC X       VALUE '1'.
  2934     12  AL-UABOF            PIC X       VALUE 'H'.
  2935     12  AL-UABON            PIC X       VALUE 'I'.
  2936     12  AL-UADOF            PIC X       VALUE '<'.
  2937     12  AL-UADON            PIC X       VALUE '('.
  2938     12  AL-UANOF            PIC X       VALUE ' '.
  2939     12  AL-UANON            PIC X       VALUE 'A'.
  2940     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2941     12  AL-UNBON            PIC X       VALUE 'R'.
  2942     12  AL-UNDOF            PIC X       VALUE '*'.
  2943     12  AL-UNDON            PIC X       VALUE ')'.
  2944     12  AL-UNNOF            PIC X       VALUE '&'.
  2945     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  55
* EL130.cbl
  2947*    COPY ELCEMIB.
  2948******************************************************************
  2949*                                                                *
  2950*                                                                *
  2951*                            ELCEMIB.                            *
  2952*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2953*                            VMOD=2.005                          *
  2954*                                                                *
  2955*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2956*                                                                *
  2957******************************************************************
  2958 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2959     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2960     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2961     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2962     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2963     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2964     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2965     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2966     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2967     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2968         88  EMI-NO-ERRORS                    VALUE '1'.
  2969         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2970         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2971     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2972         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2973     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2974         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2975         88  EMI-AREA1-FULL                   VALUE '2'.
  2976     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2977         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2978         88  EMI-AREA2-FULL                   VALUE '2'.
  2979     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2980         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2981         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2982         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2983         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2984         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2985     12  EMI-ERROR-LINES.
  2986         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2987         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2988         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2989         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2990             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2991                 24  EMI-ERR-NUM         PIC X(4).
  2992                 24  EMI-FILLER          PIC X.
  2993                 24  EMI-SEV             PIC X.
  2994                 24  FILLER              PIC X.
  2995             20  FILLER                  PIC X(02).
  2996     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2997         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2998             20  EMI-ERROR-NUMBER    PIC X(4).
  2999             20  EMI-FILL            PIC X.
  3000             20  EMI-SEVERITY        PIC X.
  3001             20  FILLER              PIC X.
  3002             20  EMI-ERROR-TEXT.
  3003                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3004                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  56
* EL130.cbl
  3005     12  EMI-SEVERITY-SAVE           PIC X.
  3006         88  EMI-NOTE                    VALUE 'N'.
  3007         88  EMI-WARNING                 VALUE 'W'.
  3008         88  EMI-FORCABLE                VALUE 'F'.
  3009         88  EMI-FATAL                   VALUE 'X'.
  3010     12  EMI-MESSAGE-FLAG            PIC X.
  3011         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3012         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3013     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3014     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3015         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3016         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3017         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3018     12  emi-claim-no                pic x(7).
  3019     12  emi-claim-type              pic x(6).
  3020     12  FILLER                      PIC X(124)  VALUE SPACES.
  3021     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3022     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3023     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3024     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  57
* EL130.cbl
  3026*    COPY ELCJPFX.
  3027******************************************************************
  3028*                                                                *
  3029*                                                                *
  3030*                            ELCJPFX.                            *
  3031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3032*                            VMOD=2.002                          *
  3033*                                                                *
  3034*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3035*                                                                *
  3036*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3037*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3038*        ELCNTL - CONTROL FILE                                   *
  3039*        ELMSTR - CLAIM MASTERS                                  *
  3040*        ELTRLR - ACTIVITY TRAILERS                              *
  3041*        ELCHKQ - CHECK QUE                                      *
  3042******************************************************************
  3043 01  JOURNAL-RECORD.
  3044     12  jp-date                     pic s9(5) comp-3.
  3045     12  jp-time                     pic s9(7) comp-3.
  3046     12  JP-USER-ID                  PIC X(4).
  3047     12  JP-FILE-ID                  PIC X(8).
  3048     12  JP-PROGRAM-ID               PIC X(8).
  3049     12  JP-RECORD-TYPE              PIC X.
  3050         88 JP-ADD              VALUE 'A'.
  3051         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3052         88 JP-AFTER-CHANGE     VALUE 'C'.
  3053         88 JP-DELETE           VALUE 'D'.
  3054         88 JP-GENERIC-DELETE   VALUE 'G'.
  3055         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3056         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3057     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3058     12  JP-RECORD-AREA
  3059
  3060
  3061         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  58
* EL130.cbl
  3063*    COPY ELCAID.
  3064******************************************************************
  3065*                                                                *
  3066*                            ELCAID.                             *
  3067*                            VMOD=2.001                          *
  3068*                                                                *
  3069*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3070*                                                                *
  3071*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3072*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3073******************************************************************
  3074
  3075 01  DFHAID.
  3076   02  DFHNULL   PIC  X  VALUE  ' '.
  3077   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3078   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3079   02  DFHPEN    PIC  X  VALUE  '='.
  3080   02  DFHOPID   PIC  X  VALUE  'W'.
  3081   02  DFHPA1    PIC  X  VALUE  '%'.
  3082   02  DFHPA2    PIC  X  VALUE  '>'.
  3083   02  DFHPA3    PIC  X  VALUE  ','.
  3084   02  DFHPF1    PIC  X  VALUE  '1'.
  3085   02  DFHPF2    PIC  X  VALUE  '2'.
  3086   02  DFHPF3    PIC  X  VALUE  '3'.
  3087   02  DFHPF4    PIC  X  VALUE  '4'.
  3088   02  DFHPF5    PIC  X  VALUE  '5'.
  3089   02  DFHPF6    PIC  X  VALUE  '6'.
  3090   02  DFHPF7    PIC  X  VALUE  '7'.
  3091   02  DFHPF8    PIC  X  VALUE  '8'.
  3092   02  DFHPF9    PIC  X  VALUE  '9'.
  3093   02  DFHPF10   PIC  X  VALUE  ':'.
  3094   02  DFHPF11   PIC  X  VALUE  '#'.
  3095   02  DFHPF12   PIC  X  VALUE  '@'.
  3096   02  DFHPF13   PIC  X  VALUE  'A'.
  3097   02  DFHPF14   PIC  X  VALUE  'B'.
  3098   02  DFHPF15   PIC  X  VALUE  'C'.
  3099   02  DFHPF16   PIC  X  VALUE  'D'.
  3100   02  DFHPF17   PIC  X  VALUE  'E'.
  3101   02  DFHPF18   PIC  X  VALUE  'F'.
  3102   02  DFHPF19   PIC  X  VALUE  'G'.
  3103   02  DFHPF20   PIC  X  VALUE  'H'.
  3104   02  DFHPF21   PIC  X  VALUE  'I'.
  3105*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3106   02  DFHPF22   PIC  X  VALUE  '['.
  3107   02  DFHPF23   PIC  X  VALUE  '.'.
  3108   02  DFHPF24   PIC  X  VALUE  '<'.
  3109   02  DFHMSRE   PIC  X  VALUE  'X'.
  3110   02  DFHSTRF   PIC  X  VALUE  'h'.
  3111   02  DFHTRIG   PIC  X  VALUE  '"'.
  3112
  3113 01  FILLER    REDEFINES DFHAID.
  3114     12  FILLER              PIC X(8).
  3115     12  PF-VALUES           PIC X       OCCURS 12.
  3116
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  59
* EL130.cbl
  3118****************************************************************
  3119*
  3120* Copyright (c) 2007 by Clerity Solutions, Inc.
  3121* All rights reserved.
  3122*
  3123****************************************************************
  3124 01  DFHEIV.
  3125   02  DFHEIV0               PIC X(35).
  3126   02  DFHEIV1               PIC X(08).
  3127   02  DFHEIV2               PIC X(08).
  3128   02  DFHEIV3               PIC X(08).
  3129   02  DFHEIV4               PIC X(06).
  3130   02  DFHEIV5               PIC X(04).
  3131   02  DFHEIV6               PIC X(04).
  3132   02  DFHEIV7               PIC X(02).
  3133   02  DFHEIV8               PIC X(02).
  3134   02  DFHEIV9               PIC X(01).
  3135   02  DFHEIV10              PIC S9(7) COMP-3.
  3136   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3137   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3138   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3139   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3140   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3141   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3142   02  DFHEIV17              PIC X(04).
  3143   02  DFHEIV18              PIC X(04).
  3144   02  DFHEIV19              PIC X(04).
  3145   02  DFHEIV20              USAGE IS POINTER.
  3146   02  DFHEIV21              USAGE IS POINTER.
  3147   02  DFHEIV22              USAGE IS POINTER.
  3148   02  DFHEIV23              USAGE IS POINTER.
  3149   02  DFHEIV24              USAGE IS POINTER.
  3150   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3151   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3152   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3153   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3154   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3155   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3156   02  FILLER                PIC X(02).
  3157   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3158   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3159   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3160   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3161   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3162 LINKAGE  SECTION.
  3163*****************************************************************
  3164*                                                               *
  3165* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3166* All rights reserved.                                          *
  3167*                                                               *
  3168*****************************************************************
  3169 01  dfheiblk.
  3170     02  eibtime          pic s9(7) comp-3.
  3171     02  eibdate          pic s9(7) comp-3.
  3172     02  eibtrnid         pic x(4).
  3173     02  eibtaskn         pic s9(7) comp-3.
  3174     02  eibtrmid         pic x(4).
  3175     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  60
* EL130.cbl
  3176     02  eibcposn         pic s9(4) comp.
  3177     02  eibcalen         pic s9(4) comp.
  3178     02  eibaid           pic x(1).
  3179     02  eibfiller1       pic x(1).
  3180     02  eibfn            pic x(2).
  3181     02  eibfiller2       pic x(2).
  3182     02  eibrcode         pic x(6).
  3183     02  eibfiller3       pic x(2).
  3184     02  eibds            pic x(8).
  3185     02  eibreqid         pic x(8).
  3186     02  eibrsrce         pic x(8).
  3187     02  eibsync          pic x(1).
  3188     02  eibfree          pic x(1).
  3189     02  eibrecv          pic x(1).
  3190     02  eibsend          pic x(1).
  3191     02  eibatt           pic x(1).
  3192     02  eibeoc           pic x(1).
  3193     02  eibfmh           pic x(1).
  3194     02  eibcompl         pic x(1).
  3195     02  eibsig           pic x(1).
  3196     02  eibconf          pic x(1).
  3197     02  eiberr           pic x(1).
  3198     02  eibrldbk         pic x(1).
  3199     02  eiberrcd         pic x(4).
  3200     02  eibsynrb         pic x(1).
  3201     02  eibnodat         pic x(1).
  3202     02  eibfiller5       pic x(2).
  3203     02  eibresp          pic 9(09) comp.
  3204     02  eibresp2         pic 9(09) comp.
  3205     02  dfheigdj         pic s9(4) comp.
  3206     02  dfheigdk         pic s9(4) comp.
  3207
  3208 01  DFHCOMMAREA             PIC X(1024).
  3209
  3210*01 PARMLIST .
  3211*    02  FILLER              PIC S9(8)   COMP.
  3212*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3213*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3214*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3215*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3216*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3217*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3218*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3219*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3220*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  61
* EL130.cbl
  3222*    COPY ELCMSTR.
  3223******************************************************************
  3224*                                                                *
  3225*                            ELCMSTR.                            *
  3226*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3227*                            VMOD=2.012                          *
  3228*                                                                *
  3229*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3230*                                                                *
  3231*   FILE TYPE = VSAM,KSDS                                        *
  3232*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3233*                                                                *
  3234*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3235*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3236*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3237*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3238*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3239*                                                 RKP=75,LEN=21  *
  3240*                                                                *
  3241*   **** NOTE ****                                               *
  3242*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3243*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3244*                                                                *
  3245*   LOG = YES                                                    *
  3246*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3247******************************************************************
  3248*                   C H A N G E   L O G
  3249*
  3250* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3251*-----------------------------------------------------------------
  3252*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3253* EFFECTIVE    NUMBER
  3254*-----------------------------------------------------------------
  3255* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3256* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3257* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3258* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3259******************************************************************
  3260 01  CLAIM-MASTER.
  3261     12  CL-RECORD-ID                PIC XX.
  3262         88  VALID-CL-ID         VALUE 'CL'.
  3263
  3264     12  CL-CONTROL-PRIMARY.
  3265         16  CL-COMPANY-CD           PIC X.
  3266         16  CL-CARRIER              PIC X.
  3267         16  CL-CLAIM-NO             PIC X(7).
  3268         16  CL-CERT-NO.
  3269             20  CL-CERT-PRIME       PIC X(10).
  3270             20  CL-CERT-SFX         PIC X.
  3271
  3272     12  CL-CONTROL-BY-NAME.
  3273         16  CL-COMPANY-CD-A1        PIC X.
  3274         16  CL-INSURED-LAST-NAME    PIC X(15).
  3275         16  CL-INSURED-NAME.
  3276             20  CL-INSURED-1ST-NAME PIC X(12).
  3277             20  CL-INSURED-MID-INIT PIC X.
  3278
  3279     12  CL-CONTROL-BY-SSN.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  62
* EL130.cbl
  3280         16  CL-COMPANY-CD-A2        PIC X.
  3281         16  CL-SOC-SEC-NO.
  3282             20  CL-SSN-STATE        PIC XX.
  3283             20  CL-SSN-ACCOUNT      PIC X(6).
  3284             20  CL-SSN-LN3          PIC X(3).
  3285
  3286     12  CL-CONTROL-BY-CERT-NO.
  3287         16  CL-COMPANY-CD-A4        PIC X.
  3288         16  CL-CERT-NO-A4.
  3289             20  CL-CERT-A4-PRIME    PIC X(10).
  3290             20  CL-CERT-A4-SFX      PIC X.
  3291
  3292     12  CL-CONTROL-BY-CCN.
  3293         16  CL-COMPANY-CD-A5        PIC X.
  3294         16  CL-CCN-A5.
  3295             20  CL-CCN.
  3296                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3297                 24  CL-CCN-PRIME-A5 PIC X(12).
  3298             20  CL-CCN-FILLER-A5    PIC X(4).
  3299
  3300     12  CL-INSURED-PROFILE-DATA.
  3301         16  CL-INSURED-BIRTH-DT     PIC XX.
  3302         16  CL-INSURED-SEX-CD       PIC X.
  3303             88  INSURED-IS-MALE        VALUE 'M'.
  3304             88  INSURED-IS-FEMALE      VALUE 'F'.
  3305             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3306         16  CL-INSURED-OCC-CD       PIC X(6).
  3307         16  FILLER                  PIC X(5).
  3308
  3309     12  CL-PROCESSING-INFO.
  3310         16  CL-PROCESSOR-ID         PIC X(4).
  3311         16  CL-CLAIM-STATUS         PIC X.
  3312             88  CLAIM-IS-OPEN          VALUE 'O'.
  3313             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3314         16  CL-CLAIM-TYPE           PIC X.
  3315*            88  AH-CLAIM               VALUE 'A'.
  3316*            88  LIFE-CLAIM             VALUE 'L'.
  3317*            88  PROPERTY-CLAIM         VALUE 'P'.
  3318*            88  IUI-CLAIM              VALUE 'I'.
  3319*            88  GAP-CLAIM              VALUE 'G'.
  3320         16  CL-CLAIM-PREM-TYPE      PIC X.
  3321             88  SINGLE-PREMIUM         VALUE '1'.
  3322             88  O-B-COVERAGE           VALUE '2'.
  3323             88  OPEN-END-COVERAGE      VALUE '3'.
  3324         16  CL-INCURRED-DT          PIC XX.
  3325         16  CL-REPORTED-DT          PIC XX.
  3326         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3327         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3328         16  CL-LAST-PMT-DT          PIC XX.
  3329         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3330         16  CL-PAID-THRU-DT         PIC XX.
  3331         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3332         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3333         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3334         16  CL-PMT-CALC-METHOD      PIC X.
  3335             88  CL-360-DAY-YR          VALUE '1'.
  3336             88  CL-365-DAY-YR          VALUE '2'.
  3337             88  CL-FULL-MONTHS         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  63
* EL130.cbl
  3338         16  CL-CAUSE-CD             PIC X(6).
  3339
  3340         16  CL-PRIME-CERT-NO.
  3341             20  CL-PRIME-CERT-PRIME PIC X(10).
  3342             20  CL-PRIME-CERT-SFX   PIC X.
  3343
  3344         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3345             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3346             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3347
  3348         16  CL-MICROFILM-NO         PIC X(10).
  3349         16  FILLER REDEFINES CL-MICROFILM-NO.
  3350             20  CL-BENEFIT-PERIOD   PIC 99.
  3351             20  FILLER              PIC X(8).
  3352         16  CL-PROG-FORM-TYPE       PIC X.
  3353         16  CL-LAST-ADD-ON-DT       PIC XX.
  3354
  3355         16  CL-LAST-REOPEN-DT       PIC XX.
  3356         16  CL-LAST-CLOSE-DT        PIC XX.
  3357         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3358             88  FINAL-PAID             VALUE '1'.
  3359             88  CLAIM-DENIED           VALUE '2'.
  3360             88  AUTO-CLOSE             VALUE '3'.
  3361             88  MANUAL-CLOSE           VALUE '4'.
  3362             88  BENEFITS-CHANGED       VALUE 'C'.
  3363             88  SETUP-ERRORS           VALUE 'E'.
  3364         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3365         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3366         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3367             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3368         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3369         16  FILLER                  PIC X.
  3370
  3371     12  CL-CERTIFICATE-DATA.
  3372         16  CL-CERT-ORIGIN          PIC X.
  3373             88  CERT-WAS-ONLINE        VALUE '1'.
  3374             88  CERT-WAS-CREATED       VALUE '2'.
  3375             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3376         16  CL-CERT-KEY-DATA.
  3377             20  CL-CERT-CARRIER     PIC X.
  3378             20  CL-CERT-GROUPING    PIC X(6).
  3379             20  CL-CERT-STATE       PIC XX.
  3380             20  CL-CERT-ACCOUNT.
  3381                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3382                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3383             20  CL-CERT-EFF-DT      PIC XX.
  3384
  3385     12  CL-STATUS-CONTROLS.
  3386         16  CL-PRIORITY-CD          PIC X.
  3387             88  CONFIDENTIAL-DATA      VALUE '8'.
  3388             88  HIGHEST-PRIORITY       VALUE '9'.
  3389         16  CL-SUPV-ATTN-CD         PIC X.
  3390             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3391             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3392         16  CL-PURGED-DT            PIC XX.
  3393         16  CL-RESTORED-DT          PIC XX.
  3394         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3395         16  CL-NEXT-RESEND-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  64
* EL130.cbl
  3396         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3397         16  CL-CRITICAL-PERIOD      PIC 99.
  3398*        16  FILLER                  PIC XX.
  3399         16  CL-LAST-MAINT-DT        PIC XX.
  3400         16  CL-LAST-MAINT-USER      PIC X(4).
  3401         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3402         16  CL-LAST-MAINT-TYPE      PIC X.
  3403             88  CLAIM-SET-UP           VALUE ' '.
  3404             88  PAYMENT-MADE           VALUE '1'.
  3405             88  LETTER-SENT            VALUE '2'.
  3406             88  MASTER-WAS-ALTERED     VALUE '3'.
  3407             88  MASTER-WAS-RESTORED    VALUE '4'.
  3408             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3409             88  FILE-CONVERTED         VALUE '6'.
  3410             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3411             88  ERROR-CORRECTION       VALUE 'E'.
  3412         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3413         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3414         16  CL-BENEFICIARY          PIC X(10).
  3415         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3416         16  CL-DENIAL-TYPE          PIC X.
  3417             88  CL-TYPE-DENIAL          VALUE '1'.
  3418             88  CL-TYPE-RESCISSION      VALUE '2'.
  3419             88  CL-TYPE-REFORMATION     VALUE '3'.
  3420             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3421             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3422         16  filler                  pic x(5).
  3423*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3424*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3425*        16  CL-RTW-DT               PIC XX.
  3426
  3427     12  CL-TRAILER-CONTROLS.
  3428         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3429             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3430             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3431             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3432         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3433         16  FILLER                  PIC XX.
  3434         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3435         16  CL-ADDRESS-TRAILER-CNT.
  3436             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3437                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3438             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3439                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3440             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3441                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3442             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3443                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3444             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3445                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3446             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3447                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3448             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3449                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3450
  3451     12  CL-CV-REFERENCE-NO.
  3452         16  CL-CV-REFNO-PRIME       PIC X(18).
  3453         16  CL-CV-REFNO-SFX         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  65
* EL130.cbl
  3454
  3455     12  CL-FILE-LOCATION            PIC X(4).
  3456
  3457     12  CL-PROCESS-ERRORS.
  3458         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3459             88  NO-FATAL-ERRORS        VALUE ZERO.
  3460         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3461             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3462
  3463     12  CL-PRODUCT-CD               PIC X.
  3464
  3465     12  CL-CURRENT-KEY-DATA.
  3466         16  CL-CURRENT-CARRIER      PIC X.
  3467         16  CL-CURRENT-GROUPING     PIC X(6).
  3468         16  CL-CURRENT-STATE        PIC XX.
  3469         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3470
  3471     12  CL-ASSOCIATES               PIC X.
  3472         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3473         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3474         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3475         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3476
  3477     12  CL-ACTIVITY-CODE            PIC 99.
  3478     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3479     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3480
  3481     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3482     12  CL-LAG-REPORT-CODE          PIC 9.
  3483     12  CL-LOAN-TYPE                PIC XX.
  3484     12  CL-LEGAL-STATE              PIC XX.
  3485
  3486     12  CL-YESNOSW                  PIC X.
  3487     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3488         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3489         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3490         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3491     12  cl-insured-type             pic x.
  3492         88  cl-claim-on-primary         value 'P'.
  3493         88  cl-claim-on-co-borrower     value 'C'.
  3494     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  66
* EL130.cbl
  3496*    COPY ELCCNTL.
  3497******************************************************************
  3498*                                                                *
  3499*                                                                *
  3500*                            ELCCNTL.                            *
  3501*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3502*                            VMOD=2.059                          *
  3503*                                                                *
  3504*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3505*                                                                *
  3506*   FILE TYPE = VSAM,KSDS                                        *
  3507*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3508*                                                                *
  3509*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3510*       ALTERNATE INDEX = NONE                                   *
  3511*                                                                *
  3512*   LOG = YES                                                    *
  3513*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3514******************************************************************
  3515*                   C H A N G E   L O G
  3516*
  3517* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3518*-----------------------------------------------------------------
  3519*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3520* EFFECTIVE    NUMBER
  3521*-----------------------------------------------------------------
  3522* 082503                   PEMA  ADD BENEFIT GROUP
  3523* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3524* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3525* 092705    2005050300006  PEMA  ADD SPP LEASES
  3526* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3527* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3528* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3529* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3530* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3531* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3532* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3533* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3534* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3535* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3536******************************************************************
  3537*
  3538 01  CONTROL-FILE.
  3539     12  CF-RECORD-ID                       PIC XX.
  3540         88  VALID-CF-ID                        VALUE 'CF'.
  3541
  3542     12  CF-CONTROL-PRIMARY.
  3543         16  CF-COMPANY-ID                  PIC XXX.
  3544         16  CF-RECORD-TYPE                 PIC X.
  3545             88  CF-COMPANY-MASTER              VALUE '1'.
  3546             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3547             88  CF-STATE-MASTER                VALUE '3'.
  3548             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3549             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3550             88  CF-CARRIER-MASTER              VALUE '6'.
  3551             88  CF-MORTALITY-MASTER            VALUE '7'.
  3552             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3553             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  67
* EL130.cbl
  3554             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3555             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3556             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3557             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3558             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3559             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3560             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3561             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3562             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3563         16  CF-ACCESS-CD-GENL              PIC X(4).
  3564         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3565             20  CF-PROCESSOR               PIC X(4).
  3566         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3567             20  CF-STATE-CODE              PIC XX.
  3568             20  FILLER                     PIC XX.
  3569         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3570             20  FILLER                     PIC XX.
  3571             20  CF-HI-BEN-IN-REC           PIC XX.
  3572         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3573             20  FILLER                     PIC XXX.
  3574             20  CF-CARRIER-CNTL            PIC X.
  3575         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3576             20  FILLER                     PIC XX.
  3577             20  CF-HI-TYPE-IN-REC          PIC 99.
  3578         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3579             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3580                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3581             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3582             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3583         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3584             20  FILLER                     PIC X.
  3585             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3586         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3587             20  FILLER                     PIC XX.
  3588             20  CF-MORTGAGE-PLAN           PIC XX.
  3589         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3590
  3591     12  CF-LAST-MAINT-DT                   PIC XX.
  3592     12  CF-LAST-MAINT-BY                   PIC X(4).
  3593     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3594
  3595     12  CF-RECORD-BODY                     PIC X(728).
  3596
  3597
  3598****************************************************************
  3599*             COMPANY MASTER RECORD                            *
  3600****************************************************************
  3601
  3602     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3603         16  CF-COMPANY-ADDRESS.
  3604             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3605             20  CF-CL-IN-CARE-OF           PIC X(30).
  3606             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3607             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3608             20  CF-CL-CITY-STATE           PIC X(30).
  3609             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3610             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3611         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  68
* EL130.cbl
  3612         16  CF-COMPANY-PASSWORD            PIC X(8).
  3613         16  CF-SECURITY-OPTION             PIC X.
  3614             88  ALL-SECURITY                   VALUE '1'.
  3615             88  COMPANY-VERIFY                 VALUE '2'.
  3616             88  PROCESSOR-VERIFY               VALUE '3'.
  3617             88  NO-SECURITY                    VALUE '4'.
  3618             88  ALL-BUT-TERM                   VALUE '5'.
  3619         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3620             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3621         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3622             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3623         16  CF-INFORCE-LOCATION            PIC X.
  3624             88  CERTS-ARE-ONLINE               VALUE '1'.
  3625             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3626             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3627         16  CF-LOWER-CASE-LETTERS          PIC X.
  3628         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3629             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3630             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3631             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3632             88  CF-ACCNT-CNTL                  VALUE '3'.
  3633             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3634
  3635         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3636         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3637
  3638         16  CF-LGX-CREDIT-USER             PIC X.
  3639             88  CO-IS-NOT-USER                 VALUE 'N'.
  3640             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3641
  3642         16 CF-CREDIT-CALC-CODES.
  3643             20  CF-CR-REM-TERM-CALC PIC X.
  3644               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3645               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3646               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3647               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3648               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3649               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3650               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3651             20  CF-CR-R78-METHOD           PIC X.
  3652               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3653               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3654
  3655         16  CF-CLAIM-CONTROL-COUNTS.
  3656             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3657                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3658
  3659             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3660                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3661
  3662             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3663                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3664
  3665             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3666                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3667
  3668         16  CF-CURRENT-MONTH-END           PIC XX.
  3669
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  69
* EL130.cbl
  3670         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3671             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3672             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3673             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3674             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3675                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3676                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3677             20  CF-CO-PREM-REJECT-SW       PIC X.
  3678                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3679                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3680             20  CF-CO-REF-REJECT-SW        PIC X.
  3681                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3682                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3683
  3684         16  CF-CO-REPORTING-DT             PIC XX.
  3685         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3686         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3687           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3688           88  CF-CO-MONTH-END                  VALUE '1'.
  3689
  3690         16  CF-LGX-CLAIM-USER              PIC X.
  3691             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3692             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3693
  3694         16  CF-CREDIT-EDIT-CONTROLS.
  3695             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3696             20  CF-MIN-AGE                 PIC 99.
  3697             20  CF-DEFAULT-AGE             PIC 99.
  3698             20  CF-MIN-TERM                PIC S999      COMP-3.
  3699             20  CF-MAX-TERM                PIC S999      COMP-3.
  3700             20  CF-DEFAULT-SEX             PIC X.
  3701             20  CF-JOINT-AGE-INPUT         PIC X.
  3702                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3703             20  CF-BIRTH-DATE-INPUT        PIC X.
  3704                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3705             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3706                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3707                 88  CF-ZERO-CARRIER            VALUE '1'.
  3708                 88  CF-ZERO-GROUPING           VALUE '2'.
  3709                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3710             20  CF-EDIT-SW                 PIC X.
  3711                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3712             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3713             20  CF-CR-PR-METHOD            PIC X.
  3714               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3715               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3716             20  FILLER                     PIC X.
  3717
  3718         16  CF-CREDIT-MISC-CONTROLS.
  3719             20  CF-REIN-TABLE-SW           PIC X.
  3720                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3721             20  CF-COMP-TABLE-SW           PIC X.
  3722                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3723             20  CF-EXPERIENCE-RETENTION-AGE
  3724                                            PIC S9        COMP-3.
  3725             20  CF-CONVERSION-DT           PIC XX.
  3726             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3727             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  70
* EL130.cbl
  3728                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3729                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3730
  3731             20  CF-CR-CHECK-NO-CONTROL.
  3732                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3733                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3734                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3735                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3736                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3737                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3738
  3739                 24  CF-CR-CHECK-COUNT       REDEFINES
  3740                     CF-CR-CHECK-COUNTER      PIC X(4).
  3741
  3742                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3743                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3744
  3745                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3746                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3747                 24  CF-MAIL-PROCESSING       PIC X.
  3748                     88  MAIL-PROCESSING          VALUE 'Y'.
  3749
  3750         16  CF-MISC-SYSTEM-CONTROL.
  3751             20  CF-SYSTEM-C                 PIC X.
  3752                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3753             20  CF-SYSTEM-D                 PIC X.
  3754                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3755             20  CF-SOC-SEC-NO-SW            PIC X.
  3756                 88  SOC-SEC-NO-USED             VALUE '1'.
  3757             20  CF-MEMBER-NO-SW             PIC X.
  3758                 88  MEMBER-NO-USED              VALUE '1'.
  3759             20  CF-TAX-ID-NUMBER            PIC X(11).
  3760             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3761             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3762                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3763                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3764                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3765                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3766             20  CF-SYSTEM-E                 PIC X.
  3767                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3768
  3769         16  CF-LGX-LIFE-USER               PIC X.
  3770             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3771             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3772
  3773         16  CF-CR-MONTH-END-DT             PIC XX.
  3774
  3775         16  CF-FILE-MAINT-DATES.
  3776             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3777                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3778             20  CF-LAST-BATCH       REDEFINES
  3779                 CF-LAST-BATCH-NO               PIC X(4).
  3780             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3781             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3782             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3783             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3784             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3785             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  71
* EL130.cbl
  3786             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3787             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3788             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3789             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3790
  3791         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3792         16  FILLER                         PIC X.
  3793
  3794         16  CF-ALT-MORT-CODE               PIC X(4).
  3795         16  CF-MEMBER-CAPTION              PIC X(10).
  3796
  3797         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3798             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3799             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3800             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3801             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3802             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3803
  3804         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3805
  3806         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3807         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3808         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3809         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3810
  3811         16  CF-AH-OVERRIDE-L1              PIC X.
  3812         16  CF-AH-OVERRIDE-L2              PIC XX.
  3813         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3814         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3815
  3816         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3817         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3818
  3819         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3820         16  CF-AR-LAST-EL860-DT            PIC XX.
  3821         16  CF-MP-MONTH-END-DT             PIC XX.
  3822
  3823         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3824         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3825             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3826
  3827         16  CF-AR-MONTH-END-DT             PIC XX.
  3828
  3829         16  CF-CRDTCRD-USER                PIC X.
  3830             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3831             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3832
  3833         16  CF-CC-MONTH-END-DT             PIC XX.
  3834
  3835         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3836
  3837         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3838             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3839             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3840             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3841         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3842         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3843         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  72
* EL130.cbl
  3844         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3845             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3846             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3847         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3848         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3849         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3850             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3851         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3852
  3853         16  CF-CL-ZIP-CODE.
  3854             20  CF-CL-ZIP-PRIME.
  3855                 24  CF-CL-ZIP-1ST          PIC X.
  3856                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3857                 24  FILLER                 PIC X(4).
  3858             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3859         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3860             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3861             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3862             20  FILLER                     PIC XXX.
  3863
  3864         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3865         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3866         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3867         16  CF-CO-OPTION-START-DATE        PIC XX.
  3868         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3869           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3870                                                      '3' '4'.
  3871           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3872           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3873           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3874           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3875           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3876           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3877
  3878         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3879
  3880         16  CF-PAYMENT-APPROVAL-LEVELS.
  3881             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3882             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3883             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3884             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3885             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3886             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3887
  3888         16  CF-END-USER-REPORTING-USER     PIC X.
  3889             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3890             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3891
  3892         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3893             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3894             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3895
  3896         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3897
  3898         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3899         16  FILLER                         PIC X.
  3900
  3901         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  73
* EL130.cbl
  3902             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3903             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3904             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3905
  3906         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3907
  3908         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3909             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3910             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3911
  3912         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3913             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3914             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3915
  3916         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3917
  3918         16  CF-CO-ACH-ID-CODE              PIC  X.
  3919             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3920             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3921             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3922         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3923         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3924         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3925         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3926         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3927         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3928         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3929         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3930         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3931                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3932         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3933                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3934
  3935         16  CF-CO-OVER-SHORT.
  3936             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3937             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3938
  3939*         16  FILLER                         PIC X(102).
  3940         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3941             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3942             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3943
  3944         16  CF-AH-APPROVAL-DAYS.
  3945             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3946             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3947             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3948             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3949
  3950         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3951
  3952         16  CF-APPROV-LEV-5.
  3953             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3954             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3955             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3956
  3957         16  FILLER                         PIC X(68).
  3958****************************************************************
  3959*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  74
* EL130.cbl
  3960****************************************************************
  3961
  3962     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3963         16  CF-PROCESSOR-NAME              PIC X(30).
  3964         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3965         16  CF-PROCESSOR-TITLE             PIC X(26).
  3966         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3967                 88  MESSAGE-YES                VALUE 'Y'.
  3968                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3969
  3970*****************************************************
  3971****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3972****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3973****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3974****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3975*****************************************************
  3976
  3977         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3978             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3979             20  CF-APPLICATION-FORCE       PIC X.
  3980             20  CF-INDIVIDUAL-APP.
  3981                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3982                     28  CF-BROWSE-APP      PIC X.
  3983                     28  CF-UPDATE-APP      PIC X.
  3984
  3985         16  CF-CURRENT-TERM-ON             PIC X(4).
  3986         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3987             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3988             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3989             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3990             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3991             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3992             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3993             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3994         16  CF-PROCESSOR-CARRIER           PIC X.
  3995             88  NO-CARRIER-SECURITY            VALUE ' '.
  3996         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3997             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3998         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3999             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4000         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4001             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4002
  4003         16  CF-PROC-SYS-ACCESS-SW.
  4004             20  CF-PROC-CREDIT-CLAIMS-SW.
  4005                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4006                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4007                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4008                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4009             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4010                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4011                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4012             20  CF-PROC-LIFE-GNRLDGR-SW.
  4013                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4014                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4015                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4016                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4017             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  75
* EL130.cbl
  4018                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4019                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4020         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4021             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4022             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4023         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4024
  4025         16  CF-APPROVAL-LEVEL                  PIC X.
  4026             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4027             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4028             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4029             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4030             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4031
  4032         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4033
  4034         16  CF-LANGUAGE-TYPE                   PIC X.
  4035             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4036             88  CF-LANG-IS-FR                      VALUE 'F'.
  4037
  4038         16  CF-CSR-IND                         PIC X.
  4039         16  FILLER                             PIC X(239).
  4040
  4041****************************************************************
  4042*             PROCESSOR/REMINDERS RECORD                       *
  4043****************************************************************
  4044
  4045     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4046         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4047             20  CF-START-REMIND-DT         PIC XX.
  4048             20  CF-END-REMIND-DT           PIC XX.
  4049             20  CF-REMINDER-TEXT           PIC X(50).
  4050         16  FILLER                         PIC X(296).
  4051
  4052
  4053****************************************************************
  4054*             STATE MASTER RECORD                              *
  4055****************************************************************
  4056
  4057     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4058         16  CF-STATE-ABBREVIATION          PIC XX.
  4059         16  CF-STATE-NAME                  PIC X(25).
  4060         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4061         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4062             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4063             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4064             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4065             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4066                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4067                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4068             20  CF-ST-PREM-REJECT-SW       PIC X.
  4069                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4070                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4071             20  CF-ST-REF-REJECT-SW        PIC X.
  4072                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4073                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4074         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4075         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  76
* EL130.cbl
  4076         16  CF-ST-REFUND-RULES.
  4077             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4078             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4079             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4080         16  CF-ST-FST-PMT-EXTENSION.
  4081             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4082             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4083                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4084                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4085                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4086                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4087         16  CF-ST-STATE-CALL.
  4088             20  CF-ST-CALL-UNEARNED        PIC X.
  4089             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4090             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4091         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4092             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4093             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4094         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4095         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4096         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4097         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4098         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4099         16  FILLER                         PIC X.
  4100         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4101             20  CF-ST-BENEFIT-CD           PIC XX.
  4102             20  CF-ST-BENEFIT-KIND         PIC X.
  4103                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4104                 88  CF-ST-AH-KIND              VALUE 'A'.
  4105             20  CF-ST-REM-TERM-CALC        PIC X.
  4106                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4107                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4108                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4109                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4110                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4111                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4112                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4113                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4114
  4115             20  CF-ST-REFUND-CALC          PIC X.
  4116                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4117                 88  ST-REFD-BY-R78             VALUE '1'.
  4118                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4119                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4120                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4121                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4122                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4123                 88  ST-REFD-UTAH               VALUE '7'.
  4124                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4125                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4126                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4127
  4128             20  CF-ST-EARNING-CALC         PIC X.
  4129                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4130                 88  ST-EARN-BY-R78             VALUE '1'.
  4131                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4132                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4133                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  77
* EL130.cbl
  4134                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4135                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4136                 88  ST-EARN-MEAN               VALUE '8'.
  4137                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4138
  4139             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4140                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4141                 88  ST-OVRD-BY-R78             VALUE '1'.
  4142                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4143                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4144                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4145                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4146                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4147                 88  ST-OVRD-MEAN               VALUE '8'.
  4148                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4149             20  FILLER                     PIC X.
  4150
  4151         16  CF-ST-COMMISSION-CAPS.
  4152             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4153             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4154             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4155             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4156         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4157                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4158
  4159         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4160
  4161         16  CF-ST-STATUTORY-INTEREST.
  4162             20  CF-ST-STAT-DATE-FROM       PIC X.
  4163                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4164                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4165             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4166             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4167             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4168             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4169             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4170
  4171         16  CF-ST-OVER-SHORT.
  4172             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4173             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4174
  4175         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4176
  4177         16  CF-ST-RT-CALC                  PIC X.
  4178
  4179         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4180         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4181         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4182         16  CF-ST-RF-LR-CALC               PIC X.
  4183         16  CF-ST-RF-LL-CALC               PIC X.
  4184         16  CF-ST-RF-LN-CALC               PIC X.
  4185         16  CF-ST-RF-AH-CALC               PIC X.
  4186         16  CF-ST-RF-CP-CALC               PIC X.
  4187*        16  FILLER                         PIC X(206).
  4188*CIDMOD         16  FILLER                         PIC X(192).
  4189         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4190             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4191         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  78
* EL130.cbl
  4192         16  CF-ST-VFY-2ND-BENE             PIC X.
  4193         16  CF-ST-CAUSAL-STATE             PIC X.
  4194         16  FILLER                         PIC X(185).
  4195
  4196****************************************************************
  4197*             BENEFIT MASTER RECORD                            *
  4198****************************************************************
  4199
  4200     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4201         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4202             20  CF-BENEFIT-CODE            PIC XX.
  4203             20  CF-BENEFIT-NUMERIC  REDEFINES
  4204                 CF-BENEFIT-CODE            PIC XX.
  4205             20  CF-BENEFIT-ALPHA           PIC XXX.
  4206             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4207             20  CF-BENEFIT-COMMENT         PIC X(10).
  4208
  4209             20  CF-LF-COVERAGE-TYPE        PIC X.
  4210                 88  CF-REDUCING                VALUE 'R'.
  4211                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4212
  4213             20  CF-SPECIAL-CALC-CD         PIC X.
  4214                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4215                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4216                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4217                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4218                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4219                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4220                 88  CF-FARM-PLAN               VALUE 'F'.
  4221                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4222                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4223                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4224                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4225                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4226                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4227                 88  CF-PRUDENTIAL              VALUE 'P'.
  4228                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4229                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4230                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4231                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4232                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4233                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4234
  4235             20  CF-JOINT-INDICATOR         PIC X.
  4236                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4237
  4238*            20  FILLER                     PIC X(12).
  4239             20  cf-maximum-benefits        pic s999 comp-3.
  4240             20  FILLER                     PIC X(09).
  4241             20  CF-BENEFIT-CATEGORY        PIC X.
  4242             20  CF-LOAN-TYPE               PIC X(8).
  4243
  4244             20  CF-CO-REM-TERM-CALC        PIC X.
  4245                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4246                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4247                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4248                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4249                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  79
* EL130.cbl
  4250
  4251             20  CF-CO-EARNINGS-CALC        PIC X.
  4252                 88  CO-EARN-BY-R78             VALUE '1'.
  4253                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4254                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4255                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4256                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4257                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4258                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4259                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4260
  4261             20  CF-CO-REFUND-CALC          PIC X.
  4262                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4263                 88  CO-REFD-BY-R78             VALUE '1'.
  4264                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4265                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4266                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4267                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4268                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4269                 88  CO-REFD-MEAN               VALUE '8'.
  4270                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4271                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4272                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4273
  4274             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4275                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4276                 88  CO-OVRD-BY-R78             VALUE '1'.
  4277                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4278                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4279                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4280                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4281                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4282                 88  CO-OVRD-MEAN               VALUE '8'.
  4283                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4284
  4285             20  CF-CO-BEN-I-G-CD           PIC X.
  4286                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4287                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4288                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4289
  4290         16  FILLER                         PIC X(304).
  4291
  4292
  4293****************************************************************
  4294*             CARRIER MASTER RECORD                            *
  4295****************************************************************
  4296
  4297     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4298         16  CF-ADDRESS-DATA.
  4299             20  CF-MAIL-TO-NAME            PIC X(30).
  4300             20  CF-IN-CARE-OF              PIC X(30).
  4301             20  CF-ADDRESS-LINE-1          PIC X(30).
  4302             20  CF-ADDRESS-LINE-2          PIC X(30).
  4303             20  CF-CITY-STATE              PIC X(30).
  4304             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4305             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4306
  4307         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  80
* EL130.cbl
  4308             20  CF-CLAIM-NO-METHOD         PIC X.
  4309                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4310                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4311                 88  CLAIM-NO-SEQ               VALUE '3'.
  4312                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4313             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4314                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4315                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4316                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4317
  4318         16  CF-CHECK-NO-CONTROL.
  4319             20  CF-CHECK-NO-METHOD         PIC X.
  4320                 88  CHECK-NO-MANUAL            VALUE '1'.
  4321                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4322                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4323                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4324             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4325                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4326
  4327         16  CF-DOMICILE-STATE              PIC XX.
  4328
  4329         16  CF-EXPENSE-CONTROLS.
  4330             20  CF-EXPENSE-METHOD          PIC X.
  4331                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4332                 88  DOLLARS-PER-PMT            VALUE '2'.
  4333                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4334                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4335             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4336             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4337
  4338         16  CF-CORRESPONDENCE-CONTROL.
  4339             20  CF-LETTER-RESEND-OPT       PIC X.
  4340                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4341                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4342             20  FILLER                     PIC X(4).
  4343
  4344         16  CF-RESERVE-CONTROLS.
  4345             20  CF-MANUAL-SW               PIC X.
  4346                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4347             20  CF-FUTURE-SW               PIC X.
  4348                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4349             20  CF-PTC-SW                  PIC X.
  4350                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4351             20  CF-IBNR-SW                 PIC X.
  4352                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4353             20  CF-PTC-LF-SW               PIC X.
  4354                 88  CF-LF-PTC-USED             VALUE '1'.
  4355             20  CF-CDT-ACCESS-METHOD       PIC X.
  4356                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4357                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4358                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4359             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4360
  4361         16  CF-CLAIM-CALC-METHOD           PIC X.
  4362             88  360-PLUS-MONTHS                VALUE '1'.
  4363             88  365-PLUS-MONTHS                VALUE '2'.
  4364             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4365             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  81
* EL130.cbl
  4366             88  365-DAILY                      VALUE '5'.
  4367
  4368         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4369         16  FILLER                         PIC X(11).
  4370
  4371         16  CF-LIMIT-AMOUNTS.
  4372             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4373             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4374             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4375             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4376             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4377             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4378             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4379             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4380             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4381             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4382
  4383         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4384         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4385         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4386
  4387         16  CF-ZIP-CODE.
  4388             20  CF-ZIP-PRIME.
  4389                 24  CF-ZIP-1ST             PIC X.
  4390                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4391                 24  FILLER                 PIC X(4).
  4392             20  CF-ZIP-PLUS4               PIC X(4).
  4393         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4394             20  CF-CAN-POSTAL-1            PIC XXX.
  4395             20  CF-CAN-POSTAL-2            PIC XXX.
  4396             20  FILLER                     PIC XXX.
  4397
  4398         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4399         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4400         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4401
  4402         16  CF-RATING-SWITCH               PIC X.
  4403             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4404             88  CF-NO-RATING                   VALUE 'N'.
  4405
  4406         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4407
  4408         16  CF-CARRIER-OVER-SHORT.
  4409             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4410             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4411
  4412         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4413         16  CF-SECPAY-SWITCH               PIC X.
  4414             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4415             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4416         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4417         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4418         16  FILLER                         PIC X(444).
  4419*        16  FILLER                         PIC X(452).
  4420
  4421
  4422****************************************************************
  4423*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  82
* EL130.cbl
  4424****************************************************************
  4425
  4426     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4427         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4428                                INDEXED BY CF-MORT-NDX.
  4429             20  CF-MORT-TABLE              PIC X(5).
  4430             20  CF-MORT-TABLE-TYPE         PIC X.
  4431                 88  CF-MORT-JOINT              VALUE 'J'.
  4432                 88  CF-MORT-SINGLE             VALUE 'S'.
  4433                 88  CF-MORT-COMBINED           VALUE 'C'.
  4434                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4435                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4436             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4437             20  CF-MORT-AGE-METHOD         PIC XX.
  4438                 88  CF-AGE-LAST                VALUE 'AL'.
  4439                 88  CF-AGE-NEAR                VALUE 'AN'.
  4440             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4441             20  CF-MORT-ADJUSTMENT-DIRECTION
  4442                                            PIC X.
  4443                 88  CF-MINUS                   VALUE '-'.
  4444                 88  CF-PLUS                    VALUE '+'.
  4445             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4446             20  CF-MORT-JOINT-CODE         PIC X.
  4447                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4448             20  CF-MORT-PC-Q               PIC X.
  4449                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4450             20  CF-MORT-TABLE-CODE         PIC X(4).
  4451             20  CF-MORT-COMMENTS           PIC X(15).
  4452             20  FILLER                     PIC X(14).
  4453
  4454         16  FILLER                         PIC X(251).
  4455
  4456
  4457****************************************************************
  4458*             BUSSINESS TYPE MASTER RECORD                     *
  4459****************************************************************
  4460
  4461     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4462* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4463* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4464* AND RECORD 05 IS TYPES 81-99
  4465         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4466             20  CF-BUSINESS-TITLE          PIC  X(19).
  4467             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4468                                            PIC S9V9(4) COMP-3.
  4469             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4470             20  FILLER                     PIC  X.
  4471         16  FILLER                         PIC  X(248).
  4472
  4473
  4474****************************************************************
  4475*             TERMINAL MASTER RECORD                           *
  4476****************************************************************
  4477
  4478     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4479
  4480         16  CF-COMPANY-TERMINALS.
  4481             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  83
* EL130.cbl
  4482                                  PIC X(4).
  4483         16  FILLER               PIC X(248).
  4484
  4485
  4486****************************************************************
  4487*             LIFE EDIT MASTER RECORD                          *
  4488****************************************************************
  4489
  4490     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4491         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4492             20  CF-LIFE-CODE-IN            PIC XX.
  4493             20  CF-LIFE-CODE-OUT           PIC XX.
  4494         16  FILLER                         PIC X(248).
  4495
  4496
  4497****************************************************************
  4498*             AH EDIT MASTER RECORD                            *
  4499****************************************************************
  4500
  4501     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4502         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4503             20  CF-AH-CODE-IN              PIC XXX.
  4504             20  CF-AH-CODE-OUT             PIC XX.
  4505         16  FILLER                         PIC X(248).
  4506
  4507
  4508****************************************************************
  4509*             CREDIBILITY TABLES                               *
  4510****************************************************************
  4511
  4512     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4513         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4514                             INDEXED BY CF-CRDB-NDX.
  4515             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4516             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4517             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4518         16  FILLER                         PIC  X(332).
  4519
  4520
  4521****************************************************************
  4522*             REPORT CUSTOMIZATION RECORD                      *
  4523****************************************************************
  4524
  4525     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4526         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4527             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4528             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4529             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4530**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4531****       A T-TRANSFER.                                   ****
  4532             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4533
  4534         16  FILLER                         PIC XX.
  4535
  4536         16  CF-CARRIER-CNTL-OPT.
  4537             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4538                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4539                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  84
* EL130.cbl
  4540             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4541                                            PIC X.
  4542         16  CF-GROUP-CNTL-OPT.
  4543             20  CF-GROUP-OPT-SEQ           PIC 9.
  4544                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4545                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4546             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4547                                            PIC X(6).
  4548         16  CF-STATE-CNTL-OPT.
  4549             20  CF-STATE-OPT-SEQ           PIC 9.
  4550                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4551                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4552             20  CF-STATE-SELECT OCCURS 3 TIMES
  4553                                            PIC XX.
  4554         16  CF-ACCOUNT-CNTL-OPT.
  4555             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4556                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4557                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4558             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4559                                            PIC X(10).
  4560         16  CF-BUS-TYP-CNTL-OPT.
  4561             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4562                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4563                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4564             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4565                                            PIC XX.
  4566         16  CF-LF-TYP-CNTL-OPT.
  4567             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4568                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4569                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4570             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4571                                            PIC XX.
  4572         16  CF-AH-TYP-CNTL-OPT.
  4573             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4574                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4575                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4576             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4577                                            PIC XX.
  4578         16  CF-REPTCD1-CNTL-OPT.
  4579             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4580                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4581                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4582             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4583                                            PIC X(10).
  4584         16  CF-REPTCD2-CNTL-OPT.
  4585             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4586                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4587                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4588             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4589                                            PIC X(10).
  4590         16  CF-USER1-CNTL-OPT.
  4591             20  CF-USER1-OPT-SEQ           PIC 9.
  4592                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4593                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4594             20  CF-USER1-SELECT OCCURS 3 TIMES
  4595                                            PIC X(10).
  4596         16  CF-USER2-CNTL-OPT.
  4597             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  85
* EL130.cbl
  4598                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4599                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4600             20  CF-USER2-SELECT OCCURS 3 TIMES
  4601                                            PIC X(10).
  4602         16  CF-USER3-CNTL-OPT.
  4603             20  CF-USER3-OPT-SEQ           PIC 9.
  4604                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4605                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4606             20  CF-USER3-SELECT OCCURS 3 TIMES
  4607                                            PIC X(10).
  4608         16  CF-USER4-CNTL-OPT.
  4609             20  CF-USER4-OPT-SEQ           PIC 9.
  4610                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4611                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4612             20  CF-USER4-SELECT OCCURS 3 TIMES
  4613                                            PIC X(10).
  4614         16  CF-USER5-CNTL-OPT.
  4615             20  CF-USER5-OPT-SEQ           PIC 9.
  4616                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4617                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4618             20  CF-USER5-SELECT OCCURS 3 TIMES
  4619                                            PIC X(10).
  4620         16  CF-REINS-CNTL-OPT.
  4621             20  CF-REINS-OPT-SEQ           PIC 9.
  4622                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4623                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4624             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4625                 24  CF-REINS-PRIME         PIC XXX.
  4626                 24  CF-REINS-SUB           PIC XXX.
  4627
  4628         16  CF-AGENT-CNTL-OPT.
  4629             20  CF-AGENT-OPT-SEQ           PIC 9.
  4630                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4631                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4632             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4633                                            PIC X(10).
  4634
  4635         16  FILLER                         PIC X(43).
  4636
  4637         16  CF-LOSS-RATIO-SELECT.
  4638             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4639             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4640         16  CF-ENTRY-DATE-SELECT.
  4641             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4642             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4643         16  CF-EFFECTIVE-DATE-SELECT.
  4644             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4645             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4646
  4647         16  CF-EXCEPTION-LIST-IND          PIC X.
  4648             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4649
  4650         16  FILLER                         PIC X(318).
  4651
  4652****************************************************************
  4653*                  EXCEPTION REPORTING RECORD                  *
  4654****************************************************************
  4655
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  86
* EL130.cbl
  4656     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4657         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4658             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4659
  4660         16  CF-COMBINED-LIFE-AH-OPT.
  4661             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4662             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4663             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4664             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4665
  4666         16  CF-LIFE-OPT.
  4667             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4668             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4669             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4670             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4671             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4672             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4673             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4674             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4675             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4676             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4677
  4678         16  CF-AH-OPT.
  4679             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4680             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4681             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4682             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4683             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4684             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4685             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4686             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4687             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4688             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4689
  4690         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4691             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4692             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4693             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4694
  4695         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4696
  4697         16  FILLER                         PIC X(673).
  4698
  4699
  4700****************************************************************
  4701*             MORTGAGE SYSTEM PLAN RECORD                      *
  4702****************************************************************
  4703
  4704     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4705         16  CF-PLAN-TYPE                   PIC X.
  4706             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4707             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4708             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4709         16  CF-PLAN-ABBREV                 PIC XXX.
  4710         16  CF-PLAN-DESCRIPT               PIC X(10).
  4711         16  CF-PLAN-NOTES                  PIC X(20).
  4712         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4713         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  87
* EL130.cbl
  4714             20  CF-PLAN-TERM-DATA.
  4715                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4716                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4717             20  CF-PLAN-AGE-DATA.
  4718                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4719                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4720                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4721             20  CF-PLAN-BENEFIT-DATA.
  4722                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4723                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4724                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4725                                            PIC S9(7)V99  COMP-3.
  4726         16  CF-PLAN-POLICY-FORMS.
  4727             20  CF-POLICY-FORM             PIC X(12).
  4728             20  CF-MASTER-APPLICATION      PIC X(12).
  4729             20  CF-MASTER-POLICY           PIC X(12).
  4730         16  CF-PLAN-RATING.
  4731             20  CF-RATE-CODE               PIC X(5).
  4732             20  CF-SEX-RATING              PIC X.
  4733                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4734                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4735             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4736             20  CF-SUB-STD-TYPE            PIC X.
  4737                 88  CF-PCT-OF-PREM            VALUE '1'.
  4738                 88  CF-PCT-OF-BENE            VALUE '2'.
  4739         16  CF-PLAN-PREM-TOLERANCES.
  4740             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4741             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4742         16  CF-PLAN-PYMT-TOLERANCES.
  4743             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4744             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4745         16  CF-PLAN-MISC-DATA.
  4746             20  FILLER                     PIC X.
  4747             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4748             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4749         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4750         16  CF-PLAN-IND-GRP                PIC X.
  4751             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4752                                                     '1'.
  4753             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4754                                                     '2'.
  4755         16  CF-MIB-SEARCH-SW               PIC X.
  4756             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4757             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4758             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4759             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4760         16  CF-ALPHA-SEARCH-SW             PIC X.
  4761             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4762             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4763             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4764             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4765             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4766             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4767             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4768             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4769             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4770             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4771                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  88
* EL130.cbl
  4772                                                     'X' 'Y' 'Z'.
  4773         16  CF-EFF-DT-RULE-SW              PIC X.
  4774             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4775             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4776             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4777             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4778             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4779         16  FILLER                         PIC X(4).
  4780         16  CF-HEALTH-QUESTIONS            PIC X.
  4781             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4782         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4783         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4784         16  CF-PLAN-SNGL-JNT               PIC X.
  4785             88  CF-COMBINED-PLAN              VALUE 'C'.
  4786             88  CF-JNT-PLAN                   VALUE 'J'.
  4787             88  CF-SNGL-PLAN                  VALUE 'S'.
  4788         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4789         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4790         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4791         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4792         16  CF-RERATE-CNTL                 PIC  X.
  4793             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4794             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4795             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4796             88  CF-AUTO-RECALC                 VALUE '4'.
  4797         16  CF-BENEFIT-TYPE                PIC  X.
  4798             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4799             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4800         16  CF-POLICY-FEE                  PIC S999V99
  4801                                                    COMP-3.
  4802         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4803         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4804         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4805         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4806         16  FILLER                         PIC  X(32).
  4807         16  CF-TERMINATION-FORM            PIC  X(04).
  4808         16  FILLER                         PIC  X(08).
  4809         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4810                                                       COMP-3.
  4811         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4812         16  CF-ISSUE-LETTER                PIC  X(4).
  4813         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4814         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4815             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4816             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4817         16  CF-MP-REFUND-CALC              PIC X.
  4818             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4819             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4820             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4821             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4822             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4823             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4824             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4825             88  CF-MP-REFD-MEAN                VALUE '8'.
  4826         16  CF-ALT-RATE-CODE               PIC  X(5).
  4827
  4828
  4829         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  89
* EL130.cbl
  4830****************************************************************
  4831*             MORTGAGE COMPANY MASTER RECORD                   *
  4832****************************************************************
  4833
  4834     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4835         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4836         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4837             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4838             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4839             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4840             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4841             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4842
  4843         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4844         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4845         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4846         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4847         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4848
  4849         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4850             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4851         16  CF-MP-RECON-USE-IND            PIC X(1).
  4852             88  CF-MP-USE-RECON             VALUE 'Y'.
  4853         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4854             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4855         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4856             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4857             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4858         16  FILLER                         PIC X(1).
  4859         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4860             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4861         16  CF-MORTG-MIB-VERSION           PIC X.
  4862             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4863             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4864             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4865         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4866             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4867                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4868             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4869                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4870             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4871                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4872             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4873                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4874             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4875                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4876             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4877                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4878         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4879         16  FILLER                         PIC X(7).
  4880         16  CF-MORTG-DESTINATION-SYMBOL.
  4881             20  CF-MORTG-MIB-COMM          PIC X(5).
  4882             20  CF-MORTG-MIB-TERM          PIC X(5).
  4883         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4884             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4885         16  FILLER                         PIC X(03).
  4886         16  CF-MP-CHECK-NO-CONTROL.
  4887             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  90
* EL130.cbl
  4888                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4889                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4890                                                ' ' LOW-VALUES.
  4891                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4892                                               VALUE '3'.
  4893         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4894         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4895         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4896             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4897                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4898             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4899                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4900             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4901                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4902             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4903                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4904             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4905                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4906             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4907                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4908         16  CF-MORTG-BILLING-AREA.
  4909             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4910                                            PIC X.
  4911         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4912         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4913         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4914         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4915             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4916             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4917         16  FILLER                         PIC X.
  4918         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4919             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4920             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4921         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4922         16  FILLER                         PIC X(8).
  4923         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4924         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4925         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4926         16  CF-ACH-COMPANY-ID.
  4927             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4928                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4929                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4930                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4931             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4932         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4933             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4934         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4935             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4936             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4937         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4938         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4939         16  FILLER                         PIC X(536).
  4940
  4941****************************************************************
  4942*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4943****************************************************************
  4944
  4945     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  91
* EL130.cbl
  4946         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4947             20  CF-FEMALE-HEIGHT.
  4948                 24  CF-FEMALE-FT           PIC 99.
  4949                 24  CF-FEMALE-IN           PIC 99.
  4950             20  CF-FEMALE-MIN-WT           PIC 999.
  4951             20  CF-FEMALE-MAX-WT           PIC 999.
  4952         16  FILLER                         PIC X(428).
  4953
  4954     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4955         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4956             20  CF-MALE-HEIGHT.
  4957                 24  CF-MALE-FT             PIC 99.
  4958                 24  CF-MALE-IN             PIC 99.
  4959             20  CF-MALE-MIN-WT             PIC 999.
  4960             20  CF-MALE-MAX-WT             PIC 999.
  4961         16  FILLER                         PIC X(428).
  4962******************************************************************
  4963*             AUTOMATIC ACTIVITY RECORD                          *
  4964******************************************************************
  4965     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4966         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4967             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4968             20  CF-SYS-LETTER-ID           PIC X(04).
  4969             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4970             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4971             20  CF-SYS-RESET-SW            PIC X(01).
  4972             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4973             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4974
  4975         16  FILLER                         PIC X(50).
  4976
  4977         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4978             20  CF-USER-ACTIVE-SW          PIC X(01).
  4979             20  CF-USER-LETTER-ID          PIC X(04).
  4980             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4981             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4982             20  CF-USER-RESET-SW           PIC X(01).
  4983             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4984             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4985             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4986
  4987         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  92
* EL130.cbl
  4989*    COPY ELCCERT.
  4990******************************************************************
  4991*                                                                *
  4992*                            ELCCERT.                            *
  4993*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4994*                            VMOD=2.013                          *
  4995*                                                                *
  4996*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4997*                                                                *
  4998*   FILE TYPE = VSAM,KSDS                                        *
  4999*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5000*                                                                *
  5001*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5002*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5003*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5004*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5005*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5006*                                                                *
  5007*   LOG = YES                                                    *
  5008*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5009******************************************************************
  5010*                   C H A N G E   L O G
  5011*
  5012* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5013*-----------------------------------------------------------------
  5014*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5015* EFFECTIVE    NUMBER
  5016*-----------------------------------------------------------------
  5017* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5018* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5019* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5020* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5021* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5022* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5023* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5024* 032612  CR2011110200001  PEMA  AHL CHANGES
  5025******************************************************************
  5026
  5027 01  CERTIFICATE-MASTER.
  5028     12  CM-RECORD-ID                      PIC XX.
  5029         88  VALID-CM-ID                      VALUE 'CM'.
  5030
  5031     12  CM-CONTROL-PRIMARY.
  5032         16  CM-COMPANY-CD                 PIC X.
  5033         16  CM-CARRIER                    PIC X.
  5034         16  CM-GROUPING.
  5035             20  CM-GROUPING-PREFIX        PIC X(3).
  5036             20  CM-GROUPING-PRIME         PIC X(3).
  5037         16  CM-STATE                      PIC XX.
  5038         16  CM-ACCOUNT.
  5039             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5040             20  CM-ACCOUNT-PRIME          PIC X(6).
  5041         16  CM-CERT-EFF-DT                PIC XX.
  5042         16  CM-CERT-NO.
  5043             20  CM-CERT-PRIME             PIC X(10).
  5044             20  CM-CERT-SFX               PIC X.
  5045
  5046     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  93
* EL130.cbl
  5047         16  CM-COMPANY-CD-A1              PIC X.
  5048         16  CM-INSURED-LAST-NAME          PIC X(15).
  5049         16  CM-INSURED-INITIALS.
  5050             20  CM-INSURED-INITIAL1       PIC X.
  5051             20  CM-INSURED-INITIAL2       PIC X.
  5052
  5053     12  CM-CONTROL-BY-SSN.
  5054         16  CM-COMPANY-CD-A2              PIC X.
  5055         16  CM-SOC-SEC-NO.
  5056             20  CM-SSN-STATE              PIC XX.
  5057             20  CM-SSN-ACCOUNT            PIC X(6).
  5058             20  CM-SSN-LN3.
  5059                 25  CM-INSURED-INITIALS-A2.
  5060                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5061                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5062                 25 CM-PART-LAST-NAME-A2         PIC X.
  5063
  5064     12  CM-CONTROL-BY-CERT-NO.
  5065         16  CM-COMPANY-CD-A4              PIC X.
  5066         16  CM-CERT-NO-A4                 PIC X(11).
  5067
  5068     12  CM-CONTROL-BY-MEMB.
  5069         16  CM-COMPANY-CD-A5              PIC X.
  5070         16  CM-MEMBER-NO.
  5071             20  CM-MEMB-STATE             PIC XX.
  5072             20  CM-MEMB-ACCOUNT           PIC X(6).
  5073             20  CM-MEMB-LN4.
  5074                 25  CM-INSURED-INITIALS-A5.
  5075                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5076                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5077                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5078
  5079     12  CM-INSURED-PROFILE-DATA.
  5080         16  CM-INSURED-FIRST-NAME.
  5081             20  CM-INSURED-1ST-INIT       PIC X.
  5082             20  FILLER                    PIC X(9).
  5083         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5084         16  CM-INSURED-SEX                PIC X.
  5085             88  CM-SEX-MALE                  VALUE 'M'.
  5086             88  CM-SEX-FEMAL                 VALUE 'F'.
  5087         16  CM-INSURED-JOINT-AGE          PIC 99.
  5088         16  CM-JOINT-INSURED-NAME.
  5089             20  CM-JT-LAST-NAME           PIC X(15).
  5090             20  CM-JT-FIRST-NAME.
  5091                 24  CM-JT-1ST-INIT        PIC X.
  5092                 24  FILLER                PIC X(9).
  5093             20  CM-JT-INITIAL             PIC X.
  5094
  5095     12  CM-LIFE-DATA.
  5096         16  CM-LF-BENEFIT-CD              PIC XX.
  5097         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5098         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5099         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5100         16  CM-LF-DEV-CODE                PIC XXX.
  5101         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5102         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5103         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5104         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  94
* EL130.cbl
  5105         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5106         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5107         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5108         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5109         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5110         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5111         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5112         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5113         16  FILLER                        PIC XX.
  5114
  5115     12  CM-AH-DATA.
  5116         16  CM-AH-BENEFIT-CD              PIC XX.
  5117         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5118         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5119         16  CM-AH-DEV-CODE                PIC XXX.
  5120         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5121         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5122         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5123         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5124         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5125         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5126         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5127         16  CM-AH-PAID-THRU-DT            PIC XX.
  5128             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5129         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5130         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5131         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5132         16  FILLER                        PIC X.
  5133
  5134     12  CM-LOAN-INFORMATION.
  5135         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5136         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5137                                           PIC S9(5)V99  COMP-3.
  5138         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5139         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5140         16  CM-PAY-FREQUENCY              PIC S99.
  5141         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5142         16  CM-RATE-CLASS                 PIC XX.
  5143         16  CM-BENEFICIARY                PIC X(25).
  5144         16  CM-POLICY-FORM-NO             PIC X(12).
  5145         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5146         16  CM-LAST-ADD-ON-DT             PIC XX.
  5147         16  CM-DEDUCTIBLE-AMOUNTS.
  5148             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5149             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5150         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5151             20  CM-RESIDENT-STATE         PIC XX.
  5152             20  CM-RATE-CODE              PIC X(4).
  5153             20  FILLER                    PIC XX.
  5154         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5155             20  CM-LOAN-OFFICER           PIC X(5).
  5156             20  FILLER                    PIC XXX.
  5157         16  CM-CSR-CODE                   PIC XXX.
  5158         16  CM-UNDERWRITING-CODE          PIC X.
  5159             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5160         16  CM-POST-CARD-IND              PIC X.
  5161         16  CM-NH-INTERFACE-SW            PIC X.
  5162         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  95
* EL130.cbl
  5163             88  CM-SING-PRM                  VALUE '1'.
  5164             88  CM-O-B-COVERAGE              VALUE '2'.
  5165             88  CM-OPEN-END                  VALUE '3'.
  5166         16  CM-IND-GRP-TYPE               PIC X.
  5167             88  CM-INDIVIDUAL                VALUE 'I'.
  5168             88  CM-GROUP                     VALUE 'G'.
  5169         16  CM-SKIP-CODE                  PIC X.
  5170             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5171             88  SKIP-JULY                    VALUE '1'.
  5172             88  SKIP-AUGUST                  VALUE '2'.
  5173             88  SKIP-SEPTEMBER               VALUE '3'.
  5174             88  SKIP-JULY-AUG                VALUE '4'.
  5175             88  SKIP-AUG-SEPT                VALUE '5'.
  5176             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5177             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5178             88  SKIP-JUNE                    VALUE '8'.
  5179             88  SKIP-JUNE-JULY               VALUE '9'.
  5180             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5181             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5182         16  CM-PAYMENT-MODE               PIC X.
  5183             88  PAY-MONTHLY                  VALUE SPACE.
  5184             88  PAY-WEEKLY                   VALUE '1'.
  5185             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5186             88  PAY-BI-WEEKLY                VALUE '3'.
  5187             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5188         16  CM-LOAN-NUMBER                PIC X(8).
  5189         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5190         16  CM-OLD-LOF                    PIC XXX.
  5191*        16  CM-LOAN-OFFICER               PIC XXX.
  5192         16  CM-REIN-TABLE                 PIC XXX.
  5193         16  CM-SPECIAL-REIN-CODE          PIC X.
  5194         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5195         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5196         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5197
  5198     12  CM-STATUS-DATA.
  5199         16  CM-ENTRY-STATUS               PIC X.
  5200         16  CM-ENTRY-DT                   PIC XX.
  5201
  5202         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5203         16  CM-LF-CANCEL-DT               PIC XX.
  5204         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5205
  5206         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5207         16  CM-LF-DEATH-DT                PIC XX.
  5208         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5209
  5210         16  CM-LF-CURRENT-STATUS          PIC X.
  5211             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5212                                                'M' '4' '5' '9'.
  5213             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5214             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5215             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5216             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5217             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5218             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5219             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5220             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  96
* EL130.cbl
  5221             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5222             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5223             88  CM-LF-DECLINED               VALUE 'D'.
  5224             88  CM-LF-VOIDED                 VALUE 'V'.
  5225
  5226         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5227         16  CM-AH-CANCEL-DT               PIC XX.
  5228         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5229
  5230         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5231         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5232         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5233
  5234         16  CM-AH-CURRENT-STATUS          PIC X.
  5235             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5236                                                'M' '4' '5' '9'.
  5237             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5238             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5239             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5240             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5241             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5242             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5243             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5244             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5245             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5246             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5247             88  CM-AH-DECLINED               VALUE 'D'.
  5248             88  CM-AH-VOIDED                 VALUE 'V'.
  5249
  5250         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5251             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5252             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5253             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5254         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5255
  5256         16  CM-ENTRY-BATCH                PIC X(6).
  5257         16  CM-LF-EXIT-BATCH              PIC X(6).
  5258         16  CM-AH-EXIT-BATCH              PIC X(6).
  5259         16  CM-LAST-MONTH-END             PIC XX.
  5260
  5261     12  CM-NOTE-SW                        PIC X.
  5262         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5263         88  CERT-NOTES-PRESENT               VALUE '1'.
  5264         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5265         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5266         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5267         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5268         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5269         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5270     12  CM-COMP-EXCP-SW                   PIC X.
  5271         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5272         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5273     12  CM-INSURED-ADDRESS-SW             PIC X.
  5274         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5275         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5276
  5277*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5278     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  97
* EL130.cbl
  5279     12  FILLER                            PIC X.
  5280
  5281*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5282     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5283     12  FILLER                            PIC X.
  5284*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5285     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5286
  5287     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5288         88  CERT-ADDED-BATCH                 VALUE ' '.
  5289         88  CERT-ADDED-ONLINE                VALUE '1'.
  5290         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5291         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5292         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5293     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5294         88  CERT-AS-LOADED                   VALUE ' '.
  5295         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5296         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5297         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5298         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5299         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5300         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5301         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5302
  5303     12  CM-ACCOUNT-COMM-PCTS.
  5304         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5305         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5306
  5307     12  CM-USER-FIELD                     PIC X.
  5308     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5309     12  CM-CLP-STATE                      PIC XX.
  5310     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5311     12  CM-USER-RESERVED                  PIC XXX.
  5312     12  FILLER REDEFINES CM-USER-RESERVED.
  5313         16  CM-AH-CLASS-CD                PIC XX.
  5314         16  F                             PIC X.
  5315******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  98
* EL130.cbl
  5317*    COPY ERCACCT.
  5318******************************************************************
  5319*                                                                *
  5320*                                                                *
  5321*                            ERCACCT                             *
  5322*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5323*                            VMOD=2.031                          *
  5324*                                                                *
  5325*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5326*                                                                *
  5327*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5328*   VSAM ACCOUNT MASTER FILES.                                   *
  5329*                                                                *
  5330*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5331*                                                                *
  5332*   FILE TYPE = VSAM,KSDS                                        *
  5333*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5334*                                                                *
  5335*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5336*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5337*                                                                *
  5338*   LOG = NO                                                     *
  5339*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5340*                                                                *
  5341*                                                                *
  5342******************************************************************
  5343*                   C H A N G E   L O G
  5344*
  5345* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5346*-----------------------------------------------------------------
  5347*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5348* EFFECTIVE    NUMBER
  5349*-----------------------------------------------------------------
  5350* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5351* 092705    2005050300006  PEMA  ADD SPP LEASES
  5352* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5353* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5354* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5355* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5356* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5357******************************************************************
  5358
  5359 01  ACCOUNT-MASTER.
  5360     12  AM-RECORD-ID                      PIC XX.
  5361         88  VALID-AM-ID                      VALUE 'AM'.
  5362
  5363     12  AM-CONTROL-PRIMARY.
  5364         16  AM-COMPANY-CD                 PIC X.
  5365         16  AM-MSTR-CNTRL.
  5366             20  AM-CONTROL-A.
  5367                 24  AM-CARRIER            PIC X.
  5368                 24  AM-GROUPING.
  5369                     28 AM-GROUPING-PREFIX PIC XXX.
  5370                     28 AM-GROUPING-PRIME  PIC XXX.
  5371                 24  AM-STATE              PIC XX.
  5372                 24  AM-ACCOUNT.
  5373                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5374                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page  99
* EL130.cbl
  5375             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5376                                           PIC X(19).
  5377             20  AM-CNTRL-B.
  5378                 24  AM-EXPIRATION-DT      PIC XX.
  5379                 24  FILLER                PIC X(4).
  5380             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5381                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5382
  5383     12  AM-CONTROL-BY-VAR-GRP.
  5384         16  AM-COMPANY-CD-A1              PIC X.
  5385         16  AM-VG-CARRIER                 PIC X.
  5386         16  AM-VG-GROUPING                PIC X(6).
  5387         16  AM-VG-STATE                   PIC XX.
  5388         16  AM-VG-ACCOUNT                 PIC X(10).
  5389         16  AM-VG-DATE.
  5390             20  AM-VG-EXPIRATION-DT       PIC XX.
  5391             20  FILLER                    PIC X(4).
  5392         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5393                                           PIC 9(11)      COMP-3.
  5394     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5395         16  FILLER                        PIC X(10).
  5396         16  AM-VG-KEY3.
  5397             20  AM-VG3-ACCOUNT            PIC X(10).
  5398             20  AM-VG3-EXP-DT             PIC XX.
  5399         16  FILLER                        PIC X(4).
  5400     12  AM-MAINT-INFORMATION.
  5401         16  AM-LAST-MAINT-DT              PIC XX.
  5402         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5403         16  AM-LAST-MAINT-USER            PIC X(4).
  5404         16  FILLER                        PIC XX.
  5405
  5406     12  AM-EFFECTIVE-DT                   PIC XX.
  5407     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5408
  5409     12  AM-PREV-DATES  COMP-3.
  5410         16  AM-PREV-EXP-DT                PIC 9(11).
  5411         16  AM-PREV-EFF-DT                PIC 9(11).
  5412
  5413     12  AM-REPORT-CODE-1                  PIC X(10).
  5414     12  AM-REPORT-CODE-2                  PIC X(10).
  5415
  5416     12  AM-CITY-CODE                      PIC X(4).
  5417     12  AM-COUNTY-PARISH                  PIC X(6).
  5418
  5419     12  AM-NAME                           PIC X(30).
  5420     12  AM-PERSON                         PIC X(30).
  5421     12  AM-ADDRS                          PIC X(30).
  5422     12  AM-CITY.
  5423         16  AM-ADDR-CITY                  PIC X(28).
  5424         16  AM-ADDR-STATE                 PIC XX.
  5425     12  AM-ZIP.
  5426         16  AM-ZIP-PRIME.
  5427             20  AM-ZIP-PRI-1ST            PIC X.
  5428                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5429             20  FILLER                    PIC X(4).
  5430         16  AM-ZIP-PLUS4                  PIC X(4).
  5431     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5432         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 100
* EL130.cbl
  5433         16  AM-CAN-POSTAL-2               PIC XXX.
  5434         16  FILLER                        PIC XXX.
  5435     12  AM-TEL-NO.
  5436         16  AM-AREA-CODE                  PIC 999.
  5437         16  AM-TEL-PRE                    PIC 999.
  5438         16  AM-TEL-NBR                    PIC 9(4).
  5439     12  AM-TEL-LOC                        PIC X.
  5440         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5441         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5442
  5443     12  AM-COMM-STRUCTURE.
  5444         16  AM-DEFN-1.
  5445             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5446                 24  AM-AGT.
  5447                     28  AM-AGT-PREFIX     PIC X(4).
  5448                     28  AM-AGT-PRIME      PIC X(6).
  5449                 24  AM-COM-TYP            PIC X.
  5450                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5451                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5452                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5453                 24  AM-RECALC-LV-INDIC    PIC X.
  5454                 24  AM-RETRO-LV-INDIC     PIC X.
  5455                 24  AM-GL-CODES           PIC X.
  5456                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5457                 24  FILLER                PIC X(01).
  5458         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5459             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5460                 24  FILLER                PIC X(11).
  5461                 24  AM-L-COMA             PIC XXX.
  5462                 24  AM-J-COMA             PIC XXX.
  5463                 24  AM-A-COMA             PIC XXX.
  5464                 24  FILLER                PIC X(6).
  5465
  5466     12  AM-COMM-CHANGE-STATUS             PIC X.
  5467         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5468
  5469     12  AM-CSR-CODE                       PIC X(4).
  5470
  5471     12  AM-BILLING-STATUS                 PIC X.
  5472         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5473         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5474     12  AM-AUTO-REFUND-SW                 PIC X.
  5475         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5476         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5477     12  AM-GPCD                           PIC 99.
  5478     12  AM-IG                             PIC X.
  5479         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5480         88  AM-HAS-GROUP                     VALUE '2'.
  5481     12  AM-STATUS                         PIC X.
  5482         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5483         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5484         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5485         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5486         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5487         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5488     12  AM-REMIT-TO                       PIC 99.
  5489     12  AM-ID-NO                          PIC X(11).
  5490
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 101
* EL130.cbl
  5491     12  AM-CAL-TABLE                      PIC XX.
  5492     12  AM-LF-DEVIATION                   PIC XXX.
  5493     12  AM-AH-DEVIATION                   PIC XXX.
  5494     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5495     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5496     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5497     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5498     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5499     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5500
  5501     12  AM-USER-FIELDS.
  5502         16  AM-FLD-1                      PIC XX.
  5503         16  AM-FLD-2                      PIC XX.
  5504         16  AM-FLD-3                      PIC XX.
  5505         16  AM-FLD-4                      PIC XX.
  5506         16  AM-FLD-5                      PIC XX.
  5507
  5508     12  AM-1ST-PROD-DATE.
  5509         16  AM-1ST-PROD-YR                PIC XX.
  5510         16  AM-1ST-PROD-MO                PIC XX.
  5511         16  AM-1ST-PROD-DA                PIC XX.
  5512     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5513     12  AM-CERTS-PURGED-DATE.
  5514         16  AM-PUR-YR                     PIC XX.
  5515         16  AM-PUR-MO                     PIC XX.
  5516         16  AM-PUR-DA                     PIC XX.
  5517     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5518     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5519     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5520     12  AM-INACTIVE-DATE.
  5521         16  AM-INA-MO                     PIC 99.
  5522         16  AM-INA-DA                     PIC 99.
  5523         16  AM-INA-YR                     PIC 99.
  5524     12  AM-AR-HI-CERT-DATE                PIC XX.
  5525
  5526     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5527     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5528
  5529     12  AM-OB-PAYMENT-MODE                PIC X.
  5530         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5531         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5532         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5533         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5534
  5535     12  AM-AH-ONLY-INDICATOR              PIC X.
  5536         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5537         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5538
  5539     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5540
  5541     12  AM-OVER-SHORT.
  5542         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5543         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5544
  5545     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5546     12  AM-DCC-CLP-STATE                  PIC XX.
  5547
  5548     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 102
* EL130.cbl
  5549     12  AM-RECALC-REIN                    PIC X.
  5550
  5551     12  AM-REI-TABLE                      PIC XXX.
  5552     12  AM-REI-ET-LF                      PIC X.
  5553     12  AM-REI-ET-AH                      PIC X.
  5554     12  AM-REI-PE-LF                      PIC X.
  5555     12  AM-REI-PE-AH                      PIC X.
  5556     12  AM-REI-PRT-ST                     PIC X.
  5557     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5558     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5559     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5560     12  AM-REI-GROUP-A                    PIC X(6).
  5561     12  AM-REI-MORT                       PIC X(4).
  5562     12  AM-REI-PRT-OW                     PIC X.
  5563     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5564     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5565     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5566     12  AM-REI-GROUP-B                    PIC X(6).
  5567
  5568     12  AM-TRUST-TYPE                     PIC X(2).
  5569
  5570     12  AM-EMPLOYER-STMT-USED             PIC X.
  5571     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5572
  5573     12  AM-STD-AH-TYPE                    PIC XX.
  5574     12  AM-EARN-METHODS.
  5575         16  AM-EARN-METHOD-R              PIC X.
  5576             88 AM-REF-RL-R78                 VALUE 'R'.
  5577             88 AM-REF-RL-PR                  VALUE 'P'.
  5578             88 AM-REF-RL-MEAN                VALUE 'M'.
  5579             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5580         16  AM-EARN-METHOD-L              PIC X.
  5581             88 AM-REF-LL-R78                 VALUE 'R'.
  5582             88 AM-REF-LL-PR                  VALUE 'P'.
  5583             88 AM-REF-LL-MEAN                VALUE 'M'.
  5584             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5585         16  AM-EARN-METHOD-A              PIC X.
  5586             88 AM-REF-AH-R78                 VALUE 'R'.
  5587             88 AM-REF-AH-PR                  VALUE 'P'.
  5588             88 AM-REF-AH-MEAN                VALUE 'M'.
  5589             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5590             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5591             88 AM-REF-AH-NET                 VALUE 'N'.
  5592
  5593     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5594     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5595     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5596
  5597     12  AM-RET-Y-N                        PIC X.
  5598     12  AM-RET-P-E                        PIC X.
  5599     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5600     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5601     12  AM-RET-GRP                        PIC X(6).
  5602     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5603         16  AM-POOL-PRIME                 PIC XXX.
  5604         16  AM-POOL-SUB                   PIC XXX.
  5605     12  AM-RETRO-EARNINGS.
  5606         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 103
* EL130.cbl
  5607         16  AM-RET-EARN-L                 PIC X.
  5608         16  AM-RET-EARN-A                 PIC X.
  5609     12  AM-RET-ST-TAX-USE                 PIC X.
  5610         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5611         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5612     12  AM-RETRO-BEG-EARNINGS.
  5613         16  AM-RET-BEG-EARN-R             PIC X.
  5614         16  AM-RET-BEG-EARN-L             PIC X.
  5615         16  AM-RET-BEG-EARN-A             PIC X.
  5616     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5617     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5618
  5619     12  AM-USER-SELECT-OPTIONS.
  5620         16  AM-USER-SELECT-1              PIC X(10).
  5621         16  AM-USER-SELECT-2              PIC X(10).
  5622         16  AM-USER-SELECT-3              PIC X(10).
  5623         16  AM-USER-SELECT-4              PIC X(10).
  5624         16  AM-USER-SELECT-5              PIC X(10).
  5625
  5626     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5627
  5628     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5629
  5630     12  AM-RPT045A-SWITCH                 PIC X.
  5631         88  RPT045A-OFF                   VALUE 'N'.
  5632
  5633     12  AM-INSURANCE-LIMITS.
  5634         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5635         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5636
  5637     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5638         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5639
  5640     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5641         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5642         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5643
  5644     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5645
  5646     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5647     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5648     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5649     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5650     12  AM-DCC-UEF-STATE                  PIC XX.
  5651     12  FILLER                            PIC XXX.
  5652     12  AM-REPORT-CODE-3                  PIC X(10).
  5653*    12  FILLER                            PIC X(22).
  5654
  5655     12  AM-RESERVE-DATE.
  5656         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5657         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5658         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5659
  5660     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5661     12  AM-NOTIFICATION-TYPES.
  5662         16  AM-NOTIF-OF-LETTERS           PIC X.
  5663         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5664         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 104
* EL130.cbl
  5665         16  AM-NOTIF-OF-STATUS            PIC X.
  5666
  5667     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5668         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5669         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5670         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5671         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5672
  5673     12  AM-BENEFIT-CONTROLS.
  5674         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5675             20  AM-BENEFIT-CODE           PIC XX.
  5676             20  AM-BENEFIT-TYPE           PIC X.
  5677             20  AM-BENEFIT-REVISION       PIC XXX.
  5678             20  AM-BENEFIT-REM-TERM       PIC X.
  5679             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5680             20  FILLER                    PIC XX.
  5681         16  FILLER                        PIC X(80).
  5682
  5683     12  AM-TRANSFER-DATA.
  5684         16  AM-TRANSFERRED-FROM.
  5685             20  AM-TRNFROM-CARRIER        PIC X.
  5686             20  AM-TRNFROM-GROUPING.
  5687                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5688                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5689             20  AM-TRNFROM-STATE          PIC XX.
  5690             20  AM-TRNFROM-ACCOUNT.
  5691                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5692                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5693             20  AM-TRNFROM-DTE            PIC XX.
  5694         16  AM-TRANSFERRED-TO.
  5695             20  AM-TRNTO-CARRIER          PIC X.
  5696             20  AM-TRNTO-GROUPING.
  5697                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5698                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5699             20  AM-TRNTO-STATE            PIC XX.
  5700             20  AM-TRNTO-ACCOUNT.
  5701                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5702                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5703             20  AM-TRNTO-DTE              PIC XX.
  5704         16  FILLER                        PIC X(10).
  5705
  5706     12  AM-SAVED-REMIT-TO                 PIC 99.
  5707
  5708     12  AM-COMM-STRUCTURE-SAVED.
  5709         16  AM-DEFN-1-SAVED.
  5710             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5711                 24  AM-AGT-SV             PIC X(10).
  5712                 24  AM-COM-TYP-SV         PIC X.
  5713                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5714                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5715                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5716                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5717                 24  FILLER                PIC X.
  5718                 24  AM-GL-CODES-SV        PIC X.
  5719                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5720                 24  FILLER                PIC X.
  5721         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5722             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 105
* EL130.cbl
  5723                 24  FILLER                PIC X(11).
  5724                 24  AM-L-COMA-SV          PIC XXX.
  5725                 24  AM-J-COMA-SV          PIC XXX.
  5726                 24  AM-A-COMA-SV          PIC XXX.
  5727                 24  FILLER                PIC X(6).
  5728
  5729     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5730         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5731            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5732            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5733            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5734
  5735     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5736     12  FILLER                            PIC X(120).
  5737
  5738     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5739         16  AM-CONTROL-NAME               PIC X(30).
  5740         16  AM-EXECUTIVE-ONE.
  5741             20  AM-EXEC1-NAME             PIC X(15).
  5742             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5743                                                          COMP-3.
  5744             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5745                                                          COMP-3.
  5746         16  AM-EXECUTIVE-TWO.
  5747             20  AM-EXEC2-NAME             PIC X(15).
  5748             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5749                                                          COMP-3.
  5750             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5751                                                          COMP-3.
  5752
  5753     12  AM-RETRO-ADDITIONAL-DATA.
  5754         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5755         16  AM-RETRO-PREM-P-E             PIC X.
  5756         16  AM-RETRO-CLMS-P-I             PIC X.
  5757         16  AM-RETRO-RET-BRACKET-LF.
  5758             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5759                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5760                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5761             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5762                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5763                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5764             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5765                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5766                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5767         16  AM-RETRO-RET-BRACKET-AH.
  5768             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5769                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5770                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5771                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5772             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5773                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5774                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5775             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5776                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5777                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5778
  5779     12  AM-COMMENTS.
  5780         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 106
* EL130.cbl
  5781
  5782     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5783         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5784         16  AM-FLI-BILLING-CODE           PIC X.
  5785         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5786         16  AM-FLI-UNITED-IDENT           PIC X.
  5787         16  AM-FLI-INTEREST-LOST-DATA.
  5788             20  AM-FLI-BANK-NO            PIC X(5).
  5789             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5790             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5791             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5792         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5793             20  AM-FLI-AGT                PIC X(9).
  5794             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5795             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5796         16  FILLER                        PIC X(102).
  5797
  5798     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5799         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5800             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5801             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5802             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5803             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5804             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5805         16  FILLER                          PIC X(10).
  5806******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 107
* EL130.cbl
  5808*    COPY ELCTRLR.
  5809******************************************************************
  5810*                                                                *
  5811*                            ELCTRLR.                            *
  5812*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5813*                            VMOD=2.014                          *
  5814*                                                                *
  5815*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5816*                                                                *
  5817*   FILE TYPE = VSAM,KSDS                                        *
  5818*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5819*                                                                *
  5820*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5821*       ALTERNATE INDEX = NONE                                   *
  5822*                                                                *
  5823*   LOG = YES                                                    *
  5824*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5825******************************************************************
  5826*                   C H A N G E   L O G
  5827*
  5828* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5829*-----------------------------------------------------------------
  5830*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5831* EFFECTIVE    NUMBER
  5832*-----------------------------------------------------------------
  5833* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5834* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5835* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5836* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5837* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5838* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5839* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5840* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5841* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5842* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5843* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5844* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5845* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5846* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5847* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5848* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5849* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5850* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5851* 040814    2014030500002  AJRA  ADD ICD CODES
  5852******************************************************************
  5853 01  ACTIVITY-TRAILERS.
  5854     12  AT-RECORD-ID                    PIC XX.
  5855         88  VALID-AT-ID                       VALUE 'AT'.
  5856
  5857     12  AT-CONTROL-PRIMARY.
  5858         16  AT-COMPANY-CD               PIC X.
  5859         16  AT-CARRIER                  PIC X.
  5860         16  AT-CLAIM-NO                 PIC X(7).
  5861         16  AT-CERT-NO.
  5862             20  AT-CERT-PRIME           PIC X(10).
  5863             20  AT-CERT-SFX             PIC X.
  5864         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5865             88  AT-1ST-TRL-AVAIL             VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 108
* EL130.cbl
  5866             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5867             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5868             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5869             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5870             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5871             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5872             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5873             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5874             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5875             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5876             88  AT-BENEFICIARY-TRL           VALUE +91.
  5877             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5878             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5879             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5880             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5881
  5882     12  AT-TRAILER-TYPE                 PIC X.
  5883         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5884         88  PAYMENT-TR                       VALUE '2'.
  5885         88  AUTO-PAY-TR                      VALUE '3'.
  5886         88  CORRESPONDENCE-TR                VALUE '4'.
  5887         88  ADDRESS-TR                       VALUE '5'.
  5888         88  GENERAL-INFO-TR                  VALUE '6'.
  5889         88  AUTO-PROMPT-TR                   VALUE '7'.
  5890         88  DENIAL-TR                        VALUE '8'.
  5891         88  INCURRED-CHG-TR                  VALUE '9'.
  5892         88  FORM-CONTROL-TR                  VALUE 'A'.
  5893
  5894     12  AT-RECORDED-DT                  PIC XX.
  5895     12  AT-RECORDED-BY                  PIC X(4).
  5896     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5897
  5898     12  AT-TRAILER-BODY                 PIC X(165).
  5899
  5900     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5901         16  AT-RESERVE-CONTROLS.
  5902             20  AT-MANUAL-SW            PIC X.
  5903                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5904             20  AT-FUTURE-SW            PIC X.
  5905                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5906             20  AT-PTC-SW               PIC X.
  5907                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5908             20  AT-IBNR-SW              PIC X.
  5909                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5910             20  AT-PTC-LF-SW            PIC X.
  5911                 88  AT-LF-PTC-USED          VALUE '1'.
  5912             20  AT-CDT-ACCESS-METHOD    PIC X.
  5913                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5914                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5915                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5916             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5917         16  AT-LAST-COMPUTED-DT         PIC XX.
  5918         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5919         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5920         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5921         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5922         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5923         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 109
* EL130.cbl
  5924         16  AT-EXPENSE-CONTROLS.
  5925             20  AT-EXPENSE-METHOD       PIC X.
  5926                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5927                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5928                 88  PERCENT-OF-PMT           VALUE '3'.
  5929                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5930             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5931             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5932         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5933         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5934
  5935         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5936         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5937
  5938*        16  FILLER                      PIC X(53).
  5939         16  FILLER                      PIC X(47).
  5940
  5941         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5942         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5943
  5944         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5945             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5946             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5947*                    C = CLOSED
  5948*                    O = OPEN
  5949             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5950*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5951
  5952     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5953         16  AT-PAYMENT-TYPE             PIC X.
  5954             88  PARTIAL-PAYMENT                VALUE '1'.
  5955             88  FINAL-PAYMENT                  VALUE '2'.
  5956             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5957             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5958             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5959             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5960             88  VOIDED-PAYMENT                 VALUE '9'.
  5961             88  TRANSFER                       VALUE 'T'.
  5962             88  LIFE-INTEREST                  VALUE 'I'.
  5963
  5964         16  AT-CLAIM-TYPE               PIC X.
  5965             88  PAID-FOR-AH                    VALUE 'A'.
  5966             88  PAID-FOR-LIFE                  VALUE 'L'.
  5967             88  PAID-FOR-IUI                   VALUE 'I'.
  5968             88  PAID-FOR-GAP                   VALUE 'G'.
  5969         16  AT-CLAIM-PREM-TYPE          PIC X.
  5970             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5971             88  AT-O-B-COVERAGE                VALUE '2'.
  5972             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5973         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5974         16  AT-CHECK-NO                 PIC X(7).
  5975         16  AT-PAID-FROM-DT             PIC XX.
  5976         16  AT-PAID-THRU-DT             PIC XX.
  5977         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5978         16  FILLER                      PIC X.
  5979         16  AT-PAYEES-NAME              PIC X(30).
  5980         16  AT-PAYMENT-ORIGIN           PIC X.
  5981             88  ONLINE-MANUAL-PMT              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 110
* EL130.cbl
  5982             88  ONLINE-AUTO-PMT                VALUE '2'.
  5983             88  OFFLINE-PMT                    VALUE '3'.
  5984         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5985         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5986         16  AT-VOID-DATA.
  5987             20  AT-VOID-DT              PIC XX.
  5988*00144       20  AT-VOID-REASON          PIC X(30).
  5989             20  AT-VOID-REASON          PIC X(26).
  5990         16  AT-PMT-APPROVED-BY          PIC X(04).
  5991         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5992         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5993         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5994                                         PIC S99V9(5)  COMP-3.
  5995         16  AT-CREDIT-INTERFACE.
  5996             20  AT-PMT-SELECT-DT        PIC XX.
  5997                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5998             20  AT-PMT-ACCEPT-DT        PIC XX.
  5999                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6000             20  AT-VOID-SELECT-DT       PIC XX.
  6001                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6002             20  AT-VOID-ACCEPT-DT       PIC XX.
  6003                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6004
  6005         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6006                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6007                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6008         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6009
  6010         16  AT-FORCE-CONTROL            PIC X.
  6011             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6012         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6013         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6014         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6015         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6016         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6017         16  AT-BENEFIT-TYPE             PIC X.
  6018
  6019         16  AT-EXPENSE-TYPE             PIC X.
  6020         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6021
  6022         16  AT-PAYEE-TYPE-CD.
  6023             20  AT-PAYEE-TYPE           PIC X.
  6024                 88  INSURED-PAID           VALUE 'I'.
  6025                 88  BENEFICIARY-PAID       VALUE 'B'.
  6026                 88  ACCOUNT-PAID           VALUE 'A'.
  6027                 88  OTHER-1-PAID           VALUE 'O'.
  6028                 88  OTHER-2-PAID           VALUE 'Q'.
  6029                 88  DOCTOR-PAID            VALUE 'P'.
  6030                 88  EMPLOYER-PAID          VALUE 'E'.
  6031             20  AT-PAYEE-SEQ            PIC X.
  6032
  6033         16  AT-CASH-PAYMENT             PIC X.
  6034         16  AT-GROUPED-PAYMENT          PIC X.
  6035         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6036         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6037         16  AT-APPROVED-LEVEL           PIC X.
  6038         16  AT-VOID-TYPE                PIC X.
  6039             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 111
* EL130.cbl
  6040             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6041         16  AT-AIG-UNEMP-IND            PIC X.
  6042             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6043         16  AT-ASSOCIATES               PIC X.
  6044             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6045             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6046
  6047         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6048         16  AT-CV-PMT-CODE              PIC X.
  6049             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6050             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6051             88  FULL-ADD-PAYMENT           VALUE '3'.
  6052             88  HALF-ADD-PAYMENT           VALUE '4'.
  6053             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6054             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6055             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6056             88  ADDL-PAYMENT               VALUE '8'.
  6057
  6058         16  AT-EOB-CODE1                PIC XXX.
  6059         16  AT-EOB-CODE2                PIC XXX.
  6060         16  AT-EOB-CODE3                PIC XXX.
  6061         16  FILLER REDEFINES AT-EOB-CODE3.
  6062             20  AT-PRINT-CLM-FORM       PIC X.
  6063             20  AT-PRINT-SURVEY         PIC X.
  6064             20  AT-SPECIAL-RELEASE      PIC X.
  6065         16  AT-EOB-CODE4                PIC XXX.
  6066         16  FILLER REDEFINES AT-EOB-CODE4.
  6067             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6068             20  FILLER                  PIC X.
  6069         16  AT-EOB-CODE5                PIC XXX.
  6070         16  FILLER REDEFINES AT-EOB-CODE5.
  6071             20  AT-PMT-PROOF-DT         PIC XX.
  6072             20  FILLER                  PIC X.
  6073
  6074         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6075             88  AT-PRINT-EOB            VALUE 'Y'.
  6076
  6077         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6078         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6079
  6080     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6081         16  AT-SCHEDULE-START-DT        PIC XX.
  6082         16  AT-SCHEDULE-END-DT          PIC XX.
  6083         16  AT-TERMINATED-DT            PIC XX.
  6084         16  AT-LAST-PMT-TYPE            PIC X.
  6085             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6086             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6087         16  AT-FIRST-PMT-DATA.
  6088             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6089             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6090             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6091         16  AT-REGULAR-PMT-DATA.
  6092             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6093             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6094             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6095         16  AT-AUTO-PAYEE-CD.
  6096             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6097                 88  INSURED-PAID-AUTO      VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 112
* EL130.cbl
  6098                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6099                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6100                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6101                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6102             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6103         16  AT-AUTO-PAY-DAY             PIC 99.
  6104         16  AT-AUTO-CASH                PIC X.
  6105             88  AT-CASH                      VALUE 'Y'.
  6106             88  AT-NON-CASH                  VALUE 'N'.
  6107*        16  FILLER                      PIC X(129).
  6108         16  AT-AUTO-END-LETTER          PIC X(4).
  6109         16  FILLER                      PIC X(125).
  6110
  6111         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6112         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6113
  6114     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6115         16  AT-LETTER-SENT-DT           PIC XX.
  6116         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6117         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6118         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6119         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6120         16  AT-LETTER-ORIGIN            PIC X.
  6121             88  ONLINE-CREATION              VALUE '1' '3'.
  6122             88  OFFLINE-CREATION             VALUE '2' '4'.
  6123             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6124             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6125         16  AT-STD-LETTER-FORM          PIC X(4).
  6126         16  AT-REASON-TEXT              PIC X(70).
  6127         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6128         16  AT-ADDRESEE-TYPE            PIC X.
  6129              88  INSURED-ADDRESEE            VALUE 'I'.
  6130              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6131              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6132              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6133              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6134              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6135              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6136         16  AT-ADDRESSEE-NAME           PIC X(30).
  6137         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6138         16  AT-RESEND-PRINT-DATE        PIC XX.
  6139         16  AT-CORR-SOL-UNSOL           PIC X.
  6140         16  AT-LETTER-PURGED-DT         PIC XX.
  6141*
  6142*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6143*
  6144         16  AT-CSO-REDEFINITION.
  6145             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6146             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6147             20  AT-LETTER-TO-BENE       PIC X(1).
  6148             20  AT-STOP-LETTER-DT       PIC X(2).
  6149             20  FILLER                  PIC X(19).
  6150*             20  FILLER                  PIC X(27).
  6151             20  AT-CSO-LETTER-STATUS    PIC X.
  6152                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6153                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6154                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6155             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 113
* EL130.cbl
  6156             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6157*
  6158*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6159*
  6160*        16  FILLER                      PIC X(26).
  6161*
  6162*        16  AT-DMD-BSR-CODE             PIC X.
  6163*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6164*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6165*
  6166*        16  AT-DMD-LETTER-STATUS        PIC X.
  6167*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6168*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6169*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6170*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6171*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6172
  6173         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6174         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6175
  6176     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6177         16  AT-ADDRESS-TYPE             PIC X.
  6178             88  INSURED-ADDRESS               VALUE 'I'.
  6179             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6180             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6181             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6182             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6183             88  OTHER-ADDRESS-1               VALUE 'O'.
  6184             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6185         16  AT-MAIL-TO-NAME             PIC X(30).
  6186         16  AT-ADDRESS-LINE-1           PIC X(30).
  6187         16  AT-ADDRESS-LINE-2           PIC X(30).
  6188         16  AT-CITY-STATE.
  6189             20  AT-CITY                 PIC X(28).
  6190             20  AT-STATE                PIC XX.
  6191         16  AT-ZIP.
  6192             20  AT-ZIP-CODE.
  6193                 24  AT-ZIP-1ST          PIC X.
  6194                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6195                 24  FILLER              PIC X(4).
  6196             20  AT-ZIP-PLUS4            PIC X(4).
  6197         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6198             20  AT-CAN-POSTAL-1         PIC XXX.
  6199             20  AT-CAN-POSTAL-2         PIC XXX.
  6200             20  FILLER                  PIC XXX.
  6201         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6202*         16  FILLER                      PIC X(23).
  6203         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6204         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6205         16  FILLER                      PIC X(13).
  6206         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6207         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6208
  6209     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6210         16  AT-INFO-LINE-1              PIC X(60).
  6211         16  FILLER REDEFINES AT-INFO-LINE-1.
  6212             20  AT-NOTE-ERROR-NO OCCURS 15
  6213                                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 114
* EL130.cbl
  6214         16  AT-INFO-LINE-2              PIC X(60).
  6215         16  FILLER REDEFINES AT-INFO-LINE-2.
  6216             20  AT-ICD-CODE-1           PIC X(8).
  6217             20  AT-ICD-CODE-2           PIC X(8).
  6218             20  FILLER                  PIC X(44).
  6219         16  AT-INFO-TRAILER-TYPE        PIC X.
  6220             88  AT-ERRORS-NOTE          VALUE 'E'.
  6221             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6222             88  AT-CALL-NOTE            VALUE 'C'.
  6223             88  AT-MAINT-NOTE           VALUE 'M'.
  6224             88  AT-CERT-CHANGE          VALUE 'X'.
  6225             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6226             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6227             88  AT-CERT-CANCELLED       VALUE 'T'.
  6228         16  AT-CALL-TYPE                PIC X.
  6229             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6230             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6231         16  AT-NOTE-CONTINUATION        PIC X.
  6232             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6233         16  AT-EOB-CODES-EXIST          PIC X.
  6234             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6235         16  FILLER                      PIC X(35).
  6236         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6237         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6238
  6239     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6240         16  AT-PROMPT-LINE-1            PIC X(60).
  6241         16  AT-PROMPT-LINE-2            PIC X(60).
  6242         16  AT-PROMPT-START-DT          PIC XX.
  6243         16  AT-PROMPT-END-DT            PIC XX.
  6244         16  FILLER                      PIC X(35).
  6245         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6246         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6247
  6248     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6249         16  AT-DENIAL-INFO-1            PIC X(60).
  6250         16  AT-DENIAL-INFO-2            PIC X(60).
  6251         16  AT-DENIAL-DT                PIC XX.
  6252         16  AT-RETRACTION-DT            PIC XX.
  6253         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6254*         16  FILLER                      PIC X(31).
  6255         16  AT-DENIAL-PROOF-DT          PIC XX.
  6256         16  FILLER                      PIC X(29).
  6257         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6258         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6259
  6260     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6261         16  AT-OLD-INCURRED-DT          PIC XX.
  6262         16  AT-OLD-REPORTED-DT          PIC XX.
  6263         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6264         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6265         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6266         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6267         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6268         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6269         16  FILLER                      PIC X(26).
  6270         16  AT-OLD-DIAG-CODE            PIC X(6).
  6271         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 115
* EL130.cbl
  6272         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6273         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6274         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6275         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6276         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6277         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6278         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6279         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6280         16  FILLER                      PIC X(9).
  6281         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6282
  6283     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6284         16  AT-FORM-SEND-ON-DT          PIC XX.
  6285         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6286         16  AT-FORM-RE-SEND-DT          PIC XX.
  6287         16  AT-FORM-ANSWERED-DT         PIC XX.
  6288         16  AT-FORM-PRINTED-DT          PIC XX.
  6289         16  AT-FORM-REPRINT-DT          PIC XX.
  6290         16  AT-FORM-TYPE                PIC X.
  6291             88  INITIAL-FORM                  VALUE '1'.
  6292             88  PROGRESS-FORM                 VALUE '2'.
  6293         16  AT-INSTRUCT-LN-1            PIC X(28).
  6294         16  AT-INSTRUCT-LN-2            PIC X(28).
  6295         16  AT-INSTRUCT-LN-3            PIC X(28).
  6296         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6297         16  AT-FORM-ADDRESS             PIC X.
  6298             88  FORM-TO-INSURED              VALUE 'I'.
  6299             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6300             88  FORM-TO-OTHER-1              VALUE 'O'.
  6301             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6302         16  AT-RELATED-1.
  6303             20 AT-REL-CARR-1            PIC X.
  6304             20 AT-REL-CLAIM-1           PIC X(7).
  6305             20 AT-REL-CERT-1            PIC X(11).
  6306         16  AT-RELATED-2.
  6307             20 AT-REL-CARR-2            PIC X.
  6308             20 AT-REL-CLAIM-2           PIC X(7).
  6309             20 AT-REL-CERT-2            PIC X(11).
  6310         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6311         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6312         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6313         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6314         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6315         16  AT-STOP-FORM-DT             PIC X(2).
  6316
  6317         16  FILLER                      PIC X(09).
  6318         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6319         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6320******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 116
* EL130.cbl
  6322*    COPY ELCBENE.
  6323******************************************************************
  6324*                                                                *
  6325*                            ELCBENE.                            *
  6326*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6327*                            VMOD=2.006                          *
  6328*                                                                *
  6329*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6330*                                                                *
  6331*   FILE TYPE = VSAM,KSDS                                        *
  6332*   RECORD SIZE = 500   RECFORM = FIX                            *
  6333*                                                                *
  6334*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6335*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6336*                                                                *
  6337*   LOG = YES                                                    *
  6338*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6339*                                                                *
  6340*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6341******************************************************************
  6342
  6343 01  BENEFICIARY-MASTER.
  6344     12  BE-RECORD-ID                PIC XX.
  6345         88  VALID-BE-ID                VALUE 'BE'.
  6346
  6347     12  BE-CONTROL-PRIMARY.
  6348         16  BE-COMPANY-CD           PIC X.
  6349         16  BE-RECORD-TYPE          PIC X.
  6350             88  BENEFICIARY-RECORD  VALUE 'B'.
  6351             88  ADJUSTOR-RECORD     VALUE 'A'.
  6352         16  BE-BENEFICIARY          PIC X(10).
  6353     12  BE-CONTROL-BY-NAME.
  6354         16  BE-COMPANY-CD-A1        PIC X.
  6355         16  BE-RECORD-TYPE-A1       PIC X.
  6356         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6357         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6358
  6359     12  BE-LAST-MAINT-DT            PIC XX.
  6360     12  BE-LAST-MAINT-BY            PIC X(4).
  6361     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6362
  6363     12  BE-ADDRESS-DATA.
  6364         16  BE-MAIL-TO-NAME         PIC X(30).
  6365         16  BE-ADDRESS-LINE-1       PIC X(30).
  6366         16  BE-ADDRESS-LINE-2       PIC X(30).
  6367         16  BE-ADDRESS-LINE-3       PIC X(30).
  6368         16  BE-CITY-STATE.
  6369             20  BE-CITY             PIC X(28).
  6370             20  BE-STATE            PIC XX.
  6371         16  BE-ZIP-CODE.
  6372             20  BE-ZIP-PRIME.
  6373                 24  BE-ZIP-1ST      PIC X.
  6374                     88  BE-CANADIAN-POST-CODE
  6375                                         VALUE 'A' THRU 'Z'.
  6376                 24  FILLER          PIC X(4).
  6377             20  BE-ZIP-PLUS4        PIC X(4).
  6378         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6379             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 117
* EL130.cbl
  6380             20  BE-CAN-POSTAL-2     PIC XXX.
  6381             20  FILLER              PIC XXX.
  6382         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6383         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6384
  6385******************************************************************
  6386*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6387*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6388******************************************************************
  6389     12  BE-CARRIER                  PIC X.
  6390
  6391     12  BE-ADDRESS-DATA2.
  6392         16  BE-MAIL-TO-NAME2        PIC X(30).
  6393         16  BE-ADDRESS-LINE-12      PIC X(30).
  6394         16  BE-ADDRESS-LINE-22      PIC X(30).
  6395         16  BE-ADDRESS-LINE-32      PIC X(30).
  6396         16  BE-CITY-STATE2.
  6397             20  BE-CITY2            PIC X(28).
  6398             20  BE-STATE2           PIC XX.
  6399         16  BE-ZIP-CODE2.
  6400             20  BE-ZIP-PRIME2.
  6401                 24  BE-ZIP-1ST2     PIC X.
  6402                     88  BE-CANADIAN-POST-CODE2
  6403                                         VALUE 'A' THRU 'Z'.
  6404                 24  FILLER          PIC X(4).
  6405             20  BE-ZIP-PLUS42       PIC X(4).
  6406         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6407             20  BE-CAN-POSTAL-12    PIC XXX.
  6408             20  BE-CAN-POSTAL-22    PIC XXX.
  6409             20  FILLER              PIC XXX.
  6410         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6411         16  BE-BILLING-STMT-DATA.
  6412             20  BE-BSR              PIC X.
  6413                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6414                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6415             20  BE-BSR-FROM         PIC X(30).
  6416             20  BE-BSR-DEPT         PIC X(30).
  6417             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6418             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6419             20  BE-OUTPUT-TYPE      PIC X.
  6420                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6421                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6422
  6423     12  FILLER                      PIC X(28).
  6424******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 118
* EL130.cbl
  6426*    COPY ELCDAR.
  6427******************************************************************
  6428*                                                                *
  6429*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6430*   FILE TYPE = VSAM,KSDS                                        *
  6431*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6432*   BASE CLUSTER = DLYACTV                                       *
  6433*   LOG = YES                                                    *
  6434*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6435*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6436*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6437*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6438*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6439*               BY PROGRAM "LGINFCE".                            *
  6440*                                                                *
  6441******************************************************************
  6442 01  DAILY-ACTIVITY-RECORD.
  6443     05  DA-KEY.
  6444         10  DA-COMP-CD          PIC X.
  6445         10  DA-CARRIER          PIC X.
  6446         10  DA-CLAIM-NO         PIC X(7).
  6447         10  DA-CERT-NO.
  6448             15  DA-CERT-PRIME   PIC X(10).
  6449             15  DA-CERT-SFX     PIC X.
  6450     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6451     05  DA-RECORD-TYPE          PIC X.
  6452     05  FILLER                  PIC X(2).
  6453******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 119
* EL130.cbl
  6455*    COPY ELCACTQ.
  6456******************************************************************
  6457*                                                                *
  6458*                            ELCACTQ.                            *
  6459*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6460*                            VMOD=2.004                          *
  6461*                                                                *
  6462*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6463*                                                                *
  6464*   FILE TYPE = VSAM,KSDS                                        *
  6465*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6466*                                                                *
  6467*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6468*       ALTERNATE INDEX = NONE                                   *
  6469*                                                                *
  6470*   LOG = YES                                                    *
  6471*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6472*                                                                *
  6473*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6474******************************************************************
  6475
  6476 01  ACTIVITY-QUE.
  6477     12  AQ-RECORD-ID                PIC XX.
  6478         88  VALID-AQ-ID                VALUE 'AQ'.
  6479
  6480     12  AQ-CONTROL-PRIMARY.
  6481         16  AQ-COMPANY-CD           PIC X.
  6482         16  AQ-CARRIER              PIC X.
  6483         16  AQ-CLAIM-NO             PIC X(7).
  6484         16  AQ-CERT-NO.
  6485             20  AQ-CERT-PRIME       PIC X(10).
  6486             20  AQ-CERT-SFX         PIC X.
  6487
  6488     12  AQ-PENDING-ACTIVITY-FLAGS.
  6489         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6490         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6491             88  PENDING-PAYMENTS       VALUE '1'.
  6492         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6493             88  PENDING-FULL-PRINT     VALUE '1'.
  6494             88  PENDING-PART-PRINT     VALUE '2'.
  6495         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6496             88  PENDING-LETTERS        VALUE '1'.
  6497         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6498             88  PENDING-RESTORE        VALUE 'C'.
  6499             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6500
  6501     12  FILLER                      PIC X(20).
  6502
  6503     12  AQ-RESEND-DATE              PIC XX.
  6504     12  AQ-FOLLOWUP-DATE            PIC XX.
  6505     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6506     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6507     12  AQ-AUTO-LETTER              PIC X(4).
  6508     12  FILLER                      PIC XX.
  6509     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6510*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 120
* EL130.cbl
  6512*    COPY ELCARCH.
  6513******************************************************************
  6514*                                                                *
  6515*                            ELCARCH.                            *
  6516*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6517*                            VMOD=2.007                          *
  6518*                                                                *
  6519*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6520*                                                                *
  6521*   FILE TYPE = VSAM,KSDS                                        *
  6522*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6523*                                                                *
  6524*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6525*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6526*                                                                *
  6527*   LOG = NO                                                     *
  6528*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6529*                                                                *
  6530*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6531******************************************************************
  6532 01  LETTER-ARCHIVE.
  6533     12  LA-RECORD-ID                PIC XX.
  6534         88  VALID-LA-ID                VALUE 'LA'.
  6535
  6536     12  LA-CONTROL-PRIMARY.
  6537         16  LA-COMPANY-CD           PIC X.
  6538         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6539         16  LA-RECORD-TYPE          PIC X.
  6540             88  LA-HEADER-DATA         VALUE '1'.
  6541             88  LA-ADDRESS-DATA        VALUE '2'.
  6542             88  LA-TEXT-DATA           VALUE '3'.
  6543             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6544         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6545
  6546     12  LA-CONTROL-BY-TYPE.
  6547         16  LA-COMPANY-CD-A1        PIC X.
  6548         16  LA-RECORD-TYPE-A1       PIC X.
  6549         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6550         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6551
  6552     12  LA-TEXT-RECORD.
  6553         16  LA-SKIP-CONTROL         PIC XX.
  6554             88  NO-LINES-SKIPPED       VALUE SPACES.
  6555             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6556         16  LA-TEXT-LINE            PIC X(70).
  6557
  6558     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6559         16  FILLER                  PIC XX.
  6560         16  LA-ADDRESS-LINE         PIC X(30).
  6561         16  FILLER                  PIC X(40).
  6562
  6563     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6564         16  FILLER                  PIC XX.
  6565         16  LA-CARRIER              PIC X.
  6566         16  LA-CLAIM-NO             PIC X(7).
  6567         16  LA-CERT-NO.
  6568             20  LA-CERT-PRIME       PIC X(10).
  6569             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 121
* EL130.cbl
  6570         16  LA-NO-OF-COPIES         PIC S9.
  6571         16  LA-RESEND-DATE          PIC XX.
  6572         16  LA-PROCESSOR-CD         PIC X(4).
  6573         16  LA-CREATION-DT          PIC XX.
  6574         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6575         16  LA-RESEND-PRINT-DATE    PIC XX.
  6576         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6577         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6578*
  6579* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6580*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6581*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6582*   I        20  LA-DMD-RES-ST           PIC XX.
  6583*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6584*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6585*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6586*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6587*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6588*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6589*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6590*   I        20  LA-DMD-UND-CODE         PIC XX.
  6591*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6592*   V    16  FILLER                  PIC X(15).
  6593* -----
  6594*
  6595* REINSERTED  CSO  MODS
  6596*
  6597         16  FILLER.
  6598             20  FILLER                  PIC X(29).
  6599             20  LA-CSO-LETTER-STATUS    PIC X.
  6600                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6601                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6602                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6603             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6604             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6605*
  6606
  6607     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6608         16  FILLER                  PIC XX.
  6609         16  LA4-CARRIER             PIC X.
  6610         16  LA4-CLAIM-NO            PIC X(7).
  6611         16  LA4-CERT-NO.
  6612             20  LA4-CERT-PRIME      PIC X(10).
  6613             20  LA4-CERT-SFX        PIC X.
  6614         16  LA4-NO-OF-COPIES        PIC S9.
  6615         16  LA4-RESEND-DATE         PIC XX.
  6616         16  LA4-PROCESSOR-CD        PIC X(4).
  6617         16  LA4-CREATION-DT         PIC XX.
  6618         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6619         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6620         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6621         16  LA4-FORM-TYPE           PIC X.
  6622             88  LA4-INITIAL-FORM    VALUE '1'.
  6623             88  LA4-PROGRESS-FORM   VALUE '2'.
  6624         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6625         16  LA4-STATE               PIC X(02).
  6626         16  FILLER                  PIC X(31).
  6627******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 122
* EL130.cbl
  6629*    COPY ERCREIN.
  6630******************************************************************
  6631*                                                                *
  6632*                            ERCREIN                             *
  6633*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6634*                            VMOD=2.010                          *
  6635*                                                                *
  6636*   ONLINE CREDIT SYSTEM                                         *
  6637*                                                                *
  6638*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6639*                                                                *
  6640*   FILE TYPE = VSAM,KSDS                                        *
  6641*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6642*                                                                *
  6643*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6644*       ALTERNATE PATH = NONE                                    *
  6645*                                                                *
  6646*   LOG = NO                                                     *
  6647*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6648*                                                                *
  6649******************************************************************
  6650*                   C H A N G E   L O G
  6651*
  6652* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6653*-----------------------------------------------------------------
  6654*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6655* EFFECTIVE    NUMBER
  6656*-----------------------------------------------------------------
  6657* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6658* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6659******************************************************************
  6660 01  REINSURANCE-RECORD.
  6661     12  RE-RECORD-ID                      PIC XX.
  6662         88  VALID-RE-ID                      VALUE 'RE'.
  6663
  6664     12  RE-CONTROL-PRIMARY.
  6665         16  RE-COMPANY-CD                 PIC X.
  6666         16  RE-KEY.
  6667             20  RE-CODE                   PIC X.
  6668                 88  RE-TABLE-RECORD          VALUE 'A'.
  6669                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6670             20  RE-TABLE                  PIC XXX.
  6671             20  FILLER                    PIC XXX.
  6672         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6673             20  FILLER                    PIC X.
  6674             20  RE-COMPANY.
  6675                 24  RE-COMP-PRIME         PIC XXX.
  6676                 24  RE-COMP-SUB           PIC XXX.
  6677
  6678     12  RE-MAINT-INFORMATION.
  6679         16  RE-LAST-MAINT-DT              PIC XX.
  6680         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6681         16  RE-LAST-MAINT-USER            PIC X(4).
  6682         16  FILLER                        PIC X(10).
  6683
  6684     12  RE-TABLE-DATA.
  6685         16  RE-100-COMP                   PIC 99.
  6686
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 123
* EL130.cbl
  6687         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6688             20  RE-REI-COMP-NO.
  6689                 24  RE-REI-COMP           PIC XXX.
  6690                 24  RE-REI-COMP-SUB       PIC XXX.
  6691             20  RE-LF-QC                  PIC X.
  6692             20  RE-AH-QC                  PIC X.
  6693             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6694             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6695             20  RE-LFAGE-LO               PIC 99.
  6696             20  RE-LFAGE-HI               PIC 99.
  6697             20  RE-AHAGE-LO               PIC 99.
  6698             20  RE-AHAGE-HI               PIC 99.
  6699             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6700             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6701             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6702             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6703             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6704             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6705             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6706             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6707             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6708             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6709             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6710             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6711             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6712             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6713             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6714             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6715             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6716             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6717             20  RE-LF-BEN-CODE            PIC X.
  6718             20  RE-AH-BEN-CODE            PIC X.
  6719             20  RE-INTERACTIVE            PIC X.
  6720             20  RE-REMAINING              PIC X.
  6721             20  RE-LF-RUNOFF-SW           PIC X.
  6722             20  RE-AH-RUNOFF-SW           PIC X.
  6723             20  FILLER                    PIC X(19).
  6724
  6725         16  RE-COMP-INFO-END              PIC X(6).
  6726         16  RE-NSP-ST-CD-LF               PIC XX.
  6727         16  RE-NSP-ST-CD-AH               PIC XX.
  6728         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6729             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6730
  6731         16  FILLER                        PIC X(27).
  6732
  6733     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6734         16  RE-NAME                       PIC X(30).
  6735         16  RE-LF-PE                      PIC X.
  6736         16  RE-AH-PE                      PIC X.
  6737         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6738         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6739         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6740         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6741         16  RE-PRT-ST                     PIC X.
  6742         16  RE-PRT-OW                     PIC X.
  6743         16  RE-MORT-CODE                  PIC X(4).
  6744         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 124
* EL130.cbl
  6745         16  RE-ZERO-LF-FEE                PIC X.
  6746         16  RE-ZERO-AH-FEE                PIC X.
  6747         16  RE-CEDE-NAME                  PIC X(30).
  6748         16  RE-LF-COMM                    PIC X.
  6749         16  RE-AH-COMM                    PIC X.
  6750         16  RE-LF-TAX                     PIC X.
  6751         16  RE-AH-TAX                     PIC X.
  6752         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6753         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6754         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6755
  6756         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6757             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6758
  6759         16  RE-LF-CEDING-FEE-BRACKETS.
  6760             20  RE-LF-FEE-METHOD          PIC X.
  6761                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6762                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6763                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6764                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6765             20  RE-LF-FEE-BASIS           PIC X.
  6766                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6767                 88  RE-LF-NET-CEDED               VALUE '2'.
  6768                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6769                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6770                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6771                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6772                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6773                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6774             20  FILLER                    PIC XXX.
  6775             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6776                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6777                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6778
  6779         16  RE-AH-CEDING-FEE-BRACKETS.
  6780             20  RE-AH-FEE-METHOD          PIC X.
  6781                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6782                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6783                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6784                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6785             20  RE-AH-FEE-BASIS           PIC X.
  6786                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6787                 88  RE-AH-NET-CEDED               VALUE '2'.
  6788                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6789                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6790                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6791                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6792                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6793                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6794             20  FILLER                    PIC XXX.
  6795             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6796                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6797                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6798
  6799         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6800
  6801         16  RE-OLD-CEDING-STMT            PIC X.
  6802
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 125
* EL130.cbl
  6803         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6804         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6805         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6806         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6807         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6808         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6809         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6810         16  RE-MORT-SW                    PIC X.
  6811         16  RE-CEDING-TYPE-FLAG           PIC X.
  6812             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6813             88  RE-CEDED                          VALUE 'C'.
  6814             88  RE-ASSUMED                        VALUE 'A'.
  6815             88  RE-PHANTOM                        VALUE 'P'.
  6816
  6817         16  RE-CEDING-STMT-OPT-A          PIC X.
  6818             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6819         16  RE-CEDING-STMT-OPT-B          PIC X.
  6820             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6821         16  RE-CEDING-STMT-OPT-C          PIC X.
  6822             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6823         16  RE-CEDING-STMT-OPT-D          PIC X.
  6824             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6825         16  RE-CEDING-STMT-OPT-E          PIC X.
  6826             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6827
  6828         16  RE-PRT-CRSV                   PIC X.
  6829
  6830         16  RE-GL-CENTER                  PIC X(4).
  6831
  6832         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6833
  6834         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6835
  6836         16  RE-EARN-STOP-CODE             PIC X.
  6837             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6838             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6839
  6840         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6841             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6842
  6843         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6844         16  FILLER                        PIC X(2281).
  6845
  6846         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6847
  6848******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 126
* EL130.cbl
  6850*    COPY ERCMAIL.
  6851******************************************************************
  6852*                                                                *
  6853*                                                                *
  6854*                            ERCMAIL                             *
  6855*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6856*                            VMOD=2.003                          *
  6857*                                                                *
  6858*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6859*                                                                *
  6860*   FILE TYPE = VSAM,KSDS                                        *
  6861*   RECORD SIZE = 374   RECFORM = FIX                            *
  6862*                                                                *
  6863*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6864*   ALTERNATE PATH    = NOT USED                                 *
  6865*                                                                *
  6866*   LOG = YES                                                    *
  6867*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6868******************************************************************
  6869*                   C H A N G E   L O G
  6870*
  6871* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6872*-----------------------------------------------------------------
  6873*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6874* EFFECTIVE    NUMBER
  6875*-----------------------------------------------------------------
  6876* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6877* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6878* 111108                   PEMA  ADD CRED BENE ADDR2
  6879******************************************************************
  6880
  6881 01  MAILING-DATA.
  6882     12  MA-RECORD-ID                      PIC XX.
  6883         88  VALID-MA-ID                       VALUE 'MA'.
  6884
  6885     12  MA-CONTROL-PRIMARY.
  6886         16  MA-COMPANY-CD                 PIC X.
  6887         16  MA-CARRIER                    PIC X.
  6888         16  MA-GROUPING.
  6889             20  MA-GROUPING-PREFIX        PIC XXX.
  6890             20  MA-GROUPING-PRIME         PIC XXX.
  6891         16  MA-STATE                      PIC XX.
  6892         16  MA-ACCOUNT.
  6893             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6894             20  MA-ACCOUNT-PRIME          PIC X(6).
  6895         16  MA-CERT-EFF-DT                PIC XX.
  6896         16  MA-CERT-NO.
  6897             20  MA-CERT-PRIME             PIC X(10).
  6898             20  MA-CERT-SFX               PIC X.
  6899
  6900     12  FILLER                            PIC XX.
  6901
  6902     12  MA-ACCESS-CONTROL.
  6903         16  MA-SOURCE-SYSTEM              PIC XX.
  6904             88  MA-FROM-CREDIT                VALUE 'CR'.
  6905             88  MA-FROM-VSI                   VALUE 'VS'.
  6906             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6907             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 127
* EL130.cbl
  6908         16  MA-RECORD-ADD-DT              PIC XX.
  6909         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6910         16  MA-LAST-MAINT-DT              PIC XX.
  6911         16  MA-LAST-MAINT-BY              PIC XXXX.
  6912         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6913
  6914     12  MA-PROFILE-INFO.
  6915         16  MA-QUALIFY-CODE-1             PIC XX.
  6916         16  MA-QUALIFY-CODE-2             PIC XX.
  6917         16  MA-QUALIFY-CODE-3             PIC XX.
  6918         16  MA-QUALIFY-CODE-4             PIC XX.
  6919         16  MA-QUALIFY-CODE-5             PIC XX.
  6920
  6921         16  MA-INSURED-LAST-NAME          PIC X(15).
  6922         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6923         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6924         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6925         16  MA-INSURED-BIRTH-DT           PIC XX.
  6926         16  MA-INSURED-SEX                PIC X.
  6927             88  MA-SEX-MALE                   VALUE 'M'.
  6928             88  MA-SEX-FEMALE                 VALUE 'F'.
  6929         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6930
  6931         16  MA-ADDRESS-CORRECTED          PIC X.
  6932         16  MA-JOINT-BIRTH-DT             PIC XX.
  6933*        16  FILLER                        PIC X(12).
  6934
  6935         16  MA-ADDRESS-LINE-1             PIC X(30).
  6936         16  MA-ADDRESS-LINE-2             PIC X(30).
  6937         16  MA-CITY-STATE.
  6938             20  MA-CITY                   PIC X(28).
  6939             20  MA-ADDR-STATE             PIC XX.
  6940         16  MA-ZIP.
  6941             20  MA-ZIP-CODE.
  6942                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6943                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6944                 24  FILLER                PIC X(4).
  6945             20  MA-ZIP-PLUS4              PIC X(4).
  6946         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6947             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6948             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6949             20  FILLER                    PIC X(3).
  6950
  6951         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6952
  6953         16  FILLER                        PIC XXX.
  6954*        16  FILLER                        PIC X(10).
  6955
  6956     12  MA-CRED-BENE-INFO.
  6957         16  MA-CRED-BENE-NAME                 PIC X(25).
  6958         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6959         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6960         16  MA-CRED-BENE-CTYST.
  6961             20  MA-CRED-BENE-CITY             PIC X(28).
  6962             20  MA-CRED-BENE-STATE            PIC XX.
  6963         16  MA-CRED-BENE-ZIP.
  6964             20  MA-CB-ZIP-CODE.
  6965                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 128
* EL130.cbl
  6966                     88  MA-CB-CANADIAN-POST-CODE
  6967                                           VALUE 'A' THRU 'Z'.
  6968                 24  FILLER                    PIC X(4).
  6969             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6970         16  MA-CB-CANADIAN-POSTAL-CODE
  6971                            REDEFINES MA-CRED-BENE-ZIP.
  6972             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6973             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6974             20  FILLER                        PIC X(3).
  6975     12  MA-POST-CARD-MAIL-DATA.
  6976         16  MA-MAIL-DATA OCCURS 7.
  6977             20  MA-MAIL-TYPE              PIC X.
  6978                 88  MA-12MO-MAILING           VALUE '1'.
  6979                 88  MA-EXP-MAILING            VALUE '2'.
  6980             20  MA-MAIL-STATUS            PIC X.
  6981                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6982                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6983                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6984             20  MA-MAIL-DATE              PIC XX.
  6985     12  FILLER                            PIC XX.
  6986     12  FILLER                            PIC XX.
  6987*    12  FILLER                            PIC X(30).
  6988******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 129
* EL130.cbl
  6990*    COPY ELCCRTT.
  6991******************************************************************
  6992*                                                                *
  6993*                            ELCCRTT.                            *
  6994*                                                                *
  6995*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  6996*                                                                *
  6997*   FILE TYPE = VSAM,KSDS                                        *
  6998*   RECORD SIZE = 552  RECFORM = FIXED                           *
  6999*                                                                *
  7000*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7001*                                                                *
  7002*   LOG = YES                                                    *
  7003*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7004******************************************************************
  7005*                   C H A N G E   L O G
  7006*
  7007* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7008*-----------------------------------------------------------------
  7009*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7010* EFFECTIVE    NUMBER
  7011*-----------------------------------------------------------------
  7012* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7013* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7014* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7015* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7016* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7017* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7018******************************************************************
  7019
  7020 01  CERTIFICATE-TRAILERS.
  7021     12  CS-RECORD-ID                      PIC XX.
  7022         88  VALID-CS-ID                      VALUE 'CS'.
  7023
  7024     12  CS-CONTROL-PRIMARY.
  7025         16  CS-COMPANY-CD                 PIC X.
  7026         16  CS-CARRIER                    PIC X.
  7027         16  CS-GROUPING                   PIC X(6).
  7028         16  CS-STATE                      PIC XX.
  7029         16  CS-ACCOUNT                    PIC X(10).
  7030         16  CS-CERT-EFF-DT                PIC XX.
  7031         16  CS-CERT-NO.
  7032             20  CS-CERT-PRIME             PIC X(10).
  7033             20  CS-CERT-SFX               PIC X.
  7034         16  CS-TRAILER-TYPE               PIC X.
  7035             88  COMM-TRLR           VALUE 'A'.
  7036             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7037             88  CERT-DATA-TRLR      VALUE 'C'.
  7038
  7039     12  CS-DATA-AREA                      PIC X(516).
  7040
  7041     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7042         16  CS-BANK-COMMISSION-AREA.
  7043             20  CS-BANK-COMMS       OCCURS 10.
  7044                 24  CS-AGT                PIC X(10).
  7045                 24  CS-COM-TYP            PIC X.
  7046                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7047                 24  CS-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 130
* EL130.cbl
  7048                 24  FILLER                PIC X(10).
  7049         16  FILLER                        PIC X(256).
  7050
  7051     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7052****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7053         16  CS-MB-CLAIM-DATA OCCURS 24.
  7054             20  CS-CLAIM-NO               PIC X(7).
  7055             20  CS-CLAIM-TYPE             PIC X.
  7056                 88  CS-AH-CLM               VALUE 'A'.
  7057                 88  CS-IU-CLM               VALUE 'I'.
  7058                 88  CS-GP-CLM               VALUE 'G'.
  7059                 88  CS-LF-CLM               VALUE 'L'.
  7060                 88  CS-PR-CLM               VALUE 'P'.
  7061             20  CS-INSURED-TYPE           PIC X.
  7062                 88  CS-PRIM-INSURED          VALUE 'P'.
  7063                 88  CS-CO-BORROWER           VALUE 'C'.
  7064             20  CS-BENEFIT-PERIOD         PIC 99.
  7065             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7066             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7067             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7068         16  FILLER                        PIC X(12).
  7069     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7070         16  CS-VIN-NUMBER                 PIC X(17).
  7071         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7072         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7073         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7074         16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 131
* EL130.cbl
  7076
  7077 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7078                          CONTROL-FILE CERTIFICATE-MASTER
  7079                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7080                          BENEFICIARY-MASTER
  7081                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7082                          LETTER-ARCHIVE REINSURANCE-RECORD
  7083                          MAILING-DATA CERTIFICATE-TRAILERS.
  7084 0000-DFHEXIT SECTION.
  7085     MOVE '9#                    $   ' TO DFHEIV0.
  7086     MOVE 'EL130' TO DFHEIV1.
  7087     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7088     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7089     MOVE '5'                    TO DC-OPTION-CODE.
  7090     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7091     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7092     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7093
  7094     IF EIBCALEN = ZERO
  7095         GO TO 8800-UNAUTHORIZED-ACCESS
  7096     END-IF.
  7097
  7098     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7099     MOVE EIBTRMID               TO QID-TERM.
  7100     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7101     move spaces                 to emi-error-lines
  7102     MOVE '2'                    TO EMI-SWITCH2.
  7103     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7104     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7105
  7106
  7107* EXEC CICS HANDLE CONDITION
  7108*        QIDERR     (0100-TEST-ENTRY)
  7109*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7110*        PGMIDERR   (9600-PGMID-ERROR)
  7111*        TERMIDERR  (8820-TERM-ERROR)
  7112*        TRANSIDERR (8830-TRAN-ERROR)
  7113*        ERROR      (9990-ABEND)
  7114*    END-EXEC.
  7115*    MOVE '"$N?L[\.              ! " #00007102' TO DFHEIV0
  7116     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7117     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7118     MOVE X'2220233030303037313032' TO DFHEIV0(25:11)
  7119     CALL 'kxdfhei1' USING DFHEIV0
  7120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7121
  7122
  7123     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7124        PI-CALLING-PROGRAM   = XCTL-6592
  7125         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7126     ELSE
  7127         MOVE SPACES             TO RETURNED-FROM
  7128     END-IF.
  7129
  7130     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7131         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7132             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7133             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 132
* EL130.cbl
  7134             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7135             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7136             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7137             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7138             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7139             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7140         ELSE
  7141             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7142             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7143             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7144             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7145             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7146             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7147             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7148             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7149         END-IF
  7150     END-IF.
  7151
  7152     IF EIBTRNID = TRANS-ID
  7153         IF EIBAID = DFHCLEAR
  7154             GO TO 9400-CLEAR
  7155         ELSE
  7156             GO TO 0200-RECEIVE
  7157         END-IF
  7158     END-IF.
  7159
  7160     IF RETURNED-FROM NOT = SPACES
  7161         GO TO 0600-RECOVER-TEMP-STORAGE
  7162     END-IF.
  7163
  7164     MOVE LOW-VALUES TO EL130AO.
  7165     move zeros to pi-dcc-max-amt
  7166                   pi-dcc-max-benefits
  7167
  7168
  7169
  7170* EXEC CICS DELETEQ TS
  7171*         QUEUE   (QID)
  7172*    END-EXEC.
  7173*    MOVE '*&                    #   #00007157' TO DFHEIV0
  7174     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7175     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7176     MOVE X'2020233030303037313537' TO DFHEIV0(25:11)
  7177     CALL 'kxdfhei1' USING DFHEIV0,
  7178           QID,
  7179           DFHEIV99
  7180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7181
  7182
  7183 0100-TEST-ENTRY.
  7184     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7185         GO TO 0650-FROM-EL127
  7186     ELSE
  7187         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7188                                    PI-CERT-PROCESSED
  7189                                    PI-LETTER-ERROR-CODE
  7190     END-IF.
  7191
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 133
* EL130.cbl
  7192     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7193         GO TO 0640-FROM-EL132
  7194     END-IF.
  7195
  7196     GO TO 8100-SEND-INITIAL-MAP.
  7197
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 134
* EL130.cbl
  7199 0200-RECEIVE.
  7200     MOVE LOW-VALUES             TO EL130AI.
  7201
  7202     IF PI-PROCESSOR-ID = 'LGXX'
  7203*        NEXT SENTENCE
  7204         CONTINUE
  7205     ELSE
  7206
  7207* EXEC CICS READQ TS
  7208*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7209*            INTO    (SECURITY-CONTROL)
  7210*            LENGTH  (SC-COMM-LENGTH)
  7211*            ITEM    (SC-ITEM)
  7212*        END-EXEC
  7213*    MOVE '*$II   L              ''   #00007184' TO DFHEIV0
  7214     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7215     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7216     MOVE X'2020233030303037313834' TO DFHEIV0(25:11)
  7217     CALL 'kxdfhei1' USING DFHEIV0,
  7218           PI-SECURITY-TEMP-STORE-ID,
  7219           SECURITY-CONTROL,
  7220           SC-COMM-LENGTH,
  7221           SC-ITEM,
  7222           DFHEIV99,
  7223           DFHEIV99
  7224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7225         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7226         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7227         IF NOT DISPLAY-CAP
  7228             MOVE 'READ'              TO  SM-READ
  7229             PERFORM 9995-SECURITY-VIOLATION
  7230             MOVE ER-0070             TO  EMI-ERROR
  7231             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7232             GO TO 8100-SEND-INITIAL-MAP
  7233         END-IF
  7234     END-IF.
  7235
  7236     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7237         MOVE ER-7008 TO EMI-ERROR
  7238         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7239         MOVE -1 TO MAINTL
  7240         GO TO 8200-SEND-DATAONLY
  7241     END-IF.
  7242
  7243
  7244
  7245* EXEC CICS RECEIVE
  7246*         MAP     (MAP-NAME)
  7247*         MAPSET  (MAPSET-NAME)
  7248*         INTO    (EL130AI)
  7249*    END-EXEC.
  7250     MOVE LENGTH OF
  7251      EL130AI
  7252       TO DFHEIV11
  7253*    MOVE '8"T I  L              ''   #00007209' TO DFHEIV0
  7254     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7255     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7256     MOVE X'2020233030303037323039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 135
* EL130.cbl
  7257     CALL 'kxdfhei1' USING DFHEIV0,
  7258           MAP-NAME,
  7259           EL130AI,
  7260           DFHEIV11,
  7261           MAPSET-NAME,
  7262           DFHEIV99,
  7263           DFHEIV99
  7264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7265
  7266
  7267     IF NOT PI-NO-CARRIER-SECURITY
  7268        MOVE +1                  TO CLMCARRL
  7269        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7270     END-IF.
  7271
  7272     IF ENTERPFL = ZERO
  7273         GO TO 0300-CHECK-PFKEYS
  7274     END-IF.
  7275
  7276     IF EIBAID NOT = DFHENTER
  7277         MOVE ER-0004            TO EMI-ERROR
  7278         GO TO 0320-INPUT-ERROR
  7279     END-IF.
  7280
  7281     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7282         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7283     ELSE
  7284         MOVE ER-0029            TO EMI-ERROR
  7285         GO TO 0320-INPUT-ERROR
  7286     END-IF.
  7287
  7288 0300-CHECK-PFKEYS.
  7289     IF EIBAID = DFHPF23
  7290         GO TO 8810-PF23
  7291     END-IF.
  7292
  7293     IF EIBAID = DFHPF24
  7294         GO TO 9200-RETURN-MAIN-MENU
  7295     END-IF.
  7296
  7297     IF EIBAID = DFHPF12
  7298         GO TO 9500-PF12
  7299     END-IF.
  7300
  7301     IF EIBAID = DFHPF3
  7302         MOVE SPACES              TO MAINTI
  7303         MOVE ZEROS               TO MAINTL
  7304         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7305         MOVE XCTL-127            TO PGM-NAME
  7306         GO TO 9300-XCTL
  7307     END-IF.
  7308
  7309     IF EIBAID = DFHPF4
  7310         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7311         MOVE XCTL-132            TO PGM-NAME
  7312         GO TO 9300-XCTL
  7313     END-IF.
  7314
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 136
* EL130.cbl
  7315     IF EIBAID = DFHPF13
  7316         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7317             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7318             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7319             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7320             MOVE PI-STATE            TO  PI-CR-STATE
  7321             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7322             MOVE XCTL-650            TO  PGM-NAME
  7323             GO TO 9300-XCTL
  7324         ELSE
  7325             MOVE -1                  TO  ENTERPFL
  7326             MOVE ER-2566             TO  EMI-ERROR
  7327             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7328             GO TO 8100-SEND-INITIAL-MAP
  7329         END-IF
  7330     END-IF.
  7331
  7332     IF EIBAID = DFHPF5
  7333         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7334             ADD +1 TO PI-CERT-PROCESSED
  7335             GO TO 0650-FROM-EL127
  7336         ELSE
  7337             MOVE ER-7686         TO EMI-ERROR
  7338             GO TO 0320-INPUT-ERROR
  7339         END-IF
  7340     END-IF.
  7341
  7342     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7343         GO TO 0800-TEST-PREVIOUS-CONTROL
  7344     END-IF.
  7345
  7346     IF PI-HAS-CLAS-IC-CRDTCRD
  7347         IF EIBAID = DFHPF10
  7348             MOVE XCTL-725          TO PGM-NAME
  7349             GO TO 9300-XCTL
  7350         END-IF
  7351     END-IF.
  7352
  7353     IF EIBAID = DFHPF14
  7354         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7355         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7356         MOVE XCTL-659            TO PGM-NAME
  7357         GO TO 9300-XCTL
  7358     END-IF.
  7359
  7360     IF EIBAID = DFHPF15
  7361         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7362         MOVE XCTL-114            TO PGM-NAME
  7363         GO TO 9300-XCTL
  7364     END-IF.
  7365
  7366*    IF EIBAID = DFHPF11
  7367*       GO TO 0600-RECOVER-TEMP-STORAGE
  7368*    END-IF
  7369     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7370         GO TO 0330-EDIT-DATA
  7371     END-IF.
  7372
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 137
* EL130.cbl
  7373     MOVE ER-0029                TO EMI-ERROR.
  7374
  7375 0320-INPUT-ERROR.
  7376     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7377
  7378     MOVE AL-UNBON               TO ENTERPFA.
  7379
  7380     IF ENTERPFL = ZERO
  7381         MOVE -1                 TO MAINTL
  7382     ELSE
  7383         MOVE -1                 TO ENTERPFL
  7384     END-IF.
  7385
  7386     GO TO 8200-SEND-DATAONLY.
  7387
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 138
* EL130.cbl
  7389 0330-EDIT-DATA.
  7390
  7391     IF MAINTI = 'S'
  7392         IF PRTOPTL GREATER THAN 0
  7393             IF PRTOPTI NOT = 'N' AND 'L'
  7394                 MOVE AL-UABON   TO  PRTOPTA
  7395                 MOVE -1         TO  PRTOPTL
  7396                 MOVE ER-0334    TO  EMI-ERROR
  7397                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7398                 GO TO 8200-SEND-DATAONLY
  7399             ELSE
  7400                 IF PRTOPTI = 'L'
  7401                     GO TO 0400-CREATE-ELACTQ
  7402                 ELSE
  7403                     GO TO 0480-PRINT-NOW
  7404                 END-IF
  7405             END-IF
  7406         ELSE
  7407             GO TO 1000-SHOW-CLAIM
  7408         END-IF
  7409     END-IF.
  7410
  7411     IF NOT MODIFY-CAP
  7412         MOVE 'UPDATE'       TO  SM-READ
  7413         PERFORM 9995-SECURITY-VIOLATION
  7414         MOVE ER-0070        TO  EMI-ERROR
  7415         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7416         GO TO 8100-SEND-INITIAL-MAP
  7417     END-IF.
  7418
  7419     IF MAINTI = 'D'
  7420         GO TO 2000-DELETE-CLAIM
  7421     END-IF.
  7422
  7423     IF MAINTI = 'A'
  7424         GO TO 3000-ADD-CLAIM
  7425     END-IF.
  7426
  7427     IF MAINTI = 'I'
  7428         GO TO 5000-INCURRED-CHANGE
  7429     END-IF.
  7430
  7431     MOVE ER-0023                TO EMI-ERROR.
  7432     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7433     MOVE -1                     TO MAINTL.
  7434     MOVE AL-UABON               TO MAINTA.
  7435
  7436     GO TO 8200-SEND-DATAONLY.
  7437
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 139
* EL130.cbl
  7439 0400-CREATE-ELACTQ.
  7440     IF CLMNOI   = PI-LAST-CLAIM      AND
  7441        CLMCARRI = PI-LAST-CARR       AND
  7442        CERTNOI  = PI-LAST-CERT-PRIME AND
  7443        SUFXI    = PI-LAST-CERT-SUFX
  7444         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7445         MOVE PI-LAST-CARR       TO PI-CARRIER
  7446         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7447     ELSE
  7448         MOVE ER-0207            TO EMI-ERROR
  7449         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7450         MOVE -1                 TO MAINTL
  7451         GO TO 8200-SEND-DATAONLY
  7452     END-IF.
  7453
  7454     IF (NOT PI-NO-CARRIER-SECURITY OR
  7455         NOT PI-NO-ACCOUNT-SECURITY)
  7456         MOVE AL-UABON      TO  PRTOPTA
  7457         MOVE -1            TO  PRTOPTL
  7458         MOVE ER-2378       TO  EMI-ERROR
  7459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7460         GO TO 8200-SEND-DATAONLY
  7461     END-IF.
  7462
  7463     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7464     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7465     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7466     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7467
  7468
  7469
  7470* EXEC CICS HANDLE CONDITION
  7471*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7472*    END-EXEC.
  7473*    MOVE '"$I                   ! # #00007417' TO DFHEIV0
  7474     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7475     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7476     MOVE X'2320233030303037343137' TO DFHEIV0(25:11)
  7477     CALL 'kxdfhei1' USING DFHEIV0
  7478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7479
  7480
  7481
  7482
  7483* EXEC CICS READ
  7484*         UPDATE
  7485*         DATASET    (ELACTQ-DSID)
  7486*         SET        (ADDRESS OF ACTIVITY-QUE)
  7487*         RIDFLD     (ELACTQ-KEY)
  7488*    END-EXEC.
  7489*    MOVE '&"S        EU         (   #00007422' TO DFHEIV0
  7490     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7491     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7492     MOVE X'2020233030303037343232' TO DFHEIV0(25:11)
  7493     CALL 'kxdfhei1' USING DFHEIV0,
  7494           ELACTQ-DSID,
  7495           DFHEIV20,
  7496           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 140
* EL130.cbl
  7497           ELACTQ-KEY,
  7498           DFHEIV99,
  7499           DFHEIV99,
  7500           DFHEIV99
  7501     SET ADDRESS OF ACTIVITY-QUE TO
  7502         DFHEIV20
  7503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7504
  7505
  7506     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7507     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7508
  7509
  7510
  7511* EXEC CICS REWRITE
  7512*         DATASET     (ELACTQ-DSID)
  7513*         FROM        (ACTIVITY-QUE)
  7514*    END-EXEC.
  7515     MOVE LENGTH OF
  7516      ACTIVITY-QUE
  7517       TO DFHEIV11
  7518*    MOVE '&& L                  %   #00007433' TO DFHEIV0
  7519     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7520     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7521     MOVE X'2020233030303037343333' TO DFHEIV0(25:11)
  7522     CALL 'kxdfhei1' USING DFHEIV0,
  7523           ELACTQ-DSID,
  7524           ACTIVITY-QUE,
  7525           DFHEIV11,
  7526           DFHEIV99
  7527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7528
  7529
  7530     GO TO 0470-STATUS-FINISH.
  7531
  7532 0450-ADD-ELACTQ-RECORD.
  7533
  7534
  7535* EXEC CICS GETMAIN
  7536*        SET     (ADDRESS OF ACTIVITY-QUE)
  7537*        LENGTH  (ELACTQ-LENGTH)
  7538*        INITIMG (GETMAIN-SPACE)
  7539*    END-EXEC.
  7540*    MOVE ',"IL                  $   #00007442' TO DFHEIV0
  7541     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7542     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7543     MOVE X'2020233030303037343432' TO DFHEIV0(25:11)
  7544     CALL 'kxdfhei1' USING DFHEIV0,
  7545           DFHEIV20,
  7546           ELACTQ-LENGTH,
  7547           GETMAIN-SPACE
  7548     SET ADDRESS OF ACTIVITY-QUE TO
  7549         DFHEIV20
  7550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7551
  7552
  7553     MOVE 'AQ'              TO AQ-RECORD-ID.
  7554     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 141
* EL130.cbl
  7555     MOVE +0                TO AQ-PAYMENT-COUNTER
  7556                               AQ-PMT-UNAPPROVED-COUNT.
  7557     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7558                               AQ-FOLLOWUP-DATE.
  7559     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7560     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7561
  7562
  7563
  7564* EXEC CICS WRITE
  7565*         DATASET     (ELACTQ-DSID)
  7566*         FROM        (ACTIVITY-QUE)
  7567*         RIDFLD      (ELACTQ-KEY)
  7568*    END-EXEC.
  7569     MOVE LENGTH OF
  7570      ACTIVITY-QUE
  7571       TO DFHEIV11
  7572*    MOVE '&$ L                  ''   #00007458' TO DFHEIV0
  7573     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7574     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7575     MOVE X'2020233030303037343538' TO DFHEIV0(25:11)
  7576     CALL 'kxdfhei1' USING DFHEIV0,
  7577           ELACTQ-DSID,
  7578           ACTIVITY-QUE,
  7579           DFHEIV11,
  7580           ELACTQ-KEY,
  7581           DFHEIV99,
  7582           DFHEIV99
  7583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7584
  7585
  7586 0470-STATUS-FINISH.
  7587     MOVE AL-UANOF               TO  PRTOPTA
  7588                                     ALTPRTA.
  7589
  7590     MOVE SPACES                 TO  PRTOPTO
  7591                                     ALTPRTO.
  7592
  7593     MOVE ER-0000                TO EMI-ERROR.
  7594     MOVE -1                     TO MAINTL.
  7595     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7596     GO TO 8100-SEND-INITIAL-MAP.
  7597
  7598 0480-PRINT-NOW.
  7599
  7600
  7601* EXEC CICS HANDLE CONDITION
  7602*        TERMIDERR   (8820-TERM-ERROR)
  7603*        TRANSIDERR  (8830-TRAN-ERROR)
  7604*    END-EXEC.
  7605*    MOVE '"$[\                  ! $ #00007478' TO DFHEIV0
  7606     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7608     MOVE X'2420233030303037343738' TO DFHEIV0(25:11)
  7609     CALL 'kxdfhei1' USING DFHEIV0
  7610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7611
  7612
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 142
* EL130.cbl
  7613     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7614     MOVE '1'                    TO  CNTL-REC-TYPE.
  7615     MOVE SPACES                 TO  CNTL-ACCESS.
  7616     MOVE +0                     TO  CNTL-SEQ-NO.
  7617     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7618
  7619     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7620
  7621     IF CF-FORMS-PRINTER-ID = SPACES
  7622         IF ALTPRTL NOT GREATER THAN 0
  7623             MOVE ER-0337        TO  EMI-ERROR
  7624             MOVE -1             TO  ALTPRTL
  7625             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7626             GO TO 8200-SEND-DATAONLY
  7627         END-IF
  7628     END-IF.
  7629
  7630     IF ALTPRTL GREATER THAN 0
  7631         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7632     END-IF.
  7633
  7634     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7635     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7636     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7637
  7638
  7639
  7640* EXEC CICS START
  7641*        TRANSID   (START-TRANS-ID)
  7642*        TERMID    (CF-FORMS-PRINTER-ID)
  7643*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7644*        LENGTH    (PI-COMM-LENGTH)
  7645*    END-EXEC.
  7646*    MOVE '0( LFT                1   #00007509' TO DFHEIV0
  7647     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7648     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7649     MOVE X'2020233030303037353039' TO DFHEIV0(25:11)
  7650     CALL 'kxdfhei1' USING DFHEIV0,
  7651           DFHEIV99,
  7652           START-TRANS-ID,
  7653           DFHEIV99,
  7654           PROGRAM-INTERFACE-BLOCK,
  7655           PI-COMM-LENGTH,
  7656           CF-FORMS-PRINTER-ID,
  7657           DFHEIV99,
  7658           DFHEIV99,
  7659           DFHEIV99,
  7660           DFHEIV99,
  7661           DFHEIV99,
  7662           DFHEIV99,
  7663           DFHEIV99,
  7664           DFHEIV99,
  7665           DFHEIV99,
  7666           DFHEIV99
  7667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7668
  7669
  7670     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 143
* EL130.cbl
  7671                                     ALTPRTA.
  7672
  7673     MOVE SPACES                 TO  PRTOPTO
  7674                                     ALTPRTO.
  7675
  7676     MOVE ER-0000                TO  EMI-ERROR.
  7677     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7678     MOVE -1                     TO  MAINTL.
  7679     GO TO 8100-SEND-INITIAL-MAP.
  7680
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 144
* EL130.cbl
  7682 0500-CREATE-TEMP-STORAGE.
  7683     MOVE EIBCPOSN               TO PI-CURSOR.
  7684
  7685    move emi-line1               to errmsg1o
  7686    move emi-line2               to errmsg2o
  7687    move emi-sub                 to pi-emi-sub
  7688
  7689
  7690* EXEC CICS WRITEQ TS
  7691*        QUEUE   (QID)
  7692*        FROM    (EL130AI)
  7693*        LENGTH  (QID-MAP-LENGTH)
  7694*    END-EXEC.
  7695*    MOVE '*"                    ''   #00007535' TO DFHEIV0
  7696     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7697     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7698     MOVE X'2020233030303037353335' TO DFHEIV0(25:11)
  7699     CALL 'kxdfhei1' USING DFHEIV0,
  7700           QID,
  7701           EL130AI,
  7702           QID-MAP-LENGTH,
  7703           DFHEIV99,
  7704           DFHEIV99,
  7705           DFHEIV99
  7706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7707
  7708
  7709
  7710
  7711* EXEC CICS WRITEQ TS
  7712*        QUEUE    (QID)
  7713*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7714*        LENGTH   (PI-COMM-LENGTH)
  7715*    END-EXEC.
  7716*    MOVE '*"                    ''   #00007542' TO DFHEIV0
  7717     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7719     MOVE X'2020233030303037353432' TO DFHEIV0(25:11)
  7720     CALL 'kxdfhei1' USING DFHEIV0,
  7721           QID,
  7722           PROGRAM-INTERFACE-BLOCK,
  7723           PI-COMM-LENGTH,
  7724           DFHEIV99,
  7725           DFHEIV99,
  7726           DFHEIV99
  7727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7728
  7729
  7730 0599-EXIT.
  7731      EXIT.
  7732
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 145
* EL130.cbl
  7734 0600-RECOVER-TEMP-STORAGE.
  7735     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7736     MOVE PI-EL127-TO-EL130-CNTRL
  7737                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7738     MOVE PI-EL659-TO-EL130-CNTRL
  7739                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7740     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7741     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7742     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7743     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7744     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7745     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7746     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7747     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7748     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7749     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7750     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7751     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7752     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7753     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7754     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7755     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7756                                 TO SAVE-BENEFICIARY
  7757
  7758
  7759
  7760* EXEC CICS HANDLE CONDITION
  7761*        NOTFND  (0660-NOT-FOUND)
  7762*        QIDERR  (0670-QIDERR)
  7763*    END-EXEC.
  7764*    MOVE '"$IN                  ! % #00007577' TO DFHEIV0
  7765     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7767     MOVE X'2520233030303037353737' TO DFHEIV0(25:11)
  7768     CALL 'kxdfhei1' USING DFHEIV0
  7769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7770
  7771
  7772
  7773
  7774* EXEC CICS READQ TS
  7775*        QUEUE    (QID)
  7776*        INTO     (EL130AI)
  7777*        LENGTH   (QID-MAP-LENGTH)
  7778*    END-EXEC.
  7779*    MOVE '*$I    L              ''   #00007583' TO DFHEIV0
  7780     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7781     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7782     MOVE X'2020233030303037353833' TO DFHEIV0(25:11)
  7783     CALL 'kxdfhei1' USING DFHEIV0,
  7784           QID,
  7785           EL130AI,
  7786           QID-MAP-LENGTH,
  7787           DFHEIV99,
  7788           DFHEIV99,
  7789           DFHEIV99
  7790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7791
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 146
* EL130.cbl
  7792
  7793     IF RETURNED-FROM = XCTL-131
  7794        IF CLAIM-DELETED-BY-EL131
  7795            MOVE LOW-VALUES      TO CERTNOI
  7796                                    SUFXI
  7797            MOVE ZEROS           TO CERTNOL
  7798                                    SUFXL
  7799         END-IF
  7800     END-IF.
  7801
  7802     IF RETURNED-FROM = XCTL-131
  7803         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7804         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7805                                    PI-CERT-PROCESSED
  7806     ELSE
  7807
  7808
  7809* EXEC CICS READQ TS
  7810*             QUEUE   (QID)
  7811*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7812*             LENGTH  (PI-COMM-LENGTH)
  7813*        END-EXEC
  7814*    MOVE '*$I    L              ''   #00007604' TO DFHEIV0
  7815     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7816     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7817     MOVE X'2020233030303037363034' TO DFHEIV0(25:11)
  7818     CALL 'kxdfhei1' USING DFHEIV0,
  7819           QID,
  7820           PROGRAM-INTERFACE-BLOCK,
  7821           PI-COMM-LENGTH,
  7822           DFHEIV99,
  7823           DFHEIV99,
  7824           DFHEIV99
  7825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7826     END-IF.
  7827
  7828
  7829* EXEC CICS DELETEQ TS
  7830*        QUEUE   (QID)
  7831*    END-EXEC.
  7832*    MOVE '*&                    #   #00007611' TO DFHEIV0
  7833     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7834     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7835     MOVE X'2020233030303037363131' TO DFHEIV0(25:11)
  7836     CALL 'kxdfhei1' USING DFHEIV0,
  7837           QID,
  7838           DFHEIV99
  7839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7840
  7841
  7842     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7843
  7844     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7845         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7846         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7847         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7848         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7849         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 147
* EL130.cbl
  7850         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7851         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7852         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7853         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7854         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7855         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7856         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7857         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7858         MOVE SAVE-CERT-ACCESS-CONTROL
  7859                                    TO PI-CERT-ACCESS-CONTROL
  7860         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7861                                    TO PI-CARRIER-CONTROL-LEVEL
  7862     END-IF.
  7863
  7864*    IF EIBAID = DFHPF11
  7865*       move errmsg1i            to emi-line1
  7866*       move errmsg2i            to emi-line2
  7867*       move pi-emi-sub          to emi-sub
  7868*       go to 8200-SEND-DATAONLY
  7869*    end-if
  7870     IF RETURNED-FROM = XCTL-127
  7871         MOVE SAVE-EL127-TO-EL130-CNTRL
  7872                                 TO PI-EL127-TO-EL130-CNTRL
  7873     END-IF.
  7874
  7875     IF RETURNED-FROM = XCTL-6592
  7876        MOVE SAVE-EL659-TO-EL130-CNTRL
  7877                                 TO PI-EL659-TO-EL130-CNTRL
  7878     END-IF.
  7879
  7880     IF RETURNED-FROM = XCTL-114
  7881        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7882           MOVE SAVE-BENEFICIARY TO BENECDI
  7883           MOVE +10              TO BENECDL
  7884           MOVE -1               TO BIRTHDTL
  7885        END-IF
  7886     END-IF.
  7887     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7888
  7889     IF MAINTL NOT = ZERO
  7890         MOVE AL-UANON           TO MAINTA
  7891     END-IF.
  7892
  7893     IF ENTERPFL NOT = ZERO
  7894         MOVE AL-UNNON           TO ENTERPFA
  7895     END-IF.
  7896
  7897     IF RETURNED-FROM = XCTL-127
  7898         GO TO 0650-FROM-EL127
  7899     END-IF.
  7900
  7901     IF RETURNED-FROM = XCTL-132
  7902         GO TO 0640-FROM-EL132
  7903     END-IF.
  7904
  7905     IF RETURNED-FROM = XCTL-650
  7906         MOVE AL-SABON           TO PF5A
  7907         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 148
* EL130.cbl
  7908     END-IF.
  7909
  7910     IF RETURNED-FROM = XCTL-6592
  7911         GO TO 0630-FROM-EL6592
  7912     END-IF.
  7913
  7914     IF MAINTI = 'S' OR 'I'
  7915        GO TO 1000-SHOW-CLAIM
  7916     END-IF.
  7917
  7918     GO TO 8100-SEND-INITIAL-MAP.
  7919
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 149
* EL130.cbl
  7921 0630-FROM-EL6592.
  7922     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7923     MOVE PI-EL659-GROUPING      TO GROUPO.
  7924     MOVE PI-EL659-STATE         TO STATEO.
  7925     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7926
  7927     MOVE AL-UANON               TO CRTCARRA
  7928                                    GROUPA
  7929                                    STATEA
  7930                                    ACCOUNTA.
  7931     GO TO 8100-SEND-INITIAL-MAP.
  7932
  7933 0640-FROM-EL132.
  7934     IF PI-CLAIM-NO = SPACES
  7935         GO TO 0645-NO-CLAIM-SELECTED
  7936     END-IF.
  7937
  7938     MOVE LOW-VALUES             TO EL130AI.
  7939     MOVE 'MSTR'                 TO FILE-SWITCH.
  7940     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7941     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7942     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7943                                    CLMNOO.
  7944     MOVE AL-UANON               TO CLMNOA.
  7945     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7946
  7947
  7948
  7949* EXEC CICS HANDLE CONDITION
  7950*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  7951*    END-EXEC.
  7952*    MOVE '"$I                   ! & #00007721' TO DFHEIV0
  7953     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7954     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7955     MOVE X'2620233030303037373231' TO DFHEIV0(25:11)
  7956     CALL 'kxdfhei1' USING DFHEIV0
  7957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7958
  7959
  7960     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  7961     MOVE 'X'                    TO CLAIM-SWITCH.
  7962     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  7963     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  7964     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  7965     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  7966     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  7967     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7968
  7969     MOVE ER-0213                TO EMI-ERROR.
  7970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7971     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  7972     GO TO 8100-SEND-INITIAL-MAP.
  7973
  7974 0645-NO-CLAIM-SELECTED.
  7975
  7976     IF MAINTI = 'S' OR 'I'
  7977        GO TO 1000-SHOW-CLAIM
  7978     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 150
* EL130.cbl
  7979
  7980     GO TO 8100-SEND-INITIAL-MAP.
  7981
  7982 0650-FROM-EL127.
  7983
  7984     IF PI-CERT-SELECT-CNT GREATER THAN +6
  7985         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7986                                    PI-CERT-PROCESSED
  7987     END-IF.
  7988
  7989     IF PI-RETURN-TO-PROGRAM = XCTL-727
  7990         MOVE +1                 TO PI-CERT-SELECT-CNT
  7991                                    PI-CERT-PROCESSED
  7992         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  7993         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  7994         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  7995         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  7996         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  7997         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  7998     END-IF.
  7999
  8000     IF PI-CERT-SELECT-CNT = ZERO
  8001         IF CERTNOI NOT = SPACES AND LOW-VALUES
  8002             MOVE CERTNOI        TO PI-CERT-NO
  8003             MOVE SUFXI          TO PI-CERT-SFX
  8004             GO TO 3000-READ-CERT
  8005         ELSE
  8006             GO TO 8100-SEND-INITIAL-MAP
  8007         END-IF
  8008     END-IF.
  8009
  8010     MOVE AL-SABON               TO PF5A.
  8011
  8012     IF PI-CERT-PROCESSED = 1
  8013         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  8014     END-IF.
  8015
  8016     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  8017     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  8018
  8019     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  8020     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  8021                                 TO CERT-CARRIER
  8022                                    PI-CARRIER.
  8023     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  8024                                 TO CERT-GROUPING
  8025                                    PI-GROUPING.
  8026     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  8027                                 TO CERT-STATE
  8028                                    PI-STATE.
  8029     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8030                                 TO CERT-ACCOUNT
  8031                                    PI-ACCOUNT.
  8032     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8033                                 TO CERT-EFF-DT
  8034                                    PI-CERT-EFF-DT.
  8035     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8036                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 151
* EL130.cbl
  8037                                    PI-CERT-NO.
  8038
  8039     MOVE 'CERT'                 TO FILE-SWITCH.
  8040     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8041
  8042     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8043     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8044     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8045
  8046     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8047         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8048         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8049         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8050         IF INCURRED-DATE-MATCH
  8051             MOVE ER-7352        TO EMI-ERROR
  8052             MOVE -1             TO CERTNOL
  8053             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8054         ELSE
  8055             IF NO-CLAIMS-FOR-CERT
  8056                 MOVE ER-7353    TO EMI-ERROR
  8057                 MOVE -1         TO CERTNOL
  8058                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8059             ELSE
  8060                 MOVE ER-0558    TO EMI-ERROR
  8061                 MOVE -1         TO CERTNOL
  8062                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8063             END-IF
  8064         END-IF
  8065     END-IF.
  8066
  8067     MOVE SPACES                 TO PI-PRT-OPT
  8068                                    PI-ALT-PRT.
  8069
  8070     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8071
  8072     if (ws-lf-joint-indicator not = 'J')
  8073        and (ws-ah-joint-indicator not = 'J')
  8074        move 'P'                 to INSTYPEO
  8075        MOVE AL-UANON            TO INSTYPEA
  8076     end-if
  8077     IF LSTNMEL NOT GREATER ZERO
  8078        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8079         MOVE CRTLNMEI           TO  LSTNMEO
  8080         MOVE CRTFNMEI           TO  FSTNMEO
  8081         MOVE CRTINITI           TO  INITO
  8082         MOVE AL-UANON           TO  LSTNMEA
  8083                                     FSTNMEA
  8084                                     INITA
  8085     END-IF.
  8086
  8087     IF SSNL GREATER ZERO
  8088         GO TO 0655-SKIP-SOCIAL-SECURITY
  8089     END-IF.
  8090
  8091     IF CRTSSNI = SPACES OR LOW-VALUES
  8092         GO TO 0655-SKIP-SOCIAL-SECURITY
  8093     END-IF.
  8094
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 152
* EL130.cbl
  8095     IF CM-SSN-STATE   = CM-STATE AND
  8096        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8097            GO TO 0655-SKIP-SOCIAL-SECURITY
  8098     END-IF.
  8099
  8100     MOVE CRTSSNI                TO SSNO
  8101     MOVE AL-UANON               TO SSNA.
  8102
  8103 0655-SKIP-SOCIAL-SECURITY.
  8104
  8105     IF CLMCARRL NOT = ZERO  AND
  8106        CLMCARRI NOT = CRTCARRI
  8107        MOVE ER-0562             TO EMI-ERROR
  8108        MOVE AL-UABON            TO CLMCARRA
  8109        MOVE -1                  TO CLMCARRL
  8110        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8111     END-IF.
  8112
  8113     IF CLMCARRL = ZERO
  8114        MOVE AL-UANON            TO CLMCARRA
  8115        MOVE CRTCARRI            TO CLMCARRI
  8116     END-IF.
  8117
  8118     MOVE 'A'                    TO MAINTO.
  8119     MOVE AL-UANON               TO MAINTA.
  8120
  8121     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8122        GO TO 8100-SEND-INITIAL-MAP
  8123     ELSE
  8124        GO TO 8150-SEND-MAP-CURSOR
  8125     END-IF.
  8126
  8127 0660-NOT-FOUND.
  8128     MOVE ER-0214                TO EMI-ERROR.
  8129     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8130     GO TO 8100-SEND-INITIAL-MAP.
  8131
  8132 0670-QIDERR.
  8133     MOVE ER-0033                TO EMI-ERROR.
  8134     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8135     GO TO 8100-SEND-INITIAL-MAP.
  8136
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 153
* EL130.cbl
  8138 0680-PLUG-SELECTED-CERTS.
  8139
  8140     MOVE AL-SANON               TO BCERT1A
  8141                                    BSUFX1A
  8142                                    BCERT2A
  8143                                    BSUFX2A
  8144                                    BCERT3A
  8145                                    BSUFX3A
  8146                                    BCERT4A
  8147                                    BSUFX4A
  8148                                    BCERT5A
  8149                                    BSUFX5A.
  8150
  8151     IF PCERTNOO = SPACES OR LOW-VALUES
  8152         MOVE PI-EL127-CERT-PRIME (1)
  8153                                 TO PCERTNOO
  8154         MOVE PI-EL127-CERT-SUFX  (1)
  8155                                 TO PSUFXO
  8156     END-IF.
  8157
  8158     MOVE PI-EL127-CERT-PRIME (1)
  8159                                 TO BCERT1O.
  8160     MOVE PI-EL127-CERT-SUFX  (1)
  8161                                 TO BSUFX1O.
  8162
  8163     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8164         MOVE PI-EL127-CERT-PRIME (2)
  8165                                 TO BCERT2O
  8166         MOVE PI-EL127-CERT-SUFX  (2)
  8167                                 TO BSUFX2O
  8168     ELSE
  8169         MOVE LOW-VALUES         TO BCERT2O
  8170                                    BSUFX2O
  8171     END-IF.
  8172
  8173     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8174         MOVE PI-EL127-CERT-PRIME (3)
  8175                                 TO BCERT3O
  8176         MOVE PI-EL127-CERT-SUFX  (3)
  8177                                 TO BSUFX3O
  8178     ELSE
  8179         MOVE LOW-VALUES         TO BCERT3O
  8180                                    BSUFX3O
  8181     END-IF.
  8182
  8183     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8184         MOVE PI-EL127-CERT-PRIME (4)
  8185                                 TO BCERT4O
  8186         MOVE PI-EL127-CERT-SUFX  (4)
  8187                                 TO BSUFX4O
  8188     ELSE
  8189         MOVE LOW-VALUES         TO BCERT4O
  8190                                    BSUFX4O
  8191     END-IF.
  8192
  8193     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8194         MOVE PI-EL127-CERT-PRIME (5)
  8195                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 154
* EL130.cbl
  8196         MOVE PI-EL127-CERT-SUFX  (5)
  8197                                 TO BSUFX5O
  8198     ELSE
  8199         MOVE LOW-VALUES         TO BCERT5O
  8200                                    BSUFX5O
  8201     END-IF.
  8202
  8203 0680-EXIT.
  8204     EXIT.
  8205
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 155
* EL130.cbl
  8207 0690-HIGHLIGHT-CERTS.
  8208
  8209     MOVE AL-UANON               TO PCERTNOA
  8210                                    PSUFXA.
  8211
  8212     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8213        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8214            MOVE AL-SABON        TO BCERT1A
  8215                                    BSUFX1A
  8216     ELSE
  8217         MOVE AL-SANON           TO BCERT1A
  8218                                    BSUFX1A
  8219     END-IF.
  8220
  8221     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8222        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8223            MOVE AL-SABON        TO BCERT2A
  8224                                    BSUFX2A
  8225     ELSE
  8226         MOVE AL-SANON           TO BCERT2A
  8227                                    BSUFX2A
  8228     END-IF.
  8229
  8230     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8231        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8232            MOVE AL-SABON        TO BCERT3A
  8233                                    BSUFX3A
  8234     ELSE
  8235         MOVE AL-SANON           TO BCERT3A
  8236                                    BSUFX3A
  8237     END-IF.
  8238
  8239     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8240        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8241            MOVE AL-SABON        TO BCERT4A
  8242                                    BSUFX4A
  8243     ELSE
  8244         MOVE AL-SANON           TO BCERT4A
  8245                                    BSUFX4A
  8246     END-IF.
  8247
  8248     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8249        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8250            MOVE AL-SABON        TO BCERT5A
  8251                                    BSUFX5A
  8252     ELSE
  8253         MOVE AL-SANON           TO BCERT5A
  8254                                    BSUFX5A
  8255     END-IF.
  8256
  8257 0690-EXIT.
  8258     EXIT.
  8259
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 156
* EL130.cbl
  8261 0800-TEST-PREVIOUS-CONTROL.
  8262     IF CLMNOI   = PI-LAST-CLAIM       AND
  8263        CLMCARRI = PI-LAST-CARR        AND
  8264        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8265        SUFXI    = PI-LAST-CERT-SUFX
  8266*        NEXT SENTENCE
  8267         CONTINUE
  8268     ELSE
  8269         MOVE ER-0207            TO EMI-ERROR
  8270         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8271         MOVE -1                 TO MAINTL
  8272         GO TO 8200-SEND-DATAONLY
  8273     END-IF.
  8274
  8275     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8276
  8277     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8278     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8279     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8280
  8281     IF EIBAID = DFHPF7
  8282         MOVE XCTL-157           TO PGM-NAME
  8283     END-IF.
  8284
  8285     IF EIBAID = DFHPF8
  8286         MOVE XCTL-141           TO PGM-NAME
  8287     END-IF.
  8288
  8289     IF EIBAID = DFHPF9
  8290        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8291                                    PI-SAVED-PROGRAM-2
  8292                                    PI-SAVED-PROGRAM-3
  8293                                    PI-SAVED-PROGRAM-4
  8294                                    PI-SAVED-PROGRAM-5
  8295                                    PI-SAVED-PROGRAM-6
  8296        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8297        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8298        MOVE XCTL-150            TO PGM-NAME
  8299     END-IF.
  8300
  8301     GO TO 9300-XCTL.
  8302
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 157
* EL130.cbl
  8304 1000-SHOW-CLAIM.
  8305
  8306     IF CLMNOL = ZERO
  8307         MOVE -1                 TO CLMNOL
  8308         MOVE AL-UABON           TO CLMNOA
  8309         MOVE ER-0202            TO EMI-ERROR
  8310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8311     ELSE
  8312         MOVE AL-UANON           TO CLMNOA
  8313     END-IF.
  8314
  8315     IF PI-NO-CARRIER-SECURITY
  8316        IF CLMCARRL = ZERO
  8317             MOVE -1             TO CLMCARRL
  8318             MOVE AL-UABON       TO CLMCARRA
  8319             MOVE ER-0194        TO EMI-ERROR
  8320             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8321         ELSE
  8322             MOVE AL-UANON       TO CLMCARRA
  8323         END-IF
  8324     END-IF.
  8325
  8326     IF SUFXL = ZERO
  8327         MOVE SPACES             TO SUFXI
  8328         MOVE AL-UANON           TO SUFXA
  8329     ELSE
  8330         MOVE AL-UANON           TO SUFXA
  8331     END-IF.
  8332
  8333     IF NOT EMI-NO-ERRORS
  8334         GO TO 1050-SEND-CHECK
  8335     END-IF.
  8336
  8337
  8338
  8339* EXEC CICS HANDLE CONDITION
  8340*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8341*    END-EXEC.
  8342*    MOVE '"$I                   ! '' #00008103' TO DFHEIV0
  8343     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8345     MOVE X'2720233030303038313033' TO DFHEIV0(25:11)
  8346     CALL 'kxdfhei1' USING DFHEIV0
  8347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8348
  8349
  8350     MOVE 'MSTR'                 TO FILE-SWITCH
  8351     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8352
  8353     MOVE CLMCARRI               TO MSTR-CARRIER.
  8354     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8355
  8356     IF CERTNOL = ZERO     OR
  8357        CERTNOI = SPACES   OR
  8358        CERTNOI = LOW-VALUES
  8359         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8360         MOVE AL-SANON        TO CERTNOA
  8361                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 158
* EL130.cbl
  8362     ELSE
  8363         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8364     END-IF.
  8365
  8366     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8367     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8368
  8369
  8370
  8371* EXEC CICS HANDLE CONDITION
  8372*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8373*    END-EXEC.
  8374*    MOVE '"$I                   ! ( #00008127' TO DFHEIV0
  8375     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8376     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8377     MOVE X'2820233030303038313237' TO DFHEIV0(25:11)
  8378     CALL 'kxdfhei1' USING DFHEIV0
  8379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8380
  8381
  8382     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8383
  8384     IF NOT PI-NO-ACCOUNT-SECURITY
  8385         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8386           MOVE ER-2371          TO EMI-ERROR
  8387           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8388           MOVE -1               TO MAINTL
  8389           GO TO 8200-SEND-DATAONLY
  8390         END-IF
  8391     END-IF.
  8392
  8393
  8394
  8395* EXEC CICS HANDLE CONDITION
  8396*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8397*    END-EXEC.
  8398*    MOVE '"$I                   ! ) #00008143' TO DFHEIV0
  8399     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8401     MOVE X'2920233030303038313433' TO DFHEIV0(25:11)
  8402     CALL 'kxdfhei1' USING DFHEIV0
  8403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8404
  8405
  8406     MOVE 'Y'                    TO CLAIM-SWITCH.
  8407     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8408     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8409     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8410     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8411     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8412
  8413 1000-SHOW-END-OF-PERFORM.
  8414
  8415     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8416     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8417     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8418     MOVE CL-CERT-STATE          TO CERT-STATE.
  8419     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 159
* EL130.cbl
  8420     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8421     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8422
  8423     MOVE 'CERT'                 TO FILE-SWITCH.
  8424
  8425     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8426
  8427     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8428     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8429     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8430     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8431     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8432     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8433     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8434     MOVE CLMCARRI               TO PI-LAST-CARR.
  8435
  8436     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8437
  8438     IF MAINTI = 'I'
  8439         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8440                 BIRTHDTA  LSTNMEA   RELCLMA
  8441                 LOANNOA   LOANBALA  BENECDA
  8442         MOVE AL-SANON TO  SSNA
  8443         MOVE SPACES   TO  INCURI    REPORTI
  8444         MOVE 'Y'      TO PI-INCURR-SW
  8445         MOVE ER-0522  TO EMI-ERROR
  8446         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8447     ELSE
  8448         MOVE ' '      TO PI-INCURR-SW
  8449     END-IF.
  8450
  8451     MOVE -1                     TO MAINTL.
  8452     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8453     MOVE CERT-GROUPING          TO PI-GROUPING.
  8454     MOVE CERT-STATE             TO PI-STATE.
  8455     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8456     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8457     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8458     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8459
  8460     IF RETURNED-FROM NOT = SPACES
  8461         GO TO 8100-SEND-INITIAL-MAP
  8462     ELSE
  8463         GO TO 8200-SEND-DATAONLY
  8464     END-IF.
  8465
  8466 1025-SHOW-RECORD-NOT-FOUND.
  8467
  8468     IF FILE-SWITCH = 'MSTR'
  8469         MOVE ER-0204            TO EMI-ERROR
  8470     ELSE
  8471         IF FILE-SWITCH = 'TRLR'
  8472             MOVE ER-0205        TO EMI-ERROR
  8473         ELSE
  8474             MOVE ER-0206        TO EMI-ERROR
  8475         END-IF
  8476     END-IF.
  8477
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 160
* EL130.cbl
  8478     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8479
  8480 1050-SEND-CHECK.
  8481
  8482     IF RETURNED-FROM NOT = SPACES
  8483         GO TO 8100-SEND-INITIAL-MAP
  8484     ELSE
  8485         MOVE -1                 TO MAINTL
  8486         GO TO 8200-SEND-DATAONLY
  8487     END-IF.
  8488
  8489 2000-DELETE-CLAIM.
  8490     IF NOT MODIFY-CAP
  8491         MOVE ER-0070            TO EMI-ERROR
  8492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8493         MOVE -1                 TO MAINTL
  8494         GO TO 8200-SEND-DATAONLY
  8495     END-IF.
  8496
  8497     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8498        CLMCARRI NOT = PI-LAST-CARR        OR
  8499        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8500        SUFXI    NOT = PI-LAST-CERT-SUFX
  8501         MOVE ER-0207            TO EMI-ERROR
  8502         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8503         MOVE -1                 TO MAINTL
  8504         GO TO 8200-SEND-DATAONLY
  8505     END-IF.
  8506
  8507
  8508
  8509* EXEC CICS HANDLE CONDITION
  8510*        NOTFND   (2050-DELETE-NOT-FOUND)
  8511*    END-EXEC.
  8512*    MOVE '"$I                   ! * #00008249' TO DFHEIV0
  8513     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8514     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8515     MOVE X'2A20233030303038323439' TO DFHEIV0(25:11)
  8516     CALL 'kxdfhei1' USING DFHEIV0
  8517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8518
  8519
  8520     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8521
  8522     MOVE CLMCARRI               TO MSTR-CARRIER.
  8523     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8524     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8525     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8526
  8527     MOVE 'MSTR'                 TO FILE-SWITCH.
  8528     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8529
  8530     MOVE 'Y'                    TO CLAIM-SWITCH.
  8531
  8532     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8533        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8534         MOVE ER-0068        TO EMI-ERROR
  8535         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 161
* EL130.cbl
  8536         MOVE -1             TO MAINTL
  8537         GO TO 8200-SEND-DATAONLY
  8538     END-IF.
  8539
  8540     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8541         MOVE ER-0569            TO EMI-ERROR
  8542         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8543         MOVE -1                 TO MAINTL
  8544         GO TO 8200-SEND-DATAONLY
  8545     END-IF.
  8546
  8547     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8548         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8549     END-IF.
  8550
  8551     IF CL-PURGED-DT NOT = LOW-VALUES
  8552         MOVE ER-7691            TO EMI-ERROR
  8553         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8554         MOVE -1                 TO MAINTL
  8555         GO TO 8200-SEND-DATAONLY
  8556     END-IF.
  8557
  8558     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8559     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8560     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8561     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8562     MOVE +0                     TO TRLR-SEQ-NO.
  8563     MOVE '1'                    TO TRLR-TYPE.
  8564
  8565     MOVE 'TRLR'                 TO FILE-SWITCH.
  8566
  8567
  8568
  8569* EXEC CICS READ
  8570*        UPDATE
  8571*        DATASET  (ELTRLR-DSID)
  8572*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8573*        RIDFLD   (ELTRLR-KEY)
  8574*    END-EXEC.
  8575*    MOVE '&"S        EU         (   #00008301' TO DFHEIV0
  8576     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8577     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8578     MOVE X'2020233030303038333031' TO DFHEIV0(25:11)
  8579     CALL 'kxdfhei1' USING DFHEIV0,
  8580           ELTRLR-DSID,
  8581           DFHEIV20,
  8582           DFHEIV99,
  8583           ELTRLR-KEY,
  8584           DFHEIV99,
  8585           DFHEIV99,
  8586           DFHEIV99
  8587     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8588         DFHEIV20
  8589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8590
  8591
  8592     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8593        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 162
* EL130.cbl
  8594         MOVE ER-0068        TO EMI-ERROR
  8595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8596         MOVE -1             TO MAINTL
  8597         GO TO 8200-SEND-DATAONLY
  8598     END-IF.
  8599
  8600
  8601
  8602* EXEC CICS DELETE
  8603*        DATASET   (ELTRLR-DSID)
  8604*    END-EXEC.
  8605*    MOVE '&(                    &   #00008317' TO DFHEIV0
  8606     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8607     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8608     MOVE X'2020233030303038333137' TO DFHEIV0(25:11)
  8609     CALL 'kxdfhei1' USING DFHEIV0,
  8610           ELTRLR-DSID,
  8611           DFHEIV99,
  8612           DFHEIV99,
  8613           DFHEIV99,
  8614           DFHEIV99
  8615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8616
  8617
  8618     MOVE +90                    TO TRLR-SEQ-NO.
  8619     MOVE '6'                    TO TRLR-TYPE.
  8620
  8621
  8622
  8623* EXEC CICS READ
  8624*        UPDATE
  8625*        DATASET  (ELTRLR-DSID)
  8626*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8627*        RIDFLD   (ELTRLR-KEY)
  8628*    END-EXEC.
  8629*    MOVE '&"S        EU         (   #00008325' TO DFHEIV0
  8630     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8631     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8632     MOVE X'2020233030303038333235' TO DFHEIV0(25:11)
  8633     CALL 'kxdfhei1' USING DFHEIV0,
  8634           ELTRLR-DSID,
  8635           DFHEIV20,
  8636           DFHEIV99,
  8637           ELTRLR-KEY,
  8638           DFHEIV99,
  8639           DFHEIV99,
  8640           DFHEIV99
  8641     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8642         DFHEIV20
  8643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8644
  8645
  8646
  8647
  8648* EXEC CICS DELETE
  8649*        DATASET   (ELTRLR-DSID)
  8650*    END-EXEC.
  8651*    MOVE '&(                    &   #00008333' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 163
* EL130.cbl
  8652     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8653     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8654     MOVE X'2020233030303038333333' TO DFHEIV0(25:11)
  8655     CALL 'kxdfhei1' USING DFHEIV0,
  8656           ELTRLR-DSID,
  8657           DFHEIV99,
  8658           DFHEIV99,
  8659           DFHEIV99,
  8660           DFHEIV99
  8661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8662
  8663
  8664     MOVE +91                    TO TRLR-SEQ-NO.
  8665     MOVE '6'                    TO TRLR-TYPE.
  8666
  8667
  8668
  8669* EXEC CICS READ
  8670*        UPDATE
  8671*        DATASET  (ELTRLR-DSID)
  8672*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8673*        RIDFLD   (ELTRLR-KEY)
  8674*        RESP     (WS-RESPONSE)
  8675*    END-EXEC
  8676*    MOVE '&"S        EU         (  N#00008341' TO DFHEIV0
  8677     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8678     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8679     MOVE X'204E233030303038333431' TO DFHEIV0(25:11)
  8680     CALL 'kxdfhei1' USING DFHEIV0,
  8681           ELTRLR-DSID,
  8682           DFHEIV20,
  8683           DFHEIV99,
  8684           ELTRLR-KEY,
  8685           DFHEIV99,
  8686           DFHEIV99,
  8687           DFHEIV99
  8688     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8689         DFHEIV20
  8690     MOVE EIBRESP  TO WS-RESPONSE
  8691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8692
  8693     IF WS-RESP-NORMAL
  8694
  8695* EXEC CICS DELETE
  8696*          DATASET   (ELTRLR-DSID)
  8697*       END-EXEC
  8698*    MOVE '&(                    &   #00008350' TO DFHEIV0
  8699     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8700     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8701     MOVE X'2020233030303038333530' TO DFHEIV0(25:11)
  8702     CALL 'kxdfhei1' USING DFHEIV0,
  8703           ELTRLR-DSID,
  8704           DFHEIV99,
  8705           DFHEIV99,
  8706           DFHEIV99,
  8707           DFHEIV99
  8708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8709     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 164
* EL130.cbl
  8710
  8711     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8712     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8713     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8714     MOVE CL-CERT-STATE          TO CERT-STATE.
  8715     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8716     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8717     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8718
  8719     MOVE 'CERT'                 TO FILE-SWITCH.
  8720
  8721     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8722
  8723     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8724
  8725     IF WS-NUM-HOLD NOT = +0
  8726         GO TO 2005-REWRITE-CERT
  8727     END-IF.
  8728
  8729     IF NOT CERT-WAS-CREATED
  8730         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8731         GO TO 2005-REWRITE-CERT
  8732     END-IF.
  8733
  8734
  8735
  8736* EXEC CICS DELETE
  8737*        DATASET   (ELCERT-DSID)
  8738*    END-EXEC.
  8739*    MOVE '&(                    &   #00008379' TO DFHEIV0
  8740     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8741     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8742     MOVE X'2020233030303038333739' TO DFHEIV0(25:11)
  8743     CALL 'kxdfhei1' USING DFHEIV0,
  8744           ELCERT-DSID,
  8745           DFHEIV99,
  8746           DFHEIV99,
  8747           DFHEIV99,
  8748           DFHEIV99
  8749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8750
  8751
  8752     GO TO 2010-DELETE-CL.
  8753
  8754 2005-REWRITE-CERT.
  8755
  8756     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8757
  8758
  8759
  8760* EXEC CICS HANDLE CONDITION
  8761*         DUPKEY   (2010-DELETE-CL)
  8762*    END-EXEC.
  8763*    MOVE '"$$                   ! + #00008390' TO DFHEIV0
  8764     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8766     MOVE X'2B20233030303038333930' TO DFHEIV0(25:11)
  8767     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 165
* EL130.cbl
  8768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8769
  8770
  8771
  8772
  8773* EXEC CICS REWRITE
  8774*        DATASET  (ELCERT-DSID)
  8775*        FROM     (CERTIFICATE-MASTER)
  8776*    END-EXEC.
  8777     MOVE LENGTH OF
  8778      CERTIFICATE-MASTER
  8779       TO DFHEIV11
  8780*    MOVE '&& L                  %   #00008395' TO DFHEIV0
  8781     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8782     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8783     MOVE X'2020233030303038333935' TO DFHEIV0(25:11)
  8784     CALL 'kxdfhei1' USING DFHEIV0,
  8785           ELCERT-DSID,
  8786           CERTIFICATE-MASTER,
  8787           DFHEIV11,
  8788           DFHEIV99
  8789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8790
  8791
  8792 2010-DELETE-CL.
  8793
  8794
  8795
  8796* EXEC CICS DELETE
  8797*        DATASET  (ELMSTR-DSID)
  8798*    END-EXEC.
  8799*    MOVE '&(                    &   #00008403' TO DFHEIV0
  8800     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8801     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8802     MOVE X'2020233030303038343033' TO DFHEIV0(25:11)
  8803     CALL 'kxdfhei1' USING DFHEIV0,
  8804           ELMSTR-DSID,
  8805           DFHEIV99,
  8806           DFHEIV99,
  8807           DFHEIV99,
  8808           DFHEIV99
  8809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8810
  8811
  8812     MOVE -1                     TO ONE-OR-MIN1.
  8813     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8814
  8815     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8816         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8817                                    WS-SAVE-CLAIM-KEY
  8818         MOVE +1                 TO ONE-OR-MIN1
  8819         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8820     END-IF.
  8821
  8822     MOVE ER-0000                TO EMI-ERROR.
  8823     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8824     MOVE LOW-VALUES             TO EL130AO.
  8825     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 166
* EL130.cbl
  8826     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8827     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8828                                    PI-CERT-PROCESSED
  8829                                    PI-LETTER-ERROR-CODE.
  8830     GO TO 8100-SEND-INITIAL-MAP.
  8831
  8832 2050-DELETE-NOT-FOUND.
  8833     IF FILE-SWITCH = 'MSTR'
  8834         MOVE -1                 TO CLMNOL
  8835         MOVE ER-0204            TO EMI-ERROR
  8836     ELSE
  8837         IF FILE-SWITCH = 'TRLR'
  8838             MOVE -1             TO MAINTL
  8839             MOVE ER-0205        TO EMI-ERROR
  8840         ELSE
  8841             MOVE -1             TO CERTNOL
  8842             MOVE ER-0206        TO EMI-ERROR
  8843         END-IF
  8844     END-IF.
  8845
  8846     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8847     GO TO 8200-SEND-DATAONLY.
  8848
  8849 3000-ADD-CLAIM.
  8850     IF NOT MODIFY-CAP
  8851         MOVE ER-0070            TO EMI-ERROR
  8852         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8853         MOVE -1                 TO MAINTL
  8854         GO TO 8200-SEND-DATAONLY
  8855     END-IF.
  8856
  8857     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8858
  8859     IF CERTMTI = 'S'
  8860         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8861            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8862            WS-EFFDT = PI-SAVE-EFFDT       AND
  8863            ACCOUNTI = PI-SAVE-ACCOUNT
  8864             IF EMI-ERROR = 0
  8865                 GO TO 3010-TEST-FOR-ERRORS
  8866             ELSE
  8867                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8868                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8869                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8870                 MOVE PI-STATE         TO  CERT-STATE
  8871                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8872                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8873                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8874
  8875
  8876* EXEC CICS HANDLE CONDITION
  8877*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8878*                END-EXEC
  8879*    MOVE '"$I                   ! , #00008470' TO DFHEIV0
  8880     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8882     MOVE X'2C20233030303038343730' TO DFHEIV0(25:11)
  8883     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 167
* EL130.cbl
  8884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8885                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  8886                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8887                 GO TO 3010-TEST-FOR-ERRORS
  8888             END-IF
  8889         END-IF
  8890     END-IF.
  8891
  8892     IF CERTMTI = 'A'
  8893         IF NOT PI-NO-CARRIER-SECURITY OR
  8894             NOT PI-NO-ACCOUNT-SECURITY
  8895             MOVE ER-2370          TO EMI-ERROR
  8896             MOVE -1               TO MAINTL
  8897             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8898             GO TO 8200-SEND-DATAONLY
  8899         ELSE
  8900             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8901             GO TO 3010-TEST-FOR-ERRORS
  8902         END-IF
  8903     END-IF.
  8904
  8905     IF CERTNOL = ZEROS
  8906        GO TO 3010-TEST-FOR-ERRORS
  8907     END-IF.
  8908
  8909 3000-READ-CERT.
  8910
  8911     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8912                                    MSTR5-COMP-CD.
  8913     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8914                                    MSTR5-CERT-NO-PRIME.
  8915     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8916                                    MSTR5-CERT-NO-SUFX.
  8917
  8918
  8919
  8920* EXEC CICS HANDLE CONDITION
  8921*         DUPKEY   (3008-DUP-ERROR)
  8922*         NOTFND   (3009-NOT-FOUND)
  8923*    END-EXEC
  8924*    MOVE '"$$I                  ! - #00008507' TO DFHEIV0
  8925     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8926     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8927     MOVE X'2D20233030303038353037' TO DFHEIV0(25:11)
  8928     CALL 'kxdfhei1' USING DFHEIV0
  8929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8930
  8931     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8932
  8933     IF NOT PI-NO-ACCOUNT-SECURITY
  8934         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8935             MOVE ER-2371          TO EMI-ERROR
  8936             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8937             MOVE -1               TO MAINTL
  8938             GO TO 8200-SEND-DATAONLY
  8939         END-IF
  8940     END-IF.
  8941
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 168
* EL130.cbl
  8942     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8943     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  8944     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8945     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8946     MOVE CM-CARRIER             TO PI-CARRIER.
  8947     MOVE CM-GROUPING            TO PI-GROUPING.
  8948     MOVE CM-STATE               TO PI-STATE.
  8949     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  8950     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8951     MOVE CM-CERT-NO             TO PI-CERT-NO.
  8952     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  8953
  8954     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  8955         IF LSTNMEO = SPACES OR LOW-VALUES
  8956             MOVE CRTLNMEI       TO  LSTNMEO
  8957             MOVE AL-UANON       TO  LSTNMEA
  8958         END-IF
  8959     END-IF.
  8960
  8961     MOVE 'S'                    TO CERTMTO.
  8962*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  8963     MOVE AL-SANON               TO CERTNOA.
  8964     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  8965                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  8966     IF EMI-NO-ERRORS
  8967         MOVE -1                  TO MAINTL
  8968     END-IF.
  8969
  8970     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8971         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8972         IF INCURRED-DATE-MATCH
  8973             MOVE ER-7352         TO EMI-ERROR
  8974             MOVE -1              TO CERTNOL
  8975             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8976         ELSE
  8977             IF NO-CLAIMS-FOR-CERT
  8978                 MOVE ER-7353     TO EMI-ERROR
  8979                 MOVE -1          TO CERTNOL
  8980                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8981             ELSE
  8982                 MOVE ER-0558     TO EMI-ERROR
  8983                 MOVE -1          TO CERTNOL
  8984                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8985                 GO TO 3010-TEST-FOR-ERRORS
  8986             END-IF
  8987         END-IF
  8988     END-IF.
  8989
  8990 3007-SEND-SCREEN.
  8991     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8992         GO TO 8150-SEND-MAP-CURSOR
  8993     ELSE
  8994         GO TO 8200-SEND-DATAONLY
  8995     END-IF.
  8996
  8997 3008-DUP-ERROR.
  8998     MOVE ER-0560                TO EMI-ERROR.
  8999     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 169
* EL130.cbl
  9000     MOVE -1                     TO CERTNOL.
  9001     GO TO 3007-SEND-SCREEN.
  9002
  9003 3009-NOT-FOUND.
  9004     MOVE ER-0214                TO EMI-ERROR.
  9005     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9006     MOVE -1                     TO CERTNOL.
  9007     GO TO 3007-SEND-SCREEN.
  9008
  9009 3010-TEST-FOR-ERRORS.
  9010
  9011     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  9012     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  9013     perform 6500-get-acct    thru 6500-exit
  9014
  9015     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  9016     move +0                     to e1
  9017     move spaces                 to ws-dcc-error-line
  9018     move ' '                    to ws-zero-bens-avail
  9019
  9020     if ws-dcc-product-code not = spaces
  9021        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  9022        IF ERPDEF-FOUND
  9023           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9024           MOVE WS-INCUR         TO DC-BIN-DATE-2
  9025           MOVE '1'              TO DC-OPTION-CODE
  9026           MOVE +0               TO DC-ELAPSED-MONTHS
  9027                                    DC-ELAPSED-DAYS
  9028           PERFORM 9700-LINK-DATE-CONVERT
  9029                                 THRU 9700-EXIT
  9030           IF NO-CONVERSION-ERROR
  9031              MOVE DC-ELAPSED-MONTHS
  9032                                 TO WS-MONTHS-BETWEEN
  9033              IF DC-ELAPSED-DAYS > 1
  9034                 ADD 1 TO WS-MONTHS-BETWEEN
  9035              END-IF
  9036           ELSE
  9037              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9038           END-IF
  9039
  9040           evaluate true
  9041              when (ws-excl-period not = zeros)
  9042                 and (ws-months-between <= ws-excl-period)
  9043                 MOVE -1         TO MAINTL
  9044                 add +1          to e1
  9045                 move 'Y'        to ws-zero-bens-avail
  9046                 MOVE ER-1651    TO EMI-ERROR
  9047                                    ws-error-no (e1)
  9048                 PERFORM 9900-ERROR-FORMAT
  9049                                 THRU 9900-EXIT
  9050              when (ws-cov-ends not = zeros)
  9051                 and (ws-months-between > ws-cov-ends)
  9052                 MOVE -1         TO MAINTL
  9053                 add +1          to e1
  9054                 move 'Y'        to ws-zero-bens-avail
  9055                 MOVE ER-1653    TO EMI-ERROR
  9056                                    ws-error-no (e1)
  9057                 evaluate true
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 170
* EL130.cbl
  9058                    when clmtypei = 'L'
  9059                       move '  LF  ' to emi-claim-type
  9060                    when clmtypei = 'I'
  9061                       move '  IU  ' to emi-claim-type
  9062                    when clmtypei = 'F'
  9063                       move ' FMLA ' to emi-claim-type
  9064                    when other
  9065                       move '  AH  ' to emi-claim-type
  9066                 end-evaluate
  9067                 PERFORM 9900-ERROR-FORMAT
  9068                                 THRU 9900-EXIT
  9069              when (ws-acc-period not = zeros)
  9070                 and (ws-months-between <= ws-acc-period)
  9071                 MOVE -1         TO MAINTL
  9072                 add +1          to e1
  9073                 MOVE ER-1652    TO EMI-ERROR
  9074                                    ws-error-no (e1)
  9075                 PERFORM 9900-ERROR-FORMAT
  9076                                 THRU 9900-EXIT
  9077                 add +1          to e1
  9078                 move er-1655    to emi-error
  9079                                    ws-error-no (e1)
  9080                 PERFORM 9900-ERROR-FORMAT
  9081                                 THRU 9900-EXIT
  9082              when clmtypei = 'I'
  9083                 add +1          to e1
  9084                 move er-1661    to emi-error
  9085                                    ws-error-no (e1)
  9086                 PERFORM 9900-ERROR-FORMAT
  9087                                 THRU 9900-EXIT
  9088           end-evaluate
  9089        END-IF
  9090*       perform 3996-read-cert-claim-trailer
  9091*                                thru 3996-exit
  9092     END-IF
  9093     perform 3996-read-cert-claim-trailer
  9094                                 thru 3996-exit
  9095     IF CERTMTI NOT = 'A'
  9096         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9097             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9098             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9099             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9100             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9101             IF INCURRED-DATE-MATCH
  9102                 MOVE ER-7352         TO EMI-ERROR
  9103                 MOVE -1              TO CERTNOL
  9104                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9105             ELSE
  9106                 IF NO-CLAIMS-FOR-CERT
  9107                     MOVE ER-7353     TO EMI-ERROR
  9108                     MOVE -1          TO CERTNOL
  9109                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9110                 ELSE
  9111                     MOVE ER-0558     TO EMI-ERROR
  9112                     MOVE -1          TO CERTNOL
  9113                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9114                 END-IF
  9115             END-IF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 171
* EL130.cbl
  9116         END-IF
  9117     END-IF.
  9118
  9119     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9120         MOVE ER-0433             TO EMI-ERROR
  9121         MOVE -1                  TO MAINTL
  9122         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9123         GO TO 8200-SEND-DATAONLY
  9124     END-IF.
  9125
  9126     IF (EMI-NO-ERRORS)
  9127        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9128         GO TO 3015-TRY-TO-BUILD
  9129     END-IF.
  9130
  9131     IF EIBAID = DFHPF6
  9132         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9133             MOVE ER-0434         TO EMI-ERROR
  9134             MOVE -1              TO MAINTL
  9135             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9136             GO TO 8200-SEND-DATAONLY
  9137         ELSE
  9138             MOVE +1              TO INCURL
  9139             GO TO 3015-TRY-TO-BUILD
  9140         END-IF
  9141     END-IF.
  9142
  9143     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9144         GO TO 8150-SEND-MAP-CURSOR
  9145     ELSE
  9146         GO TO 8200-SEND-DATAONLY
  9147     END-IF.
  9148
  9149 3015-TRY-TO-BUILD.
  9150     IF CLMNOL EQUAL ZERO
  9151         GO TO 3030-BUILD-CONT
  9152     END-IF.
  9153
  9154
  9155
  9156* EXEC CICS HANDLE CONDITION
  9157*        NOTFND   (3030-BUILD-CONT)
  9158*    END-EXEC.
  9159*    MOVE '"$I                   ! . #00008736' TO DFHEIV0
  9160     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9162     MOVE X'2E20233030303038373336' TO DFHEIV0(25:11)
  9163     CALL 'kxdfhei1' USING DFHEIV0
  9164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9165
  9166
  9167     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9168
  9169     MOVE CLMCARRI               TO MSTR-CARRIER.
  9170     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9171     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9172     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9173
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 172
* EL130.cbl
  9174     MOVE 'MSTR'                 TO FILE-SWITCH.
  9175
  9176     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9177
  9178     MOVE ER-0221                TO EMI-ERROR.
  9179
  9180     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9181     MOVE -1                     TO MAINTL.
  9182     GO TO 8200-SEND-DATAONLY.
  9183
  9184 3030-BUILD-CONT.
  9185     IF (CERTMTI NOT = 'A')
  9186        and (pi-company-id not = 'DCC')
  9187         GO TO 3060-BUILD-CONT
  9188     END-IF.
  9189
  9190
  9191
  9192* EXEC CICS HANDLE CONDITION
  9193*        NOTFND   (3033-ACCT-NOT-FOUND)
  9194*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9195*    END-EXEC.
  9196*    MOVE '"$I''                  ! / #00008764' TO DFHEIV0
  9197     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9198     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9199     MOVE X'2F20233030303038373634' TO DFHEIV0(25:11)
  9200     CALL 'kxdfhei1' USING DFHEIV0
  9201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9202
  9203
  9204     MOVE SPACES                 TO ERACCT-KEY.
  9205
  9206     IF CARR-GROUP-ST-ACCNT-CNTL
  9207         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9208         MOVE CRTCARRI           TO ACCT-CARRIER
  9209         MOVE GROUPI             TO ACCT-GROUPING
  9210         MOVE STATEI             TO ACCT-STATE
  9211         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9212         GO TO 3031-MOVE-ACCT-KEY
  9213     END-IF.
  9214
  9215     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9216     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9217
  9218     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9219         MOVE STATEI             TO ACCT-STATE
  9220     END-IF.
  9221
  9222     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9223         MOVE CRTCARRI           TO ACCT-CARRIER
  9224     END-IF.
  9225
  9226 3031-MOVE-ACCT-KEY.
  9227     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9228
  9229
  9230
  9231* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 173
* EL130.cbl
  9232*        DATASET     (ERACCT2-DSID)
  9233*        RIDFLD      (SAVE-ERACCT-KEY)
  9234*        GENERIC
  9235*        KEYLENGTH   (20)
  9236*    END-EXEC.
  9237     MOVE 20
  9238       TO DFHEIV11
  9239     MOVE 0
  9240       TO DFHEIV12
  9241*    MOVE '&,   KG    G          &   #00008795' TO DFHEIV0
  9242     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9243     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9244     MOVE X'2020233030303038373935' TO DFHEIV0(25:11)
  9245     CALL 'kxdfhei1' USING DFHEIV0,
  9246           ERACCT2-DSID,
  9247           SAVE-ERACCT-KEY,
  9248           DFHEIV11,
  9249           DFHEIV12,
  9250           DFHEIV99
  9251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9252
  9253
  9254
  9255
  9256* EXEC CICS HANDLE CONDITION
  9257*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9258*    END-EXEC.
  9259*    MOVE '"$''                   ! 0 #00008803' TO DFHEIV0
  9260     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9261     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9262     MOVE X'3020233030303038383033' TO DFHEIV0(25:11)
  9263     CALL 'kxdfhei1' USING DFHEIV0
  9264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9265
  9266
  9267 3031-READ-ACCT-LOOP.
  9268
  9269
  9270* EXEC CICS READNEXT
  9271*        DATASET   (ERACCT2-DSID)
  9272*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9273*        RIDFLD    (SAVE-ERACCT-KEY)
  9274*    END-EXEC.
  9275     MOVE 0
  9276       TO DFHEIV11
  9277*    MOVE '&.S                   )   #00008809' TO DFHEIV0
  9278     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9279     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9280     MOVE X'2020233030303038383039' TO DFHEIV0(25:11)
  9281     CALL 'kxdfhei1' USING DFHEIV0,
  9282           ERACCT2-DSID,
  9283           DFHEIV20,
  9284           DFHEIV99,
  9285           SAVE-ERACCT-KEY,
  9286           DFHEIV99,
  9287           DFHEIV11,
  9288           DFHEIV99,
  9289           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 174
* EL130.cbl
  9290     SET ADDRESS OF ACCOUNT-MASTER TO
  9291         DFHEIV20
  9292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9293
  9294
  9295     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9296        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9297        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9298        ACCT-STATE    NOT = AM-VG-STATE       OR
  9299        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9300         GO TO 3033-ACCT-NOT-FOUND
  9301     END-IF.
  9302
  9303     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9304        WS-EFFDT LESS AM-EXPIRATION-DT
  9305         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9306         MOVE AM-CARRIER       TO CERT-CARRIER
  9307         MOVE AM-GROUPING      TO CERT-GROUPING
  9308         MOVE AM-STATE         TO CERT-STATE
  9309         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9310         MOVE WS-EFFDT         TO CERT-EFF-DT
  9311         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9312         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9313         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9314         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9315     END-IF.
  9316
  9317     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9318         GO TO 3031-READ-ACCT-LOOP
  9319     END-IF.
  9320
  9321 3032-NOT-IN-DT-RANGE.
  9322     MOVE ER-0226                TO EMI-ERROR.
  9323     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9324     MOVE -1                     TO EFFDTL.
  9325     GO TO 8200-SEND-DATAONLY.
  9326
  9327 3033-ACCT-NOT-FOUND.
  9328     MOVE ER-0226 TO EMI-ERROR.
  9329     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9330     MOVE -1                     TO ACCOUNTL.
  9331     GO TO 8200-SEND-DATAONLY.
  9332
  9333 3034-CHECK-EMPLOYER-STATEMENT.
  9334
  9335     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9336*        NEXT SENTENCE
  9337         CONTINUE
  9338     ELSE
  9339         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9340     END-IF.
  9341
  9342     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9343     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9344     MOVE '1'                    TO  DC-OPTION-CODE.
  9345     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9346                                     DC-ELAPSED-DAYS.
  9347     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 175
* EL130.cbl
  9348
  9349     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9350         DC-ELAPSED-DAYS LESS THAN +31)
  9351                      OR
  9352        (AM-EMPLOYER-STMT-USED = '2' AND
  9353         DC-ELAPSED-DAYS LESS THAN +61)
  9354                      OR
  9355        (AM-EMPLOYER-STMT-USED = '3' AND
  9356         DC-ELAPSED-DAYS LESS THAN +91)
  9357            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9358     END-IF.
  9359
  9360 3034-CHECK-ACCOUNT-LIMITS.
  9361
  9362     IF CERTMTI NOT = 'A'
  9363         GO TO 3060-BUILD-CONT
  9364     END-IF.
  9365
  9366     IF AM-STATUS NOT = '0'
  9367         MOVE ER-0225                TO EMI-ERROR
  9368         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9369         MOVE -1                     TO ACCOUNTL
  9370     END-IF.
  9371
  9372     IF EIBAID = DFHPF6
  9373         IF EMI-FATAL-CTR NOT = ZERO
  9374             MOVE ER-0434         TO EMI-ERROR
  9375             MOVE -1              TO MAINTL
  9376             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9377             GO TO 8200-SEND-DATAONLY
  9378         END-IF
  9379     END-IF.
  9380
  9381*    IF PI-COMPANY-ID NOT = 'CRI'
  9382*        GO TO 3035-END-BROWSE
  9383*    END-IF.
  9384
  9385 3035-END-BROWSE.
  9386
  9387
  9388* EXEC CICS ENDBR
  9389*        DATASET    (ERACCT2-DSID)
  9390*    END-EXEC.
  9391     MOVE 0
  9392       TO DFHEIV11
  9393*    MOVE '&2                    $   #00008907' TO DFHEIV0
  9394     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9395     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9396     MOVE X'2020233030303038393037' TO DFHEIV0(25:11)
  9397     CALL 'kxdfhei1' USING DFHEIV0,
  9398           ERACCT2-DSID,
  9399           DFHEIV11,
  9400           DFHEIV99
  9401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9402
  9403
  9404 3040-CHECK-CERT-ALREADY-ON.
  9405
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 176
* EL130.cbl
  9406
  9407* EXEC CICS HANDLE CONDITION
  9408*        NOTFND   (3070-BUILD-CONT)
  9409*    END-EXEC.
  9410*    MOVE '"$I                   ! 1 #00008913' TO DFHEIV0
  9411     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9413     MOVE X'3120233030303038393133' TO DFHEIV0(25:11)
  9414     CALL 'kxdfhei1' USING DFHEIV0
  9415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9416
  9417
  9418     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9419
  9420     MOVE ER-0229                TO EMI-ERROR.
  9421     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9422     MOVE -1                     TO MAINTL.
  9423     GO TO 8200-SEND-DATAONLY.
  9424
  9425 3060-BUILD-CONT.
  9426     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9427     MOVE CRTCARRI               TO CERT-CARRIER.
  9428     MOVE GROUPI                 TO CERT-GROUPING.
  9429     MOVE STATEI                 TO CERT-STATE.
  9430     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9431     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9432     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9433     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9434
  9435
  9436
  9437* EXEC CICS HANDLE CONDITION
  9438*        NOTFND  (3065-CERT-NOT-FOUND)
  9439*    END-EXEC.
  9440*    MOVE '"$I                   ! 2 #00008935' TO DFHEIV0
  9441     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9443     MOVE X'3220233030303038393335' TO DFHEIV0(25:11)
  9444     CALL 'kxdfhei1' USING DFHEIV0
  9445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9446
  9447
  9448     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9449
  9450     GO TO 3070-BUILD-CONT.
  9451
  9452 3065-CERT-NOT-FOUND.
  9453     MOVE ER-0244                TO EMI-ERROR.
  9454     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9455     MOVE -1                     TO CERTNOL.
  9456     GO TO 8200-SEND-DATAONLY.
  9457
  9458 3070-BUILD-CONT.
  9459     IF CLMNOL NOT = ZERO
  9460         GO TO 3200-BUILD-ZERO-TRAILER
  9461     END-IF.
  9462
  9463     MOVE SPACES                 TO ELCNTL-KEY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 177
* EL130.cbl
  9464
  9465     IF CONTROL-IS-ACTUAL-CARRIER
  9466         MOVE PI-CARRIER         TO CNTL-CARRIER
  9467     ELSE
  9468         MOVE PI-CARRIER-CONTROL-LEVEL
  9469                                 TO CNTL-CARRIER
  9470     END-IF.
  9471
  9472     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9473     MOVE '6'                    TO CNTL-REC-TYPE.
  9474     MOVE +0                     TO CNTL-SEQ-NO.
  9475
  9476
  9477
  9478* EXEC CICS HANDLE CONDITION
  9479*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9480*    END-EXEC.
  9481*    MOVE '"$I                   ! 3 #00008968' TO DFHEIV0
  9482     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9484     MOVE X'3320233030303038393638' TO DFHEIV0(25:11)
  9485     CALL 'kxdfhei1' USING DFHEIV0
  9486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9487
  9488
  9489
  9490
  9491* EXEC CICS READ
  9492*        UPDATE
  9493*        DATASET   (ELCNTL-DSID)
  9494*        SET       (ADDRESS OF CONTROL-FILE)
  9495*        RIDFLD    (ELCNTL-KEY)
  9496*    END-EXEC.
  9497*    MOVE '&"S        EU         (   #00008973' TO DFHEIV0
  9498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9499     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9500     MOVE X'2020233030303038393733' TO DFHEIV0(25:11)
  9501     CALL 'kxdfhei1' USING DFHEIV0,
  9502           ELCNTL-DSID,
  9503           DFHEIV20,
  9504           DFHEIV99,
  9505           ELCNTL-KEY,
  9506           DFHEIV99,
  9507           DFHEIV99,
  9508           DFHEIV99
  9509     SET ADDRESS OF CONTROL-FILE TO
  9510         DFHEIV20
  9511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9512
  9513
  9514     IF CLAIM-NO-MANUAL
  9515         GO TO 3120-CLAIM-MUST-BE-INPUT
  9516     END-IF.
  9517
  9518     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9519     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9520
  9521     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 178
* EL130.cbl
  9522         CONTINUE
  9523     ELSE
  9524         GO TO 3080-ASSIGN-LOOP
  9525     END-IF.
  9526
  9527
  9528
  9529* EXEC CICS UNLOCK
  9530*        DATASET   (ELCNTL-DSID)
  9531*    END-EXEC.
  9532*    MOVE '&*                    #   #00008994' TO DFHEIV0
  9533     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9534     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9535     MOVE X'2020233030303038393934' TO DFHEIV0(25:11)
  9536     CALL 'kxdfhei1' USING DFHEIV0,
  9537           ELCNTL-DSID,
  9538           DFHEIV99
  9539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9540
  9541
  9542     MOVE '1'                    TO CNTL-REC-TYPE.
  9543     MOVE SPACES                 TO CNTL-ACCESS.
  9544
  9545     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9546
  9547
  9548
  9549* EXEC CICS HANDLE CONDITION
  9550*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9551*    END-EXEC.
  9552*    MOVE '"$I                   ! 4 #00009004' TO DFHEIV0
  9553     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9554     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9555     MOVE X'3420233030303039303034' TO DFHEIV0(25:11)
  9556     CALL 'kxdfhei1' USING DFHEIV0
  9557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9558
  9559
  9560     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9561
  9562     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9563
  9564 3080-ASSIGN-LOOP.
  9565     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9566        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9567         MOVE +0                 TO SAVE-COUNTER
  9568     END-IF.
  9569
  9570     ADD +1 TO SAVE-COUNTER.
  9571
  9572     IF SAVE-METHOD  = '3'
  9573         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9574         GO TO 3090-SET-COMP
  9575     END-IF.
  9576
  9577     IF SAVE-METHOD  = '4'
  9578         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9579         MOVE CLMCARRI           TO WS-CN-PRF-A
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 179
* EL130.cbl
  9580         GO TO 3090-SET-COMP
  9581     END-IF.
  9582
  9583     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9584     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9585     MOVE SAVE-DATE              TO CURR-DATE.
  9586
  9587     IF CURR-MM LESS '10'
  9588         MOVE CURR-M2             TO WS-CN-PRF-B
  9589     END-IF.
  9590
  9591     IF CURR-MM = '10'
  9592        MOVE 'A'                 TO WS-CN-PRF-B
  9593     END-IF.
  9594     IF CURR-MM = '11'
  9595        MOVE 'B'                 TO WS-CN-PRF-B
  9596     END-IF.
  9597     IF CURR-MM = '12'
  9598        MOVE 'C'                 TO WS-CN-PRF-B
  9599     END-IF.
  9600
  9601     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9602
  9603 3090-SET-COMP.
  9604
  9605     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9606     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9607                                    CLMNOO.
  9608     MOVE AL-UANON               TO CLMNOA.
  9609     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9610     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9611     MOVE CLMCARRI               TO MSTR-CARRIER.
  9612
  9613
  9614
  9615* EXEC CICS HANDLE CONDITION
  9616*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9617*    END-EXEC.
  9618*    MOVE '"$I                   ! 5 #00009062' TO DFHEIV0
  9619     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9620     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9621     MOVE X'3520233030303039303632' TO DFHEIV0(25:11)
  9622     CALL 'kxdfhei1' USING DFHEIV0
  9623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9624
  9625
  9626     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9627
  9628     GO TO 3080-ASSIGN-LOOP.
  9629
  9630 3100-CARRIER-NOT-FOUND.
  9631     MOVE ER-0252                TO EMI-ERROR.
  9632     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9633     MOVE -1                     TO CLMCARRL.
  9634     GO TO 8200-SEND-DATAONLY.
  9635
  9636 3110-COMPANY-NOT-FOUND.
  9637     MOVE ER-0254                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 180
* EL130.cbl
  9638     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9639     MOVE -1                     TO MAINTL.
  9640     GO TO 8200-SEND-DATAONLY.
  9641
  9642 3120-CLAIM-MUST-BE-INPUT.
  9643     MOVE ER-0264                TO EMI-ERROR.
  9644     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9645     MOVE -1                     TO CLMNOL.
  9646     GO TO 8200-SEND-DATAONLY.
  9647
  9648 3200-BUILD-ZERO-TRAILER.
  9649
  9650
  9651* EXEC CICS HANDLE CONDITION
  9652*        NOTFND
  9653*    END-EXEC.
  9654*    MOVE '"$                   ! 6 #00009090' TO DFHEIV0
  9655     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9657     MOVE X'3620233030303039303930' TO DFHEIV0(25:11)
  9658     CALL 'kxdfhei1' USING DFHEIV0
  9659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9660
  9661
  9662
  9663
  9664* EXEC CICS GETMAIN
  9665*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9666*        LENGTH  (ELTRLR-LENGTH)
  9667*    END-EXEC.
  9668*    MOVE '," L                  $   #00009095' TO DFHEIV0
  9669     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9670     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9671     MOVE X'2020233030303039303935' TO DFHEIV0(25:11)
  9672     CALL 'kxdfhei1' USING DFHEIV0,
  9673           DFHEIV20,
  9674           ELTRLR-LENGTH,
  9675           DFHEIV99
  9676     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9677         DFHEIV20
  9678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9679
  9680
  9681     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9682     MOVE 'AT'                   TO AT-RECORD-ID.
  9683
  9684     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9685     MOVE CLMCARRI               TO AT-CARRIER.
  9686     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9687     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9688     MOVE +0                     TO AT-SEQUENCE-NO.
  9689     MOVE '1'                    TO AT-TRAILER-TYPE.
  9690
  9691     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9692     MOVE '5'                    TO DC-OPTION-CODE.
  9693     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9694     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9695                                    AT-RESERVES-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 181
* EL130.cbl
  9696
  9697     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9698                                    AT-RESERVES-LAST-UPDATED-BY.
  9699
  9700     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9701
  9702     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9703
  9704     MOVE +0                     TO AT-FUTURE-RESERVE
  9705                                    AT-IBNR-RESERVE
  9706                                    AT-PAY-CURRENT-RESERVE
  9707                                    AT-INITIAL-MANUAL-RESERVE
  9708                                    AT-CURRENT-MANUAL-RESERVE
  9709                                    AT-ITD-LIFE-REFUNDS
  9710                                    AT-ITD-AH-REFUNDS
  9711                                    AT-ITD-ADDITIONAL-RESERVE.
  9712
  9713     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9714
  9715     IF MANRSVL NOT = ZERO
  9716         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9717                                    AT-CURRENT-MANUAL-RESERVE
  9718     END-IF.
  9719
  9720     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9721
  9722     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9723                                    AT-ITD-CHARGEABLE-EXPENSE.
  9724
  9725     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9726     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9727     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9728
  9729
  9730
  9731* EXEC CICS WRITE
  9732*        DATASET   (ELTRLR-DSID)
  9733*        FROM      (ACTIVITY-TRAILERS)
  9734*        RIDFLD    (AT-CONTROL-PRIMARY)
  9735*    END-EXEC.
  9736     MOVE LENGTH OF
  9737      ACTIVITY-TRAILERS
  9738       TO DFHEIV11
  9739*    MOVE '&$ L                  ''   #00009149' TO DFHEIV0
  9740     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9742     MOVE X'2020233030303039313439' TO DFHEIV0(25:11)
  9743     CALL 'kxdfhei1' USING DFHEIV0,
  9744           ELTRLR-DSID,
  9745           ACTIVITY-TRAILERS,
  9746           DFHEIV11,
  9747           AT-CONTROL-PRIMARY,
  9748           DFHEIV99,
  9749           DFHEIV99
  9750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9751
  9752
  9753     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 182
* EL130.cbl
  9754
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 183
* EL130.cbl
  9756
  9757 3250-BUILD-I1-ADDRESS-TRAILER.
  9758
  9759     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9760     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9761     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9762     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9763     MOVE GROUPI                 TO WS-MA-GROUPING.
  9764     MOVE STATEI                 TO WS-MA-STATE.
  9765     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9766     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9767     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9768     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9769
  9770
  9771* EXEC CICS HANDLE CONDITION
  9772*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9773*    END-EXEC.
  9774*    MOVE '"$I                   ! 7 #00009172' TO DFHEIV0
  9775     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9777     MOVE X'3720233030303039313732' TO DFHEIV0(25:11)
  9778     CALL 'kxdfhei1' USING DFHEIV0
  9779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9780
  9781
  9782
  9783* EXEC CICS READ
  9784*        EQUAL
  9785*        DATASET   (ERMAIL-DSID)
  9786*        SET       (ADDRESS OF MAILING-DATA)
  9787*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9788*    END-EXEC.
  9789*    MOVE '&"S        E          (   #00009176' TO DFHEIV0
  9790     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9791     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9792     MOVE X'2020233030303039313736' TO DFHEIV0(25:11)
  9793     CALL 'kxdfhei1' USING DFHEIV0,
  9794           ERMAIL-DSID,
  9795           DFHEIV20,
  9796           DFHEIV99,
  9797           WS-MA-CONTROL-PRIMARY,
  9798           DFHEIV99,
  9799           DFHEIV99,
  9800           DFHEIV99
  9801     SET ADDRESS OF MAILING-DATA TO
  9802         DFHEIV20
  9803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9804
  9805
  9806     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9807         GO TO 3290-NO-INSURED-ADDRESS
  9808     END-IF.
  9809
  9810     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9811     MOVE 'AT'                   TO AT-RECORD-ID.
  9812
  9813     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 184
* EL130.cbl
  9814     MOVE CLMCARRI               TO AT-CARRIER.
  9815     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9816     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9817     MOVE +1                     TO AT-SEQUENCE-NO.
  9818     MOVE '5'                    TO AT-TRAILER-TYPE.
  9819
  9820     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9821     IF MA-INSURED-MIDDLE-INIT > SPACES
  9822        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9823               ' ' DELIMITED BY SIZE
  9824               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9825               ' ' DELIMITED BY SIZE
  9826               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9827        INTO AT-MAIL-TO-NAME
  9828     ELSE
  9829        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9830               ' ' DELIMITED BY SIZE
  9831               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9832        INTO AT-MAIL-TO-NAME
  9833     END-IF.
  9834     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9835     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9836*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9837     MOVE MA-CITY                TO AT-CITY
  9838     MOVE MA-ADDR-STATE          TO AT-STATE
  9839     MOVE MA-ZIP                 TO AT-ZIP
  9840     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9841
  9842     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9843                                    AT-ADDRESS-LAST-MAINT-DT.
  9844
  9845     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9846                                    AT-ADDRESS-LAST-UPDATED-BY.
  9847
  9848     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9849
  9850
  9851* EXEC CICS WRITE
  9852*        DATASET   (ELTRLR-DSID)
  9853*        FROM      (ACTIVITY-TRAILERS)
  9854*        RIDFLD    (AT-CONTROL-PRIMARY)
  9855*    END-EXEC.
  9856     MOVE LENGTH OF
  9857      ACTIVITY-TRAILERS
  9858       TO DFHEIV11
  9859*    MOVE '&$ L                  ''   #00009227' TO DFHEIV0
  9860     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9861     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9862     MOVE X'2020233030303039323237' TO DFHEIV0(25:11)
  9863     CALL 'kxdfhei1' USING DFHEIV0,
  9864           ELTRLR-DSID,
  9865           ACTIVITY-TRAILERS,
  9866           DFHEIV11,
  9867           AT-CONTROL-PRIMARY,
  9868           DFHEIV99,
  9869           DFHEIV99
  9870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9871
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 185
* EL130.cbl
  9872
  9873     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9874     GO TO 3300-BUILD-NINETY-TRAILER.
  9875
  9876 3290-NO-INSURED-ADDRESS.
  9877      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9878
  9879 3300-BUILD-NINETY-TRAILER.
  9880
  9881     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9882     MOVE 'AT'                   TO AT-RECORD-ID.
  9883
  9884     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9885     MOVE CLMCARRI               TO AT-CARRIER.
  9886
  9887     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9888     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9889     MOVE +90                    TO AT-SEQUENCE-NO.
  9890     MOVE '6'                    TO AT-TRAILER-TYPE.
  9891
  9892     IF DIAGL NOT = ZERO
  9893         MOVE DIAGI              TO AT-INFO-LINE-1
  9894     END-IF.
  9895
  9896     IF ICD1L NOT = ZERO
  9897         MOVE ICD1I              TO AT-ICD-CODE-1
  9898     END-IF.
  9899
  9900     IF ICD2L NOT = ZERO
  9901         MOVE ICD2I              TO AT-ICD-CODE-2
  9902     END-IF.
  9903
  9904     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9905                                    AT-GEN-INFO-LAST-MAINT-DT.
  9906
  9907     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9908                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9909     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9910
  9911
  9912
  9913* EXEC CICS WRITE
  9914*        DATASET   (ELTRLR-DSID)
  9915*        FROM      (ACTIVITY-TRAILERS)
  9916*        RIDFLD    (AT-CONTROL-PRIMARY)
  9917*    END-EXEC.
  9918     MOVE LENGTH OF
  9919      ACTIVITY-TRAILERS
  9920       TO DFHEIV11
  9921*    MOVE '&$ L                  ''   #00009272' TO DFHEIV0
  9922     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9923     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9924     MOVE X'2020233030303039323732' TO DFHEIV0(25:11)
  9925     CALL 'kxdfhei1' USING DFHEIV0,
  9926           ELTRLR-DSID,
  9927           ACTIVITY-TRAILERS,
  9928           DFHEIV11,
  9929           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 186
* EL130.cbl
  9930           DFHEIV99,
  9931           DFHEIV99
  9932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9933
  9934
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 187
* EL130.cbl
  9936 3400-CHECK-CERT-MAINT.
  9937
  9938     IF CERTMTI = 'A'
  9939         GO TO 3600-BUILD-NEW-CERT
  9940     END-IF.
  9941
  9942     IF NO-CLAIM-ATTACHED
  9943         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9944     END-IF.
  9945
  9946     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9947
  9948     IF CM-LF-CURRENT-STATUS = '2' OR
  9949        CM-AH-CURRENT-STATUS = '2'
  9950         GO TO 3400-REWRITE-CERT
  9951     END-IF.
  9952
  9953     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9954
  9955 3400-REWRITE-CERT.
  9956
  9957
  9958
  9959* EXEC CICS HANDLE CONDITION
  9960*        DUPKEY (3410-DUP-KEY)
  9961*    END-EXEC.
  9962*    MOVE '"$$                   ! 8 #00009301' TO DFHEIV0
  9963     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9964     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9965     MOVE X'3820233030303039333031' TO DFHEIV0(25:11)
  9966     CALL 'kxdfhei1' USING DFHEIV0
  9967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9968
  9969
  9970
  9971
  9972* EXEC CICS REWRITE
  9973*        DATASET   (ELCERT-DSID)
  9974*        FROM      (CERTIFICATE-MASTER)
  9975*    END-EXEC.
  9976     MOVE LENGTH OF
  9977      CERTIFICATE-MASTER
  9978       TO DFHEIV11
  9979*    MOVE '&& L                  %   #00009306' TO DFHEIV0
  9980     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9981     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9982     MOVE X'2020233030303039333036' TO DFHEIV0(25:11)
  9983     CALL 'kxdfhei1' USING DFHEIV0,
  9984           ELCERT-DSID,
  9985           CERTIFICATE-MASTER,
  9986           DFHEIV11,
  9987           DFHEIV99
  9988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9989
  9990
  9991 3410-DUP-KEY.
  9992     GO TO 3800-BUILD-NEW-CLAIM.
  9993
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 188
* EL130.cbl
  9994 3600-BUILD-NEW-CERT.
  9995
  9996
  9997* EXEC CICS GETMAIN
  9998*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9999*        LENGTH   (ELCERT-LENGTH)
 10000*    END-EXEC.
 10001*    MOVE '," L                  $   #00009316' TO DFHEIV0
 10002     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10003     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10004     MOVE X'2020233030303039333136' TO DFHEIV0(25:11)
 10005     CALL 'kxdfhei1' USING DFHEIV0,
 10006           DFHEIV20,
 10007           ELCERT-LENGTH,
 10008           DFHEIV99
 10009     SET ADDRESS OF CERTIFICATE-MASTER TO
 10010         DFHEIV20
 10011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10012
 10013
 10014     MOVE SPACES                 TO CERTIFICATE-MASTER.
 10015
 10016     MOVE 'CM'                   TO CM-RECORD-ID.
 10017
 10018     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
 10019                                    CM-COMPANY-CD-A1
 10020                                    CM-COMPANY-CD-A2
 10021                                    CM-COMPANY-CD-A4
 10022                                    CM-COMPANY-CD-A5.
 10023
 10024     MOVE CERT-CARRIER           TO CM-CARRIER.
 10025     MOVE CERT-GROUPING          TO CM-GROUPING.
 10026     MOVE CERT-STATE             TO CM-STATE.
 10027     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
 10028     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
 10029     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
 10030
 10031     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
 10032                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
 10033                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
 10034                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
 10035                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
 10036                       CM-LIVES              CM-LOAN-TERM
 10037                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
 10038                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10039                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10040                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10041                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10042                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10043                       CM-LF-ALT-PREMIUM-RATE
 10044                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10045                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10046                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10047                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10048                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10049
 10050     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10051                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 189
* EL130.cbl
 10052                                    CM-AH-SETTLEMENT-DT
 10053                                    CM-AH-CANCEL-EXIT-DT
 10054                                    CM-AH-SETTLEMENT-EXIT-DT
 10055                                    CM-LF-LOAN-EXPIRE-DT
 10056                                    CM-LF-CANCEL-DT
 10057                                    CM-LF-DEATH-DT
 10058                                    CM-LF-CANCEL-EXIT-DT
 10059                                    CM-LF-DEATH-EXIT-DT
 10060                                    CM-LAST-ADD-ON-DT
 10061                                    CM-ENTRY-DT.
 10062
 10063     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10064     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10065     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10066
 10067     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10068                                    CM-PART-LAST-NAME-A2
 10069                                    CM-PART-LAST-NAME-A5.
 10070
 10071     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10072                                    CM-INSURED-INITIAL1-A2
 10073                                    CM-INSURED-INITIAL1-A5
 10074                                    CM-INSURED-FIRST-NAME.
 10075
 10076     IF CRTINITL GREATER ZERO
 10077         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10078                                    CM-INSURED-INITIAL2-A2
 10079                                    CM-INSURED-INITIAL2-A5
 10080     ELSE
 10081         MOVE SPACES             TO CM-INSURED-INITIAL2
 10082                                    CM-INSURED-INITIAL2-A2
 10083                                    CM-INSURED-INITIAL2-A5
 10084     END-IF.
 10085
 10086     IF CM-INSURED-INITIALS = SPACES
 10087         MOVE '**'               TO CM-INSURED-INITIALS
 10088     END-IF.
 10089
 10090     IF MEMBERL GREATER ZERO
 10091         MOVE MEMBERI              TO CM-MEMBER-NO
 10092     ELSE
 10093         MOVE CERT-STATE           TO CM-MEMB-STATE
 10094         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10095         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10096         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10097     END-IF.
 10098
 10099     IF JNTLNMEL GREATER ZERO
 10100         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10101     END-IF.
 10102
 10103     IF JNTFNMEL GREATER ZERO
 10104         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10105     END-IF.
 10106
 10107     IF JNTINITL GREATER ZERO
 10108         MOVE JNTINITI           TO CM-JT-INITIAL
 10109     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 190
* EL130.cbl
 10110
 10111     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10112
 10113
 10114
 10115* EXEC CICS HANDLE CONDITION
 10116*        DUPKEY   (3690-CERT-WRITTEN)
 10117*    END-EXEC.
 10118*    MOVE '"$$                   ! 9 #00009421' TO DFHEIV0
 10119     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10121     MOVE X'3920233030303039343231' TO DFHEIV0(25:11)
 10122     CALL 'kxdfhei1' USING DFHEIV0
 10123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10124
 10125
 10126
 10127
 10128* EXEC CICS WRITE
 10129*        DATASET   (ELCERT-DSID)
 10130*        FROM      (CERTIFICATE-MASTER)
 10131*        RIDFLD    (CM-CONTROL-PRIMARY)
 10132*    END-EXEC.
 10133     MOVE LENGTH OF
 10134      CERTIFICATE-MASTER
 10135       TO DFHEIV11
 10136*    MOVE '&$ L                  ''   #00009426' TO DFHEIV0
 10137     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10138     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10139     MOVE X'2020233030303039343236' TO DFHEIV0(25:11)
 10140     CALL 'kxdfhei1' USING DFHEIV0,
 10141           ELCERT-DSID,
 10142           CERTIFICATE-MASTER,
 10143           DFHEIV11,
 10144           CM-CONTROL-PRIMARY,
 10145           DFHEIV99,
 10146           DFHEIV99
 10147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10148
 10149
 10150 3690-CERT-WRITTEN.
 10151
 10152     GO TO 3800-BUILD-NEW-CLAIM.
 10153
 10154 3690-EXIT.
 10155      EXIT.
 10156
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 191
* EL130.cbl
 10158 3700-BUILD-CERT.
 10159
 10160     IF CERTMTI NOT = 'A'
 10161         GO TO 3700-FINISH-CERT-BUILD
 10162     END-IF.
 10163
 10164     IF CERTMTI = 'A'
 10165         IF LCVCDL = ZEROS
 10166             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10167                                    CM-LF-ORIG-TERM
 10168                                    CM-LF-BENEFIT-AMT
 10169                                    CM-LF-PREMIUM-RATE
 10170             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10171         END-IF
 10172     END-IF.
 10173
 10174     IF LCVCDL GREATER ZERO
 10175         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10176     END-IF.
 10177
 10178     IF LCVOTRML GREATER ZERO
 10179         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10180     END-IF.
 10181
 10182     IF LCVBENEL GREATER ZERO
 10183         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10184     END-IF.
 10185
 10186     IF LCVRATEL GREATER ZERO
 10187         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10188     END-IF.
 10189
 10190     IF WS-EXPIRE NOT = LOW-VALUES
 10191         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10192     END-IF.
 10193
 10194     IF LCVFORML GREATER ZERO
 10195         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10196     END-IF.
 10197
 10198     IF LCVCNDTL = ZERO
 10199        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10200     END-IF.
 10201
 10202     IF WS-LCVCNDT NOT = LOW-VALUES
 10203        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10204        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10205        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10206     END-IF.
 10207
 10208     IF CM-LF-CURRENT-STATUS = '7'
 10209        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10210        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10211        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10212                                    CM-LF-DEATH-DT
 10213        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10214     END-IF.
 10215
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 192
* EL130.cbl
 10216     IF CM-LF-CURRENT-STATUS = '8'
 10217        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10218        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10219     END-IF.
 10220
 10221 3700-BUILD-AH-COVERAGE-SIDE.
 10222
 10223     IF CERTMTI = 'A'
 10224         IF ACVCDL = ZEROS
 10225             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10226                                    CM-AH-ORIG-TERM
 10227                                    CM-AH-BENEFIT-AMT
 10228                                    CM-AH-PREMIUM-RATE
 10229             GO TO 3700-COVERAGE-BUILT
 10230         END-IF
 10231     END-IF.
 10232
 10233     IF ACVCDL GREATER ZERO
 10234         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10235     END-IF.
 10236
 10237     IF ACVOTRML GREATER ZERO
 10238         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10239     END-IF.
 10240
 10241     IF ACVBENEL GREATER ZERO
 10242         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10243     END-IF.
 10244
 10245     IF ACVRATEL GREATER ZERO
 10246         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10247     END-IF.
 10248
 10249     IF WS-EXPIRE NOT = LOW-VALUES
 10250         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10251     END-IF.
 10252
 10253     IF ACVFORML GREATER ZERO
 10254         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10255     END-IF.
 10256
 10257     IF ACVCNDTL = ZERO
 10258        GO TO 3700-COVERAGE-BUILT
 10259     END-IF.
 10260
 10261     IF WS-ACVCNDT NOT = LOW-VALUES
 10262        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10263        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10264        GO TO 3700-COVERAGE-BUILT
 10265     END-IF.
 10266
 10267     IF CM-AH-CURRENT-STATUS = '6'
 10268        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10269        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10270        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10271        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10272        GO TO 3700-COVERAGE-BUILT
 10273     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 193
* EL130.cbl
 10274
 10275     IF CM-AH-CURRENT-STATUS = '8'
 10276        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10277        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10278     END-IF.
 10279
 10280 3700-COVERAGE-BUILT.
 10281     IF ISSAGEL GREATER ZERO
 10282         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10283     END-IF.
 10284
 10285     IF JNTAGEL GREATER ZERO
 10286         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10287     END-IF.
 10288
 10289     IF SEXL GREATER ZERO
 10290         MOVE SEXI               TO CM-INSURED-SEX
 10291     END-IF.
 10292
 10293     IF APRL GREATER ZERO
 10294         MOVE WS-APR             TO CM-LOAN-APR
 10295     END-IF.
 10296
 10297     IF PMTFREQL GREATER ZERO
 10298         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10299     END-IF.
 10300
 10301     IF INDGRPL GREATER ZERO
 10302         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10303     END-IF.
 10304
 10305     IF CERTMTI = 'A'
 10306         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10307     END-IF.
 10308
 10309     IF REINCDL GREATER ZERO
 10310         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10311                                    WS-REIN-1
 10312                                    WS-REIN-2
 10313                                    WS-REIN-3
 10314         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10315     END-IF.
 10316
 10317     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10318         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10319     END-IF.
 10320
 10321     IF CRTSSNL GREATER ZERO
 10322         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10323     ELSE
 10324         IF SSNL GREATER ZERO
 10325             MOVE SSNI           TO CM-SOC-SEC-NO
 10326         END-IF
 10327     END-IF.
 10328
 10329     IF CRTSSNL = ZERO AND
 10330        SSNL    = ZERO
 10331         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 194
* EL130.cbl
 10332         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10333         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10334         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10335     END-IF.
 10336
 10337     IF CM-LF-CURRENT-STATUS = SPACES
 10338         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10339     END-IF.
 10340
 10341     IF CM-AH-CURRENT-STATUS = SPACES
 10342         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10343     END-IF.
 10344
 10345     IF CERTMTI = 'A'
 10346         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10347     END-IF.
 10348
 10349 3700-FINISH-CERT-BUILD.
 10350
 10351     IF LOANNOL GREATER ZERO
 10352         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10353     END-IF.
 10354
 10355     IF LOANBALL GREATER ZERO
 10356         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10357     END-IF.
 10358
 10359     IF PREMTYPL GREATER ZERO
 10360         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10361     END-IF.
 10362
 10363 3700-EXIT.
 10364      EXIT.
 10365
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 195
* EL130.cbl
 10367 3800-BUILD-NEW-CLAIM.
 10368
 10369*************************************************************
 10370*****           START OF ACTIVITY FILE PROCESSING          **
 10371*************************************************************
 10372     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10373         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10374                 6700-EXIT
 10375     END-IF.
 10376*************************************************************
 10377*****            END OF ACTIVITY FILE PROCESSING           **
 10378*************************************************************
 10379
 10380
 10381
 10382
 10383* EXEC CICS GETMAIN
 10384*        SET     (ADDRESS OF CLAIM-MASTER)
 10385*        LENGTH  (ELMSTR-LENGTH)
 10386*    END-EXEC.
 10387*    MOVE '," L                  $   #00009664' TO DFHEIV0
 10388     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10389     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10390     MOVE X'2020233030303039363634' TO DFHEIV0(25:11)
 10391     CALL 'kxdfhei1' USING DFHEIV0,
 10392           DFHEIV20,
 10393           ELMSTR-LENGTH,
 10394           DFHEIV99
 10395     SET ADDRESS OF CLAIM-MASTER TO
 10396         DFHEIV20
 10397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10398
 10399
 10400     MOVE SPACES TO CLAIM-MASTER.
 10401
 10402     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10403         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10404         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10405         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10406         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10407         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10408         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10409         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10410
 10411     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10412             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10413             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10414             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10415             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10416             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10417             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10418             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10419             CL-FORCEABLE-ERROR-CNT.
 10420
 10421     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10422
 10423     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10424                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 196
* EL130.cbl
 10425                                    CL-LAG-REPORT-CODE
 10426                                    CL-CRITICAL-PERIOD
 10427*                                   CL-CRIT-PER-RTW-MOS
 10428     move 01                     to cl-benefit-period
 10429
 10430     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10431     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10432
 10433     IF BENECDL NOT = ZEROS
 10434        MOVE BENECDI             TO CL-BENEFICIARY
 10435     END-IF.
 10436
 10437     MOVE 'CL'                   TO CL-RECORD-ID.
 10438     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10439
 10440     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10441                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10442                             CL-COMPANY-CD-A5.
 10443
 10444     MOVE CLMCARRI               TO CL-CARRIER.
 10445
 10446     IF CLMNOL = ZERO
 10447         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10448     ELSE
 10449         MOVE CLMNOI             TO CL-CLAIM-NO
 10450     END-IF.
 10451
 10452     MOVE CERTNOI                TO CL-CERT-PRIME
 10453                                    CL-CERT-A4-PRIME.
 10454
 10455     MOVE SUFXI                  TO CL-CERT-SFX
 10456                                    CL-CERT-A4-SFX.
 10457
 10458     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10459
 10460     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10461
 10462     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10463
 10464     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10465
 10466     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10467     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10468
 10469     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10470
 10471     IF CERTMTI = 'A'
 10472         MOVE '2'                TO CL-CERT-ORIGIN
 10473     ELSE
 10474         MOVE '1'                TO CL-CERT-ORIGIN
 10475     END-IF.
 10476
 10477     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10478     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10479     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10480     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10481     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10482
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 197
* EL130.cbl
 10483 3820-REWRITE-CONTROL-FILE.
 10484
 10485     IF CLMNOL GREATER ZERO
 10486         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10487     END-IF.
 10488
 10489     IF CF-RECORD-TYPE = '6'
 10490         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10491     ELSE
 10492         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10493     END-IF.
 10494
 10495
 10496
 10497* EXEC CICS REWRITE
 10498*        DATASET   (ELCNTL-DSID)
 10499*        FROM      (CONTROL-FILE)
 10500*    END-EXEC.
 10501     MOVE LENGTH OF
 10502      CONTROL-FILE
 10503       TO DFHEIV11
 10504*    MOVE '&& L                  %   #00009765' TO DFHEIV0
 10505     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10506     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10507     MOVE X'2020233030303039373635' TO DFHEIV0(25:11)
 10508     CALL 'kxdfhei1' USING DFHEIV0,
 10509           ELCNTL-DSID,
 10510           CONTROL-FILE,
 10511           DFHEIV11,
 10512           DFHEIV99
 10513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10514
 10515
 10516 3830-SEQUENCE-CLAIM-RECORDS.
 10517
 10518     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10519     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10520     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10521
 10522     IF WS-ASSOC-CERT-TOTAL = ZERO
 10523         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10524                                    CL-ASSOC-CERT-TOTAL
 10525         GO TO 3840-WRITE-CLAIM-MASTER
 10526     END-IF.
 10527
 10528     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10529         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10530     ELSE
 10531         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10532     END-IF.
 10533
 10534     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10535     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10536     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10537
 10538 3840-WRITE-CLAIM-MASTER.
 10539
 10540     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 198
* EL130.cbl
 10541     IF WS-REC-FOUND-SW = 'Y'
 10542         MOVE 01                 TO  CL-ACTIVITY-CODE
 10543         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10544         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10545     END-IF.
 10546
 10547
 10548
 10549* EXEC CICS HANDLE CONDITION
 10550*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10551*    END-EXEC.
 10552*    MOVE '"$$                   ! : #00009802' TO DFHEIV0
 10553     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10554     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10555     MOVE X'3A20233030303039383032' TO DFHEIV0(25:11)
 10556     CALL 'kxdfhei1' USING DFHEIV0
 10557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10558
 10559
 10560** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10561     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10562
 10563
 10564*    DISPLAY ' ABOUT TO WRITE ELMSTR '
 10565*    DISPLAY ' KEY ' CL-CARRIER ' ' CL-CLAIM-NO ' '
 10566*       CL-CERT-NO
 10567*    IF CL-COMPANY-CD = X'04'
 10568*       DISPLAY ' CID COMP CD '
 10569*    ELSE
 10570*       IF CL-COMPANY-CD = X'05'
 10571*          DISPLAY ' DCC COMP CD '
 10572*       ELSE
 10573*          DISPLAY ' UNKNOWN COMP CD '
 10574*       END-IF
 10575*    END-IF
 10576
 10577* EXEC CICS WRITE
 10578*        DATASET   (ELMSTR-DSID)
 10579*        FROM      (CLAIM-MASTER)
 10580*        RIDFLD    (CL-CONTROL-PRIMARY)
 10581*    END-EXEC.
 10582     MOVE LENGTH OF
 10583      CLAIM-MASTER
 10584       TO DFHEIV11
 10585*    MOVE '&$ L                  ''   #00009822' TO DFHEIV0
 10586     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10587     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10588     MOVE X'2020233030303039383232' TO DFHEIV0(25:11)
 10589     CALL 'kxdfhei1' USING DFHEIV0,
 10590           ELMSTR-DSID,
 10591           CLAIM-MASTER,
 10592           DFHEIV11,
 10593           CL-CONTROL-PRIMARY,
 10594           DFHEIV99,
 10595           DFHEIV99
 10596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10597
 10598
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 199
* EL130.cbl
 10599 3850-CLAIM-MSTR-WRITTEN.
 10600
 10601     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10602         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10603     END-IF.
 10604
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 200
* EL130.cbl
 10606 3990-ADD-DONE.
 10607*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10608*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10609*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10610*                                  EMI-ERROR-LINES.
 10611
 10612     IF CLMNOL = ZERO
 10613         move spaces             to emi-claim-no
 10614         MOVE ER-0265            TO EMI-ERROR
 10615         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10616         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10617                                    PI-LAST-CLAIM
 10618     ELSE
 10619         MOVE CLMNOI             TO PI-LAST-CLAIM
 10620                                    MSTR-CLAIM-NO
 10621         MOVE ER-0000            TO EMI-ERROR
 10622         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10623     END-IF.
 10624
 10625     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10626       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10627         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10628         MOVE ER-7575            TO EMI-ERROR
 10629         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10630     END-IF.
 10631
 10632     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 10633       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10634         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10635         MOVE ER-7582            TO EMI-ERROR
 10636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10637     END-IF.
 10638
 10639     IF WS-NO-INSURED-ADDRESS = 'Y'
 10640         MOVE ER-3548            TO EMI-ERROR
 10641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10642     END-IF.
 10643
 10644     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10645       (PI-ST-CAUSAL-STATE = 'L' AND
 10646              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10647       (PI-ST-CAUSAL-STATE = 'A' AND
 10648              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10649         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10650         MOVE ER-7577            TO EMI-ERROR
 10651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10652     END-IF.
 10653     if pi-company-id = 'DCC'
 10654        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10655                                 THRU 3994C-EXIT
 10656     end-if
 10657     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10658     MOVE CLMCARRI                   TO  PI-CARRIER.
 10659     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10660     MOVE SUFXI                      TO  PI-CERT-SFX.
 10661
 10662     IF WS-LETTER-SW = 'Y'
 10663         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 201
* EL130.cbl
 10664         IF W-1523-ERROR-CODE NOT = ZEROS
 10665             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10666             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10667         END-IF
 10668     END-IF.
 10669
 10670     perform 3998-update-cert-claim-trailer
 10671                                 thru 3998-exit
 10672     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10673     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10674     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10675     MOVE CLMCARRI               TO PI-LAST-CARR.
 10676
 10677     IF PRTOPTL GREATER THAN 0
 10678         MOVE PRTOPTI            TO PI-PRT-OPT
 10679     END-IF.
 10680     IF ALTPRTL GREATER THAN 0
 10681         MOVE ALTPRTI            TO PI-ALT-PRT
 10682     END-IF.
 10683
 10684     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10685         MOVE LOW-VALUES         TO EL130AI
 10686         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10687         MOVE AL-SANON           TO CERTNOA
 10688         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10689         MOVE AL-SANON           TO SUFXA
 10690         MOVE PI-LAST-CARR       TO CLMCARRO
 10691         MOVE AL-UANON           TO CLMCARRA
 10692         MOVE PI-LAST-CLAIM      TO CLMNOO
 10693         MOVE AL-UANON           TO CLMNOA
 10694         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10695         MOVE AL-UANON           TO CLMTYPEA
 10696     ELSE
 10697         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10698         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10699     END-IF.
 10700
 10701     IF PI-PRT-OPT = 'N' OR 'L'
 10702         MOVE PI-PRT-OPT         TO PRTOPTO
 10703         MOVE 1                  TO PRTOPTL
 10704     END-IF.
 10705
 10706     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10707         MOVE PI-ALT-PRT         TO ALTPRTO
 10708         MOVE 4                  TO ALTPRTL
 10709     END-IF.
 10710
 10711     IF PRTOPTL GREATER THAN 0
 10712         IF PRTOPTI = 'L'
 10713             GO TO 0400-CREATE-ELACTQ
 10714         ELSE
 10715             GO TO 0480-PRINT-NOW
 10716         END-IF
 10717     END-IF.
 10718     move 'S'                    to mainti
 10719     PERFORM 0500-CREATE-TEMP-STORAGE
 10720                                 THRU 0599-EXIT
 10721     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 202
* EL130.cbl
 10722         GO TO 8100-SEND-INITIAL-MAP
 10723     ELSE
 10724         MOVE LOW-VALUES         TO MAINTO
 10725         MOVE -1                 TO MAINTL
 10726         GO TO 8200-SEND-DATAONLY
 10727     END-IF.
 10728
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 203
* EL130.cbl
 10730 3993-MODIFY-SCREEN-ATTRB.
 10731
 10732     IF CERTMTL GREATER ZERO
 10733         MOVE AL-UANON           TO CERTMTA
 10734     END-IF.
 10735
 10736     IF EFFDTL GREATER ZERO
 10737         MOVE AL-UANON           TO EFFDTA
 10738     END-IF.
 10739
 10740     IF ACCOUNTL GREATER ZERO
 10741         MOVE AL-UANON           TO ACCOUNTA
 10742     END-IF.
 10743
 10744     IF STATEL GREATER ZERO
 10745         MOVE AL-UANON           TO STATEA
 10746     END-IF.
 10747
 10748     IF CRTCARRL GREATER ZERO
 10749         MOVE AL-UANON           TO CRTCARRA
 10750     END-IF.
 10751
 10752     IF GROUPL GREATER ZERO
 10753         MOVE AL-UANON           TO GROUPA
 10754     END-IF.
 10755
 10756     IF CRTLNMEL GREATER ZERO
 10757         MOVE AL-UANON           TO CRTLNMEA
 10758     END-IF.
 10759
 10760     IF CRTFNMEL GREATER ZERO
 10761         MOVE AL-UANON           TO CRTFNMEA
 10762     END-IF.
 10763
 10764     IF CRTINITL GREATER ZERO
 10765         MOVE AL-UANON           TO CRTINITA
 10766     END-IF.
 10767
 10768     IF ISSAGEL GREATER ZERO
 10769         MOVE AL-UNNON           TO ISSAGEA
 10770     END-IF.
 10771
 10772     IF JNTLNMEL GREATER ZERO
 10773         MOVE AL-UANON           TO JNTLNMEA
 10774     END-IF.
 10775
 10776     IF JNTFNMEL GREATER ZERO
 10777         MOVE AL-UANON           TO JNTFNMEA
 10778     END-IF.
 10779
 10780     IF JNTINITL GREATER ZERO
 10781         MOVE AL-UANON           TO JNTINITA
 10782     END-IF.
 10783
 10784     IF JNTAGEL GREATER ZERO
 10785         MOVE AL-UNNON           TO JNTAGEA
 10786     END-IF.
 10787
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 204
* EL130.cbl
 10788     IF CRTSSNL GREATER ZERO
 10789         MOVE AL-UANON           TO CRTSSNA
 10790     END-IF.
 10791
 10792     IF ACVDSCRL GREATER ZERO
 10793         MOVE AL-SANON           TO ACVDSCRA
 10794     END-IF.
 10795
 10796     IF ACVKINDL GREATER ZERO
 10797         MOVE AL-SANON           TO ACVKINDA
 10798     END-IF.
 10799
 10800     IF ACVCDL GREATER ZERO
 10801         MOVE AL-UANON           TO ACVCDA
 10802     END-IF.
 10803
 10804     IF ACVOTRML GREATER ZERO
 10805         MOVE AL-UNNON           TO ACVOTRMA
 10806     END-IF.
 10807
 10808     IF ACVRTRML GREATER ZERO
 10809         MOVE AL-UNNON           TO ACVRTRMA
 10810     END-IF.
 10811
 10812     IF ACVRATEL GREATER ZERO
 10813         MOVE AL-UNNON           TO ACVRATEA
 10814     END-IF.
 10815
 10816     IF ACVBENEL GREATER ZERO
 10817         MOVE AL-UNNON           TO ACVBENEA
 10818     END-IF.
 10819
 10820     IF ACVFORML GREATER ZERO
 10821         MOVE AL-UANON           TO ACVFORMA
 10822     END-IF.
 10823
 10824     IF ACVCNDTL GREATER ZERO
 10825         MOVE AL-UANON           TO ACVCNDTA
 10826     END-IF.
 10827
 10828     IF ACVEXITL GREATER ZERO
 10829         MOVE AL-UANON           TO ACVEXITA
 10830     END-IF.
 10831
 10832     IF ACVSTATL GREATER ZERO
 10833         MOVE AL-UANON           TO ACVSTATA
 10834     END-IF.
 10835
 10836     IF LCVDSCRL GREATER ZERO
 10837         MOVE AL-SANON           TO LCVDSCRA
 10838     END-IF.
 10839
 10840     IF LCVKINDL GREATER ZERO
 10841         MOVE AL-SANON           TO LCVKINDA
 10842     END-IF.
 10843
 10844     IF LCVCDL GREATER ZERO
 10845         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 205
* EL130.cbl
 10846     END-IF.
 10847
 10848     IF LCVOTRML GREATER ZERO
 10849         MOVE AL-UNNON           TO LCVOTRMA
 10850     END-IF.
 10851
 10852     IF LCVRTRML GREATER ZERO
 10853         MOVE AL-UNNON           TO LCVRTRMA
 10854     END-IF.
 10855
 10856     IF LCVRATEL GREATER ZERO
 10857         MOVE AL-UNNON           TO LCVRATEA
 10858     END-IF.
 10859
 10860     IF LCVBENEL GREATER ZERO
 10861         MOVE AL-UNNON           TO LCVBENEA
 10862     END-IF.
 10863
 10864     IF LCVFORML GREATER ZERO
 10865         MOVE AL-UANON           TO LCVFORMA
 10866     END-IF.
 10867
 10868     IF LCVCNDTL GREATER ZERO
 10869         MOVE AL-UANON           TO LCVCNDTA
 10870     END-IF.
 10871
 10872     IF LCVEXITL GREATER ZERO
 10873         MOVE AL-UANON           TO LCVEXITA
 10874     END-IF.
 10875
 10876     IF LCVSTATL GREATER ZERO
 10877         MOVE AL-UANON           TO LCVSTATA
 10878     END-IF.
 10879
 10880     IF MEMCAPL GREATER ZERO
 10881         MOVE AL-UANON           TO MEMCAPA
 10882     END-IF.
 10883
 10884     IF APRL GREATER ZERO
 10885         MOVE AL-UNNON           TO APRA
 10886     END-IF.
 10887
 10888     IF PMTFREQL GREATER ZERO
 10889         MOVE AL-UNNON           TO PMTFREQA
 10890     END-IF.
 10891
 10892     IF INDGRPL GREATER ZERO
 10893         MOVE AL-UANON           TO INDGRPA
 10894     END-IF.
 10895
 10896     IF PREMTYPL GREATER ZERO
 10897         MOVE AL-UANON           TO PREMTYPA
 10898     END-IF.
 10899
 10900     IF REINCDL GREATER ZERO
 10901         MOVE AL-UANON           TO REINCDA
 10902     END-IF.
 10903
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 206
* EL130.cbl
 10904     IF ADDONDTL GREATER ZERO
 10905         MOVE AL-UANON           TO ADDONDTA
 10906     END-IF.
 10907
 10908     IF MEMBERL GREATER ZERO
 10909         MOVE AL-UANON           TO MEMBERA
 10910     END-IF.
 10911
 10912     IF BCERT1L GREATER ZERO
 10913         MOVE AL-SANON           TO BCERT1A
 10914                                    BSUFX1A
 10915     END-IF.
 10916
 10917     IF BCERT2L GREATER ZERO
 10918         MOVE AL-SANON           TO BCERT2A
 10919                                    BSUFX2A
 10920     END-IF.
 10921
 10922     IF BCERT3L GREATER ZERO
 10923         MOVE AL-SANON           TO BCERT3A
 10924                                    BSUFX3A
 10925     END-IF.
 10926
 10927     IF BCERT4L GREATER ZERO
 10928         MOVE AL-SANON           TO BCERT4A
 10929                                    BSUFX4A
 10930     END-IF.
 10931
 10932     IF BCERT5L GREATER ZERO
 10933         MOVE AL-SANON           TO BCERT5A
 10934                                    BSUFX5A
 10935     END-IF.
 10936
 10937 3993-MODIFY-CLAIM-ATTRB.
 10938
 10939     IF PCERTNOL GREATER ZERO
 10940         MOVE AL-UANON           TO PCERTNOA
 10941     END-IF.
 10942
 10943     IF PSUFXL GREATER ZERO
 10944         MOVE AL-UANON           TO PSUFXA
 10945     END-IF.
 10946
 10947     IF LSTNMEL GREATER ZERO
 10948         MOVE AL-UANON           TO LSTNMEA
 10949     END-IF.
 10950
 10951     IF FSTNMEL GREATER ZERO
 10952         MOVE AL-UANON           TO FSTNMEA
 10953     END-IF.
 10954
 10955     IF INITL GREATER ZERO
 10956         MOVE AL-UANON           TO INITA
 10957     END-IF.
 10958
 10959     IF SEXL GREATER ZERO
 10960         MOVE AL-UANON           TO SEXA
 10961     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 207
* EL130.cbl
 10962
 10963     IF BIRTHDTL GREATER ZERO
 10964         MOVE AL-UANON           TO BIRTHDTA
 10965     END-IF.
 10966
 10967     IF SSNL GREATER ZERO
 10968         MOVE AL-UANON           TO SSNA
 10969     END-IF.
 10970
 10971     IF INCURL GREATER ZERO
 10972         MOVE AL-UANON           TO INCURA
 10973     END-IF.
 10974
 10975     IF REPORTL GREATER ZERO
 10976         MOVE AL-UANON           TO REPORTA
 10977     END-IF.
 10978
 10979*    IF ESTENDL GREATER ZERO
 10980*        MOVE AL-UANON           TO ESTENDA
 10981*    END-IF.
 10982
 10983     IF DIAGL GREATER ZERO
 10984         MOVE AL-UANON           TO DIAGA
 10985     END-IF.
 10986*
 10987     IF ICD1L GREATER ZERO
 10988         MOVE AL-UANON           TO ICD1A
 10989     END-IF.
 10990
 10991     IF ICD2L GREATER ZERO
 10992         MOVE AL-UANON           TO ICD2A
 10993     END-IF.
 10994
 10995*    IF CAUSEL GREATER ZERO
 10996*        MOVE AL-UANON           TO CAUSEA
 10997*    END-IF.
 10998
 10999     IF MANRSVL GREATER ZERO
 11000         MOVE AL-UNNON           TO MANRSVA
 11001     END-IF.
 11002
 11003     IF RELCLML GREATER ZERO
 11004         MOVE AL-UANON           TO RELCLMA
 11005     END-IF.
 11006
 11007     IF LOANNOL GREATER ZERO
 11008         MOVE AL-UANON           TO LOANNOA
 11009     END-IF.
 11010
 11011     IF LOANBALL GREATER ZERO
 11012         MOVE AL-UNNON           TO LOANBALA
 11013     END-IF.
 11014
 11015     IF PROCCDL GREATER ZERO
 11016         MOVE AL-UANON           TO PROCCDA
 11017     END-IF.
 11018
 11019     IF BENECDL GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 208
* EL130.cbl
 11020         MOVE AL-UANON           TO  BENECDA
 11021     END-IF.
 11022
 11023     IF PRICDL GREATER ZERO
 11024         MOVE AL-UANON           TO PRICDA
 11025     END-IF.
 11026
 11027     IF SUPVL GREATER ZERO
 11028         MOVE AL-UANON           TO SUPVA
 11029     END-IF.
 11030
 11031     IF FILETOL GREATER ZERO
 11032         MOVE AL-UANON           TO FILETOA
 11033     END-IF.
 11034
 11035
 11036 3993-MODIFY-CLAIM-KEY-ATTRB.
 11037
 11038     IF CLMNOL GREATER ZERO
 11039         MOVE AL-UANON           TO CLMNOA
 11040     END-IF.
 11041
 11042     IF CLMCARRL GREATER ZERO
 11043         MOVE AL-UANON           TO CLMCARRA
 11044     END-IF.
 11045
 11046     IF CLMTYPEL GREATER ZERO
 11047         MOVE AL-UANON           TO CLMTYPEA
 11048     END-IF.
 11049
 11050     IF CERTNOL GREATER ZERO
 11051         MOVE AL-SANON           TO CERTNOA
 11052     END-IF.
 11053
 11054     IF SUFXL GREATER ZERO
 11055         MOVE AL-SANON           TO SUFXA
 11056     END-IF.
 11057
 11058 3993-EXIT.
 11059     EXIT.
 11060
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 209
* EL130.cbl
 11062 3994-BUILD-NINETY-THREE-TRAILER.
 11063
 11064     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11065     MOVE 'AT'                   TO AT-RECORD-ID.
 11066
 11067     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11068     MOVE CLMCARRI               TO AT-CARRIER.
 11069
 11070     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11071     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11072     MOVE +93                    TO AT-SEQUENCE-NO.
 11073     MOVE '6'                    TO AT-TRAILER-TYPE.
 11074     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11075
 11076     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11077         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11078     ELSE
 11079         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11080     END-IF
 11081
 11082     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11083                                    AT-GEN-INFO-LAST-MAINT-DT.
 11084
 11085     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11086                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11087     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11088
 11089
 11090
 11091* EXEC CICS WRITE
 11092*        DATASET   (ELTRLR-DSID)
 11093*        FROM      (ACTIVITY-TRAILERS)
 11094*        RIDFLD    (AT-CONTROL-PRIMARY)
 11095*    END-EXEC.
 11096     MOVE LENGTH OF
 11097      ACTIVITY-TRAILERS
 11098       TO DFHEIV11
 11099*    MOVE '&$ L                  ''   #00010319' TO DFHEIV0
 11100     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11101     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11102     MOVE X'2020233030303130333139' TO DFHEIV0(25:11)
 11103     CALL 'kxdfhei1' USING DFHEIV0,
 11104           ELTRLR-DSID,
 11105           ACTIVITY-TRAILERS,
 11106           DFHEIV11,
 11107           AT-CONTROL-PRIMARY,
 11108           DFHEIV99,
 11109           DFHEIV99
 11110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11111
 11112
 11113 3994-EXIT.
 11114     EXIT.
 11115
 11116 3994B-BUILD-NINETY-FOUR-TRAILER.
 11117
 11118     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11119     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 210
* EL130.cbl
 11120
 11121     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11122     MOVE CLMCARRI               TO AT-CARRIER.
 11123
 11124     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11125     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11126     MOVE +94                    TO AT-SEQUENCE-NO.
 11127     MOVE '6'                    TO AT-TRAILER-TYPE.
 11128     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11129
 11130     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11131
 11132     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11133                                    AT-GEN-INFO-LAST-MAINT-DT.
 11134
 11135     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11136                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11137     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11138
 11139
 11140
 11141* EXEC CICS WRITE
 11142*        DATASET   (ELTRLR-DSID)
 11143*        FROM      (ACTIVITY-TRAILERS)
 11144*        RIDFLD    (AT-CONTROL-PRIMARY)
 11145*    END-EXEC.
 11146     MOVE LENGTH OF
 11147      ACTIVITY-TRAILERS
 11148       TO DFHEIV11
 11149*    MOVE '&$ L                  ''   #00010352' TO DFHEIV0
 11150     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11151     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11152     MOVE X'2020233030303130333532' TO DFHEIV0(25:11)
 11153     CALL 'kxdfhei1' USING DFHEIV0,
 11154           ELTRLR-DSID,
 11155           ACTIVITY-TRAILERS,
 11156           DFHEIV11,
 11157           AT-CONTROL-PRIMARY,
 11158           DFHEIV99,
 11159           DFHEIV99
 11160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11161
 11162
 11163 3994B-EXIT.
 11164     EXIT.
 11165 3994C-BUILD-NINETY-FIVE-TRAILER.
 11166
 11167     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11168     MOVE 'AT'                   TO AT-RECORD-ID
 11169
 11170     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11171     MOVE CLMCARRI               TO AT-CARRIER
 11172
 11173     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11174     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11175     MOVE +95                    TO AT-SEQUENCE-NO
 11176     MOVE '6'                    TO AT-TRAILER-TYPE
 11177     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 211
* EL130.cbl
 11178
 11179     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11180                                    AT-GEN-INFO-LAST-MAINT-DT
 11181
 11182     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11183                                    AT-GEN-INFO-LAST-UPDATED-BY
 11184     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11185
 11186     perform varying e1 from +1 by +1 until
 11187        ws-error-no (e1) = spaces
 11188        move ws-error-no (e1)    to at-note-error-no (e1)
 11189     end-perform
 11190
 11191     if at-info-line-1 not = spaces
 11192
 11193* EXEC CICS WRITE
 11194*          DATASET  (ELTRLR-DSID)
 11195*          FROM     (ACTIVITY-TRAILERS)
 11196*          RIDFLD   (AT-CONTROL-PRIMARY)
 11197*       END-EXEC
 11198     MOVE LENGTH OF
 11199      ACTIVITY-TRAILERS
 11200       TO DFHEIV11
 11201*    MOVE '&$ L                  ''   #00010387' TO DFHEIV0
 11202     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11203     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11204     MOVE X'2020233030303130333837' TO DFHEIV0(25:11)
 11205     CALL 'kxdfhei1' USING DFHEIV0,
 11206           ELTRLR-DSID,
 11207           ACTIVITY-TRAILERS,
 11208           DFHEIV11,
 11209           AT-CONTROL-PRIMARY,
 11210           DFHEIV99,
 11211           DFHEIV99
 11212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11213     end-if
 11214
 11215     .
 11216 3994C-EXIT.
 11217     EXIT.
 11218 3995-BUILD-CLAIM-RECORD.
 11219     IF PROCCDL GREATER ZERO
 11220         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11221     ELSE
 11222         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11223     END-IF.
 11224
 11225     IF FSTNMEL GREATER ZERO
 11226         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11227     END-IF.
 11228
 11229     IF INITL GREATER ZERO
 11230         MOVE INITI              TO CL-INSURED-MID-INIT
 11231     END-IF.
 11232
 11233     IF BIRTHDTL GREATER ZERO
 11234         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11235     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 212
* EL130.cbl
 11236
 11237     IF SEXL GREATER ZERO
 11238         MOVE SEXI               TO CL-INSURED-SEX-CD
 11239     END-IF.
 11240
 11241     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11242
 11243*    IF CLMTYPEL GREATER ZERO
 11244     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11245*    END-IF.
 11246
 11247     IF PREMTYPL GREATER ZERO
 11248         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11249     END-IF.
 11250
 11251     IF INCURL GREATER ZERO
 11252         MOVE WS-INCUR           TO CL-INCURRED-DT
 11253     END-IF.
 11254
 11255     IF (PI-COMPANY-ID = 'DCC')
 11256        AND (ERPDEF-FOUND)
 11257        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11258*       MOVE WS-CRIT-PER-RECURRENT
 11259*                                TO CL-CRIT-PER-RECURRENT
 11260*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11261        if ws-crit-per-recurrent > 01
 11262           move zeros            to cl-benefit-period
 11263        end-if
 11264     ELSE
 11265        IF CL-CLAIM-TYPE = 'L' OR 'P'
 11266           MOVE CM-LF-CRITICAL-PERIOD
 11267                                 TO CL-CRITICAL-PERIOD
 11268        ELSE
 11269           MOVE CM-AH-CRITICAL-PERIOD
 11270                                 TO CL-CRITICAL-PERIOD
 11271        END-IF
 11272     END-IF
 11273
 11274     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11275        COMPUTE DC-ELAPSED-MONTHS =
 11276           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11277        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11278        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11279        MOVE '6'                 TO DC-OPTION-CODE
 11280        PERFORM 9700-LINK-DATE-CONVERT
 11281                                 THRU 9700-EXIT
 11282        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11283     END-IF
 11284
 11285     if instypel > zero
 11286        move instypei            to cl-insured-type
 11287     end-if
 11288     IF REPORTL GREATER ZERO
 11289         MOVE WS-REPORT          TO CL-REPORTED-DT
 11290     END-IF.
 11291
 11292     IF EIBAID = DFHPF6
 11293         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 213
* EL130.cbl
 11294             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11295                 IF EMI-FORCABLE-CTR = +1
 11296                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11297                 END-IF
 11298         END-IF
 11299     END-IF.
 11300
 11301*    IF ESTENDL GREATER ZERO
 11302*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11303*    END-IF.
 11304
 11305     IF ADDONDTL GREATER ZERO
 11306         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11307     END-IF.
 11308
 11309*    IF CAUSEL GREATER ZERO
 11310*        MOVE CAUSEI             TO CL-CAUSE-CD
 11311*    END-IF.
 11312
 11313     IF SSNL GREATER ZERO
 11314         MOVE SSNI               TO CL-SOC-SEC-NO
 11315     ELSE
 11316         MOVE CERT-STATE         TO CL-SSN-STATE
 11317         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11318         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11319     END-IF.
 11320
 11321     IF PRICDL GREATER ZERO
 11322         MOVE PRICDI             TO CL-PRIORITY-CD
 11323     END-IF.
 11324
 11325     IF SUPVL GREATER ZERO
 11326         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11327     END-IF.
 11328
 11329     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11330     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11331     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11332
 11333     IF RELCLML GREATER ZERO
 11334         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11335     END-IF.
 11336
 11337     IF FILETOL GREATER ZERO
 11338         MOVE FILETOI            TO CL-FILE-LOCATION
 11339     END-IF.
 11340
 11341 3995-EXIT.
 11342      EXIT.
 11343 3996-read-cert-claim-trailer.
 11344
 11345     move cm-ah-benefit-amt      to ws-monthly-benefit
 11346     if (pi-dcc-max-amt < ws-monthly-benefit)
 11347        and (pi-dcc-max-amt not = zeros)
 11348        move pi-dcc-max-amt      to ws-monthly-benefit
 11349     end-if
 11350
 11351     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 214
* EL130.cbl
 11352     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11353     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11354     MOVE CM-STATE               TO CTRLR-STATE
 11355     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11356     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11357     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11358     MOVE 'B'                    TO CTRLR-REC-TYPE
 11359
 11360* EXEC CICS READ
 11361*       DATASET  (ELCRTT-DSID)
 11362*       set     (address of CERTIFICATE-TRAILERS)
 11363*       RIDFLD   (ELCRTT-KEY)
 11364*       RESP     (WS-RESPONSE)
 11365*    END-EXEC
 11366*    MOVE '&"S        E          (  N#00010538' TO DFHEIV0
 11367     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11368     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11369     MOVE X'204E233030303130353338' TO DFHEIV0(25:11)
 11370     CALL 'kxdfhei1' USING DFHEIV0,
 11371           ELCRTT-DSID,
 11372           DFHEIV20,
 11373           DFHEIV99,
 11374           ELCRTT-KEY,
 11375           DFHEIV99,
 11376           DFHEIV99,
 11377           DFHEIV99
 11378     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11379         DFHEIV20
 11380     MOVE EIBRESP  TO WS-RESPONSE
 11381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11382***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11383***                                                            ***
 11384***  This may need some work here. I think I should accumulate ***
 11385***  all the claims with the same claim type?????????          ***
 11386***                                                            ***
 11387***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11388     IF WS-RESP-NORMAL
 11389        move zeros to ws-tot-days-paid ws-tot-amt-paid
 11390        perform varying s1 from +1 by +1 until
 11391           (s1 > +24)
 11392           or (cs-claim-no (s1) = spaces)
 11393           if cs-claim-type (s1) = clmtypei
 11394              move er-1659       to ws-error-no (e1)
 11395              compute ws-tot-days-paid =
 11396                 ws-tot-days-paid + cs-days-paid (s1)
 11397              compute ws-tot-amt-paid =
 11398                 ws-tot-amt-paid + cs-total-paid (s1)
 11399           end-if
 11400        end-perform
 11401*        compute ws-pd-bens rounded = ws-tot-days-paid / 30
 11402*        if (ws-pd-bens >= pi-dcc-max-benefits)
 11403*           and (pi-dcc-max-benefits not = zeros)
 11404*           add +1                to e1
 11405*           MOVE ER-1660          TO EMI-ERROR
 11406*                                    ws-error-no (e1)
 11407*           PERFORM 9900-ERROR-FORMAT
 11408*                                 THRU 9900-EXIT
 11409*        end-if
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 215
* EL130.cbl
 11410     end-if
 11411**       if instypei = 'P'
 11412**          move +1 to s1
 11413**       else
 11414**          MOVE +2 to s1
 11415**       end-if
 11416*
 11417*        move +1 to s1
 11418*        evaluate clmtypei
 11419*           when 'A'
 11420*              move +1 to s2
 11421*           when 'I'
 11422*              move +2 to s2
 11423*           when 'G'
 11424*              move +3 to s2
 11425*           when 'L'
 11426*              move +4 to s2
 11427*           when 'P'
 11428*              move +5 to s2
 11429*        end-evaluate
 11430*        if cs-claim-type (s1 s2) = clmtypei
 11431*           if cs-no-of-claims (s1 s2) > zeros
 11432*              move er-1659       to ws-error-no (e1)
 11433*           end-if
 11434*           compute WS-BENEFITS-PREV-PAID =
 11435*              cs-total-paid (s1 s2) / ws-monthly-benefit
 11436*           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11437*              and (pi-dcc-max-benefits not = zeros)
 11438*              add +1             to e1
 11439*              MOVE ER-1660       TO EMI-ERROR
 11440*                                    ws-error-no (e1)
 11441*              PERFORM 9900-ERROR-FORMAT
 11442*                                 THRU 9900-EXIT
 11443*           end-if
 11444*        end-if
 11445*     end-if
 11446
 11447     .
 11448 3996-exit.
 11449     exit.
 11450
 11451 3997-GET-ERPDEF.
 11452
 11453     if cm-clp-state = spaces or low-values or zeros
 11454        move cm-state            to cm-clp-state
 11455     end-if
 11456     MOVE SPACES                 TO WS-ERPDEF-SW
 11457     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11458                                    WS-CRIT-PER-RTW-MOS
 11459                                    WS-CRIT-PER-RECURRENT
 11460
 11461     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11462     MOVE CM-clp-state        TO ERPDEF-STATE
 11463     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11464     if (clmtypei = 'L' or 'P')
 11465        and (cm-lf-benefit-cd not = '00' and '  ' and 'DD')
 11466        move 'L'              to erpdef-ben-type
 11467        move cm-lf-benefit-cd to erpdef-ben-code
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 216
* EL130.cbl
 11468     ELSE
 11469        MOVE 'A'              to erpdef-ben-type
 11470        move cm-ah-benefit-cd to erpdef-ben-code
 11471     end-if
 11472*    MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11473*    MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11474     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11475     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11476
 11477
 11478* EXEC CICS STARTBR
 11479*        DATASET  ('ERPDEF')
 11480*        RIDFLD   (ERPDEF-KEY)
 11481*        GTEQ
 11482*        RESP     (WS-RESPONSE)
 11483*    END-EXEC
 11484     MOVE 'ERPDEF' TO DFHEIV1
 11485     MOVE 0
 11486       TO DFHEIV11
 11487*    MOVE '&,         G          &  N#00010639' TO DFHEIV0
 11488     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11489     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11490     MOVE X'204E233030303130363339' TO DFHEIV0(25:11)
 11491     CALL 'kxdfhei1' USING DFHEIV0,
 11492           DFHEIV1,
 11493           ERPDEF-KEY,
 11494           DFHEIV99,
 11495           DFHEIV11,
 11496           DFHEIV99
 11497     MOVE EIBRESP  TO WS-RESPONSE
 11498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11499
 11500     IF WS-RESP-NORMAL
 11501
 11502* EXEC CICS READNEXT
 11503*          DATASET  ('ERPDEF')
 11504*          INTO     (PRODUCT-MASTER)
 11505*          RIDFLD   (ERPDEF-KEY)
 11506*          RESP     (WS-RESPONSE)
 11507*       END-EXEC
 11508     MOVE LENGTH OF
 11509      PRODUCT-MASTER
 11510       TO DFHEIV12
 11511     MOVE 'ERPDEF' TO DFHEIV1
 11512     MOVE 0
 11513       TO DFHEIV11
 11514*    MOVE '&.IL                  )  N#00010647' TO DFHEIV0
 11515     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11516     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11517     MOVE X'204E233030303130363437' TO DFHEIV0(25:11)
 11518     CALL 'kxdfhei1' USING DFHEIV0,
 11519           DFHEIV1,
 11520           PRODUCT-MASTER,
 11521           DFHEIV12,
 11522           ERPDEF-KEY,
 11523           DFHEIV99,
 11524           DFHEIV11,
 11525           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 217
* EL130.cbl
 11526           DFHEIV99
 11527     MOVE EIBRESP  TO WS-RESPONSE
 11528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11529
 11530        IF WS-RESP-NORMAL
 11531           IF (ERPDEF-KEY-SAVE (1:16) =
 11532              PD-CONTROL-PRIMARY (1:16))
 11533              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11534
 11535              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11536                 (A1 > +8)
 11537                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11538              END-PERFORM
 11539              IF A1 < +9
 11540                 SET ERPDEF-FOUND TO TRUE
 11541                 move pd-max-amt (a1)
 11542                              to pi-dcc-max-amt
 11543                 MOVE PD-CRIT-PERIOD (A1)
 11544                              TO WS-MAX-BENEFITS
 11545                                 pi-dcc-max-benefits
 11546                 if pd-rec-crit-period (a1) not numeric
 11547                    move 01      to pd-rec-crit-period (a1)
 11548                 end-if
 11549                 MOVE PD-REC-CRIT-PERIOD (A1)
 11550                              TO WS-CRIT-PER-RECURRENT
 11551                 IF PD-RTW-MOS (A1) NUMERIC
 11552                    MOVE PD-RTW-MOS (A1)
 11553                              TO WS-CRIT-PER-RTW-MOS
 11554                 ELSE
 11555                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11556                 END-IF
 11557                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11558                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11559                                 TO WS-EXCL-PERIOD
 11560                 END-IF
 11561                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 11562                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11563                                 TO WS-COV-ENDS
 11564                 END-IF
 11565                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11566                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11567                                 TO WS-ACC-PERIOD
 11568                 END-IF
 11569              else
 11570                 move er-1673    to emi-error
 11571                 PERFORM 9900-ERROR-FORMAT
 11572                                 THRU 9900-EXIT
 11573              END-IF
 11574           else
 11575              MOVE -1            TO MAINTL
 11576              move er-1671       to emi-error
 11577              PERFORM 9900-ERROR-FORMAT
 11578                                 THRU 9900-EXIT
 11579           END-IF
 11580        END-IF
 11581     END-IF
 11582
 11583     .
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 218
* EL130.cbl
 11584 3997-EXIT.
 11585     EXIT.
 11586
 11587 3998-update-cert-claim-trailer.
 11588
 11589
 11590* EXEC CICS GETMAIN
 11591*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11592*       LENGTH   (ELCRTT-LENGTH)
 11593*       INITIMG  (GETMAIN-SPACE)
 11594*    END-EXEC
 11595*    MOVE ',"IL                  $   #00010713' TO DFHEIV0
 11596     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11597     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11598     MOVE X'2020233030303130373133' TO DFHEIV0(25:11)
 11599     CALL 'kxdfhei1' USING DFHEIV0,
 11600           DFHEIV20,
 11601           ELCRTT-LENGTH,
 11602           GETMAIN-SPACE
 11603     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11604         DFHEIV20
 11605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11606
 11607     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11608     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11609     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11610     MOVE CM-STATE         TO CTRLR-STATE
 11611     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11612     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11613     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11614     MOVE 'B'              TO CTRLR-REC-TYPE
 11615
 11616* EXEC CICS READ
 11617*       UPDATE
 11618*       DATASET  (ELCRTT-DSID)
 11619*       into     (CERTIFICATE-TRAILERS)
 11620*       RIDFLD   (ELCRTT-KEY)
 11621*       RESP     (WS-RESPONSE)
 11622*    END-EXEC
 11623     MOVE LENGTH OF
 11624      CERTIFICATE-TRAILERS
 11625       TO DFHEIV11
 11626*    MOVE '&"IL       EU         (  N#00010727' TO DFHEIV0
 11627     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11628     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11629     MOVE X'204E233030303130373237' TO DFHEIV0(25:11)
 11630     CALL 'kxdfhei1' USING DFHEIV0,
 11631           ELCRTT-DSID,
 11632           CERTIFICATE-TRAILERS,
 11633           DFHEIV11,
 11634           ELCRTT-KEY,
 11635           DFHEIV99,
 11636           DFHEIV99,
 11637           DFHEIV99
 11638     MOVE EIBRESP  TO WS-RESPONSE
 11639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11640     IF WS-RESP-NORMAL
 11641        perform varying s1 from +1 by +1 until
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 219
* EL130.cbl
 11642           (s1 > +24)
 11643           or (cs-claim-no (s1) = spaces)
 11644        end-perform
 11645        if s1 < +25
 11646           perform 3999-upd-crt-trlr thru 3999-exit
 11647
 11648* EXEC CICS REWRITE
 11649*             DATASET  (ELCRTT-DSID)
 11650*             from     (CERTIFICATE-TRAILERS)
 11651*             RESP     (WS-RESPONSE)
 11652*          END-EXEC
 11653     MOVE LENGTH OF
 11654      CERTIFICATE-TRAILERS
 11655       TO DFHEIV11
 11656*    MOVE '&& L                  %  N#00010741' TO DFHEIV0
 11657     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11658     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11659     MOVE X'204E233030303130373431' TO DFHEIV0(25:11)
 11660     CALL 'kxdfhei1' USING DFHEIV0,
 11661           ELCRTT-DSID,
 11662           CERTIFICATE-TRAILERS,
 11663           DFHEIV11,
 11664           DFHEIV99
 11665     MOVE EIBRESP  TO WS-RESPONSE
 11666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11667        end-if
 11668     else
 11669        if ws-resp-notfnd
 11670           move 'CS'             to certificate-trailers
 11671           move cm-control-primary to cs-control-primary
 11672           move 'B'              to cs-trailer-type
 11673           perform varying s1 from +1 by +1 until s1 > +24
 11674              move zeros         to cs-days-paid (s1)
 11675                                    cs-total-paid (s1)
 11676                                    cs-benefit-period (s1)
 11677                                    cs-remaining-bens (s1)
 11678           end-perform
 11679           move +1               to s1
 11680           perform 3999-upd-crt-trlr
 11681                                 thru 3999-exit
 11682
 11683* EXEC CICS WRITE
 11684*             DATASET  (ELCRTT-DSID)
 11685*             from     (CERTIFICATE-TRAILERS)
 11686*             RIDFLD   (cs-control-primary)
 11687*             RESP     (WS-RESPONSE)
 11688*          END-EXEC
 11689     MOVE LENGTH OF
 11690      CERTIFICATE-TRAILERS
 11691       TO DFHEIV11
 11692*    MOVE '&$ L                  ''  N#00010761' TO DFHEIV0
 11693     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11694     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11695     MOVE X'204E233030303130373631' TO DFHEIV0(25:11)
 11696     CALL 'kxdfhei1' USING DFHEIV0,
 11697           ELCRTT-DSID,
 11698           CERTIFICATE-TRAILERS,
 11699           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 220
* EL130.cbl
 11700           cs-control-primary,
 11701           DFHEIV99,
 11702           DFHEIV99
 11703     MOVE EIBRESP  TO WS-RESPONSE
 11704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11705        end-if
 11706     END-IF
 11707
 11708     .
 11709 3998-exit.
 11710     exit.
 11711
 11712 3999-upd-crt-trlr.
 11713     move clmnoi                 to cs-claim-no       (s1)
 11714     move clmtypei               to cs-claim-type     (s1)
 11715     move instypei               to cs-insured-type   (s1)
 11716     move cl-benefit-period      to cs-benefit-period (s1)
 11717*    move cl-critical-period     to cs-remaining-bens (s1)
 11718     move zeros                  to cs-remaining-bens (s1)
 11719     .
 11720 3999-exit.
 11721     exit.
 11722 4000-CALCULATE-CERT-TERM.
 11723
 11724     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 11725
 11726     MOVE N                      TO WS-TERM.
 11727
 11728     IF WS-TERM GREATER 120
 11729         MOVE 120                TO WS-TERM
 11730     END-IF.
 11731
 11732 4000-CALC-TERM-EXIT.
 11733      EXIT.
 11734
 11735 4100-CALC-GROSS-TERM.
 11736     MOVE HOLD-LOAN-BAL           TO L.
 11737     MOVE WS-ACVBENE              TO M.
 11738     COMPUTE N = L / M.
 11739     IF N LESS 1
 11740         MOVE 1  TO N
 11741     END-IF.
 11742
 11743     IF LCVCDL GREATER ZERO
 11744         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 11745     ELSE
 11746         MOVE ZEROS               TO WS-LF-RATE
 11747     END-IF.
 11748
 11749     IF ACVCDL GREATER ZERO
 11750         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 11751     ELSE
 11752         MOVE ZEROS               TO WS-AH-RATE
 11753     END-IF.
 11754
 11755     COMPUTE I = WS-APR / +1200.
 11756
 11757 4105-LOOP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 221
* EL130.cbl
 11758     IF N GREATER 240
 11759         GO TO 4200-EXIT
 11760     END-IF.
 11761
 11762     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 11763
 11764     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 11765         ADD 1 TO N
 11766         GO TO 4105-LOOP
 11767     END-IF.
 11768
 11769 4200-EXIT.
 11770      EXIT.
 11771
 11772 4210-CALC-LEFT-RIGHTONE.
 11773      MOVE L         TO LEFT-TOT-1.
 11774      SUBTRACT 1 FROM N.
 11775      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11776      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 11777      ADD 1 TO N.
 11778
 11779 4211-CALC-TERM1.
 11780      MOVE N         TO TERM1.
 11781      MULTIPLY M BY TERM1.
 11782
 11783 4212-LOOP.
 11784      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 11785      ADD 1 TO A-N.
 11786      MULTIPLY A-N BY TERM1.
 11787      SUBTRACT 1 FROM A-N.
 11788      ADD TERM1 TO LEFT-TOT-1.
 11789
 11790 4213-CALC-TERM2.
 11791      MOVE M         TO TERM2.
 11792      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 11793      MULTIPLY IA-N BY TERM2.
 11794      SUBTRACT TERM2 FROM LEFT-TOT-1.
 11795
 11796 4215-CALC-RIGHTONE.
 11797      MOVE M         TO RIGHT-TOT-1.
 11798      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11799      MULTIPLY A-N BY RIGHT-TOT-1.
 11800
 11801 4220-EXIT.
 11802      EXIT.
 11803
 11804 4300-CALC-A-N.
 11805     IF N LESS 1
 11806         MOVE 0     TO A-N
 11807         GO TO 4300-EXIT
 11808     END-IF.
 11809
 11810     IF I = 0
 11811         MOVE .00001 TO I
 11812     END-IF.
 11813
 11814     ADD 1 TO I.
 11815     DIVIDE I INTO 1 GIVING V.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 222
* EL130.cbl
 11816     SUBTRACT 1 FROM I.
 11817     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11818     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 11819     DIVIDE I INTO TERM3 GIVING A-N.
 11820
 11821 4300-EXIT.
 11822      EXIT.
 11823
 11824 4350-CALC-IA-N.
 11825     IF N LESS 1
 11826         MOVE 0      TO IA-N
 11827         GO TO 4400-EXIT
 11828     END-IF.
 11829
 11830     ADD 1 TO N.
 11831     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11832     SUBTRACT 1 FROM N.
 11833     MULTIPLY N BY V-EX-N GIVING TERM3.
 11834     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 11835     SUBTRACT V FROM 1 GIVING TERM4.
 11836     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 11837
 11838 4400-EXIT.
 11839      EXIT.
 11840
 11841 4450-CALC-V-EX-N.
 11842     IF N LESS 1
 11843         MOVE 1    TO V-EX-N
 11844         GO TO 4490-EXIT
 11845     END-IF.
 11846
 11847     MOVE N        TO NV-STORE.
 11848
 11849     IF V-EX-ONETIME = 1  OR
 11850        V NOT = V-EXPONENT (1)
 11851          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 11852     END-IF.
 11853
 11854 4460-LOOP.
 11855     IF N GREATER 248
 11856         MOVE 248 TO N
 11857     END-IF.
 11858
 11859     IF N = 1
 11860         MOVE V               TO V-EX-N
 11861     ELSE
 11862         MOVE V-EXPONENT (N)  TO V-EX-N
 11863     END-IF.
 11864
 11865     GO TO 4490-EXIT.
 11866
 11867 4470-BUILD-V-EX-TABLE.
 11868     MOVE 2      TO N.
 11869     MOVE V      TO V-EXPONENT (1)
 11870                    V-EX-N.
 11871
 11872 4471-LOOP.
 11873     MULTIPLY V BY V-EX-N.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 223
* EL130.cbl
 11874     MOVE V-EX-N   TO V-EXPONENT (N).
 11875
 11876     ADD 1 TO N.
 11877     IF N LESS 248
 11878         GO TO 4471-LOOP
 11879     END-IF.
 11880
 11881     MOVE NV-STORE     TO N.
 11882     MOVE ZERO         TO V-EX-ONETIME.
 11883
 11884 4480-EXIT.
 11885      EXIT.
 11886
 11887 4490-EXIT.
 11888      EXIT.
 11889
 11890 4500-CALC-NET-TERM.
 11891     MOVE HOLD-LOAN-BAL           TO L.
 11892     MOVE WS-ACVBENE              TO M.
 11893     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 11894
 11895     IF WS-REMAIN GREATER ZERO
 11896         ADD 1 TO N
 11897     END-IF.
 11898
 11899     IF N = 0
 11900         MOVE 1 TO N
 11901     END-IF.
 11902
 11903 4700-EXIT.
 11904      EXIT.
 11905
 11906 4999-CALC-TERM-EXIT.
 11907     EXIT.
 11908
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 224
* EL130.cbl
 11910 5000-INCURRED-CHANGE.
 11911     IF NOT MODIFY-CAP
 11912         MOVE ER-0070            TO EMI-ERROR
 11913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11914         MOVE -1                 TO MAINTL
 11915         GO TO 8200-SEND-DATAONLY
 11916     END-IF.
 11917
 11918     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 11919        CLMCARRI     NOT = PI-LAST-CARR        OR
 11920        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 11921        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 11922        PI-INCURR-SW NOT = 'Y'
 11923          GO TO 1000-SHOW-CLAIM
 11924     END-IF.
 11925
 11926     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 11927     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 11928     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 11929
 11930     IF EMI-NO-ERRORS
 11931         GO TO 5000-TRY-TO-BUILD
 11932     END-IF.
 11933
 11934     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 11935        MOVE ER-0433             TO EMI-ERROR
 11936        MOVE -1                  TO MAINTL
 11937        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11938        GO TO 8200-SEND-DATAONLY
 11939     END-IF.
 11940
 11941     IF EIBAID = DFHPF6
 11942         IF EMI-FATAL-CTR NOT EQUAL ZERO
 11943            MOVE ER-0434         TO EMI-ERROR
 11944            MOVE -1              TO MAINTL
 11945            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11946            GO TO 8200-SEND-DATAONLY
 11947         ELSE
 11948            MOVE +1              TO INCURL
 11949            GO TO 5000-TRY-TO-BUILD
 11950         END-IF
 11951     END-IF.
 11952
 11953     GO TO 8200-SEND-DATAONLY.
 11954
 11955 5000-TRY-TO-BUILD.
 11956
 11957     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 11958
 11959     MOVE CLMCARRI               TO MSTR-CARRIER.
 11960
 11961     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 11962     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 11963     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 11964
 11965     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 11966
 11967     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 225
* EL130.cbl
 11968         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 11969     END-IF.
 11970
 11971     IF CL-PURGED-DT NOT = LOW-VALUES
 11972
 11973
 11974* EXEC CICS UNLOCK
 11975*            DATASET   (ELMSTR-DSID)
 11976*        END-EXEC
 11977*    MOVE '&*                    #   #00011035' TO DFHEIV0
 11978     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11979     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11980     MOVE X'2020233030303131303335' TO DFHEIV0(25:11)
 11981     CALL 'kxdfhei1' USING DFHEIV0,
 11982           ELMSTR-DSID,
 11983           DFHEIV99
 11984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11985         MOVE ER-7691            TO EMI-ERROR
 11986         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11987         MOVE -1                 TO MAINTL
 11988         GO TO 8200-SEND-DATAONLY
 11989     END-IF.
 11990
 11991     IF CL-AUTO-PAY-SEQ NOT = ZERO
 11992
 11993
 11994* EXEC CICS UNLOCK
 11995*            DATASET   (ELMSTR-DSID)
 11996*       END-EXEC
 11997*    MOVE '&*                    #   #00011046' TO DFHEIV0
 11998     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11999     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12000     MOVE X'2020233030303131303436' TO DFHEIV0(25:11)
 12001     CALL 'kxdfhei1' USING DFHEIV0,
 12002           ELMSTR-DSID,
 12003           DFHEIV99
 12004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12005         MOVE ER-0523             TO EMI-ERROR
 12006         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12007         MOVE -1                  TO MAINTL
 12008         GO TO 8200-SEND-DATAONLY
 12009     END-IF.
 12010
 12011     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 12012
 12013     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 12014     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 12015     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 12016     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 12017     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 12018
 12019     IF MANRSVL GREATER ZERO
 12020        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 12021                                    AT-CURRENT-MANUAL-RESERVE
 12022     END-IF.
 12023     MOVE 1                      TO SUB.
 12024
 12025 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 226
* EL130.cbl
 12026     IF SUB = 1
 12027        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 12028        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 12029        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 12030     ELSE
 12031        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 12032        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 12033                                    AT-OPEN-CLOSE-REASON (SUB)
 12034     END-IF.
 12035
 12036     IF SUB NOT = 6
 12037        ADD 1                    TO SUB
 12038        GO TO 5010-LOOP
 12039     END-IF.
 12040
 12041 5020-UPDATE.
 12042
 12043     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12044
 12045     IF DIAGL = ZERO
 12046       AND ICD1L = ZERO
 12047       AND ICD2L = ZERO
 12048         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 12049         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 12050         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 12051         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 12052         GO TO 5025-BYPASS-UPDATE
 12053     END-IF.
 12054
 12055     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 12056
 12057     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 12058     IF DIAGL NOT = ZERO
 12059         MOVE DIAGI              TO AT-INFO-LINE-1
 12060     END-IF.
 12061
 12062     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 12063     IF ICD1L NOT = ZERO
 12064         MOVE ICD1I              TO AT-ICD-CODE-1
 12065     END-IF.
 12066
 12067     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 12068     IF ICD2L NOT = ZERO
 12069         MOVE ICD2I              TO AT-ICD-CODE-2
 12070     END-IF.
 12071
 12072     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12073
 12074 5025-BYPASS-UPDATE.
 12075
 12076
 12077
 12078* EXEC CICS GETMAIN
 12079*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12080*        LENGTH   (ELTRLR-LENGTH)
 12081*    END-EXEC.
 12082*    MOVE '," L                  $   #00011121' TO DFHEIV0
 12083     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 227
* EL130.cbl
 12084     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12085     MOVE X'2020233030303131313231' TO DFHEIV0(25:11)
 12086     CALL 'kxdfhei1' USING DFHEIV0,
 12087           DFHEIV20,
 12088           ELTRLR-LENGTH,
 12089           DFHEIV99
 12090     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12091         DFHEIV20
 12092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12093
 12094
 12095     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12096     MOVE 'AT'                   TO AT-RECORD-ID.
 12097
 12098     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12099     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12100     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12101     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12102     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12103     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12104     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12105     MOVE '9'                    TO AT-TRAILER-TYPE.
 12106     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12107     MOVE '5'                    TO DC-OPTION-CODE.
 12108     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12109     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12110
 12111     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12112     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12113
 12114     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12115     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12116     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12117     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12118     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12119     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12120     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12121     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12122     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12123     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12124     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12125     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12126
 12127     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12128     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12129     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12130     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12131     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12132
 12133
 12134
 12135* EXEC CICS WRITE
 12136*        DATASET   (ELTRLR-DSID)
 12137*        FROM      (ACTIVITY-TRAILERS)
 12138*        RIDFLD    (AT-CONTROL-PRIMARY)
 12139*    END-EXEC.
 12140     MOVE LENGTH OF
 12141      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 228
* EL130.cbl
 12142       TO DFHEIV11
 12143*    MOVE '&$ L                  ''   #00011165' TO DFHEIV0
 12144     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12145     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12146     MOVE X'2020233030303131313635' TO DFHEIV0(25:11)
 12147     CALL 'kxdfhei1' USING DFHEIV0,
 12148           ELTRLR-DSID,
 12149           ACTIVITY-TRAILERS,
 12150           DFHEIV11,
 12151           AT-CONTROL-PRIMARY,
 12152           DFHEIV99,
 12153           DFHEIV99
 12154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12155
 12156
 12157     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12158     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12159     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12160     MOVE CL-CERT-STATE          TO CERT-STATE.
 12161     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12162     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12163     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12164
 12165
 12166
 12167* EXEC CICS HANDLE CONDITION
 12168*        NOTFND   (5050-CERT-NOT-FOUND)
 12169*    END-EXEC.
 12170*    MOVE '"$I                   ! ; #00011180' TO DFHEIV0
 12171     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12173     MOVE X'3B20233030303131313830' TO DFHEIV0(25:11)
 12174     CALL 'kxdfhei1' USING DFHEIV0
 12175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12176
 12177
 12178     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12179
 12180     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12181
 12182
 12183
 12184* EXEC CICS HANDLE CONDITION
 12185*         DUPKEY   (5030-CERT-WRITTEN)
 12186*    END-EXEC.
 12187*    MOVE '"$$                   ! < #00011189' TO DFHEIV0
 12188     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12190     MOVE X'3C20233030303131313839' TO DFHEIV0(25:11)
 12191     CALL 'kxdfhei1' USING DFHEIV0
 12192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12193
 12194
 12195
 12196
 12197* EXEC CICS REWRITE
 12198*        DATASET  (ELCERT-DSID)
 12199*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 229
* EL130.cbl
 12200*    END-EXEC.
 12201     MOVE LENGTH OF
 12202      CERTIFICATE-MASTER
 12203       TO DFHEIV11
 12204*    MOVE '&& L                  %   #00011194' TO DFHEIV0
 12205     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12206     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12207     MOVE X'2020233030303131313934' TO DFHEIV0(25:11)
 12208     CALL 'kxdfhei1' USING DFHEIV0,
 12209           ELCERT-DSID,
 12210           CERTIFICATE-MASTER,
 12211           DFHEIV11,
 12212           DFHEIV99
 12213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12214
 12215
 12216 5030-CERT-WRITTEN.
 12217
 12218     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12219                                    CL-INCURRED-DT
 12220                                    CL-REPORTED-DT
 12221                                    CL-EST-END-OF-DISAB-DT
 12222                                    CL-PAID-THRU-DT.
 12223
 12224     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12225                                    CL-NO-OF-PMTS-MADE
 12226                                    CL-NO-OF-DAYS-PAID.
 12227
 12228     IF CLAIM-IS-CLOSED
 12229        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12230        MOVE 'O'                 TO CL-CLAIM-STATUS
 12231     END-IF.
 12232
 12233     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12234     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12235     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12236
 12237
 12238
 12239* EXEC CICS HANDLE CONDITION
 12240*         DUPKEY   (5035-CLAIM-WRITTEN)
 12241*    END-EXEC.
 12242*    MOVE '"$$                   ! = #00011221' TO DFHEIV0
 12243     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12245     MOVE X'3D20233030303131323231' TO DFHEIV0(25:11)
 12246     CALL 'kxdfhei1' USING DFHEIV0
 12247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12248
 12249
 12250
 12251
 12252* EXEC CICS REWRITE
 12253*        DATASET   (ELMSTR-DSID)
 12254*        FROM      (CLAIM-MASTER)
 12255*    END-EXEC.
 12256     MOVE LENGTH OF
 12257      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 230
* EL130.cbl
 12258       TO DFHEIV11
 12259*    MOVE '&& L                  %   #00011226' TO DFHEIV0
 12260     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12261     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12262     MOVE X'2020233030303131323236' TO DFHEIV0(25:11)
 12263     CALL 'kxdfhei1' USING DFHEIV0,
 12264           ELMSTR-DSID,
 12265           CLAIM-MASTER,
 12266           DFHEIV11,
 12267           DFHEIV99
 12268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12269
 12270
 12271 5035-CLAIM-WRITTEN.
 12272
 12273     MOVE ER-0000                TO EMI-ERROR.
 12274     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12275
 12276     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12277     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12278     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12279     MOVE CLMCARRI               TO PI-LAST-CARR.
 12280
 12281     IF PRTOPTL GREATER ZERO
 12282         MOVE PRTOPTI            TO PI-PRT-OPT
 12283     END-IF.
 12284
 12285     IF ALTPRTL GREATER ZERO
 12286         MOVE ALTPRTI            TO PI-ALT-PRT
 12287     END-IF.
 12288
 12289     MOVE LOW-VALUES             TO EL130AI.
 12290
 12291     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12292     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12293     MOVE PI-LAST-CARR           TO CLMCARRO.
 12294     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12295
 12296     IF PI-PRT-OPT = 'N' OR 'L'
 12297         MOVE PI-PRT-OPT         TO PRTOPTO
 12298         MOVE 1                  TO PRTOPTL
 12299     END-IF.
 12300
 12301     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12302         MOVE PI-ALT-PRT         TO ALTPRTO
 12303         MOVE 4                  TO ALTPRTL
 12304     END-IF.
 12305
 12306     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12307     MOVE AL-SANON               TO CERTNOA SUFXA.
 12308
 12309     MOVE SPACES                 TO PI-INCURR-SW.
 12310
 12311     IF PRTOPTL GREATER ZERO
 12312         IF PRTOPTI = 'L'
 12313             GO TO 0400-CREATE-ELACTQ
 12314         ELSE
 12315             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 231
* EL130.cbl
 12316         END-IF
 12317     END-IF.
 12318
 12319     GO TO 8100-SEND-INITIAL-MAP.
 12320
 12321 5050-CERT-NOT-FOUND.
 12322
 12323     MOVE ER-0244                TO EMI-ERROR.
 12324     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12325     MOVE -1                     TO CERTNOL.
 12326     GO TO 8200-SEND-DATAONLY.
 12327
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 232
* EL130.cbl
 12329 5500-BUILD-FORM-TRAILER.
 12330*************************************************************
 12331*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12332*************************************************************
 12333
 12334     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12335
 12336     IF  WS-BEN-ALPHA-2 = '30'
 12337         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12338         MOVE '6'                TO DC-OPTION-CODE
 12339         IF CL-CARRIER = 'C'
 12340             MOVE +14            TO DC-ELAPSED-DAYS
 12341             MOVE +0             TO DC-ELAPSED-MONTHS
 12342             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12343             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12344         ELSE
 12345             MOVE +21            TO DC-ELAPSED-DAYS
 12346             MOVE +0             TO DC-ELAPSED-MONTHS
 12347             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12348             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12349         END-IF
 12350     END-IF.
 12351
 12352
 12353
 12354* EXEC CICS GETMAIN
 12355*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12356*         LENGTH   (ELTRLR-LENGTH)
 12357*         INITIMG  (GETMAIN-SPACE)
 12358*    END-EXEC.
 12359*    MOVE ',"IL                  $   #00011313' TO DFHEIV0
 12360     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12361     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12362     MOVE X'2020233030303131333133' TO DFHEIV0(25:11)
 12363     CALL 'kxdfhei1' USING DFHEIV0,
 12364           DFHEIV20,
 12365           ELTRLR-LENGTH,
 12366           GETMAIN-SPACE
 12367     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12368         DFHEIV20
 12369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12370
 12371
 12372     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12373     MOVE 'AT'                   TO AT-RECORD-ID.
 12374
 12375     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12376     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12377     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12378     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12379                                    AT-FORM-LAST-MAINT-DT.
 12380     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12381                                    AT-FORM-LAST-UPDATED-BY.
 12382     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12383     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12384     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12385                                    AT-FORM-RE-SEND-DT
 12386                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 233
* EL130.cbl
 12387                                    AT-EMP-FORM-ANSWERED-DT
 12388                                    AT-PHY-FORM-ANSWERED-DT
 12389                                    AT-EMP-FORM-SEND-ON-DT
 12390                                    AT-FORM-PRINTED-DT
 12391                                    AT-FORM-REPRINT-DT.
 12392     MOVE '1'                    TO AT-FORM-TYPE.
 12393
 12394     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12395                                    AT-INSTRUCT-LN-2
 12396                                    AT-INSTRUCT-LN-3.
 12397
 12398     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12399     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12400
 12401     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12402
 12403     IF AM-EMPLOYER-STMT-USED = 'Y'
 12404        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12405     END-IF.
 12406
 12407
 12408
 12409* EXEC CICS WRITE
 12410*         DATASET  (ELTRLR-DSID)
 12411*         FROM     (ACTIVITY-TRAILERS)
 12412*         RIDFLD   (AT-CONTROL-PRIMARY)
 12413*    END-EXEC.
 12414     MOVE LENGTH OF
 12415      ACTIVITY-TRAILERS
 12416       TO DFHEIV11
 12417*    MOVE '&$ L                  ''   #00011355' TO DFHEIV0
 12418     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12419     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12420     MOVE X'2020233030303131333535' TO DFHEIV0(25:11)
 12421     CALL 'kxdfhei1' USING DFHEIV0,
 12422           ELTRLR-DSID,
 12423           ACTIVITY-TRAILERS,
 12424           DFHEIV11,
 12425           AT-CONTROL-PRIMARY,
 12426           DFHEIV99,
 12427           DFHEIV99
 12428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12429
 12430
 12431 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 234
* EL130.cbl
 12433*************************************************************
 12434*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12435*************************************************************
 12436
 12437 5700-BUILD-ARCHIVE-HEADER.
 12438
 12439     MOVE '1'                    TO CNTL-REC-TYPE.
 12440     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12441     MOVE SPACES                 TO CNTL-ACCESS.
 12442
 12443
 12444
 12445* EXEC CICS READ
 12446*         DATASET  (ELCNTL-DSID)
 12447*         SET      (ADDRESS OF CONTROL-FILE)
 12448*         RIDFLD   (ELCNTL-KEY)
 12449*         UPDATE
 12450*    END-EXEC.
 12451*    MOVE '&"S        EU         (   #00011374' TO DFHEIV0
 12452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12453     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12454     MOVE X'2020233030303131333734' TO DFHEIV0(25:11)
 12455     CALL 'kxdfhei1' USING DFHEIV0,
 12456           ELCNTL-DSID,
 12457           DFHEIV20,
 12458           DFHEIV99,
 12459           ELCNTL-KEY,
 12460           DFHEIV99,
 12461           DFHEIV99,
 12462           DFHEIV99
 12463     SET ADDRESS OF CONTROL-FILE TO
 12464         DFHEIV20
 12465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12466
 12467
 12468     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12469
 12470     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12471
 12472
 12473
 12474* EXEC CICS REWRITE
 12475*         FROM     (CONTROL-FILE)
 12476*         DATASET  (ELCNTL-DSID)
 12477*    END-EXEC.
 12478     MOVE LENGTH OF
 12479      CONTROL-FILE
 12480       TO DFHEIV11
 12481*    MOVE '&& L                  %   #00011386' TO DFHEIV0
 12482     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12483     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12484     MOVE X'2020233030303131333836' TO DFHEIV0(25:11)
 12485     CALL 'kxdfhei1' USING DFHEIV0,
 12486           ELCNTL-DSID,
 12487           CONTROL-FILE,
 12488           DFHEIV11,
 12489           DFHEIV99
 12490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 235
* EL130.cbl
 12491
 12492
 12493
 12494
 12495* EXEC CICS HANDLE CONDITION
 12496*         NOTOPEN  (9990-ABEND)
 12497*         DUPKEY   (5799-EXIT)
 12498*    END-EXEC.
 12499*    MOVE '"$J$                  ! > #00011392' TO DFHEIV0
 12500     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12502     MOVE X'3E20233030303131333932' TO DFHEIV0(25:11)
 12503     CALL 'kxdfhei1' USING DFHEIV0
 12504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12505
 12506
 12507
 12508
 12509* EXEC CICS GETMAIN
 12510*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12511*         LENGTH  (ELARCH-LENGTH)
 12512*    END-EXEC.
 12513*    MOVE '," L                  $   #00011398' TO DFHEIV0
 12514     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12515     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12516     MOVE X'2020233030303131333938' TO DFHEIV0(25:11)
 12517     CALL 'kxdfhei1' USING DFHEIV0,
 12518           DFHEIV20,
 12519           ELARCH-LENGTH,
 12520           DFHEIV99
 12521     SET ADDRESS OF LETTER-ARCHIVE TO
 12522         DFHEIV20
 12523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12524
 12525
 12526     MOVE SPACES                 TO LETTER-ARCHIVE.
 12527     MOVE 'LA'                   TO LA-RECORD-ID.
 12528     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12529                                    LA-ARCHIVE-NO-A1.
 12530     MOVE '4'                    TO LA-RECORD-TYPE
 12531                                    LA-RECORD-TYPE-A1.
 12532     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12533                                    LA-LINE-SEQ-NO-A1.
 12534     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12535                                    LA-COMPANY-CD-A1.
 12536     MOVE CL-CARRIER             TO LA4-CARRIER.
 12537     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12538     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12539     MOVE CL-CERT-STATE          TO LA4-STATE.
 12540     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12541     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12542     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12543     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12544                                    LA4-RESEND-PRINT-DATE
 12545                                    LA4-FORM-REM-PRINT-DT
 12546                                    LA4-RESEND-DATE.
 12547     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12548     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 236
* EL130.cbl
 12549
 12550
 12551
 12552* EXEC CICS WRITE
 12553*         DATASET  (ELARCH-DSID)
 12554*         FROM     (LETTER-ARCHIVE)
 12555*         RIDFLD   (LA-CONTROL-PRIMARY)
 12556*    END-EXEC.
 12557     MOVE LENGTH OF
 12558      LETTER-ARCHIVE
 12559       TO DFHEIV11
 12560*    MOVE '&$ L                  ''   #00011428' TO DFHEIV0
 12561     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12562     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12563     MOVE X'2020233030303131343238' TO DFHEIV0(25:11)
 12564     CALL 'kxdfhei1' USING DFHEIV0,
 12565           ELARCH-DSID,
 12566           LETTER-ARCHIVE,
 12567           DFHEIV11,
 12568           LA-CONTROL-PRIMARY,
 12569           DFHEIV99,
 12570           DFHEIV99
 12571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12572
 12573
 12574 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 237
* EL130.cbl
 12576 6000-EDIT-CLAIM-DATA.
 12577
 12578     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12579     MOVE '2'                    TO DC-OPTION-CODE.
 12580     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12581     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12582
 12583     IF MAINTL NOT = ZERO
 12584         MOVE AL-UANON           TO MAINTA
 12585     END-IF
 12586
 12587     IF CLMNOL GREATER ZERO
 12588         IF CLMNOI = SPACES OR LOW-VALUES
 12589             MOVE -1             TO CLMNOL
 12590             MOVE AL-UABON       TO CLMNOA
 12591             MOVE ER-7688        TO EMI-ERROR
 12592             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12593         ELSE
 12594             MOVE AL-UANON       TO CLMNOA
 12595         END-IF
 12596     END-IF.
 12597
 12598     IF CERTNOL = ZERO
 12599         MOVE -1                 TO CERTNOL
 12600         MOVE AL-SABON           TO CERTNOA
 12601         MOVE ER-0203            TO EMI-ERROR
 12602         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12603     ELSE
 12604         MOVE AL-SANON           TO CERTNOA
 12605     END-IF.
 12606
 12607     IF SUFXL = ZERO
 12608         MOVE SPACES             TO SUFXI
 12609         MOVE AL-SANON           TO SUFXA
 12610     ELSE
 12611         MOVE AL-SANON           TO SUFXA
 12612     END-IF.
 12613
 12614     IF CLMCARRL = ZERO
 12615         MOVE -1                 TO CLMCARRL
 12616         MOVE ER-0194            TO EMI-ERROR
 12617         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12618     ELSE
 12619         MOVE CLMCARRI           TO PI-CARRIER
 12620         IF PI-NO-CARRIER-SECURITY
 12621             MOVE AL-UANON       TO CLMCARRA
 12622         END-IF
 12623     END-IF.
 12624
 12625     IF CLMTYPEL > ZERO
 12626        IF ((PI-COMPANY-ID = 'DCC')
 12627           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12628              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G'))
 12629                        OR
 12630           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12631           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12632              AND PI-AH-OVERRIDE-L1))
 12633              MOVE -1             TO CLMTYPEL
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 238
* EL130.cbl
 12634              MOVE AL-UABON       TO CLMTYPEA
 12635              MOVE ER-7634        TO EMI-ERROR
 12636              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12637        ELSE
 12638           MOVE AL-UANON       TO CLMTYPEA
 12639        END-IF
 12640     ELSE
 12641        IF MAINTI = 'A'
 12642           MOVE -1             TO CLMTYPEL
 12643           MOVE AL-UABON       TO CLMTYPEA
 12644           MOVE ER-0546        TO EMI-ERROR
 12645           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12646        END-IF
 12647     END-IF
 12648     if instypel > ZERO
 12649        if instypei = 'P' OR 'C'
 12650           move al-uanon         to instypea
 12651        else
 12652           MOVE -1               TO INSTYPEL
 12653           MOVE AL-UABON         TO INSTYPEA
 12654           MOVE ER-1654          TO EMI-ERROR
 12655           PERFORM 9900-ERROR-FORMAT
 12656                                 THRU 9900-EXIT
 12657        END-IF
 12658     ELSE
 12659        IF MAINTI = 'A'
 12660           MOVE -1               TO INSTYPEL
 12661           MOVE AL-UABON         TO INSTYPEA
 12662           MOVE ER-1654          TO EMI-ERROR
 12663           PERFORM 9900-ERROR-FORMAT
 12664                                 THRU 9900-EXIT
 12665        END-IF
 12666     END-IF
 12667     if (instypel <> zeros)
 12668        and (emi-error not = er-1654)
 12669        and (instypei = 'C')
 12670        and (crtfnmei = fstnmei)
 12671        move er-1675             to emi-error
 12672        MOVE -1                  TO INSTYPEL
 12673        MOVE AL-UABON            TO INSTYPEA
 12674        PERFORM 9900-ERROR-FORMAT
 12675                                 THRU 9900-EXIT
 12676    end-if
 12677     if (instypel <> zeros)
 12678        and (emi-error not = er-1654)
 12679        and (instypei = 'P')
 12680        and (crtfnmei <> fstnmei)
 12681        move er-1676             to emi-error
 12682        MOVE -1                  TO INSTYPEL
 12683        MOVE AL-UABON            TO INSTYPEA
 12684        PERFORM 9900-ERROR-FORMAT
 12685                                 THRU 9900-EXIT
 12686    end-if
 12687     IF PCERTNOL = ZERO
 12688        MOVE CERTNOI             TO PCERTNOI
 12689        MOVE CERTNOL             TO PCERTNOL
 12690        MOVE AL-UANON            TO PCERTNOA
 12691     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 239
* EL130.cbl
 12692        MOVE AL-UANON            TO PCERTNOA
 12693     END-IF.
 12694
 12695     IF PSUFXL = ZERO
 12696        MOVE SUFXI               TO PSUFXI
 12697        MOVE SUFXL               TO PSUFXL
 12698        MOVE AL-UANON            TO PSUFXA
 12699     ELSE
 12700        MOVE AL-UANON            TO PSUFXA
 12701     END-IF.
 12702
 12703     IF MAINTI = 'I'
 12704         GO TO 6020-EDIT
 12705     END-IF.
 12706
 12707     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 12708         MOVE -1                 TO LSTNMEL
 12709         MOVE ER-0236            TO EMI-ERROR
 12710         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12711     ELSE
 12712         MOVE AL-UANON           TO LSTNMEA
 12713     END-IF.
 12714     if fstnmel not = zeros
 12715        move al-uanon            to fstnmea
 12716     end-if
 12717     IF SEXL > ZEROS
 12718        IF SEXI = 'M' OR 'F'
 12719           move al-uanon         to sexa
 12720           CONTINUE
 12721        ELSE
 12722           MOVE -1               TO SEXL
 12723           MOVE AL-UABON         TO SEXA
 12724           MOVE ER-0219          TO EMI-ERROR
 12725           PERFORM 9900-ERROR-FORMAT
 12726                                 THRU 9900-EXIT
 12727        END-IF
 12728     ELSE
 12729        IF MAINTI = 'A'
 12730           MOVE -1               TO SEXL
 12731           MOVE AL-UABON         TO SEXA
 12732           MOVE ER-0219          TO EMI-ERROR
 12733           PERFORM 9900-ERROR-FORMAT
 12734                                 THRU 9900-EXIT
 12735        END-IF
 12736     END-IF
 12737     IF SSNL GREATER THAN ZERO
 12738         MOVE SSNI TO WS-SOC-SEC-NUMBER
 12739         IF WS-SOC-SEC-NO NUMERIC AND
 12740           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 12741             NEXT SENTENCE
 12742         ELSE
 12743            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 12744               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 12745               WS-SSN-DASH2 = '-'
 12746                 NEXT SENTENCE
 12747            ELSE
 12748                 MOVE ER-0887        TO  EMI-ERROR
 12749                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 240
* EL130.cbl
 12750                 MOVE AL-UABON       TO  SSNA
 12751                 MOVE -1             TO  SSNL
 12752            END-IF
 12753        END-IF
 12754     END-IF.
 12755
 12756     IF BIRTHDTL = ZERO
 12757         GO TO 6020-EDIT
 12758     END-IF.
 12759
 12760     IF BIRTHDTL GREATER ZERO
 12761         MOVE BIRTHDTI           TO DATE-WORK
 12762         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12763         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12764         MOVE '4'                TO DC-OPTION-CODE
 12765         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12766         IF DATE-CONVERSION-ERROR
 12767             MOVE AL-UABON       TO BIRTHDTA
 12768             MOVE -1             TO BIRTHDTL
 12769             MOVE ER-0220        TO EMI-ERROR
 12770             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12771             GO TO 6020-EDIT
 12772         END-IF
 12773     END-IF.
 12774
 12775******************************************************************
 12776**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 12777**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 12778**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 12779******************************************************************
 12780
 12781     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 12782         MOVE BIRTHDTI           TO  DATE-WORK
 12783         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12784         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 12785         MOVE '4'                TO  DC-OPTION-CODE
 12786         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 12787         MOVE +0                 TO  DC-ELAPSED-MONTHS
 12788                                     DC-ELAPSED-DAYS
 12789         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12790         IF DATE-CONVERSION-ERROR
 12791             MOVE AL-UABON       TO  BIRTHDTA
 12792             MOVE -1             TO  BIRTHDTL
 12793             MOVE ER-0220        TO  EMI-ERROR
 12794             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12795             GO TO 6020-EDIT
 12796         END-IF
 12797     END-IF.
 12798
 12799     MOVE AL-UANON               TO  BIRTHDTA.
 12800     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 12801     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 12802     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 12803
 12804 6020-EDIT.
 12805     IF INCURL GREATER ZERO
 12806         MOVE INCURI             TO DATE-WORK
 12807         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 241
* EL130.cbl
 12808         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12809         MOVE '4'                TO DC-OPTION-CODE
 12810         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12811         IF DATE-CONVERSION-ERROR
 12812             MOVE AL-UABON       TO INCURA
 12813             MOVE -1             TO INCURL
 12814             MOVE ER-0222        TO EMI-ERROR
 12815             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12816         ELSE
 12817             MOVE AL-UANON       TO INCURA
 12818             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 12819             MOVE DC-BIN-DATE-1  TO WS-INCUR
 12820                                    PI-SAVE-INCUR-DT
 12821             IF WS-INCUR GREATER THAN WS-TODAY-DT
 12822                 MOVE ER-0511     TO EMI-ERROR
 12823                 MOVE -1          TO INCURL
 12824                 MOVE AL-UABON    TO INCURA
 12825                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12826             ELSE
 12827*                NEXT SENTENCE
 12828                 CONTINUE
 12829             END-IF
 12830         END-IF
 12831     ELSE
 12832         MOVE ER-0516         TO EMI-ERROR
 12833         MOVE AL-UABON        TO INCURA
 12834         MOVE -1              TO INCURL
 12835         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12836     END-IF.
 12837
 12838     IF REPORTL GREATER ZERO
 12839         MOVE REPORTI            TO DATE-WORK
 12840         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12841         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12842         MOVE '4'                TO DC-OPTION-CODE
 12843         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12844         IF DATE-CONVERSION-ERROR
 12845             MOVE AL-UABON       TO REPORTA
 12846             MOVE -1             TO REPORTL
 12847             MOVE ER-0223        TO EMI-ERROR
 12848             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12849         ELSE
 12850             MOVE AL-UANON       TO REPORTA
 12851             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 12852             MOVE DC-BIN-DATE-1  TO WS-REPORT
 12853             IF WS-REPORT GREATER THAN WS-TODAY-DT
 12854                 MOVE ER-0512     TO EMI-ERROR
 12855                 MOVE -1          TO REPORTL
 12856                 MOVE AL-UABON    TO REPORTA
 12857                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12858             ELSE
 12859*                NEXT SENTENCE
 12860                 CONTINUE
 12861             END-IF
 12862         END-IF
 12863     ELSE
 12864         MOVE ER-0517         TO EMI-ERROR
 12865         MOVE -1              TO REPORTL
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 242
* EL130.cbl
 12866         MOVE AL-UABON        TO REPORTA
 12867         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12868     END-IF.
 12869
 12870     IF WS-REPORT NOT = LOW-VALUES
 12871         IF WS-INCUR GREATER THAN WS-REPORT
 12872             MOVE AL-UABON       TO REPORTA
 12873             MOVE -1             TO REPORTL
 12874             MOVE ER-0509        TO EMI-ERROR
 12875             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12876         END-IF
 12877     END-IF.
 12878
 12879     IF ICD1L GREATER THAN ZERO
 12880         IF (ICD1I GREATER THAN SPACES) AND
 12881            (ICD1I(4:1) NOT = '.')
 12882             IF ICD1I(4:1) = ' '
 12883                 MOVE '.' TO ICD1I(4:1)
 12884             ELSE
 12885                 IF ICD1I(8:1) = ' '
 12886                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 12887                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 12888                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 12889                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 12890                     MOVE '.'        TO ICD1I(4:1)
 12891                 END-IF
 12892             END-IF
 12893         END-IF
 12894         IF (ICD1I GREATER THAN SPACES) AND
 12895            (ICD1I(1:1) NOT > ' ' OR
 12896             ICD1I(2:1) NOT > ' ' OR
 12897             ICD1I(3:1) NOT > ' ' OR
 12898             ICD1I(4:1) NOT = '.')
 12899              MOVE ER-0992        TO  EMI-ERROR
 12900              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12901              MOVE AL-UABON       TO ICD1A
 12902              MOVE -1             TO ICD1L
 12903         END-IF
 12904     END-IF.
 12905
 12906     IF ICD2L GREATER THAN ZERO
 12907         IF (ICD2I GREATER THAN SPACES) AND
 12908            (ICD2I(4:1) NOT = '.')
 12909             IF ICD2I(4:1) = ' '
 12910                 MOVE '.' TO ICD2I(4:1)
 12911             ELSE
 12912                 IF ICD2I(8:1) = ' '
 12913                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 12914                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 12915                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 12916                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 12917                     MOVE '.'        TO ICD2I(4:1)
 12918                 END-IF
 12919             END-IF
 12920         END-IF
 12921         IF (ICD2I GREATER THAN SPACES) AND
 12922            (ICD2I(1:1) NOT > ' ' OR
 12923             ICD2I(2:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 243
* EL130.cbl
 12924             ICD2I(3:1) NOT > ' ' OR
 12925             ICD2I(4:1) NOT = '.')
 12926              MOVE ER-0992        TO  EMI-ERROR
 12927              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12928              MOVE AL-UABON       TO ICD2A
 12929              MOVE -1             TO ICD2L
 12930         END-IF
 12931     END-IF
 12932
 12933*    IF ESTENDL GREATER ZERO
 12934*        MOVE ESTENDI            TO DATE-WORK
 12935*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12936*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12937*        MOVE '4'                TO DC-OPTION-CODE
 12938*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12939*        IF DATE-CONVERSION-ERROR
 12940*            MOVE AL-UABON       TO ESTENDA
 12941*            MOVE -1             TO ESTENDL
 12942*            MOVE ER-0224        TO EMI-ERROR
 12943*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12944*        ELSE
 12945*            MOVE AL-UANON       TO ESTENDA
 12946*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 12947*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 12948*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 12949*               MOVE AL-UABON    TO ESTENDA
 12950*               MOVE -1          TO ESTENDL
 12951*               MOVE ER-0544     TO EMI-ERROR
 12952*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12953*            END-IF
 12954*        END-IF
 12955*    END-IF.
 12956*
 12957*    IF WS-ESTEND NOT = LOW-VALUES
 12958*        IF WS-INCUR GREATER THAN WS-ESTEND
 12959*            MOVE AL-UABON       TO ESTENDA
 12960*            MOVE -1             TO ESTENDL
 12961*            MOVE ER-0510        TO EMI-ERROR
 12962*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12963*        END-IF
 12964*    END-IF.
 12965
 12966     IF PRTOPTL GREATER ZERO
 12967         IF PRTOPTI NOT = 'N' AND 'L'
 12968             MOVE AL-UABON       TO PRTOPTA
 12969             MOVE -1             TO PRTOPTL
 12970             MOVE ER-0334        TO EMI-ERROR
 12971             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12972         END-IF
 12973     END-IF.
 12974
 12975     IF MANRSVL GREATER ZERO
 12976
 12977* EXEC CICS BIF DEEDIT
 12978*            FIELD   (MANRSVI)
 12979*            LENGTH  (9)
 12980*        END-EXEC
 12981     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 244
* EL130.cbl
 12982       TO DFHEIV11
 12983*    MOVE '@"L                   #   #00011836' TO DFHEIV0
 12984     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12985     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12986     MOVE X'2020233030303131383336' TO DFHEIV0(25:11)
 12987     CALL 'kxdfhei1' USING DFHEIV0,
 12988           MANRSVI,
 12989           DFHEIV11
 12990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12991         IF MANRSVI NOT NUMERIC
 12992             MOVE AL-UNBON       TO MANRSVA
 12993             MOVE -1             TO MANRSVL
 12994             MOVE ER-0489        TO EMI-ERROR
 12995             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12996         ELSE
 12997             MOVE AL-UNNON       TO MANRSVA
 12998             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 12999         END-IF
 13000     END-IF.
 13001
 13002     MOVE SPACES                 TO ELCNTL-KEY.
 13003
 13004     IF CONTROL-IS-ACTUAL-CARRIER
 13005         MOVE PI-CARRIER         TO CNTL-CARRIER
 13006     ELSE
 13007         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 13008     END-IF.
 13009
 13010     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13011     MOVE '6'                    TO CNTL-REC-TYPE.
 13012     MOVE +0                     TO CNTL-SEQ-NO.
 13013
 13014
 13015
 13016* EXEC CICS HANDLE CONDITION
 13017*        NOTFND   (3100-CARRIER-NOT-FOUND)
 13018*    END-EXEC.
 13019*    MOVE '"$I                   ! ? #00011864' TO DFHEIV0
 13020     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13021     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13022     MOVE X'3F20233030303131383634' TO DFHEIV0(25:11)
 13023     CALL 'kxdfhei1' USING DFHEIV0
 13024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13025
 13026
 13027     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13028
 13029     IF NOT CF-MANUAL-RESERVES-USED AND
 13030           WS-MANRSV GREATER ZERO
 13031         MOVE ER-0518             TO EMI-ERROR
 13032         MOVE -1                  TO MANRSVL
 13033         MOVE AL-UNBON            TO MANRSVA
 13034         MOVE ZEROS               TO WS-MANRSV
 13035         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13036     END-IF.
 13037
 13038     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 13039     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 245
* EL130.cbl
 13040
 13041     IF SUPVL GREATER ZERO
 13042         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 13043             MOVE -1             TO SUPVL
 13044             MOVE AL-UABON       TO SUPVA
 13045             MOVE ER-0230        TO EMI-ERROR
 13046             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13047         ELSE
 13048             MOVE AL-UANON       TO SUPVA
 13049         END-IF
 13050     END-IF.
 13051
 13052     IF PROCCDL = ZERO
 13053        GO TO 6050-CONTINUE-EDITS
 13054     END-IF.
 13055
 13056     MOVE SPACES                 TO ELCNTL-KEY.
 13057     MOVE PROCCDI                TO CNTL-ACCESS.
 13058
 13059     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13060     MOVE '2'                    TO CNTL-REC-TYPE.
 13061     MOVE +0                     TO CNTL-SEQ-NO.
 13062
 13063
 13064
 13065* EXEC CICS HANDLE CONDITION
 13066*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 13067*    END-EXEC.
 13068*    MOVE '"$I                   ! @ #00011905' TO DFHEIV0
 13069     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13070     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13071     MOVE X'4020233030303131393035' TO DFHEIV0(25:11)
 13072     CALL 'kxdfhei1' USING DFHEIV0
 13073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13074
 13075
 13076     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13077
 13078     GO TO 6050-CONTINUE-EDITS.
 13079
 13080 6040-NO-PROCESSOR-RECORD.
 13081     MOVE ER-0019                TO EMI-ERROR.
 13082     MOVE -1                     TO PROCCDL.
 13083     MOVE AL-UABON               TO PROCCDA.
 13084     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13085
 13086 6050-CONTINUE-EDITS.
 13087     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 13088           GO TO 6070-CONTINUE-EDITS
 13089     END-IF.
 13090
 13091     MOVE BENECDI                TO BENE-CODE.
 13092     MOVE 'B'                    TO BENE-RCD-TYPE.
 13093     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 13094
 13095
 13096
 13097* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 246
* EL130.cbl
 13098*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 13099*    END-EXEC.
 13100*    MOVE '"$I                   ! A #00011929' TO DFHEIV0
 13101     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13102     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13103     MOVE X'4120233030303131393239' TO DFHEIV0(25:11)
 13104     CALL 'kxdfhei1' USING DFHEIV0
 13105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13106
 13107
 13108
 13109* EXEC CICS READ
 13110*         DATASET   (ELBENE-DSID)
 13111*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13112*         RIDFLD    (ELBENE-KEY)
 13113*    END-EXEC.
 13114*    MOVE '&"S        E          (   #00011933' TO DFHEIV0
 13115     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13116     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13117     MOVE X'2020233030303131393333' TO DFHEIV0(25:11)
 13118     CALL 'kxdfhei1' USING DFHEIV0,
 13119           ELBENE-DSID,
 13120           DFHEIV20,
 13121           DFHEIV99,
 13122           ELBENE-KEY,
 13123           DFHEIV99,
 13124           DFHEIV99,
 13125           DFHEIV99
 13126     SET ADDRESS OF BENEFICIARY-MASTER TO
 13127         DFHEIV20
 13128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13129
 13130
 13131     GO TO 6070-CONTINUE-EDITS.
 13132
 13133 6060-NO-BENEFICIARY-RECORD.
 13134     MOVE ER-0565                TO EMI-ERROR.
 13135     MOVE -1                     TO BENECDL.
 13136     MOVE AL-UABON               TO BENECDA.
 13137     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13138
 13139
 13140 6070-CONTINUE-EDITS.
 13141     IF CERTMTL GREATER ZERO
 13142         IF CERTMTI NOT = 'A' AND 'S'
 13143             MOVE -1             TO CERTMTL
 13144             MOVE AL-UABON       TO CERTMTA
 13145             MOVE ER-0267        TO EMI-ERROR
 13146             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13147         ELSE
 13148             MOVE AL-UANON       TO CERTMTA
 13149         END-IF
 13150     ELSE
 13151         GO TO 6000-EXIT
 13152     END-IF.
 13153
 13154     IF EFFDTL GREATER ZERO
 13155         MOVE EFFDTI             TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 247
* EL130.cbl
 13156         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13157         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13158         MOVE '4'                TO DC-OPTION-CODE
 13159         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13160         IF DATE-CONVERSION-ERROR
 13161             MOVE AL-UABON       TO EFFDTA
 13162             MOVE -1             TO EFFDTL
 13163             MOVE ER-0231        TO EMI-ERROR
 13164             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13165         ELSE
 13166             MOVE AL-UANON       TO EFFDTA
 13167             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13168             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13169         END-IF
 13170     ELSE
 13171         MOVE ER-0231            TO EMI-ERROR
 13172         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13173         MOVE -1                 TO EFFDTL
 13174         MOVE AL-UABON           TO EFFDTA
 13175     END-IF.
 13176
 13177     IF ACCOUNTL = ZERO
 13178         MOVE ER-0232            TO EMI-ERROR
 13179         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13180         MOVE AL-UABON           TO ACCOUNTA
 13181         MOVE -1                 TO ACCOUNTL
 13182     ELSE
 13183         MOVE AL-UANON           TO ACCOUNTA
 13184     END-IF.
 13185
 13186     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13187        (STATEL = ZERO)
 13188         MOVE ER-0233        TO EMI-ERROR
 13189         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13190         MOVE AL-UABON       TO STATEA
 13191         MOVE -1             TO STATEL
 13192     ELSE
 13193         MOVE AL-UANON       TO STATEA
 13194     END-IF.
 13195
 13196     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13197        (CRTCARRL = ZERO)
 13198         MOVE ER-0234        TO EMI-ERROR
 13199         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13200         MOVE AL-UABON       TO CRTCARRA
 13201         MOVE -1             TO CRTCARRL
 13202     ELSE
 13203         MOVE AL-UANON       TO CRTCARRA
 13204     END-IF.
 13205
 13206     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13207        GROUPL = ZERO
 13208         MOVE ER-0235            TO EMI-ERROR
 13209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13210         MOVE AL-UABON           TO GROUPA
 13211         MOVE -1                 TO GROUPL
 13212     ELSE
 13213         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 248
* EL130.cbl
 13214     END-IF.
 13215
 13216     IF CRTLNMEL = ZERO
 13217         IF LSTNMEI = SPACES OR LOW-VALUES
 13218             MOVE ER-0236            TO  EMI-ERROR
 13219             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13220             MOVE AL-UABON           TO  CRTLNMEA
 13221             MOVE -1                 TO  CRTLNMEL
 13222         ELSE
 13223             MOVE LSTNMEI            TO  CRTLNMEI
 13224             MOVE AL-UANON           TO  CRTLNMEA
 13225         END-IF
 13226     ELSE
 13227         MOVE AL-UANON               TO  CRTLNMEA
 13228     END-IF.
 13229
 13230     IF CRTFNMEL = ZERO
 13231         IF FSTNMEI = SPACES OR LOW-VALUES
 13232*            NEXT SENTENCE
 13233             CONTINUE
 13234         ELSE
 13235             MOVE FSTNMEI            TO  CRTFNMEI
 13236             MOVE AL-UANON           TO  CRTFNMEA
 13237         END-IF
 13238     END-IF.
 13239
 13240     IF CRTINITL = ZERO
 13241         IF INITI = SPACES OR LOW-VALUES
 13242*            NEXT SENTENCE
 13243             CONTINUE
 13244         ELSE
 13245             MOVE INITI              TO  CRTINITI
 13246             MOVE AL-UANON           TO  CRTINITA
 13247         END-IF
 13248     END-IF.
 13249
 13250 6000-EXIT.
 13251     EXIT.
 13252
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 249
* EL130.cbl
 13254 6200-EDIT-CERT-DATA.
 13255     IF ISSAGEL GREATER ZERO
 13256         IF ISSAGEI NOT NUMERIC
 13257             MOVE ER-0237        TO EMI-ERROR
 13258             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13259             MOVE -1             TO ISSAGEL
 13260             MOVE AL-UNBON       TO ISSAGEA
 13261         ELSE
 13262             MOVE AL-UNNON       TO ISSAGEA
 13263         END-IF
 13264     END-IF.
 13265
 13266     IF JNTAGEL GREATER ZERO
 13267         IF JNTAGEI NOT NUMERIC
 13268             MOVE ER-0238        TO EMI-ERROR
 13269             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13270             MOVE -1             TO JNTAGEL
 13271             MOVE AL-UNBON       TO JNTAGEA
 13272         ELSE
 13273             MOVE AL-UNNON       TO JNTAGEA
 13274         END-IF
 13275     END-IF.
 13276
 13277     IF LCVCDL GREATER ZERO
 13278         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13279         IF INVALID-BENEFIT-CODE
 13280             MOVE ER-7635        TO EMI-ERROR
 13281             MOVE -1             TO LCVCDL
 13282             MOVE AL-UABON       TO LCVCDA
 13283             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13284         ELSE
 13285             MOVE LCVCDI         TO WS-BEN-HOLD
 13286             MOVE '4'            TO WS-REC-TYPE
 13287             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13288             IF WS-BEN-ALPHA-HOLD = SPACES
 13289                MOVE ER-7635     TO EMI-ERROR
 13290                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13291                MOVE -1          TO LCVCDL
 13292                MOVE AL-UABON    TO LCVCDA
 13293             ELSE
 13294                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13295                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13296                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13297                MOVE AL-UANON           TO LCVCDA
 13298             END-IF
 13299         END-IF
 13300     END-IF.
 13301
 13302     IF ACVCDL GREATER ZERO
 13303         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13304         IF INVALID-BENEFIT-CODE
 13305             MOVE ER-7635        TO EMI-ERROR
 13306             MOVE -1             TO ACVCDL
 13307             MOVE AL-UABON       TO ACVCDA
 13308             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13309         ELSE
 13310             MOVE ACVCDI         TO WS-BEN-HOLD
 13311             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 250
* EL130.cbl
 13312             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13313             IF WS-BEN-ALPHA-HOLD = SPACES
 13314                MOVE ER-7635     TO EMI-ERROR
 13315                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13316                MOVE -1          TO ACVCDL
 13317                MOVE AL-UABON    TO ACVCDA
 13318             ELSE
 13319                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13320                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13321                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13322                MOVE AL-UANON           TO ACVCDA
 13323             END-IF
 13324         END-IF
 13325     END-IF.
 13326
 13327     IF LCVOTRML GREATER ZERO
 13328         IF LCVOTRMI NOT NUMERIC
 13329             MOVE ER-7636        TO EMI-ERROR
 13330             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13331             MOVE -1             TO LCVOTRML
 13332             MOVE AL-UNBON       TO LCVOTRMA
 13333         ELSE
 13334             MOVE AL-UNNON       TO LCVOTRMA
 13335         END-IF
 13336     END-IF.
 13337
 13338     IF ACVOTRML GREATER ZERO
 13339         IF ACVOTRMI NOT NUMERIC
 13340             MOVE ER-7636        TO EMI-ERROR
 13341             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13342             MOVE -1             TO ACVOTRML
 13343             MOVE AL-UNBON       TO ACVOTRMA
 13344         ELSE
 13345             MOVE AL-UNNON       TO ACVOTRMA
 13346         END-IF
 13347     END-IF.
 13348
 13349     IF LCVRATEL GREATER ZERO
 13350
 13351* EXEC CICS BIF DEEDIT
 13352*            FIELD    (LCVRATEI)
 13353*            LENGTH   (06)
 13354*        END-EXEC
 13355     MOVE 06
 13356       TO DFHEIV11
 13357*    MOVE '@"L                   #   #00012158' TO DFHEIV0
 13358     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13359     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13360     MOVE X'2020233030303132313538' TO DFHEIV0(25:11)
 13361     CALL 'kxdfhei1' USING DFHEIV0,
 13362           LCVRATEI,
 13363           DFHEIV11
 13364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13365         IF LCVRATEI NOT NUMERIC
 13366             MOVE AL-UNBON       TO LCVRATEA
 13367             MOVE -1             TO LCVRATEL
 13368             MOVE ER-2280        TO EMI-ERROR
 13369             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 251
* EL130.cbl
 13370         ELSE
 13371             MOVE AL-UNNON       TO LCVRATEA
 13372             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13373         END-IF
 13374     END-IF.
 13375
 13376     IF ACVRATEL GREATER ZERO
 13377
 13378* EXEC CICS BIF DEEDIT
 13379*            FIELD    (ACVRATEI)
 13380*            LENGTH   (06)
 13381*        END-EXEC
 13382     MOVE 06
 13383       TO DFHEIV11
 13384*    MOVE '@"L                   #   #00012174' TO DFHEIV0
 13385     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13386     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13387     MOVE X'2020233030303132313734' TO DFHEIV0(25:11)
 13388     CALL 'kxdfhei1' USING DFHEIV0,
 13389           ACVRATEI,
 13390           DFHEIV11
 13391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13392         IF ACVRATEI NOT NUMERIC
 13393             MOVE AL-UNBON       TO ACVRATEA
 13394             MOVE -1             TO ACVRATEL
 13395             MOVE ER-2280        TO EMI-ERROR
 13396             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13397         ELSE
 13398             MOVE AL-UNNON       TO ACVRATEA
 13399             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13400         END-IF
 13401     END-IF.
 13402
 13403     IF LCVBENEL GREATER ZERO
 13404
 13405* EXEC CICS BIF DEEDIT
 13406*            FIELD    (LCVBENEI)
 13407*            LENGTH   (11)
 13408*        END-EXEC
 13409     MOVE 11
 13410       TO DFHEIV11
 13411*    MOVE '@"L                   #   #00012190' TO DFHEIV0
 13412     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13413     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13414     MOVE X'2020233030303132313930' TO DFHEIV0(25:11)
 13415     CALL 'kxdfhei1' USING DFHEIV0,
 13416           LCVBENEI,
 13417           DFHEIV11
 13418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13419         IF LCVBENEI NOT NUMERIC
 13420             MOVE AL-UNBON       TO LCVBENEA
 13421             MOVE -1             TO LCVBENEL
 13422             MOVE ER-7637        TO EMI-ERROR
 13423             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13424         ELSE
 13425             MOVE AL-UNNON       TO LCVBENEA
 13426             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13427         END-IF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 252
* EL130.cbl
 13428     END-IF.
 13429
 13430     IF ACVBENEL GREATER ZERO
 13431
 13432* EXEC CICS BIF DEEDIT
 13433*            FIELD    (ACVBENEI)
 13434*            LENGTH   (11)
 13435*        END-EXEC
 13436     MOVE 11
 13437       TO DFHEIV11
 13438*    MOVE '@"L                   #   #00012206' TO DFHEIV0
 13439     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13440     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13441     MOVE X'2020233030303132323036' TO DFHEIV0(25:11)
 13442     CALL 'kxdfhei1' USING DFHEIV0,
 13443           ACVBENEI,
 13444           DFHEIV11
 13445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13446         IF ACVBENEI NOT NUMERIC
 13447             MOVE AL-UNBON       TO ACVBENEA
 13448             MOVE -1             TO ACVBENEL
 13449             MOVE ER-7637        TO EMI-ERROR
 13450             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13451         ELSE
 13452             MOVE AL-UNNON       TO ACVBENEA
 13453             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13454         END-IF
 13455     END-IF.
 13456
 13457     IF LCVCNDTL GREATER ZERO
 13458         IF LCVCNDTI NOT = SPACES
 13459             MOVE LCVCNDTI        TO DATE-WORK
 13460             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13461             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13462             MOVE '4'             TO DC-OPTION-CODE
 13463             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13464             IF DATE-CONVERSION-ERROR
 13465                 MOVE AL-UABON    TO LCVCNDTA
 13466                 MOVE -1          TO LCVCNDTL
 13467                 MOVE ER-7638     TO EMI-ERROR
 13468                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13469             ELSE
 13470                 MOVE AL-UANON    TO LCVCNDTA
 13471                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13472                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13473             END-IF
 13474         END-IF
 13475     END-IF.
 13476
 13477     IF ACVCNDTL GREATER ZERO
 13478         IF ACVCNDTI NOT = SPACES
 13479             MOVE ACVCNDTI        TO DATE-WORK
 13480             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13481             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13482             MOVE '4'             TO DC-OPTION-CODE
 13483             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13484             IF DATE-CONVERSION-ERROR
 13485                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 253
* EL130.cbl
 13486                 MOVE -1          TO ACVCNDTL
 13487                 MOVE ER-7638     TO EMI-ERROR
 13488                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13489             ELSE
 13490                 MOVE AL-UANON    TO ACVCNDTA
 13491                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13492                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13493             END-IF
 13494         END-IF
 13495     END-IF.
 13496
 13497     IF ADDONDTL GREATER ZERO
 13498         MOVE ADDONDTI        TO DATE-WORK
 13499         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13500         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13501         MOVE '4'             TO DC-OPTION-CODE
 13502         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13503         IF DATE-CONVERSION-ERROR
 13504             MOVE AL-UABON    TO ADDONDTA
 13505             MOVE -1          TO ADDONDTL
 13506             MOVE ER-7651     TO EMI-ERROR
 13507             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13508         ELSE
 13509             MOVE AL-UANON    TO ADDONDTA
 13510             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13511             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13512         END-IF
 13513     END-IF.
 13514
 13515     IF APRL GREATER ZERO
 13516
 13517* EXEC CICS BIF DEEDIT
 13518*            FIELD    (APRI)
 13519*            LENGTH   (8)
 13520*        END-EXEC
 13521     MOVE 8
 13522       TO DFHEIV11
 13523*    MOVE '@"L                   #   #00012280' TO DFHEIV0
 13524     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13525     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13526     MOVE X'2020233030303132323830' TO DFHEIV0(25:11)
 13527     CALL 'kxdfhei1' USING DFHEIV0,
 13528           APRI,
 13529           DFHEIV11
 13530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13531         IF APRI NOT NUMERIC
 13532             MOVE AL-UNBON       TO APRA
 13533             MOVE -1             TO APRL
 13534             MOVE ER-0248        TO EMI-ERROR
 13535             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13536         ELSE
 13537             MOVE AL-UNNON       TO APRA
 13538             MOVE APRI           TO WS-APR APRO
 13539         END-IF
 13540     END-IF.
 13541
 13542     IF PMTFREQL GREATER ZERO
 13543
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 254
* EL130.cbl
 13544* EXEC CICS BIF DEEDIT
 13545*            FIELD   (PMTFREQI)
 13546*            LENGTH  (2)
 13547*        END-EXEC
 13548     MOVE 2
 13549       TO DFHEIV11
 13550*    MOVE '@"L                   #   #00012296' TO DFHEIV0
 13551     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13552     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13553     MOVE X'2020233030303132323936' TO DFHEIV0(25:11)
 13554     CALL 'kxdfhei1' USING DFHEIV0,
 13555           PMTFREQI,
 13556           DFHEIV11
 13557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13558         IF PMTFREQI NOT NUMERIC
 13559             MOVE -1             TO PMTFREQL
 13560             MOVE AL-UNBON       TO PMTFREQA
 13561             MOVE ER-0258        TO EMI-ERROR
 13562             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13563         ELSE
 13564             MOVE AL-UNNON       TO PMTFREQA
 13565             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13566         END-IF
 13567     END-IF.
 13568
 13569     IF INDGRPL GREATER ZERO
 13570         IF INDGRPI = 'I' OR 'G'
 13571             MOVE AL-UANON       TO INDGRPA
 13572         ELSE
 13573             MOVE -1 TO INDGRPL
 13574             MOVE AL-UABON       TO INDGRPA
 13575             MOVE ER-0260        TO EMI-ERROR
 13576             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13577         END-IF
 13578     END-IF.
 13579
 13580     IF LOANBALL GREATER ZERO
 13581         MOVE LOANBALI           TO DEEDIT-FIELD
 13582
 13583* EXEC CICS BIF DEEDIT
 13584*            FIELD   (DEEDIT-FIELD)
 13585*            LENGTH  (12)
 13586*        END-EXEC
 13587     MOVE 12
 13588       TO DFHEIV11
 13589*    MOVE '@"L                   #   #00012324' TO DFHEIV0
 13590     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13591     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13592     MOVE X'2020233030303132333234' TO DFHEIV0(25:11)
 13593     CALL 'kxdfhei1' USING DFHEIV0,
 13594           DEEDIT-FIELD,
 13595           DFHEIV11
 13596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13597         IF DEEDIT-FIELD NOT NUMERIC
 13598             MOVE AL-UNBON       TO LOANBALA
 13599             MOVE -1             TO LOANBALL
 13600             MOVE ER-0247        TO EMI-ERROR
 13601             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 255
* EL130.cbl
 13602         ELSE
 13603             MOVE AL-UNNON       TO LOANBALA
 13604             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13605         END-IF
 13606     END-IF.
 13607
 13608     IF PREMTYPL GREATER ZERO
 13609         IF (PREMTYPI = '1' OR '2' OR '3')
 13610             MOVE AL-UANON       TO PREMTYPA
 13611         ELSE
 13612             MOVE -1             TO PREMTYPL
 13613             MOVE AL-UABON       TO PREMTYPA
 13614             MOVE ER-0227        TO EMI-ERROR
 13615             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13616         END-IF
 13617     END-IF.
 13618
 13619     IF REINCDL GREATER ZERO
 13620         MOVE LOW-VALUES         TO  ERREIN-KEY
 13621         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13622         MOVE REINCDI            TO  REIN-CODE-1
 13623                                     REIN-CODE-2
 13624                                     REIN-CODE-3
 13625         MOVE 'A'                TO  REIN-TYPE
 13626         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13627         IF REIN-REC-NOT-FOUND
 13628             MOVE ER-0266        TO  EMI-ERROR
 13629             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13630             MOVE -1             TO  REINCDL
 13631             MOVE AL-UABON       TO  REINCDA
 13632         ELSE
 13633             MOVE AL-UANON       TO  REINCDA
 13634         END-IF
 13635     END-IF.
 13636
 13637     IF CERTMTI NOT = 'A'
 13638        GO TO 6200-EXIT
 13639     END-IF.
 13640
 13641     IF PREMTYPI = '1'
 13642         IF LCVCDL GREATER ZERO
 13643             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13644                 MOVE ER-0841        TO  EMI-ERROR
 13645                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13646                 MOVE -1             TO  PREMTYPL
 13647                 MOVE AL-UABON       TO  PREMTYPA
 13648             END-IF
 13649         END-IF
 13650     END-IF.
 13651
 13652     IF PREMTYPI = '1'
 13653         IF ACVCDL GREATER ZERO
 13654             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13655                 MOVE ER-0841        TO  EMI-ERROR
 13656                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13657                 MOVE -1             TO  PREMTYPL
 13658                 MOVE AL-UABON       TO  PREMTYPA
 13659             END-IF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 256
* EL130.cbl
 13660         END-IF
 13661     END-IF.
 13662
 13663     IF PREMTYPI = '2'
 13664         IF LCVCDL GREATER ZERO
 13665             IF (PI-COMPANY-ID = 'HAN') AND
 13666                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13667                        OR
 13668                 WS-LF-SPECIAL-CALC-CD = 'O'
 13669*                NEXT SENTENCE
 13670                 CONTINUE
 13671             ELSE
 13672                 MOVE ER-0840        TO  EMI-ERROR
 13673                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13674                 MOVE -1             TO  PREMTYPL
 13675                 MOVE AL-UABON       TO  PREMTYPA
 13676             END-IF
 13677         END-IF
 13678     END-IF.
 13679
 13680     IF PREMTYPI = '2'
 13681         IF ACVCDL GREATER ZERO
 13682             IF (PI-COMPANY-ID = 'HAN')  AND
 13683                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13684                        OR
 13685                 WS-AH-SPECIAL-CALC-CD = 'O'
 13686*                NEXT SENTENCE
 13687                 CONTINUE
 13688             ELSE
 13689                 MOVE ER-0840        TO  EMI-ERROR
 13690                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13691                 MOVE -1             TO  PREMTYPL
 13692                 MOVE AL-UABON       TO  PREMTYPA
 13693             END-IF
 13694         END-IF
 13695     END-IF.
 13696
 13697     IF LCVCDL = ZEROS
 13698        GO TO 6200-EXIT
 13699     END-IF.
 13700
 13701     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 13702         IF PMTFREQI NOT = ZEROS
 13703             MOVE ER-0428        TO EMI-ERROR
 13704             MOVE -1             TO PMTFREQL
 13705             MOVE AL-UNBON       TO PMTFREQA
 13706             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13707             GO TO 6200-CHECK-APR
 13708         END-IF
 13709     END-IF.
 13710
 13711     IF PMTFREQL = ZEROS AND TEX-REG
 13712         MOVE ER-0429            TO EMI-ERROR
 13713         MOVE -1                 TO PMTFREQL
 13714         MOVE AL-UNBON           TO PMTFREQA
 13715         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13716         GO TO 6200-CHECK-APR
 13717     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 257
* EL130.cbl
 13718
 13719     IF LCVOTRMI NOT NUMERIC
 13720         GO TO 6200-CHECK-APR
 13721     END-IF.
 13722
 13723     IF WS-PMTFREQ NOT = ZERO
 13724         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 13725         GIVING DIVIDE-QUOT
 13726         REMAINDER DIVIDE-REM
 13727         IF DIVIDE-REM GREATER ZERO
 13728             MOVE ER-0430            TO EMI-ERROR
 13729             MOVE -1                 TO PMTFREQL
 13730             MOVE AL-UNBON           TO PMTFREQA
 13731             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13732         END-IF
 13733     END-IF.
 13734
 13735 6200-CHECK-APR.
 13736     IF NET-PAY AND APRL = ZEROS
 13737        MOVE ER-0257             TO EMI-ERROR
 13738        MOVE -1                  TO APRL
 13739        MOVE AL-UABON            TO APRA
 13740        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13741     END-IF.
 13742
 13743 6200-EXIT.
 13744     EXIT.
 13745
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 258
* EL130.cbl
 13747 6300-REQUIRED-CERT-EDIT.
 13748
 13749     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13750        GO TO 6300-REQUIRED-AH-EDIT
 13751     END-IF
 13752
 13753     IF LCVCDL = ZERO
 13754        MOVE ER-7639             TO EMI-ERROR
 13755        MOVE -1                  TO LCVCDL
 13756        MOVE AL-UABON            TO LCVCDA
 13757        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13758     END-IF.
 13759
 13760     IF LCVOTRML = ZERO
 13761        MOVE ER-7670             TO EMI-ERROR
 13762        MOVE -1                  TO LCVOTRML
 13763        MOVE AL-UNBON            TO LCVOTRMA
 13764        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13765     END-IF.
 13766
 13767     IF LCVBENEL = ZERO
 13768        MOVE ER-7671             TO EMI-ERROR
 13769        MOVE -1                  TO LCVBENEL
 13770        MOVE AL-UNBON            TO LCVBENEA
 13771        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13772     END-IF.
 13773
 13774     GO TO 6399-EXIT.
 13775
 13776 6300-REQUIRED-AH-EDIT.
 13777
 13778     IF ACVCDL = ZERO
 13779        MOVE ER-7639             TO EMI-ERROR
 13780        MOVE -1                  TO ACVCDL
 13781        MOVE AL-UABON            TO ACVCDA
 13782        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13783     END-IF.
 13784
 13785     IF ACVOTRML = ZERO
 13786         MOVE ER-7670             TO EMI-ERROR
 13787         MOVE -1                  TO ACVOTRML
 13788         MOVE AL-UNBON            TO ACVOTRMA
 13789         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13790     END-IF.
 13791
 13792     IF ACVBENEL = ZERO
 13793        MOVE ER-7671             TO EMI-ERROR
 13794        MOVE -1                  TO ACVBENEL
 13795        MOVE AL-UNBON            TO ACVBENEA
 13796        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13797     END-IF.
 13798
 13799 6399-EXIT.
 13800      EXIT.
 13801
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 259
* EL130.cbl
 13803 6400-TEST-CLAIM-REASONABILITY.
 13804
 13805     IF WS-INCUR = LOW-VALUES
 13806        GO TO 6499-EXIT
 13807     END-IF.
 13808
 13809     IF WS-EFFDT NOT = LOW-VALUES
 13810         IF WS-INCUR LESS WS-EFFDT
 13811             MOVE ER-0458          TO EMI-ERROR
 13812             MOVE -1               TO INCURL
 13813             MOVE AL-UABON         TO INCURA
 13814             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13815         END-IF
 13816     END-IF.
 13817
 13818     IF CERTMTI = 'A'
 13819        GO TO 6460-TEST-NEW-CERT
 13820     END-IF.
 13821
 13822     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 13823     MOVE CRTCARRI               TO CERT-CARRIER.
 13824     MOVE GROUPI                 TO CERT-GROUPING.
 13825     MOVE STATEI                 TO CERT-STATE.
 13826     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 13827     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 13828     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 13829
 13830
 13831
 13832* EXEC CICS HANDLE CONDITION
 13833*         DUPKEY   (6499-EXIT)
 13834*         NOTFND   (6499-EXIT)
 13835*    END-EXEC.
 13836*    MOVE '"$$I                  ! B #00012562' TO DFHEIV0
 13837     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 13838     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13839     MOVE X'4220233030303132353632' TO DFHEIV0(25:11)
 13840     CALL 'kxdfhei1' USING DFHEIV0
 13841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13842
 13843
 13844     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 13845
 13846     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 13847        'I' OR 'G')
 13848        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13849     ELSE
 13850        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13851     END-IF.
 13852
 13853     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13854     MOVE '6'                    TO DC-OPTION-CODE.
 13855     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13856
 13857     IF WS-INCUR GREATER THAN DC-BIN-DATE-2
 13858        MOVE ER-0519             TO EMI-ERROR
 13859        MOVE -1                  TO INCURL
 13860        MOVE AL-UABON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 260
* EL130.cbl
 13861        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13862     END-IF.
 13863
 13864     IF CLMCARRI NOT = CRTCARRI
 13865        MOVE ER-0562             TO EMI-ERROR
 13866        MOVE AL-UABON            TO CLMCARRA
 13867        MOVE -1                  TO CLMCARRL
 13868        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13869     END-IF.
 13870
 13871     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13872        CM-AH-BENEFIT-CD = '00')
 13873                  OR
 13874        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13875        CM-LF-BENEFIT-CD = '00')
 13876         MOVE ER-0521         TO EMI-ERROR
 13877         MOVE AL-UABON        TO CLMTYPEA
 13878         MOVE -1              TO CLMTYPEL
 13879         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13880     END-IF.
 13881*    IF CLMTYPEI = 'I' AND
 13882*       CM-AH-CRITICAL-PERIOD = +0
 13883*        MOVE ER-0521         TO EMI-ERROR
 13884*        MOVE AL-UABON        TO CLMTYPEA
 13885*        MOVE -1              TO CLMTYPEL
 13886*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13887*    END-IF
 13888
 13889*    IF PI-COMPANY-ID = 'CRI'
 13890*        IF MAINTI = 'A'
 13891*            IF CERT-PEND-ISSUE-ERROR  OR
 13892*               CERT-PEND-ISSUE-RETURNED
 13893*                MOVE -1                 TO CERTNOL
 13894*                MOVE AL-UABON           TO CERTNOA
 13895*                MOVE ER-7640            TO EMI-ERROR
 13896*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13897*            END-IF
 13898*        END-IF
 13899*    END-IF.
 13900
 13901     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 13902         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 13903         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 13904             GO TO 6450-DATE-ERROR
 13905         END-IF
 13906     END-IF.
 13907
 13908     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 13909         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 13910         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 13911             GO TO 6450-DATE-ERROR
 13912         END-IF
 13913     END-IF.
 13914
 13915     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13916         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 13917             GO TO 6450-DATE-ERROR
 13918         END-IF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 261
* EL130.cbl
 13919     END-IF.
 13920
 13921     GO TO 6499-EXIT.
 13922
 13923 6450-DATE-ERROR.
 13924     MOVE ER-0520                TO EMI-ERROR.
 13925     MOVE -1                     TO INCURL.
 13926     MOVE AL-UABON               TO INCURA.
 13927     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13928
 13929*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 13930*       (EMI-SEVERITY-SAVE = 'X')
 13931*        ADD 1                TO EMI-FORCABLE-CTR
 13932*        SUBTRACT 1 FROM EMI-FATAL-CTR
 13933*    END-IF.
 13934
 13935     GO TO 6499-EXIT.
 13936
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 262
* EL130.cbl
 13938 6460-TEST-NEW-CERT.
 13939
 13940     IF NOT EMI-NO-ERRORS
 13941        GO TO 6499-EXIT
 13942     END-IF.
 13943
 13944     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 13945
 13946     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13947         ACVOTRML GREATER ZERO)
 13948        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 13949     END-IF.
 13950
 13951     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13952         LCVOTRML GREATER ZERO
 13953        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 13954     END-IF.
 13955
 13956     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 13957
 13958*    IF PI-COMPANY-ID = 'HAN'
 13959*        IF ADDONDTL GREATER ZERO
 13960*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 13961*            IF CLMTYPEI = 'A'
 13962*                IF ACVOTRMI NOT = ZEROS
 13963*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 13964*                ELSE
 13965*                    NEXT SENTENCE
 13966*                    CONTINUE
 13967*                END-IF
 13968*            ELSE
 13969*                IF LCVOTRMI NOT = ZEROS
 13970*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 13971*                END-IF
 13972*            END-IF
 13973*        END-IF
 13974*    END-IF.
 13975
 13976     MOVE '6'                    TO DC-OPTION-CODE.
 13977     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13978
 13979     IF NO-CONVERSION-ERROR
 13980         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 13981     END-IF.
 13982
 13983     IF WS-INCUR GREATER THAN WS-EXPIRE
 13984        MOVE ER-0519             TO EMI-ERROR
 13985        MOVE -1                  TO INCURL
 13986        MOVE AL-UABON            TO INCURA
 13987        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13988     END-IF.
 13989
 13990     IF CLMCARRI NOT = CRTCARRI
 13991        MOVE ER-0562             TO EMI-ERROR
 13992        MOVE AL-UABON            TO CLMCARRA
 13993        MOVE -1                  TO CLMCARRL
 13994        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13995     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 263
* EL130.cbl
 13996
 13997     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13998         ACVCDL = ZEROS)
 13999             MOVE ER-0521        TO EMI-ERROR
 14000             MOVE AL-UABON       TO CLMTYPEA
 14001             MOVE -1             TO CLMTYPEL
 14002             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14003     END-IF.
 14004
 14005     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14006         LCVCDL = ZEROS
 14007             MOVE ER-0521        TO EMI-ERROR
 14008             MOVE AL-UABON       TO CLMTYPEA
 14009             MOVE -1             TO CLMTYPEL
 14010             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14011     END-IF.
 14012
 14013     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14014         IF LCVCNDTL GREATER ZERO
 14015             IF WS-INCUR GREATER THAN WS-LCVCNDT
 14016                 GO TO 6450-DATE-ERROR
 14017             END-IF
 14018         END-IF
 14019     END-IF.
 14020
 14021     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14022         IF ACVCNDTL GREATER ZERO
 14023             IF WS-INCUR GREATER THAN WS-ACVCNDT
 14024                 GO TO 6450-DATE-ERROR
 14025             END-IF
 14026         END-IF
 14027     END-IF.
 14028
 14029 6499-EXIT.
 14030     EXIT.
 14031 6500-get-acct.
 14032
 14033     MOVE SPACES                 TO ERACCT-KEY
 14034                                    ws-dcc-product-code
 14035                                    ws-acct-found-sw
 14036
 14037     IF CARR-GROUP-ST-ACCNT-CNTL
 14038        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 14039        MOVE CRTCARRI            TO ACCT-CARRIER
 14040        MOVE GROUPI              TO ACCT-GROUPING
 14041        MOVE STATEI              TO ACCT-STATE
 14042        MOVE ACCOUNTI            TO ACCT-ACCOUNT
 14043        GO TO 6500-startbr
 14044     END-IF
 14045
 14046     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 14047     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 14048
 14049     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 14050        MOVE STATEI             TO ACCT-STATE
 14051     END-IF
 14052
 14053     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 264
* EL130.cbl
 14054        MOVE CRTCARRI           TO ACCT-CARRIER
 14055     END-IF
 14056
 14057     .
 14058 6500-startbr.
 14059
 14060     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 14061
 14062
 14063* EXEC CICS STARTBR
 14064*       DATASET     (ERACCT2-DSID)
 14065*       RIDFLD      (SAVE-ERACCT-KEY)
 14066*       GENERIC
 14067*       KEYLENGTH   (20)
 14068*       resp        (ws-response)
 14069*    END-EXEC
 14070     MOVE 20
 14071       TO DFHEIV11
 14072     MOVE 0
 14073       TO DFHEIV12
 14074*    MOVE '&,   KG    G          &  N#00012785' TO DFHEIV0
 14075     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 14076     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14077     MOVE X'204E233030303132373835' TO DFHEIV0(25:11)
 14078     CALL 'kxdfhei1' USING DFHEIV0,
 14079           ERACCT2-DSID,
 14080           SAVE-ERACCT-KEY,
 14081           DFHEIV11,
 14082           DFHEIV12,
 14083           DFHEIV99
 14084     MOVE EIBRESP  TO ws-response
 14085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14086
 14087     if not ws-resp-normal
 14088        go to 6500-exit
 14089     end-if
 14090
 14091     .
 14092 6500-readnext.
 14093
 14094
 14095* EXEC CICS READNEXT
 14096*       DATASET   (ERACCT2-DSID)
 14097*       SET       (ADDRESS OF ACCOUNT-MASTER)
 14098*       RIDFLD    (SAVE-ERACCT-KEY)
 14099*    END-EXEC
 14100     MOVE 0
 14101       TO DFHEIV11
 14102*    MOVE '&.S                   )   #00012800' TO DFHEIV0
 14103     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14104     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14105     MOVE X'2020233030303132383030' TO DFHEIV0(25:11)
 14106     CALL 'kxdfhei1' USING DFHEIV0,
 14107           ERACCT2-DSID,
 14108           DFHEIV20,
 14109           DFHEIV99,
 14110           SAVE-ERACCT-KEY,
 14111           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 265
* EL130.cbl
 14112           DFHEIV11,
 14113           DFHEIV99,
 14114           DFHEIV99
 14115     SET ADDRESS OF ACCOUNT-MASTER TO
 14116         DFHEIV20
 14117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14118
 14119     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14120        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14121        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14122        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14123        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14124        go to 6500-endbr
 14125     END-IF
 14126
 14127     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14128        and (WS-EFFDT < AM-EXPIRATION-DT)
 14129        set acct-found to true
 14130        MOVE AM-dcc-product-code to ws-dcc-product-code
 14131        GO TO 6500-endbr
 14132     END-IF
 14133
 14134     IF WS-EFFDT >= AM-EXPIRATION-DT
 14135         GO TO 6500-readnext
 14136     END-IF
 14137
 14138     .
 14139 6500-endbr.
 14140
 14141
 14142* EXEC CICS ENDBR
 14143*        DATASET    (ERACCT2-DSID)
 14144*    END-EXEC
 14145     MOVE 0
 14146       TO DFHEIV11
 14147*    MOVE '&2                    $   #00012828' TO DFHEIV0
 14148     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14149     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14150     MOVE X'2020233030303132383238' TO DFHEIV0(25:11)
 14151     CALL 'kxdfhei1' USING DFHEIV0,
 14152           ERACCT2-DSID,
 14153           DFHEIV11,
 14154           DFHEIV99
 14155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14156
 14157     .
 14158 6500-exit.
 14159     exit.
 14160 6600-CHECK-AUTO-ACTIVITY.
 14161
 14162
 14163* EXEC CICS HANDLE CONDITION
 14164*        NOTFND   (6600-NOT-FOUND)
 14165*    END-EXEC.
 14166*    MOVE '"$I                   ! C #00012837' TO DFHEIV0
 14167     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14168     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14169     MOVE X'4320233030303132383337' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 266
* EL130.cbl
 14170     CALL 'kxdfhei1' USING DFHEIV0
 14171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14172
 14173
 14174     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14175     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14176     MOVE SPACES                     TO  CNTL-ACCESS.
 14177     MOVE +0                         TO  CNTL-SEQ-NO.
 14178
 14179     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14180
 14181     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14182         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14183                                         WS-LETTER-SW
 14184         GO TO 6600-EXIT
 14185     END-IF.
 14186
 14187     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14188         MOVE 'N'                     TO  WS-LETTER-SW
 14189     ELSE
 14190         MOVE 'Y'                     TO  WS-LETTER-SW
 14191     END-IF.
 14192
 14193     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14194     GO TO 6600-EXIT.
 14195
 14196 6600-START-AUTO-LETTER-WRITER.
 14197
 14198     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14199     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14200
 14201     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14202
 14203     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14204         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14205         MOVE '6'                     TO  DC-OPTION-CODE
 14206         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14207         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14208         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14209         IF NO-CONVERSION-ERROR
 14210             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14211         ELSE
 14212             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14213         END-IF
 14214     END-IF.
 14215
 14216     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
 14217         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14218         MOVE '6'                     TO  DC-OPTION-CODE
 14219         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14220         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14221         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14222         IF NO-CONVERSION-ERROR
 14223             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14224         ELSE
 14225             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14226         END-IF
 14227     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 267
* EL130.cbl
 14228
 14229
 14230
 14231* EXEC CICS LINK
 14232*        PROGRAM    (LINK-1523)
 14233*        COMMAREA   (W-1523-LINKDATA)
 14234*        LENGTH     (W-1523-COMM-LENGTH)
 14235*    END-EXEC.
 14236*    MOVE '."C                   (   #00012897' TO DFHEIV0
 14237     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14239     MOVE X'2020233030303132383937' TO DFHEIV0(25:11)
 14240     CALL 'kxdfhei1' USING DFHEIV0,
 14241           LINK-1523,
 14242           W-1523-LINKDATA,
 14243           W-1523-COMM-LENGTH,
 14244           DFHEIV99,
 14245           DFHEIV99,
 14246           DFHEIV99,
 14247           DFHEIV99
 14248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14249
 14250
 14251     GO TO 6600-EXIT.
 14252
 14253 6600-NOT-FOUND.
 14254     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14255
 14256 6600-EXIT.
 14257     EXIT.
 14258
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 268
* EL130.cbl
 14259/
 14260*************************************************************
 14261*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14262*************************************************************
 14263
 14264 6700-OUTPUT-ACTIVITY-RECORD.
 14265
 14266
 14267
 14268* EXEC CICS GETMAIN
 14269*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14270*        LENGTH (DLYACTV-LENGTH)
 14271*        INITIMG (WS-BLANK)
 14272*    END-EXEC.
 14273*    MOVE ',"IL                  $   #00012919' TO DFHEIV0
 14274     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14275     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14276     MOVE X'2020233030303132393139' TO DFHEIV0(25:11)
 14277     CALL 'kxdfhei1' USING DFHEIV0,
 14278           DFHEIV20,
 14279           DLYACTV-LENGTH,
 14280           WS-BLANK
 14281     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14282         DFHEIV20
 14283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14284
 14285
 14286     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14287     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14288     MOVE CLMCARRI               TO DA-CARRIER.
 14289     IF CLMNOL EQUAL ZERO
 14290         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14291     ELSE
 14292         MOVE CLMNOI             TO DA-CLAIM-NO
 14293     END-IF.
 14294     MOVE CERTNOI                TO DA-CERT-PRIME.
 14295     MOVE SUFXI                  TO DA-CERT-SFX.
 14296     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14297     MOVE 'A'                    TO DA-RECORD-TYPE.
 14298
 14299
 14300* EXEC CICS HANDLE CONDITION
 14301*        NOTOPEN (6700-NOTOPEN-ERROR)
 14302*        DUPREC (6700-EXIT)
 14303*    END-EXEC.
 14304*    MOVE '"$J%                  ! D #00012938' TO DFHEIV0
 14305     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14307     MOVE X'4420233030303132393338' TO DFHEIV0(25:11)
 14308     CALL 'kxdfhei1' USING DFHEIV0
 14309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14310
 14311
 14312
 14313* EXEC CICS WRITE
 14314*        DATASET (DLYACTV-DSID)
 14315*        RIDFLD (DA-KEY)
 14316*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 269
* EL130.cbl
 14317*        LENGTH (DLYACTV-LENGTH)
 14318*    END-EXEC.
 14319*    MOVE '&$ L                  ''   #00012943' TO DFHEIV0
 14320     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14321     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14322     MOVE X'2020233030303132393433' TO DFHEIV0(25:11)
 14323     CALL 'kxdfhei1' USING DFHEIV0,
 14324           DLYACTV-DSID,
 14325           DAILY-ACTIVITY-RECORD,
 14326           DLYACTV-LENGTH,
 14327           DA-KEY,
 14328           DFHEIV99,
 14329           DFHEIV99
 14330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14331
 14332     GO TO 6700-EXIT.
 14333
 14334 6700-NOTOPEN-ERROR.
 14335     MOVE '2955'                 TO EMI-ERROR.
 14336     MOVE -1                     TO MAINTL.
 14337     MOVE AL-UANON               TO MAINTA.
 14338     PERFORM 9900-ERROR-FORMAT THRU
 14339             9900-EXIT.
 14340     GO TO 8200-SEND-DATAONLY.
 14341
 14342 6700-EXIT.
 14343     EXIT.
 14344
 14345*************************************************************
 14346*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14347*************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 270
* EL130.cbl
 14348/
 14349 6990-DEEDIT-DATE.
 14350
 14351
 14352* EXEC CICS BIF DEEDIT
 14353*        FIELD   (DATE-WORK)
 14354*        LENGTH  (8)
 14355*    END-EXEC.
 14356     MOVE 8
 14357       TO DFHEIV11
 14358*    MOVE '@"L                   #   #00012968' TO DFHEIV0
 14359     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14360     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14361     MOVE X'2020233030303132393638' TO DFHEIV0(25:11)
 14362     CALL 'kxdfhei1' USING DFHEIV0,
 14363           DATE-WORK,
 14364           DFHEIV11
 14365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14366
 14367 6990-EXIT.
 14368     EXIT.
 14369
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 271
* EL130.cbl
 14371 7000-BUILD-OUTPUT-MAP.
 14372
 14373     IF CLAIM-SWITCH = 'N'
 14374         GO TO 7050-BUILD-MAP-CERT-DATA
 14375     END-IF.
 14376
 14377     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14378         MOVE SPACES                 TO SEQUO
 14379         MOVE AL-SABOF               TO SEQUA
 14380     ELSE
 14381         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14382         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14383         MOVE WS-CLAIM-SEQU          TO SEQUO
 14384         MOVE AL-SABON               TO SEQUA
 14385     END-IF.
 14386
 14387     MOVE CL-CARRIER             TO CLMCARRO.
 14388     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14389     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14390     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14391     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14392     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14393     MOVE CL-INSURED-MID-INIT    TO INITO.
 14394     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14395     move cl-insured-type        to instypeo
 14396*    MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14397
 14398     MOVE AL-UANON               TO CLMCARRA
 14399                                    CLMTYPEA
 14400                                    PCERTNOA
 14401                                    PSUFXA
 14402                                    LSTNMEA
 14403                                    FSTNMEA
 14404                                    INITA
 14405                                    SEXA
 14406
 14407     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14408
 14409     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14410         MOVE ' '                 TO DC-OPTION-CODE
 14411         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14412         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14413         IF NOT DATE-CONVERSION-ERROR
 14414             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14415             MOVE AL-UANON            TO BIRTHDTA
 14416         END-IF
 14417     END-IF.
 14418
 14419     MOVE CL-SOC-SEC-NO          TO SSNO.
 14420     MOVE AL-UANON               TO SSNA.
 14421
 14422     IF CL-INCURRED-DT NOT = LOW-VALUES
 14423         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14424         MOVE ' '                TO DC-OPTION-CODE
 14425         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14426         IF NOT DATE-CONVERSION-ERROR
 14427             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14428             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 272
* EL130.cbl
 14429         END-IF
 14430     END-IF.
 14431
 14432     IF CL-REPORTED-DT NOT = LOW-VALUES
 14433         MOVE ' '                TO DC-OPTION-CODE
 14434         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14435         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14436         IF NOT DATE-CONVERSION-ERROR
 14437             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14438             MOVE AL-UANON            TO REPORTA
 14439         END-IF
 14440     END-IF.
 14441
 14442*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14443*        MOVE ' '                 TO DC-OPTION-CODE
 14444*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14445*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14446*        IF NOT DATE-CONVERSION-ERROR
 14447*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14448*            MOVE AL-UANON            TO ESTENDA
 14449*        END-IF
 14450*    END-IF.
 14451
 14452     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14453     MOVE WS-ICD-CODE-1          TO ICD1O.
 14454     MOVE WS-ICD-CODE-2          TO ICD2O.
 14455*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14456     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14457     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14458     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14459     MOVE CL-PRIORITY-CD         TO PRICDO.
 14460     MOVE AL-UANON               TO DIAGA
 14461                                    ICD1A
 14462                                    ICD2A
 14463*                                   CAUSEA
 14464                                    RELCLMA
 14465                                    PROCCDA
 14466                                    PRICDA.
 14467     MOVE AL-UNNON               TO MANRSVA.
 14468
 14469*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14470*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14471*        MOVE AL-UANON               TO PRODCDA
 14472*    END-IF.
 14473
 14474     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14475     MOVE CL-FILE-LOCATION       TO FILETOO.
 14476     MOVE CL-BENEFICIARY         TO BENECDO.
 14477     MOVE AL-UANON               TO SUPVA
 14478                                    FILETOA
 14479                                    BENECDA.
 14480
 14481     IF CLAIM-SWITCH = 'X'
 14482         GO TO 7099-EXIT
 14483     END-IF.
 14484
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 273
* EL130.cbl
 14486 7050-BUILD-MAP-CERT-DATA.
 14487     MOVE CM-CERT-PRIME          TO CERTNOO.
 14488     MOVE CM-CERT-SFX            TO SUFXO.
 14489     MOVE AL-SANON               TO CERTNOA
 14490                                    SUFXA.
 14491
 14492     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14493         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14494         MOVE ' '                TO DC-OPTION-CODE
 14495         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14496         IF NOT DATE-CONVERSION-ERROR
 14497             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14498         END-IF
 14499     END-IF.
 14500
 14501     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14502     MOVE CM-STATE               TO STATEO.
 14503     MOVE CM-CARRIER             TO CRTCARRO.
 14504     MOVE CM-GROUPING            TO GROUPO.
 14505     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14506     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14507     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14508     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14509     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14510     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14511     MOVE CM-JT-INITIAL          TO JNTINITO.
 14512     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14513     MOVE AL-UANON               TO ACCOUNTA
 14514                                    STATEA
 14515                                    CRTCARRA
 14516                                    GROUPA
 14517                                    CRTLNMEA
 14518                                    CRTFNMEA
 14519                                    CRTINITA
 14520                                    JNTLNMEA
 14521                                    JNTFNMEA
 14522                                    JNTINITA.
 14523     MOVE AL-UNNON               TO ISSAGEA
 14524                                    JNTAGEA.
 14525
 14526     IF CM-SSN-STATE   = CM-STATE AND
 14527        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14528*        NEXT SENTENCE
 14529         CONTINUE
 14530     ELSE
 14531         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14532     END-IF.
 14533
 14534     MOVE AL-UANON               TO CRTSSNA.
 14535
 14536     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14537     MOVE '2'                    TO DC-OPTION-CODE.
 14538     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14539     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14540
 14541*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14542     MOVE SPACES                 TO ELCNTL-KEY.
 14543     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 274
* EL130.cbl
 14544     MOVE '3'                    TO CNTL-REC-TYPE.
 14545     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14546     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14547
 14548
 14549
 14550* EXEC CICS READ
 14551*        DATASET  (ELCNTL-DSID)
 14552*        SET      (ADDRESS OF CONTROL-FILE)
 14553*        RIDFLD   (ELCNTL-KEY)
 14554*        RESP     (WS-RESPONSE)
 14555*    END-EXEC.
 14556*    MOVE '&"S        E          (  N#00013154' TO DFHEIV0
 14557     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14558     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14559     MOVE X'204E233030303133313534' TO DFHEIV0(25:11)
 14560     CALL 'kxdfhei1' USING DFHEIV0,
 14561           ELCNTL-DSID,
 14562           DFHEIV20,
 14563           DFHEIV99,
 14564           ELCNTL-KEY,
 14565           DFHEIV99,
 14566           DFHEIV99,
 14567           DFHEIV99
 14568     SET ADDRESS OF CONTROL-FILE TO
 14569         DFHEIV20
 14570     MOVE EIBRESP  TO WS-RESPONSE
 14571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14572
 14573
 14574     IF WS-RESP-NOTFND
 14575          MOVE ER-2848           TO EMI-ERROR
 14576          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14577          GO TO 8100-SEND-INITIAL-MAP
 14578     END-IF.
 14579
 14580     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14581     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14582     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 275
* EL130.cbl
 14584     IF CM-LF-BENEFIT-CD = '00'
 14585         MOVE ZEROS              TO LCVOTRMO
 14586                                    LCVRTRMO
 14587                                    LCVRATEO
 14588                                    LCVBENEO
 14589         MOVE SPACES             TO LCVDSCRO
 14590                                    LCVCDO
 14591                                    LCVKINDO
 14592                                    LCVFORMO
 14593                                    LCVCNDTO
 14594                                    LCVEXITO
 14595                                    LCVSTATO
 14596         IF CLMTYPEL GREATER THAN ZERO AND
 14597            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14598                MOVE ER-0521     TO EMI-ERROR
 14599                MOVE AL-UABON    TO CLMTYPEA
 14600                MOVE -1          TO CLMTYPEL
 14601                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14602                GO TO 7060-FILL-AH-COVERAGE
 14603         ELSE
 14604             GO TO 7060-FILL-AH-COVERAGE
 14605         END-IF
 14606     END-IF.
 14607
 14608     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14609     MOVE AL-UANON               TO LCVDSCRA.
 14610     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14611     MOVE '4'                    TO WS-REC-TYPE.
 14612     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14613     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14614     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14615     MOVE AL-UANON               TO LCVCDA.
 14616     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14617                                    CP-ORIGINAL-TERM.
 14618     MOVE AL-UNNON               TO LCVOTRMA.
 14619     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14620     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14621     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14622     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14623     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14624     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14625
 14626     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14627     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14628
 14629     IF CM-LF-PREMIUM-RATE NUMERIC
 14630         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14631     ELSE
 14632         MOVE ZEROS              TO LCVRATEO
 14633     END-IF.
 14634
 14635     MOVE AL-UNNON               TO LCVRATEA.
 14636
 14637     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14638         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14639     END-IF.
 14640
 14641     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 276
* EL130.cbl
 14642
 14643     MOVE AL-UNNON               TO LCVBENEA.
 14644
 14645     IF CM-POLICY-FORM-NO NOT = SPACES
 14646         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14647     ELSE
 14648         MOVE WS-FORM-HOLD       TO LCVFORMO
 14649     END-IF.
 14650
 14651     MOVE SPACES                 TO WS-FORM-HOLD.
 14652     MOVE 'L'                    TO WS-REC-TYPE.
 14653     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14654
 14655     IF WS-FORM-HOLD NOT = SPACES
 14656         MOVE WS-FORM-HOLD       TO LCVFORMO
 14657         MOVE AL-UANON           TO LCVFORMA
 14658     END-IF.
 14659
 14660     IF CM-LF-CURRENT-STATUS = '8'
 14661         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14662             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14663             MOVE ' '             TO DC-OPTION-CODE
 14664             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14665             IF NOT DATE-CONVERSION-ERROR
 14666                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14667                 MOVE AL-UANON            TO LCVCNDTA
 14668             END-IF
 14669         END-IF
 14670     END-IF.
 14671
 14672     IF CM-LF-CURRENT-STATUS = '7'
 14673         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14674             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 14675             MOVE ' '            TO DC-OPTION-CODE
 14676             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14677             IF NOT DATE-CONVERSION-ERROR
 14678                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14679                 MOVE AL-UANON   TO LCVCNDTA
 14680             END-IF
 14681         END-IF
 14682     END-IF.
 14683
 14684     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14685         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 14686             MOVE ' '            TO DC-OPTION-CODE
 14687             MOVE CM-LF-DEATH-EXIT-DT
 14688                                 TO DC-BIN-DATE-1
 14689             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14690             IF NOT DATE-CONVERSION-ERROR
 14691                 MOVE DC-GREG-DATE-1-EDIT
 14692                                 TO LCVEXITO
 14693             END-IF
 14694         END-IF
 14695     END-IF.
 14696
 14697     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14698         IF CP-REMAINING-TERM-3 = ZEROS
 14699             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 277
* EL130.cbl
 14700         ELSE
 14701             MOVE 'ACTIVE'       TO LCVSTATO
 14702         END-IF
 14703     END-IF.
 14704
 14705     IF CM-LF-CURRENT-STATUS = '2'
 14706        MOVE 'PEND  '            TO LCVSTATO
 14707     END-IF.
 14708     IF CM-LF-CURRENT-STATUS = '3'
 14709        MOVE 'RESTORE'           TO LCVSTATO
 14710     END-IF.
 14711     IF CM-LF-CURRENT-STATUS = '5'
 14712        MOVE 'REISSUE'           TO LCVSTATO
 14713     END-IF.
 14714     IF CM-LF-CURRENT-STATUS = '6'
 14715        MOVE 'LMP DIS'           TO LCVSTATO
 14716     END-IF.
 14717     IF CM-LF-CURRENT-STATUS = '7'
 14718        MOVE 'DEATH  '           TO LCVSTATO
 14719     END-IF.
 14720     IF CM-LF-CURRENT-STATUS = '8'
 14721        MOVE 'CANCEL '           TO LCVSTATO
 14722     END-IF.
 14723     IF CM-LF-CURRENT-STATUS = '9'
 14724        MOVE 'RE-ONLY'           TO LCVSTATO
 14725     END-IF.
 14726     IF CM-LF-CURRENT-STATUS = 'V'
 14727        MOVE 'VOID   '           TO LCVSTATO
 14728     END-IF.
 14729     IF CM-LF-CURRENT-STATUS = 'D'
 14730        MOVE 'DECLINE'           TO LCVSTATO
 14731     END-IF.
 14732
 14733     IF PI-COMPANY-ID = 'CID'
 14734         IF CM-LF-BENEFIT-CD >= '2O' AND
 14735            CM-LF-BENEFIT-CD <= '2V'
 14736             MOVE ER-0878       TO EMI-ERROR
 14737             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14738         END-IF
 14739     END-IF.
 14740
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 278
* EL130.cbl
 14742 7060-FILL-AH-COVERAGE.
 14743
 14744     IF CM-AH-BENEFIT-CD = '00'
 14745         MOVE ZEROS              TO ACVOTRMO
 14746                                    ACVRTRMO
 14747                                    ACVRATEO
 14748                                    ACVBENEO
 14749         MOVE SPACES             TO ACVDSCRO
 14750                                    ACVCDO
 14751                                    ACVKINDO
 14752                                    ACVFORMO
 14753                                    ACVCNDTO
 14754                                    ACVEXITO
 14755                                    ACVSTATO
 14756         IF (CLMTYPEL GREATER THAN ZERO AND
 14757             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 14758             MOVE ER-0521     TO EMI-ERROR
 14759             MOVE AL-UABON    TO CLMTYPEA
 14760             MOVE -1          TO CLMTYPEL
 14761             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14762             GO TO 7070-BUILD-MAP-FINISH
 14763         ELSE
 14764             GO TO 7070-BUILD-MAP-FINISH
 14765         END-IF
 14766     END-IF.
 14767
 14768     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14769     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 14770     MOVE AL-UANON               TO ACVDSCRA
 14771                                    ACVCDA.
 14772     MOVE '5'                    TO WS-REC-TYPE.
 14773     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14774     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 14775
 14776     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 14777                                    CP-ORIGINAL-TERM.
 14778     MOVE AL-UNNON               TO ACVOTRMA.
 14779
 14780     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14781     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14782     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14783     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14784     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14785     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14786
 14787     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14788     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14789
 14790     IF CM-AH-PREMIUM-RATE NUMERIC
 14791         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14792     ELSE
 14793         MOVE ZEROS              TO ACVRATEO
 14794     END-IF.
 14795
 14796     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 14797     MOVE AL-UNNON               TO ACVRATEA
 14798                                    ACVBENEA.
 14799
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 279
* EL130.cbl
 14800     IF CM-POLICY-FORM-NO NOT = SPACES
 14801         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 14802     ELSE
 14803         MOVE WS-FORM-HOLD       TO ACVFORMO
 14804         MOVE SPACES TO WS-FORM-HOLD
 14805         MOVE 'A'                TO WS-REC-TYPE
 14806         PERFORM 7400-READ-STATE THRU 7499-EXIT
 14807         IF WS-FORM-HOLD NOT = SPACES
 14808             MOVE WS-FORM-HOLD   TO ACVFORMO
 14809         END-IF
 14810     END-IF.
 14811
 14812     MOVE AL-UANON               TO ACVFORMA.
 14813
 14814     IF CM-AH-CURRENT-STATUS = '8'
 14815         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 14816             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14817             MOVE ' '             TO DC-OPTION-CODE
 14818             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14819             IF NOT DATE-CONVERSION-ERROR
 14820                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14821                MOVE AL-UANON    TO ACVCNDTA
 14822             END-IF
 14823         END-IF
 14824     END-IF.
 14825
 14826     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14827         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14828             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 14829             MOVE ' '             TO DC-OPTION-CODE
 14830             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14831             IF NOT DATE-CONVERSION-ERROR
 14832                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14833                MOVE AL-UANON            TO ACVCNDTA
 14834             END-IF
 14835         END-IF
 14836     END-IF.
 14837
 14838     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14839         MOVE ' '                TO DC-OPTION-CODE
 14840         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14841         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14842         IF NOT DATE-CONVERSION-ERROR
 14843             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 14844         END-IF
 14845     END-IF.
 14846
 14847     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14848         IF CP-REMAINING-TERM-3 = ZEROS
 14849             MOVE 'EXPIRED'      TO ACVSTATO
 14850         ELSE
 14851             MOVE 'ACTIVE'       TO ACVSTATO
 14852         END-IF
 14853     END-IF.
 14854
 14855     IF CM-AH-CURRENT-STATUS = '2'
 14856         MOVE 'PEND  '           TO ACVSTATO
 14857     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 280
* EL130.cbl
 14858     IF CM-AH-CURRENT-STATUS = '3'
 14859         MOVE 'RESTORE'          TO ACVSTATO
 14860     END-IF.
 14861     IF CM-AH-CURRENT-STATUS = '5'
 14862         MOVE 'REISSUE'          TO ACVSTATO
 14863     END-IF.
 14864     IF CM-AH-CURRENT-STATUS = '6'
 14865         MOVE 'LMP DIS'          TO ACVSTATO
 14866     END-IF.
 14867     IF CM-AH-CURRENT-STATUS = '7'
 14868         MOVE 'DEATH  '          TO ACVSTATO
 14869     END-IF.
 14870     IF CM-AH-CURRENT-STATUS = '8'
 14871         MOVE 'CANCEL '          TO ACVSTATO
 14872     END-IF.
 14873     IF CM-AH-CURRENT-STATUS = '9'
 14874         MOVE 'RE-ONLY'          TO ACVSTATO
 14875     END-IF.
 14876     IF CM-AH-CURRENT-STATUS = 'V'
 14877         MOVE 'VOID   '          TO ACVSTATO
 14878     END-IF.
 14879     IF CM-AH-CURRENT-STATUS = 'D'
 14880         MOVE 'DECLINE'          TO ACVSTATO
 14881     END-IF.
 14882
 14883     IF PI-COMPANY-ID = 'DCC'
 14884        IF CM-ACCOUNT (9:2) = 'BI'
 14885           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 14886           MOVE CM-CARRIER       TO CTRLR-CARRIER
 14887           MOVE CM-GROUPING      TO CTRLR-GROUPING
 14888           MOVE CM-STATE         TO CTRLR-STATE
 14889           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 14890           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 14891           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 14892           MOVE 'C'              TO CTRLR-REC-TYPE
 14893
 14894* EXEC CICS READ
 14895*            DATASET  (ELCRTT-DSID)
 14896*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 14897*            RIDFLD   (ELCRTT-KEY)
 14898*            RESP     (WS-RESPONSE)
 14899*          END-EXEC
 14900*    MOVE '&"S        E          (  N#00013480' TO DFHEIV0
 14901     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14902     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14903     MOVE X'204E233030303133343830' TO DFHEIV0(25:11)
 14904     CALL 'kxdfhei1' USING DFHEIV0,
 14905           ELCRTT-DSID,
 14906           DFHEIV20,
 14907           DFHEIV99,
 14908           ELCRTT-KEY,
 14909           DFHEIV99,
 14910           DFHEIV99,
 14911           DFHEIV99
 14912     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 14913         DFHEIV20
 14914     MOVE EIBRESP  TO WS-RESPONSE
 14915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 281
* EL130.cbl
 14916           IF WS-RESP-NORMAL
 14917               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 14918               MOVE WS-DIAG-VIN-MSG TO DIAGO
 14919               MOVE AL-UANON        TO DIAGA
 14920           END-IF
 14921        END-IF
 14922     END-IF.
 14923
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 282
* EL130.cbl
 14925 7070-BUILD-MAP-FINISH.
 14926     MOVE CM-LOAN-APR            TO APRO.
 14927     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14928     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14929     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 14930     MOVE AL-UNNON               TO APRA
 14931                                    PMTFREQA.
 14932     MOVE AL-UANON               TO INDGRPA
 14933                                    PREMTYPA.
 14934
 14935     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 14936         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 14937         MOVE AL-UANON               TO REINCDA
 14938     END-IF.
 14939
 14940     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 14941*        NEXT SENTENCE
 14942         CONTINUE
 14943     ELSE
 14944         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 14945         MOVE ' '                TO DC-OPTION-CODE
 14946         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14947         IF NOT DATE-CONVERSION-ERROR
 14948             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 14949             MOVE AL-UANON            TO ADDONDTA
 14950         END-IF
 14951     END-IF.
 14952
 14953     IF CLAIM-SWITCH = 'N'
 14954         IF SEXL = ZEROS
 14955             MOVE CM-INSURED-SEX TO SEXO
 14956*            MOVE AL-UANON       TO SEXA
 14957         END-IF
 14958     END-IF.
 14959
 14960     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 14961         MOVE CM-MEMBER-NO       TO MEMBERO
 14962         MOVE AL-UANON           TO MEMBERA
 14963     END-IF.
 14964
 14965     IF MAINTI = 'A'
 14966         IF (LOANNOL = ZEROS OR
 14967             EIBAID = DFHPF5)
 14968             MOVE CM-LOAN-NUMBER TO LOANNOO
 14969             MOVE AL-UANON       TO LOANNOA
 14970         ELSE
 14971*            NEXT SENTENCE
 14972             CONTINUE
 14973         END-IF
 14974     ELSE
 14975         MOVE CM-LOAN-NUMBER     TO LOANNOO
 14976         MOVE AL-UANON           TO LOANNOA
 14977     END-IF.
 14978
 14979     IF MAINTI = 'A'
 14980         IF (LOANBALL = ZEROS OR
 14981             EIBAID = DFHPF5)
 14982             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 283
* EL130.cbl
 14983             MOVE AL-UNNON       TO LOANBALA
 14984         ELSE
 14985*            NEXT SENTENCE
 14986             CONTINUE
 14987         END-IF
 14988     ELSE
 14989         MOVE CM-LOAN-BALANCE    TO LOANBALO
 14990         MOVE AL-UNNON           TO LOANBALA
 14991     END-IF.
 14992
 14993     IF CM-PREMIUM-TYPE NOT = '3'
 14994         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 14995             PERFORM 7200-PROTECT-CERT-FIELDS
 14996         ELSE
 14997             PERFORM 7300-RESET-KEY-ATTRBS
 14998         END-IF
 14999     ELSE
 15000         PERFORM 7300-RESET-KEY-ATTRBS
 15001     END-IF.
 15002
 15003*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15004*        NEXT SENTENCE
 15005*        CONTINUE
 15006*    ELSE
 15007         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15008*    END-IF.
 15009
 15010 7099-EXIT.
 15011     EXIT.
 15012
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 284
* EL130.cbl
 15014 7100-READ-BENEFIT.
 15015
 15016
 15017* EXEC CICS HANDLE CONDITION
 15018*         NOTFND   (7120-NOT-FOUND)
 15019*    END-EXEC.
 15020*    MOVE '"$I                   ! E #00013586' TO DFHEIV0
 15021     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15022     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15023     MOVE X'4520233030303133353836' TO DFHEIV0(25:11)
 15024     CALL 'kxdfhei1' USING DFHEIV0
 15025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15026
 15027
 15028     MOVE SPACES                 TO ELCNTL-KEY.
 15029     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 15030     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 15031     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15032     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15033
 15034 7105-READ-FILE.
 15035     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 15036
 15037     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 15038        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 15039          GO TO 7120-NOT-FOUND
 15040     END-IF.
 15041
 15042     MOVE 1                      TO SUB.
 15043 7110-LOOP.
 15044     IF SUB = 9
 15045         GO TO 7120-NOT-FOUND
 15046     END-IF.
 15047
 15048     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 15049         ADD 1                   TO SUB
 15050         GO TO 7110-LOOP
 15051     END-IF.
 15052
 15053     if ws-rec-type = '4'
 15054        move cf-joint-indicator (sub)
 15055                                 to ws-lf-joint-indicator
 15056     else
 15057        move cf-joint-indicator (sub)
 15058                                 to ws-ah-joint-indicator
 15059     end-if
 15060     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 15061     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 15062     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 15063
 15064     GO TO 7199-EXIT.
 15065
 15066 7120-NOT-FOUND.
 15067     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 15068                                    WS-FORM-HOLD.
 15069
 15070 7199-EXIT.
 15071      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 285
* EL130.cbl
 15072
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 286
* EL130.cbl
 15074 7200-PROTECT-CERT-FIELDS.
 15075     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15076                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15077                                LCVFORMA ACVFORMA JNTLNMEA
 15078                                JNTFNMEA JNTINITA.
 15079
 15080     IF CM-LF-CURRENT-STATUS = '2' OR
 15081        CM-AH-CURRENT-STATUS = '2'
 15082         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 15083     END-IF.
 15084
 15085     MOVE AL-SANOF TO
 15086            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 15087            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 15088            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 15089            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 15090            LCVRATEA   ACVRATEA.
 15091
 15092     MOVE 'S'                    TO CERTMTI.
 15093
 15094 7300-RESET-KEY-ATTRBS.
 15095     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15096                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15097                                LCVFORMA ACVFORMA JNTLNMEA
 15098                                JNTFNMEA JNTINITA.
 15099
 15100     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15101         MOVE AL-SANOF           TO REINCDA
 15102     END-IF.
 15103
 15104     MOVE 'S'                    TO CERTMTI.
 15105
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 287
* EL130.cbl
 15107 7400-READ-STATE.
 15108
 15109
 15110* EXEC CICS HANDLE CONDITION
 15111*         NOTFND   (7499-EXIT)
 15112*    END-EXEC.
 15113*    MOVE '"$I                   ! F #00013671' TO DFHEIV0
 15114     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15115     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15116     MOVE X'4620233030303133363731' TO DFHEIV0(25:11)
 15117     CALL 'kxdfhei1' USING DFHEIV0
 15118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15119
 15120
 15121     MOVE SPACES                 TO ELCNTL-KEY.
 15122     MOVE CM-STATE               TO CNTL-ACCESS.
 15123     MOVE '3'                    TO CNTL-REC-TYPE.
 15124     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15125     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15126
 15127     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15128
 15129     MOVE 1                      TO SUB.
 15130
 15131 7410-LOOP.
 15132     IF SUB = 21
 15133        GO TO 7499-EXIT
 15134     END-IF.
 15135
 15136*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15137*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15138*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15139*        GO TO 7499-EXIT.
 15140
 15141     ADD 1                       TO SUB.
 15142     GO TO 7410-LOOP.
 15143
 15144 7499-EXIT.
 15145      EXIT.
 15146
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 288
* EL130.cbl
 15148 7500-BROWSE-FOR-DUPLICATE.
 15149
 15150     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15151
 15152
 15153
 15154* EXEC CICS HANDLE CONDITION
 15155*        NOTFND   (7500-EXIT)
 15156*        DUPKEY   (7500-DUPLICATE-KEY)
 15157*        ENDFILE  (7500-EXIT)
 15158*    END-EXEC.
 15159*    MOVE '"$I$''                 ! G #00013707' TO DFHEIV0
 15160     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15162     MOVE X'4720233030303133373037' TO DFHEIV0(25:11)
 15163     CALL 'kxdfhei1' USING DFHEIV0
 15164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15165
 15166
 15167
 15168
 15169* EXEC CICS STARTBR
 15170*        DATASET    (ELMSTR5-DSID)
 15171*        RIDFLD     (ELMSTR5-KEY)
 15172*    END-EXEC.
 15173     MOVE 0
 15174       TO DFHEIV11
 15175*    MOVE '&,         G          &   #00013714' TO DFHEIV0
 15176     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15177     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15178     MOVE X'2020233030303133373134' TO DFHEIV0(25:11)
 15179     CALL 'kxdfhei1' USING DFHEIV0,
 15180           ELMSTR5-DSID,
 15181           ELMSTR5-KEY,
 15182           DFHEIV99,
 15183           DFHEIV11,
 15184           DFHEIV99
 15185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15186
 15187
 15188
 15189
 15190* EXEC CICS HANDLE CONDITION
 15191*        ENDFILE  (7500-END-BROWSE)
 15192*    END-EXEC.
 15193*    MOVE '"$''                   ! H #00013720' TO DFHEIV0
 15194     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15196     MOVE X'4820233030303133373230' TO DFHEIV0(25:11)
 15197     CALL 'kxdfhei1' USING DFHEIV0
 15198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15199
 15200
 15201 7500-READ-CLAIM-LOOP.
 15202
 15203
 15204
 15205* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 289
* EL130.cbl
 15206*        DATASET   (ELMSTR5-DSID)
 15207*        SET       (ADDRESS OF CLAIM-MASTER)
 15208*        RIDFLD    (ELMSTR5-KEY)
 15209*    END-EXEC.
 15210     MOVE 0
 15211       TO DFHEIV11
 15212*    MOVE '&.S                   )   #00013727' TO DFHEIV0
 15213     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15214     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15215     MOVE X'2020233030303133373237' TO DFHEIV0(25:11)
 15216     CALL 'kxdfhei1' USING DFHEIV0,
 15217           ELMSTR5-DSID,
 15218           DFHEIV20,
 15219           DFHEIV99,
 15220           ELMSTR5-KEY,
 15221           DFHEIV99,
 15222           DFHEIV11,
 15223           DFHEIV99,
 15224           DFHEIV99
 15225     SET ADDRESS OF CLAIM-MASTER TO
 15226         DFHEIV20
 15227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15228
 15229
 15230 7500-DUPLICATE-KEY.
 15231
 15232     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15233        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15234        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15235        CL-CERT-STATE     NOT = CM-STATE       OR
 15236        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15237        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15238        CL-CERT-NO        NOT = CM-CERT-NO
 15239           GO TO 7500-CHECK-MATCH-COUNT
 15240     END-IF.
 15241
 15242     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15243
 15244     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15245        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15246        GO TO 7500-END-BROWSE
 15247     ELSE
 15248        GO TO 7500-READ-CLAIM-LOOP
 15249     END-IF.
 15250
 15251 7500-CHECK-MATCH-COUNT.
 15252
 15253     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15254        CL-CERT-NO    = CM-CERT-NO
 15255          GO TO 7500-READ-CLAIM-LOOP
 15256     END-IF.
 15257
 15258 7500-END-BROWSE.
 15259
 15260
 15261
 15262* EXEC CICS ENDBR
 15263*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 290
* EL130.cbl
 15264*    END-EXEC.
 15265     MOVE 0
 15266       TO DFHEIV11
 15267*    MOVE '&2                    $   #00013764' TO DFHEIV0
 15268     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15269     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15270     MOVE X'2020233030303133373634' TO DFHEIV0(25:11)
 15271     CALL 'kxdfhei1' USING DFHEIV0,
 15272           ELMSTR5-DSID,
 15273           DFHEIV11,
 15274           DFHEIV99
 15275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15276
 15277
 15278 7500-EXIT.
 15279     EXIT.
 15280
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 291
* EL130.cbl
 15282 7550-FALL-THRU-PARA.
 15283
 15284
 15285
 15286* EXEC CICS DUMP
 15287*         DUMPCODE ('E130')
 15288*         TASK
 15289*    END-EXEC.
 15290     MOVE 'E130' TO DFHEIV5
 15291*    MOVE '<"   T                $   #00013775' TO DFHEIV0
 15292     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15293     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15294     MOVE X'2020233030303133373735' TO DFHEIV0(25:11)
 15295     CALL 'kxdfhei1' USING DFHEIV0,
 15296           DFHEIV5,
 15297           DFHEIV99,
 15298           DFHEIV99
 15299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15300
 15301
 15302
 15303
 15304* EXEC CICS RETURN
 15305*    END-EXEC.
 15306*    MOVE '.(                    ''   #00013781' TO DFHEIV0
 15307     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15308     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15309     MOVE X'2020233030303133373831' TO DFHEIV0(25:11)
 15310     CALL 'kxdfhei1' USING DFHEIV0,
 15311           DFHEIV99,
 15312           DFHEIV99,
 15313           DFHEIV99,
 15314           DFHEIV99,
 15315           DFHEIV99,
 15316           DFHEIV99
 15317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15318
 15319
 15320 7600-BROWSE-CLAIM.
 15321
 15322
 15323
 15324* EXEC CICS READ
 15325*        DATASET(ELMSTR-DSID)
 15326*        SET    (ADDRESS OF CLAIM-MASTER)
 15327*        RIDFLD (ELMSTR-KEY)
 15328*        GENERIC
 15329*        EQUAL
 15330*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15331*    END-EXEC.
 15332*    MOVE '&"S  KG    E          (   #00013787' TO DFHEIV0
 15333     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15335     MOVE X'2020233030303133373837' TO DFHEIV0(25:11)
 15336     CALL 'kxdfhei1' USING DFHEIV0,
 15337           ELMSTR-DSID,
 15338           DFHEIV20,
 15339           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 292
* EL130.cbl
 15340           ELMSTR-KEY,
 15341           ELMSTR-GENERIC-LENGTH,
 15342           DFHEIV99,
 15343           DFHEIV99
 15344     SET ADDRESS OF CLAIM-MASTER TO
 15345         DFHEIV20
 15346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15347
 15348
 15349     MOVE CL-CERT-PRIME          TO CERTNOI.
 15350     MOVE CL-CERT-SFX            TO SUFXI.
 15351
 15352 7610-BROWSE-CLAIM-LOOP.
 15353
 15354     MOVE LOW-VALUES             TO BCERT1O
 15355                                    BSUFX1O
 15356                                    BCERT2O
 15357                                    BSUFX2O
 15358                                    BCERT3O
 15359                                    BSUFX3O
 15360                                    BCERT4O
 15361                                    BSUFX4O
 15362                                    BCERT5O
 15363                                    BSUFX5O.
 15364
 15365     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15366
 15367
 15368
 15369* EXEC CICS HANDLE CONDITION
 15370*        ENDFILE  (7630-END-BROWSE)
 15371*    END-EXEC.
 15372*    MOVE '"$''                   ! I #00013815' TO DFHEIV0
 15373     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15375     MOVE X'4920233030303133383135' TO DFHEIV0(25:11)
 15376     CALL 'kxdfhei1' USING DFHEIV0
 15377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15378
 15379
 15380
 15381
 15382* EXEC CICS STARTBR
 15383*        DATASET    (ELMSTR-DSID)
 15384*        RIDFLD     (ELMSTR-KEY)
 15385*    END-EXEC.
 15386     MOVE 0
 15387       TO DFHEIV11
 15388*    MOVE '&,         G          &   #00013820' TO DFHEIV0
 15389     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15390     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15391     MOVE X'2020233030303133383230' TO DFHEIV0(25:11)
 15392     CALL 'kxdfhei1' USING DFHEIV0,
 15393           ELMSTR-DSID,
 15394           ELMSTR-KEY,
 15395           DFHEIV99,
 15396           DFHEIV11,
 15397           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 293
* EL130.cbl
 15398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15399
 15400
 15401     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15402
 15403 7620-READ-CLAIM-LOOP.
 15404
 15405
 15406
 15407* EXEC CICS READNEXT
 15408*        DATASET   (ELMSTR-DSID)
 15409*        SET       (ADDRESS OF CLAIM-MASTER)
 15410*        RIDFLD    (ELMSTR-KEY)
 15411*    END-EXEC.
 15412     MOVE 0
 15413       TO DFHEIV11
 15414*    MOVE '&.S                   )   #00013830' TO DFHEIV0
 15415     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15416     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15417     MOVE X'2020233030303133383330' TO DFHEIV0(25:11)
 15418     CALL 'kxdfhei1' USING DFHEIV0,
 15419           ELMSTR-DSID,
 15420           DFHEIV20,
 15421           DFHEIV99,
 15422           ELMSTR-KEY,
 15423           DFHEIV99,
 15424           DFHEIV11,
 15425           DFHEIV99,
 15426           DFHEIV99
 15427     SET ADDRESS OF CLAIM-MASTER TO
 15428         DFHEIV20
 15429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15430
 15431
 15432     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15433        CL-CARRIER     NOT = CLMCARRI       OR
 15434        CL-CLAIM-NO    NOT = CLMNOI
 15435          GO TO 7630-END-BROWSE
 15436     END-IF.
 15437
 15438     IF WS-ASSOCIATED-CERTS = 1
 15439         MOVE CL-CERT-PRIME      TO BCERT1O
 15440         MOVE CL-CERT-SFX        TO BSUFX1O
 15441     END-IF.
 15442
 15443     IF WS-ASSOCIATED-CERTS = 2
 15444         MOVE CL-CERT-PRIME      TO BCERT2O
 15445         MOVE CL-CERT-SFX        TO BSUFX2O
 15446     END-IF.
 15447
 15448     IF WS-ASSOCIATED-CERTS = 3
 15449         MOVE CL-CERT-PRIME      TO BCERT3O
 15450         MOVE CL-CERT-SFX        TO BSUFX3O
 15451     END-IF.
 15452
 15453     IF WS-ASSOCIATED-CERTS = 4
 15454         MOVE CL-CERT-PRIME      TO BCERT4O
 15455         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 294
* EL130.cbl
 15456     END-IF.
 15457
 15458     IF WS-ASSOCIATED-CERTS = 5
 15459         MOVE CL-CERT-PRIME      TO BCERT5O
 15460         MOVE CL-CERT-SFX        TO BSUFX5O
 15461     ELSE
 15462         ADD +1                  TO WS-ASSOCIATED-CERTS
 15463         GO TO 7620-READ-CLAIM-LOOP
 15464     END-IF.
 15465
 15466 7630-END-BROWSE.
 15467
 15468
 15469
 15470* EXEC CICS ENDBR
 15471*        DATASET   (ELMSTR-DSID)
 15472*    END-EXEC.
 15473     MOVE 0
 15474       TO DFHEIV11
 15475*    MOVE '&2                    $   #00013873' TO DFHEIV0
 15476     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15477     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15478     MOVE X'2020233030303133383733' TO DFHEIV0(25:11)
 15479     CALL 'kxdfhei1' USING DFHEIV0,
 15480           ELMSTR-DSID,
 15481           DFHEIV11,
 15482           DFHEIV99
 15483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15484
 15485
 15486 7640-HIGHLIGHT-CERT-DISPLAYED.
 15487
 15488     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15489     MOVE AL-SANON               TO BCERT1A
 15490                                    BSUFX1A
 15491                                    BCERT2A
 15492                                    BSUFX2A
 15493                                    BCERT3A
 15494                                    BSUFX3A
 15495                                    BCERT4A
 15496                                    BSUFX4A
 15497                                    BCERT5A
 15498                                    BSUFX5A.
 15499
 15500     IF BCERT1O = CERTNOI AND
 15501        BSUFX1O = SUFXI
 15502            MOVE AL-SABON        TO BCERT1A
 15503                                    BSUFX1A
 15504     END-IF.
 15505
 15506     IF BCERT2O = CERTNOI AND
 15507        BSUFX2O = SUFXI
 15508            MOVE AL-SABON        TO BCERT2A
 15509                                    BSUFX2A
 15510     END-IF.
 15511
 15512     IF BCERT3O = CERTNOI AND
 15513        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 295
* EL130.cbl
 15514            MOVE AL-SABON        TO BCERT3A
 15515                                    BSUFX3A
 15516     END-IF.
 15517
 15518     IF BCERT4O = CERTNOI AND
 15519        BSUFX4O = SUFXI
 15520            MOVE AL-SABON        TO BCERT4A
 15521                                    BSUFX4A
 15522     END-IF.
 15523
 15524     IF BCERT5O = CERTNOI AND
 15525        BSUFX5O = SUFXI
 15526            MOVE AL-SABON        TO BCERT5A
 15527                                    BSUFX5A
 15528     END-IF.
 15529
 15530 7699-EXIT.
 15531     EXIT.
 15532
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 296
* EL130.cbl
 15534 7700-CHECK-SEQUENCE.
 15535
 15536
 15537
 15538* EXEC CICS HANDLE CONDITION
 15539*        ENDFILE  (7799-EXIT)
 15540*        NOTFND   (7799-EXIT)
 15541*    END-EXEC.
 15542*    MOVE '"$''I                  ! J #00013928' TO DFHEIV0
 15543     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15544     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15545     MOVE X'4A20233030303133393238' TO DFHEIV0(25:11)
 15546     CALL 'kxdfhei1' USING DFHEIV0
 15547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15548
 15549
 15550
 15551
 15552* EXEC CICS READ
 15553*        DATASET(ELMSTR-DSID)
 15554*        SET    (ADDRESS OF CLAIM-MASTER)
 15555*        RIDFLD (ELMSTR-KEY)
 15556*        GENERIC
 15557*        EQUAL
 15558*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15559*    END-EXEC.
 15560*    MOVE '&"S  KG    E          (   #00013934' TO DFHEIV0
 15561     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15562     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15563     MOVE X'2020233030303133393334' TO DFHEIV0(25:11)
 15564     CALL 'kxdfhei1' USING DFHEIV0,
 15565           ELMSTR-DSID,
 15566           DFHEIV20,
 15567           DFHEIV99,
 15568           ELMSTR-KEY,
 15569           ELMSTR-GENERIC-LENGTH,
 15570           DFHEIV99,
 15571           DFHEIV99
 15572     SET ADDRESS OF CLAIM-MASTER TO
 15573         DFHEIV20
 15574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15575
 15576
 15577     COMPUTE WS-ASSOC-CERT-TOTAL =
 15578             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15579
 15580     GO TO 7799-EXIT.
 15581
 15582 7710-RESEQUENCE-CLAIMS.
 15583
 15584
 15585
 15586* EXEC CICS HANDLE CONDITION
 15587*        ENDFILE  (7790-END-BROWSE)
 15588*    END-EXEC.
 15589*    MOVE '"$''                   ! K #00013951' TO DFHEIV0
 15590     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 297
* EL130.cbl
 15592     MOVE X'4B20233030303133393531' TO DFHEIV0(25:11)
 15593     CALL 'kxdfhei1' USING DFHEIV0
 15594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15595
 15596
 15597
 15598
 15599* EXEC CICS STARTBR
 15600*        DATASET    (ELMSTR-DSID)
 15601*        RIDFLD     (ELMSTR-KEY)
 15602*    END-EXEC.
 15603     MOVE 0
 15604       TO DFHEIV11
 15605*    MOVE '&,         G          &   #00013956' TO DFHEIV0
 15606     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15607     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15608     MOVE X'2020233030303133393536' TO DFHEIV0(25:11)
 15609     CALL 'kxdfhei1' USING DFHEIV0,
 15610           ELMSTR-DSID,
 15611           ELMSTR-KEY,
 15612           DFHEIV99,
 15613           DFHEIV11,
 15614           DFHEIV99
 15615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15616
 15617
 15618     ADD +1 TO WS-ASSOC-CERT-SEQU
 15619               WS-READNEXT-SWITCH.
 15620
 15621 7720-READ-CLAIM-LOOP.
 15622
 15623
 15624
 15625* EXEC CICS READNEXT
 15626*        DATASET   (ELMSTR-DSID)
 15627*        SET       (ADDRESS OF CLAIM-MASTER)
 15628*        RIDFLD    (ELMSTR-KEY)
 15629*    END-EXEC.
 15630     MOVE 0
 15631       TO DFHEIV11
 15632*    MOVE '&.S                   )   #00013967' TO DFHEIV0
 15633     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15634     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15635     MOVE X'2020233030303133393637' TO DFHEIV0(25:11)
 15636     CALL 'kxdfhei1' USING DFHEIV0,
 15637           ELMSTR-DSID,
 15638           DFHEIV20,
 15639           DFHEIV99,
 15640           ELMSTR-KEY,
 15641           DFHEIV99,
 15642           DFHEIV11,
 15643           DFHEIV99,
 15644           DFHEIV99
 15645     SET ADDRESS OF CLAIM-MASTER TO
 15646         DFHEIV20
 15647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15648
 15649
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 298
* EL130.cbl
 15650     IF WS-READNEXT-SWITCH = 1
 15651         ADD 1 TO WS-READNEXT-SWITCH
 15652         GO TO 7720-READ-CLAIM-LOOP
 15653     END-IF.
 15654
 15655 7730-END-BROWSE.
 15656
 15657
 15658
 15659* EXEC CICS ENDBR
 15660*        DATASET   (ELMSTR-DSID)
 15661*    END-EXEC.
 15662     MOVE 0
 15663       TO DFHEIV11
 15664*    MOVE '&2                    $   #00013981' TO DFHEIV0
 15665     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15666     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15667     MOVE X'2020233030303133393831' TO DFHEIV0(25:11)
 15668     CALL 'kxdfhei1' USING DFHEIV0,
 15669           ELMSTR-DSID,
 15670           DFHEIV11,
 15671           DFHEIV99
 15672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15673
 15674
 15675 7740-READ-CLAIM-UPDATE.
 15676
 15677     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 15678        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 15679        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 15680          GO TO 7799-EXIT
 15681     ELSE
 15682          MOVE ZERO              TO WS-READNEXT-SWITCH
 15683     END-IF.
 15684
 15685
 15686
 15687* EXEC CICS READ
 15688*        DATASET(ELMSTR-DSID)
 15689*        SET    (ADDRESS OF CLAIM-MASTER)
 15690*        RIDFLD (ELMSTR-KEY)
 15691*        UPDATE
 15692*    END-EXEC.
 15693*    MOVE '&"S        EU         (   #00013996' TO DFHEIV0
 15694     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15695     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15696     MOVE X'2020233030303133393936' TO DFHEIV0(25:11)
 15697     CALL 'kxdfhei1' USING DFHEIV0,
 15698           ELMSTR-DSID,
 15699           DFHEIV20,
 15700           DFHEIV99,
 15701           ELMSTR-KEY,
 15702           DFHEIV99,
 15703           DFHEIV99,
 15704           DFHEIV99
 15705     SET ADDRESS OF CLAIM-MASTER TO
 15706         DFHEIV20
 15707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 299
* EL130.cbl
 15708
 15709
 15710     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15711     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15712
 15713
 15714
 15715* EXEC CICS REWRITE
 15716*         DATASET     (ELMSTR-DSID)
 15717*         FROM        (CLAIM-MASTER)
 15718*    END-EXEC.
 15719     MOVE LENGTH OF
 15720      CLAIM-MASTER
 15721       TO DFHEIV11
 15722*    MOVE '&& L                  %   #00014007' TO DFHEIV0
 15723     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15724     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15725     MOVE X'2020233030303134303037' TO DFHEIV0(25:11)
 15726     CALL 'kxdfhei1' USING DFHEIV0,
 15727           ELMSTR-DSID,
 15728           CLAIM-MASTER,
 15729           DFHEIV11,
 15730           DFHEIV99
 15731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15732
 15733
 15734     GO TO 7710-RESEQUENCE-CLAIMS.
 15735
 15736 7790-END-BROWSE.
 15737
 15738
 15739
 15740* EXEC CICS ENDBR
 15741*        DATASET   (ELMSTR-DSID)
 15742*    END-EXEC.
 15743     MOVE 0
 15744       TO DFHEIV11
 15745*    MOVE '&2                    $   #00014017' TO DFHEIV0
 15746     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15747     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15748     MOVE X'2020233030303134303137' TO DFHEIV0(25:11)
 15749     CALL 'kxdfhei1' USING DFHEIV0,
 15750           ELMSTR-DSID,
 15751           DFHEIV11,
 15752           DFHEIV99
 15753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15754
 15755
 15756 7799-EXIT.
 15757     EXIT.
 15758
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 300
* EL130.cbl
 15760************************************************
 15761*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 15762************************************************
 15763
 15764 7900-READ-ACTV-UPDATE.
 15765     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15766     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15767     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15768     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15769     MOVE +0                     TO TRLR-SEQ-NO.
 15770     MOVE '1'                    TO TRLR-TYPE.
 15771     GO TO 7900-READ-TRAILER-UPDATE.
 15772
 15773 7900-READ-NINETY-UPDATE.
 15774     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15775     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15776     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15777     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15778     MOVE +90                    TO TRLR-SEQ-NO.
 15779     MOVE '6'                    TO TRLR-TYPE.
 15780
 15781 7900-READ-TRAILER-UPDATE.
 15782
 15783
 15784* EXEC CICS READ  UPDATE
 15785*        DATASET    (ELTRLR-DSID)
 15786*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 15787*        RIDFLD     (ELTRLR-KEY)
 15788*    END-EXEC.
 15789*    MOVE '&"S        EU         (   #00014048' TO DFHEIV0
 15790     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15791     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15792     MOVE X'2020233030303134303438' TO DFHEIV0(25:11)
 15793     CALL 'kxdfhei1' USING DFHEIV0,
 15794           ELTRLR-DSID,
 15795           DFHEIV20,
 15796           DFHEIV99,
 15797           ELTRLR-KEY,
 15798           DFHEIV99,
 15799           DFHEIV99,
 15800           DFHEIV99
 15801     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15802         DFHEIV20
 15803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15804
 15805
 15806 7900-EXIT.
 15807      EXIT.
 15808
 15809 7910-READ-ACTV.
 15810     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15811     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15812     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15813     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15814     MOVE +0                     TO TRLR-SEQ-NO.
 15815     MOVE '1'                    TO TRLR-TYPE.
 15816     GO TO 7910-READ-TRAILER.
 15817
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 301
* EL130.cbl
 15818 7910-READ-NINETY.
 15819     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15820     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15821     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15822     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15823     MOVE +90                    TO TRLR-SEQ-NO.
 15824     MOVE '6'                    TO TRLR-TYPE.
 15825
 15826 7910-READ-TRAILER.
 15827     MOVE 'TRLR'                 TO FILE-SWITCH.
 15828
 15829
 15830
 15831* EXEC CICS READ
 15832*        DATASET   (ELTRLR-DSID)
 15833*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15834*        RIDFLD    (ELTRLR-KEY)
 15835*    END-EXEC.
 15836*    MOVE '&"S        E          (   #00014078' TO DFHEIV0
 15837     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15838     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15839     MOVE X'2020233030303134303738' TO DFHEIV0(25:11)
 15840     CALL 'kxdfhei1' USING DFHEIV0,
 15841           ELTRLR-DSID,
 15842           DFHEIV20,
 15843           DFHEIV99,
 15844           ELTRLR-KEY,
 15845           DFHEIV99,
 15846           DFHEIV99,
 15847           DFHEIV99
 15848     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15849         DFHEIV20
 15850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15851
 15852
 15853 7910-EXIT.
 15854      EXIT.
 15855
 15856 7915-REWRITE-TRAILER.
 15857
 15858
 15859* EXEC CICS REWRITE
 15860*        DATASET   (ELTRLR-DSID)
 15861*        FROM      (ACTIVITY-TRAILERS)
 15862*    END-EXEC.
 15863     MOVE LENGTH OF
 15864      ACTIVITY-TRAILERS
 15865       TO DFHEIV11
 15866*    MOVE '&& L                  %   #00014089' TO DFHEIV0
 15867     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15868     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15869     MOVE X'2020233030303134303839' TO DFHEIV0(25:11)
 15870     CALL 'kxdfhei1' USING DFHEIV0,
 15871           ELTRLR-DSID,
 15872           ACTIVITY-TRAILERS,
 15873           DFHEIV11,
 15874           DFHEIV99
 15875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 302
* EL130.cbl
 15876
 15877
 15878 7915-EXIT.
 15879      EXIT.
 15880
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 303
* EL130.cbl
 15882********************************************
 15883*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 15884********************************************
 15885
 15886 7920-READ-CLAIM-UPDATE.
 15887
 15888
 15889
 15890* EXEC CICS READ
 15891*        UPDATE
 15892*        DATASET   (ELMSTR-DSID)
 15893*        SET       (ADDRESS OF CLAIM-MASTER)
 15894*        RIDFLD    (ELMSTR-KEY)
 15895*    END-EXEC.
 15896*    MOVE '&"S        EU         (   #00014105' TO DFHEIV0
 15897     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15898     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15899     MOVE X'2020233030303134313035' TO DFHEIV0(25:11)
 15900     CALL 'kxdfhei1' USING DFHEIV0,
 15901           ELMSTR-DSID,
 15902           DFHEIV20,
 15903           DFHEIV99,
 15904           ELMSTR-KEY,
 15905           DFHEIV99,
 15906           DFHEIV99,
 15907           DFHEIV99
 15908     SET ADDRESS OF CLAIM-MASTER TO
 15909         DFHEIV20
 15910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15911
 15912
 15913 7920-EXIT.
 15914      EXIT.
 15915
 15916 7950-READ-CLAIM.
 15917
 15918
 15919* EXEC CICS READ
 15920*        DATASET   (ELMSTR-DSID)
 15921*        SET       (ADDRESS OF CLAIM-MASTER)
 15922*        RIDFLD    (ELMSTR-KEY)
 15923*    END-EXEC.
 15924*    MOVE '&"S        E          (   #00014117' TO DFHEIV0
 15925     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15926     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15927     MOVE X'2020233030303134313137' TO DFHEIV0(25:11)
 15928     CALL 'kxdfhei1' USING DFHEIV0,
 15929           ELMSTR-DSID,
 15930           DFHEIV20,
 15931           DFHEIV99,
 15932           ELMSTR-KEY,
 15933           DFHEIV99,
 15934           DFHEIV99,
 15935           DFHEIV99
 15936     SET ADDRESS OF CLAIM-MASTER TO
 15937         DFHEIV20
 15938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15939
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 304
* EL130.cbl
 15940
 15941 7950-EXIT.
 15942      EXIT.
 15943
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 305
* EL130.cbl
 15945***************************************
 15946*  I/O REQUESTS AGAINST CONTROL FILE  *
 15947***************************************
 15948
 15949 7960-READ-CNTL-UPDATE.
 15950
 15951
 15952* EXEC CICS READ
 15953*        UPDATE
 15954*        DATASET  (ELCNTL-DSID)
 15955*        SET      (ADDRESS OF CONTROL-FILE)
 15956*        RIDFLD   (ELCNTL-KEY)
 15957*    END-EXEC.
 15958*    MOVE '&"S        EU         (   #00014133' TO DFHEIV0
 15959     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15960     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15961     MOVE X'2020233030303134313333' TO DFHEIV0(25:11)
 15962     CALL 'kxdfhei1' USING DFHEIV0,
 15963           ELCNTL-DSID,
 15964           DFHEIV20,
 15965           DFHEIV99,
 15966           ELCNTL-KEY,
 15967           DFHEIV99,
 15968           DFHEIV99,
 15969           DFHEIV99
 15970     SET ADDRESS OF CONTROL-FILE TO
 15971         DFHEIV20
 15972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15973
 15974
 15975 7960-EXIT.
 15976      EXIT.
 15977
 15978 7970-READ-CNTL.
 15979
 15980
 15981* EXEC CICS READ
 15982*        DATASET  (ELCNTL-DSID)
 15983*        SET      (ADDRESS OF CONTROL-FILE)
 15984*        RIDFLD   (ELCNTL-KEY)
 15985*    END-EXEC.
 15986*    MOVE '&"S        E          (   #00014145' TO DFHEIV0
 15987     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15989     MOVE X'2020233030303134313435' TO DFHEIV0(25:11)
 15990     CALL 'kxdfhei1' USING DFHEIV0,
 15991           ELCNTL-DSID,
 15992           DFHEIV20,
 15993           DFHEIV99,
 15994           ELCNTL-KEY,
 15995           DFHEIV99,
 15996           DFHEIV99,
 15997           DFHEIV99
 15998     SET ADDRESS OF CONTROL-FILE TO
 15999         DFHEIV20
 16000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16001
 16002
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 306
* EL130.cbl
 16003 7970-EXIT.
 16004      EXIT.
 16005
 16006 7975-READ-CNTL-GTEQ.
 16007
 16008
 16009* EXEC CICS READ
 16010*         DATASET   (ELCNTL-DSID)
 16011*         SET       (ADDRESS OF CONTROL-FILE)
 16012*         RIDFLD    (ELCNTL-KEY)
 16013*         GTEQ
 16014*     END-EXEC.
 16015*    MOVE '&"S        G          (   #00014156' TO DFHEIV0
 16016     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16018     MOVE X'2020233030303134313536' TO DFHEIV0(25:11)
 16019     CALL 'kxdfhei1' USING DFHEIV0,
 16020           ELCNTL-DSID,
 16021           DFHEIV20,
 16022           DFHEIV99,
 16023           ELCNTL-KEY,
 16024           DFHEIV99,
 16025           DFHEIV99,
 16026           DFHEIV99
 16027     SET ADDRESS OF CONTROL-FILE TO
 16028         DFHEIV20
 16029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16030
 16031
 16032 7975-EXIT.
 16033      EXIT.
 16034
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 307
* EL130.cbl
 16036**************************************************
 16037*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 16038**************************************************
 16039
 16040 7980-READ-CERT5.
 16041
 16042
 16043* EXEC CICS READ
 16044*         DATASET  (ELCERT5-DSID)
 16045*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 16046*         RIDFLD   (ELCERT-KEY-5)
 16047*     END-EXEC.
 16048*    MOVE '&"S        E          (   #00014173' TO DFHEIV0
 16049     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16050     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16051     MOVE X'2020233030303134313733' TO DFHEIV0(25:11)
 16052     CALL 'kxdfhei1' USING DFHEIV0,
 16053           ELCERT5-DSID,
 16054           DFHEIV20,
 16055           DFHEIV99,
 16056           ELCERT-KEY-5,
 16057           DFHEIV99,
 16058           DFHEIV99,
 16059           DFHEIV99
 16060     SET ADDRESS OF CERTIFICATE-MASTER TO
 16061         DFHEIV20
 16062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16063
 16064
 16065 7980-EXIT.
 16066      EXIT.
 16067
 16068 7930-READ-CERT-UPDATE.
 16069
 16070
 16071* EXEC CICS READ
 16072*        DATASET  (ELCERT-DSID)
 16073*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16074*        RIDFLD   (ELCERT-KEY)
 16075*        UPDATE
 16076*    END-EXEC.
 16077*    MOVE '&"S        EU         (   #00014184' TO DFHEIV0
 16078     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16079     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16080     MOVE X'2020233030303134313834' TO DFHEIV0(25:11)
 16081     CALL 'kxdfhei1' USING DFHEIV0,
 16082           ELCERT-DSID,
 16083           DFHEIV20,
 16084           DFHEIV99,
 16085           ELCERT-KEY,
 16086           DFHEIV99,
 16087           DFHEIV99,
 16088           DFHEIV99
 16089     SET ADDRESS OF CERTIFICATE-MASTER TO
 16090         DFHEIV20
 16091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16092
 16093
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 308
* EL130.cbl
 16094 7930-EXIT.
 16095      EXIT.
 16096
 16097 7940-READ-CERT.
 16098
 16099
 16100* EXEC CICS READ
 16101*        DATASET  (ELCERT-DSID)
 16102*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16103*        RIDFLD   (ELCERT-KEY)
 16104*    END-EXEC.
 16105*    MOVE '&"S        E          (   #00014196' TO DFHEIV0
 16106     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16107     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16108     MOVE X'2020233030303134313936' TO DFHEIV0(25:11)
 16109     CALL 'kxdfhei1' USING DFHEIV0,
 16110           ELCERT-DSID,
 16111           DFHEIV20,
 16112           DFHEIV99,
 16113           ELCERT-KEY,
 16114           DFHEIV99,
 16115           DFHEIV99,
 16116           DFHEIV99
 16117     SET ADDRESS OF CERTIFICATE-MASTER TO
 16118         DFHEIV20
 16119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16120
 16121
 16122 7940-EXIT.
 16123      EXIT.
 16124
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 309
* EL130.cbl
 16126**************************************************
 16127*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16128**************************************************
 16129
 16130 7991-READ-BENE.
 16131
 16132
 16133* EXEC CICS READ
 16134*         DATASET   (ELBENE-DSID)
 16135*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16136*         RIDFLD    (ELBENE-KEY)
 16137*     END-EXEC.
 16138*    MOVE '&"S        E          (   #00014212' TO DFHEIV0
 16139     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16140     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16141     MOVE X'2020233030303134323132' TO DFHEIV0(25:11)
 16142     CALL 'kxdfhei1' USING DFHEIV0,
 16143           ELBENE-DSID,
 16144           DFHEIV20,
 16145           DFHEIV99,
 16146           ELBENE-KEY,
 16147           DFHEIV99,
 16148           DFHEIV99,
 16149           DFHEIV99
 16150     SET ADDRESS OF BENEFICIARY-MASTER TO
 16151         DFHEIV20
 16152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16153
 16154
 16155 7991-EXIT.
 16156      EXIT.
 16157
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 310
* EL130.cbl
 16159**************************************************
 16160*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16161**************************************************
 16162
 16163 7992-READ-REIN.
 16164
 16165
 16166
 16167* EXEC CICS HANDLE CONDITION
 16168*        NOTFND   (7992-NOT-FOUND)
 16169*    END-EXEC.
 16170*    MOVE '"$I                   ! L #00014229' TO DFHEIV0
 16171     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16173     MOVE X'4C20233030303134323239' TO DFHEIV0(25:11)
 16174     CALL 'kxdfhei1' USING DFHEIV0
 16175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16176
 16177
 16178
 16179
 16180* EXEC CICS READ
 16181*        DATASET   (ERREIN-DSID)
 16182*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16183*        RIDFLD    (ERREIN-KEY)
 16184*    END-EXEC.
 16185*    MOVE '&"S        E          (   #00014234' TO DFHEIV0
 16186     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16188     MOVE X'2020233030303134323334' TO DFHEIV0(25:11)
 16189     CALL 'kxdfhei1' USING DFHEIV0,
 16190           ERREIN-DSID,
 16191           DFHEIV20,
 16192           DFHEIV99,
 16193           ERREIN-KEY,
 16194           DFHEIV99,
 16195           DFHEIV99,
 16196           DFHEIV99
 16197     SET ADDRESS OF REINSURANCE-RECORD TO
 16198         DFHEIV20
 16199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16200
 16201
 16202     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16203
 16204     GO TO 7992-EXIT.
 16205
 16206 7992-NOT-FOUND.
 16207     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16208
 16209 7992-EXIT.
 16210     EXIT.
 16211
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 311
* EL130.cbl
 16213 8000-LOAD-ERROR-MESSAGES.
 16214     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16215
 16216     IF EMI-NO-ERRORS
 16217         GO TO 8000-EXIT
 16218     END-IF.
 16219
 16220     perform varying e1 from +1 by +1 until e1 > +3
 16221        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16222                                or '1655' or '1660'
 16223           move 'W'              to emi-severity (e1)
 16224        end-if
 16225     end-perform
 16226     IF EMI-NUMBER-OF-LINES = 1
 16227         MOVE EMI-LINE1          TO ERRMSG1O
 16228         GO TO 8000-EXIT
 16229     END-IF.
 16230
 16231     IF EMI-NUMBER-OF-LINES = 2
 16232          MOVE EMI-LINE1         TO ERRMSG1O
 16233          MOVE EMI-LINE2         TO ERRMSG2O
 16234          GO TO 8000-EXIT
 16235     END-IF.
 16236
 16237     MOVE EMI-LINE1              TO ERRMSG1O.
 16238
 16239 8000-EXIT.
 16240     EXIT.
 16241
 16242 8100-SEND-INITIAL-MAP.
 16243     MOVE SAVE-DATE              TO RUNDTEO.
 16244     MOVE EIBTIME                TO TIME-IN.
 16245     MOVE TIME-OUT               TO RUNTIMEO.
 16246     IF EIBAID = DFHPF11
 16247        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16248        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16249     end-if
 16250     IF RETURNED-FROM = XCTL-114
 16251        CONTINUE
 16252     ELSE
 16253        MOVE -1                  TO MAINTL
 16254     END-IF.
 16255
 16256*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16257         MOVE SPACES             TO PRODO.
 16258         MOVE AL-SANOF           TO PRODCDA.
 16259*    END-IF.
 16260
 16261     MOVE PI-COMPANY-ID          TO COMPO.
 16262     MOVE AL-PABOF               TO COMPA.
 16263     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16264     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16265     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16266
 16267     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16268
 16269     IF NOT PI-NO-CARRIER-SECURITY
 16270        MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 312
* EL130.cbl
 16271        MOVE AL-SABOF            TO CLMCARRA
 16272     END-IF.
 16273
 16274     IF PI-PROCESSOR-ID = 'PEMA'
 16275        MOVE AL-UANON            TO CERTNOA
 16276                                    SUFXA
 16277     END-IF.
 16278*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16279*        NEXT SENTENCE
 16280*        CONTINUE
 16281*    ELSE
 16282         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16283*    END-IF.
 16284
 16285
 16286
 16287* EXEC CICS SEND
 16288*        MAP     (MAP-NAME)
 16289*        MAPSET  (MAPSET-NAME)
 16290*        FROM    (EL130AO)
 16291*        ERASE
 16292*        CURSOR
 16293*    END-EXEC.
 16294     MOVE LENGTH OF
 16295      EL130AO
 16296       TO DFHEIV12
 16297     MOVE -1
 16298       TO DFHEIV11
 16299*    MOVE '8$     CT  E    H L F ,   #00014324' TO DFHEIV0
 16300     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16301     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16302     MOVE X'2020233030303134333234' TO DFHEIV0(25:11)
 16303     CALL 'kxdfhei1' USING DFHEIV0,
 16304           MAP-NAME,
 16305           EL130AO,
 16306           DFHEIV12,
 16307           MAPSET-NAME,
 16308           DFHEIV99,
 16309           DFHEIV99,
 16310           DFHEIV99,
 16311           DFHEIV11,
 16312           DFHEIV99,
 16313           DFHEIV99,
 16314           DFHEIV99
 16315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16316
 16317
 16318     GO TO 9100-RETURN-TRAN.
 16319
 16320 8150-SEND-MAP-CURSOR.
 16321     MOVE SAVE-DATE              TO RUNDTEO.
 16322     MOVE EIBTIME                TO TIME-IN.
 16323     MOVE TIME-OUT               TO RUNTIMEO.
 16324     IF EIBAID = DFHPF11
 16325        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16327     end-if
 16328     MOVE PI-COMPANY-ID          TO COMPO.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 313
* EL130.cbl
 16329     MOVE AL-PABOF               TO COMPA
 16330     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16331     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16332     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16333
 16334*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16335         MOVE SPACES             TO PRODO.
 16336         MOVE AL-SANOF           TO PRODCDA.
 16337*    END-IF.
 16338
 16339     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16340
 16341     IF NOT PI-NO-CARRIER-SECURITY
 16342         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16343         MOVE AL-SABOF            TO CLMCARRA
 16344     END-IF.
 16345
 16346     IF PI-PROCESSOR-ID = 'PEMA'
 16347        MOVE AL-UANON            TO CERTNOA
 16348                                    SUFXA
 16349     END-IF.
 16350*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16351*        NEXT SENTENCE
 16352*        CONTINUE
 16353*    ELSE
 16354         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16355*    END-IF.
 16356
 16357
 16358
 16359* EXEC CICS SEND
 16360*        MAP      (MAP-NAME)
 16361*        MAPSET   (MAPSET-NAME)
 16362*        FROM     (EL130AO)
 16363*        CURSOR   (PI-CURSOR)
 16364*        ERASE
 16365*    END-EXEC.
 16366     MOVE LENGTH OF
 16367      EL130AO
 16368       TO DFHEIV11
 16369*    MOVE '8$     CT  E    H L F ,   #00014372' TO DFHEIV0
 16370     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16371     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16372     MOVE X'2020233030303134333732' TO DFHEIV0(25:11)
 16373     CALL 'kxdfhei1' USING DFHEIV0,
 16374           MAP-NAME,
 16375           EL130AO,
 16376           DFHEIV11,
 16377           MAPSET-NAME,
 16378           DFHEIV99,
 16379           DFHEIV99,
 16380           DFHEIV99,
 16381           PI-CURSOR,
 16382           DFHEIV99,
 16383           DFHEIV99,
 16384           DFHEIV99
 16385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16386
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 314
* EL130.cbl
 16387
 16388     GO TO 9100-RETURN-TRAN.
 16389
 16390 8200-SEND-DATAONLY.
 16391     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16392
 16393     IF EIBAID = DFHPF11
 16394        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16395        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16396        go to 8100-send-initial-map
 16397     end-if
 16398*    IF EIBAID = DFHPF11
 16399*       MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16400*       move pi-last-claim       to emi-claim-no
 16401*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16402*       go to 8100-send-initial-map
 16403*    END-IF.
 16404     .
 16405 8200-BYPASS-ERROR.
 16406     MOVE SAVE-DATE              TO RUNDTEO.
 16407     MOVE EIBTIME                TO TIME-IN.
 16408     MOVE TIME-OUT               TO RUNTIMEO.
 16409     MOVE PI-COMPANY-ID          TO COMPO.
 16410     MOVE AL-PABOF               TO COMPA
 16411     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16412
 16413*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16414         MOVE SPACES             TO PRODO.
 16415         MOVE AL-SANOF           TO PRODCDA.
 16416*    END-IF.
 16417
 16418     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16419     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16420
 16421     IF PI-PROCESSOR-ID = 'PEMA'
 16422        MOVE AL-UANON            TO CERTNOA
 16423                                    SUFXA
 16424     END-IF.
 16425     IF NOT PI-NO-CARRIER-SECURITY
 16426        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16427        MOVE AL-SABOF            TO CLMCARRA
 16428     END-IF.
 16429
 16430*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16431*        NEXT SENTENCE
 16432*        CONTINUE
 16433*    ELSE
 16434         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16435*    END-IF.
 16436
 16437*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16438         MOVE AL-SANOF           TO PRODCDA.
 16439*    END-IF.
 16440
 16441
 16442
 16443* EXEC CICS SEND
 16444*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 315
* EL130.cbl
 16445*        MAPSET   (MAPSET-NAME)
 16446*        FROM     (EL130AO)
 16447*        DATAONLY
 16448*        CURSOR
 16449*    END-EXEC.
 16450     MOVE LENGTH OF
 16451      EL130AO
 16452       TO DFHEIV12
 16453     MOVE -1
 16454       TO DFHEIV11
 16455*    MOVE '8$D    CT       H L F ,   #00014434' TO DFHEIV0
 16456     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16457     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16458     MOVE X'2020233030303134343334' TO DFHEIV0(25:11)
 16459     CALL 'kxdfhei1' USING DFHEIV0,
 16460           MAP-NAME,
 16461           EL130AO,
 16462           DFHEIV12,
 16463           MAPSET-NAME,
 16464           DFHEIV99,
 16465           DFHEIV99,
 16466           DFHEIV99,
 16467           DFHEIV11,
 16468           DFHEIV99,
 16469           DFHEIV99,
 16470           DFHEIV99
 16471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16472
 16473
 16474     GO TO 9100-RETURN-TRAN.
 16475
 16476 8300-SEND-TEXT.
 16477
 16478
 16479* EXEC CICS SEND TEXT
 16480*        FROM     (LOGOFF-TEXT)
 16481*        LENGTH   (LOGOFF-LENGTH)
 16482*        ERASE
 16483*        FREEKB
 16484*    END-EXEC.
 16485*    MOVE '8&      T  E F  H   F -   #00014446' TO DFHEIV0
 16486     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16487     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16488     MOVE X'2020233030303134343436' TO DFHEIV0(25:11)
 16489     CALL 'kxdfhei1' USING DFHEIV0,
 16490           LOGOFF-TEXT,
 16491           LOGOFF-LENGTH,
 16492           DFHEIV99,
 16493           DFHEIV99,
 16494           DFHEIV99,
 16495           DFHEIV99,
 16496           DFHEIV99,
 16497           DFHEIV99,
 16498           DFHEIV99,
 16499           DFHEIV99,
 16500           DFHEIV99,
 16501           DFHEIV99
 16502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 316
* EL130.cbl
 16503
 16504
 16505
 16506
 16507* EXEC CICS RETURN
 16508*    END-EXEC.
 16509*    MOVE '.(                    ''   #00014454' TO DFHEIV0
 16510     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16511     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16512     MOVE X'2020233030303134343534' TO DFHEIV0(25:11)
 16513     CALL 'kxdfhei1' USING DFHEIV0,
 16514           DFHEIV99,
 16515           DFHEIV99,
 16516           DFHEIV99,
 16517           DFHEIV99,
 16518           DFHEIV99,
 16519           DFHEIV99
 16520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16521
 16522
 16523 8800-UNAUTHORIZED-ACCESS.
 16524     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16525     GO TO 8300-SEND-TEXT.
 16526
 16527 8810-PF23.
 16528     MOVE EIBAID TO PI-ENTRY-CD-1.
 16529     MOVE XCTL-005               TO PGM-NAME.
 16530     GO TO 9300-XCTL.
 16531
 16532 8820-TERM-ERROR.
 16533     MOVE ER-0412                TO EMI-ERROR.
 16534     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16535     MOVE -1                     TO MAINTL.
 16536     GO TO 8200-SEND-DATAONLY.
 16537
 16538 8830-TRAN-ERROR.
 16539     MOVE ER-0413                TO EMI-ERROR.
 16540     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16541     MOVE -1                     TO MAINTL.
 16542     GO TO 8200-SEND-DATAONLY.
 16543
 16544 9000-RETURN-CICS.
 16545
 16546
 16547* EXEC CICS RETURN
 16548*    END-EXEC.
 16549*    MOVE '.(                    ''   #00014480' TO DFHEIV0
 16550     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16551     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16552     MOVE X'2020233030303134343830' TO DFHEIV0(25:11)
 16553     CALL 'kxdfhei1' USING DFHEIV0,
 16554           DFHEIV99,
 16555           DFHEIV99,
 16556           DFHEIV99,
 16557           DFHEIV99,
 16558           DFHEIV99,
 16559           DFHEIV99
 16560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 317
* EL130.cbl
 16561
 16562
 16563 9100-RETURN-TRAN.
 16564     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16565     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16566
 16567
 16568
 16569* EXEC CICS RETURN
 16570*        TRANSID   (TRANS-ID)
 16571*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16572*        LENGTH    (PI-COMM-LENGTH)
 16573*    END-EXEC.
 16574*    MOVE '.(CT                  ''   #00014488' TO DFHEIV0
 16575     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16576     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16577     MOVE X'2020233030303134343838' TO DFHEIV0(25:11)
 16578     CALL 'kxdfhei1' USING DFHEIV0,
 16579           TRANS-ID,
 16580           PROGRAM-INTERFACE-BLOCK,
 16581           PI-COMM-LENGTH,
 16582           DFHEIV99,
 16583           DFHEIV99,
 16584           DFHEIV99
 16585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16586
 16587
 16588 9200-RETURN-MAIN-MENU.
 16589     MOVE XCTL-126               TO PGM-NAME.
 16590     GO TO 9300-XCTL.
 16591
 16592 9300-XCTL.
 16593
 16594
 16595* EXEC CICS XCTL
 16596*        PROGRAM   (PGM-NAME)
 16597*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16598*        LENGTH    (PI-COMM-LENGTH)
 16599*    END-EXEC.
 16600*    MOVE '.$C                   %   #00014500' TO DFHEIV0
 16601     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16602     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16603     MOVE X'2020233030303134353030' TO DFHEIV0(25:11)
 16604     CALL 'kxdfhei1' USING DFHEIV0,
 16605           PGM-NAME,
 16606           PROGRAM-INTERFACE-BLOCK,
 16607           PI-COMM-LENGTH,
 16608           DFHEIV99
 16609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16610
 16611
 16612 9400-CLEAR.
 16613     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16614     GO TO 9300-XCTL.
 16615
 16616 9500-PF12.
 16617     MOVE XCTL-010               TO PGM-NAME.
 16618     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 318
* EL130.cbl
 16619
 16620 9600-PGMID-ERROR.
 16621
 16622
 16623* EXEC CICS HANDLE CONDITION
 16624*        PGMIDERR  (8300-SEND-TEXT)
 16625*    END-EXEC.
 16626*    MOVE '"$L                   ! M #00014516' TO DFHEIV0
 16627     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16628     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16629     MOVE X'4D20233030303134353136' TO DFHEIV0(25:11)
 16630     CALL 'kxdfhei1' USING DFHEIV0
 16631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16632
 16633
 16634     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16635     MOVE ' '                    TO PI-ENTRY-CD-1.
 16636     MOVE XCTL-005               TO PGM-NAME.
 16637     MOVE PGM-NAME               TO LOGOFF-PGM.
 16638     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16639     GO TO 9300-XCTL.
 16640
 16641 9700-LINK-DATE-CONVERT.
 16642     MOVE LINK-ELDATCV           TO PGM-NAME.
 16643
 16644
 16645* EXEC CICS LINK
 16646*        PROGRAM    (PGM-NAME)
 16647*        COMMAREA   (DATE-CONVERSION-DATA)
 16648*        LENGTH     (DC-COMM-LENGTH)
 16649*    END-EXEC.
 16650*    MOVE '."C                   (   #00014530' TO DFHEIV0
 16651     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16652     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16653     MOVE X'2020233030303134353330' TO DFHEIV0(25:11)
 16654     CALL 'kxdfhei1' USING DFHEIV0,
 16655           PGM-NAME,
 16656           DATE-CONVERSION-DATA,
 16657           DC-COMM-LENGTH,
 16658           DFHEIV99,
 16659           DFHEIV99,
 16660           DFHEIV99,
 16661           DFHEIV99
 16662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16663
 16664
 16665 9700-EXIT.
 16666     EXIT.
 16667
 16668 9800-LINK-REM-TERM.
 16669     MOVE LINK-ELRTRM            TO PGM-NAME.
 16670
 16671
 16672* EXEC CICS LINK
 16673*        PROGRAM    (PGM-NAME)
 16674*        COMMAREA   (CALCULATION-PASS-AREA)
 16675*        LENGTH     (CP-COMM-LENGTH)
 16676*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 319
* EL130.cbl
 16677*    MOVE '."C                   (   #00014542' TO DFHEIV0
 16678     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16679     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16680     MOVE X'2020233030303134353432' TO DFHEIV0(25:11)
 16681     CALL 'kxdfhei1' USING DFHEIV0,
 16682           PGM-NAME,
 16683           CALCULATION-PASS-AREA,
 16684           CP-COMM-LENGTH,
 16685           DFHEIV99,
 16686           DFHEIV99,
 16687           DFHEIV99,
 16688           DFHEIV99
 16689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16690
 16691
 16692 9800-EXIT.
 16693     EXIT.
 16694
 16695 9900-ERROR-FORMAT.
 16696*    if emi-error = 1651 or 1652 or 1653 or 1655
 16697*       display ' 9900 error ' emi-error
 16698*       display emi-message-area (1)
 16699*       display emi-message-area (2)
 16700*       display emi-message-area (3)
 16701*    end-if
 16702     IF NOT EMI-ERRORS-COMPLETE
 16703         MOVE LINK-001           TO PGM-NAME
 16704
 16705* EXEC CICS LINK
 16706*            PROGRAM   (PGM-NAME)
 16707*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 16708*            LENGTH    (EMI-COMM-LENGTH)
 16709*        END-EXEC
 16710*    MOVE '."C                   (   #00014560' TO DFHEIV0
 16711     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16712     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16713     MOVE X'2020233030303134353630' TO DFHEIV0(25:11)
 16714     CALL 'kxdfhei1' USING DFHEIV0,
 16715           PGM-NAME,
 16716           ERROR-MESSAGE-INTERFACE-BLOCK,
 16717           EMI-COMM-LENGTH,
 16718           DFHEIV99,
 16719           DFHEIV99,
 16720           DFHEIV99,
 16721           DFHEIV99
 16722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16723         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 16724            subtract 1 from emi-fatal-ctr
 16725         end-if
 16726     END-IF.
 16727
 16728     .
 16729 9900-EXIT.
 16730     EXIT.
 16731
 16732 9990-ABEND.
 16733     MOVE -1                     TO MAINTL.
 16734     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 320
* EL130.cbl
 16735     MOVE DFHEIBLK               TO EMI-LINE1.
 16736
 16737
 16738* EXEC CICS LINK
 16739*        PROGRAM   (PGM-NAME)
 16740*        COMMAREA  (EMI-LINE1)
 16741*        LENGTH    (72)
 16742*    END-EXEC.
 16743     MOVE 72
 16744       TO DFHEIV11
 16745*    MOVE '."C                   (   #00014579' TO DFHEIV0
 16746     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16747     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16748     MOVE X'2020233030303134353739' TO DFHEIV0(25:11)
 16749     CALL 'kxdfhei1' USING DFHEIV0,
 16750           PGM-NAME,
 16751           EMI-LINE1,
 16752           DFHEIV11,
 16753           DFHEIV99,
 16754           DFHEIV99,
 16755           DFHEIV99,
 16756           DFHEIV99
 16757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16758
 16759
 16760     MOVE EMI-LINE1              TO ERRMSG2O.
 16761
 16762     GO TO 8200-BYPASS-ERROR.
 16763
 16764
 16765
 16766* GOBACK.
 16767     MOVE '9%                    "   ' TO DFHEIV0
 16768     MOVE 'EL130' TO DFHEIV1
 16769     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16770     GOBACK.
 16771
 16772 9995-SECURITY-VIOLATION.
 16773*             COPY ELCSCTP.
 16774******************************************************************
 16775*                                                                *
 16776*                            ELCSCTP                             *
 16777*                            VMOD=2.001                          *
 16778*                                                                *
 16779*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16780******************************************************************
 16781
 16782
 16783     MOVE EIBDATE          TO SM-JUL-DATE.
 16784     MOVE EIBTRMID         TO SM-TERMID.
 16785     MOVE THIS-PGM         TO SM-PGM.
 16786     MOVE EIBTIME          TO TIME-IN.
 16787     MOVE TIME-OUT         TO SM-TIME.
 16788     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16789
 16790
 16791* EXEC CICS LINK
 16792*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 321
* EL130.cbl
 16793*         COMMAREA (SECURITY-MESSAGE)
 16794*         LENGTH   (80)
 16795*    END-EXEC.
 16796     MOVE 'EL003' TO DFHEIV1
 16797     MOVE 80
 16798       TO DFHEIV11
 16799*    MOVE '."C                   (   #00014610' TO DFHEIV0
 16800     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16802     MOVE X'2020233030303134363130' TO DFHEIV0(25:11)
 16803     CALL 'kxdfhei1' USING DFHEIV0,
 16804           DFHEIV1,
 16805           SECURITY-MESSAGE,
 16806           DFHEIV11,
 16807           DFHEIV99,
 16808           DFHEIV99,
 16809           DFHEIV99,
 16810           DFHEIV99
 16811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16812
 16813
 16814******************************************************************
 16815
 16816
 16817 9995-EXIT.
 16818     EXIT.
 16819
 16820
 16821 9999-DFHBACK SECTION.
 16822     MOVE '9%                    "   ' TO DFHEIV0
 16823     MOVE 'EL130' TO DFHEIV1
 16824     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16825     GOBACK.
 16826 9999-DFHEXIT.
 16827     IF DFHEIGDJ EQUAL 0001
 16828         NEXT SENTENCE
 16829     ELSE IF DFHEIGDJ EQUAL 2
 16830         GO TO 0100-TEST-ENTRY,
 16831               8100-SEND-INITIAL-MAP,
 16832               9600-PGMID-ERROR,
 16833               8820-TERM-ERROR,
 16834               8830-TRAN-ERROR,
 16835               9990-ABEND
 16836         DEPENDING ON DFHEIGDI
 16837     ELSE IF DFHEIGDJ EQUAL 3
 16838         GO TO 0450-ADD-ELACTQ-RECORD
 16839         DEPENDING ON DFHEIGDI
 16840     ELSE IF DFHEIGDJ EQUAL 4
 16841         GO TO 8820-TERM-ERROR,
 16842               8830-TRAN-ERROR
 16843         DEPENDING ON DFHEIGDI
 16844     ELSE IF DFHEIGDJ EQUAL 5
 16845         GO TO 0660-NOT-FOUND,
 16846               0670-QIDERR
 16847         DEPENDING ON DFHEIGDI
 16848     ELSE IF DFHEIGDJ EQUAL 6
 16849         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16850         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 322
* EL130.cbl
 16851     ELSE IF DFHEIGDJ EQUAL 7
 16852         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16853         DEPENDING ON DFHEIGDI
 16854     ELSE IF DFHEIGDJ EQUAL 8
 16855         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16856         DEPENDING ON DFHEIGDI
 16857     ELSE IF DFHEIGDJ EQUAL 9
 16858         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16859         DEPENDING ON DFHEIGDI
 16860     ELSE IF DFHEIGDJ EQUAL 10
 16861         GO TO 2050-DELETE-NOT-FOUND
 16862         DEPENDING ON DFHEIGDI
 16863     ELSE IF DFHEIGDJ EQUAL 11
 16864         GO TO 2010-DELETE-CL
 16865         DEPENDING ON DFHEIGDI
 16866     ELSE IF DFHEIGDJ EQUAL 12
 16867         GO TO 3010-TEST-FOR-ERRORS
 16868         DEPENDING ON DFHEIGDI
 16869     ELSE IF DFHEIGDJ EQUAL 13
 16870         GO TO 3008-DUP-ERROR,
 16871               3009-NOT-FOUND
 16872         DEPENDING ON DFHEIGDI
 16873     ELSE IF DFHEIGDJ EQUAL 14
 16874         GO TO 3030-BUILD-CONT
 16875         DEPENDING ON DFHEIGDI
 16876     ELSE IF DFHEIGDJ EQUAL 15
 16877         GO TO 3033-ACCT-NOT-FOUND,
 16878               3033-ACCT-NOT-FOUND
 16879         DEPENDING ON DFHEIGDI
 16880     ELSE IF DFHEIGDJ EQUAL 16
 16881         GO TO 3032-NOT-IN-DT-RANGE
 16882         DEPENDING ON DFHEIGDI
 16883     ELSE IF DFHEIGDJ EQUAL 17
 16884         GO TO 3070-BUILD-CONT
 16885         DEPENDING ON DFHEIGDI
 16886     ELSE IF DFHEIGDJ EQUAL 18
 16887         GO TO 3065-CERT-NOT-FOUND
 16888         DEPENDING ON DFHEIGDI
 16889     ELSE IF DFHEIGDJ EQUAL 19
 16890         GO TO 3100-CARRIER-NOT-FOUND
 16891         DEPENDING ON DFHEIGDI
 16892     ELSE IF DFHEIGDJ EQUAL 20
 16893         GO TO 3110-COMPANY-NOT-FOUND
 16894         DEPENDING ON DFHEIGDI
 16895     ELSE IF DFHEIGDJ EQUAL 21
 16896         GO TO 3200-BUILD-ZERO-TRAILER
 16897         DEPENDING ON DFHEIGDI
 16898     ELSE IF DFHEIGDJ EQUAL 22
 16899         GO TO 9999-DFHBACK
 16900         DEPENDING ON DFHEIGDI
 16901     ELSE IF DFHEIGDJ EQUAL 23
 16902         GO TO 3290-NO-INSURED-ADDRESS
 16903         DEPENDING ON DFHEIGDI
 16904     ELSE IF DFHEIGDJ EQUAL 24
 16905         GO TO 3410-DUP-KEY
 16906         DEPENDING ON DFHEIGDI
 16907     ELSE IF DFHEIGDJ EQUAL 25
 16908         GO TO 3690-CERT-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 323
* EL130.cbl
 16909         DEPENDING ON DFHEIGDI
 16910     ELSE IF DFHEIGDJ EQUAL 26
 16911         GO TO 3850-CLAIM-MSTR-WRITTEN
 16912         DEPENDING ON DFHEIGDI
 16913     ELSE IF DFHEIGDJ EQUAL 27
 16914         GO TO 5050-CERT-NOT-FOUND
 16915         DEPENDING ON DFHEIGDI
 16916     ELSE IF DFHEIGDJ EQUAL 28
 16917         GO TO 5030-CERT-WRITTEN
 16918         DEPENDING ON DFHEIGDI
 16919     ELSE IF DFHEIGDJ EQUAL 29
 16920         GO TO 5035-CLAIM-WRITTEN
 16921         DEPENDING ON DFHEIGDI
 16922     ELSE IF DFHEIGDJ EQUAL 30
 16923         GO TO 9990-ABEND,
 16924               5799-EXIT
 16925         DEPENDING ON DFHEIGDI
 16926     ELSE IF DFHEIGDJ EQUAL 31
 16927         GO TO 3100-CARRIER-NOT-FOUND
 16928         DEPENDING ON DFHEIGDI
 16929     ELSE IF DFHEIGDJ EQUAL 32
 16930         GO TO 6040-NO-PROCESSOR-RECORD
 16931         DEPENDING ON DFHEIGDI
 16932     ELSE IF DFHEIGDJ EQUAL 33
 16933         GO TO 6060-NO-BENEFICIARY-RECORD
 16934         DEPENDING ON DFHEIGDI
 16935     ELSE IF DFHEIGDJ EQUAL 34
 16936         GO TO 6499-EXIT,
 16937               6499-EXIT
 16938         DEPENDING ON DFHEIGDI
 16939     ELSE IF DFHEIGDJ EQUAL 35
 16940         GO TO 6600-NOT-FOUND
 16941         DEPENDING ON DFHEIGDI
 16942     ELSE IF DFHEIGDJ EQUAL 36
 16943         GO TO 6700-NOTOPEN-ERROR,
 16944               6700-EXIT
 16945         DEPENDING ON DFHEIGDI
 16946     ELSE IF DFHEIGDJ EQUAL 37
 16947         GO TO 7120-NOT-FOUND
 16948         DEPENDING ON DFHEIGDI
 16949     ELSE IF DFHEIGDJ EQUAL 38
 16950         GO TO 7499-EXIT
 16951         DEPENDING ON DFHEIGDI
 16952     ELSE IF DFHEIGDJ EQUAL 39
 16953         GO TO 7500-EXIT,
 16954               7500-DUPLICATE-KEY,
 16955               7500-EXIT
 16956         DEPENDING ON DFHEIGDI
 16957     ELSE IF DFHEIGDJ EQUAL 40
 16958         GO TO 7500-END-BROWSE
 16959         DEPENDING ON DFHEIGDI
 16960     ELSE IF DFHEIGDJ EQUAL 41
 16961         GO TO 7630-END-BROWSE
 16962         DEPENDING ON DFHEIGDI
 16963     ELSE IF DFHEIGDJ EQUAL 42
 16964         GO TO 7799-EXIT,
 16965               7799-EXIT
 16966         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:27 Page 324
* EL130.cbl
 16967     ELSE IF DFHEIGDJ EQUAL 43
 16968         GO TO 7790-END-BROWSE
 16969         DEPENDING ON DFHEIGDI
 16970     ELSE IF DFHEIGDJ EQUAL 44
 16971         GO TO 7992-NOT-FOUND
 16972         DEPENDING ON DFHEIGDI
 16973     ELSE IF DFHEIGDJ EQUAL 45
 16974         GO TO 8300-SEND-TEXT
 16975         DEPENDING ON DFHEIGDI.
 16976     MOVE '9%                    "   ' TO DFHEIV0
 16977     MOVE 'EL130' TO DFHEIV1
 16978     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16979     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12280     Code:       53664
