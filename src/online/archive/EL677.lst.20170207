* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33* 030414  IR2014030400001  PEMA  CHG PYAJ VOID TRANS TO R AND +
    34* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    35* 091615  CR2015082000001  PEMA  ADD TOTAL ENDT PROCESSING
    36* 101216  IR2016101000002  PEMA  Fix negative amount also per DJWB
    37*  REMOVE ERROR 3445.
    38* 103116  IR2016102000001  PEMA  Fix zero refund amount.
    39* 120516  IR2016113000001  PEMA  Rem erchek del if sql error
    40******************************************************************
    41 ENVIRONMENT DIVISION.
    42
    43 DATA DIVISION.
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    48 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    49 77  s1                          pic s999 comp-3 value +0.
    50 77  s2                          pic s999 comp-3 value +0.
    51 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    52 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    53 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    54 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    55 77  ws-browse-sw                pic x value spaces.
    56     88  i-say-when                 value 'Y'.
    57 77  ws-delete-sw                pic x value ' '.
    58     88  row-deleted                 value 'Y'.
    59 77  ws-sql-code                 pic s9(7) value zeros.
    60 77  ws-dis-sql-code             pic -9999999 value zeros.
    61 77  ws-match-sw                 pic x  value ' '.
    62     88  found-a-match             value 'Y'.
    63 77  ws-commit-sw                pic x value ' '.
    64     88  tbl-commited                value 'Y'.
    65 01  P pointer.
    66 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    67 01  var-ptr pointer.
    68 01  env-var-len                 pic 9(4)  binary.
    69 01  rc                          pic 9(9)  binary.
    70
    71 01  WS-KIXSYS.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page   3
* EL677.cbl
    72     05  WS-KIX-FIL1             PIC X(10).
    73     05  WS-KIX-APPS             PIC X(10).
    74     05  WS-KIX-ENV              PIC X(10).
    75     05  WS-KIX-MYENV            PIC X(10).
    76     05  WS-KIX-SYS              PIC X(10).
*   77 EXEC SQL
*   78    INCLUDE SQLDA
*   79 END-EXEC
    80 01 SQLDA sync.
    81    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    82    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    83    05 SQLN                  PIC S9(4) COMP-5 value 0.
    84    05 SQLD                  PIC S9(4) COMP-5 value 0.
    85    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    86       10 SQLTYPE            PIC S9(4) COMP-5.
    87       10 SQLLEN             PIC S9(4) COMP-5.
    88$IF P64 SET
    89X      *> For 64-bit environments, ensure that SQLDATA is
    90X      *> aligned on an 8-byte boundary.
    91X      10 FILLER             PIC S9(9) COMP-5.
    92$END
    93       10 SQLDATA            USAGE POINTER.
    94       10 SQLIND             USAGE POINTER.
    95       10 SQLNAME.
    96          15 SQLNAMEL        PIC S9(4) COMP-5.
    97          15 SQLNAMEC        PIC X(30).
    98
    99* Values for SQLTYPE
   100
   101 78  ESQL-DATE-CHAR              VALUE 384.
   102 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   103 78  ESQL-DATE-REC               VALUE 386.
   104 78  ESQL-DATE-REC-NULL          VALUE 387.
   105 78  ESQL-TIME-CHAR              VALUE 388.
   106 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   107 78  ESQL-TIME-REC               VALUE 390.
   108 78  ESQL-TIME-REC-NULL          VALUE 391.
   109 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   110 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   111 78  ESQL-TIMESTAMP-REC          VALUE 394.
   112 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   113 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   114 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   115 78  ESQL-TS-OFFSET-REC          VALUE 398.
   116 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   117 78  ESQL-LONGVARBINARY          VALUE 404.
   118 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   119 78  ESQL-LONGVARCHAR            VALUE 408.
   120 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   121 78  ESQL-BINARY                 VALUE 444.
   122 78  ESQL-BINARY-NULL            VALUE 445.
   123 78  ESQL-VARBINARY              VALUE 446.
   124 78  ESQL-VARBINARY-NULL         VALUE 447.
   125 78  ESQL-VARCHAR                VALUE 448.
   126 78  ESQL-VARCHAR-NULL           VALUE 449.
   127
   128 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   129 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130
   131 78  ESQL-CHAR                   VALUE 452.
   132 78  ESQL-CHAR-NULL              VALUE 453.
   133
   134 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   135 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   136
   137 78  ESQL-DOUBLE                 VALUE 480.
   138 78  ESQL-DOUBLE-NULL            VALUE 481.
   139 78  ESQL-REAL                   VALUE 482.
   140 78  ESQL-REAL-NULL              VALUE 483.
   141 78  ESQL-DECIMAL                VALUE 484.
   142 78  ESQL-DECIMAL-NULL           VALUE 485.
   143 78  ESQL-INTEGER                VALUE 496.
   144 78  ESQL-INTEGER-NULL           VALUE 497.
   145 78  ESQL-SMALLINT               VALUE 500.
   146 78  ESQL-SMALLINT-NULL          VALUE 501.
   147 78  ESQL-TINYINT                VALUE 502.
   148 78  ESQL-TINYINT-NULL           VALUE 503.
*  149 EXEC SQL
*  150    INCLUDE SQLCA
*  151 END-EXEC
   152 01 SQLCA.
   153     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   154     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   155     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   156     05  SQLERRM.
   157         49  SQLERRML    PIC S9(4) COMP-5.
   158         49  SQLERRMC    PIC X(70).
   159     05  SQLERRP         PIC X(8).
   160     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   161     05  SQLWARN.
   162         10  SQLWARN0    PIC X.
   163         10  SQLWARN1    PIC X.
   164         10  SQLWARN2    PIC X.
   165         10  SQLWARN3    PIC X.
   166         10  SQLWARN4    PIC X.
   167         10  SQLWARN5    PIC X.
   168         10  SQLWARN6    PIC X.
   169         10  SQLWARN7    PIC X.
   170     05  SQLEXT.
   171         10  SQLWARN8    PIC X.
   172         10  SQLWARN9    PIC X.
   173         10  SQLWARN10   PIC X.
   174         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   175     05  SQLSTATE    PIC X(5).
   176 EXEC SQL
   177    BEGIN DECLARE SECTION
   178 END-EXEC
   179 01  ws-paid-bank-work-area.
   180     05  ws-pb-compid            pic x(9).
   181     05  ws-pb-check-no          pic x(10).
   182     05  ws-pb-bad-check-no      pic x(10).
   183     05  ws-check-amount         pic x(10).
   184 01  Paid-Bank-Info.
   185     05  pb-check-no             pic 9(10).
   186     05  pb-tran-type            pic x.
   187     05  pb-bank-acct-desc       pic x(50).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page   5
* EL677.cbl
   188     05  pb-amount               pic x(12).
   189     05  pb-paid-date            pic x(25).
   190 01  ws-key-stuff.
   191     05  ws-compid               pic xxx.
   192     05  ws-carrier              pic x.
   193     05  ws-grouping             pic x(6).
   194     05  ws-state                pic xx.
   195     05  ws-account              pic x(10).
   196     05  ws-eff-date             pic x(10).
   197     05  ws-certificate          pic x(10).
   198     05  ws-cert-sfx             pic x.
   199     05  ws-seq-no               pic 999.
   200     05  ws-type                 pic x.
   201     05  ws-check-sub-type       pic x.
   202 01  sqlcmd                      pic x(1024).
   203 01  WS-MOE-DATE                 pic x(10).
   204 01  svr                         pic x(32).
   205 01  usr                         pic x(32).
   206 01  pass                        pic x(32).
   207 01  usr-pass                    pic x(64).
   208 01  ws-disp-code                pic s9(11).
   209***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   210***                                                            ***
   211***  These indicators are used to determine if a variable      ***
   212***  is passed nulls from sql. The indicator will be -1        ***
   213***  if the value on sql is nulls and +0 if the value is       ***
   214***  something other than nulls. Here is an example on how     ***
   215***  to use the indicator variables.                           ***
   216***                                                            ***
   217***     EXEC SQL                                               ***
   218***        fetch checkapp into                                 ***
   219***           :db-app-status :nu-app-status,                   ***
   220***           :db-app-by     :nu-app-by,                       ***
   221***           :db-app-date   :nu-app-date,                     ***
   222***           :db-app-batch  :nu-app-batch                     ***
   223***     END-EXEC                                               ***
   224***                                                            ***
   225***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   226 01  indicator-vaiables-for-nulls.
   227     05  nu-app-status           pic s9(4) comp value +0.
   228     05  nu-app-by               pic s9(4) comp value +0.
   229     05  nu-app-date             pic s9(4) comp value +0.
   230     05  nu-app-batch            pic s9(4) comp value +0.
   231     05  nu-fincar               pic s9(4) comp value +0.
   232 01  daily-check-request-rec.
   233     05  db-compid               pic xxx.
   234     05  db-carrier              pic x.
   235     05  db-grouping             pic x(6).
   236     05  db-state                pic xx.
   237     05  db-account              pic x(10).
   238     05  db-effdate              pic x(10).
   239     05  db-certificate          pic x(10).
   240     05  db-cert-sfx             pic x.
   241     05  db-seq-no               pic 999.
   242     05  db-type                 pic x.
   243     05  db-amount-n             pic 9(7).99.
   244     05  db-amount redefines db-amount-n
   245                                 pic x(10).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page   6
* EL677.cbl
   246     05  db-checkno              pic x(15).
   247     05  db-checkdate            pic x(10).
   248     05  db-checkstatus          pic 9(5).
   249     05  db-releasebatch         pic 9(5).
   250     05  db-releasedt            pic x(10).
   251     05  db-releaseby            pic x(4).
   252     05  db-payeename1           pic x(30).
   253     05  db-payeename2           pic x(30).
   254     05  db-payeeaddr1           pic x(30).
   255     05  db-payeeaddr2           pic x(30).
   256     05  db-payeecity            pic x(30).
   257     05  db-payeest              pic xx.
   258     05  db-payeezip             pic x(10).
   259     05  db-fincar               pic x.
   260     05  db-fingrp               pic x(6).
   261     05  db-finresp              pic x(10).
   262     05  db-finacct              pic x(10).
   263     05  db-preparer             pic x(4).
   264     05  db-app-status           pic x(9).
   265     05  dp-app-status-n redefines db-app-status
   266                                 pic 9(9).
   267     05  db-app-by               pic x(20).
   268     05  db-app-date             pic x(30).
   269     05  db-app-batch            pic x(10).
   270     05  db-return-to            pic x(30).
   271     05  db-insured-name         pic x(30).
   272     05  db-check-sub-type       pic x.
   273 EXEC SQL
   274    END DECLARE SECTION
   275 END-EXEC
   276*                            COPY ELCSCTM.
   277******************************************************************
   278*                                                                *
   279*                                                                *
   280*                            ELCSCTM                             *
   281*                            VMOD=2.001                          *
   282*                                                                *
   283*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   284*                                                                *
   285******************************************************************
   286 01  SECURITY-MESSAGE.
   287     12  FILLER                          PIC X(30)
   288            VALUE '** LOGIC SECURITY VIOLATION -'.
   289     12  SM-READ                         PIC X(6).
   290     12  FILLER                          PIC X(5)
   291            VALUE ' PGM='.
   292     12  SM-PGM                          PIC X(6).
   293     12  FILLER                          PIC X(5)
   294            VALUE ' OPR='.
   295     12  SM-PROCESSOR-ID                 PIC X(4).
   296     12  FILLER                          PIC X(6)
   297            VALUE ' TERM='.
   298     12  SM-TERMID                       PIC X(4).
   299     12  FILLER                          PIC XX   VALUE SPACE.
   300     12  SM-JUL-DATE                     PIC 9(5).
   301     12  FILLER                          PIC X    VALUE SPACE.
   302     12  SM-TIME                         PIC 99.99.
   303
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page   7
* EL677.cbl
   304*                            COPY ELCSCRTY.
   305******************************************************************
   306*                                                                *
   307*                                                                *
   308*                            ELCSCRTY                            *
   309*                            VMOD=2.001                          *
   310*                                                                *
   311*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   312*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   313*        SAVED IN PI-SECURITY-ADDRESS.                           *
   314*                                                                *
   315******************************************************************
   316 01  SECURITY-CONTROL.
   317     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   318     12  FILLER                       PIC XX    VALUE 'SC'.
   319     12  SC-CREDIT-CODES.
   320         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   321             20  SC-CREDIT-DISPLAY    PIC X.
   322             20  SC-CREDIT-UPDATE     PIC X.
   323     12  SC-CLAIMS-CODES.
   324         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   325             20  SC-CLAIMS-DISPLAY    PIC X.
   326             20  SC-CLAIMS-UPDATE     PIC X.
   327 01  ws-dummy-erchek             pic x(600).
   328 01  filler.
   329     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   330     05  WS-CHECK-AMT-TMPX REDEFINES
   331         WS-CHECK-AMT-TMP        PIC X(10).
   332     05  ws-ind                     pic s9(4) comp value +0.
   333     05  ws-ind-red redefines ws-ind pic xx.
   334     05  ws-display-ind             pic s9(7) value zeros.
   335 01  ws-compare-erchek-key          pic x(33) value low-values.
   336 01  ws-eracct-sw                   pic x value ' '.
   337     88  eracct-found                 value 'Y'.
   338 01  ws-eracct-start-sw             pic x value ' '.
   339     88  eracct-start                 value 'Y'.
   340 01  WS-MISC-AREA.
   341     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   342     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   343     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   344
   345 01  ws-work-amt-alpha           pic x(10).
   346 01  ws-work-amt-num redefines ws-work-amt-alpha
   347                                 pic 9(8)v99.
   348 01  ws-user-defined.
   349     05  ws-user-reason         pic xxx.
   350     05  ws-user-cert-no        pic x(11).
   351     05  ws-user-name           pic x(28).
   352 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   353 01  STANDARD-AREAS.
   354     12  ws-connect-sw               pic x  value ' '.
   355         88  connected-to-db             value 'Y'.
   356     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   357     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   358     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   359     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   360     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   361     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page   8
* EL677.cbl
   362     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   363     12  EL6318-TRANS-ID             PIC X(4)    VALUE 'EXBE'.
   364     12  EL1273-TRANS-ID             PIC X(4)    VALUE 'EXX3'.
   365     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   366     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   367     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   368     12  TIME-OUT-R  REDEFINES TIME-IN.
   369         16  FILLER                  PIC X.
   370         16  TIME-OUT                PIC 99V99.
   371         16  FILLER                  PIC XX.
   372     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   373     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   374     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   375     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   376     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   377     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   378     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   379     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   380     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   381     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   382     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   383     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   384     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   385     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   386     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   387     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   388     12  ERPNDM-FILE-ID              PIC X(8)    VALUE 'ERPNDM'.
   389     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   390     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   391     12  WS-KEY-LENGTH               PIC S9(4)   VALUE +28   COMP.
   392     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   393     12  QID.
   394         16  QID-TERM                PIC X(4)    VALUE SPACES.
   395         16  FILLER                  PIC X(4)    VALUE '677A'.
   396
   397 01  WORK-AREAS.
   398     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   399     12  WS-AM-WK REDEFINES WS-AM-WORK.
   400         16  WS-AM-NUM               PIC S9(7)V99.
   401         16  WS-AM-SIGN              PIC X.
   402     12  WS-CHECK-WORK.
   403         16  FILLER                  PIC X        VALUE SPACE.
   404         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   405     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   406     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   407     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   408     12  WS-AMT-PAID                 PIC S9(7)V99 VALUE +0.
   409     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   410     12  WS-SV-CARRIER               PIC X       VALUE SPACES.
   411     12  WS-SV-GROUPING              PIC X(6)    VALUE SPACES.
   412     12  WS-SV-STATE                 PIC XX      VALUE SPACES.
   413     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   414     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   415     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   416         WS-DT-DEEDIT-FIELD.
   417         16  FILLER                  PIC X(4).
   418         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   419     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page   9
* EL677.cbl
   420     12  WS-DEEDIT-FIELD-V0          REDEFINES
   421         WS-DEEDIT-FIELD-A           PIC S9(15).
   422
   423     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   424     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   425         88 WS-CERT-FOUND                        VALUE 'Y'.
   426         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   427     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   428         88 WS-PNDB-FOUND                        VALUE 'Y'.
   429         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   430     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   431         88  WS-PROCESS-CERT                     VALUE 'Y'.
   432     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   433         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   434     12  WS-PY-ENTRY-COMMENT.
   435         16  WS-PY-CURRENT-DATE      PIC X(6)    VALUE SPACES.
   436         16  FILLER                  PIC X(13)   VALUE
   437            ' MISC. CHECK '.
   438         16  WS-PY-CURRENT-CERT      PIC X(10)   VALUE SPACES.
   439         16  WS-PY-CURRENT-SUFFIX    PIC X       VALUE SPACE.
   440     12  WS-PY-REF-COMMENT.
   441         16  WS-PY-REF-DATE          PIC X(6)    VALUE SPACES.
   442         16  FILLER                  PIC X(13)   VALUE
   443            ' REFUND PYMT '.
   444         16  WS-PY-REF-CERT          PIC X(10)   VALUE SPACES.
   445         16  WS-PY-REF-SUFFIX        PIC X       VALUE SPACE.
   446     12  WS-PY-END-COMMENT.
   447         16  WS-PY-END-DATE          PIC X(6)    VALUE SPACES.
   448         16  FILLER                  PIC X(13)   VALUE
   449            ' ENDORSEMENT '.
   450         16  WS-PY-END-CERT          PIC X(10)   VALUE SPACES.
   451         16  WS-PY-END-SUFFIX        PIC X       VALUE SPACE.
   452     12  WS-PY-DED-COMMENT.
   453         16  WS-PY-DED-DATE          PIC X(6)    VALUE SPACES.
   454         16  FILLER                  PIC X(13)   VALUE
   455            ' STAT DEDUCT '.
   456         16  WS-PY-DED-CERT          PIC X(10)   VALUE SPACES.
   457         16  WS-PY-DED-SUFFIX        PIC X       VALUE SPACE.
   458     12  WS-PY-ADDL-COMMENT.
   459         16  WS-PY-ADDL-DATE         PIC X(6)    VALUE SPACES.
   460         16  FILLER                  PIC X(13)   VALUE
   461            ' ADDL CHARGE '.
   462         16  WS-PY-ADDL-CERT         PIC X(10)   VALUE SPACES.
   463         16  WS-PY-ADDL-SUFFIX       PIC X       VALUE SPACE.
   464     12  WS-PY-REVERSAL-COMMENT.
   465         16  WS-PY-REVERSAL-DATE     PIC X(6)    VALUE SPACES.
   466         16  WS-PY-REVERSAL-TYPE     PIC X(13)   VALUE
   467            ' VOID REFUND '.
   468         16  WS-PY-REVERSAL-CERT     PIC X(10)   VALUE SPACES.
   469         16  WS-PY-REVERSAL-SUFFIX   PIC X       VALUE SPACE.
   470     12  WS-TMS-ENTRY-COMMENT.
   471         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   472         16  FILLER                  PIC XX      VALUE SPACES.
   473         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   474     12  WS-ZIP-CODE.
   475         16  WS-ZIP-PRIME.
   476             20  WS-ZIP-PRI-1ST      PIC X.
   477                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  10
* EL677.cbl
   478             20  FILLER              PIC X(4).
   479         16  WS-ZIP-PLUS4            PIC X(4).
   480     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   481         16  WS-CAN-POST1-1          PIC XXX.
   482         16  WS-CAN-POST1-2.
   483             20  WS-CAN-POST-4TH     PIC X.
   484             20  FILLER              PIC XX.
   485         16  FILLER                  PIC XXX.
   486     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   487         16  WS-CAN-POST2-1          PIC XXX.
   488         16  FILLER                  PIC X.
   489         16  WS-CAN-POST2-2          PIC XXX.
   490         16  FILLER                  PIC XX.
   491
   492*                                    COPY ELCNWA.
   493*****************************************************************
   494*                                                               *
   495*                                                               *
   496*                            ELCNWA.                            *
   497*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   498*                            VMOD=2.003                         *
   499*                                                               *
   500*            M O V E   N A M E   W O R K   A R E A.             *
   501*                                                               *
   502*****************************************************************.
   503
   504 01  WS-NAME-WORK-AREA.
   505     05  WS-INSURED-LAST-NAME        PIC X(15).
   506     05  WS-INSURED-1ST-NAME         PIC X(12).
   507     05  WS-INSURED-MID-INIT         PIC X.
   508
   509     05  WS-NAME-WORK.
   510         10  WS-NW                   PIC X
   511             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   512
   513     05  WS-NAME-WORK2.
   514         10  WS-NW2                  PIC X
   515             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   516                                        NWA-INDEX0.
   517
   518     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   519                                     COMP-3.
   520
   521 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   522     88  RESP-NORMAL                    VALUE +0.
   523     88  resp-file-notfnd               value +12.
   524     88  RESP-NOTFND                    VALUE +13.
   525     88  resp-duprec                    value +14.
   526     88  resp-dupkey                    value +15.
   527     88  resp-invreq                    value +16.
   528     88  RESP-NOTOPEN                   VALUE +19.
   529     88  RESP-ENDFILE                   VALUE +20.
   530     88  resp-lengtherr                 value +22.
   531 01  ACCESS-KEYS.
   532     12  ELCNTL-KEY.
   533         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   534         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   535         16 ELCNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  11
* EL677.cbl
   536             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   537             20  FILLER              PIC X       VALUE SPACES.
   538             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   539         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   540
   541     12  ELCNTL-RECORD-LENGTH        PIC S9(4)   VALUE +750  COMP.
   542
   543     12  ERACCT-KEY.
   544         16  ERACCT-CO               PIC X       VALUE SPACES.
   545         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   546         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   547         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   548         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   549         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   550         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   551
   552     12  SAVE-ERACCT-KEY.
   553         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   554         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   555         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   556         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   557         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   558         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   559         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   560
   561     12  ERACCT-RECORD-LENGTH        PIC S9(4)   VALUE +2000 COMP.
   562
   563     12  ERCOMP-KEY.
   564         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   565         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   566         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   567         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   568         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   569         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   570
   571     12  ERCOMP-LENGTH               PIC S9(4)   VALUE +700  COMP.
   572
   573     12  ELCERT-KEY.
   574         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   575         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   576         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   577         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   578         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   579         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   580         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   581         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   582
   583     12  ELCERT-RECORD-LENGTH        PIC S9(4)   VALUE +450  COMP.
   584
   585     12  ERPNDB-PRIMARY-KEY.
   586         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   587         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   588         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   589         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   590
   591     12  ERPNDB-ALT-KEY.
   592         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   593         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  12
* EL677.cbl
   594         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
   595         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   596         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   597         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   598         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   599         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   600         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   601         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   602
   603     12  ERPNDB-RECORD-LENGTH        PIC S9(4)   VALUE +585  COMP.
   604
   605     12  ERPNDM-PRIMARY-KEY.
   606         16 ERPNDM-COMPANY-CD        PIC X       VALUE SPACES.
   607         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   608         16 ERPNDM-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   609         16 ERPNDM-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   610
   611     12  ERPNDM-RECORD-LENGTH        PIC S9(4)   VALUE +250  COMP.
   612
   613     12  ERCHEK-KEY.
   614         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   615         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   616         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   617         16  CHEK-STATE              PIC XX      VALUE SPACES.
   618         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   619         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   620         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   621         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   622         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   623
   624     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   625     12  ERPYAJ-KEY.
   626         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   627         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   628         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   629         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   630         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   631         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   632         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   633
   634     12  ERPYAJ-RECORD-LENGTH        PIC S9(4)   VALUE +200  COMP.
   635
   636 01  ERROR-NUMBERS.
   637     12  ER-0000                     PIC X(4)    VALUE '0000'.
   638     12  ER-0004                     PIC X(4)    VALUE '0004'.
   639     12  ER-0008                     PIC X(4)    VALUE '0008'.
   640     12  ER-0013                     PIC X(4)    VALUE '0013'.
   641     12  ER-0022                     PIC X(4)    VALUE '0022'.
   642     12  ER-0023                     PIC X(4)    VALUE '0023'.
   643     12  ER-0026                     PIC X(4)    VALUE '0026'.
   644     12  ER-0029                     PIC X(4)    VALUE '0029'.
   645     12  ER-0070                     PIC X(4)    VALUE '0070'.
   646     12  ER-0194                     PIC X(4)    VALUE '0194'.
   647     12  ER-0195                     PIC X(4)    VALUE '0195'.
   648     12  ER-0196                     PIC X(4)    VALUE '0196'.
   649     12  ER-0197                     PIC X(4)    VALUE '0197'.
   650     12  ER-0203                     PIC X(4)    VALUE '0203'.
   651     12  ER-0215                     PIC X(4)    VALUE '0215'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  13
* EL677.cbl
   652     12  ER-0216                     PIC X(4)    VALUE '0216'.
   653     12  ER-0433                     PIC X(4)    VALUE '0433'.
   654     12  ER-0565                     PIC X(4)    VALUE '0565'.
   655     12  ER-1159                     PIC X(4)    VALUE '1159'.
   656     12  ER-1162                     PIC X(4)    VALUE '1162'.
   657     12  ER-2056                     PIC X(4)    VALUE '2056'.
   658     12  ER-2208                     PIC X(4)    VALUE '2208'.
   659     12  ER-2209                     PIC X(4)    VALUE '2209'.
   660     12  ER-2210                     PIC X(4)    VALUE '2210'.
   661     12  ER-2230                     PIC X(4)    VALUE '2230'.
   662     12  ER-2237                     PIC X(4)    VALUE '2237'.
   663     12  ER-2238                     PIC X(4)    VALUE '2238'.
   664     12  ER-2294                     PIC X(4)    VALUE '2294'.
   665     12  ER-2394                     PIC X(4)    VALUE '2394'.
   666     12  ER-2438                     PIC X(4)    VALUE '2438'.
   667     12  ER-2439                     PIC X(4)    VALUE '2439'.
   668     12  ER-2583                     PIC X(4)    VALUE '2583'.
   669     12  ER-2600                     PIC X(4)    VALUE '2600'.
   670     12  ER-2726                     PIC X(4)    VALUE '2726'.
   671     12  ER-2905                     PIC X(4)    VALUE '2905'.
   672     12  ER-2906                     PIC X(4)    VALUE '2906'.
   673     12  ER-2907                     PIC X(4)    VALUE '2907'.
   674     12  ER-2908                     PIC X(4)    VALUE '2908'.
   675     12  ER-2909                     PIC X(4)    VALUE '2909'.
   676     12  ER-3044                     PIC X(4)    VALUE '3044'.
   677     12  ER-3046                     PIC X(4)    VALUE '3046'.
   678     12  ER-3047                     PIC X(4)    VALUE '3047'.
   679     12  ER-3445                     PIC X(4)    VALUE '3445'.
   680     12  er-3450                     pic x(4)    value '3450'.
   681     12  er-3451                     pic x(4)    value '3451'.
   682     12  er-3452                     pic x(4)    value '3452'.
   683     12  er-3453                     pic x(4)    value '3453'.
   684     12  er-3454                     pic x(4)    value '3454'.
   685     12  er-3455                     pic x(4)    value '3455'.
   686     12  er-3459                     pic x(4)    value '3459'.
   687     12  ER-7389                     PIC X(4)    VALUE '7389'.
   688     12  ER-9999                     PIC X(4)    VALUE '9999'.
   689*                                    COPY ELCLOGOF.
   690******************************************************************
   691*                                                                *
   692*                                                                *
   693*                            ELCLOGOF.                           *
   694*                            VMOD=2.001                          *
   695*                                                                *
   696*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   697*                                                                *
   698******************************************************************
   699 01  CLASIC-LOGOFF.
   700     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   701     12  LOGOFF-TEXT.
   702         16  FILLER          PIC X(5)    VALUE SPACES.
   703         16  LOGOFF-MSG.
   704             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   705             20  FILLER      PIC X       VALUE SPACES.
   706             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   707         16  FILLER          PIC X(80)
   708           VALUE '* YOU ARE NOW LOGGED OFF'.
   709         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  14
* EL677.cbl
   710         16  FILLER          PIC X       VALUE QUOTE.
   711         16  LOGOFF-SYS-MSG  PIC X(17)
   712           VALUE 'S CLAS-IC SYSTEM '.
   713     12  TEXT-MESSAGES.
   714         16  UNACCESS-MSG    PIC X(29)
   715             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   716         16  PGMIDERR-MSG    PIC X(17)
   717             VALUE 'PROGRAM NOT FOUND'.
   718*                                    COPY ELCDATE.
   719******************************************************************
   720*                                                                *
   721*                                                                *
   722*                            ELCDATE.                            *
   723*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   724*                            VMOD=2.003
   725*                                                                *
   726*                                                                *
   727*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   728*                 LENGTH = 200                                   *
   729******************************************************************
   730
   731 01  DATE-CONVERSION-DATA.
   732     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   733     12  DC-OPTION-CODE                PIC X.
   734         88  BIN-TO-GREG                VALUE ' '.
   735         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   736         88  EDIT-GREG-TO-BIN           VALUE '2'.
   737         88  YMD-GREG-TO-BIN            VALUE '3'.
   738         88  MDY-GREG-TO-BIN            VALUE '4'.
   739         88  JULIAN-TO-BIN              VALUE '5'.
   740         88  BIN-PLUS-ELAPSED           VALUE '6'.
   741         88  FIND-CENTURY               VALUE '7'.
   742         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   743         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   744         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   745         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   746         88  JULIAN-TO-BIN-3            VALUE 'C'.
   747         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   748         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   749         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   750         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   751         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   752         88  CHECK-LEAP-YEAR            VALUE 'H'.
   753         88  BIN-3-TO-GREG              VALUE 'I'.
   754         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   755         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   756         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   757         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   758         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   759         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   760         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   761         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   762         88  THREE-CHARACTER-BIN
   763                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   764         88  GREGORIAN-TO-BIN
   765                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   766         88  BIN-TO-GREGORIAN
   767                  VALUES ' ' '1' 'I' '8' 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  15
* EL677.cbl
   768         88  JULIAN-TO-BINARY
   769                  VALUES '5' 'C' 'E' 'F'.
   770     12  DC-ERROR-CODE                 PIC X.
   771         88  NO-CONVERSION-ERROR        VALUE ' '.
   772         88  DATE-CONVERSION-ERROR
   773                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   774         88  DATE-IS-ZERO               VALUE '1'.
   775         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   776         88  DATE-IS-INVALID            VALUE '3'.
   777         88  DATE1-GREATER-DATE2        VALUE '4'.
   778         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   779         88  DATE-INVALID-OPTION        VALUE '9'.
   780         88  INVALID-CENTURY            VALUE 'A'.
   781         88  ONLY-CENTURY               VALUE 'B'.
   782         88  ONLY-LEAP-YEAR             VALUE 'C'.
   783         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   784     12  DC-END-OF-MONTH               PIC X.
   785         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   786     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   787         88  USE-NORMAL-PROCESS         VALUE ' '.
   788         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   789         88  ADJUST-UP-100-YRS          VALUE '2'.
   790     12  FILLER                        PIC X.
   791     12  DC-CONVERSION-DATES.
   792         16  DC-BIN-DATE-1             PIC XX.
   793         16  DC-BIN-DATE-2             PIC XX.
   794         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   795         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   796                       DC-GREG-DATE-1-EDIT.
   797             20  DC-EDIT1-MONTH        PIC 99.
   798             20  SLASH1-1              PIC X.
   799             20  DC-EDIT1-DAY          PIC 99.
   800             20  SLASH1-2              PIC X.
   801             20  DC-EDIT1-YEAR         PIC 99.
   802         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   803         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   804                     DC-GREG-DATE-2-EDIT.
   805             20  DC-EDIT2-MONTH        PIC 99.
   806             20  SLASH2-1              PIC X.
   807             20  DC-EDIT2-DAY          PIC 99.
   808             20  SLASH2-2              PIC X.
   809             20  DC-EDIT2-YEAR         PIC 99.
   810         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   811         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   812                     DC-GREG-DATE-1-YMD.
   813             20  DC-YMD-YEAR           PIC 99.
   814             20  DC-YMD-MONTH          PIC 99.
   815             20  DC-YMD-DAY            PIC 99.
   816         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   817         16  DC-GREG-DATE-1-MDY-R REDEFINES
   818                      DC-GREG-DATE-1-MDY.
   819             20  DC-MDY-MONTH          PIC 99.
   820             20  DC-MDY-DAY            PIC 99.
   821             20  DC-MDY-YEAR           PIC 99.
   822         16  DC-GREG-DATE-1-ALPHA.
   823             20  DC-ALPHA-MONTH        PIC X(10).
   824             20  DC-ALPHA-DAY          PIC 99.
   825             20  FILLER                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  16
* EL677.cbl
   826             20  DC-ALPHA-CENTURY.
   827                 24 DC-ALPHA-CEN-N     PIC 99.
   828             20  DC-ALPHA-YEAR         PIC 99.
   829         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   830         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   831         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   832         16  DC-JULIAN-DATE            PIC 9(05).
   833         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   834                                       PIC 9(05).
   835         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   836             20  DC-JULIAN-YEAR        PIC 99.
   837             20  DC-JULIAN-DAYS        PIC 999.
   838         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   839         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   840         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   841     12  DATE-CONVERSION-VARIBLES.
   842         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   843         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   844             20  FILLER                PIC 9(3).
   845             20  HOLD-CEN-1-CCYY.
   846                 24  HOLD-CEN-1-CC     PIC 99.
   847                 24  HOLD-CEN-1-YY     PIC 99.
   848             20  HOLD-CEN-1-MO         PIC 99.
   849             20  HOLD-CEN-1-DA         PIC 99.
   850         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   851             20  HOLD-CEN-1-R-MO       PIC 99.
   852             20  HOLD-CEN-1-R-DA       PIC 99.
   853             20  HOLD-CEN-1-R-CCYY.
   854                 24  HOLD-CEN-1-R-CC   PIC 99.
   855                 24  HOLD-CEN-1-R-YY   PIC 99.
   856             20  FILLER                PIC 9(3).
   857         16  HOLD-CENTURY-1-X.
   858             20  FILLER                PIC X(3)  VALUE SPACES.
   859             20  HOLD-CEN-1-X-CCYY.
   860                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   861                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   862             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   863             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   864         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   865             20  HOLD-CEN-1-R-X-MO     PIC XX.
   866             20  HOLD-CEN-1-R-X-DA     PIC XX.
   867             20  HOLD-CEN-1-R-X-CCYY.
   868                 24  HOLD-CEN-1-R-X-CC PIC XX.
   869                 24  HOLD-CEN-1-R-X-YY PIC XX.
   870             20  FILLER                PIC XXX.
   871         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   872         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   873         16  DC-JULIAN-DATE-1          PIC 9(07).
   874         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   875             20  DC-JULIAN-1-CCYY.
   876                 24  DC-JULIAN-1-CC    PIC 99.
   877                 24  DC-JULIAN-1-YR    PIC 99.
   878             20  DC-JULIAN-DA-1        PIC 999.
   879         16  DC-JULIAN-DATE-2          PIC 9(07).
   880         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   881             20  DC-JULIAN-2-CCYY.
   882                 24  DC-JULIAN-2-CC    PIC 99.
   883                 24  DC-JULIAN-2-YR    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  17
* EL677.cbl
   884             20  DC-JULIAN-DA-2        PIC 999.
   885         16  DC-GREG-DATE-A-EDIT.
   886             20  DC-EDITA-MONTH        PIC 99.
   887             20  SLASHA-1              PIC X VALUE '/'.
   888             20  DC-EDITA-DAY          PIC 99.
   889             20  SLASHA-2              PIC X VALUE '/'.
   890             20  DC-EDITA-CCYY.
   891                 24  DC-EDITA-CENT     PIC 99.
   892                 24  DC-EDITA-YEAR     PIC 99.
   893         16  DC-GREG-DATE-B-EDIT.
   894             20  DC-EDITB-MONTH        PIC 99.
   895             20  SLASHB-1              PIC X VALUE '/'.
   896             20  DC-EDITB-DAY          PIC 99.
   897             20  SLASHB-2              PIC X VALUE '/'.
   898             20  DC-EDITB-CCYY.
   899                 24  DC-EDITB-CENT     PIC 99.
   900                 24  DC-EDITB-YEAR     PIC 99.
   901         16  DC-GREG-DATE-CYMD         PIC 9(08).
   902         16  DC-GREG-DATE-CYMD-R REDEFINES
   903                              DC-GREG-DATE-CYMD.
   904             20  DC-CYMD-CEN           PIC 99.
   905             20  DC-CYMD-YEAR          PIC 99.
   906             20  DC-CYMD-MONTH         PIC 99.
   907             20  DC-CYMD-DAY           PIC 99.
   908         16  DC-GREG-DATE-MDCY         PIC 9(08).
   909         16  DC-GREG-DATE-MDCY-R REDEFINES
   910                              DC-GREG-DATE-MDCY.
   911             20  DC-MDCY-MONTH         PIC 99.
   912             20  DC-MDCY-DAY           PIC 99.
   913             20  DC-MDCY-CEN           PIC 99.
   914             20  DC-MDCY-YEAR          PIC 99.
   915    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   916        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   917    12  DC-EL310-DATE                  PIC X(21).
   918    12  FILLER                         PIC X(28).
   919*                                    COPY ELCATTR.
   920******************************************************************
   921*                                                                *
   922*                            ELCATTR.                            *
   923*                            VMOD=2.001                          *
   924*                                                                *
   925*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   926*                                                                *
   927*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   928*                                                                *
   929*                   POS 1   P=PROTECTED                          *
   930*                           U=UNPROTECTED                        *
   931*                           S=ASKIP                              *
   932*                   POS 2   A=ALPHA/NUMERIC                      *
   933*                           N=NUMERIC                            *
   934*                   POS 3   N=NORMAL                             *
   935*                           B=BRIGHT                             *
   936*                           D=DARK                               *
   937*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   938*                           OF=MODIFIED DATA TAG OFF             *
   939*                                                                *
   940*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   941******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  18
* EL677.cbl
   942 01  ATTRIBUTE-LIST.
   943     12  AL-PABOF            PIC X       VALUE 'Y'.
   944     12  AL-PABON            PIC X       VALUE 'Z'.
   945     12  AL-PADOF            PIC X       VALUE '%'.
   946     12  AL-PADON            PIC X       VALUE '_'.
   947     12  AL-PANOF            PIC X       VALUE '-'.
   948     12  AL-PANON            PIC X       VALUE '/'.
   949     12  AL-SABOF            PIC X       VALUE '8'.
   950     12  AL-SABON            PIC X       VALUE '9'.
   951     12  AL-SADOF            PIC X       VALUE '@'.
   952     12  AL-SADON            PIC X       VALUE QUOTE.
   953     12  AL-SANOF            PIC X       VALUE '0'.
   954     12  AL-SANON            PIC X       VALUE '1'.
   955     12  AL-UABOF            PIC X       VALUE 'H'.
   956     12  AL-UABON            PIC X       VALUE 'I'.
   957     12  AL-UADOF            PIC X       VALUE '<'.
   958     12  AL-UADON            PIC X       VALUE '('.
   959     12  AL-UANOF            PIC X       VALUE ' '.
   960     12  AL-UANON            PIC X       VALUE 'A'.
   961     12  AL-UNBOF            PIC X       VALUE 'Q'.
   962     12  AL-UNBON            PIC X       VALUE 'R'.
   963     12  AL-UNDOF            PIC X       VALUE '*'.
   964     12  AL-UNDON            PIC X       VALUE ')'.
   965     12  AL-UNNOF            PIC X       VALUE '&'.
   966     12  AL-UNNON            PIC X       VALUE 'J'.
   967*                                    COPY ELCEMIB.
   968******************************************************************
   969*                                                                *
   970*                                                                *
   971*                            ELCEMIB.                            *
   972*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   973*                            VMOD=2.005                          *
   974*                                                                *
   975*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   976*                                                                *
   977******************************************************************
   978 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   979     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   980     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   981     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   982     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   983     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   984     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   985     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   986     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   987     12  EMI-SWITCH1             PIC X        VALUE '1'.
   988         88  EMI-NO-ERRORS                    VALUE '1'.
   989         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   990         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   991     12  EMI-SWITCH2             PIC X        VALUE '1'.
   992         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   993     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   994         88  EMI-AREA1-EMPTY                  VALUE '1'.
   995         88  EMI-AREA1-FULL                   VALUE '2'.
   996     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   997         88  EMI-AREA2-EMPTY                  VALUE '1'.
   998         88  EMI-AREA2-FULL                   VALUE '2'.
   999     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  19
* EL677.cbl
  1000         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1001         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1002         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1003         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1004         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1005     12  EMI-ERROR-LINES.
  1006         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1007         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1008         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1009         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1010             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1011                 24  EMI-ERR-NUM         PIC X(4).
  1012                 24  EMI-FILLER          PIC X.
  1013                 24  EMI-SEV             PIC X.
  1014                 24  FILLER              PIC X.
  1015             20  FILLER                  PIC X(02).
  1016     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1017         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1018             20  EMI-ERROR-NUMBER    PIC X(4).
  1019             20  EMI-FILL            PIC X.
  1020             20  EMI-SEVERITY        PIC X.
  1021             20  FILLER              PIC X.
  1022             20  EMI-ERROR-TEXT.
  1023                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1024                 24  FILLER          PIC X(55).
  1025     12  EMI-SEVERITY-SAVE           PIC X.
  1026         88  EMI-NOTE                    VALUE 'N'.
  1027         88  EMI-WARNING                 VALUE 'W'.
  1028         88  EMI-FORCABLE                VALUE 'F'.
  1029         88  EMI-FATAL                   VALUE 'X'.
  1030     12  EMI-MESSAGE-FLAG            PIC X.
  1031         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1032         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1033     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1034     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1035         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1036         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1037         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1038     12  emi-claim-no                pic x(7).
  1039     12  emi-claim-type              pic x(6).
  1040     12  FILLER                      PIC X(124)  VALUE SPACES.
  1041     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1042     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1043     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1044     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1045*                                    COPY ELCINTF.
  1046******************************************************************
  1047*                                                                *
  1048*                                                                *
  1049*                            ELCINTF.                            *
  1050*                            VMOD=2.017                          *
  1051*                                                                *
  1052*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1053*                                                                *
  1054*       LENGTH = 1024                                            *
  1055*                                                                *
  1056******************************************************************
  1057*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  20
* EL677.cbl
  1058*
  1059* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1060*-----------------------------------------------------------------
  1061*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1062* EFFECTIVE    NUMBER
  1063*-----------------------------------------------------------------
  1064* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1065******************************************************************
  1066 01  PROGRAM-INTERFACE-BLOCK.
  1067     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1068     12  PI-CALLING-PROGRAM              PIC X(8).
  1069     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1070     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1071     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1072     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1073     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1074     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1075     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1076     12  PI-COMPANY-ID                   PIC XXX.
  1077     12  PI-COMPANY-CD                   PIC X.
  1078
  1079     12  PI-COMPANY-PASSWORD             PIC X(8).
  1080
  1081     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1082
  1083     12  PI-CONTROL-IN-PROGRESS.
  1084         16  PI-CARRIER                  PIC X.
  1085         16  PI-GROUPING                 PIC X(6).
  1086         16  PI-STATE                    PIC XX.
  1087         16  PI-ACCOUNT                  PIC X(10).
  1088         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1089                                         PIC X(10).
  1090         16  PI-CLAIM-CERT-GRP.
  1091             20  PI-CLAIM-NO             PIC X(7).
  1092             20  PI-CERT-NO.
  1093                 25  PI-CERT-PRIME       PIC X(10).
  1094                 25  PI-CERT-SFX         PIC X.
  1095             20  PI-CERT-EFF-DT          PIC XX.
  1096         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1097             20  PI-PLAN-CODE            PIC X(2).
  1098             20  PI-REVISION-NUMBER      PIC X(3).
  1099             20  PI-PLAN-EFF-DT          PIC X(2).
  1100             20  PI-PLAN-EXP-DT          PIC X(2).
  1101             20  FILLER                  PIC X(11).
  1102         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1103             20  PI-OE-REFERENCE-1.
  1104                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1105                 25  PI-OE-REF-1-SUFF    PIC XX.
  1106
  1107     12  PI-SESSION-IN-PROGRESS          PIC X.
  1108         88  CLAIM-SESSION                   VALUE '1'.
  1109         88  CREDIT-SESSION                  VALUE '2'.
  1110         88  WARRANTY-SESSION                VALUE '3'.
  1111         88  MORTGAGE-SESSION                VALUE '4'.
  1112         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1113
  1114
  1115*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  21
* EL677.cbl
  1116
  1117     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1118     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1119
  1120     12  PI-CREDIT-USER                  PIC X.
  1121         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1122         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1123
  1124     12  PI-CLAIM-USER                   PIC X.
  1125         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1126         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1127
  1128     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1129         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1130         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1131         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1132         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1133         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1134
  1135     12  PI-PROCESSOR-ID                 PIC X(4).
  1136
  1137     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1138
  1139     12  PI-MEMBER-CAPTION               PIC X(10).
  1140
  1141     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1142         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1143
  1144     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1145     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1146     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1147     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1148
  1149     12  PI-AH-OVERRIDE-L1               PIC X.
  1150     12  PI-AH-OVERRIDE-L2               PIC XX.
  1151     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1152     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1153
  1154     12  PI-NEW-SYSTEM                   PIC X(2).
  1155
  1156     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1157     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1158         88  PI-USES-PAID-TO                 VALUE '1'.
  1159     12  PI-CRDTCRD-SYSTEM.
  1160         16  PI-CRDTCRD-USER             PIC X.
  1161             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1162             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1163         16  PI-CC-MONTH-END-DT          PIC XX.
  1164     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1165
  1166     12  PI-OE-REFERENCE-2.
  1167         16  PI-OE-REF-2-PRIME           PIC X(10).
  1168         16  PI-OE-REF-2-SUFF            PIC X.
  1169
  1170     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1171
  1172     12  PI-LANGUAGE-TYPE                PIC X.
  1173             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  22
* EL677.cbl
  1174             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1175             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1176
  1177     12  PI-POLICY-LINKAGE-IND           PIC X.
  1178         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1179         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1180                                                   LOW-VALUES.
  1181
  1182     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1183     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1184         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1185         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1186
  1187     12  PI-PROCESSOR-CSR-IND            PIC X.
  1188         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1189         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1190
  1191     12  FILLER                          PIC X(3).
  1192
  1193     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1194
  1195     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1196         PI-SYSTEM-LEVEL.
  1197
  1198         16  PI-ENTRY-CODES.
  1199             20  PI-ENTRY-CD-1           PIC X.
  1200             20  PI-ENTRY-CD-2           PIC X.
  1201
  1202         16  PI-RETURN-CODES.
  1203             20  PI-RETURN-CD-1          PIC X.
  1204             20  PI-RETURN-CD-2          PIC X.
  1205
  1206         16  PI-UPDATE-STATUS-SAVE.
  1207             20  PI-UPDATE-BY            PIC X(4).
  1208             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1209
  1210         16  PI-LOWER-CASE-LETTERS       PIC X.
  1211             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1212
  1213*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1214*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1215*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1216
  1217         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1218             88  ST-ACCNT-CNTL               VALUE ' '.
  1219             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1220             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1221             88  ACCNT-CNTL                  VALUE '3'.
  1222             88  CARR-ACCNT-CNTL             VALUE '4'.
  1223
  1224         16  PI-PROCESSOR-CAP-LIST.
  1225             20  PI-SYSTEM-CONTROLS.
  1226                24 PI-SYSTEM-DISPLAY     PIC X.
  1227                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1228                24 PI-SYSTEM-MODIFY      PIC X.
  1229                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1230             20  FILLER                  PIC XX.
  1231             20  PI-DISPLAY-CAP          PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  23
* EL677.cbl
  1232                 88  DISPLAY-CAP             VALUE 'Y'.
  1233             20  PI-MODIFY-CAP           PIC X.
  1234                 88  MODIFY-CAP              VALUE 'Y'.
  1235             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1236                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1237             20  PI-FORCE-CAP            PIC X.
  1238                 88  FORCE-CAP               VALUE 'Y'.
  1239
  1240         16  PI-PROGRAM-CONTROLS.
  1241             20  PI-PGM-PRINT-OPT        PIC X.
  1242             20  PI-PGM-FORMAT-OPT       PIC X.
  1243             20  PI-PGM-PROCESS-OPT      PIC X.
  1244             20  PI-PGM-TOTALS-OPT       PIC X.
  1245
  1246         16  PI-HELP-INTERFACE.
  1247             20  PI-LAST-ERROR-NO        PIC X(4).
  1248             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1249
  1250         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1251             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1252
  1253         16  PI-CR-CONTROL-IN-PROGRESS.
  1254             20  PI-CR-CARRIER           PIC X.
  1255             20  PI-CR-GROUPING          PIC X(6).
  1256             20  PI-CR-STATE             PIC XX.
  1257             20  PI-CR-ACCOUNT           PIC X(10).
  1258             20  PI-CR-FIN-RESP          PIC X(10).
  1259             20  PI-CR-TYPE              PIC X.
  1260
  1261         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1262
  1263         16  PI-CR-MONTH-END-DT          PIC XX.
  1264
  1265         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1266             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1267             88  PI-ZERO-CARRIER             VALUE '1'.
  1268             88  PI-ZERO-GROUPING            VALUE '2'.
  1269             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1270
  1271         16  PI-CARRIER-SECURITY         PIC X.
  1272             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1273
  1274         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1275             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1276             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1277
  1278         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1279             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1280                                         INDEXED BY PI-ACCESS-NDX
  1281                                         PIC X.
  1282
  1283         16  PI-GA-BILLING-CONTROL       PIC X.
  1284             88  PI-GA-BILLING               VALUE '1'.
  1285
  1286         16  PI-MAIL-PROCESSING          PIC X.
  1287             88  PI-MAIL-YES                 VALUE 'Y'.
  1288
  1289         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  24
* EL677.cbl
  1290
  1291         16  PI-AR-SYSTEM.
  1292             20  PI-AR-PROCESSING-CNTL   PIC X.
  1293                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1294             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1295             20  PI-AR-MONTH-END-DT      PIC XX.
  1296
  1297         16  PI-MP-SYSTEM.
  1298             20  PI-MORTGAGE-USER            PIC X.
  1299                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1300                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1301             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1302                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1303                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1304                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1305                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1306                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1307             20  PI-MP-MONTH-END-DT          PIC XX.
  1308             20  PI-MP-REFERENCE-NO.
  1309                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1310                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1311
  1312         16  PI-LABEL-CONTROL            PIC X(01).
  1313             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1314             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1315
  1316         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1317             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1318
  1319         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1320             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1321             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1322
  1323         16  FILLER                      PIC X(14).
  1324
  1325     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1326******************************************************************
  1327     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1328         16  PI-EOF-SW               PIC X.
  1329             88  PI-FILE-EOF                     VALUE 'Y'.
  1330         16  PI-PREV-MAINT           PIC X.
  1331         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1332         16  PI-ERCHEK-KEY.
  1333             20  PI-CHEK-COMP-CD     PIC X.
  1334             20  PI-CHEK-CARRIER     PIC X.
  1335             20  PI-CHEK-GROUPING    PIC X(6).
  1336             20  PI-CHEK-STATE       PIC XX.
  1337             20  PI-CHEK-ACCOUNT     PIC X(10).
  1338             20  PI-CHEK-EFF-DT      PIC XX.
  1339             20  PI-CHEK-CERT-NO     PIC X(10).
  1340             20  PI-CHEK-SUF-NO      PIC X.
  1341             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1342         16  PI-ACCOUNT-ADDRESS.
  1343             20  PI-AM-NAME          PIC X(30).
  1344             20  PI-AM-ADDRS         PIC X(30).
  1345             20  PI-AM-CITY-st.
  1346                 24  pi-am-city      PIC X(28).
  1347                 24  pi-am-st        pic xx.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  25
* EL677.cbl
  1348             20  PI-AM-ZIP-CODE.
  1349                 24  PI-AM-ZIP-PRIME PIC X(5).
  1350                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1351         16  PI-PROCESS-CERT-SW          PIC X.
  1352             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1353         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1354             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1355         16  PI-PAYTO1                   PIC X(30).
  1356         16  PI-REFERENCE                PIC X(12).
  1357         16  PI-CANC-DT                  PIC XX.
  1358         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1359         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1360         16  PI-INSURED-NAME             PIC X(28).
  1361         16  PI-PFKEY                    PIC XXX.
  1362             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1363             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1364         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1365         16  PI-TYPE                     PIC X.
  1366         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1367         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1368         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1369         16  pi-chek-rec-cnt             pic s999 comp-3.
  1370         16  pi-am-csr                   pic x(4).
  1371         16  pi-return-to                pic x(30).
  1372         16  pi-prev-ded-comm            pic x.
  1373         16  pi-table-name               pic x(30).
  1374         16  pi-check-cashed             pic x.
  1375         16  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1376         16  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1377         16  pi-check-type               pic x.
  1378             88  ws-corr-check              value 'C'.
  1379             88  ws-ref-check               value 'R'.
  1380         16  pi-check-cut                pic x.
  1381         16  pi-prev-paid-this-month     pic s9(7)v99 comp-3.
  1382         16  FILLER                      PIC X(306). *> wass 311
  1383*                                    COPY ELCAID.
  1384******************************************************************
  1385*                                                                *
  1386*                            ELCAID.                             *
  1387*                            VMOD=2.001                          *
  1388*                                                                *
  1389*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1390*                                                                *
  1391*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1392*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1393******************************************************************
  1394
  1395 01  DFHAID.
  1396   02  DFHNULL   PIC  X  VALUE  ' '.
  1397   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1398   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1399   02  DFHPEN    PIC  X  VALUE  '='.
  1400   02  DFHOPID   PIC  X  VALUE  'W'.
  1401   02  DFHPA1    PIC  X  VALUE  '%'.
  1402   02  DFHPA2    PIC  X  VALUE  '>'.
  1403   02  DFHPA3    PIC  X  VALUE  ','.
  1404   02  DFHPF1    PIC  X  VALUE  '1'.
  1405   02  DFHPF2    PIC  X  VALUE  '2'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  26
* EL677.cbl
  1406   02  DFHPF3    PIC  X  VALUE  '3'.
  1407   02  DFHPF4    PIC  X  VALUE  '4'.
  1408   02  DFHPF5    PIC  X  VALUE  '5'.
  1409   02  DFHPF6    PIC  X  VALUE  '6'.
  1410   02  DFHPF7    PIC  X  VALUE  '7'.
  1411   02  DFHPF8    PIC  X  VALUE  '8'.
  1412   02  DFHPF9    PIC  X  VALUE  '9'.
  1413   02  DFHPF10   PIC  X  VALUE  ':'.
  1414   02  DFHPF11   PIC  X  VALUE  '#'.
  1415   02  DFHPF12   PIC  X  VALUE  '@'.
  1416   02  DFHPF13   PIC  X  VALUE  'A'.
  1417   02  DFHPF14   PIC  X  VALUE  'B'.
  1418   02  DFHPF15   PIC  X  VALUE  'C'.
  1419   02  DFHPF16   PIC  X  VALUE  'D'.
  1420   02  DFHPF17   PIC  X  VALUE  'E'.
  1421   02  DFHPF18   PIC  X  VALUE  'F'.
  1422   02  DFHPF19   PIC  X  VALUE  'G'.
  1423   02  DFHPF20   PIC  X  VALUE  'H'.
  1424   02  DFHPF21   PIC  X  VALUE  'I'.
  1425*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1426   02  DFHPF22   PIC  X  VALUE  '['.
  1427   02  DFHPF23   PIC  X  VALUE  '.'.
  1428   02  DFHPF24   PIC  X  VALUE  '<'.
  1429   02  DFHMSRE   PIC  X  VALUE  'X'.
  1430   02  DFHSTRF   PIC  X  VALUE  'h'.
  1431   02  DFHTRIG   PIC  X  VALUE  '"'.
  1432 01  FILLER    REDEFINES DFHAID.
  1433     12  FILLER                      PIC X(8).
  1434     12  PF-VALUES                   PIC X       OCCURS 24.
  1435     12  FILLER                      PIC X(3).
  1436*                                    COPY EL677S.
  1437 01  EL677AI.
  1438     05  FILLER            PIC  X(0012).
  1439*    -------------------------------
  1440     05  DATEL PIC S9(0004) COMP.
  1441     05  DATEF PIC  X(0001).
  1442     05  FILLER REDEFINES DATEF.
  1443         10  DATEA PIC  X(0001).
  1444     05  DATEI PIC  X(0008).
  1445*    -------------------------------
  1446     05  TIMEL PIC S9(0004) COMP.
  1447     05  TIMEF PIC  X(0001).
  1448     05  FILLER REDEFINES TIMEF.
  1449         10  TIMEA PIC  X(0001).
  1450     05  TIMEI PIC  X(0005).
  1451*    -------------------------------
  1452     05  MAINTL PIC S9(0004) COMP.
  1453     05  MAINTF PIC  X(0001).
  1454     05  FILLER REDEFINES MAINTF.
  1455         10  MAINTA PIC  X(0001).
  1456     05  MAINTI PIC  X(0001).
  1457*    -------------------------------
  1458     05  DMAINT1L PIC S9(0004) COMP.
  1459     05  DMAINT1F PIC  X(0001).
  1460     05  FILLER REDEFINES DMAINT1F.
  1461         10  DMAINT1A PIC  X(0001).
  1462     05  DMAINT1I PIC  X(0009).
  1463*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  27
* EL677.cbl
  1464     05  DMAINT2L PIC S9(0004) COMP.
  1465     05  DMAINT2F PIC  X(0001).
  1466     05  FILLER REDEFINES DMAINT2F.
  1467         10  DMAINT2A PIC  X(0001).
  1468     05  DMAINT2I PIC  X(0029).
  1469*    -------------------------------
  1470     05  CARRIERL PIC S9(0004) COMP.
  1471     05  CARRIERF PIC  X(0001).
  1472     05  FILLER REDEFINES CARRIERF.
  1473         10  CARRIERA PIC  X(0001).
  1474     05  CARRIERI PIC  X(0001).
  1475*    -------------------------------
  1476     05  GROUPL PIC S9(0004) COMP.
  1477     05  GROUPF PIC  X(0001).
  1478     05  FILLER REDEFINES GROUPF.
  1479         10  GROUPA PIC  X(0001).
  1480     05  GROUPI PIC  X(0006).
  1481*    -------------------------------
  1482     05  STATEL PIC S9(0004) COMP.
  1483     05  STATEF PIC  X(0001).
  1484     05  FILLER REDEFINES STATEF.
  1485         10  STATEA PIC  X(0001).
  1486     05  STATEI PIC  X(0002).
  1487*    -------------------------------
  1488     05  ACCTL PIC S9(0004) COMP.
  1489     05  ACCTF PIC  X(0001).
  1490     05  FILLER REDEFINES ACCTF.
  1491         10  ACCTA PIC  X(0001).
  1492     05  ACCTI PIC  X(0010).
  1493*    -------------------------------
  1494     05  EFFDTL PIC S9(0004) COMP.
  1495     05  EFFDTF PIC  X(0001).
  1496     05  FILLER REDEFINES EFFDTF.
  1497         10  EFFDTA PIC  X(0001).
  1498     05  EFFDTI PIC  X(0008).
  1499*    -------------------------------
  1500     05  CERTNOL PIC S9(0004) COMP.
  1501     05  CERTNOF PIC  X(0001).
  1502     05  FILLER REDEFINES CERTNOF.
  1503         10  CERTNOA PIC  X(0001).
  1504     05  CERTNOI PIC  X(0010).
  1505*    -------------------------------
  1506     05  SFXL PIC S9(0004) COMP.
  1507     05  SFXF PIC  X(0001).
  1508     05  FILLER REDEFINES SFXF.
  1509         10  SFXA PIC  X(0001).
  1510     05  SFXI PIC  X(0001).
  1511*    -------------------------------
  1512     05  SEQL PIC S9(0004) COMP.
  1513     05  SEQF PIC  X(0001).
  1514     05  FILLER REDEFINES SEQF.
  1515         10  SEQA PIC  X(0001).
  1516     05  SEQI PIC  99.
  1517*    -------------------------------
  1518     05  PAYTO1L PIC S9(0004) COMP.
  1519     05  PAYTO1F PIC  X(0001).
  1520     05  FILLER REDEFINES PAYTO1F.
  1521         10  PAYTO1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  28
* EL677.cbl
  1522     05  PAYTO1I PIC  X(0030).
  1523*    -------------------------------
  1524     05  CREATEDL PIC S9(0004) COMP.
  1525     05  CREATEDF PIC  X(0001).
  1526     05  FILLER REDEFINES CREATEDF.
  1527         10  CREATEDA PIC  X(0001).
  1528     05  CREATEDI PIC  X(0008).
  1529*    -------------------------------
  1530     05  CBYL PIC S9(0004) COMP.
  1531     05  CBYF PIC  X(0001).
  1532     05  FILLER REDEFINES CBYF.
  1533         10  CBYA PIC  X(0001).
  1534     05  CBYI PIC  X(0004).
  1535*    -------------------------------
  1536     05  PAYTO2L PIC S9(0004) COMP.
  1537     05  PAYTO2F PIC  X(0001).
  1538     05  FILLER REDEFINES PAYTO2F.
  1539         10  PAYTO2A PIC  X(0001).
  1540     05  PAYTO2I PIC  X(0030).
  1541*    -------------------------------
  1542     05  PAYEEL PIC S9(0004) COMP.
  1543     05  PAYEEF PIC  X(0001).
  1544     05  FILLER REDEFINES PAYEEF.
  1545         10  PAYEEA PIC  X(0001).
  1546     05  PAYEEI PIC  X(0006).
  1547*    -------------------------------
  1548     05  APVSTATL PIC S9(0004) COMP.
  1549     05  APVSTATF PIC  X(0001).
  1550     05  FILLER REDEFINES APVSTATF.
  1551         10  APVSTATA PIC  X(0001).
  1552     05  APVSTATI PIC  X(0009).
  1553*    -------------------------------
  1554     05  PAYAD1L PIC S9(0004) COMP.
  1555     05  PAYAD1F PIC  X(0001).
  1556     05  FILLER REDEFINES PAYAD1F.
  1557         10  PAYAD1A PIC  X(0001).
  1558     05  PAYAD1I PIC  X(0030).
  1559*    -------------------------------
  1560     05  APVDTL PIC S9(0004) COMP.
  1561     05  APVDTF PIC  X(0001).
  1562     05  FILLER REDEFINES APVDTF.
  1563         10  APVDTA PIC  X(0001).
  1564     05  APVDTI PIC  X(0008).
  1565*    -------------------------------
  1566     05  APVBYL PIC S9(0004) COMP.
  1567     05  APVBYF PIC  X(0001).
  1568     05  FILLER REDEFINES APVBYF.
  1569         10  APVBYA PIC  X(0001).
  1570     05  APVBYI PIC  X(0004).
  1571*    -------------------------------
  1572     05  PAYAD2L PIC S9(0004) COMP.
  1573     05  PAYAD2F PIC  X(0001).
  1574     05  FILLER REDEFINES PAYAD2F.
  1575         10  PAYAD2A PIC  X(0001).
  1576     05  PAYAD2I PIC  X(0030).
  1577*    -------------------------------
  1578     05  VOIDEDL PIC S9(0004) COMP.
  1579     05  VOIDEDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  29
* EL677.cbl
  1580     05  FILLER REDEFINES VOIDEDF.
  1581         10  VOIDEDA PIC  X(0001).
  1582     05  VOIDEDI PIC  X(0008).
  1583*    -------------------------------
  1584     05  VBYL PIC S9(0004) COMP.
  1585     05  VBYF PIC  X(0001).
  1586     05  FILLER REDEFINES VBYF.
  1587         10  VBYA PIC  X(0001).
  1588     05  VBYI PIC  X(0004).
  1589*    -------------------------------
  1590     05  PAYCTYL PIC S9(0004) COMP.
  1591     05  PAYCTYF PIC  X(0001).
  1592     05  FILLER REDEFINES PAYCTYF.
  1593         10  PAYCTYA PIC  X(0001).
  1594     05  PAYCTYI PIC  X(0028).
  1595*    -------------------------------
  1596     05  PAYSTL PIC S9(0004) COMP.
  1597     05  PAYSTF PIC  X(0001).
  1598     05  FILLER REDEFINES PAYSTF.
  1599         10  PAYSTA PIC  X(0001).
  1600     05  PAYSTI PIC  X(0002).
  1601*    -------------------------------
  1602     05  PRINTEDL PIC S9(0004) COMP.
  1603     05  PRINTEDF PIC  X(0001).
  1604     05  FILLER REDEFINES PRINTEDF.
  1605         10  PRINTEDA PIC  X(0001).
  1606     05  PRINTEDI PIC  X(0008).
  1607*    -------------------------------
  1608     05  PTOZIPL PIC S9(0004) COMP.
  1609     05  PTOZIPF PIC  X(0001).
  1610     05  FILLER REDEFINES PTOZIPF.
  1611         10  PTOZIPA PIC  X(0001).
  1612     05  PTOZIPI PIC  X(0009).
  1613*    -------------------------------
  1614     05  DEDCYNL PIC S9(0004) COMP.
  1615     05  DEDCYNF PIC  X(0001).
  1616     05  FILLER REDEFINES DEDCYNF.
  1617         10  DEDCYNA PIC  X(0001).
  1618     05  DEDCYNI PIC  X(0001).
  1619*    -------------------------------
  1620     05  CASHEDL PIC S9(0004) COMP.
  1621     05  CASHEDF PIC  X(0001).
  1622     05  FILLER REDEFINES CASHEDF.
  1623         10  CASHEDA PIC  X(0001).
  1624     05  CASHEDI PIC  X(0008).
  1625*    -------------------------------
  1626     05  RETTOL PIC S9(0004) COMP.
  1627     05  RETTOF PIC  X(0001).
  1628     05  FILLER REDEFINES RETTOF.
  1629         10  RETTOA PIC  X(0001).
  1630     05  RETTOI PIC  X(0030).
  1631*    -------------------------------
  1632     05  DPREML PIC S9(0004) COMP.
  1633     05  DPREMF PIC  X(0001).
  1634     05  FILLER REDEFINES DPREMF.
  1635         10  DPREMA PIC  X(0001).
  1636     05  DPREMI PIC  X(0005).
  1637*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  30
* EL677.cbl
  1638     05  PREML PIC S9(0004) COMP.
  1639     05  PREMF PIC  X(0001).
  1640     05  FILLER REDEFINES PREMF.
  1641         10  PREMA PIC  X(0001).
  1642     05  PREMI PIC  X(0008).
  1643*    -------------------------------
  1644     05  DCOMML PIC S9(0004) COMP.
  1645     05  DCOMMF PIC  X(0001).
  1646     05  FILLER REDEFINES DCOMMF.
  1647         10  DCOMMA PIC  X(0001).
  1648     05  DCOMMI PIC  X(0005).
  1649*    -------------------------------
  1650     05  ISSCOMML PIC S9(0004) COMP.
  1651     05  ISSCOMMF PIC  X(0001).
  1652     05  FILLER REDEFINES ISSCOMMF.
  1653         10  ISSCOMMA PIC  X(0001).
  1654     05  ISSCOMMI PIC  X(0008).
  1655*    -------------------------------
  1656     05  DREFL PIC S9(0004) COMP.
  1657     05  DREFF PIC  X(0001).
  1658     05  FILLER REDEFINES DREFF.
  1659         10  DREFA PIC  X(0001).
  1660     05  DREFI PIC  X(0004).
  1661*    -------------------------------
  1662     05  REFL PIC S9(0004) COMP.
  1663     05  REFF PIC  X(0001).
  1664     05  FILLER REDEFINES REFF.
  1665         10  REFA PIC  X(0001).
  1666     05  REFI PIC  X(0008).
  1667*    -------------------------------
  1668     05  DUECOMML PIC S9(0004) COMP.
  1669     05  DUECOMMF PIC  X(0001).
  1670     05  FILLER REDEFINES DUECOMMF.
  1671         10  DUECOMMA PIC  X(0001).
  1672     05  DUECOMMI PIC  X(0007).
  1673*    -------------------------------
  1674     05  UECOMML PIC S9(0004) COMP.
  1675     05  UECOMMF PIC  X(0001).
  1676     05  FILLER REDEFINES UECOMMF.
  1677         10  UECOMMA PIC  X(0001).
  1678     05  UECOMMI PIC  X(0008).
  1679*    -------------------------------
  1680     05  DPREPDL PIC S9(0004) COMP.
  1681     05  DPREPDF PIC  X(0001).
  1682     05  FILLER REDEFINES DPREPDF.
  1683         10  DPREPDA PIC  X(0001).
  1684     05  DPREPDI PIC  X(0006).
  1685*    -------------------------------
  1686     05  PREPDL PIC S9(0004) COMP.
  1687     05  PREPDF PIC  X(0001).
  1688     05  FILLER REDEFINES PREPDF.
  1689         10  PREPDA PIC  X(0001).
  1690     05  PREPDI PIC  X(0008).
  1691*    -------------------------------
  1692     05  AMOUNTL PIC S9(0004) COMP.
  1693     05  AMOUNTF PIC  X(0001).
  1694     05  FILLER REDEFINES AMOUNTF.
  1695         10  AMOUNTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  31
* EL677.cbl
  1696     05  AMOUNTI PIC  S9(9)V99.
  1697*    -------------------------------
  1698     05  CHECKL PIC S9(0004) COMP.
  1699     05  CHECKF PIC  X(0001).
  1700     05  FILLER REDEFINES CHECKF.
  1701         10  CHECKA PIC  X(0001).
  1702     05  CHECKI PIC  X(0007).
  1703*    -------------------------------
  1704     05  TYPEL PIC S9(0004) COMP.
  1705     05  TYPEF PIC  X(0001).
  1706     05  FILLER REDEFINES TYPEF.
  1707         10  TYPEA PIC  X(0001).
  1708     05  TYPEI PIC  X(0001).
  1709*    -------------------------------
  1710     05  REASONL PIC S9(0004) COMP.
  1711     05  REASONF PIC  X(0001).
  1712     05  FILLER REDEFINES REASONF.
  1713         10  REASONA PIC  X(0001).
  1714     05  REASONI PIC  X(0025).
  1715*    -------------------------------
  1716     05  VREASONL PIC S9(0004) COMP.
  1717     05  VREASONF PIC  X(0001).
  1718     05  FILLER REDEFINES VREASONF.
  1719         10  VREASONA PIC  X(0001).
  1720     05  VREASONI PIC  X(0024).
  1721*    -------------------------------
  1722     05  STUBL PIC S9(0004) COMP.
  1723     05  STUBF PIC  X(0001).
  1724     05  FILLER REDEFINES STUBF.
  1725         10  STUBA PIC  X(0001).
  1726     05  STUBI PIC  X(0030).
  1727*    -------------------------------
  1728     05  TEXT1L PIC S9(0004) COMP.
  1729     05  TEXT1F PIC  X(0001).
  1730     05  FILLER REDEFINES TEXT1F.
  1731         10  TEXT1A PIC  X(0001).
  1732     05  TEXT1I PIC  X(0050).
  1733*    -------------------------------
  1734     05  TEXT2L PIC S9(0004) COMP.
  1735     05  TEXT2F PIC  X(0001).
  1736     05  FILLER REDEFINES TEXT2F.
  1737         10  TEXT2A PIC  X(0001).
  1738     05  TEXT2I PIC  X(0050).
  1739*    -------------------------------
  1740     05  TEXT3L PIC S9(0004) COMP.
  1741     05  TEXT3F PIC  X(0001).
  1742     05  FILLER REDEFINES TEXT3F.
  1743         10  TEXT3A PIC  X(0001).
  1744     05  TEXT3I PIC  X(0040).
  1745*    -------------------------------
  1746     05  ERRMSG1L PIC S9(0004) COMP.
  1747     05  ERRMSG1F PIC  X(0001).
  1748     05  FILLER REDEFINES ERRMSG1F.
  1749         10  ERRMSG1A PIC  X(0001).
  1750     05  ERRMSG1I PIC  X(0079).
  1751*    -------------------------------
  1752     05  ERRMSG2L PIC S9(0004) COMP.
  1753     05  ERRMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  32
* EL677.cbl
  1754     05  FILLER REDEFINES ERRMSG2F.
  1755         10  ERRMSG2A PIC  X(0001).
  1756     05  ERRMSG2I PIC  X(0079).
  1757*    -------------------------------
  1758     05  PFENTERL PIC S9(0004) COMP.
  1759     05  PFENTERF PIC  X(0001).
  1760     05  FILLER REDEFINES PFENTERF.
  1761         10  PFENTERA PIC  X(0001).
  1762     05  PFENTERI PIC  9(2).
  1763*    -------------------------------
  1764     05  PF357L PIC S9(0004) COMP.
  1765     05  PF357F PIC  X(0001).
  1766     05  FILLER REDEFINES PF357F.
  1767         10  PF357A PIC  X(0001).
  1768     05  PF357I PIC  X(0050).
  1769*    -------------------------------
  1770     05  PF46L PIC S9(0004) COMP.
  1771     05  PF46F PIC  X(0001).
  1772     05  FILLER REDEFINES PF46F.
  1773         10  PF46A PIC  X(0001).
  1774     05  PF46I PIC  X(0033).
  1775 01  EL677AO REDEFINES EL677AI.
  1776     05  FILLER            PIC  X(0012).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  DATEO PIC  X(0008).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  TIMEO PIC  99.99.
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  MAINTO PIC  X(0001).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  DMAINT1O PIC  X(0009).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  DMAINT2O PIC  X(0029).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  CARRIERO PIC  X(0001).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  GROUPO PIC  X(0006).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  STATEO PIC  X(0002).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  ACCTO PIC  X(0010).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  EFFDTO PIC  99B99B99.
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  CERTNOO PIC  X(0010).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  33
* EL677.cbl
  1812     05  SFXO PIC  X(0001).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  SEQO PIC  99.
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  PAYTO1O PIC  X(0030).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  CREATEDO PIC  X(0008).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  CBYO PIC  X(0004).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  PAYTO2O PIC  X(0030).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  PAYEEO PIC  X(0006).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  APVSTATO PIC  X(0009).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  PAYAD1O PIC  X(0030).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  APVDTO PIC  X(0008).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  APVBYO PIC  X(0004).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  PAYAD2O PIC  X(0030).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  VOIDEDO PIC  X(0008).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  VBYO PIC  X(0004).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  PAYCTYO PIC  X(0028).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  PAYSTO PIC  X(0002).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  PRINTEDO PIC  99B99B99.
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  PTOZIPO PIC  X(0009).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  DEDCYNO PIC  X(0001).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  CASHEDO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  34
* EL677.cbl
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  RETTOO PIC  X(0030).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  DPREMO PIC  X(0005).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  PREMO PIC  Z(5).99.
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  DCOMMO PIC  X(0005).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  ISSCOMMO PIC  Z(5).99.
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  DREFO PIC  X(0004).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  REFO PIC  Z(5).99.
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  DUECOMMO PIC  X(0007).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  UECOMMO PIC  Z(5).99.
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  DPREPDO PIC  X(0006).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  PREPDO PIC  Z(5).99.
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  AMOUNTO PIC  Z(7).ZZ-.
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  CHECKO PIC  X(0007).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  TYPEO PIC  X(0001).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  REASONO PIC  X(0025).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  VREASONO PIC  X(0024).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  STUBO PIC  X(0030).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  TEXT1O PIC  X(0050).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  TEXT2O PIC  X(0050).
  1927*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  35
* EL677.cbl
  1928     05  FILLER            PIC  X(0003).
  1929     05  TEXT3O PIC  X(0040).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  ERRMSG1O PIC  X(0079).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  ERRMSG2O PIC  X(0079).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  PFENTERO PIC  99.
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  PF357O PIC  X(0050).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  PF46O PIC  X(0033).
  1945*    -------------------------------
  1946****************************************************************
  1947*
  1948* Copyright (c) 2007 by Clerity Solutions, Inc.
  1949* All rights reserved.
  1950*
  1951****************************************************************
  1952 01  DFHEIV.
  1953   02  DFHEIV0               PIC X(35).
  1954   02  DFHEIV1               PIC X(08).
  1955   02  DFHEIV2               PIC X(08).
  1956   02  DFHEIV3               PIC X(08).
  1957   02  DFHEIV4               PIC X(06).
  1958   02  DFHEIV5               PIC X(04).
  1959   02  DFHEIV6               PIC X(04).
  1960   02  DFHEIV7               PIC X(02).
  1961   02  DFHEIV8               PIC X(02).
  1962   02  DFHEIV9               PIC X(01).
  1963   02  DFHEIV10              PIC S9(7) COMP-3.
  1964   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1965   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1966   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1967   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1968   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1969   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1970   02  DFHEIV17              PIC X(04).
  1971   02  DFHEIV18              PIC X(04).
  1972   02  DFHEIV19              PIC X(04).
  1973   02  DFHEIV20              USAGE IS POINTER.
  1974   02  DFHEIV21              USAGE IS POINTER.
  1975   02  DFHEIV22              USAGE IS POINTER.
  1976   02  DFHEIV23              USAGE IS POINTER.
  1977   02  DFHEIV24              USAGE IS POINTER.
  1978   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1979   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1980   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1981   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1982   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1983   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1984   02  FILLER                PIC X(02).
  1985   02  DFHEIV99              PIC X(08) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  36
* EL677.cbl
  1986   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1987   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1988   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1989   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1990 LINKAGE  SECTION.
  1991*****************************************************************
  1992*                                                               *
  1993* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1994* All rights reserved.                                          *
  1995*                                                               *
  1996*****************************************************************
  1997 01  dfheiblk.
  1998     02  eibtime          pic s9(7) comp-3.
  1999     02  eibdate          pic s9(7) comp-3.
  2000     02  eibtrnid         pic x(4).
  2001     02  eibtaskn         pic s9(7) comp-3.
  2002     02  eibtrmid         pic x(4).
  2003     02  dfheigdi         pic s9(4) comp.
  2004     02  eibcposn         pic s9(4) comp.
  2005     02  eibcalen         pic s9(4) comp.
  2006     02  eibaid           pic x(1).
  2007     02  eibfiller1       pic x(1).
  2008     02  eibfn            pic x(2).
  2009     02  eibfiller2       pic x(2).
  2010     02  eibrcode         pic x(6).
  2011     02  eibfiller3       pic x(2).
  2012     02  eibds            pic x(8).
  2013     02  eibreqid         pic x(8).
  2014     02  eibrsrce         pic x(8).
  2015     02  eibsync          pic x(1).
  2016     02  eibfree          pic x(1).
  2017     02  eibrecv          pic x(1).
  2018     02  eibsend          pic x(1).
  2019     02  eibatt           pic x(1).
  2020     02  eibeoc           pic x(1).
  2021     02  eibfmh           pic x(1).
  2022     02  eibcompl         pic x(1).
  2023     02  eibsig           pic x(1).
  2024     02  eibconf          pic x(1).
  2025     02  eiberr           pic x(1).
  2026     02  eibrldbk         pic x(1).
  2027     02  eiberrcd         pic x(4).
  2028     02  eibsynrb         pic x(1).
  2029     02  eibnodat         pic x(1).
  2030     02  eibfiller5       pic x(2).
  2031     02  eibresp          pic 9(09) comp.
  2032     02  eibresp2         pic 9(09) comp.
  2033     02  dfheigdj         pic s9(4) comp.
  2034     02  dfheigdk         pic s9(4) comp.
  2035 01  DFHCOMMAREA.
  2036     05  filler                  PIC X(1024).
  2037 01  var  pic x(30).
  2038*                                    COPY ELCCNTL.
  2039******************************************************************
  2040*                                                                *
  2041*                                                                *
  2042*                            ELCCNTL.                            *
  2043*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  37
* EL677.cbl
  2044*                            VMOD=2.059                          *
  2045*                                                                *
  2046*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2047*                                                                *
  2048*   FILE TYPE = VSAM,KSDS                                        *
  2049*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2050*                                                                *
  2051*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2052*       ALTERNATE INDEX = NONE                                   *
  2053*                                                                *
  2054*   LOG = YES                                                    *
  2055*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2056******************************************************************
  2057*                   C H A N G E   L O G
  2058*
  2059* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2060*-----------------------------------------------------------------
  2061*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2062* EFFECTIVE    NUMBER
  2063*-----------------------------------------------------------------
  2064* 082503                   PEMA  ADD BENEFIT GROUP
  2065* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2066* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2067* 092705    2005050300006  PEMA  ADD SPP LEASES
  2068* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2069* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2070* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2071* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2072* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2073* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2074* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2075* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2076* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2077* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2078******************************************************************
  2079*
  2080 01  CONTROL-FILE.
  2081     12  CF-RECORD-ID                       PIC XX.
  2082         88  VALID-CF-ID                        VALUE 'CF'.
  2083
  2084     12  CF-CONTROL-PRIMARY.
  2085         16  CF-COMPANY-ID                  PIC XXX.
  2086         16  CF-RECORD-TYPE                 PIC X.
  2087             88  CF-COMPANY-MASTER              VALUE '1'.
  2088             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2089             88  CF-STATE-MASTER                VALUE '3'.
  2090             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2091             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2092             88  CF-CARRIER-MASTER              VALUE '6'.
  2093             88  CF-MORTALITY-MASTER            VALUE '7'.
  2094             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2095             88  CF-TERMINAL-MASTER             VALUE '9'.
  2096             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2097             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2098             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2099             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2100             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2101             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  38
* EL677.cbl
  2102             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2103             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2104             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2105         16  CF-ACCESS-CD-GENL              PIC X(4).
  2106         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2107             20  CF-PROCESSOR               PIC X(4).
  2108         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2109             20  CF-STATE-CODE              PIC XX.
  2110             20  FILLER                     PIC XX.
  2111         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2112             20  FILLER                     PIC XX.
  2113             20  CF-HI-BEN-IN-REC           PIC XX.
  2114         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2115             20  FILLER                     PIC XXX.
  2116             20  CF-CARRIER-CNTL            PIC X.
  2117         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2118             20  FILLER                     PIC XX.
  2119             20  CF-HI-TYPE-IN-REC          PIC 99.
  2120         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2121             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2122                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2123             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2124             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2125         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2126             20  FILLER                     PIC X.
  2127             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2128         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2129             20  FILLER                     PIC XX.
  2130             20  CF-MORTGAGE-PLAN           PIC XX.
  2131         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2132
  2133     12  CF-LAST-MAINT-DT                   PIC XX.
  2134     12  CF-LAST-MAINT-BY                   PIC X(4).
  2135     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2136
  2137     12  CF-RECORD-BODY                     PIC X(728).
  2138
  2139
  2140****************************************************************
  2141*             COMPANY MASTER RECORD                            *
  2142****************************************************************
  2143
  2144     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2145         16  CF-COMPANY-ADDRESS.
  2146             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2147             20  CF-CL-IN-CARE-OF           PIC X(30).
  2148             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2149             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2150             20  CF-CL-CITY-STATE           PIC X(30).
  2151             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2152             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2153         16  CF-COMPANY-CD                  PIC X.
  2154         16  CF-COMPANY-PASSWORD            PIC X(8).
  2155         16  CF-SECURITY-OPTION             PIC X.
  2156             88  ALL-SECURITY                   VALUE '1'.
  2157             88  COMPANY-VERIFY                 VALUE '2'.
  2158             88  PROCESSOR-VERIFY               VALUE '3'.
  2159             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  39
* EL677.cbl
  2160             88  ALL-BUT-TERM                   VALUE '5'.
  2161         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2162             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2163         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2164             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2165         16  CF-INFORCE-LOCATION            PIC X.
  2166             88  CERTS-ARE-ONLINE               VALUE '1'.
  2167             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2168             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2169         16  CF-LOWER-CASE-LETTERS          PIC X.
  2170         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2171             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2172             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2173             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2174             88  CF-ACCNT-CNTL                  VALUE '3'.
  2175             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2176
  2177         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2178         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2179
  2180         16  CF-LGX-CREDIT-USER             PIC X.
  2181             88  CO-IS-NOT-USER                 VALUE 'N'.
  2182             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2183
  2184         16 CF-CREDIT-CALC-CODES.
  2185             20  CF-CR-REM-TERM-CALC PIC X.
  2186               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2187               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2188               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2189               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2190               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2191               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2192               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2193             20  CF-CR-R78-METHOD           PIC X.
  2194               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2195               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2196
  2197         16  CF-CLAIM-CONTROL-COUNTS.
  2198             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2199                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2200
  2201             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2202                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2203
  2204             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2205                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2206
  2207             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2208                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2209
  2210         16  CF-CURRENT-MONTH-END           PIC XX.
  2211
  2212         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2213             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2214             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2215             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2216             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2217                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  40
* EL677.cbl
  2218                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2219             20  CF-CO-PREM-REJECT-SW       PIC X.
  2220                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2221                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2222             20  CF-CO-REF-REJECT-SW        PIC X.
  2223                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2224                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2225
  2226         16  CF-CO-REPORTING-DT             PIC XX.
  2227         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2228         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2229           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2230           88  CF-CO-MONTH-END                  VALUE '1'.
  2231
  2232         16  CF-LGX-CLAIM-USER              PIC X.
  2233             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2234             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2235
  2236         16  CF-CREDIT-EDIT-CONTROLS.
  2237             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2238             20  CF-MIN-AGE                 PIC 99.
  2239             20  CF-DEFAULT-AGE             PIC 99.
  2240             20  CF-MIN-TERM                PIC S999      COMP-3.
  2241             20  CF-MAX-TERM                PIC S999      COMP-3.
  2242             20  CF-DEFAULT-SEX             PIC X.
  2243             20  CF-JOINT-AGE-INPUT         PIC X.
  2244                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2245             20  CF-BIRTH-DATE-INPUT        PIC X.
  2246                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2247             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2248                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2249                 88  CF-ZERO-CARRIER            VALUE '1'.
  2250                 88  CF-ZERO-GROUPING           VALUE '2'.
  2251                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2252             20  CF-EDIT-SW                 PIC X.
  2253                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2254             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2255             20  CF-CR-PR-METHOD            PIC X.
  2256               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2257               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2258             20  FILLER                     PIC X.
  2259
  2260         16  CF-CREDIT-MISC-CONTROLS.
  2261             20  CF-REIN-TABLE-SW           PIC X.
  2262                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2263             20  CF-COMP-TABLE-SW           PIC X.
  2264                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2265             20  CF-EXPERIENCE-RETENTION-AGE
  2266                                            PIC S9        COMP-3.
  2267             20  CF-CONVERSION-DT           PIC XX.
  2268             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2269             20  CF-RUN-FREQUENCY-SW        PIC X.
  2270                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2271                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2272
  2273             20  CF-CR-CHECK-NO-CONTROL.
  2274                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2275                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  41
* EL677.cbl
  2276                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2277                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2278                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2279                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2280
  2281                 24  CF-CR-CHECK-COUNT       REDEFINES
  2282                     CF-CR-CHECK-COUNTER      PIC X(4).
  2283
  2284                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2285                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2286
  2287                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2288                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2289                 24  CF-MAIL-PROCESSING       PIC X.
  2290                     88  MAIL-PROCESSING          VALUE 'Y'.
  2291
  2292         16  CF-MISC-SYSTEM-CONTROL.
  2293             20  CF-SYSTEM-C                 PIC X.
  2294                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2295             20  CF-SYSTEM-D                 PIC X.
  2296                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2297             20  CF-SOC-SEC-NO-SW            PIC X.
  2298                 88  SOC-SEC-NO-USED             VALUE '1'.
  2299             20  CF-MEMBER-NO-SW             PIC X.
  2300                 88  MEMBER-NO-USED              VALUE '1'.
  2301             20  CF-TAX-ID-NUMBER            PIC X(11).
  2302             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2303             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2304                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2305                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2306                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2307                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2308             20  CF-SYSTEM-E                 PIC X.
  2309                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2310
  2311         16  CF-LGX-LIFE-USER               PIC X.
  2312             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2313             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2314
  2315         16  CF-CR-MONTH-END-DT             PIC XX.
  2316
  2317         16  CF-FILE-MAINT-DATES.
  2318             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2319                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2320             20  CF-LAST-BATCH       REDEFINES
  2321                 CF-LAST-BATCH-NO               PIC X(4).
  2322             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2323             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2324             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2325             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2326             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2327             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2328             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2329             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2330             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2331             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2332
  2333         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  42
* EL677.cbl
  2334         16  FILLER                         PIC X.
  2335
  2336         16  CF-ALT-MORT-CODE               PIC X(4).
  2337         16  CF-MEMBER-CAPTION              PIC X(10).
  2338
  2339         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2340             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2341             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2342             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2343             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2344             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2345
  2346         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2347
  2348         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2349         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2350         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2351         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2352
  2353         16  CF-AH-OVERRIDE-L1              PIC X.
  2354         16  CF-AH-OVERRIDE-L2              PIC XX.
  2355         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2356         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2357
  2358         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2359         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2360
  2361         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2362         16  CF-AR-LAST-EL860-DT            PIC XX.
  2363         16  CF-MP-MONTH-END-DT             PIC XX.
  2364
  2365         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2366         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2367             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2368
  2369         16  CF-AR-MONTH-END-DT             PIC XX.
  2370
  2371         16  CF-CRDTCRD-USER                PIC X.
  2372             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2373             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2374
  2375         16  CF-CC-MONTH-END-DT             PIC XX.
  2376
  2377         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2378
  2379         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2380             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2381             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2382             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2383         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2384         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2385         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2386         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2387             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2388             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2389         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2390         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2391         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  43
* EL677.cbl
  2392             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2393         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2394
  2395         16  CF-CL-ZIP-CODE.
  2396             20  CF-CL-ZIP-PRIME.
  2397                 24  CF-CL-ZIP-1ST          PIC X.
  2398                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2399                 24  FILLER                 PIC X(4).
  2400             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2401         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2402             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2403             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2404             20  FILLER                     PIC XXX.
  2405
  2406         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2407         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2408         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2409         16  CF-CO-OPTION-START-DATE        PIC XX.
  2410         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2411           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2412                                                      '3' '4'.
  2413           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2414           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2415           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2416           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2417           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2418           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2419
  2420         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2421
  2422         16  CF-PAYMENT-APPROVAL-LEVELS.
  2423             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2424             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2425             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2426             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2427             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2428             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2429
  2430         16  CF-END-USER-REPORTING-USER     PIC X.
  2431             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2432             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2433
  2434         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2435             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2436             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2437
  2438         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2439
  2440         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2441         16  FILLER                         PIC X.
  2442
  2443         16  CF-CREDIT-ARCHIVE-CNTL.
  2444             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2445             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2446             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2447
  2448         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2449
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  44
* EL677.cbl
  2450         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2451             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2452             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2453
  2454         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2455             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2456             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2457
  2458         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2459
  2460         16  CF-CO-ACH-ID-CODE              PIC  X.
  2461             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2462             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2463             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2464         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2465         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2466         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2467         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2468         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2469         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2470         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2471         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2472         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2473                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2474         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2475                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2476
  2477         16  CF-CO-OVER-SHORT.
  2478             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2479             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2480
  2481*         16  FILLER                         PIC X(102).
  2482         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2483             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2484             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2485
  2486         16  CF-AH-APPROVAL-DAYS.
  2487             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2488             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2489             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2490             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2491
  2492         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2493
  2494         16  CF-APPROV-LEV-5.
  2495             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2496             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2497             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2498
  2499         16  FILLER                         PIC X(68).
  2500****************************************************************
  2501*             PROCESSOR/USER RECORD                            *
  2502****************************************************************
  2503
  2504     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2505         16  CF-PROCESSOR-NAME              PIC X(30).
  2506         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2507         16  CF-PROCESSOR-TITLE             PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  45
* EL677.cbl
  2508         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2509                 88  MESSAGE-YES                VALUE 'Y'.
  2510                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2511
  2512*****************************************************
  2513****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2514****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2515****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2516****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2517*****************************************************
  2518
  2519         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2520             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2521             20  CF-APPLICATION-FORCE       PIC X.
  2522             20  CF-INDIVIDUAL-APP.
  2523                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2524                     28  CF-BROWSE-APP      PIC X.
  2525                     28  CF-UPDATE-APP      PIC X.
  2526
  2527         16  CF-CURRENT-TERM-ON             PIC X(4).
  2528         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2529             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2530             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2531             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2532             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2533             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2534             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2535             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2536         16  CF-PROCESSOR-CARRIER           PIC X.
  2537             88  NO-CARRIER-SECURITY            VALUE ' '.
  2538         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2539             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2540         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2541             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2542         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2543             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2544
  2545         16  CF-PROC-SYS-ACCESS-SW.
  2546             20  CF-PROC-CREDIT-CLAIMS-SW.
  2547                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2548                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2549                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2550                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2551             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2552                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2553                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2554             20  CF-PROC-LIFE-GNRLDGR-SW.
  2555                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2556                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2557                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2558                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2559             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2560                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2561                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2562         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2563             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2564             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2565         16  CF-PROCESSOR-PRINTER               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  46
* EL677.cbl
  2566
  2567         16  CF-APPROVAL-LEVEL                  PIC X.
  2568             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2569             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2570             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2571             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2572             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2573
  2574         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2575
  2576         16  CF-LANGUAGE-TYPE                   PIC X.
  2577             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2578             88  CF-LANG-IS-FR                      VALUE 'F'.
  2579
  2580         16  CF-CSR-IND                         PIC X.
  2581         16  FILLER                             PIC X(239).
  2582
  2583****************************************************************
  2584*             PROCESSOR/REMINDERS RECORD                       *
  2585****************************************************************
  2586
  2587     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2588         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2589             20  CF-START-REMIND-DT         PIC XX.
  2590             20  CF-END-REMIND-DT           PIC XX.
  2591             20  CF-REMINDER-TEXT           PIC X(50).
  2592         16  FILLER                         PIC X(296).
  2593
  2594
  2595****************************************************************
  2596*             STATE MASTER RECORD                              *
  2597****************************************************************
  2598
  2599     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2600         16  CF-STATE-ABBREVIATION          PIC XX.
  2601         16  CF-STATE-NAME                  PIC X(25).
  2602         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2603         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2604             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2605             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2606             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2607             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2608                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2609                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2610             20  CF-ST-PREM-REJECT-SW       PIC X.
  2611                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2612                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2613             20  CF-ST-REF-REJECT-SW        PIC X.
  2614                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2615                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2616         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2617         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2618         16  CF-ST-REFUND-RULES.
  2619             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2620             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2621             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2622         16  CF-ST-FST-PMT-EXTENSION.
  2623             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  47
* EL677.cbl
  2624             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2625                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2626                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2627                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2628                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2629         16  CF-ST-STATE-CALL.
  2630             20  CF-ST-CALL-UNEARNED        PIC X.
  2631             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2632             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2633         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2634             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2635             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2636         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2637         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2638         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2639         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2640         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2641         16  FILLER                         PIC X.
  2642         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2643             20  CF-ST-BENEFIT-CD           PIC XX.
  2644             20  CF-ST-BENEFIT-KIND         PIC X.
  2645                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2646                 88  CF-ST-AH-KIND              VALUE 'A'.
  2647             20  CF-ST-REM-TERM-CALC        PIC X.
  2648                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2649                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2650                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2651                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2652                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2653                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2654                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2655                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2656
  2657             20  CF-ST-REFUND-CALC          PIC X.
  2658                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2659                 88  ST-REFD-BY-R78             VALUE '1'.
  2660                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2661                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2662                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2663                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2664                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2665                 88  ST-REFD-UTAH               VALUE '7'.
  2666                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2667                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2668                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2669
  2670             20  CF-ST-EARNING-CALC         PIC X.
  2671                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2672                 88  ST-EARN-BY-R78             VALUE '1'.
  2673                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2674                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2675                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2676                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2677                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2678                 88  ST-EARN-MEAN               VALUE '8'.
  2679                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2680
  2681             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  48
* EL677.cbl
  2682                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2683                 88  ST-OVRD-BY-R78             VALUE '1'.
  2684                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2685                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2686                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2687                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2688                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2689                 88  ST-OVRD-MEAN               VALUE '8'.
  2690                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2691             20  cf-st-extra-periods        pic 9.
  2692*            20  FILLER                     PIC X.
  2693
  2694         16  CF-ST-COMMISSION-CAPS.
  2695             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2696             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2697             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2698             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2699         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2700                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2701
  2702         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2703
  2704         16  CF-ST-STATUTORY-INTEREST.
  2705             20  CF-ST-STAT-DATE-FROM       PIC X.
  2706                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2707                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2708             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2709             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2710             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2711             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2712             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2713
  2714         16  CF-ST-OVER-SHORT.
  2715             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2716             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2717
  2718         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2719
  2720         16  CF-ST-RT-CALC                  PIC X.
  2721
  2722         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2723         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2724         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2725         16  CF-ST-RF-LR-CALC               PIC X.
  2726         16  CF-ST-RF-LL-CALC               PIC X.
  2727         16  CF-ST-RF-LN-CALC               PIC X.
  2728         16  CF-ST-RF-AH-CALC               PIC X.
  2729         16  CF-ST-RF-CP-CALC               PIC X.
  2730*        16  FILLER                         PIC X(206).
  2731*CIDMOD         16  FILLER                         PIC X(192).
  2732         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2733             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2734         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2735         16  CF-ST-VFY-2ND-BENE             PIC X.
  2736         16  CF-ST-CAUSAL-STATE             PIC X.
  2737         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2738         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2739         16  CF-ST-AGENT-SIG-EDIT           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  49
* EL677.cbl
  2740             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2741         16  CF-ST-NET-ONLY-STATE           PIC X.
  2742             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2743         16  FILLER                         PIC X(181).
  2744
  2745****************************************************************
  2746*             BENEFIT MASTER RECORD                            *
  2747****************************************************************
  2748
  2749     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2750         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2751             20  CF-BENEFIT-CODE            PIC XX.
  2752             20  CF-BENEFIT-NUMERIC  REDEFINES
  2753                 CF-BENEFIT-CODE            PIC XX.
  2754             20  CF-BENEFIT-ALPHA           PIC XXX.
  2755             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2756             20  CF-BENEFIT-COMMENT         PIC X(10).
  2757
  2758             20  CF-LF-COVERAGE-TYPE        PIC X.
  2759                 88  CF-REDUCING                VALUE 'R'.
  2760                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2761
  2762             20  CF-SPECIAL-CALC-CD         PIC X.
  2763                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2764                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2765                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2766                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2767                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2768                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2769                 88  CF-FARM-PLAN               VALUE 'F'.
  2770                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2771                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2772                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2773                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2774                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2775                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2776                 88  CF-PRUDENTIAL              VALUE 'P'.
  2777                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2778                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2779                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2780                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2781                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2782                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2783
  2784             20  CF-JOINT-INDICATOR         PIC X.
  2785                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2786
  2787*            20  FILLER                     PIC X(12).
  2788             20  cf-maximum-benefits        pic s999 comp-3.
  2789             20  FILLER                     PIC X(09).
  2790             20  CF-BENEFIT-CATEGORY        PIC X.
  2791             20  CF-LOAN-TYPE               PIC X(8).
  2792
  2793             20  CF-CO-REM-TERM-CALC        PIC X.
  2794                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2795                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2796                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2797                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  50
* EL677.cbl
  2798                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2799
  2800             20  CF-CO-EARNINGS-CALC        PIC X.
  2801                 88  CO-EARN-BY-R78             VALUE '1'.
  2802                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2803                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2804                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2805                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2806                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2807                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2808                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2809
  2810             20  CF-CO-REFUND-CALC          PIC X.
  2811                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2812                 88  CO-REFD-BY-R78             VALUE '1'.
  2813                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2814                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2815                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2816                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2817                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2818                 88  CO-REFD-MEAN               VALUE '8'.
  2819                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2820                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2821                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2822
  2823             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2824                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2825                 88  CO-OVRD-BY-R78             VALUE '1'.
  2826                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2827                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2828                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2829                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2830                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2831                 88  CO-OVRD-MEAN               VALUE '8'.
  2832                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2833
  2834             20  CF-CO-BEN-I-G-CD           PIC X.
  2835                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2836                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2837                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2838
  2839         16  FILLER                         PIC X(304).
  2840
  2841
  2842****************************************************************
  2843*             CARRIER MASTER RECORD                            *
  2844****************************************************************
  2845
  2846     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2847         16  CF-ADDRESS-DATA.
  2848             20  CF-MAIL-TO-NAME            PIC X(30).
  2849             20  CF-IN-CARE-OF              PIC X(30).
  2850             20  CF-ADDRESS-LINE-1          PIC X(30).
  2851             20  CF-ADDRESS-LINE-2          PIC X(30).
  2852             20  CF-CITY-STATE              PIC X(30).
  2853             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2854             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2855
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  51
* EL677.cbl
  2856         16  CF-CLAIM-NO-CONTROL.
  2857             20  CF-CLAIM-NO-METHOD         PIC X.
  2858                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2859                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2860                 88  CLAIM-NO-SEQ               VALUE '3'.
  2861                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2862             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2863                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2864                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2865                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2866
  2867         16  CF-CHECK-NO-CONTROL.
  2868             20  CF-CHECK-NO-METHOD         PIC X.
  2869                 88  CHECK-NO-MANUAL            VALUE '1'.
  2870                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2871                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2872                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2873             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2874                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2875
  2876         16  CF-DOMICILE-STATE              PIC XX.
  2877
  2878         16  CF-EXPENSE-CONTROLS.
  2879             20  CF-EXPENSE-METHOD          PIC X.
  2880                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2881                 88  DOLLARS-PER-PMT            VALUE '2'.
  2882                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2883                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2884             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2885             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2886
  2887         16  CF-CORRESPONDENCE-CONTROL.
  2888             20  CF-LETTER-RESEND-OPT       PIC X.
  2889                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2890                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2891             20  FILLER                     PIC X(4).
  2892
  2893         16  CF-RESERVE-CONTROLS.
  2894             20  CF-MANUAL-SW               PIC X.
  2895                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2896             20  CF-FUTURE-SW               PIC X.
  2897                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2898             20  CF-PTC-SW                  PIC X.
  2899                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2900             20  CF-IBNR-SW                 PIC X.
  2901                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2902             20  CF-PTC-LF-SW               PIC X.
  2903                 88  CF-LF-PTC-USED             VALUE '1'.
  2904             20  CF-CDT-ACCESS-METHOD       PIC X.
  2905                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2906                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2907                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2908             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2909
  2910         16  CF-CLAIM-CALC-METHOD           PIC X.
  2911             88  360-PLUS-MONTHS                VALUE '1'.
  2912             88  365-PLUS-MONTHS                VALUE '2'.
  2913             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  52
* EL677.cbl
  2914             88  360-DAILY                      VALUE '4'.
  2915             88  365-DAILY                      VALUE '5'.
  2916
  2917         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2918         16  FILLER                         PIC X(11).
  2919
  2920         16  CF-LIMIT-AMOUNTS.
  2921             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2922             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2923             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2924             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2925             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2926             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2927             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2928             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2929             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2930             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2931
  2932         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2933         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2934         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2935
  2936         16  CF-ZIP-CODE.
  2937             20  CF-ZIP-PRIME.
  2938                 24  CF-ZIP-1ST             PIC X.
  2939                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2940                 24  FILLER                 PIC X(4).
  2941             20  CF-ZIP-PLUS4               PIC X(4).
  2942         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2943             20  CF-CAN-POSTAL-1            PIC XXX.
  2944             20  CF-CAN-POSTAL-2            PIC XXX.
  2945             20  FILLER                     PIC XXX.
  2946
  2947         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2948         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2949         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2950
  2951         16  CF-RATING-SWITCH               PIC X.
  2952             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2953             88  CF-NO-RATING                   VALUE 'N'.
  2954
  2955         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2956
  2957         16  CF-CARRIER-OVER-SHORT.
  2958             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2959             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2960
  2961         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2962         16  CF-SECPAY-SWITCH               PIC X.
  2963             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2964             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2965         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2966         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2967         16  FILLER                         PIC X(444).
  2968*        16  FILLER                         PIC X(452).
  2969
  2970
  2971****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  53
* EL677.cbl
  2972*             MORTALITY MASTER RECORD                          *
  2973****************************************************************
  2974
  2975     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2976         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2977                                INDEXED BY CF-MORT-NDX.
  2978             20  CF-MORT-TABLE              PIC X(5).
  2979             20  CF-MORT-TABLE-TYPE         PIC X.
  2980                 88  CF-MORT-JOINT              VALUE 'J'.
  2981                 88  CF-MORT-SINGLE             VALUE 'S'.
  2982                 88  CF-MORT-COMBINED           VALUE 'C'.
  2983                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2984                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2985             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2986             20  CF-MORT-AGE-METHOD         PIC XX.
  2987                 88  CF-AGE-LAST                VALUE 'AL'.
  2988                 88  CF-AGE-NEAR                VALUE 'AN'.
  2989             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2990             20  CF-MORT-ADJUSTMENT-DIRECTION
  2991                                            PIC X.
  2992                 88  CF-MINUS                   VALUE '-'.
  2993                 88  CF-PLUS                    VALUE '+'.
  2994             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2995             20  CF-MORT-JOINT-CODE         PIC X.
  2996                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2997             20  CF-MORT-PC-Q               PIC X.
  2998                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2999             20  CF-MORT-TABLE-CODE         PIC X(4).
  3000             20  CF-MORT-COMMENTS           PIC X(15).
  3001             20  FILLER                     PIC X(14).
  3002
  3003         16  FILLER                         PIC X(251).
  3004
  3005
  3006****************************************************************
  3007*             BUSSINESS TYPE MASTER RECORD                     *
  3008****************************************************************
  3009
  3010     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3011* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3012* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3013* AND RECORD 05 IS TYPES 81-99
  3014         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3015             20  CF-BUSINESS-TITLE          PIC  X(19).
  3016             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3017                                            PIC S9V9(4) COMP-3.
  3018             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3019             20  FILLER                     PIC  X.
  3020         16  FILLER                         PIC  X(248).
  3021
  3022
  3023****************************************************************
  3024*             TERMINAL MASTER RECORD                           *
  3025****************************************************************
  3026
  3027     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3028
  3029         16  CF-COMPANY-TERMINALS.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  54
* EL677.cbl
  3030             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3031                                  PIC X(4).
  3032         16  FILLER               PIC X(248).
  3033
  3034
  3035****************************************************************
  3036*             LIFE EDIT MASTER RECORD                          *
  3037****************************************************************
  3038
  3039     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3040         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3041             20  CF-LIFE-CODE-IN            PIC XX.
  3042             20  CF-LIFE-CODE-OUT           PIC XX.
  3043         16  FILLER                         PIC X(248).
  3044
  3045
  3046****************************************************************
  3047*             AH EDIT MASTER RECORD                            *
  3048****************************************************************
  3049
  3050     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3051         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3052             20  CF-AH-CODE-IN              PIC XXX.
  3053             20  CF-AH-CODE-OUT             PIC XX.
  3054         16  FILLER                         PIC X(248).
  3055
  3056
  3057****************************************************************
  3058*             CREDIBILITY TABLES                               *
  3059****************************************************************
  3060
  3061     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3062         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3063                             INDEXED BY CF-CRDB-NDX.
  3064             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3065             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3066             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3067         16  FILLER                         PIC  X(332).
  3068
  3069
  3070****************************************************************
  3071*             REPORT CUSTOMIZATION RECORD                      *
  3072****************************************************************
  3073
  3074     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3075         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3076             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3077             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3078             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3079**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3080****       A T-TRANSFER.                                   ****
  3081             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3082
  3083         16  FILLER                         PIC XX.
  3084
  3085         16  CF-CARRIER-CNTL-OPT.
  3086             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3087                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  55
* EL677.cbl
  3088                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3089             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3090                                            PIC X.
  3091         16  CF-GROUP-CNTL-OPT.
  3092             20  CF-GROUP-OPT-SEQ           PIC 9.
  3093                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3094                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3095             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3096                                            PIC X(6).
  3097         16  CF-STATE-CNTL-OPT.
  3098             20  CF-STATE-OPT-SEQ           PIC 9.
  3099                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3100                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3101             20  CF-STATE-SELECT OCCURS 3 TIMES
  3102                                            PIC XX.
  3103         16  CF-ACCOUNT-CNTL-OPT.
  3104             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3105                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3106                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3107             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3108                                            PIC X(10).
  3109         16  CF-BUS-TYP-CNTL-OPT.
  3110             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3111                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3112                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3113             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3114                                            PIC XX.
  3115         16  CF-LF-TYP-CNTL-OPT.
  3116             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3117                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3118                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3119             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3120                                            PIC XX.
  3121         16  CF-AH-TYP-CNTL-OPT.
  3122             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3123                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3124                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3125             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3126                                            PIC XX.
  3127         16  CF-REPTCD1-CNTL-OPT.
  3128             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3129                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3130                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3131             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3132                                            PIC X(10).
  3133         16  CF-REPTCD2-CNTL-OPT.
  3134             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3135                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3136                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3137             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3138                                            PIC X(10).
  3139         16  CF-USER1-CNTL-OPT.
  3140             20  CF-USER1-OPT-SEQ           PIC 9.
  3141                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3142                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3143             20  CF-USER1-SELECT OCCURS 3 TIMES
  3144                                            PIC X(10).
  3145         16  CF-USER2-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  56
* EL677.cbl
  3146             20  CF-USER2-OPT-SEQ           PIC 9.
  3147                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3148                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3149             20  CF-USER2-SELECT OCCURS 3 TIMES
  3150                                            PIC X(10).
  3151         16  CF-USER3-CNTL-OPT.
  3152             20  CF-USER3-OPT-SEQ           PIC 9.
  3153                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3154                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3155             20  CF-USER3-SELECT OCCURS 3 TIMES
  3156                                            PIC X(10).
  3157         16  CF-USER4-CNTL-OPT.
  3158             20  CF-USER4-OPT-SEQ           PIC 9.
  3159                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3160                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3161             20  CF-USER4-SELECT OCCURS 3 TIMES
  3162                                            PIC X(10).
  3163         16  CF-USER5-CNTL-OPT.
  3164             20  CF-USER5-OPT-SEQ           PIC 9.
  3165                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3166                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3167             20  CF-USER5-SELECT OCCURS 3 TIMES
  3168                                            PIC X(10).
  3169         16  CF-REINS-CNTL-OPT.
  3170             20  CF-REINS-OPT-SEQ           PIC 9.
  3171                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3172                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3173             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3174                 24  CF-REINS-PRIME         PIC XXX.
  3175                 24  CF-REINS-SUB           PIC XXX.
  3176
  3177         16  CF-AGENT-CNTL-OPT.
  3178             20  CF-AGENT-OPT-SEQ           PIC 9.
  3179                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3180                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3181             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3182                                            PIC X(10).
  3183
  3184         16  FILLER                         PIC X(43).
  3185
  3186         16  CF-LOSS-RATIO-SELECT.
  3187             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3188             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3189         16  CF-ENTRY-DATE-SELECT.
  3190             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3191             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3192         16  CF-EFFECTIVE-DATE-SELECT.
  3193             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3194             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3195
  3196         16  CF-EXCEPTION-LIST-IND          PIC X.
  3197             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3198
  3199         16  FILLER                         PIC X(318).
  3200
  3201****************************************************************
  3202*                  EXCEPTION REPORTING RECORD                  *
  3203****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  57
* EL677.cbl
  3204
  3205     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3206         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3207             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3208
  3209         16  CF-COMBINED-LIFE-AH-OPT.
  3210             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3211             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3212             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3213             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3214
  3215         16  CF-LIFE-OPT.
  3216             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3217             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3218             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3219             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3220             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3221             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3222             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3223             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3224             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3225             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3226
  3227         16  CF-AH-OPT.
  3228             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3229             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3230             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3231             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3232             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3233             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3234             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3235             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3236             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3237             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3238
  3239         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3240             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3241             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3242             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3243
  3244         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3245
  3246         16  FILLER                         PIC X(673).
  3247
  3248
  3249****************************************************************
  3250*             MORTGAGE SYSTEM PLAN RECORD                      *
  3251****************************************************************
  3252
  3253     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3254         16  CF-PLAN-TYPE                   PIC X.
  3255             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3256             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3257             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3258         16  CF-PLAN-ABBREV                 PIC XXX.
  3259         16  CF-PLAN-DESCRIPT               PIC X(10).
  3260         16  CF-PLAN-NOTES                  PIC X(20).
  3261         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  58
* EL677.cbl
  3262         16  CF-PLAN-UNDERWRITING.
  3263             20  CF-PLAN-TERM-DATA.
  3264                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3265                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3266             20  CF-PLAN-AGE-DATA.
  3267                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3268                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3269                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3270             20  CF-PLAN-BENEFIT-DATA.
  3271                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3272                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3273                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3274                                            PIC S9(7)V99  COMP-3.
  3275         16  CF-PLAN-POLICY-FORMS.
  3276             20  CF-POLICY-FORM             PIC X(12).
  3277             20  CF-MASTER-APPLICATION      PIC X(12).
  3278             20  CF-MASTER-POLICY           PIC X(12).
  3279         16  CF-PLAN-RATING.
  3280             20  CF-RATE-CODE               PIC X(5).
  3281             20  CF-SEX-RATING              PIC X.
  3282                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3283                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3284             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3285             20  CF-SUB-STD-TYPE            PIC X.
  3286                 88  CF-PCT-OF-PREM            VALUE '1'.
  3287                 88  CF-PCT-OF-BENE            VALUE '2'.
  3288         16  CF-PLAN-PREM-TOLERANCES.
  3289             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3290             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3291         16  CF-PLAN-PYMT-TOLERANCES.
  3292             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3293             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3294         16  CF-PLAN-MISC-DATA.
  3295             20  FILLER                     PIC X.
  3296             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3297             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3298         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3299         16  CF-PLAN-IND-GRP                PIC X.
  3300             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3301                                                     '1'.
  3302             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3303                                                     '2'.
  3304         16  CF-MIB-SEARCH-SW               PIC X.
  3305             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3306             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3307             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3308             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3309         16  CF-ALPHA-SEARCH-SW             PIC X.
  3310             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3311             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3312             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3313             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3314             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3315             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3316             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3317             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3318             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3319             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  59
* EL677.cbl
  3320                                                     'A' 'B' 'C'
  3321                                                     'X' 'Y' 'Z'.
  3322         16  CF-EFF-DT-RULE-SW              PIC X.
  3323             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3324             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3325             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3326             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3327             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3328         16  FILLER                         PIC X(4).
  3329         16  CF-HEALTH-QUESTIONS            PIC X.
  3330             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3331         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3332         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3333         16  CF-PLAN-SNGL-JNT               PIC X.
  3334             88  CF-COMBINED-PLAN              VALUE 'C'.
  3335             88  CF-JNT-PLAN                   VALUE 'J'.
  3336             88  CF-SNGL-PLAN                  VALUE 'S'.
  3337         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3338         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3339         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3340         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3341         16  CF-RERATE-CNTL                 PIC  X.
  3342             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3343             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3344             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3345             88  CF-AUTO-RECALC                 VALUE '4'.
  3346         16  CF-BENEFIT-TYPE                PIC  X.
  3347             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3348             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3349         16  CF-POLICY-FEE                  PIC S999V99
  3350                                                    COMP-3.
  3351         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3352         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3353         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3354         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3355         16  FILLER                         PIC  X(32).
  3356         16  CF-TERMINATION-FORM            PIC  X(04).
  3357         16  FILLER                         PIC  X(08).
  3358         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3359                                                       COMP-3.
  3360         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3361         16  CF-ISSUE-LETTER                PIC  X(4).
  3362         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3363         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3364             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3365             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3366         16  CF-MP-REFUND-CALC              PIC X.
  3367             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3368             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3369             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3370             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3371             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3372             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3373             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3374             88  CF-MP-REFD-MEAN                VALUE '8'.
  3375         16  CF-ALT-RATE-CODE               PIC  X(5).
  3376
  3377
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  60
* EL677.cbl
  3378         16  FILLER                         PIC X(498).
  3379****************************************************************
  3380*             MORTGAGE COMPANY MASTER RECORD                   *
  3381****************************************************************
  3382
  3383     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3384         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3385         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3386             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3387             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3388             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3389             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3390             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3391
  3392         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3393         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3394         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3395         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3396         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3397
  3398         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3399             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3400         16  CF-MP-RECON-USE-IND            PIC X(1).
  3401             88  CF-MP-USE-RECON             VALUE 'Y'.
  3402         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3403             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3404         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3405             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3406             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3407         16  FILLER                         PIC X(1).
  3408         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3409             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3410         16  CF-MORTG-MIB-VERSION           PIC X.
  3411             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3412             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3413             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3414         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3415             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3416                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3417             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3418                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3419             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3420                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3421             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3422                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3423             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3424                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3425             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3426                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3427         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3428         16  FILLER                         PIC X(7).
  3429         16  CF-MORTG-DESTINATION-SYMBOL.
  3430             20  CF-MORTG-MIB-COMM          PIC X(5).
  3431             20  CF-MORTG-MIB-TERM          PIC X(5).
  3432         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3433             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3434         16  FILLER                         PIC X(03).
  3435         16  CF-MP-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  61
* EL677.cbl
  3436             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3437                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3438                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3439                                                ' ' LOW-VALUES.
  3440                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3441                                               VALUE '3'.
  3442         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3443         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3444         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3445             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3446                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3447             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3448                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3449             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3450                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3451             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3452                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3453             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3454                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3455             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3456                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3457         16  CF-MORTG-BILLING-AREA.
  3458             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3459                                            PIC X.
  3460         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3461         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3462         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3463         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3464             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3465             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3466         16  FILLER                         PIC X.
  3467         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3468             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3469             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3470         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3471         16  FILLER                         PIC X(8).
  3472         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3473         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3474         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3475         16  CF-ACH-COMPANY-ID.
  3476             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3477                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3478                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3479                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3480             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3481         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3482             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3483         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3484             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3485             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3486         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3487         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3488         16  FILLER                         PIC X(536).
  3489
  3490****************************************************************
  3491*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3492****************************************************************
  3493
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  62
* EL677.cbl
  3494     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3495         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3496             20  CF-FEMALE-HEIGHT.
  3497                 24  CF-FEMALE-FT           PIC 99.
  3498                 24  CF-FEMALE-IN           PIC 99.
  3499             20  CF-FEMALE-MIN-WT           PIC 999.
  3500             20  CF-FEMALE-MAX-WT           PIC 999.
  3501         16  FILLER                         PIC X(428).
  3502
  3503     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3504         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3505             20  CF-MALE-HEIGHT.
  3506                 24  CF-MALE-FT             PIC 99.
  3507                 24  CF-MALE-IN             PIC 99.
  3508             20  CF-MALE-MIN-WT             PIC 999.
  3509             20  CF-MALE-MAX-WT             PIC 999.
  3510         16  FILLER                         PIC X(428).
  3511******************************************************************
  3512*             AUTOMATIC ACTIVITY RECORD                          *
  3513******************************************************************
  3514     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3515         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3516             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3517             20  CF-SYS-LETTER-ID           PIC X(04).
  3518             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3519             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3520             20  CF-SYS-RESET-SW            PIC X(01).
  3521             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3522             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3523
  3524         16  FILLER                         PIC X(50).
  3525
  3526         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3527             20  CF-USER-ACTIVE-SW          PIC X(01).
  3528             20  CF-USER-LETTER-ID          PIC X(04).
  3529             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3530             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3531             20  CF-USER-RESET-SW           PIC X(01).
  3532             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3533             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3534             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3535
  3536         16  FILLER                         PIC X(246).
  3537*                                    COPY ERCCHEK.
  3538******************************************************************
  3539*                                                                *
  3540*                                                                *
  3541*                            ERCCHEK                             *
  3542*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3543*                            VMOD=2.008                          *
  3544*                                                                *
  3545*   FILE DESCRIPTION = CHECK RECORDS                             *
  3546*                                                                *
  3547*   FILE TYPE = VSAM,KSDS                                        *
  3548*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3549*                                                                *
  3550*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3551*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  63
* EL677.cbl
  3552*                                                                *
  3553*   LOG = YES                                                    *
  3554*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3555******************************************************************
  3556*                   C H A N G E   L O G
  3557*
  3558* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3559*-----------------------------------------------------------------
  3560*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3561* EFFECTIVE    NUMBER
  3562*-----------------------------------------------------------------
  3563* 021414    2003053000001  PEMA  changes for auto chk request
  3564******************************************************************
  3565 01  CHECK-RECORDS.
  3566     12  CH-RECORD-ID                      PIC XX.
  3567         88  VALID-CH-ID                      VALUE 'CH'.
  3568
  3569     12  CH-CONTROL-PRIMARY.
  3570         16  CH-COMPANY-CD                 PIC X.
  3571         16  CH-CARRIER                    PIC X.
  3572         16  CH-GROUPING                   PIC X(6).
  3573         16  CH-STATE                      PIC XX.
  3574         16  CH-ACCOUNT                    PIC X(10).
  3575         16  CH-CERT-EFF-DT                PIC XX.
  3576         16  CH-CERT-NO.
  3577             20  CH-CERT-PRIME             PIC X(10).
  3578             20  CH-CERT-SFX               PIC X.
  3579         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3580
  3581     12  CH-RECORDED-DT                    PIC XX.
  3582     12  CH-RECORDED-BY                    PIC X(4).
  3583     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3584
  3585     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3586     12  CH-CHECK-NO                       PIC X(7).
  3587     12  CH-REASON-FOR-CHECK               PIC X(25).
  3588     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3589     12  FILLER                            PIC X.
  3590
  3591     12  CH-PAYEE-INFO.
  3592         16  CH-PAYEE-NAME-1               PIC X(30).
  3593         16  CH-PAYEE-NAME-2               PIC X(30).
  3594         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3595         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3596         16  CH-PAYEE-CITY-ST.
  3597             20  CH-PAYEE-CITY             PIC X(28).
  3598             20  CH-PAYEE-STATE            PIC XX.
  3599         16  CH-PAYEE-ZIP-CODE.
  3600             20  CH-PAYEE-ZIP.
  3601                 24  CH-ZIP-PRI-1ST        PIC X.
  3602                     88  CH-CANADIAN-POST-CODE
  3603                                           VALUES 'A' THRU 'Z'.
  3604                 24  FILLER                PIC X(4).
  3605             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3606         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3607             20  CH-CAN-POSTAL-1           PIC XXX.
  3608             20  CH-CAN-POSTAL-2           PIC XXX.
  3609             20  FILLER                    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  64
* EL677.cbl
  3610
  3611     12  CH-CHECK-STUB-TEXT.
  3612         16  CH-STUB-LINE-1                PIC X(30).
  3613         16  CH-TEXT-LINE-1                PIC X(50).
  3614         16  CH-TEXT-LINE-2                PIC X(50).
  3615         16  CH-TEXT-LINE-3                PIC X(40).
  3616     12  CH-RETURN-TO                      PIC X(30).
  3617
  3618     12  CH-COMPENSATION-CONTROL.
  3619         16  CH-COMP-CARRIER               PIC X.
  3620         16  CH-COMP-GROUPING              PIC X(6).
  3621         16  CH-COMP-FIN-RESP              PIC X(10).
  3622         16  CH-COMP-ACCOUNT               PIC X(10).
  3623
  3624     12  CH-CREDIT-SELECT-DT               PIC XX.
  3625     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3626     12  CH-PAYEE-CODE                     PIC X(6).
  3627
  3628     12  CH-VOID-DATA.
  3629         20  CH-VOID-DT                    PIC XX.
  3630         20  CH-VOID-BY                    PIC X(4).
  3631         20  CH-VOID-REASON                PIC X(25).
  3632
  3633     12  CH-APPROVAL-DATA.
  3634         20  CH-APPROVAL-DT                PIC XX.
  3635         20  CH-APPROVAL-STATUS            PIC X.
  3636             88  CH-IN-LIMBO                  VALUE ' '.
  3637             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3638             88  CH-APPROVED                  VALUE 'A'.
  3639             88  CH-DENIED                    VALUE 'D'.
  3640         20  CH-APPROVED-BY                PIC XXXX.
  3641     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3642             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3643     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3644
  3645     12  ch-released-dt                    pic xx.
  3646     12  ch-check-cashed-dt                pic xx.
  3647     12  FILLER                            PIC X.
  3648*    12  CH-CHECK-REFERENCE                PIC X(12).
  3649     12  CH-CHECK-ORIGIN-SW                PIC X.
  3650             88  CH-REFUND-CHECK              VALUE 'R'.
  3651             88  CH-MAINT-CHECK               VALUE 'M'.
  3652
  3653     12  CH-CANC-DT                        PIC XX.
  3654     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3655     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3656
  3657     12  CH-INSURED-NAME                   PIC X(28).
  3658
  3659     12  ch-released-by                    pic x(4).
  3660     12  ch-csr                            pic x(4).
  3661     12  ch-deduct-commission              pic x.
  3662         88  ch-deduct-comm                  value 'Y'.
  3663         88  ch-do-not-deduct-comm           value 'N'.
  3664
  3665     12  FILLER                            PIC X(11).
  3666*    12  CH-LETTER-TABLE.
  3667*        16  CH-LETTERS OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  65
* EL677.cbl
  3668*                       INDEXED BY CH-LT-NDX
  3669*                                          PIC X(04).
  3670
  3671     12  FILLER                            PIC X(07).
  3672
  3673*                                    COPY ERCACCT.
  3674******************************************************************
  3675*                                                                *
  3676*                                                                *
  3677*                            ERCACCT                             *
  3678*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3679*                            VMOD=2.031                          *
  3680*                                                                *
  3681*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3682*                                                                *
  3683*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3684*   VSAM ACCOUNT MASTER FILES.                                   *
  3685*                                                                *
  3686*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3687*                                                                *
  3688*   FILE TYPE = VSAM,KSDS                                        *
  3689*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3690*                                                                *
  3691*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3692*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3693*                                                                *
  3694*   LOG = NO                                                     *
  3695*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3696*                                                                *
  3697*                                                                *
  3698******************************************************************
  3699*                   C H A N G E   L O G
  3700*
  3701* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3702*-----------------------------------------------------------------
  3703*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3704* EFFECTIVE    NUMBER
  3705*-----------------------------------------------------------------
  3706* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3707* 092705    2005050300006  PEMA  ADD SPP LEASES
  3708* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3709* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3710* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3711* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3712* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3713* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  3714******************************************************************
  3715
  3716 01  ACCOUNT-MASTER.
  3717     12  AM-RECORD-ID                      PIC XX.
  3718         88  VALID-AM-ID                      VALUE 'AM'.
  3719
  3720     12  AM-CONTROL-PRIMARY.
  3721         16  AM-COMPANY-CD                 PIC X.
  3722         16  AM-MSTR-CNTRL.
  3723             20  AM-CONTROL-A.
  3724                 24  AM-CARRIER            PIC X.
  3725                 24  AM-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  66
* EL677.cbl
  3726                     28 AM-GROUPING-PREFIX PIC XXX.
  3727                     28 AM-GROUPING-PRIME  PIC XXX.
  3728                 24  AM-STATE              PIC XX.
  3729                 24  AM-ACCOUNT.
  3730                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3731                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3732             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3733                                           PIC X(19).
  3734             20  AM-CNTRL-B.
  3735                 24  AM-EXPIRATION-DT      PIC XX.
  3736                 24  FILLER                PIC X(4).
  3737             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3738                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3739
  3740     12  AM-CONTROL-BY-VAR-GRP.
  3741         16  AM-COMPANY-CD-A1              PIC X.
  3742         16  AM-VG-CARRIER                 PIC X.
  3743         16  AM-VG-GROUPING                PIC X(6).
  3744         16  AM-VG-STATE                   PIC XX.
  3745         16  AM-VG-ACCOUNT                 PIC X(10).
  3746         16  AM-VG-DATE.
  3747             20  AM-VG-EXPIRATION-DT       PIC XX.
  3748             20  FILLER                    PIC X(4).
  3749         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3750                                           PIC 9(11)      COMP-3.
  3751     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3752         16  FILLER                        PIC X(10).
  3753         16  AM-VG-KEY3.
  3754             20  AM-VG3-ACCOUNT            PIC X(10).
  3755             20  AM-VG3-EXP-DT             PIC XX.
  3756         16  FILLER                        PIC X(4).
  3757     12  AM-MAINT-INFORMATION.
  3758         16  AM-LAST-MAINT-DT              PIC XX.
  3759         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3760         16  AM-LAST-MAINT-USER            PIC X(4).
  3761         16  FILLER                        PIC XX.
  3762
  3763     12  AM-EFFECTIVE-DT                   PIC XX.
  3764     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3765
  3766     12  AM-PREV-DATES  COMP-3.
  3767         16  AM-PREV-EXP-DT                PIC 9(11).
  3768         16  AM-PREV-EFF-DT                PIC 9(11).
  3769
  3770     12  AM-REPORT-CODE-1                  PIC X(10).
  3771     12  AM-REPORT-CODE-2                  PIC X(10).
  3772
  3773     12  AM-CITY-CODE                      PIC X(4).
  3774     12  AM-COUNTY-PARISH                  PIC X(6).
  3775
  3776     12  AM-NAME                           PIC X(30).
  3777     12  AM-PERSON                         PIC X(30).
  3778     12  AM-ADDRS                          PIC X(30).
  3779     12  AM-CITY.
  3780         16  AM-ADDR-CITY                  PIC X(28).
  3781         16  AM-ADDR-STATE                 PIC XX.
  3782     12  AM-ZIP.
  3783         16  AM-ZIP-PRIME.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  67
* EL677.cbl
  3784             20  AM-ZIP-PRI-1ST            PIC X.
  3785                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3786             20  FILLER                    PIC X(4).
  3787         16  AM-ZIP-PLUS4                  PIC X(4).
  3788     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3789         16  AM-CAN-POSTAL-1               PIC XXX.
  3790         16  AM-CAN-POSTAL-2               PIC XXX.
  3791         16  FILLER                        PIC XXX.
  3792     12  AM-TEL-NO.
  3793         16  AM-AREA-CODE                  PIC 999.
  3794         16  AM-TEL-PRE                    PIC 999.
  3795         16  AM-TEL-NBR                    PIC 9(4).
  3796     12  AM-TEL-LOC                        PIC X.
  3797         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3798         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3799
  3800     12  AM-COMM-STRUCTURE.
  3801         16  AM-DEFN-1.
  3802             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3803                 24  AM-AGT.
  3804                     28  AM-AGT-PREFIX     PIC X(4).
  3805                     28  AM-AGT-PRIME      PIC X(6).
  3806                 24  AM-COM-TYP            PIC X.
  3807                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3808                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3809                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3810                 24  AM-RECALC-LV-INDIC    PIC X.
  3811                 24  AM-RETRO-LV-INDIC     PIC X.
  3812                 24  AM-GL-CODES           PIC X.
  3813                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3814                 24  FILLER                PIC X(01).
  3815         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3816             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3817                 24  FILLER                PIC X(11).
  3818                 24  AM-L-COMA             PIC XXX.
  3819                 24  AM-J-COMA             PIC XXX.
  3820                 24  AM-A-COMA             PIC XXX.
  3821                 24  FILLER                PIC X(6).
  3822
  3823     12  AM-COMM-CHANGE-STATUS             PIC X.
  3824         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3825
  3826     12  AM-CSR-CODE                       PIC X(4).
  3827
  3828     12  AM-BILLING-STATUS                 PIC X.
  3829         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3830         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3831     12  AM-AUTO-REFUND-SW                 PIC X.
  3832         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3833         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3834     12  AM-GPCD                           PIC 99.
  3835     12  AM-IG                             PIC X.
  3836         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3837         88  AM-HAS-GROUP                     VALUE '2'.
  3838     12  AM-STATUS                         PIC X.
  3839         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3840         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3841         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  68
* EL677.cbl
  3842         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3843         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3844         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3845         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  3846         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3847         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3848         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3849     12  AM-REMIT-TO                       PIC 99.
  3850     12  AM-ID-NO                          PIC X(11).
  3851
  3852     12  AM-CAL-TABLE                      PIC XX.
  3853     12  AM-LF-DEVIATION                   PIC XXX.
  3854     12  AM-AH-DEVIATION                   PIC XXX.
  3855     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3856     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3857     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3858     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3859     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3860     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3861
  3862     12  AM-USER-FIELDS.
  3863         16  AM-FLD-1                      PIC XX.
  3864         16  AM-FLD-2                      PIC XX.
  3865         16  AM-FLD-3                      PIC XX.
  3866         16  AM-FLD-4                      PIC XX.
  3867         16  AM-FLD-5                      PIC XX.
  3868
  3869     12  AM-1ST-PROD-DATE.
  3870         16  AM-1ST-PROD-YR                PIC XX.
  3871         16  AM-1ST-PROD-MO                PIC XX.
  3872         16  AM-1ST-PROD-DA                PIC XX.
  3873     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3874     12  AM-CERTS-PURGED-DATE.
  3875         16  AM-PUR-YR                     PIC XX.
  3876         16  AM-PUR-MO                     PIC XX.
  3877         16  AM-PUR-DA                     PIC XX.
  3878     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3879     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3880     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3881     12  AM-INACTIVE-DATE.
  3882         16  AM-INA-MO                     PIC 99.
  3883         16  AM-INA-DA                     PIC 99.
  3884         16  AM-INA-YR                     PIC 99.
  3885     12  AM-AR-HI-CERT-DATE                PIC XX.
  3886
  3887     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3888     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3889
  3890     12  AM-OB-PAYMENT-MODE                PIC X.
  3891         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3892         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3893         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3894         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3895
  3896     12  AM-AH-ONLY-INDICATOR              PIC X.
  3897         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3898         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3899
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  69
* EL677.cbl
  3900     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3901
  3902     12  AM-OVER-SHORT.
  3903         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3904         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3905
  3906     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3907     12  AM-DCC-CLP-STATE                  PIC XX.
  3908
  3909     12  AM-RECALC-COMM                    PIC X.
  3910     12  AM-RECALC-REIN                    PIC X.
  3911
  3912     12  AM-REI-TABLE                      PIC XXX.
  3913     12  AM-REI-ET-LF                      PIC X.
  3914     12  AM-REI-ET-AH                      PIC X.
  3915     12  AM-REI-PE-LF                      PIC X.
  3916     12  AM-REI-PE-AH                      PIC X.
  3917     12  AM-REI-PRT-ST                     PIC X.
  3918     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3919     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3920     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3921     12  AM-REI-GROUP-A                    PIC X(6).
  3922     12  AM-REI-MORT                       PIC X(4).
  3923     12  AM-REI-PRT-OW                     PIC X.
  3924     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3925     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3926     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3927     12  AM-REI-GROUP-B                    PIC X(6).
  3928
  3929     12  AM-TRUST-TYPE                     PIC X(2).
  3930
  3931     12  AM-EMPLOYER-STMT-USED             PIC X.
  3932     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3933
  3934     12  AM-STD-AH-TYPE                    PIC XX.
  3935     12  AM-EARN-METHODS.
  3936         16  AM-EARN-METHOD-R              PIC X.
  3937             88 AM-REF-RL-R78                 VALUE 'R'.
  3938             88 AM-REF-RL-PR                  VALUE 'P'.
  3939             88 AM-REF-RL-MEAN                VALUE 'M'.
  3940             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3941         16  AM-EARN-METHOD-L              PIC X.
  3942             88 AM-REF-LL-R78                 VALUE 'R'.
  3943             88 AM-REF-LL-PR                  VALUE 'P'.
  3944             88 AM-REF-LL-MEAN                VALUE 'M'.
  3945             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3946         16  AM-EARN-METHOD-A              PIC X.
  3947             88 AM-REF-AH-R78                 VALUE 'R'.
  3948             88 AM-REF-AH-PR                  VALUE 'P'.
  3949             88 AM-REF-AH-MEAN                VALUE 'M'.
  3950             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3951             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3952             88 AM-REF-AH-NET                 VALUE 'N'.
  3953
  3954     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3955     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3956     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3957
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  70
* EL677.cbl
  3958     12  AM-RET-Y-N                        PIC X.
  3959     12  AM-RET-P-E                        PIC X.
  3960     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3961     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3962     12  AM-RET-GRP                        PIC X(6).
  3963     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3964         16  AM-POOL-PRIME                 PIC XXX.
  3965         16  AM-POOL-SUB                   PIC XXX.
  3966     12  AM-RETRO-EARNINGS.
  3967         16  AM-RET-EARN-R                 PIC X.
  3968         16  AM-RET-EARN-L                 PIC X.
  3969         16  AM-RET-EARN-A                 PIC X.
  3970     12  AM-RET-ST-TAX-USE                 PIC X.
  3971         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3972         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3973     12  AM-RETRO-BEG-EARNINGS.
  3974         16  AM-RET-BEG-EARN-R             PIC X.
  3975         16  AM-RET-BEG-EARN-L             PIC X.
  3976         16  AM-RET-BEG-EARN-A             PIC X.
  3977     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3978     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3979
  3980     12  AM-USER-SELECT-OPTIONS.
  3981         16  AM-USER-SELECT-1              PIC X(10).
  3982         16  AM-USER-SELECT-2              PIC X(10).
  3983         16  AM-USER-SELECT-3              PIC X(10).
  3984         16  AM-USER-SELECT-4              PIC X(10).
  3985         16  AM-USER-SELECT-5              PIC X(10).
  3986
  3987     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3988
  3989     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3990
  3991     12  AM-RPT045A-SWITCH                 PIC X.
  3992         88  RPT045A-OFF                   VALUE 'N'.
  3993
  3994     12  AM-INSURANCE-LIMITS.
  3995         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3996         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3997
  3998     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3999         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4000
  4001     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4002         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4003         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4004
  4005     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4006
  4007     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4008     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4009     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4010     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4011     12  AM-DCC-UEF-STATE                  PIC XX.
  4012     12  FILLER                            PIC XXX.
  4013     12  AM-REPORT-CODE-3                  PIC X(10).
  4014*    12  FILLER                            PIC X(22).
  4015
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  71
* EL677.cbl
  4016     12  AM-RESERVE-DATE.
  4017         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4018         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4019         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4020
  4021     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4022     12  AM-NOTIFICATION-TYPES.
  4023         16  AM-NOTIF-OF-LETTERS           PIC X.
  4024         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4025         16  AM-NOTIF-OF-REPORTS           PIC X.
  4026         16  AM-NOTIF-OF-STATUS            PIC X.
  4027
  4028     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4029         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4030         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4031         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4032         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4033
  4034     12  AM-BENEFIT-CONTROLS.
  4035         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4036             20  AM-BENEFIT-CODE           PIC XX.
  4037             20  AM-BENEFIT-TYPE           PIC X.
  4038             20  AM-BENEFIT-REVISION       PIC XXX.
  4039             20  AM-BENEFIT-REM-TERM       PIC X.
  4040             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4041             20  FILLER                    PIC XX.
  4042         16  FILLER                        PIC X(80).
  4043
  4044     12  AM-TRANSFER-DATA.
  4045         16  AM-TRANSFERRED-FROM.
  4046             20  AM-TRNFROM-CARRIER        PIC X.
  4047             20  AM-TRNFROM-GROUPING.
  4048                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4049                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4050             20  AM-TRNFROM-STATE          PIC XX.
  4051             20  AM-TRNFROM-ACCOUNT.
  4052                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4053                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4054             20  AM-TRNFROM-DTE            PIC XX.
  4055         16  AM-TRANSFERRED-TO.
  4056             20  AM-TRNTO-CARRIER          PIC X.
  4057             20  AM-TRNTO-GROUPING.
  4058                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4059                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4060             20  AM-TRNTO-STATE            PIC XX.
  4061             20  AM-TRNTO-ACCOUNT.
  4062                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4063                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4064             20  AM-TRNTO-DTE              PIC XX.
  4065         16  FILLER                        PIC X(10).
  4066
  4067     12  AM-SAVED-REMIT-TO                 PIC 99.
  4068
  4069     12  AM-COMM-STRUCTURE-SAVED.
  4070         16  AM-DEFN-1-SAVED.
  4071             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4072                 24  AM-AGT-SV             PIC X(10).
  4073                 24  AM-COM-TYP-SV         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  72
* EL677.cbl
  4074                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4075                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4076                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4077                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4078                 24  FILLER                PIC X.
  4079                 24  AM-GL-CODES-SV        PIC X.
  4080                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4081                 24  FILLER                PIC X.
  4082         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4083             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4084                 24  FILLER                PIC X(11).
  4085                 24  AM-L-COMA-SV          PIC XXX.
  4086                 24  AM-J-COMA-SV          PIC XXX.
  4087                 24  AM-A-COMA-SV          PIC XXX.
  4088                 24  FILLER                PIC X(6).
  4089
  4090     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4091         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4092            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4093            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4094            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4095
  4096     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4097     12  FILLER                            PIC X(120).
  4098
  4099     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4100         16  AM-CONTROL-NAME               PIC X(30).
  4101         16  AM-EXECUTIVE-ONE.
  4102             20  AM-EXEC1-NAME             PIC X(15).
  4103             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4104                                                          COMP-3.
  4105             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4106                                                          COMP-3.
  4107         16  AM-EXECUTIVE-TWO.
  4108             20  AM-EXEC2-NAME             PIC X(15).
  4109             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4110                                                          COMP-3.
  4111             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4112                                                          COMP-3.
  4113
  4114     12  AM-RETRO-ADDITIONAL-DATA.
  4115         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4116         16  AM-RETRO-PREM-P-E             PIC X.
  4117         16  AM-RETRO-CLMS-P-I             PIC X.
  4118         16  AM-RETRO-RET-BRACKET-LF.
  4119             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4120                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4121                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4122             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4123                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4124                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4125             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4126                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4127                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4128         16  AM-RETRO-RET-BRACKET-AH.
  4129             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4130                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4131                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  73
* EL677.cbl
  4132                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4133             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4134                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4135                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4136             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4137                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4138                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4139
  4140     12  AM-COMMENTS.
  4141         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4142
  4143     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4144         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4145         16  AM-FLI-BILLING-CODE           PIC X.
  4146         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4147         16  AM-FLI-UNITED-IDENT           PIC X.
  4148         16  AM-FLI-INTEREST-LOST-DATA.
  4149             20  AM-FLI-BANK-NO            PIC X(5).
  4150             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4151             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4152             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4153         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4154             20  AM-FLI-AGT                PIC X(9).
  4155             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4156             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4157         16  FILLER                        PIC X(102).
  4158
  4159     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4160         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4161             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4162             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4163             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4164             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4165             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4166         16  FILLER                          PIC X(10).
  4167******************************************************************
  4168*                                    COPY ERCCOMP.
  4169******************************************************************
  4170*                                                                *
  4171*                                                                *
  4172*                            ERCCOMP                             *
  4173*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4174*                            VMOD=2.019                          *
  4175*                                                                *
  4176*   ONLINE CREDIT SYSTEM                                         *
  4177*                                                                *
  4178*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4179*                                                                *
  4180*   FILE TYPE = VSAM,KSDS                                        *
  4181*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4182*                                                                *
  4183*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4184*       ALTERNATE PATH = NONE                                    *
  4185*                                                                *
  4186*   LOG = NO                                                     *
  4187*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4188*                                                                *
  4189******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  74
* EL677.cbl
  4190*                   C H A N G E   L O G
  4191*
  4192* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4193*-----------------------------------------------------------------
  4194*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4195* EFFECTIVE    NUMBER
  4196*-----------------------------------------------------------------
  4197* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4198* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4199* 092205    2005050300006  PEMA  ADD LEASE FEE
  4200* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4201* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4202* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4203* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4204* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4205* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4206******************************************************************
  4207
  4208 01  COMPENSATION-MASTER.
  4209     12  CO-RECORD-ID                          PIC XX.
  4210         88  VALID-CO-ID                          VALUE 'CO'.
  4211
  4212     12  CO-CONTROL-PRIMARY.
  4213         16  CO-COMPANY-CD                     PIC X.
  4214         16  CO-CONTROL.
  4215             20  CO-CTL-1.
  4216                 24  CO-CARR-GROUP.
  4217                     28  CO-CARRIER            PIC X.
  4218                     28  CO-GROUPING.
  4219                         32  CO-GROUP-PREFIX   PIC XXX.
  4220                         32  CO-GROUP-PRIME    PIC XXX.
  4221                 24  CO-RESP-NO.
  4222                     28  CO-RESP-PREFIX        PIC X(4).
  4223                     28  CO-RESP-PRIME         PIC X(6).
  4224             20  CO-CTL-2.
  4225                 24  CO-ACCOUNT.
  4226                     28  CO-ACCT-PREFIX        PIC X(4).
  4227                     28  CO-ACCT-PRIME         PIC X(6).
  4228         16  CO-TYPE                           PIC X.
  4229             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4230             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4231             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4232
  4233     12  CO-MAINT-INFORMATION.
  4234         16  CO-LAST-MAINT-DT                  PIC XX.
  4235         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4236         16  CO-LAST-MAINT-USER                PIC X(4).
  4237     12  FILLER                                PIC XX.
  4238     12  CO-STMT-TYPE                          PIC XXX.
  4239     12  CO-COMP-TYPE                          PIC X.
  4240         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4241     12  CO-STMT-OWNER                         PIC X(4).
  4242     12  CO-BALANCE-CONTROL                    PIC X.
  4243         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4244         88  CO-NO-BALANCE                        VALUE 'N'.
  4245
  4246     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4247         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  75
* EL677.cbl
  4248         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4249         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4250
  4251     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4252         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4253         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4254
  4255     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4256     12  CO-GA-DIRECT-DEP                      PIC X.
  4257     12  CO-FUTURE-SPACE                       PIC X.
  4258         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4259
  4260     12  CO-ACCT-NAME                          PIC X(30).
  4261     12  CO-MAIL-NAME                          PIC X(30).
  4262     12  CO-ADDR-1                             PIC X(30).
  4263     12  CO-ADDR-2                             PIC X(30).
  4264     12  CO-ADDR-3.
  4265         16  CO-ADDR-CITY                      PIC X(27).
  4266         16  CO-ADDR-STATE                     PIC XX.
  4267     12  CO-CSO-1099                           PIC X.
  4268     12  CO-ZIP.
  4269         16  CO-ZIP-PRIME.
  4270             20  CO-ZIP-PRI-1ST                PIC X.
  4271                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4272             20  FILLER                        PIC X(4).
  4273         16  CO-ZIP-PLUS4                      PIC X(4).
  4274     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4275         16  CO-CAN-POSTAL-1                   PIC XXX.
  4276         16  CO-CAN-POSTAL-2                   PIC XXX.
  4277         16  FILLER                            PIC XXX.
  4278     12  CO-SOC-SEC                            PIC X(13).
  4279     12  CO-TELEPHONE.
  4280         16  CO-AREA-CODE                      PIC XXX.
  4281         16  CO-PREFIX                         PIC XXX.
  4282         16  CO-PHONE                          PIC X(4).
  4283
  4284     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4285
  4286     12  CO-AR-BAL-LEVEL                       PIC X.
  4287         88  CO-AR-REF-LVL                        VALUE '1'.
  4288         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4289         88  CO-AR-BILL-LVL                       VALUE '2'.
  4290         88  CO-AR-AGT-LVL                        VALUE '3'.
  4291         88  CO-AR-FR-LVL                         VALUE '4'.
  4292
  4293     12  CO-AR-NORMAL-PRINT                    PIC X.
  4294         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4295         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4296
  4297     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4298
  4299     12  CO-AR-REPORTING                       PIC X.
  4300         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4301         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4302
  4303     12  CO-AR-PULL-CHECK                      PIC X.
  4304         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4305         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  76
* EL677.cbl
  4306
  4307     12  CO-AR-BALANCE-PRINT                   PIC X.
  4308         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4309
  4310     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4311         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4312         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4313         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4314
  4315     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4316
  4317     12  CO-USER-CODE                          PIC X.
  4318     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4319
  4320******************************************************************
  4321*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4322*    THE LAST MONTH END RUN.
  4323******************************************************************
  4324
  4325     12  CO-LAST-ACTIVITY-DATE.
  4326         16  CO-ACT-YEAR                       PIC 99.
  4327         16  CO-ACT-MONTH                      PIC 99.
  4328         16  CO-ACT-DAY                        PIC 99.
  4329
  4330     12  CO-LAST-STMT-DT.
  4331         16  CO-LAST-STMT-YEAR                 PIC 99.
  4332         16  CO-LAST-STMT-MONTH                PIC 99.
  4333         16  CO-LAST-STMT-DAY                  PIC 99.
  4334
  4335     12  CO-MO-END-TOTALS.
  4336         16  CO-MONTHLY-TOTALS.
  4337             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4338             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4339             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4340             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4341             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4342
  4343         16  CO-AGING-TOTALS.
  4344             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4345             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4346             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4347             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4348
  4349         16  CO-YTD-TOTALS.
  4350             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4351             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4352
  4353         16  CO-OVER-UNDER-TOTALS.
  4354             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4355             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4356
  4357     12  CO-MISCELLANEOUS-TOTALS.
  4358         16  CO-FICA-TOTALS.
  4359             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4360             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4361
  4362         16  CO-CLAIM-TOTALS.
  4363             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  77
* EL677.cbl
  4364             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4365
  4366******************************************************************
  4367*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4368*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4369******************************************************************
  4370
  4371     12  CO-CURRENT-TOTALS.
  4372         16  CO-CURRENT-LAST-STMT-DT.
  4373             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4374             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4375             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4376
  4377         16  CO-CURRENT-MONTHLY-TOTALS.
  4378             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4379             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4380             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4381             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4382             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4383
  4384         16  CO-CURRENT-AGING-TOTALS.
  4385             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4386             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4387             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4388             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4389
  4390         16  CO-CURRENT-YTD-TOTALS.
  4391             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4392             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4393
  4394     12  CO-PAID-COMM-TOTALS.
  4395         16  CO-YTD-PAID-COMMS.
  4396             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4397             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4398
  4399     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4400         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4401         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4402
  4403     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4404         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4405         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4406         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4407         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4408         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4409         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4410         88  CO-FINAL-LETTER                  VALUE 'F'.
  4411         88  CO-RECONCILING                   VALUE 'R'.
  4412         88  CO-PHONE-CALL                    VALUE 'P'.
  4413         88  CO-LEGAL                         VALUE 'L'.
  4414         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4415         88  CO-WRITE-OFF                     VALUE 'W'.
  4416         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4417
  4418     12  CO-CSR-CODE                       PIC X(4).
  4419
  4420     12  CO-GA-STATUS-INFO.
  4421         16  CO-GA-EFFECTIVE-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  78
* EL677.cbl
  4422         16  CO-GA-TERMINATION-DT          PIC XX.
  4423         16  CO-GA-STATUS-CODE             PIC X.
  4424             88  CO-GA-ACTIVE                 VALUE 'A'.
  4425             88  CO-GA-INACTIVE               VALUE 'I'.
  4426             88  CO-GA-PENDING                VALUE 'P'.
  4427         16  CO-GA-COMMENTS.
  4428             20  CO-GA-COMMENT-1           PIC X(40).
  4429             20  CO-GA-COMMENT-2           PIC X(40).
  4430             20  CO-GA-COMMENT-3           PIC X(40).
  4431             20  CO-GA-COMMENT-4           PIC X(40).
  4432
  4433     12  CO-RPTCD2                         PIC X(10).
  4434     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4435         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4436         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4437
  4438     12  CO-TYPE-AGENT                     PIC X(01).
  4439         88  CO-CORPORATION                   VALUE 'C'.
  4440         88  CO-PARTNERSHIP                   VALUE 'P'.
  4441         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4442         88  CO-TRUST                         VALUE 'T'.
  4443         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4444
  4445     12  CO-FAXNO.
  4446         16  CO-FAX-AREA-CODE                  PIC XXX.
  4447         16  CO-FAX-PREFIX                     PIC XXX.
  4448         16  CO-FAX-PHONE                      PIC X(4).
  4449
  4450     12  CO-BANK-INFORMATION.
  4451         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4452         16  CO-BANK-TRANSIT-NON REDEFINES
  4453             CO-BANK-TRANSIT-NO                PIC 9(8).
  4454
  4455         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4456     12  CO-MISC-DEDUCT-INFO REDEFINES
  4457                  CO-BANK-INFORMATION.
  4458         16  CO-MD-GL-ACCT                     PIC X(10).
  4459         16  CO-MD-DIV                         PIC XX.
  4460         16  CO-MD-CENTER                      PIC X(4).
  4461         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4462         16  CO-CREATE-AP-CHECK                PIC X.
  4463         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4464         16  FILLER                            PIC XXX.
  4465     12  CO-ACH-STATUS                         PIC X.
  4466         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4467         88  CO-ACH-PENDING                        VALUE 'P'.
  4468
  4469     12  CO-BILL-SW                            PIC X.
  4470     12  CO-CONTROL-NAME                       PIC X(30).
  4471     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4472     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4473     12  CO-CLP-STATE                          PIC XX.
  4474     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4475     12  CO-SPP-REFUND-EDIT                    PIC X.
  4476
  4477******************************************************************
  4478*                                    COPY ELCCERT.
  4479******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  79
* EL677.cbl
  4480*                                                                *
  4481*                            ELCCERT.                            *
  4482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4483*                            VMOD=2.013                          *
  4484*                                                                *
  4485*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4486*                                                                *
  4487*   FILE TYPE = VSAM,KSDS                                        *
  4488*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4489*                                                                *
  4490*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4491*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4492*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4493*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4494*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4495*                                                                *
  4496*   LOG = YES                                                    *
  4497*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4498******************************************************************
  4499*                   C H A N G E   L O G
  4500*
  4501* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4502*-----------------------------------------------------------------
  4503*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4504* EFFECTIVE    NUMBER
  4505*-----------------------------------------------------------------
  4506* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4507* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4508* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4509* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4510* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4511* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4512* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4513* 032612  CR2011110200001  PEMA  AHL CHANGES
  4514* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4515* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4516******************************************************************
  4517
  4518 01  CERTIFICATE-MASTER.
  4519     12  CM-RECORD-ID                      PIC XX.
  4520         88  VALID-CM-ID                      VALUE 'CM'.
  4521
  4522     12  CM-CONTROL-PRIMARY.
  4523         16  CM-COMPANY-CD                 PIC X.
  4524         16  CM-CARRIER                    PIC X.
  4525         16  CM-GROUPING.
  4526             20  CM-GROUPING-PREFIX        PIC X(3).
  4527             20  CM-GROUPING-PRIME         PIC X(3).
  4528         16  CM-STATE                      PIC XX.
  4529         16  CM-ACCOUNT.
  4530             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4531             20  CM-ACCOUNT-PRIME          PIC X(6).
  4532         16  CM-CERT-EFF-DT                PIC XX.
  4533         16  CM-CERT-NO.
  4534             20  CM-CERT-PRIME             PIC X(10).
  4535             20  CM-CERT-SFX               PIC X.
  4536
  4537     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  80
* EL677.cbl
  4538         16  CM-COMPANY-CD-A1              PIC X.
  4539         16  CM-INSURED-LAST-NAME          PIC X(15).
  4540         16  CM-INSURED-INITIALS.
  4541             20  CM-INSURED-INITIAL1       PIC X.
  4542             20  CM-INSURED-INITIAL2       PIC X.
  4543
  4544     12  CM-CONTROL-BY-SSN.
  4545         16  CM-COMPANY-CD-A2              PIC X.
  4546         16  CM-SOC-SEC-NO.
  4547             20  CM-SSN-STATE              PIC XX.
  4548             20  CM-SSN-ACCOUNT            PIC X(6).
  4549             20  CM-SSN-LN3.
  4550                 25  CM-INSURED-INITIALS-A2.
  4551                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4552                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4553                 25 CM-PART-LAST-NAME-A2         PIC X.
  4554
  4555     12  CM-CONTROL-BY-CERT-NO.
  4556         16  CM-COMPANY-CD-A4              PIC X.
  4557         16  CM-CERT-NO-A4                 PIC X(11).
  4558
  4559     12  CM-CONTROL-BY-MEMB.
  4560         16  CM-COMPANY-CD-A5              PIC X.
  4561         16  CM-MEMBER-NO.
  4562             20  CM-MEMB-STATE             PIC XX.
  4563             20  CM-MEMB-ACCOUNT           PIC X(6).
  4564             20  CM-MEMB-LN4.
  4565                 25  CM-INSURED-INITIALS-A5.
  4566                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4567                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4568                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4569
  4570     12  CM-INSURED-PROFILE-DATA.
  4571         16  CM-INSURED-FIRST-NAME.
  4572             20  CM-INSURED-1ST-INIT       PIC X.
  4573             20  FILLER                    PIC X(9).
  4574         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4575         16  CM-INSURED-SEX                PIC X.
  4576             88  CM-SEX-MALE                  VALUE 'M'.
  4577             88  CM-SEX-FEMAL                 VALUE 'F'.
  4578         16  CM-INSURED-JOINT-AGE          PIC 99.
  4579         16  CM-JOINT-INSURED-NAME.
  4580             20  CM-JT-LAST-NAME           PIC X(15).
  4581             20  CM-JT-FIRST-NAME.
  4582                 24  CM-JT-1ST-INIT        PIC X.
  4583                 24  FILLER                PIC X(9).
  4584             20  CM-JT-INITIAL             PIC X.
  4585
  4586     12  CM-LIFE-DATA.
  4587         16  CM-LF-BENEFIT-CD              PIC XX.
  4588         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4589         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4590         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4591         16  CM-LF-DEV-CODE                PIC XXX.
  4592         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4593         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4594         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4595         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  81
* EL677.cbl
  4596         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4597         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4598         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4599         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4600         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4601         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4602         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4603         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4604         16  cm-temp-epiq                  pic xx.
  4605             88  EPIQ-CLASS                  value 'EQ'.
  4606*        16  FILLER                        PIC XX.
  4607
  4608     12  CM-AH-DATA.
  4609         16  CM-AH-BENEFIT-CD              PIC XX.
  4610         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4611         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4612         16  CM-AH-DEV-CODE                PIC XXX.
  4613         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4614         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4615         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4616         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4617         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4618         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4619         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4620         16  CM-AH-PAID-THRU-DT            PIC XX.
  4621             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4622         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4623         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4624         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4625         16  FILLER                        PIC X.
  4626
  4627     12  CM-LOAN-INFORMATION.
  4628         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4629         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4630                                           PIC S9(5)V99  COMP-3.
  4631         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4632         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4633         16  CM-PAY-FREQUENCY              PIC S99.
  4634         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4635         16  CM-RATE-CLASS                 PIC XX.
  4636         16  CM-BENEFICIARY                PIC X(25).
  4637         16  CM-POLICY-FORM-NO             PIC X(12).
  4638         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4639         16  CM-LAST-ADD-ON-DT             PIC XX.
  4640         16  CM-DEDUCTIBLE-AMOUNTS.
  4641             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4642             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4643         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4644             20  CM-RESIDENT-STATE         PIC XX.
  4645             20  CM-RATE-CODE              PIC X(4).
  4646             20  FILLER                    PIC XX.
  4647         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4648             20  CM-LOAN-OFFICER           PIC X(5).
  4649             20  FILLER                    PIC XXX.
  4650         16  CM-CSR-CODE                   PIC XXX.
  4651         16  CM-UNDERWRITING-CODE          PIC X.
  4652             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4653         16  CM-POST-CARD-IND              PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  82
* EL677.cbl
  4654         16  CM-NH-INTERFACE-SW            PIC X.
  4655         16  CM-PREMIUM-TYPE               PIC X.
  4656             88  CM-SING-PRM                  VALUE '1'.
  4657             88  CM-O-B-COVERAGE              VALUE '2'.
  4658             88  CM-OPEN-END                  VALUE '3'.
  4659         16  CM-IND-GRP-TYPE               PIC X.
  4660             88  CM-INDIVIDUAL                VALUE 'I'.
  4661             88  CM-GROUP                     VALUE 'G'.
  4662         16  CM-SKIP-CODE                  PIC X.
  4663             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4664             88  SKIP-JULY                    VALUE '1'.
  4665             88  SKIP-AUGUST                  VALUE '2'.
  4666             88  SKIP-SEPTEMBER               VALUE '3'.
  4667             88  SKIP-JULY-AUG                VALUE '4'.
  4668             88  SKIP-AUG-SEPT                VALUE '5'.
  4669             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4670             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4671             88  SKIP-JUNE                    VALUE '8'.
  4672             88  SKIP-JUNE-JULY               VALUE '9'.
  4673             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4674             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4675         16  CM-PAYMENT-MODE               PIC X.
  4676             88  PAY-MONTHLY                  VALUE SPACE.
  4677             88  PAY-WEEKLY                   VALUE '1'.
  4678             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4679             88  PAY-BI-WEEKLY                VALUE '3'.
  4680             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4681         16  CM-LOAN-NUMBER                PIC X(8).
  4682         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4683         16  CM-OLD-LOF                    PIC XXX.
  4684*        16  CM-LOAN-OFFICER               PIC XXX.
  4685         16  CM-REIN-TABLE                 PIC XXX.
  4686         16  CM-SPECIAL-REIN-CODE          PIC X.
  4687         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4688         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4689         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4690
  4691     12  CM-STATUS-DATA.
  4692         16  CM-ENTRY-STATUS               PIC X.
  4693         16  CM-ENTRY-DT                   PIC XX.
  4694
  4695         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4696         16  CM-LF-CANCEL-DT               PIC XX.
  4697         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4698
  4699         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4700         16  CM-LF-DEATH-DT                PIC XX.
  4701         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4702
  4703         16  CM-LF-CURRENT-STATUS          PIC X.
  4704             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4705                                                'M' '4' '5' '9'.
  4706             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4707             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4708             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4709             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4710             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4711             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  83
* EL677.cbl
  4712             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4713             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4714             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4715             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4716             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4717             88  CM-LF-DECLINED               VALUE 'D'.
  4718             88  CM-LF-VOIDED                 VALUE 'V'.
  4719
  4720         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4721         16  CM-AH-CANCEL-DT               PIC XX.
  4722         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4723
  4724         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4725         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4726         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4727
  4728         16  CM-AH-CURRENT-STATUS          PIC X.
  4729             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4730                                                'M' '4' '5' '9'.
  4731             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4732             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4733             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4734             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4735             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4736             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4737             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4738             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4739             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4740             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4741             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4742             88  CM-AH-DECLINED               VALUE 'D'.
  4743             88  CM-AH-VOIDED                 VALUE 'V'.
  4744
  4745         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4746             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4747             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4748             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4749         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4750
  4751         16  CM-ENTRY-BATCH                PIC X(6).
  4752         16  CM-LF-EXIT-BATCH              PIC X(6).
  4753         16  CM-AH-EXIT-BATCH              PIC X(6).
  4754         16  CM-LAST-MONTH-END             PIC XX.
  4755
  4756     12  CM-NOTE-SW                        PIC X.
  4757         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4758         88  CERT-NOTES-PRESENT               VALUE '1'.
  4759         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4760         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4761         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4762         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4763         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4764         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4765     12  CM-COMP-EXCP-SW                   PIC X.
  4766         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4767         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4768     12  CM-INSURED-ADDRESS-SW             PIC X.
  4769         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  84
* EL677.cbl
  4770         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4771
  4772*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4773     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4774     12  FILLER                            PIC X.
  4775
  4776*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4777     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4778     12  FILLER                            PIC X.
  4779*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4780     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4781
  4782     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4783         88  CERT-ADDED-BATCH                 VALUE ' '.
  4784         88  CERT-ADDED-ONLINE                VALUE '1'.
  4785         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4786         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4787         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4788     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4789         88  CERT-AS-LOADED                   VALUE ' '.
  4790         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4791         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4792         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4793         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4794         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4795         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4796         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4797
  4798     12  CM-ACCOUNT-COMM-PCTS.
  4799         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4800         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4801
  4802     12  CM-USER-FIELD                     PIC X.
  4803     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4804     12  CM-CLP-STATE                      PIC XX.
  4805     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4806     12  CM-USER-RESERVED                  PIC XXX.
  4807     12  FILLER REDEFINES CM-USER-RESERVED.
  4808         16  CM-AH-CLASS-CD                PIC XX.
  4809         16  F                             PIC X.
  4810******************************************************************
  4811*                                    COPY ERCPNDB.
  4812******************************************************************
  4813*                                                                *
  4814*                                                                *
  4815*                            ERCPNDB.                            *
  4816*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4817*                            VMOD=2.025                          *
  4818*                                                                *
  4819*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4820*                                                                *
  4821******************************************************************
  4822*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4823*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4824******************************************************************
  4825*                                                                *
  4826*                                                                *
  4827*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  85
* EL677.cbl
  4828*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4829*                                                                *
  4830*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4831*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4832*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4833*                                                 RKP=13,LEN=36  *
  4834*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4835*                                      AND CHG-SEQ.)             *
  4836*                                                RKP=49,LEN=11   *
  4837*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4838*                                      AND CHG-SEQ.)             *
  4839*                                                RKP=60,LEN=15   *
  4840*                                                                *
  4841*   LOG = NO                                                     *
  4842*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4843******************************************************************
  4844******************************************************************
  4845*                   C H A N G E   L O G
  4846*
  4847* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4848*-----------------------------------------------------------------
  4849*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4850* EFFECTIVE    NUMBER
  4851*-----------------------------------------------------------------
  4852* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4853* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4854* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4855* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4856* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4857* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4858* 032306                   PEMA  ADD BOW LOAN NUMBER
  4859* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4860* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4861* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4862* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4863* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4864* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4865* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4866* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4867* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4868* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4869******************************************************************
  4870
  4871 01  PENDING-BUSINESS.
  4872     12  PB-RECORD-ID                     PIC XX.
  4873         88  VALID-PB-ID                        VALUE 'PB'.
  4874
  4875     12  PB-CONTROL-PRIMARY.
  4876         16  PB-COMPANY-CD                PIC X.
  4877         16  PB-ENTRY-BATCH               PIC X(6).
  4878         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4879         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4880
  4881     12  PB-CONTROL-BY-ACCOUNT.
  4882         16  PB-COMPANY-CD-A1             PIC X.
  4883         16  PB-CARRIER                   PIC X.
  4884         16  PB-GROUPING.
  4885             20  PB-GROUPING-PREFIX       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  86
* EL677.cbl
  4886             20  PB-GROUPING-PRIME        PIC XXX.
  4887         16  PB-STATE                     PIC XX.
  4888         16  PB-ACCOUNT.
  4889             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4890             20  PB-ACCOUNT-PRIME         PIC X(6).
  4891         16  PB-CERT-EFF-DT               PIC XX.
  4892         16  PB-CERT-NO.
  4893             20  PB-CERT-PRIME            PIC X(10).
  4894             20  PB-CERT-SFX              PIC X.
  4895         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4896
  4897         16  PB-RECORD-TYPE               PIC X.
  4898             88  PB-MAILING-DATA                VALUE '0'.
  4899             88  PB-ISSUE                       VALUE '1'.
  4900             88  PB-CANCELLATION                VALUE '2'.
  4901             88  PB-BATCH-TRAILER               VALUE '9'.
  4902
  4903     12  PB-CONTROL-BY-ORIG-BATCH.
  4904         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4905         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4906         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4907         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4908
  4909     12  PB-CONTROL-BY-CSR.
  4910         16  PB-CSR-COMPANY-CD            PIC X.
  4911         16  PB-CSR-ID                    PIC X(4).
  4912         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4913         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4914         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4915******************************************************************
  4916*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4917******************************************************************
  4918
  4919     12  PB-LAST-MAINT-DT                 PIC XX.
  4920     12  PB-LAST-MAINT-BY                 PIC X(4).
  4921     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4922
  4923     12  PB-RECORD-BODY                   PIC X(375).
  4924
  4925     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4926         16  PB-CERT-ORIGIN               PIC X.
  4927             88  CLASIC-CREATED-CERT         VALUE '1'.
  4928         16  PB-I-NAME.
  4929             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4930             20  PB-I-INSURED-FIRST-NAME.
  4931                 24  PB-I-INSURED-1ST-INIT PIC X.
  4932                 24  FILLER                PIC X(9).
  4933             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4934         16  PB-I-AGE                     PIC S99   COMP-3.
  4935         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4936         16  PB-I-BIRTHDAY                PIC XX.
  4937         16  PB-I-INSURED-SEX             PIC X.
  4938             88  PB-SEX-MALE     VALUE 'M'.
  4939             88  PB-SEX-FEMALE   VALUE 'F'.
  4940
  4941         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4942         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4943         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  87
* EL677.cbl
  4944         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4945         16  PB-I-SKIP-CODE               PIC X.
  4946             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4947             88  PB-SKIP-JULY              VALUE '1'.
  4948             88  PB-SKIP-AUGUST            VALUE '2'.
  4949             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4950             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4951             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4952             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4953             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4954             88  PB-SKIP-JUNE              VALUE '8'.
  4955             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4956             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4957             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4958         16  PB-I-TERM-TYPE               PIC X.
  4959             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4960             88  PB-PAID-WEEKLY            VALUE 'W'.
  4961             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4962             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4963             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4964         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4965         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4966         16  PB-I-DATA-ENTRY-SW           PIC X.
  4967             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4968             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4969             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4970             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4971         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4972         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4973*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4974         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4975         16  FILLER                       PIC X.
  4976
  4977         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4978             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4979             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4980                                                   '90' THRU '99'.
  4981         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4982                                          PIC XX.
  4983         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4984         16  PB-I-AMOUNT-FINANCED REDEFINES
  4985                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4986         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4987         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4988                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4989         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4990         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4991         16  PB-I-CLP-AMOUNT REDEFINES
  4992                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4993         16  PB-I-LF-CALC-FLAG            PIC X.
  4994             88 PB-COMP-LF-PREM               VALUE '?'.
  4995         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4996         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4997         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4998         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4999         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5000         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5001         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  88
* EL677.cbl
  5002         16  PB-I-LF-ABBR                 PIC XXX.
  5003         16  PB-I-LF-INPUT-CD             PIC XX.
  5004
  5005         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5006             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5007             88  PB-INVALID-AH               VALUE '  ' '00'
  5008                                                   '90' THRU '99'.
  5009         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5010         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5011         16  PB-I-AH-CALC-FLAG            PIC X.
  5012             88 PB-COMP-AH-PREM                  VALUE '?'.
  5013         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5014         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5015         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  5016         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5017         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5018         16  PB-I-AH-ABBR                 PIC XXX.
  5019         16  PB-I-AH-INPUT-CD             PIC XXX.
  5020
  5021         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5022         16  PB-I-REIN-TABLE              PIC XXX.
  5023         16  PB-I-BUSINESS-TYPE           PIC 99.
  5024         16  PB-I-INDV-GRP-CD             PIC X.
  5025         16  PB-I-MORT-CODE.
  5026             20  PB-I-TABLE               PIC X.
  5027             20  PB-I-INTEREST            PIC XX.
  5028             20  PB-I-MORT-TYP            PIC X.
  5029         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5030         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5031         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5032         16  PB-I-INDV-GRP-OVRD           PIC X.
  5033         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5034         16  PB-I-SIG-SW                  PIC X.
  5035             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5036         16  PB-I-RATE-CLASS              PIC XX.
  5037         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5038         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5039         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5040         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5041         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5042         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5043         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5044         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5045         16  PB-I-OB-FLAG                 PIC X.
  5046             88  PB-I-OB                      VALUE 'B'.
  5047             88  PB-I-SUMMARY                 VALUE 'Z'.
  5048         16  PB-I-ENTRY-STATUS            PIC X.
  5049             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5050                                              'M' '5' '9' '2'.
  5051             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5052             88  PB-I-POLICY-PENDING          VALUE '2'.
  5053             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5054             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5055             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  5056             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5057             88  PB-I-REIN-ONLY               VALUE '9'.
  5058             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5059             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  89
* EL677.cbl
  5060             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5061             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5062         16  PB-I-INT-CODE                PIC X.
  5063             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5064             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5065         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5066         16  PB-I-SOC-SEC-NO              PIC X(11).
  5067         16  PB-I-MEMBER-NO               PIC X(12).
  5068         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5069*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5070         16  PB-I-OLD-LOF                 PIC XXX.
  5071         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5072         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5073         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5074         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5075         16  PB-I-LIFE-INDICATOR          PIC X.
  5076             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5077         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5078         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5079                                          PIC S9(5)V99    COMP-3.
  5080         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5081             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5082             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5083         16  PB-I-1ST-PMT-DT              PIC XX.
  5084         16  PB-I-JOINT-INSURED.
  5085             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5086             20 PB-I-JOINT-FIRST-NAME.
  5087                24  PB-I-JOINT-FIRST-INIT PIC X.
  5088                24  FILLER                PIC X(9).
  5089             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5090*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5091         16  PB-I-BENEFICIARY-NAME.
  5092             20  PB-I-BANK-NUMBER         PIC X(10).
  5093             20  FILLER                   PIC X(15).
  5094         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5095         16  PB-I-REFERENCE               PIC X(12).
  5096         16  FILLER REDEFINES PB-I-REFERENCE.
  5097             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5098             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5099             20  PB-I-CLP-STATE           PIC XX.
  5100         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5101             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5102             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5103             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5104         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5105         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5106         16  PB-I-RESIDENT-STATE          PIC XX.
  5107         16  PB-I-RATE-CODE               PIC X(4).
  5108         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5109         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5110         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5111         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5112         16  PB-I-BANK-NOCHRGB            PIC 99.
  5113         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5114         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5115
  5116     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5117         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  90
* EL677.cbl
  5118             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5119         16  PB-C-CANCEL-ORIGIN           PIC X.
  5120             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5121         16  PB-C-LF-CANCEL-DT            PIC XX.
  5122         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5123         16  PB-C-LF-CALC-REQ             PIC X.
  5124             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5125         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5126         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5127         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5128             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5129         16  PB-C-AH-CANCEL-DT            PIC XX.
  5130         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5131         16  PB-C-AH-CALC-REQ             PIC X.
  5132             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5133         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5134         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5135         16  PB-C-LAST-NAME               PIC X(15).
  5136         16  PB-C-REFUND-SW               PIC X.
  5137             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5138             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5139         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5140         16  PB-C-PAYEE-CODE              PIC X(6).
  5141         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5142         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5143         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5144         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5145         16  PB-C-REFERENCE               PIC X(12).
  5146         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5147         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5148         16  PB-C-POST-CARD-IND           PIC X.
  5149         16  PB-C-CANCEL-REASON           PIC X.
  5150         16  PB-C-REF-INTERFACE-SW        PIC X.
  5151         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5152         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5153         16  FILLER                       PIC X(01).
  5154*        16  FILLER                       PIC X(18).
  5155         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5156*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5157         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  5158         16  PB-CANCELED-CERT-DATA.
  5159             20  PB-CI-INSURED-NAME.
  5160                 24  PB-CI-LAST-NAME      PIC X(15).
  5161                 24  PB-CI-INITIALS       PIC XX.
  5162             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5163             20  PB-CI-INSURED-SEX        PIC X.
  5164             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5165             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5166             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5167             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5168             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5169             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5170             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5171             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5172             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5173             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5174             20  PB-CI-RATE-CLASS         PIC XX.
  5175             20  PB-CI-RATE-DEV-LF        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  91
* EL677.cbl
  5176             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5177             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5178             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5179             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5180             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5181             20  PB-CI-LF-ABBR            PIC X(3).
  5182             20  PB-CI-AH-ABBR            PIC X(3).
  5183             20  PB-CI-OB-FLAG            PIC X.
  5184                 88  PB-CI-OB                VALUE 'B'.
  5185             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5186                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5187                                           'M' '4' '5' '9' '2'.
  5188                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5189                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5190                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5191                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5192                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5193                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  5194                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5195                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5196                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5197                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5198                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5199                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5200                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5201             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5202                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5203                                           'M' '4' '5' '9' '2'.
  5204                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5205                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5206                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5207                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5208                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5209                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  5210                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5211                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5212                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5213                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5214                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5215                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5216                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5217             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5218             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5219             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5220             20  PB-CI-MEMBER-NO          PIC X(12).
  5221             20  PB-CI-INT-CODE           PIC X.
  5222                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5223                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5224             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5225             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5226             20  PB-CI-COMP-EXCP-SW       PIC X.
  5227                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5228                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5229             20  PB-CI-ENTRY-STATUS       PIC X.
  5230             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5231             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5232             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5233             20  PB-CI-DEATH-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  92
* EL677.cbl
  5234             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5235             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5236             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5237             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5238             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5239             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5240             20  PB-CI-ENTRY-DT              PIC XX.
  5241             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5242             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5243             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5244             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5245             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5246             20  PB-CI-OLD-LOF               PIC XXX.
  5247*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5248             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5249             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5250             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5251             20  PB-CI-INDV-GRP-CD           PIC X.
  5252             20  PB-CI-BENEFICIARY-NAME.
  5253                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5254                 24  FILLER                  PIC X(15).
  5255             20  PB-CI-NOTE-SW               PIC X.
  5256             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5257             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5258             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5259             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5260             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5261             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5262             20  PB-CI-FIRST-NAME            PIC X(10).
  5263             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5264
  5265         16  FILLER                       PIC X(13).
  5266*032306  16  FILLER                       PIC X(27).
  5267*        16  FILLER                       PIC X(46).
  5268
  5269     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5270         16  FILLER                       PIC X(10).
  5271         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5272         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5273         16  PB-M-INSURED-MID-INIT        PIC X.
  5274         16  PB-M-INSURED-AGE             PIC 99.
  5275         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5276         16  PB-M-INSURED-SEX             PIC X.
  5277         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5278         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5279         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5280         16  PB-M-INSURED-CITY-STATE.
  5281             20  PB-M-INSURED-CITY        PIC X(28).
  5282             20  PB-M-INSURED-STATE       PIC XX.
  5283         16  PB-M-INSURED-ZIP-CODE.
  5284             20  PB-M-INSURED-ZIP-PRIME.
  5285                 24  PB-M-INSURED-ZIP-1   PIC X.
  5286                     88  PB-M-CANADIAN-POST-CODE
  5287                                             VALUE 'A' THRU 'Z'.
  5288                 24  FILLER               PIC X(4).
  5289             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5290         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5291                                        PB-M-INSURED-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  93
* EL677.cbl
  5292             20  PM-M-INS-CAN-POST1       PIC XXX.
  5293             20  PM-M-INS-CAN-POST2       PIC XXX.
  5294             20  FILLER                   PIC XXX.
  5295         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5296         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5297         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5298         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5299         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5300         16  PB-M-CRED-BENE-CITYST.
  5301             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5302             20  PB-M-CRED-BENE-STATE     PIC XX.
  5303         16  FILLER                       PIC X(92).
  5304
  5305     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5306         16  FILLER                       PIC X(10).
  5307         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5308         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5309         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5310         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5311         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5312         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5313         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5314         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5315         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5316         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5317         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5318         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5319         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5320         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5321         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5322         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5323         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5324         16  PB-ACCOUNT-NAME              PIC X(30).
  5325         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5326         16  PB-REFERENCE                 PIC X(12).
  5327         16  PB-B-RECEIVED-DT             PIC XX.
  5328         16  FILLER                       PIC X(234).
  5329
  5330     12  PB-RECORD-STATUS.
  5331         16  PB-CREDIT-SELECT-DT          PIC XX.
  5332         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5333         16  PB-BILLED-DT                 PIC XX.
  5334         16  PB-BILLING-STATUS            PIC X.
  5335             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5336             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5337             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5338         16  PB-RECORD-BILL               PIC X.
  5339             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5340             88  PB-RECORD-RETURNED           VALUE 'R'.
  5341             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5342             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5343             88  PB-OVERRIDE-AH               VALUE 'A'.
  5344             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5345         16  PB-BATCH-ENTRY               PIC X.
  5346             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5347             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5348             88  PB-REISSUED-CERT             VALUE 'E'.
  5349             88  PB-CASH-CERT                 VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  94
* EL677.cbl
  5350             88  PB-MONTHLY-CERT              VALUE 'M'.
  5351             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5352             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5353             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5354         16  PB-FORCE-CODE                PIC X.
  5355             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5356             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5357             88  PB-CANCEL-FORCE              VALUE '8'.
  5358             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5359             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5360             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5361             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5362             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5363             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5364             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5365         16  PB-FATAL-FLAG                PIC X.
  5366             88  PB-FATAL-ERRORS              VALUE 'X'.
  5367         16  PB-FORCE-ER-CD               PIC X.
  5368             88  PB-FORCE-ERRORS              VALUE 'F'.
  5369             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5370         16  PB-WARN-ER-CD                PIC X.
  5371             88  PB-WARNING-ERRORS            VALUE 'W'.
  5372         16  FILLER                       PIC X.
  5373         16  PB-OUT-BAL-CD                PIC X.
  5374             88  PB-OUT-OF-BAL                VALUE 'O'.
  5375         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5376         16  PB-AH-OVERRIDE-L1            PIC X.
  5377         16  PB-INPUT-DT                  PIC XX.
  5378         16  PB-INPUT-BY                  PIC X(4).
  5379         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5380         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5381         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5382         16  PB-LF-EARNING-METHOD         PIC X.
  5383         16  PB-AH-EARNING-METHOD         PIC X.
  5384         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5385         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5386         16  PB-REIN-CD                   PIC XXX.
  5387         16  PB-LF-REFUND-TYPE            PIC X.
  5388         16  PB-AH-REFUND-TYPE            PIC X.
  5389         16  PB-ACCT-EFF-DT               PIC XX.
  5390         16  PB-ACCT-EXP-DT               PIC XX.
  5391         16  PB-COMPANY-ID                PIC X(3).
  5392         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5393         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5394         16  PB-SV-CARRIER                PIC X.
  5395         16  PB-SV-GROUPING               PIC X(6).
  5396         16  PB-SV-STATE                  PIC XX.
  5397         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5398         16  PB-GA-BILLING-INFO.
  5399             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5400                                          PIC XX.
  5401         16  PB-SV-REMIT-TO  REDEFINES
  5402             PB-GA-BILLING-INFO           PIC X(10).
  5403         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5404         16  PB-I-LOAN-OFFICER            PIC X(5).
  5405         16  PB-I-VIN                     PIC X(17).
  5406
  5407         16  FILLER                       PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  95
* EL677.cbl
  5408         16  IMNET-BYPASS-SW              PIC X.
  5409
  5410******************************************************************
  5411*                COMMON EDIT ERRORS                              *
  5412******************************************************************
  5413
  5414     12  PB-COMMON-ERRORS.
  5415         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5416                                           PIC S9(4)     COMP.
  5417
  5418******************************************************************
  5419*                                    COPY ERCPNDM.
  5420******************************************************************
  5421*                                                                *
  5422*                                                                *
  5423*                            ERCPNDM                             *
  5424*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5425*                            VMOD=2.003                          *
  5426*                                                                *
  5427*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5428*                                                                *
  5429*   FILE TYPE = VSAM,KSDS                                        *
  5430*   RECORD SIZE = 374   RECFORM = FIX                            *
  5431*                                                                *
  5432*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5433*   ALTERNATE PATH    = NOT USED                                 *
  5434*                                                                *
  5435*   LOG = YES                                                    *
  5436*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5437******************************************************************
  5438*                   C H A N G E   L O G
  5439*
  5440* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5441*-----------------------------------------------------------------
  5442*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5443* EFFECTIVE    NUMBER
  5444*-----------------------------------------------------------------
  5445* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5446* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5447* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5448******************************************************************
  5449
  5450 01  PENDING-MAILING-DATA.
  5451     12  PM-RECORD-ID                      PIC XX.
  5452         88  VALID-MA-ID                       VALUE 'PM'.
  5453
  5454     12  PM-CONTROL-PRIMARY.
  5455         16  PM-COMPANY-CD                 PIC X.
  5456         16  PM-ENTRY-BATCH                PIC X(6).
  5457         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5458         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5459
  5460     12  FILLER                            PIC X(14).
  5461
  5462     12  PM-ACCESS-CONTROL.
  5463         16  PM-SOURCE-SYSTEM              PIC XX.
  5464             88  PM-FROM-CREDIT                VALUE 'CR'.
  5465             88  PM-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  96
* EL677.cbl
  5466             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5467             88  PM-FROM-OTHER                 VALUE 'OT'.
  5468         16  PM-RECORD-ADD-DT              PIC XX.
  5469         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5470         16  PM-LAST-MAINT-DT              PIC XX.
  5471         16  PM-LAST-MAINT-BY              PIC XXXX.
  5472         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5473
  5474     12  PM-PROFILE-INFO.
  5475         16  PM-QUALIFY-CODE-1             PIC XX.
  5476         16  PM-QUALIFY-CODE-2             PIC XX.
  5477         16  PM-QUALIFY-CODE-3             PIC XX.
  5478         16  PM-QUALIFY-CODE-4             PIC XX.
  5479         16  PM-QUALIFY-CODE-5             PIC XX.
  5480
  5481         16  PM-INSURED-LAST-NAME          PIC X(15).
  5482         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5483         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5484         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5485         16  PM-INSURED-BIRTH-DT           PIC XX.
  5486         16  PM-INSURED-SEX                PIC X.
  5487             88  PM-SEX-MALE                   VALUE 'M'.
  5488             88  PM-SEX-FEMALE                 VALUE 'F'.
  5489         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5490
  5491         16  PM-ADDRESS-CORRECTED          PIC X.
  5492         16  PM-JOINT-BIRTH-DT             PIC XX.
  5493*        16  FILLER                        PIC X(12).
  5494
  5495         16  PM-ADDRESS-LINE-1             PIC X(30).
  5496         16  PM-ADDRESS-LINE-2             PIC X(30).
  5497         16  PM-CITY-STATE.
  5498             20  PM-CITY                   PIC X(28).
  5499             20  PM-STATE                  PIC XX.
  5500         16  PM-ZIP.
  5501             20  PM-ZIP-CODE.
  5502                 24  PM-ZIP-1              PIC X.
  5503                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5504                 24  FILLER                PIC X(4).
  5505             20  PM-ZIP-PLUS4              PIC X(4).
  5506         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5507             20  PM-CAN-POST1              PIC XXX.
  5508             20  PM-CAN-POST2              PIC XXX.
  5509             20  FILLER                    PIC XXX.
  5510
  5511         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5512
  5513         16  FILLER                        PIC X(03).
  5514
  5515     12  PM-CRED-BENE-INFO.
  5516         16  PM-CRED-BENE-NAME             PIC X(25).
  5517         16  PM-CRED-BENE-ADDR             PIC X(30).
  5518         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5519         16  PM-CRED-BENE-CTYST.
  5520             20  PM-CRED-BENE-CITY         PIC X(28).
  5521             20  PM-CRED-BENE-STATE        PIC XX.
  5522         16  PM-CRED-BENE-ZIP.
  5523             20  PM-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  97
* EL677.cbl
  5524                 24  PM-CB-ZIP-1           PIC X.
  5525                     88  PM-CB-CANADIAN-POST-CODE
  5526                                  VALUE 'A' THRU 'Z'.
  5527                 24  FILLER                PIC X(4).
  5528             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5529         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5530             20  PM-CB-CAN-POST1           PIC XXX.
  5531             20  PM-CB-CAN-POST2           PIC XXX.
  5532             20  FILLER                    PIC XXX.
  5533     12  PM-POST-CARD-MAIL-DATA.
  5534         16  PM-MAIL-DATA OCCURS 7.
  5535             20  PM-MAIL-TYPE              PIC X.
  5536                 88  PM-12MO-MAILING           VALUE '1'.
  5537                 88  PM-EXP-MAILING            VALUE '2'.
  5538             20  PM-MAIL-STATUS            PIC X.
  5539                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5540                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5541                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5542             20  PM-MAIL-DATE              PIC XX.
  5543     12  FILLER                            PIC XX.
  5544     12  FILLER                            PIC X(12).
  5545*    12  FILLER                            PIC X(30).
  5546
  5547******************************************************************
  5548*                                    COPY ERCMAIL.
  5549******************************************************************
  5550*                                                                *
  5551*                                                                *
  5552*                            ERCMAIL                             *
  5553*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5554*                            VMOD=2.003                          *
  5555*                                                                *
  5556*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5557*                                                                *
  5558*   FILE TYPE = VSAM,KSDS                                        *
  5559*   RECORD SIZE = 374   RECFORM = FIX                            *
  5560*                                                                *
  5561*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5562*   ALTERNATE PATH    = NOT USED                                 *
  5563*                                                                *
  5564*   LOG = YES                                                    *
  5565*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5566******************************************************************
  5567*                   C H A N G E   L O G
  5568*
  5569* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5570*-----------------------------------------------------------------
  5571*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5572* EFFECTIVE    NUMBER
  5573*-----------------------------------------------------------------
  5574* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5575* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5576* 111108                   PEMA  ADD CRED BENE ADDR2
  5577******************************************************************
  5578
  5579 01  MAILING-DATA.
  5580     12  MA-RECORD-ID                      PIC XX.
  5581         88  VALID-MA-ID                       VALUE 'MA'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  98
* EL677.cbl
  5582
  5583     12  MA-CONTROL-PRIMARY.
  5584         16  MA-COMPANY-CD                 PIC X.
  5585         16  MA-CARRIER                    PIC X.
  5586         16  MA-GROUPING.
  5587             20  MA-GROUPING-PREFIX        PIC XXX.
  5588             20  MA-GROUPING-PRIME         PIC XXX.
  5589         16  MA-STATE                      PIC XX.
  5590         16  MA-ACCOUNT.
  5591             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5592             20  MA-ACCOUNT-PRIME          PIC X(6).
  5593         16  MA-CERT-EFF-DT                PIC XX.
  5594         16  MA-CERT-NO.
  5595             20  MA-CERT-PRIME             PIC X(10).
  5596             20  MA-CERT-SFX               PIC X.
  5597
  5598     12  FILLER                            PIC XX.
  5599
  5600     12  MA-ACCESS-CONTROL.
  5601         16  MA-SOURCE-SYSTEM              PIC XX.
  5602             88  MA-FROM-CREDIT                VALUE 'CR'.
  5603             88  MA-FROM-VSI                   VALUE 'VS'.
  5604             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5605             88  MA-FROM-OTHER                 VALUE 'OT'.
  5606         16  MA-RECORD-ADD-DT              PIC XX.
  5607         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5608         16  MA-LAST-MAINT-DT              PIC XX.
  5609         16  MA-LAST-MAINT-BY              PIC XXXX.
  5610         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5611
  5612     12  MA-PROFILE-INFO.
  5613         16  MA-QUALIFY-CODE-1             PIC XX.
  5614         16  MA-QUALIFY-CODE-2             PIC XX.
  5615         16  MA-QUALIFY-CODE-3             PIC XX.
  5616         16  MA-QUALIFY-CODE-4             PIC XX.
  5617         16  MA-QUALIFY-CODE-5             PIC XX.
  5618
  5619         16  MA-INSURED-LAST-NAME          PIC X(15).
  5620         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5621         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5622         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5623         16  MA-INSURED-BIRTH-DT           PIC XX.
  5624         16  MA-INSURED-SEX                PIC X.
  5625             88  MA-SEX-MALE                   VALUE 'M'.
  5626             88  MA-SEX-FEMALE                 VALUE 'F'.
  5627         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5628
  5629         16  MA-ADDRESS-CORRECTED          PIC X.
  5630         16  MA-JOINT-BIRTH-DT             PIC XX.
  5631*        16  FILLER                        PIC X(12).
  5632
  5633         16  MA-ADDRESS-LINE-1             PIC X(30).
  5634         16  MA-ADDRESS-LINE-2             PIC X(30).
  5635         16  MA-CITY-STATE.
  5636             20  MA-CITY                   PIC X(28).
  5637             20  MA-ADDR-STATE             PIC XX.
  5638         16  MA-ZIP.
  5639             20  MA-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page  99
* EL677.cbl
  5640                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5641                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5642                 24  FILLER                PIC X(4).
  5643             20  MA-ZIP-PLUS4              PIC X(4).
  5644         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5645             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5646             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5647             20  FILLER                    PIC X(3).
  5648
  5649         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5650
  5651         16  FILLER                        PIC XXX.
  5652*        16  FILLER                        PIC X(10).
  5653
  5654     12  MA-CRED-BENE-INFO.
  5655         16  MA-CRED-BENE-NAME                 PIC X(25).
  5656         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5657         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5658         16  MA-CRED-BENE-CTYST.
  5659             20  MA-CRED-BENE-CITY             PIC X(28).
  5660             20  MA-CRED-BENE-STATE            PIC XX.
  5661         16  MA-CRED-BENE-ZIP.
  5662             20  MA-CB-ZIP-CODE.
  5663                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5664                     88  MA-CB-CANADIAN-POST-CODE
  5665                                           VALUE 'A' THRU 'Z'.
  5666                 24  FILLER                    PIC X(4).
  5667             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5668         16  MA-CB-CANADIAN-POSTAL-CODE
  5669                            REDEFINES MA-CRED-BENE-ZIP.
  5670             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5671             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5672             20  FILLER                        PIC X(3).
  5673     12  MA-POST-CARD-MAIL-DATA.
  5674         16  MA-MAIL-DATA OCCURS 7.
  5675             20  MA-MAIL-TYPE              PIC X.
  5676                 88  MA-12MO-MAILING           VALUE '1'.
  5677                 88  MA-EXP-MAILING            VALUE '2'.
  5678             20  MA-MAIL-STATUS            PIC X.
  5679                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5680                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5681                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5682             20  MA-MAIL-DATE              PIC XX.
  5683     12  FILLER                            PIC XX.
  5684     12  FILLER                            PIC XX.
  5685*    12  FILLER                            PIC X(30).
  5686******************************************************************
  5687*                                    COPY ERCPYAJ.
  5688******************************************************************
  5689*                                                                *
  5690*                            ERCPYAJ                             *
  5691*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5692*                            VMOD=2.015                          *
  5693*                                                                *
  5694*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5695*                                                                *
  5696*                                                                *
  5697*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 100
* EL677.cbl
  5698*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5699*                                                                *
  5700*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5701*       ALTERNATE PATHS = NONE                                   *
  5702*                                                                *
  5703*   LOG = YES                                                    *
  5704*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5705******************************************************************
  5706******************************************************************
  5707*                   C H A N G E   L O G
  5708*
  5709* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5710*-----------------------------------------------------------------
  5711*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5712* EFFECTIVE    NUMBER
  5713*-----------------------------------------------------------------
  5714* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5715* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5716******************************************************************
  5717
  5718 01  PENDING-PAY-ADJ.
  5719     12  PY-RECORD-ID                     PIC XX.
  5720         88  VALID-PY-ID                        VALUE 'PY'.
  5721
  5722     12  PY-CONTROL-PRIMARY.
  5723         16  PY-COMPANY-CD                PIC X.
  5724         16  PY-CARRIER                   PIC X.
  5725         16  PY-GROUPING                  PIC X(6).
  5726         16  PY-FIN-RESP                  PIC X(10).
  5727         16  PY-ACCOUNT                   PIC X(10).
  5728         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5729                                          PIC X(10).
  5730         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5731         16  PY-RECORD-TYPE               PIC X.
  5732             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5733             88  PY-DEPOSIT                   VALUE 'D'.
  5734             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5735             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5736             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5737             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5738             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5739             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5740             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5741             88  PY-FICA-ENTRY                VALUE 'F'.
  5742             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5743             88  PY-POLICY-FEE                VALUE 'W'.
  5744             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  5745
  5746     12  PY-PYMT-TYPE                     PIC X.
  5747             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5748             88  PY-REINS-PYMT                VALUE 'R'.
  5749             88  PY-EXP-PYMT                  VALUE 'E'.
  5750
  5751     12  PY-BIL-INV                       PIC X(6).
  5752     12  PY-REF-NO                        PIC X(12).
  5753
  5754     12  PY-LAST-MAINT-DT                 PIC XX.
  5755     12  PY-LAST-MAINT-BY                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 101
* EL677.cbl
  5756     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5757
  5758     12  PY-PYADJ-RECORD.
  5759         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5760         16  PY-ENTRY-COMMENT             PIC X(30).
  5761         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5762             20  PY-GL-ACCOUNT            PIC X(10).
  5763             20  PY-GL-STATE              PIC X(02).
  5764             20  PY-GL-CANC-SW            PIC X(01).
  5765                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5766                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5767             20  PY-GL-COMMENT            PIC X(10).
  5768             20  FILLER      REDEFINES PY-GL-COMMENT.
  5769                 24  PY-GL-CHECK-NO       PIC 9(06).
  5770                 24  FILLER               PIC X(04).
  5771             20  FILLER                   PIC X(07).
  5772         16  PY-SAVE-ACCOUNT              PIC X(10).
  5773         16  PY-SAVE-TYPE                 PIC X(01).
  5774
  5775         16  PY-LETTERS.
  5776             20  PY-LETTER OCCURS 3 TIMES
  5777                           INDEXED BY PY-LET-NDX
  5778                                          PIC X(04).
  5779
  5780         16  PY-ERCOMP-TYPE               PIC X.
  5781             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5782             88  PY-GA-TYPE                   VALUE 'G'.
  5783             88  PY-BANK-TYPE                 VALUE 'B'.
  5784         16  FILLER                       PIC X(05).
  5785
  5786     12  PY-RECORD-STATUS.
  5787         16  PY-CREDIT-SELECT-DT          PIC XX.
  5788         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5789         16  PY-BILLED-DATE               PIC XX.
  5790         16  PY-REPORTED-DT               PIC XX.
  5791         16  PY-PMT-APPLIED               PIC X.
  5792             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5793             88  PY-GA-PMT                    VALUE 'G'.
  5794             88  PY-OVWRITE-PMT               VALUE 'O'.
  5795             88  PY-NON-AR-PMT                VALUE 'N'.
  5796         16  FILLER                       PIC X(5).
  5797         16  PY-INPUT-DT                  PIC XX.
  5798         16  PY-CHECK-NUMBER              PIC X(6).
  5799         16  PY-VOID-SW                   PIC X.
  5800             88  PY-CHECK-VOIDED              VALUE 'V'.
  5801         16  PY-CHECK-ORIGIN-SW           PIC X.
  5802             88  PY-BILLING-CHECK             VALUE 'B'.
  5803             88  PY-REFUND-CHECK              VALUE 'R'.
  5804             88  PY-GA-CHECK                  VALUE 'G'.
  5805             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5806             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5807         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5808         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5809         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5810         16  PY-BILL-FLAG                 PIC X.
  5811             88  PY-BILLED                    VALUE 'B'.
  5812         16  PY-AR-FLAG                   PIC X.
  5813             88  PY-AR-CYCLE                  VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 102
* EL677.cbl
  5814             88  PY-AR-MONTH-END              VALUE 'M'.
  5815         16  PY-AR-DATE                   PIC XX.
  5816
  5817     12  PY-GL-CODES.
  5818         16  PY-GL-DB                     PIC X(14).
  5819         16  PY-GL-CR                     PIC X(14).
  5820         16  PY-GL-FLAG                   PIC X.
  5821         16  PY-GL-DATE                   PIC XX.
  5822
  5823     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5824     12  FILLER                           PIC X(3).
  5825******************************************************************
  5826 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
  5827                          CHECK-RECORDS ACCOUNT-MASTER
  5828                          COMPENSATION-MASTER
  5829                          CERTIFICATE-MASTER PENDING-BUSINESS
  5830                          PENDING-MAILING-DATA MAILING-DATA
  5831                          PENDING-PAY-ADJ.
  5832 0000-DFHEXIT SECTION.
  5833     MOVE '9#                    $   ' TO DFHEIV0.
  5834     MOVE 'EL677' TO DFHEIV1.
  5835     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5836
  5837     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5838     MOVE '5'                    TO  DC-OPTION-CODE.
  5839     PERFORM 8500-DATE-CONVERT.
  5840     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5841     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5842     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5843
  5844     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5845
  5846     IF PI-AMOUNT NOT NUMERIC
  5847         MOVE ZEROS              TO  PI-AMOUNT.
  5848
  5849     IF EIBCALEN = 0
  5850         GO TO 8800-UNAUTHORIZED-ACCESS.
  5851     set P to address of KIXSYS
  5852     CALL "getenv" using by value P returning var-ptr
  5853     if var-ptr = null then
  5854        display ' kixsys not set '
  5855     else
  5856        set address of var to var-ptr
  5857        move 0 to env-var-len
  5858        inspect var tallying env-var-len
  5859          for characters before X'00'
  5860        unstring var (1:env-var-len) delimited by '/'
  5861           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5862              WS-KIX-SYS
  5863        end-unstring
  5864     end-if
  5865     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5866     MOVE 2                      TO  EMI-SWITCH2.
  5867     MOVE EIBTRMID               TO  QID-TERM.
  5868
  5869     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5870         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5871
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 103
* EL677.cbl
  5872     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5873         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5874             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5875             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5876             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5877             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5878             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5879             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5880             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5881             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5882         ELSE
  5883             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5884             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5885             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5886             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5887             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5888             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5889             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5890             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5891
  5892     MOVE LOW-VALUES             TO  EL677AI.
  5893
  5894     if eibtrnid not = trans-id
  5895        evaluate true
  5896           when pi-return-to-program = 'EL6315'
  5897              move pi-company-cd to pi-chek-comp-cd
  5898              move pi-carrier    to pi-chek-carrier
  5899              move pi-grouping   to pi-chek-grouping
  5900              move pi-state      to pi-chek-state
  5901              move pi-account    to pi-chek-account
  5902              move pi-cert-eff-dt to pi-chek-eff-dt
  5903              move pi-cert-prime to pi-chek-cert-no
  5904              move pi-cert-sfx   to pi-chek-suf-no
  5905              move +1            to pi-chek-sequence
  5906              move 'C'           to pi-check-type *> Correction
  5907              move 'S'           to mainti
  5908              move +1            to maintl
  5909              move al-uanon      to mainta
  5910              move dfhenter      to eibaid
  5911              go to 5000-browse-file
  5912           when pi-return-to-program = 'EL6318'
  5913              move 'C'           to pi-check-type *> Correction
  5914           when other
  5915              move 'R'           to pi-check-type *> Refund
  5916        end-evaluate
  5917     end-if
  5918     IF EIBTRNID NOT = TRANS-ID
  5919         move pi-processor-id    to pi-return-to
  5920         move +1                 to dedcynl
  5921         move 'N'                to dedcyno
  5922         move al-uanon           to dedcyna
  5923         move dfhpf7             to eibaid
  5924         perform 6800-browse-previous-chek-recs *> totals up prev
  5925                                 thru 6800-exit
  5926         perform 5600-get-erpndb thru 5600-exit *> calc refund on
  5927                                                *> pending record
  5928         IF PI-TO-EL677-FROM-EL1273
  5929             MOVE 'S'            TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 104
* EL677.cbl
  5930             MOVE 1              TO MAINTL
  5931             MOVE AL-UABON       TO MAINTA
  5932             MOVE DFHENTER       TO EIBAID
  5933             GO TO 5000-BROWSE-FILE.
  5934
  5935     IF EIBTRNID NOT = TRANS-ID
  5936        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5937           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5938           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5939           IF PI-PROCESS-BENEFICIARY
  5940              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5941           ELSE
  5942              GO TO 6300-BUILD-CERT-SCREEN
  5943           end-if
  5944        ELSE
  5945           IF EIBTRNID NOT = EL6311-TRANS-ID and el6318-trans-id
  5946              GO TO 8100-SEND-INITIAL-MAP
  5947           ELSE
  5948              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5949              IF PI-PROCESS-BENEFICIARY
  5950                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5951              ELSE
  5952                 GO TO 6300-BUILD-CERT-SCREEN
  5953              end-if
  5954           end-if
  5955        end-if
  5956     end-if
  5957
  5958     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5959                                     PI-CHEK-COMP-CD.
  5960
  5961
  5962* EXEC CICS HANDLE CONDITION
  5963*        PGMIDERR  (9600-PGMID-ERROR)
  5964*        ERROR     (9990-ABEND)
  5965*    END-EXEC.
  5966*    MOVE '"$L.                  ! " #00005864' TO DFHEIV0
  5967     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5968     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5969     MOVE X'2220233030303035383634' TO DFHEIV0(25:11)
  5970     CALL 'kxdfhei1' USING DFHEIV0
  5971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5972
  5973
  5974     IF EIBAID = DFHCLEAR
  5975         GO TO 9400-CLEAR.
  5976
  5977     IF PI-PROCESSOR-ID = 'LGXX'
  5978         GO TO 0200-RECEIVE.
  5979
  5980
  5981* EXEC CICS READQ TS
  5982*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5983*        INTO   (SECURITY-CONTROL)
  5984*        LENGTH (SC-COMM-LENGTH)
  5985*        ITEM   (SC-ITEM)
  5986*    END-EXEC.
  5987*    MOVE '*$II   L              ''   #00005875' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 105
* EL677.cbl
  5988     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5989     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5990     MOVE X'2020233030303035383735' TO DFHEIV0(25:11)
  5991     CALL 'kxdfhei1' USING DFHEIV0,
  5992           PI-SECURITY-TEMP-STORE-ID,
  5993           SECURITY-CONTROL,
  5994           SC-COMM-LENGTH,
  5995           SC-ITEM,
  5996           DFHEIV99,
  5997           DFHEIV99
  5998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5999
  6000
  6001     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  6002     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  6003
  6004     IF NOT DISPLAY-CAP
  6005         MOVE 'READ'          TO SM-READ
  6006         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6007         MOVE ER-0070         TO  EMI-ERROR
  6008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6009         GO TO 8100-SEND-INITIAL-MAP.
  6010
  6011 0200-RECEIVE.
  6012     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6013         MOVE ER-1159            TO  EMI-ERROR
  6014         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6015         MOVE -1                 TO  PFENTERL
  6016         GO TO 8200-SEND-DATAONLY.
  6017
  6018
  6019* EXEC CICS HANDLE CONDITION
  6020*        MAPFAIL (8100-SEND-INITIAL-MAP)
  6021*    END-EXEC.
  6022*    MOVE '"$?                   ! # #00005899' TO DFHEIV0
  6023     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6024     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6025     MOVE X'2320233030303035383939' TO DFHEIV0(25:11)
  6026     CALL 'kxdfhei1' USING DFHEIV0
  6027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6028
  6029
  6030
  6031* EXEC CICS RECEIVE
  6032*        MAP      (EL677A)
  6033*        MAPSET   (MAPSET-NAME)
  6034*        INTO     (EL677AI)
  6035*    END-EXEC.
  6036     MOVE LENGTH OF
  6037      EL677AI
  6038       TO DFHEIV11
  6039*    MOVE '8"T I  L              ''   #00005903' TO DFHEIV0
  6040     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6041     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6042     MOVE X'2020233030303035393033' TO DFHEIV0(25:11)
  6043     CALL 'kxdfhei1' USING DFHEIV0,
  6044           EL677A,
  6045           EL677AI,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 106
* EL677.cbl
  6046           DFHEIV11,
  6047           MAPSET-NAME,
  6048           DFHEIV99,
  6049           DFHEIV99
  6050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6051
  6052
  6053     IF PFENTERL GREATER ZERO
  6054         IF EIBAID NOT = DFHENTER
  6055             MOVE ER-0004        TO  EMI-ERROR
  6056             MOVE AL-UNBOF       TO  PFENTERA
  6057             MOVE -1             TO  PFENTERL
  6058             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6059             GO TO 8200-SEND-DATAONLY
  6060         ELSE
  6061             IF (PFENTERI NUMERIC) AND
  6062                (PFENTERI GREATER 0 AND LESS 25)
  6063                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  6064             ELSE
  6065                 MOVE ER-0029    TO  EMI-ERROR
  6066                 MOVE AL-UNBOF   TO  PFENTERA
  6067                 MOVE -1         TO  PFENTERL
  6068                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6069                 GO TO 8200-SEND-DATAONLY.
  6070 0300-CHECK-PFKEYS.
  6071     IF EIBAID = DFHPF23
  6072         GO TO 8810-PF23.
  6073
  6074     IF EIBAID = DFHPF24
  6075         GO TO 9200-RETURN-MAIN-MENU.
  6076
  6077     IF EIBAID = DFHPF12
  6078         GO TO 9500-PF12.
  6079
  6080     IF EIBAID = DFHPF1 OR DFHPF2
  6081         GO TO 5000-BROWSE-FILE.
  6082
  6083     if PI-TO-EL677-FROM-EL1273
  6084        and (eibaid not = dfhenter)
  6085        go to 0320-input-error
  6086     end-if
  6087     IF EIBAID = DFHPF3
  6088         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6089         MOVE 'PF3'              TO  PI-PFKEY
  6090         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6091         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6092             GO TO 9400-CLEAR
  6093         ELSE
  6094             MOVE XCTL-1273      TO  PGM-NAME
  6095             GO TO 9300-XCTL.
  6096
  6097     IF EIBAID = DFHPF4
  6098         IF NOT FORCE-CAP
  6099             MOVE ER-0433        TO EMI-ERROR
  6100             MOVE -1             TO PFENTERL
  6101             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6102             GO TO 8200-SEND-DATAONLY.
  6103
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 107
* EL677.cbl
  6104     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6105                             DFHPF5 OR DFHPF6 or dfhpf7
  6106         GO TO 1000-EDIT-DATA.
  6107
  6108*    IF EIBAID = DFHPF7
  6109*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6110*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6111*        MOVE XCTL-114           TO  PGM-NAME
  6112*        GO TO 9300-XCTL.
  6113
  6114 0320-INPUT-ERROR.
  6115     MOVE ER-0029                TO  EMI-ERROR.
  6116     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6117     MOVE -1                     TO  PFENTERL.
  6118     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 108
* EL677.cbl
  6120
  6121 1000-EDIT-DATA.
  6122     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D'
  6123         MOVE AL-UANON           TO MAINTA
  6124         IF MAINTI = 'C' OR 'V'
  6125             IF PI-PREV-MAINT = 'S'  OR  'C'
  6126                 NEXT SENTENCE
  6127             ELSE
  6128                 MOVE ER-2056    TO  EMI-ERROR
  6129                 MOVE -1         TO  MAINTL
  6130                 MOVE AL-UABON   TO  MAINTA
  6131                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6132                 GO TO 1100-EDIT-COMPLETE
  6133         ELSE
  6134             NEXT SENTENCE
  6135     ELSE
  6136         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6137            NEXT SENTENCE
  6138         ELSE
  6139            MOVE ER-0023            TO  EMI-ERROR
  6140            MOVE -1                 TO  MAINTL
  6141            MOVE AL-UABON           TO  MAINTA
  6142            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6143
  6144     IF MODIFY-CAP
  6145         NEXT SENTENCE
  6146       ELSE
  6147         IF MAINTI NOT = 'S'
  6148            MOVE 'UPDATE'       TO SM-READ
  6149            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6150            MOVE ER-0070        TO EMI-ERROR
  6151            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6152            GO TO 8100-SEND-INITIAL-MAP.
  6153
  6154     if (pi-return-to-program = 'EL1273')
  6155        and (MAINTI not = 'S' and 'V')
  6156        move 'S'                 to mainti
  6157        move +1                  to maintl
  6158        move al-uanon            to mainta
  6159     end-if
  6160     IF CARRIERI NOT = LOW-VALUES
  6161         MOVE AL-UANON           TO  CARRIERA
  6162         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6163         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6164                                     PI-CARRIER
  6165     ELSE
  6166         MOVE -1                 TO  CARRIERL
  6167         MOVE AL-UABON           TO  CARRIERA
  6168         MOVE ER-0194            TO  EMI-ERROR
  6169         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6170
  6171     IF GROUPI NOT = LOW-VALUES
  6172         MOVE AL-UANON           TO  GROUPA
  6173         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6174                                     PI-GROUPING
  6175     ELSE
  6176         MOVE -1                 TO  GROUPL
  6177         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 109
* EL677.cbl
  6178         MOVE ER-0195            TO  EMI-ERROR
  6179         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6180
  6181     IF STATEI NOT = LOW-VALUES
  6182         MOVE AL-UANON           TO  STATEA
  6183         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6184         MOVE STATEI             TO  PI-CHEK-STATE
  6185                                     PI-STATE
  6186     ELSE
  6187         MOVE -1                 TO  STATEL
  6188         MOVE AL-UABON           TO  STATEA
  6189         MOVE ER-0196            TO  EMI-ERROR
  6190         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6191
  6192     IF EFFDTL GREATER ZERO
  6193         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6194         PERFORM 8700-DEEDIT
  6195         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6196             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6197             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6198             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6199             MOVE '4'                TO  DC-OPTION-CODE
  6200             PERFORM 8500-DATE-CONVERT
  6201             IF DC-ERROR-CODE NOT = SPACES
  6202                 MOVE ER-0215        TO  EMI-ERROR
  6203                 PERFORM 9900-ERROR-FORMAT
  6204                 MOVE -1             TO  EFFDTL
  6205                 MOVE AL-UABON       TO  EFFDTA
  6206               ELSE
  6207                 MOVE AL-UANON       TO  EFFDTA
  6208                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6209                                         PI-CERT-EFF-DT
  6210           ELSE
  6211             MOVE ER-0215        TO  EMI-ERROR
  6212             PERFORM 9900-ERROR-FORMAT
  6213             MOVE -1             TO  EFFDTL
  6214             MOVE AL-UABON       TO  EFFDTA
  6215       ELSE
  6216         MOVE ER-0216            TO  EMI-ERROR
  6217         PERFORM 9900-ERROR-FORMAT
  6218         MOVE -1                 TO  EFFDTL
  6219         MOVE AL-UABOF           TO  EFFDTA.
  6220
  6221     IF ACCTI NOT = LOW-VALUES
  6222         MOVE AL-UANON           TO  ACCTA
  6223         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6224         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6225                                     PI-ACCOUNT
  6226     ELSE
  6227         MOVE -1                 TO  ACCTL
  6228         MOVE AL-UABON           TO  ACCTA
  6229         MOVE ER-0197            TO  EMI-ERROR
  6230         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6231
  6232     IF CERTNOI NOT = LOW-VALUES
  6233         MOVE AL-UANON           TO  CERTNOA
  6234         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6235                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 110
* EL677.cbl
  6236     ELSE
  6237         MOVE -1                 TO  CERTNOL
  6238         MOVE AL-UABON           TO  CERTNOA
  6239         MOVE ER-0203            TO  EMI-ERROR
  6240         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6241
  6242     IF SFXI  = LOW-VALUES
  6243         MOVE SPACE              TO  SFXI.
  6244
  6245     MOVE AL-UANON               TO  SFXA.
  6246
  6247     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6248                                     PI-CERT-SFX.
  6249     IF SEQI = LOW-VALUES
  6250         MOVE +1                 TO  SEQI.
  6251
  6252     MOVE AL-UNNON               TO  SEQA.
  6253     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6254
  6255     IF PAYTO1L > 0
  6256         MOVE PAYTO1I            TO  PI-PAYTO1
  6257     ELSE
  6258         MOVE SPACES             TO  PI-PAYTO1.
  6259
  6260     IF AMOUNTL > 0
  6261
  6262* EXEC CICS BIF DEEDIT
  6263*            FIELD   (AMOUNTI)
  6264*            LENGTH  (11)
  6265*        END-EXEC
  6266     MOVE 11
  6267       TO DFHEIV11
  6268*    MOVE '@"L                   #   #00006117' TO DFHEIV0
  6269     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6270     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6271     MOVE X'2020233030303036313137' TO DFHEIV0(25:11)
  6272     CALL 'kxdfhei1' USING DFHEIV0,
  6273           AMOUNTI,
  6274           DFHEIV11
  6275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6276         MOVE AMOUNTI            TO  PI-AMOUNT
  6277     ELSE
  6278         MOVE ZEROS              TO  PI-AMOUNT.
  6279
  6280     IF TYPEL > 0
  6281         MOVE TYPEI              TO  PI-TYPE
  6282     ELSE
  6283         MOVE SPACE              TO  PI-TYPE.
  6284
  6285*    IF REFL > 0
  6286*        MOVE REFI               TO  PI-REFERENCE
  6287*    ELSE
  6288*        MOVE SPACES             TO  PI-REFERENCE.
  6289     if rettol not = zeros
  6290        move rettoi              to pi-return-to
  6291        MOVE AL-UANON            TO  RETTOA
  6292     end-if
  6293     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 111
* EL677.cbl
  6294        if dedcyni = 'Y' OR 'N'
  6295           continue
  6296        else
  6297           move er-3451          to emi-error
  6298           move -1               to dedcynl
  6299           move al-uabon         to dedcyna
  6300           perform 9900-error-format
  6301                                 thru 9900-exit
  6302        end-if
  6303     end-if
  6304
  6305     if mainti = 'V'
  6306        if (vreasonl > zeros)
  6307           and (vreasoni (1:2) not = spaces)
  6308           continue
  6309        else
  6310           move er-3454          to emi-error
  6311           move -1               to vreasonl
  6312           move al-uabon         to vreasona
  6313           perform 9900-error-format
  6314                                 thru 9900-exit
  6315        end-if
  6316     end-if
  6317     if (mainti = 'A')
  6318        and (pi-prev-paid > zeros)
  6319        and (pi-check-type = 'C')
  6320        move er-3459             to emi-error
  6321        move -1                  to maintl
  6322        move al-uabon            to mainta
  6323        perform 9900-error-format
  6324                                 thru 9900-exit
  6325     end-if
  6326     if mainti = 'A'
  6327        continue
  6328     else
  6329        IF MAINTI = 'S'
  6330           or pi-prev-maint = 'S'
  6331           GO TO 1100-EDIT-COMPLETE
  6332        end-if
  6333     end-if
  6334     IF EIBAID = DFHPF5
  6335        IF EMI-ERROR = ZEROS
  6336          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6337        ELSE
  6338          GO TO 1100-EDIT-COMPLETE.
  6339
  6340     IF EIBAID = DFHPF6
  6341        IF EMI-ERROR = ZEROS
  6342           GO TO 6300-BUILD-CERT-SCREEN
  6343         ELSE
  6344           GO TO 1100-EDIT-COMPLETE.
  6345
  6346     IF EIBAID = DFHPF7
  6347        IF EMI-ERROR = ZEROS
  6348           GO TO 6600-build-beneficiary-screen
  6349         ELSE
  6350           GO TO 1100-EDIT-COMPLETE.
  6351
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 112
* EL677.cbl
  6352*    if mainti = 'V'
  6353*       if (vreasonl > zeros)
  6354*          and (vreasoni (1:2) not = spaces)
  6355*          continue
  6356*       else
  6357*          move er-3454          to emi-error
  6358*          move -1               to vreasonl
  6359*          move al-uabon         to vreasona
  6360*          perform 9900-error-format
  6361*                                thru 9900-exit
  6362*       end-if
  6363*    end-if
  6364     IF MAINTI = 'A'
  6365        if (payto1i not = spaces and low-values)
  6366           and (payad1i not = spaces and low-values)
  6367           and (payctyi not = spaces and low-values)
  6368           and (paysti not = spaces and low-values)
  6369           and (ptozipi not = spaces and low-values)
  6370           continue
  6371        else
  6372           MOVE -1               TO PAYTO1L
  6373           MOVE ER-2907          TO EMI-ERROR
  6374           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6375        end-if
  6376     end-if
  6377
  6378     IF MAINTI = 'A'
  6379         IF EIBAID NOT = DFHPF4
  6380             MOVE DFHENTER       TO  EIBAID
  6381             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6382
  6383     IF MAINTI = 'S' OR 'V'
  6384         GO TO 1100-EDIT-COMPLETE.
  6385
  6386     IF PRINTEDL GREATER THAN +0
  6387         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6388         PERFORM 8700-DEEDIT
  6389         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6390             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6391             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6392             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6393             MOVE '4'                TO  DC-OPTION-CODE
  6394             PERFORM 8500-DATE-CONVERT
  6395             IF DC-ERROR-CODE NOT = SPACES
  6396                 MOVE ER-3046        TO  EMI-ERROR
  6397                 PERFORM 9900-ERROR-FORMAT
  6398                 MOVE -1             TO  PRINTEDL
  6399                 MOVE AL-UABON       TO  PRINTEDA
  6400                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6401             ELSE
  6402                 MOVE AL-UANON       TO  PRINTEDA
  6403                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6404         ELSE
  6405             MOVE ER-3046        TO  EMI-ERROR
  6406             PERFORM 9900-ERROR-FORMAT
  6407             MOVE -1             TO  PRINTEDL
  6408             MOVE AL-UABON       TO  PRINTEDA
  6409             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 113
* EL677.cbl
  6410
  6411     IF AMOUNTL = ZEROS
  6412         GO TO 1050-CK-AMT.
  6413
  6414
  6415* EXEC CICS BIF DEEDIT
  6416*        FIELD   (AMOUNTI)
  6417*        LENGTH  (11)
  6418*    END-EXEC.
  6419     MOVE 11
  6420       TO DFHEIV11
  6421*    MOVE '@"L                   #   #00006259' TO DFHEIV0
  6422     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6423     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6424     MOVE X'2020233030303036323539' TO DFHEIV0(25:11)
  6425     CALL 'kxdfhei1' USING DFHEIV0,
  6426           AMOUNTI,
  6427           DFHEIV11
  6428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6429
  6430
  6431     IF AMOUNTI NOT NUMERIC     OR
  6432        AMOUNTI LESS THAN ZERO  OR
  6433       (AMOUNTI = ZEROS  AND
  6434               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6435          MOVE ER-1159            TO  EMI-ERROR
  6436          MOVE -1                 TO  AMOUNTL
  6437          MOVE AL-UNBON           TO  AMOUNTA
  6438          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6439          GO TO 1100-EDIT-COMPLETE.
  6440
  6441     MOVE AMOUNTI                TO  WS-AM-WORK.
  6442
  6443     IF WS-AM-SIGN = SPACES
  6444         MOVE WS-AM-NUM          TO  WS-AMT
  6445         ADD 0                   TO  WS-AMT
  6446       ELSE
  6447         MOVE AMOUNTI            TO  WS-AMT
  6448         ADD 0                   TO  WS-AMT.
  6449
  6450      MOVE WS-AMT                TO  AMOUNTO.
  6451      MOVE AL-UNNON              TO  AMOUNTA.
  6452
  6453 1050-CK-AMT.
  6454     IF AMOUNTL = ZEROS AND
  6455        MAINTI  = 'A'
  6456         MOVE ER-1159            TO  EMI-ERROR
  6457         MOVE -1                 TO  AMOUNTL
  6458         MOVE AL-UNBON           TO  AMOUNTA
  6459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6460
  6461     if pi-amount = pi-prev-paid
  6462         MOVE ER-9999            TO EMI-ERROR
  6463         MOVE -1                 TO maintL
  6464         MOVE AL-UABON           TO maintA
  6465         PERFORM 9900-ERROR-FORMAT
  6466                                 THRU 9900-EXIT
  6467     end-if
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 114
* EL677.cbl
  6468*    MOVE AL-UANON              TO  TYPEA.
  6469
  6470     IF TYPEL GREATER THAN ZEROS
  6471         IF TYPEI = 'R' OR 'M' OR 'E' or 'C'
  6472             NEXT SENTENCE
  6473         ELSE
  6474             MOVE ER-3044    TO  EMI-ERROR
  6475             MOVE -1         TO  TYPEL
  6476             MOVE AL-PABON   TO  TYPEA
  6477             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6478     ELSE
  6479         IF MAINTI  = 'A'
  6480             MOVE ER-3044    TO  EMI-ERROR
  6481             MOVE -1         TO  TYPEL
  6482             MOVE AL-PABON   TO  TYPEA
  6483             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6484
  6485
  6486 1100-EDIT-COMPLETE.
  6487
  6488     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6489       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6490        EIBAID NOT = DFHPF4)
  6491         GO TO 8200-SEND-DATAONLY.
  6492
  6493     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6494
  6495     IF MAINTI = 'A'
  6496         GO TO 2000-ADD-RECORD.
  6497
  6498*    IF MAINTI = 'C' OR 'V'
  6499     IF MAINTI = 'V'
  6500         GO TO 3000-CHANGE-RECORD.
  6501
  6502     IF MAINTI = 'S' or 'C'
  6503         GO TO 5000-BROWSE-FILE.
  6504
  6505     if mainti = 'D'
  6506        go to 3400-delete-record
  6507     end-if
  6508     .
  6509 1200-VERIFY-CARRIER-ID.
  6510     MOVE SPACES                 TO ELCNTL-KEY.
  6511     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6512     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6513     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6514     MOVE +0                     TO ELCNTL-SEQ.
  6515
  6516
  6517* EXEC CICS HANDLE CONDITION
  6518*        NOTFND   (1290-NO-CARRIER)
  6519*    END-EXEC.
  6520*    MOVE '"$I                   ! $ #00006349' TO DFHEIV0
  6521     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6523     MOVE X'2420233030303036333439' TO DFHEIV0(25:11)
  6524     CALL 'kxdfhei1' USING DFHEIV0
  6525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 115
* EL677.cbl
  6526
  6527
  6528
  6529* EXEC CICS READ
  6530*        DATASET   (ELCNTL-FILE-ID)
  6531*        SET       (ADDRESS OF CONTROL-FILE)
  6532*        RIDFLD    (ELCNTL-KEY)
  6533*    END-EXEC.
  6534*    MOVE '&"S        E          (   #00006353' TO DFHEIV0
  6535     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6537     MOVE X'2020233030303036333533' TO DFHEIV0(25:11)
  6538     CALL 'kxdfhei1' USING DFHEIV0,
  6539           ELCNTL-FILE-ID,
  6540           DFHEIV20,
  6541           DFHEIV99,
  6542           ELCNTL-KEY,
  6543           DFHEIV99,
  6544           DFHEIV99,
  6545           DFHEIV99
  6546     SET ADDRESS OF CONTROL-FILE TO
  6547         DFHEIV20
  6548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6549
  6550
  6551     GO TO 1200-EXIT.
  6552
  6553 1290-NO-CARRIER.
  6554     MOVE ER-2208                TO EMI-ERROR.
  6555     MOVE -1                     TO CARRIERL.
  6556     MOVE AL-UABON               TO CARRIERA.
  6557     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6558
  6559 1200-EXIT.
  6560      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 116
* EL677.cbl
  6562 1300-VERIFY-STATE-ID.
  6563     MOVE SPACES                 TO ELCNTL-KEY.
  6564     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6565     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6566     MOVE STATEI                 TO ELCNTL-STATE.
  6567     MOVE +0                     TO ELCNTL-SEQ.
  6568
  6569
  6570* EXEC CICS HANDLE CONDITION
  6571*        NOTFND   (1380-NO-STATE)
  6572*    END-EXEC.
  6573*    MOVE '"$I                   ! % #00006377' TO DFHEIV0
  6574     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6576     MOVE X'2520233030303036333737' TO DFHEIV0(25:11)
  6577     CALL 'kxdfhei1' USING DFHEIV0
  6578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6579
  6580
  6581
  6582* EXEC CICS READ
  6583*        DATASET   (ELCNTL-FILE-ID)
  6584*        SET       (ADDRESS OF CONTROL-FILE)
  6585*        RIDFLD    (ELCNTL-KEY)
  6586*    END-EXEC.
  6587*    MOVE '&"S        E          (   #00006381' TO DFHEIV0
  6588     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6590     MOVE X'2020233030303036333831' TO DFHEIV0(25:11)
  6591     CALL 'kxdfhei1' USING DFHEIV0,
  6592           ELCNTL-FILE-ID,
  6593           DFHEIV20,
  6594           DFHEIV99,
  6595           ELCNTL-KEY,
  6596           DFHEIV99,
  6597           DFHEIV99,
  6598           DFHEIV99
  6599     SET ADDRESS OF CONTROL-FILE TO
  6600         DFHEIV20
  6601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6602
  6603
  6604     GO TO 1390-EXIT.
  6605
  6606 1380-NO-STATE.
  6607     MOVE ER-2209                TO EMI-ERROR.
  6608     MOVE -1                     TO STATEL.
  6609     MOVE AL-UABON               TO STATEA.
  6610     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6611
  6612 1390-EXIT.
  6613      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 117
* EL677.cbl
  6615
  6616 1400-VERIFY-ACCOUNT.
  6617     IF EIBAID = DFHPF5
  6618         GO TO 1410-BUILD-ACCOUNT-KEY.
  6619
  6620     IF MAINTL GREATER +0
  6621         NEXT SENTENCE
  6622       ELSE
  6623         GO TO 1490-EXIT.
  6624
  6625*    IF MAINTI = 'A' OR 'C' OR 'V'
  6626     IF MAINTI = 'A' OR 'V'
  6627         NEXT SENTENCE
  6628       ELSE
  6629         GO TO 1490-EXIT.
  6630
  6631 1410-BUILD-ACCOUNT-KEY.
  6632     MOVE CARRIERI               TO ERACCT-CARRIER.
  6633     MOVE GROUPI                 TO ERACCT-GROUPING
  6634     MOVE STATEI                 TO ERACCT-STATE.
  6635     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6636     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6637
  6638     MOVE '2'                    TO DC-OPTION-CODE.
  6639     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6640
  6641     PERFORM 8500-DATE-CONVERT.
  6642     IF DATE-CONVERSION-ERROR
  6643        GO TO 1480-ACCOUNT-INVALID.
  6644
  6645     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6646    .
  6647 1420-get-eracct.
  6648     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6649
  6650
  6651* EXEC CICS HANDLE CONDITION
  6652*        NOTFND   (1480-ACCOUNT-INVALID)
  6653*        ENDFILE  (1480-ACCOUNT-INVALID)
  6654*    END-EXEC.
  6655*    MOVE '"$I''                  ! & #00006433' TO DFHEIV0
  6656     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6658     MOVE X'2620233030303036343333' TO DFHEIV0(25:11)
  6659     CALL 'kxdfhei1' USING DFHEIV0
  6660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6661
  6662
  6663
  6664* EXEC CICS STARTBR
  6665*        DATASET   (ERACCT-FILE-ID)
  6666*        RIDFLD    (ERACCT-KEY)
  6667*    END-EXEC.
  6668     MOVE 0
  6669       TO DFHEIV11
  6670*    MOVE '&,         G          &   #00006438' TO DFHEIV0
  6671     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6672     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 118
* EL677.cbl
  6673     MOVE X'2020233030303036343338' TO DFHEIV0(25:11)
  6674     CALL 'kxdfhei1' USING DFHEIV0,
  6675           ERACCT-FILE-ID,
  6676           ERACCT-KEY,
  6677           DFHEIV99,
  6678           DFHEIV11,
  6679           DFHEIV99
  6680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6681
  6682
  6683     set eracct-start to true
  6684     .
  6685 1420-READNEXT-ACCOUNT-MASTER.
  6686
  6687* EXEC CICS READNEXT
  6688*        DATASET   (ERACCT-FILE-ID)
  6689*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6690*        RIDFLD    (ERACCT-KEY)
  6691*    END-EXEC.
  6692     MOVE 0
  6693       TO DFHEIV11
  6694*    MOVE '&.S                   )   #00006446' TO DFHEIV0
  6695     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6696     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6697     MOVE X'2020233030303036343436' TO DFHEIV0(25:11)
  6698     CALL 'kxdfhei1' USING DFHEIV0,
  6699           ERACCT-FILE-ID,
  6700           DFHEIV20,
  6701           DFHEIV99,
  6702           ERACCT-KEY,
  6703           DFHEIV99,
  6704           DFHEIV11,
  6705           DFHEIV99,
  6706           DFHEIV99
  6707     SET ADDRESS OF ACCOUNT-MASTER TO
  6708         DFHEIV20
  6709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6710
  6711
  6712*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6713*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6714*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6715*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6716*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6717*         GO TO 1480-ACCOUNT-INVALID.
  6718*
  6719*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6720*        GO TO 1480-ACCOUNT-INVALID.
  6721*
  6722*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6723*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6724
  6725     evaluate true
  6726        when (save-eracct-key (1:20) not =
  6727           am-control-primary (1:20))
  6728           and (not eracct-found)
  6729           go to 1480-account-invalid
  6730        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 119
* EL677.cbl
  6731           am-control-primary (1:20))
  6732           and (eracct-found)
  6733           move ws-hold-eracct-record
  6734                                 to account-master
  6735        when (sv-acct-exp-date < am-effective-dt)
  6736           and (not eracct-found)
  6737           go to 1480-account-invalid
  6738        when sv-acct-exp-date >= am-expiration-dt
  6739           go to 1420-readnext-account-master
  6740        when am-expiration-dt = high-values
  6741           continue
  6742        when other
  6743           set eracct-found to true
  6744           move account-master   to ws-hold-eracct-record
  6745           go to 1420-readnext-account-master
  6746     end-evaluate
  6747     if eracct-start
  6748
  6749* exec cics endbr
  6750*          dataset  (eracct-file-id)
  6751*       end-exec
  6752     MOVE 0
  6753       TO DFHEIV11
  6754*    MOVE '&2                    $   #00006488' TO DFHEIV0
  6755     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6756     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6757     MOVE X'2020233030303036343838' TO DFHEIV0(25:11)
  6758     CALL 'kxdfhei1' USING DFHEIV0,
  6759           eracct-file-id,
  6760           DFHEIV11,
  6761           DFHEIV99
  6762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6763     end-if
  6764*    if am-expiration-dt = high-values
  6765*       continue
  6766*    else
  6767*       move account-master      to ws-hold-eracct-record
  6768*       go to 1420-readnext-account-master
  6769*    end-if
  6770     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6771     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6772     MOVE AM-STATE               TO PI-CR-STATE.
  6773     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6774
  6775     MOVE AM-NAME                TO PI-AM-NAME.
  6776     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6777     MOVE AM-CITY                TO PI-AM-CITY-st
  6778     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6779     move am-csr-code            to pi-am-csr
  6780
  6781     MOVE +0                     TO WS-SUB.
  6782
  6783 1430-FIND-ACC-AGT.
  6784     ADD +1                      TO WS-SUB.
  6785
  6786     IF  WS-SUB GREATER +10
  6787         GO TO 1480-ACCOUNT-INVALID.
  6788
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 120
* EL677.cbl
  6789     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F')
  6790         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6791       ELSE
  6792         GO TO 1430-FIND-ACC-AGT.
  6793
  6794     MOVE AL-UANON               TO CARRIERA
  6795                                    GROUPA
  6796                                    STATEA.
  6797
  6798     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6799
  6800     GO TO 1490-EXIT.
  6801
  6802 1480-ACCOUNT-INVALID.
  6803     MOVE -1                     TO CARRIERL
  6804     MOVE AL-UANON               TO CARRIERA
  6805                                    GROUPA
  6806                                    STATEA
  6807                                    ACCTA.
  6808     MOVE ER-2210                TO EMI-ERROR.
  6809     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6810     GO TO 8200-SEND-DATAONLY.
  6811
  6812 1490-EXIT.
  6813      EXIT.
  6814
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 121
* EL677.cbl
  6816 1500-VERIFY-PENDING-BUS-REC.
  6817     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6818     if ws-corr-check
  6819        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW
  6820        go to 1590-exit
  6821     end-if
  6822
  6823* EXEC CICS HANDLE CONDITION
  6824*        NOTFND   (1590-EXIT)
  6825*    END-EXEC.
  6826*    MOVE '"$I                   ! '' #00006550' TO DFHEIV0
  6827     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6829     MOVE X'2720233030303036353530' TO DFHEIV0(25:11)
  6830     CALL 'kxdfhei1' USING DFHEIV0
  6831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6832
  6833
  6834
  6835     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6836     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6837     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6838     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6839     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6840     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6841     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6842     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6843     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6844     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6845
  6846     IF ST-ACCNT-CNTL  OR
  6847        ACCNT-CNTL
  6848          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6849
  6850     IF ST-ACCNT-CNTL      OR
  6851        CARR-ST-ACCNT-CNTL OR
  6852        ACCNT-CNTL         OR
  6853        CARR-ACCNT-CNTL
  6854          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6855
  6856     IF ACCNT-CNTL OR
  6857        CARR-ACCNT-CNTL
  6858          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6859
  6860
  6861* EXEC CICS READ
  6862*         DATASET   (ERPNDB-ALT-FILE-ID)
  6863*         SET       (ADDRESS OF PENDING-BUSINESS)
  6864*         RIDFLD    (ERPNDB-ALT-KEY)
  6865*     END-EXEC.
  6866*    MOVE '&"S        E          (   #00006580' TO DFHEIV0
  6867     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6869     MOVE X'2020233030303036353830' TO DFHEIV0(25:11)
  6870     CALL 'kxdfhei1' USING DFHEIV0,
  6871           ERPNDB-ALT-FILE-ID,
  6872           DFHEIV20,
  6873           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 122
* EL677.cbl
  6874           ERPNDB-ALT-KEY,
  6875           DFHEIV99,
  6876           DFHEIV99,
  6877           DFHEIV99
  6878     SET ADDRESS OF PENDING-BUSINESS TO
  6879         DFHEIV20
  6880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6881
  6882
  6883     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6884
  6885     IF PB-C-PAYEE-CODE GREATER SPACES
  6886        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6887
  6888     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6889*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6890
  6891     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6892     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6893
  6894     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6895         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6896     ELSE
  6897         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6898
  6899*    IF MAINTI = 'A' OR 'C'
  6900*      IF PB-C-REFUND-CREATED
  6901*          MOVE -1               TO  MAINTL
  6902*          MOVE ER-3445          TO  EMI-ERROR
  6903*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6904
  6905 1590-EXIT.
  6906      EXIT.
  6907
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 123
* EL677.cbl
  6909 2000-ADD-RECORD.
  6910
  6911* EXEC CICS GETMAIN
  6912*        SET      (ADDRESS OF CHECK-RECORDS)
  6913*        LENGTH   (600)
  6914*        INITIMG  (GETMAIN-SPACE)
  6915*    END-EXEC.
  6916     MOVE 600
  6917       TO DFHEIV11
  6918*    MOVE ',"IL                  $   #00006613' TO DFHEIV0
  6919     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6920     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6921     MOVE X'2020233030303036363133' TO DFHEIV0(25:11)
  6922     CALL 'kxdfhei1' USING DFHEIV0,
  6923           DFHEIV20,
  6924           DFHEIV11,
  6925           GETMAIN-SPACE
  6926     SET ADDRESS OF CHECK-RECORDS TO
  6927         DFHEIV20
  6928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6929
  6930
  6931     MOVE 'CH'                   TO CH-RECORD-ID.
  6932     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6933     MOVE CARRIERI               TO CH-CARRIER.
  6934     MOVE GROUPI                 TO CH-GROUPING.
  6935     MOVE STATEI                 TO CH-STATE.
  6936     MOVE ACCTI                  TO CH-ACCOUNT.
  6937
  6938     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6939     MOVE '2'                    TO DC-OPTION-CODE.
  6940     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6941     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6942
  6943     MOVE CERTNOI                TO CH-CERT-PRIME.
  6944     MOVE SFXI                   TO CH-CERT-SFX.
  6945
  6946     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6947
  6948     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6949                                    ch-released-by
  6950     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6951
  6952     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6953     MOVE '5'                    TO DC-OPTION-CODE.
  6954     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6955     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6956                                    ch-released-dt
  6957
  6958     move 'P'                    to ch-approval-status
  6959
  6960     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6961                                    CH-VOID-DT
  6962                                    CH-CREDIT-ACCEPT-DT
  6963                                    CH-CANC-DT
  6964                                    ch-approval-dt
  6965                                    ch-check-cashed-dt
  6966     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 124
* EL677.cbl
  6967                                    CH-AH-REFUND
  6968*                                   CH-DEDUCT-WITHHELD
  6969*                                   CH-ADDITIONAL-CHARGE.
  6970
  6971     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  6972
  6973     if pi-prev-paid not numeric
  6974        move zeros               to pi-prev-paid
  6975     end-if
  6976     if pi-prev-paid-this-month not numeric
  6977        move zeros               to pi-prev-paid-this-month
  6978     end-if
  6979     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6980       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6981        EIBAID NOT = DFHPF4)
  6982         GO TO 8200-SEND-DATAONLY.
  6983
  6984     add ch-amount-paid to pi-prev-paid
  6985     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  6986     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  6987     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  6988     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  6989     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  6990     move pi-am-csr              to ch-csr
  6991     .
  6992 2100-WRITE-RECORD.
  6993
  6994* exec cics read
  6995*       dataset    (erchek-file-id)
  6996*       into       (ws-dummy-erchek)
  6997*       ridfld     (ch-control-primary)
  6998*       resp       (ws-response)
  6999*    end-exec
  7000     MOVE LENGTH OF
  7001      ws-dummy-erchek
  7002       TO DFHEIV11
  7003*    MOVE '&"IL       E          (  N#00006681' TO DFHEIV0
  7004     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7005     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7006     MOVE X'204E233030303036363831' TO DFHEIV0(25:11)
  7007     CALL 'kxdfhei1' USING DFHEIV0,
  7008           erchek-file-id,
  7009           ws-dummy-erchek,
  7010           DFHEIV11,
  7011           ch-control-primary,
  7012           DFHEIV99,
  7013           DFHEIV99,
  7014           DFHEIV99
  7015     MOVE EIBRESP  TO ws-response
  7016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7017     if RESP-NOTFND
  7018        continue
  7019     else
  7020        add +1 to ch-sequence-no
  7021        add 1 to seqi
  7022        go to 2100-write-record
  7023     end-if
  7024     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 125
* EL677.cbl
  7025
  7026* EXEC CICS HANDLE CONDITION
  7027*        DUPREC (2200-DUPREC)
  7028*    END-EXEC.
  7029*    MOVE '"$%                   ! ( #00006695' TO DFHEIV0
  7030     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7031     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7032     MOVE X'2820233030303036363935' TO DFHEIV0(25:11)
  7033     CALL 'kxdfhei1' USING DFHEIV0
  7034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7035
  7036
  7037     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  7038     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  7039                                    CH-CHECK-QUE-SEQUENCE
  7040
  7041
  7042* EXEC CICS WRITE
  7043*        DATASET  (ERCHEK-FILE-ID)
  7044*        FROM     (CHECK-RECORDS)
  7045*        RIDFLD   (CH-CONTROL-PRIMARY)
  7046*        resp     (ws-response)
  7047*    END-EXEC.
  7048     MOVE LENGTH OF
  7049      CHECK-RECORDS
  7050       TO DFHEIV11
  7051*    MOVE '&$ L                  ''  N#00006703' TO DFHEIV0
  7052     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7053     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7054     MOVE X'204E233030303036373033' TO DFHEIV0(25:11)
  7055     CALL 'kxdfhei1' USING DFHEIV0,
  7056           ERCHEK-FILE-ID,
  7057           CHECK-RECORDS,
  7058           DFHEIV11,
  7059           CH-CONTROL-PRIMARY,
  7060           DFHEIV99,
  7061           DFHEIV99
  7062     MOVE EIBRESP  TO ws-response
  7063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7064
  7065     if resp-normal and pi-check-type = 'C'
  7066        move 'Y'                 to pi-check-cut
  7067     end-if
  7068     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  7069             ERCHEK-RECORD-LENGTH + 23.
  7070
  7071     if pi-check-type not = 'C'
  7072        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7073                                 THRU 6200-EXIT
  7074        if resp-normal
  7075           MOVE 'Y'              TO PB-C-REFUND-SW
  7076           add +1 to pi-chek-rec-cnt
  7077           perform 6210-rewrite-pndb
  7078                                 thru 6210-exit
  7079*          PERFORM 2700-WRITE-SQL THRU 2700-EXIT
  7080        end-if
  7081     end-if
  7082*    PERFORM 2500-WRITE-PAY-ADJ  THRU  2590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 126
* EL677.cbl
  7083
  7084     IF EMI-NO-ERRORS
  7085         MOVE ER-0000            TO EMI-ERROR
  7086     ELSE
  7087         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7088            EIBAID = DFHPF4
  7089             MOVE ER-2600        TO EMI-ERROR.
  7090
  7091     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7092
  7093     MOVE LOW-VALUES             TO EL677AI.
  7094
  7095     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7096     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7097     MOVE PI-CHEK-STATE          TO STATEO.
  7098     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7099
  7100     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7101     MOVE SPACE                  TO DC-OPTION-CODE.
  7102     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7103     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7104
  7105     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7106     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7107     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7108
  7109     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7110                                    ACCTA     EFFDTA  CERTNOA
  7111                                    SFXA.
  7112     MOVE AL-UNNON               TO SEQA.
  7113     go to 5000-browse-file
  7114     GO TO 8100-SEND-INITIAL-MAP.
  7115
  7116 2200-DUPREC.
  7117     ADD +1 TO CH-SEQUENCE-NO.
  7118     MOVE CH-SEQUENCE-NO         TO SEQO
  7119                                    PI-CHEK-SEQUENCE
  7120                                    CHEK-RECORD-SEQ.
  7121     GO TO 2100-WRITE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 127
* EL677.cbl
  7123
  7124 2500-WRITE-PAY-ADJ.
  7125
  7126     PERFORM 2600-READ-CONTROL-FILE THRU 2600-EXIT.
  7127
  7128     IF CH-AMOUNT-PAID = ZEROS
  7129         GO TO 2510-CONTINUE.
  7130     PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT.
  7131     PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.
  7132
  7133 2510-CONTINUE.
  7134
  7135     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  7136         GO TO 2580-HANDLE-ELCNTL-FILE.
  7137
  7138 2550-BUILD-ERPYAJ-RECORD.
  7139
  7140
  7141* EXEC CICS GETMAIN
  7142*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7143*        LENGTH  (200)
  7144*        INITIMG (GETMAIN-SPACE)
  7145*    END-EXEC.
  7146     MOVE 200
  7147       TO DFHEIV11
  7148*    MOVE ',"IL                  $   #00006784' TO DFHEIV0
  7149     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7150     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7151     MOVE X'2020233030303036373834' TO DFHEIV0(25:11)
  7152     CALL 'kxdfhei1' USING DFHEIV0,
  7153           DFHEIV20,
  7154           DFHEIV11,
  7155           GETMAIN-SPACE
  7156     SET ADDRESS OF PENDING-PAY-ADJ TO
  7157         DFHEIV20
  7158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7159
  7160
  7161     MOVE SPACES                 TO PENDING-PAY-ADJ.
  7162     MOVE 'PY'                   TO PY-RECORD-ID.
  7163     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7164
  7165     MOVE CARRIERI               TO PY-CARRIER.
  7166     IF PI-ZERO-CARRIER  OR
  7167        PI-ZERO-CAR-GROUP
  7168         MOVE ZERO               TO PY-CARRIER.
  7169
  7170     MOVE GROUPI                 TO PY-GROUPING.
  7171     IF PI-ZERO-GROUPING  OR
  7172        PI-ZERO-CAR-GROUP
  7173         MOVE ZERO               TO PY-GROUPING.
  7174
  7175     MOVE PI-CR-FIN-RESP         TO PY-FIN-RESP.
  7176     MOVE PI-CR-ACCOUNT          TO PY-ACCOUNT.
  7177     MOVE 'C'                    TO PY-RECORD-TYPE.
  7178     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7179
  7180     MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-CURRENT-DATE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 128
* EL677.cbl
  7181                                    WS-PY-REF-DATE
  7182                                    WS-PY-END-DATE
  7183                                    WS-PY-DED-DATE
  7184                                    WS-PY-ADDL-DATE.
  7185     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7186     MOVE CERTNOI                TO WS-PY-CURRENT-CERT
  7187                                    WS-PY-REF-CERT
  7188                                    WS-PY-END-CERT
  7189                                    WS-PY-DED-CERT
  7190                                    WS-PY-ADDL-CERT
  7191                                    WS-TMS-PY-CERT.
  7192     IF SFXI NOT = LOW-VALUES
  7193         MOVE SFXI               TO WS-PY-CURRENT-SUFFIX
  7194                                    WS-PY-REF-SUFFIX
  7195                                    WS-PY-END-SUFFIX
  7196                                    WS-PY-DED-SUFFIX
  7197                                    WS-PY-ADDL-SUFFIX
  7198     ELSE
  7199         MOVE SPACE              TO WS-PY-CURRENT-SUFFIX
  7200                                    WS-PY-REF-SUFFIX
  7201                                    WS-PY-END-SUFFIX
  7202                                    WS-PY-DED-SUFFIX
  7203                                    WS-PY-ADDL-SUFFIX.
  7204
  7205     IF PI-COMPANY-ID EQUAL 'TMS' OR 'LGX'
  7206         MOVE WS-TMS-ENTRY-COMMENT
  7207                                 TO PY-ENTRY-COMMENT
  7208     ELSE
  7209         IF TYPEI EQUAL 'R'
  7210             MOVE WS-PY-REF-COMMENT
  7211                                 TO PY-ENTRY-COMMENT
  7212         ELSE
  7213             IF TYPEI EQUAL 'E'
  7214                 MOVE WS-PY-END-COMMENT
  7215                                 TO PY-ENTRY-COMMENT
  7216             ELSE
  7217                 MOVE WS-PY-ENTRY-COMMENT
  7218                                 TO PY-ENTRY-COMMENT.
  7219
  7220     MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT.
  7221
  7222     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7223     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7224     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7225                                    PY-INPUT-DT.
  7226*    MOVE +0                     TO PY-CHECK-QUE-CONTROL
  7227*                                   PY-CHECK-QUE-SEQUENCE.
  7228     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7229                                    PY-REPORTED-DT
  7230                                    PY-CHECK-WRITTEN-DT
  7231                                    PY-BILLED-DATE
  7232                                    PY-AR-DATE
  7233                                    PY-GL-DATE.
  7234     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7235     MOVE TYPEI                  TO PY-CHECK-ORIGIN-SW.
  7236*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7237
  7238     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 129
* EL677.cbl
  7239         MOVE 'B'                TO PY-PYMT-TYPE
  7240         MOVE 'A'                TO PY-PMT-APPLIED.
  7241
  7242 2559-BUILD-EXIT.
  7243     EXIT.
  7244
  7245 2570-WRITE-ERPYAJ-RECORD.
  7246
  7247
  7248* EXEC CICS HANDLE CONDITION
  7249*        DUPREC (2577-DUPREC)
  7250*    END-EXEC.
  7251*    MOVE '"$%                   ! ) #00006876' TO DFHEIV0
  7252     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7254     MOVE X'2920233030303036383736' TO DFHEIV0(25:11)
  7255     CALL 'kxdfhei1' USING DFHEIV0
  7256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7257
  7258
  7259
  7260* EXEC CICS WRITE
  7261*        DATASET (ERPYAJ-FILE-ID)
  7262*        FROM    (PENDING-PAY-ADJ)
  7263*        RIDFLD  (PY-CONTROL-PRIMARY)
  7264*    END-EXEC.
  7265     MOVE LENGTH OF
  7266      PENDING-PAY-ADJ
  7267       TO DFHEIV11
  7268*    MOVE '&$ L                  ''   #00006880' TO DFHEIV0
  7269     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7270     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7271     MOVE X'2020233030303036383830' TO DFHEIV0(25:11)
  7272     CALL 'kxdfhei1' USING DFHEIV0,
  7273           ERPYAJ-FILE-ID,
  7274           PENDING-PAY-ADJ,
  7275           DFHEIV11,
  7276           PY-CONTROL-PRIMARY,
  7277           DFHEIV99,
  7278           DFHEIV99
  7279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7280
  7281
  7282     GO TO 2579-WRITE-EXIT.
  7283
  7284 2577-DUPREC.
  7285     ADD +1 TO PY-FILE-SEQ-NO.
  7286
  7287     GO TO 2570-WRITE-ERPYAJ-RECORD.
  7288
  7289 2579-WRITE-EXIT.
  7290     EXIT.
  7291
  7292 2580-HANDLE-ELCNTL-FILE.
  7293
  7294     IF CR-CHECK-NO-AUTO-SEQ
  7295         PERFORM 2650-REWRITE-CONTROL-FILE THRU 2650-EXIT
  7296     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 130
* EL677.cbl
  7297
  7298* EXEC CICS UNLOCK
  7299*            DATASET (ELCNTL-FILE-ID)
  7300*        END-EXEC.
  7301*    MOVE '&*                    #   #00006901' TO DFHEIV0
  7302     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7303     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7304     MOVE X'2020233030303036393031' TO DFHEIV0(25:11)
  7305     CALL 'kxdfhei1' USING DFHEIV0,
  7306           ELCNTL-FILE-ID,
  7307           DFHEIV99
  7308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7309
  7310
  7311 2590-EXIT.
  7312      EXIT.
  7313
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 131
* EL677.cbl
  7315
  7316 2600-READ-CONTROL-FILE.
  7317     MOVE SPACES                 TO ELCNTL-KEY.
  7318     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  7319     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7320     MOVE +0                     TO ELCNTL-SEQ.
  7321
  7322
  7323* EXEC CICS HANDLE CONDITION
  7324*        NOTFND   (2600-NO-CO-MASTER)
  7325*    END-EXEC.
  7326*    MOVE '"$I                   ! * #00006916' TO DFHEIV0
  7327     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7329     MOVE X'2A20233030303036393136' TO DFHEIV0(25:11)
  7330     CALL 'kxdfhei1' USING DFHEIV0
  7331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7332
  7333
  7334
  7335* EXEC CICS READ
  7336*        DATASET   (ELCNTL-FILE-ID)
  7337*        SET       (ADDRESS OF CONTROL-FILE)
  7338*        RIDFLD    (ELCNTL-KEY)
  7339*    END-EXEC.
  7340*    MOVE '&"S        E          (   #00006920' TO DFHEIV0
  7341     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7343     MOVE X'2020233030303036393230' TO DFHEIV0(25:11)
  7344     CALL 'kxdfhei1' USING DFHEIV0,
  7345           ELCNTL-FILE-ID,
  7346           DFHEIV20,
  7347           DFHEIV99,
  7348           ELCNTL-KEY,
  7349           DFHEIV99,
  7350           DFHEIV99,
  7351           DFHEIV99
  7352     SET ADDRESS OF CONTROL-FILE TO
  7353         DFHEIV20
  7354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7355
  7356
  7357     GO TO 2600-EXIT
  7358
  7359     .
  7360 2600-NO-CO-MASTER.
  7361     MOVE ER-0022                TO  EMI-ERROR.
  7362     MOVE -1                     TO  CARRIERL.
  7363     MOVE AL-UABON               TO  CARRIERA.
  7364     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7365
  7366 2600-EXIT.
  7367      EXIT.
  7368
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 132
* EL677.cbl
  7370 2650-REWRITE-CONTROL-FILE.
  7371
  7372* EXEC CICS READ
  7373*        DATASET   (ELCNTL-FILE-ID)
  7374*        SET       (ADDRESS OF CONTROL-FILE)
  7375*        RIDFLD    (ELCNTL-KEY)
  7376*        UPDATE
  7377*    END-EXEC.
  7378*    MOVE '&"S        EU         (   #00006940' TO DFHEIV0
  7379     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7380     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7381     MOVE X'2020233030303036393430' TO DFHEIV0(25:11)
  7382     CALL 'kxdfhei1' USING DFHEIV0,
  7383           ELCNTL-FILE-ID,
  7384           DFHEIV20,
  7385           DFHEIV99,
  7386           ELCNTL-KEY,
  7387           DFHEIV99,
  7388           DFHEIV99,
  7389           DFHEIV99
  7390     SET ADDRESS OF CONTROL-FILE TO
  7391         DFHEIV20
  7392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7393
  7394
  7395
  7396* EXEC CICS REWRITE
  7397*         DATASET (ELCNTL-FILE-ID)
  7398*         FROM    (CONTROL-FILE)
  7399*     END-EXEC.
  7400     MOVE LENGTH OF
  7401      CONTROL-FILE
  7402       TO DFHEIV11
  7403*    MOVE '&& L                  %   #00006947' TO DFHEIV0
  7404     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7405     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7406     MOVE X'2020233030303036393437' TO DFHEIV0(25:11)
  7407     CALL 'kxdfhei1' USING DFHEIV0,
  7408           ELCNTL-FILE-ID,
  7409           CONTROL-FILE,
  7410           DFHEIV11,
  7411           DFHEIV99
  7412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7413
  7414
  7415 2650-EXIT.
  7416      EXIT.
  7417 2700-WRITE-SQL.
  7418     perform 2710-build-rec      thru 2710-exit
  7419     perform 2720-insert-row     thru 2720-exit
  7420     perform 4300-FINISH-UP-DB   thru 4300-exit
  7421     .
  7422 2700-EXIT.
  7423     EXIT.
  7424 2710-BUILD-REC.
  7425     move spaces                 to daily-check-request-rec
  7426     move pi-company-id          to db-compid
  7427     move ch-carrier             to db-carrier
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 133
* EL677.cbl
  7428                                    db-fincar
  7429     move ch-grouping            to db-grouping
  7430                                    db-fingrp
  7431     move ch-state               to db-state
  7432     move ch-account             to db-account
  7433     move ch-cert-eff-dt         to dc-bin-date-1
  7434     move ' '                    to dc-option-code
  7435     perform 8500-date-convert   thru 8500-exit
  7436     if no-conversion-error
  7437        move dc-greg-date-a-edit to db-effdate
  7438     else
  7439        move spaces              to db-effdate
  7440     end-if
  7441     move ch-cert-prime          to db-certificate
  7442     move ch-cert-sfx            to db-cert-sfx
  7443     move ch-sequence-no         to db-seq-no
  7444     move '1'                    to db-type
  7445                                    db-check-sub-type
  7446     if pi-check-type = 'C'
  7447        move '2'                 to db-check-sub-type
  7448     end-if
  7449     move ch-amount-paid         to db-amount-n
  7450     move zeros                  to db-checkstatus
  7451     move ch-check-que-control   to db-releasebatch
  7452     move save-bin-date          to dc-bin-date-1
  7453     move ' '                    to dc-option-code
  7454     perform 8500-date-convert   thru 8500-exit
  7455     if no-conversion-error
  7456        move dc-greg-date-a-edit to db-releasedt
  7457     else
  7458        move spaces              to db-releasedt
  7459     end-if
  7460     move pi-processor-id        to db-releaseby
  7461     move ch-payee-name-1        to db-payeename1
  7462     move ch-payee-name-2        to db-payeename2
  7463     move ch-payee-address-1     to db-payeeaddr1
  7464     move ch-payee-address-2     to db-payeeaddr2
  7465     move ch-payee-city          to db-payeecity
  7466     move ch-payee-state         to db-payeest
  7467     move ch-payee-zip-code      to db-payeezip
  7468     move ch-comp-fin-resp       to db-finresp
  7469     move ch-comp-account        to db-finacct
  7470     move ch-recorded-by         to db-preparer
  7471     move ch-return-to           to db-return-to
  7472     move pi-table-name          to db-insured-name
  7473     .
  7474 2710-EXIT.
  7475     EXIT.
  7476 2720-INSERT-ROW.
  7477     if not connected-to-db
  7478        perform 4100-CONNECT-TO-DB
  7479                                 thru 4100-exit
  7480     end-if
  7481     EXEC SQL
  7482        INSERT into ChkApp_Check (
  7483           Company,
  7484           CertCarrier,
  7485           CertGroup,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 134
* EL677.cbl
  7486           CertState,
  7487           CertAccount,
  7488           CertEffDate,
  7489           CertNumber,
  7490           CertNumberSuf,
  7491           CheckSeqNbr,
  7492           CheckType,
  7493           CheckAmount,
  7494           ReleaseBatchNbr,
  7495           ReleaseDate,
  7496           ReleasedBy,
  7497           PayeeName1,
  7498           PayeeName2,
  7499           PayeeAddress1,
  7500           PayeeAddress2,
  7501           PayeeCity,
  7502           PayeeState,
  7503           PayeeZip,
  7504           CompCarrier,
  7505           CompGroup,
  7506           CompFinResp,
  7507           CompAccount,
  7508           Preparer,
  7509           ReturnTo,
  7510           InsuredName,
  7511           CheckSubType)
  7512         VALUES (
  7513           :DB-CompId,
  7514           :DB-Carrier,
  7515           :DB-Grouping,
  7516           :DB-State,
  7517           :DB-Account,
  7518           :DB-EffDate,
  7519           :DB-Certificate,
  7520           :db-cert-sfx,
  7521           :DB-Seq-No,
  7522           :DB-Type,
  7523           :db-amount,
  7524           :db-releasebatch,
  7525           :db-releasedt,
  7526           :db-releaseby,
  7527           :db-payeename1,
  7528           :db-payeename2,
  7529           :db-payeeaddr1,
  7530           :db-payeeaddr2,
  7531           :db-payeecity,
  7532           :db-payeest,
  7533           :db-payeezip,
  7534           :db-fincar,
  7535           :db-fingrp,
  7536           :db-finresp,
  7537           :db-finacct,
  7538           :db-preparer,
  7539           :db-return-to,
  7540           :db-insured-name,
  7541           :db-check-sub-type)
  7542     END-EXEC
  7543     if sqlcode = -2601
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 135
* EL677.cbl
  7544        add +1                   to ch-sequence-no
  7545        move ch-sequence-no      to DB-Seq-No
  7546        go to 2720-insert-row
  7547     end-if
  7548     if sqlcode not = 0
  7549        display "Error: cannot insert row "
  7550        display ' sql return code ' sqlcode
  7551        move sqlcode to ws-sql-code
  7552        move ws-sql-code to ws-dis-sql-code
  7553        display ' dis sql code ' ws-dis-sql-code
  7554        display ' sql err mess    ' sqlerrmc
  7555        move sqlcode to ws-sql-code
  7556        move ws-sql-code to ws-dis-sql-code
  7557        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7558           into EMI-MESSAGE-AREA (1)
  7559        end-string
  7560        display ' msga1 ' emi-message-area (1)
  7561        perform 4300-FINISH-UP-DB thru 4300-exit
  7562        go to 8200-send-dataonly
  7563*       goback
  7564     end-if
  7565     .
  7566 2720-EXIT.
  7567     EXIT.
  7568 3000-CHANGE-RECORD.
  7569
  7570* EXEC CICS HANDLE CONDITION
  7571*        NOTFND (3900-RECORD-NOTFND)
  7572*    END-EXEC.
  7573*    MOVE '"$I                   ! + #00007106' TO DFHEIV0
  7574     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7576     MOVE X'2B20233030303037313036' TO DFHEIV0(25:11)
  7577     CALL 'kxdfhei1' USING DFHEIV0
  7578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7579
  7580
  7581
  7582* EXEC CICS READ
  7583*        DATASET  (ERCHEK-FILE-ID)
  7584*        SET      (ADDRESS OF CHECK-RECORDS)
  7585*        RIDFLD   (PI-ERCHEK-KEY)
  7586*        UPDATE
  7587*    END-EXEC.
  7588*    MOVE '&"S        EU         (   #00007110' TO DFHEIV0
  7589     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7590     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7591     MOVE X'2020233030303037313130' TO DFHEIV0(25:11)
  7592     CALL 'kxdfhei1' USING DFHEIV0,
  7593           ERCHEK-FILE-ID,
  7594           DFHEIV20,
  7595           DFHEIV99,
  7596           PI-ERCHEK-KEY,
  7597           DFHEIV99,
  7598           DFHEIV99,
  7599           DFHEIV99
  7600     SET ADDRESS OF CHECK-RECORDS TO
  7601         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 136
* EL677.cbl
  7602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7603
  7604
  7605     IF CH-LF-REFUND NOT NUMERIC
  7606         MOVE ZEROS              TO CH-LF-REFUND.
  7607     IF CH-AH-REFUND NOT NUMERIC
  7608         MOVE ZEROS              TO CH-AH-REFUND.
  7609*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7610*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7611*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7612*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7613
  7614     IF VREASONL NOT = ZEROS
  7615         MOVE VREASONI           TO  CH-VOID-REASON.
  7616
  7617     IF MAINTI = 'V'
  7618        GO TO 3050-void-processing
  7619     end-if
  7620
  7621     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7622
  7623     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7624
  7625     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7626       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7627        EIBAID NOT = DFHPF4)
  7628         GO TO 8200-SEND-DATAONLY.
  7629     go to 3100-rewrite-record
  7630     .
  7631 3050-void-processing.
  7632     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7633     if sqlcode = 0
  7634        perform 4200-get-tbl-row thru 4200-exit
  7635        if sqlcode = 0
  7636           if nu-app-date = -1
  7637              move -1            to maintl
  7638              move er-3453       to emi-error
  7639              move al-uabon      to mainta
  7640              perform 9900-error-format
  7641                                 thru 9900-exit
  7642              perform 4300-FINISH-UP-DB thru 4300-exit
  7643              go to 8200-send-dataonly
  7644           end-if
  7645        end-if
  7646        if connected-to-db
  7647           perform 4300-FINISH-UP-DB thru 4300-exit
  7648        end-if
  7649     end-if
  7650     if (ch-check-written-dt = low-values)
  7651        or (ch-check-no = spaces)
  7652        move -1                  to maintl
  7653        move er-3455             to emi-error
  7654        move al-uabon            to mainta
  7655        perform 9900-error-format
  7656                                 thru 9900-exit
  7657        perform 4300-FINISH-UP-DB thru 4300-exit
  7658        go to 8200-send-dataonly
  7659     end-if
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 137
* EL677.cbl
  7660     .
  7661 3100-REWRITE-RECORD.
  7662     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7663
  7664     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7665     MOVE '5'                    TO DC-OPTION-CODE.
  7666     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7667
  7668     IF MAINTI = 'C'
  7669       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7670     end-if
  7671*      IF MANUAL-CHECK-WRITTEN
  7672*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT.
  7673
  7674     IF MAINTI = 'V'
  7675        IF (CH-VOID-DT = LOW-VALUES)
  7676           and (pi-check-cashed = spaces)
  7677           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7678           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7679*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT
  7680           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7681           if pi-chek-rec-cnt = +1
  7682              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7683                                 THRU 6200-EXIT
  7684              if resp-normal
  7685                 MOVE ' '        TO PB-C-REFUND-SW
  7686                 perform 6210-rewrite-pndb
  7687                                 thru 6210-exit
  7688              end-if
  7689           end-if
  7690        ELSE
  7691           MOVE -1               TO MAINTL
  7692           MOVE ER-2583          TO EMI-ERROR
  7693           MOVE AL-UABON         TO MAINTA
  7694           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7695           GO TO 8200-SEND-DATAONLY
  7696        end-if
  7697     end-if
  7698
  7699     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7700
  7701
  7702* EXEC CICS REWRITE
  7703*        DATASET  (ERCHEK-FILE-ID)
  7704*        FROM     (CHECK-RECORDS)
  7705*    END-EXEC.
  7706     MOVE LENGTH OF
  7707      CHECK-RECORDS
  7708       TO DFHEIV11
  7709*    MOVE '&& L                  %   #00007213' TO DFHEIV0
  7710     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7711     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7712     MOVE X'2020233030303037323133' TO DFHEIV0(25:11)
  7713     CALL 'kxdfhei1' USING DFHEIV0,
  7714           ERCHEK-FILE-ID,
  7715           CHECK-RECORDS,
  7716           DFHEIV11,
  7717           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 138
* EL677.cbl
  7718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7719
  7720
  7721     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7722        (MAINTI EQUAL 'C')          AND
  7723        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7724            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7725
  7726     IF EMI-NO-ERRORS
  7727         MOVE ER-0000            TO EMI-ERROR
  7728     ELSE
  7729         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7730            EIBAID = DFHPF4
  7731             MOVE ER-2600        TO EMI-ERROR.
  7732
  7733     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7734
  7735     MOVE LOW-VALUES             TO EL677AI.
  7736
  7737     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7738     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7739     MOVE PI-CHEK-STATE          TO STATEO.
  7740     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7741
  7742     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7743     MOVE SPACE                  TO DC-OPTION-CODE.
  7744     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7745     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7746
  7747     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7748     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7749     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7750
  7751     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7752                                     ACCTA   EFFDTA
  7753                                    CERTNOA   SFXA.
  7754
  7755     MOVE AL-UNNON               TO SEQA.
  7756     go to 5000-browse-file
  7757*    GO TO 8100-SEND-INITIAL-MAP.
  7758
  7759     .
  7760 3200-PAY-ADJS-REVERSAL.
  7761
  7762     IF CH-AMOUNT-PAID NOT = ZEROS
  7763         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7764         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7765
  7766     GO TO 3290-EXIT
  7767     .
  7768 3250-BUILD-ERPYAJ-REVERSAL.
  7769
  7770
  7771* EXEC CICS GETMAIN
  7772*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7773*        LENGTH  (200)
  7774*        INITIMG (GETMAIN-SPACE)
  7775*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 139
* EL677.cbl
  7776     MOVE 200
  7777       TO DFHEIV11
  7778*    MOVE ',"IL                  $   #00007267' TO DFHEIV0
  7779     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7780     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7781     MOVE X'2020233030303037323637' TO DFHEIV0(25:11)
  7782     CALL 'kxdfhei1' USING DFHEIV0,
  7783           DFHEIV20,
  7784           DFHEIV11,
  7785           GETMAIN-SPACE
  7786     SET ADDRESS OF PENDING-PAY-ADJ TO
  7787         DFHEIV20
  7788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7789
  7790
  7791     MOVE 'PY'                   TO PY-RECORD-ID.
  7792     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7793
  7794     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7795     IF PI-ZERO-CARRIER  OR
  7796        PI-ZERO-CAR-GROUP
  7797         MOVE ZERO               TO PY-CARRIER.
  7798
  7799     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7800     IF PI-ZERO-GROUPING  OR
  7801        PI-ZERO-CAR-GROUP
  7802         MOVE ZERO               TO PY-GROUPING.
  7803
  7804     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7805     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7806     MOVE 'R'                    TO PY-RECORD-TYPE.
  7807     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7808     move '1825011300'           to py-gl-account
  7809     move 'VOID REFCK'           TO py-gl-comment
  7810     move ch-amount-paid         to py-entry-amt
  7811*    COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7812
  7813     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7814     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7815
  7816     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7817     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7818     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7819                                    PY-INPUT-DT.
  7820*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7821*                                   PY-CHECK-QUE-SEQUENCE.
  7822     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7823                                    PY-BILLED-DATE
  7824                                    PY-REPORTED-DT
  7825                                    PY-CHECK-WRITTEN-DT
  7826                                    PY-AR-DATE
  7827                                    PY-GL-DATE.
  7828     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7829     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7830*    MOVE 'V'                    TO PY-VOID-SW.
  7831*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7832
  7833     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 140
* EL677.cbl
  7834         MOVE 'B'                TO PY-PYMT-TYPE
  7835         MOVE 'A'                TO PY-PMT-APPLIED.
  7836
  7837 3259-BUILD-EXIT.
  7838     EXIT.
  7839
  7840 3280-WRITE-ERPYAJ-REVERSAL.
  7841
  7842
  7843* EXEC CICS HANDLE CONDITION
  7844*        DUPREC (3287-DUPREC)
  7845*    END-EXEC.
  7846*    MOVE '"$%                   ! , #00007324' TO DFHEIV0
  7847     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7848     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7849     MOVE X'2C20233030303037333234' TO DFHEIV0(25:11)
  7850     CALL 'kxdfhei1' USING DFHEIV0
  7851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7852
  7853
  7854
  7855* EXEC CICS WRITE
  7856*        DATASET (ERPYAJ-FILE-ID)
  7857*        FROM    (PENDING-PAY-ADJ)
  7858*        RIDFLD  (PY-CONTROL-PRIMARY)
  7859*    END-EXEC.
  7860     MOVE LENGTH OF
  7861      PENDING-PAY-ADJ
  7862       TO DFHEIV11
  7863*    MOVE '&$ L                  ''   #00007328' TO DFHEIV0
  7864     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7865     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7866     MOVE X'2020233030303037333238' TO DFHEIV0(25:11)
  7867     CALL 'kxdfhei1' USING DFHEIV0,
  7868           ERPYAJ-FILE-ID,
  7869           PENDING-PAY-ADJ,
  7870           DFHEIV11,
  7871           PY-CONTROL-PRIMARY,
  7872           DFHEIV99,
  7873           DFHEIV99
  7874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7875
  7876
  7877     GO TO 3289-WRITE-EXIT.
  7878
  7879 3287-DUPREC.
  7880     ADD +1 TO PY-FILE-SEQ-NO.
  7881
  7882     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7883
  7884 3289-WRITE-EXIT.
  7885     EXIT.
  7886
  7887 3290-EXIT.
  7888      EXIT.
  7889
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 141
* EL677.cbl
  7891 3300-UPDATE-ERPYAJ.
  7892
  7893
  7894* EXEC CICS GETMAIN
  7895*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7896*        LENGTH  (200)
  7897*        INITIMG (GETMAIN-SPACE)
  7898*    END-EXEC.
  7899     MOVE 200
  7900       TO DFHEIV11
  7901*    MOVE ',"IL                  $   #00007350' TO DFHEIV0
  7902     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7903     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7904     MOVE X'2020233030303037333530' TO DFHEIV0(25:11)
  7905     CALL 'kxdfhei1' USING DFHEIV0,
  7906           DFHEIV20,
  7907           DFHEIV11,
  7908           GETMAIN-SPACE
  7909     SET ADDRESS OF PENDING-PAY-ADJ TO
  7910         DFHEIV20
  7911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7912
  7913
  7914     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7915     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7916     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7917     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7918     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7919     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7920     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7921
  7922
  7923* EXEC CICS HANDLE CONDITION
  7924*        NOTFND   (3390-EXIT)
  7925*        ENDFILE  (3390-EXIT)
  7926*    END-EXEC.
  7927*    MOVE '"$I''                  ! - #00007364' TO DFHEIV0
  7928     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7930     MOVE X'2D20233030303037333634' TO DFHEIV0(25:11)
  7931     CALL 'kxdfhei1' USING DFHEIV0
  7932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7933
  7934
  7935 3320-READNEXT-ERPYAJ.
  7936
  7937
  7938* EXEC CICS READ
  7939*        DATASET  (ERPYAJ-FILE-ID)
  7940*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7941*        RIDFLD   (ERPYAJ-KEY)
  7942*        GTEQ
  7943*    END-EXEC.
  7944*    MOVE '&"S        G          (   #00007371' TO DFHEIV0
  7945     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7946     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7947     MOVE X'2020233030303037333731' TO DFHEIV0(25:11)
  7948     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 142
* EL677.cbl
  7949           ERPYAJ-FILE-ID,
  7950           DFHEIV20,
  7951           DFHEIV99,
  7952           ERPYAJ-KEY,
  7953           DFHEIV99,
  7954           DFHEIV99,
  7955           DFHEIV99
  7956     SET ADDRESS OF PENDING-PAY-ADJ TO
  7957         DFHEIV20
  7958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7959
  7960
  7961     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7962
  7963     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7964        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7965        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7966        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7967        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7968        (PY-RECORD-TYPE   NOT = 'C')
  7969          GO TO 3390-EXIT.
  7970
  7971     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7972         ADD +1 TO PYAJ-FILE-SEQ-NO
  7973         GO TO 3320-READNEXT-ERPYAJ.
  7974
  7975
  7976* EXEC CICS READ UPDATE
  7977*        DATASET   (ERPYAJ-FILE-ID)
  7978*        RIDFLD    (ERPYAJ-KEY)
  7979*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7980*    END-EXEC.
  7981*    MOVE '&"S        EU         (   #00007392' TO DFHEIV0
  7982     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7983     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7984     MOVE X'2020233030303037333932' TO DFHEIV0(25:11)
  7985     CALL 'kxdfhei1' USING DFHEIV0,
  7986           ERPYAJ-FILE-ID,
  7987           DFHEIV20,
  7988           DFHEIV99,
  7989           ERPYAJ-KEY,
  7990           DFHEIV99,
  7991           DFHEIV99,
  7992           DFHEIV99
  7993     SET ADDRESS OF PENDING-PAY-ADJ TO
  7994         DFHEIV20
  7995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7996
  7997
  7998     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7999     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  8000
  8001     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  8002
  8003     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  8004     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  8005     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  8006
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 143
* EL677.cbl
  8007
  8008* EXEC CICS REWRITE
  8009*        DATASET  (ERPYAJ-FILE-ID)
  8010*        FROM     (PENDING-PAY-ADJ)
  8011*    END-EXEC.
  8012     MOVE LENGTH OF
  8013      PENDING-PAY-ADJ
  8014       TO DFHEIV11
  8015*    MOVE '&& L                  %   #00007407' TO DFHEIV0
  8016     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8017     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8018     MOVE X'2020233030303037343037' TO DFHEIV0(25:11)
  8019     CALL 'kxdfhei1' USING DFHEIV0,
  8020           ERPYAJ-FILE-ID,
  8021           PENDING-PAY-ADJ,
  8022           DFHEIV11,
  8023           DFHEIV99
  8024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8025
  8026
  8027 3390-EXIT.
  8028      EXIT.
  8029
  8030 3400-delete-record.
  8031
  8032* EXEC CICS READ
  8033*        DATASET  (ERCHEK-FILE-ID)
  8034*        SET      (ADDRESS OF CHECK-RECORDS)
  8035*        RIDFLD   (PI-ERCHEK-KEY)
  8036*        UPDATE
  8037*        resp     (ws-response)
  8038*    END-EXEC
  8039*    MOVE '&"S        EU         (  N#00007416' TO DFHEIV0
  8040     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8041     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8042     MOVE X'204E233030303037343136' TO DFHEIV0(25:11)
  8043     CALL 'kxdfhei1' USING DFHEIV0,
  8044           ERCHEK-FILE-ID,
  8045           DFHEIV20,
  8046           DFHEIV99,
  8047           PI-ERCHEK-KEY,
  8048           DFHEIV99,
  8049           DFHEIV99,
  8050           DFHEIV99
  8051     SET ADDRESS OF CHECK-RECORDS TO
  8052         DFHEIV20
  8053     MOVE EIBRESP  TO ws-response
  8054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8055     if (ch-in-limbo or ch-approv-pending)
  8056        and (ch-void-dt = low-values)
  8057        and (ch-check-written-dt = low-values)
  8058        and (ch-credit-accept-dt = low-values)
  8059        perform 3500-check-tbl   thru 3500-exit
  8060        if (row-deleted and tbl-commited)
  8061*          or (emi-error = er-3450)
  8062
  8063* exec cics delete
  8064*             dataset   (erchek-file-id)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 144
* EL677.cbl
  8065*          end-exec
  8066*    MOVE '&(                    &   #00007430' TO DFHEIV0
  8067     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8068     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8069     MOVE X'2020233030303037343330' TO DFHEIV0(25:11)
  8070     CALL 'kxdfhei1' USING DFHEIV0,
  8071           erchek-file-id,
  8072           DFHEIV99,
  8073           DFHEIV99,
  8074           DFHEIV99,
  8075           DFHEIV99
  8076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8077        end-if
  8078     else
  8079        move -1               to maintl
  8080        move er-3452          to emi-error
  8081        move al-uabon         to mainta
  8082        perform 9900-error-format
  8083                                 thru 9900-exit
  8084        go to 8200-send-dataonly
  8085     end-if
  8086     if pi-chek-rec-cnt = +1
  8087        PERFORM 6200-UPDATE-PENDING-BUS-REC
  8088                                 THRU 6200-EXIT
  8089        if resp-normal
  8090           MOVE ' '              TO PB-C-REFUND-SW
  8091           perform 6210-rewrite-pndb
  8092                                 thru 6210-exit
  8093        end-if
  8094     end-if
  8095     MOVE ER-0000            TO EMI-ERROR
  8096     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8097     MOVE LOW-VALUES             TO EL677AI.
  8098     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  8099     MOVE PI-CHEK-GROUPING       TO GROUPO.
  8100     MOVE PI-CHEK-STATE          TO STATEO.
  8101     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  8102     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  8103     MOVE SPACE                  TO DC-OPTION-CODE.
  8104     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8105     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  8106     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  8107     MOVE PI-CHEK-SUF-NO         TO SFXO.
  8108     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  8109     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8110                                    ACCTA   EFFDTA
  8111                                    CERTNOA   SFXA.
  8112     MOVE AL-UNNON               TO SEQA.
  8113     GO TO 8100-SEND-INITIAL-MAP
  8114     .
  8115 3400-exit.
  8116     exit.
  8117 3500-check-tbl.
  8118     perform 4100-CONNECT-TO-DB  thru 4100-exit
  8119*    if sqlcode = 0
  8120*       perform 4150-open-cursor    thru 4150-exit
  8121*    end-if
  8122     if sqlcode = 0
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 145
* EL677.cbl
  8123        perform 4200-get-tbl-row thru 4200-exit
  8124     end-if
  8125      if sqlcode = 0
  8126         if (nu-app-date = -1)
  8127            or (db-app-status = '2')
  8128            perform 4250-delete-row thru 4250-exit
  8129         else
  8130           MOVE ER-3452            TO  EMI-ERROR
  8131           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8132           MOVE -1                 TO  PFENTERL
  8133           GO TO 8200-SEND-DATAONLY
  8134        end-if
  8135      else
  8136         MOVE ER-3450            TO  EMI-ERROR
  8137         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8138         MOVE -1                 TO  PFENTERL
  8139*        GO TO 8200-SEND-DATAONLY
  8140      end-if
  8141     if connected-to-db
  8142        perform 4300-FINISH-UP-DB thru 4300-exit
  8143     end-if
  8144     .
  8145 3500-exit.
  8146     exit.
  8147 3700-UPDATE-ERCHKQ.
  8148*    MOVE CH-COMPANY-CD          TO CHKQ-COMPANY-CD.
  8149*    MOVE CH-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NUMBER.
  8150*    MOVE CH-CHECK-QUE-SEQUENCE  TO CHKQ-SEQUENCE-NUMBER.
  8151*
  8152*    EXEC CICS HANDLE CONDITION
  8153*        NOTFND (3780-CHECK-NOTFND)
  8154*    END-EXEC.
  8155*
  8156*    EXEC CICS READ
  8157*        DATASET  (ERCHKQ-FILE-ID)
  8158*        SET      (ADDRESS OF CHECK-QUE)
  8159*        RIDFLD   (ERCHKQ-KEY)
  8160*        UPDATE
  8161*    END-EXEC.
  8162*
  8163*    IF MAINTI = 'C'
  8164*        IF MANUAL-CHECK-WRITTEN
  8165*            MOVE 'M'                 TO CQ-ENTRY-TYPE
  8166*            MOVE +1                  TO CQ-TIMES-PRINTED
  8167*            MOVE CH-CHECK-NO         TO CQ-CHECK-NUMBER
  8168*            MOVE CH-AMOUNT-PAID      TO CQ-CHECK-AMOUNT
  8169*            MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  8170*
  8171*    IF MAINTI = 'V'
  8172*        MOVE 'V'                TO CQ-ENTRY-TYPE
  8173*                                   CQ-VOID-INDICATOR
  8174*        MOVE CH-VOID-DT         TO CQ-CHECK-VOIDED-DT.
  8175*
  8176*    MOVE CH-CHECK-REFERENCE     TO PI-REFERENCE.
  8177*
  8178*    EXEC CICS REWRITE
  8179*        DATASET  (ERCHKQ-FILE-ID)
  8180*        FROM     (CHECK-QUE)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 146
* EL677.cbl
  8181*    END-EXEC.
  8182*
  8183*    GO TO 3790-EXIT.
  8184*
  8185*3780-CHECK-NOTFND.
  8186*    MOVE ER-2905                TO EMI-ERROR.
  8187*    MOVE -1                     TO CARRIERL
  8188*    MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8189*                                   ACCTA     EFFDTA  CERTNOA
  8190*                                   SFXA      SEQA.
  8191*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8192     .
  8193 3790-EXIT.
  8194      EXIT.
  8195
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 147
* EL677.cbl
  8197
  8198 3900-RECORD-NOTFND.
  8199     MOVE ER-2908                TO EMI-ERROR.
  8200     MOVE -1                     TO CARRIERL
  8201     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8202                                    ACCTA     EFFDTA  CERTNOA
  8203                                    SFXA      SEQA.
  8204     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8205     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 148
* EL677.cbl
  8207 4000-ADD-CHANGE.
  8208     IF PAYTO1L NOT = ZEROS
  8209        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  8210     END-IF
  8211
  8212     IF PAYTO2L NOT = ZEROS
  8213         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  8214
  8215     IF PAYAD1L NOT = ZEROS
  8216         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  8217
  8218     IF PAYAD2L NOT = ZEROS
  8219         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  8220
  8221     IF PAYctyL NOT = ZEROS
  8222         MOVE payctyi            TO CH-PAYEE-CITY.
  8223
  8224     IF PAYstL NOT = ZEROS
  8225         MOVE paysti            TO CH-PAYEE-state.
  8226
  8227     IF PAYEEI GREATER SPACES
  8228        MOVE PAYEEI              TO CH-PAYEE-CODE.
  8229
  8230     IF PTOZIPL  =  ZEROS
  8231         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  8232         GO TO 4000-CK-REST.
  8233
  8234     MOVE PTOZIPI                TO WS-ZIP-CODE.
  8235
  8236     IF NOT WS-CANADIAN-POST-CODE
  8237         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  8238         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  8239         GO TO 4000-CK-REST.
  8240
  8241     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  8242     IF WS-CAN-POST-4TH = SPACE OR '-'
  8243         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  8244         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  8245     ELSE
  8246         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  8247         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  8248
  8249 4000-CK-REST.
  8250
  8251     IF RETTOL NOT = ZEROS
  8252        MOVE RETTOI TO CH-RETURN-TO.
  8253     if dedcynl not = zeros
  8254        move dedcyni             to ch-deduct-commission
  8255     end-if
  8256     if dedcynl not = zeros
  8257        if (dedcyni = 'Y')
  8258           or (pi-prev-ded-comm = 'Y')
  8259           compute ws-amt = pi-amount - pi-ue-comm
  8260        else
  8261           if dedcyni = 'N'
  8262              compute ws-amt = pi-amount
  8263           end-if
  8264        end-if
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 149
* EL677.cbl
  8265     end-if
  8266*    if dedcynl not = zeros
  8267*       if (dedcyni = 'Y')
  8268*          or (pi-prev-ded-comm = 'Y')
  8269*          compute ws-amt =
  8270*             pi-refund-on-pending-rec -
  8271*                pi-prev-paid - pi-ue-comm
  8272*       else
  8273*          if dedcyni = 'N'
  8274*             compute ws-amt =
  8275*                pi-refund-on-pending-rec -
  8276*                   pi-prev-paid
  8277*          end-if
  8278*       end-if
  8279*    end-if
  8280     if pi-check-type = 'C'
  8281        compute ws-amt =
  8282           pi-endt-prm-diff - pi-prev-paid
  8283        if (dedcyni = 'Y')
  8284           or (pi-prev-ded-comm = 'Y')
  8285           compute ws-amt =
  8286              ws-amt - pi-ue-comm
  8287        end-if
  8288        if ws-amt <= zeros
  8289           move pi-endt-prm-diff to ws-amt
  8290        end-if
  8291     end-if
  8292     IF AMOUNTL NOT = ZEROS
  8293         MOVE WS-AMT             TO CH-AMOUNT-PAID
  8294         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  8295
  8296     IF CHECKL NOT = ZEROS
  8297         MOVE CHECKI             TO CH-CHECK-NO.
  8298
  8299     IF REASONL NOT = ZEROS
  8300         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  8301
  8302*    IF DEDAMTL NOT = ZEROS
  8303*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  8304*                                   DEDAMTO.
  8305
  8306*    IF ADDLCHGL NOT = ZEROS
  8307*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  8308*                                   ADDLCHGO.
  8309
  8310     IF STUBL NOT = ZEROS
  8311         MOVE STUBI              TO CH-STUB-LINE-1.
  8312
  8313     IF TEXT1L NOT = ZEROS
  8314         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  8315
  8316     IF TEXT2L NOT = ZEROS
  8317         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  8318
  8319     IF TEXT3L NOT = ZEROS
  8320         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8321
  8322     IF TYPEL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 150
* EL677.cbl
  8323         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8324
  8325*    MOVE LETTER1I               TO CH-LETTERS (1).
  8326*    MOVE LETTER2I               TO CH-LETTERS (2).
  8327*    MOVE LETTER3I               TO CH-LETTERS (3).
  8328
  8329*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8330     IF CH-CHECK-ORIGIN-SW = 'R'
  8331         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8332*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
  8333         MOVE PI-CANC-DT             TO CH-CANC-DT
  8334         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8335         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8336     end-if
  8337     MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8338*    IF PI-AR-PROCESSING AND
  8339*       REFL NOT = ZERO
  8340*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8341
  8342 4000-EXIT.
  8343      EXIT.
  8344 4100-CONNECT-TO-DB.
  8345     move 'NTSQLTST2_Logic'      to svr
  8346     move 'sa'                   to usr
  8347     move 'sql2008r2'            to pass
  8348
  8349     if ws-kix-myenv = 'cid1p'
  8350        move 'NTCSO2_ChkApprv'   to svr
  8351        move 'sa'                to usr
  8352        move 'ntcso2'            to pass
  8353     end-if
  8354     string
  8355         usr delimited space
  8356         "." delimited size
  8357         pass delimited space into usr-pass
  8358     end-string
  8359     EXEC SQL
  8360        CONNECT TO :svr USER :usr-pass
  8361     END-EXEC
  8362     if sqlcode not = 0
  8363        display "Error: cannot connect "
  8364        display sqlcode
  8365        display sqlerrmc
  8366     end-if
  8367     set connected-to-db to true
  8368     .
  8369 4100-EXIT.
  8370     EXIT.
  8371 4150-open-cursor.
  8372     move pi-company-id          to ws-compid
  8373     move ch-carrier             to ws-carrier
  8374     move ch-grouping            to ws-grouping
  8375     move ch-state               to ws-state
  8376     move ch-account             to ws-account
  8377     move ch-cert-eff-dt         to dc-bin-date-1
  8378     move ' '                    to dc-option-code
  8379     perform 8500-date-convert   thru 8500-exit
  8380     if no-conversion-error
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 151
* EL677.cbl
  8381        move dc-greg-date-a-edit to ws-eff-date
  8382     end-if
  8383     move ch-cert-prime          to ws-certificate
  8384     move ch-cert-sfx            to ws-cert-sfx
  8385     move ch-sequence-no         to ws-seq-no
  8386     move '1'                    to ws-type
  8387                                    ws-check-sub-type
  8388     if pi-check-type = 'C'
  8389        move '2'                 to ws-check-sub-type
  8390     end-if
  8391     EXEC SQL
  8392        DECLARE
  8393           checkapp cursor for
  8394        SELECT
  8395           ApprovalStatus,
  8396           MaintainedBy,
  8397           MaintainedDate,
  8398           ApprovalBatch
  8399        FROM
  8400           ChkApp_Check
  8401        WHERE
  8402           Company           = :ws-compid
  8403           and CertCarrier   = :ws-carrier
  8404           and CertGroup     = :ws-grouping
  8405           and CertState     = :ws-state
  8406           and CertAccount   = :ws-account
  8407           and CertEffDate   = :ws-eff-date
  8408           and CertNumber    = :ws-certificate
  8409           and CertNumberSuf = :ws-cert-sfx
  8410           and CheckSeqNbr   = :ws-seq-no
  8411           and CheckType     = :ws-type
  8412           and CheckSubType  = :ws-check-sub-type
  8413     END-EXEC
  8414     if sqlcode not = 0
  8415        display "Error: cannot declare cursor "
  8416        display ' sql retrun code ' sqlcode
  8417        display ' sql err mess    ' sqlerrmc
  8418        go to 4150-exit
  8419     end-if
  8420     EXEC SQL
  8421        open checkapp
  8422     END-EXEC
  8423     if sqlcode not = 0
  8424        display "Error: cannot open cursor "
  8425        display ' sql retrun code ' sqlcode
  8426        display ' sql err mess    ' sqlerrmc
  8427     end-if
  8428     .
  8429 4150-exit.
  8430     exit.
  8431 4200-get-tbl-row.
  8432***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8433***                                                            ***
  8434***  I'm only expecting one row so no cursor is declared       ***
  8435***                                                            ***
  8436***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8437     move pi-company-id          to ws-compid
  8438     move ch-carrier             to ws-carrier
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 152
* EL677.cbl
  8439     move ch-grouping            to ws-grouping
  8440     move ch-state               to ws-state
  8441     move ch-account             to ws-account
  8442     move ch-cert-eff-dt         to dc-bin-date-1
  8443     move ' '                    to dc-option-code
  8444     perform 8500-date-convert   thru 8500-exit
  8445     if no-conversion-error
  8446        move dc-greg-date-a-edit to ws-eff-date
  8447     end-if
  8448     move ch-cert-prime          to ws-certificate
  8449     move ch-cert-sfx            to ws-cert-sfx
  8450     move ch-sequence-no         to ws-seq-no
  8451     move '1'                    to ws-type
  8452                                    ws-check-sub-type
  8453     if pi-check-type = 'C'
  8454        move '2'                 to ws-check-sub-type
  8455     end-if
  8456     exec sql
  8457        SELECT
  8458           ApprovalStatus,
  8459           MaintainedBy,
  8460           MaintainedDate,
  8461           ApprovalBatch
  8462        INTO
  8463           :db-app-status :nu-app-status,
  8464           :db-app-by :nu-app-by,
  8465           :db-app-date :nu-app-date,
  8466           :db-app-batch :nu-app-batch
  8467        FROM
  8468           ChkApp_Check
  8469        WHERE
  8470           Company           = :ws-compid
  8471           and CertCarrier   = :ws-carrier
  8472           and CertGroup     = :ws-grouping
  8473           and CertState     = :ws-state
  8474           and CertAccount   = :ws-account
  8475           and CertEffDate   = :ws-eff-date
  8476           and CertNumber    = :ws-certificate
  8477           and CertNumberSuf = :ws-cert-sfx
  8478           and CheckSeqNbr   = :ws-seq-no
  8479           and CheckType     = :ws-type
  8480           and CheckSubType  = :ws-check-sub-type
  8481     end-exec
  8482     if sqlcode not = 0
  8483        display "Error: cannot read row "
  8484        display ' sql return code ' sqlcode
  8485        display ' sql err mess    ' sqlerrmc
  8486        go to 4200-exit
  8487     end-if
  8488*    display ' status ' db-app-status
  8489*    display ' by     ' db-app-by
  8490*    display ' date   ' db-app-date
  8491*    display ' batch  ' db-app-batch
  8492*    if nu-app-date = -1
  8493*       display ' approval date is low-values '
  8494*    else
  8495*       display ' approval date is NOT low values '
  8496*    end-if
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 153
* EL677.cbl
  8497     .
  8498 4200-exit.
  8499     exit.
  8500 4250-delete-row.
  8501     EXEC SQL
  8502        DELETE
  8503           from ChkApp_Check
  8504        WHERE
  8505           Company           = :ws-compid
  8506           and CertCarrier   = :ws-carrier
  8507           and CertGroup     = :ws-grouping
  8508           and CertState     = :ws-state
  8509           and CertAccount   = :ws-account
  8510           and CertEffDate   = :ws-eff-date
  8511           and CertNumber    = :ws-certificate
  8512           and CertNumberSuf = :ws-cert-sfx
  8513           and CheckSeqNbr   = :ws-seq-no
  8514           and CheckType     = :ws-type
  8515           and CheckSubType  = :ws-check-sub-type
  8516     END-EXEC
  8517     if sqlcode not = 0
  8518        display "Error: cannot delete row  "
  8519        display ' sql retrun code ' sqlcode
  8520        display ' sql err mess    ' sqlerrmc
  8521        go to 4250-exit
  8522     end-if
  8523     set row-deleted         to true
  8524     EXEC SQL
  8525         commit transaction
  8526     END-EXEC
  8527     if sqlcode not = 0
  8528        display "Error: commit "
  8529        display ' sql return code ' sqlcode
  8530        display ' sql err mess    ' sqlerrmc
  8531        go to 4250-exit
  8532     end-if
  8533     set tbl-commited to true
  8534     .
  8535 4250-exit.
  8536     exit.
  8537 4300-FINISH-UP-DB.
  8538     EXEC SQL
  8539         commit work release
  8540     END-EXEC
  8541     if sqlcode not = 0
  8542        display "Error: commit release "
  8543        display ' sql return code ' sqlcode
  8544        display ' sql err mess    ' sqlerrmc
  8545     end-if
  8546     .
  8547 4300-EXIT.
  8548     EXIT.
  8549 5000-BROWSE-FILE.
  8550
  8551* EXEC CICS HANDLE CONDITION
  8552*        NOTFND   (5560-END-OF-FILE)
  8553*        ENDFILE  (5560-END-OF-FILE)
  8554*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 154
* EL677.cbl
  8555*    MOVE '"$I''                  ! . #00007906' TO DFHEIV0
  8556     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8557     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8558     MOVE X'2E20233030303037393036' TO DFHEIV0(25:11)
  8559     CALL 'kxdfhei1' USING DFHEIV0
  8560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8561
  8562
  8563     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8564
  8565     IF SEQI = LOW-VALUES
  8566         MOVE +1                 TO CHEK-RECORD-SEQ.
  8567
  8568     IF EIBAID = DFHPF2
  8569         GO TO 5100-BROWSE-BKWD.
  8570
  8571 5010-READ-LOOP.
  8572     IF EIBAID = DFHPF1
  8573         ADD +1                  TO CHEK-RECORD-SEQ.
  8574
  8575
  8576* EXEC CICS READ
  8577*        DATASET  (ERCHEK-FILE-ID)
  8578*        SET      (ADDRESS OF CHECK-RECORDS)
  8579*        RIDFLD   (ERCHEK-KEY)
  8580*        GTEQ
  8581*    END-EXEC.
  8582*    MOVE '&"S        G          (   #00007923' TO DFHEIV0
  8583     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8584     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8585     MOVE X'2020233030303037393233' TO DFHEIV0(25:11)
  8586     CALL 'kxdfhei1' USING DFHEIV0,
  8587           ERCHEK-FILE-ID,
  8588           DFHEIV20,
  8589           DFHEIV99,
  8590           ERCHEK-KEY,
  8591           DFHEIV99,
  8592           DFHEIV99,
  8593           DFHEIV99
  8594     SET ADDRESS OF CHECK-RECORDS TO
  8595         DFHEIV20
  8596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8597
  8598
  8599     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8600         IF EIBAID = DFHENTER
  8601             GO TO 5550-NO-RECORD
  8602         ELSE
  8603             GO TO 5560-END-OF-FILE.
  8604
  8605        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8606           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8607           PI-CHEK-STATE      = CH-STATE       AND
  8608           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8609           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8610           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8611           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8612              GO TO 5500-FORMAT-SCREEN
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 155
* EL677.cbl
  8613            ELSE
  8614              IF EIBAID = DFHPF1
  8615                  GO TO 5560-END-OF-FILE
  8616                ELSE
  8617                  GO TO 5550-NO-RECORD.
  8618
  8619     IF EIBAID = DFHENTER
  8620        IF CHEK-CARRIER    = CH-CARRIER     AND
  8621           CHEK-GROUPING   = CH-GROUPING    AND
  8622           CHEK-STATE      = CH-STATE       AND
  8623           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8624           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8625           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8626           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8627           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8628              GO TO 5500-FORMAT-SCREEN
  8629        ELSE
  8630              GO TO 5550-NO-RECORD.
  8631
  8632     GO TO 5500-FORMAT-SCREEN.
  8633
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 156
* EL677.cbl
  8635
  8636 5100-BROWSE-BKWD.
  8637
  8638* EXEC CICS STARTBR
  8639*        DATASET  (ERCHEK-FILE-ID)
  8640*        RIDFLD   (ERCHEK-KEY)
  8641*    END-EXEC.
  8642     MOVE 0
  8643       TO DFHEIV11
  8644*    MOVE '&,         G          &   #00007968' TO DFHEIV0
  8645     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8646     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8647     MOVE X'2020233030303037393638' TO DFHEIV0(25:11)
  8648     CALL 'kxdfhei1' USING DFHEIV0,
  8649           ERCHEK-FILE-ID,
  8650           ERCHEK-KEY,
  8651           DFHEIV99,
  8652           DFHEIV11,
  8653           DFHEIV99
  8654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8655
  8656
  8657
  8658* EXEC CICS READPREV
  8659*        DATASET  (ERCHEK-FILE-ID)
  8660*        SET      (ADDRESS OF CHECK-RECORDS)
  8661*        RIDFLD   (ERCHEK-KEY)
  8662*    END-EXEC.
  8663     MOVE 0
  8664       TO DFHEIV11
  8665*    MOVE '&0S                   )   #00007973' TO DFHEIV0
  8666     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8667     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8668     MOVE X'2020233030303037393733' TO DFHEIV0(25:11)
  8669     CALL 'kxdfhei1' USING DFHEIV0,
  8670           ERCHEK-FILE-ID,
  8671           DFHEIV20,
  8672           DFHEIV99,
  8673           ERCHEK-KEY,
  8674           DFHEIV99,
  8675           DFHEIV11,
  8676           DFHEIV99,
  8677           DFHEIV99
  8678     SET ADDRESS OF CHECK-RECORDS TO
  8679         DFHEIV20
  8680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8681
  8682
  8683 5110-READ-LOOP.
  8684     IF PI-FILE-EOF
  8685         MOVE SPACE              TO PI-EOF-SW
  8686     ELSE
  8687
  8688* EXEC CICS READPREV
  8689*            DATASET  (ERCHEK-FILE-ID)
  8690*            SET      (ADDRESS OF CHECK-RECORDS)
  8691*            RIDFLD   (ERCHEK-KEY)
  8692*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 157
* EL677.cbl
  8693     MOVE 0
  8694       TO DFHEIV11
  8695*    MOVE '&0S                   )   #00007983' TO DFHEIV0
  8696     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8697     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8698     MOVE X'2020233030303037393833' TO DFHEIV0(25:11)
  8699     CALL 'kxdfhei1' USING DFHEIV0,
  8700           ERCHEK-FILE-ID,
  8701           DFHEIV20,
  8702           DFHEIV99,
  8703           ERCHEK-KEY,
  8704           DFHEIV99,
  8705           DFHEIV11,
  8706           DFHEIV99,
  8707           DFHEIV99
  8708     SET ADDRESS OF CHECK-RECORDS TO
  8709         DFHEIV20
  8710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8711
  8712
  8713     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8714         GO TO 5560-END-OF-FILE.
  8715
  8716        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8717           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8718           PI-CHEK-STATE      = CH-STATE       AND
  8719           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8720           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8721           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8722           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8723              GO TO 5500-FORMAT-SCREEN
  8724            ELSE
  8725              GO TO 5560-END-OF-FILE.
  8726
  8727     GO TO 5500-FORMAT-SCREEN.
  8728
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 158
* EL677.cbl
  8730*                          COPY ELCNPD.
  8731*****************************************************************
  8732*                                                               *
  8733*                                                               *
  8734*                            ELCNPD                             *
  8735*                            VMOD=2.001                         *
  8736*****************************************************************
  8737
  8738 5200-MOVE-NAME.
  8739*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8740*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8741*            BLANKS.                                            *
  8742*                                                               *
  8743*                  FIELD               VALUE                    *
  8744*                                                               *
  8745*                LAST NAME (CL15)      SMITH                    *
  8746*                1ST NAME  (CL12)      JOHN                     *
  8747*                MID NAME  (CL1)       A                        *
  8748*                                                               *
  8749*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8750*         *                                                     *
  8751*         *              JOHN A. SMITH                          *
  8752*         *                                                     *
  8753*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8754*         *  STORAGE COPYBOOK:                                  *
  8755*         *                                                     *
  8756*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8757*         *******************************************************.
  8758
  8759     MOVE SPACES                 TO  WS-NAME-WORK
  8760                                     WS-NAME-WORK2.
  8761     MOVE ZERO                   TO  WS-NAME-SW.
  8762     SET NWA-INDEX TO +1.
  8763
  8764     IF WS-INSURED-1ST-NAME = SPACES  AND
  8765        WS-INSURED-MID-INIT = SPACES
  8766         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8767         GO TO 5200-EXIT.
  8768
  8769     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8770     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8771
  8772     SET NWA-INDEX UP BY +1
  8773     IF WS-INSURED-MID-INIT NOT = SPACES
  8774        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8775        SET NWA-INDEX UP BY +1
  8776        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8777        SET NWA-INDEX UP BY +2.
  8778
  8779     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8780     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8781
  8782
  8783 5200-EXIT.
  8784     EXIT.
  8785
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 159
* EL677.cbl
  8787 5300-MOVE-NAME SECTION.
  8788     IF WS-NAME-SW GREATER THAN +1
  8789         GO TO 5390-EXIT.
  8790
  8791     IF WS-NAME-WORK2 = SPACES
  8792         GO TO 5390-EXIT.
  8793
  8794     SET NWA-INDEX2 TO +1.
  8795     SET NWA-INDEX3 TO +2.
  8796
  8797 5310-MOVE-NAME.
  8798     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8799
  8800     IF NWA-INDEX LESS THAN +30
  8801        SET NWA-INDEX UP BY +1
  8802     ELSE
  8803        ADD +2  TO  WS-NAME-SW
  8804        GO TO 5390-EXIT.
  8805
  8806     IF NWA-INDEX2 LESS THAN +20
  8807         SET NWA-INDEX2 UP BY +1
  8808         SET NWA-INDEX3 UP BY +1.
  8809
  8810     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8811        WS-NW2 (NWA-INDEX3) = SPACES
  8812        GO TO 5390-EXIT.
  8813
  8814     GO TO 5310-MOVE-NAME.
  8815
  8816 5390-EXIT.
  8817     EXIT.
  8818
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 160
* EL677.cbl
  8821 5500-FORMAT-SCREEN.
  8822     MOVE LOW-VALUES             TO  EL677AI.
  8823     MOVE 'S'                    TO  MAINTI   PI-PREV-MAINT.
  8824     MOVE +1                     TO  MAINTL.
  8825     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8826     MOVE CH-CARRIER             TO  CARRIERO.
  8827     MOVE CH-GROUPING            TO  GROUPO.
  8828     MOVE CH-STATE               TO  STATEO.
  8829     MOVE CH-ACCOUNT             TO  ACCTO.
  8830
  8831     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8832     MOVE SPACE                  TO  DC-OPTION-CODE.
  8833     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8834     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8835
  8836     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8837     MOVE CH-CERT-SFX            TO  SFXO.
  8838     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8839
  8840     MOVE AL-UANON               TO  CARRIERA
  8841                                     GROUPA
  8842                                     STATEA
  8843                                     ACCTA
  8844                                     EFFDTA
  8845                                     CERTNOA
  8846                                     SFXA.
  8847     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8848
  8849     if ch-approval-dt not = low-values
  8850        move ch-approval-dt      to dc-bin-date-1
  8851        move ' '                 to dc-option-code
  8852        perform 8500-date-convert thru 8500-exit
  8853        move dc-greg-date-1-edit to apvdto
  8854     end-if
  8855     evaluate ch-approval-status
  8856        when '2'
  8857           move 'PENDING '       TO APVSTATO
  8858        when 'P'
  8859           move 'PENDING '       TO APVSTATO
  8860        when 'A'
  8861           move 'APPROVED'       to apvstato
  8862        when 'D'
  8863           move 'DENIED'         to apvstato
  8864     end-evaluate
  8865     move ch-approved-by         to apvbyo
  8866*    IF PI-COMPANY-ID = 'TMS'
  8867*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8868*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8869*    ELSE
  8870         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8871         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8872
  8873     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8874     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8875     move ch-payee-city          to payctyo
  8876     move ch-payee-state         to paysto
  8877     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8878
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 161
* EL677.cbl
  8879     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8880         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8881         MOVE AL-UANON           TO  PTOZIPA.
  8882
  8883     MOVE CH-RETURN-TO           TO  RETTOO
  8884*    if ch-check-cashed-dt not = spaces and low-values
  8885*       move ch-check-cashed-dt  to dc-bin-date-1
  8886*       MOVE SPACE               TO  DC-OPTION-CODE
  8887*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8888*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8889*    end-if
  8890     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8891     MOVE SPACE                  TO  DC-OPTION-CODE.
  8892     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8893     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8894
  8895     MOVE CH-RECORDED-BY         TO  CBYO.
  8896
  8897     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8898         NEXT SENTENCE
  8899     ELSE
  8900         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8901         MOVE SPACE                  TO  DC-OPTION-CODE
  8902         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8903         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8904         MOVE CH-VOID-BY             TO  VBYO.
  8905
  8906     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8907         NEXT SENTENCE
  8908     ELSE
  8909         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8910         MOVE SPACE                  TO  DC-OPTION-CODE
  8911         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8912         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8913
  8914     MOVE CH-AMOUNT-PAID         TO  AMOUNTO.
  8915     MOVE AL-SANOF               TO  AMOUNTA.
  8916     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8917     MOVE AL-SANOF               TO  TYPEA.
  8918     MOVE CH-CHECK-NO            TO  CHECKO.
  8919     move ch-deduct-commission   to dedcyno
  8920     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8921     MOVE CH-VOID-REASON         TO  VREASONO.
  8922
  8923     MOVE CH-STUB-LINE-1         TO  STUBO.
  8924     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8925     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8926     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8927     IF CH-LF-REFUND NOT NUMERIC
  8928         MOVE ZEROS              TO CH-LF-REFUND.
  8929     IF CH-AH-REFUND NOT NUMERIC
  8930         MOVE ZEROS              TO CH-AH-REFUND.
  8931     if (ch-check-no not = spaces and low-values)
  8932        and (ch-check-written-dt not = low-values)
  8933        perform 5800-fetch-check-cashed-dt
  8934                                 thru 5800-exit
  8935     end-if
  8936     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 162
* EL677.cbl
  8937        CH-VOID-DT          GREATER LOW-VALUES
  8938        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8939                                     STUBA     TEXT1A   TEXT2A
  8940                                     TEXT3A    PAYTO1A  SFXA
  8941                                     PAYTO2A   PAYAD1A  PAYctyA
  8942                                     paysta    RETTOA   PAYAD2A
  8943                                     PTOZIPA
  8944                                     PRINTEDA
  8945     ELSE
  8946        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8947                                     ACCTA     EFFDTA   CERTNOA
  8948                                     CHECKA    REASONA  VREASONA
  8949                                     STUBA     TEXT1A   TEXT2A
  8950                                     TEXT3A    PAYTO1A  SFXA
  8951                                     PAYTO2A   PAYAD1A  PAYctyA
  8952                                     paysta    RETTOA   PAYAD2A
  8953                                     PRINTEDA.
  8954
  8955     MOVE AL-UNNON               TO SEQA.
  8956     perform 5600-get-erpndb     thru 5600-exit
  8957     perform 5700-get-elcert     thru 5700-exit
  8958*    move pi-prev-paid           to prepdo
  8959     move al-sadof               to drefa
  8960*    if WS-PNDB-FOUND
  8961*       compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8962*    end-if
  8963     if WS-CERT-FOUND
  8964        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8965           cm-lf-alt-premium-amt
  8966        compute ws-tot-iss-prem  =
  8967           cm-ah-premium-amt + ws-tot-lf-prem
  8968        compute ws-tot-iss-comm =
  8969           (ws-tot-lf-prem * cm-life-comm-pct) +
  8970           (cm-ah-premium-amt * cm-ah-comm-pct)
  8971        compute ws-tot-ref-comm =
  8972           (pi-lf-refund * cm-life-comm-pct) +
  8973           (pi-ah-refund * cm-ah-comm-pct)
  8974        move ws-tot-iss-prem     to premo
  8975        move ws-tot-iss-comm     to isscommo
  8976*       move ws-tot-ref-comm     to uecommo
  8977     end-if
  8978     if PI-TO-EL677-FROM-EL1273
  8979        move zeros               to premo
  8980                                    isscommo
  8981                                    uecommo
  8982                                    prepdo
  8983                                    refo
  8984     end-if
  8985     GO TO 8100-SEND-INITIAL-MAP
  8986     .
  8987 5550-NO-RECORD.
  8988     MOVE ER-1162                TO  EMI-ERROR.
  8989     MOVE -1                     TO  CARRIERL.
  8990     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8991                                     ACCTA     EFFDTA  CERTNOA
  8992                                     SFXA      SEQA.
  8993     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8994
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 163
* EL677.cbl
  8995     IF (NOT PI-TO-EL677-FROM-EL1273)
  8996        and (pi-return-to-program not = 'EL6315')
  8997         GO TO 8200-SEND-DATAONLY.
  8998
  8999     MOVE CHEK-CARRIER           TO  CARRIERO.
  9000     MOVE CHEK-GROUPING          TO  GROUPO.
  9001     MOVE CHEK-STATE             TO  STATEO.
  9002     MOVE CHEK-ACCOUNT           TO  ACCTO.
  9003
  9004     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  9005     MOVE SPACE                  TO  DC-OPTION-CODE.
  9006     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9007     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  9008
  9009     MOVE CHEK-CERT-NO           TO  CERTNOO.
  9010     MOVE CHEK-SUF-NO            TO  SFXO.
  9011     GO TO 8100-SEND-INITIAL-MAP.
  9012
  9013 5560-END-OF-FILE.
  9014     IF EIBAID = DFHPF1
  9015         MOVE 'Y'                TO  PI-EOF-SW
  9016         MOVE ER-2237            TO  EMI-ERROR
  9017     ELSE
  9018     IF EIBAID = DFHENTER
  9019        GO TO 5550-NO-RECORD
  9020     ELSE
  9021*        MOVE SPACES             TO  PI-ERCHEK-KEY
  9022         MOVE ER-2238            TO  EMI-ERROR.
  9023
  9024     MOVE -1                     TO  MAINTL.
  9025     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9026     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 164
* EL677.cbl
  9028 5600-get-erpndb.
  9029     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  9030     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  9031     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  9032     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  9033     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  9034     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  9035     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  9036     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  9037     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  9038     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  9039     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  9040     IF ST-ACCNT-CNTL  OR
  9041        ACCNT-CNTL
  9042          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9043     IF ST-ACCNT-CNTL      OR
  9044        CARR-ST-ACCNT-CNTL OR
  9045        ACCNT-CNTL         OR
  9046        CARR-ACCNT-CNTL
  9047          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9048     IF ACCNT-CNTL OR
  9049        CARR-ACCNT-CNTL
  9050          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9051
  9052* EXEC CICS READ
  9053*         DATASET   (ERPNDB-ALT-FILE-ID)
  9054*         SET       (ADDRESS OF PENDING-BUSINESS)
  9055*         RIDFLD    (ERPNDB-ALT-KEY)
  9056*         resp      (ws-response)
  9057*    END-EXEC
  9058*    MOVE '&"S        E          (  N#00008327' TO DFHEIV0
  9059     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9060     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9061     MOVE X'204E233030303038333237' TO DFHEIV0(25:11)
  9062     CALL 'kxdfhei1' USING DFHEIV0,
  9063           ERPNDB-ALT-FILE-ID,
  9064           DFHEIV20,
  9065           DFHEIV99,
  9066           ERPNDB-ALT-KEY,
  9067           DFHEIV99,
  9068           DFHEIV99,
  9069           DFHEIV99
  9070     SET ADDRESS OF PENDING-BUSINESS TO
  9071         DFHEIV20
  9072     MOVE EIBRESP  TO ws-response
  9073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9074     if resp-normal
  9075        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  9076        compute pi-refund-on-pending-rec =
  9077           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  9078     end-if
  9079     .
  9080 5600-exit.
  9081     exit.
  9082 5700-get-elcert.
  9083     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9084     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9085     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 165
* EL677.cbl
  9086     MOVE PI-STATE               TO  ELCERT-STATE.
  9087     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9088     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9089     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9090     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9091     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9092
  9093* EXEC CICS READ
  9094*         DATASET   (ELCERT-FILE-ID)
  9095*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9096*         RIDFLD    (ELCERT-KEY)
  9097*         resp      (ws-response)
  9098*    END-EXEC
  9099*    MOVE '&"S        E          (  N#00008351' TO DFHEIV0
  9100     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9102     MOVE X'204E233030303038333531' TO DFHEIV0(25:11)
  9103     CALL 'kxdfhei1' USING DFHEIV0,
  9104           ELCERT-FILE-ID,
  9105           DFHEIV20,
  9106           DFHEIV99,
  9107           ELCERT-KEY,
  9108           DFHEIV99,
  9109           DFHEIV99,
  9110           DFHEIV99
  9111     SET ADDRESS OF CERTIFICATE-MASTER TO
  9112         DFHEIV20
  9113     MOVE EIBRESP  TO ws-response
  9114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9115     if resp-normal
  9116        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  9117     end-if
  9118     .
  9119 5700-exit.
  9120     exit.
  9121 5800-fetch-check-cashed-dt.
  9122     move ' '                    to ws-connect-sw
  9123                                    ws-match-sw
  9124                                    pi-check-cashed
  9125     move 'NTCSO2_PdBnkInfo'     to svr
  9126     move 'sa'                   to usr
  9127     move 'ntcso2'               to pass
  9128     string
  9129         usr delimited space
  9130         "." delimited size
  9131         pass delimited space into usr-pass
  9132     end-string
  9133     EXEC SQL
  9134        CONNECT TO :svr USER :usr-pass
  9135     END-EXEC
  9136     if sqlcode not = 0
  9137        display "Error: cannot connect to pdbnkinfo "
  9138        display sqlcode
  9139        display sqlerrmc
  9140        go to 5800-exit
  9141     end-if
  9142     set connected-to-db to true
  9143     if pi-company-id = 'CID'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 166
* EL677.cbl
  9144        move 'CSO - AP%'         to ws-pb-compid
  9145     else
  9146        move 'AHL - AP%'         to ws-pb-compid
  9147     end-if
  9148     move '000'                  to ws-pb-check-no (1:3)
  9149     move ch-check-no            to ws-pb-check-no (4:7)
  9150     move spaces                 to ws-pb-bad-check-no
  9151     perform varying s1 from +1 by +1 until
  9152        (s1 > +10)
  9153        or (ws-pb-check-no (s1:1) not = '0')
  9154     end-perform
  9155     if s1 < +11
  9156        move ws-pb-check-no (s1:11 - s1)
  9157                            to ws-pb-bad-check-no (1: 11 - s1)
  9158     end-if
  9159*    display ' compid **' ws-pb-compid '**'
  9160*    display ' ckno  **' ws-pb-check-no '**'
  9161     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  9162     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  9163     MOVE SPACES              TO pb-paid-date
  9164
  9165     EXEC SQL
  9166        CALL pbi_GetCashDate_by_TransactionNbr
  9167           @compid          = :ws-pb-compid,
  9168           @checkno         = :ws-pb-check-no,
  9169           @badcheckno      = :ws-pb-bad-check-no,
  9170           @checkamount     = :ws-check-amount,
  9171           @checkcasheddate = :pb-paid-date OUT
  9172     END-EXEC
  9173     if sqlcode not = 0
  9174        display "Error: cannot run stor proc  "
  9175        move sqlcode            to ws-sql-code
  9176        move ws-sql-code to ws-dis-sql-code
  9177        display ' dis sql code ' ws-dis-sql-code
  9178        display ' sql return code ' sqlcode
  9179        display ' sql err mess    ' sqlerrmc
  9180        go to 5800-disconnect
  9181     end-if
  9182***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9183***                                                            ***
  9184***  The following code works just as well as the above        ***
  9185***  stored procedure and just as fast.                        ***
  9186***  Originally, I had declared a cursor and fetched through   ***
  9187***  the record set to find the correct check and that REALLY  ***
  9188***  slowed the response down to ~ 3/4 second.                 ***
  9189***                                                            ***
  9190***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9191*     EXEC SQL
  9192*        SELECT
  9193*           PaidDate
  9194*        INTO
  9195*           :pb-paid-date
  9196*        FROM
  9197*           dbo.cso_pbi_TransactionLookup
  9198*        WHERE
  9199*           (BankAcctDescr like :ws-pb-compid)
  9200*           and (Amount = :ws-check-amount)
  9201*           and ((transactionNbr = :ws-pb-check-no)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 167
* EL677.cbl
  9202*                  or
  9203*               (transactionnbr = :ws-pb-bad-check-no))
  9204**          and (CAST(TransactionNbr AS INT) =
  9205**             :ws-pb-check-no-num)
  9206**          and (right('00000' + rtrim(TransactionNbr),10)
  9207**             = :ws-pb-check-no)
  9208**          and (TransactionNbr  = :ws-pb-check-no)
  9209*     END-EXEC
  9210*    display ' chkno  ' pb-check-no
  9211*    display ' desc   ' pb-bank-acct-desc
  9212*    display ' trn typ' pb-tran-type
  9213*    display ' amt   *' pb-amount '**'
  9214*    display ' pd dte ' pb-paid-date
  9215     string pb-paid-date (7:4)
  9216            pb-paid-date (1:2)
  9217            pb-paid-date (4:2)
  9218        delimited by size into dc-greg-date-cymd-r
  9219     end-string
  9220     move 'L'                    to dc-option-code
  9221     perform 8500-date-convert   thru 8500-exit
  9222     if no-conversion-error
  9223*       move dc-bin-date-1       to ws-bin-cashed-dt
  9224        move dc-greg-date-1-edit to cashedo
  9225        move 'Y' to pi-check-cashed
  9226     else
  9227        display ' error cvtdte cash dt ' pb-paid-date ' '
  9228           dc-error-code
  9229     end-if
  9230     .
  9231 5800-disconnect.
  9232     EXEC SQL
  9233        DISCONNECT ALL
  9234     END-EXEC
  9235     if sqlcode not = 0
  9236        display "Error: cannot disconnect pdbnk "
  9237        display ' sql return code ' sqlcode
  9238        display ' sql err mess    ' sqlerrmc
  9239     end-if
  9240     .
  9241 5800-exit.
  9242     exit.
  9243 6000-VERIFY-COMP-MASTER.
  9244
  9245* EXEC CICS HANDLE CONDITION
  9246*        NOTFND   (6070-NO-COMP-MSTR)
  9247*    END-EXEC.
  9248*    MOVE '"$I                   ! / #00008486' TO DFHEIV0
  9249     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9251     MOVE X'2F20233030303038343836' TO DFHEIV0(25:11)
  9252     CALL 'kxdfhei1' USING DFHEIV0
  9253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9254
  9255
  9256     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  9257
  9258     IF NOT PI-ZERO-CARRIER AND
  9259        NOT PI-ZERO-CAR-GROUP
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 168
* EL677.cbl
  9260         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  9261     ELSE
  9262         MOVE ZEROS              TO  ERCOMP-CARRIER.
  9263
  9264     IF NOT PI-ZERO-GROUPING  AND
  9265        NOT PI-ZERO-CAR-GROUP
  9266         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  9267     ELSE
  9268         MOVE ZEROS              TO  ERCOMP-GROUPING.
  9269
  9270     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  9271     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  9272     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  9273
  9274
  9275* EXEC CICS READ
  9276*         DATASET   (ERCOMP-FILE-ID)
  9277*         SET       (ADDRESS OF COMPENSATION-MASTER)
  9278*         RIDFLD    (ERCOMP-KEY)
  9279*     END-EXEC.
  9280*    MOVE '&"S        E          (   #00008508' TO DFHEIV0
  9281     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9282     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9283     MOVE X'2020233030303038353038' TO DFHEIV0(25:11)
  9284     CALL 'kxdfhei1' USING DFHEIV0,
  9285           ERCOMP-FILE-ID,
  9286           DFHEIV20,
  9287           DFHEIV99,
  9288           ERCOMP-KEY,
  9289           DFHEIV99,
  9290           DFHEIV99,
  9291           DFHEIV99
  9292     SET ADDRESS OF COMPENSATION-MASTER TO
  9293         DFHEIV20
  9294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9295
  9296
  9297     GO TO 6090-EXIT.
  9298
  9299 6070-NO-COMP-MSTR.
  9300     MOVE -1                     TO  CARRIERL.
  9301     MOVE ER-2230                TO  EMI-ERROR.
  9302     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9303     GO TO 8200-SEND-DATAONLY.
  9304
  9305 6090-EXIT.
  9306      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 169
* EL677.cbl
  9308 6100-VERIFY-CERTIFICATE.
  9309
  9310* EXEC CICS HANDLE CONDITION
  9311*        NOTFND   (6170-NO-CERTIFICATE)
  9312*    END-EXEC.
  9313*    MOVE '"$I                   ! 0 #00008526' TO DFHEIV0
  9314     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9315     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9316     MOVE X'3020233030303038353236' TO DFHEIV0(25:11)
  9317     CALL 'kxdfhei1' USING DFHEIV0
  9318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9319
  9320
  9321     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9322     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9323     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  9324     MOVE PI-STATE               TO  ELCERT-STATE.
  9325     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9326     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9327     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9328     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9329
  9330     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9331
  9332     MOVE SPACES                 TO  PI-REFERENCE
  9333*                                    PI-INSURED-NAME.
  9334     MOVE LOW-VALUES             TO  PI-CANC-DT.
  9335     MOVE ZEROS                  TO  PI-LF-REFUND
  9336                                     PI-AH-REFUND.
  9337
  9338
  9339* EXEC CICS READ
  9340*         DATASET   (ELCERT-FILE-ID)
  9341*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9342*         RIDFLD    (ELCERT-KEY)
  9343*     END-EXEC.
  9344*    MOVE '&"S        E          (   #00008547' TO DFHEIV0
  9345     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9347     MOVE X'2020233030303038353437' TO DFHEIV0(25:11)
  9348     CALL 'kxdfhei1' USING DFHEIV0,
  9349           ELCERT-FILE-ID,
  9350           DFHEIV20,
  9351           DFHEIV99,
  9352           ELCERT-KEY,
  9353           DFHEIV99,
  9354           DFHEIV99,
  9355           DFHEIV99
  9356     SET ADDRESS OF CERTIFICATE-MASTER TO
  9357         DFHEIV20
  9358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9359
  9360
  9361     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  9362
  9363     MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  9364     MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  9365     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 170
* EL677.cbl
  9366         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  9367     ELSE
  9368         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9369             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  9370*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  9371
  9372     GO TO 6190-EXIT.
  9373
  9374 6170-NO-CERTIFICATE.
  9375     MOVE -1                     TO  CARRIERL.
  9376     MOVE ER-2726                TO  EMI-ERROR.
  9377     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9378
  9379 6190-EXIT.
  9380      EXIT.
  9381
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 171
* EL677.cbl
  9383 6200-UPDATE-PENDING-BUS-REC.
  9384     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9385     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9386     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9387     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9388     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9389     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9390     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9391     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9392     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9393     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9394
  9395     IF ST-ACCNT-CNTL  OR
  9396        ACCNT-CNTL
  9397          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9398
  9399     IF ST-ACCNT-CNTL      OR
  9400        CARR-ST-ACCNT-CNTL OR
  9401        ACCNT-CNTL         OR
  9402        CARR-ACCNT-CNTL
  9403          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9404
  9405     IF ACCNT-CNTL OR
  9406        CARR-ACCNT-CNTL
  9407          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9408
  9409
  9410* EXEC CICS READ
  9411*         DATASET   (ERPNDB-ALT-FILE-ID)
  9412*         SET       (ADDRESS OF PENDING-BUSINESS)
  9413*         RIDFLD    (ERPNDB-ALT-KEY)
  9414*         resp      (ws-response)
  9415*     END-EXEC.
  9416*    MOVE '&"S        E          (  N#00008601' TO DFHEIV0
  9417     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9418     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9419     MOVE X'204E233030303038363031' TO DFHEIV0(25:11)
  9420     CALL 'kxdfhei1' USING DFHEIV0,
  9421           ERPNDB-ALT-FILE-ID,
  9422           DFHEIV20,
  9423           DFHEIV99,
  9424           ERPNDB-ALT-KEY,
  9425           DFHEIV99,
  9426           DFHEIV99,
  9427           DFHEIV99
  9428     SET ADDRESS OF PENDING-BUSINESS TO
  9429         DFHEIV20
  9430     MOVE EIBRESP  TO ws-response
  9431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9432
  9433
  9434     if not resp-normal
  9435        go to 6200-exit
  9436     end-if
  9437     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9438
  9439
  9440* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 172
* EL677.cbl
  9441*         DATASET   (ERPNDB-FILE-ID)
  9442*         SET       (ADDRESS OF PENDING-BUSINESS)
  9443*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9444*         UPDATE
  9445*         resp      (ws-response)
  9446*     END-EXEC.
  9447*    MOVE '&"S        EU         (  N#00008613' TO DFHEIV0
  9448     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9449     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9450     MOVE X'204E233030303038363133' TO DFHEIV0(25:11)
  9451     CALL 'kxdfhei1' USING DFHEIV0,
  9452           ERPNDB-FILE-ID,
  9453           DFHEIV20,
  9454           DFHEIV99,
  9455           ERPNDB-PRIMARY-KEY,
  9456           DFHEIV99,
  9457           DFHEIV99,
  9458           DFHEIV99
  9459     SET ADDRESS OF PENDING-BUSINESS TO
  9460         DFHEIV20
  9461     MOVE EIBRESP  TO ws-response
  9462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9463
  9464
  9465 6200-EXIT.
  9466      EXIT.
  9467 6210-rewrite-pndb.
  9468
  9469* EXEC CICS REWRITE
  9470*        DATASET  (ERPNDB-FILE-ID)
  9471*        FROM     (PENDING-BUSINESS)
  9472*    END-EXEC
  9473     MOVE LENGTH OF
  9474      PENDING-BUSINESS
  9475       TO DFHEIV11
  9476*    MOVE '&& L                  %   #00008624' TO DFHEIV0
  9477     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9478     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9479     MOVE X'2020233030303038363234' TO DFHEIV0(25:11)
  9480     CALL 'kxdfhei1' USING DFHEIV0,
  9481           ERPNDB-FILE-ID,
  9482           PENDING-BUSINESS,
  9483           DFHEIV11,
  9484           DFHEIV99
  9485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9486     .
  9487 6210-exit.
  9488     exit.
  9489 6300-BUILD-CERT-SCREEN.
  9490     perform 6700-build-common   thru 6700-exit
  9491     if ws-refund-amount = zeros
  9492        move pi-company-cd       to pi-chek-comp-cd
  9493        move pi-carrier          to pi-chek-carrier
  9494        move pi-grouping         to pi-chek-grouping
  9495        move pi-state            to pi-chek-state
  9496        move pi-account          to pi-chek-account
  9497        move pi-cert-eff-dt      to pi-chek-eff-dt
  9498        move pi-cert-prime       to pi-chek-cert-no
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 173
* EL677.cbl
  9499        move pi-cert-sfx         to pi-chek-suf-no
  9500        move +1                  to pi-chek-sequence
  9501             MOVE 'S'            TO MAINTI
  9502             MOVE 1              TO MAINTL
  9503             MOVE AL-UABON       TO MAINTA
  9504             MOVE DFHENTER       TO EIBAID
  9505        go to 5000-browse-file
  9506     end-if
  9507     IF WS-CERT-NOT-FOUND
  9508         GO TO 8100-SEND-INITIAL-MAP.
  9509
  9510*    IF WS-PNDB-FOUND
  9511*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9512*                                   PB-C-AH-CANCEL-AMT
  9513*        MOVE 'R'                TO  TYPEO
  9514*        IF PI-AR-PROCESSING
  9515*            MOVE AL-UANON       TO  REFA
  9516*            MOVE PB-C-REFERENCE TO  REFO
  9517*        END-IF
  9518*    ELSE
  9519*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9520*                                   CM-AH-ITD-CANCEL-AMT.
  9521     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9522     MOVE pi-check-type           TO TYPEO
  9523
  9524     IF PI-COMPANY-ID = 'TMS'
  9525         MOVE WS-NAME-WORK         TO PAYTO1I
  9526                                      PI-PAYTO1
  9527         MOVE AL-UANON             TO PAYTO1A
  9528     ELSE
  9529         MOVE WS-NAME-WORK         TO PAYTO1I
  9530                                      PI-PAYTO1
  9531         MOVE AL-UANON             TO PAYTO1A.
  9532
  9533*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9534*    MOVE AL-UANON                 TO PAYTO1AA.
  9535     move 'N'                    to dedcyni
  9536     move al-uanon               to dedcyna
  9537     move 'INS'                  to payeeo
  9538     move al-panon               to payeea
  9539     IF PI-MAIL-YES
  9540         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9541
  9542     GO TO 8100-SEND-INITIAL-MAP.
  9543
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 174
* EL677.cbl
  9545
  9546 6400-MAILING-ADDRESS.
  9547
  9548* EXEC CICS HANDLE CONDITION
  9549*        NOTFND   (6470-NO-ADDRESS)
  9550*    END-EXEC.
  9551*    MOVE '"$I                   ! 1 #00008689' TO DFHEIV0
  9552     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9553     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9554     MOVE X'3120233030303038363839' TO DFHEIV0(25:11)
  9555     CALL 'kxdfhei1' USING DFHEIV0
  9556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9557
  9558
  9559
  9560* EXEC CICS READ
  9561*        DATASET   (ERMAIL-FILE-ID)
  9562*        SET       (ADDRESS OF MAILING-DATA)
  9563*        RIDFLD    (ELCERT-KEY)
  9564*    END-EXEC.
  9565*    MOVE '&"S        E          (   #00008693' TO DFHEIV0
  9566     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9567     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9568     MOVE X'2020233030303038363933' TO DFHEIV0(25:11)
  9569     CALL 'kxdfhei1' USING DFHEIV0,
  9570           ERMAIL-FILE-ID,
  9571           DFHEIV20,
  9572           DFHEIV99,
  9573           ELCERT-KEY,
  9574           DFHEIV99,
  9575           DFHEIV99,
  9576           DFHEIV99
  9577     SET ADDRESS OF MAILING-DATA TO
  9578         DFHEIV20
  9579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9580
  9581
  9582     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9583     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9584     move ma-city                to payctyi
  9585     move ma-addr-state          to paysti
  9586     MOVE MA-ZIP                 TO PTOZIPI.
  9587     MOVE AL-UANON               TO PAYAD1A
  9588                                    PAYAD2A
  9589                                    PAYctyA
  9590                                    paysta
  9591                                    PTOZIPA.
  9592
  9593     GO TO 6490-EXIT.
  9594
  9595 6470-NO-ADDRESS.
  9596     MOVE -1                     TO  PAYAD1L.
  9597     MOVE ER-2394                TO  EMI-ERROR.
  9598     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9599
  9600 6490-EXIT.
  9601      EXIT.
  9602
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 175
* EL677.cbl
  9604
  9605 6500-BUILD-ACCOUNT-SCREEN.
  9606     perform 6700-build-common   thru 6700-exit
  9607     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9608     MOVE PI-AM-NAME             TO PAYTO1I
  9609     MOVE SPACES                 TO PAYTO2I
  9610     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9611     MOVE PI-AM-CITY             TO PAYCTYI
  9612     move pi-am-st               to paysti
  9613     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9614     move 'ACCT'                 to payeeo
  9615     move al-panon               to payeea
  9616     MOVE AL-UANON               TO PAYTO1A
  9617                                    PAYTO2A
  9618                                    PAYAD1A
  9619                                    PAYCTYA
  9620                                    paysta
  9621                                    PTOZIPA.
  9622     GO TO 8100-SEND-INITIAL-MAP
  9623     .
  9624 6600-BUILD-BENEFICIARY-SCREEN.
  9625     perform 6700-build-common   thru 6700-exit
  9626     IF WS-CERT-NOT-FOUND
  9627         GO TO 8100-SEND-INITIAL-MAP.
  9628
  9629*    IF WS-PNDB-FOUND
  9630*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9631*                                   PB-C-AH-CANCEL-AMT
  9632*        MOVE 'R'                TO  TYPEO
  9633*        IF PI-AR-PROCESSING
  9634*            MOVE AL-UANON       TO  REFA
  9635*            MOVE PB-C-REFERENCE TO  REFO
  9636*        END-IF
  9637*    ELSE
  9638*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9639*                                   CM-AH-ITD-CANCEL-AMT.
  9640
  9641     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9642     MOVE pi-check-type           TO  TYPEO.
  9643
  9644     IF PI-COMPANY-ID = 'TMS'
  9645         MOVE WS-NAME-WORK         TO PAYTO1I
  9646                                      PI-PAYTO1
  9647         MOVE AL-UANON             TO PAYTO1A
  9648     ELSE
  9649         MOVE WS-NAME-WORK         TO PAYTO1I
  9650                                      PI-PAYTO1
  9651         MOVE AL-UANON             TO PAYTO1A.
  9652
  9653*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9654*    MOVE AL-UANON                 TO PAYTO1AA.
  9655
  9656     move 'N'                    to dedcyni
  9657     move al-uanon               to dedcyna
  9658     move 'BENE'                 to payeeo
  9659     move al-panon               to payeea
  9660     IF PI-MAIL-YES
  9661         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 176
* EL677.cbl
  9662
  9663     GO TO 8100-SEND-INITIAL-MAP.
  9664
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 177
* EL677.cbl
  9666
  9667 6620-MAILING-ADDRESS.
  9668
  9669* EXEC CICS HANDLE CONDITION
  9670*        NOTFND   (6670-NO-beneficiary)
  9671*    END-EXEC.
  9672*    MOVE '"$I                   ! 2 #00008785' TO DFHEIV0
  9673     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9674     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9675     MOVE X'3220233030303038373835' TO DFHEIV0(25:11)
  9676     CALL 'kxdfhei1' USING DFHEIV0
  9677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9678
  9679
  9680
  9681* EXEC CICS READ
  9682*        DATASET   (ERMAIL-FILE-ID)
  9683*        SET       (ADDRESS OF MAILING-DATA)
  9684*        RIDFLD    (ELCERT-KEY)
  9685*    END-EXEC.
  9686*    MOVE '&"S        E          (   #00008789' TO DFHEIV0
  9687     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9689     MOVE X'2020233030303038373839' TO DFHEIV0(25:11)
  9690     CALL 'kxdfhei1' USING DFHEIV0,
  9691           ERMAIL-FILE-ID,
  9692           DFHEIV20,
  9693           DFHEIV99,
  9694           ELCERT-KEY,
  9695           DFHEIV99,
  9696           DFHEIV99,
  9697           DFHEIV99
  9698     SET ADDRESS OF MAILING-DATA TO
  9699         DFHEIV20
  9700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9701
  9702
  9703     move spaces                 to payto2i
  9704     move ma-cred-bene-name      to payto1i
  9705     MOVE MA-cred-bene-addr      TO PAYad1I.
  9706     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9707     move ma-cred-bene-city      to payctyi
  9708     move ma-cred-bene-state     to paysti
  9709     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9710     MOVE AL-UANON               TO payto1a
  9711                                    PAYTO2A
  9712                                    PAYad1A
  9713                                    payad2a
  9714                                    PAYctyA
  9715                                    paysta
  9716                                    PTOZIPA.
  9717
  9718     GO TO 6690-EXIT.
  9719
  9720 6670-NO-BENEFICIARY.
  9721     MOVE -1                     TO  PAYTO1L.
  9722     MOVE ER-2394                TO  EMI-ERROR.
  9723     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 178
* EL677.cbl
  9724
  9725 6690-EXIT.
  9726      EXIT.
  9727 6700-build-common.
  9728     if not eracct-found
  9729        move pi-company-cd       to eracct-co
  9730        move pi-carrier          to eracct-carrier
  9731        move pi-grouping         to eracct-grouping
  9732        move pi-state            to eracct-state
  9733        move pi-account          to eracct-account
  9734        move pi-cert-eff-dt      to eracct-exp-date
  9735        perform 1420-get-eracct  thru 1490-exit
  9736     end-if
  9737*    if WS-PNDB-NOT-FOUND
  9738*       perform 5600-get-erpndb thru 5600-exit
  9739*    end-if
  9740     MOVE LOW-VALUES             TO  EL677AI.
  9741     MOVE 'A'                    TO  MAINTI.
  9742     MOVE AL-UANON               TO  MAINTA.
  9743     MOVE +1                     TO  MAINTL.
  9744     MOVE PI-CARRIER             TO  CARRIERO.
  9745     MOVE PI-GROUPING            TO  GROUPO.
  9746     MOVE PI-STATE               TO  STATEO.
  9747     MOVE PI-ACCOUNT             TO  ACCTO.
  9748     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9749     MOVE PI-CERT-SFX            TO  SFXO.
  9750     MOVE PI-AMOUNT              TO  AMOUNTO.
  9751*    MOVE PI-TYPE                TO  TYPEO.
  9752     move pi-check-type          to  typeo
  9753     move pi-return-to           to  rettoo
  9754*    MOVE PI-REFERENCE           TO  REFO.
  9755     MOVE PI-PAYTO1              TO  PAYTO1O.
  9756     MOVE AL-UANON               TO  CARRIERA
  9757                                     GROUPA
  9758                                     STATEA
  9759                                     ACCTA
  9760                                     CERTNOA
  9761                                     SFXA
  9762                                     PAYTO1A
  9763                                     PAYTO2A
  9764*                                    AMOUNTA
  9765*                                    TYPEA
  9766                                     rettoa.
  9767     move al-panon               to typea
  9768     move al-panon               to amounta
  9769     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9770     MOVE ' '                    TO  DC-OPTION-CODE.
  9771     PERFORM 8500-DATE-CONVERT.
  9772     IF NO-CONVERSION-ERROR
  9773         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9774         MOVE AL-UANON            TO  EFFDTA
  9775         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9776         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9777     ELSE
  9778         GO TO 8200-SEND-DATAONLY.
  9779     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9780         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
  9781         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 179
* EL677.cbl
  9782     ELSE
  9783         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9784         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9785     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9786     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9787     move spaces to pi-insured-name
  9788     string cm-insured-last-name ' '
  9789            cm-insured-first-name delimited by '  '
  9790        into pi-insured-name
  9791     end-string
  9792     move spaces                 to pi-table-name
  9793     string cm-insured-last-name ', '
  9794            cm-insured-first-name ' '
  9795            cm-insured-initial2
  9796        delimited by '  '
  9797        into
  9798           pi-table-name
  9799     end-string
  9800*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9801     if eibaid = dfhpf5
  9802        move 'Y'                 to dedcyni
  9803        move al-uanon            to dedcyna
  9804     end-if
  9805    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9806       cm-lf-alt-premium-amt
  9807    compute ws-tot-iss-prem  =
  9808       cm-ah-premium-amt + ws-tot-lf-prem
  9809    compute ws-tot-iss-comm =
  9810       (ws-tot-lf-prem * cm-life-comm-pct) +
  9811       (cm-ah-premium-amt * cm-ah-comm-pct)
  9812    compute ws-tot-ref-comm =
  9813       (pi-lf-refund * cm-life-comm-pct) +
  9814       (pi-ah-refund * cm-ah-comm-pct)
  9815     move ws-tot-iss-prem        to premo
  9816     move ws-tot-iss-comm        to isscommo
  9817     move al-sadof               to drefa
  9818                                    refa
  9819*    compute refo = pi-lf-refund + pi-ah-refund
  9820     move pi-prev-paid            to prepdo
  9821     move ws-tot-ref-comm         to uecommo
  9822                                     pi-ue-comm
  9823***  compute ws-refund-amount = pi-refund-on-pending-rec -
  9824***     pi-prev-paid
  9825     compute ws-refund-amount =
  9826        pi-refund-on-pending-rec - pi-prev-paid-this-month
  9827     if (ws-refund-amount + pi-prev-paid) > ws-tot-iss-prem
  9828        compute ws-refund-amount = pi-refund-on-pending-rec -
  9829           pi-prev-paid
  9830     end-if
  9831
  9832     if ws-refund-amount < zeros
  9833        move zeros               to ws-refund-amount
  9834     end-if
  9835     if (dedcyni = 'Y')
  9836        or (pi-prev-ded-comm = 'Y')
  9837        compute ws-refund-amount = ws-refund-amount -
  9838           ws-tot-ref-comm
  9839     end-if
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 180
* EL677.cbl
  9840     if pi-check-type = 'C'
  9841*       move pi-endt-prm-diff    to refo
  9842        move pi-endt-com-diff    to uecommo
  9843                                    pi-ue-comm
  9844        compute ws-refund-amount =
  9845           pi-endt-prm-diff - pi-prev-paid
  9846        if (dedcyni = 'Y')
  9847           or (pi-prev-ded-comm = 'Y')
  9848           compute ws-refund-amount = ws-refund-amount -
  9849              pi-endt-com-diff
  9850        end-if
  9851        if ws-refund-amount <= zeros
  9852           move pi-endt-prm-diff to ws-refund-amount
  9853        end-if
  9854     end-if
  9855     if not WS-CERT-NOT-FOUND
  9856        string
  9857           pi-cert-prime         ' : '
  9858           cm-insured-last-name  ', '
  9859           cm-insured-first-name ' : '
  9860           pi-account            ' : '
  9861           pi-am-csr delimited by '  ' into text1o
  9862        end-string
  9863        move al-uanon            to text1a
  9864        MOVE 'REF'               TO WS-USER-REASON
  9865        if pi-check-type = 'C'
  9866           move 'COR'            to ws-user-reason
  9867        end-if
  9868        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9869        inspect ws-user-cert-no replacing leading zeros
  9870           by spaces
  9871        move pi-insured-name     to ws-user-name
  9872        perform varying s1 from +1 by +1 until
  9873           (s1 > +11)
  9874           or (ws-user-cert-no (s1:1)) <> ' '
  9875        end-perform
  9876        string ws-user-reason  ' ' delimited by size
  9877               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9878                  delimited by size
  9879               cm-insured-last-name ' '
  9880               cm-insured-first-name delimited by '  '
  9881           into stubo
  9882        end-string
  9883        move al-uanon            to stuba
  9884     end-if
  9885     .
  9886 6700-exit.
  9887     exit.
  9888 6800-browse-previous-chek-recs.
  9889***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9890***                                                            ***
  9891**** this should be the first time through, we need to gather  ***
  9892**** all the erchek records for this pending record, add the   ***
  9893**** amounts and make sure this check request will not exceed  ***
  9894**** the collected premium                                     ***
  9895***                                                            ***
  9896***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9897     move zeros                  to pi-prev-paid
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 181
* EL677.cbl
  9898                                    pi-prev-paid-this-month
  9899                                    ws-browse-sw
  9900                                    pi-chek-rec-cnt
  9901     move spaces                 to pi-prev-ded-comm
  9902     move pi-company-cd          to chek-company-cd
  9903     move pi-carrier             to chek-carrier
  9904     move pi-grouping            to chek-grouping
  9905     move pi-state               to chek-state
  9906     move pi-account             to chek-account
  9907     move pi-cert-prime          to chek-cert-no
  9908     move pi-cert-sfx            to chek-suf-no
  9909     move pi-cert-eff-dt         to chek-eff-dt
  9910     move +0                     to chek-record-seq
  9911     move erchek-key             to ws-compare-erchek-key
  9912
  9913* EXEC CICS STARTBR
  9914*       DATASET  (ERCHEK-FILE-ID)
  9915*       RIDFLD   (ERCHEK-KEY)
  9916*       resp     (ws-response)
  9917*    END-EXEC
  9918     MOVE 0
  9919       TO DFHEIV11
  9920*    MOVE '&,         G          &  N#00009004' TO DFHEIV0
  9921     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9922     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9923     MOVE X'204E233030303039303034' TO DFHEIV0(25:11)
  9924     CALL 'kxdfhei1' USING DFHEIV0,
  9925           ERCHEK-FILE-ID,
  9926           ERCHEK-KEY,
  9927           DFHEIV99,
  9928           DFHEIV11,
  9929           DFHEIV99
  9930     MOVE EIBRESP  TO ws-response
  9931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9932     if not resp-normal
  9933        go to 6800-exit
  9934     end-if
  9935     perform until i-say-when
  9936
  9937* EXEC CICS READNEXT
  9938*          DATASET   (ERCHEK-FILE-ID)
  9939*          SET       (ADDRESS OF CHECK-RECORDS)
  9940*          RIDFLD    (ERCHEK-KEY)
  9941*          resp      (ws-response)
  9942*       END-EXEC
  9943     MOVE 0
  9944       TO DFHEIV11
  9945*    MOVE '&.S                   )  N#00009013' TO DFHEIV0
  9946     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9947     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9948     MOVE X'204E233030303039303133' TO DFHEIV0(25:11)
  9949     CALL 'kxdfhei1' USING DFHEIV0,
  9950           ERCHEK-FILE-ID,
  9951           DFHEIV20,
  9952           DFHEIV99,
  9953           ERCHEK-KEY,
  9954           DFHEIV99,
  9955           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 182
* EL677.cbl
  9956           DFHEIV99,
  9957           DFHEIV99
  9958     SET ADDRESS OF CHECK-RECORDS TO
  9959         DFHEIV20
  9960     MOVE EIBRESP  TO ws-response
  9961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9962        if resp-normal
  9963           and erchek-key (1:33) = ws-compare-erchek-key
  9964           if (ch-void-dt = low-values)
  9965              and (not ch-denied)
  9966              evaluate true
  9967                 when (pi-check-type = 'R')
  9968                    and (ch-check-origin-sw <> 'C')
  9969                    compute pi-prev-paid =
  9970                       pi-prev-paid + ch-amount-paid
  9971                    add +1 to pi-chek-rec-cnt
  9972                    move ch-deduct-commission
  9973                                 to pi-prev-ded-comm
  9974                    if ch-credit-select-dt = pi-cr-month-end-dt
  9975                       compute pi-prev-paid-this-month =
  9976                          pi-prev-paid-this-month + ch-amount-paid
  9977                    end-if
  9978              end-evaluate
  9979           end-if
  9980        else
  9981           set i-say-when to true
  9982        end-if
  9983     end-perform
  9984*     perform until i-say-when
  9985*        EXEC CICS READNEXT
  9986*           DATASET   (ERCHEK-FILE-ID)
  9987*           SET       (ADDRESS OF CHECK-RECORDS)
  9988*           RIDFLD    (ERCHEK-KEY)
  9989*           resp      (ws-response)
  9990*        END-EXEC
  9991*        if resp-normal
  9992*           and erchek-key (1:33) = ws-compare-erchek-key
  9993*           if (ch-void-dt = low-values)
  9994*              and (not ch-denied)
  9995*              if (pi-check-type = 'R')
  9996*                 and (ch-check-origin-sw = 'C')
  9997*                 continue
  9998*              else
  9999*                 compute pi-prev-paid = pi-prev-paid +
 10000*                    ch-amount-paid
 10001*                 add +1 to pi-chek-rec-cnt
 10002*                 move ch-deduct-commission
 10003*                                 to pi-prev-ded-comm
 10004*              end-if
 10005*           end-if
 10006*        else
 10007*           set i-say-when to true
 10008*        end-if
 10009*     end-perform
 10010     .
 10011 6800-exit.
 10012     exit.
 10013 7000-SET-PI-AREA.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 183
* EL677.cbl
 10014     MOVE CARRIERI               TO  PI-CARRIER
 10015                                     PI-CHEK-CARRIER.
 10016     MOVE GROUPI                 TO  PI-GROUPING
 10017                                     PI-CHEK-GROUPING.
 10018     MOVE STATEI                 TO  PI-STATE
 10019                                     PI-CHEK-STATE.
 10020     MOVE ACCTI                  TO  PI-ACCOUNT
 10021                                     PI-CHEK-ACCOUNT.
 10022     MOVE CERTNOI                TO  PI-CERT-PRIME
 10023                                     PI-CHEK-CERT-NO.
 10024     IF SFXI NOT = LOW-VALUES
 10025         MOVE SFXI               TO  PI-CERT-SFX
 10026                                     PI-CHEK-SUF-NO
 10027     ELSE
 10028         MOVE SPACE              TO  PI-CERT-SFX
 10029                                     PI-CHEK-SUF-NO.
 10030
 10031     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
 10032     MOVE '2'                    TO  DC-OPTION-CODE.
 10033     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10034     IF DATE-CONVERSION-ERROR
 10035         MOVE ER-0215            TO  EMI-ERROR
 10036         MOVE -1                 TO  EFFDTL
 10037         MOVE AL-UNBON           TO  EFFDTA
 10038         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10039         GO TO 8200-SEND-DATAONLY
 10040     ELSE
 10041         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
 10042                                     PI-CHEK-EFF-DT.
 10043
 10044 7090-EXIT.
 10045      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 184
* EL677.cbl
 10047 7100-CREATE-TEMP-STORAGE.
 10048     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
 10049
 10050
 10051* EXEC CICS WRITEQ TS
 10052*        QUEUE   (QID)
 10053*        FROM    (PROGRAM-INTERFACE-BLOCK)
 10054*        LENGTH  (PI-COMM-LENGTH)
 10055*    END-EXEC.
 10056*    MOVE '*"                    ''   #00009107' TO DFHEIV0
 10057     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 10058     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10059     MOVE X'2020233030303039313037' TO DFHEIV0(25:11)
 10060     CALL 'kxdfhei1' USING DFHEIV0,
 10061           QID,
 10062           PROGRAM-INTERFACE-BLOCK,
 10063           PI-COMM-LENGTH,
 10064           DFHEIV99,
 10065           DFHEIV99,
 10066           DFHEIV99
 10067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10068
 10069
 10070 7100-EXIT.
 10071      EXIT.
 10072
 10073 7200-RECOVER-TEMP-STORAGE.
 10074
 10075* EXEC CICS READQ TS
 10076*        QUEUE   (QID)
 10077*        INTO    (PROGRAM-INTERFACE-BLOCK)
 10078*        LENGTH  (PI-COMM-LENGTH)
 10079*    END-EXEC.
 10080*    MOVE '*$I    L              ''   #00009117' TO DFHEIV0
 10081     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
 10082     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10083     MOVE X'2020233030303039313137' TO DFHEIV0(25:11)
 10084     CALL 'kxdfhei1' USING DFHEIV0,
 10085           QID,
 10086           PROGRAM-INTERFACE-BLOCK,
 10087           PI-COMM-LENGTH,
 10088           DFHEIV99,
 10089           DFHEIV99,
 10090           DFHEIV99
 10091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10092
 10093
 10094     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
 10095
 10096 7200-EXIT.
 10097      EXIT.
 10098
 10099 7300-DELETE-TEMP-STORAGE.
 10100
 10101* EXEC CICS HANDLE CONDITION
 10102*        QIDERR  (7300-EXIT)
 10103*    END-EXEC.
 10104*    MOVE '"$N                   ! 3 #00009129' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 185
* EL677.cbl
 10105     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 10106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10107     MOVE X'3320233030303039313239' TO DFHEIV0(25:11)
 10108     CALL 'kxdfhei1' USING DFHEIV0
 10109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10110
 10111
 10112
 10113* EXEC CICS DELETEQ TS
 10114*        QUEUE  (QID)
 10115*    END-EXEC.
 10116*    MOVE '*&                    #   #00009133' TO DFHEIV0
 10117     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 10118     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10119     MOVE X'2020233030303039313333' TO DFHEIV0(25:11)
 10120     CALL 'kxdfhei1' USING DFHEIV0,
 10121           QID,
 10122           DFHEIV99
 10123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10124
 10125
 10126 7300-EXIT.
 10127      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 186
* EL677.cbl
 10129 8035-LETR-NOT-OPEN.
 10130
 10131     MOVE ER-0013                TO EMI-ERROR.
 10132*    MOVE -1                     TO LETTER1L
 10133     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10134     GO TO 8200-SEND-DATAONLY.
 10135
 10136 8035-EXIT.
 10137     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 187
* EL677.cbl
 10139 8100-SEND-INITIAL-MAP.
 10140     MOVE SAVE-DATE              TO  DATEO.
 10141     MOVE EIBTIME                TO  TIME-IN.
 10142     MOVE TIME-OUT               TO  TIMEO.
 10143     MOVE -1                     TO  MAINTL
 10144     move al-uanon               to mainta
 10145     if PI-TO-EL677-FROM-EL1273
 10146        move al-sadof            to pf357a
 10147                                    pf46a
 10148                                    dprema
 10149                                    dcomma
 10150                                    drefa
 10151                                    duecomma
 10152                                    dprepda
 10153                                    prema
 10154                                    isscomma
 10155                                    refa
 10156                                    uecomma
 10157                                    prepda
 10158                                    dmaint2a
 10159        move ', VOID(V)'         to dmaint1o
 10160     end-if
 10161     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10162     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10163
 10164
 10165* EXEC CICS SEND
 10166*        MAP      (EL677A)
 10167*        MAPSET   (MAPSET-NAME)
 10168*        FROM     (EL677AO)
 10169*        ERASE
 10170*        CURSOR
 10171*    END-EXEC.
 10172     MOVE LENGTH OF
 10173      EL677AO
 10174       TO DFHEIV12
 10175     MOVE -1
 10176       TO DFHEIV11
 10177*    MOVE '8$     CT  E    H L F ,   #00009175' TO DFHEIV0
 10178     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10179     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10180     MOVE X'2020233030303039313735' TO DFHEIV0(25:11)
 10181     CALL 'kxdfhei1' USING DFHEIV0,
 10182           EL677A,
 10183           EL677AO,
 10184           DFHEIV12,
 10185           MAPSET-NAME,
 10186           DFHEIV99,
 10187           DFHEIV99,
 10188           DFHEIV99,
 10189           DFHEIV11,
 10190           DFHEIV99,
 10191           DFHEIV99,
 10192           DFHEIV99
 10193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10194
 10195
 10196     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 188
* EL677.cbl
 10198 8200-SEND-DATAONLY.
 10199     if connected-to-db
 10200        perform 4300-FINISH-UP-DB thru 4300-exit
 10201     end-if
 10202     MOVE SAVE-DATE              TO  DATEO.
 10203     MOVE EIBTIME                TO  TIME-IN.
 10204     MOVE TIME-OUT               TO  TIMEO.
 10205     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10206     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10207
 10208
 10209* EXEC CICS SEND
 10210*        MAP     (EL677A)
 10211*        MAPSET  (MAPSET-NAME)
 10212*        FROM    (EL677AO)
 10213*        DATAONLY
 10214*        CURSOR
 10215*    END-EXEC.
 10216     MOVE LENGTH OF
 10217      EL677AO
 10218       TO DFHEIV12
 10219     MOVE -1
 10220       TO DFHEIV11
 10221*    MOVE '8$D    CT       H L F ,   #00009195' TO DFHEIV0
 10222     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10223     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10224     MOVE X'2020233030303039313935' TO DFHEIV0(25:11)
 10225     CALL 'kxdfhei1' USING DFHEIV0,
 10226           EL677A,
 10227           EL677AO,
 10228           DFHEIV12,
 10229           MAPSET-NAME,
 10230           DFHEIV99,
 10231           DFHEIV99,
 10232           DFHEIV99,
 10233           DFHEIV11,
 10234           DFHEIV99,
 10235           DFHEIV99,
 10236           DFHEIV99
 10237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10238
 10239
 10240     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 189
* EL677.cbl
 10242 8300-SEND-TEXT.
 10243
 10244* EXEC CICS SEND TEXT
 10245*        FROM     (LOGOFF-TEXT)
 10246*        LENGTH   (LOGOFF-LENGTH)
 10247*        ERASE
 10248*        FREEKB
 10249*    END-EXEC.
 10250*    MOVE '8&      T  E F  H   F -   #00009206' TO DFHEIV0
 10251     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10252     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10253     MOVE X'2020233030303039323036' TO DFHEIV0(25:11)
 10254     CALL 'kxdfhei1' USING DFHEIV0,
 10255           LOGOFF-TEXT,
 10256           LOGOFF-LENGTH,
 10257           DFHEIV99,
 10258           DFHEIV99,
 10259           DFHEIV99,
 10260           DFHEIV99,
 10261           DFHEIV99,
 10262           DFHEIV99,
 10263           DFHEIV99,
 10264           DFHEIV99,
 10265           DFHEIV99,
 10266           DFHEIV99
 10267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10268
 10269
 10270
 10271* EXEC CICS RETURN
 10272*    END-EXEC.
 10273*    MOVE '.(                    ''   #00009213' TO DFHEIV0
 10274     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10275     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10276     MOVE X'2020233030303039323133' TO DFHEIV0(25:11)
 10277     CALL 'kxdfhei1' USING DFHEIV0,
 10278           DFHEIV99,
 10279           DFHEIV99,
 10280           DFHEIV99,
 10281           DFHEIV99,
 10282           DFHEIV99,
 10283           DFHEIV99
 10284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10285
 10286
 10287 8500-DATE-CONVERT.
 10288     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10289
 10290
 10291* EXEC CICS LINK
 10292*        PROGRAM    (PGM-NAME)
 10293*        COMMAREA   (DATE-CONVERSION-DATA)
 10294*        LENGTH     (DC-COMM-LENGTH)
 10295*    END-EXEC.
 10296*    MOVE '."C                   (   #00009219' TO DFHEIV0
 10297     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10298     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10299     MOVE X'2020233030303039323139' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 190
* EL677.cbl
 10300     CALL 'kxdfhei1' USING DFHEIV0,
 10301           PGM-NAME,
 10302           DATE-CONVERSION-DATA,
 10303           DC-COMM-LENGTH,
 10304           DFHEIV99,
 10305           DFHEIV99,
 10306           DFHEIV99,
 10307           DFHEIV99
 10308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10309
 10310
 10311 8500-EXIT.
 10312      EXIT.
 10313
 10314 8600-DEEDIT.
 10315
 10316* EXEC CICS BIF DEEDIT
 10317*        FIELD   (WS-DEEDIT-FIELD)
 10318*        LENGTH  (10)
 10319*    END-EXEC.
 10320     MOVE 10
 10321       TO DFHEIV11
 10322*    MOVE '@"L                   #   #00009229' TO DFHEIV0
 10323     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10324     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10325     MOVE X'2020233030303039323239' TO DFHEIV0(25:11)
 10326     CALL 'kxdfhei1' USING DFHEIV0,
 10327           WS-DEEDIT-FIELD,
 10328           DFHEIV11
 10329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10330
 10331
 10332 8600-EXIT.
 10333      EXIT.
 10334
 10335 8700-DEEDIT.
 10336
 10337* EXEC CICS BIF DEEDIT
 10338*        FIELD   (WS-DT-DEEDIT-FIELD)
 10339*        LENGTH  (10)
 10340*    END-EXEC.
 10341     MOVE 10
 10342       TO DFHEIV11
 10343*    MOVE '@"L                   #   #00009238' TO DFHEIV0
 10344     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10345     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10346     MOVE X'2020233030303039323338' TO DFHEIV0(25:11)
 10347     CALL 'kxdfhei1' USING DFHEIV0,
 10348           WS-DT-DEEDIT-FIELD,
 10349           DFHEIV11
 10350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10351
 10352
 10353 8700-EXIT.
 10354      EXIT.
 10355
 10356 8800-UNAUTHORIZED-ACCESS.
 10357     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 191
* EL677.cbl
 10358     GO TO 8300-SEND-TEXT.
 10359
 10360 8810-PF23.
 10361     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10362     MOVE XCTL-005               TO  PGM-NAME.
 10363     GO TO 9300-XCTL.
 10364
 10365
 10366 9100-RETURN-TRAN.
 10367     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10368     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10369
 10370* EXEC CICS RETURN
 10371*        TRANSID  (TRANS-ID)
 10372*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10373*        LENGTH   (PI-COMM-LENGTH)
 10374*    END-EXEC.
 10375*    MOVE '.(CT                  ''   #00009259' TO DFHEIV0
 10376     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10378     MOVE X'2020233030303039323539' TO DFHEIV0(25:11)
 10379     CALL 'kxdfhei1' USING DFHEIV0,
 10380           TRANS-ID,
 10381           PROGRAM-INTERFACE-BLOCK,
 10382           PI-COMM-LENGTH,
 10383           DFHEIV99,
 10384           DFHEIV99,
 10385           DFHEIV99
 10386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10387
 10388
 10389
 10390* GOBACK.
 10391     MOVE '9%                    "   ' TO DFHEIV0
 10392     MOVE 'EL677' TO DFHEIV1
 10393     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10394     GOBACK.
 10395
 10396 9200-RETURN-MAIN-MENU.
 10397     MOVE XCTL-626               TO  PGM-NAME.
 10398     GO TO 9300-XCTL.
 10399
 10400 9300-XCTL.
 10401
 10402* EXEC CICS XCTL
 10403*        PROGRAM    (PGM-NAME)
 10404*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10405*        LENGTH     (PI-COMM-LENGTH)
 10406*    END-EXEC.
 10407*    MOVE '.$C                   %   #00009272' TO DFHEIV0
 10408     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10409     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10410     MOVE X'2020233030303039323732' TO DFHEIV0(25:11)
 10411     CALL 'kxdfhei1' USING DFHEIV0,
 10412           PGM-NAME,
 10413           PROGRAM-INTERFACE-BLOCK,
 10414           PI-COMM-LENGTH,
 10415           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 192
* EL677.cbl
 10416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10417
 10418
 10419 9400-CLEAR.
 10420     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10421     MOVE SPACES                 TO  PI-PFKEY.
 10422     GO TO 9300-XCTL.
 10423
 10424 9500-PF12.
 10425     MOVE XCTL-010               TO  PGM-NAME.
 10426     GO TO 9300-XCTL.
 10427
 10428 9600-PGMID-ERROR.
 10429
 10430* EXEC CICS HANDLE CONDITION
 10431*        PGMIDERR    (8300-SEND-TEXT)
 10432*    END-EXEC.
 10433*    MOVE '"$L                   ! 4 #00009288' TO DFHEIV0
 10434     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10435     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10436     MOVE X'3420233030303039323838' TO DFHEIV0(25:11)
 10437     CALL 'kxdfhei1' USING DFHEIV0
 10438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10439
 10440
 10441     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10442     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10443     MOVE XCTL-005               TO  PGM-NAME.
 10444     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10445     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10446
 10447     GO TO 9300-XCTL.
 10448
 10449 9900-ERROR-FORMAT.
 10450     IF NOT EMI-ERRORS-COMPLETE
 10451         MOVE LINK-001           TO  PGM-NAME
 10452
 10453* EXEC CICS LINK
 10454*            PROGRAM    (PGM-NAME)
 10455*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10456*            LENGTH     (EMI-COMM-LENGTH)
 10457*        END-EXEC.
 10458*    MOVE '."C                   (   #00009303' TO DFHEIV0
 10459     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10460     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10461     MOVE X'2020233030303039333033' TO DFHEIV0(25:11)
 10462     CALL 'kxdfhei1' USING DFHEIV0,
 10463           PGM-NAME,
 10464           ERROR-MESSAGE-INTERFACE-BLOCK,
 10465           EMI-COMM-LENGTH,
 10466           DFHEIV99,
 10467           DFHEIV99,
 10468           DFHEIV99,
 10469           DFHEIV99
 10470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10471
 10472
 10473 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 193
* EL677.cbl
 10474      EXIT.
 10475
 10476 9990-ABEND.
 10477     MOVE LINK-004               TO  PGM-NAME.
 10478     MOVE DFHEIBLK               TO  EMI-LINE1.
 10479
 10480* EXEC CICS LINK
 10481*        PROGRAM   (PGM-NAME)
 10482*        COMMAREA  (EMI-LINE1)
 10483*        LENGTH    (72)
 10484*    END-EXEC.
 10485     MOVE 72
 10486       TO DFHEIV11
 10487*    MOVE '."C                   (   #00009315' TO DFHEIV0
 10488     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10489     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10490     MOVE X'2020233030303039333135' TO DFHEIV0(25:11)
 10491     CALL 'kxdfhei1' USING DFHEIV0,
 10492           PGM-NAME,
 10493           EMI-LINE1,
 10494           DFHEIV11,
 10495           DFHEIV99,
 10496           DFHEIV99,
 10497           DFHEIV99,
 10498           DFHEIV99
 10499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10500
 10501
 10502     GO TO 8200-SEND-DATAONLY.
 10503
 10504 9995-SECURITY-VIOLATION.
 10505*                            COPY ELCSCTP.
 10506******************************************************************
 10507*                                                                *
 10508*                            ELCSCTP                             *
 10509*                            VMOD=2.001                          *
 10510*                                                                *
 10511*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10512******************************************************************
 10513
 10514
 10515     MOVE EIBDATE          TO SM-JUL-DATE.
 10516     MOVE EIBTRMID         TO SM-TERMID.
 10517     MOVE THIS-PGM         TO SM-PGM.
 10518     MOVE EIBTIME          TO TIME-IN.
 10519     MOVE TIME-OUT         TO SM-TIME.
 10520     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10521
 10522
 10523* EXEC CICS LINK
 10524*         PROGRAM  ('EL003')
 10525*         COMMAREA (SECURITY-MESSAGE)
 10526*         LENGTH   (80)
 10527*    END-EXEC.
 10528     MOVE 'EL003' TO DFHEIV1
 10529     MOVE 80
 10530       TO DFHEIV11
 10531*    MOVE '."C                   (   #00009341' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 194
* EL677.cbl
 10532     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10533     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10534     MOVE X'2020233030303039333431' TO DFHEIV0(25:11)
 10535     CALL 'kxdfhei1' USING DFHEIV0,
 10536           DFHEIV1,
 10537           SECURITY-MESSAGE,
 10538           DFHEIV11,
 10539           DFHEIV99,
 10540           DFHEIV99,
 10541           DFHEIV99,
 10542           DFHEIV99
 10543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10544
 10545
 10546******************************************************************
 10547
 10548
 10549 9995-EXIT.
 10550     EXIT.
 10551
 10552
 10553 9999-DFHBACK SECTION.
 10554     MOVE '9%                    "   ' TO DFHEIV0
 10555     MOVE 'EL677' TO DFHEIV1
 10556     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10557     GOBACK.
 10558 9999-DFHEXIT.
 10559     IF DFHEIGDJ EQUAL 0001
 10560         NEXT SENTENCE
 10561     ELSE IF DFHEIGDJ EQUAL 2
 10562         GO TO 9600-PGMID-ERROR,
 10563               9990-ABEND
 10564         DEPENDING ON DFHEIGDI
 10565     ELSE IF DFHEIGDJ EQUAL 3
 10566         GO TO 8100-SEND-INITIAL-MAP
 10567         DEPENDING ON DFHEIGDI
 10568     ELSE IF DFHEIGDJ EQUAL 4
 10569         GO TO 1290-NO-CARRIER
 10570         DEPENDING ON DFHEIGDI
 10571     ELSE IF DFHEIGDJ EQUAL 5
 10572         GO TO 1380-NO-STATE
 10573         DEPENDING ON DFHEIGDI
 10574     ELSE IF DFHEIGDJ EQUAL 6
 10575         GO TO 1480-ACCOUNT-INVALID,
 10576               1480-ACCOUNT-INVALID
 10577         DEPENDING ON DFHEIGDI
 10578     ELSE IF DFHEIGDJ EQUAL 7
 10579         GO TO 1590-EXIT
 10580         DEPENDING ON DFHEIGDI
 10581     ELSE IF DFHEIGDJ EQUAL 8
 10582         GO TO 2200-DUPREC
 10583         DEPENDING ON DFHEIGDI
 10584     ELSE IF DFHEIGDJ EQUAL 9
 10585         GO TO 2577-DUPREC
 10586         DEPENDING ON DFHEIGDI
 10587     ELSE IF DFHEIGDJ EQUAL 10
 10588         GO TO 2600-NO-CO-MASTER
 10589         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 06-Dec-16 09:26 Page 195
* EL677.cbl
 10590     ELSE IF DFHEIGDJ EQUAL 11
 10591         GO TO 3900-RECORD-NOTFND
 10592         DEPENDING ON DFHEIGDI
 10593     ELSE IF DFHEIGDJ EQUAL 12
 10594         GO TO 3287-DUPREC
 10595         DEPENDING ON DFHEIGDI
 10596     ELSE IF DFHEIGDJ EQUAL 13
 10597         GO TO 3390-EXIT,
 10598               3390-EXIT
 10599         DEPENDING ON DFHEIGDI
 10600     ELSE IF DFHEIGDJ EQUAL 14
 10601         GO TO 5560-END-OF-FILE,
 10602               5560-END-OF-FILE
 10603         DEPENDING ON DFHEIGDI
 10604     ELSE IF DFHEIGDJ EQUAL 15
 10605         GO TO 6070-NO-COMP-MSTR
 10606         DEPENDING ON DFHEIGDI
 10607     ELSE IF DFHEIGDJ EQUAL 16
 10608         GO TO 6170-NO-CERTIFICATE
 10609         DEPENDING ON DFHEIGDI
 10610     ELSE IF DFHEIGDJ EQUAL 17
 10611         GO TO 6470-NO-ADDRESS
 10612         DEPENDING ON DFHEIGDI
 10613     ELSE IF DFHEIGDJ EQUAL 18
 10614         GO TO 6670-NO-beneficiary
 10615         DEPENDING ON DFHEIGDI
 10616     ELSE IF DFHEIGDJ EQUAL 19
 10617         GO TO 7300-EXIT
 10618         DEPENDING ON DFHEIGDI
 10619     ELSE IF DFHEIGDJ EQUAL 20
 10620         GO TO 8300-SEND-TEXT
 10621         DEPENDING ON DFHEIGDI.
 10622     MOVE '9%                    "   ' TO DFHEIV0
 10623     MOVE 'EL677' TO DFHEIV1
 10624     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10625     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      142324     Code:       39609
