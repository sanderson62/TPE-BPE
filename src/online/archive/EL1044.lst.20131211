* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page   1
* EL1044.cbl
* Options: int("EL1044.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1044.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1044.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1044.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL1044.
     3*
     4*AUTHOR.     PABLO
     5*            OMAHA NE
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
    12*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    13*            *   CENTRAL STATES                                  *
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page   2
* EL1044.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE Z LETTER CONTROLS FOR ACCOUNT SERVICES
    19*    SCREENS     - EL1044Z - LETTER (Z) CONTROL MAINTENANCE
    20*    ENTERED BY  - EL1042 - TEXT MAINT
    21*    EXIT TO     - EL1042 - TEXT MAINT
    22*    INPUT FILE  - ELLETR -              - LETTER TEXT
    23*    OUTPUT FILE - ELLETR -              - LETTER TEXT
    24*    COMMAREA    - PASSED
    25*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL1042. ON
    26*                  FIRST ENTRY, WE READ THE ELLETR FILE USING THE
    27*                  LETTER ID PASSED FROM EL1042.     ON SUBSEQUENT
    28*                  ENTRIES (XCTL FROM CICS VIA     ) THE SCREEN
    29*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    30*                  MAINTENANCE TYPE INDICATED.
    31******************************************************************
    32*                   C H A N G E   L O G
    33*
    34* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    35*-----------------------------------------------------------------
    36*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    37* EFFECTIVE    NUMBER
    38*-----------------------------------------------------------------
    39* 122011    2011022800001  AJRA  ADD ELCZREC COPYBOOK
    40* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
    41* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
    42* 080113    2013062000003  AJRA  ADD BARCODE,RETURN ENV FLAG
    43******************************************************************
    44 ENVIRONMENT DIVISION.
    45 DATA DIVISION.
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*   EL1044 WORKING STORAGE     *'.
    50 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    51 77  M1                          PIC S999 COMP-3 VALUE +0.
    52 77  M2                          PIC S999 COMP-3 VALUE +0.
    53 77  WS-STOP-SW                  PIC X  VALUE ' '.
    54     88  I-SAY-TO-STOP              VALUE 'Y'.
    55 77  WS-FIND-SW                  PIC X  VALUE ' '.
    56     88  WE-FOUND-IT                VALUE 'Y'.
    57 77  WS-SEQ-NO-TO-USE            PIC S9(4) COMP VALUE +0.
    58 01  ACCESS-KEYS.
    59     12  ELLETR-KEY.
    60         16  ELLETR-COMPANY-CD   PIC X.
    61         16  ELLETR-ACCESS-CD    PIC X(12).
    62         16  ELLETR-SEQ-NO       PIC S9(4) COMP.
    63 01  WS-DATE-AREA.
    64     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
    65     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
    66 01  MISC-WORK-AREAS.
    67     12  WS-RESPONSE             PIC S9(8)   COMP.
    68         88  RESP-NORMAL              VALUE +00.
    69         88  RESP-ERROR               VALUE +01.
    70         88  RESP-NOTFND              VALUE +13.
    71         88  RESP-NOTOPEN             VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page   3
* EL1044.cbl
    72         88  RESP-ENDFILE             VALUE +20.
    73     12  WS-NUMVAL.
    74         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
    75         16  WS-9V999-OF-DEEDIT REDEFINES
    76             WS-NUMVAL-OF-DEEDIT     PIC 9(8)V999.
    77     12  DEEDIT-FIELD                PIC X(11).
    78     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    79                                     PIC S9(11).
    80     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    81                                     PIC S9(09)V99.
    82 01  STANDARD-AREAS.
    83     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
    84     12  TRANS-ID                    PIC X(04)   VALUE 'EX1F'.
    85     12  PGM-NAME                    PIC X(08).
    86     12  TIME-IN                     PIC S9(07).
    87     12  TIME-OUT-R  REDEFINES TIME-IN.
    88         16  FILLER                  PIC X(01).
    89         16  TIME-OUT                PIC 99V99.
    90         16  FILLER                  PIC X(02).
    91     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
    92     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
    93     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
    94     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
    95     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
    96     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
    97     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
    98     12  THIS-PGM                    PIC X(08)   VALUE 'EL1044'.
    99     12  ELLETR-FILE-ID              PIC X(08)   VALUE 'ELLETR'.
   100     12  ELLETR-LENGTH               PIC S9(04)  VALUE +100  COMP.
   101     12  SUB                         PIC 9(02).
   102     12  SUB-1                       PIC 9(02).
   103     12  SUB2                        PIC 9(02).
   104     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
   105     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL1044S'.
   106     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL1044Z'.
   107     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
   108****  Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   109*                                    COPY ELCZREC.
   110******************************************************************
   111*                                                                *
   112*                                                                *
   113*                            ELCZREC.                            *
   114*                                                                *
   115*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   116*                                                                *
   117******************************************************************
   118*-----------------------------------------------------------------
   119*                   C H A N G E   L O G
   120*
   121* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   122*-----------------------------------------------------------------
   123*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   124* EFFECTIVE    NUMBER
   125*-----------------------------------------------------------------
   126* 122011    2011022800001  AJRA  NEW FILE
   127* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   128* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   129* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page   4
* EL1044.cbl
   130*-----------------------------------------------------------------
   131 01  W-Z-CONTROL-DATA.
   132     05  W-NUMBER-OF-COPIES      PIC  9.
   133     05  FILLER                  PIC  X.
   134     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   135     05  FILLER                  PIC  X.
   136     05  W-DAYS-TO-RESEND        PIC  999.
   137     05  FILLER                  PIC  X.
   138     05  W-FORM-TO-RESEND        PIC  X(4).
   139     05  W-ADD-BAR-CODE          PIC  X.
   140     05  W-PROMPT-LETTER         PIC  X.
   141     05  W-HAS-RETURN-ENV        PIC  X.
   142     05  W-ENCLOSURE-CD          PIC  XXX.
   143     05  FILLER                  PIC  X.
   144     05  W-AUTO-CLOSE-IND        PIC  X.
   145     05  FILLER                  PIC  X.
   146     05  W-LETTER-TO-BENE        PIC  X.
   147     05  FILLER                  PIC  X.
   148     05  W-LETTER-TO-ACCT        PIC  X.
   149     05  FILLER                  PIC  X.
   150     05  W-LETTER-TYPE           PIC  X.
   151     05  FILLER                  PIC  X.
   152     05  W-PRINT-CERTIFICATE     PIC  X.
   153     05  FILLER                  PIC  X.
   154     05  W-REFUND-REQUIRED       PIC  X.
   155     05  FILLER                  PIC  X.
   156     05  W-ONBASE-CODE           PIC  XX.
   157     05  FILLER                  PIC  X.
   158     05  W-ACCT-SUMM             PIC  X.
   159     05  FILLER                  PIC  X.
   160     05  W-CSO-SUMM              PIC  X.
   161     05  FILLER                  PIC  X.
   162     05  W-REASONS-REQUIRED      PIC  X.
   163     05  FILLER                  PIC  X(29).
   164*                                    COPY ELCSCTM.
   165******************************************************************
   166*                                                                *
   167*                                                                *
   168*                            ELCSCTM                             *
   169*                            VMOD=2.001                          *
   170*                                                                *
   171*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   172*                                                                *
   173******************************************************************
   174 01  SECURITY-MESSAGE.
   175     12  FILLER                          PIC X(30)
   176            VALUE '** LOGIC SECURITY VIOLATION -'.
   177     12  SM-READ                         PIC X(6).
   178     12  FILLER                          PIC X(5)
   179            VALUE ' PGM='.
   180     12  SM-PGM                          PIC X(6).
   181     12  FILLER                          PIC X(5)
   182            VALUE ' OPR='.
   183     12  SM-PROCESSOR-ID                 PIC X(4).
   184     12  FILLER                          PIC X(6)
   185            VALUE ' TERM='.
   186     12  SM-TERMID                       PIC X(4).
   187     12  FILLER                          PIC XX   VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page   5
* EL1044.cbl
   188     12  SM-JUL-DATE                     PIC 9(5).
   189     12  FILLER                          PIC X    VALUE SPACE.
   190     12  SM-TIME                         PIC 99.99.
   191
   192*                                    COPY ELCSCRTY.
   193******************************************************************
   194*                                                                *
   195*                                                                *
   196*                            ELCSCRTY                            *
   197*                            VMOD=2.001                          *
   198*                                                                *
   199*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   200*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   201*        SAVED IN PI-SECURITY-ADDRESS.                           *
   202*                                                                *
   203******************************************************************
   204 01  SECURITY-CONTROL.
   205     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   206     12  FILLER                       PIC XX    VALUE 'SC'.
   207     12  SC-CREDIT-CODES.
   208         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   209             20  SC-CREDIT-DISPLAY    PIC X.
   210             20  SC-CREDIT-UPDATE     PIC X.
   211     12  SC-CLAIMS-CODES.
   212         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   213             20  SC-CLAIMS-DISPLAY    PIC X.
   214             20  SC-CLAIMS-UPDATE     PIC X.
   215 01  ERROR-MESSAGES.
   216     12  ER-0000                     PIC X(04)   VALUE '0000'.
   217     12  ER-0005                     PIC X(04)   VALUE '0005'.
   218     12  ER-0023                     PIC X(04)   VALUE '0023'.
   219     12  ER-0029                     PIC X(04)   VALUE '0029'.
   220     12  ER-0050                     PIC X(04)   VALUE '0050'.
   221     12  ER-0068                     PIC X(04)   VALUE '0068'.
   222     12  ER-0070                     PIC X(04)   VALUE '0070'.
   223     12  ER-0130                     PIC X(04)   VALUE '0130'.
   224     12  ER-0131                     PIC X(04)   VALUE '0131'.
   225     12  ER-0132                     PIC X(04)   VALUE '0132'.
   226     12  ER-0138                     PIC X(04)   VALUE '0138'.
   227     12  ER-0144                     PIC X(04)   VALUE '0144'.
   228     12  ER-0145                     PIC X(04)   VALUE '0145'.
   229     12  ER-0184                     PIC X(04)   VALUE '0184'.
   230     12  ER-0418                     PIC X(04)   VALUE '0418'.
   231     12  ER-0491                     PIC X(04)   VALUE '0491'.
   232     12  ER-0582                     PIC X(04)   VALUE '0582'.
   233     12  ER-0627                     PIC X(04)   VALUE '0627'.
   234     12  ER-0701                     PIC X(04)   VALUE '0701'.
   235     12  ER-0702                     PIC X(04)   VALUE '0702'.
   236     12  ER-0703                     PIC X(04)   VALUE '0703'.
   237     12  ER-0704                     PIC X(04)   VALUE '0704'.
   238     12  ER-0705                     PIC X(04)   VALUE '0705'.
   239     12  ER-0706                     PIC X(04)   VALUE '0706'.
   240     12  ER-0707                     PIC X(04)   VALUE '0707'.
   241     12  ER-0708                     PIC X(04)   VALUE '0708'.
   242     12  ER-0709                     PIC X(04)   VALUE '0709'.
   243     12  ER-0710                     PIC X(04)   VALUE '0710'.
   244     12  ER-0711                     PIC X(04)   VALUE '0711'.
   245     12  ER-0712                     PIC X(04)   VALUE '0712'.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page   6
* EL1044.cbl
   246     12  ER-0713                     PIC X(04)   VALUE '0713'.
   247     12  ER-0717                     PIC X(04)   VALUE '0717'.
   248     12  ER-0718                     PIC X(04)   VALUE '0718'.
   249     12  ER-0719                     PIC X(04)   VALUE '0719'.
   250     12  ER-0720                     PIC X(04)   VALUE '0720'.
   251     12  ER-0721                     PIC X(04)   VALUE '0721'.
   252     12  ER-0722                     PIC X(04)   VALUE '0722'.
   253     12  ER-0723                     PIC X(04)   VALUE '0723'.
   254     12  ER-0724                     PIC X(04)   VALUE '0724'.
   255     12  ER-0725                     PIC X(04)   VALUE '0725'.
   256     12  ER-0726                     PIC X(04)   VALUE '0726'.
   257     12  ER-0727                     PIC X(04)   VALUE '0727'.
   258     12  ER-0729                     PIC X(04)   VALUE '0729'.
   259     12  ER-0754                     PIC X(04)   VALUE '0754'.
   260     12  ER-1560                     PIC X(04)   VALUE '1560'.
   261     12  ER-1562                     PIC X(04)   VALUE '1562'.
   262     12  ER-1564                     PIC X(04)   VALUE '1564'.
   263     12  ER-2241                     PIC X(04)   VALUE '2241'.
   264     12  ER-2276                     PIC X(04)   VALUE '2276'.
   265     12  ER-3804                     PIC X(04)   VALUE '3804'.
   266     12  ER-3820                     PIC X(04)   VALUE '3820'.
   267     12  ER-3821                     PIC X(04)   VALUE '3821'.
   268     12  ER-7008                     PIC X(04)   VALUE '7008'.
   269     12  ER-7031                     PIC X(04)   VALUE '7031'.
   270     12  ER-7123                     PIC X(04)   VALUE '7123'.
   271     12  ER-8150                     PIC X(04)   VALUE '8150'.
   272     12  ER-9999                     PIC XXXX    VALUE '9999'.
   273*                                    COPY ELCDATE.
   274******************************************************************
   275*                                                                *
   276*                                                                *
   277*                            ELCDATE.                            *
   278*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   279*                            VMOD=2.003
   280*                                                                *
   281*                                                                *
   282*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   283*                 LENGTH = 200                                   *
   284******************************************************************
   285
   286 01  DATE-CONVERSION-DATA.
   287     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   288     12  DC-OPTION-CODE                PIC X.
   289         88  BIN-TO-GREG                VALUE ' '.
   290         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   291         88  EDIT-GREG-TO-BIN           VALUE '2'.
   292         88  YMD-GREG-TO-BIN            VALUE '3'.
   293         88  MDY-GREG-TO-BIN            VALUE '4'.
   294         88  JULIAN-TO-BIN              VALUE '5'.
   295         88  BIN-PLUS-ELAPSED           VALUE '6'.
   296         88  FIND-CENTURY               VALUE '7'.
   297         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   298         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   299         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   300         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   301         88  JULIAN-TO-BIN-3            VALUE 'C'.
   302         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   303         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page   7
* EL1044.cbl
   304         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   305         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   306         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   307         88  CHECK-LEAP-YEAR            VALUE 'H'.
   308         88  BIN-3-TO-GREG              VALUE 'I'.
   309         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   310         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   311         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   312         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   313         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   314         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   315         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   316         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   317         88  THREE-CHARACTER-BIN
   318                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   319         88  GREGORIAN-TO-BIN
   320                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   321         88  BIN-TO-GREGORIAN
   322                  VALUES ' ' '1' 'I' '8' 'G'.
   323         88  JULIAN-TO-BINARY
   324                  VALUES '5' 'C' 'E' 'F'.
   325     12  DC-ERROR-CODE                 PIC X.
   326         88  NO-CONVERSION-ERROR        VALUE ' '.
   327         88  DATE-CONVERSION-ERROR
   328                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   329         88  DATE-IS-ZERO               VALUE '1'.
   330         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   331         88  DATE-IS-INVALID            VALUE '3'.
   332         88  DATE1-GREATER-DATE2        VALUE '4'.
   333         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   334         88  DATE-INVALID-OPTION        VALUE '9'.
   335         88  INVALID-CENTURY            VALUE 'A'.
   336         88  ONLY-CENTURY               VALUE 'B'.
   337         88  ONLY-LEAP-YEAR             VALUE 'C'.
   338         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   339     12  DC-END-OF-MONTH               PIC X.
   340         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   341     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   342         88  USE-NORMAL-PROCESS         VALUE ' '.
   343         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   344         88  ADJUST-UP-100-YRS          VALUE '2'.
   345     12  FILLER                        PIC X.
   346     12  DC-CONVERSION-DATES.
   347         16  DC-BIN-DATE-1             PIC XX.
   348         16  DC-BIN-DATE-2             PIC XX.
   349         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   350         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   351                       DC-GREG-DATE-1-EDIT.
   352             20  DC-EDIT1-MONTH        PIC 99.
   353             20  SLASH1-1              PIC X.
   354             20  DC-EDIT1-DAY          PIC 99.
   355             20  SLASH1-2              PIC X.
   356             20  DC-EDIT1-YEAR         PIC 99.
   357         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   358         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   359                     DC-GREG-DATE-2-EDIT.
   360             20  DC-EDIT2-MONTH        PIC 99.
   361             20  SLASH2-1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page   8
* EL1044.cbl
   362             20  DC-EDIT2-DAY          PIC 99.
   363             20  SLASH2-2              PIC X.
   364             20  DC-EDIT2-YEAR         PIC 99.
   365         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   366         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   367                     DC-GREG-DATE-1-YMD.
   368             20  DC-YMD-YEAR           PIC 99.
   369             20  DC-YMD-MONTH          PIC 99.
   370             20  DC-YMD-DAY            PIC 99.
   371         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   372         16  DC-GREG-DATE-1-MDY-R REDEFINES
   373                      DC-GREG-DATE-1-MDY.
   374             20  DC-MDY-MONTH          PIC 99.
   375             20  DC-MDY-DAY            PIC 99.
   376             20  DC-MDY-YEAR           PIC 99.
   377         16  DC-GREG-DATE-1-ALPHA.
   378             20  DC-ALPHA-MONTH        PIC X(10).
   379             20  DC-ALPHA-DAY          PIC 99.
   380             20  FILLER                PIC XX.
   381             20  DC-ALPHA-CENTURY.
   382                 24 DC-ALPHA-CEN-N     PIC 99.
   383             20  DC-ALPHA-YEAR         PIC 99.
   384         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   385         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   386         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   387         16  DC-JULIAN-DATE            PIC 9(05).
   388         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   389                                       PIC 9(05).
   390         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   391             20  DC-JULIAN-YEAR        PIC 99.
   392             20  DC-JULIAN-DAYS        PIC 999.
   393         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   394         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   395         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   396     12  DATE-CONVERSION-VARIBLES.
   397         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   398         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   399             20  FILLER                PIC 9(3).
   400             20  HOLD-CEN-1-CCYY.
   401                 24  HOLD-CEN-1-CC     PIC 99.
   402                 24  HOLD-CEN-1-YY     PIC 99.
   403             20  HOLD-CEN-1-MO         PIC 99.
   404             20  HOLD-CEN-1-DA         PIC 99.
   405         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   406             20  HOLD-CEN-1-R-MO       PIC 99.
   407             20  HOLD-CEN-1-R-DA       PIC 99.
   408             20  HOLD-CEN-1-R-CCYY.
   409                 24  HOLD-CEN-1-R-CC   PIC 99.
   410                 24  HOLD-CEN-1-R-YY   PIC 99.
   411             20  FILLER                PIC 9(3).
   412         16  HOLD-CENTURY-1-X.
   413             20  FILLER                PIC X(3)  VALUE SPACES.
   414             20  HOLD-CEN-1-X-CCYY.
   415                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   416                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   417             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   418             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   419         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page   9
* EL1044.cbl
   420             20  HOLD-CEN-1-R-X-MO     PIC XX.
   421             20  HOLD-CEN-1-R-X-DA     PIC XX.
   422             20  HOLD-CEN-1-R-X-CCYY.
   423                 24  HOLD-CEN-1-R-X-CC PIC XX.
   424                 24  HOLD-CEN-1-R-X-YY PIC XX.
   425             20  FILLER                PIC XXX.
   426         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   427         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   428         16  DC-JULIAN-DATE-1          PIC 9(07).
   429         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   430             20  DC-JULIAN-1-CCYY.
   431                 24  DC-JULIAN-1-CC    PIC 99.
   432                 24  DC-JULIAN-1-YR    PIC 99.
   433             20  DC-JULIAN-DA-1        PIC 999.
   434         16  DC-JULIAN-DATE-2          PIC 9(07).
   435         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   436             20  DC-JULIAN-2-CCYY.
   437                 24  DC-JULIAN-2-CC    PIC 99.
   438                 24  DC-JULIAN-2-YR    PIC 99.
   439             20  DC-JULIAN-DA-2        PIC 999.
   440         16  DC-GREG-DATE-A-EDIT.
   441             20  DC-EDITA-MONTH        PIC 99.
   442             20  SLASHA-1              PIC X VALUE '/'.
   443             20  DC-EDITA-DAY          PIC 99.
   444             20  SLASHA-2              PIC X VALUE '/'.
   445             20  DC-EDITA-CCYY.
   446                 24  DC-EDITA-CENT     PIC 99.
   447                 24  DC-EDITA-YEAR     PIC 99.
   448         16  DC-GREG-DATE-B-EDIT.
   449             20  DC-EDITB-MONTH        PIC 99.
   450             20  SLASHB-1              PIC X VALUE '/'.
   451             20  DC-EDITB-DAY          PIC 99.
   452             20  SLASHB-2              PIC X VALUE '/'.
   453             20  DC-EDITB-CCYY.
   454                 24  DC-EDITB-CENT     PIC 99.
   455                 24  DC-EDITB-YEAR     PIC 99.
   456         16  DC-GREG-DATE-CYMD         PIC 9(08).
   457         16  DC-GREG-DATE-CYMD-R REDEFINES
   458                              DC-GREG-DATE-CYMD.
   459             20  DC-CYMD-CEN           PIC 99.
   460             20  DC-CYMD-YEAR          PIC 99.
   461             20  DC-CYMD-MONTH         PIC 99.
   462             20  DC-CYMD-DAY           PIC 99.
   463         16  DC-GREG-DATE-MDCY         PIC 9(08).
   464         16  DC-GREG-DATE-MDCY-R REDEFINES
   465                              DC-GREG-DATE-MDCY.
   466             20  DC-MDCY-MONTH         PIC 99.
   467             20  DC-MDCY-DAY           PIC 99.
   468             20  DC-MDCY-CEN           PIC 99.
   469             20  DC-MDCY-YEAR          PIC 99.
   470    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   471        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   472    12  DC-EL310-DATE                  PIC X(21).
   473    12  FILLER                         PIC X(28).
   474*                                    COPY ELCLOGOF.
   475******************************************************************
   476*                                                                *
   477*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  10
* EL1044.cbl
   478*                            ELCLOGOF.                           *
   479*                            VMOD=2.001                          *
   480*                                                                *
   481*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   482*                                                                *
   483******************************************************************
   484 01  CLASIC-LOGOFF.
   485     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   486     12  LOGOFF-TEXT.
   487         16  FILLER          PIC X(5)    VALUE SPACES.
   488         16  LOGOFF-MSG.
   489             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   490             20  FILLER      PIC X       VALUE SPACES.
   491             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   492         16  FILLER          PIC X(80)
   493           VALUE '* YOU ARE NOW LOGGED OFF'.
   494         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   495         16  FILLER          PIC X       VALUE QUOTE.
   496         16  LOGOFF-SYS-MSG  PIC X(17)
   497           VALUE 'S CLAS-IC SYSTEM '.
   498     12  TEXT-MESSAGES.
   499         16  UNACCESS-MSG    PIC X(29)
   500             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   501         16  PGMIDERR-MSG    PIC X(17)
   502             VALUE 'PROGRAM NOT FOUND'.
   503*                                    COPY ELCATTR.
   504******************************************************************
   505*                                                                *
   506*                            ELCATTR.                            *
   507*                            VMOD=2.001                          *
   508*                                                                *
   509*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   510*                                                                *
   511*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   512*                                                                *
   513*                   POS 1   P=PROTECTED                          *
   514*                           U=UNPROTECTED                        *
   515*                           S=ASKIP                              *
   516*                   POS 2   A=ALPHA/NUMERIC                      *
   517*                           N=NUMERIC                            *
   518*                   POS 3   N=NORMAL                             *
   519*                           B=BRIGHT                             *
   520*                           D=DARK                               *
   521*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   522*                           OF=MODIFIED DATA TAG OFF             *
   523*                                                                *
   524*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   525******************************************************************
   526 01  ATTRIBUTE-LIST.
   527     12  AL-PABOF            PIC X       VALUE 'Y'.
   528     12  AL-PABON            PIC X       VALUE 'Z'.
   529     12  AL-PADOF            PIC X       VALUE '%'.
   530     12  AL-PADON            PIC X       VALUE '_'.
   531     12  AL-PANOF            PIC X       VALUE '-'.
   532     12  AL-PANON            PIC X       VALUE '/'.
   533     12  AL-SABOF            PIC X       VALUE '8'.
   534     12  AL-SABON            PIC X       VALUE '9'.
   535     12  AL-SADOF            PIC X       VALUE '@'.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  11
* EL1044.cbl
   536     12  AL-SADON            PIC X       VALUE QUOTE.
   537     12  AL-SANOF            PIC X       VALUE '0'.
   538     12  AL-SANON            PIC X       VALUE '1'.
   539     12  AL-UABOF            PIC X       VALUE 'H'.
   540     12  AL-UABON            PIC X       VALUE 'I'.
   541     12  AL-UADOF            PIC X       VALUE '<'.
   542     12  AL-UADON            PIC X       VALUE '('.
   543     12  AL-UANOF            PIC X       VALUE ' '.
   544     12  AL-UANON            PIC X       VALUE 'A'.
   545     12  AL-UNBOF            PIC X       VALUE 'Q'.
   546     12  AL-UNBON            PIC X       VALUE 'R'.
   547     12  AL-UNDOF            PIC X       VALUE '*'.
   548     12  AL-UNDON            PIC X       VALUE ')'.
   549     12  AL-UNNOF            PIC X       VALUE '&'.
   550     12  AL-UNNON            PIC X       VALUE 'J'.
   551*                                    COPY ELCEMIB.
   552******************************************************************
   553*                                                                *
   554*                                                                *
   555*                            ELCEMIB.                            *
   556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   557*                            VMOD=2.005                          *
   558*                                                                *
   559*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   560*                                                                *
   561******************************************************************
   562 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   563     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   564     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   565     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   566     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   567     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   568     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   569     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   570     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   571     12  EMI-SWITCH1             PIC X        VALUE '1'.
   572         88  EMI-NO-ERRORS                    VALUE '1'.
   573         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   574         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   575     12  EMI-SWITCH2             PIC X        VALUE '1'.
   576         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   577     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   578         88  EMI-AREA1-EMPTY                  VALUE '1'.
   579         88  EMI-AREA1-FULL                   VALUE '2'.
   580     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   581         88  EMI-AREA2-EMPTY                  VALUE '1'.
   582         88  EMI-AREA2-FULL                   VALUE '2'.
   583     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   584         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   585         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   586         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   587         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   588         88  EMI-BYPASS-FATALS                VALUE 'X'.
   589     12  EMI-ERROR-LINES.
   590         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   591         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   592         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   593         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  12
* EL1044.cbl
   594             20  EMI-ERR-CODES OCCURS 10 TIMES.
   595                 24  EMI-ERR-NUM         PIC X(4).
   596                 24  EMI-FILLER          PIC X.
   597                 24  EMI-SEV             PIC X.
   598                 24  FILLER              PIC X.
   599             20  FILLER                  PIC X(02).
   600     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   601         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   602             20  EMI-ERROR-NUMBER    PIC X(4).
   603             20  EMI-FILL            PIC X.
   604             20  EMI-SEVERITY        PIC X.
   605             20  FILLER              PIC X.
   606             20  EMI-ERROR-TEXT.
   607                 24  EMI-TEXT-VARIABLE   PIC X(10).
   608                 24  FILLER          PIC X(55).
   609     12  EMI-SEVERITY-SAVE           PIC X.
   610         88  EMI-NOTE                    VALUE 'N'.
   611         88  EMI-WARNING                 VALUE 'W'.
   612         88  EMI-FORCABLE                VALUE 'F'.
   613         88  EMI-FATAL                   VALUE 'X'.
   614     12  EMI-MESSAGE-FLAG            PIC X.
   615         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   616         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   617     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   618     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   619         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   620         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   621         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   622     12  emi-claim-no                pic x(7).
   623     12  emi-claim-type              pic x(6).
   624     12  FILLER                      PIC X(124)  VALUE SPACES.
   625     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   626     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   627     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   628     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   629*                                    COPY ELCJPFX.
   630******************************************************************
   631*                                                                *
   632*                                                                *
   633*                            ELCJPFX.                            *
   634*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   635*                            VMOD=2.002                          *
   636*                                                                *
   637*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   638*                                                                *
   639*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   640*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   641*        ELCNTL - CONTROL FILE                                   *
   642*        ELMSTR - CLAIM MASTERS                                  *
   643*        ELTRLR - ACTIVITY TRAILERS                              *
   644*        ELCHKQ - CHECK QUE                                      *
   645******************************************************************
   646 01  JOURNAL-RECORD.
   647     12  jp-date                     pic s9(5) comp-3.
   648     12  jp-time                     pic s9(7) comp-3.
   649     12  JP-USER-ID                  PIC X(4).
   650     12  JP-FILE-ID                  PIC X(8).
   651     12  JP-PROGRAM-ID               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  13
* EL1044.cbl
   652     12  JP-RECORD-TYPE              PIC X.
   653         88 JP-ADD              VALUE 'A'.
   654         88 JP-BEFORE-CHANGE    VALUE 'B'.
   655         88 JP-AFTER-CHANGE     VALUE 'C'.
   656         88 JP-DELETE           VALUE 'D'.
   657         88 JP-GENERIC-DELETE   VALUE 'G'.
   658         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   659         88 JP-KEY-CHG-ADD      VALUE 'N'.
   660     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   661     12  JP-RECORD-AREA
   662
   663
   664                                     PIC X(530).
   665*                                    COPY ELCINTF.
   666******************************************************************
   667*                                                                *
   668*                                                                *
   669*                            ELCINTF.                            *
   670*                            VMOD=2.017                          *
   671*                                                                *
   672*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   673*                                                                *
   674*       LENGTH = 1024                                            *
   675*                                                                *
   676******************************************************************
   677*                   C H A N G E   L O G
   678*
   679* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   680*-----------------------------------------------------------------
   681*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   682* EFFECTIVE    NUMBER
   683*-----------------------------------------------------------------
   684* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   685******************************************************************
   686 01  PROGRAM-INTERFACE-BLOCK.
   687     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   688     12  PI-CALLING-PROGRAM              PIC X(8).
   689     12  PI-SAVED-PROGRAM-1              PIC X(8).
   690     12  PI-SAVED-PROGRAM-2              PIC X(8).
   691     12  PI-SAVED-PROGRAM-3              PIC X(8).
   692     12  PI-SAVED-PROGRAM-4              PIC X(8).
   693     12  PI-SAVED-PROGRAM-5              PIC X(8).
   694     12  PI-SAVED-PROGRAM-6              PIC X(8).
   695     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   696     12  PI-COMPANY-ID                   PIC XXX.
   697     12  PI-COMPANY-CD                   PIC X.
   698
   699     12  PI-COMPANY-PASSWORD             PIC X(8).
   700
   701     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   702
   703     12  PI-CONTROL-IN-PROGRESS.
   704         16  PI-CARRIER                  PIC X.
   705         16  PI-GROUPING                 PIC X(6).
   706         16  PI-STATE                    PIC XX.
   707         16  PI-ACCOUNT                  PIC X(10).
   708         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   709                                         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  14
* EL1044.cbl
   710         16  PI-CLAIM-CERT-GRP.
   711             20  PI-CLAIM-NO             PIC X(7).
   712             20  PI-CERT-NO.
   713                 25  PI-CERT-PRIME       PIC X(10).
   714                 25  PI-CERT-SFX         PIC X.
   715             20  PI-CERT-EFF-DT          PIC XX.
   716         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   717             20  PI-PLAN-CODE            PIC X(2).
   718             20  PI-REVISION-NUMBER      PIC X(3).
   719             20  PI-PLAN-EFF-DT          PIC X(2).
   720             20  PI-PLAN-EXP-DT          PIC X(2).
   721             20  FILLER                  PIC X(11).
   722         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   723             20  PI-OE-REFERENCE-1.
   724                 25  PI-OE-REF-1-PRIME   PIC X(18).
   725                 25  PI-OE-REF-1-SUFF    PIC XX.
   726
   727     12  PI-SESSION-IN-PROGRESS          PIC X.
   728         88  CLAIM-SESSION                   VALUE '1'.
   729         88  CREDIT-SESSION                  VALUE '2'.
   730         88  WARRANTY-SESSION                VALUE '3'.
   731         88  MORTGAGE-SESSION                VALUE '4'.
   732         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   733
   734
   735*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   736
   737     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   738     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   739
   740     12  PI-CREDIT-USER                  PIC X.
   741         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   742         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   743
   744     12  PI-CLAIM-USER                   PIC X.
   745         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   746         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   747
   748     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   749         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   750         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   751         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   752         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   753         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   754
   755     12  PI-PROCESSOR-ID                 PIC X(4).
   756
   757     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   758
   759     12  PI-MEMBER-CAPTION               PIC X(10).
   760
   761     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   762         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   763
   764     12  PI-LIFE-OVERRIDE-L1             PIC X.
   765     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   766     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   767     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  15
* EL1044.cbl
   768
   769     12  PI-AH-OVERRIDE-L1               PIC X.
   770     12  PI-AH-OVERRIDE-L2               PIC XX.
   771     12  PI-AH-OVERRIDE-L6               PIC X(6).
   772     12  PI-AH-OVERRIDE-L12              PIC X(12).
   773
   774     12  PI-NEW-SYSTEM                   PIC X(2).
   775
   776     12  PI-PRIMARY-CERT-NO              PIC X(11).
   777     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   778         88  PI-USES-PAID-TO                 VALUE '1'.
   779     12  PI-CRDTCRD-SYSTEM.
   780         16  PI-CRDTCRD-USER             PIC X.
   781             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   782             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   783         16  PI-CC-MONTH-END-DT          PIC XX.
   784     12  PI-PROCESSOR-PRINTER            PIC X(4).
   785
   786     12  PI-OE-REFERENCE-2.
   787         16  PI-OE-REF-2-PRIME           PIC X(10).
   788         16  PI-OE-REF-2-SUFF            PIC X.
   789
   790     12  PI-REM-TRM-CALC-OPTION          PIC X.
   791
   792     12  PI-LANGUAGE-TYPE                PIC X.
   793             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   794             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   795             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   796
   797     12  PI-POLICY-LINKAGE-IND           PIC X.
   798         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   799         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   800                                                   LOW-VALUES.
   801
   802     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   803     12  PI-CLAIM-PW-SESSION             PIC X(1).
   804         88  PI-CLAIM-CREDIT                 VALUE '1'.
   805         88  PI-CLAIM-CONVEN                 VALUE '2'.
   806
   807     12  PI-PROCESSOR-CSR-IND            PIC X.
   808         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   809         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   810
   811     12  FILLER                          PIC X(3).
   812
   813     12  PI-SYSTEM-LEVEL                 PIC X(145).
   814
   815     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   816         PI-SYSTEM-LEVEL.
   817
   818         16  PI-ENTRY-CODES.
   819             20  PI-ENTRY-CD-1           PIC X.
   820             20  PI-ENTRY-CD-2           PIC X.
   821
   822         16  PI-RETURN-CODES.
   823             20  PI-RETURN-CD-1          PIC X.
   824             20  PI-RETURN-CD-2          PIC X.
   825
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  16
* EL1044.cbl
   826         16  PI-UPDATE-STATUS-SAVE.
   827             20  PI-UPDATE-BY            PIC X(4).
   828             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   829
   830         16  PI-LOWER-CASE-LETTERS       PIC X.
   831             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   832
   833*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   834*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   835*            88  CARRIER-CLM-CNTL            VALUE '2'.
   836
   837         16  PI-CERT-ACCESS-CONTROL      PIC X.
   838             88  ST-ACCNT-CNTL               VALUE ' '.
   839             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   840             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   841             88  ACCNT-CNTL                  VALUE '3'.
   842             88  CARR-ACCNT-CNTL             VALUE '4'.
   843
   844         16  PI-PROCESSOR-CAP-LIST.
   845             20  PI-SYSTEM-CONTROLS.
   846                24 PI-SYSTEM-DISPLAY     PIC X.
   847                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   848                24 PI-SYSTEM-MODIFY      PIC X.
   849                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   850             20  FILLER                  PIC XX.
   851             20  PI-DISPLAY-CAP          PIC X.
   852                 88  DISPLAY-CAP             VALUE 'Y'.
   853             20  PI-MODIFY-CAP           PIC X.
   854                 88  MODIFY-CAP              VALUE 'Y'.
   855             20  PI-MSG-AT-LOGON-CAP     PIC X.
   856                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   857             20  PI-FORCE-CAP            PIC X.
   858                 88  FORCE-CAP               VALUE 'Y'.
   859
   860         16  PI-PROGRAM-CONTROLS.
   861             20  PI-PGM-PRINT-OPT        PIC X.
   862             20  PI-PGM-FORMAT-OPT       PIC X.
   863             20  PI-PGM-PROCESS-OPT      PIC X.
   864             20  PI-PGM-TOTALS-OPT       PIC X.
   865
   866         16  PI-HELP-INTERFACE.
   867             20  PI-LAST-ERROR-NO        PIC X(4).
   868             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   869
   870         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   871             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   872
   873         16  PI-CR-CONTROL-IN-PROGRESS.
   874             20  PI-CR-CARRIER           PIC X.
   875             20  PI-CR-GROUPING          PIC X(6).
   876             20  PI-CR-STATE             PIC XX.
   877             20  PI-CR-ACCOUNT           PIC X(10).
   878             20  PI-CR-FIN-RESP          PIC X(10).
   879             20  PI-CR-TYPE              PIC X.
   880
   881         16  PI-CR-BATCH-NUMBER          PIC X(6).
   882
   883         16  PI-CR-MONTH-END-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  17
* EL1044.cbl
   884
   885         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   886             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   887             88  PI-ZERO-CARRIER             VALUE '1'.
   888             88  PI-ZERO-GROUPING            VALUE '2'.
   889             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   890
   891         16  PI-CARRIER-SECURITY         PIC X.
   892             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   893
   894         16  PI-ACCOUNT-SECURITY         PIC X(10).
   895             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   896             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   897
   898         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   899             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   900                                         INDEXED BY PI-ACCESS-NDX
   901                                         PIC X.
   902
   903         16  PI-GA-BILLING-CONTROL       PIC X.
   904             88  PI-GA-BILLING               VALUE '1'.
   905
   906         16  PI-MAIL-PROCESSING          PIC X.
   907             88  PI-MAIL-YES                 VALUE 'Y'.
   908
   909         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   910
   911         16  PI-AR-SYSTEM.
   912             20  PI-AR-PROCESSING-CNTL   PIC X.
   913                 88  PI-AR-PROCESSING        VALUE 'Y'.
   914             20  PI-AR-SUMMARY-CODE      PIC X(6).
   915             20  PI-AR-MONTH-END-DT      PIC XX.
   916
   917         16  PI-MP-SYSTEM.
   918             20  PI-MORTGAGE-USER            PIC X.
   919                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   920                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   921             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   922                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   923                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   924                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   925                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   926                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   927             20  PI-MP-MONTH-END-DT          PIC XX.
   928             20  PI-MP-REFERENCE-NO.
   929                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   930                 24  PI-MP-REFERENCE-SFX     PIC XX.
   931
   932         16  PI-LABEL-CONTROL            PIC X(01).
   933             88  PI-CREATE-LABELS                    VALUE 'Y'.
   934             88  PI-BYPASS-LABELS                    VALUE 'N'.
   935
   936         16  PI-BILL-GROUPING-CODE       PIC X(01).
   937             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   938
   939         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   940             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   941             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  18
* EL1044.cbl
   942
   943         16  FILLER                      PIC X(14).
   944
   945     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   946******************************************************************
   947     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   948*                                    COPY ELC1042.
   949******************************************************************
   950*                                                                *
   951*                                                                *
   952*                           ELC1042                              *
   953*                            VMOD=2.002                          *
   954*                                                                *
   955*    NOTE                                                        *
   956*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   957*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   958*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   959*        TO THESE PROGRAMS.                                      *
   960*                                                                *
   961*    NOTE                                                        *
   962*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   963*        USE ONLY!                                               *
   964*                                                                *
   965******************************************************************
   966
   967         16  PI-1042-WA.
   968             20  PI-ACTION       PIC  X(01).
   969                 88 PI-SHOW-MODE           VALUE '1'.
   970                 88 PI-CLEAR-MODE          VALUE '2'.
   971                 88 PI-CREATE-MODE         VALUE '3'.
   972             20  PI-COMM-CONTROL PIC  X(12).
   973             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   974             20  PI-EOF-SW       PIC  X(01).
   975                 88  PI-FILE-EOF           VALUE 'Y'.
   976             20  PI-FILETYP      PIC  X(01).
   977             20  PI-FORM-SQUEEZE-CONTROL
   978                                 PIC  X(01).
   979                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   980                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   981             20  PI-LAST-CONTROL PIC  X(12).
   982             20  PI-TEMP-STOR-ITEMS
   983                                 PIC S9(04) COMP.
   984             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   985             20  PI-UPDATE-SW    PIC  9(01).
   986                 88 ANY-UPDATES            VALUE 1.
   987             20  PI-104-SCREEN-SENT-IND
   988                                 PIC  X(01).
   989                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   990                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   991             20  PI-1042-SCREEN-SENT-IND
   992                                 PIC  X(01).
   993                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   994                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   995             20  PI-1042-ARCHIVE-IND
   996                                 PIC  X(01).
   997                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   998             20  FILLER          PIC  X(29).
   999         16  PI-PREV-LETR-KEY        PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  19
* EL1044.cbl
  1000         16  PI-CURR-LETR-KEY        PIC X(15).
  1001         16  PI-UPDATE-DT            PIC XX.
  1002         16  FILLER                  PIC X(556).
  1003*                                    COPY ELCAID.
  1004******************************************************************
  1005*                                                                *
  1006*                            ELCAID.                             *
  1007*                            VMOD=2.001                          *
  1008*                                                                *
  1009*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1010*                                                                *
  1011*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1012*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1013******************************************************************
  1014
  1015 01  DFHAID.
  1016   02  DFHNULL   PIC  X  VALUE  ' '.
  1017   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1018   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1019   02  DFHPEN    PIC  X  VALUE  '='.
  1020   02  DFHOPID   PIC  X  VALUE  'W'.
  1021   02  DFHPA1    PIC  X  VALUE  '%'.
  1022   02  DFHPA2    PIC  X  VALUE  '>'.
  1023   02  DFHPA3    PIC  X  VALUE  ','.
  1024   02  DFHPF1    PIC  X  VALUE  '1'.
  1025   02  DFHPF2    PIC  X  VALUE  '2'.
  1026   02  DFHPF3    PIC  X  VALUE  '3'.
  1027   02  DFHPF4    PIC  X  VALUE  '4'.
  1028   02  DFHPF5    PIC  X  VALUE  '5'.
  1029   02  DFHPF6    PIC  X  VALUE  '6'.
  1030   02  DFHPF7    PIC  X  VALUE  '7'.
  1031   02  DFHPF8    PIC  X  VALUE  '8'.
  1032   02  DFHPF9    PIC  X  VALUE  '9'.
  1033   02  DFHPF10   PIC  X  VALUE  ':'.
  1034   02  DFHPF11   PIC  X  VALUE  '#'.
  1035   02  DFHPF12   PIC  X  VALUE  '@'.
  1036   02  DFHPF13   PIC  X  VALUE  'A'.
  1037   02  DFHPF14   PIC  X  VALUE  'B'.
  1038   02  DFHPF15   PIC  X  VALUE  'C'.
  1039   02  DFHPF16   PIC  X  VALUE  'D'.
  1040   02  DFHPF17   PIC  X  VALUE  'E'.
  1041   02  DFHPF18   PIC  X  VALUE  'F'.
  1042   02  DFHPF19   PIC  X  VALUE  'G'.
  1043   02  DFHPF20   PIC  X  VALUE  'H'.
  1044   02  DFHPF21   PIC  X  VALUE  'I'.
  1045*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1046   02  DFHPF22   PIC  X  VALUE  '['.
  1047   02  DFHPF23   PIC  X  VALUE  '.'.
  1048   02  DFHPF24   PIC  X  VALUE  '<'.
  1049   02  DFHMSRE   PIC  X  VALUE  'X'.
  1050   02  DFHSTRF   PIC  X  VALUE  'h'.
  1051   02  DFHTRIG   PIC  X  VALUE  '"'.
  1052 01  FILLER    REDEFINES DFHAID.
  1053     12  FILLER                      PIC X(08).
  1054     12  PF-VALUES                   PIC X         OCCURS 24.
  1055*                                    COPY EL1044S.
  1056 01  EL1044ZI.
  1057     05  FILLER            PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  20
* EL1044.cbl
  1058*    -------------------------------
  1059     05  DATEL PIC S9(0004) COMP.
  1060     05  DATEF PIC  X(0001).
  1061     05  FILLER REDEFINES DATEF.
  1062         10  DATEA PIC  X(0001).
  1063     05  FILLER            PIC  X(3).
  1064     05  DATEI PIC  X(0008).
  1065*    -------------------------------
  1066     05  TIMEL PIC S9(0004) COMP.
  1067     05  TIMEF PIC  X(0001).
  1068     05  FILLER REDEFINES TIMEF.
  1069         10  TIMEA PIC  X(0001).
  1070     05  FILLER            PIC  X(3).
  1071     05  TIMEI PIC  X(0005).
  1072*    -------------------------------
  1073     05  CMPNYIDL PIC S9(0004) COMP.
  1074     05  CMPNYIDF PIC  X(0001).
  1075     05  FILLER REDEFINES CMPNYIDF.
  1076         10  CMPNYIDA PIC  X(0001).
  1077     05  FILLER            PIC  X(3).
  1078     05  CMPNYIDI PIC  X(0003).
  1079*    -------------------------------
  1080     05  USERIDL PIC S9(0004) COMP.
  1081     05  USERIDF PIC  X(0001).
  1082     05  FILLER REDEFINES USERIDF.
  1083         10  USERIDA PIC  X(0001).
  1084     05  FILLER            PIC  X(3).
  1085     05  USERIDI PIC  X(0004).
  1086*    -------------------------------
  1087     05  MAINTL PIC S9(0004) COMP.
  1088     05  MAINTF PIC  X(0001).
  1089     05  FILLER REDEFINES MAINTF.
  1090         10  MAINTA PIC  X(0001).
  1091     05  FILLER            PIC  X(3).
  1092     05  MAINTI PIC  X(0001).
  1093*    -------------------------------
  1094     05  LSTUSRL PIC S9(0004) COMP.
  1095     05  LSTUSRF PIC  X(0001).
  1096     05  FILLER REDEFINES LSTUSRF.
  1097         10  LSTUSRA PIC  X(0001).
  1098     05  FILLER            PIC  X(3).
  1099     05  LSTUSRI PIC  X(0004).
  1100*    -------------------------------
  1101     05  LSTDTEL PIC S9(0004) COMP.
  1102     05  LSTDTEF PIC  X(0001).
  1103     05  FILLER REDEFINES LSTDTEF.
  1104         10  LSTDTEA PIC  X(0001).
  1105     05  FILLER            PIC  X(3).
  1106     05  LSTDTEI PIC  X(0008).
  1107*    -------------------------------
  1108     05  ZLETRL PIC S9(0004) COMP.
  1109     05  ZLETRF PIC  X(0001).
  1110     05  FILLER REDEFINES ZLETRF.
  1111         10  ZLETRA PIC  X(0001).
  1112     05  FILLER            PIC  X(3).
  1113     05  ZLETRI PIC  X(0004).
  1114*    -------------------------------
  1115     05  ZCOPIESL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  21
* EL1044.cbl
  1116     05  ZCOPIESF PIC  X(0001).
  1117     05  FILLER REDEFINES ZCOPIESF.
  1118         10  ZCOPIESA PIC  X(0001).
  1119     05  FILLER            PIC  X(3).
  1120     05  ZCOPIESI PIC  X(0001).
  1121*    -------------------------------
  1122     05  ZPROMPTL PIC S9(0004) COMP.
  1123     05  ZPROMPTF PIC  X(0001).
  1124     05  FILLER REDEFINES ZPROMPTF.
  1125         10  ZPROMPTA PIC  X(0001).
  1126     05  FILLER            PIC  X(3).
  1127     05  ZPROMPTI PIC  X(0001).
  1128*    -------------------------------
  1129     05  ZENCCDL PIC S9(0004) COMP.
  1130     05  ZENCCDF PIC  X(0001).
  1131     05  FILLER REDEFINES ZENCCDF.
  1132         10  ZENCCDA PIC  X(0001).
  1133     05  FILLER            PIC  X(3).
  1134     05  ZENCCDI PIC  X(0003).
  1135*    -------------------------------
  1136     05  ZRDAYSL PIC S9(0004) COMP.
  1137     05  ZRDAYSF PIC  X(0001).
  1138     05  FILLER REDEFINES ZRDAYSF.
  1139         10  ZRDAYSA PIC  X(0001).
  1140     05  FILLER            PIC  X(3).
  1141     05  ZRDAYSI PIC  X(0003).
  1142*    -------------------------------
  1143     05  ZFORML PIC S9(0004) COMP.
  1144     05  ZFORMF PIC  X(0001).
  1145     05  FILLER REDEFINES ZFORMF.
  1146         10  ZFORMA PIC  X(0001).
  1147     05  FILLER            PIC  X(3).
  1148     05  ZFORMI PIC  X(0004).
  1149*    -------------------------------
  1150     05  ZBENEL PIC S9(0004) COMP.
  1151     05  ZBENEF PIC  X(0001).
  1152     05  FILLER REDEFINES ZBENEF.
  1153         10  ZBENEA PIC  X(0001).
  1154     05  FILLER            PIC  X(3).
  1155     05  ZBENEI PIC  X(0001).
  1156*    -------------------------------
  1157     05  ZACCTL PIC S9(0004) COMP.
  1158     05  ZACCTF PIC  X(0001).
  1159     05  FILLER REDEFINES ZACCTF.
  1160         10  ZACCTA PIC  X(0001).
  1161     05  FILLER            PIC  X(3).
  1162     05  ZACCTI PIC  X(0001).
  1163*    -------------------------------
  1164     05  ZTYPEL PIC S9(0004) COMP.
  1165     05  ZTYPEF PIC  X(0001).
  1166     05  FILLER REDEFINES ZTYPEF.
  1167         10  ZTYPEA PIC  X(0001).
  1168     05  FILLER            PIC  X(3).
  1169     05  ZTYPEI PIC  X(0001).
  1170*    -------------------------------
  1171     05  ZPRTCRTL PIC S9(0004) COMP.
  1172     05  ZPRTCRTF PIC  X(0001).
  1173     05  FILLER REDEFINES ZPRTCRTF.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  22
* EL1044.cbl
  1174         10  ZPRTCRTA PIC  X(0001).
  1175     05  FILLER            PIC  X(3).
  1176     05  ZPRTCRTI PIC  X(0001).
  1177*    -------------------------------
  1178     05  ZREFREQL PIC S9(0004) COMP.
  1179     05  ZREFREQF PIC  X(0001).
  1180     05  FILLER REDEFINES ZREFREQF.
  1181         10  ZREFREQA PIC  X(0001).
  1182     05  FILLER            PIC  X(3).
  1183     05  ZREFREQI PIC  X(0001).
  1184*    -------------------------------
  1185     05  ZONBASEL PIC S9(0004) COMP.
  1186     05  ZONBASEF PIC  X(0001).
  1187     05  FILLER REDEFINES ZONBASEF.
  1188         10  ZONBASEA PIC  X(0001).
  1189     05  FILLER            PIC  X(3).
  1190     05  ZONBASEI PIC  X(0002).
  1191*    -------------------------------
  1192     05  ZACTSUML PIC S9(0004) COMP.
  1193     05  ZACTSUMF PIC  X(0001).
  1194     05  FILLER REDEFINES ZACTSUMF.
  1195         10  ZACTSUMA PIC  X(0001).
  1196     05  FILLER            PIC  X(3).
  1197     05  ZACTSUMI PIC  X(0001).
  1198*    -------------------------------
  1199     05  ZCSOSUML PIC S9(0004) COMP.
  1200     05  ZCSOSUMF PIC  X(0001).
  1201     05  FILLER REDEFINES ZCSOSUMF.
  1202         10  ZCSOSUMA PIC  X(0001).
  1203     05  FILLER            PIC  X(3).
  1204     05  ZCSOSUMI PIC  X(0001).
  1205*    -------------------------------
  1206     05  ZREASONL PIC S9(0004) COMP.
  1207     05  ZREASONF PIC  X(0001).
  1208     05  FILLER REDEFINES ZREASONF.
  1209         10  ZREASONA PIC  X(0001).
  1210     05  FILLER            PIC  X(3).
  1211     05  ZREASONI PIC  X(0001).
  1212*    -------------------------------
  1213     05  ZBARCODL PIC S9(0004) COMP.
  1214     05  ZBARCODF PIC  X(0001).
  1215     05  FILLER REDEFINES ZBARCODF.
  1216         10  ZBARCODA PIC  X(0001).
  1217     05  FILLER            PIC  X(3).
  1218     05  ZBARCODI PIC  X(0001).
  1219*    -------------------------------
  1220     05  ZRETENVL PIC S9(0004) COMP.
  1221     05  ZRETENVF PIC  X(0001).
  1222     05  FILLER REDEFINES ZRETENVF.
  1223         10  ZRETENVA PIC  X(0001).
  1224     05  FILLER            PIC  X(3).
  1225     05  ZRETENVI PIC  X(0001).
  1226*    -------------------------------
  1227     05  ZFADAYSL PIC S9(0004) COMP.
  1228     05  ZFADAYSF PIC  X(0001).
  1229     05  FILLER REDEFINES ZFADAYSF.
  1230         10  ZFADAYSA PIC  X(0001).
  1231     05  FILLER            PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  23
* EL1044.cbl
  1232     05  ZFADAYSI PIC  X(0003).
  1233*    -------------------------------
  1234     05  ZACLOSEL PIC S9(0004) COMP.
  1235     05  ZACLOSEF PIC  X(0001).
  1236     05  FILLER REDEFINES ZACLOSEF.
  1237         10  ZACLOSEA PIC  X(0001).
  1238     05  FILLER            PIC  X(3).
  1239     05  ZACLOSEI PIC  X(0001).
  1240*    -------------------------------
  1241     05  ERRMSGL PIC S9(0004) COMP.
  1242     05  ERRMSGF PIC  X(0001).
  1243     05  FILLER REDEFINES ERRMSGF.
  1244         10  ERRMSGA PIC  X(0001).
  1245     05  FILLER            PIC  X(3).
  1246     05  ERRMSGI PIC  X(0072).
  1247*    -------------------------------
  1248     05  PFKEYL PIC S9(0004) COMP.
  1249     05  PFKEYF PIC  X(0001).
  1250     05  FILLER REDEFINES PFKEYF.
  1251         10  PFKEYA PIC  X(0001).
  1252     05  FILLER            PIC  X(3).
  1253     05  PFKEYI PIC  99.
  1254 01  EL1044ZO REDEFINES EL1044ZI.
  1255     05  FILLER            PIC  X(0012).
  1256*    -------------------------------
  1257     05  FILLER            PIC  X(3).
  1258     05  DATEC PIC  X(0001).
  1259     05  DATEH PIC  X(0001).
  1260     05  DATEU PIC  X(0001).
  1261     05  DATEO PIC  X(0008).
  1262*    -------------------------------
  1263     05  FILLER            PIC  X(3).
  1264     05  TIMEC PIC  X(0001).
  1265     05  TIMEH PIC  X(0001).
  1266     05  TIMEU PIC  X(0001).
  1267     05  TIMEO PIC  99.99.
  1268*    -------------------------------
  1269     05  FILLER            PIC  X(3).
  1270     05  CMPNYIDC PIC  X(0001).
  1271     05  CMPNYIDH PIC  X(0001).
  1272     05  CMPNYIDU PIC  X(0001).
  1273     05  CMPNYIDO PIC  X(0003).
  1274*    -------------------------------
  1275     05  FILLER            PIC  X(3).
  1276     05  USERIDC PIC  X(0001).
  1277     05  USERIDH PIC  X(0001).
  1278     05  USERIDU PIC  X(0001).
  1279     05  USERIDO PIC  X(0004).
  1280*    -------------------------------
  1281     05  FILLER            PIC  X(3).
  1282     05  MAINTC PIC  X(0001).
  1283     05  MAINTH PIC  X(0001).
  1284     05  MAINTU PIC  X(0001).
  1285     05  MAINTO PIC  X(0001).
  1286*    -------------------------------
  1287     05  FILLER            PIC  X(3).
  1288     05  LSTUSRC PIC  X(0001).
  1289     05  LSTUSRH PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  24
* EL1044.cbl
  1290     05  LSTUSRU PIC  X(0001).
  1291     05  LSTUSRO PIC  X(0004).
  1292*    -------------------------------
  1293     05  FILLER            PIC  X(3).
  1294     05  LSTDTEC PIC  X(0001).
  1295     05  LSTDTEH PIC  X(0001).
  1296     05  LSTDTEU PIC  X(0001).
  1297     05  LSTDTEO PIC  X(0008).
  1298*    -------------------------------
  1299     05  FILLER            PIC  X(3).
  1300     05  ZLETRC PIC  X(0001).
  1301     05  ZLETRH PIC  X(0001).
  1302     05  ZLETRU PIC  X(0001).
  1303     05  ZLETRO PIC  X(0004).
  1304*    -------------------------------
  1305     05  FILLER            PIC  X(3).
  1306     05  ZCOPIESC PIC  X(0001).
  1307     05  ZCOPIESH PIC  X(0001).
  1308     05  ZCOPIESU PIC  X(0001).
  1309     05  ZCOPIESO PIC  9.
  1310*    -------------------------------
  1311     05  FILLER            PIC  X(3).
  1312     05  ZPROMPTC PIC  X(0001).
  1313     05  ZPROMPTH PIC  X(0001).
  1314     05  ZPROMPTU PIC  X(0001).
  1315     05  ZPROMPTO PIC  X(0001).
  1316*    -------------------------------
  1317     05  FILLER            PIC  X(3).
  1318     05  ZENCCDC PIC  X(0001).
  1319     05  ZENCCDH PIC  X(0001).
  1320     05  ZENCCDU PIC  X(0001).
  1321     05  ZENCCDO PIC  X(0003).
  1322*    -------------------------------
  1323     05  FILLER            PIC  X(3).
  1324     05  ZRDAYSC PIC  X(0001).
  1325     05  ZRDAYSH PIC  X(0001).
  1326     05  ZRDAYSU PIC  X(0001).
  1327     05  ZRDAYSO PIC  999.
  1328*    -------------------------------
  1329     05  FILLER            PIC  X(3).
  1330     05  ZFORMC PIC  X(0001).
  1331     05  ZFORMH PIC  X(0001).
  1332     05  ZFORMU PIC  X(0001).
  1333     05  ZFORMO PIC  X(0004).
  1334*    -------------------------------
  1335     05  FILLER            PIC  X(3).
  1336     05  ZBENEC PIC  X(0001).
  1337     05  ZBENEH PIC  X(0001).
  1338     05  ZBENEU PIC  X(0001).
  1339     05  ZBENEO PIC  X(0001).
  1340*    -------------------------------
  1341     05  FILLER            PIC  X(3).
  1342     05  ZACCTC PIC  X(0001).
  1343     05  ZACCTH PIC  X(0001).
  1344     05  ZACCTU PIC  X(0001).
  1345     05  ZACCTO PIC  X(0001).
  1346*    -------------------------------
  1347     05  FILLER            PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  25
* EL1044.cbl
  1348     05  ZTYPEC PIC  X(0001).
  1349     05  ZTYPEH PIC  X(0001).
  1350     05  ZTYPEU PIC  X(0001).
  1351     05  ZTYPEO PIC  X(0001).
  1352*    -------------------------------
  1353     05  FILLER            PIC  X(3).
  1354     05  ZPRTCRTC PIC  X(0001).
  1355     05  ZPRTCRTH PIC  X(0001).
  1356     05  ZPRTCRTU PIC  X(0001).
  1357     05  ZPRTCRTO PIC  X(0001).
  1358*    -------------------------------
  1359     05  FILLER            PIC  X(3).
  1360     05  ZREFREQC PIC  X(0001).
  1361     05  ZREFREQH PIC  X(0001).
  1362     05  ZREFREQU PIC  X(0001).
  1363     05  ZREFREQO PIC  X(0001).
  1364*    -------------------------------
  1365     05  FILLER            PIC  X(3).
  1366     05  ZONBASEC PIC  X(0001).
  1367     05  ZONBASEH PIC  X(0001).
  1368     05  ZONBASEU PIC  X(0001).
  1369     05  ZONBASEO PIC  X(0002).
  1370*    -------------------------------
  1371     05  FILLER            PIC  X(3).
  1372     05  ZACTSUMC PIC  X(0001).
  1373     05  ZACTSUMH PIC  X(0001).
  1374     05  ZACTSUMU PIC  X(0001).
  1375     05  ZACTSUMO PIC  X(0001).
  1376*    -------------------------------
  1377     05  FILLER            PIC  X(3).
  1378     05  ZCSOSUMC PIC  X(0001).
  1379     05  ZCSOSUMH PIC  X(0001).
  1380     05  ZCSOSUMU PIC  X(0001).
  1381     05  ZCSOSUMO PIC  X(0001).
  1382*    -------------------------------
  1383     05  FILLER            PIC  X(3).
  1384     05  ZREASONC PIC  X(0001).
  1385     05  ZREASONH PIC  X(0001).
  1386     05  ZREASONU PIC  X(0001).
  1387     05  ZREASONO PIC  X(0001).
  1388*    -------------------------------
  1389     05  FILLER            PIC  X(3).
  1390     05  ZBARCODC PIC  X(0001).
  1391     05  ZBARCODH PIC  X(0001).
  1392     05  ZBARCODU PIC  X(0001).
  1393     05  ZBARCODO PIC  X(0001).
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(3).
  1396     05  ZRETENVC PIC  X(0001).
  1397     05  ZRETENVH PIC  X(0001).
  1398     05  ZRETENVU PIC  X(0001).
  1399     05  ZRETENVO PIC  X(0001).
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(3).
  1402     05  ZFADAYSC PIC  X(0001).
  1403     05  ZFADAYSH PIC  X(0001).
  1404     05  ZFADAYSU PIC  X(0001).
  1405     05  ZFADAYSO PIC  999.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  26
* EL1044.cbl
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(3).
  1408     05  ZACLOSEC PIC  X(0001).
  1409     05  ZACLOSEH PIC  X(0001).
  1410     05  ZACLOSEU PIC  X(0001).
  1411     05  ZACLOSEO PIC  X(0001).
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(3).
  1414     05  ERRMSGC PIC  X(0001).
  1415     05  ERRMSGH PIC  X(0001).
  1416     05  ERRMSGU PIC  X(0001).
  1417     05  ERRMSGO PIC  X(0072).
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(3).
  1420     05  PFKEYC PIC  X(0001).
  1421     05  PFKEYH PIC  X(0001).
  1422     05  PFKEYU PIC  X(0001).
  1423     05  PFKEYO PIC  99.
  1424*    -------------------------------
  1425****************************************************************
  1426*
  1427* Copyright (c) 2007 by Clerity Solutions, Inc.
  1428* All rights reserved.
  1429*
  1430****************************************************************
  1431 01  DFHEIV.
  1432   02  DFHEIV0               PIC X(35).
  1433   02  DFHEIV1               PIC X(08).
  1434   02  DFHEIV2               PIC X(08).
  1435   02  DFHEIV3               PIC X(08).
  1436   02  DFHEIV4               PIC X(06).
  1437   02  DFHEIV5               PIC X(04).
  1438   02  DFHEIV6               PIC X(04).
  1439   02  DFHEIV7               PIC X(02).
  1440   02  DFHEIV8               PIC X(02).
  1441   02  DFHEIV9               PIC X(01).
  1442   02  DFHEIV10              PIC S9(7) COMP-3.
  1443   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1444   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1445   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1446   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1447   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1448   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1449   02  DFHEIV17              PIC X(04).
  1450   02  DFHEIV18              PIC X(04).
  1451   02  DFHEIV19              PIC X(04).
  1452   02  DFHEIV20              USAGE IS POINTER.
  1453   02  DFHEIV21              USAGE IS POINTER.
  1454   02  DFHEIV22              USAGE IS POINTER.
  1455   02  DFHEIV23              USAGE IS POINTER.
  1456   02  DFHEIV24              USAGE IS POINTER.
  1457   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1458   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1459   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1460   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1461   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1462   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1463   02  FILLER                PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  27
* EL1044.cbl
  1464   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1465   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1466   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1467   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1468   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1469 LINKAGE  SECTION.
  1470*****************************************************************
  1471*                                                               *
  1472* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1473* All rights reserved.                                          *
  1474*                                                               *
  1475*****************************************************************
  1476 01  dfheiblk.
  1477     02  eibtime          pic s9(7) comp-3.
  1478     02  eibdate          pic s9(7) comp-3.
  1479     02  eibtrnid         pic x(4).
  1480     02  eibtaskn         pic s9(7) comp-3.
  1481     02  eibtrmid         pic x(4).
  1482     02  dfheigdi         pic s9(4) comp.
  1483     02  eibcposn         pic s9(4) comp.
  1484     02  eibcalen         pic s9(4) comp.
  1485     02  eibaid           pic x(1).
  1486     02  eibfiller1       pic x(1).
  1487     02  eibfn            pic x(2).
  1488     02  eibfiller2       pic x(2).
  1489     02  eibrcode         pic x(6).
  1490     02  eibfiller3       pic x(2).
  1491     02  eibds            pic x(8).
  1492     02  eibreqid         pic x(8).
  1493     02  eibrsrce         pic x(8).
  1494     02  eibsync          pic x(1).
  1495     02  eibfree          pic x(1).
  1496     02  eibrecv          pic x(1).
  1497     02  eibsend          pic x(1).
  1498     02  eibatt           pic x(1).
  1499     02  eibeoc           pic x(1).
  1500     02  eibfmh           pic x(1).
  1501     02  eibcompl         pic x(1).
  1502     02  eibsig           pic x(1).
  1503     02  eibconf          pic x(1).
  1504     02  eiberr           pic x(1).
  1505     02  eibrldbk         pic x(1).
  1506     02  eiberrcd         pic x(4).
  1507     02  eibsynrb         pic x(1).
  1508     02  eibnodat         pic x(1).
  1509     02  eibfiller5       pic x(2).
  1510     02  eibresp          pic 9(09) comp.
  1511     02  eibresp2         pic 9(09) comp.
  1512     02  dfheigdj         pic s9(4) comp.
  1513     02  dfheigdk         pic s9(4) comp.
  1514 01  DFHCOMMAREA                     PIC X(1024).
  1515*                                    COPY ELCTEXT.
  1516******************************************************************
  1517*                                                                *
  1518*                                                                *
  1519*                            ELCTEXT.                            *
  1520*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1521*                            VMOD=2.008                          *
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  28
* EL1044.cbl
  1522*                                                                *
  1523*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1524*                                     FORM LETTERS,              *
  1525*                                     CERT FORM DISPLAY.
  1526*                                                                *
  1527*   FILE TYPE = VSAM,KSDS                                        *
  1528*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1529*                                                                *
  1530*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1531*       ALTERNATE INDEX = NONE                                   *
  1532*                                                                *
  1533*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1534*       ALTERNATE INDEX = NONE                                   *
  1535*                                                                *
  1536*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1537*       ALTERNATE INDEX = NONE                                   *
  1538*                                                                *
  1539*   LOG = NO                                                     *
  1540*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1541******************************************************************
  1542 01  TEXT-FILES.
  1543     12  TEXT-FILE-ID                PIC XX.
  1544         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1545         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1546         88  HELP-FILE-TEXT             VALUE 'TH'.
  1547
  1548     12  TX-CONTROL-PRIMARY.
  1549         16  TX-COMPANY-CD           PIC X.
  1550             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1551         16  TX-ACCESS-CD-GENL       PIC X(12).
  1552
  1553         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1554             20  TX-LETTER-NO        PIC X(4).
  1555             20  FILLER              PIC X(8).
  1556
  1557         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1558             20  TX-FORM-NO          PIC X(12).
  1559
  1560         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1561             20  TX-HELP-TYPE        PIC X.
  1562                 88  HELP-FOR-GENERAL   VALUE ' '.
  1563                 88  HELP-BY-SCREEN     VALUE 'S'.
  1564                 88  HELP-BY-ERROR      VALUE 'E'.
  1565             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1566                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1567             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1568                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1569             20  FILLER              PIC X(4).
  1570
  1571         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1572
  1573     12  TX-PROCESS-CONTROL          PIC XX.
  1574         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1575
  1576     12  TX-TEXT-LINE                PIC X(70).
  1577
  1578     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1579         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  29
* EL1044.cbl
  1580         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1581         88  TX-VALID-FORM-SQUEEZE-VALUE
  1582                                        VALUE 'Y' ' '.
  1583
  1584     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1585         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1586         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1587         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1588         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1589         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1590         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1591         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1592                                              'K' 'N' ' '
  1593                                              'Z'.
  1594
  1595     12  TX-ARCHIVE-SW               PIC X.
  1596         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1597         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1598         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1599
  1600     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1601     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1602
  1603     12  TX-BSR-CODE                 PIC X.
  1604         88  TX-BSR-LETTER              VALUE 'B'.
  1605         88  TX-NON-BSR-LETTER          VALUE ' '.
  1606
  1607     12  FILLER                      PIC X.
  1608*****************************************************************
  1609 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES.
  1610 0000-DFHEXIT SECTION.
  1611     MOVE '9#                    $   ' TO DFHEIV0.
  1612     MOVE 'EL1044' TO DFHEIV1.
  1613     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1614     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1615     MOVE '5'                    TO DC-OPTION-CODE
  1616     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1617     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1618     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1619     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1620     IF EIBCALEN = 0
  1621        GO TO 8800-UNAUTHORIZED-ACCESS.
  1622     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  1623     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  1624     MOVE 1                      TO EMI-NUMBER-OF-LINES
  1625
  1626* EXEC CICS HANDLE CONDITION
  1627*        DUPREC     (8850-DUPREC)
  1628*        NOTOPEN    (8870-NOTOPEN)
  1629*        NOTFND     (8880-NOT-FOUND)
  1630*        PGMIDERR   (9600-PGMID-ERROR)
  1631*        ERROR      (9990-ABEND)
  1632*    END-EXEC.
  1633*    MOVE '"$%JIL.               ! " #00001621' TO DFHEIV0
  1634     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  1635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1636     MOVE X'2220233030303031363231' TO DFHEIV0(25:11)
  1637     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  30
* EL1044.cbl
  1638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1639
  1640     .
  1641 0150-SET-PROGRAM-SAVES.
  1642     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
  1643         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  1644             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1645             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1646             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1647             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1648             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1649             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1650             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1651             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1652         ELSE
  1653             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1654             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1655             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1656             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1657             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1658             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1659             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1660             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1661     ELSE
  1662         GO TO 0200-RECEIVE.
  1663*    DISPLAY ' COMM KEY PASSED ' PI-COMM-CONTROL
  1664     MOVE PI-COMPANY-CD          TO ELLETR-KEY
  1665     MOVE PI-COMM-CONTROL        TO ELLETR-KEY (2:12)
  1666     MOVE ZEROS                  TO ELLETR-SEQ-NO
  1667     MOVE ELLETR-KEY             TO PI-CURR-LETR-KEY
  1668                                    PI-PREV-LETR-KEY
  1669     GO TO 1000-SHOW-LETR-RECORD
  1670     .
  1671 0200-RECEIVE.
  1672     IF EIBAID = DFHCLEAR
  1673        GO TO 9400-CLEAR.
  1674     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1675         MOVE LOW-VALUES             TO  EL1044ZI
  1676         MOVE ER-7008                TO  EMI-ERROR
  1677         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1678         MOVE -1                     TO  MAINTL
  1679         GO TO 8200-SEND-DATAONLY.
  1680     IF PI-PROCESSOR-ID EQUAL 'LGXX'
  1681         NEXT SENTENCE
  1682     ELSE
  1683
  1684* EXEC CICS READQ TS
  1685*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1686*            INTO   (SECURITY-CONTROL)
  1687*            LENGTH (SC-COMM-LENGTH)
  1688*            ITEM   (SC-ITEM)
  1689*        END-EXEC
  1690*    MOVE '*$II   L              ''   #00001671' TO DFHEIV0
  1691     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1692     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1693     MOVE X'2020233030303031363731' TO DFHEIV0(25:11)
  1694     CALL 'kxdfhei1' USING DFHEIV0,
  1695           PI-SECURITY-TEMP-STORE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  31
* EL1044.cbl
  1696           SECURITY-CONTROL,
  1697           SC-COMM-LENGTH,
  1698           SC-ITEM,
  1699           DFHEIV99,
  1700           DFHEIV99
  1701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1702         MOVE SC-CREDIT-DISPLAY (3)  TO  PI-DISPLAY-CAP
  1703         MOVE SC-CREDIT-UPDATE  (3)  TO  PI-MODIFY-CAP.
  1704
  1705* EXEC CICS RECEIVE
  1706*        MAP      (WS-MAP-NAME)
  1707*        MAPSET   (MAPSET-NAME)
  1708*        INTO     (EL1044ZI)
  1709*    END-EXEC
  1710     MOVE LENGTH OF
  1711      EL1044ZI
  1712       TO DFHEIV11
  1713*    MOVE '8"T I  L              ''   #00001679' TO DFHEIV0
  1714     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1715     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1716     MOVE X'2020233030303031363739' TO DFHEIV0(25:11)
  1717     CALL 'kxdfhei1' USING DFHEIV0,
  1718           WS-MAP-NAME,
  1719           EL1044ZI,
  1720           DFHEIV11,
  1721           MAPSET-NAME,
  1722           DFHEIV99,
  1723           DFHEIV99
  1724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1725     IF PFKEYL = +0
  1726         GO TO 0300-CHECK-PFKEYS.
  1727     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
  1728         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  1729     ELSE
  1730         MOVE ER-0029                TO  EMI-ERROR
  1731         GO TO 0320-INPUT-ERROR.
  1732 0300-CHECK-PFKEYS.
  1733*    DISPLAY ' MADE IT TO 0300 '
  1734     IF EIBAID EQUAL DFHPF23
  1735         GO TO 8810-PF23.
  1736     IF EIBAID EQUAL DFHPF24
  1737         GO TO 9200-RETURN-MAIN-MENU.
  1738     IF EIBAID EQUAL DFHPF12
  1739         GO TO 9500-PF12.
  1740     IF (MAINTL <> 0) AND (EIBAID <> DFHENTER)
  1741         MOVE ER-0050            TO EMI-ERROR
  1742         GO TO 0320-INPUT-ERROR.
  1743     IF EIBAID EQUAL DFHENTER
  1744         GO TO 0330-EDIT-DATA.
  1745     MOVE ER-0029                    TO  EMI-ERROR.
  1746 0320-INPUT-ERROR.
  1747*    DISPLAY ' MADE IT TO 0320 '
  1748     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1749     MOVE AL-UNBON                   TO  PFKEYA.
  1750     MOVE -1                         TO  PFKEYL.
  1751     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  32
* EL1044.cbl
  1753 0330-EDIT-DATA.
  1754     IF NOT DISPLAY-CAP
  1755         MOVE 'READ'                 TO  SM-READ
  1756         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1757         MOVE ER-0070                TO  EMI-ERROR
  1758         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1759         MOVE -1                     TO  MAINTL
  1760         GO TO 8100-SEND-INITIAL-MAP.
  1761     IF MAINTI EQUAL 'S'
  1762        GO TO 1000-SHOW-LETR-RECORD.
  1763     IF MAINTI = 'C' OR 'A'
  1764        IF NOT MODIFY-CAP
  1765           PERFORM 9995-SECURITY-VIOLATION
  1766                                 THRU 9995-EXIT
  1767           MOVE ER-0070          TO EMI-ERROR
  1768           PERFORM 9900-ERROR-FORMAT
  1769                                 THRU 9900-EXIT
  1770           MOVE LOW-VALUES       TO EL1044ZO
  1771           MOVE -1               TO MAINTL
  1772           GO TO 8100-SEND-INITIAL-MAP
  1773        END-IF
  1774     END-IF
  1775     IF MAINTI = 'C'
  1776        GO TO 2000-CHANGE-LETR-RECORD
  1777     END-IF
  1778     IF MAINTI = 'A'
  1779        GO TO 3000-ADD-LETR-RECORD
  1780     END-IF
  1781     MOVE ER-0023                    TO  EMI-ERROR.
  1782     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1783     MOVE -1                         TO  MAINTL.
  1784     MOVE AL-UABON                   TO  MAINTA.
  1785     GO TO 8200-SEND-DATAONLY.
  1786 1000-SHOW-LETR-RECORD.
  1787     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1788
  1789* EXEC CICS STARTBR
  1790*        DATASET   (ELLETR-FILE-ID)
  1791*        RIDFLD    (ELLETR-KEY)
  1792*        GTEQ
  1793*        RESP      (WS-RESPONSE)
  1794*    END-EXEC
  1795     MOVE 0
  1796       TO DFHEIV11
  1797*    MOVE '&,         G          &  N#00001747' TO DFHEIV0
  1798     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1799     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1800     MOVE X'204E233030303031373437' TO DFHEIV0(25:11)
  1801     CALL 'kxdfhei1' USING DFHEIV0,
  1802           ELLETR-FILE-ID,
  1803           ELLETR-KEY,
  1804           DFHEIV99,
  1805           DFHEIV11,
  1806           DFHEIV99
  1807     MOVE EIBRESP  TO WS-RESPONSE
  1808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1809     IF RESP-NORMAL
  1810        PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  33
* EL1044.cbl
  1811           OR WE-FOUND-IT
  1812
  1813* EXEC CICS READNEXT
  1814*              DATASET    (ELLETR-FILE-ID)
  1815*              SET        (ADDRESS OF TEXT-FILES)
  1816*              RIDFLD     (ELLETR-KEY)
  1817*              RESP       (WS-RESPONSE)
  1818*          END-EXEC
  1819     MOVE 0
  1820       TO DFHEIV11
  1821*    MOVE '&.S                   )  N#00001756' TO DFHEIV0
  1822     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1823     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1824     MOVE X'204E233030303031373536' TO DFHEIV0(25:11)
  1825     CALL 'kxdfhei1' USING DFHEIV0,
  1826           ELLETR-FILE-ID,
  1827           DFHEIV20,
  1828           DFHEIV99,
  1829           ELLETR-KEY,
  1830           DFHEIV99,
  1831           DFHEIV11,
  1832           DFHEIV99,
  1833           DFHEIV99
  1834     SET ADDRESS OF TEXT-FILES TO
  1835         DFHEIV20
  1836     MOVE EIBRESP  TO WS-RESPONSE
  1837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1838           IF (RESP-NORMAL)
  1839              AND (TX-LETTER-NO = PI-COMM-CONTROL (1:4))
  1840              IF (TX-LINE-SQUEEZE-CONTROL = 'Z')
  1841                 SET WE-FOUND-IT   TO TRUE
  1842              END-IF
  1843           ELSE
  1844              SET I-SAY-TO-STOP  TO TRUE
  1845           END-IF
  1846        END-PERFORM
  1847     END-IF
  1848     IF WE-FOUND-IT
  1849        MOVE TX-CONTROL-PRIMARY  TO PI-CURR-LETR-KEY
  1850                                    PI-PREV-LETR-KEY
  1851        GO TO 7000-BUILD-OUTPUT-MAP
  1852     END-IF
  1853     MOVE ER-0418                TO EMI-ERROR.
  1854     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1855     MOVE -1                     TO MAINTL
  1856     MOVE 'A'                    TO MAINTI
  1857     MOVE AL-UANON               TO MAINTA
  1858     MOVE PI-COMM-CONTROL (1:4)  TO ZLETRI
  1859     MOVE +4                     TO ZLETRL
  1860     MOVE AL-UANON               TO ZLETRA
  1861     GO TO 8100-SEND-INITIAL-MAP
  1862     .
  1863 2000-CHANGE-LETR-RECORD.
  1864*    display ' made it to 2000 '
  1865*    display ' curr   ' pi-curr-letr-key
  1866*    display ' prev   ' pi-prev-letr-key
  1867     IF PI-CURR-LETR-KEY NOT = PI-PREV-LETR-KEY
  1868        MOVE ER-0145             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  34
* EL1044.cbl
  1869        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1870        MOVE -1                  TO MAINTL
  1871        GO TO 8200-SEND-DATAONLY
  1872     END-IF
  1873     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1874     IF NOT EMI-NO-ERRORS
  1875         GO TO 8200-SEND-DATAONLY.
  1876     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1877     .
  1878 2000-CHANGE-CONTINUE.
  1879
  1880* EXEC CICS READ
  1881*        DATASET    (ELLETR-FILE-ID)
  1882*        SET        (ADDRESS OF TEXT-FILES)
  1883*        RIDFLD     (ELLETR-KEY)
  1884*        UPDATE
  1885*        RESP       (WS-RESPONSE)
  1886*    END-EXEC
  1887*    MOVE '&"S        EU         (  N#00001803' TO DFHEIV0
  1888     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1889     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1890     MOVE X'204E233030303031383033' TO DFHEIV0(25:11)
  1891     CALL 'kxdfhei1' USING DFHEIV0,
  1892           ELLETR-FILE-ID,
  1893           DFHEIV20,
  1894           DFHEIV99,
  1895           ELLETR-KEY,
  1896           DFHEIV99,
  1897           DFHEIV99,
  1898           DFHEIV99
  1899     SET ADDRESS OF TEXT-FILES TO
  1900         DFHEIV20
  1901     MOVE EIBRESP  TO WS-RESPONSE
  1902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1903     IF RESP-NOTFND
  1904        IF ELLETR-SEQ-NO = +0
  1905           GO TO 2000-CONTINUE-CHANGE
  1906        END-IF
  1907     END-IF
  1908     IF TX-LAST-MAINTENANCED-BY NOT = PI-UPDATE-BY OR
  1909        TX-LAST-MAINTENANCED-DT NOT = PI-UPDATE-DT
  1910
  1911* EXEC CICS UNLOCK
  1912*            DATASET   (ELLETR-FILE-ID)
  1913*        END-EXEC
  1914*    MOVE '&*                    #   #00001817' TO DFHEIV0
  1915     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  1916     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1917     MOVE X'2020233030303031383137' TO DFHEIV0(25:11)
  1918     CALL 'kxdfhei1' USING DFHEIV0,
  1919           ELLETR-FILE-ID,
  1920           DFHEIV99
  1921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1922         MOVE ER-0068                TO  EMI-ERROR
  1923         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1924         GO TO 1000-SHOW-LETR-RECORD.
  1925     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  1926     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  35
* EL1044.cbl
  1927     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  1928     IF ZCOPIESL > +0
  1929        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  1930     END-IF
  1931     IF ZFADAYSL > +0
  1932        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  1933     END-IF
  1934     IF ZRDAYSL > +0
  1935        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  1936     END-IF
  1937     IF ZFORML > +0
  1938        MOVE ZFORMI              TO W-FORM-TO-RESEND
  1939     END-IF
  1940     IF ZPROMPTL > +0
  1941        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  1942     END-IF
  1943     IF ZENCCDL > +0
  1944        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  1945     END-IF
  1946     IF ZACLOSEL > +0
  1947        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  1948     END-IF
  1949     IF ZBENEL > +0
  1950        MOVE ZBENEI              TO W-LETTER-TO-BENE
  1951     END-IF
  1952     IF ZACCTL > +0
  1953        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  1954     END-IF
  1955     IF ZTYPEL > +0
  1956        MOVE ZTYPEI              TO W-LETTER-TYPE
  1957     END-IF
  1958     IF ZPRTCRTL > +0
  1959        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  1960     END-IF
  1961     IF ZREFREQL > +0
  1962        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  1963     END-IF
  1964     IF ZONBASEL > +0
  1965         MOVE ZONBASEI           TO W-ONBASE-CODE
  1966     END-IF
  1967
  1968     IF ZACTSUML > +0
  1969         MOVE ZACTSUMI           TO W-ACCT-SUMM
  1970     END-IF
  1971
  1972     IF ZCSOSUML > +0
  1973         MOVE ZCSOSUMI           TO W-CSO-SUMM
  1974     END-IF
  1975
  1976     IF ZREASONL > +0
  1977        MOVE ZREASONI            TO W-REASONS-REQUIRED
  1978     END-IF
  1979
  1980     IF ZBARCODL > +0
  1981        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  1982     END-IF
  1983
  1984     IF ZRETENVL > +0
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  36
* EL1044.cbl
  1985        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  1986     END-IF
  1987     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  1988     .
  1989 2000-CONTINUE-CHANGE.
  1990*    DISPLAY ' ABOUT TO REWRITE '
  1991
  1992* EXEC CICS REWRITE
  1993*        DATASET   (ELLETR-FILE-ID)
  1994*        FROM      (TEXT-FILES)
  1995*    END-EXEC.
  1996     MOVE LENGTH OF
  1997      TEXT-FILES
  1998       TO DFHEIV11
  1999*    MOVE '&& L                  %   #00001889' TO DFHEIV0
  2000     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2001     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2002     MOVE X'2020233030303031383839' TO DFHEIV0(25:11)
  2003     CALL 'kxdfhei1' USING DFHEIV0,
  2004           ELLETR-FILE-ID,
  2005           TEXT-FILES,
  2006           DFHEIV11,
  2007           DFHEIV99
  2008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2009
  2010     MOVE ER-0000                    TO  EMI-ERROR.
  2011     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2012     GO TO 1000-SHOW-LETR-RECORD
  2013     .
  2014 3000-ADD-LETR-RECORD.
  2015*    display ' made it to 3000 '
  2016*    display ' curr   ' pi-curr-letr-key
  2017*    display ' prev   ' pi-prev-letr-key
  2018     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  2019     .
  2020 3000-CONTINUE-ADD.
  2021     IF NOT EMI-NO-ERRORS
  2022        GO TO 8200-SEND-DATAONLY
  2023     END-IF
  2024     MOVE SPACES                 TO ELLETR-KEY
  2025     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD
  2026     MOVE ZLETRI                 TO ELLETR-ACCESS-CD
  2027     MOVE +0                     TO ELLETR-SEQ-NO
  2028
  2029* EXEC CICS READ
  2030*        DATASET    (ELLETR-FILE-ID)
  2031*        SET        (ADDRESS OF TEXT-FILES)
  2032*        RIDFLD     (ELLETR-KEY)
  2033*        GTEQ
  2034*        RESP       (WS-RESPONSE)
  2035*    END-EXEC
  2036*    MOVE '&"S        G          (  N#00001911' TO DFHEIV0
  2037     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2038     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2039     MOVE X'204E233030303031393131' TO DFHEIV0(25:11)
  2040     CALL 'kxdfhei1' USING DFHEIV0,
  2041           ELLETR-FILE-ID,
  2042           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  37
* EL1044.cbl
  2043           DFHEIV99,
  2044           ELLETR-KEY,
  2045           DFHEIV99,
  2046           DFHEIV99,
  2047           DFHEIV99
  2048     SET ADDRESS OF TEXT-FILES TO
  2049         DFHEIV20
  2050     MOVE EIBRESP  TO WS-RESPONSE
  2051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2052     IF RESP-NORMAL
  2053        IF TX-LETTER-NO = ZLETRI
  2054           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  2055              MOVE ER-0132       TO EMI-ERROR
  2056              PERFORM 9900-ERROR-FORMAT
  2057                                 THRU 9900-EXIT
  2058              MOVE -1            TO ZLETRL
  2059              MOVE AL-UABON      TO ZLETRA
  2060              GO TO 8200-SEND-DATAONLY
  2061           ELSE
  2062              MOVE +0            TO WS-SEQ-NO-TO-USE
  2063           END-IF
  2064        ELSE
  2065           MOVE +1               TO WS-SEQ-NO-TO-USE
  2066        END-IF
  2067     ELSE
  2068        MOVE +1                  TO WS-SEQ-NO-TO-USE
  2069     END-IF
  2070
  2071* EXEC CICS GETMAIN
  2072*       SET(ADDRESS OF TEXT-FILES)
  2073*       LENGTH(ELLETR-LENGTH)
  2074*    END-EXEC
  2075*    MOVE '," L                  $   #00001936' TO DFHEIV0
  2076     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  2077     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2078     MOVE X'2020233030303031393336' TO DFHEIV0(25:11)
  2079     CALL 'kxdfhei1' USING DFHEIV0,
  2080           DFHEIV20,
  2081           ELLETR-LENGTH,
  2082           DFHEIV99
  2083     SET ADDRESS OF TEXT-FILES TO
  2084         DFHEIV20
  2085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2086     MOVE SPACES                 TO TEXT-FILES
  2087     MOVE 'TL'                   TO TEXT-FILE-ID
  2088     MOVE PI-COMPANY-CD          TO TX-COMPANY-CD
  2089     MOVE ZLETRI                 TO TX-LETTER-NO
  2090     MOVE WS-SEQ-NO-TO-USE       TO TX-LINE-SEQUENCE
  2091     MOVE 'Z'                    TO TX-LINE-SQUEEZE-CONTROL
  2092     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2093     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2094     MOVE SPACES                 TO W-Z-CONTROL-DATA
  2095     IF ZCOPIESL > +0
  2096        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  2097     ELSE
  2098        MOVE 1                   TO W-NUMBER-OF-COPIES
  2099     END-IF
  2100     IF ZFADAYSL > +0
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  38
* EL1044.cbl
  2101        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2102     END-IF
  2103     IF ZRDAYSL > +0
  2104        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2105     ELSE
  2106        MOVE ZEROS               TO W-DAYS-TO-RESEND
  2107     END-IF
  2108     IF ZFORML > +0
  2109        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2110     END-IF
  2111     IF ZPROMPTL > +0
  2112        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2113     END-IF
  2114     IF ZENCCDL > +0
  2115        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2116     END-IF
  2117     IF ZACLOSEL > +0
  2118        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2119     END-IF
  2120     IF ZBENEL > +0
  2121        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2122     END-IF
  2123     IF ZACCTL > +0
  2124        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  2125     END-IF
  2126     IF ZTYPEL > +0
  2127        MOVE ZTYPEI              TO W-LETTER-TYPE
  2128     END-IF
  2129     IF ZPRTCRTL > +0
  2130        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  2131     END-IF
  2132     IF ZREFREQL > +0
  2133        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  2134     END-IF
  2135     IF ZONBASEL > +0
  2136        MOVE ZONBASEI            TO W-ONBASE-CODE
  2137     END-IF
  2138
  2139     IF ZACTSUML > +0
  2140         MOVE ZACTSUMI           TO W-ACCT-SUMM
  2141     END-IF
  2142
  2143     IF ZCSOSUML > +0
  2144         MOVE ZCSOSUMI           TO W-CSO-SUMM
  2145     END-IF
  2146
  2147     IF ZREASONL > +0
  2148        MOVE ZREASONI            TO W-REASONS-REQUIRED
  2149     END-IF
  2150
  2151     IF ZBARCODL > +0
  2152        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  2153     END-IF
  2154
  2155     IF ZRETENVL > +0
  2156        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  2157     END-IF
  2158     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  39
* EL1044.cbl
  2159*    DISPLAY ' ABOUT TO WRITE '
  2160     MOVE TX-CONTROL-PRIMARY     TO ELLETR-KEY
  2161                                    PI-CURR-LETR-KEY
  2162                                    PI-PREV-LETR-KEY
  2163
  2164* EXEC CICS WRITE
  2165*       DATASET (ELLETR-FILE-ID)
  2166*       FROM    (TEXT-FILES)
  2167*       RIDFLD  (ELLETR-KEY)
  2168*    END-EXEC
  2169     MOVE LENGTH OF
  2170      TEXT-FILES
  2171       TO DFHEIV11
  2172*    MOVE '&$ L                  ''   #00002017' TO DFHEIV0
  2173     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2174     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2175     MOVE X'2020233030303032303137' TO DFHEIV0(25:11)
  2176     CALL 'kxdfhei1' USING DFHEIV0,
  2177           ELLETR-FILE-ID,
  2178           TEXT-FILES,
  2179           DFHEIV11,
  2180           ELLETR-KEY,
  2181           DFHEIV99,
  2182           DFHEIV99
  2183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2184     MOVE ER-0000                    TO  EMI-ERROR.
  2185     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2186     GO TO 1000-SHOW-LETR-RECORD
  2187     .
  2188 5000-FIND-NEXT-PROD-RECORD.
  2189*    MOVE PI-PROD-KEY            TO ELLETR-KEY
  2190*
  2191*    EXEC CICS STARTBR
  2192*        DATASET   (ELLETR-FILE-ID)
  2193*        RIDFLD    (ELLETR-KEY)
  2194*        GTEQ
  2195*        RESP      (WS-RESPONSE)
  2196*    END-EXEC
  2197*
  2198*    IF NOT RESP-NORMAL
  2199*       MOVE -1                  TO PFKEYL
  2200*       MOVE ER-0130             TO EMI-ERROR
  2201*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2202*       GO TO 8200-SEND-DATAONLY
  2203*    END-IF
  2204     .
  2205 5000-READNEXT-LOOP.
  2206*    EXEC CICS READNEXT
  2207*        DATASET   (ELLETR-FILE-ID)
  2208*        SET       (ADDRESS OF PRODUCT-MASTER)
  2209*        RIDFLD    (ELLETR-KEY)
  2210*        RESP      (WS-RESPONSE)
  2211*    END-EXEC
  2212*
  2213*    IF (NOT RESP-NORMAL)
  2214*       OR (PD-COMPANY-CD NOT = PI-COMPANY-CD)
  2215*       PERFORM 5000-END-BROWSE
  2216*       MOVE -1                  TO PFKEYL
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  40
* EL1044.cbl
  2217*       MOVE ER-0130             TO EMI-ERROR
  2218*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2219*       GO TO 1000-SHOW-LETR-RECORD
  2220*    END-IF
  2221*
  2222*    IF ELLETR-KEY = PI-PREV-LETR-KEY
  2223*       GO TO 5000-READNEXT-LOOP
  2224*    END-IF
  2225*
  2226*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2227*
  2228*    PERFORM 5000-END-BROWSE
  2229*    GO TO 7000-BUILD-OUTPUT-MAP
  2230     .
  2231 5000-END-BROWSE.
  2232*    EXEC CICS ENDBR
  2233*        DATASET   (ELLETR-FILE-ID)
  2234*    END-EXEC
  2235     .
  2236 5100-FIND-PREV-PROD-RECORD.
  2237*    MOVE PI-PREV-LETR-KEY       TO ELLETR-KEY
  2238*    IF STATEL > +0
  2239*       MOVE STATEI              TO ELLETR-STATE
  2240*    END-IF
  2241*    IF PRODCDL > +0
  2242*       MOVE PRODCDI             TO ELLETR-PROD-CD
  2243*    END-IF
  2244*    IF BENTYPL > +0
  2245*        MOVE BENTYPI                TO  ELLETR-BEN-TYPE.
  2246*    IF BENCODEL > +0
  2247*        MOVE BENCODEI               TO  ELLETR-BEN-CODE.
  2248*    IF EXPDTL IS GREATER THAN +0
  2249*        MOVE EXPDTI                 TO  DEEDIT-FIELD
  2250*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  2251*        IF WS-NUMVAL-OF-DEEDIT >= 999999
  2252*            MOVE HIGH-VALUES        TO  ELLETR-EXP-DT
  2253*        ELSE
  2254*          STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:12)
  2255*             DELIMITED BY SIZE INTO DC-GREG-DATE-CYMD
  2256*          END-STRING
  2257*           MOVE 'L'                    TO  DC-OPTION-CODE
  2258*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2259*            IF NO-CONVERSION-ERROR
  2260*                MOVE DC-BIN-DATE-1  TO  ELLETR-EXP-DT
  2261*            ELSE
  2262*                MOVE LOW-VALUES     TO  ELLETR-EXP-DT.
  2263*
  2264*    EXEC CICS HANDLE CONDITION
  2265*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  2266*    END-EXEC.
  2267*
  2268*    EXEC CICS STARTBR
  2269*        DATASET   (ELLETR-FILE-ID)
  2270*        RIDFLD    (ELLETR-KEY)
  2271*        GTEQ
  2272*    END-EXEC.
  2273 5100-READPREV-LOOP.
  2274*    EXEC CICS READPREV
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  41
* EL1044.cbl
  2275*        DATASET   (ELLETR-FILE-ID)
  2276*        SET       (ADDRESS OF PRODUCT-MASTER)
  2277*        RIDFLD    (ELLETR-KEY)
  2278*    END-EXEC.
  2279*
  2280*    IF PD-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  2281*        GO TO 5100-UNSUCCESSFUL-SEARCH.
  2282*
  2283*    IF ELLETR-KEY IS EQUAL TO PI-PREV-LETR-KEY
  2284*        GO TO 5100-READPREV-LOOP.
  2285*
  2286*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2287*
  2288*    GO TO 7000-BUILD-OUTPUT-MAP.
  2289 5100-END-BROWSE.
  2290*    EXEC CICS ENDBR
  2291*        DATASET   (ELLETR-FILE-ID)
  2292*    END-EXEC.
  2293 5100-UNSUCCESSFUL-SEARCH.
  2294     PERFORM 5100-END-BROWSE.
  2295     MOVE ER-0131                    TO  EMI-ERROR.
  2296     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2297     GO TO 1000-SHOW-LETR-RECORD.
  2298     .
  2299 6000-EDIT-INPUT-DATA.
  2300     IF MAINTI = 'A'
  2301        IF ZLETRL > +0
  2302           AND ZLETRI NOT = SPACES
  2303           CONTINUE
  2304        ELSE
  2305           MOVE AL-UNBON         TO ZCOPIESA
  2306           MOVE -1               TO ZCOPIESL
  2307           MOVE ER-0005          TO EMI-ERROR
  2308           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2309        END-IF
  2310     END-IF
  2311     IF ZCOPIESL > +0
  2312        IF ZCOPIESI NUMERIC
  2313           CONTINUE
  2314        ELSE
  2315           MOVE AL-UNBON         TO ZCOPIESA
  2316           MOVE -1               TO ZCOPIESL
  2317           MOVE ER-0184          TO EMI-ERROR
  2318           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2319        END-IF
  2320     END-IF
  2321     IF ZFADAYSL > +0
  2322       IF ZFADAYSI NOT EQUAL SPACES
  2323          IF ZFADAYSI NUMERIC
  2324             CONTINUE
  2325          ELSE
  2326             MOVE AL-UNBON         TO ZFADAYSA
  2327             MOVE -1               TO ZFADAYSL
  2328             MOVE ER-0491          TO EMI-ERROR
  2329             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2330          END-IF
  2331       END-IF
  2332     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  42
* EL1044.cbl
  2333     IF ZRDAYSL > +0
  2334       IF ZRDAYSI NOT EQUAL SPACES
  2335          IF ZRDAYSI NUMERIC
  2336             CONTINUE
  2337          ELSE
  2338             MOVE AL-UNBON         TO ZRDAYSA
  2339             MOVE -1               TO ZRDAYSL
  2340             MOVE ER-0491          TO EMI-ERROR
  2341             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2342          END-IF
  2343       END-IF
  2344     END-IF
  2345     IF ZPROMPTL > +0
  2346        IF ZPROMPTI = 'Y' OR 'N' OR ' '
  2347           CONTINUE
  2348        ELSE
  2349           MOVE AL-UABON         TO ZPROMPTA
  2350           MOVE -1               TO ZPROMPTL
  2351           MOVE ER-0627          TO EMI-ERROR
  2352           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2353        END-IF
  2354     END-IF
  2355     IF MAINTI = 'A'
  2356        AND ZENCCDL <= 0
  2357        MOVE AL-UABON            TO ZENCCDA
  2358        MOVE -1                  TO ZENCCDL
  2359        MOVE ER-1560             TO EMI-ERROR
  2360        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2361     END-IF
  2362     IF ZENCCDL > +0
  2363        IF ZENCCDI = 'E' OR 'ENV' OR '0' OR '@'
  2364                  OR 'A' OR 'C' OR 'CLM'
  2365                  OR 'RE'
  2366                  OR '1' OR '2' OR '3' OR 'B' OR 'D'
  2367           CONTINUE
  2368        ELSE
  2369           MOVE AL-UABON         TO ZENCCDA
  2370           MOVE -1               TO ZENCCDL
  2371           MOVE ER-1560          TO EMI-ERROR
  2372           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2373        END-IF
  2374     END-IF
  2375     IF MAINTI = 'A'
  2376        AND ZTYPEL <= 0
  2377        MOVE AL-UABON            TO ZTYPEA
  2378        MOVE -1                  TO ZTYPEL
  2379        MOVE ER-1564             TO EMI-ERROR
  2380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2381     END-IF
  2382     IF ZTYPEL > +0
  2383        IF ZTYPEI = 'C' OR 'P' OR 'U'
  2384           CONTINUE
  2385        ELSE
  2386           MOVE -1               TO ZTYPEL
  2387           MOVE AL-UABON         TO ZTYPEA
  2388           MOVE ER-1564          TO EMI-ERROR
  2389           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2390        END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  43
* EL1044.cbl
  2391     END-IF
  2392     IF ZACLOSEL > +0
  2393        IF ZACLOSEI = 'S' OR 'C' OR 'B' OR ' '
  2394           CONTINUE
  2395        ELSE
  2396           MOVE -1               TO ZACLOSEL
  2397           MOVE AL-UABON         TO ZACLOSEA
  2398           MOVE ER-1562          TO EMI-ERROR
  2399           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2400        END-IF
  2401     END-IF
  2402     IF ZPRTCRTL > +0
  2403        IF ZPRTCRTI = 'Y' OR 'N' OR ' '
  2404           CONTINUE
  2405        ELSE
  2406           MOVE AL-UABON         TO ZPRTCRTA
  2407           MOVE -1               TO ZPRTCRTL
  2408           MOVE ER-0627          TO EMI-ERROR
  2409           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2410        END-IF
  2411     END-IF
  2412     IF ZREFREQL > +0
  2413        IF ZREFREQI = 'Y' OR 'N' OR ' '
  2414           CONTINUE
  2415        ELSE
  2416           MOVE AL-UABON         TO ZREFREQA
  2417           MOVE -1               TO ZREFREQL
  2418           MOVE ER-0627          TO EMI-ERROR
  2419           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2420        END-IF
  2421     END-IF
  2422     IF MAINTI = 'A'
  2423        AND ZONBASEL <= 0
  2424        MOVE AL-UABON            TO ZONBASEA
  2425        MOVE -1                  TO ZONBASEL
  2426        MOVE ER-3804             TO EMI-ERROR
  2427        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2428     END-IF
  2429     IF ZONBASEL > +0
  2430        IF ZONBASEI = ' '
  2431           MOVE AL-UABON            TO ZONBASEA
  2432           MOVE -1                  TO ZONBASEL
  2433           MOVE ER-3804             TO EMI-ERROR
  2434           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2435        END-IF
  2436     END-IF
  2437
  2438     IF ZACTSUML > +0
  2439        IF ZACTSUMI = '1' OR '2' OR ' '
  2440           CONTINUE
  2441        ELSE
  2442           MOVE AL-UABON         TO ZACTSUMA
  2443           MOVE -1               TO ZACTSUML
  2444           MOVE ER-3820          TO EMI-ERROR
  2445           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2446        END-IF
  2447     END-IF
  2448
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  44
* EL1044.cbl
  2449     IF ZCSOSUML > +0
  2450        IF ZCSOSUMI = '3' OR '4' OR ' '
  2451           CONTINUE
  2452        ELSE
  2453           MOVE AL-UABON         TO ZCSOSUMA
  2454           MOVE -1               TO ZCSOSUML
  2455           MOVE ER-3821          TO EMI-ERROR
  2456           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2457        END-IF
  2458     END-IF
  2459
  2460     IF ZREASONL > +0
  2461        IF ZREASONI = 'Y' OR 'N' OR ' '
  2462           CONTINUE
  2463        ELSE
  2464           MOVE AL-UABON         TO ZREASONA
  2465           MOVE -1               TO ZREASONL
  2466           MOVE ER-0627          TO EMI-ERROR
  2467           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2468        END-IF
  2469     END-IF
  2470
  2471     IF ZBARCODL > +0
  2472        IF ZBARCODI = 'Y' OR 'N' OR ' '
  2473           CONTINUE
  2474        ELSE
  2475           MOVE AL-UABON         TO ZBARCODA
  2476           MOVE -1               TO ZBARCODL
  2477           MOVE ER-0627          TO EMI-ERROR
  2478           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2479        END-IF
  2480     END-IF
  2481
  2482     IF ZRETENVL > +0
  2483        IF ZRETENVI = 'Y' OR 'N' OR ' '
  2484           CONTINUE
  2485        ELSE
  2486           MOVE AL-UABON         TO ZRETENVA
  2487           MOVE -1               TO ZRETENVL
  2488           MOVE ER-0627          TO EMI-ERROR
  2489           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2490        END-IF
  2491     END-IF
  2492
  2493     .
  2494 6000-EXIT.
  2495     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  45
* EL1044.cbl
  2497 7000-BUILD-OUTPUT-MAP.
  2498     MOVE LOW-VALUES             TO EL1044ZO
  2499     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2500     MOVE TX-LETTER-NO           TO ZLETRO
  2501     MOVE W-NUMBER-OF-COPIES     TO ZCOPIESO
  2502     MOVE W-DAYS-TO-FOLLOW-UP    TO ZFADAYSO
  2503     MOVE W-DAYS-TO-RESEND       TO ZRDAYSO
  2504     MOVE W-FORM-TO-RESEND       TO ZFORMO
  2505     MOVE W-PROMPT-LETTER        TO ZPROMPTO
  2506     MOVE W-ENCLOSURE-CD         TO ZENCCDO
  2507     MOVE W-AUTO-CLOSE-IND       TO ZACLOSEO
  2508     MOVE W-LETTER-TO-BENE       TO ZBENEO
  2509     MOVE W-LETTER-TO-ACCT       TO ZACCTO
  2510     MOVE W-LETTER-TYPE          TO ZTYPEO
  2511     MOVE W-PRINT-CERTIFICATE    TO ZPRTCRTO
  2512     MOVE W-REFUND-REQUIRED      TO ZREFREQO
  2513     MOVE W-ONBASE-CODE          TO ZONBASEO
  2514     MOVE W-ACCT-SUMM            TO ZACTSUMO
  2515     MOVE W-CSO-SUMM             TO ZCSOSUMO
  2516     MOVE W-REASONS-REQUIRED     TO ZREASONO
  2517     MOVE W-ADD-BAR-CODE         TO ZBARCODO
  2518     MOVE W-HAS-RETURN-ENV       TO ZRETENVO
  2519     MOVE TX-LAST-MAINTENANCED-BY TO LSTUSRO
  2520                                    PI-UPDATE-BY
  2521     MOVE TX-LAST-MAINTENANCED-DT TO PI-UPDATE-DT
  2522                                    DC-BIN-DATE-1
  2523     MOVE ' '                    TO DC-OPTION-CODE
  2524     MOVE +0                     TO DC-ELAPSED-DAYS
  2525                                     DC-ELAPSED-MONTHS.
  2526     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2527     IF NO-CONVERSION-ERROR
  2528        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2529     ELSE
  2530        MOVE LOW-VALUES          TO LSTDTEO
  2531     END-IF
  2532     MOVE -1                     TO MAINTL
  2533     .
  2534 8100-SEND-INITIAL-MAP.
  2535     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2536     MOVE EIBTIME                    TO  TIME-IN.
  2537     MOVE SAVE-DATE                  TO  DATEO.
  2538     MOVE TIME-OUT                   TO  TIMEO
  2539     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2540     MOVE PI-PROCESSOR-ID        TO USERIDO
  2541
  2542* EXEC CICS SEND
  2543*        MAP      (WS-MAP-NAME)
  2544*        MAPSET   (MAPSET-NAME)
  2545*        FROM     (EL1044ZO)
  2546*        ERASE
  2547*        CURSOR
  2548*    END-EXEC.
  2549     MOVE LENGTH OF
  2550      EL1044ZO
  2551       TO DFHEIV12
  2552     MOVE -1
  2553       TO DFHEIV11
  2554*    MOVE '8$     CT  E    H L F ,   #00002379' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  46
* EL1044.cbl
  2555     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2556     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2557     MOVE X'2020233030303032333739' TO DFHEIV0(25:11)
  2558     CALL 'kxdfhei1' USING DFHEIV0,
  2559           WS-MAP-NAME,
  2560           EL1044ZO,
  2561           DFHEIV12,
  2562           MAPSET-NAME,
  2563           DFHEIV99,
  2564           DFHEIV99,
  2565           DFHEIV99,
  2566           DFHEIV11,
  2567           DFHEIV99,
  2568           DFHEIV99,
  2569           DFHEIV99
  2570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2571
  2572     MOVE '044Z'                 TO PI-CURRENT-SCREEN-NO
  2573     GO TO 9100-RETURN-TRAN
  2574     .
  2575 8200-SEND-DATAONLY.
  2576*    DISPLAY ' MADE IT TO 8200 '
  2577     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2578     MOVE EIBTIME                    TO  TIME-IN.
  2579     MOVE SAVE-DATE                  TO  DATEO.
  2580     MOVE TIME-OUT                   TO  TIMEO.
  2581     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2582     MOVE PI-PROCESSOR-ID        TO USERIDO
  2583
  2584* EXEC CICS SEND
  2585*        MAP      (WS-MAP-NAME)
  2586*        MAPSET   (MAPSET-NAME)
  2587*        FROM     (EL1044ZO)
  2588*        DATAONLY
  2589*        CURSOR
  2590*    END-EXEC.
  2591     MOVE LENGTH OF
  2592      EL1044ZO
  2593       TO DFHEIV12
  2594     MOVE -1
  2595       TO DFHEIV11
  2596*    MOVE '8$D    CT       H L F ,   #00002397' TO DFHEIV0
  2597     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2598     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2599     MOVE X'2020233030303032333937' TO DFHEIV0(25:11)
  2600     CALL 'kxdfhei1' USING DFHEIV0,
  2601           WS-MAP-NAME,
  2602           EL1044ZO,
  2603           DFHEIV12,
  2604           MAPSET-NAME,
  2605           DFHEIV99,
  2606           DFHEIV99,
  2607           DFHEIV99,
  2608           DFHEIV11,
  2609           DFHEIV99,
  2610           DFHEIV99,
  2611           DFHEIV99
  2612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  47
* EL1044.cbl
  2613
  2614     GO TO 9100-RETURN-TRAN
  2615     .
  2616 8300-SEND-TEXT.
  2617
  2618* EXEC CICS SEND TEXT
  2619*        FROM  (LOGOFF-TEXT)
  2620*        LENGTH(LOGOFF-LENGTH)
  2621*        ERASE
  2622*        FREEKB
  2623*    END-EXEC.
  2624*    MOVE '8&      T  E F  H   F -   #00002407' TO DFHEIV0
  2625     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2626     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2627     MOVE X'2020233030303032343037' TO DFHEIV0(25:11)
  2628     CALL 'kxdfhei1' USING DFHEIV0,
  2629           LOGOFF-TEXT,
  2630           LOGOFF-LENGTH,
  2631           DFHEIV99,
  2632           DFHEIV99,
  2633           DFHEIV99,
  2634           DFHEIV99,
  2635           DFHEIV99,
  2636           DFHEIV99,
  2637           DFHEIV99,
  2638           DFHEIV99,
  2639           DFHEIV99,
  2640           DFHEIV99
  2641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2642
  2643
  2644* EXEC CICS RETURN
  2645*        END-EXEC.
  2646*    MOVE '.(                    ''   #00002413' TO DFHEIV0
  2647     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2648     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2649     MOVE X'2020233030303032343133' TO DFHEIV0(25:11)
  2650     CALL 'kxdfhei1' USING DFHEIV0,
  2651           DFHEIV99,
  2652           DFHEIV99,
  2653           DFHEIV99,
  2654           DFHEIV99,
  2655           DFHEIV99,
  2656           DFHEIV99
  2657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2658
  2659     .
  2660 8500-DEEDIT.
  2661     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2662                                 TO WS-9V999-OF-DEEDIT
  2663     .
  2664 8500-EXIT.
  2665     EXIT.
  2666 8600-DEEDIT.
  2667     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2668                                 TO WS-NUMVAL-OF-DEEDIT
  2669     .
  2670 8600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  48
* EL1044.cbl
  2671     EXIT.
  2672 8800-UNAUTHORIZED-ACCESS.
  2673     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  2674     GO TO 8300-SEND-TEXT.
  2675 8810-PF23.
  2676     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  2677     MOVE XCTL-005                   TO  PGM-NAME.
  2678     GO TO 9300-XCTL.
  2679 8850-DUPREC.
  2680     MOVE ER-0132                    TO  EMI-ERROR.
  2681     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2682     MOVE -1                         TO  MAINTL
  2683     MOVE AL-UABON                   TO  ZLETRA
  2684     GO TO 8100-SEND-INITIAL-MAP.
  2685 8870-NOTOPEN.
  2686     MOVE LOW-VALUES                 TO  EL1044ZO.
  2687     MOVE -1                         TO  MAINTL.
  2688     MOVE ER-0701                    TO  EMI-ERROR.
  2689     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2690     GO TO 8100-SEND-INITIAL-MAP.
  2691 8880-NOT-FOUND.
  2692     MOVE ER-0702                    TO  EMI-ERROR.
  2693     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2694     MOVE -1                         TO  MAINTL
  2695     MOVE AL-UABON                   TO  ZLETRA
  2696     GO TO 8100-SEND-INITIAL-MAP.
  2697     .
  2698 9100-RETURN-TRAN.
  2699     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  2700
  2701* EXEC CICS RETURN
  2702*        TRANSID    (TRANS-ID)
  2703*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2704*        LENGTH     (PI-COMM-LENGTH)
  2705*    END-EXEC.
  2706*    MOVE '.(CT                  ''   #00002456' TO DFHEIV0
  2707     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2708     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2709     MOVE X'2020233030303032343536' TO DFHEIV0(25:11)
  2710     CALL 'kxdfhei1' USING DFHEIV0,
  2711           TRANS-ID,
  2712           PROGRAM-INTERFACE-BLOCK,
  2713           PI-COMM-LENGTH,
  2714           DFHEIV99,
  2715           DFHEIV99,
  2716           DFHEIV99
  2717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2718
  2719 9200-RETURN-MAIN-MENU.
  2720     MOVE XCTL-626                   TO  PGM-NAME.
  2721     GO TO 9300-XCTL.
  2722 9300-XCTL.
  2723
  2724* EXEC CICS XCTL
  2725*        PROGRAM    (PGM-NAME)
  2726*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2727*        LENGTH     (PI-COMM-LENGTH)
  2728*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  49
* EL1044.cbl
  2729*    MOVE '.$C                   %   #00002465' TO DFHEIV0
  2730     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2731     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2732     MOVE X'2020233030303032343635' TO DFHEIV0(25:11)
  2733     CALL 'kxdfhei1' USING DFHEIV0,
  2734           PGM-NAME,
  2735           PROGRAM-INTERFACE-BLOCK,
  2736           PI-COMM-LENGTH,
  2737           DFHEIV99
  2738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2739
  2740 9400-CLEAR.
  2741     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  2742     GO TO 9300-XCTL.
  2743 9500-PF12.
  2744     MOVE XCTL-010                   TO  PGM-NAME.
  2745     GO TO 9300-XCTL.
  2746 9600-PGMID-ERROR.
  2747
  2748* EXEC CICS HANDLE CONDITION
  2749*        PGMIDERR   (8300-SEND-TEXT)
  2750*    END-EXEC.
  2751*    MOVE '"$L                   ! # #00002477' TO DFHEIV0
  2752     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2754     MOVE X'2320233030303032343737' TO DFHEIV0(25:11)
  2755     CALL 'kxdfhei1' USING DFHEIV0
  2756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2757
  2758     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  2759     MOVE ' '                        TO  PI-ENTRY-CD-1.
  2760     MOVE XCTL-005                   TO  PGM-NAME.
  2761     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  2762     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  2763     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  50
* EL1044.cbl
  2765 9700-LINK-DATE-CONVERT.
  2766
  2767* EXEC CICS LINK
  2768*        PROGRAM    ('ELDATCV')
  2769*        COMMAREA   (DATE-CONVERSION-DATA)
  2770*        LENGTH     (DC-COMM-LENGTH)
  2771*    END-EXEC.
  2772     MOVE 'ELDATCV' TO DFHEIV1
  2773*    MOVE '."C                   (   #00002488' TO DFHEIV0
  2774     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2775     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2776     MOVE X'2020233030303032343838' TO DFHEIV0(25:11)
  2777     CALL 'kxdfhei1' USING DFHEIV0,
  2778           DFHEIV1,
  2779           DATE-CONVERSION-DATA,
  2780           DC-COMM-LENGTH,
  2781           DFHEIV99,
  2782           DFHEIV99,
  2783           DFHEIV99,
  2784           DFHEIV99
  2785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2786
  2787 9700-EXIT.
  2788     EXIT.
  2789 9900-ERROR-FORMAT.
  2790     IF NOT EMI-ERRORS-COMPLETE
  2791         MOVE LINK-001               TO  PGM-NAME
  2792
  2793* EXEC CICS LINK
  2794*            PROGRAM    (PGM-NAME)
  2795*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2796*            LENGTH     (EMI-COMM-LENGTH)
  2797*        END-EXEC.
  2798*    MOVE '."C                   (   #00002498' TO DFHEIV0
  2799     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2800     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2801     MOVE X'2020233030303032343938' TO DFHEIV0(25:11)
  2802     CALL 'kxdfhei1' USING DFHEIV0,
  2803           PGM-NAME,
  2804           ERROR-MESSAGE-INTERFACE-BLOCK,
  2805           EMI-COMM-LENGTH,
  2806           DFHEIV99,
  2807           DFHEIV99,
  2808           DFHEIV99,
  2809           DFHEIV99
  2810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2811
  2812 9900-EXIT.
  2813     EXIT.
  2814 9990-ABEND.
  2815     MOVE LINK-004                   TO  PGM-NAME.
  2816     MOVE DFHEIBLK                   TO  EMI-LINE1.
  2817
  2818* EXEC CICS LINK
  2819*        PROGRAM   (PGM-NAME)
  2820*        COMMAREA  (EMI-LINE1)
  2821*        LENGTH    (72)
  2822*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  51
* EL1044.cbl
  2823     MOVE 72
  2824       TO DFHEIV11
  2825*    MOVE '."C                   (   #00002508' TO DFHEIV0
  2826     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2827     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2828     MOVE X'2020233030303032353038' TO DFHEIV0(25:11)
  2829     CALL 'kxdfhei1' USING DFHEIV0,
  2830           PGM-NAME,
  2831           EMI-LINE1,
  2832           DFHEIV11,
  2833           DFHEIV99,
  2834           DFHEIV99,
  2835           DFHEIV99,
  2836           DFHEIV99
  2837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2838
  2839     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  52
* EL1044.cbl
  2841 9995-SECURITY-VIOLATION.
  2842*                            COPY ELCSCTP.
  2843******************************************************************
  2844*                                                                *
  2845*                            ELCSCTP                             *
  2846*                            VMOD=2.001                          *
  2847*                                                                *
  2848*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2849******************************************************************
  2850
  2851
  2852     MOVE EIBDATE          TO SM-JUL-DATE.
  2853     MOVE EIBTRMID         TO SM-TERMID.
  2854     MOVE THIS-PGM         TO SM-PGM.
  2855     MOVE EIBTIME          TO TIME-IN.
  2856     MOVE TIME-OUT         TO SM-TIME.
  2857     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2858
  2859
  2860* EXEC CICS LINK
  2861*         PROGRAM  ('EL003')
  2862*         COMMAREA (SECURITY-MESSAGE)
  2863*         LENGTH   (80)
  2864*    END-EXEC.
  2865     MOVE 'EL003' TO DFHEIV1
  2866     MOVE 80
  2867       TO DFHEIV11
  2868*    MOVE '."C                   (   #00002533' TO DFHEIV0
  2869     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2870     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2871     MOVE X'2020233030303032353333' TO DFHEIV0(25:11)
  2872     CALL 'kxdfhei1' USING DFHEIV0,
  2873           DFHEIV1,
  2874           SECURITY-MESSAGE,
  2875           DFHEIV11,
  2876           DFHEIV99,
  2877           DFHEIV99,
  2878           DFHEIV99,
  2879           DFHEIV99
  2880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2881
  2882
  2883******************************************************************
  2884
  2885 9995-EXIT.
  2886     EXIT.
  2887
  2888 9999-DFHBACK SECTION.
  2889     MOVE '9%                    "   ' TO DFHEIV0
  2890     MOVE 'EL1044' TO DFHEIV1
  2891     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2892     GOBACK.
  2893 9999-DFHEXIT.
  2894     IF DFHEIGDJ EQUAL 0001
  2895         NEXT SENTENCE
  2896     ELSE IF DFHEIGDJ EQUAL 2
  2897         GO TO 8850-DUPREC,
  2898               8870-NOTOPEN,
* Micro Focus Server Express         V5.1 revision 000 10-Sep-13 09:22 Page  53
* EL1044.cbl
  2899               8880-NOT-FOUND,
  2900               9600-PGMID-ERROR,
  2901               9990-ABEND
  2902         DEPENDING ON DFHEIGDI
  2903     ELSE IF DFHEIGDJ EQUAL 3
  2904         GO TO 8300-SEND-TEXT
  2905         DEPENDING ON DFHEIGDI.
  2906     MOVE '9%                    "   ' TO DFHEIV0
  2907     MOVE 'EL1044' TO DFHEIV1
  2908     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2909     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4632     Code:        7131
