* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    70******************************************************************
    71
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   3
* EL6311.cbl
    72 ENVIRONMENT DIVISION.
    73
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   4
* EL6311.cbl
    75 DATA DIVISION.
    76 WORKING-STORAGE SECTION.
    77 01  DFH-START PIC X(04).
    78 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    79 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    80 77  FILLER  PIC X(32)  VALUE '********************************'.
    81 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    82 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    83 77  A1                          PIC S999 COMP-3 VALUE +0.
    84 77  N1                          PIC S999 COMP-3 VALUE +0.
    85 77  N2                          PIC S999 COMP-3 VALUE +0.
    86 77  N3                          PIC S999 COMP-3 VALUE +0.
    87 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    88 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    89 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    90     88  REVERSAL                    VALUE 'Y'.
    91 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    92 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    93 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    94 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    95 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
    96     88  ERMAIL-FOUND                 VALUE 'Y'.
    97 77  A2                          PIC S9(5) COMP-3 VALUE +0.
    98 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    99 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   100 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   101     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   102
   103*    COPY ELCSCTM.
   104******************************************************************
   105*                                                                *
   106*                                                                *
   107*                            ELCSCTM                             *
   108*                            VMOD=2.001                          *
   109*                                                                *
   110*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   111*                                                                *
   112******************************************************************
   113 01  SECURITY-MESSAGE.
   114     12  FILLER                          PIC X(30)
   115            VALUE '** LOGIC SECURITY VIOLATION -'.
   116     12  SM-READ                         PIC X(6).
   117     12  FILLER                          PIC X(5)
   118            VALUE ' PGM='.
   119     12  SM-PGM                          PIC X(6).
   120     12  FILLER                          PIC X(5)
   121            VALUE ' OPR='.
   122     12  SM-PROCESSOR-ID                 PIC X(4).
   123     12  FILLER                          PIC X(6)
   124            VALUE ' TERM='.
   125     12  SM-TERMID                       PIC X(4).
   126     12  FILLER                          PIC XX   VALUE SPACE.
   127     12  SM-JUL-DATE                     PIC 9(5).
   128     12  FILLER                          PIC X    VALUE SPACE.
   129     12  SM-TIME                         PIC 99.99.
   130
   131
   132*    COPY ELCSCRTY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   5
* EL6311.cbl
   133******************************************************************
   134*                                                                *
   135*                                                                *
   136*                            ELCSCRTY                            *
   137*                            VMOD=2.001                          *
   138*                                                                *
   139*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   140*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   141*        SAVED IN PI-SECURITY-ADDRESS.                           *
   142*                                                                *
   143******************************************************************
   144 01  SECURITY-CONTROL.
   145     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   146     12  FILLER                       PIC XX    VALUE 'SC'.
   147     12  SC-CREDIT-CODES.
   148         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   149             20  SC-CREDIT-DISPLAY    PIC X.
   150             20  SC-CREDIT-UPDATE     PIC X.
   151     12  SC-CLAIMS-CODES.
   152         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   153             20  SC-CLAIMS-DISPLAY    PIC X.
   154             20  SC-CLAIMS-UPDATE     PIC X.
   155
   156 01  WS-VA-NO-COMM-MESS.
   157     12  FILLER                  PIC X(41) VALUE
   158        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   159 01  WS-OC-MESSAGE.
   160     12  FILLER                  PIC X(43) VALUE
   161        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   162     12  WS-OC-DIS-AMT           PIC -----9.99.
   163     12  FILLER                  PIC X(4) VALUE ' ON '.
   164     12  WS-OC-DATE              PIC X(10).
   165 01  WS-DATE-AREA.
   166     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   167     12  WS-CURRENT-DT.
   168         16  FILLER              PIC X(6)    VALUE SPACES.
   169         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   170     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   171     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   172     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   173
   174 01  STANDARD-AREAS.
   175     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   176     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   177     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   178     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   179     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   180     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   181     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   182     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   183     12  PGM-NAME                PIC X(8).
   184     12  TIME-IN                 PIC S9(7).
   185     12  TIME-OUT-R  REDEFINES TIME-IN.
   186         16  FILLER              PIC X.
   187         16  TIME-OUT            PIC 99V99.
   188         16  FILLER              PIC XX.
   189     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   190     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   6
* EL6311.cbl
   191     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   192     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   193     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   194     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   195     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   196     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   197     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   198     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   199     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   200     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   201     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   202     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   203     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   204     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   205     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   206     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   207     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   208     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   209     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   210     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   211     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   212     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   213     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   214     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   215     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   216     12  FILE-ID                 PIC X(8).
   217     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   218     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   219     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   220     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   221     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   222     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   223     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   224     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   225     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   226     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   227     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   228     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   229     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   230     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   231     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   232
   233 01  WS-PASS-AREA.
   234     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   235     05  WS-PASS-VADS-REC    PIC X(350).
   236*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   237*                                COPY ELCZREC.
   238******************************************************************
   239*                                                                *
   240*                                                                *
   241*                            ELCZREC.                            *
   242*                                                                *
   243*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   244*                                                                *
   245******************************************************************
   246*-----------------------------------------------------------------
   247*                   C H A N G E   L O G
   248*
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   7
* EL6311.cbl
   249* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   250*-----------------------------------------------------------------
   251*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   252* EFFECTIVE    NUMBER
   253*-----------------------------------------------------------------
   254* 122011    2011022800001  AJRA  NEW FILE
   255* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   256* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   257* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   258* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   259*-----------------------------------------------------------------
   260 01  W-Z-CONTROL-DATA.
   261     05  W-NUMBER-OF-COPIES      PIC  9.
   262     05  FILLER                  PIC  X.
   263     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   264     05  FILLER                  PIC  X.
   265     05  W-DAYS-TO-RESEND        PIC  999.
   266     05  FILLER                  PIC  X.
   267     05  W-FORM-TO-RESEND        PIC  X(4).
   268     05  W-ADD-BAR-CODE          PIC  X.
   269     05  W-PROMPT-LETTER         PIC  X.
   270     05  W-HAS-RETURN-ENV        PIC  X.
   271     05  W-ENCLOSURE-CD          PIC  XXX.
   272     05  W-SIG-FLAG-DEFAULT      PIC  X.
   273     05  W-AUTO-CLOSE-IND        PIC  X.
   274     05  FILLER                  PIC  X.
   275     05  W-LETTER-TO-BENE        PIC  X.
   276     05  FILLER                  PIC  X.
   277     05  W-LETTER-TO-ACCT        PIC  X.
   278     05  FILLER                  PIC  X.
   279     05  W-LETTER-TYPE           PIC  X.
   280     05  FILLER                  PIC  X.
   281     05  W-PRINT-CERTIFICATE     PIC  X.
   282     05  FILLER                  PIC  X.
   283     05  W-REFUND-REQUIRED       PIC  X.
   284     05  FILLER                  PIC  X.
   285     05  W-ONBASE-CODE           PIC  XX.
   286     05  FILLER                  PIC  X.
   287     05  W-ACCT-SUMM             PIC  X.
   288     05  FILLER                  PIC  X.
   289     05  W-CSO-SUMM              PIC  X.
   290     05  FILLER                  PIC  X.
   291     05  W-REASONS-REQUIRED      PIC  X.
   292     05  FILLER                  PIC  X(29).
   293******************************************************************
   294*                                                                *
   295*              A C C E S S   K E Y S                             *
   296*                                                                *
   297******************************************************************
   298
   299 01  ACCESS-KEYS.
   300     12  ERPYAJ-KEY.
   301         16  ERPYAJ-COMPANY-CD       PIC X.
   302         16  ERPYAJ-CARRIER          PIC X.
   303         16  ERPYAJ-GROUPING         PIC X(6).
   304         16  ERPYAJ-FIN-RESP         PIC X(10).
   305         16  ERPYAJ-ACCOUNT          PIC X(10).
   306         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   8
* EL6311.cbl
   307         16  ERPYAJ-TYPE             PIC X.
   308     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   309     12  ELCERT-KEY.
   310         16  ELCERT-COMPANY-CD       PIC X.
   311         16  ELCERT-CARRIER          PIC X.
   312         16  ELCERT-GROUPING         PIC X(6).
   313         16  ELCERT-STATE            PIC XX.
   314         16  ELCERT-ACCOUNT          PIC X(10).
   315         16  ELCERT-CERT-EFF-DT      PIC XX.
   316         16  ELCERT-CERT-NO.
   317             20  ELCERT-CERT-PRIME   PIC X(10).
   318             20  ELCERT-CERT-SFX     PIC X.
   319
   320     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   321     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   322     12  ELCRTO-KEY.
   323         16  ELCRTO-COMPANY-CD       PIC X.
   324         16  ELCRTO-CARRIER          PIC X.
   325         16  ELCRTO-GROUPING         PIC X(6).
   326         16  ELCRTO-STATE            PIC XX.
   327         16  ELCRTO-ACCOUNT          PIC X(10).
   328         16  ELCRTO-CERT-EFF-DT      PIC XX.
   329         16  ELCRTO-CERT-NO.
   330             20  ELCRTO-CERT-PRIME   PIC X(10).
   331             20  ELCRTO-CERT-SFX     PIC X.
   332         16  ELCRTO-RECORD-TYPE      PIC X.
   333         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   334
   335     12  ELCRTT-KEY.
   336         16  ELCRTT-PRIMARY          PIC X(33).
   337         16  ELCRTT-REC-TYPE         PIC X(1).
   338     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   339     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   340
   341     12  ERPNDB-KEY.
   342         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   343         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   344         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   345         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   346             ERPNDB-BATCH-SEQ-NO     PIC XX.
   347         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   348
   349     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   350     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   351     12  ELLETR-KEY.
   352         16  LETR-COMPANY-CD     PIC X.
   353         16  LETR-LETTER-ID      PIC X(4).
   354         16  LETR-FILLER         PIC X(8).
   355         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   356     12  ERPNDM-KEY.
   357         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   358         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   359         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   360         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   361
   362*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   363     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   364*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   9
* EL6311.cbl
   365     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   366
   367     12  ERPNDB-ALT-KEY.
   368         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   369         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   370         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   371         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   372         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   373         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   374         16  ERPNDB-CERT-NO.
   375             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   376             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   377         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   378         16  ERPNDB-RECORD-TYPE      PIC X.
   379
   380      12  ERPNDB-CSR-KEY.
   381          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   382          20  ERPNDB-CSR-ID                PIC X(4).
   383          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   384          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   385          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   386
   387     12  ERNOTE-KEY.
   388         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   389         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   390         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   391         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   392         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   393         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   394         16  ERNOTE-CERT-NO.
   395             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   396             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   397
   398     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   399     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   400
   401     12  ERCNOT-KEY.
   402         16  ERCNOT-PART-KEY.
   403             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   404             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   405             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   406             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   407             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   408             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   409             20  ERCNOT-CERT-NO.
   410                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   411                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   412         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   413         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   414
   415     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   416     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   417
   418     12  ERMAIL-KEY.
   419         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   420         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   421         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   422         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  10
* EL6311.cbl
   423         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   424         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   425         16  ERMAIL-CERT-NO.
   426             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   427             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   428
   429     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   430     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   431
   432     12  ERRQST-KEY.
   433         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   434         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   435
   436     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   437     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   438
   439     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   440
   441     12  ERLOFC-KEY.
   442         16  ERLOFC-COMPANY-CD          PIC  X.
   443         16  ERLOFC-CARRIER             PIC  X.
   444         16  ERLOFC-GROUPING            PIC  X(6).
   445         16  ERLOFC-STATE               PIC  XX.
   446         16  ERLOFC-ACCOUNT             PIC  X(10).
   447         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   448*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   449
   450     12  ERACCT-KEY.
   451         16  ERACCT-COMPANY-CD          PIC  X.
   452         16  ERACCT-CARRIER             PIC  X.
   453         16  ERACCT-GROUPING            PIC  X(6).
   454         16  ERACCT-STATE               PIC  XX.
   455         16  ERACCT-ACCOUNT             PIC  X(10).
   456         16  ERACCT-EXP-DT.
   457             20  ERACCT-DT              PIC  XX.
   458             20  ERACCT-FILL            PIC  X(4).
   459
   460     12  ERENDT-KEY.
   461         16  ENDT-COMPANY-CD       PIC X.
   462         16  ENDT-CARRIER          PIC X.
   463         16  ENDT-GROUPING         PIC X(6).
   464         16  ENDT-STATE            PIC XX.
   465         16  ENDT-ACCOUNT          PIC X(10).
   466         16  ENDT-CERT-EFF-DT      PIC XX.
   467         16  ENDT-CERT-PRIME       PIC X(10).
   468         16  ENDT-CERT-SFX         PIC X.
   469         16  ENDT-RECORD-TYPE      PIC X.
   470         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   471
   472 01  WS-ELMSTR-WORK.
   473     12  ELMSTR-KEY.
   474         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   475         16  MSTR-CERT-NO.
   476             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   477             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   478     12  W-CLAIM-KEY.
   479         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   480         16  W-CL-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  11
* EL6311.cbl
   481             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   482             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   483      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   484 01  CANCEL-GEN-PASS-AREA.
   485     05  CG-OPTION-CODE          PIC X.
   486         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   487         88  CG-FLAT-CANCEL        VALUE '1'.
   488         88  CG-CANCEL             VALUE '2'.
   489         88  CG-CANCEL-REISSUE     VALUE '3'.
   490     05  CG-ERROR-CODE           PIC 99.
   491         88  CG-SUCCESS            VALUE 00.
   492         88  CG-DATE-ERROR         VALUE 01.
   493         88  CG-CERT-NOT-FOUND     VALUE 02.
   494         88  CG-AMOUNT-ERROR       VALUE 04.
   495         88  CG-OPTION-ERROR       VALUE 05.
   496         88  CG-PREV-CAN           VALUE 06.
   497         88  CG-INVALID-DATA       VALUE 07.
   498         88  CG-NO-ACCT-MSTR       VALUE 08.
   499         88  CG-SFX-A-EXIST        VALUE 09.
   500         88  CG-MISC-ERROR         VALUE 99.
   501     05  CG-COMPANY-ID           PIC XXX.
   502     05  CG-PROC-ID              PIC XXXX.
   503     05  CG-CURRENT-DT           PIC XX.
   504     05  CG-MONTH-END-DT         PIC XX.
   505     05  CG-CERT-KEY.
   506         10  CG-CERT-COMPANY-CD  PIC X.
   507         10  CG-CERT-CARRIER     PIC X.
   508         10  CG-CERT-GROUP       PIC X(6).
   509         10  CG-CERT-STATE       PIC XX.
   510         10  CG-CERT-ACCOUNT     PIC X(10).
   511         10  CG-CERT-EFF-DT      PIC XX.
   512         10  CG-CERT-CERT-NO     PIC X(11).
   513     05  CG-LF-CAN-DATA.
   514         10  CG-LF-CAN-DT        PIC XX.
   515         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   516     05  CG-AH-CAN-DATA.
   517         10  CG-AH-CAN-DT        PIC XX.
   518         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   519     05  CG-CERT-PROFILE-DATA.
   520         10  CG-INS-LNAME        PIC X(15).
   521         10  CG-INS-FNAME        PIC X(10).
   522         10  CG-INS-MID-INIT     PIC X.
   523         10  CG-INS-AGE          PIC 99.
   524         10  CG-JNT-LNAME        PIC X(15).
   525         10  CG-JNT-FNAME        PIC X(10).
   526         10  CG-JNT-MID-INIT     PIC X.
   527         10  CG-JNT-AGE          PIC 99.
   528     05  CG-LF-ISS-DATA.
   529         10  CG-LF-BENCD         PIC XX.
   530         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   531         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   532     05  CG-AH-ISS-DATA.
   533         10  CG-AH-BENCD         PIC XX.
   534         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   535     05  CG-BATCH-NO             PIC X(6).
   536     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   537     05  FILLER                  PIC X(306).
   538******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  12
* EL6311.cbl
   539*                                                                *
   540*            G E N E R A L   W O R K   A R E A                   *
   541*                                                                *
   542******************************************************************
   543
   544 01  WORK-AREA.
   545     12  WS-RESPONSE             PIC S9(8)   COMP.
   546         88  RESP-NORMAL                  VALUE +00.
   547         88  RESP-NOTFND                  VALUE +13.
   548         88  RESP-DUPREC                  VALUE +14.
   549         88  RESP-DUPKEY                  VALUE +15.
   550         88  RESP-NOTOPEN                 VALUE +19.
   551         88  RESP-ENDFILE                 VALUE +20.
   552     12  DEEDIT-FIELD            PIC X(15).
   553     12  FILLER          REDEFINES DEEDIT-FIELD.
   554         16  FILLER              PIC X(4).
   555         16  DEEDIT-FIELD-X11    PIC X(11).
   556     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   557                                 PIC S9(15).
   558     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   559                                 PIC S9(13)V99.
   560     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   561                                 PIC S9(11)V9999.
   562     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   563     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   564     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   565         16  WS-CALC-TERM-WHOLE  PIC S999.
   566         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   567
   568     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   569     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   570         16  WS-HR-MINS          PIC 99V99.
   571         16  FILLER              PIC XX.
   572
   573     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   574     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   575
   576     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   577     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   578
   579     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   580     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   581     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   582     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   583     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   584     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   585     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   586
   587     12  QID.
   588         16  QID-TERM            PIC X(4).
   589         16  FILLER              PIC X(4)    VALUE '607B'.
   590
   591     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   592         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   593
   594     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   595         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   596
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  13
* EL6311.cbl
   597     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   598         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   599                                         'A'.
   600
   601     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   602
   603     12  WS-NUMERIC-SW           PIC X.
   604        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   605
   606     12  WS-EDIT-CSO-FIELD.
   607         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   608                                 PIC X.
   609
   610     12  WS-SAVE-INPUT-FIELDS.
   611         16  WS-BAGE             PIC 99       VALUE ZERO.
   612*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   613         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   614         16  FILLER REDEFINES WS-BAPR.
   615             20  WS-APR-WHOLE-NUM    PIC 99.
   616             20  WS-APR-DEC          PIC 9999.
   617         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   618         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   619
   620         16  WS-B-COVERAGE OCCURS 2 TIMES.
   621             20  WS-TERM-IN-DAYS-SW  PIC X.
   622                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   623             20  WS-BTERM        PIC 999       COMP-3.
   624             20  WS-BALT-TERM    PIC 999       COMP-3.
   625             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   626             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   627             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   628             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   629             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   630             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   631
   632         16  WS-C-FIELDS COMP-3.
   633             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   634             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   635             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   636
   637         16  WS-D-FIELDS COMP-3.
   638             20  WS-DRISS        PIC S9(5)    VALUE +0.
   639             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   640             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   641             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   642             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   643             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   644
   645     12  WS-SAVE-BIRTH-DATE.
   646         16  FILLER              PIC X(4)   VALUE SPACES.
   647         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   648
   649     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   650     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   651     12  FILLER REDEFINES WS-WORK-BIN-RED.
   652         16  FILLER              PIC X(02).
   653         16  WS-WORK-BIN-DT      PIC X(02).
   654     12  WS-SW-1                 PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  14
* EL6311.cbl
   655     12  WS-SW-2                 PIC X     VALUE SPACE.
   656     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   657         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   658     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   659         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   660
   661     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   662     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   663     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   664     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   665     12  WS-CONVERTED-CANCEL-DATES.
   666         16  WS-CONVERTED-CANDT1                  PIC XX.
   667         16  WS-CONVERTED-CANDT2                  PIC XX.
   668
   669     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   670
   671     12  WS-REC-FOUND-SW         PIC X.
   672         88  RECORD-NOT-FOUND    VALUE 'N'.
   673
   674     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   675         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   676         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   677
   678     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   679         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   680         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   681
   682     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   683         88  BROWSE-STARTED      VALUE 'Y'.
   684
   685     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   686         88  FIRST-TIME          VALUE 'Y'.
   687
   688     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   689         88  FIRST-ENTRY         VALUE 'Y'.
   690
   691     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   692         88  REC-BILLED          VALUE 'Y'.
   693
   694     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   695         88  NO-CURSOR-SET       VALUE +0.
   696         88  CURSOR-SET          VALUE +1.
   697
   698     12  WS-ERR-SW               PIC X.
   699         88  STD-ERRORS          VALUE 'S'.
   700         88  TRN-ERRORS          VALUE 'T'.
   701
   702     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   703         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   704
   705     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   706         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   707
   708     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   709         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   710
   711     12  WS-ERR-CODE.
   712         16  FILLER              PIC 99.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  15
* EL6311.cbl
   713         16  WS-ERROR-SUB        PIC 99.
   714
   715     12  WS-DATE-WORK.
   716         16  WS-WORK-MM          PIC XX.
   717         16  WS-WORK-DD          PIC XX.
   718         16  WS-WORK-YY          PIC XX.
   719
   720     12  WS-MM-YY.
   721         16  WS-MM               PIC XX.
   722         16  FILLER              PIC X     VALUE '/'.
   723         16  WS-YY               PIC XX.
   724
   725     12  WS-CERT-EFF-DT          PIC XX.
   726
   727     12  WS-MEMBER-NO            PIC X(12).
   728     12  FILLER  REDEFINES  WS-MEMBER-NO.
   729         16  WS-MEMBER-NO-1-8    PIC 9(8).
   730         16  FILLER              PIC X(4).
   731
   732     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   733
   734     12  WS-ERPNDB-ALT-KEY.
   735         16  WS-PB-COMPANY-CD-A1         PIC X.
   736         16  WS-PB-CARRIER               PIC X.
   737         16  WS-PB-GROUPING              PIC X(6).
   738         16  WS-PB-STATE                 PIC XX.
   739         16  WS-PB-ACCOUNT               PIC X(10).
   740         16  WS-PB-CERT-EFF-DT           PIC XX.
   741         16  WS-PB-CERT-NO.
   742             20  WS-PB-CERT-PRIME        PIC X(10).
   743             20  WS-PB-CERT-SFX          PIC X.
   744         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   745         16  WS-PB-RECORD-TYPE           PIC X.
   746
   747     12  WS-SHOW-SAVE-AREAS.
   748         16  WS-NEW-CERT-NO.
   749             20  WS-NEW-PRIME    PIC X(10).
   750             20  WS-NEW-SUFFIX   PIC X.
   751         16  WS-NEW-CERT-EFF-DT  PIC XX.
   752         16  WS-NEW-RECORD-TYPE  PIC X.
   753         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   754             88   SHOW-RECORD            VALUE 'Y'.
   755
   756     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   757
   758     12  WS-BATCH-NO.
   759         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   760         16  FILLER              PIC X(5) VALUE SPACES.
   761
   762     12  WS-FIRST-NAME.
   763         16  WS-1ST-INIT         PIC X.
   764         16  FILLER              PIC X(9).
   765
   766     12  WS-INITIALS.
   767         16  WS-INITIAL-1        PIC X.
   768         16  WS-INITIAL-2        PIC X.
   769
   770     12  WS-C-HDG.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  16
* EL6311.cbl
   771         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   772         16  FILLER              PIC X(4) VALUE '-REF'.
   773
   774     12  WS-D-PREM-HDG.
   775         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   776         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   777
   778     12  WS-D-REFUND-HDG.
   779         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   780         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   781
   782     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   783
   784     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   785     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   786     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   787     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   788     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   789     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   790     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   791
   792     12  WS-01-CANCEL-ERR        PIC X(25)
   793         VALUE 'CANCEL DATE ERROR'.
   794     12  WS-02-CANCEL-ERR        PIC X(25)
   795         VALUE 'CERT NOT FOUND'.
   796     12  WS-04-CANCEL-ERR        PIC X(25)
   797         VALUE 'CANCEL AMOUNT ERROR'.
   798     12  WS-05-CANCEL-ERR        PIC X(25)
   799         VALUE 'CANCEL OPTION ERROR'.
   800     12  WS-06-CANCEL-ERR        PIC X(25)
   801         VALUE 'PREVIOUSLY CANCELLED'.
   802     12  WS-07-CANCEL-ERR        PIC X(25)
   803         VALUE 'INVALID DATA'.
   804     12  WS-08-CANCEL-ERR        PIC X(25)
   805         VALUE 'NO ACCOUNT MASTER'.
   806     12  WS-09-CANCEL-ERR        PIC X(25)
   807         VALUE 'SUFFIX ALREADY EXISTS'.
   808     12  WS-99-CANCEL-ERR        PIC X(25)
   809         VALUE 'MISC CANCEL ERROR'.
   810
   811     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   812     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   813
   814     12  WS-AGE-FIELDS.
   815         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   816         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   817         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   818         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   819
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  17
* EL6311.cbl
   821
   822******************************************************************
   823*                                                                *
   824*                 B A T C H   T O T A L S                        *
   825*                                                                *
   826******************************************************************
   827
   828     12  WS-BATCH-RECORD.
   829         16  FILLER                       PIC X(10).
   830         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   831         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   832         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   833         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   834         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   835         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   836         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   837         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   838         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   839         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   840         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   841         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   842         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   843         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   844         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   845         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   846         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   847         16  WS-ACCOUNT-NAME              PIC X(30).
   848         16  FILLER                       PIC X.
   849         16  WS-REFERENCE                 PIC X(12).
   850         16  FILLER                       PIC X(197).
   851
   852     12  WS-BATCH-TOTALS.
   853         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   854         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   855         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   856         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   857         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   858         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   859         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   860         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   861         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   862         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   863         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   864         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   865         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   866         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   867         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   868         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   869         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   870         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   871         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   872
   873     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   874
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  18
* EL6311.cbl
   876
   877******************************************************************
   878*                                                                *
   879*                E R R O R   M E S S A G E S                     *
   880*                                                                *
   881******************************************************************
   882
   883 01  ERROR-MESSAGES.
   884     12  ER-0004                 PIC  9(4) VALUE 0004.
   885     12  ER-0008                 PIC  9(4) VALUE 0008.
   886     12  ER-0023                 PIC  9(4) VALUE 0023.
   887     12  ER-0029                 PIC  9(4) VALUE 0029.
   888     12  ER-0033                 PIC  9(4) VALUE 0033.
   889     12  ER-0070                 PIC  9(4) VALUE 0070.
   890     12  ER-0220                 PIC  9(4) VALUE 0220.
   891     12  ER-0248                 PIC  9(4) VALUE 0248.
   892     12  ER-0280                 PIC  9(4) VALUE 0280.
   893     12  ER-0348                 PIC  9(4) VALUE 0348.
   894     12  ER-0582                 PIC  9(4) VALUE 0582.
   895     12  ER-0877                 PIC  9(4) VALUE 0877.
   896     12  ER-1236                 PIC  9(4) VALUE 1236.
   897     12  ER-1570                 PIC  9(4) VALUE 1570.
   898     12  ER-1575                 PIC  9(4) VALUE 1575.
   899     12  ER-1609                 PIC  9(4) VALUE 1609.
   900     12  ER-1819                 PIC  9(4) VALUE 1819.
   901     12  ER-2077                 PIC  9(4) VALUE 2077.
   902     12  ER-2129                 PIC  9(4) VALUE 2129.
   903     12  ER-2188                 PIC  9(4) VALUE 2188.
   904     12  ER-2192                 PIC  9(4) VALUE 2192.
   905     12  ER-2196                 PIC  9(4) VALUE 2196.
   906     12  ER-2197                 PIC  9(4) VALUE 2197.
   907     12  ER-2198                 PIC  9(4) VALUE 2198.
   908     12  ER-2200                 PIC  9(4) VALUE 2200.
   909     12  ER-2212                 PIC  9(4) VALUE 2212.
   910     12  ER-2218                 PIC  9(4) VALUE 2218.
   911     12  ER-2220                 PIC  9(4) VALUE 2220.
   912     12  ER-2222                 PIC  9(4) VALUE 2222.
   913     12  ER-2223                 PIC  9(4) VALUE 2223.
   914     12  ER-2224                 PIC  9(4) VALUE 2224.
   915     12  ER-2225                 PIC  9(4) VALUE 2225.
   916     12  ER-2226                 PIC  9(4) VALUE 2226.
   917     12  ER-2227                 PIC  9(4) VALUE 2227.
   918     12  ER-2228                 PIC  9(4) VALUE 2228.
   919     12  ER-2240                 PIC  9(4) VALUE 2240.
   920     12  ER-2241                 PIC  9(4) VALUE 2241.
   921     12  ER-2242                 PIC  9(4) VALUE 2242.
   922     12  ER-2243                 PIC  9(4) VALUE 2243.
   923     12  ER-2244                 PIC  9(4) VALUE 2244.
   924     12  ER-2245                 PIC  9(4) VALUE 2245.
   925     12  ER-2246                 PIC  9(4) VALUE 2246.
   926     12  ER-2247                 PIC  9(4) VALUE 2247.
   927     12  ER-2251                 PIC  9(4) VALUE 2251.
   928     12  ER-2252                 PIC  9(4) VALUE 2252.
   929     12  ER-2253                 PIC  9(4) VALUE 2253.
   930     12  ER-2254                 PIC  9(4) VALUE 2254.
   931     12  ER-2255                 PIC  9(4) VALUE 2255.
   932     12  ER-2256                 PIC  9(4) VALUE 2256.
   933     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  19
* EL6311.cbl
   934     12  ER-2258                 PIC  9(4) VALUE 2258.
   935     12  ER-2259                 PIC  9(4) VALUE 2259.
   936     12  ER-2260                 PIC  9(4) VALUE 2260.
   937     12  ER-2261                 PIC  9(4) VALUE 2261.
   938     12  ER-2287                 PIC  9(4) VALUE 2287.
   939     12  ER-2336                 PIC  9(4) VALUE 2336.
   940     12  ER-2337                 PIC  9(4) VALUE 2337.
   941     12  ER-2437                 PIC  9(4) VALUE 2437.
   942     12  ER-2471                 PIC  9(4) VALUE 2471.
   943     12  ER-2530                 PIC  9(4) VALUE 2530.
   944     12  ER-2531                 PIC  9(4) VALUE 2531.
   945     12  ER-2532                 PIC  9(4) VALUE 2532.
   946     12  ER-2533                 PIC  9(4) VALUE 2533.
   947     12  ER-2547                 PIC  9(4) VALUE 2547.
   948     12  ER-2591                 PIC  9(4) VALUE 2591.
   949     12  ER-2592                 PIC  9(4) VALUE 2592.
   950     12  ER-2593                 PIC  9(4) VALUE 2593.
   951     12  ER-2600                 PIC  9(4) VALUE 2600.
   952     12  ER-2601                 PIC  9(4) VALUE 2601.
   953     12  ER-2604                 PIC  9(4) VALUE 2604.
   954     12  ER-2605                 PIC  9(4) VALUE 2605.
   955     12  ER-2606                 PIC  9(4) VALUE 2606.
   956     12  ER-2607                 PIC  9(4) VALUE 2607.
   957     12  ER-2622                 PIC  9(4) VALUE 2622.
   958     12  ER-2625                 PIC  9(4) VALUE 2625.
   959     12  ER-2626                 PIC  9(4) VALUE 2626.
   960     12  ER-2627                 PIC  9(4) VALUE 2627.
   961     12  ER-2628                 PIC  9(4) VALUE 2628.
   962     12  ER-2629                 PIC  9(4) VALUE 2629.
   963     12  ER-2630                 PIC  9(4) VALUE 2630.
   964     12  ER-2631                 PIC  9(4) VALUE 2631.
   965     12  ER-2632                 PIC  9(4) VALUE 2632.
   966     12  ER-2633                 PIC  9(4) VALUE 2633.
   967     12  ER-2634                 PIC  9(4) VALUE 2634.
   968     12  ER-2635                 PIC  9(4) VALUE 2635.
   969     12  ER-2636                 PIC  9(4) VALUE 2636.
   970     12  ER-2639                 PIC  9(4) VALUE 2639.
   971     12  ER-2640                 PIC  9(4) VALUE 2640.
   972     12  ER-2647                 PIC  9(4) VALUE 2647.
   973     12  ER-2648                 PIC  9(4) VALUE 2648.
   974     12  ER-2649                 PIC  9(4) VALUE 2649.
   975     12  ER-2650                 PIC  9(4) VALUE 2650.
   976     12  ER-2653                 PIC  9(4) VALUE 2653.
   977     12  ER-2654                 PIC  9(4) VALUE 2654.
   978     12  ER-2655                 PIC  9(4) VALUE 2655.
   979     12  ER-2656                 PIC  9(4) VALUE 2656.
   980     12  ER-2657                 PIC  9(4) VALUE 2657.
   981     12  ER-2660                 PIC  9(4) VALUE 2660.
   982     12  ER-2661                 PIC  9(4) VALUE 2661.
   983     12  ER-2662                 PIC  9(4) VALUE 2662.
   984     12  ER-2663                 PIC  9(4) VALUE 2663.
   985     12  ER-2664                 PIC  9(4) VALUE 2664.
   986     12  ER-2667                 PIC  9(4) VALUE 2667.
   987     12  ER-2668                 PIC  9(4) VALUE 2668.
   988     12  ER-2669                 PIC  9(4) VALUE 2669.
   989     12  ER-2670                 PIC  9(4) VALUE 2670.
   990     12  ER-2671                 PIC  9(4) VALUE 2671.
   991     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  20
* EL6311.cbl
   992     12  ER-2673                 PIC  9(4) VALUE 2673.
   993     12  ER-2677                 PIC  9(4) VALUE 2677.
   994     12  ER-2678                 PIC  9(4) VALUE 2678.
   995     12  ER-2679                 PIC  9(4) VALUE 2679.
   996     12  ER-2680                 PIC  9(4) VALUE 2680.
   997     12  ER-2681                 PIC  9(4) VALUE 2681.
   998     12  ER-2682                 PIC  9(4) VALUE 2682.
   999     12  ER-2683                 PIC  9(4) VALUE 2683.
  1000     12  ER-2684                 PIC  9(4) VALUE 2684.
  1001     12  ER-2686                 PIC  9(4) VALUE 2686.
  1002     12  ER-2689                 PIC  9(4) VALUE 2689.
  1003     12  ER-2690                 PIC  9(4) VALUE 2690.
  1004     12  ER-2693                 PIC  9(4) VALUE 2693.
  1005     12  ER-2695                 PIC  9(4) VALUE 2695.
  1006     12  ER-2701                 PIC  9(4) VALUE 2701.
  1007     12  ER-2720                 PIC  9(4) VALUE 2720.
  1008     12  ER-2709                 PIC  9(4) VALUE 2709.
  1009     12  ER-2704                 PIC  9(4) VALUE 2704.
  1010     12  ER-2725                 PIC  9(4) VALUE 2725.
  1011     12  ER-2726                 PIC  9(4) VALUE 2726.
  1012     12  ER-2728                 PIC  9(4) VALUE 2728.
  1013     12  ER-2729                 PIC  9(4) VALUE 2729.
  1014     12  ER-2731                 PIC  9(4) VALUE 2731.
  1015     12  ER-2732                 PIC  9(4) VALUE 2732.
  1016     12  ER-2733                 PIC  9(4) VALUE 2733.
  1017     12  ER-2735                 PIC  9(4) VALUE 2735.
  1018     12  ER-2738                 PIC  9(4) VALUE 2738.
  1019     12  ER-2742                 PIC  9(4) VALUE 2742.
  1020     12  ER-2743                 PIC  9(4) VALUE 2743.
  1021     12  ER-2744                 PIC  9(4) VALUE 2744.
  1022     12  ER-2747                 PIC  9(4) VALUE 2747.
  1023     12  ER-2749                 PIC  9(4) VALUE 2749.
  1024     12  ER-2753                 PIC  9(4) VALUE 2753.
  1025     12  ER-2755                 PIC  9(4) VALUE 2755.
  1026     12  ER-2757                 PIC  9(4) VALUE 2757.
  1027     12  ER-2771                 PIC  9(4) VALUE 2771.
  1028     12  ER-2774                 PIC  9(4) VALUE 2774.
  1029     12  ER-2775                 PIC  9(4) VALUE 2775.
  1030     12  ER-2776                 PIC  9(4) VALUE 2776.
  1031     12  ER-2777                 PIC  9(4) VALUE 2777.
  1032     12  ER-2794                 PIC  9(4) VALUE 2794.
  1033     12  ER-2799                 PIC  9(4) VALUE 2799.
  1034     12  ER-2900                 PIC  9(4) VALUE 2900.
  1035     12  ER-2902                 PIC  9(4) VALUE 2902.
  1036     12  ER-2945                 PIC  9(4) VALUE 2945.
  1037     12  ER-3000                 PIC  9(4) VALUE 3000.
  1038     12  ER-3006                 PIC  9(4) VALUE 3006.
  1039     12  ER-3054                 PIC  9(4) VALUE 3054.
  1040     12  ER-3224                 PIC  9(4) VALUE 3224.
  1041     12  ER-3269                 PIC  9(4) VALUE 3269.
  1042     12  ER-3504                 PIC  9(4) VALUE 3504.
  1043     12  ER-3513                 PIC  9(4) VALUE 3513.
  1044     12  ER-3831                 PIC  9(4) VALUE 3831.
  1045     12  ER-3834                 PIC  9(4) VALUE 3834.
  1046     12  ER-3835                 PIC  9(4) VALUE 3835.
  1047     12  ER-4005                 PIC  9(4) VALUE 4005.
  1048     12  ER-7144                 PIC  9(4) VALUE 7144.
  1049     12  ER-7401                 PIC  9(4) VALUE 7401.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  21
* EL6311.cbl
  1050     12  ER-7402                 PIC  9(4) VALUE 7402.
  1051     12  ER-7403                 PIC  9(4) VALUE 7403.
  1052     12  ER-7404                 PIC  9(4) VALUE 7404.
  1053     12  ER-7423                 PIC  9(4) VALUE 7423.
  1054     12  ER-7424                 PIC  9(4) VALUE 7424.
  1055     12  ER-7433                 PIC  9(4) VALUE 7433.
  1056     12  ER-7450                 PIC  9(4) VALUE 7450.
  1057     12  ER-7451                 PIC  9(4) VALUE 7451.
  1058     12  ER-7530                 PIC  9(4) VALUE 7530.
  1059     12  ER-7573                 PIC  9(4) VALUE 7573.
  1060     12  ER-7631                 PIC  9(4) VALUE 7631.
  1061     12  ER-7632                 PIC  9(4) VALUE 7632.
  1062     12  ER-7633                 PIC  9(4) VALUE 7633.
  1063     12  ER-7537                 PIC  9(4) VALUE 7537.
  1064     12  ER-7538                 PIC  9(4) VALUE 7538.
  1065     12  ER-7574                 PIC  9(4) VALUE 7574.
  1066     12  ER-7997                 PIC  9(4) VALUE 7997.
  1067     12  ER-7998                 PIC  9(4) VALUE 7998.
  1068     12  ER-8148                 PIC  9(4) VALUE 8148.
  1069     12  ER-9063                 PIC  9(4) VALUE 9063.
  1070     12  ER-9076                 PIC  9(4) VALUE 9076.
  1071     12  ER-9618                 PIC  9(4) VALUE 9618.
  1072     12  ER-9841                 PIC  9(4) VALUE 9841.
  1073
  1074*                                COPY ELCTEXT.
  1075******************************************************************
  1076*                                                                *
  1077*                                                                *
  1078*                            ELCTEXT.                            *
  1079*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1080*                            VMOD=2.008                          *
  1081*                                                                *
  1082*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1083*                                     FORM LETTERS,              *
  1084*                                     CERT FORM DISPLAY.
  1085*                                                                *
  1086*   FILE TYPE = VSAM,KSDS                                        *
  1087*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1088*                                                                *
  1089*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1090*       ALTERNATE INDEX = NONE                                   *
  1091*                                                                *
  1092*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1093*       ALTERNATE INDEX = NONE                                   *
  1094*                                                                *
  1095*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1096*       ALTERNATE INDEX = NONE                                   *
  1097*                                                                *
  1098*   LOG = NO                                                     *
  1099*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1100******************************************************************
  1101 01  TEXT-FILES.
  1102     12  TEXT-FILE-ID                PIC XX.
  1103         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1104         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1105         88  HELP-FILE-TEXT             VALUE 'TH'.
  1106
  1107     12  TX-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  22
* EL6311.cbl
  1108         16  TX-COMPANY-CD           PIC X.
  1109             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1110         16  TX-ACCESS-CD-GENL       PIC X(12).
  1111
  1112         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1113             20  TX-LETTER-NO        PIC X(4).
  1114             20  FILLER              PIC X(8).
  1115
  1116         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1117             20  TX-FORM-NO          PIC X(12).
  1118
  1119         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1120             20  TX-HELP-TYPE        PIC X.
  1121                 88  HELP-FOR-GENERAL   VALUE ' '.
  1122                 88  HELP-BY-SCREEN     VALUE 'S'.
  1123                 88  HELP-BY-ERROR      VALUE 'E'.
  1124             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1125                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1126             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1127                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1128             20  FILLER              PIC X(4).
  1129
  1130         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1131
  1132     12  TX-PROCESS-CONTROL          PIC XX.
  1133         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1134
  1135     12  TX-TEXT-LINE                PIC X(70).
  1136
  1137     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1138         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1139         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1140         88  TX-VALID-FORM-SQUEEZE-VALUE
  1141                                        VALUE 'Y' ' '.
  1142
  1143     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1144         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1145         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1146         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1147         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1148         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1149         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1150         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1151                                              'K' 'N' ' '
  1152                                              'Z'.
  1153
  1154     12  TX-ARCHIVE-SW               PIC X.
  1155         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1156         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1157         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1158
  1159     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1160     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1161
  1162     12  TX-BSR-CODE                 PIC X.
  1163         88  TX-BSR-LETTER              VALUE 'B'.
  1164         88  TX-NON-BSR-LETTER          VALUE ' '.
  1165
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  23
* EL6311.cbl
  1166     12  FILLER                      PIC X.
  1167*****************************************************************
  1168*                                COPY ELCCRTO.
  1169******************************************************************
  1170*                                                                *
  1171*                            ELCCRTO.                            *
  1172*                                                                *
  1173*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1174*                                                                *
  1175*   FILE TYPE = VSAM,KSDS                                        *
  1176*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1177*                                                                *
  1178*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1179*                                                                *
  1180*   LOG = YES                                                    *
  1181*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1182******************************************************************
  1183*                   C H A N G E   L O G
  1184*
  1185* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1186*-----------------------------------------------------------------
  1187*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1188* EFFECTIVE    NUMBER
  1189*-----------------------------------------------------------------
  1190* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1191* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1192* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1193* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1194* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1195******************************************************************
  1196 01  ORIGINAL-CERTIFICATE.
  1197     12  OC-RECORD-ID                      PIC XX.
  1198         88  VALID-OC-ID                      VALUE 'OC'.
  1199     12  OC-CONTROL-PRIMARY.
  1200         16  OC-COMPANY-CD                 PIC X.
  1201         16  OC-CARRIER                    PIC X.
  1202         16  OC-GROUPING                   PIC X(6).
  1203         16  OC-STATE                      PIC XX.
  1204         16  OC-ACCOUNT                    PIC X(10).
  1205         16  OC-CERT-EFF-DT                PIC XX.
  1206         16  OC-CERT-NO.
  1207             20  OC-CERT-PRIME             PIC X(10).
  1208             20  OC-CERT-SFX               PIC X.
  1209         16  OC-RECORD-TYPE                PIC X.
  1210         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1211     12  OC-LAST-MAINT-DT                  PIC XX.
  1212     12  OC-LAST-MAINT-BY                  PIC X(4).
  1213     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1214     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1215     12  FILLER                            PIC X(49).
  1216     12  OC-ORIG-REC.
  1217         16  OC-INS-LAST-NAME              PIC X(15).
  1218         16  OC-INS-FIRST-NAME             PIC X(10).
  1219         16  OC-INS-MIDDLE-INIT            PIC X.
  1220         16  OC-INS-AGE                    PIC S999     COMP-3.
  1221         16  OC-JNT-LAST-NAME              PIC X(15).
  1222         16  OC-JNT-FIRST-NAME             PIC X(10).
  1223         16  OC-JNT-MIDDLE-INIT            PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  24
* EL6311.cbl
  1224         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1225         16  OC-LF-BENCD                   PIC XX.
  1226         16  OC-LF-TERM                    PIC S999      COMP-3.
  1227         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1228         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1229         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1230         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1231         16  OC-LF-EXP-DT                  PIC XX.
  1232         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1233         16  OC-LF-CANCEL-DT               PIC XX.
  1234         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1235         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1236         16  OC-AH-BENCD                   PIC XX.
  1237         16  OC-AH-TERM                    PIC S999      COMP-3.
  1238         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1239         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1240         16  OC-AH-EXP-DT                  PIC XX.
  1241         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1242         16  OC-AH-CP                      PIC 99.
  1243         16  OC-AH-CANCEL-DT               PIC XX.
  1244         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1245         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1246         16  OC-CRED-BENE-NAME             PIC X(25).
  1247         16  OC-1ST-PMT-DT                 PIC XX.
  1248         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1249         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1250         16  OC-ISSUE-TRAN-IND             PIC X.
  1251         16  OC-CANCEL-TRAN-IND            PIC X.
  1252         16  FILLER                        PIC X(211).
  1253
  1254     12  FILLER                            PIC X(50).
  1255******************************************************************
  1256*                                COPY ERCACCT.
  1257******************************************************************
  1258*                                                                *
  1259*                                                                *
  1260*                            ERCACCT                             *
  1261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1262*                            VMOD=2.031                          *
  1263*                                                                *
  1264*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1265*                                                                *
  1266*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1267*   VSAM ACCOUNT MASTER FILES.                                   *
  1268*                                                                *
  1269*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1270*                                                                *
  1271*   FILE TYPE = VSAM,KSDS                                        *
  1272*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1273*                                                                *
  1274*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1275*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1276*                                                                *
  1277*   LOG = NO                                                     *
  1278*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1279*                                                                *
  1280*                                                                *
  1281******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  25
* EL6311.cbl
  1282*                   C H A N G E   L O G
  1283*
  1284* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1285*-----------------------------------------------------------------
  1286*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1287* EFFECTIVE    NUMBER
  1288*-----------------------------------------------------------------
  1289* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1290* 092705    2005050300006  PEMA  ADD SPP LEASES
  1291* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1292* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1293* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1294* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1295* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1296******************************************************************
  1297
  1298 01  ACCOUNT-MASTER.
  1299     12  AM-RECORD-ID                      PIC XX.
  1300         88  VALID-AM-ID                      VALUE 'AM'.
  1301
  1302     12  AM-CONTROL-PRIMARY.
  1303         16  AM-COMPANY-CD                 PIC X.
  1304         16  AM-MSTR-CNTRL.
  1305             20  AM-CONTROL-A.
  1306                 24  AM-CARRIER            PIC X.
  1307                 24  AM-GROUPING.
  1308                     28 AM-GROUPING-PREFIX PIC XXX.
  1309                     28 AM-GROUPING-PRIME  PIC XXX.
  1310                 24  AM-STATE              PIC XX.
  1311                 24  AM-ACCOUNT.
  1312                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1313                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1314             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1315                                           PIC X(19).
  1316             20  AM-CNTRL-B.
  1317                 24  AM-EXPIRATION-DT      PIC XX.
  1318                 24  FILLER                PIC X(4).
  1319             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1320                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1321
  1322     12  AM-CONTROL-BY-VAR-GRP.
  1323         16  AM-COMPANY-CD-A1              PIC X.
  1324         16  AM-VG-CARRIER                 PIC X.
  1325         16  AM-VG-GROUPING                PIC X(6).
  1326         16  AM-VG-STATE                   PIC XX.
  1327         16  AM-VG-ACCOUNT                 PIC X(10).
  1328         16  AM-VG-DATE.
  1329             20  AM-VG-EXPIRATION-DT       PIC XX.
  1330             20  FILLER                    PIC X(4).
  1331         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1332                                           PIC 9(11)      COMP-3.
  1333     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1334         16  FILLER                        PIC X(10).
  1335         16  AM-VG-KEY3.
  1336             20  AM-VG3-ACCOUNT            PIC X(10).
  1337             20  AM-VG3-EXP-DT             PIC XX.
  1338         16  FILLER                        PIC X(4).
  1339     12  AM-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  26
* EL6311.cbl
  1340         16  AM-LAST-MAINT-DT              PIC XX.
  1341         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1342         16  AM-LAST-MAINT-USER            PIC X(4).
  1343         16  FILLER                        PIC XX.
  1344
  1345     12  AM-EFFECTIVE-DT                   PIC XX.
  1346     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1347
  1348     12  AM-PREV-DATES  COMP-3.
  1349         16  AM-PREV-EXP-DT                PIC 9(11).
  1350         16  AM-PREV-EFF-DT                PIC 9(11).
  1351
  1352     12  AM-REPORT-CODE-1                  PIC X(10).
  1353     12  AM-REPORT-CODE-2                  PIC X(10).
  1354
  1355     12  AM-CITY-CODE                      PIC X(4).
  1356     12  AM-COUNTY-PARISH                  PIC X(6).
  1357
  1358     12  AM-NAME                           PIC X(30).
  1359     12  AM-PERSON                         PIC X(30).
  1360     12  AM-ADDRS                          PIC X(30).
  1361     12  AM-CITY.
  1362         16  AM-ADDR-CITY                  PIC X(28).
  1363         16  AM-ADDR-STATE                 PIC XX.
  1364     12  AM-ZIP.
  1365         16  AM-ZIP-PRIME.
  1366             20  AM-ZIP-PRI-1ST            PIC X.
  1367                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1368             20  FILLER                    PIC X(4).
  1369         16  AM-ZIP-PLUS4                  PIC X(4).
  1370     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1371         16  AM-CAN-POSTAL-1               PIC XXX.
  1372         16  AM-CAN-POSTAL-2               PIC XXX.
  1373         16  FILLER                        PIC XXX.
  1374     12  AM-TEL-NO.
  1375         16  AM-AREA-CODE                  PIC 999.
  1376         16  AM-TEL-PRE                    PIC 999.
  1377         16  AM-TEL-NBR                    PIC 9(4).
  1378     12  AM-TEL-LOC                        PIC X.
  1379         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1380         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1381
  1382     12  AM-COMM-STRUCTURE.
  1383         16  AM-DEFN-1.
  1384             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1385                 24  AM-AGT.
  1386                     28  AM-AGT-PREFIX     PIC X(4).
  1387                     28  AM-AGT-PRIME      PIC X(6).
  1388                 24  AM-COM-TYP            PIC X.
  1389                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1390                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1391                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1392                 24  AM-RECALC-LV-INDIC    PIC X.
  1393                 24  AM-RETRO-LV-INDIC     PIC X.
  1394                 24  AM-GL-CODES           PIC X.
  1395                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1396                 24  FILLER                PIC X(01).
  1397         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  27
* EL6311.cbl
  1398             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1399                 24  FILLER                PIC X(11).
  1400                 24  AM-L-COMA             PIC XXX.
  1401                 24  AM-J-COMA             PIC XXX.
  1402                 24  AM-A-COMA             PIC XXX.
  1403                 24  FILLER                PIC X(6).
  1404
  1405     12  AM-COMM-CHANGE-STATUS             PIC X.
  1406         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1407
  1408     12  AM-CSR-CODE                       PIC X(4).
  1409
  1410     12  AM-BILLING-STATUS                 PIC X.
  1411         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1412         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1413     12  AM-AUTO-REFUND-SW                 PIC X.
  1414         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1415         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1416     12  AM-GPCD                           PIC 99.
  1417     12  AM-IG                             PIC X.
  1418         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1419         88  AM-HAS-GROUP                     VALUE '2'.
  1420     12  AM-STATUS                         PIC X.
  1421         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1422         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1423         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1424         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1425         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1426         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1427     12  AM-REMIT-TO                       PIC 99.
  1428     12  AM-ID-NO                          PIC X(11).
  1429
  1430     12  AM-CAL-TABLE                      PIC XX.
  1431     12  AM-LF-DEVIATION                   PIC XXX.
  1432     12  AM-AH-DEVIATION                   PIC XXX.
  1433     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1434     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1435     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1436     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1437     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1438     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1439
  1440     12  AM-USER-FIELDS.
  1441         16  AM-FLD-1                      PIC XX.
  1442         16  AM-FLD-2                      PIC XX.
  1443         16  AM-FLD-3                      PIC XX.
  1444         16  AM-FLD-4                      PIC XX.
  1445         16  AM-FLD-5                      PIC XX.
  1446
  1447     12  AM-1ST-PROD-DATE.
  1448         16  AM-1ST-PROD-YR                PIC XX.
  1449         16  AM-1ST-PROD-MO                PIC XX.
  1450         16  AM-1ST-PROD-DA                PIC XX.
  1451     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1452     12  AM-CERTS-PURGED-DATE.
  1453         16  AM-PUR-YR                     PIC XX.
  1454         16  AM-PUR-MO                     PIC XX.
  1455         16  AM-PUR-DA                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  28
* EL6311.cbl
  1456     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1457     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1458     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1459     12  AM-INACTIVE-DATE.
  1460         16  AM-INA-MO                     PIC 99.
  1461         16  AM-INA-DA                     PIC 99.
  1462         16  AM-INA-YR                     PIC 99.
  1463     12  AM-AR-HI-CERT-DATE                PIC XX.
  1464
  1465     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1466     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1467
  1468     12  AM-OB-PAYMENT-MODE                PIC X.
  1469         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1470         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1471         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1472         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1473
  1474     12  AM-AH-ONLY-INDICATOR              PIC X.
  1475         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1476         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1477
  1478     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1479
  1480     12  AM-OVER-SHORT.
  1481         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1482         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1483
  1484     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1485     12  AM-DCC-CLP-STATE                  PIC XX.
  1486
  1487     12  AM-RECALC-COMM                    PIC X.
  1488     12  AM-RECALC-REIN                    PIC X.
  1489
  1490     12  AM-REI-TABLE                      PIC XXX.
  1491     12  AM-REI-ET-LF                      PIC X.
  1492     12  AM-REI-ET-AH                      PIC X.
  1493     12  AM-REI-PE-LF                      PIC X.
  1494     12  AM-REI-PE-AH                      PIC X.
  1495     12  AM-REI-PRT-ST                     PIC X.
  1496     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1497     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1498     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1499     12  AM-REI-GROUP-A                    PIC X(6).
  1500     12  AM-REI-MORT                       PIC X(4).
  1501     12  AM-REI-PRT-OW                     PIC X.
  1502     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1503     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1504     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1505     12  AM-REI-GROUP-B                    PIC X(6).
  1506
  1507     12  AM-TRUST-TYPE                     PIC X(2).
  1508
  1509     12  AM-EMPLOYER-STMT-USED             PIC X.
  1510     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1511
  1512     12  AM-STD-AH-TYPE                    PIC XX.
  1513     12  AM-EARN-METHODS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  29
* EL6311.cbl
  1514         16  AM-EARN-METHOD-R              PIC X.
  1515             88 AM-REF-RL-R78                 VALUE 'R'.
  1516             88 AM-REF-RL-PR                  VALUE 'P'.
  1517             88 AM-REF-RL-MEAN                VALUE 'M'.
  1518             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1519         16  AM-EARN-METHOD-L              PIC X.
  1520             88 AM-REF-LL-R78                 VALUE 'R'.
  1521             88 AM-REF-LL-PR                  VALUE 'P'.
  1522             88 AM-REF-LL-MEAN                VALUE 'M'.
  1523             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1524         16  AM-EARN-METHOD-A              PIC X.
  1525             88 AM-REF-AH-R78                 VALUE 'R'.
  1526             88 AM-REF-AH-PR                  VALUE 'P'.
  1527             88 AM-REF-AH-MEAN                VALUE 'M'.
  1528             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1529             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1530             88 AM-REF-AH-NET                 VALUE 'N'.
  1531
  1532     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1533     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1534     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1535
  1536     12  AM-RET-Y-N                        PIC X.
  1537     12  AM-RET-P-E                        PIC X.
  1538     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1539     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1540     12  AM-RET-GRP                        PIC X(6).
  1541     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1542         16  AM-POOL-PRIME                 PIC XXX.
  1543         16  AM-POOL-SUB                   PIC XXX.
  1544     12  AM-RETRO-EARNINGS.
  1545         16  AM-RET-EARN-R                 PIC X.
  1546         16  AM-RET-EARN-L                 PIC X.
  1547         16  AM-RET-EARN-A                 PIC X.
  1548     12  AM-RET-ST-TAX-USE                 PIC X.
  1549         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1550         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1551     12  AM-RETRO-BEG-EARNINGS.
  1552         16  AM-RET-BEG-EARN-R             PIC X.
  1553         16  AM-RET-BEG-EARN-L             PIC X.
  1554         16  AM-RET-BEG-EARN-A             PIC X.
  1555     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1556     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1557
  1558     12  AM-USER-SELECT-OPTIONS.
  1559         16  AM-USER-SELECT-1              PIC X(10).
  1560         16  AM-USER-SELECT-2              PIC X(10).
  1561         16  AM-USER-SELECT-3              PIC X(10).
  1562         16  AM-USER-SELECT-4              PIC X(10).
  1563         16  AM-USER-SELECT-5              PIC X(10).
  1564
  1565     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1566
  1567     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1568
  1569     12  AM-RPT045A-SWITCH                 PIC X.
  1570         88  RPT045A-OFF                   VALUE 'N'.
  1571
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  30
* EL6311.cbl
  1572     12  AM-INSURANCE-LIMITS.
  1573         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1574         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1575
  1576     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1577         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1578
  1579     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1580         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1581         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1582
  1583     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1584
  1585     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1586     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1587     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1588     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1589     12  AM-DCC-UEF-STATE                  PIC XX.
  1590     12  FILLER                            PIC XXX.
  1591     12  AM-REPORT-CODE-3                  PIC X(10).
  1592*    12  FILLER                            PIC X(22).
  1593
  1594     12  AM-RESERVE-DATE.
  1595         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1596         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1597         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1598
  1599     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1600     12  AM-NOTIFICATION-TYPES.
  1601         16  AM-NOTIF-OF-LETTERS           PIC X.
  1602         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1603         16  AM-NOTIF-OF-REPORTS           PIC X.
  1604         16  AM-NOTIF-OF-STATUS            PIC X.
  1605
  1606     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1607         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1608         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1609         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1610         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1611
  1612     12  AM-BENEFIT-CONTROLS.
  1613         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1614             20  AM-BENEFIT-CODE           PIC XX.
  1615             20  AM-BENEFIT-TYPE           PIC X.
  1616             20  AM-BENEFIT-REVISION       PIC XXX.
  1617             20  AM-BENEFIT-REM-TERM       PIC X.
  1618             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1619             20  FILLER                    PIC XX.
  1620         16  FILLER                        PIC X(80).
  1621
  1622     12  AM-TRANSFER-DATA.
  1623         16  AM-TRANSFERRED-FROM.
  1624             20  AM-TRNFROM-CARRIER        PIC X.
  1625             20  AM-TRNFROM-GROUPING.
  1626                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1627                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1628             20  AM-TRNFROM-STATE          PIC XX.
  1629             20  AM-TRNFROM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  31
* EL6311.cbl
  1630                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1631                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1632             20  AM-TRNFROM-DTE            PIC XX.
  1633         16  AM-TRANSFERRED-TO.
  1634             20  AM-TRNTO-CARRIER          PIC X.
  1635             20  AM-TRNTO-GROUPING.
  1636                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1637                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1638             20  AM-TRNTO-STATE            PIC XX.
  1639             20  AM-TRNTO-ACCOUNT.
  1640                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1641                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1642             20  AM-TRNTO-DTE              PIC XX.
  1643         16  FILLER                        PIC X(10).
  1644
  1645     12  AM-SAVED-REMIT-TO                 PIC 99.
  1646
  1647     12  AM-COMM-STRUCTURE-SAVED.
  1648         16  AM-DEFN-1-SAVED.
  1649             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1650                 24  AM-AGT-SV             PIC X(10).
  1651                 24  AM-COM-TYP-SV         PIC X.
  1652                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1653                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1654                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1655                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1656                 24  FILLER                PIC X.
  1657                 24  AM-GL-CODES-SV        PIC X.
  1658                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1659                 24  FILLER                PIC X.
  1660         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1661             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1662                 24  FILLER                PIC X(11).
  1663                 24  AM-L-COMA-SV          PIC XXX.
  1664                 24  AM-J-COMA-SV          PIC XXX.
  1665                 24  AM-A-COMA-SV          PIC XXX.
  1666                 24  FILLER                PIC X(6).
  1667
  1668     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1669         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1670            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1671            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1672            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1673
  1674     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1675     12  FILLER                            PIC X(120).
  1676
  1677     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1678         16  AM-CONTROL-NAME               PIC X(30).
  1679         16  AM-EXECUTIVE-ONE.
  1680             20  AM-EXEC1-NAME             PIC X(15).
  1681             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1682                                                          COMP-3.
  1683             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1684                                                          COMP-3.
  1685         16  AM-EXECUTIVE-TWO.
  1686             20  AM-EXEC2-NAME             PIC X(15).
  1687             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  32
* EL6311.cbl
  1688                                                          COMP-3.
  1689             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1690                                                          COMP-3.
  1691
  1692     12  AM-RETRO-ADDITIONAL-DATA.
  1693         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1694         16  AM-RETRO-PREM-P-E             PIC X.
  1695         16  AM-RETRO-CLMS-P-I             PIC X.
  1696         16  AM-RETRO-RET-BRACKET-LF.
  1697             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1698                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1699                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1700             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1701                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1702                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1703             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1704                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1705                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1706         16  AM-RETRO-RET-BRACKET-AH.
  1707             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1708                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1709                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1710                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1711             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1712                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1713                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1714             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1715                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1716                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1717
  1718     12  AM-COMMENTS.
  1719         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1720
  1721     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1722         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1723         16  AM-FLI-BILLING-CODE           PIC X.
  1724         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1725         16  AM-FLI-UNITED-IDENT           PIC X.
  1726         16  AM-FLI-INTEREST-LOST-DATA.
  1727             20  AM-FLI-BANK-NO            PIC X(5).
  1728             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1729             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1730             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1731         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1732             20  AM-FLI-AGT                PIC X(9).
  1733             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1734             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1735         16  FILLER                        PIC X(102).
  1736
  1737     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1738         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1739             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1740             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1741             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1742             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1743             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1744         16  FILLER                          PIC X(10).
  1745******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  33
* EL6311.cbl
  1746*                                COPY ELCVADS.
  1747******************************************************************
  1748*                                                                *
  1749*                                                                *
  1750*                            ELCVADS.                            *
  1751*                                                                *
  1752*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1753*   ELVADS                  LENGTH = 350                         *
  1754******************************************************************
  1755******************************************************************
  1756*                   C H A N G E   L O G
  1757*
  1758* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1759*-----------------------------------------------------------------
  1760*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1761* EFFECTIVE    NUMBER
  1762*-----------------------------------------------------------------
  1763* 100111    2011022800001  AJRA  NAPERSOFT
  1764******************************************************************
  1765
  1766 01  VIRGINIA-DISCLOSURE.
  1767     12  VD-COMPANY-CD              PIC X.
  1768     12  VD-CARRIER                 PIC X.
  1769     12  VD-GROUPING.
  1770         20  VD-GROUPING-PREFIX     PIC XXX.
  1771         20  VD-GROUPING-PRIME      PIC XXX.
  1772     12  VD-STATE                   PIC XX.
  1773     12  VD-ACCOUNT.
  1774         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1775         20  VD-ACCOUNT-PRIME       PIC X(6).
  1776     12  VD-CERT-EFF-DT             PIC XX.
  1777     12  VD-CERT-NO.
  1778         20  VD-CERT-PRIME          PIC X(10).
  1779         20  VD-CERT-SFX            PIC X.
  1780     12  VD-ENTRY-BATCH             PIC X(6).
  1781     12  VD-CSR-ID                  PIC X(4).
  1782     12  VD-NAME.
  1783         20  VD-INSURED-LAST-NAME   PIC X(15).
  1784         20  VD-INSURED-FIRST-NAME.
  1785             24  VD-INSURED-1ST-INIT PIC X.
  1786             24  FILLER             PIC X(9).
  1787         20  VD-INSURED-MIDDLE-INIT PIC X.
  1788     12  VD-JOINT-INSURED.
  1789         20 VD-JOINT-LAST-NAME      PIC X(15).
  1790         20 VD-JOINT-FIRST-NAME.
  1791            24  VD-JOINT-FIRST-INIT PIC X.
  1792            24  FILLER              PIC X(9).
  1793         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1794     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1795     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1796     12  VD-INSURED-CITY-STATE.
  1797         20  VD-INSURED-CITY        PIC X(28).
  1798         20  VD-INSURED-STATE       PIC XX.
  1799     12  VD-INSURED-ZIP-CODE.
  1800         20  VD-INSURED-ZIP-PRIME.
  1801             24  VD-INSURED-ZIP-1   PIC X.
  1802                 88  VD-CANADIAN-POST-CODE
  1803                                       VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  34
* EL6311.cbl
  1804             24  FILLER             PIC X(4).
  1805         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1806     12  VD-BENEFICIARY-NAME        PIC X(30).
  1807     12  VD-ACCOUNT-NAME            PIC X(30).
  1808     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1809     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1810     12  VD-1ST-PMT-DT              PIC XX.
  1811     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1812         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1813         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1814                                             '90' THRU '99'.
  1815     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1816                                    PIC XX.
  1817     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1818     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1819     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1820     12  VD-LF-TERM                 PIC S999   COMP-3.
  1821     12  VD-AH-BENEFIT-CD           PIC XX.
  1822         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1823         88  VD-INVALID-AH             VALUE '  ' '00'
  1824                                             '90' THRU '99'.
  1825     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1826     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1827     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1828     12  VD-AH-TERM                 PIC S999   COMP-3.
  1829     12  VD-LETTER-ID               PIC X(4).
  1830     12  VD-PROC-ID                 PIC X(4).
  1831     12  VD-COMP-ID                 PIC X(3).
  1832     12  VD-CURRENT-DATE            PIC XX.
  1833     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1834     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1835     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  35
* EL6311.cbl
  1837*    COPY ELCDATE.
  1838******************************************************************
  1839*                                                                *
  1840*                                                                *
  1841*                            ELCDATE.                            *
  1842*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1843*                            VMOD=2.003
  1844*                                                                *
  1845*                                                                *
  1846*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1847*                 LENGTH = 200                                   *
  1848******************************************************************
  1849
  1850 01  DATE-CONVERSION-DATA.
  1851     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1852     12  DC-OPTION-CODE                PIC X.
  1853         88  BIN-TO-GREG                VALUE ' '.
  1854         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1855         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1856         88  YMD-GREG-TO-BIN            VALUE '3'.
  1857         88  MDY-GREG-TO-BIN            VALUE '4'.
  1858         88  JULIAN-TO-BIN              VALUE '5'.
  1859         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1860         88  FIND-CENTURY               VALUE '7'.
  1861         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1862         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1863         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1864         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1865         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1866         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1867         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1868         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1869         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1870         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1871         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1872         88  BIN-3-TO-GREG              VALUE 'I'.
  1873         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1874         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1875         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1876         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1877         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1878         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1879         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1880         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1881         88  THREE-CHARACTER-BIN
  1882                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1883         88  GREGORIAN-TO-BIN
  1884                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1885         88  BIN-TO-GREGORIAN
  1886                  VALUES ' ' '1' 'I' '8' 'G'.
  1887         88  JULIAN-TO-BINARY
  1888                  VALUES '5' 'C' 'E' 'F'.
  1889     12  DC-ERROR-CODE                 PIC X.
  1890         88  NO-CONVERSION-ERROR        VALUE ' '.
  1891         88  DATE-CONVERSION-ERROR
  1892                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1893         88  DATE-IS-ZERO               VALUE '1'.
  1894         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  36
* EL6311.cbl
  1895         88  DATE-IS-INVALID            VALUE '3'.
  1896         88  DATE1-GREATER-DATE2        VALUE '4'.
  1897         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1898         88  DATE-INVALID-OPTION        VALUE '9'.
  1899         88  INVALID-CENTURY            VALUE 'A'.
  1900         88  ONLY-CENTURY               VALUE 'B'.
  1901         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1902         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1903     12  DC-END-OF-MONTH               PIC X.
  1904         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1905     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1906         88  USE-NORMAL-PROCESS         VALUE ' '.
  1907         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1908         88  ADJUST-UP-100-YRS          VALUE '2'.
  1909     12  FILLER                        PIC X.
  1910     12  DC-CONVERSION-DATES.
  1911         16  DC-BIN-DATE-1             PIC XX.
  1912         16  DC-BIN-DATE-2             PIC XX.
  1913         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1914         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1915                       DC-GREG-DATE-1-EDIT.
  1916             20  DC-EDIT1-MONTH        PIC 99.
  1917             20  SLASH1-1              PIC X.
  1918             20  DC-EDIT1-DAY          PIC 99.
  1919             20  SLASH1-2              PIC X.
  1920             20  DC-EDIT1-YEAR         PIC 99.
  1921         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1922         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1923                     DC-GREG-DATE-2-EDIT.
  1924             20  DC-EDIT2-MONTH        PIC 99.
  1925             20  SLASH2-1              PIC X.
  1926             20  DC-EDIT2-DAY          PIC 99.
  1927             20  SLASH2-2              PIC X.
  1928             20  DC-EDIT2-YEAR         PIC 99.
  1929         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1930         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1931                     DC-GREG-DATE-1-YMD.
  1932             20  DC-YMD-YEAR           PIC 99.
  1933             20  DC-YMD-MONTH          PIC 99.
  1934             20  DC-YMD-DAY            PIC 99.
  1935         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1936         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1937                      DC-GREG-DATE-1-MDY.
  1938             20  DC-MDY-MONTH          PIC 99.
  1939             20  DC-MDY-DAY            PIC 99.
  1940             20  DC-MDY-YEAR           PIC 99.
  1941         16  DC-GREG-DATE-1-ALPHA.
  1942             20  DC-ALPHA-MONTH        PIC X(10).
  1943             20  DC-ALPHA-DAY          PIC 99.
  1944             20  FILLER                PIC XX.
  1945             20  DC-ALPHA-CENTURY.
  1946                 24 DC-ALPHA-CEN-N     PIC 99.
  1947             20  DC-ALPHA-YEAR         PIC 99.
  1948         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1949         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1950         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1951         16  DC-JULIAN-DATE            PIC 9(05).
  1952         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  37
* EL6311.cbl
  1953                                       PIC 9(05).
  1954         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1955             20  DC-JULIAN-YEAR        PIC 99.
  1956             20  DC-JULIAN-DAYS        PIC 999.
  1957         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1958         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1959         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1960     12  DATE-CONVERSION-VARIBLES.
  1961         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1962         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1963             20  FILLER                PIC 9(3).
  1964             20  HOLD-CEN-1-CCYY.
  1965                 24  HOLD-CEN-1-CC     PIC 99.
  1966                 24  HOLD-CEN-1-YY     PIC 99.
  1967             20  HOLD-CEN-1-MO         PIC 99.
  1968             20  HOLD-CEN-1-DA         PIC 99.
  1969         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1970             20  HOLD-CEN-1-R-MO       PIC 99.
  1971             20  HOLD-CEN-1-R-DA       PIC 99.
  1972             20  HOLD-CEN-1-R-CCYY.
  1973                 24  HOLD-CEN-1-R-CC   PIC 99.
  1974                 24  HOLD-CEN-1-R-YY   PIC 99.
  1975             20  FILLER                PIC 9(3).
  1976         16  HOLD-CENTURY-1-X.
  1977             20  FILLER                PIC X(3)  VALUE SPACES.
  1978             20  HOLD-CEN-1-X-CCYY.
  1979                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1980                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1981             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1982             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1983         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1984             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1985             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1986             20  HOLD-CEN-1-R-X-CCYY.
  1987                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1988                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1989             20  FILLER                PIC XXX.
  1990         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1991         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1992         16  DC-JULIAN-DATE-1          PIC 9(07).
  1993         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1994             20  DC-JULIAN-1-CCYY.
  1995                 24  DC-JULIAN-1-CC    PIC 99.
  1996                 24  DC-JULIAN-1-YR    PIC 99.
  1997             20  DC-JULIAN-DA-1        PIC 999.
  1998         16  DC-JULIAN-DATE-2          PIC 9(07).
  1999         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2000             20  DC-JULIAN-2-CCYY.
  2001                 24  DC-JULIAN-2-CC    PIC 99.
  2002                 24  DC-JULIAN-2-YR    PIC 99.
  2003             20  DC-JULIAN-DA-2        PIC 999.
  2004         16  DC-GREG-DATE-A-EDIT.
  2005             20  DC-EDITA-MONTH        PIC 99.
  2006             20  SLASHA-1              PIC X VALUE '/'.
  2007             20  DC-EDITA-DAY          PIC 99.
  2008             20  SLASHA-2              PIC X VALUE '/'.
  2009             20  DC-EDITA-CCYY.
  2010                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  38
* EL6311.cbl
  2011                 24  DC-EDITA-YEAR     PIC 99.
  2012         16  DC-GREG-DATE-B-EDIT.
  2013             20  DC-EDITB-MONTH        PIC 99.
  2014             20  SLASHB-1              PIC X VALUE '/'.
  2015             20  DC-EDITB-DAY          PIC 99.
  2016             20  SLASHB-2              PIC X VALUE '/'.
  2017             20  DC-EDITB-CCYY.
  2018                 24  DC-EDITB-CENT     PIC 99.
  2019                 24  DC-EDITB-YEAR     PIC 99.
  2020         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2021         16  DC-GREG-DATE-CYMD-R REDEFINES
  2022                              DC-GREG-DATE-CYMD.
  2023             20  DC-CYMD-CEN           PIC 99.
  2024             20  DC-CYMD-YEAR          PIC 99.
  2025             20  DC-CYMD-MONTH         PIC 99.
  2026             20  DC-CYMD-DAY           PIC 99.
  2027         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2028         16  DC-GREG-DATE-MDCY-R REDEFINES
  2029                              DC-GREG-DATE-MDCY.
  2030             20  DC-MDCY-MONTH         PIC 99.
  2031             20  DC-MDCY-DAY           PIC 99.
  2032             20  DC-MDCY-CEN           PIC 99.
  2033             20  DC-MDCY-YEAR          PIC 99.
  2034    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2035        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2036    12  DC-EL310-DATE                  PIC X(21).
  2037    12  FILLER                         PIC X(28).
  2038
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  39
* EL6311.cbl
  2040*    COPY ELCLOGOF.
  2041******************************************************************
  2042*                                                                *
  2043*                                                                *
  2044*                            ELCLOGOF.                           *
  2045*                            VMOD=2.001                          *
  2046*                                                                *
  2047*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2048*                                                                *
  2049******************************************************************
  2050 01  CLASIC-LOGOFF.
  2051     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2052     12  LOGOFF-TEXT.
  2053         16  FILLER          PIC X(5)    VALUE SPACES.
  2054         16  LOGOFF-MSG.
  2055             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2056             20  FILLER      PIC X       VALUE SPACES.
  2057             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2058         16  FILLER          PIC X(80)
  2059           VALUE '* YOU ARE NOW LOGGED OFF'.
  2060         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2061         16  FILLER          PIC X       VALUE QUOTE.
  2062         16  LOGOFF-SYS-MSG  PIC X(17)
  2063           VALUE 'S CLAS-IC SYSTEM '.
  2064     12  TEXT-MESSAGES.
  2065         16  UNACCESS-MSG    PIC X(29)
  2066             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2067         16  PGMIDERR-MSG    PIC X(17)
  2068             VALUE 'PROGRAM NOT FOUND'.
  2069
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  40
* EL6311.cbl
  2071*    COPY ELCATTR.
  2072******************************************************************
  2073*                                                                *
  2074*                            ELCATTR.                            *
  2075*                            VMOD=2.001                          *
  2076*                                                                *
  2077*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2078*                                                                *
  2079*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2080*                                                                *
  2081*                   POS 1   P=PROTECTED                          *
  2082*                           U=UNPROTECTED                        *
  2083*                           S=ASKIP                              *
  2084*                   POS 2   A=ALPHA/NUMERIC                      *
  2085*                           N=NUMERIC                            *
  2086*                   POS 3   N=NORMAL                             *
  2087*                           B=BRIGHT                             *
  2088*                           D=DARK                               *
  2089*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2090*                           OF=MODIFIED DATA TAG OFF             *
  2091*                                                                *
  2092*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2093******************************************************************
  2094 01  ATTRIBUTE-LIST.
  2095     12  AL-PABOF            PIC X       VALUE 'Y'.
  2096     12  AL-PABON            PIC X       VALUE 'Z'.
  2097     12  AL-PADOF            PIC X       VALUE '%'.
  2098     12  AL-PADON            PIC X       VALUE '_'.
  2099     12  AL-PANOF            PIC X       VALUE '-'.
  2100     12  AL-PANON            PIC X       VALUE '/'.
  2101     12  AL-SABOF            PIC X       VALUE '8'.
  2102     12  AL-SABON            PIC X       VALUE '9'.
  2103     12  AL-SADOF            PIC X       VALUE '@'.
  2104     12  AL-SADON            PIC X       VALUE QUOTE.
  2105     12  AL-SANOF            PIC X       VALUE '0'.
  2106     12  AL-SANON            PIC X       VALUE '1'.
  2107     12  AL-UABOF            PIC X       VALUE 'H'.
  2108     12  AL-UABON            PIC X       VALUE 'I'.
  2109     12  AL-UADOF            PIC X       VALUE '<'.
  2110     12  AL-UADON            PIC X       VALUE '('.
  2111     12  AL-UANOF            PIC X       VALUE ' '.
  2112     12  AL-UANON            PIC X       VALUE 'A'.
  2113     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2114     12  AL-UNBON            PIC X       VALUE 'R'.
  2115     12  AL-UNDOF            PIC X       VALUE '*'.
  2116     12  AL-UNDON            PIC X       VALUE ')'.
  2117     12  AL-UNNOF            PIC X       VALUE '&'.
  2118     12  AL-UNNON            PIC X       VALUE 'J'.
  2119
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  41
* EL6311.cbl
  2121*    COPY ELCEMIB.
  2122******************************************************************
  2123*                                                                *
  2124*                                                                *
  2125*                            ELCEMIB.                            *
  2126*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2127*                            VMOD=2.005                          *
  2128*                                                                *
  2129*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2130*                                                                *
  2131******************************************************************
  2132 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2133     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2134     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2135     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2136     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2137     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2138     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2139     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2140     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2141     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2142         88  EMI-NO-ERRORS                    VALUE '1'.
  2143         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2144         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2145     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2146         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2147     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2148         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2149         88  EMI-AREA1-FULL                   VALUE '2'.
  2150     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2151         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2152         88  EMI-AREA2-FULL                   VALUE '2'.
  2153     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2154         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2155         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2156         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2157         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2158         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2159     12  EMI-ERROR-LINES.
  2160         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2161         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2162         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2163         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2164             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2165                 24  EMI-ERR-NUM         PIC X(4).
  2166                 24  EMI-FILLER          PIC X.
  2167                 24  EMI-SEV             PIC X.
  2168                 24  FILLER              PIC X.
  2169             20  FILLER                  PIC X(02).
  2170     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2171         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2172             20  EMI-ERROR-NUMBER    PIC X(4).
  2173             20  EMI-FILL            PIC X.
  2174             20  EMI-SEVERITY        PIC X.
  2175             20  FILLER              PIC X.
  2176             20  EMI-ERROR-TEXT.
  2177                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2178                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  42
* EL6311.cbl
  2179     12  EMI-SEVERITY-SAVE           PIC X.
  2180         88  EMI-NOTE                    VALUE 'N'.
  2181         88  EMI-WARNING                 VALUE 'W'.
  2182         88  EMI-FORCABLE                VALUE 'F'.
  2183         88  EMI-FATAL                   VALUE 'X'.
  2184     12  EMI-MESSAGE-FLAG            PIC X.
  2185         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2186         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2187     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2188     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2189         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2190         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2191         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2192     12  emi-claim-no                pic x(7).
  2193     12  emi-claim-type              pic x(6).
  2194     12  FILLER                      PIC X(124)  VALUE SPACES.
  2195     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2196     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2197     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2198     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2199
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  43
* EL6311.cbl
  2201*    COPY ELCINTF.
  2202******************************************************************
  2203*                                                                *
  2204*                                                                *
  2205*                            ELCINTF.                            *
  2206*                            VMOD=2.017                          *
  2207*                                                                *
  2208*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2209*                                                                *
  2210*       LENGTH = 1024                                            *
  2211*                                                                *
  2212******************************************************************
  2213*                   C H A N G E   L O G
  2214*
  2215* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2216*-----------------------------------------------------------------
  2217*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2218* EFFECTIVE    NUMBER
  2219*-----------------------------------------------------------------
  2220* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2221******************************************************************
  2222 01  PROGRAM-INTERFACE-BLOCK.
  2223     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2224     12  PI-CALLING-PROGRAM              PIC X(8).
  2225     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2226     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2227     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2228     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2229     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2230     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2231     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2232     12  PI-COMPANY-ID                   PIC XXX.
  2233     12  PI-COMPANY-CD                   PIC X.
  2234
  2235     12  PI-COMPANY-PASSWORD             PIC X(8).
  2236
  2237     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2238
  2239     12  PI-CONTROL-IN-PROGRESS.
  2240         16  PI-CARRIER                  PIC X.
  2241         16  PI-GROUPING                 PIC X(6).
  2242         16  PI-STATE                    PIC XX.
  2243         16  PI-ACCOUNT                  PIC X(10).
  2244         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2245                                         PIC X(10).
  2246         16  PI-CLAIM-CERT-GRP.
  2247             20  PI-CLAIM-NO             PIC X(7).
  2248             20  PI-CERT-NO.
  2249                 25  PI-CERT-PRIME       PIC X(10).
  2250                 25  PI-CERT-SFX         PIC X.
  2251             20  PI-CERT-EFF-DT          PIC XX.
  2252         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2253             20  PI-PLAN-CODE            PIC X(2).
  2254             20  PI-REVISION-NUMBER      PIC X(3).
  2255             20  PI-PLAN-EFF-DT          PIC X(2).
  2256             20  PI-PLAN-EXP-DT          PIC X(2).
  2257             20  FILLER                  PIC X(11).
  2258         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  44
* EL6311.cbl
  2259             20  PI-OE-REFERENCE-1.
  2260                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2261                 25  PI-OE-REF-1-SUFF    PIC XX.
  2262
  2263     12  PI-SESSION-IN-PROGRESS          PIC X.
  2264         88  CLAIM-SESSION                   VALUE '1'.
  2265         88  CREDIT-SESSION                  VALUE '2'.
  2266         88  WARRANTY-SESSION                VALUE '3'.
  2267         88  MORTGAGE-SESSION                VALUE '4'.
  2268         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2269
  2270
  2271*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2272
  2273     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2274     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2275
  2276     12  PI-CREDIT-USER                  PIC X.
  2277         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2278         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2279
  2280     12  PI-CLAIM-USER                   PIC X.
  2281         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2282         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2283
  2284     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2285         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2286         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2287         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2288         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2289         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2290
  2291     12  PI-PROCESSOR-ID                 PIC X(4).
  2292
  2293     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2294
  2295     12  PI-MEMBER-CAPTION               PIC X(10).
  2296
  2297     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2298         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2299
  2300     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2301     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2302     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2303     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2304
  2305     12  PI-AH-OVERRIDE-L1               PIC X.
  2306     12  PI-AH-OVERRIDE-L2               PIC XX.
  2307     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2308     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2309
  2310     12  PI-NEW-SYSTEM                   PIC X(2).
  2311
  2312     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2313     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2314         88  PI-USES-PAID-TO                 VALUE '1'.
  2315     12  PI-CRDTCRD-SYSTEM.
  2316         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  45
* EL6311.cbl
  2317             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2318             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2319         16  PI-CC-MONTH-END-DT          PIC XX.
  2320     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2321
  2322     12  PI-OE-REFERENCE-2.
  2323         16  PI-OE-REF-2-PRIME           PIC X(10).
  2324         16  PI-OE-REF-2-SUFF            PIC X.
  2325
  2326     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2327
  2328     12  PI-LANGUAGE-TYPE                PIC X.
  2329             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2330             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2331             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2332
  2333     12  PI-POLICY-LINKAGE-IND           PIC X.
  2334         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2335         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2336                                                   LOW-VALUES.
  2337
  2338     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2339     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2340         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2341         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2342
  2343     12  PI-PROCESSOR-CSR-IND            PIC X.
  2344         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2345         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2346
  2347     12  FILLER                          PIC X(3).
  2348
  2349     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2350
  2351     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2352         PI-SYSTEM-LEVEL.
  2353
  2354         16  PI-ENTRY-CODES.
  2355             20  PI-ENTRY-CD-1           PIC X.
  2356             20  PI-ENTRY-CD-2           PIC X.
  2357
  2358         16  PI-RETURN-CODES.
  2359             20  PI-RETURN-CD-1          PIC X.
  2360             20  PI-RETURN-CD-2          PIC X.
  2361
  2362         16  PI-UPDATE-STATUS-SAVE.
  2363             20  PI-UPDATE-BY            PIC X(4).
  2364             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2365
  2366         16  PI-LOWER-CASE-LETTERS       PIC X.
  2367             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2368
  2369*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2370*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2371*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2372
  2373         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2374             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  46
* EL6311.cbl
  2375             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2376             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2377             88  ACCNT-CNTL                  VALUE '3'.
  2378             88  CARR-ACCNT-CNTL             VALUE '4'.
  2379
  2380         16  PI-PROCESSOR-CAP-LIST.
  2381             20  PI-SYSTEM-CONTROLS.
  2382                24 PI-SYSTEM-DISPLAY     PIC X.
  2383                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2384                24 PI-SYSTEM-MODIFY      PIC X.
  2385                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2386             20  FILLER                  PIC XX.
  2387             20  PI-DISPLAY-CAP          PIC X.
  2388                 88  DISPLAY-CAP             VALUE 'Y'.
  2389             20  PI-MODIFY-CAP           PIC X.
  2390                 88  MODIFY-CAP              VALUE 'Y'.
  2391             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2392                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2393             20  PI-FORCE-CAP            PIC X.
  2394                 88  FORCE-CAP               VALUE 'Y'.
  2395
  2396         16  PI-PROGRAM-CONTROLS.
  2397             20  PI-PGM-PRINT-OPT        PIC X.
  2398             20  PI-PGM-FORMAT-OPT       PIC X.
  2399             20  PI-PGM-PROCESS-OPT      PIC X.
  2400             20  PI-PGM-TOTALS-OPT       PIC X.
  2401
  2402         16  PI-HELP-INTERFACE.
  2403             20  PI-LAST-ERROR-NO        PIC X(4).
  2404             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2405
  2406         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2407             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2408
  2409         16  PI-CR-CONTROL-IN-PROGRESS.
  2410             20  PI-CR-CARRIER           PIC X.
  2411             20  PI-CR-GROUPING          PIC X(6).
  2412             20  PI-CR-STATE             PIC XX.
  2413             20  PI-CR-ACCOUNT           PIC X(10).
  2414             20  PI-CR-FIN-RESP          PIC X(10).
  2415             20  PI-CR-TYPE              PIC X.
  2416
  2417         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2418
  2419         16  PI-CR-MONTH-END-DT          PIC XX.
  2420
  2421         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2422             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2423             88  PI-ZERO-CARRIER             VALUE '1'.
  2424             88  PI-ZERO-GROUPING            VALUE '2'.
  2425             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2426
  2427         16  PI-CARRIER-SECURITY         PIC X.
  2428             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2429
  2430         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2431             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2432             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  47
* EL6311.cbl
  2433
  2434         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2435             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2436                                         INDEXED BY PI-ACCESS-NDX
  2437                                         PIC X.
  2438
  2439         16  PI-GA-BILLING-CONTROL       PIC X.
  2440             88  PI-GA-BILLING               VALUE '1'.
  2441
  2442         16  PI-MAIL-PROCESSING          PIC X.
  2443             88  PI-MAIL-YES                 VALUE 'Y'.
  2444
  2445         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2446
  2447         16  PI-AR-SYSTEM.
  2448             20  PI-AR-PROCESSING-CNTL   PIC X.
  2449                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2450             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2451             20  PI-AR-MONTH-END-DT      PIC XX.
  2452
  2453         16  PI-MP-SYSTEM.
  2454             20  PI-MORTGAGE-USER            PIC X.
  2455                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2456                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2457             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2458                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2459                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2460                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2461                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2462                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2463             20  PI-MP-MONTH-END-DT          PIC XX.
  2464             20  PI-MP-REFERENCE-NO.
  2465                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2466                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2467
  2468         16  PI-LABEL-CONTROL            PIC X(01).
  2469             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2470             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2471
  2472         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2473             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2474
  2475         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2476             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2477             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2478
  2479         16  FILLER                      PIC X(14).
  2480
  2481     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2482******************************************************************
  2483
  2484     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2485*    COPY ELC631PI.
  2486******************************************************************
  2487*                                                                *
  2488*                                                                *
  2489*                            ELC631PI                            *
  2490*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  48
* EL6311.cbl
  2491*                                                                *
  2492*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2493*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2494*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2495*                                                                *
  2496*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2497*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2498*    BETWEEN PROGRAMS.                                           *
  2499*                                                                *
  2500*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2501*                                                                *
  2502*               EL631 - EL6311 - EL6312 - EL6313                 *
  2503*                                                                *
  2504******************************************************************
  2505
  2506         16  PI-631-DATA.
  2507             20  PI-ERPNDB-KEY.
  2508                 24  PI-PB-COMPANY-CD     PIC X.
  2509                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2510                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2511                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2512
  2513             20  PI-ERPNDB-ALT-KEY.
  2514                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2515                 24  PI-PB-CARRIER        PIC X.
  2516                 24  PI-PB-GROUPING       PIC X(6).
  2517                 24  PI-PB-STATE          PIC XX.
  2518                 24  PI-PB-ACCOUNT        PIC X(10).
  2519                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2520                 24  PI-PB-CERT-NO.
  2521                     28  PI-PB-CERT-PRIME PIC X(10).
  2522                     28  PI-PB-CERT-SFX   PIC X.
  2523                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2524                 24  PI-PB-RECORD-TYPE    PIC X.
  2525
  2526             20  PI-ERPNDB-CSR-KEY.
  2527                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2528                 24  PI-PB-CSR-ID             PIC X(4).
  2529                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2530                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2531                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2532
  2533             20  PI-BROWSE-TYPE               PIC X.
  2534                 88  PI-FILE-BROWSE             VALUE ' '.
  2535                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2536                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2537                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2538                 88  PI-CSR-BROWSE              VALUE '4'.
  2539
  2540             20  PI-MAINT-FUNCTION            PIC X.
  2541                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2542                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2543                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2544                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2545                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2546                 88  PI-PF5-FUNCTION            VALUE '5'.
  2547                 88  PI-PF6-FUNCTION            VALUE '6'.
  2548
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  49
* EL6311.cbl
  2549             20  PI-FILE-SWITCHES.
  2550                 24  PI-ALL-ISSUES-SW         PIC X.
  2551                     88  ALL-ISSUES             VALUE 'Y'.
  2552                 24  PI-ALL-CANCELS-SW        PIC X.
  2553                     88  ALL-CANCELS            VALUE 'Y'.
  2554                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2555                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2556                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2557                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2558                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2559                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2560                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2561                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2562                 24  PI-HOLD-REC-SW           PIC X.
  2563                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2564                 24  PI-CHANGE-REC-SW         PIC X.
  2565                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2566                 24  PI-CHK-REQ-REC-SW        PIC X.
  2567                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2568                 24  PI-ISSUE-WARNING-SW      PIC X.
  2569                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2570                 24  PI-CANCEL-WARNING-SW     PIC X.
  2571                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2572             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2573                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2574             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2575                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2576
  2577             20  PI-MAP-NAME                  PIC X(8).
  2578
  2579             20  PI-CURSOR                    PIC S9(4) COMP.
  2580
  2581             20  PI-PREV-ALT-KEY              PIC X(36).
  2582             20  PI-PREV-CSR-KEY              PIC X(15).
  2583             20  PI-PREV-KEY.
  2584                 24  PI-PREV-COMPANY-CD       PIC X.
  2585                 24  PI-PREV-BATCH            PIC X(6).
  2586                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2587                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2588             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2589             20  PI-BROWSE-SW                 PIC X.
  2590                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2591                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2592             20  PI-SV-CARRIER                PIC X.
  2593             20  PI-SV-GROUPING               PIC X(6).
  2594             20  PI-SV-STATE                  PIC XX.
  2595             20  PI-EDIT-SW                   PIC X.
  2596             20  PI-DISPLAY-SW                PIC XX.
  2597                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  2598                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2599             20  PI-CRITERIA-DATA             PIC X(350).
  2600             20  PI-BMODE                     PIC X.
  2601             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2602             20  PI-BPMTS                     PIC S999     COMP-3.
  2603             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2604             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2605             20  PI-CSR-SESSION-SW            PIC X.
  2606                 88  CSR-EDIT-SESSION           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  50
* EL6311.cbl
  2607             20  PI-ERRORS-SW                 PIC X.
  2608                 88  FATAL-ERRORS               VALUE 'X'.
  2609*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2610             20  FILLER                       PIC X(5).
  2611
  2612        16  FILLER             PIC X(94).
  2613
  2614 01  W-LETTER-COMMUNICATION-AREAS.
  2615*    COPY ELC1042.
  2616******************************************************************
  2617*                                                                *
  2618*                                                                *
  2619*                           ELC1042                              *
  2620*                            VMOD=2.002                          *
  2621*                                                                *
  2622*    NOTE                                                        *
  2623*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2624*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2625*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2626*        TO THESE PROGRAMS.                                      *
  2627*                                                                *
  2628*    NOTE                                                        *
  2629*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2630*        USE ONLY!                                               *
  2631*                                                                *
  2632******************************************************************
  2633
  2634         16  PI-1042-WA.
  2635             20  PI-ACTION       PIC  X(01).
  2636                 88 PI-SHOW-MODE           VALUE '1'.
  2637                 88 PI-CLEAR-MODE          VALUE '2'.
  2638                 88 PI-CREATE-MODE         VALUE '3'.
  2639             20  PI-COMM-CONTROL PIC  X(12).
  2640             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2641             20  PI-EOF-SW       PIC  X(01).
  2642                 88  PI-FILE-EOF           VALUE 'Y'.
  2643             20  PI-FILETYP      PIC  X(01).
  2644             20  PI-FORM-SQUEEZE-CONTROL
  2645                                 PIC  X(01).
  2646                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2647                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2648             20  PI-LAST-CONTROL PIC  X(12).
  2649             20  PI-TEMP-STOR-ITEMS
  2650                                 PIC S9(04) COMP.
  2651             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2652             20  PI-UPDATE-SW    PIC  9(01).
  2653                 88 ANY-UPDATES            VALUE 1.
  2654             20  PI-104-SCREEN-SENT-IND
  2655                                 PIC  X(01).
  2656                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2657                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2658             20  PI-1042-SCREEN-SENT-IND
  2659                                 PIC  X(01).
  2660                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2661                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2662             20  PI-1042-ARCHIVE-IND
  2663                                 PIC  X(01).
  2664                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  51
* EL6311.cbl
  2665             20  FILLER          PIC  X(29).
  2666*    COPY ELC689PI.
  2667******************************************************************
  2668*                                                                *
  2669*                            ELC689PI                            *
  2670*                            VMOD=2.003                          *
  2671*                                                                *
  2672*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2673*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2674*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2675*                                                                *
  2676*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2677*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2678*    BETWEEN PROGRAMS.                                           *
  2679*                                                                *
  2680*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2681*                                                                *
  2682*               EL631 - EL689  - EL6891 - EL6892                 *
  2683*                                                                *
  2684******************************************************************
  2685*                   C H A N G E   L O G
  2686*
  2687* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2688*-----------------------------------------------------------------
  2689*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2690* EFFECTIVE    NUMBER
  2691*-----------------------------------------------------------------
  2692* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2693* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2694* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2695******************************************************************
  2696
  2697
  2698         16  PI-689-WORK-AREA.
  2699             20  PI-689-ALT-PRINTER-ID
  2700                                 PIC  X(04).
  2701             20  PI-689-ARCHIVE-NUMBER
  2702                                 PIC  9(08).
  2703             20  PI-689-ARCHIVE-SW
  2704                                 PIC  X(01).
  2705                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2706             20  PI-689-DATA-SOURCE
  2707                                 PIC  X(01).
  2708                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2709                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2710                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2711                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2712                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2713             20  PI-689-ERROR-IND
  2714                                 PIC  X(01).
  2715                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2716             20  PI-689-ERROR    PIC  9(04).
  2717                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2718                 88  PI-689-FATAL-ERROR
  2719                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2720                            0042 0047 0051 0066 0067 0070
  2721                            0168 0169 0174 0175 0176 0177 0179
  2722                            0180 0181 0182 0184 0185 0189 0190
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  52
* EL6311.cbl
  2723                            0191
  2724                            0215 0279 0280
  2725                            0412 0413 0454
  2726                            0533 0537
  2727                            2055 2114 2208 2209 2216 2232 2369
  2728                            2398 2433 2908 2999
  2729                            3000 3770 3771 3775
  2730                            7250 7365 7367 7368 7369 7370 7371
  2731                            7272 7373 7374 7376 7377 7378 7379
  2732                            7381 7388 7390 7393 7395 7396 7398
  2733                            9095 9096 9281 9298 9299 9320 9327
  2734                            9426 9427.
  2735                 88  PI-689-STOP-ERROR
  2736                     VALUES 0004 0008 0013 0023 0029 0033
  2737                            0042 0047 0066 0067 0070
  2738                            0168 0169 0174 0175 0176 0177
  2739                            0181 0182 0184 0185 0189 0190
  2740                            0279 0280
  2741                            0412 0413 0454
  2742                            2055 2208 2209 2216 2232
  2743                            2398 2999
  2744                            3000 3770 3771 3775
  2745                            7250 7365 7369 7370 7371
  2746                            7272 7373 7374 7376 7377 7378 7379
  2747                            7381 7388 7390 7393 7396 7398
  2748                            9095 9096 9299 9320 9426.
  2749             20  PI-689-FOLLOW-UP-DATE
  2750                                 PIC  X(02).
  2751             20  PI-689-FORM-NUMBER
  2752                                 PIC  X(04).
  2753             20  PI-689-LABEL-SOURCE
  2754                                 PIC X(01).
  2755                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2756                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2757                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2758                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2759                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2760                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2761                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2762             20  PI-689-NUMBER-COPIES
  2763                                 PIC  9(01).
  2764             20  PI-689-NUMBER-LABEL-LINES
  2765                                 PIC  9(01).
  2766             20  PI-689-NUMBER-TEXT-RECORDS
  2767                                 PIC  9(03).
  2768             20  PI-689-PRINT-ORDER-SW
  2769                                 PIC  X(01).
  2770                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2771                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2772                 88  PI-689-PRINT-LATER     VALUE '3'.
  2773                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2774             20  PI-689-PRINT-RESTRICTION
  2775                                 PIC  X(01).
  2776                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2777                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2778                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2779             20  PI-689-PRINT-SW PIC  X(01).
  2780                 88  PI-689-PRINT-PERFORMED VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  53
* EL6311.cbl
  2781             20  PI-689-RESEND-DATE-1
  2782                                 PIC  X(02).
  2783             20  PI-689-RESEND-LETR-1
  2784                                 PIC X(4).
  2785             20  PI-689-TEMP-STOR-ID
  2786                                 PIC  X(08).
  2787             20  PI-689-USE-SCREEN-IND
  2788                                 PIC  X(01).
  2789                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2790             20  PI-689-ARCH-POINTER
  2791                                 PIC S9(08) COMP.
  2792                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2793             20  PI-689-ARCT-POINTER
  2794                                 PIC S9(08) COMP.
  2795                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2796             20  PI-689-VARIABLE-DATA-GRP.
  2797                 24  PI-689-VARIABLE-DATA-1
  2798                                 PIC  X(30).
  2799                 24  PI-689-VARIABLE-DATA-2
  2800                                 PIC  X(30).
  2801                 24  PI-689-VARIABLE-DATA-3
  2802                                 PIC  X(30).
  2803                 24  PI-689-VARIABLE-DATA-4
  2804                                 PIC  X(30).
  2805
  2806         16  PI-689-KEY-DATA-FIELDS.
  2807             20  PI-689-ACCOUNT  PIC  X(10).
  2808             20  PI-689-CARRIER  PIC  X(01).
  2809             20  PI-689-CERT-NO.
  2810                 24  PI-689-CERT-PRIME
  2811                                 PIC  X(10).
  2812                 24  PI-689-CERT-SFX
  2813                                 PIC  X(01).
  2814             20  PI-689-CHG-SEQ-NO
  2815                                 PIC S9(04)    COMP.
  2816             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2817                                 PIC  X(02).
  2818             20  PI-689-ENTRY-BATCH
  2819                                 PIC  X(06).
  2820             20  PI-689-EFF-DATE PIC  X(02).
  2821             20  PI-689-EXP-DATE PIC  X(02).
  2822             20  PI-689-GROUPING PIC  X(06).
  2823             20  PI-689-RESP-PERSON
  2824                                 PIC  X(10).
  2825             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2826             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2827                                 PIC  X(04).
  2828             20  PI-689-STATE    PIC  X(02).
  2829             20  PI-689-TYPE     PIC  X(01).
  2830             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2831             20  PI-689-ALT-SEQ-NO
  2832                                 PIC S9(04)    COMP.
  2833         16  PI-689-DATE-EDIT    PIC  X(08).
  2834         16  PI-689-FOLLOW-UP-EDIT
  2835                                 PIC  X(08).
  2836         16  PI-689-RESEND1-EDIT PIC  X(08).
  2837         16  PI-689-SEQ-EDIT     PIC  X(08).
  2838         16  PI-689-BCSEQ-EDIT   PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  54
* EL6311.cbl
  2839         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2840             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2841         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2842         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  55
* EL6311.cbl
  2844
  2845 01  WS-EL6315-PASS-AREA.
  2846        16  PI-6315-ISS-CAN-SW      PIC X.
  2847        16  FILLER                  PIC X(120).
  2848        16  PI-RES-REF-CLM-TYPE     PIC X.
  2849        16  FILLER                  PIC X.
  2850        16  PI-6315-PASS-AREA.
  2851            20 FILLER               PIC X(236).
  2852            20 PI-6315-FINALIZED    PIC X.
  2853            20 FILLER               PIC X(280).
  2854
  2855 01  WS-EL6316-PASS-AREA.
  2856        16  PI-ISS-CAN-SW           PIC X.
  2857        16  FILLER                  PIC X(121).
  2858        16  PI-CLM-RESC-IND         PIC X.
  2859        16  PI-6316-PASS-AREA.
  2860            20 FILLER               PIC X(236).
  2861            20 PI-6316-FINALIZED    PIC X.
  2862            20 FILLER               PIC X(280).
  2863
  2864******************************************************************
  2865*                                                                *
  2866*         P A S S   A R E A   F O R   E D I T                    *
  2867*                                                                *
  2868******************************************************************
  2869
  2870 01  PASSED-RECORD.
  2871     12  RECORD-SAVE                  PIC X(585).
  2872* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2873*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2874*                    BY  WK-CURRENT-DATE.
  2875******************************************************************
  2876*                                                                *
  2877*                                                                *
  2878*                             ELC50W1                            *
  2879*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2880*                            VMOD=2.004                          *
  2881*                                                                *
  2882*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2883*                                                                *
  2884*                                                                *
  2885******************************************************************
  2886
  2887     12  WK-WORK-AREA.
  2888         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2889         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2890         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2891         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2892         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2893         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2894         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2895         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2896         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2897         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2898         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2899         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2900         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2901         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  56
* EL6311.cbl
  2902         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2903         16  WK-CREDIT-EDIT-CONTROLS.
  2904             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2905             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2906             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2907             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2908             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2909             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2910         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2911         16  WK-SAVE-REIN-DATA.
  2912             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2913             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2914             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2915         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2916             88  ENTRY-FROM-EL6311       VALUE '6'.
  2917         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2918         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2919     12  WK-RECORD-ADDRESSES.
  2920         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2921         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2922         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2923         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2924         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2925         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2926         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2927         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2928     12  WK-OVER-SHORT-AREA.
  2929         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2930         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2931         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2932             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2933         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  57
* EL6311.cbl
  2935
  2936*    COPY ELCEDITC.
  2937******************************************************************
  2938*                                                                *
  2939*                                                                *
  2940*                            ELCEDITC                            *
  2941*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2942*                            VMOD=2.012                          *
  2943*                                                                *
  2944*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2945*                     EL6313, EL050 AND EL517.                   *
  2946*                                                                *
  2947******************************************************************
  2948******************************************************************
  2949*                   C H A N G E   L O G
  2950*
  2951* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2952*-----------------------------------------------------------------
  2953*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2954* EFFECTIVE    NUMBER
  2955*-----------------------------------------------------------------
  2956* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2957******************************************************************
  2958
  2959     12  EDIT-CRITERIA-DATA.
  2960         16  EC-CO-MONTH-END-DT       PIC XX.
  2961         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  2962         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  2963         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  2964         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  2965         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  2966         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  2967         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  2968         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  2969         16  EC-CO-REM-TERM-CALC      PIC X.
  2970               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  2971               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  2972               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  2973               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  2974
  2975         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  2976               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  2977               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  2978               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  2979               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  2980               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  2981               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  2982               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  2983               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  2984               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  2985               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  2986
  2987         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  2988               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  2989               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  2990               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  2991               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  2992               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  58
* EL6311.cbl
  2993               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  2994               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  2995               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  2996
  2997         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  2998                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  2999                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3000
  3001         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3002                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3003                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3004                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3005                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3006                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3007                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3008                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3009                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3010
  3011         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3012               88  EC-BR-REDUCING                   VALUE 'R'.
  3013               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3014
  3015         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3016         16  EC-BR-LF-DESC             PIC X(10).
  3017         16  EC-BR-AH-DESC             PIC X(10).
  3018         16  EC-BR-LF-COMMENT          PIC X(10).
  3019         16  EC-BR-AH-COMMENT          PIC X(10).
  3020
  3021         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3022               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3023               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3024               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3025               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3026
  3027         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3028               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3029               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3030               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3031               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3032
  3033         16  EC-BR-LF-REFUND-CALC      PIC X.
  3034                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3035                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3036                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3037                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3038                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3039                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3040                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3041
  3042         16  EC-BR-AH-REFUND-CALC      PIC X.
  3043                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3044                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3045                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3046                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3047                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3048                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3049                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3050                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  59
* EL6311.cbl
  3051
  3052         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3053                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3054                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3055                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3056
  3057         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3058                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3059                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3060                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3061
  3062         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3063         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3064         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3065         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3066
  3067         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3068         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3069                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3070                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3071                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3072                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3073
  3074         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3075               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3076               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3077               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3078               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3079               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3080
  3081         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3082               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3083               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3084               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3085               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3086               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3087
  3088         16  EC-ST-LF-REFUND-CALC      PIC X.
  3089                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3090                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3091                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3092                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3093                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3094                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3095                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3096                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3097
  3098         16  EC-ST-AH-REFUND-CALC      PIC X.
  3099                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3100                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3101                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3102                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3103                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3104                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3105                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3106                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3107
  3108         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  60
* EL6311.cbl
  3109         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3110         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3111         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3112         16  EC-AM-EXPIRATION-DT       PIC XX.
  3113         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3114         16  EC-AM-CLASS-CD            PIC XX.
  3115         16  EC-AM-LF-DEVIATION        PIC XXX.
  3116         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3117         16  EC-AM-AH-DEVIATION        PIC XXX.
  3118         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3119         16  EC-AM-PHONE-NO            PIC X(10).
  3120
  3121         16  EC-AM-LF-REFUND-CALC      PIC X.
  3122                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3123                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3124                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3125                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3126                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3127                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3128                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3129
  3130         16  EC-AM-AH-REFUND-CALC      PIC X.
  3131                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3132                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3133                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3134                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3135                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3136                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3137                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3138
  3139         16  EC-AM-BEN-I-G-CD          PIC X.
  3140                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3141                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3142                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3143
  3144         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3145         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3146         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3147         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3148         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3149         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3150         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3151         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3152         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3153
  3154         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3155         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3156         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3157         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3158         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3159         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3160         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3161         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3162         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3163         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3164         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3165         16  EC-RT-LF-NSP-ST           PIC XX.
  3166         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  61
* EL6311.cbl
  3167         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3168         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3169
  3170         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3171             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3172                                             'M' '5' '9' '2'.
  3173             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3174             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3175             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3176             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3177             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3178             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3179             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3180             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3181             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3182             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3183
  3184         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3185             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3186                                             'M' '5' '9' '2'.
  3187             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3188             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3189             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3190             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3191             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3192             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3193             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3194             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3195             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3196             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3197
  3198         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3199         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3200         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3201         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3202         16  EC-CM-DEATH-DT            PIC XX.
  3203
  3204*DMD CUSTOM CODING FIELDS BELOW
  3205*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3206         16  EC-BR-DMD-RATING-SW       PIC X.
  3207                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3208                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3209                 88  NO-DMD-RATING               VALUE 'N'.
  3210
  3211         16  EC-NEW-CERT               PIC X(11).
  3212         16  EC-NEW-STATE              PIC XX.
  3213         16  FILLER                    PIC X.
  3214*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3215         16  OVER-SHORT-EDIT-FIELDS.
  3216             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3217             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3218             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3219             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3220             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3221             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3222             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3223             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3224             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  62
* EL6311.cbl
  3225         16  FILLER                    PIC X(71).
  3226
  3227******************************************************************
  3228
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  63
* EL6311.cbl
  3230
  3231*    COPY ELCJPFX.
  3232******************************************************************
  3233*                                                                *
  3234*                                                                *
  3235*                            ELCJPFX.                            *
  3236*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3237*                            VMOD=2.002                          *
  3238*                                                                *
  3239*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3240*                                                                *
  3241*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3242*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3243*        ELCNTL - CONTROL FILE                                   *
  3244*        ELMSTR - CLAIM MASTERS                                  *
  3245*        ELTRLR - ACTIVITY TRAILERS                              *
  3246*        ELCHKQ - CHECK QUE                                      *
  3247******************************************************************
  3248 01  JOURNAL-RECORD.
  3249     12  jp-date                     pic s9(5) comp-3.
  3250     12  jp-time                     pic s9(7) comp-3.
  3251     12  JP-USER-ID                  PIC X(4).
  3252     12  JP-FILE-ID                  PIC X(8).
  3253     12  JP-PROGRAM-ID               PIC X(8).
  3254     12  JP-RECORD-TYPE              PIC X.
  3255         88 JP-ADD              VALUE 'A'.
  3256         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3257         88 JP-AFTER-CHANGE     VALUE 'C'.
  3258         88 JP-DELETE           VALUE 'D'.
  3259         88 JP-GENERIC-DELETE   VALUE 'G'.
  3260         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3261         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3262     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3263     12  JP-RECORD-AREA
  3264
  3265
  3266                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  64
* EL6311.cbl
  3268*    COPY ELCAID.
  3269******************************************************************
  3270*                                                                *
  3271*                            ELCAID.                             *
  3272*                            VMOD=2.001                          *
  3273*                                                                *
  3274*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3275*                                                                *
  3276*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3277*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3278******************************************************************
  3279
  3280 01  DFHAID.
  3281   02  DFHNULL   PIC  X  VALUE  ' '.
  3282   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3283   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3284   02  DFHPEN    PIC  X  VALUE  '='.
  3285   02  DFHOPID   PIC  X  VALUE  'W'.
  3286   02  DFHPA1    PIC  X  VALUE  '%'.
  3287   02  DFHPA2    PIC  X  VALUE  '>'.
  3288   02  DFHPA3    PIC  X  VALUE  ','.
  3289   02  DFHPF1    PIC  X  VALUE  '1'.
  3290   02  DFHPF2    PIC  X  VALUE  '2'.
  3291   02  DFHPF3    PIC  X  VALUE  '3'.
  3292   02  DFHPF4    PIC  X  VALUE  '4'.
  3293   02  DFHPF5    PIC  X  VALUE  '5'.
  3294   02  DFHPF6    PIC  X  VALUE  '6'.
  3295   02  DFHPF7    PIC  X  VALUE  '7'.
  3296   02  DFHPF8    PIC  X  VALUE  '8'.
  3297   02  DFHPF9    PIC  X  VALUE  '9'.
  3298   02  DFHPF10   PIC  X  VALUE  ':'.
  3299   02  DFHPF11   PIC  X  VALUE  '#'.
  3300   02  DFHPF12   PIC  X  VALUE  '@'.
  3301   02  DFHPF13   PIC  X  VALUE  'A'.
  3302   02  DFHPF14   PIC  X  VALUE  'B'.
  3303   02  DFHPF15   PIC  X  VALUE  'C'.
  3304   02  DFHPF16   PIC  X  VALUE  'D'.
  3305   02  DFHPF17   PIC  X  VALUE  'E'.
  3306   02  DFHPF18   PIC  X  VALUE  'F'.
  3307   02  DFHPF19   PIC  X  VALUE  'G'.
  3308   02  DFHPF20   PIC  X  VALUE  'H'.
  3309   02  DFHPF21   PIC  X  VALUE  'I'.
  3310*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3311   02  DFHPF22   PIC  X  VALUE  '['.
  3312   02  DFHPF23   PIC  X  VALUE  '.'.
  3313   02  DFHPF24   PIC  X  VALUE  '<'.
  3314   02  DFHMSRE   PIC  X  VALUE  'X'.
  3315   02  DFHSTRF   PIC  X  VALUE  'h'.
  3316   02  DFHTRIG   PIC  X  VALUE  '"'.
  3317
  3318 01  FILLER    REDEFINES DFHAID.
  3319     12  FILLER              PIC X(8).
  3320     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3321
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  65
* EL6311.cbl
  3323*    COPY EL6311S.
  3324 01  EL631BI.
  3325     05  FILLER            PIC  X(0012).
  3326*    -------------------------------
  3327     05  BDATEL PIC S9(0004) COMP.
  3328     05  BDATEF PIC  X(0001).
  3329     05  FILLER REDEFINES BDATEF.
  3330         10  BDATEA PIC  X(0001).
  3331     05  BDATEI PIC  X(0008).
  3332*    -------------------------------
  3333     05  BTIMEL PIC S9(0004) COMP.
  3334     05  BTIMEF PIC  X(0001).
  3335     05  FILLER REDEFINES BTIMEF.
  3336         10  BTIMEA PIC  X(0001).
  3337     05  BTIMEI PIC  X(0005).
  3338*    -------------------------------
  3339     05  BHEADL PIC S9(0004) COMP.
  3340     05  BHEADF PIC  X(0001).
  3341     05  FILLER REDEFINES BHEADF.
  3342         10  BHEADA PIC  X(0001).
  3343     05  BHEADI PIC  X(0038).
  3344*    -------------------------------
  3345     05  BNCERTLL PIC S9(0004) COMP.
  3346     05  BNCERTLF PIC  X(0001).
  3347     05  FILLER REDEFINES BNCERTLF.
  3348         10  BNCERTLA PIC  X(0001).
  3349     05  BNCERTLI PIC  X(0008).
  3350*    -------------------------------
  3351     05  BNCERTL PIC S9(0004) COMP.
  3352     05  BNCERTF PIC  X(0001).
  3353     05  FILLER REDEFINES BNCERTF.
  3354         10  BNCERTA PIC  X(0001).
  3355     05  BNCERTI PIC  X(0011).
  3356*    -------------------------------
  3357     05  BNSTATLL PIC S9(0004) COMP.
  3358     05  BNSTATLF PIC  X(0001).
  3359     05  FILLER REDEFINES BNSTATLF.
  3360         10  BNSTATLA PIC  X(0001).
  3361     05  BNSTATLI PIC  X(0009).
  3362*    -------------------------------
  3363     05  BNSTATL PIC S9(0004) COMP.
  3364     05  BNSTATF PIC  X(0001).
  3365     05  FILLER REDEFINES BNSTATF.
  3366         10  BNSTATA PIC  X(0001).
  3367     05  BNSTATI PIC  X(0002).
  3368*    -------------------------------
  3369     05  BCHGTL PIC S9(0004) COMP.
  3370     05  BCHGTF PIC  X(0001).
  3371     05  FILLER REDEFINES BCHGTF.
  3372         10  BCHGTA PIC  X(0001).
  3373     05  BCHGTI PIC  X(0004).
  3374*    -------------------------------
  3375     05  BCHGL PIC S9(0004) COMP.
  3376     05  BCHGF PIC  X(0001).
  3377     05  FILLER REDEFINES BCHGF.
  3378         10  BCHGA PIC  X(0001).
  3379     05  BCHGI PIC  X(0004).
  3380*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  66
* EL6311.cbl
  3381     05  BMAINTL PIC S9(0004) COMP.
  3382     05  BMAINTF PIC  X(0001).
  3383     05  FILLER REDEFINES BMAINTF.
  3384         10  BMAINTA PIC  X(0001).
  3385     05  BMAINTI PIC  X(0001).
  3386*    -------------------------------
  3387     05  BMANTBYL PIC S9(0004) COMP.
  3388     05  BMANTBYF PIC  X(0001).
  3389     05  FILLER REDEFINES BMANTBYF.
  3390         10  BMANTBYA PIC  X(0001).
  3391     05  BMANTBYI PIC  X(0004).
  3392*    -------------------------------
  3393     05  BCHGHDGL PIC S9(0004) COMP.
  3394     05  BCHGHDGF PIC  X(0001).
  3395     05  FILLER REDEFINES BCHGHDGF.
  3396         10  BCHGHDGA PIC  X(0001).
  3397     05  BCHGHDGI PIC  X(0003).
  3398*    -------------------------------
  3399     05  BMANTDTL PIC S9(0004) COMP.
  3400     05  BMANTDTF PIC  X(0001).
  3401     05  FILLER REDEFINES BMANTDTF.
  3402         10  BMANTDTA PIC  X(0001).
  3403     05  BMANTDTI PIC  X(0008).
  3404*    -------------------------------
  3405     05  BMANTATL PIC S9(0004) COMP.
  3406     05  BMANTATF PIC  X(0001).
  3407     05  FILLER REDEFINES BMANTATF.
  3408         10  BMANTATA PIC  X(0001).
  3409     05  BMANTATI PIC  X(0005).
  3410*    -------------------------------
  3411     05  BCSRL PIC S9(0004) COMP.
  3412     05  BCSRF PIC  X(0001).
  3413     05  FILLER REDEFINES BCSRF.
  3414         10  BCSRA PIC  X(0001).
  3415     05  BCSRI PIC  X(0004).
  3416*    -------------------------------
  3417     05  BBATCHL PIC S9(0004) COMP.
  3418     05  BBATCHF PIC  X(0001).
  3419     05  FILLER REDEFINES BBATCHF.
  3420         10  BBATCHA PIC  X(0001).
  3421     05  BBATCHI PIC  X(0006).
  3422*    -------------------------------
  3423     05  BSEQL PIC S9(0004) COMP.
  3424     05  BSEQF PIC  X(0001).
  3425     05  FILLER REDEFINES BSEQF.
  3426         10  BSEQA PIC  X(0001).
  3427     05  BSEQI PIC  X(0004).
  3428*    -------------------------------
  3429     05  BMOENDTL PIC S9(0004) COMP.
  3430     05  BMOENDTF PIC  X(0001).
  3431     05  FILLER REDEFINES BMOENDTF.
  3432         10  BMOENDTA PIC  X(0001).
  3433     05  BMOENDTI PIC  X(0008).
  3434*    -------------------------------
  3435     05  BCARRL PIC S9(0004) COMP.
  3436     05  BCARRF PIC  X(0001).
  3437     05  FILLER REDEFINES BCARRF.
  3438         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  67
* EL6311.cbl
  3439     05  BCARRI PIC  X(0001).
  3440*    -------------------------------
  3441     05  BGROUPL PIC S9(0004) COMP.
  3442     05  BGROUPF PIC  X(0001).
  3443     05  FILLER REDEFINES BGROUPF.
  3444         10  BGROUPA PIC  X(0001).
  3445     05  BGROUPI PIC  X(0006).
  3446*    -------------------------------
  3447     05  BSTATEL PIC S9(0004) COMP.
  3448     05  BSTATEF PIC  X(0001).
  3449     05  FILLER REDEFINES BSTATEF.
  3450         10  BSTATEA PIC  X(0001).
  3451     05  BSTATEI PIC  X(0002).
  3452*    -------------------------------
  3453     05  BACCTL PIC S9(0004) COMP.
  3454     05  BACCTF PIC  X(0001).
  3455     05  FILLER REDEFINES BACCTF.
  3456         10  BACCTA PIC  X(0001).
  3457     05  BACCTI PIC  X(0010).
  3458*    -------------------------------
  3459     05  BVINHL PIC S9(0004) COMP.
  3460     05  BVINHF PIC  X(0001).
  3461     05  FILLER REDEFINES BVINHF.
  3462         10  BVINHA PIC  X(0001).
  3463     05  BVINHI PIC  X(0004).
  3464*    -------------------------------
  3465     05  BVINL PIC S9(0004) COMP.
  3466     05  BVINF PIC  X(0001).
  3467     05  FILLER REDEFINES BVINF.
  3468         10  BVINA PIC  X(0001).
  3469     05  BVINI PIC  X(0017).
  3470*    -------------------------------
  3471     05  BREFHDGL PIC S9(0004) COMP.
  3472     05  BREFHDGF PIC  X(0001).
  3473     05  FILLER REDEFINES BREFHDGF.
  3474         10  BREFHDGA PIC  X(0001).
  3475     05  BREFHDGI PIC  X(0004).
  3476*    -------------------------------
  3477     05  BREFL PIC S9(0004) COMP.
  3478     05  BREFF PIC  X(0001).
  3479     05  FILLER REDEFINES BREFF.
  3480         10  BREFA PIC  X(0001).
  3481     05  BREFI PIC  X(0012).
  3482*    -------------------------------
  3483     05  BAGEDEFL PIC S9(0004) COMP.
  3484     05  BAGEDEFF PIC  X(0001).
  3485     05  FILLER REDEFINES BAGEDEFF.
  3486         10  BAGEDEFA PIC  X(0001).
  3487     05  BAGEDEFI PIC  X(0004).
  3488*    -------------------------------
  3489     05  BCERTNOL PIC S9(0004) COMP.
  3490     05  BCERTNOF PIC  X(0001).
  3491     05  FILLER REDEFINES BCERTNOF.
  3492         10  BCERTNOA PIC  X(0001).
  3493     05  BCERTNOI PIC  X(0010).
  3494*    -------------------------------
  3495     05  BSUFIXL PIC S9(0004) COMP.
  3496     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  68
* EL6311.cbl
  3497     05  FILLER REDEFINES BSUFIXF.
  3498         10  BSUFIXA PIC  X(0001).
  3499     05  BSUFIXI PIC  X(0001).
  3500*    -------------------------------
  3501     05  BEFFDTL PIC S9(0004) COMP.
  3502     05  BEFFDTF PIC  X(0001).
  3503     05  FILLER REDEFINES BEFFDTF.
  3504         10  BEFFDTA PIC  X(0001).
  3505     05  BEFFDTI PIC  X(0008).
  3506*    -------------------------------
  3507     05  BLSTNML PIC S9(0004) COMP.
  3508     05  BLSTNMF PIC  X(0001).
  3509     05  FILLER REDEFINES BLSTNMF.
  3510         10  BLSTNMA PIC  X(0001).
  3511     05  BLSTNMI PIC  X(0015).
  3512*    -------------------------------
  3513     05  B1STNML PIC S9(0004) COMP.
  3514     05  B1STNMF PIC  X(0001).
  3515     05  FILLER REDEFINES B1STNMF.
  3516         10  B1STNMA PIC  X(0001).
  3517     05  B1STNMI PIC  X(0010).
  3518*    -------------------------------
  3519     05  BINITL PIC S9(0004) COMP.
  3520     05  BINITF PIC  X(0001).
  3521     05  FILLER REDEFINES BINITF.
  3522         10  BINITA PIC  X(0001).
  3523     05  BINITI PIC  X(0001).
  3524*    -------------------------------
  3525     05  BSEXL PIC S9(0004) COMP.
  3526     05  BSEXF PIC  X(0001).
  3527     05  FILLER REDEFINES BSEXF.
  3528         10  BSEXA PIC  X(0001).
  3529     05  BSEXI PIC  X(0001).
  3530*    -------------------------------
  3531     05  BAGEL PIC S9(0004) COMP.
  3532     05  BAGEF PIC  X(0001).
  3533     05  FILLER REDEFINES BAGEF.
  3534         10  BAGEA PIC  X(0001).
  3535     05  BAGEI PIC  X(0002).
  3536*    -------------------------------
  3537     05  BBIRTHL PIC S9(0004) COMP.
  3538     05  BBIRTHF PIC  X(0001).
  3539     05  FILLER REDEFINES BBIRTHF.
  3540         10  BBIRTHA PIC  X(0001).
  3541     05  BBIRTHI PIC  X(0008).
  3542*    -------------------------------
  3543     05  B1STPMTL PIC S9(0004) COMP.
  3544     05  B1STPMTF PIC  X(0001).
  3545     05  FILLER REDEFINES B1STPMTF.
  3546         10  B1STPMTA PIC  X(0001).
  3547     05  B1STPMTI PIC  X(0008).
  3548*    -------------------------------
  3549     05  BDAYSL PIC S9(0004) COMP.
  3550     05  BDAYSF PIC  X(0001).
  3551     05  FILLER REDEFINES BDAYSF.
  3552         10  BDAYSA PIC  X(0001).
  3553     05  BDAYSI PIC  X(0003).
  3554*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  69
* EL6311.cbl
  3555     05  BLNTRML PIC S9(0004) COMP.
  3556     05  BLNTRMF PIC  X(0001).
  3557     05  FILLER REDEFINES BLNTRMF.
  3558         10  BLNTRMA PIC  X(0001).
  3559     05  BLNTRMI PIC  X(0003).
  3560*    -------------------------------
  3561     05  BLNOFCRL PIC S9(0004) COMP.
  3562     05  BLNOFCRF PIC  X(0001).
  3563     05  FILLER REDEFINES BLNOFCRF.
  3564         10  BLNOFCRA PIC  X(0001).
  3565     05  BLNOFCRI PIC  X(0005).
  3566*    -------------------------------
  3567     05  BMODEL PIC S9(0004) COMP.
  3568     05  BMODEF PIC  X(0001).
  3569     05  FILLER REDEFINES BMODEF.
  3570         10  BMODEA PIC  X(0001).
  3571     05  BMODEI PIC  X(0001).
  3572*    -------------------------------
  3573     05  BFREQL PIC S9(0004) COMP.
  3574     05  BFREQF PIC  X(0001).
  3575     05  FILLER REDEFINES BFREQF.
  3576         10  BFREQA PIC  X(0001).
  3577     05  BFREQI PIC  X(0002).
  3578*    -------------------------------
  3579     05  BPMTSL PIC S9(0004) COMP.
  3580     05  BPMTSF PIC  X(0001).
  3581     05  FILLER REDEFINES BPMTSF.
  3582         10  BPMTSA PIC  X(0001).
  3583     05  BPMTSI PIC  999.
  3584*    -------------------------------
  3585     05  BPMTAMTL PIC S9(0004) COMP.
  3586     05  BPMTAMTF PIC  X(0001).
  3587     05  FILLER REDEFINES BPMTAMTF.
  3588         10  BPMTAMTA PIC  X(0001).
  3589     05  BPMTAMTI PIC  9(7)V99.
  3590*    -------------------------------
  3591     05  BAPRL PIC S9(0004) COMP.
  3592     05  BAPRF PIC  X(0001).
  3593     05  FILLER REDEFINES BAPRF.
  3594         10  BAPRA PIC  X(0001).
  3595     05  BAPRI PIC  X(7).
  3596*    -------------------------------
  3597     05  BLIVESL PIC S9(0004) COMP.
  3598     05  BLIVESF PIC  X(0001).
  3599     05  FILLER REDEFINES BLIVESF.
  3600         10  BLIVESA PIC  X(0001).
  3601     05  BLIVESI PIC  X(0009).
  3602*    -------------------------------
  3603     05  BMEMCAPL PIC S9(0004) COMP.
  3604     05  BMEMCAPF PIC  X(0001).
  3605     05  FILLER REDEFINES BMEMCAPF.
  3606         10  BMEMCAPA PIC  X(0001).
  3607     05  BMEMCAPI PIC  X(0011).
  3608*    -------------------------------
  3609     05  BORIGHDL PIC S9(0004) COMP.
  3610     05  BORIGHDF PIC  X(0001).
  3611     05  FILLER REDEFINES BORIGHDF.
  3612         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  70
* EL6311.cbl
  3613     05  BORIGHDI PIC  X(0009).
  3614*    -------------------------------
  3615     05  DMDBILL PIC S9(0004) COMP.
  3616     05  DMDBILF PIC  X(0001).
  3617     05  FILLER REDEFINES DMDBILF.
  3618         10  DMDBILA PIC  X(0001).
  3619     05  DMDBILI PIC  X(0006).
  3620*    -------------------------------
  3621     05  BFORCEL PIC S9(0004) COMP.
  3622     05  BFORCEF PIC  X(0001).
  3623     05  FILLER REDEFINES BFORCEF.
  3624         10  BFORCEA PIC  X(0001).
  3625     05  BFORCEI PIC  X(0001).
  3626*    -------------------------------
  3627     05  BENTRYL PIC S9(0004) COMP.
  3628     05  BENTRYF PIC  X(0001).
  3629     05  FILLER REDEFINES BENTRYF.
  3630         10  BENTRYA PIC  X(0001).
  3631     05  BENTRYI PIC  X(0001).
  3632*    -------------------------------
  3633     05  BREINL PIC S9(0004) COMP.
  3634     05  BREINF PIC  X(0001).
  3635     05  FILLER REDEFINES BREINF.
  3636         10  BREINA PIC  X(0001).
  3637     05  BREINI PIC  X(0001).
  3638*    -------------------------------
  3639     05  BBILCDL PIC S9(0004) COMP.
  3640     05  BBILCDF PIC  X(0001).
  3641     05  FILLER REDEFINES BBILCDF.
  3642         10  BBILCDA PIC  X(0001).
  3643     05  BBILCDI PIC  X(0001).
  3644*    -------------------------------
  3645     05  BUNWRITL PIC S9(0004) COMP.
  3646     05  BUNWRITF PIC  X(0001).
  3647     05  FILLER REDEFINES BUNWRITF.
  3648         10  BUNWRITA PIC  X(0001).
  3649     05  BUNWRITI PIC  X(0001).
  3650*    -------------------------------
  3651     05  BSKPCDL PIC S9(0004) COMP.
  3652     05  BSKPCDF PIC  X(0001).
  3653     05  FILLER REDEFINES BSKPCDF.
  3654         10  BSKPCDA PIC  X(0001).
  3655     05  BSKPCDI PIC  X(0001).
  3656*    -------------------------------
  3657     05  BINDGRPL PIC S9(0004) COMP.
  3658     05  BINDGRPF PIC  X(0001).
  3659     05  FILLER REDEFINES BINDGRPF.
  3660         10  BINDGRPA PIC  X(0001).
  3661     05  BINDGRPI PIC  X(0001).
  3662*    -------------------------------
  3663     05  BSIGL PIC S9(0004) COMP.
  3664     05  BSIGF PIC  X(0001).
  3665     05  FILLER REDEFINES BSIGF.
  3666         10  BSIGA PIC  X(0001).
  3667     05  BSIGI PIC  X(0001).
  3668*    -------------------------------
  3669     05  BRTCLSL PIC S9(0004) COMP.
  3670     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  71
* EL6311.cbl
  3671     05  FILLER REDEFINES BRTCLSF.
  3672         10  BRTCLSA PIC  X(0001).
  3673     05  BRTCLSI PIC  X(0002).
  3674*    -------------------------------
  3675     05  BCHGCNTL PIC S9(0004) COMP.
  3676     05  BCHGCNTF PIC  X(0001).
  3677     05  FILLER REDEFINES BCHGCNTF.
  3678         10  BCHGCNTA PIC  X(0001).
  3679     05  BCHGCNTI PIC  X(0003).
  3680*    -------------------------------
  3681     05  BMEMBERL PIC S9(0004) COMP.
  3682     05  BMEMBERF PIC  X(0001).
  3683     05  FILLER REDEFINES BMEMBERF.
  3684         10  BMEMBERA PIC  X(0001).
  3685     05  BMEMBERI PIC  X(0012).
  3686*    -------------------------------
  3687     05  BORGNOL PIC S9(0004) COMP.
  3688     05  BORGNOF PIC  X(0001).
  3689     05  FILLER REDEFINES BORGNOF.
  3690         10  BORGNOA PIC  X(0001).
  3691     05  BORGNOI PIC  X(0006).
  3692*    -------------------------------
  3693     05  BORGSEQL PIC S9(0004) COMP.
  3694     05  BORGSEQF PIC  X(0001).
  3695     05  FILLER REDEFINES BORGSEQF.
  3696         10  BORGSEQA PIC  X(0001).
  3697     05  BORGSEQI PIC  X(0004).
  3698*    -------------------------------
  3699     05  BBILLEDL PIC S9(0004) COMP.
  3700     05  BBILLEDF PIC  X(0001).
  3701     05  FILLER REDEFINES BBILLEDF.
  3702         10  BBILLEDA PIC  X(0001).
  3703     05  BBILLEDI PIC  9(9).
  3704*    -------------------------------
  3705     05  BKIND1L PIC S9(0004) COMP.
  3706     05  BKIND1F PIC  X(0001).
  3707     05  FILLER REDEFINES BKIND1F.
  3708         10  BKIND1A PIC  X(0001).
  3709     05  BKIND1I PIC  X(0002).
  3710*    -------------------------------
  3711     05  BTYPE1L PIC S9(0004) COMP.
  3712     05  BTYPE1F PIC  X(0001).
  3713     05  FILLER REDEFINES BTYPE1F.
  3714         10  BTYPE1A PIC  X(0001).
  3715     05  BTYPE1I PIC  X(0003).
  3716*    -------------------------------
  3717     05  BTERM1L PIC S9(0004) COMP.
  3718     05  BTERM1F PIC  X(0001).
  3719     05  FILLER REDEFINES BTERM1F.
  3720         10  BTERM1A PIC  X(0001).
  3721     05  BTERM1I PIC  X(0003).
  3722*    -------------------------------
  3723     05  BBEN1L PIC S9(0004) COMP.
  3724     05  BBEN1F PIC  X(0001).
  3725     05  FILLER REDEFINES BBEN1F.
  3726         10  BBEN1A PIC  X(0001).
  3727     05  BBEN1I PIC  X(0012).
  3728*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  72
* EL6311.cbl
  3729     05  BPREM1L PIC S9(0004) COMP.
  3730     05  BPREM1F PIC  X(0001).
  3731     05  FILLER REDEFINES BPREM1F.
  3732         10  BPREM1A PIC  X(0001).
  3733     05  BPREM1I PIC  X(0011).
  3734*    -------------------------------
  3735     05  BEXPIR1L PIC S9(0004) COMP.
  3736     05  BEXPIR1F PIC  X(0001).
  3737     05  FILLER REDEFINES BEXPIR1F.
  3738         10  BEXPIR1A PIC  X(0001).
  3739     05  BEXPIR1I PIC  X(0008).
  3740*    -------------------------------
  3741     05  BCP1L PIC S9(0004) COMP.
  3742     05  BCP1F PIC  X(0001).
  3743     05  FILLER REDEFINES BCP1F.
  3744         10  BCP1A PIC  X(0001).
  3745     05  BCP1I PIC  X(0002).
  3746*    -------------------------------
  3747     05  BALTBN1L PIC S9(0004) COMP.
  3748     05  BALTBN1F PIC  X(0001).
  3749     05  FILLER REDEFINES BALTBN1F.
  3750         10  BALTBN1A PIC  X(0001).
  3751     05  BALTBN1I PIC  X(0012).
  3752*    -------------------------------
  3753     05  BALTPR1L PIC S9(0004) COMP.
  3754     05  BALTPR1F PIC  X(0001).
  3755     05  FILLER REDEFINES BALTPR1F.
  3756         10  BALTPR1A PIC  X(0001).
  3757     05  BALTPR1I PIC  X(0011).
  3758*    -------------------------------
  3759     05  BBNCD1L PIC S9(0004) COMP.
  3760     05  BBNCD1F PIC  X(0001).
  3761     05  FILLER REDEFINES BBNCD1F.
  3762         10  BBNCD1A PIC  X(0001).
  3763     05  BBNCD1I PIC  X(0003).
  3764*    -------------------------------
  3765     05  BCPRM1L PIC S9(0004) COMP.
  3766     05  BCPRM1F PIC  X(0001).
  3767     05  FILLER REDEFINES BCPRM1F.
  3768         10  BCPRM1A PIC  X(0001).
  3769     05  BCPRM1I PIC  X(0011).
  3770*    -------------------------------
  3771     05  BCAPRM1L PIC S9(0004) COMP.
  3772     05  BCAPRM1F PIC  X(0001).
  3773     05  FILLER REDEFINES BCAPRM1F.
  3774         10  BCAPRM1A PIC  X(0001).
  3775     05  BCAPRM1I PIC  X(0011).
  3776*    -------------------------------
  3777     05  BENABR1L PIC S9(0004) COMP.
  3778     05  BENABR1F PIC  X(0001).
  3779     05  FILLER REDEFINES BENABR1F.
  3780         10  BENABR1A PIC  X(0001).
  3781     05  BENABR1I PIC  X(0005).
  3782*    -------------------------------
  3783     05  BDIFF1L PIC S9(0004) COMP.
  3784     05  BDIFF1F PIC  X(0001).
  3785     05  FILLER REDEFINES BDIFF1F.
  3786         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  73
* EL6311.cbl
  3787     05  BDIFF1I PIC  X(0011).
  3788*    -------------------------------
  3789     05  BBILIT1L PIC S9(0004) COMP.
  3790     05  BBILIT1F PIC  X(0001).
  3791     05  FILLER REDEFINES BBILIT1F.
  3792         10  BBILIT1A PIC  X(0001).
  3793     05  BBILIT1I PIC  X(0008).
  3794*    -------------------------------
  3795     05  BADIFF1L PIC S9(0004) COMP.
  3796     05  BADIFF1F PIC  X(0001).
  3797     05  FILLER REDEFINES BADIFF1F.
  3798         10  BADIFF1A PIC  X(0001).
  3799     05  BADIFF1I PIC  X(0011).
  3800*    -------------------------------
  3801     05  BKIND2L PIC S9(0004) COMP.
  3802     05  BKIND2F PIC  X(0001).
  3803     05  FILLER REDEFINES BKIND2F.
  3804         10  BKIND2A PIC  X(0001).
  3805     05  BKIND2I PIC  X(0002).
  3806*    -------------------------------
  3807     05  BTYPE2L PIC S9(0004) COMP.
  3808     05  BTYPE2F PIC  X(0001).
  3809     05  FILLER REDEFINES BTYPE2F.
  3810         10  BTYPE2A PIC  X(0001).
  3811     05  BTYPE2I PIC  X(0003).
  3812*    -------------------------------
  3813     05  BTERM2L PIC S9(0004) COMP.
  3814     05  BTERM2F PIC  X(0001).
  3815     05  FILLER REDEFINES BTERM2F.
  3816         10  BTERM2A PIC  X(0001).
  3817     05  BTERM2I PIC  X(0003).
  3818*    -------------------------------
  3819     05  BBEN2L PIC S9(0004) COMP.
  3820     05  BBEN2F PIC  X(0001).
  3821     05  FILLER REDEFINES BBEN2F.
  3822         10  BBEN2A PIC  X(0001).
  3823     05  BBEN2I PIC  X(0012).
  3824*    -------------------------------
  3825     05  BPREM2L PIC S9(0004) COMP.
  3826     05  BPREM2F PIC  X(0001).
  3827     05  FILLER REDEFINES BPREM2F.
  3828         10  BPREM2A PIC  X(0001).
  3829     05  BPREM2I PIC  X(0011).
  3830*    -------------------------------
  3831     05  BEXPIR2L PIC S9(0004) COMP.
  3832     05  BEXPIR2F PIC  X(0001).
  3833     05  FILLER REDEFINES BEXPIR2F.
  3834         10  BEXPIR2A PIC  X(0001).
  3835     05  BEXPIR2I PIC  X(0008).
  3836*    -------------------------------
  3837     05  BCP2L PIC S9(0004) COMP.
  3838     05  BCP2F PIC  X(0001).
  3839     05  FILLER REDEFINES BCP2F.
  3840         10  BCP2A PIC  X(0001).
  3841     05  BCP2I PIC  X(0002).
  3842*    -------------------------------
  3843     05  BALTBN2L PIC S9(0004) COMP.
  3844     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  74
* EL6311.cbl
  3845     05  FILLER REDEFINES BALTBN2F.
  3846         10  BALTBN2A PIC  X(0001).
  3847     05  BALTBN2I PIC  X(0012).
  3848*    -------------------------------
  3849     05  BALTPR2L PIC S9(0004) COMP.
  3850     05  BALTPR2F PIC  X(0001).
  3851     05  FILLER REDEFINES BALTPR2F.
  3852         10  BALTPR2A PIC  X(0001).
  3853     05  BALTPR2I PIC  X(0011).
  3854*    -------------------------------
  3855     05  BBNCD2L PIC S9(0004) COMP.
  3856     05  BBNCD2F PIC  X(0001).
  3857     05  FILLER REDEFINES BBNCD2F.
  3858         10  BBNCD2A PIC  X(0001).
  3859     05  BBNCD2I PIC  X(0003).
  3860*    -------------------------------
  3861     05  BCPRM2L PIC S9(0004) COMP.
  3862     05  BCPRM2F PIC  X(0001).
  3863     05  FILLER REDEFINES BCPRM2F.
  3864         10  BCPRM2A PIC  X(0001).
  3865     05  BCPRM2I PIC  X(0011).
  3866*    -------------------------------
  3867     05  BCAPRM2L PIC S9(0004) COMP.
  3868     05  BCAPRM2F PIC  X(0001).
  3869     05  FILLER REDEFINES BCAPRM2F.
  3870         10  BCAPRM2A PIC  X(0001).
  3871     05  BCAPRM2I PIC  X(0011).
  3872*    -------------------------------
  3873     05  BENABR2L PIC S9(0004) COMP.
  3874     05  BENABR2F PIC  X(0001).
  3875     05  FILLER REDEFINES BENABR2F.
  3876         10  BENABR2A PIC  X(0001).
  3877     05  BENABR2I PIC  X(0005).
  3878*    -------------------------------
  3879     05  BDIFF2L PIC S9(0004) COMP.
  3880     05  BDIFF2F PIC  X(0001).
  3881     05  FILLER REDEFINES BDIFF2F.
  3882         10  BDIFF2A PIC  X(0001).
  3883     05  BDIFF2I PIC  X(0011).
  3884*    -------------------------------
  3885     05  BBILIT2L PIC S9(0004) COMP.
  3886     05  BBILIT2F PIC  X(0001).
  3887     05  FILLER REDEFINES BBILIT2F.
  3888         10  BBILIT2A PIC  X(0001).
  3889     05  BBILIT2I PIC  X(0008).
  3890*    -------------------------------
  3891     05  BADIFF2L PIC S9(0004) COMP.
  3892     05  BADIFF2F PIC  X(0001).
  3893     05  FILLER REDEFINES BADIFF2F.
  3894         10  BADIFF2A PIC  X(0001).
  3895     05  BADIFF2I PIC  X(0011).
  3896*    -------------------------------
  3897     05  BERMSG1L PIC S9(0004) COMP.
  3898     05  BERMSG1F PIC  X(0001).
  3899     05  FILLER REDEFINES BERMSG1F.
  3900         10  BERMSG1A PIC  X(0001).
  3901     05  BERMSG1I PIC  X(0078).
  3902*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  75
* EL6311.cbl
  3903     05  BERMSG2L PIC S9(0004) COMP.
  3904     05  BERMSG2F PIC  X(0001).
  3905     05  FILLER REDEFINES BERMSG2F.
  3906         10  BERMSG2A PIC  X(0001).
  3907     05  BERMSG2I PIC  X(0078).
  3908*    -------------------------------
  3909     05  BERMSG3L PIC S9(0004) COMP.
  3910     05  BERMSG3F PIC  X(0001).
  3911     05  FILLER REDEFINES BERMSG3F.
  3912         10  BERMSG3A PIC  X(0001).
  3913     05  BERMSG3I PIC  X(0078).
  3914*    -------------------------------
  3915     05  BPFENTRL PIC S9(0004) COMP.
  3916     05  BPFENTRF PIC  X(0001).
  3917     05  FILLER REDEFINES BPFENTRF.
  3918         10  BPFENTRA PIC  X(0001).
  3919     05  BPFENTRI PIC  9(2).
  3920*    -------------------------------
  3921     05  BPF5HDRL PIC S9(0004) COMP.
  3922     05  BPF5HDRF PIC  X(0001).
  3923     05  FILLER REDEFINES BPF5HDRF.
  3924         10  BPF5HDRA PIC  X(0001).
  3925     05  BPF5HDRI PIC  X(0005).
  3926*    -------------------------------
  3927     05  BPF4HDRL PIC S9(0004) COMP.
  3928     05  BPF4HDRF PIC  X(0001).
  3929     05  FILLER REDEFINES BPF4HDRF.
  3930         10  BPF4HDRA PIC  X(0001).
  3931     05  BPF4HDRI PIC  X(0013).
  3932*    -------------------------------
  3933     05  BF15HDRL PIC S9(0004) COMP.
  3934     05  BF15HDRF PIC  X(0001).
  3935     05  FILLER REDEFINES BF15HDRF.
  3936         10  BF15HDRA PIC  X(0001).
  3937     05  BF15HDRI PIC  X(0010).
  3938 01  EL631BO REDEFINES EL631BI.
  3939     05  FILLER            PIC  X(0012).
  3940*    -------------------------------
  3941     05  FILLER            PIC  X(0003).
  3942     05  BDATEO PIC  X(0008).
  3943*    -------------------------------
  3944     05  FILLER            PIC  X(0003).
  3945     05  BTIMEO PIC  99.99.
  3946*    -------------------------------
  3947     05  FILLER            PIC  X(0003).
  3948     05  BHEADO PIC  X(0038).
  3949*    -------------------------------
  3950     05  FILLER            PIC  X(0003).
  3951     05  BNCERTLO PIC  X(0008).
  3952*    -------------------------------
  3953     05  FILLER            PIC  X(0003).
  3954     05  BNCERTO PIC  X(0011).
  3955*    -------------------------------
  3956     05  FILLER            PIC  X(0003).
  3957     05  BNSTATLO PIC  X(0009).
  3958*    -------------------------------
  3959     05  FILLER            PIC  X(0003).
  3960     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  76
* EL6311.cbl
  3961*    -------------------------------
  3962     05  FILLER            PIC  X(0003).
  3963     05  BCHGTO PIC  X(0004).
  3964*    -------------------------------
  3965     05  FILLER            PIC  X(0003).
  3966     05  BCHGO PIC  ZZZ9.
  3967*    -------------------------------
  3968     05  FILLER            PIC  X(0003).
  3969     05  BMAINTO PIC  X(0001).
  3970*    -------------------------------
  3971     05  FILLER            PIC  X(0003).
  3972     05  BMANTBYO PIC  X(0004).
  3973*    -------------------------------
  3974     05  FILLER            PIC  X(0003).
  3975     05  BCHGHDGO PIC  X(0003).
  3976*    -------------------------------
  3977     05  FILLER            PIC  X(0003).
  3978     05  BMANTDTO PIC  X(0008).
  3979*    -------------------------------
  3980     05  FILLER            PIC  X(0003).
  3981     05  BMANTATO PIC  99.99.
  3982*    -------------------------------
  3983     05  FILLER            PIC  X(0003).
  3984     05  BCSRO PIC  X(0004).
  3985*    -------------------------------
  3986     05  FILLER            PIC  X(0003).
  3987     05  BBATCHO PIC  X(0006).
  3988*    -------------------------------
  3989     05  FILLER            PIC  X(0003).
  3990     05  BSEQO PIC  X(0004).
  3991*    -------------------------------
  3992     05  FILLER            PIC  X(0003).
  3993     05  BMOENDTO PIC  X(0008).
  3994*    -------------------------------
  3995     05  FILLER            PIC  X(0003).
  3996     05  BCARRO PIC  X(0001).
  3997*    -------------------------------
  3998     05  FILLER            PIC  X(0003).
  3999     05  BGROUPO PIC  X(0006).
  4000*    -------------------------------
  4001     05  FILLER            PIC  X(0003).
  4002     05  BSTATEO PIC  X(0002).
  4003*    -------------------------------
  4004     05  FILLER            PIC  X(0003).
  4005     05  BACCTO PIC  X(0010).
  4006*    -------------------------------
  4007     05  FILLER            PIC  X(0003).
  4008     05  BVINHO PIC  X(0004).
  4009*    -------------------------------
  4010     05  FILLER            PIC  X(0003).
  4011     05  BVINO PIC  X(0017).
  4012*    -------------------------------
  4013     05  FILLER            PIC  X(0003).
  4014     05  BREFHDGO PIC  X(0004).
  4015*    -------------------------------
  4016     05  FILLER            PIC  X(0003).
  4017     05  BREFO PIC  X(0012).
  4018*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  77
* EL6311.cbl
  4019     05  FILLER            PIC  X(0003).
  4020     05  BAGEDEFO PIC  X(0004).
  4021*    -------------------------------
  4022     05  FILLER            PIC  X(0003).
  4023     05  BCERTNOO PIC  X(0010).
  4024*    -------------------------------
  4025     05  FILLER            PIC  X(0003).
  4026     05  BSUFIXO PIC  X(0001).
  4027*    -------------------------------
  4028     05  FILLER            PIC  X(0003).
  4029     05  BEFFDTO PIC  X(0008).
  4030*    -------------------------------
  4031     05  FILLER            PIC  X(0003).
  4032     05  BLSTNMO PIC  X(0015).
  4033*    -------------------------------
  4034     05  FILLER            PIC  X(0003).
  4035     05  B1STNMO PIC  X(0010).
  4036*    -------------------------------
  4037     05  FILLER            PIC  X(0003).
  4038     05  BINITO PIC  X(0001).
  4039*    -------------------------------
  4040     05  FILLER            PIC  X(0003).
  4041     05  BSEXO PIC  X(0001).
  4042*    -------------------------------
  4043     05  FILLER            PIC  X(0003).
  4044     05  BAGEO PIC  X(0002).
  4045*    -------------------------------
  4046     05  FILLER            PIC  X(0003).
  4047     05  BBIRTHO PIC  X(0008).
  4048*    -------------------------------
  4049     05  FILLER            PIC  X(0003).
  4050     05  B1STPMTO PIC  X(0008).
  4051*    -------------------------------
  4052     05  FILLER            PIC  X(0003).
  4053     05  BDAYSO PIC  X(0003).
  4054*    -------------------------------
  4055     05  FILLER            PIC  X(0003).
  4056     05  BLNTRMO PIC  X(0003).
  4057*    -------------------------------
  4058     05  FILLER            PIC  X(0003).
  4059     05  BLNOFCRO PIC  X(0005).
  4060*    -------------------------------
  4061     05  FILLER            PIC  X(0003).
  4062     05  BMODEO PIC  X(0001).
  4063*    -------------------------------
  4064     05  FILLER            PIC  X(0003).
  4065     05  BFREQO PIC  X(0002).
  4066*    -------------------------------
  4067     05  FILLER            PIC  X(0003).
  4068     05  BPMTSO PIC  X(0003).
  4069*    -------------------------------
  4070     05  FILLER            PIC  X(0003).
  4071     05  BPMTAMTO PIC  ZZZZZ9.99.
  4072*    -------------------------------
  4073     05  FILLER            PIC  X(0003).
  4074     05  BAPRO PIC  99.9999.
  4075*    -------------------------------
  4076     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  78
* EL6311.cbl
  4077     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4078*    -------------------------------
  4079     05  FILLER            PIC  X(0003).
  4080     05  BMEMCAPO PIC  X(0011).
  4081*    -------------------------------
  4082     05  FILLER            PIC  X(0003).
  4083     05  BORIGHDO PIC  X(0009).
  4084*    -------------------------------
  4085     05  FILLER            PIC  X(0003).
  4086     05  DMDBILO PIC  X(0006).
  4087*    -------------------------------
  4088     05  FILLER            PIC  X(0003).
  4089     05  BFORCEO PIC  X(0001).
  4090*    -------------------------------
  4091     05  FILLER            PIC  X(0003).
  4092     05  BENTRYO PIC  X(0001).
  4093*    -------------------------------
  4094     05  FILLER            PIC  X(0003).
  4095     05  BREINO PIC  X(0001).
  4096*    -------------------------------
  4097     05  FILLER            PIC  X(0003).
  4098     05  BBILCDO PIC  X(0001).
  4099*    -------------------------------
  4100     05  FILLER            PIC  X(0003).
  4101     05  BUNWRITO PIC  X(0001).
  4102*    -------------------------------
  4103     05  FILLER            PIC  X(0003).
  4104     05  BSKPCDO PIC  X(0001).
  4105*    -------------------------------
  4106     05  FILLER            PIC  X(0003).
  4107     05  BINDGRPO PIC  X(0001).
  4108*    -------------------------------
  4109     05  FILLER            PIC  X(0003).
  4110     05  BSIGO PIC  X(0001).
  4111*    -------------------------------
  4112     05  FILLER            PIC  X(0003).
  4113     05  BRTCLSO PIC  X(0002).
  4114*    -------------------------------
  4115     05  FILLER            PIC  X(0003).
  4116     05  BCHGCNTO PIC  X(0003).
  4117*    -------------------------------
  4118     05  FILLER            PIC  X(0003).
  4119     05  BMEMBERO PIC  X(0012).
  4120*    -------------------------------
  4121     05  FILLER            PIC  X(0003).
  4122     05  BORGNOO PIC  X(0006).
  4123*    -------------------------------
  4124     05  FILLER            PIC  X(0003).
  4125     05  BORGSEQO PIC  X(0004).
  4126*    -------------------------------
  4127     05  FILLER            PIC  X(0003).
  4128     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4129*    -------------------------------
  4130     05  FILLER            PIC  X(0003).
  4131     05  BKIND1O PIC  X(0002).
  4132*    -------------------------------
  4133     05  FILLER            PIC  X(0003).
  4134     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  79
* EL6311.cbl
  4135*    -------------------------------
  4136     05  FILLER            PIC  X(0003).
  4137     05  BTERM1O PIC  X(0003).
  4138*    -------------------------------
  4139     05  FILLER            PIC  X(0003).
  4140     05  BBEN1O PIC  X(0012).
  4141*    -------------------------------
  4142     05  FILLER            PIC  X(0003).
  4143     05  BPREM1O PIC  X(0011).
  4144*    -------------------------------
  4145     05  FILLER            PIC  X(0003).
  4146     05  BEXPIR1O PIC  X(0008).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
  4149     05  BCP1O PIC  X(0002).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BALTBN1O PIC  X(0012).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BALTPR1O PIC  X(0011).
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BBNCD1O PIC  X(0003).
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BCPRM1O PIC  X(0011).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BCAPRM1O PIC  X(0011).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BENABR1O PIC  X(0005).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BDIFF1O PIC  X(0011).
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BBILIT1O PIC  X(0008).
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BADIFF1O PIC  X(0011).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BKIND2O PIC  X(0002).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BTYPE2O PIC  X(0003).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BTERM2O PIC  X(0003).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BBEN2O PIC  X(0012).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BPREM2O PIC  X(0011).
  4192*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  80
* EL6311.cbl
  4193     05  FILLER            PIC  X(0003).
  4194     05  BEXPIR2O PIC  X(0008).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BCP2O PIC  X(0002).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BALTBN2O PIC  X(0012).
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BALTPR2O PIC  X(0011).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BBNCD2O PIC  X(0003).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BCPRM2O PIC  X(0011).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BCAPRM2O PIC  X(0011).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BENABR2O PIC  X(0005).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BDIFF2O PIC  X(0011).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BBILIT2O PIC  X(0008).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BADIFF2O PIC  X(0011).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BERMSG1O PIC  X(0078).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BERMSG2O PIC  X(0078).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BERMSG3O PIC  X(0078).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  BPFENTRO PIC  X(0002).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  BPF5HDRO PIC  X(0005).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BPF4HDRO PIC  X(0013).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BF15HDRO PIC  X(0010).
  4246*    -------------------------------
  4247 01  EL631CI REDEFINES EL631BI.
  4248     05  FILLER            PIC  X(0012).
  4249*    -------------------------------
  4250     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  81
* EL6311.cbl
  4251     05  CDATEF PIC  X(0001).
  4252     05  FILLER REDEFINES CDATEF.
  4253         10  CDATEA PIC  X(0001).
  4254     05  CDATEI PIC  X(0008).
  4255*    -------------------------------
  4256     05  CTIMEL PIC S9(0004) COMP.
  4257     05  CTIMEF PIC  X(0001).
  4258     05  FILLER REDEFINES CTIMEF.
  4259         10  CTIMEA PIC  X(0001).
  4260     05  CTIMEI PIC  X(0005).
  4261*    -------------------------------
  4262     05  CHEADL PIC S9(0004) COMP.
  4263     05  CHEADF PIC  X(0001).
  4264     05  FILLER REDEFINES CHEADF.
  4265         10  CHEADA PIC  X(0001).
  4266     05  CHEADI PIC  X(0038).
  4267*    -------------------------------
  4268     05  CCHGTL PIC S9(0004) COMP.
  4269     05  CCHGTF PIC  X(0001).
  4270     05  FILLER REDEFINES CCHGTF.
  4271         10  CCHGTA PIC  X(0001).
  4272     05  CCHGTI PIC  X(0004).
  4273*    -------------------------------
  4274     05  CCHGL PIC S9(0004) COMP.
  4275     05  CCHGF PIC  X(0001).
  4276     05  FILLER REDEFINES CCHGF.
  4277         10  CCHGA PIC  X(0001).
  4278     05  CCHGI PIC  X(0004).
  4279*    -------------------------------
  4280     05  CMAINTL PIC S9(0004) COMP.
  4281     05  CMAINTF PIC  X(0001).
  4282     05  FILLER REDEFINES CMAINTF.
  4283         10  CMAINTA PIC  X(0001).
  4284     05  CMAINTI PIC  X(0001).
  4285*    -------------------------------
  4286     05  CMANTBYL PIC S9(0004) COMP.
  4287     05  CMANTBYF PIC  X(0001).
  4288     05  FILLER REDEFINES CMANTBYF.
  4289         10  CMANTBYA PIC  X(0001).
  4290     05  CMANTBYI PIC  X(0004).
  4291*    -------------------------------
  4292     05  CCHGHDGL PIC S9(0004) COMP.
  4293     05  CCHGHDGF PIC  X(0001).
  4294     05  FILLER REDEFINES CCHGHDGF.
  4295         10  CCHGHDGA PIC  X(0001).
  4296     05  CCHGHDGI PIC  X(0003).
  4297*    -------------------------------
  4298     05  CMANTDTL PIC S9(0004) COMP.
  4299     05  CMANTDTF PIC  X(0001).
  4300     05  FILLER REDEFINES CMANTDTF.
  4301         10  CMANTDTA PIC  X(0001).
  4302     05  CMANTDTI PIC  X(0008).
  4303*    -------------------------------
  4304     05  CMANTATL PIC S9(0004) COMP.
  4305     05  CMANTATF PIC  X(0001).
  4306     05  FILLER REDEFINES CMANTATF.
  4307         10  CMANTATA PIC  X(0001).
  4308     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  82
* EL6311.cbl
  4309*    -------------------------------
  4310     05  CCSRL PIC S9(0004) COMP.
  4311     05  CCSRF PIC  X(0001).
  4312     05  FILLER REDEFINES CCSRF.
  4313         10  CCSRA PIC  X(0001).
  4314     05  CCSRI PIC  X(0004).
  4315*    -------------------------------
  4316     05  CBATCHL PIC S9(0004) COMP.
  4317     05  CBATCHF PIC  X(0001).
  4318     05  FILLER REDEFINES CBATCHF.
  4319         10  CBATCHA PIC  X(0001).
  4320     05  CBATCHI PIC  X(0006).
  4321*    -------------------------------
  4322     05  CSEQL PIC S9(0004) COMP.
  4323     05  CSEQF PIC  X(0001).
  4324     05  FILLER REDEFINES CSEQF.
  4325         10  CSEQA PIC  X(0001).
  4326     05  CSEQI PIC  X(0004).
  4327*    -------------------------------
  4328     05  CMOENDTL PIC S9(0004) COMP.
  4329     05  CMOENDTF PIC  X(0001).
  4330     05  FILLER REDEFINES CMOENDTF.
  4331         10  CMOENDTA PIC  X(0001).
  4332     05  CMOENDTI PIC  X(0008).
  4333*    -------------------------------
  4334     05  CCARRL PIC S9(0004) COMP.
  4335     05  CCARRF PIC  X(0001).
  4336     05  FILLER REDEFINES CCARRF.
  4337         10  CCARRA PIC  X(0001).
  4338     05  CCARRI PIC  X(0001).
  4339*    -------------------------------
  4340     05  CGROUPL PIC S9(0004) COMP.
  4341     05  CGROUPF PIC  X(0001).
  4342     05  FILLER REDEFINES CGROUPF.
  4343         10  CGROUPA PIC  X(0001).
  4344     05  CGROUPI PIC  X(0006).
  4345*    -------------------------------
  4346     05  CSTATEL PIC S9(0004) COMP.
  4347     05  CSTATEF PIC  X(0001).
  4348     05  FILLER REDEFINES CSTATEF.
  4349         10  CSTATEA PIC  X(0001).
  4350     05  CSTATEI PIC  X(0002).
  4351*    -------------------------------
  4352     05  CACCTL PIC S9(0004) COMP.
  4353     05  CACCTF PIC  X(0001).
  4354     05  FILLER REDEFINES CACCTF.
  4355         10  CACCTA PIC  X(0001).
  4356     05  CACCTI PIC  X(0010).
  4357*    -------------------------------
  4358     05  CORIGHDL PIC S9(0004) COMP.
  4359     05  CORIGHDF PIC  X(0001).
  4360     05  FILLER REDEFINES CORIGHDF.
  4361         10  CORIGHDA PIC  X(0001).
  4362     05  CORIGHDI PIC  X(0011).
  4363*    -------------------------------
  4364     05  CORGNOL PIC S9(0004) COMP.
  4365     05  CORGNOF PIC  X(0001).
  4366     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  83
* EL6311.cbl
  4367         10  CORGNOA PIC  X(0001).
  4368     05  CORGNOI PIC  X(0006).
  4369*    -------------------------------
  4370     05  CORGSEQL PIC S9(0004) COMP.
  4371     05  CORGSEQF PIC  X(0001).
  4372     05  FILLER REDEFINES CORGSEQF.
  4373         10  CORGSEQA PIC  X(0001).
  4374     05  CORGSEQI PIC  X(0004).
  4375*    -------------------------------
  4376     05  CREFHDGL PIC S9(0004) COMP.
  4377     05  CREFHDGF PIC  X(0001).
  4378     05  FILLER REDEFINES CREFHDGF.
  4379         10  CREFHDGA PIC  X(0001).
  4380     05  CREFHDGI PIC  X(0010).
  4381*    -------------------------------
  4382     05  CREFL PIC S9(0004) COMP.
  4383     05  CREFF PIC  X(0001).
  4384     05  FILLER REDEFINES CREFF.
  4385         10  CREFA PIC  X(0001).
  4386     05  CREFI PIC  X(0012).
  4387*    -------------------------------
  4388     05  CNHINTL PIC S9(0004) COMP.
  4389     05  CNHINTF PIC  X(0001).
  4390     05  FILLER REDEFINES CNHINTF.
  4391         10  CNHINTA PIC  X(0001).
  4392     05  CNHINTI PIC  9(7)V99.
  4393*    -------------------------------
  4394     05  CCERTNOL PIC S9(0004) COMP.
  4395     05  CCERTNOF PIC  X(0001).
  4396     05  FILLER REDEFINES CCERTNOF.
  4397         10  CCERTNOA PIC  X(0001).
  4398     05  CCERTNOI PIC  X(0010).
  4399*    -------------------------------
  4400     05  CSUFIXL PIC S9(0004) COMP.
  4401     05  CSUFIXF PIC  X(0001).
  4402     05  FILLER REDEFINES CSUFIXF.
  4403         10  CSUFIXA PIC  X(0001).
  4404     05  CSUFIXI PIC  X(0001).
  4405*    -------------------------------
  4406     05  CEFFDTL PIC S9(0004) COMP.
  4407     05  CEFFDTF PIC  X(0001).
  4408     05  FILLER REDEFINES CEFFDTF.
  4409         10  CEFFDTA PIC  X(0001).
  4410     05  CEFFDTI PIC  X(0008).
  4411*    -------------------------------
  4412     05  CLSTNML PIC S9(0004) COMP.
  4413     05  CLSTNMF PIC  X(0001).
  4414     05  FILLER REDEFINES CLSTNMF.
  4415         10  CLSTNMA PIC  X(0001).
  4416     05  CLSTNMI PIC  X(0015).
  4417*    -------------------------------
  4418     05  CPCYNL PIC S9(0004) COMP.
  4419     05  CPCYNF PIC  X(0001).
  4420     05  FILLER REDEFINES CPCYNF.
  4421         10  CPCYNA PIC  X(0001).
  4422     05  CPCYNI PIC  X(0001).
  4423*    -------------------------------
  4424     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  84
* EL6311.cbl
  4425     05  CINAMEF PIC  X(0001).
  4426     05  FILLER REDEFINES CINAMEF.
  4427         10  CINAMEA PIC  X(0001).
  4428     05  CINAMEI PIC  X(0015).
  4429*    -------------------------------
  4430     05  CINITSL PIC S9(0004) COMP.
  4431     05  CINITSF PIC  X(0001).
  4432     05  FILLER REDEFINES CINITSF.
  4433         10  CINITSA PIC  X(0001).
  4434     05  CINITSI PIC  X(0010).
  4435*    -------------------------------
  4436     05  CCANREAL PIC S9(0004) COMP.
  4437     05  CCANREAF PIC  X(0001).
  4438     05  FILLER REDEFINES CCANREAF.
  4439         10  CCANREAA PIC  X(0001).
  4440     05  CCANREAI PIC  X(0001).
  4441*    -------------------------------
  4442     05  CKIND1L PIC S9(0004) COMP.
  4443     05  CKIND1F PIC  X(0001).
  4444     05  FILLER REDEFINES CKIND1F.
  4445         10  CKIND1A PIC  X(0001).
  4446     05  CKIND1I PIC  X(0002).
  4447*    -------------------------------
  4448     05  CCANDT1L PIC S9(0004) COMP.
  4449     05  CCANDT1F PIC  X(0001).
  4450     05  FILLER REDEFINES CCANDT1F.
  4451         10  CCANDT1A PIC  X(0001).
  4452     05  CCANDT1I PIC  X(0008).
  4453*    -------------------------------
  4454     05  CREFND1L PIC S9(0004) COMP.
  4455     05  CREFND1F PIC  X(0001).
  4456     05  FILLER REDEFINES CREFND1F.
  4457         10  CREFND1A PIC  X(0001).
  4458     05  CREFND1I PIC  S9(9)V99.
  4459*    -------------------------------
  4460     05  CMTHD1L PIC S9(0004) COMP.
  4461     05  CMTHD1F PIC  X(0001).
  4462     05  FILLER REDEFINES CMTHD1F.
  4463         10  CMTHD1A PIC  X(0001).
  4464     05  CMTHD1I PIC  X(0001).
  4465*    -------------------------------
  4466     05  CKIND2L PIC S9(0004) COMP.
  4467     05  CKIND2F PIC  X(0001).
  4468     05  FILLER REDEFINES CKIND2F.
  4469         10  CKIND2A PIC  X(0001).
  4470     05  CKIND2I PIC  X(0002).
  4471*    -------------------------------
  4472     05  CCANDT2L PIC S9(0004) COMP.
  4473     05  CCANDT2F PIC  X(0001).
  4474     05  FILLER REDEFINES CCANDT2F.
  4475         10  CCANDT2A PIC  X(0001).
  4476     05  CCANDT2I PIC  X(0008).
  4477*    -------------------------------
  4478     05  CREFND2L PIC S9(0004) COMP.
  4479     05  CREFND2F PIC  X(0001).
  4480     05  FILLER REDEFINES CREFND2F.
  4481         10  CREFND2A PIC  X(0001).
  4482     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  85
* EL6311.cbl
  4483*    -------------------------------
  4484     05  CMTHD2L PIC S9(0004) COMP.
  4485     05  CMTHD2F PIC  X(0001).
  4486     05  FILLER REDEFINES CMTHD2F.
  4487         10  CMTHD2A PIC  X(0001).
  4488     05  CMTHD2I PIC  X(0001).
  4489*    -------------------------------
  4490     05  CLIVESL PIC S9(0004) COMP.
  4491     05  CLIVESF PIC  X(0001).
  4492     05  FILLER REDEFINES CLIVESF.
  4493         10  CLIVESA PIC  X(0001).
  4494     05  CLIVESI PIC  X(0003).
  4495*    -------------------------------
  4496     05  CFORCEL PIC S9(0004) COMP.
  4497     05  CFORCEF PIC  X(0001).
  4498     05  FILLER REDEFINES CFORCEF.
  4499         10  CFORCEA PIC  X(0001).
  4500     05  CFORCEI PIC  X(0001).
  4501*    -------------------------------
  4502     05  CBILCDL PIC S9(0004) COMP.
  4503     05  CBILCDF PIC  X(0001).
  4504     05  FILLER REDEFINES CBILCDF.
  4505         10  CBILCDA PIC  X(0001).
  4506     05  CBILCDI PIC  X(0001).
  4507*    -------------------------------
  4508     05  CCRFND1L PIC S9(0004) COMP.
  4509     05  CCRFND1F PIC  X(0001).
  4510     05  FILLER REDEFINES CCRFND1F.
  4511         10  CCRFND1A PIC  X(0001).
  4512     05  CCRFND1I PIC  X(0011).
  4513*    -------------------------------
  4514     05  CCRFND2L PIC S9(0004) COMP.
  4515     05  CCRFND2F PIC  X(0001).
  4516     05  FILLER REDEFINES CCRFND2F.
  4517         10  CCRFND2A PIC  X(0001).
  4518     05  CCRFND2I PIC  X(0011).
  4519*    -------------------------------
  4520     05  CBILIT1L PIC S9(0004) COMP.
  4521     05  CBILIT1F PIC  X(0001).
  4522     05  FILLER REDEFINES CBILIT1F.
  4523         10  CBILIT1A PIC  X(0001).
  4524     05  CBILIT1I PIC  X(0008).
  4525*    -------------------------------
  4526     05  CDRFND1L PIC S9(0004) COMP.
  4527     05  CDRFND1F PIC  X(0001).
  4528     05  FILLER REDEFINES CDRFND1F.
  4529         10  CDRFND1A PIC  X(0001).
  4530     05  CDRFND1I PIC  X(0011).
  4531*    -------------------------------
  4532     05  CBILIT2L PIC S9(0004) COMP.
  4533     05  CBILIT2F PIC  X(0001).
  4534     05  FILLER REDEFINES CBILIT2F.
  4535         10  CBILIT2A PIC  X(0001).
  4536     05  CBILIT2I PIC  X(0008).
  4537*    -------------------------------
  4538     05  CDRFND2L PIC S9(0004) COMP.
  4539     05  CDRFND2F PIC  X(0001).
  4540     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  86
* EL6311.cbl
  4541         10  CDRFND2A PIC  X(0001).
  4542     05  CDRFND2I PIC  X(0011).
  4543*    -------------------------------
  4544     05  CCANTXTL PIC S9(0004) COMP.
  4545     05  CCANTXTF PIC  X(0001).
  4546     05  FILLER REDEFINES CCANTXTF.
  4547         10  CCANTXTA PIC  X(0001).
  4548     05  CCANTXTI PIC  X(0005).
  4549*    -------------------------------
  4550     05  CCANFEEL PIC S9(0004) COMP.
  4551     05  CCANFEEF PIC  X(0001).
  4552     05  FILLER REDEFINES CCANFEEF.
  4553         10  CCANFEEA PIC  X(0001).
  4554     05  CCANFEEI PIC  X(0002).
  4555*    -------------------------------
  4556     05  CTERM1L PIC S9(0004) COMP.
  4557     05  CTERM1F PIC  X(0001).
  4558     05  FILLER REDEFINES CTERM1F.
  4559         10  CTERM1A PIC  X(0001).
  4560     05  CTERM1I PIC  X(0003).
  4561*    -------------------------------
  4562     05  CRTERM1L PIC S9(0004) COMP.
  4563     05  CRTERM1F PIC  X(0001).
  4564     05  FILLER REDEFINES CRTERM1F.
  4565         10  CRTERM1A PIC  X(0001).
  4566     05  CRTERM1I PIC  X(0003).
  4567*    -------------------------------
  4568     05  CPREM1L PIC S9(0004) COMP.
  4569     05  CPREM1F PIC  X(0001).
  4570     05  FILLER REDEFINES CPREM1F.
  4571         10  CPREM1A PIC  X(0001).
  4572     05  CPREM1I PIC  X(0011).
  4573*    -------------------------------
  4574     05  CTERM2L PIC S9(0004) COMP.
  4575     05  CTERM2F PIC  X(0001).
  4576     05  FILLER REDEFINES CTERM2F.
  4577         10  CTERM2A PIC  X(0001).
  4578     05  CTERM2I PIC  X(0003).
  4579*    -------------------------------
  4580     05  CRTERM2L PIC S9(0004) COMP.
  4581     05  CRTERM2F PIC  X(0001).
  4582     05  FILLER REDEFINES CRTERM2F.
  4583         10  CRTERM2A PIC  X(0001).
  4584     05  CRTERM2I PIC  X(0003).
  4585*    -------------------------------
  4586     05  CPREM2L PIC S9(0004) COMP.
  4587     05  CPREM2F PIC  X(0001).
  4588     05  FILLER REDEFINES CPREM2F.
  4589         10  CPREM2A PIC  X(0001).
  4590     05  CPREM2I PIC  X(0011).
  4591*    -------------------------------
  4592     05  CENTRDTL PIC S9(0004) COMP.
  4593     05  CENTRDTF PIC  X(0001).
  4594     05  FILLER REDEFINES CENTRDTF.
  4595         10  CENTRDTA PIC  X(0001).
  4596     05  CENTRDTI PIC  X(0008).
  4597*    -------------------------------
  4598     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  87
* EL6311.cbl
  4599     05  CPAYEEF PIC  X(0001).
  4600     05  FILLER REDEFINES CPAYEEF.
  4601         10  CPAYEEA PIC  X(0001).
  4602     05  CPAYEEI PIC  X(0006).
  4603*    -------------------------------
  4604     05  CRFNDSWL PIC S9(0004) COMP.
  4605     05  CRFNDSWF PIC  X(0001).
  4606     05  FILLER REDEFINES CRFNDSWF.
  4607         10  CRFNDSWA PIC  X(0001).
  4608     05  CRFNDSWI PIC  X(0003).
  4609*    -------------------------------
  4610     05  CLFHDGL PIC S9(0004) COMP.
  4611     05  CLFHDGF PIC  X(0001).
  4612     05  FILLER REDEFINES CLFHDGF.
  4613         10  CLFHDGA PIC  X(0001).
  4614     05  CLFHDGI PIC  X(0006).
  4615*    -------------------------------
  4616     05  CAHHDGL PIC S9(0004) COMP.
  4617     05  CAHHDGF PIC  X(0001).
  4618     05  FILLER REDEFINES CAHHDGF.
  4619         10  CAHHDGA PIC  X(0001).
  4620     05  CAHHDGI PIC  X(0006).
  4621*    -------------------------------
  4622     05  CENTDTL PIC S9(0004) COMP.
  4623     05  CENTDTF PIC  X(0001).
  4624     05  FILLER REDEFINES CENTDTF.
  4625         10  CENTDTA PIC  X(0001).
  4626     05  CENTDTI PIC  X(0008).
  4627*    -------------------------------
  4628     05  CENTBYL PIC S9(0004) COMP.
  4629     05  CENTBYF PIC  X(0001).
  4630     05  FILLER REDEFINES CENTBYF.
  4631         10  CENTBYA PIC  X(0001).
  4632     05  CENTBYI PIC  X(0004).
  4633*    -------------------------------
  4634     05  CCHGCNTL PIC S9(0004) COMP.
  4635     05  CCHGCNTF PIC  X(0001).
  4636     05  FILLER REDEFINES CCHGCNTF.
  4637         10  CCHGCNTA PIC  X(0001).
  4638     05  CCHGCNTI PIC  X(0003).
  4639*    -------------------------------
  4640     05  CLFREFNL PIC S9(0004) COMP.
  4641     05  CLFREFNF PIC  X(0001).
  4642     05  FILLER REDEFINES CLFREFNF.
  4643         10  CLFREFNA PIC  X(0001).
  4644     05  CLFREFNI PIC  X(0006).
  4645*    -------------------------------
  4646     05  CAHREFNL PIC S9(0004) COMP.
  4647     05  CAHREFNF PIC  X(0001).
  4648     05  FILLER REDEFINES CAHREFNF.
  4649         10  CAHREFNA PIC  X(0001).
  4650     05  CAHREFNI PIC  X(0006).
  4651*    -------------------------------
  4652     05  CREINCDL PIC S9(0004) COMP.
  4653     05  CREINCDF PIC  X(0001).
  4654     05  FILLER REDEFINES CREINCDF.
  4655         10  CREINCDA PIC  X(0001).
  4656     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  88
* EL6311.cbl
  4657*    -------------------------------
  4658     05  CAEFFDTL PIC S9(0004) COMP.
  4659     05  CAEFFDTF PIC  X(0001).
  4660     05  FILLER REDEFINES CAEFFDTF.
  4661         10  CAEFFDTA PIC  X(0001).
  4662     05  CAEFFDTI PIC  X(0008).
  4663*    -------------------------------
  4664     05  CAEXPDTL PIC S9(0004) COMP.
  4665     05  CAEXPDTF PIC  X(0001).
  4666     05  FILLER REDEFINES CAEXPDTF.
  4667         10  CAEXPDTA PIC  X(0001).
  4668     05  CAEXPDTI PIC  X(0008).
  4669*    -------------------------------
  4670     05  COMMLFL PIC S9(0004) COMP.
  4671     05  COMMLFF PIC  X(0001).
  4672     05  FILLER REDEFINES COMMLFF.
  4673         10  COMMLFA PIC  X(0001).
  4674     05  COMMLFI PIC  X(0006).
  4675*    -------------------------------
  4676     05  COMMAHL PIC S9(0004) COMP.
  4677     05  COMMAHF PIC  X(0001).
  4678     05  FILLER REDEFINES COMMAHF.
  4679         10  COMMAHA PIC  X(0001).
  4680     05  COMMAHI PIC  X(0006).
  4681*    -------------------------------
  4682     05  CERMSG1L PIC S9(0004) COMP.
  4683     05  CERMSG1F PIC  X(0001).
  4684     05  FILLER REDEFINES CERMSG1F.
  4685         10  CERMSG1A PIC  X(0001).
  4686     05  CERMSG1I PIC  X(0078).
  4687*    -------------------------------
  4688     05  CERMSG2L PIC S9(0004) COMP.
  4689     05  CERMSG2F PIC  X(0001).
  4690     05  FILLER REDEFINES CERMSG2F.
  4691         10  CERMSG2A PIC  X(0001).
  4692     05  CERMSG2I PIC  X(0078).
  4693*    -------------------------------
  4694     05  CERMSG3L PIC S9(0004) COMP.
  4695     05  CERMSG3F PIC  X(0001).
  4696     05  FILLER REDEFINES CERMSG3F.
  4697         10  CERMSG3A PIC  X(0001).
  4698     05  CERMSG3I PIC  X(0078).
  4699*    -------------------------------
  4700     05  CPFENTRL PIC S9(0004) COMP.
  4701     05  CPFENTRF PIC  X(0001).
  4702     05  FILLER REDEFINES CPFENTRF.
  4703         10  CPFENTRA PIC  X(0001).
  4704     05  CPFENTRI PIC  9(2).
  4705*    -------------------------------
  4706     05  CPF5HDRL PIC S9(0004) COMP.
  4707     05  CPF5HDRF PIC  X(0001).
  4708     05  FILLER REDEFINES CPF5HDRF.
  4709         10  CPF5HDRA PIC  X(0001).
  4710     05  CPF5HDRI PIC  X(0005).
  4711*    -------------------------------
  4712     05  CPF4HDRL PIC S9(0004) COMP.
  4713     05  CPF4HDRF PIC  X(0001).
  4714     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  89
* EL6311.cbl
  4715         10  CPF4HDRA PIC  X(0001).
  4716     05  CPF4HDRI PIC  X(0013).
  4717*    -------------------------------
  4718     05  CF15HDRL PIC S9(0004) COMP.
  4719     05  CF15HDRF PIC  X(0001).
  4720     05  FILLER REDEFINES CF15HDRF.
  4721         10  CF15HDRA PIC  X(0001).
  4722     05  CF15HDRI PIC  X(0022).
  4723 01  EL631CO REDEFINES EL631BI.
  4724     05  FILLER            PIC  X(0012).
  4725*    -------------------------------
  4726     05  FILLER            PIC  X(0003).
  4727     05  CDATEO PIC  X(0008).
  4728*    -------------------------------
  4729     05  FILLER            PIC  X(0003).
  4730     05  CTIMEO PIC  99.99.
  4731*    -------------------------------
  4732     05  FILLER            PIC  X(0003).
  4733     05  CHEADO PIC  X(0038).
  4734*    -------------------------------
  4735     05  FILLER            PIC  X(0003).
  4736     05  CCHGTO PIC  X(0004).
  4737*    -------------------------------
  4738     05  FILLER            PIC  X(0003).
  4739     05  CCHGO PIC  ZZZ9.
  4740*    -------------------------------
  4741     05  FILLER            PIC  X(0003).
  4742     05  CMAINTO PIC  X(0001).
  4743*    -------------------------------
  4744     05  FILLER            PIC  X(0003).
  4745     05  CMANTBYO PIC  X(0004).
  4746*    -------------------------------
  4747     05  FILLER            PIC  X(0003).
  4748     05  CCHGHDGO PIC  X(0003).
  4749*    -------------------------------
  4750     05  FILLER            PIC  X(0003).
  4751     05  CMANTDTO PIC  X(0008).
  4752*    -------------------------------
  4753     05  FILLER            PIC  X(0003).
  4754     05  CMANTATO PIC  99.99.
  4755*    -------------------------------
  4756     05  FILLER            PIC  X(0003).
  4757     05  CCSRO PIC  X(0004).
  4758*    -------------------------------
  4759     05  FILLER            PIC  X(0003).
  4760     05  CBATCHO PIC  X(0006).
  4761*    -------------------------------
  4762     05  FILLER            PIC  X(0003).
  4763     05  CSEQO PIC  X(0004).
  4764*    -------------------------------
  4765     05  FILLER            PIC  X(0003).
  4766     05  CMOENDTO PIC  X(0008).
  4767*    -------------------------------
  4768     05  FILLER            PIC  X(0003).
  4769     05  CCARRO PIC  X(0001).
  4770*    -------------------------------
  4771     05  FILLER            PIC  X(0003).
  4772     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  90
* EL6311.cbl
  4773*    -------------------------------
  4774     05  FILLER            PIC  X(0003).
  4775     05  CSTATEO PIC  X(0002).
  4776*    -------------------------------
  4777     05  FILLER            PIC  X(0003).
  4778     05  CACCTO PIC  X(0010).
  4779*    -------------------------------
  4780     05  FILLER            PIC  X(0003).
  4781     05  CORIGHDO PIC  X(0011).
  4782*    -------------------------------
  4783     05  FILLER            PIC  X(0003).
  4784     05  CORGNOO PIC  X(0006).
  4785*    -------------------------------
  4786     05  FILLER            PIC  X(0003).
  4787     05  CORGSEQO PIC  X(0004).
  4788*    -------------------------------
  4789     05  FILLER            PIC  X(0003).
  4790     05  CREFHDGO PIC  X(0010).
  4791*    -------------------------------
  4792     05  FILLER            PIC  X(0003).
  4793     05  CREFO PIC  X(0012).
  4794*    -------------------------------
  4795     05  FILLER            PIC  X(0003).
  4796     05  CNHINTO PIC  999999.99.
  4797*    -------------------------------
  4798     05  FILLER            PIC  X(0003).
  4799     05  CCERTNOO PIC  X(0010).
  4800*    -------------------------------
  4801     05  FILLER            PIC  X(0003).
  4802     05  CSUFIXO PIC  X(0001).
  4803*    -------------------------------
  4804     05  FILLER            PIC  X(0003).
  4805     05  CEFFDTO PIC  X(0008).
  4806*    -------------------------------
  4807     05  FILLER            PIC  X(0003).
  4808     05  CLSTNMO PIC  X(0015).
  4809*    -------------------------------
  4810     05  FILLER            PIC  X(0003).
  4811     05  CPCYNO PIC  X(0001).
  4812*    -------------------------------
  4813     05  FILLER            PIC  X(0003).
  4814     05  CINAMEO PIC  X(0015).
  4815*    -------------------------------
  4816     05  FILLER            PIC  X(0003).
  4817     05  CINITSO PIC  X(0010).
  4818*    -------------------------------
  4819     05  FILLER            PIC  X(0003).
  4820     05  CCANREAO PIC  X(0001).
  4821*    -------------------------------
  4822     05  FILLER            PIC  X(0003).
  4823     05  CKIND1O PIC  X(0002).
  4824*    -------------------------------
  4825     05  FILLER            PIC  X(0003).
  4826     05  CCANDT1O PIC  X(0008).
  4827*    -------------------------------
  4828     05  FILLER            PIC  X(0003).
  4829     05  CREFND1O PIC  Z(7).99-.
  4830*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  91
* EL6311.cbl
  4831     05  FILLER            PIC  X(0003).
  4832     05  CMTHD1O PIC  X(0001).
  4833*    -------------------------------
  4834     05  FILLER            PIC  X(0003).
  4835     05  CKIND2O PIC  X(0002).
  4836*    -------------------------------
  4837     05  FILLER            PIC  X(0003).
  4838     05  CCANDT2O PIC  X(0008).
  4839*    -------------------------------
  4840     05  FILLER            PIC  X(0003).
  4841     05  CREFND2O PIC  Z(7).99-.
  4842*    -------------------------------
  4843     05  FILLER            PIC  X(0003).
  4844     05  CMTHD2O PIC  X(0001).
  4845*    -------------------------------
  4846     05  FILLER            PIC  X(0003).
  4847     05  CLIVESO PIC  X(0003).
  4848*    -------------------------------
  4849     05  FILLER            PIC  X(0003).
  4850     05  CFORCEO PIC  X(0001).
  4851*    -------------------------------
  4852     05  FILLER            PIC  X(0003).
  4853     05  CBILCDO PIC  X(0001).
  4854*    -------------------------------
  4855     05  FILLER            PIC  X(0003).
  4856     05  CCRFND1O PIC  Z(7).99-.
  4857*    -------------------------------
  4858     05  FILLER            PIC  X(0003).
  4859     05  CCRFND2O PIC  Z(7).99-.
  4860*    -------------------------------
  4861     05  FILLER            PIC  X(0003).
  4862     05  CBILIT1O PIC  X(0008).
  4863*    -------------------------------
  4864     05  FILLER            PIC  X(0003).
  4865     05  CDRFND1O PIC  Z(7).99-.
  4866*    -------------------------------
  4867     05  FILLER            PIC  X(0003).
  4868     05  CBILIT2O PIC  X(0008).
  4869*    -------------------------------
  4870     05  FILLER            PIC  X(0003).
  4871     05  CDRFND2O PIC  Z(7).99-.
  4872*    -------------------------------
  4873     05  FILLER            PIC  X(0003).
  4874     05  CCANTXTO PIC  X(0005).
  4875*    -------------------------------
  4876     05  FILLER            PIC  X(0003).
  4877     05  CCANFEEO PIC  Z9.
  4878*    -------------------------------
  4879     05  FILLER            PIC  X(0003).
  4880     05  CTERM1O PIC  ZZ9.
  4881*    -------------------------------
  4882     05  FILLER            PIC  X(0003).
  4883     05  CRTERM1O PIC  ZZ9.
  4884*    -------------------------------
  4885     05  FILLER            PIC  X(0003).
  4886     05  CPREM1O PIC  ZZZZZZ9.99-.
  4887*    -------------------------------
  4888     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  92
* EL6311.cbl
  4889     05  CTERM2O PIC  ZZ9.
  4890*    -------------------------------
  4891     05  FILLER            PIC  X(0003).
  4892     05  CRTERM2O PIC  ZZ9.
  4893*    -------------------------------
  4894     05  FILLER            PIC  X(0003).
  4895     05  CPREM2O PIC  ZZZZZZ9.99-.
  4896*    -------------------------------
  4897     05  FILLER            PIC  X(0003).
  4898     05  CENTRDTO PIC  X(0008).
  4899*    -------------------------------
  4900     05  FILLER            PIC  X(0003).
  4901     05  CPAYEEO PIC  X(0006).
  4902*    -------------------------------
  4903     05  FILLER            PIC  X(0003).
  4904     05  CRFNDSWO PIC  X(0003).
  4905*    -------------------------------
  4906     05  FILLER            PIC  X(0003).
  4907     05  CLFHDGO PIC  X(0006).
  4908*    -------------------------------
  4909     05  FILLER            PIC  X(0003).
  4910     05  CAHHDGO PIC  X(0006).
  4911*    -------------------------------
  4912     05  FILLER            PIC  X(0003).
  4913     05  CENTDTO PIC  X(0008).
  4914*    -------------------------------
  4915     05  FILLER            PIC  X(0003).
  4916     05  CENTBYO PIC  X(0004).
  4917*    -------------------------------
  4918     05  FILLER            PIC  X(0003).
  4919     05  CCHGCNTO PIC  X(0003).
  4920*    -------------------------------
  4921     05  FILLER            PIC  X(0003).
  4922     05  CLFREFNO PIC  X(0006).
  4923*    -------------------------------
  4924     05  FILLER            PIC  X(0003).
  4925     05  CAHREFNO PIC  X(0006).
  4926*    -------------------------------
  4927     05  FILLER            PIC  X(0003).
  4928     05  CREINCDO PIC  X(0003).
  4929*    -------------------------------
  4930     05  FILLER            PIC  X(0003).
  4931     05  CAEFFDTO PIC  X(0008).
  4932*    -------------------------------
  4933     05  FILLER            PIC  X(0003).
  4934     05  CAEXPDTO PIC  X(0008).
  4935*    -------------------------------
  4936     05  FILLER            PIC  X(0003).
  4937     05  COMMLFO PIC  .99999.
  4938*    -------------------------------
  4939     05  FILLER            PIC  X(0003).
  4940     05  COMMAHO PIC  .99999.
  4941*    -------------------------------
  4942     05  FILLER            PIC  X(0003).
  4943     05  CERMSG1O PIC  X(0078).
  4944*    -------------------------------
  4945     05  FILLER            PIC  X(0003).
  4946     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  93
* EL6311.cbl
  4947*    -------------------------------
  4948     05  FILLER            PIC  X(0003).
  4949     05  CERMSG3O PIC  X(0078).
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
  4952     05  CPFENTRO PIC  X(0002).
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  CPF5HDRO PIC  X(0005).
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
  4958     05  CPF4HDRO PIC  X(0013).
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  CF15HDRO PIC  X(0022).
  4962*    -------------------------------
  4963 01  EL631DI REDEFINES EL631BI.
  4964     05  FILLER            PIC  X(0012).
  4965*    -------------------------------
  4966     05  DDATEL PIC S9(0004) COMP.
  4967     05  DDATEF PIC  X(0001).
  4968     05  FILLER REDEFINES DDATEF.
  4969         10  DDATEA PIC  X(0001).
  4970     05  DDATEI PIC  X(0008).
  4971*    -------------------------------
  4972     05  DTIMEL PIC S9(0004) COMP.
  4973     05  DTIMEF PIC  X(0001).
  4974     05  FILLER REDEFINES DTIMEF.
  4975         10  DTIMEA PIC  X(0001).
  4976     05  DTIMEI PIC  X(0005).
  4977*    -------------------------------
  4978     05  DHEADL PIC S9(0004) COMP.
  4979     05  DHEADF PIC  X(0001).
  4980     05  FILLER REDEFINES DHEADF.
  4981         10  DHEADA PIC  X(0001).
  4982     05  DHEADI PIC  X(0038).
  4983*    -------------------------------
  4984     05  DLDATEL PIC S9(0004) COMP.
  4985     05  DLDATEF PIC  X(0001).
  4986     05  FILLER REDEFINES DLDATEF.
  4987         10  DLDATEA PIC  X(0001).
  4988     05  DLDATEI PIC  X(0010).
  4989*    -------------------------------
  4990     05  DBATCHL PIC S9(0004) COMP.
  4991     05  DBATCHF PIC  X(0001).
  4992     05  FILLER REDEFINES DBATCHF.
  4993         10  DBATCHA PIC  X(0001).
  4994     05  DBATCHI PIC  X(0011).
  4995*    -------------------------------
  4996     05  DACCTNML PIC S9(0004) COMP.
  4997     05  DACCTNMF PIC  X(0001).
  4998     05  FILLER REDEFINES DACCTNMF.
  4999         10  DACCTNMA PIC  X(0001).
  5000     05  DACCTNMI PIC  X(0030).
  5001*    -------------------------------
  5002     05  DPROCDTL PIC S9(0004) COMP.
  5003     05  DPROCDTF PIC  X(0001).
  5004     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  94
* EL6311.cbl
  5005         10  DPROCDTA PIC  X(0001).
  5006     05  DPROCDTI PIC  X(0008).
  5007*    -------------------------------
  5008     05  DINPUTL PIC S9(0004) COMP.
  5009     05  DINPUTF PIC  X(0001).
  5010     05  FILLER REDEFINES DINPUTF.
  5011         10  DINPUTA PIC  X(0001).
  5012     05  DINPUTI PIC  X(0008).
  5013*    -------------------------------
  5014     05  DMAINDTL PIC S9(0004) COMP.
  5015     05  DMAINDTF PIC  X(0001).
  5016     05  FILLER REDEFINES DMAINDTF.
  5017         10  DMAINDTA PIC  X(0001).
  5018     05  DMAINDTI PIC  X(0008).
  5019*    -------------------------------
  5020     05  DCARRL PIC S9(0004) COMP.
  5021     05  DCARRF PIC  X(0001).
  5022     05  FILLER REDEFINES DCARRF.
  5023         10  DCARRA PIC  X(0001).
  5024     05  DCARRI PIC  X(0001).
  5025*    -------------------------------
  5026     05  DGROUPL PIC S9(0004) COMP.
  5027     05  DGROUPF PIC  X(0001).
  5028     05  FILLER REDEFINES DGROUPF.
  5029         10  DGROUPA PIC  X(0001).
  5030     05  DGROUPI PIC  X(0006).
  5031*    -------------------------------
  5032     05  DSTATEL PIC S9(0004) COMP.
  5033     05  DSTATEF PIC  X(0001).
  5034     05  FILLER REDEFINES DSTATEF.
  5035         10  DSTATEA PIC  X(0001).
  5036     05  DSTATEI PIC  X(0002).
  5037*    -------------------------------
  5038     05  DACCTL PIC S9(0004) COMP.
  5039     05  DACCTF PIC  X(0001).
  5040     05  FILLER REDEFINES DACCTF.
  5041         10  DACCTA PIC  X(0001).
  5042     05  DACCTI PIC  X(0010).
  5043*    -------------------------------
  5044     05  DRECVDTL PIC S9(0004) COMP.
  5045     05  DRECVDTF PIC  X(0001).
  5046     05  FILLER REDEFINES DRECVDTF.
  5047         10  DRECVDTA PIC  X(0001).
  5048     05  DRECVDTI PIC  X(0008).
  5049*    -------------------------------
  5050     05  DCSRL PIC S9(0004) COMP.
  5051     05  DCSRF PIC  X(0001).
  5052     05  FILLER REDEFINES DCSRF.
  5053         10  DCSRA PIC  X(0001).
  5054     05  DCSRI PIC  X(0004).
  5055*    -------------------------------
  5056     05  DREFHDGL PIC S9(0004) COMP.
  5057     05  DREFHDGF PIC  X(0001).
  5058     05  FILLER REDEFINES DREFHDGF.
  5059         10  DREFHDGA PIC  X(0001).
  5060     05  DREFHDGI PIC  X(0010).
  5061*    -------------------------------
  5062     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  95
* EL6311.cbl
  5063     05  DREFF PIC  X(0001).
  5064     05  FILLER REDEFINES DREFF.
  5065         10  DREFA PIC  X(0001).
  5066     05  DREFI PIC  X(0012).
  5067*    -------------------------------
  5068     05  DLFPHDGL PIC S9(0004) COMP.
  5069     05  DLFPHDGF PIC  X(0001).
  5070     05  FILLER REDEFINES DLFPHDGF.
  5071         10  DLFPHDGA PIC  X(0001).
  5072     05  DLFPHDGI PIC  X(0010).
  5073*    -------------------------------
  5074     05  DAHPHDGL PIC S9(0004) COMP.
  5075     05  DAHPHDGF PIC  X(0001).
  5076     05  FILLER REDEFINES DAHPHDGF.
  5077         10  DAHPHDGA PIC  X(0001).
  5078     05  DAHPHDGI PIC  X(0010).
  5079*    -------------------------------
  5080     05  DLFRHDGL PIC S9(0004) COMP.
  5081     05  DLFRHDGF PIC  X(0001).
  5082     05  FILLER REDEFINES DLFRHDGF.
  5083         10  DLFRHDGA PIC  X(0001).
  5084     05  DLFRHDGI PIC  X(0009).
  5085*    -------------------------------
  5086     05  DAHRHDGL PIC S9(0004) COMP.
  5087     05  DAHRHDGF PIC  X(0001).
  5088     05  FILLER REDEFINES DAHRHDGF.
  5089         10  DAHRHDGA PIC  X(0001).
  5090     05  DAHRHDGI PIC  X(0009).
  5091*    -------------------------------
  5092     05  DRISSL PIC S9(0004) COMP.
  5093     05  DRISSF PIC  X(0001).
  5094     05  FILLER REDEFINES DRISSF.
  5095         10  DRISSA PIC  X(0001).
  5096     05  DRISSI PIC  X(0005).
  5097*    -------------------------------
  5098     05  DRLFPRML PIC S9(0004) COMP.
  5099     05  DRLFPRMF PIC  X(0001).
  5100     05  FILLER REDEFINES DRLFPRMF.
  5101         10  DRLFPRMA PIC  X(0001).
  5102     05  DRLFPRMI PIC  S9(9)V99.
  5103*    -------------------------------
  5104     05  DRAHPRML PIC S9(0004) COMP.
  5105     05  DRAHPRMF PIC  X(0001).
  5106     05  FILLER REDEFINES DRAHPRMF.
  5107         10  DRAHPRMA PIC  X(0001).
  5108     05  DRAHPRMI PIC  S9(9)V99.
  5109*    -------------------------------
  5110     05  DRCANCL PIC S9(0004) COMP.
  5111     05  DRCANCF PIC  X(0001).
  5112     05  FILLER REDEFINES DRCANCF.
  5113         10  DRCANCA PIC  X(0001).
  5114     05  DRCANCI PIC  X(0005).
  5115*    -------------------------------
  5116     05  DRLFRFDL PIC S9(0004) COMP.
  5117     05  DRLFRFDF PIC  X(0001).
  5118     05  FILLER REDEFINES DRLFRFDF.
  5119         10  DRLFRFDA PIC  X(0001).
  5120     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  96
* EL6311.cbl
  5121*    -------------------------------
  5122     05  DRAHRFDL PIC S9(0004) COMP.
  5123     05  DRAHRFDF PIC  X(0001).
  5124     05  FILLER REDEFINES DRAHRFDF.
  5125         10  DRAHRFDA PIC  X(0001).
  5126     05  DRAHRFDI PIC  S9(9)V99.
  5127*    -------------------------------
  5128     05  DEISSL PIC S9(0004) COMP.
  5129     05  DEISSF PIC  X(0001).
  5130     05  FILLER REDEFINES DEISSF.
  5131         10  DEISSA PIC  X(0001).
  5132     05  DEISSI PIC  X(0005).
  5133*    -------------------------------
  5134     05  DELFPRML PIC S9(0004) COMP.
  5135     05  DELFPRMF PIC  X(0001).
  5136     05  FILLER REDEFINES DELFPRMF.
  5137         10  DELFPRMA PIC  X(0001).
  5138     05  DELFPRMI PIC  X(0011).
  5139*    -------------------------------
  5140     05  DEAHPRML PIC S9(0004) COMP.
  5141     05  DEAHPRMF PIC  X(0001).
  5142     05  FILLER REDEFINES DEAHPRMF.
  5143         10  DEAHPRMA PIC  X(0001).
  5144     05  DEAHPRMI PIC  X(0011).
  5145*    -------------------------------
  5146     05  DECANCL PIC S9(0004) COMP.
  5147     05  DECANCF PIC  X(0001).
  5148     05  FILLER REDEFINES DECANCF.
  5149         10  DECANCA PIC  X(0001).
  5150     05  DECANCI PIC  X(0005).
  5151*    -------------------------------
  5152     05  DELFRFDL PIC S9(0004) COMP.
  5153     05  DELFRFDF PIC  X(0001).
  5154     05  FILLER REDEFINES DELFRFDF.
  5155         10  DELFRFDA PIC  X(0001).
  5156     05  DELFRFDI PIC  X(0011).
  5157*    -------------------------------
  5158     05  DEAHRFDL PIC S9(0004) COMP.
  5159     05  DEAHRFDF PIC  X(0001).
  5160     05  FILLER REDEFINES DEAHRFDF.
  5161         10  DEAHRFDA PIC  X(0001).
  5162     05  DEAHRFDI PIC  X(0011).
  5163*    -------------------------------
  5164     05  DCISSL PIC S9(0004) COMP.
  5165     05  DCISSF PIC  X(0001).
  5166     05  FILLER REDEFINES DCISSF.
  5167         10  DCISSA PIC  X(0001).
  5168     05  DCISSI PIC  X(0005).
  5169*    -------------------------------
  5170     05  DCLFPRML PIC S9(0004) COMP.
  5171     05  DCLFPRMF PIC  X(0001).
  5172     05  FILLER REDEFINES DCLFPRMF.
  5173         10  DCLFPRMA PIC  X(0001).
  5174     05  DCLFPRMI PIC  X(0011).
  5175*    -------------------------------
  5176     05  DCAHPRML PIC S9(0004) COMP.
  5177     05  DCAHPRMF PIC  X(0001).
  5178     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  97
* EL6311.cbl
  5179         10  DCAHPRMA PIC  X(0001).
  5180     05  DCAHPRMI PIC  X(0011).
  5181*    -------------------------------
  5182     05  DCCANCL PIC S9(0004) COMP.
  5183     05  DCCANCF PIC  X(0001).
  5184     05  FILLER REDEFINES DCCANCF.
  5185         10  DCCANCA PIC  X(0001).
  5186     05  DCCANCI PIC  X(0005).
  5187*    -------------------------------
  5188     05  DCLFRFDL PIC S9(0004) COMP.
  5189     05  DCLFRFDF PIC  X(0001).
  5190     05  FILLER REDEFINES DCLFRFDF.
  5191         10  DCLFRFDA PIC  X(0001).
  5192     05  DCLFRFDI PIC  X(0011).
  5193*    -------------------------------
  5194     05  DCAHRFDL PIC S9(0004) COMP.
  5195     05  DCAHRFDF PIC  X(0001).
  5196     05  FILLER REDEFINES DCAHRFDF.
  5197         10  DCAHRFDA PIC  X(0001).
  5198     05  DCAHRFDI PIC  X(0011).
  5199*    -------------------------------
  5200     05  DOISSL PIC S9(0004) COMP.
  5201     05  DOISSF PIC  X(0001).
  5202     05  FILLER REDEFINES DOISSF.
  5203         10  DOISSA PIC  X(0001).
  5204     05  DOISSI PIC  X(0005).
  5205*    -------------------------------
  5206     05  DOLFPRML PIC S9(0004) COMP.
  5207     05  DOLFPRMF PIC  X(0001).
  5208     05  FILLER REDEFINES DOLFPRMF.
  5209         10  DOLFPRMA PIC  X(0001).
  5210     05  DOLFPRMI PIC  X(0011).
  5211*    -------------------------------
  5212     05  DOAHPRML PIC S9(0004) COMP.
  5213     05  DOAHPRMF PIC  X(0001).
  5214     05  FILLER REDEFINES DOAHPRMF.
  5215         10  DOAHPRMA PIC  X(0001).
  5216     05  DOAHPRMI PIC  X(0011).
  5217*    -------------------------------
  5218     05  DOCANCL PIC S9(0004) COMP.
  5219     05  DOCANCF PIC  X(0001).
  5220     05  FILLER REDEFINES DOCANCF.
  5221         10  DOCANCA PIC  X(0001).
  5222     05  DOCANCI PIC  X(0005).
  5223*    -------------------------------
  5224     05  DOLFRFDL PIC S9(0004) COMP.
  5225     05  DOLFRFDF PIC  X(0001).
  5226     05  FILLER REDEFINES DOLFRFDF.
  5227         10  DOLFRFDA PIC  X(0001).
  5228     05  DOLFRFDI PIC  X(0011).
  5229*    -------------------------------
  5230     05  DOAHRFDL PIC S9(0004) COMP.
  5231     05  DOAHRFDF PIC  X(0001).
  5232     05  FILLER REDEFINES DOAHRFDF.
  5233         10  DOAHRFDA PIC  X(0001).
  5234     05  DOAHRFDI PIC  X(0011).
  5235*    -------------------------------
  5236     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  98
* EL6311.cbl
  5237     05  DITOTALF PIC  X(0001).
  5238     05  FILLER REDEFINES DITOTALF.
  5239         10  DITOTALA PIC  X(0001).
  5240     05  DITOTALI PIC  X(0005).
  5241*    -------------------------------
  5242     05  DIFATALL PIC S9(0004) COMP.
  5243     05  DIFATALF PIC  X(0001).
  5244     05  FILLER REDEFINES DIFATALF.
  5245         10  DIFATALA PIC  X(0001).
  5246     05  DIFATALI PIC  X(0005).
  5247*    -------------------------------
  5248     05  DIFORCEL PIC S9(0004) COMP.
  5249     05  DIFORCEF PIC  X(0001).
  5250     05  FILLER REDEFINES DIFORCEF.
  5251         10  DIFORCEA PIC  X(0001).
  5252     05  DIFORCEI PIC  X(0005).
  5253*    -------------------------------
  5254     05  DIHOLDL PIC S9(0004) COMP.
  5255     05  DIHOLDF PIC  X(0001).
  5256     05  FILLER REDEFINES DIHOLDF.
  5257         10  DIHOLDA PIC  X(0001).
  5258     05  DIHOLDI PIC  X(0005).
  5259*    -------------------------------
  5260     05  DIAVAILL PIC S9(0004) COMP.
  5261     05  DIAVAILF PIC  X(0001).
  5262     05  FILLER REDEFINES DIAVAILF.
  5263         10  DIAVAILA PIC  X(0001).
  5264     05  DIAVAILI PIC  X(0005).
  5265*    -------------------------------
  5266     05  DIGPREML PIC S9(0004) COMP.
  5267     05  DIGPREMF PIC  X(0001).
  5268     05  FILLER REDEFINES DIGPREMF.
  5269         10  DIGPREMA PIC  X(0001).
  5270     05  DIGPREMI PIC  X(0011).
  5271*    -------------------------------
  5272     05  DIBPREML PIC S9(0004) COMP.
  5273     05  DIBPREMF PIC  X(0001).
  5274     05  FILLER REDEFINES DIBPREMF.
  5275         10  DIBPREMA PIC  X(0001).
  5276     05  DIBPREMI PIC  X(0011).
  5277*    -------------------------------
  5278     05  DCTOTALL PIC S9(0004) COMP.
  5279     05  DCTOTALF PIC  X(0001).
  5280     05  FILLER REDEFINES DCTOTALF.
  5281         10  DCTOTALA PIC  X(0001).
  5282     05  DCTOTALI PIC  X(0005).
  5283*    -------------------------------
  5284     05  DCFATALL PIC S9(0004) COMP.
  5285     05  DCFATALF PIC  X(0001).
  5286     05  FILLER REDEFINES DCFATALF.
  5287         10  DCFATALA PIC  X(0001).
  5288     05  DCFATALI PIC  X(0005).
  5289*    -------------------------------
  5290     05  DCFORCEL PIC S9(0004) COMP.
  5291     05  DCFORCEF PIC  X(0001).
  5292     05  FILLER REDEFINES DCFORCEF.
  5293         10  DCFORCEA PIC  X(0001).
  5294     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  99
* EL6311.cbl
  5295*    -------------------------------
  5296     05  DCHOLDL PIC S9(0004) COMP.
  5297     05  DCHOLDF PIC  X(0001).
  5298     05  FILLER REDEFINES DCHOLDF.
  5299         10  DCHOLDA PIC  X(0001).
  5300     05  DCHOLDI PIC  X(0005).
  5301*    -------------------------------
  5302     05  DCAVAILL PIC S9(0004) COMP.
  5303     05  DCAVAILF PIC  X(0001).
  5304     05  FILLER REDEFINES DCAVAILF.
  5305         10  DCAVAILA PIC  X(0001).
  5306     05  DCAVAILI PIC  X(0005).
  5307*    -------------------------------
  5308     05  DCGPREML PIC S9(0004) COMP.
  5309     05  DCGPREMF PIC  X(0001).
  5310     05  FILLER REDEFINES DCGPREMF.
  5311         10  DCGPREMA PIC  X(0001).
  5312     05  DCGPREMI PIC  X(0011).
  5313*    -------------------------------
  5314     05  DCBPREML PIC S9(0004) COMP.
  5315     05  DCBPREMF PIC  X(0001).
  5316     05  FILLER REDEFINES DCBPREMF.
  5317         10  DCBPREMA PIC  X(0001).
  5318     05  DCBPREMI PIC  X(0011).
  5319*    -------------------------------
  5320     05  DNTOTALL PIC S9(0004) COMP.
  5321     05  DNTOTALF PIC  X(0001).
  5322     05  FILLER REDEFINES DNTOTALF.
  5323         10  DNTOTALA PIC  X(0001).
  5324     05  DNTOTALI PIC  X(0005).
  5325*    -------------------------------
  5326     05  DNFATALL PIC S9(0004) COMP.
  5327     05  DNFATALF PIC  X(0001).
  5328     05  FILLER REDEFINES DNFATALF.
  5329         10  DNFATALA PIC  X(0001).
  5330     05  DNFATALI PIC  X(0005).
  5331*    -------------------------------
  5332     05  DNFORCEL PIC S9(0004) COMP.
  5333     05  DNFORCEF PIC  X(0001).
  5334     05  FILLER REDEFINES DNFORCEF.
  5335         10  DNFORCEA PIC  X(0001).
  5336     05  DNFORCEI PIC  X(0005).
  5337*    -------------------------------
  5338     05  DNHOLDL PIC S9(0004) COMP.
  5339     05  DNHOLDF PIC  X(0001).
  5340     05  FILLER REDEFINES DNHOLDF.
  5341         10  DNHOLDA PIC  X(0001).
  5342     05  DNHOLDI PIC  X(0005).
  5343*    -------------------------------
  5344     05  DNAVAILL PIC S9(0004) COMP.
  5345     05  DNAVAILF PIC  X(0001).
  5346     05  FILLER REDEFINES DNAVAILF.
  5347         10  DNAVAILA PIC  X(0001).
  5348     05  DNAVAILI PIC  X(0005).
  5349*    -------------------------------
  5350     05  DNGPREML PIC S9(0004) COMP.
  5351     05  DNGPREMF PIC  X(0001).
  5352     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 100
* EL6311.cbl
  5353         10  DNGPREMA PIC  X(0001).
  5354     05  DNGPREMI PIC  X(0011).
  5355*    -------------------------------
  5356     05  DNBPREML PIC S9(0004) COMP.
  5357     05  DNBPREMF PIC  X(0001).
  5358     05  FILLER REDEFINES DNBPREMF.
  5359         10  DNBPREMA PIC  X(0001).
  5360     05  DNBPREMI PIC  X(0011).
  5361*    -------------------------------
  5362     05  DERMSGL PIC S9(0004) COMP.
  5363     05  DERMSGF PIC  X(0001).
  5364     05  FILLER REDEFINES DERMSGF.
  5365         10  DERMSGA PIC  X(0001).
  5366     05  DERMSGI PIC  X(0075).
  5367*    -------------------------------
  5368     05  DPFENTRL PIC S9(0004) COMP.
  5369     05  DPFENTRF PIC  X(0001).
  5370     05  FILLER REDEFINES DPFENTRF.
  5371         10  DPFENTRA PIC  X(0001).
  5372     05  DPFENTRI PIC  9(2).
  5373 01  EL631DO REDEFINES EL631BI.
  5374     05  FILLER            PIC  X(0012).
  5375*    -------------------------------
  5376     05  FILLER            PIC  X(0003).
  5377     05  DDATEO PIC  X(0008).
  5378*    -------------------------------
  5379     05  FILLER            PIC  X(0003).
  5380     05  DTIMEO PIC  99.99.
  5381*    -------------------------------
  5382     05  FILLER            PIC  X(0003).
  5383     05  DHEADO PIC  X(0038).
  5384*    -------------------------------
  5385     05  FILLER            PIC  X(0003).
  5386     05  DLDATEO PIC  X(0010).
  5387*    -------------------------------
  5388     05  FILLER            PIC  X(0003).
  5389     05  DBATCHO PIC  X(0011).
  5390*    -------------------------------
  5391     05  FILLER            PIC  X(0003).
  5392     05  DACCTNMO PIC  X(0030).
  5393*    -------------------------------
  5394     05  FILLER            PIC  X(0003).
  5395     05  DPROCDTO PIC  X(0008).
  5396*    -------------------------------
  5397     05  FILLER            PIC  X(0003).
  5398     05  DINPUTO PIC  X(0008).
  5399*    -------------------------------
  5400     05  FILLER            PIC  X(0003).
  5401     05  DMAINDTO PIC  X(0008).
  5402*    -------------------------------
  5403     05  FILLER            PIC  X(0003).
  5404     05  DCARRO PIC  X(0001).
  5405*    -------------------------------
  5406     05  FILLER            PIC  X(0003).
  5407     05  DGROUPO PIC  X(0006).
  5408*    -------------------------------
  5409     05  FILLER            PIC  X(0003).
  5410     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 101
* EL6311.cbl
  5411*    -------------------------------
  5412     05  FILLER            PIC  X(0003).
  5413     05  DACCTO PIC  X(0010).
  5414*    -------------------------------
  5415     05  FILLER            PIC  X(0003).
  5416     05  DRECVDTO PIC  X(0008).
  5417*    -------------------------------
  5418     05  FILLER            PIC  X(0003).
  5419     05  DCSRO PIC  X(0004).
  5420*    -------------------------------
  5421     05  FILLER            PIC  X(0003).
  5422     05  DREFHDGO PIC  X(0010).
  5423*    -------------------------------
  5424     05  FILLER            PIC  X(0003).
  5425     05  DREFO PIC  X(0012).
  5426*    -------------------------------
  5427     05  FILLER            PIC  X(0003).
  5428     05  DLFPHDGO PIC  X(0010).
  5429*    -------------------------------
  5430     05  FILLER            PIC  X(0003).
  5431     05  DAHPHDGO PIC  X(0010).
  5432*    -------------------------------
  5433     05  FILLER            PIC  X(0003).
  5434     05  DLFRHDGO PIC  X(0009).
  5435*    -------------------------------
  5436     05  FILLER            PIC  X(0003).
  5437     05  DAHRHDGO PIC  X(0009).
  5438*    -------------------------------
  5439     05  FILLER            PIC  X(0003).
  5440     05  DRISSO PIC  ZZ99-.
  5441*    -------------------------------
  5442     05  FILLER            PIC  X(0003).
  5443     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5444*    -------------------------------
  5445     05  FILLER            PIC  X(0003).
  5446     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5447*    -------------------------------
  5448     05  FILLER            PIC  X(0003).
  5449     05  DRCANCO PIC  ZZ99-.
  5450*    -------------------------------
  5451     05  FILLER            PIC  X(0003).
  5452     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5453*    -------------------------------
  5454     05  FILLER            PIC  X(0003).
  5455     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5456*    -------------------------------
  5457     05  FILLER            PIC  X(0003).
  5458     05  DEISSO PIC  ZZ99-.
  5459*    -------------------------------
  5460     05  FILLER            PIC  X(0003).
  5461     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5462*    -------------------------------
  5463     05  FILLER            PIC  X(0003).
  5464     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5465*    -------------------------------
  5466     05  FILLER            PIC  X(0003).
  5467     05  DECANCO PIC  ZZ99-.
  5468*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 102
* EL6311.cbl
  5469     05  FILLER            PIC  X(0003).
  5470     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5471*    -------------------------------
  5472     05  FILLER            PIC  X(0003).
  5473     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5474*    -------------------------------
  5475     05  FILLER            PIC  X(0003).
  5476     05  DCISSO PIC  ZZ99-.
  5477*    -------------------------------
  5478     05  FILLER            PIC  X(0003).
  5479     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5480*    -------------------------------
  5481     05  FILLER            PIC  X(0003).
  5482     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5483*    -------------------------------
  5484     05  FILLER            PIC  X(0003).
  5485     05  DCCANCO PIC  ZZ99-.
  5486*    -------------------------------
  5487     05  FILLER            PIC  X(0003).
  5488     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5489*    -------------------------------
  5490     05  FILLER            PIC  X(0003).
  5491     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5492*    -------------------------------
  5493     05  FILLER            PIC  X(0003).
  5494     05  DOISSO PIC  ZZ99-.
  5495*    -------------------------------
  5496     05  FILLER            PIC  X(0003).
  5497     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5498*    -------------------------------
  5499     05  FILLER            PIC  X(0003).
  5500     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5501*    -------------------------------
  5502     05  FILLER            PIC  X(0003).
  5503     05  DOCANCO PIC  ZZ99-.
  5504*    -------------------------------
  5505     05  FILLER            PIC  X(0003).
  5506     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5507*    -------------------------------
  5508     05  FILLER            PIC  X(0003).
  5509     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5510*    -------------------------------
  5511     05  FILLER            PIC  X(0003).
  5512     05  DITOTALO PIC  ZZZ99.
  5513*    -------------------------------
  5514     05  FILLER            PIC  X(0003).
  5515     05  DIFATALO PIC  ZZZ99.
  5516*    -------------------------------
  5517     05  FILLER            PIC  X(0003).
  5518     05  DIFORCEO PIC  ZZZ99.
  5519*    -------------------------------
  5520     05  FILLER            PIC  X(0003).
  5521     05  DIHOLDO PIC  ZZZ99.
  5522*    -------------------------------
  5523     05  FILLER            PIC  X(0003).
  5524     05  DIAVAILO PIC  ZZZ99.
  5525*    -------------------------------
  5526     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 103
* EL6311.cbl
  5527     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5528*    -------------------------------
  5529     05  FILLER            PIC  X(0003).
  5530     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5531*    -------------------------------
  5532     05  FILLER            PIC  X(0003).
  5533     05  DCTOTALO PIC  ZZZ99.
  5534*    -------------------------------
  5535     05  FILLER            PIC  X(0003).
  5536     05  DCFATALO PIC  ZZZ99.
  5537*    -------------------------------
  5538     05  FILLER            PIC  X(0003).
  5539     05  DCFORCEO PIC  ZZZ99.
  5540*    -------------------------------
  5541     05  FILLER            PIC  X(0003).
  5542     05  DCHOLDO PIC  ZZZ99.
  5543*    -------------------------------
  5544     05  FILLER            PIC  X(0003).
  5545     05  DCAVAILO PIC  ZZZ99.
  5546*    -------------------------------
  5547     05  FILLER            PIC  X(0003).
  5548     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5549*    -------------------------------
  5550     05  FILLER            PIC  X(0003).
  5551     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5552*    -------------------------------
  5553     05  FILLER            PIC  X(0003).
  5554     05  DNTOTALO PIC  ---99.
  5555*    -------------------------------
  5556     05  FILLER            PIC  X(0003).
  5557     05  DNFATALO PIC  ---99.
  5558*    -------------------------------
  5559     05  FILLER            PIC  X(0003).
  5560     05  DNFORCEO PIC  ---99.
  5561*    -------------------------------
  5562     05  FILLER            PIC  X(0003).
  5563     05  DNHOLDO PIC  ---99.
  5564*    -------------------------------
  5565     05  FILLER            PIC  X(0003).
  5566     05  DNAVAILO PIC  ---99.
  5567*    -------------------------------
  5568     05  FILLER            PIC  X(0003).
  5569     05  DNGPREMO PIC  -------9.99.
  5570*    -------------------------------
  5571     05  FILLER            PIC  X(0003).
  5572     05  DNBPREMO PIC  -------9.99.
  5573*    -------------------------------
  5574     05  FILLER            PIC  X(0003).
  5575     05  DERMSGO PIC  X(0075).
  5576*    -------------------------------
  5577     05  FILLER            PIC  X(0003).
  5578     05  DPFENTRO PIC  X(0002).
  5579*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 104
* EL6311.cbl
  5581 01  MAP-B REDEFINES EL631BI.
  5582     12  FILLER                  PIC X(569).
  5583*    12  FILLER                  PIC X(512).
  5584*    12  FILLER                  PIC X(510).
  5585     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5586         16  BKIND-LEN               PIC S9(4)  COMP.
  5587         16  BKIND-ATTRB             PIC X.
  5588         16  BKIND                   PIC XX.
  5589         16  BTYPE-LEN               PIC S9(4)  COMP.
  5590         16  BTYPE-ATTRB             PIC X.
  5591         16  BTYPE                   PIC X(3).
  5592         16  BTERM-LEN               PIC S9(4)  COMP.
  5593         16  BTERM-ATTRB             PIC X.
  5594         16  BTERMI                  PIC 999.
  5595         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5596         16  BBEN-LEN                PIC S9(4)  COMP.
  5597         16  BBEN-ATTRB              PIC X.
  5598         16  BBENI                   PIC 9(10)V99.
  5599*        16  BBENI                   PIC 9(12).
  5600         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5601         16  BPREM-LEN               PIC S9(4)  COMP.
  5602         16  BPREM-ATTRB             PIC X.
  5603         16  BPREMI                  PIC S9(9)V99.
  5604*        16  BPREMI                  PIC 9(11).
  5605         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5606         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5607         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5608         16  BEXPIRE-ATTRB           PIC X.
  5609         16  BEXPIRE                 PIC X(8).
  5610         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5611         16  BCRIT-PERD-ATTRB        PIC X.
  5612         16  BCRIT-PERDI             PIC 99.
  5613         16  BCRIT-PERDO REDEFINES
  5614                         BCRIT-PERDI PIC ZZ.
  5615         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5616         16  BALT-BEN-ATTRB          PIC X.
  5617         16  BALT-BENI               PIC 9(10)V99.
  5618*        16  BALT-BENI               PIC 9(12).
  5619         16  BALT-BENO REDEFINES
  5620                           BALT-BENI PIC Z(9).ZZ.
  5621         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5622         16  BALT-PREM-ATTRB         PIC X.
  5623         16  BALT-PREMI              PIC 9(9)V99.
  5624*        16  BALT-PREMI              PIC 9(11).
  5625         16  BALT-PREMO REDEFINES
  5626                          BALT-PREMI PIC Z(7).ZZ-.
  5627         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5628         16  BBEN-CD-ATTRB           PIC X.
  5629         16  BBEN-CD                 PIC XXX.
  5630         16  BCPREM-LEN              PIC S9(4)  COMP.
  5631         16  BCPREM-ATTRB            PIC X.
  5632         16  BCPREMI                 PIC S9(9)V99.
  5633*        16  BCPREMI                 PIC X(11).
  5634         16  BCPREMO REDEFINES BCPREMI
  5635                                     PIC Z(7).99-.
  5636         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5637         16  BCALT-PREM-ATTRB        PIC X.
  5638         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 105
* EL6311.cbl
  5639         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5640         16  BBEN-ABBR-ATTRB         PIC X.
  5641         16  BBEN-ABBR               PIC X(5).
  5642         16  BDIFF-LEN               PIC S9(4)  COMP.
  5643         16  BDIFF-ATTRB             PIC X.
  5644         16  BDIFFO                  PIC Z(7).99-.
  5645         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5646         16  BBILL-LIT-ATTRB         PIC X.
  5647         16  BBILL-LIT               PIC X(8).
  5648         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5649         16  BDALT-PREM-ATTRB        PIC X.
  5650         16  BDALT-PREM              PIC Z(7).99-.
  5651
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 106
* EL6311.cbl
  5653
  5654****************************************************************
  5655*
  5656* Copyright (c) 2007 by Clerity Solutions, Inc.
  5657* All rights reserved.
  5658*
  5659****************************************************************
  5660 01  DFHEIV.
  5661   02  DFHEIV0               PIC X(35).
  5662   02  DFHEIV1               PIC X(08).
  5663   02  DFHEIV2               PIC X(08).
  5664   02  DFHEIV3               PIC X(08).
  5665   02  DFHEIV4               PIC X(06).
  5666   02  DFHEIV5               PIC X(04).
  5667   02  DFHEIV6               PIC X(04).
  5668   02  DFHEIV7               PIC X(02).
  5669   02  DFHEIV8               PIC X(02).
  5670   02  DFHEIV9               PIC X(01).
  5671   02  DFHEIV10              PIC S9(7) COMP-3.
  5672   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5673   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5674   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5675   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5676   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5677   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5678   02  DFHEIV17              PIC X(04).
  5679   02  DFHEIV18              PIC X(04).
  5680   02  DFHEIV19              PIC X(04).
  5681   02  DFHEIV20              USAGE IS POINTER.
  5682   02  DFHEIV21              USAGE IS POINTER.
  5683   02  DFHEIV22              USAGE IS POINTER.
  5684   02  DFHEIV23              USAGE IS POINTER.
  5685   02  DFHEIV24              USAGE IS POINTER.
  5686   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5687   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5688   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5689   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5690   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5691   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5692   02  FILLER                PIC X(02).
  5693   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5694   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5695   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5696   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5697   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5698 LINKAGE  SECTION.
  5699*****************************************************************
  5700*                                                               *
  5701* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5702* All rights reserved.                                          *
  5703*                                                               *
  5704*****************************************************************
  5705 01  dfheiblk.
  5706     02  eibtime          pic s9(7) comp-3.
  5707     02  eibdate          pic s9(7) comp-3.
  5708     02  eibtrnid         pic x(4).
  5709     02  eibtaskn         pic s9(7) comp-3.
  5710     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 107
* EL6311.cbl
  5711     02  dfheigdi         pic s9(4) comp.
  5712     02  eibcposn         pic s9(4) comp.
  5713     02  eibcalen         pic s9(4) comp.
  5714     02  eibaid           pic x(1).
  5715     02  eibfiller1       pic x(1).
  5716     02  eibfn            pic x(2).
  5717     02  eibfiller2       pic x(2).
  5718     02  eibrcode         pic x(6).
  5719     02  eibfiller3       pic x(2).
  5720     02  eibds            pic x(8).
  5721     02  eibreqid         pic x(8).
  5722     02  eibrsrce         pic x(8).
  5723     02  eibsync          pic x(1).
  5724     02  eibfree          pic x(1).
  5725     02  eibrecv          pic x(1).
  5726     02  eibsend          pic x(1).
  5727     02  eibatt           pic x(1).
  5728     02  eibeoc           pic x(1).
  5729     02  eibfmh           pic x(1).
  5730     02  eibcompl         pic x(1).
  5731     02  eibsig           pic x(1).
  5732     02  eibconf          pic x(1).
  5733     02  eiberr           pic x(1).
  5734     02  eibrldbk         pic x(1).
  5735     02  eiberrcd         pic x(4).
  5736     02  eibsynrb         pic x(1).
  5737     02  eibnodat         pic x(1).
  5738     02  eibfiller5       pic x(2).
  5739     02  eibresp          pic 9(09) comp.
  5740     02  eibresp2         pic 9(09) comp.
  5741     02  dfheigdj         pic s9(4) comp.
  5742     02  dfheigdk         pic s9(4) comp.
  5743 01  DFHCOMMAREA                 PIC X(1300).
  5744
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 108
* EL6311.cbl
  5746*    COPY ERCPNDB.
  5747******************************************************************
  5748*                                                                *
  5749*                                                                *
  5750*                            ERCPNDB.                            *
  5751*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5752*                            VMOD=2.025                          *
  5753*                                                                *
  5754*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5755*                                                                *
  5756******************************************************************
  5757*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5758*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5759******************************************************************
  5760*                                                                *
  5761*                                                                *
  5762*   FILE TYPE = VSAM,KSDS                                        *
  5763*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5764*                                                                *
  5765*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5766*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5767*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5768*                                                 RKP=13,LEN=36  *
  5769*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5770*                                      AND CHG-SEQ.)             *
  5771*                                                RKP=49,LEN=11   *
  5772*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5773*                                      AND CHG-SEQ.)             *
  5774*                                                RKP=60,LEN=15   *
  5775*                                                                *
  5776*   LOG = NO                                                     *
  5777*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5778******************************************************************
  5779******************************************************************
  5780*                   C H A N G E   L O G
  5781*
  5782* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5783*-----------------------------------------------------------------
  5784*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5785* EFFECTIVE    NUMBER
  5786*-----------------------------------------------------------------
  5787* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5788* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5789* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5790* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5791* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5792* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5793* 032306                   PEMA  ADD BOW LOAN NUMBER
  5794* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5795* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5796* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5797* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5798* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5799* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5800* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5801* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5802******************************************************************
  5803
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 109
* EL6311.cbl
  5804 01  PENDING-BUSINESS.
  5805     12  PB-RECORD-ID                     PIC XX.
  5806         88  VALID-PB-ID                        VALUE 'PB'.
  5807
  5808     12  PB-CONTROL-PRIMARY.
  5809         16  PB-COMPANY-CD                PIC X.
  5810         16  PB-ENTRY-BATCH               PIC X(6).
  5811         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5812         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5813
  5814     12  PB-CONTROL-BY-ACCOUNT.
  5815         16  PB-COMPANY-CD-A1             PIC X.
  5816         16  PB-CARRIER                   PIC X.
  5817         16  PB-GROUPING.
  5818             20  PB-GROUPING-PREFIX       PIC XXX.
  5819             20  PB-GROUPING-PRIME        PIC XXX.
  5820         16  PB-STATE                     PIC XX.
  5821         16  PB-ACCOUNT.
  5822             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5823             20  PB-ACCOUNT-PRIME         PIC X(6).
  5824         16  PB-CERT-EFF-DT               PIC XX.
  5825         16  PB-CERT-NO.
  5826             20  PB-CERT-PRIME            PIC X(10).
  5827             20  PB-CERT-SFX              PIC X.
  5828         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5829
  5830         16  PB-RECORD-TYPE               PIC X.
  5831             88  PB-MAILING-DATA                VALUE '0'.
  5832             88  PB-ISSUE                       VALUE '1'.
  5833             88  PB-CANCELLATION                VALUE '2'.
  5834             88  PB-BATCH-TRAILER               VALUE '9'.
  5835
  5836     12  PB-CONTROL-BY-ORIG-BATCH.
  5837         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5838         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5839         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5840         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5841
  5842     12  PB-CONTROL-BY-CSR.
  5843         16  PB-CSR-COMPANY-CD            PIC X.
  5844         16  PB-CSR-ID                    PIC X(4).
  5845         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5846         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5847         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5848******************************************************************
  5849*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5850******************************************************************
  5851
  5852     12  PB-LAST-MAINT-DT                 PIC XX.
  5853     12  PB-LAST-MAINT-BY                 PIC X(4).
  5854     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5855
  5856     12  PB-RECORD-BODY                   PIC X(375).
  5857
  5858     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5859         16  PB-CERT-ORIGIN               PIC X.
  5860             88  CLASIC-CREATED-CERT         VALUE '1'.
  5861         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 110
* EL6311.cbl
  5862             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5863             20  PB-I-INSURED-FIRST-NAME.
  5864                 24  PB-I-INSURED-1ST-INIT PIC X.
  5865                 24  FILLER                PIC X(9).
  5866             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5867         16  PB-I-AGE                     PIC S99   COMP-3.
  5868         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5869         16  PB-I-BIRTHDAY                PIC XX.
  5870         16  PB-I-INSURED-SEX             PIC X.
  5871             88  PB-SEX-MALE     VALUE 'M'.
  5872             88  PB-SEX-FEMALE   VALUE 'F'.
  5873
  5874         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5875         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5876         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5877         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5878         16  PB-I-SKIP-CODE               PIC X.
  5879             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5880             88  PB-SKIP-JULY              VALUE '1'.
  5881             88  PB-SKIP-AUGUST            VALUE '2'.
  5882             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5883             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5884             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5885             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5886             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5887             88  PB-SKIP-JUNE              VALUE '8'.
  5888             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5889             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5890             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5891         16  PB-I-TERM-TYPE               PIC X.
  5892             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5893             88  PB-PAID-WEEKLY            VALUE 'W'.
  5894             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5895             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5896             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5897         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5898         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5899         16  PB-I-DATA-ENTRY-SW           PIC X.
  5900             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5901             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5902             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5903             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5904         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5905         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5906*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5907         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5908         16  FILLER                       PIC X.
  5909
  5910         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5911             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5912             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5913                                                   '90' THRU '99'.
  5914         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5915                                          PIC XX.
  5916         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5917         16  PB-I-AMOUNT-FINANCED REDEFINES
  5918                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5919         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 111
* EL6311.cbl
  5920         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5921                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5922         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5923         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5924         16  PB-I-CLP-AMOUNT REDEFINES
  5925                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5926         16  PB-I-LF-CALC-FLAG            PIC X.
  5927             88 PB-COMP-LF-PREM               VALUE '?'.
  5928         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5929         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5930         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5931         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5932         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5933         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5934         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5935         16  PB-I-LF-ABBR                 PIC XXX.
  5936         16  PB-I-LF-INPUT-CD             PIC XX.
  5937
  5938         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5939             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5940             88  PB-INVALID-AH               VALUE '  ' '00'
  5941                                                   '90' THRU '99'.
  5942         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5943         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5944         16  PB-I-AH-CALC-FLAG            PIC X.
  5945             88 PB-COMP-AH-PREM                  VALUE '?'.
  5946         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5947         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5948         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5949         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5950         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5951         16  PB-I-AH-ABBR                 PIC XXX.
  5952         16  PB-I-AH-INPUT-CD             PIC XXX.
  5953
  5954         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5955         16  PB-I-REIN-TABLE              PIC XXX.
  5956         16  PB-I-BUSINESS-TYPE           PIC 99.
  5957         16  PB-I-INDV-GRP-CD             PIC X.
  5958         16  PB-I-MORT-CODE.
  5959             20  PB-I-TABLE               PIC X.
  5960             20  PB-I-INTEREST            PIC XX.
  5961             20  PB-I-MORT-TYP            PIC X.
  5962         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5963         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5964         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5965         16  PB-I-INDV-GRP-OVRD           PIC X.
  5966         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5967         16  PB-I-SIG-SW                  PIC X.
  5968             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5969         16  PB-I-RATE-CLASS              PIC XX.
  5970         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5971         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5972         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5973         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5974         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5975         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5976         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5977         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 112
* EL6311.cbl
  5978         16  PB-I-OB-FLAG                 PIC X.
  5979             88  PB-I-OB                      VALUE 'B'.
  5980             88  PB-I-SUMMARY                 VALUE 'Z'.
  5981         16  PB-I-ENTRY-STATUS            PIC X.
  5982             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5983                                              'M' '5' '9' '2'.
  5984             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5985             88  PB-I-POLICY-PENDING          VALUE '2'.
  5986             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5987             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5988             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5989             88  PB-I-REIN-ONLY               VALUE '9'.
  5990             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5991             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5992             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5993             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5994         16  PB-I-INT-CODE                PIC X.
  5995             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5996             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5997         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5998         16  PB-I-SOC-SEC-NO              PIC X(11).
  5999         16  PB-I-MEMBER-NO               PIC X(12).
  6000         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6001*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6002         16  PB-I-OLD-LOF                 PIC XXX.
  6003         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6004         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6005         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6006         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6007         16  PB-I-LIFE-INDICATOR          PIC X.
  6008             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6009         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6010         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6011                                          PIC S9(5)V99    COMP-3.
  6012         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6013             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6014             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6015         16  PB-I-1ST-PMT-DT              PIC XX.
  6016         16  PB-I-JOINT-INSURED.
  6017             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6018             20 PB-I-JOINT-FIRST-NAME.
  6019                24  PB-I-JOINT-FIRST-INIT PIC X.
  6020                24  FILLER                PIC X(9).
  6021             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6022*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6023         16  PB-I-BENEFICIARY-NAME.
  6024             20  PB-I-BANK-NUMBER         PIC X(10).
  6025             20  FILLER                   PIC X(15).
  6026         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6027         16  PB-I-REFERENCE               PIC X(12).
  6028         16  FILLER REDEFINES PB-I-REFERENCE.
  6029             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6030             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6031             20  PB-I-CLP-STATE           PIC XX.
  6032         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6033             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6034             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6035             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 113
* EL6311.cbl
  6036         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6037         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6038         16  PB-I-RESIDENT-STATE          PIC XX.
  6039         16  PB-I-RATE-CODE               PIC X(4).
  6040         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6041         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6042         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6043         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6044         16  PB-I-BANK-NOCHRGB            PIC 99.
  6045         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6046         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6047
  6048     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6049         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6050             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6051         16  PB-C-CANCEL-ORIGIN           PIC X.
  6052             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6053         16  PB-C-LF-CANCEL-DT            PIC XX.
  6054         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6055         16  PB-C-LF-CALC-REQ             PIC X.
  6056             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6057         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6058         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6059         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6060             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6061         16  PB-C-AH-CANCEL-DT            PIC XX.
  6062         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6063         16  PB-C-AH-CALC-REQ             PIC X.
  6064             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6065         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6066         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6067         16  PB-C-LAST-NAME               PIC X(15).
  6068         16  PB-C-REFUND-SW               PIC X.
  6069             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6070             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6071         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6072         16  PB-C-PAYEE-CODE              PIC X(6).
  6073         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6074         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6075         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6076         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6077         16  PB-C-REFERENCE               PIC X(12).
  6078         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6079         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6080         16  PB-C-POST-CARD-IND           PIC X.
  6081         16  PB-C-CANCEL-REASON           PIC X.
  6082         16  PB-C-REF-INTERFACE-SW        PIC X.
  6083         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6084         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6085         16  FILLER                       PIC X(01).
  6086*        16  FILLER                       PIC X(18).
  6087         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6088*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6089         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6090         16  PB-CANCELED-CERT-DATA.
  6091             20  PB-CI-INSURED-NAME.
  6092                 24  PB-CI-LAST-NAME      PIC X(15).
  6093                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 114
* EL6311.cbl
  6094             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6095             20  PB-CI-INSURED-SEX        PIC X.
  6096             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6097             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6098             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6099             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6100             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6101             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6102             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6103             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6104             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6105             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6106             20  PB-CI-RATE-CLASS         PIC XX.
  6107             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6108             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6109             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6110             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6111             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6112             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6113             20  PB-CI-LF-ABBR            PIC X(3).
  6114             20  PB-CI-AH-ABBR            PIC X(3).
  6115             20  PB-CI-OB-FLAG            PIC X.
  6116                 88  PB-CI-OB                VALUE 'B'.
  6117             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6118                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6119                                           'M' '4' '5' '9' '2'.
  6120                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6121                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6122                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6123                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6124                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6125                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6126                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6127                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6128                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6129                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6130                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6131                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6132             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6133                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6134                                           'M' '4' '5' '9' '2'.
  6135                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6136                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6137                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6138                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6139                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6140                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6141                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6142                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6143                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6144                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6145                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6146                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6147             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6148             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6149             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6150             20  PB-CI-MEMBER-NO          PIC X(12).
  6151             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 115
* EL6311.cbl
  6152                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6153                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6154             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6155             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6156             20  PB-CI-COMP-EXCP-SW       PIC X.
  6157                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6158                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6159             20  PB-CI-ENTRY-STATUS       PIC X.
  6160             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6161             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6162             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6163             20  PB-CI-DEATH-DT           PIC XX.
  6164             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6165             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6166             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6167             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6168             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6169             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6170             20  PB-CI-ENTRY-DT              PIC XX.
  6171             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6172             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6173             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6174             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6175             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6176             20  PB-CI-OLD-LOF               PIC XXX.
  6177*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6178             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6179             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6180             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6181             20  PB-CI-INDV-GRP-CD           PIC X.
  6182             20  PB-CI-BENEFICIARY-NAME.
  6183                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6184                 24  FILLER                  PIC X(15).
  6185             20  PB-CI-NOTE-SW               PIC X.
  6186             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6187             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6188             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6189             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6190             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6191             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6192             20  PB-CI-FIRST-NAME            PIC X(10).
  6193             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6194
  6195         16  FILLER                       PIC X(13).
  6196*032306  16  FILLER                       PIC X(27).
  6197*        16  FILLER                       PIC X(46).
  6198
  6199     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6200         16  FILLER                       PIC X(10).
  6201         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6202         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6203         16  PB-M-INSURED-MID-INIT        PIC X.
  6204         16  PB-M-INSURED-AGE             PIC 99.
  6205         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6206         16  PB-M-INSURED-SEX             PIC X.
  6207         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6208         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6209         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 116
* EL6311.cbl
  6210         16  PB-M-INSURED-CITY-STATE.
  6211             20  PB-M-INSURED-CITY        PIC X(28).
  6212             20  PB-M-INSURED-STATE       PIC XX.
  6213         16  PB-M-INSURED-ZIP-CODE.
  6214             20  PB-M-INSURED-ZIP-PRIME.
  6215                 24  PB-M-INSURED-ZIP-1   PIC X.
  6216                     88  PB-M-CANADIAN-POST-CODE
  6217                                             VALUE 'A' THRU 'Z'.
  6218                 24  FILLER               PIC X(4).
  6219             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6220         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6221                                        PB-M-INSURED-ZIP-CODE.
  6222             20  PM-M-INS-CAN-POST1       PIC XXX.
  6223             20  PM-M-INS-CAN-POST2       PIC XXX.
  6224             20  FILLER                   PIC XXX.
  6225         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6226         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6227         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6228         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6229         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6230         16  PB-M-CRED-BENE-CITYST.
  6231             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6232             20  PB-M-CRED-BENE-STATE     PIC XX.
  6233         16  FILLER                       PIC X(92).
  6234
  6235     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6236         16  FILLER                       PIC X(10).
  6237         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6238         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6239         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6240         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6241         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6242         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6243         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6244         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6245         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6246         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6247         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6248         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6249         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6250         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6251         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6252         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6253         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6254         16  PB-ACCOUNT-NAME              PIC X(30).
  6255         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6256         16  PB-REFERENCE                 PIC X(12).
  6257         16  PB-B-RECEIVED-DT             PIC XX.
  6258         16  FILLER                       PIC X(234).
  6259
  6260     12  PB-RECORD-STATUS.
  6261         16  PB-CREDIT-SELECT-DT          PIC XX.
  6262         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6263         16  PB-BILLED-DT                 PIC XX.
  6264         16  PB-BILLING-STATUS            PIC X.
  6265             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6266             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6267             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 117
* EL6311.cbl
  6268         16  PB-RECORD-BILL               PIC X.
  6269             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6270             88  PB-RECORD-RETURNED           VALUE 'R'.
  6271             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6272             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6273             88  PB-OVERRIDE-AH               VALUE 'A'.
  6274             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6275         16  PB-BATCH-ENTRY               PIC X.
  6276             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6277             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6278             88  PB-REISSUED-CERT             VALUE 'E'.
  6279             88  PB-MONTHLY-CERT              VALUE 'M'.
  6280             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6281             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6282             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6283         16  PB-FORCE-CODE                PIC X.
  6284             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6285             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6286             88  PB-CANCEL-FORCE              VALUE '8'.
  6287             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6288             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6289             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6290             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6291             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6292             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6293             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6294         16  PB-FATAL-FLAG                PIC X.
  6295             88  PB-FATAL-ERRORS              VALUE 'X'.
  6296         16  PB-FORCE-ER-CD               PIC X.
  6297             88  PB-FORCE-ERRORS              VALUE 'F'.
  6298             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6299         16  PB-WARN-ER-CD                PIC X.
  6300             88  PB-WARNING-ERRORS            VALUE 'W'.
  6301         16  FILLER                       PIC X.
  6302         16  PB-OUT-BAL-CD                PIC X.
  6303             88  PB-OUT-OF-BAL                VALUE 'O'.
  6304         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6305         16  PB-AH-OVERRIDE-L1            PIC X.
  6306         16  PB-INPUT-DT                  PIC XX.
  6307         16  PB-INPUT-BY                  PIC X(4).
  6308         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6309         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6310         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6311         16  PB-LF-EARNING-METHOD         PIC X.
  6312         16  PB-AH-EARNING-METHOD         PIC X.
  6313         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6314         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6315         16  PB-REIN-CD                   PIC XXX.
  6316         16  PB-LF-REFUND-TYPE            PIC X.
  6317         16  PB-AH-REFUND-TYPE            PIC X.
  6318         16  PB-ACCT-EFF-DT               PIC XX.
  6319         16  PB-ACCT-EXP-DT               PIC XX.
  6320         16  PB-COMPANY-ID                PIC X(3).
  6321         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6322         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6323         16  PB-SV-CARRIER                PIC X.
  6324         16  PB-SV-GROUPING               PIC X(6).
  6325         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 118
* EL6311.cbl
  6326         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6327         16  PB-GA-BILLING-INFO.
  6328             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6329                                          PIC XX.
  6330         16  PB-SV-REMIT-TO  REDEFINES
  6331             PB-GA-BILLING-INFO           PIC X(10).
  6332         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6333         16  PB-I-LOAN-OFFICER            PIC X(5).
  6334         16  PB-I-VIN                     PIC X(17).
  6335
  6336         16  FILLER                       PIC X(04).
  6337         16  IMNET-BYPASS-SW              PIC X.
  6338
  6339******************************************************************
  6340*                COMMON EDIT ERRORS                              *
  6341******************************************************************
  6342
  6343     12  PB-COMMON-ERRORS.
  6344         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6345                                           PIC S9(4)     COMP.
  6346
  6347******************************************************************
  6348
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 119
* EL6311.cbl
  6350*    COPY ELCCERT.
  6351******************************************************************
  6352*                                                                *
  6353*                            ELCCERT.                            *
  6354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6355*                            VMOD=2.013                          *
  6356*                                                                *
  6357*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6358*                                                                *
  6359*   FILE TYPE = VSAM,KSDS                                        *
  6360*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6361*                                                                *
  6362*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6363*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6364*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6365*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6366*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6367*                                                                *
  6368*   LOG = YES                                                    *
  6369*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6370******************************************************************
  6371*                   C H A N G E   L O G
  6372*
  6373* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6374*-----------------------------------------------------------------
  6375*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6376* EFFECTIVE    NUMBER
  6377*-----------------------------------------------------------------
  6378* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6379* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6380* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6381* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6382* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6383* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6384* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6385* 032612  CR2011110200001  PEMA  AHL CHANGES
  6386******************************************************************
  6387
  6388 01  CERTIFICATE-MASTER.
  6389     12  CM-RECORD-ID                      PIC XX.
  6390         88  VALID-CM-ID                      VALUE 'CM'.
  6391
  6392     12  CM-CONTROL-PRIMARY.
  6393         16  CM-COMPANY-CD                 PIC X.
  6394         16  CM-CARRIER                    PIC X.
  6395         16  CM-GROUPING.
  6396             20  CM-GROUPING-PREFIX        PIC X(3).
  6397             20  CM-GROUPING-PRIME         PIC X(3).
  6398         16  CM-STATE                      PIC XX.
  6399         16  CM-ACCOUNT.
  6400             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6401             20  CM-ACCOUNT-PRIME          PIC X(6).
  6402         16  CM-CERT-EFF-DT                PIC XX.
  6403         16  CM-CERT-NO.
  6404             20  CM-CERT-PRIME             PIC X(10).
  6405             20  CM-CERT-SFX               PIC X.
  6406
  6407     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 120
* EL6311.cbl
  6408         16  CM-COMPANY-CD-A1              PIC X.
  6409         16  CM-INSURED-LAST-NAME          PIC X(15).
  6410         16  CM-INSURED-INITIALS.
  6411             20  CM-INSURED-INITIAL1       PIC X.
  6412             20  CM-INSURED-INITIAL2       PIC X.
  6413
  6414     12  CM-CONTROL-BY-SSN.
  6415         16  CM-COMPANY-CD-A2              PIC X.
  6416         16  CM-SOC-SEC-NO.
  6417             20  CM-SSN-STATE              PIC XX.
  6418             20  CM-SSN-ACCOUNT            PIC X(6).
  6419             20  CM-SSN-LN3.
  6420                 25  CM-INSURED-INITIALS-A2.
  6421                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6422                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6423                 25 CM-PART-LAST-NAME-A2         PIC X.
  6424
  6425     12  CM-CONTROL-BY-CERT-NO.
  6426         16  CM-COMPANY-CD-A4              PIC X.
  6427         16  CM-CERT-NO-A4                 PIC X(11).
  6428
  6429     12  CM-CONTROL-BY-MEMB.
  6430         16  CM-COMPANY-CD-A5              PIC X.
  6431         16  CM-MEMBER-NO.
  6432             20  CM-MEMB-STATE             PIC XX.
  6433             20  CM-MEMB-ACCOUNT           PIC X(6).
  6434             20  CM-MEMB-LN4.
  6435                 25  CM-INSURED-INITIALS-A5.
  6436                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6437                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6438                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6439
  6440     12  CM-INSURED-PROFILE-DATA.
  6441         16  CM-INSURED-FIRST-NAME.
  6442             20  CM-INSURED-1ST-INIT       PIC X.
  6443             20  FILLER                    PIC X(9).
  6444         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6445         16  CM-INSURED-SEX                PIC X.
  6446             88  CM-SEX-MALE                  VALUE 'M'.
  6447             88  CM-SEX-FEMAL                 VALUE 'F'.
  6448         16  CM-INSURED-JOINT-AGE          PIC 99.
  6449         16  CM-JOINT-INSURED-NAME.
  6450             20  CM-JT-LAST-NAME           PIC X(15).
  6451             20  CM-JT-FIRST-NAME.
  6452                 24  CM-JT-1ST-INIT        PIC X.
  6453                 24  FILLER                PIC X(9).
  6454             20  CM-JT-INITIAL             PIC X.
  6455
  6456     12  CM-LIFE-DATA.
  6457         16  CM-LF-BENEFIT-CD              PIC XX.
  6458         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6459         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6460         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6461         16  CM-LF-DEV-CODE                PIC XXX.
  6462         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6463         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6464         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6465         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 121
* EL6311.cbl
  6466         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6467         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6468         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6469         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6470         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6471         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6472         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6473         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6474         16  FILLER                        PIC XX.
  6475
  6476     12  CM-AH-DATA.
  6477         16  CM-AH-BENEFIT-CD              PIC XX.
  6478         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6479         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6480         16  CM-AH-DEV-CODE                PIC XXX.
  6481         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6482         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6483         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6484         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6485         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6486         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6487         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6488         16  CM-AH-PAID-THRU-DT            PIC XX.
  6489             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6490         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6491         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6492         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6493         16  FILLER                        PIC X.
  6494
  6495     12  CM-LOAN-INFORMATION.
  6496         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6497         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6498                                           PIC S9(5)V99  COMP-3.
  6499         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6500         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6501         16  CM-PAY-FREQUENCY              PIC S99.
  6502         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6503         16  CM-RATE-CLASS                 PIC XX.
  6504         16  CM-BENEFICIARY                PIC X(25).
  6505         16  CM-POLICY-FORM-NO             PIC X(12).
  6506         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6507         16  CM-LAST-ADD-ON-DT             PIC XX.
  6508         16  CM-DEDUCTIBLE-AMOUNTS.
  6509             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6510             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6511         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6512             20  CM-RESIDENT-STATE         PIC XX.
  6513             20  CM-RATE-CODE              PIC X(4).
  6514             20  FILLER                    PIC XX.
  6515         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6516             20  CM-LOAN-OFFICER           PIC X(5).
  6517             20  FILLER                    PIC XXX.
  6518         16  CM-CSR-CODE                   PIC XXX.
  6519         16  CM-UNDERWRITING-CODE          PIC X.
  6520             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6521         16  CM-POST-CARD-IND              PIC X.
  6522         16  CM-NH-INTERFACE-SW            PIC X.
  6523         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 122
* EL6311.cbl
  6524             88  CM-SING-PRM                  VALUE '1'.
  6525             88  CM-O-B-COVERAGE              VALUE '2'.
  6526             88  CM-OPEN-END                  VALUE '3'.
  6527         16  CM-IND-GRP-TYPE               PIC X.
  6528             88  CM-INDIVIDUAL                VALUE 'I'.
  6529             88  CM-GROUP                     VALUE 'G'.
  6530         16  CM-SKIP-CODE                  PIC X.
  6531             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6532             88  SKIP-JULY                    VALUE '1'.
  6533             88  SKIP-AUGUST                  VALUE '2'.
  6534             88  SKIP-SEPTEMBER               VALUE '3'.
  6535             88  SKIP-JULY-AUG                VALUE '4'.
  6536             88  SKIP-AUG-SEPT                VALUE '5'.
  6537             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6538             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6539             88  SKIP-JUNE                    VALUE '8'.
  6540             88  SKIP-JUNE-JULY               VALUE '9'.
  6541             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6542             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6543         16  CM-PAYMENT-MODE               PIC X.
  6544             88  PAY-MONTHLY                  VALUE SPACE.
  6545             88  PAY-WEEKLY                   VALUE '1'.
  6546             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6547             88  PAY-BI-WEEKLY                VALUE '3'.
  6548             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6549         16  CM-LOAN-NUMBER                PIC X(8).
  6550         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6551         16  CM-OLD-LOF                    PIC XXX.
  6552*        16  CM-LOAN-OFFICER               PIC XXX.
  6553         16  CM-REIN-TABLE                 PIC XXX.
  6554         16  CM-SPECIAL-REIN-CODE          PIC X.
  6555         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6556         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6557         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6558
  6559     12  CM-STATUS-DATA.
  6560         16  CM-ENTRY-STATUS               PIC X.
  6561         16  CM-ENTRY-DT                   PIC XX.
  6562
  6563         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6564         16  CM-LF-CANCEL-DT               PIC XX.
  6565         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6566
  6567         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6568         16  CM-LF-DEATH-DT                PIC XX.
  6569         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6570
  6571         16  CM-LF-CURRENT-STATUS          PIC X.
  6572             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6573                                                'M' '4' '5' '9'.
  6574             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6575             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6576             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6577             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6578             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6579             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6580             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6581             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 123
* EL6311.cbl
  6582             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6583             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6584             88  CM-LF-DECLINED               VALUE 'D'.
  6585             88  CM-LF-VOIDED                 VALUE 'V'.
  6586
  6587         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6588         16  CM-AH-CANCEL-DT               PIC XX.
  6589         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6590
  6591         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6592         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6593         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6594
  6595         16  CM-AH-CURRENT-STATUS          PIC X.
  6596             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6597                                                'M' '4' '5' '9'.
  6598             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6599             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6600             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6601             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6602             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6603             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6604             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6605             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6606             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6607             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6608             88  CM-AH-DECLINED               VALUE 'D'.
  6609             88  CM-AH-VOIDED                 VALUE 'V'.
  6610
  6611         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6612             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6613             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6614             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6615         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6616
  6617         16  CM-ENTRY-BATCH                PIC X(6).
  6618         16  CM-LF-EXIT-BATCH              PIC X(6).
  6619         16  CM-AH-EXIT-BATCH              PIC X(6).
  6620         16  CM-LAST-MONTH-END             PIC XX.
  6621
  6622     12  CM-NOTE-SW                        PIC X.
  6623         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6624         88  CERT-NOTES-PRESENT               VALUE '1'.
  6625         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6626         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6627         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6628         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6629         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6630         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6631     12  CM-COMP-EXCP-SW                   PIC X.
  6632         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6633         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6634     12  CM-INSURED-ADDRESS-SW             PIC X.
  6635         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6636         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6637
  6638*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6639     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 124
* EL6311.cbl
  6640     12  FILLER                            PIC X.
  6641
  6642*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6643     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6644     12  FILLER                            PIC X.
  6645*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6646     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6647
  6648     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6649         88  CERT-ADDED-BATCH                 VALUE ' '.
  6650         88  CERT-ADDED-ONLINE                VALUE '1'.
  6651         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6652         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6653         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6654     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6655         88  CERT-AS-LOADED                   VALUE ' '.
  6656         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6657         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6658         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6659         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6660         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6661         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6662         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6663
  6664     12  CM-ACCOUNT-COMM-PCTS.
  6665         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6666         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6667
  6668     12  CM-USER-FIELD                     PIC X.
  6669     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6670     12  CM-CLP-STATE                      PIC XX.
  6671     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6672     12  CM-USER-RESERVED                  PIC XXX.
  6673     12  FILLER REDEFINES CM-USER-RESERVED.
  6674         16  CM-AH-CLASS-CD                PIC XX.
  6675         16  F                             PIC X.
  6676******************************************************************
  6677
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 125
* EL6311.cbl
  6679*    COPY ERCNOTE.
  6680******************************************************************
  6681*                                                                *
  6682*                                                                *
  6683*                            ERCNOTE                             *
  6684*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6685*                            VMOD=2.003                          *
  6686*                                                                *
  6687*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6688*                                                                *
  6689*        FILE TYPE= VSAM,KSDS                                    *
  6690*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6691*                                                                *
  6692*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6693*                                                                *
  6694*        LOG = YES                                               *
  6695*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6696*                                                                *
  6697******************************************************************
  6698*                   C H A N G E   L O G
  6699*
  6700* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6701*-----------------------------------------------------------------
  6702*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6703* EFFECTIVE    NUMBER
  6704*-----------------------------------------------------------------
  6705* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6706*                                FILE WILL CONTAIN BILLING NOTES O
  6707******************************************************************
  6708
  6709 01  CERTIFICATE-NOTE.
  6710     12  CN-RECORD-ID                PIC  XX.
  6711         88  VALID-CN-ID                  VALUE 'CN'.
  6712
  6713     12  CN-CONTROL-PRIMARY.
  6714         16  CN-COMPANY-CD           PIC X.
  6715         16  CN-CARRIER              PIC X.
  6716         16  CN-GROUPING.
  6717             20 CN-GROUPING-PREFIX   PIC XXX.
  6718             20 CN-GROUPING-PRIME    PIC XXX.
  6719         16  CN-STATE                PIC XX.
  6720         16  CN-ACCOUNT.
  6721             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6722             20 CN-ACCOUNT-PRIME     PIC X(6).
  6723         16  CN-CERT-EFF-DT          PIC XX.
  6724         16  CN-CERT-NO.
  6725             20  CN-CERT-PRIME       PIC X(10).
  6726             20  CN-CERT-SFX         PIC X.
  6727
  6728     12  CN-BILLING-START-LINE-NO    PIC 99.
  6729     12  CN-BILLING-END-LINE-NO      PIC 99.
  6730
  6731     12  CN-LINES.
  6732         16  CN-LINE OCCURS 10       PIC X(77).
  6733
  6734     12  CN-LAST-MAINT-DT            PIC XX.
  6735     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6736     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 126
* EL6311.cbl
  6737     12  FILLER                      PIC X(6).
  6738******************************************************************
  6739
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 127
* EL6311.cbl
  6741*    COPY ERCPNDM.
  6742******************************************************************
  6743*                                                                *
  6744*                                                                *
  6745*                            ERCPNDM                             *
  6746*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6747*                            VMOD=2.003                          *
  6748*                                                                *
  6749*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6750*                                                                *
  6751*   FILE TYPE = VSAM,KSDS                                        *
  6752*   RECORD SIZE = 374   RECFORM = FIX                            *
  6753*                                                                *
  6754*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6755*   ALTERNATE PATH    = NOT USED                                 *
  6756*                                                                *
  6757*   LOG = YES                                                    *
  6758*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6759******************************************************************
  6760*                   C H A N G E   L O G
  6761*
  6762* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6763*-----------------------------------------------------------------
  6764*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6765* EFFECTIVE    NUMBER
  6766*-----------------------------------------------------------------
  6767* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6768* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6769* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6770******************************************************************
  6771
  6772 01  PENDING-MAILING-DATA.
  6773     12  PM-RECORD-ID                      PIC XX.
  6774         88  VALID-MA-ID                       VALUE 'PM'.
  6775
  6776     12  PM-CONTROL-PRIMARY.
  6777         16  PM-COMPANY-CD                 PIC X.
  6778         16  PM-ENTRY-BATCH                PIC X(6).
  6779         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6780         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6781
  6782     12  FILLER                            PIC X(14).
  6783
  6784     12  PM-ACCESS-CONTROL.
  6785         16  PM-SOURCE-SYSTEM              PIC XX.
  6786             88  PM-FROM-CREDIT                VALUE 'CR'.
  6787             88  PM-FROM-VSI                   VALUE 'VS'.
  6788             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6789             88  PM-FROM-OTHER                 VALUE 'OT'.
  6790         16  PM-RECORD-ADD-DT              PIC XX.
  6791         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6792         16  PM-LAST-MAINT-DT              PIC XX.
  6793         16  PM-LAST-MAINT-BY              PIC XXXX.
  6794         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6795
  6796     12  PM-PROFILE-INFO.
  6797         16  PM-QUALIFY-CODE-1             PIC XX.
  6798         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 128
* EL6311.cbl
  6799         16  PM-QUALIFY-CODE-3             PIC XX.
  6800         16  PM-QUALIFY-CODE-4             PIC XX.
  6801         16  PM-QUALIFY-CODE-5             PIC XX.
  6802
  6803         16  PM-INSURED-LAST-NAME          PIC X(15).
  6804         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6805         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6806         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6807         16  PM-INSURED-BIRTH-DT           PIC XX.
  6808         16  PM-INSURED-SEX                PIC X.
  6809             88  PM-SEX-MALE                   VALUE 'M'.
  6810             88  PM-SEX-FEMALE                 VALUE 'F'.
  6811         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6812
  6813         16  PM-ADDRESS-CORRECTED          PIC X.
  6814         16  PM-JOINT-BIRTH-DT             PIC XX.
  6815*        16  FILLER                        PIC X(12).
  6816
  6817         16  PM-ADDRESS-LINE-1             PIC X(30).
  6818         16  PM-ADDRESS-LINE-2             PIC X(30).
  6819         16  PM-CITY-STATE.
  6820             20  PM-CITY                   PIC X(28).
  6821             20  PM-STATE                  PIC XX.
  6822         16  PM-ZIP.
  6823             20  PM-ZIP-CODE.
  6824                 24  PM-ZIP-1              PIC X.
  6825                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6826                 24  FILLER                PIC X(4).
  6827             20  PM-ZIP-PLUS4              PIC X(4).
  6828         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6829             20  PM-CAN-POST1              PIC XXX.
  6830             20  PM-CAN-POST2              PIC XXX.
  6831             20  FILLER                    PIC XXX.
  6832
  6833         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6834
  6835         16  FILLER                        PIC X(03).
  6836
  6837     12  PM-CRED-BENE-INFO.
  6838         16  PM-CRED-BENE-NAME             PIC X(25).
  6839         16  PM-CRED-BENE-ADDR             PIC X(30).
  6840         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6841         16  PM-CRED-BENE-CTYST.
  6842             20  PM-CRED-BENE-CITY         PIC X(28).
  6843             20  PM-CRED-BENE-STATE        PIC XX.
  6844         16  PM-CRED-BENE-ZIP.
  6845             20  PM-CB-ZIP-CODE.
  6846                 24  PM-CB-ZIP-1           PIC X.
  6847                     88  PM-CB-CANADIAN-POST-CODE
  6848                                  VALUE 'A' THRU 'Z'.
  6849                 24  FILLER                PIC X(4).
  6850             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6851         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6852             20  PM-CB-CAN-POST1           PIC XXX.
  6853             20  PM-CB-CAN-POST2           PIC XXX.
  6854             20  FILLER                    PIC XXX.
  6855     12  PM-POST-CARD-MAIL-DATA.
  6856         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 129
* EL6311.cbl
  6857             20  PM-MAIL-TYPE              PIC X.
  6858                 88  PM-12MO-MAILING           VALUE '1'.
  6859                 88  PM-EXP-MAILING            VALUE '2'.
  6860             20  PM-MAIL-STATUS            PIC X.
  6861                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6862                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6863                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6864             20  PM-MAIL-DATE              PIC XX.
  6865     12  FILLER                            PIC XX.
  6866     12  FILLER                            PIC X(12).
  6867*    12  FILLER                            PIC X(30).
  6868
  6869******************************************************************
  6870
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 130
* EL6311.cbl
  6872*    COPY ERCMAIL.
  6873******************************************************************
  6874*                                                                *
  6875*                                                                *
  6876*                            ERCMAIL                             *
  6877*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6878*                            VMOD=2.003                          *
  6879*                                                                *
  6880*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6881*                                                                *
  6882*   FILE TYPE = VSAM,KSDS                                        *
  6883*   RECORD SIZE = 374   RECFORM = FIX                            *
  6884*                                                                *
  6885*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6886*   ALTERNATE PATH    = NOT USED                                 *
  6887*                                                                *
  6888*   LOG = YES                                                    *
  6889*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6890******************************************************************
  6891*                   C H A N G E   L O G
  6892*
  6893* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6894*-----------------------------------------------------------------
  6895*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6896* EFFECTIVE    NUMBER
  6897*-----------------------------------------------------------------
  6898* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6899* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6900* 111108                   PEMA  ADD CRED BENE ADDR2
  6901******************************************************************
  6902
  6903 01  MAILING-DATA.
  6904     12  MA-RECORD-ID                      PIC XX.
  6905         88  VALID-MA-ID                       VALUE 'MA'.
  6906
  6907     12  MA-CONTROL-PRIMARY.
  6908         16  MA-COMPANY-CD                 PIC X.
  6909         16  MA-CARRIER                    PIC X.
  6910         16  MA-GROUPING.
  6911             20  MA-GROUPING-PREFIX        PIC XXX.
  6912             20  MA-GROUPING-PRIME         PIC XXX.
  6913         16  MA-STATE                      PIC XX.
  6914         16  MA-ACCOUNT.
  6915             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6916             20  MA-ACCOUNT-PRIME          PIC X(6).
  6917         16  MA-CERT-EFF-DT                PIC XX.
  6918         16  MA-CERT-NO.
  6919             20  MA-CERT-PRIME             PIC X(10).
  6920             20  MA-CERT-SFX               PIC X.
  6921
  6922     12  FILLER                            PIC XX.
  6923
  6924     12  MA-ACCESS-CONTROL.
  6925         16  MA-SOURCE-SYSTEM              PIC XX.
  6926             88  MA-FROM-CREDIT                VALUE 'CR'.
  6927             88  MA-FROM-VSI                   VALUE 'VS'.
  6928             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6929             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 131
* EL6311.cbl
  6930         16  MA-RECORD-ADD-DT              PIC XX.
  6931         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6932         16  MA-LAST-MAINT-DT              PIC XX.
  6933         16  MA-LAST-MAINT-BY              PIC XXXX.
  6934         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6935
  6936     12  MA-PROFILE-INFO.
  6937         16  MA-QUALIFY-CODE-1             PIC XX.
  6938         16  MA-QUALIFY-CODE-2             PIC XX.
  6939         16  MA-QUALIFY-CODE-3             PIC XX.
  6940         16  MA-QUALIFY-CODE-4             PIC XX.
  6941         16  MA-QUALIFY-CODE-5             PIC XX.
  6942
  6943         16  MA-INSURED-LAST-NAME          PIC X(15).
  6944         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6945         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6946         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6947         16  MA-INSURED-BIRTH-DT           PIC XX.
  6948         16  MA-INSURED-SEX                PIC X.
  6949             88  MA-SEX-MALE                   VALUE 'M'.
  6950             88  MA-SEX-FEMALE                 VALUE 'F'.
  6951         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6952
  6953         16  MA-ADDRESS-CORRECTED          PIC X.
  6954         16  MA-JOINT-BIRTH-DT             PIC XX.
  6955*        16  FILLER                        PIC X(12).
  6956
  6957         16  MA-ADDRESS-LINE-1             PIC X(30).
  6958         16  MA-ADDRESS-LINE-2             PIC X(30).
  6959         16  MA-CITY-STATE.
  6960             20  MA-CITY                   PIC X(28).
  6961             20  MA-ADDR-STATE             PIC XX.
  6962         16  MA-ZIP.
  6963             20  MA-ZIP-CODE.
  6964                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6965                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6966                 24  FILLER                PIC X(4).
  6967             20  MA-ZIP-PLUS4              PIC X(4).
  6968         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6969             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6970             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6971             20  FILLER                    PIC X(3).
  6972
  6973         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6974
  6975         16  FILLER                        PIC XXX.
  6976*        16  FILLER                        PIC X(10).
  6977
  6978     12  MA-CRED-BENE-INFO.
  6979         16  MA-CRED-BENE-NAME                 PIC X(25).
  6980         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6981         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6982         16  MA-CRED-BENE-CTYST.
  6983             20  MA-CRED-BENE-CITY             PIC X(28).
  6984             20  MA-CRED-BENE-STATE            PIC XX.
  6985         16  MA-CRED-BENE-ZIP.
  6986             20  MA-CB-ZIP-CODE.
  6987                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 132
* EL6311.cbl
  6988                     88  MA-CB-CANADIAN-POST-CODE
  6989                                           VALUE 'A' THRU 'Z'.
  6990                 24  FILLER                    PIC X(4).
  6991             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6992         16  MA-CB-CANADIAN-POSTAL-CODE
  6993                            REDEFINES MA-CRED-BENE-ZIP.
  6994             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6995             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6996             20  FILLER                        PIC X(3).
  6997     12  MA-POST-CARD-MAIL-DATA.
  6998         16  MA-MAIL-DATA OCCURS 7.
  6999             20  MA-MAIL-TYPE              PIC X.
  7000                 88  MA-12MO-MAILING           VALUE '1'.
  7001                 88  MA-EXP-MAILING            VALUE '2'.
  7002             20  MA-MAIL-STATUS            PIC X.
  7003                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7004                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7005                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7006             20  MA-MAIL-DATE              PIC XX.
  7007     12  FILLER                            PIC XX.
  7008     12  FILLER                            PIC XX.
  7009*    12  FILLER                            PIC X(30).
  7010******************************************************************
  7011
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 133
* EL6311.cbl
  7013*    COPY ERCRQST.
  7014******************************************************************
  7015*                                                                *
  7016*                                                                *
  7017*                            ERCRQST.                            *
  7018*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7019*                            VMOD=2.002                          *
  7020*                                                                *
  7021*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7022*                                                                *
  7023*   FILE TYPE = VSAM,KSDS                                        *
  7024*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7025*                                                                *
  7026*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7027*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7028*                                   ACCOUNT, REF, BATCH)         *
  7029*                                                RKP=9, LEN=38   *
  7030*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7031*                                   ACCOUNT, REF, BATCH)         *
  7032*                                                RKP=47, LEN=46  *
  7033*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7034*                                   BATCH)                       *
  7035*                                                RKP=93, LEN=24  *
  7036*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7037*                                   REF, BATCH)                  *
  7038*                                                RKP=117, LEN=35 *
  7039*   LOG = NO                                                     *
  7040*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7041******************************************************************
  7042
  7043 01  AR-REQUEST-RECORD.
  7044     12  RQ-RECORD-ID                     PIC XX.
  7045         88  VALID-RQ-ID                        VALUE 'RQ'.
  7046
  7047     12  RQ-CONTROL-PRIMARY.
  7048         16  RQ-COMPANY-CD                PIC X.
  7049         16  RQ-ENTRY-BATCH               PIC X(6).
  7050
  7051     12  RQ-CONTROL-BY-ACCT-REF.
  7052         16  RQ-COMPANY-CD-A1             PIC X.
  7053         16  RQ-CARRIER-A1                PIC X.
  7054         16  RQ-GROUPING-A1               PIC X(6).
  7055         16  RQ-STATE-A1                  PIC XX.
  7056         16  RQ-ACCOUNT-A1                PIC X(10).
  7057         16  RQ-REFERENCE-A1              PIC X(12).
  7058         16  RQ-BATCH-A1                  PIC X(6).
  7059
  7060     12  RQ-CONTROL-BY-FIN-RESP.
  7061         16  RQ-COMPANY-CD-A2             PIC X.
  7062         16  RQ-CARRIER-A2                PIC X.
  7063         16  RQ-GROUPING-A2               PIC X(6).
  7064         16  RQ-FIN-RESP-A2               PIC X(10).
  7065         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7066         16  RQ-REFERENCE-A2              PIC X(12).
  7067         16  RQ-BATCH-A2                  PIC X(6).
  7068
  7069     12  RQ-CONTROL-BY-ACCT-AGENT.
  7070         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 134
* EL6311.cbl
  7071         16  RQ-CARRIER-A3                PIC X.
  7072         16  RQ-GROUPING-A3               PIC X(6).
  7073         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7074         16  RQ-BATCH-A3                  PIC X(6).
  7075
  7076     12  RQ-CONTROL-BY-SUMMARY.
  7077         16  RQ-COMPANY-CD-A4             PIC X.
  7078         16  RQ-SUMMARY-CODE              PIC X(6).
  7079         16  RQ-ACCOUNT-A4                PIC X(10).
  7080         16  RQ-REFERENCE-A4              PIC X(12).
  7081         16  RQ-BATCH-A4                  PIC X(6).
  7082
  7083     12  RQ-REQUEST-METHOD                PIC X.
  7084         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7085         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7086         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7087         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7088     12  FILLER                           PIC X.
  7089     12  RQ-STATUS                        PIC X.
  7090         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7091         88  RQ-RESUBMIT                      VALUE 'R'.
  7092     12  RQ-PROCESSOR-ID                  PIC X(4).
  7093     12  RQ-ENTRY-DT                      PIC XX.
  7094     12  RQ-MO-END-DT                     PIC XX.
  7095     12  RQ-REQUEST-DT                    PIC XX.
  7096     12  RQ-STMT-DT                       PIC XX.
  7097     12  RQ-REVERSAL-DT                   PIC XX.
  7098     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7099     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7100
  7101     12  FILLER                           PIC X(27).
  7102
  7103******************************************************************
  7104
  7105
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 135
* EL6311.cbl
  7107*    COPY ERCLOFC.
  7108******************************************************************
  7109*                                                                *
  7110*                                                                *
  7111*                            ERCLOFC                             *
  7112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7113*                            VMOD=2.003                          *
  7114*                                                                *
  7115*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7116*                                                                *
  7117*   FILE TYPE = VSAM,KSDS                                        *
  7118*   RECORD SIZE = 670   RECFORM = FIX                            *
  7119*                                                                *
  7120*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7121*                                                                *
  7122*   LOG = YES                                                    *
  7123*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7124*                                                                *
  7125******************************************************************
  7126
  7127 01  LOAN-OFFICER-MASTER.
  7128     12  LO-RECORD-ID                PIC XX.
  7129         88  VALID-LO-ID                VALUE 'LO'.
  7130
  7131     12  LO-CONTROL-PRIMARY.
  7132         16  LO-COMPANY-CD           PIC X.
  7133         16  LO-CARRIER              PIC X.
  7134         16  LO-GROUPING.
  7135             20  LO-GROUPING-PREFIX  PIC XXX.
  7136             20  LO-GROUPING-PRIME   PIC XXX.
  7137         16  LO-STATE                PIC XX.
  7138         16  LO-ACCOUNT.
  7139             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7140             20  LO-ACCOUNT-PRIME    PIC X(6).
  7141         16  LO-OFFICER-CODE         PIC X(5).
  7142
  7143     12  LO-OFFICER-NAME             PIC X(30).
  7144
  7145     12  LO-LAST-MAINT-DT            PIC XX.
  7146     12  LO-LAST-USER                PIC X(4).
  7147     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7148
  7149     12  LO-COMP-CONTROL             PIC X.
  7150             88  LO-SHOW-COMP           VALUE 'Y'.
  7151             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7152     12  LO-DETAIL-CONTROL           PIC X.
  7153             88  LO-PRINT-DETAIL        VALUE 'D'.
  7154             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7155
  7156     12  LO-SV-CARRIER               PIC X.
  7157     12  LO-SV-GROUPING              PIC X(6).
  7158     12  LO-SV-STATE                 PIC XX.
  7159
  7160     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7161     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7162
  7163     12  LO-OFFICER-INFO.
  7164         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 136
* EL6311.cbl
  7165             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7166             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7167             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7168             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7169             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7170             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7171             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7172             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7173     12  FILLER                      PIC X(198).
  7174******************************************************************
  7175
  7176*    COPY ERCPYAJ.
  7177******************************************************************
  7178*                                                                *
  7179*                            ERCPYAJ                             *
  7180*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7181*                            VMOD=2.015                          *
  7182*                                                                *
  7183*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7184*                                                                *
  7185*                                                                *
  7186*   FILE TYPE = VSAM,KSDS                                        *
  7187*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7188*                                                                *
  7189*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7190*       ALTERNATE PATHS = NONE                                   *
  7191*                                                                *
  7192*   LOG = YES                                                    *
  7193*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7194******************************************************************
  7195******************************************************************
  7196*                   C H A N G E   L O G
  7197*
  7198* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7199*-----------------------------------------------------------------
  7200*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7201* EFFECTIVE    NUMBER
  7202*-----------------------------------------------------------------
  7203* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7204* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7205******************************************************************
  7206
  7207 01  PENDING-PAY-ADJ.
  7208     12  PY-RECORD-ID                     PIC XX.
  7209         88  VALID-PY-ID                        VALUE 'PY'.
  7210
  7211     12  PY-CONTROL-PRIMARY.
  7212         16  PY-COMPANY-CD                PIC X.
  7213         16  PY-CARRIER                   PIC X.
  7214         16  PY-GROUPING                  PIC X(6).
  7215         16  PY-FIN-RESP                  PIC X(10).
  7216         16  PY-ACCOUNT                   PIC X(10).
  7217         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7218                                          PIC X(10).
  7219         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7220         16  PY-RECORD-TYPE               PIC X.
  7221             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7222             88  PY-DEPOSIT                   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 137
* EL6311.cbl
  7223             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7224             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7225             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7226             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7227             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7228             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7229             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7230             88  PY-FICA-ENTRY                VALUE 'F'.
  7231             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7232             88  PY-POLICY-FEE                VALUE 'W'.
  7233             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7234
  7235     12  PY-PYMT-TYPE                     PIC X.
  7236             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7237             88  PY-REINS-PYMT                VALUE 'R'.
  7238             88  PY-EXP-PYMT                  VALUE 'E'.
  7239
  7240     12  PY-BIL-INV                       PIC X(6).
  7241     12  PY-REF-NO                        PIC X(12).
  7242
  7243     12  PY-LAST-MAINT-DT                 PIC XX.
  7244     12  PY-LAST-MAINT-BY                 PIC X(4).
  7245     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7246
  7247     12  PY-PYADJ-RECORD.
  7248         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7249         16  PY-ENTRY-COMMENT             PIC X(30).
  7250         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7251             20  PY-GL-ACCOUNT            PIC X(10).
  7252             20  PY-GL-STATE              PIC X(02).
  7253             20  PY-GL-CANC-SW            PIC X(01).
  7254                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7255                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7256             20  PY-GL-COMMENT            PIC X(10).
  7257             20  FILLER      REDEFINES PY-GL-COMMENT.
  7258                 24  PY-GL-CHECK-NO       PIC 9(06).
  7259                 24  FILLER               PIC X(04).
  7260             20  FILLER                   PIC X(07).
  7261         16  PY-SAVE-ACCOUNT              PIC X(10).
  7262         16  PY-SAVE-TYPE                 PIC X(01).
  7263
  7264         16  PY-LETTERS.
  7265             20  PY-LETTER OCCURS 3 TIMES
  7266                           INDEXED BY PY-LET-NDX
  7267                                          PIC X(04).
  7268
  7269         16  PY-ERCOMP-TYPE               PIC X.
  7270             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7271             88  PY-GA-TYPE                   VALUE 'G'.
  7272             88  PY-BANK-TYPE                 VALUE 'B'.
  7273         16  FILLER                       PIC X(05).
  7274
  7275     12  PY-RECORD-STATUS.
  7276         16  PY-CREDIT-SELECT-DT          PIC XX.
  7277         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7278         16  PY-BILLED-DATE               PIC XX.
  7279         16  PY-REPORTED-DT               PIC XX.
  7280         16  PY-PMT-APPLIED               PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 138
* EL6311.cbl
  7281             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7282             88  PY-GA-PMT                    VALUE 'G'.
  7283             88  PY-OVWRITE-PMT               VALUE 'O'.
  7284             88  PY-NON-AR-PMT                VALUE 'N'.
  7285         16  FILLER                       PIC X(5).
  7286         16  PY-INPUT-DT                  PIC XX.
  7287         16  PY-CHECK-NUMBER              PIC X(6).
  7288         16  PY-VOID-SW                   PIC X.
  7289             88  PY-CHECK-VOIDED              VALUE 'V'.
  7290         16  PY-CHECK-ORIGIN-SW           PIC X.
  7291             88  PY-BILLING-CHECK             VALUE 'B'.
  7292             88  PY-REFUND-CHECK              VALUE 'R'.
  7293             88  PY-GA-CHECK                  VALUE 'G'.
  7294             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7295             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7296         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7297         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7298         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7299         16  PY-BILL-FLAG                 PIC X.
  7300             88  PY-BILLED                    VALUE 'B'.
  7301         16  PY-AR-FLAG                   PIC X.
  7302             88  PY-AR-CYCLE                  VALUE 'C'.
  7303             88  PY-AR-MONTH-END              VALUE 'M'.
  7304         16  PY-AR-DATE                   PIC XX.
  7305
  7306     12  PY-GL-CODES.
  7307         16  PY-GL-DB                     PIC X(14).
  7308         16  PY-GL-CR                     PIC X(14).
  7309         16  PY-GL-FLAG                   PIC X.
  7310         16  PY-GL-DATE                   PIC XX.
  7311
  7312     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7313     12  FILLER                           PIC X(3).
  7314******************************************************************
  7315
  7316*    COPY ERCCNOT.
  7317******************************************************************
  7318*                                                                *
  7319*                            ERCCNOT                             *
  7320*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7321*                            VMOD=2.003                          *
  7322*                                                                *
  7323*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7324*                                                                *
  7325*        FILE TYPE= VSAM,KSDS                                    *
  7326*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7327*                                                                *
  7328*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7329*                                                                *
  7330*        LOG = YES                                               *
  7331*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7332*                                                                *
  7333******************************************************************
  7334*                   C H A N G E   L O G
  7335*
  7336* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7337*-----------------------------------------------------------------
  7338*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 139
* EL6311.cbl
  7339* EFFECTIVE    NUMBER
  7340*-----------------------------------------------------------------
  7341* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7342******************************************************************
  7343
  7344 01  CERT-NOTE-FILE.
  7345     12  CZ-RECORD-ID                PIC  XX.
  7346         88  VALID-CZ-ID                  VALUE 'CZ'.
  7347
  7348     12  CZ-CONTROL-PRIMARY.
  7349         16  CZ-COMPANY-CD           PIC X.
  7350         16  CZ-CARRIER              PIC X.
  7351         16  CZ-GROUPING.
  7352             20 CZ-GROUPING-PREFIX   PIC XXX.
  7353             20 CZ-GROUPING-PRIME    PIC XXX.
  7354         16  CZ-STATE                PIC XX.
  7355         16  CZ-ACCOUNT.
  7356             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7357             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7358         16  CZ-CERT-EFF-DT          PIC XX.
  7359         16  CZ-CERT-NO.
  7360             20  CZ-CERT-PRIME       PIC X(10).
  7361             20  CZ-CERT-SFX         PIC X.
  7362         16  CZ-RECORD-TYPE          PIC X.
  7363             88  CERT-NOTE           VALUE '1'.
  7364             88  CLAIM-CERT-NOTE     VALUE '2'.
  7365         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7366
  7367     12  CZ-LAST-MAINT-DT            PIC XX.
  7368     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7369     12  CZ-LAST-MAINT-USER          PIC X(4).
  7370
  7371     12  CZ-NOTE-INFORMATION.
  7372         16  CZ-NOTE                 PIC X(63).
  7373         16  FILLER                  PIC X(39).
  7374******************************************************************
  7375
  7376*    COPY ELCMSTR.
  7377******************************************************************
  7378*                                                                *
  7379*                            ELCMSTR.                            *
  7380*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7381*                            VMOD=2.012                          *
  7382*                                                                *
  7383*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7384*                                                                *
  7385*   FILE TYPE = VSAM,KSDS                                        *
  7386*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7387*                                                                *
  7388*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7389*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7390*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7391*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7392*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7393*                                                 RKP=75,LEN=21  *
  7394*                                                                *
  7395*   **** NOTE ****                                               *
  7396*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 140
* EL6311.cbl
  7397*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7398*                                                                *
  7399*   LOG = YES                                                    *
  7400*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7401******************************************************************
  7402*                   C H A N G E   L O G
  7403*
  7404* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7405*-----------------------------------------------------------------
  7406*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7407* EFFECTIVE    NUMBER
  7408*-----------------------------------------------------------------
  7409* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7410* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7411* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7412******************************************************************
  7413 01  CLAIM-MASTER.
  7414     12  CL-RECORD-ID                PIC XX.
  7415         88  VALID-CL-ID         VALUE 'CL'.
  7416
  7417     12  CL-CONTROL-PRIMARY.
  7418         16  CL-COMPANY-CD           PIC X.
  7419         16  CL-CARRIER              PIC X.
  7420         16  CL-CLAIM-NO             PIC X(7).
  7421         16  CL-CERT-NO.
  7422             20  CL-CERT-PRIME       PIC X(10).
  7423             20  CL-CERT-SFX         PIC X.
  7424
  7425     12  CL-CONTROL-BY-NAME.
  7426         16  CL-COMPANY-CD-A1        PIC X.
  7427         16  CL-INSURED-LAST-NAME    PIC X(15).
  7428         16  CL-INSURED-NAME.
  7429             20  CL-INSURED-1ST-NAME PIC X(12).
  7430             20  CL-INSURED-MID-INIT PIC X.
  7431
  7432     12  CL-CONTROL-BY-SSN.
  7433         16  CL-COMPANY-CD-A2        PIC X.
  7434         16  CL-SOC-SEC-NO.
  7435             20  CL-SSN-STATE        PIC XX.
  7436             20  CL-SSN-ACCOUNT      PIC X(6).
  7437             20  CL-SSN-LN3          PIC X(3).
  7438
  7439     12  CL-CONTROL-BY-CERT-NO.
  7440         16  CL-COMPANY-CD-A4        PIC X.
  7441         16  CL-CERT-NO-A4.
  7442             20  CL-CERT-A4-PRIME    PIC X(10).
  7443             20  CL-CERT-A4-SFX      PIC X.
  7444
  7445     12  CL-CONTROL-BY-CCN.
  7446         16  CL-COMPANY-CD-A5        PIC X.
  7447         16  CL-CCN-A5.
  7448             20  CL-CCN.
  7449                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7450                 24  CL-CCN-PRIME-A5 PIC X(12).
  7451             20  CL-CCN-FILLER-A5    PIC X(4).
  7452
  7453     12  CL-INSURED-PROFILE-DATA.
  7454         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 141
* EL6311.cbl
  7455         16  CL-INSURED-SEX-CD       PIC X.
  7456             88  INSURED-IS-MALE        VALUE 'M'.
  7457             88  INSURED-IS-FEMALE      VALUE 'F'.
  7458             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7459         16  CL-INSURED-OCC-CD       PIC X(6).
  7460         16  FILLER                  PIC X(5).
  7461
  7462     12  CL-PROCESSING-INFO.
  7463         16  CL-PROCESSOR-ID         PIC X(4).
  7464         16  CL-CLAIM-STATUS         PIC X.
  7465             88  CLAIM-IS-OPEN          VALUE 'O'.
  7466             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7467         16  CL-CLAIM-TYPE           PIC X.
  7468*            88  AH-CLAIM               VALUE 'A'.
  7469*            88  LIFE-CLAIM             VALUE 'L'.
  7470*            88  PROPERTY-CLAIM         VALUE 'P'.
  7471*            88  IUI-CLAIM              VALUE 'I'.
  7472*            88  GAP-CLAIM              VALUE 'G'.
  7473         16  CL-CLAIM-PREM-TYPE      PIC X.
  7474             88  SINGLE-PREMIUM         VALUE '1'.
  7475             88  O-B-COVERAGE           VALUE '2'.
  7476             88  OPEN-END-COVERAGE      VALUE '3'.
  7477         16  CL-INCURRED-DT          PIC XX.
  7478         16  CL-REPORTED-DT          PIC XX.
  7479         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7480         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7481         16  CL-LAST-PMT-DT          PIC XX.
  7482         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7483         16  CL-PAID-THRU-DT         PIC XX.
  7484         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7485         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7486         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7487         16  CL-PMT-CALC-METHOD      PIC X.
  7488             88  CL-360-DAY-YR          VALUE '1'.
  7489             88  CL-365-DAY-YR          VALUE '2'.
  7490             88  CL-FULL-MONTHS         VALUE '3'.
  7491         16  CL-CAUSE-CD             PIC X(6).
  7492
  7493         16  CL-PRIME-CERT-NO.
  7494             20  CL-PRIME-CERT-PRIME PIC X(10).
  7495             20  CL-PRIME-CERT-SFX   PIC X.
  7496
  7497         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7498             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7499             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7500
  7501         16  CL-MICROFILM-NO         PIC X(10).
  7502         16  CL-PROG-FORM-TYPE       PIC X.
  7503         16  CL-LAST-ADD-ON-DT       PIC XX.
  7504
  7505         16  CL-LAST-REOPEN-DT       PIC XX.
  7506         16  CL-LAST-CLOSE-DT        PIC XX.
  7507         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7508             88  FINAL-PAID             VALUE '1'.
  7509             88  CLAIM-DENIED           VALUE '2'.
  7510             88  AUTO-CLOSE             VALUE '3'.
  7511             88  MANUAL-CLOSE           VALUE '4'.
  7512             88  BENEFITS-CHANGED       VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 142
* EL6311.cbl
  7513             88  SETUP-ERRORS           VALUE 'E'.
  7514         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7515         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7516         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7517             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7518         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7519         16  FILLER                  PIC X.
  7520
  7521     12  CL-CERTIFICATE-DATA.
  7522         16  CL-CERT-ORIGIN          PIC X.
  7523             88  CERT-WAS-ONLINE        VALUE '1'.
  7524             88  CERT-WAS-CREATED       VALUE '2'.
  7525             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7526         16  CL-CERT-KEY-DATA.
  7527             20  CL-CERT-CARRIER     PIC X.
  7528             20  CL-CERT-GROUPING    PIC X(6).
  7529             20  CL-CERT-STATE       PIC XX.
  7530             20  CL-CERT-ACCOUNT.
  7531                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7532                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7533             20  CL-CERT-EFF-DT      PIC XX.
  7534
  7535     12  CL-STATUS-CONTROLS.
  7536         16  CL-PRIORITY-CD          PIC X.
  7537             88  CONFIDENTIAL-DATA      VALUE '8'.
  7538             88  HIGHEST-PRIORITY       VALUE '9'.
  7539         16  CL-SUPV-ATTN-CD         PIC X.
  7540             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7541             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7542         16  CL-PURGED-DT            PIC XX.
  7543         16  CL-RESTORED-DT          PIC XX.
  7544         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7545         16  CL-NEXT-RESEND-DT       PIC XX.
  7546         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7547         16  CL-CRITICAL-PERIOD      PIC 99.
  7548*        16  FILLER                  PIC XX.
  7549         16  CL-LAST-MAINT-DT        PIC XX.
  7550         16  CL-LAST-MAINT-USER      PIC X(4).
  7551         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7552         16  CL-LAST-MAINT-TYPE      PIC X.
  7553             88  CLAIM-SET-UP           VALUE ' '.
  7554             88  PAYMENT-MADE           VALUE '1'.
  7555             88  LETTER-SENT            VALUE '2'.
  7556             88  MASTER-WAS-ALTERED     VALUE '3'.
  7557             88  MASTER-WAS-RESTORED    VALUE '4'.
  7558             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7559             88  FILE-CONVERTED         VALUE '6'.
  7560             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7561             88  ERROR-CORRECTION       VALUE 'E'.
  7562         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7563         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7564         16  CL-BENEFICIARY          PIC X(10).
  7565         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7566         16  CL-DENIAL-TYPE          PIC X.
  7567             88  CL-TYPE-DENIAL          VALUE '1'.
  7568             88  CL-TYPE-RESCISSION      VALUE '2'.
  7569             88  CL-TYPE-REFORMATION     VALUE '3'.
  7570             88  CL-TYPE-REF-TO-RES      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 143
* EL6311.cbl
  7571             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7572         16  CL-CRIT-PER-RECURRENT   PIC X.
  7573         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7574         16  CL-RTW-DT               PIC XX.
  7575
  7576     12  CL-TRAILER-CONTROLS.
  7577         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7578             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7579             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7580             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7581         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7582         16  FILLER                  PIC XX.
  7583         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7584         16  CL-ADDRESS-TRAILER-CNT.
  7585             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7586                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7587             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7588                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7589             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7590                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7591             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7592                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7593             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7594                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7595             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7596                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7597             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7598                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7599
  7600     12  CL-CV-REFERENCE-NO.
  7601         16  CL-CV-REFNO-PRIME       PIC X(18).
  7602         16  CL-CV-REFNO-SFX         PIC XX.
  7603
  7604     12  CL-FILE-LOCATION            PIC X(4).
  7605
  7606     12  CL-PROCESS-ERRORS.
  7607         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7608             88  NO-FATAL-ERRORS        VALUE ZERO.
  7609         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7610             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7611
  7612     12  CL-PRODUCT-CD               PIC X.
  7613
  7614     12  CL-CURRENT-KEY-DATA.
  7615         16  CL-CURRENT-CARRIER      PIC X.
  7616         16  CL-CURRENT-GROUPING     PIC X(6).
  7617         16  CL-CURRENT-STATE        PIC XX.
  7618         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7619
  7620     12  CL-ASSOCIATES               PIC X.
  7621         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7622         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7623         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7624         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7625
  7626     12  CL-ACTIVITY-CODE            PIC 99.
  7627     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7628     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 144
* EL6311.cbl
  7629
  7630     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7631     12  CL-LAG-REPORT-CODE          PIC 9.
  7632     12  CL-LOAN-TYPE                PIC XX.
  7633     12  CL-LEGAL-STATE              PIC XX.
  7634
  7635     12  CL-YESNOSW                  PIC X.
  7636     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7637         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7638         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7639         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7640     12  cl-insured-claim            pic x.
  7641         88  cl-claim-on-primary         value 'P'.
  7642         88  cl-claim-on-secondary       value 'S'.
  7643     12  cl-benefit-expiration-dt    PIC XX.
  7644
  7645*    COPY ERCENDT.
  7646******************************************************************
  7647*                                                                *
  7648*                                                                *
  7649*                            ERCENDT.                            *
  7650*                            VMOD=2.001                          *
  7651*                                                                *
  7652*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7653*                                                                *
  7654*   FILE TYPE = VSAM,KSDS                                        *
  7655*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7656*                                                                *
  7657*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7658*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7659*                                                                *
  7660*   LOG = NO                                                     *
  7661*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7662******************************************************************
  7663*-----------------------------------------------------------------
  7664*                   C H A N G E   L O G
  7665*
  7666* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7667*-----------------------------------------------------------------
  7668*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7669* EFFECTIVE    NUMBER
  7670*-----------------------------------------------------------------
  7671* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7672*                                WITH OPEN CLAIMS
  7673* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7674* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7675* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7676*-----------------------------------------------------------------
  7677 01  ENDORSEMENT-RECORD.
  7678     12  EN-RECORD-ID                PIC XX.
  7679         88  VALID-EN-ID                VALUE 'EN'.
  7680     12  EN-CONTROL-PRIMARY.
  7681         16  EN-COMPANY-CD           PIC X.
  7682         16  EN-CARRIER              PIC X.
  7683         16  EN-GROUPING             PIC X(6).
  7684         16  EN-STATE                PIC XX.
  7685         16  EN-ACCOUNT              PIC X(10).
  7686         16  EN-CERT-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 145
* EL6311.cbl
  7687         16  EN-CERT-NO.
  7688             20  EN-CERT-PRIME       PIC X(10).
  7689             20  EN-CERT-SFX         PIC X.
  7690         16  EN-REC-TYPE             PIC X.
  7691             88  EN-ISSUE               VALUE 'I'.
  7692             88  EN-CANCELLATION        VALUE 'C'.
  7693         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7694     12  EN-CONTROL-BY-ARCH-NO.
  7695         16  EN-COMPANY-CD-A1              PIC X.
  7696         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7697     12  EN-LAST-MAINT-DT            PIC XX.
  7698     12  EN-LAST-MAINT-BY            PIC X(4).
  7699     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7700     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7701     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7702         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7703         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7704         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7705         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7706         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7707         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7708         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7709         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7710         16  EN-LF-ORIG-BENCD        PIC XX.
  7711         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7712         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7713         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7714         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7715         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7716         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7717*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7718         16  EN-ORIG-CRED-BENE       PIC X(25).
  7719         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7720         16  FILLER                  PIC X.
  7721         16  EN-AH-ORIG-BENCD        PIC XX.
  7722         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7723         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7724         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7725         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7726*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7727*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7728         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7729         16  F                       PIC X(09).
  7730         16  EN-AH-ORIG-CP           PIC 99.
  7731         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7732         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7733         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7734         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7735         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7736         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7737         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7738         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7739         16  EN-LF-NEW-BENCD         PIC XX.
  7740         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7741         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7742         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7743         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7744         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 146
* EL6311.cbl
  7745         16  EN-LF-NEW-EXP-DT        PIC XX.
  7746         16  EN-NEW-CRED-BENE        PIC X(25).
  7747         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7748         16  FILLER                  PIC X.
  7749         16  EN-AH-NEW-BENCD         PIC XX.
  7750         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7751         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7752         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7753         16  EN-AH-NEW-EXP-DT        PIC XX.
  7754*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7755*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7756*        16  F                       PIC X(12).
  7757         16  EN-AH-NEW-CP            PIC 99.
  7758         16  EN-SIG-SW               PIC X.
  7759         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7760         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7761         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7762         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7763         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7764         16  FILLER                  PIC X(33).
  7765     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7766         16  EN-LF-ORIG-REF-DT       PIC XX.
  7767         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7768         16  EN-AH-ORIG-REF-DT       PIC XX.
  7769         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7770         16  EN-LF-NEW-REF-DT        PIC XX.
  7771         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7772         16  EN-AH-NEW-REF-DT        PIC XX.
  7773         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7774         16  EN-FLAG-CERT            PIC X.
  7775         16  EN-INS-LAST-NAME        PIC X(15).
  7776         16  EN-INS-FIRST-NAME       PIC X(10).
  7777         16  EN-INS-MIDDLE-INIT      PIC X.
  7778         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7779         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7780         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7781         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7782         16  FILLER                  PIC X(262).
  7783     12  EN-MONEY-SW             PIC X.
  7784     12  EN-HEALTH-APP           PIC X.
  7785     12  EN-VOUCHER-SW           PIC X.
  7786     12  EN-PAYEE                PIC X(14).
  7787     12  EN-INPUT-DT             PIC XX.
  7788     12  EN-PROCESS-DT           PIC XX.
  7789     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7790     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7791     12  EN-REASON-CODES.
  7792         16  F OCCURS 12.
  7793             20  EN-REASON-CODE  PIC X(4).
  7794     12  EN-TEMPLATE-USED        PIC X(8).
  7795     12  EN-DOCU-TYPE            PIC X.
  7796         88  EN-VERI-DOCU          VALUE 'V'.
  7797         88  EN-GCE-DOCU           VALUE 'G'.
  7798         88  EN-CANC-DOCU          VALUE 'C'.
  7799     12  EN-COMMENTS1            PIC X(13).
  7800     12  EN-COMMENTS2            PIC X(70).
  7801     12  EN-COMM-CHGBK           PIC X.
  7802         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 147
* EL6311.cbl
  7803         88  EN-CHG-ACCT           VALUE 'Y'.
  7804     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7805     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7806     12  EN-BATCH-NUMBER         PIC X(6).
  7807     12  EN-ACCT-SUMM            PIC X.
  7808     12  EN-CSO-SUMM             PIC X.
  7809     12  FILLER                  PIC X(13).
  7810******************************************************************
  7811
  7812*    COPY ELCCRTT.
  7813******************************************************************
  7814*                                                                *
  7815*                            ELCCRTT.                            *
  7816*                                                                *
  7817*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7818*                                                                *
  7819*   FILE TYPE = VSAM,KSDS                                        *
  7820*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7821*                                                                *
  7822*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7823*                                                                *
  7824*   LOG = YES                                                    *
  7825*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7826******************************************************************
  7827*                   C H A N G E   L O G
  7828*
  7829* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7830*-----------------------------------------------------------------
  7831*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7832* EFFECTIVE    NUMBER
  7833*-----------------------------------------------------------------
  7834* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7835* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7836* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7837* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7838* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7839******************************************************************
  7840
  7841 01  CERTIFICATE-TRAILERS.
  7842     12  CS-RECORD-ID                      PIC XX.
  7843         88  VALID-CS-ID                      VALUE 'CS'.
  7844
  7845     12  CS-CONTROL-PRIMARY.
  7846         16  CS-COMPANY-CD                 PIC X.
  7847         16  CS-CARRIER                    PIC X.
  7848         16  CS-GROUPING                   PIC X(6).
  7849         16  CS-STATE                      PIC XX.
  7850         16  CS-ACCOUNT                    PIC X(10).
  7851         16  CS-CERT-EFF-DT                PIC XX.
  7852         16  CS-CERT-NO.
  7853             20  CS-CERT-PRIME             PIC X(10).
  7854             20  CS-CERT-SFX               PIC X.
  7855         16  CS-TRAILER-TYPE               PIC X.
  7856             88  COMM-TRLR           VALUE 'A'.
  7857             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7858             88  CERT-DATA-TRLR      VALUE 'C'.
  7859
  7860     12  CS-DATA-AREA                      PIC X(516).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 148
* EL6311.cbl
  7861
  7862     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7863         16  CS-BANK-COMMISSION-AREA.
  7864             20  CS-BANK-COMMS       OCCURS 10.
  7865                 24  CS-AGT                PIC X(10).
  7866                 24  CS-COM-TYP            PIC X.
  7867                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7868                 24  CS-RECALC-LV-INDIC    PIC X.
  7869                 24  FILLER                PIC X(10).
  7870         16  FILLER                        PIC X(256).
  7871
  7872     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7873****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7874****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7875         16  CS-MB-CLAIM-DATA OCCURS 2.
  7876             20  FILLER OCCURS 10.
  7877                 24  CS-CLAIM-TYPE         PIC X.
  7878                     88  CS-AH-CLM           VALUE 'A'.
  7879                     88  CS-IU-CLM           VALUE 'I'.
  7880                     88  CS-GP-CLM           VALUE 'G'.
  7881                     88  CS-LF-CLM           VALUE 'L'.
  7882                     88  CS-PR-CLM           VALUE 'P'.
  7883                 24  CS-BANK               PIC S999 COMP-3.
  7884                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7885                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7886                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7887         16  FILLER                        PIC X(216).
  7888     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7889         16  CS-VIN-NUMBER                 PIC X(17).
  7890         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7891         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7892         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7893         16  FILLER                        PIC X(496).
  7894******************************************************************
  7895
  7896 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  7897                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  7898                          PENDING-MAILING-DATA MAILING-DATA
  7899                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  7900                          PENDING-PAY-ADJ CERT-NOTE-FILE
  7901                          CLAIM-MASTER ENDORSEMENT-RECORD
  7902                          CERTIFICATE-TRAILERS.
  7903 0000-DFHEXIT SECTION.
  7904     MOVE '9#                    $   ' TO DFHEIV0.
  7905     MOVE 'EL6311' TO DFHEIV1.
  7906     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7907
  7908     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7909     MOVE EIBTRMID               TO QID-TERM.
  7910     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  7911     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7912     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7913     MOVE 2                      TO EMI-SWITCH2.
  7914
  7915     IF EIBCALEN = 0
  7916         GO TO 8800-UNAUTHORIZED-ACCESS.
  7917
  7918     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 149
* EL6311.cbl
  7919     MOVE '5'                   TO DC-OPTION-CODE.
  7920     PERFORM 9700-DATE-LINK.
  7921     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  7922     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  7923
  7924     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  7925     MOVE SPACE                  TO DC-OPTION-CODE.
  7926     PERFORM 9700-DATE-LINK.
  7927     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  7928     MOVE LOW-VALUES             TO EL631BI.
  7929
  7930
  7931* EXEC CICS HANDLE CONDITION
  7932*        PGMIDERR  (9600-PGMID-ERROR)
  7933*        ERROR     (9990-ABEND)
  7934*        INVREQ    (9990-ABEND)
  7935*        QIDERR    (0010-MAIN-LOGIC)
  7936*    END-EXEC.
  7937*    MOVE '"$L.8N                ! " #00007926' TO DFHEIV0
  7938     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  7939     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7940     MOVE X'2220233030303037393236' TO DFHEIV0(25:11)
  7941     CALL 'kxdfhei1' USING DFHEIV0
  7942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7943
  7944
  7945     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7946         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7947             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7948             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7949             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7950             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7951             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7952             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7953             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7954             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7955
  7956             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  7957                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  7958
  7959             ELSE
  7960                 NEXT SENTENCE
  7961
  7962         ELSE
  7963             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  7964             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7965             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7966             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7967             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7968             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7969             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7970             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7971             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7972             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  7973             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  7974             GO TO 3900-RE-DISPLAY-RECORD
  7975     ELSE
  7976         GO TO 0020-MAIN-LOGIC.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 150
* EL6311.cbl
  7977
  7978 0010-MAIN-LOGIC.
  7979     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  7980                                    WS-FIRST-ENTRY-SW.
  7981
  7982     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  7983
  7984     MOVE LOW-VALUES             TO EC-NEW-CERT
  7985                                    EC-NEW-STATE.
  7986
  7987     IF PI-DISPLAY-ORIGINAL-BATCH
  7988         NEXT SENTENCE
  7989     ELSE
  7990         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  7991             GO TO 5000-BROWSE-BATCH-HEADERS.
  7992
  7993     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  7994         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  7995
  7996     IF PI-CSR-BROWSE
  7997        GO TO 4200-BROWSE-CSR-FORWARD.
  7998
  7999     IF PI-FILE-BROWSE
  8000         GO TO 4300-BROWSE-FILE-FORWARD.
  8001
  8002     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8003
  8004 0020-MAIN-LOGIC.
  8005     IF EIBAID = DFHCLEAR
  8006         GO TO 9400-CLEAR.
  8007
  8008     MOVE LOW-VALUES             TO EC-NEW-CERT
  8009                                    EC-NEW-STATE.
  8010
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 151
* EL6311.cbl
  8012
  8013******************************************************************
  8014*                                                                *
  8015*              R E C E I V E   M A P                             *
  8016*                                                                *
  8017******************************************************************
  8018
  8019 0200-RECEIVE.
  8020     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8021         MOVE ER-0008            TO EMI-ERROR
  8022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8023         IF PI-MAP-NAME = EL631B
  8024             MOVE -1                 TO BMAINTL
  8025             GO TO 8200-SEND-DATAONLY
  8026         ELSE
  8027             IF PI-MAP-NAME = EL631C
  8028                 MOVE -1                 TO CMAINTL
  8029                 GO TO 8200-SEND-DATAONLY
  8030             ELSE
  8031                 IF PI-MAP-NAME = EL631D
  8032                     MOVE -1                 TO DPFENTRL
  8033                     GO TO 8200-SEND-DATAONLY.
  8034
  8035
  8036* EXEC CICS RECEIVE
  8037*        MAP      (PI-MAP-NAME)
  8038*        MAPSET   (MAPSET-EL6311S)
  8039*        INTO     (EL631BI)
  8040*    END-EXEC.
  8041     MOVE LENGTH OF
  8042      EL631BI
  8043       TO DFHEIV11
  8044*    MOVE '8"T I  L              ''   #00008023' TO DFHEIV0
  8045     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8046     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8047     MOVE X'2020233030303038303233' TO DFHEIV0(25:11)
  8048     CALL 'kxdfhei1' USING DFHEIV0,
  8049           PI-MAP-NAME,
  8050           EL631BI,
  8051           DFHEIV11,
  8052           MAPSET-EL6311S,
  8053           DFHEIV99,
  8054           DFHEIV99
  8055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8056
  8057
  8058******************************************************************
  8059*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8060******************************************************************
  8061
  8062     IF BTYPE-LEN (1) EQUAL +3
  8063        IF BTYPE (1) EQUAL ALL ' '
  8064            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8065
  8066     IF BTYPE-LEN (2) EQUAL +3
  8067        IF BTYPE (2) EQUAL ALL ' '
  8068            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8069
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 152
* EL6311.cbl
  8070     INSPECT EL631BI CONVERTING '_' TO ' '.
  8071
  8072     IF PI-MAP-NAME = EL631B
  8073         IF BPFENTRL GREATER THAN ZEROS
  8074             IF EIBAID NOT = DFHENTER
  8075                 MOVE ER-0004       TO EMI-ERROR
  8076                 MOVE -1            TO BPFENTRL
  8077                 MOVE AL-UNBOF      TO BPFENTRA
  8078                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8079                 GO TO 8200-SEND-DATAONLY
  8080             ELSE
  8081                 IF BPFENTRI NUMERIC AND
  8082                   (BPFENTRI GREATER 0 AND LESS 25)
  8083                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8084                 ELSE
  8085                     MOVE ER-0029  TO EMI-ERROR
  8086                     MOVE AL-UNBON TO BPFENTRA
  8087                     MOVE -1       TO BPFENTRL
  8088                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8089                     GO TO 8200-SEND-DATAONLY
  8090         ELSE
  8091             NEXT SENTENCE
  8092     ELSE
  8093         IF PI-MAP-NAME = EL631C
  8094            IF CPFENTRL GREATER THAN ZEROS
  8095                IF EIBAID NOT = DFHENTER
  8096                 MOVE ER-0004         TO EMI-ERROR
  8097                 MOVE -1              TO CPFENTRL
  8098                 MOVE AL-UNBOF        TO CPFENTRA
  8099                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8100                 GO TO 8200-SEND-DATAONLY
  8101             ELSE
  8102                 IF CPFENTRI NUMERIC AND
  8103                   (CPFENTRI GREATER 0 AND LESS 25)
  8104                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8105                 ELSE
  8106                     MOVE ER-0029      TO EMI-ERROR
  8107                     MOVE AL-UNBON     TO CPFENTRA
  8108                     MOVE -1           TO CPFENTRL
  8109                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8110                     GO TO 8200-SEND-DATAONLY
  8111         ELSE
  8112             NEXT SENTENCE
  8113     ELSE
  8114     IF PI-MAP-NAME = EL631D
  8115         IF DPFENTRL GREATER THAN ZEROS
  8116             IF EIBAID NOT = DFHENTER
  8117                 MOVE ER-0004         TO EMI-ERROR
  8118                 MOVE -1              TO DPFENTRL
  8119                 MOVE AL-UNBOF        TO DPFENTRA
  8120                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8121                 GO TO 8200-SEND-DATAONLY
  8122             ELSE
  8123                 IF DPFENTRI NUMERIC AND
  8124                   (DPFENTRI GREATER 0 AND LESS 25)
  8125                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8126                 ELSE
  8127                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 153
* EL6311.cbl
  8128                     MOVE AL-UNBON     TO DPFENTRA
  8129                     MOVE -1           TO DPFENTRL
  8130                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8131                     GO TO 8200-SEND-DATAONLY.
  8132
  8133     IF EIBAID = DFHPF23
  8134         GO TO 8810-PF23.
  8135
  8136     IF EIBAID = DFHPF24
  8137         GO TO 9200-RETURN-MAIN-MENU.
  8138
  8139     IF EIBAID = DFHPF12
  8140         GO TO 9500-PF12.
  8141
  8142     IF PI-MAP-NAME = EL631B
  8143        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8144
  8145     IF PI-MAP-NAME = EL631C
  8146        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8147
  8148     IF PI-MAP-NAME = EL631D
  8149        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8150
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 154
* EL6311.cbl
  8152
  8153******************************************************************
  8154*                                                                *
  8155*      ISSUE SCREEN PF KEY CHECKING                              *
  8156*                                                                *
  8157******************************************************************
  8158
  8159******************************************************************
  8160*                                                                *
  8161*      PF KEY FUNCTIONS:                                         *
  8162*                                                                *
  8163*      PF1  = BROWSE FORWARD                                     *
  8164*      PF2  = BROWSE BACKWARD                                    *
  8165*      PF3  = CERTIFICATE LOOKUP                                 *
  8166*      PF4  = DISPLAY BATCH HEADER                               *
  8167*      PF5  = ADD ISSUE  SCREEN                                  *
  8168*      PF6  = ADD CANCEL SCREEN                                  *
  8169*      PF7  = CERTIFICATE DISPLAY                                *
  8170*      PF8  = CERTIFICATE NOTES                                  *
  8171*      PF9  = EDIT CONTROL                                       *
  8172*      PF10 = DISPLAY LETTER SCREEN                              *
  8173*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8174*      PF12 = HELP SCREEN                                        *
  8175*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8176*      PF14 = ACCOUNT MASTER                                     *
  8177*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8178*      PF16 = DISPLAY LETTER REVIEW                              *
  8179*                                                                *
  8180******************************************************************
  8181
  8182 0300-CHECK-ISSUE-PF-KEYS.
  8183     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8184        MOVE ER-2337            TO EMI-ERROR
  8185        MOVE -1                  TO BMAINTL
  8186        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8187        GO TO 8200-SEND-DATAONLY.
  8188
  8189     IF EIBAID = DFHPF1
  8190        MOVE '0'                TO PI-EDIT-SW
  8191        IF PI-PRIMARY-BROWSE
  8192           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8193        ELSE
  8194           IF PI-PRIMARY-WITH-SELECT
  8195              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8196           ELSE
  8197              IF PI-FILE-BROWSE
  8198                 GO TO 4300-BROWSE-FILE-FORWARD
  8199              ELSE
  8200                 IF PI-CSR-BROWSE
  8201                    GO TO 4200-BROWSE-CSR-FORWARD
  8202                 ELSE
  8203                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8204
  8205     IF EIBAID = DFHPF2
  8206        MOVE '0'                TO PI-EDIT-SW
  8207        IF PI-PRIMARY-BROWSE
  8208           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8209        ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 155
* EL6311.cbl
  8210           IF PI-PRIMARY-WITH-SELECT
  8211              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8212           ELSE
  8213              IF PI-FILE-BROWSE
  8214                 GO TO 4800-BROWSE-FILE-BACKWARD
  8215              ELSE
  8216                 IF PI-CSR-BROWSE
  8217                    GO TO 4900-BROWSE-CSR-BACKWARD
  8218                 ELSE
  8219                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8220
  8221     IF EIBAID = DFHPF3
  8222        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8223        MOVE XCTL-EL127         TO PGM-NAME
  8224        GO TO 9300-XCTL.
  8225
  8226     IF (EIBAID = DFHPF15 OR DFHPF6)
  8227        AND (CSR-EDIT-SESSION)
  8228*       AND (FATAL-OR-UNFORCED)
  8229        AND (FATAL-ERRORS)
  8230        MOVE ER-1819             TO EMI-ERROR
  8231        MOVE -1                  TO BMAINTL
  8232        MOVE AL-UANON            TO BMAINTA
  8233        PERFORM 9900-ERROR-FORMAT
  8234                                 THRU 9900-EXIT
  8235        GO TO 8200-SEND-DATAONLY
  8236     END-IF
  8237     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8238      OR (EIBAID = DFHPF10)
  8239        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8240        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8241        IF (RESP-NORMAL)
  8242           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8243              AM-CONTROL-PRIMARY (1:20))
  8244            IF AM-NAME NOT GREATER THAN SPACES OR
  8245               AM-ADDRS NOT GREATER THAN SPACES  OR
  8246               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8247               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8248               AM-ZIP NOT GREATER THAN SPACES
  8249               MOVE ER-3834             TO EMI-ERROR
  8250               MOVE -1                  TO BMAINTL
  8251               MOVE AL-UANON            TO BMAINTA
  8252               PERFORM 9900-ERROR-FORMAT
  8253                                 THRU 9900-EXIT
  8254               GO TO 8200-SEND-DATAONLY
  8255            END-IF
  8256        ELSE
  8257           MOVE ER-1609             TO EMI-ERROR
  8258           MOVE -1                  TO BMAINTL
  8259           MOVE AL-UANON            TO BMAINTA
  8260           PERFORM 9900-ERROR-FORMAT
  8261                                THRU 9900-EXIT
  8262           GO TO 8200-SEND-DATAONLY
  8263        END-IF
  8264
  8265        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8266        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8267        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 156
* EL6311.cbl
  8268            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8269               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8270               MA-CITY NOT GREATER THAN SPACES OR
  8271               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8272               MA-ZIP-CODE NOT GREATER THAN SPACES
  8273               MOVE ER-3835             TO EMI-ERROR
  8274               MOVE -1                  TO BMAINTL
  8275               MOVE AL-UANON            TO BMAINTA
  8276               PERFORM 9900-ERROR-FORMAT
  8277                                 THRU 9900-EXIT
  8278               GO TO 8200-SEND-DATAONLY
  8279            END-IF
  8280        ELSE
  8281           MOVE ER-3000             TO EMI-ERROR
  8282           MOVE -1                  TO BMAINTL
  8283           MOVE AL-UANON            TO BMAINTA
  8284           PERFORM 9900-ERROR-FORMAT
  8285                                THRU 9900-EXIT
  8286           GO TO 8200-SEND-DATAONLY
  8287        END-IF
  8288
  8289     END-IF
  8290     IF (EIBAID = DFHPF15)
  8291        AND (CSR-EDIT-SESSION)
  8292        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8293        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8294        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8295        MOVE PI-SV-STATE         TO PI-STATE
  8296        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8297        MOVE BCERTNOI            TO PI-CERT-PRIME
  8298        MOVE BSUFIXI             TO PI-CERT-SFX
  8299        MOVE BEFFDTI             TO DEEDIT-FIELD
  8300        PERFORM 8600-DEEDIT
  8301        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8302        MOVE '4'                 TO DC-OPTION-CODE
  8303        PERFORM 9700-DATE-LINK
  8304        IF DATE-CONVERSION-ERROR
  8305           MOVE ER-0348          TO EMI-ERROR
  8306           MOVE -1               TO BEFFDTL
  8307           MOVE AL-UABON         TO BEFFDTA
  8308           PERFORM 9900-ERROR-FORMAT
  8309                                 THRU 9900-EXIT
  8310           GO TO 8200-SEND-DATAONLY
  8311        ELSE
  8312           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8313           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8314           MOVE XCTL-EL6315      TO PGM-NAME
  8315           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8316           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8317           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8318           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8319           GO TO 9300-XCTL
  8320        END-IF
  8321     END-IF
  8322
  8323     IF EIBAID = DFHPF4
  8324        MOVE '0'                TO PI-EDIT-SW
  8325        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 157
* EL6311.cbl
  8326           NEXT SENTENCE
  8327        ELSE
  8328           GO TO 7200-DISPLAY-BATCHES.
  8329
  8330     IF EIBAID = DFHPF5
  8331        MOVE ER-0029                TO EMI-ERROR
  8332        MOVE -1                     TO BPFENTRL
  8333        MOVE AL-UNBON               TO BPFENTRA
  8334        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8335        GO TO 8200-SEND-DATAONLY.
  8336*        MOVE '0'                TO PI-EDIT-SW
  8337*        IF PI-DISPLAY-ORIGINAL-BATCH
  8338*           NEXT SENTENCE
  8339*        ELSE
  8340*           MOVE EL631B              TO PI-MAP-NAME
  8341*           MOVE LOW-VALUES          TO EL631BI
  8342*           MOVE 'A'                 TO BMAINTO
  8343*           MOVE AL-UANON            TO BMAINTA
  8344*           MOVE -1                  TO BMAINTL
  8345*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8346*           GO TO 8100-SEND-INITIAL-MAP.
  8347
  8348     IF EIBAID = DFHPF6
  8349        IF NOT CSR-EDIT-SESSION
  8350           MOVE ER-0029                TO EMI-ERROR
  8351           MOVE -1                     TO BPFENTRL
  8352           MOVE AL-UNBON               TO BPFENTRA
  8353           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8354           GO TO 8200-SEND-DATAONLY
  8355*           MOVE '0'              TO PI-EDIT-SW
  8356*           IF PI-DISPLAY-ORIGINAL-BATCH
  8357*              NEXT SENTENCE
  8358*           ELSE
  8359*              MOVE EL631C        TO PI-MAP-NAME
  8360*              MOVE LOW-VALUES    TO EL631CI
  8361*              MOVE 'A'           TO CMAINTO
  8362*              MOVE AL-UANON      TO CMAINTA
  8363*              MOVE -1            TO CMAINTL
  8364*              MOVE '6'           TO PI-MAINT-FUNCTION
  8365*              GO TO 8100-SEND-INITIAL-MAP
  8366*           END-IF
  8367        ELSE
  8368           PERFORM 5100-PROCESS-POL-RESC
  8369                                 THRU 5100-EXIT
  8370           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8371           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8372                                    PI-PREV-SEQ-NO
  8373           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8374*                                    WS-CANCEL-LETTER-SW
  8375                                    PI-ALL-ISSUES-SW
  8376                                    PI-ALL-CANCELS-SW
  8377           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8378        END-IF
  8379     END-IF
  8380     IF EIBAID = DFHPF7
  8381        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8382        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8383        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 158
* EL6311.cbl
  8384        MOVE PI-SV-STATE            TO PI-STATE
  8385        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8386        MOVE BCERTNOI               TO PI-CERT-PRIME
  8387        MOVE BSUFIXI                TO PI-CERT-SFX
  8388        MOVE BEFFDTI                TO DEEDIT-FIELD
  8389        PERFORM 8600-DEEDIT
  8390        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8391        MOVE '4'                    TO DC-OPTION-CODE
  8392        PERFORM 9700-DATE-LINK
  8393        IF DATE-CONVERSION-ERROR
  8394           MOVE ER-0348            TO EMI-ERROR
  8395           MOVE -1                  TO BEFFDTL
  8396           MOVE AL-UABON            TO BEFFDTA
  8397           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8398           GO TO 8200-SEND-DATAONLY
  8399        ELSE
  8400           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8401           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8402           MOVE XCTL-EL1273        TO PGM-NAME
  8403           GO TO 9300-XCTL.
  8404
  8405     IF EIBAID = DFHPF8
  8406        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8407        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8408        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8409        MOVE PI-SV-STATE            TO PI-STATE
  8410        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8411        MOVE BCERTNOI               TO PI-CERT-PRIME
  8412        MOVE BSUFIXI                TO PI-CERT-SFX
  8413        MOVE BEFFDTI                TO DEEDIT-FIELD
  8414        PERFORM 8600-DEEDIT
  8415        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8416        MOVE '4'                    TO DC-OPTION-CODE
  8417        PERFORM 9700-DATE-LINK
  8418        IF DATE-CONVERSION-ERROR
  8419           MOVE ER-0348            TO EMI-ERROR
  8420           MOVE -1                  TO BEFFDTL
  8421           MOVE AL-UABON            TO BEFFDTA
  8422           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8423           GO TO 8200-SEND-DATAONLY
  8424        ELSE
  8425           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8426           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8427           IF PI-COMPANY-ID = 'DMD'
  8428               MOVE XCTL-EL401DMD      TO PGM-NAME
  8429             ELSE
  8430               MOVE XCTL-EL1279        TO PGM-NAME
  8431           END-IF
  8432           GO TO 9300-XCTL.
  8433
  8434     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8435        MOVE XCTL-EL6312         TO PGM-NAME
  8436
  8437* EXEC CICS XCTL
  8438*           PROGRAM   (PGM-NAME)
  8439*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8440*           LENGTH    (WS-COMM-LENGTH)
  8441*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 159
* EL6311.cbl
  8442*    MOVE '.$C                   %   #00008407' TO DFHEIV0
  8443     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8444     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8445     MOVE X'2020233030303038343037' TO DFHEIV0(25:11)
  8446     CALL 'kxdfhei1' USING DFHEIV0,
  8447           PGM-NAME,
  8448           PROGRAM-INTERFACE-BLOCK,
  8449           WS-COMM-LENGTH,
  8450           DFHEIV99
  8451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8452     ELSE
  8453        MOVE '0'                 TO  PI-EDIT-SW.
  8454
  8455     IF  EIBAID = DFHPF10
  8456         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8457         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8458         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8459                                    PI-1042-WA
  8460         MOVE 4                  TO PI-689-DATA-SOURCE
  8461         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8462         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8463         MOVE PI-SV-STATE        TO PI-689-STATE
  8464         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8465         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8466         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8467         MOVE PI-PB-ALT-CHG-SEQ-NO
  8468                                 TO PI-689-ALT-SEQ-NO
  8469         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8470         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8471         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8472         MOVE +0                 TO PI-689-CONTROL
  8473         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8474                                    PI-689-EXP-DATE
  8475                                    PI-689-RESP-PERSON
  8476                                    PI-689-TYPE
  8477                                    PI-689-FOLLOW-UP-EDIT
  8478                                    PI-689-RESEND1-EDIT
  8479                                    PI-689-SEQ-EDIT
  8480                                    PI-689-BCSEQ-EDIT
  8481                                    PI-689-LBL-OVERRIDE
  8482         MOVE W-LETTER-COMMUNICATION-AREAS
  8483                                 TO PI-PROGRAM-WORK-AREA
  8484         MOVE XCTL-EL689         TO PGM-NAME
  8485         GO TO 9300-XCTL.
  8486
  8487     IF  EIBAID = DFHPF16
  8488         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8489         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8490         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8491                                    PI-1042-WA
  8492         MOVE 4                  TO PI-689-DATA-SOURCE
  8493         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8494         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8495         MOVE PI-SV-STATE        TO PI-689-STATE
  8496         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8497         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8498         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8499         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 160
* EL6311.cbl
  8500                                 TO PI-689-ALT-SEQ-NO
  8501         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8502         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8503         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8504         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8505         MOVE W-LETTER-COMMUNICATION-AREAS
  8506                                 TO PI-PROGRAM-WORK-AREA
  8507         MOVE XCTL-EL690         TO PGM-NAME
  8508         GO TO 9300-XCTL.
  8509
  8510     IF EIBAID = DFHPF13
  8511         MOVE XCTL-EL6313        TO PGM-NAME
  8512         GO TO 9300-XCTL.
  8513
  8514     IF EIBAID = DFHPF17
  8515        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8516        IF (PB-I-LOAN-APR > ZEROS)
  8517           and (pb-i-loan-apr < 99.9999)
  8518           AND (PB-I-BENEFICIARY-NAME NOT
  8519              = SPACES AND LOW-VALUES)
  8520
  8521           MOVE LINK-ELVADS          TO PGM-NAME
  8522
  8523* EXEC CICS LINK
  8524*              PROGRAM    (PGM-NAME)
  8525*              COMMAREA   (WS-PASS-AREA)
  8526*              LENGTH     (WS-PASS-AREA-LENGTH)
  8527*          END-EXEC
  8528*    MOVE '."C                   (   #00008482' TO DFHEIV0
  8529     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8530     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8531     MOVE X'2020233030303038343832' TO DFHEIV0(25:11)
  8532     CALL 'kxdfhei1' USING DFHEIV0,
  8533           PGM-NAME,
  8534           WS-PASS-AREA,
  8535           WS-PASS-AREA-LENGTH,
  8536           DFHEIV99,
  8537           DFHEIV99,
  8538           DFHEIV99,
  8539           DFHEIV99
  8540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8541
  8542           MOVE 0000             TO EMI-ERROR
  8543           MOVE -1               TO BMAINTL
  8544           PERFORM 9900-ERROR-FORMAT
  8545                                 THRU 9900-EXIT
  8546           GO TO 8200-SEND-DATAONLY
  8547        ELSE
  8548           MOVE ER-0877            TO EMI-ERROR
  8549           MOVE -1                  TO BEFFDTL
  8550           MOVE AL-UABON            TO BEFFDTA
  8551           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8552           GO TO 8200-SEND-DATAONLY
  8553        END-IF
  8554     END-IF
  8555     IF EIBAID = DFHPF14
  8556        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8557        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 161
* EL6311.cbl
  8558        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8559        MOVE PI-SV-STATE            TO PI-CR-STATE
  8560        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8561        MOVE SPACE                  TO PI-EDIT-SW
  8562        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8563        MOVE XCTL-EL650             TO PGM-NAME
  8564        GO TO 9300-XCTL.
  8565
  8566     IF EIBAID = DFHPF15
  8567        IF PI-COMPANY-ID  =  'HER'
  8568            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8569            MOVE XCTL-EL680         TO PGM-NAME
  8570            GO TO 9300-XCTL.
  8571
  8572     IF EIBAID = DFHENTER OR DFHPF11
  8573        GO TO 1000-ISSUE-MAINLINE.
  8574
  8575     MOVE ER-0029                TO EMI-ERROR
  8576     MOVE -1                     TO BPFENTRL
  8577     MOVE AL-UNBON               TO BPFENTRA
  8578     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8579     GO TO 8200-SEND-DATAONLY.
  8580
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 162
* EL6311.cbl
  8582
  8583******************************************************************
  8584*                                                                *
  8585*      CANCEL SCREEN PF KEY CHECKING                             *
  8586*                                                                *
  8587******************************************************************
  8588
  8589******************************************************************
  8590*                                                                *
  8591*      PF KEY FUNCTIONS:                                         *
  8592*                                                                *
  8593*      PF1  = BROWSE FORWARD                                     *
  8594*      PF2  = BROWSE BACKWARD                                    *
  8595*      PF3  = CERTIFICATE LOOKUP                                 *
  8596*      PF4  = DISPLAY BATCH HEADER                               *
  8597*      PF5  = ADD ISSUE SCREEN                                   *
  8598*      PF6  = ADD CANCEL SCREEN                                  *
  8599*      PF7  = CERTIFICATE DISPLAY                                *
  8600*      PF8  = CERTIFICATE NOTES                                  *
  8601*      PF9  = EDIT CONTROL                                       *
  8602*      PF10 = DISPLAY LETTER SCREEN                              *
  8603*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8604*      PF12 = DISPLAY HELP SCREEN                                *
  8605*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8606*      PF14 = ACCOUNT MASTER                                     *
  8607*      PF16 = LETTER REVIEW                                      *
  8608*                                                                *
  8609******************************************************************
  8610
  8611 0400-CHECK-CANCEL-PF-KEYS.
  8612     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8613        MOVE ER-2337             TO EMI-ERROR
  8614        MOVE -1                  TO CMAINTL
  8615        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8616        GO TO 8200-SEND-DATAONLY.
  8617
  8618     IF EIBAID = DFHPF1
  8619        MOVE '0'                TO PI-EDIT-SW
  8620        IF PI-PRIMARY-BROWSE
  8621           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8622        ELSE
  8623           IF PI-PRIMARY-WITH-SELECT
  8624              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8625           ELSE
  8626              IF PI-FILE-BROWSE
  8627                 GO TO 4300-BROWSE-FILE-FORWARD
  8628              ELSE
  8629                 IF PI-CSR-BROWSE
  8630                    GO TO 4200-BROWSE-CSR-FORWARD
  8631                 ELSE
  8632                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8633
  8634     IF EIBAID = DFHPF2
  8635        MOVE '0'                TO PI-EDIT-SW
  8636        IF PI-PRIMARY-BROWSE
  8637           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8638        ELSE
  8639           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 163
* EL6311.cbl
  8640              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8641           ELSE
  8642              IF PI-FILE-BROWSE
  8643                 GO TO 4800-BROWSE-FILE-BACKWARD
  8644              ELSE
  8645                 IF PI-CSR-BROWSE
  8646                    GO TO 4900-BROWSE-CSR-BACKWARD
  8647                 ELSE
  8648                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8649
  8650     IF EIBAID = DFHPF3
  8651        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8652        MOVE XCTL-EL127         TO PGM-NAME
  8653        GO TO 9300-XCTL.
  8654
  8655     IF (EIBAID = DFHPF15 OR DFHPF17)
  8656        AND (CSR-EDIT-SESSION)
  8657*       AND (FATAL-OR-UNFORCED)
  8658        AND (FATAL-ERRORS)
  8659        MOVE ER-1819             TO EMI-ERROR
  8660        MOVE -1                  TO CMAINTL
  8661        MOVE AL-UANON            TO CMAINTA
  8662        PERFORM 9900-ERROR-FORMAT
  8663                                 THRU 9900-EXIT
  8664        GO TO 8200-SEND-DATAONLY
  8665     END-IF
  8666     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8667       AND (CSR-EDIT-SESSION)
  8668        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8669        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8670        IF (RESP-NORMAL)
  8671           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8672              AM-CONTROL-PRIMARY (1:20))
  8673            IF AM-NAME NOT GREATER THAN SPACES OR
  8674               AM-ADDRS NOT GREATER THAN SPACES  OR
  8675               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8676               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8677               AM-ZIP NOT GREATER THAN SPACES
  8678               MOVE ER-3834             TO EMI-ERROR
  8679               MOVE -1                  TO BMAINTL
  8680               MOVE AL-UANON            TO BMAINTA
  8681               PERFORM 9900-ERROR-FORMAT
  8682                                 THRU 9900-EXIT
  8683               GO TO 8200-SEND-DATAONLY
  8684            END-IF
  8685        ELSE
  8686           MOVE ER-1609             TO EMI-ERROR
  8687           MOVE -1                  TO BMAINTL
  8688           MOVE AL-UANON            TO BMAINTA
  8689           PERFORM 9900-ERROR-FORMAT
  8690                                THRU 9900-EXIT
  8691           GO TO 8200-SEND-DATAONLY
  8692        END-IF
  8693
  8694        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8695        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8696        IF (ERMAIL-FOUND)
  8697            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 164
* EL6311.cbl
  8698               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8699               MA-CITY NOT GREATER THAN SPACES OR
  8700               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8701               MA-ZIP-CODE NOT GREATER THAN SPACES
  8702               MOVE ER-3835             TO EMI-ERROR
  8703               MOVE -1                  TO BMAINTL
  8704               MOVE AL-UANON            TO BMAINTA
  8705               PERFORM 9900-ERROR-FORMAT
  8706                                 THRU 9900-EXIT
  8707               GO TO 8200-SEND-DATAONLY
  8708            END-IF
  8709        ELSE
  8710           MOVE ER-3000             TO EMI-ERROR
  8711           MOVE -1                  TO BMAINTL
  8712           MOVE AL-UANON            TO BMAINTA
  8713           PERFORM 9900-ERROR-FORMAT
  8714                                THRU 9900-EXIT
  8715           GO TO 8200-SEND-DATAONLY
  8716        END-IF
  8717
  8718     END-IF
  8719     IF (EIBAID = DFHPF15 OR DFHPF17)
  8720        AND (CSR-EDIT-SESSION)
  8721        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8722        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8723        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8724        MOVE PI-SV-STATE         TO PI-STATE
  8725        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8726        MOVE CCERTNOI            TO PI-CERT-PRIME
  8727        MOVE CSUFIXI             TO PI-CERT-SFX
  8728        MOVE CEFFDTI             TO DEEDIT-FIELD
  8729        PERFORM 8600-DEEDIT
  8730        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8731        MOVE '4'                 TO DC-OPTION-CODE
  8732        PERFORM 9700-DATE-LINK
  8733        IF DATE-CONVERSION-ERROR
  8734           MOVE ER-0348          TO EMI-ERROR
  8735           MOVE -1               TO CEFFDTL
  8736           MOVE AL-UABON         TO CEFFDTA
  8737           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8738           GO TO 8200-SEND-DATAONLY
  8739        ELSE
  8740           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8741           PERFORM 6000-CREATE-TEMP-STORAGE
  8742                                 THRU 6000-EXIT
  8743           IF EIBAID = DFHPF17
  8744               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8745                                  THRU 6400-EXIT
  8746               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8747                                 '2' AND '3' AND '4'
  8748                  MOVE ER-3831     TO  EMI-ERROR
  8749                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8750                  GO TO 8200-SEND-DATAONLY
  8751               END-IF
  8752               MOVE 'Y'          TO PI-CLM-RESC-IND
  8753           ELSE
  8754               MOVE 'N'          TO PI-CLM-RESC-IND
  8755           END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 165
* EL6311.cbl
  8756           MOVE XCTL-EL6316      TO PGM-NAME
  8757           MOVE '2'              TO PI-ISS-CAN-SW
  8758           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8759           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8760           GO TO 9300-XCTL
  8761        END-IF
  8762     END-IF
  8763
  8764     IF EIBAID = DFHPF4
  8765        MOVE '0'                TO PI-EDIT-SW
  8766        IF PI-DISPLAY-ORIGINAL-BATCH
  8767           NEXT SENTENCE
  8768        ELSE
  8769           GO TO 7200-DISPLAY-BATCHES.
  8770
  8771     IF EIBAID = DFHPF5
  8772        MOVE ER-0029                TO EMI-ERROR
  8773        MOVE -1                     TO BPFENTRL
  8774        MOVE AL-UNBON               TO BPFENTRA
  8775        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8776        GO TO 8200-SEND-DATAONLY.
  8777*        MOVE '0'                TO PI-EDIT-SW
  8778*        IF PI-DISPLAY-ORIGINAL-BATCH
  8779*           NEXT SENTENCE
  8780*        ELSE
  8781*           MOVE EL631B              TO PI-MAP-NAME
  8782*           MOVE LOW-VALUES          TO EL631BI
  8783*           MOVE 'A'                 TO BMAINTO
  8784*           MOVE AL-UANON            TO BMAINTA
  8785*           MOVE -1                  TO BMAINTL
  8786*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8787*           GO TO 8100-SEND-INITIAL-MAP.
  8788
  8789     IF EIBAID = DFHPF6
  8790        MOVE ER-0029                TO EMI-ERROR
  8791        MOVE -1                     TO BPFENTRL
  8792        MOVE AL-UNBON               TO BPFENTRA
  8793        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8794        GO TO 8200-SEND-DATAONLY.
  8795*        MOVE '0'                TO PI-EDIT-SW
  8796*        IF PI-DISPLAY-ORIGINAL-BATCH
  8797*           NEXT SENTENCE
  8798*        ELSE
  8799*           MOVE EL631C              TO PI-MAP-NAME
  8800*           MOVE LOW-VALUES          TO EL631CI
  8801*           MOVE 'A'                 TO CMAINTO
  8802*           MOVE AL-UANON            TO CMAINTA
  8803*           MOVE -1                  TO CMAINTL
  8804*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8805*           GO TO 8100-SEND-INITIAL-MAP.
  8806
  8807     IF EIBAID = DFHPF7
  8808        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8809        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8810        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8811        MOVE PI-SV-STATE            TO PI-STATE
  8812        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8813        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 166
* EL6311.cbl
  8814        MOVE CSUFIXI                TO PI-CERT-SFX
  8815        MOVE CEFFDTI                TO DEEDIT-FIELD
  8816        PERFORM 8600-DEEDIT
  8817        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8818        MOVE '4'                    TO DC-OPTION-CODE
  8819        PERFORM 9700-DATE-LINK
  8820        IF DATE-CONVERSION-ERROR
  8821           MOVE ER-0348            TO EMI-ERROR
  8822           MOVE -1                  TO BEFFDTL
  8823           MOVE AL-UABON            TO BEFFDTA
  8824           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8825           GO TO 8200-SEND-DATAONLY
  8826        ELSE
  8827           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8828           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8829           MOVE XCTL-EL1273        TO PGM-NAME
  8830           GO TO 9300-XCTL.
  8831
  8832     IF EIBAID = DFHPF8
  8833        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8834        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8835        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8836        MOVE PI-SV-STATE            TO PI-STATE
  8837        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8838        MOVE CCERTNOI               TO PI-CERT-PRIME
  8839        MOVE CSUFIXI                TO PI-CERT-SFX
  8840        MOVE CEFFDTI                TO DEEDIT-FIELD
  8841        PERFORM 8600-DEEDIT
  8842        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8843        MOVE '4'                    TO DC-OPTION-CODE
  8844        PERFORM 9700-DATE-LINK
  8845        IF DATE-CONVERSION-ERROR
  8846           MOVE ER-0348             TO EMI-ERROR
  8847           MOVE -1                  TO BEFFDTL
  8848           MOVE AL-UABON            TO BEFFDTA
  8849           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8850           GO TO 8200-SEND-DATAONLY
  8851        ELSE
  8852           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8853           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8854           IF PI-COMPANY-ID = 'DMD'
  8855               MOVE XCTL-EL401DMD      TO PGM-NAME
  8856             ELSE
  8857               MOVE XCTL-EL1279        TO PGM-NAME
  8858           END-IF
  8859           GO TO 9300-XCTL.
  8860
  8861     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8862        MOVE XCTL-EL6312     TO PGM-NAME
  8863
  8864* EXEC CICS XCTL
  8865*           PROGRAM  (PGM-NAME)
  8866*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  8867*           LENGTH   (WS-COMM-LENGTH)
  8868*       END-EXEC
  8869*    MOVE '.$C                   %   #00008809' TO DFHEIV0
  8870     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8871     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 167
* EL6311.cbl
  8872     MOVE X'2020233030303038383039' TO DFHEIV0(25:11)
  8873     CALL 'kxdfhei1' USING DFHEIV0,
  8874           PGM-NAME,
  8875           PROGRAM-INTERFACE-BLOCK,
  8876           WS-COMM-LENGTH,
  8877           DFHEIV99
  8878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8879     ELSE
  8880        MOVE '0'                 TO  PI-EDIT-SW.
  8881
  8882     IF EIBAID = DFHPF10
  8883         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8884         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  8885         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8886         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8887                                    PI-1042-WA
  8888         MOVE 4                  TO PI-689-DATA-SOURCE
  8889         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8890         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8891         MOVE PI-SV-STATE        TO PI-689-STATE
  8892         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8893         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8894         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8895         MOVE PI-PB-ALT-CHG-SEQ-NO
  8896                                 TO PI-689-ALT-SEQ-NO
  8897         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8898         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8899         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8900         MOVE +0                 TO PI-689-CONTROL
  8901         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8902                                    PI-689-EXP-DATE
  8903                                    PI-689-RESP-PERSON
  8904                                    PI-689-TYPE
  8905                                    PI-689-FOLLOW-UP-EDIT
  8906                                    PI-689-RESEND1-EDIT
  8907                                    PI-689-SEQ-EDIT
  8908                                    PI-689-BCSEQ-EDIT
  8909                                    PI-689-LBL-OVERRIDE
  8910         MOVE W-LETTER-COMMUNICATION-AREAS
  8911                                 TO PI-PROGRAM-WORK-AREA
  8912         MOVE XCTL-EL689         TO PGM-NAME
  8913         GO TO 9300-XCTL.
  8914
  8915     IF  EIBAID = DFHPF16
  8916         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8917         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8918         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8919                                    PI-1042-WA
  8920         MOVE 4                  TO PI-689-DATA-SOURCE
  8921         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8922         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8923         MOVE PI-SV-STATE        TO PI-689-STATE
  8924         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8925         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8926         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8927         MOVE PI-PB-ALT-CHG-SEQ-NO
  8928                                 TO PI-689-ALT-SEQ-NO
  8929         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 168
* EL6311.cbl
  8930         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8931         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8932         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8933         MOVE W-LETTER-COMMUNICATION-AREAS
  8934                                 TO PI-PROGRAM-WORK-AREA
  8935         MOVE XCTL-EL690         TO PGM-NAME
  8936         GO TO 9300-XCTL.
  8937
  8938     IF EIBAID = DFHPF13
  8939        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8940        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8941        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8942        MOVE PI-SV-STATE            TO PI-STATE
  8943        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8944        MOVE CCERTNOI               TO PI-CERT-PRIME
  8945        MOVE CSUFIXI                TO PI-CERT-SFX
  8946        MOVE CEFFDTI                TO DEEDIT-FIELD
  8947        PERFORM 8600-DEEDIT
  8948        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8949        MOVE '4'                    TO DC-OPTION-CODE
  8950        PERFORM 9700-DATE-LINK
  8951        IF DATE-CONVERSION-ERROR
  8952           MOVE ER-0348            TO EMI-ERROR
  8953           MOVE -1                  TO CEFFDTL
  8954           MOVE AL-UABON            TO CEFFDTA
  8955           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8956           GO TO 8200-SEND-DATAONLY
  8957        ELSE
  8958           MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  8959           MOVE AL-UANON            TO CEFFDTA
  8960           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8961           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8962           MOVE XCTL-EL677         TO PGM-NAME
  8963           GO TO 9300-XCTL.
  8964
  8965     IF EIBAID = DFHPF14
  8966        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8967        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8968        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8969        MOVE PI-SV-STATE            TO PI-CR-STATE
  8970        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8971        MOVE SPACE                  TO PI-EDIT-SW
  8972        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8973        MOVE XCTL-EL650             TO PGM-NAME
  8974        GO TO 9300-XCTL.
  8975
  8976     IF EIBAID = DFHENTER OR DFHPF11
  8977        GO TO 2000-CANCEL-MAINLINE.
  8978
  8979     MOVE ER-0029                TO EMI-ERROR.
  8980     MOVE -1                     TO CPFENTRL.
  8981     MOVE AL-UNBON               TO CPFENTRA.
  8982     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8983     GO TO 8200-SEND-DATAONLY.
  8984
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 169
* EL6311.cbl
  8986
  8987******************************************************************
  8988*                                                                *
  8989*      BATCH SCREEN PF KEY CHECKING                              *
  8990*                                                                *
  8991******************************************************************
  8992
  8993******************************************************************
  8994*                                                                *
  8995*      PF KEY FUNCTIONS:                                         *
  8996*                                                                *
  8997*      PF1 = BROWSE FORWARD                                      *
  8998*      PF2 = BROWSE BACKWARD                                     *
  8999*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9000*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9001*                                                                *
  9002*                                                                *
  9003******************************************************************
  9004
  9005 0500-CHECK-BATCH-PF-KEYS.
  9006     IF EIBAID = DFHPF1
  9007        MOVE '0'                TO PI-EDIT-SW
  9008        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9009           GO TO 5000-BROWSE-BATCH-HEADERS
  9010        ELSE
  9011           IF PI-GOOD-BROWSE
  9012              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9013                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9014              ELSE
  9015                 IF PI-FILE-BROWSE
  9016                    GO TO 4300-BROWSE-FILE-FORWARD
  9017                 ELSE
  9018                    IF PI-CSR-BROWSE
  9019                       GO TO 4200-BROWSE-CSR-FORWARD
  9020                    ELSE
  9021                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9022           ELSE
  9023              GO TO 0800-BROWSE-ERROR.
  9024
  9025     IF EIBAID = DFHPF2
  9026        MOVE '0'                TO PI-EDIT-SW
  9027        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9028           GO TO 5500-BROWSE-BATCH-BACKWARD
  9029        ELSE
  9030           IF PI-GOOD-BROWSE
  9031              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9032                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9033              ELSE
  9034                 IF PI-FILE-BROWSE
  9035                    GO TO 4800-BROWSE-FILE-BACKWARD
  9036                 ELSE
  9037                    IF PI-CSR-BROWSE
  9038                       GO TO 4900-BROWSE-CSR-BACKWARD
  9039                    ELSE
  9040                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9041           ELSE
  9042              GO TO 0800-BROWSE-ERROR.
  9043
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 170
* EL6311.cbl
  9044     IF EIBAID = DFHPF3
  9045        GO TO 3000-BATCH-MAINLINE.
  9046
  9047     IF  EIBAID = DFHPF4
  9048        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9049        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9050        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9051        MOVE PI-SV-STATE            TO PI-CR-STATE
  9052        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9053                                       PI-CR-FIN-RESP
  9054        MOVE 'A'                    TO PI-CR-TYPE
  9055        MOVE SPACE                  TO PI-EDIT-SW
  9056        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9057        MOVE XCTL-EL640             TO PGM-NAME
  9058        GO TO 9300-XCTL.
  9059
  9060     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9061       AND
  9062        (EIBAID = DFHENTER)
  9063           GO TO 3500-EDIT-BATCH-DATA.
  9064
  9065     IF EIBAID = DFHENTER
  9066        GO TO 3500-EDIT-BATCH-DATA.
  9067
  9068     MOVE ER-0029             TO EMI-ERROR.
  9069     MOVE -1                  TO DPFENTRL.
  9070     MOVE AL-UNBON            TO DPFENTRA.
  9071     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9072     GO TO 8200-SEND-DATAONLY.
  9073
  9074 0800-BROWSE-ERROR.
  9075     MOVE ER-2258                TO EMI-ERROR.
  9076     MOVE -1                     TO DPFENTRL.
  9077     MOVE AL-UNBON               TO DPFENTRA.
  9078     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9079     GO TO 8200-SEND-DATAONLY.
  9080
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 171
* EL6311.cbl
  9082
  9083******************************************************************
  9084*                                                                *
  9085*                I S S U E   M A I N L I N E                     *
  9086*                                                                *
  9087******************************************************************
  9088
  9089 1000-ISSUE-MAINLINE.
  9090     IF PI-DISPLAY-ORIGINAL-BATCH
  9091        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9092           MOVE ER-0023             TO EMI-ERROR
  9093           MOVE -1                  TO BMAINTL
  9094           MOVE AL-UABON            TO BMAINTA
  9095           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9096           GO TO 8200-SEND-DATAONLY
  9097        ELSE
  9098           NEXT SENTENCE
  9099     ELSE
  9100        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9101           MOVE ER-0023             TO EMI-ERROR
  9102           MOVE -1                  TO BMAINTL
  9103           MOVE AL-UABON            TO BMAINTA
  9104           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9105           GO TO 8200-SEND-DATAONLY.
  9106
  9107     IF BMAINTI = 'S'
  9108        GO TO 1100-SHOW-REQUEST.
  9109
  9110     IF NOT MODIFY-CAP
  9111         MOVE 'UPDATE'       TO SM-READ
  9112         PERFORM 9995-SECURITY-VIOLATION
  9113         MOVE ER-0070        TO EMI-ERROR
  9114         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9115         GO TO 8100-SEND-INITIAL-MAP.
  9116
  9117     IF BMAINTL GREATER THAN ZEROS
  9118        IF PI-PF5-FUNCTION
  9119           IF BMAINTI NOT = 'A'
  9120              MOVE AL-UABON  TO BMAINTA
  9121              MOVE -1        TO BMAINTL
  9122              MOVE ER-2260   TO EMI-ERROR
  9123              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9124              GO TO 8200-SEND-DATAONLY.
  9125
  9126     IF BCERTNOL = ZEROS
  9127       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9128         NEXT SENTENCE
  9129     ELSE
  9130         IF BCERTNOL NOT = ZEROS
  9131             MOVE AL-UANON       TO BCERTNOA
  9132         ELSE
  9133             MOVE -1             TO BCERTNOL
  9134             MOVE  1             TO SET-CURSOR-SW
  9135             MOVE ER-2218        TO EMI-ERROR
  9136             MOVE AL-UABON       TO BCERTNOA
  9137             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9138
  9139     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 172
* EL6311.cbl
  9140         MOVE AL-UANON       TO BSUFIXA
  9141     ELSE
  9142         MOVE AL-SANOF       TO BSUFIXA.
  9143
  9144     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9145        NEXT SENTENCE
  9146     ELSE
  9147        IF BEFFDTL NOT = ZEROS
  9148           MOVE AL-UNNON             TO BEFFDTA
  9149           MOVE BEFFDTI              TO DEEDIT-FIELD
  9150           PERFORM 8600-DEEDIT
  9151           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9152           MOVE 4                    TO DC-OPTION-CODE
  9153           PERFORM 9700-DATE-LINK
  9154           IF NO-CONVERSION-ERROR
  9155              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9156              ELSE
  9157              MOVE -1                TO BEFFDTL
  9158              MOVE  1                TO SET-CURSOR-SW
  9159              MOVE ER-2226           TO EMI-ERROR
  9160              MOVE AL-UNBON          TO BEFFDTA
  9161              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9162           ELSE
  9163              MOVE -1                TO BEFFDTL
  9164              MOVE  1                TO SET-CURSOR-SW
  9165              MOVE ER-2220           TO EMI-ERROR
  9166              MOVE AL-UNBON          TO BEFFDTA
  9167              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9168
  9169     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9170
  9171     IF BCERTNOL NOT = ZEROS
  9172        MOVE BCERTNOI                TO WS-NEW-PRIME
  9173     ELSE
  9174        MOVE SPACES                  TO WS-NEW-PRIME.
  9175
  9176     IF BSUFIXL NOT = ZEROS
  9177        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9178     ELSE
  9179        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9180
  9181     IF BEFFDTL NOT = ZEROS
  9182        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9183     ELSE
  9184        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9185
  9186     IF BMAINTI = 'A' OR 'K' OR 'S'
  9187        NEXT SENTENCE
  9188     ELSE
  9189        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9190        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9191           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9192           WS-PB-RECORD-TYPE NOT = '1'
  9193           IF BMAINTI = 'C'
  9194               MOVE ER-2287          TO EMI-ERROR
  9195               MOVE -1               TO BCERTNOL
  9196               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9197               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 173
* EL6311.cbl
  9198               GO TO 8200-SEND-DATAONLY
  9199             ELSE
  9200               MOVE ER-2260          TO EMI-ERROR
  9201               MOVE -1               TO BCERTNOL
  9202               MOVE AL-UABON         TO BCERTNOA
  9203               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9204               GO TO 8200-SEND-DATAONLY.
  9205
  9206     IF BMAINTI = 'D'
  9207         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9208
  9209*    IF BMICRNOL  NOT =  ZEROS
  9210*        IF BMICRNOI  NUMERIC
  9211*            MOVE AL-UNNON       TO  BMICRNOA
  9212*        ELSE
  9213*            MOVE -1             TO  BMICRNOL
  9214*            MOVE 1              TO  SET-CURSOR-SW
  9215*            MOVE AL-UNBON       TO  BMICRNOA
  9216*            MOVE ER-2701        TO  EMI-ERROR
  9217*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9218     IF BVINL NOT = ZEROS
  9219        MOVE AL-UANON            TO BVINA
  9220     END-IF
  9221     IF B1STNML NOT = ZEROS
  9222         MOVE AL-UANON                TO B1STNMA.
  9223
  9224     IF BINITL  NOT = ZEROS
  9225        MOVE AL-UANON                TO BINITA.
  9226
  9227     IF BSEXL NOT = ZEROS
  9228        IF BSEXI = 'M' OR 'F'
  9229           MOVE AL-UANON             TO BSEXA
  9230        ELSE
  9231           MOVE -1               TO BSEXL
  9232           MOVE ER-2629          TO EMI-ERROR
  9233           MOVE AL-UABON         TO BSEXA
  9234           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9235
  9236     IF BAGEL NOT = ZEROS
  9237         IF BAGEI NUMERIC
  9238             MOVE BAGEI              TO WS-BAGE
  9239             MOVE AL-UNNON           TO BAGEA
  9240         ELSE
  9241             MOVE -1                 TO BAGEL
  9242             MOVE  1                 TO SET-CURSOR-SW
  9243             MOVE ER-2223            TO EMI-ERROR
  9244             MOVE AL-UNBON           TO BAGEA
  9245             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9246
  9247     IF BLSTNML NOT = ZERO  OR
  9248        B1STNML NOT = ZERO  OR
  9249        BINITL NOT = ZERO
  9250         IF BAGEL = ZEROS
  9251             MOVE -1                 TO BAGEL
  9252             MOVE  1                 TO SET-CURSOR-SW
  9253             MOVE ER-3269            TO EMI-ERROR
  9254             MOVE AL-UNBON           TO BAGEA
  9255             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 174
* EL6311.cbl
  9256         END-IF
  9257     END-IF.
  9258
  9259     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9260
  9261     IF (BBIRTHL GREATER THAN +0) AND
  9262        (BBIRTHI NOT EQUAL SPACES)
  9263        NEXT SENTENCE
  9264     ELSE
  9265        GO TO 1010-CHECK-AGE.
  9266
  9267     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9268     PERFORM 8600-DEEDIT.
  9269     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9270     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9271     MOVE AL-UNNON               TO BBIRTHA.
  9272     MOVE '4'                    TO DC-OPTION-CODE.
  9273     PERFORM 9700-DATE-LINK.
  9274     IF DATE-CONVERSION-ERROR
  9275        MOVE -1                  TO BBIRTHL
  9276        MOVE  1                  TO SET-CURSOR-SW
  9277        MOVE ER-2228             TO EMI-ERROR
  9278        MOVE AL-UNBON            TO BBIRTHA
  9279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9280        GO TO 1010-CHECK-AGE.
  9281
  9282     IF (NO-CONVERSION-ERROR) AND
  9283        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9284        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9285        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9286        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9287                                    WS-CONVERTED-BIRTH
  9288        MOVE AL-UANON            TO BBIRTHA
  9289     ELSE
  9290        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9291        MOVE AL-UANON            TO BBIRTHA.
  9292
  9293 1010-CHECK-AGE.
  9294
  9295*    IF BAGEL = ZERO
  9296*       IF BBIRTHL GREATER THAN ZERO
  9297*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9298
  9299     IF B1STPMTL NOT = ZEROS
  9300        IF B1STPMTI = SPACES
  9301           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9302        ELSE
  9303           MOVE B1STPMTI             TO DEEDIT-FIELD
  9304           PERFORM 8600-DEEDIT
  9305           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9306           MOVE AL-UNNON             TO B1STPMTA
  9307           MOVE 4                    TO DC-OPTION-CODE
  9308           PERFORM 9700-DATE-LINK
  9309           IF NO-CONVERSION-ERROR
  9310              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9311              MOVE AL-UANON          TO B1STPMTA
  9312           ELSE
  9313              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 175
* EL6311.cbl
  9314              MOVE  1                TO SET-CURSOR-SW
  9315              MOVE ER-2200           TO EMI-ERROR
  9316              MOVE AL-UNBON          TO B1STPMTA
  9317              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9318
  9319     IF BDAYSL NOT = ZEROS
  9320         IF BDAYSI NUMERIC
  9321             MOVE AL-UNNON           TO BDAYSA
  9322         ELSE
  9323             MOVE -1                 TO BDAYSL
  9324             MOVE ER-2530            TO EMI-ERROR
  9325             MOVE AL-UNBON           TO BDAYSA
  9326             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9327
  9328     IF BLNTRML NOT = ZEROS
  9329         IF BLNTRMI NUMERIC
  9330             MOVE AL-UNNON       TO BLNTRMA
  9331         ELSE
  9332             MOVE -1             TO BLNTRML
  9333             MOVE ER-2533        TO EMI-ERROR
  9334             MOVE AL-UNBON       TO BLNTRMA
  9335             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9336
  9337**   IF PI-COMPANY-ID = 'DMD'
  9338     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9339        NEXT SENTENCE
  9340     ELSE
  9341         IF BLNOFCRL NOT = ZEROS
  9342            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9343            IF LOAN-OFFICER-FOUND
  9344                MOVE AL-UANON        TO BLNOFCRA
  9345             ELSE
  9346                 MOVE SPACE          TO WS-LOAN-OFFICER
  9347                 MOVE -1             TO BLNOFCRL
  9348                 MOVE  1             TO SET-CURSOR-SW
  9349                 MOVE ER-3006        TO EMI-ERROR
  9350                 MOVE AL-UNBON       TO BLNOFCRA
  9351                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9352
  9353     IF BFREQL NOT = ZEROS
  9354         IF BFREQI NUMERIC
  9355             MOVE AL-UNNON       TO BFREQA
  9356         ELSE
  9357             MOVE -1             TO BFREQL
  9358             MOVE  1             TO SET-CURSOR-SW
  9359             MOVE ER-2223        TO EMI-ERROR
  9360             MOVE AL-UNBON       TO BFREQA
  9361             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9362
  9363     IF BMODEL NOT = ZEROS
  9364         MOVE BMODEI             TO WS-MODE-CODE
  9365                                    PI-BMODE
  9366         IF WS-MODE-CODE-VALID
  9367             MOVE AL-UANON       TO BMODEA
  9368         ELSE
  9369             MOVE -1             TO BMODEL
  9370             MOVE ER-2591        TO EMI-ERROR
  9371             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 176
* EL6311.cbl
  9372             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9373
  9374     IF BPMTSL NOT = ZEROS
  9375         IF BPMTSI NUMERIC
  9376             MOVE AL-UNNON           TO BPMTSA
  9377             MOVE BPMTSI             TO PI-BPMTS
  9378         ELSE
  9379             MOVE -1                 TO BPMTSL
  9380             MOVE ER-2592            TO EMI-ERROR
  9381             MOVE AL-UNBON           TO BPMTSA
  9382             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9383
  9384     IF BPMTAMTL NOT = ZEROS
  9385
  9386* EXEC CICS BIF DEEDIT
  9387*            FIELD  (BPMTAMTI)
  9388*            LENGTH (9)
  9389*       END-EXEC
  9390     MOVE 9
  9391       TO DFHEIV11
  9392*    MOVE '@"L                   #   #00009320' TO DFHEIV0
  9393     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9394     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9395     MOVE X'2020233030303039333230' TO DFHEIV0(25:11)
  9396     CALL 'kxdfhei1' USING DFHEIV0,
  9397           BPMTAMTI,
  9398           DFHEIV11
  9399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9400        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9401*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9402*        PERFORM 8600-DEEDIT
  9403*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9404
  9405*    IF BAPRL NOT = ZEROS
  9406*        EXEC CICS BIF DEEDIT
  9407*            FIELD  (BAPRI)
  9408*            LENGTH (7)
  9409*        END-EXEC
  9410*        MOVE BAPRI              TO WS-BAPR.
  9411
  9412     IF BAPRL > 0
  9413        MOVE +0                  TO  WS-BAPR
  9414        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9415           (WS-SUB > 7)
  9416           OR (BAPRI (WS-SUB:1) NUMERIC)
  9417           OR (BAPRI (WS-SUB:1) = '.')
  9418        END-PERFORM
  9419        IF WS-SUB > 7
  9420           MOVE ER-2471       TO EMI-ERROR
  9421           MOVE -1            TO BAPRL
  9422           MOVE AL-UNBON      TO BAPRA
  9423           PERFORM 9900-ERROR-FORMAT
  9424                                 THRU 9900-EXIT
  9425        ELSE
  9426           IF BAPRI (WS-SUB:1) NUMERIC
  9427              MOVE WS-SUB           TO WS-BEG
  9428              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9429                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 177
* EL6311.cbl
  9430                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9431              END-PERFORM
  9432              COMPUTE WS-END = WS-SUB - WS-BEG
  9433              MOVE BAPRI (WS-BEG:WS-END)
  9434                                 TO WS-APR-WHOLE-NUM
  9435           END-IF
  9436           IF BAPRI (WS-SUB:1) = '.'
  9437              COMPUTE WS-BEG = WS-SUB + 1
  9438              IF (WS-BEG < 8)
  9439                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9440                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9441                    (WS-SUB > 7)
  9442                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9443                 END-PERFORM
  9444                 COMPUTE WS-END = WS-SUB - WS-BEG
  9445                 MOVE BAPRI (WS-BEG:WS-END)
  9446                                 TO WS-APR-DEC (1:WS-END)
  9447              END-IF
  9448           END-IF
  9449           MOVE AL-UNNON      TO BAPRA
  9450           MOVE WS-BAPR       TO BAPRO
  9451        END-IF
  9452     END-IF
  9453*     IF BAPRL NOT = ZEROS
  9454*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9455*        PERFORM 8600-DEEDIT
  9456*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9457
  9458     IF BLIVESL NOT = ZEROS
  9459        MOVE BLIVESI             TO DEEDIT-FIELD
  9460        PERFORM 8600-DEEDIT
  9461        IF DEEDIT-FIELD-V0 NUMERIC
  9462           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9463           MOVE AL-UNNON         TO BLIVESA
  9464        ELSE
  9465           MOVE -1               TO BLIVESL
  9466           MOVE AL-UNBON         TO BLIVESA
  9467           MOVE ER-2223          TO EMI-ERROR
  9468           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9469
  9470*DMD CUSTOM CODING*************START
  9471*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9472     IF PI-COMPANY-ID NOT = 'DMD'
  9473         MOVE ZEROS               TO BBILLEDL
  9474         GO TO 1010-EDIT-CONT.
  9475
  9476     IF BBILLEDL NOT = ZEROS
  9477        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9478        MOVE 'Y'                 TO WS-NUMERIC-SW
  9479        MOVE +1                  TO WS-CSO-SUB
  9480        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9481        IF CSO-NUMERIC-FIELD
  9482
  9483* EXEC CICS BIF DEEDIT
  9484*              FIELD  (BBILLEDI)
  9485*              LENGTH (9)
  9486*          END-EXEC
  9487     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 178
* EL6311.cbl
  9488       TO DFHEIV11
  9489*    MOVE '@"L                   #   #00009406' TO DFHEIV0
  9490     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9491     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9492     MOVE X'2020233030303039343036' TO DFHEIV0(25:11)
  9493     CALL 'kxdfhei1' USING DFHEIV0,
  9494           BBILLEDI,
  9495           DFHEIV11
  9496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9497           MOVE BBILLEDI         TO WS-BILLED
  9498           MOVE AL-UNNON         TO BBILLEDA
  9499        ELSE
  9500           MOVE -1               TO BBILLEDL
  9501           MOVE AL-UNBON         TO BBILLEDA
  9502           MOVE ER-2547          TO EMI-ERROR
  9503           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9504     ELSE
  9505        IF BMAINTI EQUAL 'A'
  9506           MOVE -1               TO BBILLEDL
  9507           MOVE AL-UNBON         TO BBILLEDA
  9508           MOVE ER-8148          TO EMI-ERROR
  9509           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9510
  9511 1010-EDIT-CONT.
  9512
  9513     IF BFORCEL  NOT = ZEROS
  9514         IF FORCE-CAP
  9515            MOVE AL-UANON            TO BFORCEA
  9516         ELSE
  9517            MOVE ER-2945             TO EMI-ERROR
  9518            MOVE AL-UABON            TO BFORCEA
  9519            MOVE -1                  TO BFORCEL
  9520            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9521
  9522     IF BENTRYL NOT = ZEROS
  9523        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9524                         'D' AND 'V' AND 'U' AND 'M'
  9525           MOVE ER-2224              TO EMI-ERROR
  9526           MOVE AL-UABON             TO BENTRYA
  9527           MOVE -1                   TO BENTRYL
  9528           MOVE  1                   TO SET-CURSOR-SW
  9529           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9530        ELSE
  9531           MOVE AL-UANON             TO BENTRYA.
  9532
  9533     IF BUNWRITL NOT = ZEROS
  9534        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9535           MOVE ER-7574              TO EMI-ERROR
  9536           MOVE AL-UABON             TO BUNWRITA
  9537           MOVE -1                   TO BUNWRITL
  9538           MOVE  1                   TO SET-CURSOR-SW
  9539           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9540        ELSE
  9541           MOVE AL-UANON             TO BUNWRITA.
  9542
  9543     IF BREINL  NOT = ZEROS
  9544         MOVE AL-UANON               TO BREINA.
  9545
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 179
* EL6311.cbl
  9546     IF BBILCDL NOT = ZEROS
  9547        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9548                             AND 'A' AND 'B' AND 'E'
  9549           MOVE ER-2225              TO EMI-ERROR
  9550           MOVE AL-UABON             TO BBILCDA
  9551           MOVE -1                   TO BBILCDL
  9552           MOVE  1                   TO SET-CURSOR-SW
  9553           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9554        ELSE
  9555           MOVE AL-UANON             TO BBILCDA.
  9556
  9557     IF BSKPCDL NOT = ZEROS
  9558         MOVE AL-UANON               TO BSKPCDA.
  9559
  9560     IF BINDGRPL NOT = ZEROS
  9561         MOVE AL-UANON               TO BINDGRPA.
  9562
  9563     IF BSIGL   NOT = ZEROS
  9564         MOVE AL-UANON               TO BSIGA.
  9565
  9566     IF BRTCLSL NOT = ZEROS
  9567         MOVE AL-UANON               TO BRTCLSA.
  9568
  9569     IF BMEMBERL NOT = ZEROS
  9570         MOVE AL-UANON               TO BMEMBERA.
  9571
  9572     MOVE +0                         TO WS-SUB1.
  9573
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 180
* EL6311.cbl
  9575
  9576******************************************************************
  9577*                                                                *
  9578*           E D I T   I S S U E   C O V E R A G E S              *
  9579*                                                                *
  9580******************************************************************
  9581
  9582 1020-EDIT-COVERAGES.
  9583     ADD +1                      TO WS-SUB1.
  9584
  9585     IF WS-SUB1 GREATER +2
  9586        GO TO 1025-EDIT-COMPLETE.
  9587
  9588     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9589       IF (BMODEL   GREATER ZERO  OR
  9590            BPMTSL   GREATER ZERO  OR
  9591            BPMTAMTL GREATER ZERO)
  9592          AND
  9593            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9594               GO TO 1021-CONT-EDIT.
  9595
  9596     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9597        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9598        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9599        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9600        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9601        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9602        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9603        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9604        NEXT SENTENCE
  9605         ELSE
  9606            GO TO 1020-EDIT-COVERAGES.
  9607
  9608 1021-CONT-EDIT.
  9609
  9610     IF BMAINTI = 'A'
  9611        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9612           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9613        ELSE
  9614           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9615           MOVE ER-7404          TO EMI-ERROR
  9616           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9617           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9618     ELSE
  9619        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9620           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9621
  9622     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9623        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9624        PERFORM 8600-DEEDIT
  9625        IF DEEDIT-FIELD-V0 NUMERIC
  9626           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9627        ELSE
  9628           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9629
  9630     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9631*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9632        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 181
* EL6311.cbl
  9633           BPMTSL  GREATER THAN ZEROS
  9634           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9635
  9636     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9637         IF BMODEL   GREATER THAN ZEROS  OR
  9638            BPMTSL   GREATER THAN ZEROS  OR
  9639            BPMTAMTL GREATER THAN ZEROS
  9640             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9641
  9642     IF BMAINTI = ('C' OR 'K')
  9643        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9644           NEXT SENTENCE
  9645        ELSE
  9646           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9647           PERFORM 8600-DEEDIT
  9648           IF DEEDIT-FIELD-V0 NUMERIC
  9649              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9650              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9651                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9652              ELSE
  9653                    MOVE ER-2241      TO EMI-ERROR
  9654                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9655                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9656                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9657           ELSE
  9658              MOVE ER-2223          TO EMI-ERROR
  9659              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9660              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9661              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9662     ELSE
  9663        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9664            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9665            PERFORM 8600-DEEDIT
  9666            IF DEEDIT-FIELD-V0      NUMERIC
  9667               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9668                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9669                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9670               ELSE
  9671                  MOVE ER-2241         TO EMI-ERROR
  9672                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9673                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9674                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9675            ELSE
  9676              MOVE ER-2223             TO EMI-ERROR
  9677              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9678              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9679              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9680        ELSE
  9681            MOVE ER-2240               TO EMI-ERROR
  9682            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9683            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9684*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9685*        IF BMODEL  GREATER THAN ZEROS  AND
  9686*           BPMTSL  GREATER THAN ZEROS
  9687*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9688
  9689     IF BBEN-LEN (WS-SUB1) = ZEROS
  9690        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 182
* EL6311.cbl
  9691           NEXT SENTENCE
  9692     ELSE
  9693        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9694           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9695
  9696* EXEC CICS BIF DEEDIT
  9697*              FIELD  (BBENI (WS-SUB1))
  9698*              LENGTH (12)
  9699*          END-EXEC
  9700     MOVE 12
  9701       TO DFHEIV11
  9702*    MOVE '@"L                   #   #00009608' TO DFHEIV0
  9703     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9704     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9705     MOVE X'2020233030303039363038' TO DFHEIV0(25:11)
  9706     CALL 'kxdfhei1' USING DFHEIV0,
  9707           BBENI(WS-SUB1),
  9708           DFHEIV11
  9709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9710           IF BBENI (WS-SUB1)  NUMERIC
  9711              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9712                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9713*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9714*          PERFORM 8600-DEEDIT
  9715*          IF DEEDIT-FIELD-V2  NUMERIC
  9716*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9717*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9718              ELSE
  9719                 MOVE ER-7632    TO EMI-ERROR
  9720                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9721                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9722                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9723           ELSE
  9724              MOVE ER-2223         TO EMI-ERROR
  9725              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9726              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9727              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9728        ELSE
  9729           MOVE ER-7632    TO EMI-ERROR
  9730           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9731           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9732           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9733
  9734     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9735        AND (BMAINTI = ('C' OR 'K'))
  9736        CONTINUE
  9737     ELSE
  9738        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9739           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9740           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9741              FOR ALL '.'
  9742           IF WS-TALLY > 1
  9743              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9744                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9745              END-PERFORM
  9746              IF A1 < 9
  9747                 ADD 3 TO A1
  9748                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 183
* EL6311.cbl
  9749              END-IF
  9750           ELSE
  9751              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9752                (A1 > 11)
  9753                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9754                  LOW-VALUES OR SPACES)
  9755              END-PERFORM
  9756              IF A1 > 1 AND < 12
  9757                 MOVE SPACES
  9758                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9759              END-IF
  9760           END-IF
  9761
  9762* EXEC CICS BIF DEEDIT
  9763*              FIELD  (BPREMI (WS-SUB1))
  9764*              LENGTH (11)
  9765*          END-EXEC
  9766     MOVE 11
  9767       TO DFHEIV11
  9768*    MOVE '@"L                   #   #00009663' TO DFHEIV0
  9769     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9770     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9771     MOVE X'2020233030303039363633' TO DFHEIV0(25:11)
  9772     CALL 'kxdfhei1' USING DFHEIV0,
  9773           BPREMI(WS-SUB1),
  9774           DFHEIV11
  9775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9776           IF BPREMI (WS-SUB1) NUMERIC
  9777              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9778                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9779*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9780*          PERFORM 8600-DEEDIT
  9781*          IF DEEDIT-FIELD-V2  NUMERIC
  9782*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9783*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9784              ELSE
  9785                 IF PI-COMPANY-ID NOT = 'DCC'
  9786                    MOVE ER-7633    TO EMI-ERROR
  9787                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9788                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9789                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9790                 END-IF
  9791              END-IF
  9792           ELSE
  9793              MOVE ER-2223         TO EMI-ERROR
  9794              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9795              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9796              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9797           END-IF
  9798        ELSE
  9799           IF PI-COMPANY-ID NOT = 'DCC'
  9800              MOVE ER-7633         TO EMI-ERROR
  9801              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9802              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9803              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9804           END-IF
  9805        END-IF
  9806     END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 184
* EL6311.cbl
  9807
  9808     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9809        NEXT SENTENCE
  9810     ELSE
  9811        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9812
  9813* EXEC CICS BIF DEEDIT
  9814*           FIELD  (BCPREMI (WS-SUB1))
  9815*           LENGTH (11)
  9816*       END-EXEC
  9817     MOVE 11
  9818       TO DFHEIV11
  9819*    MOVE '@"L                   #   #00009703' TO DFHEIV0
  9820     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9821     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9822     MOVE X'2020233030303039373033' TO DFHEIV0(25:11)
  9823     CALL 'kxdfhei1' USING DFHEIV0,
  9824           BCPREMI(WS-SUB1),
  9825           DFHEIV11
  9826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9827        IF BCPREMI (WS-SUB1) NUMERIC
  9828           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9829*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9830*       PERFORM 8600-DEEDIT
  9831*       IF DEEDIT-FIELD-V2  NUMERIC
  9832*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9833        ELSE
  9834           MOVE ER-2223         TO EMI-ERROR
  9835           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9836           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9837           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9838
  9839     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9840        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9841        PERFORM 8600-DEEDIT
  9842        IF DEEDIT-FIELD-V0 NUMERIC
  9843           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9844           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9845         ELSE
  9846           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9847           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9848           MOVE ER-2223              TO EMI-ERROR
  9849           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9850
  9851     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9852        IF BEXPIRE   (WS-SUB1) = SPACES
  9853           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9854        ELSE
  9855           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9856           PERFORM 8600-DEEDIT
  9857           IF DEEDIT-FIELD-V0        NUMERIC
  9858              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9859              MOVE 4                TO DC-OPTION-CODE
  9860              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9861              PERFORM 9700-DATE-LINK
  9862              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9863                                                        (WS-SUB1)
  9864              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 185
* EL6311.cbl
  9865                 NEXT SENTENCE
  9866              ELSE
  9867                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9868                 MOVE ER-2531    TO EMI-ERROR
  9869                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9870                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9871           ELSE
  9872             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9873             MOVE ER-2532        TO EMI-ERROR
  9874             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9875             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9876
  9877     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9878        NEXT SENTENCE
  9879     ELSE
  9880
  9881* EXEC CICS BIF DEEDIT
  9882*           FIELD  (BALT-BENI (WS-SUB1))
  9883*           LENGTH (12)
  9884*       END-EXEC
  9885     MOVE 12
  9886       TO DFHEIV11
  9887*    MOVE '@"L                   #   #00009760' TO DFHEIV0
  9888     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9889     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9890     MOVE X'2020233030303039373630' TO DFHEIV0(25:11)
  9891     CALL 'kxdfhei1' USING DFHEIV0,
  9892           BALT-BENI(WS-SUB1),
  9893           DFHEIV11
  9894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9895        IF BALT-BENI (WS-SUB1) NUMERIC
  9896           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9897*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9898*       PERFORM 8600-DEEDIT
  9899*       IF DEEDIT-FIELD-V0 NUMERIC
  9900*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9901        ELSE
  9902           MOVE ER-2223         TO EMI-ERROR
  9903           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9904           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9905           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9906
  9907     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9908        NEXT SENTENCE
  9909     ELSE
  9910
  9911* EXEC CICS BIF DEEDIT
  9912*           FIELD  (BALT-PREMI (WS-SUB1))
  9913*           LENGTH (11)
  9914*       END-EXEC
  9915     MOVE 11
  9916       TO DFHEIV11
  9917*    MOVE '@"L                   #   #00009779' TO DFHEIV0
  9918     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9919     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9920     MOVE X'2020233030303039373739' TO DFHEIV0(25:11)
  9921     CALL 'kxdfhei1' USING DFHEIV0,
  9922           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 186
* EL6311.cbl
  9923           DFHEIV11
  9924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9925        IF BALT-PREMI (WS-SUB1) NUMERIC
  9926           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9927*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9928*       PERFORM 8600-DEEDIT
  9929*       IF DEEDIT-FIELD-V0 NUMERIC
  9930*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9931        ELSE
  9932           MOVE ER-2223         TO EMI-ERROR
  9933           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9934           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9935           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9936
  9937      GO TO 1020-EDIT-COVERAGES.
  9938
  9939 1025-EDIT-COMPLETE.
  9940     IF PI-COMPANY-ID  =  'DMD'
  9941        MOVE LOW-VALUES             TO BNCERTI
  9942                                       BNSTATI.
  9943
  9944     IF EMI-ERROR = ZEROS
  9945         NEXT SENTENCE
  9946     ELSE
  9947         GO TO 8200-SEND-DATAONLY.
  9948
  9949     IF BMAINTI = 'A'
  9950         GO TO 1200-ADD-ISSUE-ROUTINE.
  9951
  9952     IF BMAINTI = 'C'
  9953         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9954
  9955     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9956
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 187
* EL6311.cbl
  9958
  9959 1030-EDIT-FOR-NUMERICS.
  9960     IF WS-CSO-SUB EQUAL 10
  9961        GO TO 1030-EDIT-EXIT.
  9962
  9963     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  9964        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  9965        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  9966           ADD +1               TO WS-CSO-SUB
  9967           GO TO 1030-EDIT-FOR-NUMERICS.
  9968
  9969     MOVE 'N'                   TO WS-NUMERIC-SW.
  9970
  9971 1030-EDIT-EXIT.
  9972******************************************************************
  9973*                                                                *
  9974*                 C A L C U L A T E   A G E                      *
  9975*                                                                *
  9976******************************************************************
  9977
  9978
  9979 1095-CALC-AGE.
  9980
  9981     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
  9982     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
  9983     MOVE 1                  TO DC-OPTION-CODE.
  9984     PERFORM 9700-DATE-LINK
  9985     IF NO-CONVERSION-ERROR
  9986         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  9987         MOVE WS-BAGE            TO BAGEI
  9988         MOVE +2                 TO BAGEL
  9989         MOVE AL-UNNON TO BAGEA.
  9990
  9991 1099-EXIT.
  9992     EXIT.
  9993
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 188
* EL6311.cbl
  9995
  9996******************************************************************
  9997*                                                                *
  9998*                   S H O W   I S S U E                          *
  9999*                                                                *
 10000******************************************************************
 10001
 10002 1100-SHOW-REQUEST.
 10003     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10004
 10005     IF BCERTNOL = ZEROS AND
 10006        BEFFDTL  = ZEROS
 10007        MOVE -1                  TO BMAINTL
 10008        GO TO 8200-SEND-DATAONLY.
 10009
 10010     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10011
 10012     IF BSUFIXL NOT = ZEROS
 10013        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10014     ELSE
 10015        MOVE SPACE               TO WS-NEW-SUFFIX.
 10016
 10017     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10018     PERFORM 8600-DEEDIT.
 10019     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10020     MOVE '4'                    TO DC-OPTION-CODE.
 10021     PERFORM 9700-DATE-LINK.
 10022     IF DATE-CONVERSION-ERROR
 10023        MOVE ER-0348             TO EMI-ERROR
 10024        MOVE -1                  TO BEFFDTL
 10025        MOVE AL-UABON            TO BEFFDTA
 10026        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10027        GO TO 8200-SEND-DATAONLY
 10028     ELSE
 10029        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10030        MOVE AL-UANON            TO BEFFDTA
 10031        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10032
 10033     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10034
 10035     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10036        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10037          MOVE 'Y'                    TO WS-SHOW-SW
 10038          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10039             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10040           ELSE
 10041             IF PI-FILE-BROWSE
 10042                GO TO 4300-BROWSE-FILE-FORWARD
 10043              ELSE
 10044                IF PI-CSR-BROWSE
 10045                   GO TO 4200-BROWSE-CSR-FORWARD
 10046                ELSE
 10047                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10048        ELSE
 10049           GO TO 3900-RE-DISPLAY-RECORD.
 10050
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 189
* EL6311.cbl
 10052
 10053******************************************************************
 10054*                                                                *
 10055*            A D D   I S S U E   R O U T I N E                   *
 10056*                                                                *
 10057******************************************************************
 10058
 10059***************************************************************
 10060*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10061*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10062*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10063*     4. LINK TO THE EDIT ROUTINE.                            *
 10064*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10065*     6. WRITE THE NEW ISSUE RECORD.                          *
 10066*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10067*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10068*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10069*        ELSE                                                 *
 10070*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10071***************************************************************
 10072
 10073 1200-ADD-ISSUE-ROUTINE.
 10074     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10075
 10076
 10077* EXEC CICS GETMAIN
 10078*        SET     (ADDRESS OF PENDING-BUSINESS)
 10079*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10080*    END-EXEC.
 10081*    MOVE '," L                  $   #00009934' TO DFHEIV0
 10082     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10083     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10084     MOVE X'2020233030303039393334' TO DFHEIV0(25:11)
 10085     CALL 'kxdfhei1' USING DFHEIV0,
 10086           DFHEIV20,
 10087           ERPNDB-RECORD-LENGTH,
 10088           DFHEIV99
 10089     SET ADDRESS OF PENDING-BUSINESS TO
 10090         DFHEIV20
 10091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10092
 10093
 10094
 10095* EXEC CICS HANDLE CONDITION
 10096*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10097*    END-EXEC.
 10098*    MOVE '"$I                   ! # #00009939' TO DFHEIV0
 10099     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10101     MOVE X'2320233030303039393339' TO DFHEIV0(25:11)
 10102     CALL 'kxdfhei1' USING DFHEIV0
 10103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10104
 10105
 10106     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10107     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10108     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10109
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 190
* EL6311.cbl
 10110
 10111* EXEC CICS READ
 10112*        INTO    (PENDING-BUSINESS)
 10113*        DATASET (FILE-ID-ERPNDB)
 10114*        RIDFLD  (ERPNDB-KEY)
 10115*    END-EXEC.
 10116     MOVE LENGTH OF
 10117      PENDING-BUSINESS
 10118       TO DFHEIV11
 10119*    MOVE '&"IL       E          (   #00009947' TO DFHEIV0
 10120     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10121     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10122     MOVE X'2020233030303039393437' TO DFHEIV0(25:11)
 10123     CALL 'kxdfhei1' USING DFHEIV0,
 10124           FILE-ID-ERPNDB,
 10125           PENDING-BUSINESS,
 10126           DFHEIV11,
 10127           ERPNDB-KEY,
 10128           DFHEIV99,
 10129           DFHEIV99,
 10130           DFHEIV99
 10131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10132
 10133
 10134     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10135
 10136     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10137     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10138     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10139     MOVE SPACES                 TO PENDING-BUSINESS.
 10140     MOVE 'PB'                   TO PB-RECORD-ID.
 10141     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10142     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10143     MOVE SPACES                 TO PB-CERT-SFX.
 10144     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10145     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10146                                    PB-ALT-CHG-SEQ-NO.
 10147
 10148     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10149     MOVE '1'                    TO PB-RECORD-TYPE.
 10150
 10151     IF BSUFIXL NOT = ZEROS
 10152        MOVE BSUFIXI             TO PB-CERT-SFX.
 10153
 10154     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10155
 10156     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10157     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10158
 10159     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10160                                    PB-I-LF-PREM-CALC
 10161                                    PB-I-LF-ALT-PREM-CALC
 10162                                    PB-I-LF-RATE
 10163                                    PB-I-LF-ALT-RATE
 10164                                    PB-I-LF-REI-RATE
 10165                                    PB-I-LF-ALT-REI-RATE
 10166                                    PB-I-RATE-DEV-PCT-LF
 10167                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 191
* EL6311.cbl
 10168                                    PB-I-AH-RATE
 10169                                    PB-I-AH-REI-RATE
 10170                                    PB-I-AH-RATE-TRM
 10171                                    PB-I-RATE-DEV-PCT-AH
 10172                                    PB-I-BUSINESS-TYPE
 10173                                    PB-I-LIFE-COMMISSION
 10174                                    PB-I-JOINT-COMMISSION
 10175                                    PB-I-JOINT-AGE
 10176                                    PB-I-AH-COMMISSION
 10177                                    PB-I-CURR-SEQ
 10178                                    PB-CHG-COUNT
 10179                                    PB-LF-BILLED-AMTS
 10180                                    PB-AH-BILLED-AMTS
 10181                                    PB-CALC-TOLERANCE
 10182                                    PB-I-EXTENTION-DAYS
 10183*                                   PB-I-MICROFILM-NO
 10184                                    PB-I-TERM-IN-DAYS.
 10185
 10186     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10187                                    PB-I-LF-EXPIRE-DT
 10188                                    PB-I-AH-EXPIRE-DT
 10189                                    PB-BILLED-DT
 10190                                    PB-ACCT-EFF-DT
 10191                                    PB-ACCT-EXP-DT
 10192                                    PB-I-1ST-PMT-DT.
 10193
 10194     MOVE 'X'                    TO PB-FATAL-FLAG.
 10195
 10196     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10197
 10198     IF BLSTNML GREATER THAN ZEROS
 10199         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10200
 10201*    IF BMICRNOL  GREATER  ZEROS
 10202*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10203*    ELSE
 10204*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10205     IF BVINL > ZEROS
 10206        MOVE BVINI               TO PB-I-VIN
 10207     END-IF
 10208     IF B1STNML GREATER THAN ZEROS
 10209         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10210
 10211     IF BINITL  GREATER THAN ZEROS
 10212         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10213
 10214     IF BBIRTHL GREATER THAN ZERO
 10215         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10216     ELSE
 10217         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10218
 10219     IF B1STPMTL GREATER THAN ZERO
 10220         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10221     ELSE
 10222         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10223
 10224     IF BAGEL    GREATER THAN ZEROS
 10225         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 192
* EL6311.cbl
 10226        ELSE
 10227         MOVE ZEROS              TO PB-I-AGE.
 10228
 10229     IF BSEXL    GREATER THAN ZEROS
 10230         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10231
 10232     IF BTERM-LEN (1) GREATER THAN ZEROS
 10233        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10234     ELSE
 10235        MOVE ZEROS               TO PB-I-LF-TERM.
 10236
 10237     IF BTERM-LEN (2) GREATER THAN ZEROS
 10238        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10239     ELSE
 10240        MOVE ZEROS               TO PB-I-AH-TERM.
 10241
 10242     IF BLNTRML       GREATER THAN ZEROS
 10243         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10244        ELSE
 10245         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10246
 10247     IF BFREQL        GREATER THAN ZEROS
 10248         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10249        ELSE
 10250         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10251
 10252     IF BSKPCDL       GREATER THAN ZEROS
 10253         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10254
 10255     IF BMODEL        GREATER THAN ZEROS
 10256         MOVE BMODEI             TO PB-I-TERM-TYPE
 10257                                    PI-BMODE.
 10258
 10259     IF BPMTSL        GREATER THAN ZEROS
 10260         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10261                                    PI-BPMTS
 10262        ELSE
 10263         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10264                                    PI-BPMTS.
 10265
 10266     IF BPMTAMTL      GREATER THAN ZEROS
 10267         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10268        ELSE
 10269         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10270
 10271     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10272        IF BTYPE  (1)   NOT = ZEROS
 10273           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10274                                    PI-BTYPE (1)
 10275           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10276           MOVE SPACES           TO PB-I-LF-ABBR
 10277        ELSE
 10278           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10279                                    PB-I-LF-ABBR
 10280           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10281     ELSE
 10282        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10283                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 193
* EL6311.cbl
 10284        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10285
 10286     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10287         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10288     ELSE
 10289         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10290
 10291     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10292         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10293     ELSE
 10294         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10295
 10296     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10297         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10298            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10299            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10300         ELSE
 10301            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10302*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10303*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10304         END-IF
 10305     ELSE
 10306         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10307
 10308     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10309         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10310
 10311     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10312         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10313         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10314     ELSE
 10315         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10316
 10317     IF  BALT-PREM-LEN     (2) > ZEROS
 10318         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10319     ELSE
 10320         MOVE ZEROS            TO PB-I-TOT-FEES.
 10321
 10322     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10323        IF BTYPE      (2)   NOT = ZEROS
 10324           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10325                                  PI-BTYPE (2)
 10326           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10327           MOVE SPACES         TO PB-I-AH-ABBR
 10328        ELSE
 10329           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10330                                  PB-I-AH-ABBR
 10331           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10332     ELSE
 10333        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10334                                  PB-I-AH-ABBR
 10335        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10336
 10337     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10338         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10339     ELSE
 10340         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10341
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 194
* EL6311.cbl
 10342     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10343         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10344            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10345            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10346         ELSE
 10347            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10348*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10349*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10350         END-IF
 10351     ELSE
 10352         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10353
 10354     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10355         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10356
 10357     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10358        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10359     ELSE
 10360        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10361
 10362     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10363        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10364     ELSE
 10365        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10366
 10367     IF BINDGRPL  GREATER THAN ZEROS
 10368         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10369
 10370     IF BRTCLSL   GREATER THAN ZEROS
 10371         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10372
 10373     IF BSIGL     GREATER THAN ZEROS
 10374         MOVE BSIGI              TO PB-I-SIG-SW.
 10375     IF BAPRL > ZEROS
 10376         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10377     ELSE
 10378        if pi-company-id = 'CID'
 10379           move +99.9999         to pb-i-loan-apr
 10380        else
 10381           MOVE ZEROS            TO PB-I-LOAN-APR
 10382        end-if
 10383     end-if
 10384     IF BMEMBERL  GREATER THAN ZEROS
 10385         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10386
 10387     IF BLNOFCRL  GREATER THAN ZEROS
 10388         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10389
 10390     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10391        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10392     ELSE
 10393        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10394
 10395     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10396        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10397     ELSE
 10398        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10399
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 195
* EL6311.cbl
 10400     IF BDAYSL   GREATER THAN ZEROS
 10401        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10402                                    PB-I-EXTENTION-DAYS
 10403     ELSE
 10404        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10405                                    PB-I-EXTENTION-DAYS.
 10406
 10407     IF BDAYSL GREATER THAN ZEROS
 10408        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10409
 10410     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10411        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10412           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10413
 10414     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10415        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10416           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10417
 10418     IF B1STPMTL GREATER THAN ZEROS
 10419        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10420
 10421     IF PB-EXT-DAYS-PROCESSING
 10422        IF PB-I-EXTENTION-DAYS = ZEROS
 10423           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10424
 10425     IF PB-EXPIRE-DT-PROCESSING
 10426        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10427           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10428             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10429
 10430     IF PB-1ST-PMT-DT-PROCESSING
 10431        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10432           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10433
 10434     IF BREINL GREATER THAN ZEROS
 10435        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10436
 10437     IF BENTRYL NOT = ZEROS
 10438        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10439        IF PI-COMPANY-ID = 'CID'
 10440           AND (PB-BATCH-ENTRY = 'P')
 10441           AND (PB-STATE = 'VA')
 10442           PERFORM 1500-UPDATE-ERNOTE
 10443                                 THRU 1500-EXIT
 10444        END-IF
 10445     END-IF
 10446     IF BUNWRITL NOT = ZEROS
 10447        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10448
 10449     IF BFORCEL NOT = ZEROS
 10450        MOVE BFORCEI             TO PB-FORCE-CODE.
 10451
 10452     IF BBILCDL NOT = ZEROS
 10453        MOVE BBILCDI             TO PB-RECORD-BILL.
 10454
 10455     IF BLIVESL GREATER THAN ZEROS
 10456        MOVE WS-BLIVES           TO PB-I-LIVES
 10457     ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 196
* EL6311.cbl
 10458        MOVE ZEROS               TO PB-I-LIVES.
 10459
 10460     IF BBILLEDL GREATER THAN ZEROS
 10461        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10462     ELSE
 10463        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10464
 10465*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10466
 10467 1260-WRITE-PB-RECORD.
 10468     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10469                                    PB-INPUT-BY.
 10470     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10471     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10472                                    PB-INPUT-DT.
 10473
 10474     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10475     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10476                                    PB-CONTROL-BY-ORIG-BATCH.
 10477
 10478
 10479     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10480     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10481     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10482     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10483     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10484
 10485     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10486
 10487     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10488
 10489     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10490     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10491     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10492
 10493     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10494     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10495
 10496 1275-WRITE-PENDING-BUSINESS.
 10497     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10498     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10499     MOVE 'A'                    TO JP-RECORD-TYPE.
 10500     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10501
 10502
 10503* EXEC CICS HANDLE CONDITION
 10504*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10505*    END-EXEC.
 10506*    MOVE '"$%                   ! $ #00010321' TO DFHEIV0
 10507     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10509     MOVE X'2420233030303130333231' TO DFHEIV0(25:11)
 10510     CALL 'kxdfhei1' USING DFHEIV0
 10511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10512
 10513
 10514
 10515* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 197
* EL6311.cbl
 10516*        DATASET (FILE-ID-ERPNDB)
 10517*        FROM    (PENDING-BUSINESS)
 10518*        RIDFLD  (PB-CONTROL-PRIMARY)
 10519*    END-EXEC.
 10520     MOVE LENGTH OF
 10521      PENDING-BUSINESS
 10522       TO DFHEIV11
 10523*    MOVE '&$ L                  ''   #00010325' TO DFHEIV0
 10524     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10525     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10526     MOVE X'2020233030303130333235' TO DFHEIV0(25:11)
 10527     CALL 'kxdfhei1' USING DFHEIV0,
 10528           FILE-ID-ERPNDB,
 10529           PENDING-BUSINESS,
 10530           DFHEIV11,
 10531           PB-CONTROL-PRIMARY,
 10532           DFHEIV99,
 10533           DFHEIV99
 10534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10535
 10536
 10537     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10538
 10539     PERFORM 8400-LOG-JOURNAL-RECORD.
 10540
 10541******************************************************************
 10542*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10543******************************************************************
 10544     display ' made it to add orig cert '
 10545     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10546     MOVE ' '                    TO WS-ERMAIL-SW
 10547
 10548* EXEC CICS READ
 10549*       DATASET   (FILE-ID-ERMAIL)
 10550*       SET       (ADDRESS OF MAILING-DATA)
 10551*       RIDFLD    (ERMAIL-KEY)
 10552*       RESP      (WS-RESPONSE)
 10553*    END-EXEC
 10554*    MOVE '&"S        E          (  N#00010341' TO DFHEIV0
 10555     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10557     MOVE X'204E233030303130333431' TO DFHEIV0(25:11)
 10558     CALL 'kxdfhei1' USING DFHEIV0,
 10559           FILE-ID-ERMAIL,
 10560           DFHEIV20,
 10561           DFHEIV99,
 10562           ERMAIL-KEY,
 10563           DFHEIV99,
 10564           DFHEIV99,
 10565           DFHEIV99
 10566     SET ADDRESS OF MAILING-DATA TO
 10567         DFHEIV20
 10568     MOVE EIBRESP  TO WS-RESPONSE
 10569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10570     IF RESP-NORMAL
 10571        SET ERMAIL-FOUND TO TRUE
 10572     END-IF
 10573
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 198
* EL6311.cbl
 10574     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10575     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10576     MOVE 'OC'                   TO OC-RECORD-ID
 10577     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10578                                 TO OC-CONTROL-PRIMARY (1:33)
 10579     MOVE 'I'                    TO OC-RECORD-TYPE
 10580     MOVE +4096                  TO OC-KEY-SEQ-NO
 10581     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10582     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10583     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10584     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10585     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10586     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10587     MOVE PB-I-AGE               TO OC-INS-AGE
 10588     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10589     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10590     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10591     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10592     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10593     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10594     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10595     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10596     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10597     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10598     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10599     IF PB-I-JOINT-COMMISSION > +0
 10600         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10601     ELSE
 10602         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10603     END-IF
 10604     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10605     MOVE +0                     TO OC-LF-CANCEL-AMT
 10606                                    OC-LF-ITD-CANCEL-AMT
 10607     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10608     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10609     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10610     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10611     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10612     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10613     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10614     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10615     MOVE +0                     TO OC-AH-CANCEL-AMT
 10616                                    OC-AH-ITD-CANCEL-AMT
 10617     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10618     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10619     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10620     IF ERMAIL-FOUND
 10621        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10622     END-IF
 10623     IF NOT CERT-TRL-REC-NOT-FOUND
 10624        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10625                           OC-INS-AGE-DEFAULT-FLAG
 10626        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10627                           OC-JNT-AGE-DEFAULT-FLAG
 10628     END-IF
 10629     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10630     .
 10631 1275-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 199
* EL6311.cbl
 10632
 10633* EXEC CICS WRITE
 10634*       DATASET   ('ELCRTO')
 10635*       FROM      (ORIGINAL-CERTIFICATE)
 10636*       RIDFLD    (OC-CONTROL-PRIMARY)
 10637*       RESP      (WS-RESPONSE)
 10638*    END-EXEC
 10639     MOVE LENGTH OF
 10640      ORIGINAL-CERTIFICATE
 10641       TO DFHEIV11
 10642     MOVE 'ELCRTO' TO DFHEIV1
 10643*    MOVE '&$ L                  ''  N#00010409' TO DFHEIV0
 10644     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10645     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10646     MOVE X'204E233030303130343039' TO DFHEIV0(25:11)
 10647     CALL 'kxdfhei1' USING DFHEIV0,
 10648           DFHEIV1,
 10649           ORIGINAL-CERTIFICATE,
 10650           DFHEIV11,
 10651           OC-CONTROL-PRIMARY,
 10652           DFHEIV99,
 10653           DFHEIV99
 10654     MOVE EIBRESP  TO WS-RESPONSE
 10655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10656     display ' just wrote 1275 ' ws-response
 10657     IF RESP-DUPKEY
 10658        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10659        GO TO 1275-WRITE-ELCRTO
 10660     ELSE
 10661        IF NOT RESP-NORMAL
 10662           MOVE -1               TO BMAINTL
 10663           MOVE ER-7450          TO EMI-ERROR
 10664           PERFORM 9900-ERROR-FORMAT
 10665                                 THRU 9900-EXIT
 10666           GO TO 8200-SEND-DATAONLY
 10667        END-IF
 10668     END-IF
 10669******************************************************************
 10670*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10671******************************************************************
 10672
 10673
 10674* EXEC CICS READ
 10675*        INTO    (PENDING-BUSINESS)
 10676*        DATASET (FILE-ID-ERPNDB)
 10677*        RIDFLD  (ERPNDB-KEY)
 10678*        UPDATE
 10679*    END-EXEC.
 10680     MOVE LENGTH OF
 10681      PENDING-BUSINESS
 10682       TO DFHEIV11
 10683*    MOVE '&"IL       EU         (   #00010432' TO DFHEIV0
 10684     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10685     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10686     MOVE X'2020233030303130343332' TO DFHEIV0(25:11)
 10687     CALL 'kxdfhei1' USING DFHEIV0,
 10688           FILE-ID-ERPNDB,
 10689           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 200
* EL6311.cbl
 10690           DFHEIV11,
 10691           ERPNDB-KEY,
 10692           DFHEIV99,
 10693           DFHEIV99,
 10694           DFHEIV99
 10695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10696
 10697
 10698     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10699     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10700     MOVE 'B'                    TO JP-RECORD-TYPE.
 10701     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10702
 10703     PERFORM 8400-LOG-JOURNAL-RECORD.
 10704
 10705     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10706
 10707
 10708* EXEC CICS REWRITE
 10709*        DATASET (FILE-ID-ERPNDB)
 10710*        FROM    (PENDING-BUSINESS)
 10711*    END-EXEC.
 10712     MOVE LENGTH OF
 10713      PENDING-BUSINESS
 10714       TO DFHEIV11
 10715*    MOVE '&& L                  %   #00010448' TO DFHEIV0
 10716     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10717     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10718     MOVE X'2020233030303130343438' TO DFHEIV0(25:11)
 10719     CALL 'kxdfhei1' USING DFHEIV0,
 10720           FILE-ID-ERPNDB,
 10721           PENDING-BUSINESS,
 10722           DFHEIV11,
 10723           DFHEIV99
 10724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10725
 10726
 10727     MOVE 'C'                    TO JP-RECORD-TYPE.
 10728     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10729
 10730     PERFORM 8400-LOG-JOURNAL-RECORD.
 10731
 10732     IF WS-ERRORS-PRESENT
 10733         GO TO 3900-RE-DISPLAY-RECORD.
 10734
 10735     MOVE ZEROS                  TO EMI-ERROR.
 10736     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10737     MOVE LOW-VALUES             TO EL631BI.
 10738     MOVE  -1                    TO BMAINTL.
 10739     GO TO 8100-SEND-INITIAL-MAP.
 10740
 10741 1280-BATCH-HDR-NOT-FOUND.
 10742     MOVE -1                     TO BMAINTL.
 10743     MOVE ER-7450                TO EMI-ERROR.
 10744     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10745     GO TO 8200-SEND-DATAONLY.
 10746
 10747 1290-DUPLICATE-ALT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 201
* EL6311.cbl
 10748
 10749******************************************************************
 10750*                                                                *
 10751*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10752*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10753*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10754*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10755*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10756*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10757*                                                                *
 10758******************************************************************
 10759
 10760     IF LCP-ONCTR-01 =  0
 10761         ADD 1 TO LCP-ONCTR-01
 10762        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10763
 10764     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10765
 10766     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10767         NEXT SENTENCE
 10768     ELSE
 10769         ADD +1 TO PB-BATCH-SEQ-NO
 10770                   PB-CSR-BATCH-SEQ-NO
 10771         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10772         GO TO 1275-WRITE-PENDING-BUSINESS.
 10773
 10774     MOVE -1                     TO BCERTNOL.
 10775     MOVE AL-UABON               TO BCERTNOA.
 10776     MOVE AL-UNBON               TO BEFFDTA.
 10777
 10778     MOVE 1                      TO EMI-SUB
 10779                                    EMI-SWITCH1
 10780                                    EMI-SWITCH-AREA-1
 10781                                    EMI-SWITCH-AREA-2.
 10782
 10783     MOVE SPACES                 TO EMI-ERROR-LINES.
 10784
 10785
 10786* EXEC CICS SYNCPOINT ROLLBACK
 10787*    END-EXEC.
 10788*    MOVE '6"R                   !   #00010511' TO DFHEIV0
 10789     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10791     MOVE X'2020233030303130353131' TO DFHEIV0(25:11)
 10792     CALL 'kxdfhei1' USING DFHEIV0
 10793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10794
 10795
 10796     MOVE ER-2247                TO EMI-ERROR.
 10797     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10798     GO TO 8200-SEND-DATAONLY.
 10799
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 202
* EL6311.cbl
 10801
 10802
 10803 1295-READ-CERT-TRAILER.
 10804
 10805
 10806* EXEC CICS GETMAIN
 10807*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10808*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10809*        INITIMG (GETMAIN-SPACE)
 10810*    END-EXEC
 10811*    MOVE ',"IL                  $   #00010523' TO DFHEIV0
 10812     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10813     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10814     MOVE X'2020233030303130353233' TO DFHEIV0(25:11)
 10815     CALL 'kxdfhei1' USING DFHEIV0,
 10816           DFHEIV20,
 10817           ELCRTT-RECORD-LENGTH,
 10818           GETMAIN-SPACE
 10819     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10820         DFHEIV20
 10821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10822
 10823     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10824     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10825     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10826
 10827
 10828* EXEC CICS HANDLE CONDITION
 10829*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 10830*    END-EXEC.
 10831*    MOVE '"$I                   ! % #00010533' TO DFHEIV0
 10832     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10833     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10834     MOVE X'2520233030303130353333' TO DFHEIV0(25:11)
 10835     CALL 'kxdfhei1' USING DFHEIV0
 10836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10837
 10838
 10839
 10840* EXEC CICS READ
 10841*        DATASET  (CRTT-ID)
 10842*        RIDFLD   (ELCRTT-KEY)
 10843*        INTO     (CERTIFICATE-TRAILERS)
 10844*    END-EXEC.
 10845     MOVE LENGTH OF
 10846      CERTIFICATE-TRAILERS
 10847       TO DFHEIV11
 10848*    MOVE '&"IL       E          (   #00010537' TO DFHEIV0
 10849     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10850     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10851     MOVE X'2020233030303130353337' TO DFHEIV0(25:11)
 10852     CALL 'kxdfhei1' USING DFHEIV0,
 10853           CRTT-ID,
 10854           CERTIFICATE-TRAILERS,
 10855           DFHEIV11,
 10856           ELCRTT-KEY,
 10857           DFHEIV99,
 10858           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 203
* EL6311.cbl
 10859           DFHEIV99
 10860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10861
 10862
 10863     GO TO 1295-EXIT.
 10864
 10865 1295-CERT-TRL-REC-NOTFND.
 10866     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 10867
 10868 1295-EXIT.
 10869     EXIT.
 10870
 10871******************************************************************
 10872*                                                                *
 10873*          C H A N G E   I S S U E   R O U T I N E               *
 10874*                                                                *
 10875******************************************************************
 10876
 10877***************************************************************
 10878*                                                             *
 10879*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10880*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10881*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10882*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10883*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10884*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10885*     5. LINK TO THE EDIT ROUTINE.                            *
 10886*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10887*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10888*              THE EDIT ROUTINE.                              *
 10889*     7. REWRITE THE NEW ISSUE                                *
 10890*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10891*                                                             *
 10892***************************************************************
 10893
 10894 1300-CHANGE-ISSUE-ROUTINE.
 10895     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10896
 10897     IF BCHGL NOT = ZEROS
 10898        MOVE ER-2196             TO EMI-ERROR
 10899        MOVE AL-UABON            TO BMAINTA
 10900        MOVE -1                  TO BMAINTL
 10901        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10902        GO TO 8200-SEND-DATAONLY.
 10903
 10904     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10905
 10906     IF BSUFIXL NOT = ZEROS
 10907        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10908     ELSE
 10909        MOVE SPACE               TO WS-NEW-SUFFIX.
 10910
 10911     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10912     PERFORM 8600-DEEDIT.
 10913     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10914     MOVE '4'                    TO DC-OPTION-CODE.
 10915     PERFORM 9700-DATE-LINK.
 10916     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 204
* EL6311.cbl
 10917        MOVE ER-0348             TO EMI-ERROR
 10918        MOVE -1                  TO BEFFDTL
 10919        MOVE AL-UABON            TO BEFFDTA
 10920        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10921        GO TO 8200-SEND-DATAONLY
 10922     ELSE
 10923        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10924        MOVE AL-UANON            TO BEFFDTA
 10925        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10926
 10927 1325-PROCESS-ISSUE-CHANGES.
 10928
 10929* EXEC CICS HANDLE CONDITION
 10930*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10931*    END-EXEC.
 10932*    MOVE '"$I                   ! & #00010608' TO DFHEIV0
 10933     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10935     MOVE X'2620233030303130363038' TO DFHEIV0(25:11)
 10936     CALL 'kxdfhei1' USING DFHEIV0
 10937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10938
 10939
 10940     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10941     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10942     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10943
 10944
 10945* EXEC CICS GETMAIN
 10946*        SET      (ADDRESS OF PENDING-BUSINESS)
 10947*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10948*        INITIMG  (GETMAIN-SPACE)
 10949*     END-EXEC.
 10950*    MOVE ',"IL                  $   #00010616' TO DFHEIV0
 10951     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10952     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10953     MOVE X'2020233030303130363136' TO DFHEIV0(25:11)
 10954     CALL 'kxdfhei1' USING DFHEIV0,
 10955           DFHEIV20,
 10956           ERPNDB-RECORD-LENGTH,
 10957           GETMAIN-SPACE
 10958     SET ADDRESS OF PENDING-BUSINESS TO
 10959         DFHEIV20
 10960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10961
 10962
 10963
 10964* EXEC CICS READ
 10965*        INTO    (PENDING-BUSINESS)
 10966*        DATASET (FILE-ID-ERPNDB)
 10967*        RIDFLD  (ERPNDB-KEY)
 10968*    END-EXEC.
 10969     MOVE LENGTH OF
 10970      PENDING-BUSINESS
 10971       TO DFHEIV11
 10972*    MOVE '&"IL       E          (   #00010622' TO DFHEIV0
 10973     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10974     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 205
* EL6311.cbl
 10975     MOVE X'2020233030303130363232' TO DFHEIV0(25:11)
 10976     CALL 'kxdfhei1' USING DFHEIV0,
 10977           FILE-ID-ERPNDB,
 10978           PENDING-BUSINESS,
 10979           DFHEIV11,
 10980           ERPNDB-KEY,
 10981           DFHEIV99,
 10982           DFHEIV99,
 10983           DFHEIV99
 10984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10985
 10986
 10987     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10988
 10989
 10990* EXEC CICS HANDLE CONDITION
 10991*         NOTFND     (1385-REC-NOT-FOUND)
 10992*    END-EXEC.
 10993*    MOVE '"$I                   ! '' #00010630' TO DFHEIV0
 10994     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10995     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10996     MOVE X'2720233030303130363330' TO DFHEIV0(25:11)
 10997     CALL 'kxdfhei1' USING DFHEIV0
 10998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10999
 11000
 11001**********************************************************
 11002*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11003*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11004**********************************************************
 11005
 11006
 11007* EXEC CICS READ
 11008*        DATASET (FILE-ID-ERPNDB)
 11009*        INTO    (PENDING-BUSINESS)
 11010*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11011*    END-EXEC.
 11012     MOVE LENGTH OF
 11013      PENDING-BUSINESS
 11014       TO DFHEIV11
 11015*    MOVE '&"IL       E          (   #00010639' TO DFHEIV0
 11016     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11018     MOVE X'2020233030303130363339' TO DFHEIV0(25:11)
 11019     CALL 'kxdfhei1' USING DFHEIV0,
 11020           FILE-ID-ERPNDB,
 11021           PENDING-BUSINESS,
 11022           DFHEIV11,
 11023           PI-PREV-CONTROL-PRIMARY,
 11024           DFHEIV99,
 11025           DFHEIV99,
 11026           DFHEIV99
 11027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11028
 11029
 11030********** DO NOT ALLOW CHANGES IF THRU A/R
 11031     IF BMAINTI = 'C'
 11032         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 206
* EL6311.cbl
 11033             MOVE ER-4005          TO EMI-ERROR
 11034             MOVE -1               TO BMAINTL
 11035             MOVE AL-UABON         TO BMAINTA
 11036             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11037             GO TO 8200-SEND-DATAONLY.
 11038**********
 11039
 11040     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11041        MOVE -1                 TO BMAINTL
 11042        MOVE ER-2197            TO EMI-ERROR
 11043        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11044        GO TO 8200-SEND-DATAONLY.
 11045
 11046     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11047        MOVE ER-2196             TO EMI-ERROR
 11048        MOVE AL-UABON            TO BMAINTA
 11049        MOVE -1                  TO BMAINTL
 11050        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11051        GO TO 8200-SEND-DATAONLY.
 11052
 11053     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11054
 11055     IF PB-BILLED-DT = LOW-VALUES AND
 11056        PB-CHG-COUNT = ZEROS
 11057        NEXT SENTENCE
 11058     ELSE
 11059        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11060            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11061           OR
 11062           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11063            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11064           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11065
 11066
 11067* EXEC CICS READ
 11068*        DATASET (FILE-ID-ERPNDB)
 11069*        INTO    (PENDING-BUSINESS)
 11070*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11071*        UPDATE
 11072*    END-EXEC.
 11073     MOVE LENGTH OF
 11074      PENDING-BUSINESS
 11075       TO DFHEIV11
 11076*    MOVE '&"IL       EU         (   #00010681' TO DFHEIV0
 11077     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11078     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11079     MOVE X'2020233030303130363831' TO DFHEIV0(25:11)
 11080     CALL 'kxdfhei1' USING DFHEIV0,
 11081           FILE-ID-ERPNDB,
 11082           PENDING-BUSINESS,
 11083           DFHEIV11,
 11084           PI-PREV-CONTROL-PRIMARY,
 11085           DFHEIV99,
 11086           DFHEIV99,
 11087           DFHEIV99
 11088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11089
 11090
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 207
* EL6311.cbl
 11091     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11092     MOVE 'B'                    TO JP-RECORD-TYPE
 11093     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11094     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11095
 11096     PERFORM 8400-LOG-JOURNAL-RECORD.
 11097
 11098     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11099        PB-CHG-COUNT NOT = ZEROS
 11100        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11101            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11102           OR
 11103           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11104            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11105            MOVE LOW-VALUES             TO PB-BILLED-DT
 11106            ADD +1                      TO PB-CHG-COUNT.
 11107
 11108     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11109     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11110     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11111     MOVE '5'                    TO DC-OPTION-CODE.
 11112     PERFORM 9700-DATE-LINK
 11113     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11114
 11115*    IF BMICRNOL  GREATER  ZEROS
 11116*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11117
 11118     IF BVINL > ZEROS
 11119        MOVE BVINI               TO PB-I-VIN
 11120     END-IF
 11121     IF (BFORCEL NOT = ZEROS)
 11122        AND (PB-COMPANY-ID = 'DCC')
 11123        AND (BFORCEI = ' ')
 11124        AND (PB-FORCE-CODE = 'O')
 11125        COMPUTE PB-I-AH-PREMIUM-AMT =
 11126           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11127        PERFORM 1800-REMOVE-CERT-NOTES
 11128                                 THRU 1800-EXIT
 11129        PERFORM 1900-DELETE-ERPYAJ
 11130                                 THRU 1900-EXIT
 11131        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11132     END-IF
 11133     IF (BFORCEL NOT = ZEROS)
 11134        AND (PB-COMPANY-ID = 'DCC')
 11135        AND (BFORCEI = 'O')
 11136        AND (PB-FORCE-CODE NOT = 'O')
 11137        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11138           PB-I-AH-PREM-CALC
 11139        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11140        MOVE SPACE               TO DC-OPTION-CODE
 11141        PERFORM 9700-DATE-LINK
 11142        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11143        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11144        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11145        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11146        PERFORM 1500-UPDATE-ERNOTE
 11147                                 THRU 1500-EXIT
 11148        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 208
* EL6311.cbl
 11149                                 THRU 1600-EXIT
 11150     END-IF
 11151     IF BLSTNML  GREATER THAN ZEROS
 11152         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11153
 11154     IF B1STNML  GREATER THAN ZEROS
 11155         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11156
 11157     IF BINITL   GREATER THAN ZEROS
 11158         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11159
 11160     IF BBIRTHL  GREATER THAN ZERO
 11161         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11162
 11163     IF B1STPMTL GREATER THAN ZERO
 11164         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11165
 11166     IF BAGEL    GREATER THAN ZEROS
 11167         MOVE BAGEI              TO PB-I-AGE.
 11168
 11169     MOVE 'N'                    TO WS-INS-AGE-SET
 11170                                    WS-JNT-AGE-SET.
 11171     IF BAGEL    GREATER THAN ZEROS
 11172        MOVE 'Y'                TO WS-INS-AGE-SET
 11173        IF BAGEI = ZERO AND
 11174             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11175           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11176           MOVE 'AGE*'          TO BAGEDEFO
 11177        ELSE
 11178           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11179           MOVE 'AGE '          TO BAGEDEFO
 11180        END-IF
 11181        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11182     END-IF.
 11183
 11184     IF BSEXL    GREATER THAN ZEROS
 11185         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11186
 11187     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11188        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11189
 11190     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11191        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11192
 11193     IF BLNTRML  GREATER THAN ZEROS
 11194         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11195
 11196     IF BFREQL   GREATER THAN ZEROS
 11197         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11198
 11199     IF BSKPCDL  GREATER THAN ZEROS
 11200         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11201
 11202     IF BMODEL   GREATER THAN ZEROS
 11203         MOVE BMODEI             TO PB-I-TERM-TYPE
 11204                                    PI-BMODE.
 11205
 11206     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 209
* EL6311.cbl
 11207         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11208                                    PI-BPMTS.
 11209
 11210     IF BPMTAMTL GREATER THAN ZEROS
 11211         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11212
 11213     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11214         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11215
 11216     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11217         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11218
 11219     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11220
 11221     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11222         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11223            SUBTRACT PB-I-LF-PREMIUM-AMT
 11224                     FROM WS-B-LF-ISS-PRM-ENTERED
 11225            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11226            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11227            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11228         ELSE
 11229            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11230*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11231*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11232         END-IF
 11233     END-IF.
 11234
 11235     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11236            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11237                     FROM WS-B-LF-ISS-PRM-ENTERED
 11238         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11239         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11240
 11241     IF  BALT-PREM-LEN     (2)  > ZEROS
 11242         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11243
 11244     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11245         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11246
 11247     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11248         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11249            SUBTRACT PB-I-AH-PREMIUM-AMT
 11250                     FROM WS-B-AH-ISS-PRM-ENTERED
 11251            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11252            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11253            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11254         ELSE
 11255            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11256*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11257*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11258         END-IF
 11259     END-IF
 11260
 11261     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11262        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11263
 11264     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 210
* EL6311.cbl
 11265        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11266
 11267     IF BINDGRPL            GREATER THAN ZEROS
 11268         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11269
 11270     IF BRTCLSL             GREATER THAN ZEROS
 11271         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11272
 11273     IF BSIGL               GREATER THAN ZEROS
 11274         MOVE BSIGI              TO PB-I-SIG-SW.
 11275
 11276     IF BAPRL               GREATER THAN ZEROS
 11277         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11278
 11279     IF BMEMBERL            GREATER THAN ZEROS
 11280         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11281
 11282     IF BLNOFCRL            GREATER THAN ZEROS
 11283         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11284
 11285     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11286        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11287
 11288     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11289        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11290
 11291     IF BDAYSL              GREATER THAN ZEROS
 11292        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11293                                    PB-I-EXTENTION-DAYS.
 11294
 11295     IF BDAYSL GREATER THAN ZEROS
 11296        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11297
 11298     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11299        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11300           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11301
 11302     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11303        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11304           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11305
 11306     IF B1STPMTL GREATER THAN ZEROS
 11307        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11308
 11309     IF PB-EXT-DAYS-PROCESSING
 11310        IF PB-I-EXTENTION-DAYS = ZEROS
 11311           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11312
 11313     IF PB-EXPIRE-DT-PROCESSING
 11314        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11315           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11316             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11317
 11318     IF PB-1ST-PMT-DT-PROCESSING
 11319        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11320           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11321
 11322     IF BREINL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 211
* EL6311.cbl
 11323        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11324
 11325     IF BFORCEL NOT = ZEROS
 11326        MOVE BFORCEI             TO PB-FORCE-CODE.
 11327     IF (BENTRYL NOT = ZEROS)
 11328        AND (PB-COMPANY-ID = 'CID')
 11329        AND (PB-STATE = 'VA')
 11330        AND (BENTRYI NOT = 'P')
 11331        AND (PB-BATCH-ENTRY = 'P')
 11332        PERFORM 1800-REMOVE-CERT-NOTES
 11333                                 THRU 1800-EXIT
 11334     END-IF
 11335     IF BENTRYL NOT = ZEROS
 11336        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11337        IF PI-COMPANY-ID = 'CID'
 11338           AND (PB-BATCH-ENTRY = 'P')
 11339           AND (PB-STATE = 'VA')
 11340           PERFORM 1500-UPDATE-ERNOTE
 11341                                 THRU 1500-EXIT
 11342        END-IF
 11343     END-IF
 11344
 11345     IF BUNWRITL NOT = ZEROS
 11346        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11347
 11348     IF BBILCDL NOT = ZEROS
 11349        MOVE BBILCDI             TO PB-RECORD-BILL.
 11350
 11351     IF BLIVESL GREATER THAN ZEROS
 11352        MOVE WS-BLIVES           TO PB-I-LIVES.
 11353
 11354
 11355*DMD CUSTOM CODING*************START
 11356     IF PI-COMPANY-ID NOT = 'DMD'
 11357         MOVE ZEROS               TO BBILLEDL.
 11358*DMD CUSTOM CODING*************END
 11359
 11360     IF BBILLEDL GREATER THAN ZEROS
 11361        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11362
 11363
 11364*****************************************************************
 11365*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11366*****************************************************************
 11367
 11368     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11369        IF BTYPE  (1)   = ZEROS OR SPACES
 11370           IF REMOVE-LF-COVERAGE
 11371               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11372                                        PI-BTYPE (1)
 11373               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11374                                        WS-B-LF-ISS-PRM-ENTERED
 11375               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11376                                        WS-B-LF-ISS-PRM-ENTERED
 11377               SUBTRACT PB-I-LF-PREM-CALC FROM
 11378                                        WS-B-LF-ISS-PRM-COMPUTED
 11379               MOVE ZEROS            TO PB-I-LF-TERM
 11380                                        PB-I-LF-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 212
* EL6311.cbl
 11381                                        PB-I-LF-PREMIUM-AMT
 11382                                        PB-I-LF-BENEFIT-CD
 11383                                        PB-I-LF-PREM-CALC
 11384                                        PB-I-LF-CRIT-PER
 11385                                        PB-I-LF-ALT-BENEFIT-AMT
 11386                                        PB-I-LF-ALT-PREMIUM-AMT
 11387               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11388           ELSE
 11389               NEXT SENTENCE
 11390        ELSE
 11391           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11392                                    PI-BTYPE (1).
 11393     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11394        IF BTYPE  (2)   = ZEROS OR SPACES
 11395           IF  REMOVE-AH-COVERAGE
 11396               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11397                                        PI-BTYPE (2)
 11398               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11399                                        WS-B-AH-ISS-PRM-ENTERED
 11400               SUBTRACT PB-I-AH-PREM-CALC FROM
 11401                                        WS-B-AH-ISS-PRM-COMPUTED
 11402               MOVE ZEROS            TO PB-I-AH-TERM
 11403                                        PB-I-AH-BENEFIT-AMT
 11404                                        PB-I-AH-PREMIUM-AMT
 11405                                        PB-I-AH-BENEFIT-CD
 11406                                        PB-I-AH-PREM-CALC
 11407                                        PB-I-AH-CRIT-PER
 11408               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11409           ELSE
 11410               NEXT SENTENCE
 11411        ELSE
 11412           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11413                                    PI-BTYPE (2).
 11414 1360-REWRITE-PB-RECORD.
 11415     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11416
 11417     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11418     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11419
 11420     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11421
 11422     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11423     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11424
 11425     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11426         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11427
 11428     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11429         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11430
 11431     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11432
 11433     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11434
 11435     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11436
 11437     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11438     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 213
* EL6311.cbl
 11439     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11440
 11441     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11442     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11443
 11444 1375-REWRITE-PB-RECORD.
 11445     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11446     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11447     MOVE 'C'                    TO JP-RECORD-TYPE.
 11448     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11449
 11450
 11451* EXEC CICS REWRITE
 11452*        DATASET (FILE-ID-ERPNDB)
 11453*        FROM    (PENDING-BUSINESS)
 11454*    END-EXEC.
 11455     MOVE LENGTH OF
 11456      PENDING-BUSINESS
 11457       TO DFHEIV11
 11458*    MOVE '&& L                  %   #00011047' TO DFHEIV0
 11459     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11460     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11461     MOVE X'2020233030303131303437' TO DFHEIV0(25:11)
 11462     CALL 'kxdfhei1' USING DFHEIV0,
 11463           FILE-ID-ERPNDB,
 11464           PENDING-BUSINESS,
 11465           DFHEIV11,
 11466           DFHEIV99
 11467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11468
 11469
 11470     PERFORM 8400-LOG-JOURNAL-RECORD.
 11471******************************************************************
 11472*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11473******************************************************************
 11474     display ' made it to update orig cert '
 11475     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11476     MOVE ' '                    TO WS-ERMAIL-SW
 11477
 11478* EXEC CICS READ
 11479*       DATASET   (FILE-ID-ERMAIL)
 11480*       SET       (ADDRESS OF MAILING-DATA)
 11481*       RIDFLD    (ERMAIL-KEY)
 11482*       RESP      (WS-RESPONSE)
 11483*    END-EXEC
 11484*    MOVE '&"S        E          (  N#00011059' TO DFHEIV0
 11485     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11487     MOVE X'204E233030303131303539' TO DFHEIV0(25:11)
 11488     CALL 'kxdfhei1' USING DFHEIV0,
 11489           FILE-ID-ERMAIL,
 11490           DFHEIV20,
 11491           DFHEIV99,
 11492           ERMAIL-KEY,
 11493           DFHEIV99,
 11494           DFHEIV99,
 11495           DFHEIV99
 11496     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 214
* EL6311.cbl
 11497         DFHEIV20
 11498     MOVE EIBRESP  TO WS-RESPONSE
 11499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11500     IF RESP-NORMAL
 11501        SET ERMAIL-FOUND TO TRUE
 11502     END-IF
 11503
 11504     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11505     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11506                                 TO ELCRTO-KEY
 11507     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11508     MOVE +0                     TO ELCRTO-SEQ-NO
 11509
 11510* EXEC CICS READ
 11511*       DATASET   ('ELCRTO')
 11512*       INTO      (ORIGINAL-CERTIFICATE)
 11513*       RIDFLD    (ELCRTO-KEY)
 11514*       GTEQ
 11515*       RESP      (WS-RESPONSE)
 11516*    END-EXEC
 11517     MOVE LENGTH OF
 11518      ORIGINAL-CERTIFICATE
 11519       TO DFHEIV11
 11520     MOVE 'ELCRTO' TO DFHEIV1
 11521*    MOVE '&"IL       G          (  N#00011074' TO DFHEIV0
 11522     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11523     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11524     MOVE X'204E233030303131303734' TO DFHEIV0(25:11)
 11525     CALL 'kxdfhei1' USING DFHEIV0,
 11526           DFHEIV1,
 11527           ORIGINAL-CERTIFICATE,
 11528           DFHEIV11,
 11529           ELCRTO-KEY,
 11530           DFHEIV99,
 11531           DFHEIV99,
 11532           DFHEIV99
 11533     MOVE EIBRESP  TO WS-RESPONSE
 11534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11535     display ' just read gteq ' ws-response
 11536     IF RESP-NORMAL
 11537        AND (OC-CONTROL-PRIMARY (1:33) =
 11538                 PB-CONTROL-BY-ACCOUNT (1:33))
 11539        AND (OC-RECORD-TYPE = 'I')
 11540        display ' resp norm, key =, type i '
 11541        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11542           display ' end proc blank '
 11543           display ' csr edit session ' PI-CSR-SESSION-SW
 11544           IF NOT CSR-EDIT-SESSION
 11545
 11546* EXEC CICS READ
 11547*                DATASET   ('ELCRTO')
 11548*                INTO      (ORIGINAL-CERTIFICATE)
 11549*                RIDFLD    (OC-CONTROL-PRIMARY)
 11550*                UPDATE
 11551*                RESP      (WS-RESPONSE)
 11552*             END-EXEC
 11553     MOVE LENGTH OF
 11554      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 215
* EL6311.cbl
 11555       TO DFHEIV11
 11556     MOVE 'ELCRTO' TO DFHEIV1
 11557*    MOVE '&"IL       EU         (  N#00011091' TO DFHEIV0
 11558     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11559     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11560     MOVE X'204E233030303131303931' TO DFHEIV0(25:11)
 11561     CALL 'kxdfhei1' USING DFHEIV0,
 11562           DFHEIV1,
 11563           ORIGINAL-CERTIFICATE,
 11564           DFHEIV11,
 11565           OC-CONTROL-PRIMARY,
 11566           DFHEIV99,
 11567           DFHEIV99,
 11568           DFHEIV99
 11569     MOVE EIBRESP  TO WS-RESPONSE
 11570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11571              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11572              IF RESP-NORMAL
 11573                 display ' good read upd '
 11574                 MOVE PB-I-INSURED-LAST-NAME TO
 11575                         OC-INS-LAST-NAME
 11576                 MOVE PB-I-INSURED-FIRST-NAME TO
 11577                         OC-INS-FIRST-NAME
 11578                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11579                         OC-INS-MIDDLE-INIT
 11580                 MOVE PB-I-AGE         TO OC-INS-AGE
 11581                 MOVE PB-I-JOINT-LAST-NAME   TO
 11582                         OC-JNT-LAST-NAME
 11583                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11584                         OC-JNT-FIRST-NAME
 11585                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11586                         OC-JNT-MIDDLE-INIT
 11587                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11588                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11589                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11590                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11591                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11592                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11593                         OC-LF-ALT-BEN-AMT
 11594                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11595                         OC-LF-ALT-PRM-AMT
 11596                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11597                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11598                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11599                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11600                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11601                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11602                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11603                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11604                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11605                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11606                 IF OC-CANCEL-TRAN-IND = 'N'
 11607                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11608                    MOVE +0            TO OC-LF-CANCEL-AMT
 11609                                          OC-LF-ITD-CANCEL-AMT
 11610                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11611                    MOVE +0            TO OC-AH-CANCEL-AMT
 11612                                          OC-AH-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 216
* EL6311.cbl
 11613                 END-IF
 11614                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11615                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11616                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11617                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11618                 IF ERMAIL-FOUND
 11619                    MOVE MA-CRED-BENE-NAME
 11620                                 TO OC-CRED-BENE-NAME
 11621                 END-IF
 11622                 IF NOT CERT-TRL-REC-NOT-FOUND
 11623                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11624                           OC-INS-AGE-DEFAULT-FLAG
 11625                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11626                           OC-JNT-AGE-DEFAULT-FLAG
 11627                 END-IF
 11628
 11629* EXEC CICS REWRITE
 11630*                   DATASET   ('ELCRTO')
 11631*                   FROM      (ORIGINAL-CERTIFICATE)
 11632*                   RESP      (WS-RESPONSE)
 11633*                END-EXEC
 11634     MOVE LENGTH OF
 11635      ORIGINAL-CERTIFICATE
 11636       TO DFHEIV11
 11637     MOVE 'ELCRTO' TO DFHEIV1
 11638*    MOVE '&& L                  %  N#00011155' TO DFHEIV0
 11639     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11640     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11641     MOVE X'204E233030303131313535' TO DFHEIV0(25:11)
 11642     CALL 'kxdfhei1' USING DFHEIV0,
 11643           DFHEIV1,
 11644           ORIGINAL-CERTIFICATE,
 11645           DFHEIV11,
 11646           DFHEIV99
 11647     MOVE EIBRESP  TO WS-RESPONSE
 11648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11649                 display ' just rewrote ' ws-response
 11650              END-IF
 11651           END-IF
 11652        ELSE
 11653           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11654           MOVE 'OC'             TO OC-RECORD-ID
 11655           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11656           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11657           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11658           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11659           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11660           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11661           MOVE PB-I-AGE         TO OC-INS-AGE
 11662           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11663           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11664           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11665           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11666           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11667           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11668           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11669           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11670           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 217
* EL6311.cbl
 11671           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11672           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11673           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11674           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11675           MOVE +0               TO OC-LF-CANCEL-AMT
 11676                                    OC-LF-ITD-CANCEL-AMT
 11677           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11678           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11679           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11680           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11681           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11682           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11683           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11684           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11685           MOVE +0               TO OC-AH-CANCEL-AMT
 11686                                    OC-AH-ITD-CANCEL-AMT
 11687           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11688           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11689           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11690           IF ERMAIL-FOUND
 11691              MOVE MA-CRED-BENE-NAME
 11692                                 TO OC-CRED-BENE-NAME
 11693           END-IF
 11694           IF NOT CERT-TRL-REC-NOT-FOUND
 11695              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11696                           OC-INS-AGE-DEFAULT-FLAG
 11697              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11698                           OC-JNT-AGE-DEFAULT-FLAG
 11699           END-IF
 11700           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11701
 11702* EXEC CICS WRITE
 11703*             DATASET   ('ELCRTO')
 11704*             FROM      (ORIGINAL-CERTIFICATE)
 11705*             RIDFLD    (OC-CONTROL-PRIMARY)
 11706*             RESP      (WS-RESPONSE)
 11707*          END-EXEC
 11708     MOVE LENGTH OF
 11709      ORIGINAL-CERTIFICATE
 11710       TO DFHEIV11
 11711     MOVE 'ELCRTO' TO DFHEIV1
 11712*    MOVE '&$ L                  ''  N#00011212' TO DFHEIV0
 11713     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11714     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11715     MOVE X'204E233030303131323132' TO DFHEIV0(25:11)
 11716     CALL 'kxdfhei1' USING DFHEIV0,
 11717           DFHEIV1,
 11718           ORIGINAL-CERTIFICATE,
 11719           DFHEIV11,
 11720           OC-CONTROL-PRIMARY,
 11721           DFHEIV99,
 11722           DFHEIV99
 11723     MOVE EIBRESP  TO WS-RESPONSE
 11724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11725        END-IF
 11726     ELSE
 11727        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11728        MOVE 'OC'                TO OC-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 218
* EL6311.cbl
 11729        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11730                                 TO OC-CONTROL-PRIMARY (1:33)
 11731        MOVE 'I'                 TO OC-RECORD-TYPE
 11732        MOVE +4096               TO OC-KEY-SEQ-NO
 11733        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11734        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11735        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11736        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11737        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11738        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11739        MOVE PB-I-AGE            TO OC-INS-AGE
 11740        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11741        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11742        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11743        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11744        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11745        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11746        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11747        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11748        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11749        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11750        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11751        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11752        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11753        MOVE +0                  TO OC-LF-CANCEL-AMT
 11754                                    OC-LF-ITD-CANCEL-AMT
 11755        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11756        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11757        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11758        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11759        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11760        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11761        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11762        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11763        MOVE +0                  TO OC-AH-CANCEL-AMT
 11764                                    OC-AH-ITD-CANCEL-AMT
 11765        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11766        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11767        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11768        IF ERMAIL-FOUND
 11769           MOVE MA-CRED-BENE-NAME
 11770                                 TO OC-CRED-BENE-NAME
 11771        END-IF
 11772        IF NOT CERT-TRL-REC-NOT-FOUND
 11773           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11774                           OC-INS-AGE-DEFAULT-FLAG
 11775           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11776                           OC-JNT-AGE-DEFAULT-FLAG
 11777        END-IF
 11778        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11779
 11780* EXEC CICS WRITE
 11781*          DATASET   ('ELCRTO')
 11782*          FROM      (ORIGINAL-CERTIFICATE)
 11783*          RIDFLD    (OC-CONTROL-PRIMARY)
 11784*          RESP      (WS-RESPONSE)
 11785*       END-EXEC
 11786     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 219
* EL6311.cbl
 11787      ORIGINAL-CERTIFICATE
 11788       TO DFHEIV11
 11789     MOVE 'ELCRTO' TO DFHEIV1
 11790*    MOVE '&$ L                  ''  N#00011272' TO DFHEIV0
 11791     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11792     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11793     MOVE X'204E233030303131323732' TO DFHEIV0(25:11)
 11794     CALL 'kxdfhei1' USING DFHEIV0,
 11795           DFHEIV1,
 11796           ORIGINAL-CERTIFICATE,
 11797           DFHEIV11,
 11798           OC-CONTROL-PRIMARY,
 11799           DFHEIV99,
 11800           DFHEIV99
 11801     MOVE EIBRESP  TO WS-RESPONSE
 11802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11803     END-IF
 11804******************************************************************
 11805*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11806******************************************************************
 11807
 11808     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11809     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11810
 11811
 11812* EXEC CICS READ
 11813*        INTO    (PENDING-BUSINESS)
 11814*        DATASET (FILE-ID-ERPNDB)
 11815*        RIDFLD  (ERPNDB-KEY)
 11816*        UPDATE
 11817*    END-EXEC.
 11818     MOVE LENGTH OF
 11819      PENDING-BUSINESS
 11820       TO DFHEIV11
 11821*    MOVE '&"IL       EU         (   #00011286' TO DFHEIV0
 11822     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11823     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11824     MOVE X'2020233030303131323836' TO DFHEIV0(25:11)
 11825     CALL 'kxdfhei1' USING DFHEIV0,
 11826           FILE-ID-ERPNDB,
 11827           PENDING-BUSINESS,
 11828           DFHEIV11,
 11829           ERPNDB-KEY,
 11830           DFHEIV99,
 11831           DFHEIV99,
 11832           DFHEIV99
 11833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11834
 11835
 11836     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11837     MOVE 'B'                    TO JP-RECORD-TYPE.
 11838     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11839
 11840     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11841
 11842     PERFORM 8400-LOG-JOURNAL-RECORD.
 11843
 11844     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 220
* EL6311.cbl
 11845
 11846     MOVE 'C'                    TO JP-RECORD-TYPE.
 11847     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11848
 11849
 11850* EXEC CICS REWRITE
 11851*        DATASET    (FILE-ID-ERPNDB)
 11852*        FROM       (PENDING-BUSINESS)
 11853*    END-EXEC.
 11854     MOVE LENGTH OF
 11855      PENDING-BUSINESS
 11856       TO DFHEIV11
 11857*    MOVE '&& L                  %   #00011306' TO DFHEIV0
 11858     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11859     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11860     MOVE X'2020233030303131333036' TO DFHEIV0(25:11)
 11861     CALL 'kxdfhei1' USING DFHEIV0,
 11862           FILE-ID-ERPNDB,
 11863           PENDING-BUSINESS,
 11864           DFHEIV11,
 11865           DFHEIV99
 11866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11867
 11868
 11869     PERFORM 8400-LOG-JOURNAL-RECORD.
 11870
 11871     IF WS-ERRORS-PRESENT
 11872        GO TO 3900-RE-DISPLAY-RECORD.
 11873
 11874     MOVE ZEROS                  TO EMI-ERROR.
 11875     MOVE -1                     TO BMAINTL.
 11876     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11877     GO TO 3900-RE-DISPLAY-RECORD.
 11878
 11879 1380-BATCH-HDR-NOT-FOUND.
 11880     MOVE -1                     TO BMAINTL.
 11881     MOVE ER-7450                TO EMI-ERROR.
 11882     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11883     GO TO 8200-SEND-DATAONLY.
 11884
 11885 1385-REC-NOT-FOUND.
 11886     MOVE -1                     TO BMAINTL.
 11887     MOVE ER-7451                TO EMI-ERROR.
 11888     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11889     GO TO 8200-SEND-DATAONLY.
 11890
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 221
* EL6311.cbl
 11892
 11893 1386-UPDATE-AGE-FLAGS.
 11894
 11895
 11896* EXEC CICS GETMAIN
 11897*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11898*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11899*        INITIMG (GETMAIN-SPACE)
 11900*    END-EXEC
 11901*    MOVE ',"IL                  $   #00011337' TO DFHEIV0
 11902     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11903     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11904     MOVE X'2020233030303131333337' TO DFHEIV0(25:11)
 11905     CALL 'kxdfhei1' USING DFHEIV0,
 11906           DFHEIV20,
 11907           ELCRTT-RECORD-LENGTH,
 11908           GETMAIN-SPACE
 11909     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11910         DFHEIV20
 11911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11912
 11913
 11914* EXEC CICS HANDLE CONDITION
 11915*        NOTFND   (1386-NOTFND)
 11916*    END-EXEC.
 11917*    MOVE '"$I                   ! ( #00011343' TO DFHEIV0
 11918     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11920     MOVE X'2820233030303131333433' TO DFHEIV0(25:11)
 11921     CALL 'kxdfhei1' USING DFHEIV0
 11922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11923
 11924
 11925     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 11926     MOVE 'C'                TO ELCRTT-REC-TYPE
 11927
 11928
 11929* EXEC CICS READ
 11930*        UPDATE
 11931*        DATASET  (CRTT-ID)
 11932*        RIDFLD   (ELCRTT-KEY)
 11933*        INTO     (CERTIFICATE-TRAILERS)
 11934*    END-EXEC.
 11935     MOVE LENGTH OF
 11936      CERTIFICATE-TRAILERS
 11937       TO DFHEIV11
 11938*    MOVE '&"IL       EU         (   #00011350' TO DFHEIV0
 11939     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11940     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11941     MOVE X'2020233030303131333530' TO DFHEIV0(25:11)
 11942     CALL 'kxdfhei1' USING DFHEIV0,
 11943           CRTT-ID,
 11944           CERTIFICATE-TRAILERS,
 11945           DFHEIV11,
 11946           ELCRTT-KEY,
 11947           DFHEIV99,
 11948           DFHEIV99,
 11949           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 222
* EL6311.cbl
 11950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11951
 11952
 11953     IF WS-INS-AGE-SET = 'Y'
 11954        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 11955     END-IF
 11956     IF WS-JNT-AGE-SET = 'Y'
 11957        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 11958     END-IF
 11959
 11960
 11961* EXEC CICS REWRITE
 11962*       DATASET  (CRTT-ID)
 11963*       FROM     (CERTIFICATE-TRAILERS)
 11964*    END-EXEC.
 11965     MOVE LENGTH OF
 11966      CERTIFICATE-TRAILERS
 11967       TO DFHEIV11
 11968*    MOVE '&& L                  %   #00011364' TO DFHEIV0
 11969     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11970     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11971     MOVE X'2020233030303131333634' TO DFHEIV0(25:11)
 11972     CALL 'kxdfhei1' USING DFHEIV0,
 11973           CRTT-ID,
 11974           CERTIFICATE-TRAILERS,
 11975           DFHEIV11,
 11976           DFHEIV99
 11977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11978
 11979
 11980     GO TO 1386-EXIT.
 11981
 11982 1386-NOTFND.
 11983
 11984     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 11985     MOVE 'CS'         TO CS-RECORD-ID.
 11986     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 11987     MOVE 'C'          TO ELCRTT-REC-TYPE.
 11988     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 11989     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 11990     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 11991
 11992* EXEC CICS WRITE
 11993*       DATASET  (CRTT-ID)
 11994*       RIDFLD   (ELCRTT-KEY)
 11995*       FROM     (CERTIFICATE-TRAILERS)
 11996*    END-EXEC.
 11997     MOVE LENGTH OF
 11998      CERTIFICATE-TRAILERS
 11999       TO DFHEIV11
 12000*    MOVE '&$ L                  ''   #00011380' TO DFHEIV0
 12001     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12002     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12003     MOVE X'2020233030303131333830' TO DFHEIV0(25:11)
 12004     CALL 'kxdfhei1' USING DFHEIV0,
 12005           CRTT-ID,
 12006           CERTIFICATE-TRAILERS,
 12007           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 223
* EL6311.cbl
 12008           ELCRTT-KEY,
 12009           DFHEIV99,
 12010           DFHEIV99
 12011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12012
 12013
 12014 1386-EXIT.
 12015     EXIT.
 12016
 12017 1390-UPDATE-ERPNDM.
 12018
 12019
 12020* EXEC CICS HANDLE CONDITION
 12021*        NOTFND (1399-EXIT)
 12022*    END-EXEC.
 12023*    MOVE '"$I                   ! ) #00011391' TO DFHEIV0
 12024     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12025     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12026     MOVE X'2920233030303131333931' TO DFHEIV0(25:11)
 12027     CALL 'kxdfhei1' USING DFHEIV0
 12028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12029
 12030
 12031     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12032
 12033
 12034* EXEC CICS READ
 12035*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12036*        DATASET (FILE-ID-ERPNDM)
 12037*        RIDFLD  (ERPNDM-KEY)
 12038*        UPDATE
 12039*    END-EXEC.
 12040*    MOVE '&"S        EU         (   #00011397' TO DFHEIV0
 12041     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12042     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12043     MOVE X'2020233030303131333937' TO DFHEIV0(25:11)
 12044     CALL 'kxdfhei1' USING DFHEIV0,
 12045           FILE-ID-ERPNDM,
 12046           DFHEIV20,
 12047           DFHEIV99,
 12048           ERPNDM-KEY,
 12049           DFHEIV99,
 12050           DFHEIV99,
 12051           DFHEIV99
 12052     SET ADDRESS OF PENDING-MAILING-DATA TO
 12053         DFHEIV20
 12054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12055
 12056
 12057     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12058     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12059     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12060
 12061     IF BLSTNML GREATER THAN ZEROS
 12062         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12063
 12064     IF B1STNML GREATER  THAN ZEROS
 12065         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 224
* EL6311.cbl
 12066
 12067     IF BINITL GREATER THAN ZEROS
 12068         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12069
 12070     IF BAGEL GREATER THAN ZEROS
 12071         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12072
 12073     IF BBIRTHL GREATER THAN ZEROS
 12074         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12075
 12076     IF BSEXL GREATER THAN ZEROS
 12077         MOVE  BSEXI             TO PM-INSURED-SEX.
 12078
 12079
 12080* EXEC CICS REWRITE
 12081*        DATASET (FILE-ID-ERPNDM)
 12082*        FROM    (PENDING-MAILING-DATA)
 12083*    END-EXEC.
 12084     MOVE LENGTH OF
 12085      PENDING-MAILING-DATA
 12086       TO DFHEIV11
 12087*    MOVE '&& L                  %   #00011426' TO DFHEIV0
 12088     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12089     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12090     MOVE X'2020233030303131343236' TO DFHEIV0(25:11)
 12091     CALL 'kxdfhei1' USING DFHEIV0,
 12092           FILE-ID-ERPNDM,
 12093           PENDING-MAILING-DATA,
 12094           DFHEIV11,
 12095           DFHEIV99
 12096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12097
 12098
 12099 1399-EXIT.
 12100     EXIT.
 12101
 12102******************************************************************
 12103*                                                                *
 12104*          D E L E T E   I S S U E   R O U T I N E               *
 12105*                                                                *
 12106******************************************************************
 12107
 12108 1400-DELETE-ISSUE-ROUTINE.
 12109     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12110
 12111     IF BCHGL NOT = ZEROS
 12112        MOVE ER-2196             TO EMI-ERROR
 12113        MOVE AL-UABON            TO BMAINTA
 12114        MOVE -1                  TO BMAINTL
 12115        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12116        GO TO 8200-SEND-DATAONLY.
 12117
 12118
 12119* EXEC CICS HANDLE CONDITION
 12120*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12121*    END-EXEC.
 12122*    MOVE '"$I                   ! * #00011450' TO DFHEIV0
 12123     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 225
* EL6311.cbl
 12124     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12125     MOVE X'2A20233030303131343530' TO DFHEIV0(25:11)
 12126     CALL 'kxdfhei1' USING DFHEIV0
 12127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12128
 12129
 12130     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12131     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12132     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12133
 12134
 12135* EXEC CICS READ
 12136*        SET     (ADDRESS OF PENDING-BUSINESS)
 12137*        DATASET (FILE-ID-ERPNDB)
 12138*        RIDFLD  (ERPNDB-KEY)
 12139*    END-EXEC.
 12140*    MOVE '&"S        E          (   #00011458' TO DFHEIV0
 12141     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12142     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12143     MOVE X'2020233030303131343538' TO DFHEIV0(25:11)
 12144     CALL 'kxdfhei1' USING DFHEIV0,
 12145           FILE-ID-ERPNDB,
 12146           DFHEIV20,
 12147           DFHEIV99,
 12148           ERPNDB-KEY,
 12149           DFHEIV99,
 12150           DFHEIV99,
 12151           DFHEIV99
 12152     SET ADDRESS OF PENDING-BUSINESS TO
 12153         DFHEIV20
 12154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12155
 12156
 12157     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12158
 12159     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12160
 12161     IF BSUFIXL NOT = ZEROS
 12162        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12163     ELSE
 12164        MOVE SPACE               TO WS-NEW-SUFFIX.
 12165
 12166     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12167     PERFORM 8600-DEEDIT.
 12168     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12169     MOVE '4'                    TO DC-OPTION-CODE.
 12170     PERFORM 9700-DATE-LINK.
 12171     IF DATE-CONVERSION-ERROR
 12172        MOVE ER-0348             TO EMI-ERROR
 12173        MOVE -1                  TO BEFFDTL
 12174        MOVE AL-UABON            TO BEFFDTA
 12175        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12176        GO TO 8200-SEND-DATAONLY
 12177     ELSE
 12178        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12179        MOVE AL-UANON            TO BEFFDTA
 12180        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12181
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 226
* EL6311.cbl
 12182
 12183* EXEC CICS HANDLE CONDITION
 12184*         NOTFND    (1490-RECORD-NOT-FOUND)
 12185*    END-EXEC.
 12186*    MOVE '"$I                   ! + #00011489' TO DFHEIV0
 12187     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12189     MOVE X'2B20233030303131343839' TO DFHEIV0(25:11)
 12190     CALL 'kxdfhei1' USING DFHEIV0
 12191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12192
 12193
 12194
 12195* EXEC CICS READ
 12196*        SET     (ADDRESS OF PENDING-BUSINESS)
 12197*        DATASET (FILE-ID-ERPNDB)
 12198*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12199*        UPDATE
 12200*    END-EXEC.
 12201*    MOVE '&"S        EU         (   #00011493' TO DFHEIV0
 12202     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12203     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12204     MOVE X'2020233030303131343933' TO DFHEIV0(25:11)
 12205     CALL 'kxdfhei1' USING DFHEIV0,
 12206           FILE-ID-ERPNDB,
 12207           DFHEIV20,
 12208           DFHEIV99,
 12209           PI-PREV-CONTROL-PRIMARY,
 12210           DFHEIV99,
 12211           DFHEIV99,
 12212           DFHEIV99
 12213     SET ADDRESS OF PENDING-BUSINESS TO
 12214         DFHEIV20
 12215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12216
 12217
 12218     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12219        MOVE -1                 TO BMAINTL
 12220        MOVE ER-2197            TO EMI-ERROR
 12221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12222        GO TO 8200-SEND-DATAONLY.
 12223
 12224     IF PB-BILLED-DT NOT = LOW-VALUES
 12225        MOVE -1                 TO BMAINTL
 12226        MOVE ER-2129            TO EMI-ERROR
 12227        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12228        GO TO 8200-SEND-DATAONLY.
 12229
 12230     IF PB-CHG-COUNT NOT = ZEROS
 12231        MOVE ER-2336            TO EMI-ERROR
 12232        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12233        MOVE AL-UABON            TO BMAINTA
 12234        MOVE -1                  TO BMAINTL
 12235        GO TO 8200-SEND-DATAONLY.
 12236
 12237     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12238        PB-CHG-COUNT NOT = ZEROS
 12239        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 227
* EL6311.cbl
 12240        MOVE AL-UABON            TO BMAINTA
 12241        MOVE -1                  TO BMAINTL
 12242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12243        GO TO 8200-SEND-DATAONLY.
 12244******************************************************************
 12245*                                                                *
 12246*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12247*                                                                *
 12248******************************************************************
 12249     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12250     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12251     MOVE +0                     TO ELCRTO-SEQ-NO
 12252
 12253* EXEC CICS READ
 12254*       DATASET   ('ELCRTO')
 12255*       INTO      (ORIGINAL-CERTIFICATE)
 12256*       RIDFLD    (ELCRTO-KEY)
 12257*       GTEQ
 12258*       RESP      (WS-RESPONSE)
 12259*    END-EXEC
 12260     MOVE LENGTH OF
 12261      ORIGINAL-CERTIFICATE
 12262       TO DFHEIV11
 12263     MOVE 'ELCRTO' TO DFHEIV1
 12264*    MOVE '&"IL       G          (  N#00011534' TO DFHEIV0
 12265     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12267     MOVE X'204E233030303131353334' TO DFHEIV0(25:11)
 12268     CALL 'kxdfhei1' USING DFHEIV0,
 12269           DFHEIV1,
 12270           ORIGINAL-CERTIFICATE,
 12271           DFHEIV11,
 12272           ELCRTO-KEY,
 12273           DFHEIV99,
 12274           DFHEIV99,
 12275           DFHEIV99
 12276     MOVE EIBRESP  TO WS-RESPONSE
 12277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12278     IF RESP-NORMAL
 12279        AND (OC-CONTROL-PRIMARY (1:33) =
 12280                 PB-CONTROL-BY-ACCOUNT (1:33))
 12281        AND (OC-RECORD-TYPE = 'I')
 12282
 12283* EXEC CICS READ
 12284*          DATASET   ('ELCRTO')
 12285*          INTO      (ORIGINAL-CERTIFICATE)
 12286*          RIDFLD    (ELCRTO-KEY)
 12287*          UPDATE
 12288*          RESP      (WS-RESPONSE)
 12289*       END-EXEC
 12290     MOVE LENGTH OF
 12291      ORIGINAL-CERTIFICATE
 12292       TO DFHEIV11
 12293     MOVE 'ELCRTO' TO DFHEIV1
 12294*    MOVE '&"IL       EU         (  N#00011545' TO DFHEIV0
 12295     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12296     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12297     MOVE X'204E233030303131353435' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 228
* EL6311.cbl
 12298     CALL 'kxdfhei1' USING DFHEIV0,
 12299           DFHEIV1,
 12300           ORIGINAL-CERTIFICATE,
 12301           DFHEIV11,
 12302           ELCRTO-KEY,
 12303           DFHEIV99,
 12304           DFHEIV99,
 12305           DFHEIV99
 12306     MOVE EIBRESP  TO WS-RESPONSE
 12307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12308        IF RESP-NORMAL
 12309
 12310* EXEC CICS DELETE
 12311*             DATASET   ('ELCRTO')
 12312*          END-EXEC
 12313     MOVE 'ELCRTO' TO DFHEIV1
 12314*    MOVE '&(                    &   #00011553' TO DFHEIV0
 12315     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12316     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12317     MOVE X'2020233030303131353533' TO DFHEIV0(25:11)
 12318     CALL 'kxdfhei1' USING DFHEIV0,
 12319           DFHEIV1,
 12320           DFHEIV99,
 12321           DFHEIV99,
 12322           DFHEIV99,
 12323           DFHEIV99
 12324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12325        END-IF
 12326     END-IF
 12327******************************************************************
 12328*                                                                *
 12329*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12330*                                                                *
 12331******************************************************************
 12332
 12333* EXEC CICS HANDLE CONDITION
 12334*        NOTFND    (1405-DELETE-CERTIFICATE)
 12335*    END-EXEC.
 12336*    MOVE '"$I                   ! , #00011563' TO DFHEIV0
 12337     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12339     MOVE X'2C20233030303131353633' TO DFHEIV0(25:11)
 12340     CALL 'kxdfhei1' USING DFHEIV0
 12341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12342
 12343
 12344
 12345* EXEC CICS READ
 12346*        EQUAL
 12347*        DATASET   (FILE-ID-ERPNDM)
 12348*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12349*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12350*        UPDATE
 12351*    END-EXEC.
 12352*    MOVE '&"S        EU         (   #00011567' TO DFHEIV0
 12353     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12354     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12355     MOVE X'2020233030303131353637' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 229
* EL6311.cbl
 12356     CALL 'kxdfhei1' USING DFHEIV0,
 12357           FILE-ID-ERPNDM,
 12358           DFHEIV20,
 12359           DFHEIV99,
 12360           PI-PREV-CONTROL-PRIMARY,
 12361           DFHEIV99,
 12362           DFHEIV99,
 12363           DFHEIV99
 12364     SET ADDRESS OF PENDING-MAILING-DATA TO
 12365         DFHEIV20
 12366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12367
 12368
 12369     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12370     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12371     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12372
 12373     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12374
 12375
 12376* EXEC CICS DELETE
 12377*        DATASET   (FILE-ID-ERPNDM)
 12378*    END-EXEC.
 12379*    MOVE '&(                    &   #00011581' TO DFHEIV0
 12380     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12381     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12382     MOVE X'2020233030303131353831' TO DFHEIV0(25:11)
 12383     CALL 'kxdfhei1' USING DFHEIV0,
 12384           FILE-ID-ERPNDM,
 12385           DFHEIV99,
 12386           DFHEIV99,
 12387           DFHEIV99,
 12388           DFHEIV99
 12389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12390
 12391
 12392******************************************************************
 12393*                PROCESS   CERTIFICATE                           *
 12394******************************************************************
 12395
 12396 1405-DELETE-CERTIFICATE.
 12397
 12398* EXEC CICS HANDLE CONDITION
 12399*         NOTFND  (1420-CONTINUE-DELETE)
 12400*    END-EXEC.
 12401*    MOVE '"$I                   ! - #00011590' TO DFHEIV0
 12402     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12404     MOVE X'2D20233030303131353930' TO DFHEIV0(25:11)
 12405     CALL 'kxdfhei1' USING DFHEIV0
 12406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12407
 12408
 12409     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12410     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12411     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12412     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12413
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 230
* EL6311.cbl
 12414
 12415* EXEC CICS READ
 12416*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12417*        DATASET (FILE-ID-ELCERT)
 12418*        RIDFLD  (ELCERT-KEY)
 12419*        UPDATE
 12420*    END-EXEC.
 12421*    MOVE '&"S        EU         (   #00011599' TO DFHEIV0
 12422     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12423     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12424     MOVE X'2020233030303131353939' TO DFHEIV0(25:11)
 12425     CALL 'kxdfhei1' USING DFHEIV0,
 12426           FILE-ID-ELCERT,
 12427           DFHEIV20,
 12428           DFHEIV99,
 12429           ELCERT-KEY,
 12430           DFHEIV99,
 12431           DFHEIV99,
 12432           DFHEIV99
 12433     SET ADDRESS OF CERTIFICATE-MASTER TO
 12434         DFHEIV20
 12435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12436
 12437
 12438     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12439
 12440     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12441     MOVE 'B'                    TO JP-RECORD-TYPE
 12442     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12443
 12444     PERFORM 8400-LOG-JOURNAL-RECORD.
 12445
 12446     IF CERT-NOTES-ARE-NOT-PRESENT
 12447        MOVE ' '                 TO WS-CERT-NOTE-SW
 12448     ELSE
 12449        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12450
 12451     IF INSURED-ADDR-PRESENT
 12452        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12453
 12454******************************************************************
 12455******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12456******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12457******************************************************************
 12458******************************************************************
 12459
 12460     IF CERT-ADDED-BATCH AND
 12461        (NOT NO-CLAIM-ATTACHED
 12462         OR
 12463         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12464        GO TO 1410-REWRITE-CERT.
 12465
 12466******************************************************************
 12467******************************************************************
 12468
 12469     IF CERT-ADDED-BATCH  AND
 12470        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12471        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 231
* EL6311.cbl
 12472
 12473     IF NO-CLAIM-ATTACHED
 12474        NEXT SENTENCE
 12475     ELSE
 12476        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12477        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12478        GO TO 1410-REWRITE-CERT.
 12479
 12480     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12481     MOVE 'D'                      TO JP-RECORD-TYPE.
 12482     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12483
 12484
 12485* EXEC CICS DELETE
 12486*         DATASET    (FILE-ID-ELCERT)
 12487*    END-EXEC.
 12488*    MOVE '&(                    &   #00011652' TO DFHEIV0
 12489     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12490     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12491     MOVE X'2020233030303131363532' TO DFHEIV0(25:11)
 12492     CALL 'kxdfhei1' USING DFHEIV0,
 12493           FILE-ID-ELCERT,
 12494           DFHEIV99,
 12495           DFHEIV99,
 12496           DFHEIV99,
 12497           DFHEIV99
 12498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12499
 12500
 12501     PERFORM 8400-LOG-JOURNAL-RECORD.
 12502
 12503******************************************************************
 12504*                                                                *
 12505*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12506*                                                                *
 12507******************************************************************
 12508
 12509     IF  CERT-NOTES-ARE-PRESENT
 12510         NEXT SENTENCE
 12511     ELSE
 12512         GO TO 1407-DELETE-MAILING.
 12513
 12514
 12515* EXEC CICS HANDLE CONDITION
 12516*         NOTFND  (1406-DELETE-ERNOTE)
 12517*    END-EXEC.
 12518*    MOVE '"$I                   ! . #00011669' TO DFHEIV0
 12519     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12520     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12521     MOVE X'2E20233030303131363639' TO DFHEIV0(25:11)
 12522     CALL 'kxdfhei1' USING DFHEIV0
 12523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12524
 12525
 12526     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12527     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12528     MOVE 0                     TO ERCNOT-SEQUENCE.
 12529
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 232
* EL6311.cbl
 12530 1406-DELETE-ERCNOT-LOOP.
 12531
 12532
 12533* EXEC CICS READ
 12534*        GTEQ
 12535*        DATASET   (FILE-ID-ERCNOT)
 12536*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12537*        RIDFLD    (ERCNOT-KEY)
 12538*    END-EXEC.
 12539*    MOVE '&"S        G          (   #00011679' TO DFHEIV0
 12540     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12541     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12542     MOVE X'2020233030303131363739' TO DFHEIV0(25:11)
 12543     CALL 'kxdfhei1' USING DFHEIV0,
 12544           FILE-ID-ERCNOT,
 12545           DFHEIV20,
 12546           DFHEIV99,
 12547           ERCNOT-KEY,
 12548           DFHEIV99,
 12549           DFHEIV99,
 12550           DFHEIV99
 12551     SET ADDRESS OF CERT-NOTE-FILE TO
 12552         DFHEIV20
 12553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12554
 12555
 12556     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12557     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12558         GO TO 1406-DELETE-ERNOTE
 12559     END-IF.
 12560
 12561     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12562     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12563     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12564
 12565     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12566
 12567
 12568* EXEC CICS DELETE
 12569*        DATASET   (FILE-ID-ERCNOT)
 12570*        RIDFLD    (ERCNOT-KEY)
 12571*        END-EXEC.
 12572*    MOVE '&(  R                 &   #00011697' TO DFHEIV0
 12573     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12574     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12575     MOVE X'2020233030303131363937' TO DFHEIV0(25:11)
 12576     CALL 'kxdfhei1' USING DFHEIV0,
 12577           FILE-ID-ERCNOT,
 12578           ERCNOT-KEY,
 12579           DFHEIV99,
 12580           DFHEIV99,
 12581           DFHEIV99
 12582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12583
 12584
 12585     PERFORM 8400-LOG-JOURNAL-RECORD.
 12586
 12587     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 233
* EL6311.cbl
 12588
 12589 1406-DELETE-ERNOTE.
 12590
 12591
 12592* EXEC CICS HANDLE CONDITION
 12593*         NOTFND  (1407-DELETE-MAILING)
 12594*    END-EXEC.
 12595*    MOVE '"$I                   ! / #00011708' TO DFHEIV0
 12596     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12597     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12598     MOVE X'2F20233030303131373038' TO DFHEIV0(25:11)
 12599     CALL 'kxdfhei1' USING DFHEIV0
 12600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12601
 12602
 12603
 12604* EXEC CICS READ
 12605*        EQUAL
 12606*        DATASET   (FILE-ID-ERNOTE)
 12607*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12608*        RIDFLD    (ELCERT-KEY)
 12609*        UPDATE
 12610*    END-EXEC.
 12611*    MOVE '&"S        EU         (   #00011712' TO DFHEIV0
 12612     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12613     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12614     MOVE X'2020233030303131373132' TO DFHEIV0(25:11)
 12615     CALL 'kxdfhei1' USING DFHEIV0,
 12616           FILE-ID-ERNOTE,
 12617           DFHEIV20,
 12618           DFHEIV99,
 12619           ELCERT-KEY,
 12620           DFHEIV99,
 12621           DFHEIV99,
 12622           DFHEIV99
 12623     SET ADDRESS OF CERTIFICATE-NOTE TO
 12624         DFHEIV20
 12625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12626
 12627
 12628     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12629     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12630     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12631
 12632     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12633
 12634
 12635* EXEC CICS DELETE
 12636*        DATASET   (FILE-ID-ERNOTE)
 12637*        END-EXEC.
 12638*    MOVE '&(                    &   #00011726' TO DFHEIV0
 12639     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12640     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12641     MOVE X'2020233030303131373236' TO DFHEIV0(25:11)
 12642     CALL 'kxdfhei1' USING DFHEIV0,
 12643           FILE-ID-ERNOTE,
 12644           DFHEIV99,
 12645           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 234
* EL6311.cbl
 12646           DFHEIV99,
 12647           DFHEIV99
 12648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12649
 12650
 12651     PERFORM 8400-LOG-JOURNAL-RECORD.
 12652
 12653******************************************************************
 12654*                                                                *
 12655*                DELETE MAILING ADDRESS RECORDS                  *
 12656*                                                                *
 12657******************************************************************
 12658
 12659 1407-DELETE-MAILING.
 12660     IF CERT-ADDRESS-PRESENT
 12661        NEXT SENTENCE
 12662     ELSE
 12663        GO TO 1420-CONTINUE-DELETE.
 12664
 12665
 12666* EXEC CICS HANDLE CONDITION
 12667*         NOTFND  (1420-CONTINUE-DELETE)
 12668*    END-EXEC.
 12669*    MOVE '"$I                   ! 0 #00011744' TO DFHEIV0
 12670     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12672     MOVE X'3020233030303131373434' TO DFHEIV0(25:11)
 12673     CALL 'kxdfhei1' USING DFHEIV0
 12674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12675
 12676
 12677
 12678* EXEC CICS READ
 12679*        EQUAL
 12680*        DATASET   (FILE-ID-ERMAIL)
 12681*        SET       (ADDRESS OF MAILING-DATA)
 12682*        RIDFLD    (ELCERT-KEY)
 12683*        UPDATE
 12684*    END-EXEC.
 12685*    MOVE '&"S        EU         (   #00011748' TO DFHEIV0
 12686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12687     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12688     MOVE X'2020233030303131373438' TO DFHEIV0(25:11)
 12689     CALL 'kxdfhei1' USING DFHEIV0,
 12690           FILE-ID-ERMAIL,
 12691           DFHEIV20,
 12692           DFHEIV99,
 12693           ELCERT-KEY,
 12694           DFHEIV99,
 12695           DFHEIV99,
 12696           DFHEIV99
 12697     SET ADDRESS OF MAILING-DATA TO
 12698         DFHEIV20
 12699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12700
 12701
 12702     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12703     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 235
* EL6311.cbl
 12704     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12705
 12706     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12707
 12708
 12709* EXEC CICS DELETE
 12710*        DATASET   (FILE-ID-ERMAIL)
 12711*    END-EXEC.
 12712*    MOVE '&(                    &   #00011762' TO DFHEIV0
 12713     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12714     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12715     MOVE X'2020233030303131373632' TO DFHEIV0(25:11)
 12716     CALL 'kxdfhei1' USING DFHEIV0,
 12717           FILE-ID-ERMAIL,
 12718           DFHEIV99,
 12719           DFHEIV99,
 12720           DFHEIV99,
 12721           DFHEIV99
 12722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12723
 12724
 12725     GO TO 1420-CONTINUE-DELETE.
 12726
 12727 1410-REWRITE-CERT.
 12728     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12729     MOVE 'C'                      TO JP-RECORD-TYPE.
 12730     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12731     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12732
 12733
 12734* EXEC CICS REWRITE
 12735*         DATASET    (FILE-ID-ELCERT)
 12736*         FROM       (CERTIFICATE-MASTER)
 12737*         END-EXEC.
 12738     MOVE LENGTH OF
 12739      CERTIFICATE-MASTER
 12740       TO DFHEIV11
 12741*    MOVE '&& L                  %   #00011774' TO DFHEIV0
 12742     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12743     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12744     MOVE X'2020233030303131373734' TO DFHEIV0(25:11)
 12745     CALL 'kxdfhei1' USING DFHEIV0,
 12746           FILE-ID-ELCERT,
 12747           CERTIFICATE-MASTER,
 12748           DFHEIV11,
 12749           DFHEIV99
 12750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12751
 12752
 12753     PERFORM 8400-LOG-JOURNAL-RECORD.
 12754
 12755 1420-CONTINUE-DELETE.
 12756     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12757     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12758
 12759     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12760     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12761
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 236
* EL6311.cbl
 12762     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12763
 12764 1450-DELETE-PB-RECORD.
 12765     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12766     MOVE 'D'                      TO JP-RECORD-TYPE
 12767     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12768
 12769
 12770* EXEC CICS DELETE
 12771*        DATASET    (FILE-ID-ERPNDB)
 12772*    END-EXEC.
 12773*    MOVE '&(                    &   #00011795' TO DFHEIV0
 12774     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12775     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12776     MOVE X'2020233030303131373935' TO DFHEIV0(25:11)
 12777     CALL 'kxdfhei1' USING DFHEIV0,
 12778           FILE-ID-ERPNDB,
 12779           DFHEIV99,
 12780           DFHEIV99,
 12781           DFHEIV99,
 12782           DFHEIV99
 12783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12784
 12785
 12786     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12787
 12788     PERFORM 8400-LOG-JOURNAL-RECORD.
 12789
 12790     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12791     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12792     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12793
 12794
 12795* EXEC CICS HANDLE CONDITION
 12796*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12797*    END-EXEC.
 12798*    MOVE '"$I                   ! 1 #00011807' TO DFHEIV0
 12799     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12800     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12801     MOVE X'3120233030303131383037' TO DFHEIV0(25:11)
 12802     CALL 'kxdfhei1' USING DFHEIV0
 12803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12804
 12805
 12806
 12807* EXEC CICS READ
 12808*        SET     (ADDRESS OF PENDING-BUSINESS)
 12809*        DATASET (FILE-ID-ERPNDB)
 12810*        RIDFLD  (ERPNDB-KEY)
 12811*        UPDATE
 12812*    END-EXEC.
 12813*    MOVE '&"S        EU         (   #00011811' TO DFHEIV0
 12814     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12815     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12816     MOVE X'2020233030303131383131' TO DFHEIV0(25:11)
 12817     CALL 'kxdfhei1' USING DFHEIV0,
 12818           FILE-ID-ERPNDB,
 12819           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 237
* EL6311.cbl
 12820           DFHEIV99,
 12821           ERPNDB-KEY,
 12822           DFHEIV99,
 12823           DFHEIV99,
 12824           DFHEIV99
 12825     SET ADDRESS OF PENDING-BUSINESS TO
 12826         DFHEIV20
 12827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12828
 12829
 12830     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12831
 12832     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 12833
 12834     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12835        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12836        MOVE 'D'                   TO JP-RECORD-TYPE
 12837        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 12838
 12839* EXEC CICS DELETE
 12840*            DATASET    (FILE-ID-ERPNDB)
 12841*       END-EXEC
 12842*    MOVE '&(                    &   #00011826' TO DFHEIV0
 12843     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12844     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12845     MOVE X'2020233030303131383236' TO DFHEIV0(25:11)
 12846     CALL 'kxdfhei1' USING DFHEIV0,
 12847           FILE-ID-ERPNDB,
 12848           DFHEIV99,
 12849           DFHEIV99,
 12850           DFHEIV99,
 12851           DFHEIV99
 12852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12853        PERFORM 8400-LOG-JOURNAL-RECORD
 12854     ELSE
 12855        MOVE 'B'                 TO JP-RECORD-TYPE
 12856        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12857        PERFORM 8400-LOG-JOURNAL-RECORD
 12858        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 12859        MOVE 'C'                 TO JP-RECORD-TYPE
 12860        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12861
 12862* EXEC CICS REWRITE
 12863*            DATASET    (FILE-ID-ERPNDB)
 12864*            FROM       (PENDING-BUSINESS)
 12865*       END-EXEC
 12866     MOVE LENGTH OF
 12867      PENDING-BUSINESS
 12868       TO DFHEIV11
 12869*    MOVE '&& L                  %   #00011837' TO DFHEIV0
 12870     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12871     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12872     MOVE X'2020233030303131383337' TO DFHEIV0(25:11)
 12873     CALL 'kxdfhei1' USING DFHEIV0,
 12874           FILE-ID-ERPNDB,
 12875           PENDING-BUSINESS,
 12876           DFHEIV11,
 12877           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 238
* EL6311.cbl
 12878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12879        PERFORM 8400-LOG-JOURNAL-RECORD.
 12880
 12881******************************************************************
 12882*                                                                *
 12883*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 12884*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 12885*                                                                *
 12886******************************************************************
 12887
 12888     IF NOT PI-AR-PROCESSING
 12889        GO TO 1475-DELETE-FINISHED.
 12890
 12891     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12892        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12893        NEXT SENTENCE
 12894     ELSE
 12895        GO TO 1475-DELETE-FINISHED.
 12896
 12897
 12898* EXEC CICS HANDLE CONDITION
 12899*         NOTFND    (1475-DELETE-FINISHED)
 12900*         END-EXEC.
 12901*    MOVE '"$I                   ! 2 #00011859' TO DFHEIV0
 12902     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12903     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12904     MOVE X'3220233030303131383539' TO DFHEIV0(25:11)
 12905     CALL 'kxdfhei1' USING DFHEIV0
 12906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12907
 12908
 12909     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 12910     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 12911
 12912
 12913* EXEC CICS READ
 12914*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 12915*        DATASET (FILE-ID-ERRQST)
 12916*        RIDFLD  (ERRQST-KEY)
 12917*        UPDATE
 12918*    END-EXEC.
 12919*    MOVE '&"S        EU         (   #00011866' TO DFHEIV0
 12920     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12921     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12922     MOVE X'2020233030303131383636' TO DFHEIV0(25:11)
 12923     CALL 'kxdfhei1' USING DFHEIV0,
 12924           FILE-ID-ERRQST,
 12925           DFHEIV20,
 12926           DFHEIV99,
 12927           ERRQST-KEY,
 12928           DFHEIV99,
 12929           DFHEIV99,
 12930           DFHEIV99
 12931     SET ADDRESS OF AR-REQUEST-RECORD TO
 12932         DFHEIV20
 12933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12934
 12935
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 239
* EL6311.cbl
 12936     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12937
 12938     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 12939
 12940     MOVE 'D'                      TO JP-RECORD-TYPE.
 12941     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 12942
 12943
 12944* EXEC CICS DELETE
 12945*         DATASET    (FILE-ID-ERRQST)
 12946*    END-EXEC.
 12947*    MOVE '&(                    &   #00011880' TO DFHEIV0
 12948     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12949     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12950     MOVE X'2020233030303131383830' TO DFHEIV0(25:11)
 12951     CALL 'kxdfhei1' USING DFHEIV0,
 12952           FILE-ID-ERRQST,
 12953           DFHEIV99,
 12954           DFHEIV99,
 12955           DFHEIV99,
 12956           DFHEIV99
 12957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12958
 12959
 12960     PERFORM 8400-LOG-JOURNAL-RECORD.
 12961
 12962 1475-DELETE-FINISHED.
 12963     MOVE ZEROS                  TO EMI-ERROR.
 12964     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12965     MOVE LOW-VALUES             TO EL631BI.
 12966     MOVE -1                     TO BMAINTL.
 12967     GO TO 8100-SEND-INITIAL-MAP.
 12968
 12969 1480-BATCH-HDR-NOT-FOUND.
 12970     MOVE -1                     TO BMAINTL.
 12971     MOVE ER-7450                TO EMI-ERROR.
 12972     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12973     GO TO 8200-SEND-DATAONLY.
 12974
 12975 1490-RECORD-NOT-FOUND.
 12976     MOVE -1                     TO BMAINTL.
 12977     MOVE ER-7451                TO EMI-ERROR.
 12978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12979     GO TO 8200-SEND-DATAONLY.
 12980
 12981******************************************************************
 12982*            O V E R   C H A R G E   P R O C E S S I N G         *
 12983******************************************************************
 12984 1500-UPDATE-ERNOTE.
 12985     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 12986     MOVE 'A'                    TO WS-NOTE-SW
 12987     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 12988     .
 12989 1500-EXIT.
 12990     EXIT.
 12991 1510-ADD-ERNOTE-REC.
 12992
 12993* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 240
* EL6311.cbl
 12994*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 12995*        LENGTH  (ERNOTE-RECORD-LENGTH)
 12996*        INITIMG (GETMAIN-SPACE)
 12997*    END-EXEC
 12998*    MOVE ',"IL                  $   #00011916' TO DFHEIV0
 12999     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13000     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13001     MOVE X'2020233030303131393136' TO DFHEIV0(25:11)
 13002     CALL 'kxdfhei1' USING DFHEIV0,
 13003           DFHEIV20,
 13004           ERNOTE-RECORD-LENGTH,
 13005           GETMAIN-SPACE
 13006     SET ADDRESS OF CERTIFICATE-NOTE TO
 13007         DFHEIV20
 13008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13009     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13010                                 TO ERNOTE-KEY
 13011
 13012* EXEC CICS READ
 13013*       DATASET    (FILE-ID-ERNOTE)
 13014*       RIDFLD     (ERNOTE-KEY)
 13015*       INTO       (CERTIFICATE-NOTE)
 13016*       RESP       (WS-RESPONSE)
 13017*       UPDATE
 13018*    END-EXEC
 13019     MOVE LENGTH OF
 13020      CERTIFICATE-NOTE
 13021       TO DFHEIV11
 13022*    MOVE '&"IL       EU         (  N#00011923' TO DFHEIV0
 13023     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13024     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13025     MOVE X'204E233030303131393233' TO DFHEIV0(25:11)
 13026     CALL 'kxdfhei1' USING DFHEIV0,
 13027           FILE-ID-ERNOTE,
 13028           CERTIFICATE-NOTE,
 13029           DFHEIV11,
 13030           ERNOTE-KEY,
 13031           DFHEIV99,
 13032           DFHEIV99,
 13033           DFHEIV99
 13034     MOVE EIBRESP  TO WS-RESPONSE
 13035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13036     IF RESP-NORMAL
 13037        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13038           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13039        END-IF
 13040        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13041           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13042        END-IF
 13043        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13044           (N1 > +10)
 13045           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13046           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13047        END-PERFORM
 13048        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13049          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13050
 13051* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 241
* EL6311.cbl
 13052*            DATASET    (FILE-ID-ERNOTE)
 13053*          END-EXEC
 13054*    MOVE '&*                    #   #00011944' TO DFHEIV0
 13055     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13056     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13057     MOVE X'2020233030303131393434' TO DFHEIV0(25:11)
 13058     CALL 'kxdfhei1' USING DFHEIV0,
 13059           FILE-ID-ERNOTE,
 13060           DFHEIV99
 13061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13062        ELSE
 13063          PERFORM VARYING N1 FROM +1 BY +1
 13064           UNTIL (N1 > +10)
 13065           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13066          END-PERFORM
 13067          IF (N1 < +11)
 13068            IF N1 >= CN-BILLING-START-LINE-NO AND
 13069              N1 <= CN-BILLING-END-LINE-NO
 13070              IF PI-COMPANY-ID = 'DCC'
 13071                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13072              ELSE
 13073                 MOVE WS-VA-NO-COMM-MESS
 13074                                    TO CN-LINE (N1)
 13075              END-IF
 13076            ELSE
 13077              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13078               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13079                IF PI-COMPANY-ID = 'DCC'
 13080                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13081                ELSE
 13082                  MOVE WS-VA-NO-COMM-MESS
 13083                                    TO CN-LINE (N1)
 13084                END-IF
 13085                MOVE N1             TO CN-BILLING-END-LINE-NO
 13086              ELSE
 13087                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13088                  IF PI-COMPANY-ID = 'DCC'
 13089                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13090                  ELSE
 13091                     MOVE WS-VA-NO-COMM-MESS
 13092                                    TO CN-LINE (N1)
 13093                  END-IF
 13094                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13095                                      CN-BILLING-START-LINE-NO
 13096                ELSE
 13097                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13098                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13099                     IF PI-COMPANY-ID = 'DCC'
 13100                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13101                     ELSE
 13102                       MOVE WS-VA-NO-COMM-MESS
 13103                                    TO CN-LINE (N1)
 13104                     END-IF
 13105                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13106                  ELSE
 13107                     PERFORM 1700-SQUEEZE-IT-IN
 13108                                 THRU 1700-EXIT
 13109                  END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 242
* EL6311.cbl
 13110                END-IF
 13111              END-IF
 13112            END-IF
 13113            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13114            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13115            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13116
 13117* EXEC CICS REWRITE
 13118*              DATASET    (FILE-ID-ERNOTE)
 13119*              FROM       (CERTIFICATE-NOTE)
 13120*              RESP       (WS-RESPONSE)
 13121*           END-EXEC
 13122     MOVE LENGTH OF
 13123      CERTIFICATE-NOTE
 13124       TO DFHEIV11
 13125*    MOVE '&& L                  %  N#00012001' TO DFHEIV0
 13126     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13127     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13128     MOVE X'204E233030303132303031' TO DFHEIV0(25:11)
 13129     CALL 'kxdfhei1' USING DFHEIV0,
 13130           FILE-ID-ERNOTE,
 13131           CERTIFICATE-NOTE,
 13132           DFHEIV11,
 13133           DFHEIV99
 13134     MOVE EIBRESP  TO WS-RESPONSE
 13135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13136          END-IF
 13137        END-IF
 13138     ELSE
 13139        MOVE SPACES              TO CERTIFICATE-NOTE
 13140        MOVE 'CN'                TO CN-RECORD-ID
 13141        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13142                                 TO CN-CONTROL-PRIMARY
 13143                                    ERNOTE-KEY
 13144        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13145                                    CN-BILLING-END-LINE-NO
 13146        IF PI-COMPANY-ID = 'DCC'
 13147           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13148        ELSE
 13149           MOVE WS-VA-NO-COMM-MESS
 13150                                 TO CN-LINE (1)
 13151        END-IF
 13152        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13153        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13154        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13155
 13156* EXEC CICS WRITE
 13157*          DATASET    (FILE-ID-ERNOTE)
 13158*          FROM       (CERTIFICATE-NOTE)
 13159*          RIDFLD     (ERNOTE-KEY)
 13160*          RESP       (WS-RESPONSE)
 13161*       END-EXEC
 13162     MOVE LENGTH OF
 13163      CERTIFICATE-NOTE
 13164       TO DFHEIV11
 13165*    MOVE '&$ L                  ''  N#00012025' TO DFHEIV0
 13166     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13167     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 243
* EL6311.cbl
 13168     MOVE X'204E233030303132303235' TO DFHEIV0(25:11)
 13169     CALL 'kxdfhei1' USING DFHEIV0,
 13170           FILE-ID-ERNOTE,
 13171           CERTIFICATE-NOTE,
 13172           DFHEIV11,
 13173           ERNOTE-KEY,
 13174           DFHEIV99,
 13175           DFHEIV99
 13176     MOVE EIBRESP  TO WS-RESPONSE
 13177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13178     END-IF
 13179     .
 13180 1510-EXIT.
 13181     EXIT.
 13182 1520-UPDATE-ELCERT.
 13183     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13184                                 TO ELCERT-KEY
 13185
 13186* EXEC CICS READ
 13187*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13188*        DATASET (FILE-ID-ELCERT)
 13189*        RIDFLD  (ELCERT-KEY)
 13190*        UPDATE
 13191*        RESP    (WS-RESPONSE)
 13192*    END-EXEC
 13193*    MOVE '&"S        EU         (  N#00012038' TO DFHEIV0
 13194     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13195     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13196     MOVE X'204E233030303132303338' TO DFHEIV0(25:11)
 13197     CALL 'kxdfhei1' USING DFHEIV0,
 13198           FILE-ID-ELCERT,
 13199           DFHEIV20,
 13200           DFHEIV99,
 13201           ELCERT-KEY,
 13202           DFHEIV99,
 13203           DFHEIV99,
 13204           DFHEIV99
 13205     SET ADDRESS OF CERTIFICATE-MASTER TO
 13206         DFHEIV20
 13207     MOVE EIBRESP  TO WS-RESPONSE
 13208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13209     IF RESP-NORMAL
 13210        IF WS-NOTE-SW = 'A'
 13211           IF CM-NOTE-SW = ' '
 13212              MOVE '2'             TO CM-NOTE-SW
 13213           ELSE
 13214             IF CM-NOTE-SW = '1'
 13215                MOVE '3'           TO CM-NOTE-SW
 13216             ELSE
 13217               IF CM-NOTE-SW = '4'
 13218                  MOVE '6'         TO CM-NOTE-SW
 13219               ELSE
 13220                 IF CM-NOTE-SW = '5'
 13221                    MOVE '7'       TO CM-NOTE-SW
 13222                 END-IF
 13223               END-IF
 13224             END-IF
 13225           END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 244
* EL6311.cbl
 13226        ELSE
 13227           IF CM-NOTE-SW = '2'
 13228              MOVE ' '             TO CM-NOTE-SW
 13229           ELSE
 13230             IF CM-NOTE-SW = '3'
 13231                MOVE '1'           TO CM-NOTE-SW
 13232             ELSE
 13233               IF CM-NOTE-SW = '6'
 13234                  MOVE '4'         TO CM-NOTE-SW
 13235               ELSE
 13236                 IF CM-NOTE-SW = '7'
 13237                    MOVE '5'       TO CM-NOTE-SW
 13238                 END-IF
 13239               END-IF
 13240             END-IF
 13241           END-IF
 13242        END-IF
 13243
 13244* EXEC CICS REWRITE
 13245*          DATASET    (FILE-ID-ELCERT)
 13246*          FROM       (CERTIFICATE-MASTER)
 13247*          RESP       (WS-RESPONSE)
 13248*       END-EXEC
 13249     MOVE LENGTH OF
 13250      CERTIFICATE-MASTER
 13251       TO DFHEIV11
 13252*    MOVE '&& L                  %  N#00012079' TO DFHEIV0
 13253     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13254     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13255     MOVE X'204E233030303132303739' TO DFHEIV0(25:11)
 13256     CALL 'kxdfhei1' USING DFHEIV0,
 13257           FILE-ID-ELCERT,
 13258           CERTIFICATE-MASTER,
 13259           DFHEIV11,
 13260           DFHEIV99
 13261     MOVE EIBRESP  TO WS-RESPONSE
 13262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13263        IF RESP-NORMAL
 13264           CONTINUE
 13265        ELSE
 13266           MOVE WS-RESPONSE TO EMI-ERROR
 13267           PERFORM 9900-ERROR-FORMAT
 13268                                 THRU 9900-EXIT
 13269           GO TO 8200-SEND-DATAONLY
 13270        END-IF
 13271     ELSE
 13272        MOVE -1                  TO BMAINTL
 13273        MOVE 0249                TO EMI-ERROR
 13274        PERFORM 9900-ERROR-FORMAT
 13275                                 THRU 9900-EXIT
 13276        GO TO 8200-SEND-DATAONLY
 13277     END-IF
 13278     .
 13279 1520-EXIT.
 13280     EXIT.
 13281 1600-UPDATE-ERPYAJ.
 13282     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13283                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 245
* EL6311.cbl
 13284     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13285                                 THRU 1620-EXIT
 13286     .
 13287 1600-EXIT.
 13288     EXIT.
 13289 1610-ADD-ERPYAJ-BANK-REC.
 13290
 13291* EXEC CICS GETMAIN
 13292*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13293*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13294*        INITIMG (GETMAIN-SPACE)
 13295*    END-EXEC
 13296*    MOVE ',"IL                  $   #00012111' TO DFHEIV0
 13297     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13298     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13299     MOVE X'2020233030303132313131' TO DFHEIV0(25:11)
 13300     CALL 'kxdfhei1' USING DFHEIV0,
 13301           DFHEIV20,
 13302           ERPYAJ-RECORD-LENGTH,
 13303           GETMAIN-SPACE
 13304     SET ADDRESS OF PENDING-PAY-ADJ TO
 13305         DFHEIV20
 13306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13307     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13308     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13309     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13310     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13311     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13312     MOVE +10                    TO ERPYAJ-SEQ-NO
 13313     MOVE 'R'                    TO ERPYAJ-TYPE
 13314     IF REVERSAL
 13315        MOVE 'C'                 TO ERPYAJ-TYPE
 13316     END-IF
 13317     MOVE SPACES                 TO PENDING-PAY-ADJ
 13318     MOVE 'PY'                   TO PY-RECORD-ID
 13319     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13320     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13321     IF REVERSAL
 13322        MOVE PB-I-DCC-OVER-CHG-AMT
 13323                                 TO PY-ENTRY-AMT
 13324     END-IF
 13325     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13326                                    PY-INPUT-DT
 13327*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13328*                                   PY-INPUT-DT
 13329     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13330     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13331     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13332     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13333     IF PB-CARRIER = '2'
 13334        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13335     ELSE
 13336        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13337     END-IF
 13338     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13339                                    PY-BILLED-DATE
 13340                                    PY-AR-DATE
 13341                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 246
* EL6311.cbl
 13342                                    PY-CHECK-WRITTEN-DT
 13343     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13344                                    PY-CHECK-QUE-SEQUENCE
 13345     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13346     PERFORM WITH TEST AFTER
 13347        UNTIL (NOT RESP-DUPKEY)
 13348           AND (NOT RESP-DUPREC)
 13349
 13350* EXEC CICS WRITE
 13351*          DATASET    (FILE-ID-ERPYAJ)
 13352*          FROM       (PENDING-PAY-ADJ)
 13353*          RIDFLD     (ERPYAJ-KEY)
 13354*          RESP       (WS-RESPONSE)
 13355*       END-EXEC
 13356     MOVE LENGTH OF
 13357      PENDING-PAY-ADJ
 13358       TO DFHEIV11
 13359*    MOVE '&$ L                  ''  N#00012158' TO DFHEIV0
 13360     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13361     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13362     MOVE X'204E233030303132313538' TO DFHEIV0(25:11)
 13363     CALL 'kxdfhei1' USING DFHEIV0,
 13364           FILE-ID-ERPYAJ,
 13365           PENDING-PAY-ADJ,
 13366           DFHEIV11,
 13367           ERPYAJ-KEY,
 13368           DFHEIV99,
 13369           DFHEIV99
 13370     MOVE EIBRESP  TO WS-RESPONSE
 13371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13372        IF RESP-DUPKEY OR RESP-DUPREC
 13373           ADD +1                TO ERPYAJ-SEQ-NO
 13374           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13375        END-IF
 13376     END-PERFORM
 13377     .
 13378 1610-EXIT.
 13379     EXIT.
 13380 1620-ADD-ERPYAJ-DLR-REC.
 13381     MOVE 'C'                    TO ERPYAJ-TYPE
 13382     IF REVERSAL
 13383        MOVE 'R'                 TO ERPYAJ-TYPE
 13384     END-IF
 13385     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13386                                    ERPYAJ-ACCOUNT
 13387     ADD +1                      TO ERPYAJ-SEQ-NO
 13388     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13389     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13390     IF PB-CARRIER = '2'
 13391        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13392     ELSE
 13393        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13394     END-IF
 13395     PERFORM WITH TEST AFTER
 13396        UNTIL (NOT RESP-DUPKEY)
 13397           AND (NOT RESP-DUPREC)
 13398
 13399* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 247
* EL6311.cbl
 13400*          DATASET    (FILE-ID-ERPYAJ)
 13401*          FROM       (PENDING-PAY-ADJ)
 13402*          RIDFLD     (ERPYAJ-KEY)
 13403*          RESP       (WS-RESPONSE)
 13404*       END-EXEC
 13405     MOVE LENGTH OF
 13406      PENDING-PAY-ADJ
 13407       TO DFHEIV11
 13408*    MOVE '&$ L                  ''  N#00012190' TO DFHEIV0
 13409     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13410     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13411     MOVE X'204E233030303132313930' TO DFHEIV0(25:11)
 13412     CALL 'kxdfhei1' USING DFHEIV0,
 13413           FILE-ID-ERPYAJ,
 13414           PENDING-PAY-ADJ,
 13415           DFHEIV11,
 13416           ERPYAJ-KEY,
 13417           DFHEIV99,
 13418           DFHEIV99
 13419     MOVE EIBRESP  TO WS-RESPONSE
 13420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13421        IF RESP-DUPKEY OR RESP-DUPREC
 13422           ADD +1                TO ERPYAJ-SEQ-NO
 13423           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13424        END-IF
 13425     END-PERFORM
 13426     .
 13427 1620-EXIT.
 13428     EXIT.
 13429 1700-SQUEEZE-IT-IN.
 13430     IF (N1 > CN-BILLING-END-LINE-NO)
 13431        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13432           N1 = +1
 13433           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13434           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13435              IF PI-COMPANY-ID = 'DCC'
 13436                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13437              ELSE
 13438                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13439              END-IF
 13440              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13441              MOVE +2 TO N1
 13442           END-IF
 13443        END-PERFORM
 13444     ELSE
 13445        IF (N1 < CN-BILLING-START-LINE-NO)
 13446           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13447              N1 = +10
 13448              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13449              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13450                 IF PI-COMPANY-ID = 'DCC'
 13451                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13452                 ELSE
 13453                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13454                 END-IF
 13455                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13456                 MOVE +9 TO N1
 13457              END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 248
* EL6311.cbl
 13458           END-PERFORM
 13459        END-IF
 13460     END-IF
 13461     .
 13462 1700-EXIT.
 13463     EXIT.
 13464 1800-REMOVE-CERT-NOTES.
 13465     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13466                                 TO ERNOTE-KEY
 13467
 13468* EXEC CICS READ
 13469*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13470*       DATASET    (FILE-ID-ERNOTE)
 13471*       RIDFLD     (ERNOTE-KEY)
 13472*       RESP       (WS-RESPONSE)
 13473*       UPDATE
 13474*    END-EXEC
 13475*    MOVE '&"S        EU         (  N#00012242' TO DFHEIV0
 13476     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13477     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13478     MOVE X'204E233030303132323432' TO DFHEIV0(25:11)
 13479     CALL 'kxdfhei1' USING DFHEIV0,
 13480           FILE-ID-ERNOTE,
 13481           DFHEIV20,
 13482           DFHEIV99,
 13483           ERNOTE-KEY,
 13484           DFHEIV99,
 13485           DFHEIV99,
 13486           DFHEIV99
 13487     SET ADDRESS OF CERTIFICATE-NOTE TO
 13488         DFHEIV20
 13489     MOVE EIBRESP  TO WS-RESPONSE
 13490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13491     IF RESP-NORMAL
 13492        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13493           (N1 > +10)
 13494           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13495           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13496        END-PERFORM
 13497        IF N1 < +11
 13498           MOVE SPACES              TO CN-LINE (N1)
 13499           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13500              N1 <= CN-BILLING-END-LINE-NO
 13501              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13502              IF CN-BILLING-END-LINE-NO <
 13503                               CN-BILLING-START-LINE-NO
 13504                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13505                                     CN-BILLING-START-LINE-NO
 13506              END-IF
 13507              PERFORM 1820-SQUEEZE-ERNOTE
 13508                                  THRU 1820-EXIT
 13509           END-IF
 13510           IF CN-LINES = SPACES
 13511
 13512* EXEC CICS DELETE
 13513*                DATASET    (FILE-ID-ERNOTE)
 13514*                RESP       (WS-RESPONSE)
 13515*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 249
* EL6311.cbl
 13516*    MOVE '&(                    &  N#00012269' TO DFHEIV0
 13517     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13518     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13519     MOVE X'204E233030303132323639' TO DFHEIV0(25:11)
 13520     CALL 'kxdfhei1' USING DFHEIV0,
 13521           FILE-ID-ERNOTE,
 13522           DFHEIV99,
 13523           DFHEIV99,
 13524           DFHEIV99,
 13525           DFHEIV99
 13526     MOVE EIBRESP  TO WS-RESPONSE
 13527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13528              IF RESP-NORMAL
 13529                 MOVE 'D'        TO WS-NOTE-SW
 13530                 PERFORM 1520-UPDATE-ELCERT
 13531                                 THRU 1520-EXIT
 13532              END-IF
 13533           ELSE
 13534
 13535* EXEC CICS REWRITE
 13536*                DATASET    (FILE-ID-ERNOTE)
 13537*                FROM       (CERTIFICATE-NOTE)
 13538*                RESP       (WS-RESPONSE)
 13539*             END-EXEC
 13540     MOVE LENGTH OF
 13541      CERTIFICATE-NOTE
 13542       TO DFHEIV11
 13543*    MOVE '&& L                  %  N#00012279' TO DFHEIV0
 13544     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13545     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13546     MOVE X'204E233030303132323739' TO DFHEIV0(25:11)
 13547     CALL 'kxdfhei1' USING DFHEIV0,
 13548           FILE-ID-ERNOTE,
 13549           CERTIFICATE-NOTE,
 13550           DFHEIV11,
 13551           DFHEIV99
 13552     MOVE EIBRESP  TO WS-RESPONSE
 13553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13554           END-IF
 13555        END-IF
 13556     END-IF
 13557     .
 13558 1800-EXIT.
 13559     EXIT.
 13560 1820-SQUEEZE-ERNOTE.
 13561     MOVE CN-BILLING-START-LINE-NO TO N2
 13562     IF N2 = 0
 13563         MOVE +1                 TO N2
 13564     END-IF
 13565     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13566        (N1 > +9)
 13567        IF CN-LINE (N1) = SPACES
 13568           MOVE CN-LINE (N1 + +1)
 13569                                 TO CN-LINE (N1)
 13570           MOVE SPACES           TO CN-LINE (N1 + +1)
 13571        END-IF
 13572     END-PERFORM
 13573     .
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 250
* EL6311.cbl
 13574 1820-EXIT.
 13575     EXIT.
 13576 1900-DELETE-ERPYAJ.
 13577     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13578     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13579     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13580     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13581     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13582     MOVE +10                    TO ERPYAJ-SEQ-NO
 13583     MOVE 'R'                    TO ERPYAJ-TYPE
 13584     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13585
 13586* EXEC CICS STARTBR
 13587*       DATASET    (FILE-ID-ERPYAJ)
 13588*       RIDFLD     (ERPYAJ-KEY)
 13589*       RESP       (WS-RESPONSE)
 13590*    END-EXEC
 13591     MOVE 0
 13592       TO DFHEIV11
 13593*    MOVE '&,         G          &  N#00012315' TO DFHEIV0
 13594     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13595     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13596     MOVE X'204E233030303132333135' TO DFHEIV0(25:11)
 13597     CALL 'kxdfhei1' USING DFHEIV0,
 13598           FILE-ID-ERPYAJ,
 13599           ERPYAJ-KEY,
 13600           DFHEIV99,
 13601           DFHEIV11,
 13602           DFHEIV99
 13603     MOVE EIBRESP  TO WS-RESPONSE
 13604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13605     IF RESP-NORMAL
 13606        CONTINUE
 13607     ELSE
 13608        GO TO 1900-GET-DEALER
 13609     END-IF
 13610     .
 13611 1900-READNEXT-ERPYAJ-B.
 13612*  GET THE BANK ERPYAJ RECORD
 13613
 13614* EXEC CICS READNEXT
 13615*       DATASET    (FILE-ID-ERPYAJ)
 13616*       RIDFLD     (ERPYAJ-KEY)
 13617*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13618*       RESP       (WS-RESPONSE)
 13619*    END-EXEC
 13620     MOVE 0
 13621       TO DFHEIV11
 13622*    MOVE '&.S                   )  N#00012328' TO DFHEIV0
 13623     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13624     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13625     MOVE X'204E233030303132333238' TO DFHEIV0(25:11)
 13626     CALL 'kxdfhei1' USING DFHEIV0,
 13627           FILE-ID-ERPYAJ,
 13628           DFHEIV20,
 13629           DFHEIV99,
 13630           ERPYAJ-KEY,
 13631           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 251
* EL6311.cbl
 13632           DFHEIV11,
 13633           DFHEIV99,
 13634           DFHEIV99
 13635     SET ADDRESS OF PENDING-PAY-ADJ TO
 13636         DFHEIV20
 13637     MOVE EIBRESP  TO WS-RESPONSE
 13638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13639     IF RESP-NORMAL
 13640        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13641           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13642              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13643                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13644
 13645* EXEC CICS READ
 13646*                   DATASET    (FILE-ID-ERPYAJ)
 13647*                   RIDFLD     (ERPYAJ-KEY)
 13648*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13649*                   RESP       (WS-RESPONSE)
 13650*                   UPDATE
 13651*                END-EXEC
 13652*    MOVE '&"S        EU         (  N#00012339' TO DFHEIV0
 13653     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13654     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13655     MOVE X'204E233030303132333339' TO DFHEIV0(25:11)
 13656     CALL 'kxdfhei1' USING DFHEIV0,
 13657           FILE-ID-ERPYAJ,
 13658           DFHEIV20,
 13659           DFHEIV99,
 13660           ERPYAJ-KEY,
 13661           DFHEIV99,
 13662           DFHEIV99,
 13663           DFHEIV99
 13664     SET ADDRESS OF PENDING-PAY-ADJ TO
 13665         DFHEIV20
 13666     MOVE EIBRESP  TO WS-RESPONSE
 13667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13668                 IF RESP-NORMAL
 13669
 13670* EXEC CICS DELETE
 13671*                      DATASET   (FILE-ID-ERPYAJ)
 13672*                      RESP      (WS-RESPONSE)
 13673*                   END-EXEC
 13674*    MOVE '&(                    &  N#00012347' TO DFHEIV0
 13675     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13676     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13677     MOVE X'204E233030303132333437' TO DFHEIV0(25:11)
 13678     CALL 'kxdfhei1' USING DFHEIV0,
 13679           FILE-ID-ERPYAJ,
 13680           DFHEIV99,
 13681           DFHEIV99,
 13682           DFHEIV99,
 13683           DFHEIV99
 13684     MOVE EIBRESP  TO WS-RESPONSE
 13685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13686                 END-IF
 13687              ELSE
 13688                 SET REVERSAL    TO TRUE
 13689                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 252
* EL6311.cbl
 13690                                 THRU 1600-EXIT
 13691                 GO TO 1900-EXIT
 13692              END-IF
 13693           ELSE
 13694              GO TO 1900-READNEXT-ERPYAJ-B
 13695           END-IF
 13696        END-IF
 13697
 13698* EXEC CICS ENDBR
 13699*          DATASET   (FILE-ID-ERPYAJ)
 13700*       END-EXEC
 13701     MOVE 0
 13702       TO DFHEIV11
 13703*    MOVE '&2                    $   #00012362' TO DFHEIV0
 13704     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13705     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13706     MOVE X'2020233030303132333632' TO DFHEIV0(25:11)
 13707     CALL 'kxdfhei1' USING DFHEIV0,
 13708           FILE-ID-ERPYAJ,
 13709           DFHEIV11,
 13710           DFHEIV99
 13711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13712     END-IF
 13713     .
 13714 1900-GET-DEALER.
 13715     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13716     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13717     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13718     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13719     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13720     MOVE +10                    TO ERPYAJ-SEQ-NO
 13721     MOVE 'C'                    TO ERPYAJ-TYPE
 13722     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13723
 13724* EXEC CICS STARTBR
 13725*       DATASET    (FILE-ID-ERPYAJ)
 13726*       RIDFLD     (ERPYAJ-KEY)
 13727*       RESP       (WS-RESPONSE)
 13728*    END-EXEC
 13729     MOVE 0
 13730       TO DFHEIV11
 13731*    MOVE '&,         G          &  N#00012376' TO DFHEIV0
 13732     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13733     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13734     MOVE X'204E233030303132333736' TO DFHEIV0(25:11)
 13735     CALL 'kxdfhei1' USING DFHEIV0,
 13736           FILE-ID-ERPYAJ,
 13737           ERPYAJ-KEY,
 13738           DFHEIV99,
 13739           DFHEIV11,
 13740           DFHEIV99
 13741     MOVE EIBRESP  TO WS-RESPONSE
 13742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13743     IF RESP-NORMAL
 13744        CONTINUE
 13745     ELSE
 13746        GO TO 1900-EXIT
 13747     END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 253
* EL6311.cbl
 13748     .
 13749 1900-READNEXT-ERPYAJ-D.
 13750*  GET THE DEALER ERPYAJ RECORD
 13751
 13752* EXEC CICS READNEXT
 13753*       DATASET    (FILE-ID-ERPYAJ)
 13754*       RIDFLD     (ERPYAJ-KEY)
 13755*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13756*       RESP       (WS-RESPONSE)
 13757*    END-EXEC
 13758     MOVE 0
 13759       TO DFHEIV11
 13760*    MOVE '&.S                   )  N#00012389' TO DFHEIV0
 13761     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13762     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13763     MOVE X'204E233030303132333839' TO DFHEIV0(25:11)
 13764     CALL 'kxdfhei1' USING DFHEIV0,
 13765           FILE-ID-ERPYAJ,
 13766           DFHEIV20,
 13767           DFHEIV99,
 13768           ERPYAJ-KEY,
 13769           DFHEIV99,
 13770           DFHEIV11,
 13771           DFHEIV99,
 13772           DFHEIV99
 13773     SET ADDRESS OF PENDING-PAY-ADJ TO
 13774         DFHEIV20
 13775     MOVE EIBRESP  TO WS-RESPONSE
 13776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13777     IF RESP-NORMAL
 13778        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13779           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13780              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13781                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13782
 13783* EXEC CICS READ
 13784*                   DATASET    (FILE-ID-ERPYAJ)
 13785*                   RIDFLD     (ERPYAJ-KEY)
 13786*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13787*                   RESP       (WS-RESPONSE)
 13788*                   UPDATE
 13789*                END-EXEC
 13790*    MOVE '&"S        EU         (  N#00012400' TO DFHEIV0
 13791     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13792     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13793     MOVE X'204E233030303132343030' TO DFHEIV0(25:11)
 13794     CALL 'kxdfhei1' USING DFHEIV0,
 13795           FILE-ID-ERPYAJ,
 13796           DFHEIV20,
 13797           DFHEIV99,
 13798           ERPYAJ-KEY,
 13799           DFHEIV99,
 13800           DFHEIV99,
 13801           DFHEIV99
 13802     SET ADDRESS OF PENDING-PAY-ADJ TO
 13803         DFHEIV20
 13804     MOVE EIBRESP  TO WS-RESPONSE
 13805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 254
* EL6311.cbl
 13806                 IF RESP-NORMAL
 13807
 13808* EXEC CICS DELETE
 13809*                      DATASET   (FILE-ID-ERPYAJ)
 13810*                      RESP      (WS-RESPONSE)
 13811*                   END-EXEC
 13812*    MOVE '&(                    &  N#00012408' TO DFHEIV0
 13813     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13814     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13815     MOVE X'204E233030303132343038' TO DFHEIV0(25:11)
 13816     CALL 'kxdfhei1' USING DFHEIV0,
 13817           FILE-ID-ERPYAJ,
 13818           DFHEIV99,
 13819           DFHEIV99,
 13820           DFHEIV99,
 13821           DFHEIV99
 13822     MOVE EIBRESP  TO WS-RESPONSE
 13823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13824                 END-IF
 13825              ELSE
 13826                 SET REVERSAL    TO TRUE
 13827              END-IF
 13828           ELSE
 13829              GO TO 1900-READNEXT-ERPYAJ-D
 13830           END-IF
 13831        END-IF
 13832
 13833* EXEC CICS ENDBR
 13834*          DATASET   (FILE-ID-ERPYAJ)
 13835*       END-EXEC
 13836     MOVE 0
 13837       TO DFHEIV11
 13838*    MOVE '&2                    $   #00012420' TO DFHEIV0
 13839     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13840     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13841     MOVE X'2020233030303132343230' TO DFHEIV0(25:11)
 13842     CALL 'kxdfhei1' USING DFHEIV0,
 13843           FILE-ID-ERPYAJ,
 13844           DFHEIV11,
 13845           DFHEIV99
 13846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13847     END-IF
 13848     .
 13849 1900-EXIT.
 13850     EXIT.
 13851******************************************************************
 13852*            C A N C E L   M A I N L I N E                       *
 13853******************************************************************
 13854
 13855 2000-CANCEL-MAINLINE.
 13856     IF PI-DISPLAY-ORIGINAL-BATCH
 13857        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 13858           MOVE ER-0023             TO EMI-ERROR
 13859           MOVE -1                  TO CMAINTL
 13860           MOVE AL-UABON            TO CMAINTA
 13861           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13862           GO TO 8200-SEND-DATAONLY
 13863        ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 255
* EL6311.cbl
 13864           NEXT SENTENCE
 13865     ELSE
 13866        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 13867           MOVE ER-0023             TO EMI-ERROR
 13868           MOVE -1                  TO CMAINTL
 13869           MOVE AL-UABON            TO CMAINTA
 13870           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13871           GO TO 8200-SEND-DATAONLY.
 13872
 13873     IF CMAINTI = 'S'
 13874        GO TO 2100-SHOW-REQUEST.
 13875
 13876     IF NOT MODIFY-CAP
 13877         MOVE 'UPDATE'       TO SM-READ
 13878         PERFORM 9995-SECURITY-VIOLATION
 13879         MOVE ER-0070        TO EMI-ERROR
 13880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13881         GO TO 8100-SEND-INITIAL-MAP.
 13882
 13883     IF CMAINTL GREATER THAN ZEROS
 13884        IF PI-PF6-FUNCTION
 13885           IF CMAINTI NOT = 'A'
 13886              MOVE AL-UABON  TO CMAINTA
 13887              MOVE -1        TO CMAINTL
 13888              MOVE ER-2260   TO EMI-ERROR
 13889              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13890              GO TO 8200-SEND-DATAONLY.
 13891
 13892     IF CCERTNOL = ZEROS
 13893       AND (CMAINTI = 'C' OR 'K' OR 'D')
 13894         NEXT SENTENCE
 13895     ELSE
 13896         IF CCERTNOL NOT = ZEROS
 13897             MOVE AL-UANON       TO CCERTNOA
 13898         ELSE
 13899             MOVE -1             TO CCERTNOL
 13900             MOVE  1             TO SET-CURSOR-SW
 13901             MOVE ER-2218       TO EMI-ERROR
 13902             MOVE AL-UABON       TO CCERTNOA
 13903             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13904
 13905     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 13906        NEXT SENTENCE
 13907     ELSE
 13908        IF CEFFDTL NOT = ZEROS
 13909           MOVE AL-UNNON         TO CEFFDTA
 13910           MOVE CEFFDTI TO DEEDIT-FIELD
 13911           PERFORM 8600-DEEDIT
 13912           MOVE 4                TO DC-OPTION-CODE
 13913           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13914           PERFORM 9700-DATE-LINK
 13915           IF NO-CONVERSION-ERROR
 13916              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 13917              ELSE
 13918              MOVE -1            TO CEFFDTL
 13919              MOVE  1            TO SET-CURSOR-SW
 13920              MOVE ER-2226      TO EMI-ERROR
 13921              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 256
* EL6311.cbl
 13922              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13923          ELSE
 13924          MOVE -1                 TO CEFFDTL
 13925          MOVE  1                 TO SET-CURSOR-SW
 13926          MOVE ER-2220            TO EMI-ERROR
 13927          MOVE AL-UNBON           TO CEFFDTA
 13928          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13929
 13930     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 13931
 13932     IF CCERTNOL NOT = ZEROS
 13933        MOVE CCERTNOI                TO WS-NEW-PRIME
 13934     ELSE
 13935        MOVE SPACES                  TO WS-NEW-PRIME.
 13936
 13937     IF CSUFIXL NOT = ZEROS
 13938        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 13939     ELSE
 13940        MOVE SPACE                   TO WS-NEW-SUFFIX.
 13941
 13942     IF CEFFDTL NOT = ZEROS
 13943        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 13944     ELSE
 13945        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 13946
 13947     IF CMAINTI = 'A' OR 'K' OR 'S'
 13948        NEXT SENTENCE
 13949     ELSE
 13950        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 13951        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 13952           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 13953           WS-PB-RECORD-TYPE NOT = '2'
 13954           IF CMAINTI = 'C'
 13955              MOVE ER-2287          TO EMI-ERROR
 13956              MOVE -1               TO CCERTNOL
 13957              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 13958              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13959              GO TO 8200-SEND-DATAONLY
 13960             ELSE
 13961              MOVE ER-2260          TO EMI-ERROR
 13962              MOVE -1               TO CCERTNOL
 13963              MOVE AL-UABON         TO CCERTNOA
 13964              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13965              GO TO 8200-SEND-DATAONLY.
 13966
 13967     IF CMAINTI = 'D'
 13968        GO TO 2400-DELETE-CANCEL-ROUTINE.
 13969
 13970     IF CLSTNML GREATER THAN ZEROS
 13971         MOVE AL-UANON           TO CLSTNMA.
 13972
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 257
* EL6311.cbl
 13974
 13975******************************************************************
 13976*                                                                *
 13977*           E D I T   C A N C E L   C O V E R A G E S            *
 13978*                                                                *
 13979******************************************************************
 13980
 13981 2015-EDIT-COVERAGES.
 13982     IF CCANDT1L      GREATER THAN ZEROS OR
 13983        CREFND1L      GREATER THAN ZEROS OR
 13984        CCANDT2L      GREATER THAN ZEROS OR
 13985        CREFND2L      GREATER THAN ZEROS OR
 13986        CMTHD1L       GREATER THAN ZEROS OR
 13987        CMTHD2L       GREATER THAN ZEROS OR
 13988        CLIVESL       GREATER THAN ZEROS OR
 13989        CPAYEEL       GREATER THAN ZEROS OR
 13990        CFORCEL       GREATER THAN ZEROS OR
 13991        CBILCDL       GREATER THAN ZEROS OR
 13992        CCANREAL      GREATER THAN ZEROS
 13993            NEXT SENTENCE
 13994         ELSE
 13995            GO TO 2030-EDIT-COMPLETE.
 13996
 13997     IF CCANDT1L = ZEROS
 13998        AND (CMAINTI = 'C' OR 'K')
 13999        NEXT SENTENCE
 14000     ELSE
 14001        IF CCANDT1L      GREATER THAN ZEROS
 14002            MOVE AL-UNNON            TO CCANDT1A
 14003            IF CCANDT1I = SPACES
 14004               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14005            ELSE
 14006               MOVE CCANDT1I            TO DEEDIT-FIELD
 14007               PERFORM 8600-DEEDIT
 14008               IF DEEDIT-FIELD-V0   NUMERIC
 14009                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14010                  MOVE 4                TO DC-OPTION-CODE
 14011                  PERFORM 9700-DATE-LINK
 14012                  IF NO-CONVERSION-ERROR
 14013                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14014                  ELSE
 14015                      MOVE -1        TO CCANDT1L
 14016                      MOVE ER-2227   TO EMI-ERROR
 14017                      MOVE AL-UNBON  TO CCANDT1A
 14018                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14019               ELSE
 14020                  MOVE -1         TO CCANDT1L
 14021                  MOVE ER-2223    TO EMI-ERROR
 14022                  MOVE AL-UNBON   TO CCANDT1A
 14023                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14024        ELSE
 14025            IF CREFND1L GREATER THAN ZEROS
 14026               MOVE -1             TO CCANDT1L
 14027               MOVE ER-2222        TO EMI-ERROR
 14028               MOVE AL-UNBOF       TO CCANDT1A
 14029               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14030
 14031     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 258
* EL6311.cbl
 14032        AND (CMAINTI = 'C' OR 'K')
 14033         NEXT SENTENCE
 14034     ELSE
 14035         IF CREFND1L NOT = ZEROS
 14036            MOVE AL-UNNON        TO CREFND1A
 14037
 14038* EXEC CICS BIF DEEDIT
 14039*               FIELD  (CREFND1I)
 14040*               LENGTH (11)
 14041*           END-EXEC
 14042     MOVE 11
 14043       TO DFHEIV11
 14044*    MOVE '@"L                   #   #00012613' TO DFHEIV0
 14045     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14046     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14047     MOVE X'2020233030303132363133' TO DFHEIV0(25:11)
 14048     CALL 'kxdfhei1' USING DFHEIV0,
 14049           CREFND1I,
 14050           DFHEIV11
 14051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14052            MOVE CREFND1I        TO WS-CREFND1
 14053*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14054*           PERFORM 8600-DEEDIT
 14055*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14056            IF WS-CREFND1  = ZEROS
 14057               AND CMAINTI = 'A'
 14058             MOVE ER-2437        TO EMI-ERROR
 14059             MOVE -1             TO CREFND1L
 14060             MOVE AL-UNBON       TO CREFND1A
 14061             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14062
 14063     IF CCANREAL > +0
 14064        MOVE AL-UANON            TO CCANREAA
 14065        IF CCANREAI = 'R' OR ' '
 14066           CONTINUE
 14067        ELSE
 14068           MOVE ER-9841        TO EMI-ERROR
 14069           MOVE -1             TO CCANREAL
 14070           MOVE AL-UABON       TO CCANREAA
 14071           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14072        END-IF
 14073     END-IF
 14074     IF CMTHD1L EQUAL +0
 14075        NEXT SENTENCE
 14076     ELSE
 14077        IF CMTHD1L NOT = +0
 14078           MOVE AL-UNNON        TO CMTHD1A
 14079           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14080                         OR '5' OR '6' OR '8' OR '9'
 14081                         OR 'R' OR ' '
 14082              NEXT SENTENCE
 14083           ELSE
 14084              MOVE ER-0582        TO EMI-ERROR
 14085              MOVE -1             TO CMTHD1L
 14086              MOVE AL-UNBON       TO CMTHD1A
 14087              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14088
 14089     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 259
* EL6311.cbl
 14090        AND (CMAINTI = 'C' OR 'K')
 14091         NEXT SENTENCE
 14092     ELSE
 14093         IF CCANDT2L  GREATER THAN ZEROS
 14094             MOVE AL-UNNON       TO CCANDT2A
 14095             IF CCANDT2I = SPACES
 14096                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14097             ELSE
 14098                MOVE CCANDT2I       TO DEEDIT-FIELD
 14099                PERFORM 8600-DEEDIT
 14100                IF DEEDIT-FIELD-V0   NUMERIC
 14101                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14102                   MOVE 4                TO DC-OPTION-CODE
 14103                   PERFORM 9700-DATE-LINK
 14104                   IF NO-CONVERSION-ERROR
 14105                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14106                   ELSE
 14107                      MOVE -1       TO CCANDT2L
 14108                      MOVE ER-2227  TO EMI-ERROR
 14109                      MOVE AL-UNBON TO CCANDT2A
 14110                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14111                ELSE
 14112                   MOVE -1         TO CCANDT2L
 14113                   MOVE ER-2223    TO EMI-ERROR
 14114                   MOVE AL-UNBON   TO CCANDT2A
 14115                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14116         ELSE
 14117            IF CREFND2L GREATER THAN ZEROS
 14118               MOVE -1             TO CCANDT2L
 14119               MOVE ER-2222        TO EMI-ERROR
 14120               MOVE AL-UNBOF       TO CCANDT2A
 14121               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14122
 14123     IF CREFND2L = ZEROS
 14124        AND (CMAINTI = 'C' OR 'K')
 14125         NEXT SENTENCE
 14126     ELSE
 14127         IF CREFND2L NOT = ZEROS
 14128            MOVE AL-UNNON        TO CREFND2A
 14129
 14130* EXEC CICS BIF DEEDIT
 14131*               FIELD  (CREFND2I)
 14132*               LENGTH (11)
 14133*           END-EXEC
 14134     MOVE 11
 14135       TO DFHEIV11
 14136*    MOVE '@"L                   #   #00012694' TO DFHEIV0
 14137     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14138     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14139     MOVE X'2020233030303132363934' TO DFHEIV0(25:11)
 14140     CALL 'kxdfhei1' USING DFHEIV0,
 14141           CREFND2I,
 14142           DFHEIV11
 14143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14144            MOVE CREFND2I        TO WS-CREFND2
 14145*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14146*           PERFORM 8600-DEEDIT
 14147*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 260
* EL6311.cbl
 14148            IF WS-CREFND2  = ZEROS
 14149               AND CMAINTI = 'A'
 14150             MOVE ER-2437        TO EMI-ERROR
 14151             MOVE -1             TO CREFND2L
 14152             MOVE AL-UNBON       TO CREFND2A
 14153             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14154
 14155     IF CMTHD2L EQUAL +0
 14156        NEXT SENTENCE
 14157     ELSE
 14158        IF CMTHD2L NOT = +0
 14159           MOVE AL-UNNON        TO CMTHD2A
 14160           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14161                         OR '5' OR '6' OR '8' OR '9'
 14162                         OR ' ' OR 'R'
 14163              NEXT SENTENCE
 14164           ELSE
 14165              MOVE ER-0582        TO EMI-ERROR
 14166              MOVE -1             TO CMTHD2L
 14167              MOVE AL-UNBON       TO CMTHD2A
 14168              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14169
 14170     IF CLIVESL GREATER THAN ZEROS
 14171         MOVE CLIVESI            TO DEEDIT-FIELD
 14172         PERFORM 8600-DEEDIT
 14173         IF DEEDIT-FIELD-V0 NUMERIC
 14174             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14175             MOVE AL-UNNON       TO CLIVESA
 14176         ELSE
 14177             MOVE -1             TO CLIVESL
 14178             MOVE AL-UNBON       TO CLIVESA
 14179             MOVE ER-2223        TO EMI-ERROR
 14180             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14181
 14182     IF CFORCEL  NOT = ZEROS
 14183         IF FORCE-CAP
 14184            MOVE AL-UANON            TO CFORCEA
 14185         ELSE
 14186            MOVE ER-2945             TO EMI-ERROR
 14187            MOVE AL-UABON            TO CFORCEA
 14188            MOVE -1                  TO CFORCEL
 14189            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14190
 14191     IF CPAYEEL GREATER THAN ZEROS
 14192        MOVE AL-UANON            TO CPAYEEA.
 14193
 14194     IF CBILCDL NOT = ZEROS
 14195        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14196                             AND 'A' AND 'B' AND 'E'
 14197           MOVE ER-2225              TO EMI-ERROR
 14198           MOVE AL-UABON             TO CBILCDA
 14199           MOVE -1                   TO CBILCDL
 14200           MOVE  1                   TO SET-CURSOR-SW
 14201           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14202        ELSE
 14203           MOVE AL-UANON             TO CBILCDA.
 14204
 14205 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 261
* EL6311.cbl
 14206     IF EMI-ERROR = ZEROS
 14207         NEXT SENTENCE
 14208     ELSE
 14209         GO TO 8200-SEND-DATAONLY.
 14210
 14211     IF CMAINTI = 'A'
 14212        GO TO 2200-ADD-CANCEL-ROUTINE.
 14213
 14214     IF CMAINTI = 'C'
 14215        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14216
 14217     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14218
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 262
* EL6311.cbl
 14220
 14221******************************************************************
 14222*                                                                *
 14223*                   S H O W   C A N C E L                        *
 14224*                                                                *
 14225******************************************************************
 14226
 14227 2100-SHOW-REQUEST.
 14228     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14229
 14230     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14231        MOVE -1                  TO CMAINTL
 14232        GO TO 8200-SEND-DATAONLY.
 14233
 14234     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14235
 14236     IF CSUFIXL NOT = ZEROS
 14237        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14238       ELSE
 14239        MOVE SPACE            TO WS-NEW-SUFFIX.
 14240
 14241     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14242     PERFORM 8600-DEEDIT.
 14243     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14244     MOVE '4'                    TO DC-OPTION-CODE.
 14245     PERFORM 9700-DATE-LINK.
 14246     IF DATE-CONVERSION-ERROR
 14247        MOVE ER-0348             TO EMI-ERROR
 14248        MOVE -1                  TO CEFFDTL
 14249        MOVE AL-UABON            TO CEFFDTA
 14250        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14251        GO TO 8200-SEND-DATAONLY
 14252     ELSE
 14253        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14254        MOVE AL-UANON            TO CEFFDTA
 14255        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14256
 14257     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14258
 14259     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14260        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14261        MOVE 'Y'                    TO WS-SHOW-SW
 14262        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14263           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14264        ELSE
 14265           IF PI-FILE-BROWSE
 14266              GO TO 4300-BROWSE-FILE-FORWARD
 14267           ELSE
 14268              IF PI-CSR-BROWSE
 14269                 GO TO 4200-BROWSE-CSR-FORWARD
 14270              ELSE
 14271                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14272     ELSE
 14273        GO TO 3900-RE-DISPLAY-RECORD.
 14274
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 263
* EL6311.cbl
 14276
 14277
 14278******************************************************************
 14279*                                                                *
 14280*            A D D   C A N C E L   R O U T I N E                 *
 14281*                                                                *
 14282******************************************************************
 14283
 14284 2200-ADD-CANCEL-ROUTINE.
 14285     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14286
 14287
 14288* EXEC CICS GETMAIN
 14289*        SET     (ADDRESS OF PENDING-BUSINESS)
 14290*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14291*    END-EXEC.
 14292*    MOVE '," L                  $   #00012841' TO DFHEIV0
 14293     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14294     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14295     MOVE X'2020233030303132383431' TO DFHEIV0(25:11)
 14296     CALL 'kxdfhei1' USING DFHEIV0,
 14297           DFHEIV20,
 14298           ERPNDB-RECORD-LENGTH,
 14299           DFHEIV99
 14300     SET ADDRESS OF PENDING-BUSINESS TO
 14301         DFHEIV20
 14302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14303
 14304
 14305
 14306* EXEC CICS HANDLE CONDITION
 14307*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14308*    END-EXEC.
 14309*    MOVE '"$I                   ! 3 #00012846' TO DFHEIV0
 14310     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14311     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14312     MOVE X'3320233030303132383436' TO DFHEIV0(25:11)
 14313     CALL 'kxdfhei1' USING DFHEIV0
 14314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14315
 14316
 14317     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14318     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14319     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14320
 14321
 14322* EXEC CICS READ
 14323*        INTO    (PENDING-BUSINESS)
 14324*        DATASET (FILE-ID-ERPNDB)
 14325*        RIDFLD  (ERPNDB-KEY)
 14326*    END-EXEC.
 14327     MOVE LENGTH OF
 14328      PENDING-BUSINESS
 14329       TO DFHEIV11
 14330*    MOVE '&"IL       E          (   #00012854' TO DFHEIV0
 14331     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14332     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14333     MOVE X'2020233030303132383534' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 264
* EL6311.cbl
 14334     CALL 'kxdfhei1' USING DFHEIV0,
 14335           FILE-ID-ERPNDB,
 14336           PENDING-BUSINESS,
 14337           DFHEIV11,
 14338           ERPNDB-KEY,
 14339           DFHEIV99,
 14340           DFHEIV99,
 14341           DFHEIV99
 14342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14343
 14344
 14345     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14346
 14347     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14348     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14349     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14350     MOVE SPACES                 TO PENDING-BUSINESS.
 14351     MOVE 'PB'                   TO PB-RECORD-ID.
 14352     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14353     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14354     MOVE SPACES                 TO PB-CERT-SFX.
 14355     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14356     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14357                                    PB-ALT-CHG-SEQ-NO.
 14358
 14359     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14360     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14361     MOVE '2'                    TO PB-RECORD-TYPE.
 14362
 14363     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14364     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14365
 14366
 14367     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14368                                    PB-ALT-CHG-SEQ-NO
 14369                                    PB-C-LF-REF-CALC
 14370                                    PB-C-AH-REF-CALC
 14371                                    PB-C-LF-RFND-CLP
 14372                                    PB-C-AH-RFND-CLP
 14373                                    PB-CI-INSURED-AGE
 14374                                    PB-CI-LF-TERM
 14375                                    PB-CI-AH-TERM
 14376                                    PB-CI-LF-BENEFIT-CD
 14377                                    PB-CI-LF-BENEFIT-AMT
 14378                                    PB-CI-LF-ALT-BENEFIT-AMT
 14379                                    PB-CI-LF-PREMIUM-AMT
 14380                                    PB-CI-LF-ALT-PREMIUM-AMT
 14381                                    PB-CI-AH-BENEFIT-CD
 14382                                    PB-CI-AH-BENEFIT-AMT
 14383                                    PB-CI-AH-PREMIUM-AMT
 14384                                    PB-CI-PAY-FREQUENCY
 14385                                    PB-CI-LOAN-APR
 14386                                    PB-CI-LOAN-TERM
 14387                                    PB-CI-LIFE-COMMISSION
 14388                                    PB-CI-AH-COMMISSION
 14389                                    PB-CI-CURR-SEQ
 14390                                    PB-CI-AH-CANCEL-AMT
 14391                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 265
* EL6311.cbl
 14392                                    PB-CI-RATE-DEV-PCT-LF
 14393                                    PB-CI-RATE-DEV-PCT-AH
 14394                                    PB-CI-EXTENTION-DAYS
 14395                                    PB-CI-TERM-IN-DAYS
 14396                                    PB-CI-LIVES
 14397                                    PB-CI-LF-CRIT-PER
 14398                                    PB-CI-AH-CRIT-PER
 14399                                    PB-C-LF-REM-TERM
 14400                                    PB-C-AH-REM-TERM
 14401                                    PB-CHG-COUNT
 14402                                    PB-LF-BILLED-AMTS
 14403                                    PB-AH-BILLED-AMTS
 14404                                    PB-C-NH-INT-ON-REFS
 14405*                                   PB-C-MICROFILM-NO
 14406                                    PB-CALC-TOLERANCE.
 14407
 14408     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14409                                    PB-CI-AH-SETTLEMENT-DT
 14410                                    PB-CI-DEATH-DT
 14411                                    PB-CI-LF-PRIOR-CANCEL-DT
 14412                                    PB-CI-AH-PRIOR-CANCEL-DT
 14413                                    PB-CI-ENTRY-DT
 14414                                    PB-CI-LF-EXPIRE-DT
 14415                                    PB-CI-AH-EXPIRE-DT
 14416                                    PB-CI-LOAN-1ST-PMT-DT
 14417                                    PB-C-LF-CANCEL-DT
 14418                                    PB-C-AH-CANCEL-DT
 14419                                    PB-CREDIT-ACCEPT-DT
 14420                                    PB-BILLED-DT
 14421                                    PB-ACCT-EFF-DT
 14422                                    PB-ACCT-EXP-DT.
 14423
 14424     MOVE 'X'                    TO PB-FATAL-FLAG.
 14425
 14426     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14427
 14428     IF CSUFIXL     GREATER THAN ZEROS
 14429        MOVE CSUFIXI             TO PB-CERT-SFX.
 14430
 14431*    IF CMICRNOL  GREATER  ZEROS
 14432*        IF CMICRNOI  NUMERIC
 14433*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14434*            MOVE AL-UNNON       TO  CMICRNOA
 14435*        ELSE
 14436*            MOVE -1             TO  CMICRNOL
 14437*            MOVE AL-UNBON       TO  CMICRNOA
 14438*            MOVE ER-2701        TO  EMI-ERROR
 14439*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14440
 14441     IF CLSTNML     GREATER THAN ZEROS
 14442        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14443
 14444     IF CCANREAL > ZEROS
 14445        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14446     END-IF
 14447     IF CPCYNL > ZEROS
 14448        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14449     END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 266
* EL6311.cbl
 14450     IF CCANDT1L    GREATER THAN ZEROS
 14451        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14452
 14453     IF CCANDT2L    GREATER THAN ZEROS
 14454        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14455
 14456     IF CMTHD1L    GREATER THAN +0
 14457        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14458
 14459     IF CMTHD2L    GREATER THAN +0
 14460        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14461
 14462     IF CREFND1L    GREATER THAN ZEROS
 14463        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14464        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14465     ELSE
 14466        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14467
 14468     IF CREFND2L    GREATER THAN ZEROS
 14469        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14470        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14471     ELSE
 14472        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14473
 14474     IF CLIVESL     GREATER THAN ZEROS
 14475        MOVE WS-CLIVES           TO PB-C-LIVES
 14476     ELSE
 14477        MOVE ZEROS               TO PB-C-LIVES.
 14478
 14479     IF CPAYEEL     GREATER THAN ZEROS
 14480        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14481
 14482     IF CFORCEL     GREATER THAN ZEROS
 14483        MOVE CFORCEI             TO PB-FORCE-CODE.
 14484
 14485     IF CBILCDL     GREATER THAN ZEROS
 14486        MOVE CBILCDI             TO PB-RECORD-BILL.
 14487
 14488*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14489
 14490 2260-WRITE-PB-RECORD.
 14491     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14492                                    PB-INPUT-BY.
 14493     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14494     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14495                                    PB-INPUT-DT.
 14496
 14497     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14498     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14499                                    PB-CONTROL-BY-ORIG-BATCH.
 14500
 14501     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14502     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14503     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14504     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14505     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14506
 14507     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 267
* EL6311.cbl
 14508
 14509     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14510
 14511     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14512     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14513     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14514
 14515     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14516     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14517
 14518 2275-WRITE-PENDING-BUSINESS.
 14519     MOVE 'A'                    TO JP-RECORD-TYPE.
 14520     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14521     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14522     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14523
 14524
 14525* EXEC CICS HANDLE CONDITION
 14526*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14527*    END-EXEC.
 14528*    MOVE '"$%                   ! 4 #00013039' TO DFHEIV0
 14529     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14531     MOVE X'3420233030303133303339' TO DFHEIV0(25:11)
 14532     CALL 'kxdfhei1' USING DFHEIV0
 14533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14534
 14535
 14536
 14537* EXEC CICS WRITE
 14538*        DATASET (FILE-ID-ERPNDB)
 14539*        FROM    (PENDING-BUSINESS)
 14540*        RIDFLD  (PB-CONTROL-PRIMARY)
 14541*    END-EXEC.
 14542     MOVE LENGTH OF
 14543      PENDING-BUSINESS
 14544       TO DFHEIV11
 14545*    MOVE '&$ L                  ''   #00013043' TO DFHEIV0
 14546     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14547     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14548     MOVE X'2020233030303133303433' TO DFHEIV0(25:11)
 14549     CALL 'kxdfhei1' USING DFHEIV0,
 14550           FILE-ID-ERPNDB,
 14551           PENDING-BUSINESS,
 14552           DFHEIV11,
 14553           PB-CONTROL-PRIMARY,
 14554           DFHEIV99,
 14555           DFHEIV99
 14556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14557
 14558
 14559     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14560
 14561     PERFORM 8400-LOG-JOURNAL-RECORD.
 14562
 14563******************************************************************
 14564*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14565******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 268
* EL6311.cbl
 14566
 14567     display ' made it to add orig CANCEL cert '
 14568     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14569     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14570     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14571     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14572
 14573
 14574* EXEC CICS READ
 14575*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14576*        DATASET (FILE-ID-ELCERT)
 14577*        RIDFLD  (ELCERT-KEY)
 14578*        RESP    (WS-RESPONSE)
 14579*    END-EXEC.
 14580*    MOVE '&"S        E          (  N#00013063' TO DFHEIV0
 14581     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14582     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14583     MOVE X'204E233030303133303633' TO DFHEIV0(25:11)
 14584     CALL 'kxdfhei1' USING DFHEIV0,
 14585           FILE-ID-ELCERT,
 14586           DFHEIV20,
 14587           DFHEIV99,
 14588           ELCERT-KEY,
 14589           DFHEIV99,
 14590           DFHEIV99,
 14591           DFHEIV99
 14592     SET ADDRESS OF CERTIFICATE-MASTER TO
 14593         DFHEIV20
 14594     MOVE EIBRESP  TO WS-RESPONSE
 14595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14596
 14597
 14598     IF NOT RESP-NORMAL
 14599        GO TO 2276-BYPASS-CRTO
 14600     END-IF
 14601
 14602     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14603     MOVE ' '                    TO WS-ERMAIL-SW
 14604
 14605
 14606* EXEC CICS READ
 14607*       DATASET   (FILE-ID-ERMAIL)
 14608*       SET       (ADDRESS OF MAILING-DATA)
 14609*       RIDFLD    (ERMAIL-KEY)
 14610*       RESP      (WS-RESPONSE)
 14611*    END-EXEC
 14612*    MOVE '&"S        E          (  N#00013077' TO DFHEIV0
 14613     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14614     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14615     MOVE X'204E233030303133303737' TO DFHEIV0(25:11)
 14616     CALL 'kxdfhei1' USING DFHEIV0,
 14617           FILE-ID-ERMAIL,
 14618           DFHEIV20,
 14619           DFHEIV99,
 14620           ERMAIL-KEY,
 14621           DFHEIV99,
 14622           DFHEIV99,
 14623           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 269
* EL6311.cbl
 14624     SET ADDRESS OF MAILING-DATA TO
 14625         DFHEIV20
 14626     MOVE EIBRESP  TO WS-RESPONSE
 14627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14628
 14629     IF RESP-NORMAL
 14630        SET ERMAIL-FOUND TO TRUE
 14631     END-IF
 14632
 14633     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14634
 14635     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14636     MOVE 'OC'                   TO OC-RECORD-ID
 14637     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14638                                 TO OC-CONTROL-PRIMARY (1:33)
 14639     MOVE 'I'                    TO OC-RECORD-TYPE
 14640     MOVE +4096                  TO OC-KEY-SEQ-NO
 14641     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14642     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14643     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14644
 14645     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14646     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14647     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14648     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14649     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14650     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14651     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14652     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14653     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14654     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14655     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14656     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14657     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14658     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14659     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14660     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14661     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14662     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14663     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14664     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14665     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14666     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14667     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14668     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14669     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14670     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14671     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14672     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14673     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14674     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14675     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14676     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14677
 14678     IF ERMAIL-FOUND
 14679        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14680     END-IF
 14681     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 270
* EL6311.cbl
 14682        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14683                           OC-INS-AGE-DEFAULT-FLAG
 14684        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14685                           OC-JNT-AGE-DEFAULT-FLAG
 14686     END-IF
 14687     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14688     .
 14689 2275-WRITE-ELCRTO.
 14690
 14691
 14692* EXEC CICS WRITE
 14693*       DATASET   ('ELCRTO')
 14694*       FROM      (ORIGINAL-CERTIFICATE)
 14695*       RIDFLD    (OC-CONTROL-PRIMARY)
 14696*       RESP      (WS-RESPONSE)
 14697*    END-EXEC
 14698     MOVE LENGTH OF
 14699      ORIGINAL-CERTIFICATE
 14700       TO DFHEIV11
 14701     MOVE 'ELCRTO' TO DFHEIV1
 14702*    MOVE '&$ L                  ''  N#00013146' TO DFHEIV0
 14703     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14704     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14705     MOVE X'204E233030303133313436' TO DFHEIV0(25:11)
 14706     CALL 'kxdfhei1' USING DFHEIV0,
 14707           DFHEIV1,
 14708           ORIGINAL-CERTIFICATE,
 14709           DFHEIV11,
 14710           OC-CONTROL-PRIMARY,
 14711           DFHEIV99,
 14712           DFHEIV99
 14713     MOVE EIBRESP  TO WS-RESPONSE
 14714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14715
 14716     display ' just wrote 2275 ' ws-response
 14717     IF RESP-DUPKEY
 14718        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14719        GO TO 2275-WRITE-ELCRTO
 14720     ELSE
 14721        IF NOT RESP-NORMAL
 14722           MOVE -1               TO BMAINTL
 14723           MOVE ER-7450          TO EMI-ERROR
 14724           PERFORM 9900-ERROR-FORMAT
 14725                                 THRU 9900-EXIT
 14726           GO TO 8200-SEND-DATAONLY
 14727        END-IF
 14728     END-IF.
 14729
 14730 2276-BYPASS-CRTO.
 14731******************************************************************
 14732*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14733******************************************************************
 14734
 14735
 14736* EXEC CICS READ
 14737*        INTO    (PENDING-BUSINESS)
 14738*        DATASET (FILE-ID-ERPNDB)
 14739*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 271
* EL6311.cbl
 14740*        UPDATE
 14741*    END-EXEC.
 14742     MOVE LENGTH OF
 14743      PENDING-BUSINESS
 14744       TO DFHEIV11
 14745*    MOVE '&"IL       EU         (   #00013172' TO DFHEIV0
 14746     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14747     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14748     MOVE X'2020233030303133313732' TO DFHEIV0(25:11)
 14749     CALL 'kxdfhei1' USING DFHEIV0,
 14750           FILE-ID-ERPNDB,
 14751           PENDING-BUSINESS,
 14752           DFHEIV11,
 14753           ERPNDB-KEY,
 14754           DFHEIV99,
 14755           DFHEIV99,
 14756           DFHEIV99
 14757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14758
 14759
 14760     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14761     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14762     MOVE 'B'                    TO JP-RECORD-TYPE.
 14763     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14764
 14765     PERFORM 8400-LOG-JOURNAL-RECORD.
 14766
 14767     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14768
 14769
 14770* EXEC CICS REWRITE
 14771*        DATASET (FILE-ID-ERPNDB)
 14772*        FROM    (PENDING-BUSINESS)
 14773*    END-EXEC.
 14774     MOVE LENGTH OF
 14775      PENDING-BUSINESS
 14776       TO DFHEIV11
 14777*    MOVE '&& L                  %   #00013188' TO DFHEIV0
 14778     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14779     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14780     MOVE X'2020233030303133313838' TO DFHEIV0(25:11)
 14781     CALL 'kxdfhei1' USING DFHEIV0,
 14782           FILE-ID-ERPNDB,
 14783           PENDING-BUSINESS,
 14784           DFHEIV11,
 14785           DFHEIV99
 14786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14787
 14788
 14789     MOVE 'C'                    TO JP-RECORD-TYPE.
 14790     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14791
 14792     PERFORM 8400-LOG-JOURNAL-RECORD.
 14793
 14794     IF WS-ERRORS-PRESENT
 14795        GO TO 3900-RE-DISPLAY-RECORD.
 14796
 14797     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 272
* EL6311.cbl
 14798     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14799     MOVE LOW-VALUES             TO EL631CI.
 14800     MOVE  -1                    TO CMAINTL.
 14801     GO TO 8100-SEND-INITIAL-MAP.
 14802
 14803 2280-BATCH-HDR-NOT-FOUND.
 14804     MOVE -1                     TO BMAINTL.
 14805     MOVE ER-7450                TO EMI-ERROR.
 14806     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14807     GO TO 8200-SEND-DATAONLY.
 14808
 14809 2290-DUPLICATE-ALT-INDEX.
 14810
 14811******************************************************************
 14812*                                                                *
 14813*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14814*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14815*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14816*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14817*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14818*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14819*                                                                *
 14820******************************************************************
 14821
 14822     IF LCP-ONCTR-02 =  0
 14823         ADD 1 TO LCP-ONCTR-02
 14824        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14825
 14826     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14827
 14828     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14829         NEXT SENTENCE
 14830     ELSE
 14831         ADD +1 TO PB-BATCH-SEQ-NO
 14832                   PB-CSR-BATCH-SEQ-NO
 14833         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 14834         GO TO 2275-WRITE-PENDING-BUSINESS.
 14835
 14836     MOVE -1                     TO CCERTNOL.
 14837     MOVE AL-UABON               TO CCERTNOA.
 14838     MOVE AL-UNBON               TO CEFFDTA.
 14839
 14840     MOVE 1                      TO EMI-SUB
 14841                                    EMI-SWITCH1
 14842                                    EMI-SWITCH-AREA-1
 14843                                    EMI-SWITCH-AREA-2.
 14844
 14845     MOVE SPACES                 TO EMI-ERROR-LINES.
 14846
 14847
 14848* EXEC CICS SYNCPOINT ROLLBACK
 14849*    END-EXEC.
 14850*    MOVE '6"R                   !   #00013251' TO DFHEIV0
 14851     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14853     MOVE X'2020233030303133323531' TO DFHEIV0(25:11)
 14854     CALL 'kxdfhei1' USING DFHEIV0
 14855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 273
* EL6311.cbl
 14856
 14857
 14858     MOVE ER-2247                TO EMI-ERROR.
 14859     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14860     GO TO 8200-SEND-DATAONLY.
 14861
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 274
* EL6311.cbl
 14863
 14864******************************************************************
 14865*                                                                *
 14866*          C H A N G E   C A N C E L   R O U T I N E             *
 14867*                                                                *
 14868******************************************************************
 14869
 14870***************************************************************
 14871*                                                             *
 14872*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 14873*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 14874*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 14875*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 14876*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 14877*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 14878*     5. LINK TO THE EDIT ROUTINE.                            *
 14879*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 14880*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 14881*              THE EDIT ROUTINE.                              *
 14882*     7. REWRITE THE NEW ISSUE                                *
 14883*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 14884*                                                             *
 14885***************************************************************
 14886 2300-CHANGE-CANCEL-ROUTINE.
 14887     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 14888
 14889     IF CCHGL NOT = ZEROS
 14890        MOVE ER-2196             TO EMI-ERROR
 14891        MOVE AL-UABON            TO CMAINTA
 14892        MOVE -1                  TO CMAINTL
 14893        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14894        GO TO 8200-SEND-DATAONLY.
 14895
 14896     MOVE CCERTNOI               TO WS-NEW-PRIME.
 14897
 14898     IF CSUFIXL NOT = ZEROS
 14899        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 14900     ELSE
 14901        MOVE SPACE               TO WS-NEW-SUFFIX.
 14902
 14903     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14904     PERFORM 8600-DEEDIT.
 14905     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14906     MOVE '4'                    TO DC-OPTION-CODE.
 14907
 14908     PERFORM 9700-DATE-LINK.
 14909
 14910     IF DATE-CONVERSION-ERROR
 14911        MOVE ER-0348             TO EMI-ERROR
 14912        MOVE -1                  TO CEFFDTL
 14913        MOVE AL-UABON            TO CEFFDTA
 14914        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14915        GO TO 8200-SEND-DATAONLY
 14916     ELSE
 14917        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14918        MOVE AL-UANON            TO CEFFDTA
 14919        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14920
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 275
* EL6311.cbl
 14921 2325-PROCESS-CANCEL-CHANGES.
 14922
 14923* EXEC CICS HANDLE CONDITION
 14924*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 14925*    END-EXEC.
 14926*    MOVE '"$I                   ! 5 #00013318' TO DFHEIV0
 14927     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14929     MOVE X'3520233030303133333138' TO DFHEIV0(25:11)
 14930     CALL 'kxdfhei1' USING DFHEIV0
 14931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14932
 14933
 14934     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 14935     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14936     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14937
 14938
 14939* EXEC CICS GETMAIN
 14940*        SET      (ADDRESS OF PENDING-BUSINESS)
 14941*        LENGTH   (ERPNDB-RECORD-LENGTH)
 14942*        INITIMG  (GETMAIN-SPACE)
 14943*     END-EXEC.
 14944*    MOVE ',"IL                  $   #00013326' TO DFHEIV0
 14945     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14946     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14947     MOVE X'2020233030303133333236' TO DFHEIV0(25:11)
 14948     CALL 'kxdfhei1' USING DFHEIV0,
 14949           DFHEIV20,
 14950           ERPNDB-RECORD-LENGTH,
 14951           GETMAIN-SPACE
 14952     SET ADDRESS OF PENDING-BUSINESS TO
 14953         DFHEIV20
 14954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14955
 14956
 14957
 14958* EXEC CICS READ
 14959*        INTO    (PENDING-BUSINESS)
 14960*        DATASET (FILE-ID-ERPNDB)
 14961*        RIDFLD  (ERPNDB-KEY)
 14962*    END-EXEC.
 14963     MOVE LENGTH OF
 14964      PENDING-BUSINESS
 14965       TO DFHEIV11
 14966*    MOVE '&"IL       E          (   #00013332' TO DFHEIV0
 14967     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14968     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14969     MOVE X'2020233030303133333332' TO DFHEIV0(25:11)
 14970     CALL 'kxdfhei1' USING DFHEIV0,
 14971           FILE-ID-ERPNDB,
 14972           PENDING-BUSINESS,
 14973           DFHEIV11,
 14974           ERPNDB-KEY,
 14975           DFHEIV99,
 14976           DFHEIV99,
 14977           DFHEIV99
 14978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 276
* EL6311.cbl
 14979
 14980
 14981     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14982
 14983
 14984* EXEC CICS HANDLE CONDITION
 14985*         NOTFND     (2385-REC-NOT-FOUND)
 14986*    END-EXEC.
 14987*    MOVE '"$I                   ! 6 #00013340' TO DFHEIV0
 14988     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14989     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14990     MOVE X'3620233030303133333430' TO DFHEIV0(25:11)
 14991     CALL 'kxdfhei1' USING DFHEIV0
 14992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14993
 14994
 14995**********************************************************
 14996*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 14997*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 14998**********************************************************
 14999
 15000
 15001* EXEC CICS READ
 15002*        DATASET (FILE-ID-ERPNDB)
 15003*        INTO    (PENDING-BUSINESS)
 15004*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15005*    END-EXEC.
 15006     MOVE LENGTH OF
 15007      PENDING-BUSINESS
 15008       TO DFHEIV11
 15009*    MOVE '&"IL       E          (   #00013349' TO DFHEIV0
 15010     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15011     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15012     MOVE X'2020233030303133333439' TO DFHEIV0(25:11)
 15013     CALL 'kxdfhei1' USING DFHEIV0,
 15014           FILE-ID-ERPNDB,
 15015           PENDING-BUSINESS,
 15016           DFHEIV11,
 15017           PI-PREV-CONTROL-PRIMARY,
 15018           DFHEIV99,
 15019           DFHEIV99,
 15020           DFHEIV99
 15021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15022
 15023
 15024********** DO NOT ALLOW CHANGES IF THRU A/R
 15025     IF BMAINTI = 'C'
 15026         IF PB-EL860-INTERNAL-PROCESS
 15027             MOVE ER-4005          TO EMI-ERROR
 15028             MOVE -1               TO BMAINTL
 15029             MOVE AL-UABON         TO BMAINTA
 15030             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15031             GO TO 8200-SEND-DATAONLY.
 15032**********
 15033
 15034     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15035        MOVE -1                 TO CMAINTL
 15036        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 277
* EL6311.cbl
 15037        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15038        GO TO 8200-SEND-DATAONLY.
 15039
 15040     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15041        MOVE ER-2196             TO EMI-ERROR
 15042        MOVE AL-UABON            TO CMAINTA
 15043        MOVE -1                  TO CMAINTL
 15044        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15045        GO TO 8200-SEND-DATAONLY.
 15046     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15047
 15048     IF PB-BILLED-DT = LOW-VALUES AND
 15049        PB-CHG-COUNT = ZEROS
 15050        NEXT SENTENCE
 15051     ELSE
 15052        IF (CREFND1L GREATER THAN ZEROS AND
 15053            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15054           OR
 15055           (CREFND2L GREATER THAN ZEROS AND
 15056            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15057           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15058
 15059
 15060* EXEC CICS READ
 15061*        DATASET (FILE-ID-ERPNDB)
 15062*        INTO    (PENDING-BUSINESS)
 15063*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15064*        UPDATE
 15065*    END-EXEC.
 15066     MOVE LENGTH OF
 15067      PENDING-BUSINESS
 15068       TO DFHEIV11
 15069*    MOVE '&"IL       EU         (   #00013390' TO DFHEIV0
 15070     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15071     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15072     MOVE X'2020233030303133333930' TO DFHEIV0(25:11)
 15073     CALL 'kxdfhei1' USING DFHEIV0,
 15074           FILE-ID-ERPNDB,
 15075           PENDING-BUSINESS,
 15076           DFHEIV11,
 15077           PI-PREV-CONTROL-PRIMARY,
 15078           DFHEIV99,
 15079           DFHEIV99,
 15080           DFHEIV99
 15081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15082
 15083
 15084     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15085     MOVE 'B'                    TO JP-RECORD-TYPE
 15086     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15087     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15088
 15089     PERFORM 8400-LOG-JOURNAL-RECORD.
 15090
 15091     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15092          PB-CHG-COUNT NOT = ZEROS
 15093        IF (CREFND1L GREATER THAN ZEROS AND
 15094            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 278
* EL6311.cbl
 15095           OR
 15096           (CREFND2L GREATER THAN ZEROS AND
 15097            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15098            ADD +1                      TO PB-CHG-COUNT
 15099            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15100
 15101*    IF CMICRNOL  GREATER  ZEROS
 15102*        IF CMICRNOI  NUMERIC
 15103*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15104*            MOVE AL-UNNON       TO  CMICRNOA
 15105*        ELSE
 15106*            MOVE -1             TO  CMICRNOL
 15107*            MOVE AL-UNBON       TO  CMICRNOA
 15108*            MOVE ER-2701        TO  EMI-ERROR
 15109*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15110
 15111     IF CSUFIXL GREATER THAN ZEROS
 15112        MOVE CSUFIXI             TO PB-CERT-SFX.
 15113
 15114     IF CLSTNML GREATER THAN ZEROS
 15115         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15116
 15117     IF CCANREAL > ZEROS
 15118        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15119     END-IF
 15120     IF CPCYNL > ZEROS
 15121        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15122     END-IF
 15123     IF CCANDT1L    GREATER THAN ZEROS
 15124        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15125
 15126     IF CCANDT2L    GREATER THAN ZEROS
 15127        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15128
 15129     IF CMTHD1L    GREATER THAN +0
 15130        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15131
 15132     IF CMTHD2L    GREATER THAN +0
 15133        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15134
 15135     IF CREFND1L    GREATER THAN ZEROS
 15136        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15137        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15138        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15139        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15140
 15141     IF CREFND2L    GREATER THAN ZEROS
 15142        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15143        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15144        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15145        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15146
 15147     IF CLIVESL     GREATER THAN ZEROS
 15148        MOVE WS-CLIVES           TO PB-C-LIVES.
 15149
 15150     IF CPAYEEL     GREATER THAN ZEROS
 15151        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15152
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 279
* EL6311.cbl
 15153     IF CFORCEL     GREATER THAN ZEROS
 15154        MOVE CFORCEI             TO PB-FORCE-CODE.
 15155
 15156     IF CBILCDL     GREATER THAN ZEROS
 15157        MOVE CBILCDI             TO PB-RECORD-BILL.
 15158
 15159 2360-REWRITE-PB-RECORD.
 15160     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15161     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15162     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15163     MOVE 'C'                    TO JP-RECORD-TYPE.
 15164     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15165     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15166     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15167
 15168     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15169
 15170     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15171     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15172
 15173     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15174
 15175     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15176
 15177     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15178     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15179     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15180
 15181     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15182     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15183
 15184 2375-REWRITE-PENDING-BUSINESS.
 15185     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15186     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15187     MOVE 'C'                    TO JP-RECORD-TYPE.
 15188     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15189
 15190
 15191* EXEC CICS REWRITE
 15192*        DATASET (FILE-ID-ERPNDB)
 15193*        FROM    (PENDING-BUSINESS)
 15194*    END-EXEC.
 15195     MOVE LENGTH OF
 15196      PENDING-BUSINESS
 15197       TO DFHEIV11
 15198*    MOVE '&& L                  %   #00013503' TO DFHEIV0
 15199     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15200     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15201     MOVE X'2020233030303133353033' TO DFHEIV0(25:11)
 15202     CALL 'kxdfhei1' USING DFHEIV0,
 15203           FILE-ID-ERPNDB,
 15204           PENDING-BUSINESS,
 15205           DFHEIV11,
 15206           DFHEIV99
 15207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15208
 15209
 15210     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 280
* EL6311.cbl
 15211
 15212******************************************************************
 15213*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15214******************************************************************
 15215
 15216     display ' made it to update orig cancel cert '
 15217
 15218     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15219     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15220     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15221     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15222
 15223
 15224* EXEC CICS READ
 15225*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15226*        DATASET (FILE-ID-ELCERT)
 15227*        RIDFLD  (ELCERT-KEY)
 15228*        RESP    (WS-RESPONSE)
 15229*    END-EXEC.
 15230*    MOVE '&"S        E          (  N#00013521' TO DFHEIV0
 15231     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15232     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15233     MOVE X'204E233030303133353231' TO DFHEIV0(25:11)
 15234     CALL 'kxdfhei1' USING DFHEIV0,
 15235           FILE-ID-ELCERT,
 15236           DFHEIV20,
 15237           DFHEIV99,
 15238           ELCERT-KEY,
 15239           DFHEIV99,
 15240           DFHEIV99,
 15241           DFHEIV99
 15242     SET ADDRESS OF CERTIFICATE-MASTER TO
 15243         DFHEIV20
 15244     MOVE EIBRESP  TO WS-RESPONSE
 15245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15246
 15247
 15248     IF NOT RESP-NORMAL
 15249        GO TO 2376-BYPASS-CRTO
 15250     END-IF
 15251
 15252
 15253     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15254     MOVE ' '                    TO WS-ERMAIL-SW
 15255
 15256
 15257* EXEC CICS READ
 15258*       DATASET   (FILE-ID-ERMAIL)
 15259*       SET       (ADDRESS OF MAILING-DATA)
 15260*       RIDFLD    (ERMAIL-KEY)
 15261*       RESP      (WS-RESPONSE)
 15262*    END-EXEC
 15263*    MOVE '&"S        E          (  N#00013536' TO DFHEIV0
 15264     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15265     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15266     MOVE X'204E233030303133353336' TO DFHEIV0(25:11)
 15267     CALL 'kxdfhei1' USING DFHEIV0,
 15268           FILE-ID-ERMAIL,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 281
* EL6311.cbl
 15269           DFHEIV20,
 15270           DFHEIV99,
 15271           ERMAIL-KEY,
 15272           DFHEIV99,
 15273           DFHEIV99,
 15274           DFHEIV99
 15275     SET ADDRESS OF MAILING-DATA TO
 15276         DFHEIV20
 15277     MOVE EIBRESP  TO WS-RESPONSE
 15278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15279
 15280     IF RESP-NORMAL
 15281        SET ERMAIL-FOUND TO TRUE
 15282     END-IF
 15283
 15284     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15285
 15286     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15287                                 TO ELCRTO-KEY
 15288     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15289     MOVE +0                     TO ELCRTO-SEQ-NO
 15290
 15291
 15292* EXEC CICS READ
 15293*       DATASET   ('ELCRTO')
 15294*       INTO      (ORIGINAL-CERTIFICATE)
 15295*       RIDFLD    (ELCRTO-KEY)
 15296*       GTEQ
 15297*       RESP      (WS-RESPONSE)
 15298*    END-EXEC
 15299     MOVE LENGTH OF
 15300      ORIGINAL-CERTIFICATE
 15301       TO DFHEIV11
 15302     MOVE 'ELCRTO' TO DFHEIV1
 15303*    MOVE '&"IL       G          (  N#00013554' TO DFHEIV0
 15304     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15305     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15306     MOVE X'204E233030303133353534' TO DFHEIV0(25:11)
 15307     CALL 'kxdfhei1' USING DFHEIV0,
 15308           DFHEIV1,
 15309           ORIGINAL-CERTIFICATE,
 15310           DFHEIV11,
 15311           ELCRTO-KEY,
 15312           DFHEIV99,
 15313           DFHEIV99,
 15314           DFHEIV99
 15315     MOVE EIBRESP  TO WS-RESPONSE
 15316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15317
 15318     display ' just read gteq ' ws-response
 15319     IF RESP-NORMAL
 15320        AND (OC-CONTROL-PRIMARY (1:33) =
 15321                 PB-CONTROL-BY-ACCOUNT (1:33))
 15322        AND (OC-RECORD-TYPE = 'I')
 15323        display ' resp norm, key =, type i '
 15324        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15325           display ' end proc blank '
 15326           display ' csr edit session ' PI-CSR-SESSION-SW
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 282
* EL6311.cbl
 15327           IF NOT CSR-EDIT-SESSION
 15328
 15329* EXEC CICS READ
 15330*                DATASET   ('ELCRTO')
 15331*                INTO      (ORIGINAL-CERTIFICATE)
 15332*                RIDFLD    (OC-CONTROL-PRIMARY)
 15333*                UPDATE
 15334*                RESP      (WS-RESPONSE)
 15335*             END-EXEC
 15336     MOVE LENGTH OF
 15337      ORIGINAL-CERTIFICATE
 15338       TO DFHEIV11
 15339     MOVE 'ELCRTO' TO DFHEIV1
 15340*    MOVE '&"IL       EU         (  N#00013572' TO DFHEIV0
 15341     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15342     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15343     MOVE X'204E233030303133353732' TO DFHEIV0(25:11)
 15344     CALL 'kxdfhei1' USING DFHEIV0,
 15345           DFHEIV1,
 15346           ORIGINAL-CERTIFICATE,
 15347           DFHEIV11,
 15348           OC-CONTROL-PRIMARY,
 15349           DFHEIV99,
 15350           DFHEIV99,
 15351           DFHEIV99
 15352     MOVE EIBRESP  TO WS-RESPONSE
 15353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15354              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15355              IF RESP-NORMAL
 15356                 display ' good read upd '
 15357                 IF OC-ISSUE-TRAN-IND = 'N'
 15358                    MOVE CM-INSURED-LAST-NAME   TO
 15359                         OC-INS-LAST-NAME
 15360                    MOVE CM-INSURED-FIRST-NAME  TO
 15361                         OC-INS-FIRST-NAME
 15362                    MOVE CM-INSURED-INITIAL2    TO
 15363                         OC-INS-MIDDLE-INIT
 15364                    MOVE CM-INSURED-ISSUE-AGE   TO
 15365                         OC-INS-AGE
 15366                    MOVE CM-JT-LAST-NAME        TO
 15367                         OC-JNT-LAST-NAME
 15368                    MOVE CM-JT-FIRST-NAME       TO
 15369                         OC-JNT-FIRST-NAME
 15370                    MOVE CM-JT-INITIAL          TO
 15371                         OC-JNT-MIDDLE-INIT
 15372                    MOVE CM-INSURED-JOINT-AGE   TO
 15373                         OC-JNT-AGE
 15374                    MOVE CM-LF-BENEFIT-CD       TO
 15375                         OC-LF-BENCD
 15376                    MOVE CM-LF-ORIG-TERM        TO
 15377                         OC-LF-TERM
 15378                    MOVE CM-LF-BENEFIT-AMT      TO
 15379                         OC-LF-BEN-AMT
 15380                    MOVE CM-LF-PREMIUM-AMT      TO
 15381                         OC-LF-PRM-AMT
 15382                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15383                         OC-LF-ALT-BEN-AMT
 15384                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 283
* EL6311.cbl
 15385                         OC-LF-ALT-PRM-AMT
 15386                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15387                         OC-LF-EXP-DT
 15388                    MOVE CM-LIFE-COMM-PCT       TO
 15389                         OC-LF-COMM-PCT
 15390                    MOVE CM-AH-BENEFIT-CD       TO
 15391                         OC-AH-BENCD
 15392                    MOVE CM-AH-ORIG-TERM        TO
 15393                         OC-AH-TERM
 15394                    MOVE CM-AH-BENEFIT-AMT      TO
 15395                         OC-AH-BEN-AMT
 15396                    MOVE CM-AH-PREMIUM-AMT      TO
 15397                         OC-AH-PRM-AMT
 15398                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15399                         OC-AH-EXP-DT
 15400                    MOVE CM-AH-COMM-PCT         TO
 15401                         OC-AH-COMM-PCT
 15402                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15403                         OC-AH-CP
 15404                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15405                         OC-1ST-PMT-DT
 15406                 END-IF
 15407                 MOVE PB-C-LF-CANCEL-DT      TO
 15408                         OC-LF-CANCEL-DT
 15409                 MOVE PB-C-LF-CANCEL-AMT     TO
 15410                         OC-LF-CANCEL-AMT
 15411                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15412                         OC-LF-ITD-CANCEL-AMT
 15413                 MOVE PB-C-AH-CANCEL-DT      TO
 15414                         OC-AH-CANCEL-DT
 15415                 MOVE PB-C-AH-CANCEL-AMT     TO
 15416                         OC-AH-CANCEL-AMT
 15417                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15418                         OC-AH-ITD-CANCEL-AMT
 15419                 MOVE 'Y'                    TO
 15420                         OC-CANCEL-TRAN-IND
 15421                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15422                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15423                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15424                 IF ERMAIL-FOUND
 15425                    MOVE MA-CRED-BENE-NAME
 15426                                 TO OC-CRED-BENE-NAME
 15427                 END-IF
 15428                 IF NOT CERT-TRL-REC-NOT-FOUND
 15429                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15430                           OC-INS-AGE-DEFAULT-FLAG
 15431                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15432                           OC-JNT-AGE-DEFAULT-FLAG
 15433                 END-IF
 15434
 15435* EXEC CICS REWRITE
 15436*                   DATASET   ('ELCRTO')
 15437*                   FROM      (ORIGINAL-CERTIFICATE)
 15438*                   RESP      (WS-RESPONSE)
 15439*                END-EXEC
 15440     MOVE LENGTH OF
 15441      ORIGINAL-CERTIFICATE
 15442       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 284
* EL6311.cbl
 15443     MOVE 'ELCRTO' TO DFHEIV1
 15444*    MOVE '&& L                  %  N#00013659' TO DFHEIV0
 15445     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15446     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15447     MOVE X'204E233030303133363539' TO DFHEIV0(25:11)
 15448     CALL 'kxdfhei1' USING DFHEIV0,
 15449           DFHEIV1,
 15450           ORIGINAL-CERTIFICATE,
 15451           DFHEIV11,
 15452           DFHEIV99
 15453     MOVE EIBRESP  TO WS-RESPONSE
 15454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15455                 display ' just rewrote ' ws-response
 15456              END-IF
 15457           END-IF
 15458        ELSE
 15459           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15460           MOVE 'OC'             TO OC-RECORD-ID
 15461           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15462           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15463           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15464           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15465           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15466           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15467           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15468           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15469           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15470           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15471           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15472           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15473           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15474           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15475           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15476           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15477           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15478           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15479           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15480           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15481           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15482           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15483           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15484           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15485           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15486           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15487           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15488           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15489           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15490           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15491           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15492           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15493           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15494           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15495           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15496           IF ERMAIL-FOUND
 15497              MOVE MA-CRED-BENE-NAME
 15498                                 TO OC-CRED-BENE-NAME
 15499           END-IF
 15500           IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 285
* EL6311.cbl
 15501              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15502                           OC-INS-AGE-DEFAULT-FLAG
 15503              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15504                           OC-JNT-AGE-DEFAULT-FLAG
 15505           END-IF
 15506           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15507
 15508* EXEC CICS WRITE
 15509*             DATASET   ('ELCRTO')
 15510*             FROM      (ORIGINAL-CERTIFICATE)
 15511*             RIDFLD    (OC-CONTROL-PRIMARY)
 15512*             RESP      (WS-RESPONSE)
 15513*          END-EXEC
 15514     MOVE LENGTH OF
 15515      ORIGINAL-CERTIFICATE
 15516       TO DFHEIV11
 15517     MOVE 'ELCRTO' TO DFHEIV1
 15518*    MOVE '&$ L                  ''  N#00013716' TO DFHEIV0
 15519     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15520     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15521     MOVE X'204E233030303133373136' TO DFHEIV0(25:11)
 15522     CALL 'kxdfhei1' USING DFHEIV0,
 15523           DFHEIV1,
 15524           ORIGINAL-CERTIFICATE,
 15525           DFHEIV11,
 15526           OC-CONTROL-PRIMARY,
 15527           DFHEIV99,
 15528           DFHEIV99
 15529     MOVE EIBRESP  TO WS-RESPONSE
 15530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15531        END-IF
 15532     ELSE
 15533        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15534        MOVE 'OC'                TO OC-RECORD-ID
 15535        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15536                                 TO OC-CONTROL-PRIMARY (1:33)
 15537        MOVE 'I'                 TO OC-RECORD-TYPE
 15538        MOVE +4096               TO OC-KEY-SEQ-NO
 15539        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15540        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15541        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15542        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15543        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15544        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15545        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15546        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15547        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15548        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15549        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15550        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15551        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15552        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15553        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15554        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15555        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15556        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15557        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15558        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 286
* EL6311.cbl
 15559        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15560        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15561        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15562        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15563        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15564        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15565        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15566        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15567        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15568        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15569        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15570        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15571        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15572        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15573        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15574        IF ERMAIL-FOUND
 15575           MOVE MA-CRED-BENE-NAME
 15576                                 TO OC-CRED-BENE-NAME
 15577        END-IF
 15578        IF NOT CERT-TRL-REC-NOT-FOUND
 15579           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15580                           OC-INS-AGE-DEFAULT-FLAG
 15581           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15582                           OC-JNT-AGE-DEFAULT-FLAG
 15583        END-IF
 15584        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15585
 15586
 15587* EXEC CICS WRITE
 15588*          DATASET   ('ELCRTO')
 15589*          FROM      (ORIGINAL-CERTIFICATE)
 15590*          RIDFLD    (OC-CONTROL-PRIMARY)
 15591*          RESP      (WS-RESPONSE)
 15592*       END-EXEC
 15593     MOVE LENGTH OF
 15594      ORIGINAL-CERTIFICATE
 15595       TO DFHEIV11
 15596     MOVE 'ELCRTO' TO DFHEIV1
 15597*    MOVE '&$ L                  ''  N#00013777' TO DFHEIV0
 15598     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15599     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15600     MOVE X'204E233030303133373737' TO DFHEIV0(25:11)
 15601     CALL 'kxdfhei1' USING DFHEIV0,
 15602           DFHEIV1,
 15603           ORIGINAL-CERTIFICATE,
 15604           DFHEIV11,
 15605           OC-CONTROL-PRIMARY,
 15606           DFHEIV99,
 15607           DFHEIV99
 15608     MOVE EIBRESP  TO WS-RESPONSE
 15609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15610     END-IF.
 15611
 15612 2376-BYPASS-CRTO.
 15613******************************************************************
 15614*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15615******************************************************************
 15616
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 287
* EL6311.cbl
 15617
 15618* EXEC CICS HANDLE CONDITION
 15619*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15620*    END-EXEC.
 15621*    MOVE '"$I                   ! 7 #00013790' TO DFHEIV0
 15622     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15624     MOVE X'3720233030303133373930' TO DFHEIV0(25:11)
 15625     CALL 'kxdfhei1' USING DFHEIV0
 15626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15627
 15628
 15629
 15630* EXEC CICS READ
 15631*        INTO    (PENDING-BUSINESS)
 15632*        DATASET (FILE-ID-ERPNDB)
 15633*        RIDFLD  (ERPNDB-KEY)
 15634*        UPDATE
 15635*    END-EXEC.
 15636     MOVE LENGTH OF
 15637      PENDING-BUSINESS
 15638       TO DFHEIV11
 15639*    MOVE '&"IL       EU         (   #00013794' TO DFHEIV0
 15640     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15641     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15642     MOVE X'2020233030303133373934' TO DFHEIV0(25:11)
 15643     CALL 'kxdfhei1' USING DFHEIV0,
 15644           FILE-ID-ERPNDB,
 15645           PENDING-BUSINESS,
 15646           DFHEIV11,
 15647           ERPNDB-KEY,
 15648           DFHEIV99,
 15649           DFHEIV99,
 15650           DFHEIV99
 15651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15652
 15653
 15654     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15655     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15656     MOVE 'B'                    TO JP-RECORD-TYPE.
 15657     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15658
 15659     PERFORM 8400-LOG-JOURNAL-RECORD.
 15660
 15661     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15662
 15663
 15664* EXEC CICS REWRITE
 15665*        DATASET (FILE-ID-ERPNDB)
 15666*        FROM    (PENDING-BUSINESS)
 15667*    END-EXEC.
 15668     MOVE LENGTH OF
 15669      PENDING-BUSINESS
 15670       TO DFHEIV11
 15671*    MOVE '&& L                  %   #00013810' TO DFHEIV0
 15672     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15673     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15674     MOVE X'2020233030303133383130' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 288
* EL6311.cbl
 15675     CALL 'kxdfhei1' USING DFHEIV0,
 15676           FILE-ID-ERPNDB,
 15677           PENDING-BUSINESS,
 15678           DFHEIV11,
 15679           DFHEIV99
 15680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15681
 15682
 15683     MOVE 'C'                    TO JP-RECORD-TYPE.
 15684     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15685
 15686     PERFORM 8400-LOG-JOURNAL-RECORD.
 15687
 15688     IF WS-ERRORS-PRESENT
 15689         GO TO 3900-RE-DISPLAY-RECORD.
 15690
 15691     MOVE ZEROS                  TO EMI-ERROR
 15692     MOVE -1                     TO CMAINTL
 15693     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15694     GO TO 3900-RE-DISPLAY-RECORD.
 15695
 15696 2380-BATCH-HDR-NOT-FOUND.
 15697     MOVE -1                     TO BMAINTL.
 15698     MOVE ER-7450                TO EMI-ERROR.
 15699     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15700     GO TO 8200-SEND-DATAONLY.
 15701
 15702 2385-REC-NOT-FOUND.
 15703     MOVE -1                     TO BMAINTL.
 15704     MOVE ER-7451                TO EMI-ERROR.
 15705     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15706     GO TO 8200-SEND-DATAONLY.
 15707
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 289
* EL6311.cbl
 15709
 15710******************************************************************
 15711*                                                                *
 15712*          D E L E T E   C A N C E L   R O U T I N E             *
 15713*                                                                *
 15714******************************************************************
 15715
 15716 2400-DELETE-CANCEL-ROUTINE.
 15717     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15718
 15719     IF CCHGL NOT = ZEROS
 15720        MOVE ER-2196             TO EMI-ERROR
 15721        MOVE AL-UABON            TO CMAINTA
 15722        MOVE -1                  TO CMAINTL
 15723        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15724        GO TO 8200-SEND-DATAONLY.
 15725
 15726
 15727* EXEC CICS HANDLE CONDITION
 15728*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15729*    END-EXEC.
 15730*    MOVE '"$I                   ! 8 #00013858' TO DFHEIV0
 15731     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15732     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15733     MOVE X'3820233030303133383538' TO DFHEIV0(25:11)
 15734     CALL 'kxdfhei1' USING DFHEIV0
 15735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15736
 15737
 15738     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15739     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15740     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15741
 15742
 15743* EXEC CICS READ
 15744*        SET     (ADDRESS OF PENDING-BUSINESS)
 15745*        DATASET (FILE-ID-ERPNDB)
 15746*        RIDFLD  (ERPNDB-KEY)
 15747*    END-EXEC.
 15748*    MOVE '&"S        E          (   #00013866' TO DFHEIV0
 15749     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15750     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15751     MOVE X'2020233030303133383636' TO DFHEIV0(25:11)
 15752     CALL 'kxdfhei1' USING DFHEIV0,
 15753           FILE-ID-ERPNDB,
 15754           DFHEIV20,
 15755           DFHEIV99,
 15756           ERPNDB-KEY,
 15757           DFHEIV99,
 15758           DFHEIV99,
 15759           DFHEIV99
 15760     SET ADDRESS OF PENDING-BUSINESS TO
 15761         DFHEIV20
 15762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15763
 15764
 15765     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15766
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 290
* EL6311.cbl
 15767     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15768
 15769     IF CSUFIXL NOT = ZEROS
 15770        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15771     ELSE
 15772        MOVE SPACE               TO WS-NEW-SUFFIX.
 15773
 15774     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15775
 15776     PERFORM 8600-DEEDIT.
 15777     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15778     MOVE '4'                    TO DC-OPTION-CODE.
 15779     PERFORM 9700-DATE-LINK.
 15780
 15781     IF DATE-CONVERSION-ERROR
 15782        MOVE ER-0348             TO EMI-ERROR
 15783        MOVE -1                  TO CEFFDTL
 15784        MOVE AL-UABON            TO CEFFDTA
 15785        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15786        GO TO 8200-SEND-DATAONLY
 15787     ELSE
 15788        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15789        MOVE AL-UANON            TO CEFFDTA
 15790        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15791
 15792
 15793* EXEC CICS HANDLE CONDITION
 15794*         NOTFND    (2490-RECORD-NOT-FOUND)
 15795*    END-EXEC.
 15796*    MOVE '"$I                   ! 9 #00013899' TO DFHEIV0
 15797     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15798     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15799     MOVE X'3920233030303133383939' TO DFHEIV0(25:11)
 15800     CALL 'kxdfhei1' USING DFHEIV0
 15801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15802
 15803
 15804
 15805* EXEC CICS READ
 15806*        SET     (ADDRESS OF PENDING-BUSINESS)
 15807*        DATASET (FILE-ID-ERPNDB)
 15808*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15809*        UPDATE
 15810*    END-EXEC.
 15811*    MOVE '&"S        EU         (   #00013903' TO DFHEIV0
 15812     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15813     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15814     MOVE X'2020233030303133393033' TO DFHEIV0(25:11)
 15815     CALL 'kxdfhei1' USING DFHEIV0,
 15816           FILE-ID-ERPNDB,
 15817           DFHEIV20,
 15818           DFHEIV99,
 15819           PI-PREV-CONTROL-PRIMARY,
 15820           DFHEIV99,
 15821           DFHEIV99,
 15822           DFHEIV99
 15823     SET ADDRESS OF PENDING-BUSINESS TO
 15824         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 291
* EL6311.cbl
 15825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15826
 15827
 15828     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15829        MOVE -1                 TO CMAINTL
 15830        MOVE ER-2197            TO EMI-ERROR
 15831        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15832        GO TO 8200-SEND-DATAONLY.
 15833
 15834     IF PB-BILLED-DT NOT = LOW-VALUES
 15835        MOVE -1                 TO CMAINTL
 15836        MOVE ER-2129            TO EMI-ERROR
 15837        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15838        GO TO 8200-SEND-DATAONLY.
 15839
 15840     IF PB-CHG-COUNT NOT = ZEROS
 15841        MOVE ER-2336            TO EMI-ERROR
 15842        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15843        MOVE AL-UABON            TO CMAINTA
 15844        MOVE -1                  TO CMAINTL
 15845        GO TO 8200-SEND-DATAONLY.
 15846
 15847     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 15848        PB-CHG-COUNT NOT = ZEROS
 15849        MOVE ER-2196             TO EMI-ERROR
 15850        MOVE AL-UABON            TO CMAINTA
 15851        MOVE -1                  TO CMAINTL
 15852        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15853        GO TO 8200-SEND-DATAONLY.
 15854
 15855     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 15856        MOVE ER-2900 TO EMI-ERROR
 15857        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15858        MOVE AL-UABON         TO CMAINTA
 15859        MOVE -1               TO CMAINTL
 15860        GO TO 8200-SEND-DATAONLY.
 15861
 15862
 15863* EXEC CICS HANDLE CONDITION
 15864*         NOTFND  (2475-CONTINUE-DELETE)
 15865*    END-EXEC
 15866*    MOVE '"$I                   ! : #00013944' TO DFHEIV0
 15867     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15868     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15869     MOVE X'3A20233030303133393434' TO DFHEIV0(25:11)
 15870     CALL 'kxdfhei1' USING DFHEIV0
 15871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15872
 15873     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15874     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15875     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15876     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15877
 15878
 15879* EXEC CICS READ
 15880*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15881*        DATASET (FILE-ID-ELCERT)
 15882*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 292
* EL6311.cbl
 15883*        UPDATE
 15884*    END-EXEC.
 15885*    MOVE '&"S        EU         (   #00013953' TO DFHEIV0
 15886     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15887     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15888     MOVE X'2020233030303133393533' TO DFHEIV0(25:11)
 15889     CALL 'kxdfhei1' USING DFHEIV0,
 15890           FILE-ID-ELCERT,
 15891           DFHEIV20,
 15892           DFHEIV99,
 15893           ELCERT-KEY,
 15894           DFHEIV99,
 15895           DFHEIV99,
 15896           DFHEIV99
 15897     SET ADDRESS OF CERTIFICATE-MASTER TO
 15898         DFHEIV20
 15899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15900
 15901
 15902     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15903
 15904     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 15905     MOVE 'B'                    TO JP-RECORD-TYPE.
 15906     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 15907     PERFORM 8400-LOG-JOURNAL-RECORD.
 15908
 15909     IF PB-CI-LIVES NOT NUMERIC
 15910         MOVE ZERO                    TO PB-CI-LIVES.
 15911
 15912     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15913        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15914           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15915           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 15916           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 15917                                            CM-LF-CANCEL-DT
 15918           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 15919        ELSE
 15920           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15921           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 15922           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 15923           MOVE PB-CI-LIVES              TO CM-LIVES.
 15924
 15925     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15926        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15927           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15928               MOVE CM-LF-STATUS-AT-CANCEL
 15929                                        TO CM-LF-CURRENT-STATUS
 15930               MOVE SPACE
 15931                                        TO CM-LF-STATUS-AT-CANCEL
 15932           ELSE
 15933               MOVE PB-CI-LF-POLICY-STATUS
 15934                                        TO CM-LF-CURRENT-STATUS
 15935        ELSE
 15936           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 15937
 15938
 15939     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15940        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 293
* EL6311.cbl
 15941           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15942           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 15943           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 15944                                            CM-AH-CANCEL-DT
 15945           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 15946        ELSE
 15947           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15948           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 15949           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 15950           MOVE PB-CI-LIVES              TO CM-LIVES.
 15951
 15952     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15953        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 15954           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15955               MOVE CM-AH-STATUS-AT-CANCEL
 15956                                        TO CM-AH-CURRENT-STATUS
 15957               MOVE SPACE
 15958                                        TO CM-AH-STATUS-AT-CANCEL
 15959           ELSE
 15960               MOVE PB-CI-AH-POLICY-STATUS
 15961                                        TO CM-AH-CURRENT-STATUS
 15962        ELSE
 15963           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 15964
 15965 2450-REWRITE-CERT.
 15966     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 15967     MOVE 'C'                      TO JP-RECORD-TYPE.
 15968     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 15969
 15970
 15971* EXEC CICS REWRITE
 15972*        DATASET  (FILE-ID-ELCERT)
 15973*        FROM     (CERTIFICATE-MASTER)
 15974*    END-EXEC.
 15975     MOVE LENGTH OF
 15976      CERTIFICATE-MASTER
 15977       TO DFHEIV11
 15978*    MOVE '&& L                  %   #00014028' TO DFHEIV0
 15979     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15980     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15981     MOVE X'2020233030303134303238' TO DFHEIV0(25:11)
 15982     CALL 'kxdfhei1' USING DFHEIV0,
 15983           FILE-ID-ELCERT,
 15984           CERTIFICATE-MASTER,
 15985           DFHEIV11,
 15986           DFHEIV99
 15987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15988
 15989
 15990     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15991
 15992     PERFORM 8400-LOG-JOURNAL-RECORD.
 15993
 15994 2475-CONTINUE-DELETE.
 15995     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 15996     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 15997
 15998     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 294
* EL6311.cbl
 15999     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16000
 16001     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16002
 16003     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16004     MOVE 'D'                    TO JP-RECORD-TYPE
 16005     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16006
 16007
 16008* EXEC CICS DELETE
 16009*        DATASET    (FILE-ID-ERPNDB)
 16010*    END-EXEC.
 16011*    MOVE '&(                    &   #00014050' TO DFHEIV0
 16012     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16013     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16014     MOVE X'2020233030303134303530' TO DFHEIV0(25:11)
 16015     CALL 'kxdfhei1' USING DFHEIV0,
 16016           FILE-ID-ERPNDB,
 16017           DFHEIV99,
 16018           DFHEIV99,
 16019           DFHEIV99,
 16020           DFHEIV99
 16021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16022
 16023
 16024     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16025
 16026     PERFORM 8400-LOG-JOURNAL-RECORD.
 16027
 16028     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16029     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16030
 16031
 16032* EXEC CICS HANDLE CONDITION
 16033*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16034*    END-EXEC.
 16035*    MOVE '"$I                   ! ; #00014061' TO DFHEIV0
 16036     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16038     MOVE X'3B20233030303134303631' TO DFHEIV0(25:11)
 16039     CALL 'kxdfhei1' USING DFHEIV0
 16040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16041
 16042
 16043
 16044* EXEC CICS READ
 16045*        SET     (ADDRESS OF PENDING-BUSINESS)
 16046*        DATASET (FILE-ID-ERPNDB)
 16047*        RIDFLD  (ERPNDB-KEY)
 16048*        UPDATE
 16049*    END-EXEC.
 16050*    MOVE '&"S        EU         (   #00014065' TO DFHEIV0
 16051     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16052     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16053     MOVE X'2020233030303134303635' TO DFHEIV0(25:11)
 16054     CALL 'kxdfhei1' USING DFHEIV0,
 16055           FILE-ID-ERPNDB,
 16056           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 295
* EL6311.cbl
 16057           DFHEIV99,
 16058           ERPNDB-KEY,
 16059           DFHEIV99,
 16060           DFHEIV99,
 16061           DFHEIV99
 16062     SET ADDRESS OF PENDING-BUSINESS TO
 16063         DFHEIV20
 16064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16065
 16066
 16067     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16068     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16069
 16070     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16071        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16072        MOVE 'D'                 TO JP-RECORD-TYPE
 16073        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16074
 16075* EXEC CICS DELETE
 16076*            DATASET    (FILE-ID-ERPNDB)
 16077*       END-EXEC
 16078*    MOVE '&(                    &   #00014079' TO DFHEIV0
 16079     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16080     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16081     MOVE X'2020233030303134303739' TO DFHEIV0(25:11)
 16082     CALL 'kxdfhei1' USING DFHEIV0,
 16083           FILE-ID-ERPNDB,
 16084           DFHEIV99,
 16085           DFHEIV99,
 16086           DFHEIV99,
 16087           DFHEIV99
 16088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16089        PERFORM 8400-LOG-JOURNAL-RECORD
 16090     ELSE
 16091        MOVE 'B'                 TO JP-RECORD-TYPE
 16092        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16093        PERFORM 8400-LOG-JOURNAL-RECORD
 16094        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16095        MOVE 'C'                 TO JP-RECORD-TYPE
 16096        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16097
 16098* EXEC CICS REWRITE
 16099*            DATASET    (FILE-ID-ERPNDB)
 16100*            FROM       (PENDING-BUSINESS)
 16101*       END-EXEC
 16102     MOVE LENGTH OF
 16103      PENDING-BUSINESS
 16104       TO DFHEIV11
 16105*    MOVE '&& L                  %   #00014090' TO DFHEIV0
 16106     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16107     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16108     MOVE X'2020233030303134303930' TO DFHEIV0(25:11)
 16109     CALL 'kxdfhei1' USING DFHEIV0,
 16110           FILE-ID-ERPNDB,
 16111           PENDING-BUSINESS,
 16112           DFHEIV11,
 16113           DFHEIV99
 16114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 296
* EL6311.cbl
 16115        PERFORM 8400-LOG-JOURNAL-RECORD.
 16116
 16117******************************************************************
 16118*                                                                *
 16119*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16120*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16121*                                                                *
 16122******************************************************************
 16123
 16124     IF NOT PI-AR-PROCESSING
 16125        GO TO 2480-DELETE-FINISHED.
 16126
 16127     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16128        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16129        NEXT SENTENCE
 16130     ELSE
 16131        GO TO 2480-DELETE-FINISHED.
 16132
 16133
 16134* EXEC CICS HANDLE CONDITION
 16135*         NOTFND    (2480-DELETE-FINISHED)
 16136*    END-EXEC.
 16137*    MOVE '"$I                   ! < #00014112' TO DFHEIV0
 16138     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16140     MOVE X'3C20233030303134313132' TO DFHEIV0(25:11)
 16141     CALL 'kxdfhei1' USING DFHEIV0
 16142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16143
 16144
 16145     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16146     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16147
 16148
 16149* EXEC CICS READ
 16150*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16151*        DATASET (FILE-ID-ERRQST)
 16152*        RIDFLD  (ERRQST-KEY)
 16153*        UPDATE
 16154*    END-EXEC.
 16155*    MOVE '&"S        EU         (   #00014119' TO DFHEIV0
 16156     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16157     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16158     MOVE X'2020233030303134313139' TO DFHEIV0(25:11)
 16159     CALL 'kxdfhei1' USING DFHEIV0,
 16160           FILE-ID-ERRQST,
 16161           DFHEIV20,
 16162           DFHEIV99,
 16163           ERRQST-KEY,
 16164           DFHEIV99,
 16165           DFHEIV99,
 16166           DFHEIV99
 16167     SET ADDRESS OF AR-REQUEST-RECORD TO
 16168         DFHEIV20
 16169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16170
 16171
 16172     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 297
* EL6311.cbl
 16173
 16174     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16175
 16176     MOVE 'D'                      TO JP-RECORD-TYPE.
 16177     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16178
 16179
 16180* EXEC CICS DELETE
 16181*         DATASET    (FILE-ID-ERRQST)
 16182*    END-EXEC.
 16183*    MOVE '&(                    &   #00014133' TO DFHEIV0
 16184     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16185     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16186     MOVE X'2020233030303134313333' TO DFHEIV0(25:11)
 16187     CALL 'kxdfhei1' USING DFHEIV0,
 16188           FILE-ID-ERRQST,
 16189           DFHEIV99,
 16190           DFHEIV99,
 16191           DFHEIV99,
 16192           DFHEIV99
 16193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16194
 16195
 16196     PERFORM 8400-LOG-JOURNAL-RECORD.
 16197
 16198 2480-DELETE-FINISHED.
 16199     MOVE ZEROS                  TO EMI-ERROR.
 16200     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16201     MOVE LOW-VALUES             TO EL631CI.
 16202     MOVE -1                     TO CMAINTL.
 16203     GO TO 8100-SEND-INITIAL-MAP.
 16204
 16205 2485-BATCH-HDR-NOT-FOUND.
 16206     MOVE -1                     TO CMAINTL
 16207     MOVE AL-UABON               TO CMAINTA.
 16208     MOVE ER-7450                TO EMI-ERROR.
 16209     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16210     GO TO 8200-SEND-DATAONLY.
 16211
 16212 2490-RECORD-NOT-FOUND.
 16213     MOVE -1                     TO CMAINTL
 16214     MOVE AL-UABON               TO CMAINTA.
 16215     MOVE ER-7451                TO EMI-ERROR.
 16216     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16217     GO TO 8200-SEND-DATAONLY.
 16218
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 298
* EL6311.cbl
 16220
 16221***************************************************************
 16222*                                                             *
 16223*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16224*                                                             *
 16225***************************************************************
 16226
 16227***************************************************************
 16228*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16229*     AN ALREADY BILLED RECORD.                               *
 16230***************************************************************
 16231
 16232 2700-BUILD-CORRECTION-RECORD.
 16233     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16234     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16235     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16236     MOVE '5'                    TO DC-OPTION-CODE.
 16237     PERFORM 9700-DATE-LINK.
 16238     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16239
 16240     IF PB-CHG-COUNT = ZEROS
 16241        MOVE +1                  TO WS-SEQ-SAVE
 16242     ELSE
 16243        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16244
 16245     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16246     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16247
 16248     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16249
 16250     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16251     MOVE 'A'                    TO JP-RECORD-TYPE.
 16252     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16253
 16254
 16255* EXEC CICS WRITE
 16256*        DATASET    (FILE-ID-ERPNDB)
 16257*        FROM       (PENDING-BUSINESS)
 16258*        RIDFLD     (PB-CONTROL-PRIMARY)
 16259*    END-EXEC.
 16260     MOVE LENGTH OF
 16261      PENDING-BUSINESS
 16262       TO DFHEIV11
 16263*    MOVE '&$ L                  ''   #00014195' TO DFHEIV0
 16264     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16265     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16266     MOVE X'2020233030303134313935' TO DFHEIV0(25:11)
 16267     CALL 'kxdfhei1' USING DFHEIV0,
 16268           FILE-ID-ERPNDB,
 16269           PENDING-BUSINESS,
 16270           DFHEIV11,
 16271           PB-CONTROL-PRIMARY,
 16272           DFHEIV99,
 16273           DFHEIV99
 16274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16275
 16276
 16277     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 299
* EL6311.cbl
 16278
 16279     PERFORM 8400-LOG-JOURNAL-RECORD.
 16280
 16281 2799-EXIT.
 16282      EXIT.
 16283
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 300
* EL6311.cbl
 16285
 16286******************************************************************
 16287*                                                                *
 16288*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16289*                                                                *
 16290******************************************************************
 16291
 16292 2800-REWRITE-ISSUE-CERT-KEY.
 16293     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16294
 16295     IF  BCERTNOL GREATER THAN ZEROS
 16296         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16297
 16298     IF  BSUFIXL  GREATER THAN ZEROS
 16299         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16300
 16301     IF  BEFFDTL  GREATER THAN ZEROS
 16302         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16303
 16304 2810-READ-BY-ACCOUNT.
 16305
 16306* EXEC CICS HANDLE CONDITION
 16307*         NOTFND    (2820-PROCESS-REWRITE)
 16308*    END-EXEC.
 16309*    MOVE '"$I                   ! = #00014229' TO DFHEIV0
 16310     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16311     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16312     MOVE X'3D20233030303134323239' TO DFHEIV0(25:11)
 16313     CALL 'kxdfhei1' USING DFHEIV0
 16314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16315
 16316
 16317
 16318* EXEC CICS READ
 16319*        SET     (ADDRESS OF PENDING-BUSINESS)
 16320*        DATASET (FILE-ID-ERPNDB2)
 16321*        RIDFLD  (ERPNDB-ALT-KEY)
 16322*    END-EXEC.
 16323*    MOVE '&"S        E          (   #00014233' TO DFHEIV0
 16324     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16325     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16326     MOVE X'2020233030303134323333' TO DFHEIV0(25:11)
 16327     CALL 'kxdfhei1' USING DFHEIV0,
 16328           FILE-ID-ERPNDB2,
 16329           DFHEIV20,
 16330           DFHEIV99,
 16331           ERPNDB-ALT-KEY,
 16332           DFHEIV99,
 16333           DFHEIV99,
 16334           DFHEIV99
 16335     SET ADDRESS OF PENDING-BUSINESS TO
 16336         DFHEIV20
 16337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16338
 16339
 16340     GO TO 2890-DUPLICATE-RECORD.
 16341
 16342  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 301
* EL6311.cbl
 16343
 16344* EXEC CICS HANDLE CONDITION
 16345*         NOTFND    (2885-RECORD-MISSING)
 16346*    END-EXEC.
 16347*    MOVE '"$I                   ! > #00014242' TO DFHEIV0
 16348     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16350     MOVE X'3E20233030303134323432' TO DFHEIV0(25:11)
 16351     CALL 'kxdfhei1' USING DFHEIV0
 16352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16353
 16354
 16355     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16356
 16357
 16358* EXEC CICS READ
 16359*        SET     (ADDRESS OF PENDING-BUSINESS)
 16360*        DATASET (FILE-ID-ERPNDB)
 16361*        RIDFLD  (ERPNDB-KEY)
 16362*        UPDATE
 16363*    END-EXEC.
 16364*    MOVE '&"S        EU         (   #00014248' TO DFHEIV0
 16365     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16366     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16367     MOVE X'2020233030303134323438' TO DFHEIV0(25:11)
 16368     CALL 'kxdfhei1' USING DFHEIV0,
 16369           FILE-ID-ERPNDB,
 16370           DFHEIV20,
 16371           DFHEIV99,
 16372           ERPNDB-KEY,
 16373           DFHEIV99,
 16374           DFHEIV99,
 16375           DFHEIV99
 16376     SET ADDRESS OF PENDING-BUSINESS TO
 16377         DFHEIV20
 16378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16379
 16380
 16381     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16382     MOVE 'D'                    TO JP-RECORD-TYPE.
 16383     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16384     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16385
 16386     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16387
 16388     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16389     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16390     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16391
 16392
 16393* EXEC CICS DELETE
 16394*        DATASET    (FILE-ID-ERPNDB)
 16395*    END-EXEC.
 16396*    MOVE '&(                    &   #00014266' TO DFHEIV0
 16397     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16398     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16399     MOVE X'2020233030303134323636' TO DFHEIV0(25:11)
 16400     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 302
* EL6311.cbl
 16401           FILE-ID-ERPNDB,
 16402           DFHEIV99,
 16403           DFHEIV99,
 16404           DFHEIV99,
 16405           DFHEIV99
 16406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16407
 16408
 16409     PERFORM 8400-LOG-JOURNAL-RECORD.
 16410
 16411
 16412* EXEC CICS GETMAIN
 16413*        SET      (ADDRESS OF PENDING-BUSINESS)
 16414*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16415*        INITIMG  (GETMAIN-SPACE)
 16416*    END-EXEC.
 16417*    MOVE ',"IL                  $   #00014272' TO DFHEIV0
 16418     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16419     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16420     MOVE X'2020233030303134323732' TO DFHEIV0(25:11)
 16421     CALL 'kxdfhei1' USING DFHEIV0,
 16422           DFHEIV20,
 16423           ERPNDB-RECORD-LENGTH,
 16424           GETMAIN-SPACE
 16425     SET ADDRESS OF PENDING-BUSINESS TO
 16426         DFHEIV20
 16427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16428
 16429
 16430     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16431
 16432
 16433* EXEC CICS HANDLE CONDITION
 16434*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16435*    END-EXEC.
 16436*    MOVE '"$I                   ! ? #00014280' TO DFHEIV0
 16437     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16439     MOVE X'3F20233030303134323830' TO DFHEIV0(25:11)
 16440     CALL 'kxdfhei1' USING DFHEIV0
 16441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16442
 16443
 16444
 16445* EXEC CICS READ
 16446*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16447*        DATASET (FILE-ID-ELCERT)
 16448*        RIDFLD  (ELCERT-KEY)
 16449*        UPDATE
 16450*    END-EXEC.
 16451*    MOVE '&"S        EU         (   #00014284' TO DFHEIV0
 16452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16453     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16454     MOVE X'2020233030303134323834' TO DFHEIV0(25:11)
 16455     CALL 'kxdfhei1' USING DFHEIV0,
 16456           FILE-ID-ELCERT,
 16457           DFHEIV20,
 16458           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 303
* EL6311.cbl
 16459           ELCERT-KEY,
 16460           DFHEIV99,
 16461           DFHEIV99,
 16462           DFHEIV99
 16463     SET ADDRESS OF CERTIFICATE-MASTER TO
 16464         DFHEIV20
 16465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16466
 16467
 16468     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16469     MOVE 'B'                    TO JP-RECORD-TYPE
 16470     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16471     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16472
 16473     IF INSURED-ADDR-PRESENT
 16474        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16475
 16476     IF CERT-NOTES-ARE-NOT-PRESENT
 16477        MOVE SPACE               TO WS-CERT-NOTE-SW
 16478     ELSE
 16479        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16480
 16481     IF CERT-ADDED-BATCH      OR
 16482        CERT-AND-CLAIM-ONLINE OR
 16483        CERT-WAS-CREATED-FOR-CLAIM
 16484        NEXT SENTENCE
 16485     ELSE
 16486        GO TO 2825-DELETE-CERTIFICATE.
 16487
 16488     PERFORM 8400-LOG-JOURNAL-RECORD.
 16489
 16490*********************************************************
 16491** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16492     IF CERT-ADDED-BATCH
 16493         GO TO 2822-REWRITE-ELCERT.
 16494*********************************************************
 16495
 16496     IF NO-CLAIM-ATTACHED
 16497        NEXT SENTENCE
 16498     ELSE
 16499        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16500        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16501
 16502 2822-REWRITE-ELCERT.
 16503     MOVE 'C'                    TO JP-RECORD-TYPE
 16504     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16505
 16506     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16507
 16508
 16509* EXEC CICS REWRITE
 16510*         DATASET    (FILE-ID-ELCERT)
 16511*         FROM       (CERTIFICATE-MASTER)
 16512*    END-EXEC.
 16513     MOVE LENGTH OF
 16514      CERTIFICATE-MASTER
 16515       TO DFHEIV11
 16516*    MOVE '&& L                  %   #00014331' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 304
* EL6311.cbl
 16517     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16518     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16519     MOVE X'2020233030303134333331' TO DFHEIV0(25:11)
 16520     CALL 'kxdfhei1' USING DFHEIV0,
 16521           FILE-ID-ELCERT,
 16522           CERTIFICATE-MASTER,
 16523           DFHEIV11,
 16524           DFHEIV99
 16525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16526
 16527
 16528     PERFORM 8400-LOG-JOURNAL-RECORD.
 16529
 16530     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16531
 16532 2825-DELETE-CERTIFICATE.
 16533     MOVE 'D'                      TO JP-RECORD-TYPE.
 16534     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16535
 16536     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16537
 16538
 16539* EXEC CICS DELETE
 16540*         DATASET    (FILE-ID-ELCERT)
 16541*    END-EXEC.
 16542*    MOVE '&(                    &   #00014346' TO DFHEIV0
 16543     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16544     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16545     MOVE X'2020233030303134333436' TO DFHEIV0(25:11)
 16546     CALL 'kxdfhei1' USING DFHEIV0,
 16547           FILE-ID-ELCERT,
 16548           DFHEIV99,
 16549           DFHEIV99,
 16550           DFHEIV99,
 16551           DFHEIV99
 16552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16553
 16554
 16555     PERFORM 8400-LOG-JOURNAL-RECORD.
 16556
 16557******************************************************************
 16558*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 16559******************************************************************
 16560
 16561     IF CERT-NOTES-ARE-PRESENT
 16562        NEXT SENTENCE
 16563     ELSE
 16564        GO TO 2827-DELETE-MAILING.
 16565
 16566
 16567* EXEC CICS HANDLE CONDITION
 16568*         NOTFND  (2827-DELETE-MAILING)
 16569*    END-EXEC.
 16570*    MOVE '"$I                   ! @ #00014361' TO DFHEIV0
 16571     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16573     MOVE X'4020233030303134333631' TO DFHEIV0(25:11)
 16574     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 305
* EL6311.cbl
 16575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16576
 16577
 16578
 16579* EXEC CICS READ
 16580*        EQUAL
 16581*        DATASET   (FILE-ID-ERNOTE)
 16582*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 16583*        RIDFLD    (ELCERT-KEY)
 16584*        UPDATE
 16585*    END-EXEC.
 16586*    MOVE '&"S        EU         (   #00014365' TO DFHEIV0
 16587     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16588     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16589     MOVE X'2020233030303134333635' TO DFHEIV0(25:11)
 16590     CALL 'kxdfhei1' USING DFHEIV0,
 16591           FILE-ID-ERNOTE,
 16592           DFHEIV20,
 16593           DFHEIV99,
 16594           ELCERT-KEY,
 16595           DFHEIV99,
 16596           DFHEIV99,
 16597           DFHEIV99
 16598     SET ADDRESS OF CERTIFICATE-NOTE TO
 16599         DFHEIV20
 16600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16601
 16602
 16603     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 16604     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16605     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 16606
 16607     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16608
 16609
 16610* EXEC CICS DELETE
 16611*        DATASET   (FILE-ID-ERNOTE)
 16612*    END-EXEC.
 16613*    MOVE '&(                    &   #00014379' TO DFHEIV0
 16614     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16615     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16616     MOVE X'2020233030303134333739' TO DFHEIV0(25:11)
 16617     CALL 'kxdfhei1' USING DFHEIV0,
 16618           FILE-ID-ERNOTE,
 16619           DFHEIV99,
 16620           DFHEIV99,
 16621           DFHEIV99,
 16622           DFHEIV99
 16623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16624
 16625
 16626     PERFORM 8400-LOG-JOURNAL-RECORD.
 16627
 16628******************************************************************
 16629*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 16630******************************************************************
 16631
 16632 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 306
* EL6311.cbl
 16633     IF CERT-ADDRESS-PRESENT
 16634        NEXT SENTENCE
 16635     ELSE
 16636        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16637
 16638
 16639* EXEC CICS HANDLE CONDITION
 16640*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 16641*    END-EXEC.
 16642*    MOVE '"$I                   ! A #00014395' TO DFHEIV0
 16643     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16645     MOVE X'4120233030303134333935' TO DFHEIV0(25:11)
 16646     CALL 'kxdfhei1' USING DFHEIV0
 16647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16648
 16649
 16650     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 16651
 16652
 16653* EXEC CICS READ
 16654*        EQUAL
 16655*        DATASET   (FILE-ID-ERMAIL)
 16656*        SET       (ADDRESS OF MAILING-DATA)
 16657*        RIDFLD    (ERMAIL-KEY)
 16658*        UPDATE
 16659*    END-EXEC.
 16660*    MOVE '&"S        EU         (   #00014401' TO DFHEIV0
 16661     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16662     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16663     MOVE X'2020233030303134343031' TO DFHEIV0(25:11)
 16664     CALL 'kxdfhei1' USING DFHEIV0,
 16665           FILE-ID-ERMAIL,
 16666           DFHEIV20,
 16667           DFHEIV99,
 16668           ERMAIL-KEY,
 16669           DFHEIV99,
 16670           DFHEIV99,
 16671           DFHEIV99
 16672     SET ADDRESS OF MAILING-DATA TO
 16673         DFHEIV20
 16674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16675
 16676
 16677     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 16678     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16679     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 16680
 16681     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 16682
 16683
 16684* EXEC CICS DELETE
 16685*        DATASET   (FILE-ID-ERMAIL)
 16686*    END-EXEC.
 16687*    MOVE '&(                    &   #00014415' TO DFHEIV0
 16688     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16689     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16690     MOVE X'2020233030303134343135' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 307
* EL6311.cbl
 16691     CALL 'kxdfhei1' USING DFHEIV0,
 16692           FILE-ID-ERMAIL,
 16693           DFHEIV99,
 16694           DFHEIV99,
 16695           DFHEIV99,
 16696           DFHEIV99
 16697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16698
 16699
 16700     PERFORM 8400-LOG-JOURNAL-RECORD.
 16701
 16702 2830-BUILD-NEW-ISSUE-RECORD.
 16703     MOVE SPACES                 TO ELCERT-KEY.
 16704
 16705     IF  BCERTNOL GREATER THAN ZEROS
 16706         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 16707
 16708     IF  BSUFIXL  GREATER THAN ZEROS
 16709         MOVE BSUFIXI            TO  PB-CERT-SFX.
 16710
 16711     IF BEFFDTL GREATER THAN ZEROS
 16712        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 16713
 16714 2870-WRITE-PENDING-BUSINESS.
 16715     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16716     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16717     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16718     MOVE '5'                    TO DC-OPTION-CODE.
 16719     PERFORM 9700-DATE-LINK.
 16720     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16721
 16722     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16723
 16724     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16725     MOVE 'A'                    TO JP-RECORD-TYPE.
 16726     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16727
 16728
 16729* EXEC CICS WRITE
 16730*        DATASET  (FILE-ID-ERPNDB)
 16731*        FROM     (PENDING-BUSINESS)
 16732*        RIDFLD   (PB-CONTROL-PRIMARY)
 16733*    END-EXEC.
 16734     MOVE LENGTH OF
 16735      PENDING-BUSINESS
 16736       TO DFHEIV11
 16737*    MOVE '&$ L                  ''   #00014447' TO DFHEIV0
 16738     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16739     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16740     MOVE X'2020233030303134343437' TO DFHEIV0(25:11)
 16741     CALL 'kxdfhei1' USING DFHEIV0,
 16742           FILE-ID-ERPNDB,
 16743           PENDING-BUSINESS,
 16744           DFHEIV11,
 16745           PB-CONTROL-PRIMARY,
 16746           DFHEIV99,
 16747           DFHEIV99
 16748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 308
* EL6311.cbl
 16749
 16750
 16751     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 16752
 16753     PERFORM 8400-LOG-JOURNAL-RECORD.
 16754
 16755     GO TO 1325-PROCESS-ISSUE-CHANGES.
 16756
 16757 2885-RECORD-MISSING.
 16758     MOVE -1                     TO BMAINTL
 16759     MOVE AL-UABON               TO BMAINTA
 16760     MOVE ER-2902                TO EMI-ERROR.
 16761     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16762     GO TO 8200-SEND-DATAONLY.
 16763
 16764 2890-DUPLICATE-RECORD.
 16765     MOVE -1                     TO BMAINTL.
 16766     MOVE AL-UABON               TO BCERTNOA.
 16767     MOVE AL-UNBON               TO BEFFDTA.
 16768     MOVE SPACE                  TO BMAINTI.
 16769
 16770     MOVE 1                      TO EMI-SUB
 16771                                    EMI-SWITCH1
 16772                                    EMI-SWITCH-AREA-1
 16773                                    EMI-SWITCH-AREA-2.
 16774
 16775     MOVE SPACES                 TO EMI-ERROR-LINES.
 16776
 16777
 16778* EXEC CICS SYNCPOINT ROLLBACK
 16779*    END-EXEC.
 16780*    MOVE '6"R                   !   #00014479' TO DFHEIV0
 16781     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16783     MOVE X'2020233030303134343739' TO DFHEIV0(25:11)
 16784     CALL 'kxdfhei1' USING DFHEIV0
 16785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16786
 16787
 16788     MOVE ER-2247                TO EMI-ERROR.
 16789     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 16790     GO TO 8200-SEND-DATAONLY.
 16791
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 309
* EL6311.cbl
 16793
 16794******************************************************************
 16795*                                                                *
 16796*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 16797*                                                                *
 16798******************************************************************
 16799
 16800 2900-REWRITE-CAN-CERT-KEY.
 16801     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16802
 16803     IF  CCERTNOL GREATER THAN ZEROS
 16804         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 16805
 16806     IF  CSUFIXL  GREATER THAN ZEROS
 16807         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 16808
 16809     IF  CEFFDTL  GREATER THAN ZEROS
 16810         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16811
 16812 2910-READ-BY-ACCOUNT.
 16813
 16814* EXEC CICS HANDLE CONDITION
 16815*         NOTFND    (2920-PROCESS-REWRITE)
 16816*    END-EXEC.
 16817*    MOVE '"$I                   ! B #00014507' TO DFHEIV0
 16818     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16820     MOVE X'4220233030303134353037' TO DFHEIV0(25:11)
 16821     CALL 'kxdfhei1' USING DFHEIV0
 16822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16823
 16824
 16825
 16826* EXEC CICS READ
 16827*        SET     (ADDRESS OF PENDING-BUSINESS)
 16828*        DATASET (FILE-ID-ERPNDB2)
 16829*        RIDFLD  (ERPNDB-ALT-KEY)
 16830*    END-EXEC.
 16831*    MOVE '&"S        E          (   #00014511' TO DFHEIV0
 16832     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16834     MOVE X'2020233030303134353131' TO DFHEIV0(25:11)
 16835     CALL 'kxdfhei1' USING DFHEIV0,
 16836           FILE-ID-ERPNDB2,
 16837           DFHEIV20,
 16838           DFHEIV99,
 16839           ERPNDB-ALT-KEY,
 16840           DFHEIV99,
 16841           DFHEIV99,
 16842           DFHEIV99
 16843     SET ADDRESS OF PENDING-BUSINESS TO
 16844         DFHEIV20
 16845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16846
 16847
 16848     GO TO 2990-DUPLICATE-RECORD.
 16849
 16850  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 310
* EL6311.cbl
 16851
 16852* EXEC CICS HANDLE CONDITION
 16853*         NOTFND    (2985-RECORD-MISSING)
 16854*    END-EXEC.
 16855*    MOVE '"$I                   ! C #00014520' TO DFHEIV0
 16856     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16857     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16858     MOVE X'4320233030303134353230' TO DFHEIV0(25:11)
 16859     CALL 'kxdfhei1' USING DFHEIV0
 16860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16861
 16862
 16863     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16864
 16865
 16866* EXEC CICS READ
 16867*        SET     (ADDRESS OF PENDING-BUSINESS)
 16868*        DATASET (FILE-ID-ERPNDB)
 16869*        RIDFLD  (ERPNDB-KEY)
 16870*        UPDATE
 16871*    END-EXEC.
 16872*    MOVE '&"S        EU         (   #00014526' TO DFHEIV0
 16873     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16874     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16875     MOVE X'2020233030303134353236' TO DFHEIV0(25:11)
 16876     CALL 'kxdfhei1' USING DFHEIV0,
 16877           FILE-ID-ERPNDB,
 16878           DFHEIV20,
 16879           DFHEIV99,
 16880           ERPNDB-KEY,
 16881           DFHEIV99,
 16882           DFHEIV99,
 16883           DFHEIV99
 16884     SET ADDRESS OF PENDING-BUSINESS TO
 16885         DFHEIV20
 16886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16887
 16888
 16889     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16890     MOVE 'D'                    TO JP-RECORD-TYPE.
 16891     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16892     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16893
 16894     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16895
 16896     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16897     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16898     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16899
 16900
 16901* EXEC CICS DELETE
 16902*        DATASET    (FILE-ID-ERPNDB)
 16903*    END-EXEC.
 16904*    MOVE '&(                    &   #00014544' TO DFHEIV0
 16905     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16906     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16907     MOVE X'2020233030303134353434' TO DFHEIV0(25:11)
 16908     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 311
* EL6311.cbl
 16909           FILE-ID-ERPNDB,
 16910           DFHEIV99,
 16911           DFHEIV99,
 16912           DFHEIV99,
 16913           DFHEIV99
 16914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16915
 16916
 16917     PERFORM 8400-LOG-JOURNAL-RECORD.
 16918
 16919
 16920* EXEC CICS GETMAIN
 16921*        SET      (ADDRESS OF PENDING-BUSINESS)
 16922*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16923*        INITIMG  (GETMAIN-SPACE)
 16924*    END-EXEC.
 16925*    MOVE ',"IL                  $   #00014550' TO DFHEIV0
 16926     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16927     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16928     MOVE X'2020233030303134353530' TO DFHEIV0(25:11)
 16929     CALL 'kxdfhei1' USING DFHEIV0,
 16930           DFHEIV20,
 16931           ERPNDB-RECORD-LENGTH,
 16932           GETMAIN-SPACE
 16933     SET ADDRESS OF PENDING-BUSINESS TO
 16934         DFHEIV20
 16935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16936
 16937
 16938     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16939
 16940 2950-PROCESS-CANCELS.
 16941
 16942
 16943* EXEC CICS HANDLE CONDITION
 16944*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 16945*    END-EXEC.
 16946*    MOVE '"$I                   ! D #00014560' TO DFHEIV0
 16947     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16948     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16949     MOVE X'4420233030303134353630' TO DFHEIV0(25:11)
 16950     CALL 'kxdfhei1' USING DFHEIV0
 16951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16952
 16953
 16954
 16955* EXEC CICS READ
 16956*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16957*        DATASET (FILE-ID-ELCERT)
 16958*        RIDFLD  (ELCERT-KEY)
 16959*        UPDATE
 16960*    END-EXEC.
 16961*    MOVE '&"S        EU         (   #00014564' TO DFHEIV0
 16962     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16963     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16964     MOVE X'2020233030303134353634' TO DFHEIV0(25:11)
 16965     CALL 'kxdfhei1' USING DFHEIV0,
 16966           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 312
* EL6311.cbl
 16967           DFHEIV20,
 16968           DFHEIV99,
 16969           ELCERT-KEY,
 16970           DFHEIV99,
 16971           DFHEIV99,
 16972           DFHEIV99
 16973     SET ADDRESS OF CERTIFICATE-MASTER TO
 16974         DFHEIV20
 16975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16976
 16977
 16978     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16979
 16980     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16981     MOVE 'B'                      TO JP-RECORD-TYPE.
 16982     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16983     PERFORM 8400-LOG-JOURNAL-RECORD.
 16984
 16985     IF PB-CI-LIVES NOT NUMERIC
 16986         MOVE ZERO                    TO PB-CI-LIVES.
 16987
 16988     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16989        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16990        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16991        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16992                                         CM-LF-CANCEL-DT
 16993     ELSE
 16994        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16995        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16996        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16997        MOVE PB-CI-LIVES              TO CM-LIVES.
 16998
 16999     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17000        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17001            MOVE CM-LF-STATUS-AT-CANCEL
 17002                                     TO CM-LF-CURRENT-STATUS
 17003            MOVE SPACE
 17004                                     TO CM-LF-STATUS-AT-CANCEL
 17005        ELSE
 17006            MOVE PB-CI-LF-POLICY-STATUS
 17007                                     TO CM-LF-CURRENT-STATUS
 17008     ELSE
 17009        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17010
 17011     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17012        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17013        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17014        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17015                                         CM-AH-CANCEL-DT
 17016     ELSE
 17017        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17018        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17019        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17020        MOVE PB-CI-LIVES              TO CM-LIVES.
 17021
 17022     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17023        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17024            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 313
* EL6311.cbl
 17025                                     TO CM-AH-CURRENT-STATUS
 17026            MOVE SPACE
 17027                                     TO CM-AH-STATUS-AT-CANCEL
 17028        ELSE
 17029            MOVE PB-CI-AH-POLICY-STATUS
 17030                                     TO CM-AH-CURRENT-STATUS
 17031     ELSE
 17032        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17033
 17034 2975-REWRITE-CERT.
 17035     MOVE 'C'                      TO JP-RECORD-TYPE.
 17036     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17037
 17038
 17039* EXEC CICS REWRITE
 17040*        DATASET    (FILE-ID-ELCERT)
 17041*        FROM       (CERTIFICATE-MASTER)
 17042*    END-EXEC.
 17043     MOVE LENGTH OF
 17044      CERTIFICATE-MASTER
 17045       TO DFHEIV11
 17046*    MOVE '&& L                  %   #00014631' TO DFHEIV0
 17047     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17048     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17049     MOVE X'2020233030303134363331' TO DFHEIV0(25:11)
 17050     CALL 'kxdfhei1' USING DFHEIV0,
 17051           FILE-ID-ELCERT,
 17052           CERTIFICATE-MASTER,
 17053           DFHEIV11,
 17054           DFHEIV99
 17055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17056
 17057
 17058     PERFORM 8400-LOG-JOURNAL-RECORD.
 17059
 17060 2960-BUILD-NEW-CANCEL-RECORD.
 17061     IF  CCERTNOL GREATER THAN ZEROS
 17062         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17063
 17064     IF  CSUFIXL  GREATER THAN ZEROS
 17065         MOVE CSUFIXI             TO PB-CERT-SFX.
 17066
 17067     IF  CEFFDTL  GREATER  THAN ZEROS
 17068         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17069
 17070 2970-WRITE-PENDING-BUSINESS.
 17071     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17072     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17073     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17074     MOVE '5'                    TO DC-OPTION-CODE.
 17075     PERFORM 9700-DATE-LINK.
 17076     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17077
 17078     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17079
 17080     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17081                                    PB-CI-INSURED-SEX
 17082                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 314
* EL6311.cbl
 17083                                    PB-CI-AH-BENEFIT-CD
 17084                                    PB-CI-RATE-CLASS
 17085                                    PB-CI-RATE-DEV-LF
 17086                                    PB-CI-RATE-DEV-AH
 17087                                    PB-CI-LF-ABBR
 17088                                    PB-CI-AH-ABBR
 17089                                    PB-CI-OB-FLAG
 17090                                    PB-CI-LF-POLICY-STATUS
 17091                                    PB-CI-AH-POLICY-STATUS
 17092                                    PB-CI-INDV-GRP-CD
 17093                                    PB-CI-BENEFICIARY-NAME
 17094                                    PB-CI-NOTE-SW
 17095                                    PB-CI-SOC-SEC-NO
 17096                                    PB-CI-MEMBER-NO
 17097                                    PB-CI-INT-CODE
 17098                                    PB-CI-COMP-EXCP-SW
 17099                                    PB-CI-ENTRY-STATUS
 17100                                    PB-CI-CREDIT-INTERFACE-SW-1
 17101                                    PB-CI-CREDIT-INTERFACE-SW-2
 17102                                    PB-CI-ENTRY-BATCH.
 17103
 17104     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17105                                    PB-CI-AH-SETTLEMENT-DT
 17106                                    PB-CI-DEATH-DT
 17107                                    PB-CI-LF-PRIOR-CANCEL-DT
 17108                                    PB-CI-AH-PRIOR-CANCEL-DT
 17109                                    PB-CI-LOAN-1ST-PMT-DT
 17110                                    PB-CI-ENTRY-DT
 17111                                    PB-CI-LF-EXPIRE-DT
 17112                                    PB-CI-AH-EXPIRE-DT.
 17113
 17114     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17115                                    PB-CI-LF-TERM
 17116                                    PB-CI-LF-BENEFIT-AMT
 17117                                    PB-CI-LF-ALT-BENEFIT-AMT
 17118                                    PB-CI-LF-PREMIUM-AMT
 17119                                    PB-CI-LF-ALT-PREMIUM-AMT
 17120                                    PB-CI-AH-TERM
 17121                                    PB-CI-AH-BENEFIT-AMT
 17122                                    PB-CI-AH-PREMIUM-AMT
 17123                                    PB-CI-RATE-DEV-PCT-LF
 17124                                    PB-CI-RATE-DEV-PCT-AH
 17125                                    PB-CI-LIFE-COMMISSION
 17126                                    PB-CI-AH-COMMISSION
 17127                                    PB-CI-PAY-FREQUENCY
 17128                                    PB-CI-LOAN-APR
 17129                                    PB-CI-LOAN-TERM
 17130                                    PB-CI-CURR-SEQ
 17131                                    PB-CI-AH-CANCEL-AMT
 17132                                    PB-CI-LF-CANCEL-AMT
 17133                                    PB-CI-EXTENTION-DAYS
 17134                                    PB-CI-TERM-IN-DAYS
 17135                                    PB-CI-LOAN-OFFICER
 17136                                    PB-CI-LIVES
 17137                                    PB-CI-LF-CRIT-PER
 17138                                    PB-CI-AH-CRIT-PER
 17139                                    PB-C-LF-REM-TERM
 17140                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 315
* EL6311.cbl
 17141
 17142     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17143     MOVE 'A'                    TO JP-RECORD-TYPE.
 17144     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17145
 17146
 17147* EXEC CICS HANDLE CONDITION
 17148*        DUPREC   (2990-DUPLICATE-RECORD)
 17149*    END-EXEC.
 17150*    MOVE '"$%                   ! E #00014724' TO DFHEIV0
 17151     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17152     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17153     MOVE X'4520233030303134373234' TO DFHEIV0(25:11)
 17154     CALL 'kxdfhei1' USING DFHEIV0
 17155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17156
 17157
 17158
 17159* EXEC CICS WRITE
 17160*        DATASET  (FILE-ID-ERPNDB)
 17161*        FROM     (PENDING-BUSINESS)
 17162*        RIDFLD   (PB-CONTROL-PRIMARY)
 17163*    END-EXEC.
 17164     MOVE LENGTH OF
 17165      PENDING-BUSINESS
 17166       TO DFHEIV11
 17167*    MOVE '&$ L                  ''   #00014728' TO DFHEIV0
 17168     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17169     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17170     MOVE X'2020233030303134373238' TO DFHEIV0(25:11)
 17171     CALL 'kxdfhei1' USING DFHEIV0,
 17172           FILE-ID-ERPNDB,
 17173           PENDING-BUSINESS,
 17174           DFHEIV11,
 17175           PB-CONTROL-PRIMARY,
 17176           DFHEIV99,
 17177           DFHEIV99
 17178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17179
 17180
 17181     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17182
 17183     PERFORM 8400-LOG-JOURNAL-RECORD.
 17184
 17185     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17186
 17187 2985-RECORD-MISSING.
 17188     MOVE -1                     TO CMAINTL
 17189     MOVE AL-UABON               TO CMAINTA.
 17190
 17191     MOVE ER-2902                TO EMI-ERROR.
 17192     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17193     GO TO 8200-SEND-DATAONLY.
 17194
 17195 2990-DUPLICATE-RECORD.
 17196     MOVE SPACE                  TO CMAINTI.
 17197     MOVE -1                     TO CMAINTL.
 17198     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 316
* EL6311.cbl
 17199     MOVE AL-UNBON               TO CEFFDTA.
 17200
 17201     MOVE 1                      TO EMI-SUB
 17202                                    EMI-SWITCH1
 17203                                    EMI-SWITCH-AREA-1
 17204                                    EMI-SWITCH-AREA-2.
 17205     MOVE SPACES                 TO EMI-ERROR-LINES.
 17206
 17207
 17208* EXEC CICS SYNCPOINT ROLLBACK
 17209*    END-EXEC.
 17210*    MOVE '6"R                   !   #00014760' TO DFHEIV0
 17211     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17213     MOVE X'2020233030303134373630' TO DFHEIV0(25:11)
 17214     CALL 'kxdfhei1' USING DFHEIV0
 17215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17216
 17217
 17218     MOVE ER-2247                TO EMI-ERROR.
 17219     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17220     GO TO 8200-SEND-DATAONLY.
 17221
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 317
* EL6311.cbl
 17223
 17224***************************************************************
 17225*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17226*     PREMIUM FOR A SINGLE BATCH.                             *
 17227*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17228***************************************************************
 17229
 17230 3000-BATCH-MAINLINE.
 17231     IF PI-PREV-KEY NOT = SPACES
 17232         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17233     ELSE
 17234         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17235
 17236     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17237
 17238 3010-READNEXT.
 17239
 17240* EXEC CICS READ
 17241*         DATASET    (FILE-ID-ERPNDB)
 17242*         SET        (ADDRESS OF PENDING-BUSINESS)
 17243*         RIDFLD     (ERPNDB-KEY)
 17244*         GTEQ
 17245*    END-EXEC.
 17246*    MOVE '&"S        G          (   #00014784' TO DFHEIV0
 17247     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17248     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17249     MOVE X'2020233030303134373834' TO DFHEIV0(25:11)
 17250     CALL 'kxdfhei1' USING DFHEIV0,
 17251           FILE-ID-ERPNDB,
 17252           DFHEIV20,
 17253           DFHEIV99,
 17254           ERPNDB-KEY,
 17255           DFHEIV99,
 17256           DFHEIV99,
 17257           DFHEIV99
 17258     SET ADDRESS OF PENDING-BUSINESS TO
 17259         DFHEIV20
 17260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17261
 17262
 17263     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17264        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17265          GO TO 3030-END-BATCH.
 17266
 17267     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17268
 17269     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17270        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17271          GO TO 3020-BUMP-SEQ.
 17272
 17273     IF PB-ISSUE
 17274        ADD +1                   TO WS-ISS-TOTAL-CNT
 17275        IF PB-FATAL-ERRORS
 17276           ADD +1                      TO WS-ISS-FATAL-CNT
 17277           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17278           GO TO 3020-BUMP-SEQ
 17279        ELSE
 17280           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 318
* EL6311.cbl
 17281              ADD +1                      TO WS-ISS-FORCE-CNT
 17282              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17283              GO TO 3020-BUMP-SEQ
 17284           ELSE
 17285              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17286                 ADD +1                      TO WS-ISS-HOLD-CNT
 17287                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17288                 GO TO 3020-BUMP-SEQ
 17289              ELSE
 17290                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17291                     THRU  3299-EXIT
 17292                 GO TO 3020-BUMP-SEQ.
 17293
 17294     IF PB-CANCELLATION
 17295        ADD +1                   TO WS-CAN-TOTAL-CNT
 17296        IF PB-FATAL-ERRORS
 17297           ADD +1                 TO WS-CAN-FATAL-CNT
 17298           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17299           GO TO 3020-BUMP-SEQ
 17300        ELSE
 17301           IF PB-UNFORCED-ERRORS
 17302              ADD +1                 TO WS-CAN-FORCE-CNT
 17303              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17304              GO TO 3020-BUMP-SEQ
 17305           ELSE
 17306              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17307                 ADD +1                 TO WS-CAN-HOLD-CNT
 17308                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17309                 GO TO 3020-BUMP-SEQ
 17310              ELSE
 17311                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17312                     THRU  3499-EXIT
 17313                 GO TO 3020-BUMP-SEQ.
 17314
 17315     IF PB-BATCH-TRAILER
 17316         GO TO 3030-END-BATCH.
 17317
 17318 3020-BUMP-SEQ.
 17319     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17320     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17321     GO TO 3010-READNEXT.
 17322
 17323 3030-END-BATCH.
 17324     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17325     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17326     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17327     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17328
 17329     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17330                                          - WS-ISS-FORCE-CNT
 17331                                          - WS-ISS-HOLD-CNT).
 17332
 17333     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17334     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17335
 17336     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17337     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17338     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 319
* EL6311.cbl
 17339     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17340     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17341                                          - WS-CAN-FORCE-CNT
 17342                                          - WS-CAN-HOLD-CNT).
 17343     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17344     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17345
 17346     COMPUTE WS-NET-TOTAL-CNT
 17347         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17348     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17349     COMPUTE WS-NET-FATAL-CNT
 17350         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17351     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17352     COMPUTE WS-NET-FORCE-CNT
 17353         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17354     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17355     COMPUTE WS-NET-HOLD-CNT
 17356         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17357     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17358
 17359     COMPUTE WS-NET-AVAIL-CNT
 17360          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17361                              - WS-ISS-FORCE-CNT
 17362                              - WS-ISS-HOLD-CNT)
 17363          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17364                              - WS-CAN-FORCE-CNT
 17365                              - WS-CAN-HOLD-CNT).
 17366     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17367
 17368     COMPUTE WS-NET-GOOD-PREM
 17369         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17370     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17371     COMPUTE WS-NET-BAD-PREM
 17372         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17373     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17374
 17375     MOVE 0000                   TO EMI-ERROR.
 17376     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17377     MOVE -1                     TO DPFENTRL.
 17378     GO TO 8200-SEND-DATAONLY.
 17379
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 320
* EL6311.cbl
 17381
 17382******************************************************************
 17383*                                                                *
 17384*           A D D    B A D   I S S U E   P R E M I U M           *
 17385*                                                                *
 17386******************************************************************
 17387
 17388 3100-ADD-BAD-ISSUE-PREM.
 17389     IF PB-OVERRIDE-LIFE
 17390       OR PB-OVERRIDE-BOTH
 17391           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17392           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17393       ELSE
 17394           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17395           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17396
 17397     IF PB-OVERRIDE-AH
 17398       OR PB-OVERRIDE-BOTH
 17399           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17400       ELSE
 17401           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17402
 17403 3199-EXIT.
 17404     EXIT.
 17405
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 321
* EL6311.cbl
 17407
 17408******************************************************************
 17409*                                                                *
 17410*       A D D   G O O D   I S S U E   P R E M I U M              *
 17411*                                                                *
 17412******************************************************************
 17413
 17414 3200-ADD-GOOD-ISSUE-PREM.
 17415     IF PB-OVERRIDE-LIFE
 17416       OR PB-OVERRIDE-BOTH
 17417           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17418           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17419       ELSE
 17420           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17421           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17422
 17423     IF PB-OVERRIDE-AH
 17424       OR PB-OVERRIDE-BOTH
 17425           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17426       ELSE
 17427           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17428
 17429 3299-EXIT.
 17430     EXIT.
 17431
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 322
* EL6311.cbl
 17433
 17434
 17435******************************************************************
 17436*                                                                *
 17437*        A D D   B A D   C A N C E L   P R E M I U M             *
 17438*                                                                *
 17439******************************************************************
 17440
 17441 3300-ADD-BAD-CANCEL-PREM.
 17442     IF PB-OVERRIDE-LIFE
 17443       OR PB-OVERRIDE-BOTH
 17444           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17445       ELSE
 17446           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17447
 17448     IF PB-OVERRIDE-AH
 17449       OR PB-OVERRIDE-BOTH
 17450           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17451       ELSE
 17452           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17453
 17454 3399-EXIT.
 17455     EXIT.
 17456
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 323
* EL6311.cbl
 17458
 17459******************************************************************
 17460*                                                                *
 17461*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17462*                                                                *
 17463******************************************************************
 17464
 17465 3400-ADD-GOOD-CANCEL-PREM.
 17466     IF PB-OVERRIDE-LIFE
 17467       OR PB-OVERRIDE-BOTH
 17468           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17469       ELSE
 17470           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17471
 17472     IF PB-OVERRIDE-AH
 17473       OR PB-OVERRIDE-BOTH
 17474           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17475       ELSE
 17476           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17477
 17478 3499-EXIT.
 17479     EXIT.
 17480
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 324
* EL6311.cbl
 17482
 17483******************************************************************
 17484*                                                                *
 17485*           E D I T   B A T C H   D A T A                        *
 17486*                                                                *
 17487******************************************************************
 17488
 17489 3500-EDIT-BATCH-DATA.
 17490     IF PI-PREV-KEY NOT = SPACES
 17491        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17492     ELSE
 17493        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17494
 17495     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17496     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17497
 17498
 17499* EXEC CICS HANDLE CONDITION
 17500*         NOTFND      (3590-NOT-FOUND)
 17501*    END-EXEC.
 17502*    MOVE '"$I                   ! F #00015026' TO DFHEIV0
 17503     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17505     MOVE X'4620233030303135303236' TO DFHEIV0(25:11)
 17506     CALL 'kxdfhei1' USING DFHEIV0
 17507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17508
 17509
 17510     IF DRISSL   GREATER THAN ZEROS OR
 17511        DRISSL   GREATER THAN ZEROS OR
 17512        DRLFPRML GREATER THAN ZEROS OR
 17513        DRAHPRML GREATER THAN ZEROS OR
 17514        DRCANCL  GREATER THAN ZEROS OR
 17515        DRLFRFDL GREATER THAN ZEROS OR
 17516        DRAHRFDL GREATER THAN ZEROS
 17517              NEXT SENTENCE
 17518          ELSE
 17519              MOVE ER-3224    TO EMI-ERROR
 17520              MOVE -1         TO DPFENTRL
 17521              MOVE AL-UNBON   TO DPFENTRA
 17522              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17523              GO TO 8200-SEND-DATAONLY.
 17524
 17525     IF NOT MODIFY-CAP
 17526         MOVE 'UPDATE'       TO SM-READ
 17527         PERFORM 9995-SECURITY-VIOLATION
 17528         MOVE ER-0070        TO EMI-ERROR
 17529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17530         GO TO 8100-SEND-INITIAL-MAP.
 17531
 17532        IF DRISSL GREATER THAN ZEROS
 17533           MOVE AL-UNNON         TO DRISSA
 17534           MOVE DRISSI           TO DEEDIT-FIELD
 17535           PERFORM 8600-DEEDIT
 17536           IF DEEDIT-FIELD-V0  NUMERIC
 17537              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 17538           ELSE
 17539              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 325
* EL6311.cbl
 17540              MOVE -1         TO DRISSL
 17541              MOVE AL-UNBON   TO DRISSA
 17542              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17543
 17544        IF DRLFPRML GREATER THAN ZEROS
 17545           MOVE AL-UNNON         TO DRLFPRMA
 17546
 17547* EXEC CICS BIF DEEDIT
 17548*              FIELD  (DRLFPRMI)
 17549*              LENGTH (11)
 17550*          END-EXEC
 17551     MOVE 11
 17552       TO DFHEIV11
 17553*    MOVE '@"L                   #   #00015066' TO DFHEIV0
 17554     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17555     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17556     MOVE X'2020233030303135303636' TO DFHEIV0(25:11)
 17557     CALL 'kxdfhei1' USING DFHEIV0,
 17558           DRLFPRMI,
 17559           DFHEIV11
 17560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17561           IF DRLFPRMI NUMERIC
 17562              MOVE DRLFPRMI   TO WS-DRLFPRM
 17563*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 17564*          PERFORM 8600-DEEDIT
 17565*          IF DEEDIT-FIELD-V2  NUMERIC
 17566*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 17567           ELSE
 17568              MOVE ER-2223    TO EMI-ERROR
 17569              MOVE -1         TO DRLFPRML
 17570              MOVE AL-UNBON   TO DRLFPRMA
 17571              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17572
 17573        IF DRAHPRML GREATER THAN ZEROS
 17574           MOVE AL-UNNON         TO DRAHPRMA
 17575
 17576* EXEC CICS BIF DEEDIT
 17577*              FIELD  (DRAHPRMI)
 17578*              LENGTH (11)
 17579*          END-EXEC
 17580     MOVE 11
 17581       TO DFHEIV11
 17582*    MOVE '@"L                   #   #00015084' TO DFHEIV0
 17583     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17584     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17585     MOVE X'2020233030303135303834' TO DFHEIV0(25:11)
 17586     CALL 'kxdfhei1' USING DFHEIV0,
 17587           DRAHPRMI,
 17588           DFHEIV11
 17589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17590           IF DRAHPRMI NUMERIC
 17591              MOVE DRAHPRMI   TO WS-DRAHPRM
 17592*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 17593*          PERFORM 8600-DEEDIT
 17594*          IF DEEDIT-FIELD-V2  NUMERIC
 17595*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 17596           ELSE
 17597              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 326
* EL6311.cbl
 17598              MOVE -1         TO DRAHPRML
 17599              MOVE AL-UNBON   TO DRAHPRMA
 17600              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17601
 17602        IF DRCANCL GREATER THAN ZEROS
 17603           MOVE AL-UNNON         TO DRCANCA
 17604           MOVE DRCANCI          TO DEEDIT-FIELD
 17605           PERFORM 8600-DEEDIT
 17606           IF DEEDIT-FIELD-V0  NUMERIC
 17607              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 17608           ELSE
 17609              MOVE ER-2223    TO EMI-ERROR
 17610              MOVE -1         TO DRCANCL
 17611              MOVE AL-UNBON   TO DRCANCL
 17612              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17613
 17614        IF DRLFRFDL GREATER THAN ZEROS
 17615           MOVE AL-UNNON         TO DRLFRFDA
 17616
 17617* EXEC CICS BIF DEEDIT
 17618*              FIELD  (DRLFRFDI)
 17619*              LENGTH (11)
 17620*          END-EXEC
 17621     MOVE 11
 17622       TO DFHEIV11
 17623*    MOVE '@"L                   #   #00015114' TO DFHEIV0
 17624     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17625     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17626     MOVE X'2020233030303135313134' TO DFHEIV0(25:11)
 17627     CALL 'kxdfhei1' USING DFHEIV0,
 17628           DRLFRFDI,
 17629           DFHEIV11
 17630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17631           IF DRLFRFDI NUMERIC
 17632              MOVE DRLFRFDI   TO WS-DRLFRFD
 17633*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 17634*          PERFORM 8600-DEEDIT
 17635*          IF DEEDIT-FIELD-V2  NUMERIC
 17636*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 17637           ELSE
 17638              MOVE ER-2223    TO EMI-ERROR
 17639              MOVE -1         TO DRLFRFDL
 17640              MOVE AL-UNBON   TO DRLFRFDA
 17641              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17642
 17643        IF DRAHRFDL GREATER THAN ZEROS
 17644           MOVE AL-UNNON         TO DRAHRFDA
 17645
 17646* EXEC CICS BIF DEEDIT
 17647*              FIELD  (DRAHRFDI)
 17648*              LENGTH (11)
 17649*          END-EXEC
 17650     MOVE 11
 17651       TO DFHEIV11
 17652*    MOVE '@"L                   #   #00015132' TO DFHEIV0
 17653     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17654     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17655     MOVE X'2020233030303135313332' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 327
* EL6311.cbl
 17656     CALL 'kxdfhei1' USING DFHEIV0,
 17657           DRAHRFDI,
 17658           DFHEIV11
 17659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17660           IF DRAHRFDI NUMERIC
 17661              MOVE DRAHRFDI   TO WS-DRAHRFD
 17662*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 17663*          PERFORM 8600-DEEDIT
 17664*          IF DEEDIT-FIELD-V2  NUMERIC
 17665*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 17666           ELSE
 17667              MOVE ER-2223    TO EMI-ERROR
 17668              MOVE -1         TO DRAHRFDL
 17669              MOVE AL-UNBON   TO DRAHRFDA
 17670              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17671
 17672     IF EMI-ERROR = ZEROS
 17673        GO 3600-UPDATE-BATCH-HEADER.
 17674
 17675     GO TO 8200-SEND-DATAONLY.
 17676
 17677 3590-NOT-FOUND.
 17678     MOVE ER-2192                TO EMI-ERROR.
 17679     MOVE -1                     TO DPFENTRL.
 17680     MOVE AL-UNBON               TO DPFENTRA.
 17681     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17682     GO TO 8200-SEND-DATAONLY.
 17683
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 328
* EL6311.cbl
 17685
 17686******************************************************************
 17687*                                                                *
 17688*           U P D A T E   B A T C H   H E A D E R                *
 17689*                                                                *
 17690******************************************************************
 17691
 17692 3600-UPDATE-BATCH-HEADER.
 17693
 17694* EXEC CICS HANDLE CONDITION
 17695*         NOTFND      (3690-NOT-FOUND)
 17696*    END-EXEC.
 17697*    MOVE '"$I                   ! G #00015169' TO DFHEIV0
 17698     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17700     MOVE X'4720233030303135313639' TO DFHEIV0(25:11)
 17701     CALL 'kxdfhei1' USING DFHEIV0
 17702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17703
 17704
 17705
 17706* EXEC CICS READ
 17707*        DATASET (FILE-ID-ERPNDB)
 17708*        RIDFLD  (ERPNDB-KEY)
 17709*        SET     (ADDRESS OF PENDING-BUSINESS)
 17710*        UPDATE
 17711*    END-EXEC.
 17712*    MOVE '&"S        EU         (   #00015173' TO DFHEIV0
 17713     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17714     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17715     MOVE X'2020233030303135313733' TO DFHEIV0(25:11)
 17716     CALL 'kxdfhei1' USING DFHEIV0,
 17717           FILE-ID-ERPNDB,
 17718           DFHEIV20,
 17719           DFHEIV99,
 17720           ERPNDB-KEY,
 17721           DFHEIV99,
 17722           DFHEIV99,
 17723           DFHEIV99
 17724     SET ADDRESS OF PENDING-BUSINESS TO
 17725         DFHEIV20
 17726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17727
 17728
 17729     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17730     MOVE 'B'                    TO JP-RECORD-TYPE.
 17731     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17732
 17733     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17734
 17735     PERFORM 8400-LOG-JOURNAL-RECORD.
 17736
 17737     IF DRISSL GREATER THAN ZEROS
 17738        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 17739
 17740     IF DRCANCL GREATER THAN ZEROS
 17741        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 17742
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 329
* EL6311.cbl
 17743
 17744     IF DRLFPRML GREATER THAN ZEROS
 17745        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 17746
 17747     IF DRAHPRML GREATER THAN ZEROS
 17748        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 17749
 17750     IF DRLFRFDL GREATER THAN ZEROS
 17751        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 17752
 17753     IF DRAHRFDL GREATER THAN ZEROS
 17754        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 17755
 17756 3670-REWRITE-BATCH-HEADER.
 17757     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 17758        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 17759        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 17760        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 17761        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 17762        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 17763        MOVE SPACE               TO PB-OUT-BAL-CD
 17764     ELSE
 17765        MOVE 'O'                 TO PB-OUT-BAL-CD.
 17766
 17767     MOVE 'C'                    TO JP-RECORD-TYPE.
 17768     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17769
 17770
 17771* EXEC CICS REWRITE
 17772*         DATASET      (FILE-ID-ERPNDB)
 17773*         FROM         (PENDING-BUSINESS)
 17774*    END-EXEC.
 17775     MOVE LENGTH OF
 17776      PENDING-BUSINESS
 17777       TO DFHEIV11
 17778*    MOVE '&& L                  %   #00015221' TO DFHEIV0
 17779     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17780     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17781     MOVE X'2020233030303135323231' TO DFHEIV0(25:11)
 17782     CALL 'kxdfhei1' USING DFHEIV0,
 17783           FILE-ID-ERPNDB,
 17784           PENDING-BUSINESS,
 17785           DFHEIV11,
 17786           DFHEIV99
 17787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17788
 17789
 17790     PERFORM 8400-LOG-JOURNAL-RECORD.
 17791
 17792     GO TO 7200-DISPLAY-BATCHES.
 17793
 17794 3690-NOT-FOUND.
 17795     MOVE ER-2192                TO EMI-ERROR.
 17796     MOVE -1                     TO DPFENTRL.
 17797     MOVE AL-UNBON               TO DPFENTRA.
 17798     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17799     GO TO 8200-SEND-DATAONLY.
 17800
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 330
* EL6311.cbl
 17802
 17803******************************************************************
 17804*                                                                *
 17805*           R E - D I S P L A Y   R E C O R D                    *
 17806*                                                                *
 17807******************************************************************
 17808
 17809 3900-RE-DISPLAY-RECORD.
 17810
 17811* EXEC CICS HANDLE CONDITION
 17812*         NOTFND   (3990-NOT-FOUND)
 17813*    END-EXEC.
 17814*    MOVE '"$I                   ! H #00015246' TO DFHEIV0
 17815     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17817     MOVE X'4820233030303135323436' TO DFHEIV0(25:11)
 17818     CALL 'kxdfhei1' USING DFHEIV0
 17819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17820
 17821
 17822     IF PI-DISPLAY-ORIGINAL-BATCH
 17823         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 17824     ELSE
 17825         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 17826
 17827
 17828* EXEC CICS READ
 17829*         DATASET   (FILE-ID)
 17830*         RIDFLD    (PI-PREV-KEY)
 17831*         SET       (ADDRESS OF PENDING-BUSINESS)
 17832*    END-EXEC.
 17833*    MOVE '&"S        E          (   #00015255' TO DFHEIV0
 17834     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17835     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17836     MOVE X'2020233030303135323535' TO DFHEIV0(25:11)
 17837     CALL 'kxdfhei1' USING DFHEIV0,
 17838           FILE-ID,
 17839           DFHEIV20,
 17840           DFHEIV99,
 17841           PI-PREV-KEY,
 17842           DFHEIV99,
 17843           DFHEIV99,
 17844           DFHEIV99
 17845     SET ADDRESS OF PENDING-BUSINESS TO
 17846         DFHEIV20
 17847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17848
 17849
 17850     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 17851
 17852     IF PB-ISSUE
 17853         GO TO 7000-DISPLAY-ISSUES.
 17854
 17855     IF PB-CANCELLATION
 17856         GO TO 7100-DISPLAY-CANCELS.
 17857
 17858     IF PB-BATCH-TRAILER
 17859         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 331
* EL6311.cbl
 17860
 17861 3990-NOT-FOUND.
 17862     MOVE LOW-VALUES             TO EL631BI.
 17863
 17864     IF PI-MAP-NAME = EL631B
 17865         MOVE -1                  TO BMAINTL
 17866     ELSE
 17867         MOVE -1                  TO CMAINTL.
 17868
 17869     GO TO 8100-SEND-INITIAL-MAP.
 17870
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 332
* EL6311.cbl
 17872
 17873***************************************************************
 17874*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 17875*                                                             *
 17876*      1. START BROWSE WITH                                   *
 17877*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 17878*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 17879*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 17880*                                                             *
 17881*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 17882*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 17883*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 17884*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 17885*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 17886*               AND IS IT TO BE DISPLAYED.                    *
 17887*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 17888*               DISPLAYED.                                    *
 17889*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 17890*               DISPLAYED.                                    *
 17891*                                                             *
 17892*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 17893*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 17894***************************************************************
 17895
 17896 4000-BROWSE-DETAIL-FORWARD.
 17897     IF FIRST-TIME
 17898        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 17899     ELSE
 17900        IF SHOW-RECORD
 17901           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 17902           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 17903           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 17904           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 17905           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 17906        ELSE
 17907           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 17908
 17909
 17910* EXEC CICS HANDLE CONDITION
 17911*         NOTFND   (4050-END-RECORDS)
 17912*         ENDFILE  (4050-END-RECORDS)
 17913*    END-EXEC.
 17914*    MOVE '"$I''                  ! I #00015320' TO DFHEIV0
 17915     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17916     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17917     MOVE X'4920233030303135333230' TO DFHEIV0(25:11)
 17918     CALL 'kxdfhei1' USING DFHEIV0
 17919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17920
 17921
 17922
 17923* EXEC CICS STARTBR
 17924*         DATASET   (FILE-ID-ERPNDB2)
 17925*         RIDFLD    (ERPNDB-ALT-KEY)
 17926*    END-EXEC.
 17927     MOVE 0
 17928       TO DFHEIV11
 17929*    MOVE '&,         G          &   #00015325' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 333
* EL6311.cbl
 17930     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17931     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17932     MOVE X'2020233030303135333235' TO DFHEIV0(25:11)
 17933     CALL 'kxdfhei1' USING DFHEIV0,
 17934           FILE-ID-ERPNDB2,
 17935           ERPNDB-ALT-KEY,
 17936           DFHEIV99,
 17937           DFHEIV11,
 17938           DFHEIV99
 17939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17940
 17941
 17942     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 17943
 17944     IF FIRST-TIME OR SHOW-RECORD
 17945        MOVE SPACE               TO WS-FIRST-TIME-SW
 17946        GO TO 4005-READ-NEXT-RECORD.
 17947
 17948
 17949* EXEC CICS READNEXT
 17950*         DATASET    (FILE-ID-ERPNDB2)
 17951*         SET        (ADDRESS OF PENDING-BUSINESS)
 17952*         RIDFLD     (ERPNDB-ALT-KEY)
 17953*    END-EXEC.
 17954     MOVE 0
 17955       TO DFHEIV11
 17956*    MOVE '&.S                   )   #00015336' TO DFHEIV0
 17957     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17958     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17959     MOVE X'2020233030303135333336' TO DFHEIV0(25:11)
 17960     CALL 'kxdfhei1' USING DFHEIV0,
 17961           FILE-ID-ERPNDB2,
 17962           DFHEIV20,
 17963           DFHEIV99,
 17964           ERPNDB-ALT-KEY,
 17965           DFHEIV99,
 17966           DFHEIV11,
 17967           DFHEIV99,
 17968           DFHEIV99
 17969     SET ADDRESS OF PENDING-BUSINESS TO
 17970         DFHEIV20
 17971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17972
 17973
 17974 4005-READ-NEXT-RECORD.
 17975
 17976* EXEC CICS READNEXT
 17977*         DATASET    (FILE-ID-ERPNDB2)
 17978*         SET        (ADDRESS OF PENDING-BUSINESS)
 17979*         RIDFLD     (ERPNDB-ALT-KEY)
 17980*    END-EXEC.
 17981     MOVE 0
 17982       TO DFHEIV11
 17983*    MOVE '&.S                   )   #00015343' TO DFHEIV0
 17984     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17985     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17986     MOVE X'2020233030303135333433' TO DFHEIV0(25:11)
 17987     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 334
* EL6311.cbl
 17988           FILE-ID-ERPNDB2,
 17989           DFHEIV20,
 17990           DFHEIV99,
 17991           ERPNDB-ALT-KEY,
 17992           DFHEIV99,
 17993           DFHEIV11,
 17994           DFHEIV99,
 17995           DFHEIV99
 17996     SET ADDRESS OF PENDING-BUSINESS TO
 17997         DFHEIV20
 17998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17999
 18000
 18001     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18002
 18003     IF WS-BATCH-PREFIX = '#CL'
 18004        GO TO 4005-READ-NEXT-RECORD.
 18005
 18006     IF SHOW-RECORD
 18007        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18008           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18009           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18010           PB-STATE         NOT = PI-PB-STATE          OR
 18011           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18012           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18013           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18014           GO TO 4050-END-RECORDS
 18015        ELSE
 18016           GO TO 4010-CHECK-REC-TYPE.
 18017
 18018     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18019        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18020        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18021        PB-STATE            NOT = PI-PB-STATE          OR
 18022        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18023        GO TO 4050-END-RECORDS.
 18024
 18025     IF PB-BATCH-TRAILER
 18026        GO TO 4005-READ-NEXT-RECORD.
 18027
 18028     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18029        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18030           GO TO 4005-READ-NEXT-RECORD
 18031        ELSE
 18032           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18033              GO TO 4010-CHECK-REC-TYPE
 18034           ELSE
 18035              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18036                 GO TO 4010-CHECK-REC-TYPE
 18037              ELSE
 18038                 GO TO 4005-READ-NEXT-RECORD.
 18039
 18040     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18041        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18042           GO TO 4005-READ-NEXT-RECORD.
 18043
 18044 4010-CHECK-REC-TYPE.
 18045     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 335
* EL6311.cbl
 18046         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18047             NEXT SENTENCE
 18048         ELSE
 18049             GO TO 4005-READ-NEXT-RECORD.
 18050
 18051     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18052         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18053             NEXT SENTENCE
 18054        ELSE
 18055             GO TO 4005-READ-NEXT-RECORD.
 18056
 18057     IF NOT DISPLAY-CHANGE-RECORDS AND
 18058            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18059        GO TO 4005-READ-NEXT-RECORD.
 18060
 18061     IF DISPLAY-HOLD-RECORDS AND
 18062        NOT PB-RECORD-ON-HOLD
 18063          GO TO 4005-READ-NEXT-RECORD.
 18064
 18065     IF PB-ISSUE
 18066        IF DISPLAY-CHK-REQ-RECORDS
 18067            GO TO 4005-READ-NEXT-RECORD.
 18068
 18069     IF PB-ISSUE
 18070        IF ISSUE-WITH-WARNING
 18071           IF PB-WARNING-ERRORS
 18072              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18073                  GO TO 4005-READ-NEXT-RECORD
 18074              ELSE
 18075                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18076                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18077                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18078                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18079                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18080                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18081                 GO TO 7000-DISPLAY-ISSUES
 18082           ELSE
 18083              GO TO 4005-READ-NEXT-RECORD.
 18084
 18085     IF PB-ISSUE
 18086        IF (ISSUES-IN-ERROR AND
 18087            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18088            ALL-ISSUES
 18089            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18090            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18091            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18092            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18093            MOVE PB-SV-STATE            TO PI-SV-STATE
 18094            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18095            GO TO 7000-DISPLAY-ISSUES
 18096        ELSE
 18097            GO TO 4005-READ-NEXT-RECORD.
 18098
 18099     IF PB-CANCELLATION
 18100        IF DISPLAY-CHK-REQ-RECORDS
 18101           IF PB-C-REFUND-REQUESTED
 18102              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18103              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 336
* EL6311.cbl
 18104              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18105              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18106              MOVE PB-SV-STATE            TO PI-SV-STATE
 18107              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18108              GO TO 7100-DISPLAY-CANCELS
 18109           ELSE
 18110               GO TO 4005-READ-NEXT-RECORD.
 18111
 18112     IF PB-CANCELLATION
 18113        IF CANCEL-WITH-WARNING
 18114           IF PB-WARNING-ERRORS
 18115              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18116                  GO TO 4005-READ-NEXT-RECORD
 18117              ELSE
 18118                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18119                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18120                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18121                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18122                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18123                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18124                 GO TO 7100-DISPLAY-CANCELS
 18125           ELSE
 18126              GO TO 4005-READ-NEXT-RECORD.
 18127
 18128     IF PB-CANCELLATION
 18129        IF (CANCEL-IN-ERROR  AND
 18130            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18131            ALL-CANCELS
 18132            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18133            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18134            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18135            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18136            MOVE PB-SV-STATE            TO PI-SV-STATE
 18137            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18138            GO TO 7100-DISPLAY-CANCELS.
 18139
 18140     GO TO 4005-READ-NEXT-RECORD.
 18141
 18142 4050-END-RECORDS.
 18143******************************************************************
 18144*                                                                *
 18145*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18146*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18147*         PROGRAM.                                               *
 18148*                                                                *
 18149******************************************************************
 18150
 18151     IF BROWSE-STARTED
 18152        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18153
 18154* EXEC CICS ENDBR
 18155*            DATASET  (FILE-ID-ERPNDB2)
 18156*       END-EXEC.
 18157     MOVE 0
 18158       TO DFHEIV11
 18159*    MOVE '&2                    $   #00015501' TO DFHEIV0
 18160     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18161     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 337
* EL6311.cbl
 18162     MOVE X'2020233030303135353031' TO DFHEIV0(25:11)
 18163     CALL 'kxdfhei1' USING DFHEIV0,
 18164           FILE-ID-ERPNDB2,
 18165           DFHEIV11,
 18166           DFHEIV99
 18167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18168
 18169
 18170     IF  EIBTRNID NOT = TRANS-EXB1
 18171         IF PENDING-BUS-RECS-FOUND
 18172             NEXT SENTENCE
 18173           ELSE
 18174             MOVE '9'            TO PI-BROWSE-SW
 18175             GO TO 9400-CLEAR.
 18176
 18177     IF SHOW-RECORD
 18178        MOVE ER-2253            TO EMI-ERROR
 18179       ELSE
 18180        MOVE ER-2254            TO EMI-ERROR.
 18181
 18182     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18183
 18184     IF PI-MAP-NAME = SPACES
 18185        MOVE -1                  TO DPFENTRL
 18186        MOVE EL631D               TO PI-MAP-NAME
 18187        GO TO 8100-SEND-INITIAL-MAP.
 18188
 18189     IF PI-MAP-NAME = EL631B
 18190        MOVE -1                  TO BMAINTL
 18191     ELSE
 18192        IF PI-MAP-NAME = EL631C
 18193           MOVE -1               TO CMAINTL
 18194        ELSE
 18195           MOVE -1               TO DPFENTRL.
 18196
 18197     GO TO 8200-SEND-DATAONLY.
 18198
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 338
* EL6311.cbl
 18200
 18201***************************************************************
 18202*                                                             *
 18203*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18204*                                                             *
 18205*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18206*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18207*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18208*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18209*                                                             *
 18210*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18211*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18212*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18213*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18214*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18215*                AND IS IT TO BE DISPLAYED.                   *
 18216*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18217*                DISPLAYED.                                   *
 18218*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18219*                DISPLAYED.                                   *
 18220*                                                             *
 18221*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18222*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18223*                                                             *
 18224*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18225*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18226*                THEY ARE NOT TO BE DISPLAYED.                *
 18227*                                                             *
 18228***************************************************************
 18229
 18230 4100-BROWSE-PRIMARY-FORWARD.
 18231     IF FIRST-TIME  OR SHOW-RECORD
 18232        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18233        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18234        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18235     ELSE
 18236        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18237        IF ERPNDB-BATCH-SEQ-NO = +9999
 18238           GO TO 4150-END-BATCH
 18239        ELSE
 18240           IF DISPLAY-CHANGE-RECORDS
 18241              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18242           ELSE
 18243              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18244              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18245
 18246     IF FIRST-TIME
 18247         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18248            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18249              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18250
 18251
 18252* EXEC CICS HANDLE CONDITION
 18253*         ENDFILE  (4150-END-BATCH)
 18254*    END-EXEC.
 18255*    MOVE '"$''                   ! J #00015586' TO DFHEIV0
 18256     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 339
* EL6311.cbl
 18258     MOVE X'4A20233030303135353836' TO DFHEIV0(25:11)
 18259     CALL 'kxdfhei1' USING DFHEIV0
 18260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18261
 18262
 18263 4105-READ-NEXT.
 18264
 18265* EXEC CICS HANDLE CONDITION
 18266*         NOTFND    (4150-END-BATCH)
 18267*    END-EXEC.
 18268*    MOVE '"$I                   ! K #00015591' TO DFHEIV0
 18269     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18271     MOVE X'4B20233030303135353931' TO DFHEIV0(25:11)
 18272     CALL 'kxdfhei1' USING DFHEIV0
 18273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18274
 18275
 18276     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18277
 18278     IF PI-DISPLAY-ORIGINAL-BATCH
 18279        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18280     ELSE
 18281        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18282
 18283
 18284* EXEC CICS READ
 18285*         DATASET   (FILE-ID)
 18286*         SET       (ADDRESS OF PENDING-BUSINESS)
 18287*         RIDFLD    (ERPNDB-KEY)
 18288*         GTEQ
 18289*    END-EXEC.
 18290*    MOVE '&"S        G          (   #00015602' TO DFHEIV0
 18291     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18292     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18293     MOVE X'2020233030303135363032' TO DFHEIV0(25:11)
 18294     CALL 'kxdfhei1' USING DFHEIV0,
 18295           FILE-ID,
 18296           DFHEIV20,
 18297           DFHEIV99,
 18298           ERPNDB-KEY,
 18299           DFHEIV99,
 18300           DFHEIV99,
 18301           DFHEIV99
 18302     SET ADDRESS OF PENDING-BUSINESS TO
 18303         DFHEIV20
 18304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18305
 18306
 18307     IF PI-DISPLAY-ORIGINAL-BATCH
 18308        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18309           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18310           GO TO 4150-END-BATCH
 18311        ELSE
 18312           IF PB-BATCH-TRAILER
 18313              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18314              GO TO 4105-READ-NEXT
 18315           ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 340
* EL6311.cbl
 18316              NEXT SENTENCE
 18317     ELSE
 18318        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18319           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18320           GO TO 4150-END-BATCH.
 18321
 18322     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18323
 18324     IF WS-BATCH-PREFIX = '#CL'
 18325         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18326         GO TO 4105-READ-NEXT.
 18327
 18328     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18329     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18330     MOVE PB-STATE               TO PI-PB-STATE.
 18331     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18332
 18333     IF PB-BATCH-TRAILER
 18334        IF SHOW-RECORD
 18335           GO TO 4150-END-BATCH
 18336        ELSE
 18337           MOVE ER-2251         TO EMI-ERROR
 18338           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18339           MOVE 1               TO PI-BROWSE-TYPE
 18340           GO TO 7200-DISPLAY-BATCHES.
 18341
 18342     IF SHOW-RECORD
 18343           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18344              GO TO 4110-BUMP-SEQ
 18345           ELSE
 18346              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18347                 GO TO 4110-BUMP-SEQ
 18348              ELSE
 18349                 GO TO 4107-CHECK-REC-TYPE.
 18350
 18351     IF NOT  PI-PRIMARY-WITH-SELECT
 18352        GO TO 4107-CHECK-REC-TYPE.
 18353
 18354     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18355        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18356           GO TO 4110-BUMP-SEQ
 18357        ELSE
 18358           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18359              GO TO 4107-CHECK-REC-TYPE
 18360           ELSE
 18361              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18362                 GO TO 4107-CHECK-REC-TYPE
 18363              ELSE
 18364                 GO TO 4110-BUMP-SEQ.
 18365
 18366     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18367        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18368           GO TO 4110-BUMP-SEQ.
 18369
 18370 4107-CHECK-REC-TYPE.
 18371     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18372         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18373             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 341
* EL6311.cbl
 18374           ELSE
 18375             GO TO 4110-BUMP-SEQ.
 18376
 18377     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18378         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18379             NEXT SENTENCE
 18380           ELSE
 18381             GO TO 4110-BUMP-SEQ.
 18382
 18383     IF NOT DISPLAY-CHANGE-RECORDS AND
 18384        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18385           GO TO 4110-BUMP-SEQ.
 18386
 18387     IF DISPLAY-HOLD-RECORDS AND
 18388        NOT PB-RECORD-ON-HOLD
 18389          GO TO 4110-BUMP-SEQ.
 18390
 18391     IF PB-ISSUE
 18392        IF DISPLAY-CHK-REQ-RECORDS
 18393            GO TO 4110-BUMP-SEQ.
 18394
 18395     IF PB-ISSUE
 18396        IF ISSUE-WITH-WARNING
 18397           IF PB-WARNING-ERRORS
 18398              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18399                  GO TO 4110-BUMP-SEQ
 18400              ELSE
 18401                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18402                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18403                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18404                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18405                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18406                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18407                 GO TO 7000-DISPLAY-ISSUES
 18408        ELSE
 18409            GO TO 4110-BUMP-SEQ.
 18410
 18411     IF PB-ISSUE
 18412        IF (ISSUES-IN-ERROR AND
 18413            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18414            ALL-ISSUES
 18415            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18416            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18417            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18418            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18419            MOVE PB-SV-STATE            TO PI-SV-STATE
 18420            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18421            GO TO 7000-DISPLAY-ISSUES
 18422        ELSE
 18423            GO TO 4110-BUMP-SEQ.
 18424
 18425     IF PB-CANCELLATION
 18426        IF DISPLAY-CHK-REQ-RECORDS
 18427           IF PB-C-REFUND-REQUESTED
 18428              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18429              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18430              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18431              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 342
* EL6311.cbl
 18432              MOVE PB-SV-STATE            TO PI-SV-STATE
 18433              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18434              GO TO 7100-DISPLAY-CANCELS
 18435           ELSE
 18436              GO TO 4110-BUMP-SEQ.
 18437
 18438     IF PB-CANCELLATION
 18439        IF CANCEL-WITH-WARNING
 18440           IF PB-WARNING-ERRORS
 18441              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18442                  GO TO 4110-BUMP-SEQ
 18443              ELSE
 18444                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18445                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18446                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18447                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18448                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18449                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18450                 GO TO 7100-DISPLAY-CANCELS
 18451           ELSE
 18452              GO TO 4110-BUMP-SEQ.
 18453
 18454     IF PB-CANCELLATION
 18455        IF (CANCEL-IN-ERROR  AND
 18456            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18457            ALL-CANCELS
 18458            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18459            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18460            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18461            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18462            MOVE PB-SV-STATE            TO PI-SV-STATE
 18463            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18464            GO TO 7100-DISPLAY-CANCELS.
 18465
 18466 4110-BUMP-SEQ.
 18467     IF NOT DISPLAY-CHANGE-RECORDS
 18468        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18469        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18470     ELSE
 18471        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18472           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18473           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18474        ELSE
 18475           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18476           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18477
 18478     GO TO 4105-READ-NEXT.
 18479
 18480 4150-END-BATCH.
 18481******************************************************************
 18482*                                                                *
 18483*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18484*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18485*         PROGRAM.                                               *
 18486*                                                                *
 18487******************************************************************
 18488
 18489     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 343
* EL6311.cbl
 18490         IF PENDING-BUS-RECS-FOUND
 18491             NEXT SENTENCE
 18492           ELSE
 18493             MOVE '9'            TO PI-BROWSE-SW
 18494             GO TO 9400-CLEAR.
 18495
 18496     IF SHOW-RECORD
 18497        MOVE ER-2253             TO EMI-ERROR
 18498     ELSE
 18499        MOVE ER-2251             TO EMI-ERROR.
 18500
 18501     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18502
 18503     IF PI-MAP-NAME = SPACES
 18504        MOVE -1                  TO BMAINTL
 18505        MOVE EL631B              TO PI-MAP-NAME
 18506        GO TO 8100-SEND-INITIAL-MAP.
 18507
 18508     IF PI-MAP-NAME = EL631B
 18509        MOVE -1                  TO BMAINTL
 18510     ELSE
 18511        IF PI-MAP-NAME = EL631C
 18512           MOVE -1               TO CMAINTL
 18513        ELSE
 18514           MOVE -1               TO DPFENTRL.
 18515
 18516     GO TO 8200-SEND-DATAONLY.
 18517
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 344
* EL6311.cbl
 18519
 18520***************************************************************
 18521*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 18522*                                                             *
 18523*      1. START BROWSE WITH                                   *
 18524*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18525*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18526*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18527*                                                             *
 18528*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18529*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18530*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18531*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18532*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18533*               AND IS IT TO BE DISPLAYED.                    *
 18534*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18535*               DISPLAYED.                                    *
 18536*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18537*               DISPLAYED.                                    *
 18538*                                                             *
 18539*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18540*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18541***************************************************************
 18542
 18543 4200-BROWSE-CSR-FORWARD.
 18544
 18545     IF FIRST-TIME
 18546        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 18547     ELSE
 18548        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 18549
 18550
 18551* EXEC CICS HANDLE CONDITION
 18552*         NOTFND   (4250-END-RECORDS)
 18553*         ENDFILE  (4250-END-RECORDS)
 18554*    END-EXEC.
 18555*    MOVE '"$I''                  ! L #00015852' TO DFHEIV0
 18556     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18557     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18558     MOVE X'4C20233030303135383532' TO DFHEIV0(25:11)
 18559     CALL 'kxdfhei1' USING DFHEIV0
 18560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18561
 18562
 18563
 18564* EXEC CICS STARTBR
 18565*         DATASET   (FILE-ID-ERPNDB4)
 18566*         RIDFLD    (ERPNDB-CSR-KEY)
 18567*    END-EXEC.
 18568     MOVE 0
 18569       TO DFHEIV11
 18570*    MOVE '&,         G          &   #00015857' TO DFHEIV0
 18571     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18572     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18573     MOVE X'2020233030303135383537' TO DFHEIV0(25:11)
 18574     CALL 'kxdfhei1' USING DFHEIV0,
 18575           FILE-ID-ERPNDB4,
 18576           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 345
* EL6311.cbl
 18577           DFHEIV99,
 18578           DFHEIV11,
 18579           DFHEIV99
 18580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18581
 18582
 18583     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18584
 18585     IF FIRST-TIME
 18586        MOVE SPACE               TO WS-FIRST-TIME-SW
 18587        GO TO 4205-READ-NEXT-RECORD.
 18588
 18589
 18590* EXEC CICS READNEXT
 18591*         DATASET    (FILE-ID-ERPNDB4)
 18592*         SET        (ADDRESS OF PENDING-BUSINESS)
 18593*         RIDFLD     (ERPNDB-CSR-KEY)
 18594*    END-EXEC.
 18595     MOVE 0
 18596       TO DFHEIV11
 18597*    MOVE '&.S                   )   #00015868' TO DFHEIV0
 18598     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18599     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18600     MOVE X'2020233030303135383638' TO DFHEIV0(25:11)
 18601     CALL 'kxdfhei1' USING DFHEIV0,
 18602           FILE-ID-ERPNDB4,
 18603           DFHEIV20,
 18604           DFHEIV99,
 18605           ERPNDB-CSR-KEY,
 18606           DFHEIV99,
 18607           DFHEIV11,
 18608           DFHEIV99,
 18609           DFHEIV99
 18610     SET ADDRESS OF PENDING-BUSINESS TO
 18611         DFHEIV20
 18612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18613
 18614
 18615 4205-READ-NEXT-RECORD.
 18616
 18617
 18618* EXEC CICS READNEXT
 18619*         DATASET    (FILE-ID-ERPNDB4)
 18620*         SET        (ADDRESS OF PENDING-BUSINESS)
 18621*         RIDFLD     (ERPNDB-CSR-KEY)
 18622*    END-EXEC.
 18623     MOVE 0
 18624       TO DFHEIV11
 18625*    MOVE '&.S                   )   #00015876' TO DFHEIV0
 18626     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18627     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18628     MOVE X'2020233030303135383736' TO DFHEIV0(25:11)
 18629     CALL 'kxdfhei1' USING DFHEIV0,
 18630           FILE-ID-ERPNDB4,
 18631           DFHEIV20,
 18632           DFHEIV99,
 18633           ERPNDB-CSR-KEY,
 18634           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 346
* EL6311.cbl
 18635           DFHEIV11,
 18636           DFHEIV99,
 18637           DFHEIV99
 18638     SET ADDRESS OF PENDING-BUSINESS TO
 18639         DFHEIV20
 18640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18641
 18642
 18643     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18644
 18645     IF WS-BATCH-PREFIX = '#CL'
 18646        GO TO 4205-READ-NEXT-RECORD.
 18647
 18648     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 18649        PB-CSR-ID           NOT = PI-PB-CSR-ID
 18650        GO TO 4250-END-RECORDS.
 18651
 18652     IF PB-BATCH-TRAILER
 18653        GO TO 4205-READ-NEXT-RECORD.
 18654
 18655     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18656        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18657           GO TO 4205-READ-NEXT-RECORD
 18658        ELSE
 18659           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18660              GO TO 4210-CHECK-REC-TYPE
 18661           ELSE
 18662              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18663                 GO TO 4210-CHECK-REC-TYPE
 18664              ELSE
 18665                 GO TO 4205-READ-NEXT-RECORD.
 18666
 18667     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18668        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18669           GO TO 4205-READ-NEXT-RECORD.
 18670
 18671 4210-CHECK-REC-TYPE.
 18672     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18673         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18674             NEXT SENTENCE
 18675         ELSE
 18676             GO TO 4205-READ-NEXT-RECORD.
 18677
 18678     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18679         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18680             NEXT SENTENCE
 18681        ELSE
 18682             GO TO 4205-READ-NEXT-RECORD.
 18683
 18684     IF NOT DISPLAY-CHANGE-RECORDS AND
 18685            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18686        GO TO 4205-READ-NEXT-RECORD.
 18687
 18688     IF DISPLAY-HOLD-RECORDS AND
 18689        NOT PB-RECORD-ON-HOLD
 18690          GO TO 4205-READ-NEXT-RECORD.
 18691
 18692     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 347
* EL6311.cbl
 18693        IF DISPLAY-CHK-REQ-RECORDS
 18694            GO TO 4205-READ-NEXT-RECORD.
 18695
 18696     IF PB-ISSUE
 18697        IF ISSUE-WITH-WARNING
 18698           IF PB-WARNING-ERRORS
 18699              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18700                  GO TO 4205-READ-NEXT-RECORD
 18701              ELSE
 18702                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18703                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18704                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18705                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18706                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18707                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18708                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18709                 GO TO 7000-DISPLAY-ISSUES
 18710           ELSE
 18711              GO TO 4205-READ-NEXT-RECORD.
 18712
 18713     IF PB-ISSUE
 18714        IF (ISSUES-IN-ERROR AND
 18715            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18716            ALL-ISSUES
 18717            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18718            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18719            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18720            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18721            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18722            MOVE PB-SV-STATE            TO PI-SV-STATE
 18723            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18724            GO TO 7000-DISPLAY-ISSUES
 18725        ELSE
 18726            GO TO 4205-READ-NEXT-RECORD.
 18727
 18728     IF PB-CANCELLATION
 18729        IF DISPLAY-CHK-REQ-RECORDS
 18730           IF PB-C-REFUND-REQUESTED
 18731              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18732              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18733              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18734              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18735              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18736              MOVE PB-SV-STATE            TO PI-SV-STATE
 18737              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18738              GO TO 7100-DISPLAY-CANCELS
 18739           ELSE
 18740               GO TO 4205-READ-NEXT-RECORD.
 18741
 18742     IF PB-CANCELLATION
 18743        IF CANCEL-WITH-WARNING
 18744           IF PB-WARNING-ERRORS
 18745              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18746                  GO TO 4205-READ-NEXT-RECORD
 18747              ELSE
 18748                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18749                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18750                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 348
* EL6311.cbl
 18751                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18752                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18753                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18754                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18755                 GO TO 7100-DISPLAY-CANCELS
 18756           ELSE
 18757              GO TO 4205-READ-NEXT-RECORD.
 18758
 18759     IF PB-CANCELLATION
 18760        IF (CANCEL-IN-ERROR  AND
 18761            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18762            ALL-CANCELS
 18763            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18764            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18765            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18766            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18767            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18768            MOVE PB-SV-STATE            TO PI-SV-STATE
 18769            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18770            GO TO 7100-DISPLAY-CANCELS.
 18771
 18772     GO TO 4205-READ-NEXT-RECORD.
 18773
 18774 4250-END-RECORDS.
 18775******************************************************************
 18776*                                                                *
 18777*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18778*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18779*         PROGRAM.                                               *
 18780*                                                                *
 18781******************************************************************
 18782
 18783     IF BROWSE-STARTED
 18784        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18785
 18786* EXEC CICS ENDBR
 18787*            DATASET  (FILE-ID-ERPNDB4)
 18788*       END-EXEC.
 18789     MOVE 0
 18790       TO DFHEIV11
 18791*    MOVE '&2                    $   #00016024' TO DFHEIV0
 18792     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18793     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18794     MOVE X'2020233030303136303234' TO DFHEIV0(25:11)
 18795     CALL 'kxdfhei1' USING DFHEIV0,
 18796           FILE-ID-ERPNDB4,
 18797           DFHEIV11,
 18798           DFHEIV99
 18799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18800
 18801
 18802     IF  EIBTRNID NOT = TRANS-EXB1
 18803         IF PENDING-BUS-RECS-FOUND
 18804             NEXT SENTENCE
 18805           ELSE
 18806             MOVE '9'            TO PI-BROWSE-SW
 18807             GO TO 9400-CLEAR.
 18808
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 349
* EL6311.cbl
 18809     IF SHOW-RECORD
 18810        MOVE ER-2253            TO EMI-ERROR
 18811       ELSE
 18812        MOVE ER-2254            TO EMI-ERROR.
 18813
 18814     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18815
 18816     IF PI-MAP-NAME = SPACES
 18817        MOVE -1                  TO DPFENTRL
 18818        MOVE EL631D               TO PI-MAP-NAME
 18819        GO TO 8100-SEND-INITIAL-MAP.
 18820
 18821     IF PI-MAP-NAME = EL631B
 18822        MOVE -1                  TO BMAINTL
 18823     ELSE
 18824        IF PI-MAP-NAME = EL631C
 18825           MOVE -1               TO CMAINTL
 18826        ELSE
 18827           MOVE -1               TO DPFENTRL.
 18828
 18829     GO TO 8200-SEND-DATAONLY.
 18830
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 350
* EL6311.cbl
 18832
 18833***************************************************************
 18834*                                                             *
 18835*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 18836*                                                             *
 18837*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 18838*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18839*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18840*                                                             *
 18841*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18842*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18843*          A. IS IT WITHIN THE SAME COMPANY                   *
 18844*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18845*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18846*                AND IS IT TO BE DISPLAYED.                   *
 18847*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18848*                DISPLAYED.                                   *
 18849*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18850*                DISPLAYED.                                   *
 18851*                                                             *
 18852*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18853*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18854*                                                             *
 18855*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18856*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18857*                THEY ARE NOT TO BE DISPLAYED.                *
 18858*                                                             *
 18859***************************************************************
 18860
 18861 4300-BROWSE-FILE-FORWARD.
 18862     IF FIRST-TIME OR SHOW-RECORD
 18863        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 18864        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 18865        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18866     ELSE
 18867        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18868        IF ERPNDB-BATCH-SEQ-NO = +9999
 18869           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 18870        ELSE
 18871           IF DISPLAY-CHANGE-RECORDS
 18872              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18873           ELSE
 18874              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18875              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18876
 18877
 18878* EXEC CICS HANDLE CONDITION
 18879*         ENDFILE  (4350-END-BATCH)
 18880*         NOTFND   (4350-END-BATCH)
 18881*    END-EXEC.
 18882*    MOVE '"$''I                  ! M #00016103' TO DFHEIV0
 18883     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18885     MOVE X'4D20233030303136313033' TO DFHEIV0(25:11)
 18886     CALL 'kxdfhei1' USING DFHEIV0
 18887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18888
 18889
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 351
* EL6311.cbl
 18890 4305-READ-NEXT.
 18891     IF PI-DISPLAY-ORIGINAL-BATCH
 18892        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18893     ELSE
 18894        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18895
 18896
 18897* EXEC CICS READ
 18898*         DATASET   (FILE-ID)
 18899*         SET       (ADDRESS OF PENDING-BUSINESS)
 18900*         RIDFLD    (ERPNDB-KEY)
 18901*         GTEQ
 18902*    END-EXEC.
 18903*    MOVE '&"S        G          (   #00016114' TO DFHEIV0
 18904     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18906     MOVE X'2020233030303136313134' TO DFHEIV0(25:11)
 18907     CALL 'kxdfhei1' USING DFHEIV0,
 18908           FILE-ID,
 18909           DFHEIV20,
 18910           DFHEIV99,
 18911           ERPNDB-KEY,
 18912           DFHEIV99,
 18913           DFHEIV99,
 18914           DFHEIV99
 18915     SET ADDRESS OF PENDING-BUSINESS TO
 18916         DFHEIV20
 18917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18918
 18919
 18920     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 18921        GO TO 4350-END-BATCH.
 18922
 18923     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 18924                                    WS-BATCH-NO.
 18925
 18926     IF  WS-BATCH-PREFIX = '#CL'
 18927         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18928         GO TO 4305-READ-NEXT.
 18929
 18930     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 18931     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18932     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18933     MOVE PB-STATE               TO PI-PB-STATE.
 18934     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18935
 18936     IF PB-BATCH-TRAILER
 18937        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 18938        GO TO 4305-READ-NEXT.
 18939
 18940     IF SHOW-RECORD
 18941           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18942              GO TO 4310-BUMP-SEQ
 18943           ELSE
 18944              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18945                 GO TO 4310-BUMP-SEQ
 18946              ELSE
 18947                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 352
* EL6311.cbl
 18948
 18949     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18950        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18951           GO TO 4310-BUMP-SEQ
 18952        ELSE
 18953           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18954              GO TO 4307-CHECK-REC-TYPE
 18955           ELSE
 18956              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18957                 GO TO 4307-CHECK-REC-TYPE
 18958              ELSE
 18959                 GO TO 4310-BUMP-SEQ.
 18960
 18961     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18962        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18963           GO TO 4310-BUMP-SEQ.
 18964
 18965 4307-CHECK-REC-TYPE.
 18966     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18967         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18968             NEXT SENTENCE
 18969         ELSE
 18970             GO TO 4310-BUMP-SEQ.
 18971
 18972     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18973         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18974             NEXT SENTENCE
 18975        ELSE
 18976             GO TO 4310-BUMP-SEQ.
 18977
 18978     IF NOT DISPLAY-CHANGE-RECORDS AND
 18979            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18980        GO TO 4310-BUMP-SEQ.
 18981
 18982     IF DISPLAY-HOLD-RECORDS AND
 18983        NOT PB-RECORD-ON-HOLD
 18984          GO TO 4310-BUMP-SEQ.
 18985
 18986     IF PB-ISSUE
 18987        IF DISPLAY-CHK-REQ-RECORDS
 18988           GO TO 4310-BUMP-SEQ.
 18989
 18990     IF PB-ISSUE
 18991        IF ISSUE-WITH-WARNING
 18992           IF PB-WARNING-ERRORS
 18993              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18994                  GO TO 4310-BUMP-SEQ
 18995              ELSE
 18996                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18997                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18998                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18999                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19000                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19001                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19002                 GO TO 7000-DISPLAY-ISSUES
 19003           ELSE
 19004              GO TO 4310-BUMP-SEQ.
 19005
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 353
* EL6311.cbl
 19006     IF PB-ISSUE
 19007        IF (ISSUES-IN-ERROR AND
 19008            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19009            ALL-ISSUES
 19010            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19011            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19012            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19013            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19014            MOVE PB-SV-STATE            TO PI-SV-STATE
 19015            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19016            GO TO 7000-DISPLAY-ISSUES
 19017        ELSE
 19018            GO TO 4310-BUMP-SEQ.
 19019
 19020     IF PB-CANCELLATION
 19021        IF DISPLAY-CHK-REQ-RECORDS
 19022           IF PB-C-REFUND-REQUESTED
 19023              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19024              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19025              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19026              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19027              MOVE PB-SV-STATE            TO PI-SV-STATE
 19028              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19029              GO TO 7100-DISPLAY-CANCELS
 19030           ELSE
 19031              GO TO 4310-BUMP-SEQ.
 19032
 19033     IF PB-CANCELLATION
 19034        IF CANCEL-WITH-WARNING
 19035           IF PB-WARNING-ERRORS
 19036              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19037                  GO TO 4310-BUMP-SEQ
 19038              ELSE
 19039                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19040                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19041                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19042                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19043                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19044                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19045                 GO TO 7100-DISPLAY-CANCELS
 19046           ELSE
 19047              GO TO 4310-BUMP-SEQ.
 19048
 19049     IF PB-CANCELLATION
 19050        IF (CANCEL-IN-ERROR  AND
 19051            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19052            ALL-CANCELS
 19053            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19054            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19055            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19056            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19057            MOVE PB-SV-STATE            TO PI-SV-STATE
 19058            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19059            GO TO 7100-DISPLAY-CANCELS.
 19060
 19061 4310-BUMP-SEQ.
 19062     IF NOT DISPLAY-CHANGE-RECORDS
 19063        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 354
* EL6311.cbl
 19064        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19065     ELSE
 19066        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19067           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19068           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19069        ELSE
 19070           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19071           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19072
 19073     GO TO 4305-READ-NEXT.
 19074
 19075 4350-END-BATCH.
 19076
 19077******************************************************************
 19078*                                                                *
 19079*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19080*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19081*         PROGRAM.                                               *
 19082*                                                                *
 19083******************************************************************
 19084
 19085     IF  EIBTRNID NOT = TRANS-EXB1
 19086         IF PENDING-BUS-RECS-FOUND
 19087             NEXT SENTENCE
 19088           ELSE
 19089             MOVE '9'            TO PI-BROWSE-SW
 19090             GO TO 9400-CLEAR.
 19091
 19092     IF SHOW-RECORD
 19093        MOVE ER-2253            TO EMI-ERROR
 19094     ELSE
 19095        MOVE ER-2251            TO EMI-ERROR.
 19096
 19097     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19098
 19099     IF PI-MAP-NAME = SPACES
 19100        MOVE -1                  TO BMAINTL
 19101        MOVE EL631B               TO PI-MAP-NAME
 19102        GO TO 8100-SEND-INITIAL-MAP.
 19103
 19104     IF PI-MAP-NAME = EL631B
 19105        MOVE -1                  TO BMAINTL
 19106     ELSE
 19107        IF PI-MAP-NAME = EL631C
 19108           MOVE -1               TO CMAINTL
 19109        ELSE
 19110           MOVE -1               TO DPFENTRL.
 19111
 19112     GO TO 8200-SEND-DATAONLY.
 19113
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 355
* EL6311.cbl
 19115
 19116******************************************************************
 19117*                                                                *
 19118*        B R O W S E   D E T A I L   B A C K W A R D             *
 19119*                                                                *
 19120******************************************************************
 19121
 19122 4500-BROWSE-DETAIL-BACKWARD.
 19123
 19124     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19125
 19126
 19127* EXEC CICS HANDLE CONDITION
 19128*         NOTFND   (4570-NOT-FOUND)
 19129*         ENDFILE  (4550-END-RECORDS)
 19130*    END-EXEC
 19131*    MOVE '"$I''                  ! N #00016327' TO DFHEIV0
 19132     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19134     MOVE X'4E20233030303136333237' TO DFHEIV0(25:11)
 19135     CALL 'kxdfhei1' USING DFHEIV0
 19136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19137
 19138
 19139* EXEC CICS STARTBR
 19140*         DATASET   (FILE-ID-ERPNDB2)
 19141*         RIDFLD    (ERPNDB-ALT-KEY)
 19142*    END-EXEC.
 19143     MOVE 0
 19144       TO DFHEIV11
 19145*    MOVE '&,         G          &   #00016332' TO DFHEIV0
 19146     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19147     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19148     MOVE X'2020233030303136333332' TO DFHEIV0(25:11)
 19149     CALL 'kxdfhei1' USING DFHEIV0,
 19150           FILE-ID-ERPNDB2,
 19151           ERPNDB-ALT-KEY,
 19152           DFHEIV99,
 19153           DFHEIV11,
 19154           DFHEIV99
 19155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19156
 19157
 19158     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19159                                    WS-FIRST-TIME-SW.
 19160
 19161 4505-READ-PREV-RECORD.
 19162
 19163* EXEC CICS READPREV
 19164*         DATASET    (FILE-ID-ERPNDB2)
 19165*         SET        (ADDRESS OF PENDING-BUSINESS)
 19166*         RIDFLD     (ERPNDB-ALT-KEY)
 19167*    END-EXEC.
 19168     MOVE 0
 19169       TO DFHEIV11
 19170*    MOVE '&0S                   )   #00016341' TO DFHEIV0
 19171     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19172     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 356
* EL6311.cbl
 19173     MOVE X'2020233030303136333431' TO DFHEIV0(25:11)
 19174     CALL 'kxdfhei1' USING DFHEIV0,
 19175           FILE-ID-ERPNDB2,
 19176           DFHEIV20,
 19177           DFHEIV99,
 19178           ERPNDB-ALT-KEY,
 19179           DFHEIV99,
 19180           DFHEIV11,
 19181           DFHEIV99,
 19182           DFHEIV99
 19183     SET ADDRESS OF PENDING-BUSINESS TO
 19184         DFHEIV20
 19185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19186
 19187
 19188     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19189
 19190     IF WS-BATCH-PREFIX = '#CL'
 19191         GO TO 4505-READ-PREV-RECORD.
 19192
 19193     IF FIRST-TIME
 19194         MOVE SPACE               TO WS-FIRST-TIME-SW
 19195         GO TO 4505-READ-PREV-RECORD.
 19196
 19197     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19198        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19199        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19200        PB-STATE         NOT = PI-PB-STATE    OR
 19201        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19202          GO TO 4550-END-RECORDS.
 19203
 19204
 19205     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19206
 19207     IF PB-BATCH-TRAILER
 19208        GO TO 4505-READ-PREV-RECORD.
 19209
 19210     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19211
 19212     IF  WS-BATCH-PREFIX = '#CL'
 19213         GO TO 4505-READ-PREV-RECORD.
 19214
 19215     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19216        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19217           GO TO 4505-READ-PREV-RECORD
 19218        ELSE
 19219           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19220              GO TO 4510-CHECK-REC-TYPE
 19221           ELSE
 19222              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19223                 GO TO 4510-CHECK-REC-TYPE
 19224              ELSE
 19225                 GO TO 4505-READ-PREV-RECORD.
 19226
 19227     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19228        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19229           GO TO 4505-READ-PREV-RECORD.
 19230
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 357
* EL6311.cbl
 19231 4510-CHECK-REC-TYPE.
 19232     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19233         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19234             NEXT SENTENCE
 19235         ELSE
 19236             GO TO 4505-READ-PREV-RECORD.
 19237
 19238     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19239         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19240             NEXT SENTENCE
 19241        ELSE
 19242             GO TO 4505-READ-PREV-RECORD.
 19243
 19244     IF NOT DISPLAY-CHANGE-RECORDS AND
 19245            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19246        GO TO 4505-READ-PREV-RECORD.
 19247
 19248     IF DISPLAY-HOLD-RECORDS AND
 19249        NOT PB-RECORD-ON-HOLD
 19250          GO TO 4505-READ-PREV-RECORD.
 19251
 19252     IF PB-ISSUE
 19253        IF DISPLAY-CHK-REQ-RECORDS
 19254           GO TO 4505-READ-PREV-RECORD.
 19255
 19256     IF PB-ISSUE
 19257        IF ISSUE-WITH-WARNING
 19258           IF PB-WARNING-ERRORS
 19259              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19260                  GO TO 4505-READ-PREV-RECORD
 19261              ELSE
 19262                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19263                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19264                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19265                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19266                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19267                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19268                 GO TO 7000-DISPLAY-ISSUES
 19269           ELSE
 19270              GO TO 4505-READ-PREV-RECORD.
 19271
 19272     IF PB-ISSUE
 19273        IF (ISSUES-IN-ERROR AND
 19274            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19275            ALL-ISSUES
 19276            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19277            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19278            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19279            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19280            MOVE PB-SV-STATE            TO PI-SV-STATE
 19281            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19282            GO TO 7000-DISPLAY-ISSUES
 19283        ELSE
 19284            GO TO 4505-READ-PREV-RECORD.
 19285
 19286     IF PB-CANCELLATION
 19287        IF DISPLAY-CHK-REQ-RECORDS
 19288           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 358
* EL6311.cbl
 19289              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19290              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19291              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19292              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19293              MOVE PB-SV-STATE            TO PI-SV-STATE
 19294              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19295              GO TO 7100-DISPLAY-CANCELS
 19296           ELSE
 19297              GO TO 4505-READ-PREV-RECORD.
 19298
 19299     IF PB-CANCELLATION
 19300        IF CANCEL-WITH-WARNING
 19301           IF PB-WARNING-ERRORS
 19302              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19303                  GO TO 4505-READ-PREV-RECORD
 19304              ELSE
 19305                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19306                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19307                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19308                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19309                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19310                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19311                 GO TO 7100-DISPLAY-CANCELS
 19312           ELSE
 19313              GO TO 4505-READ-PREV-RECORD.
 19314
 19315     IF PB-CANCELLATION
 19316        IF (CANCEL-IN-ERROR  AND
 19317            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19318            ALL-CANCELS
 19319            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19320            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19321            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19322            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19323            MOVE PB-SV-STATE            TO PI-SV-STATE
 19324            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19325            GO TO 7100-DISPLAY-CANCELS.
 19326
 19327     GO TO 4505-READ-PREV-RECORD.
 19328
 19329 4550-END-RECORDS.
 19330     IF PI-MAP-NAME = EL631B
 19331        MOVE -1                  TO BMAINTL
 19332     ELSE
 19333        IF PI-MAP-NAME = EL631C
 19334           MOVE -1               TO CMAINTL
 19335        ELSE
 19336           MOVE -1               TO DPFENTRL.
 19337
 19338     MOVE ER-2255               TO EMI-ERROR.
 19339     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19340     GO TO 8200-SEND-DATAONLY.
 19341
 19342 4570-NOT-FOUND.
 19343
 19344******************************************************************
 19345*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19346******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 359
* EL6311.cbl
 19347
 19348
 19349* EXEC CICS RESETBR
 19350*         DATASET    (FILE-ID-ERPNDB2)
 19351*         RIDFLD     (ERPNDB-ALT-KEY)
 19352*    END-EXEC.
 19353     MOVE 0
 19354       TO DFHEIV11
 19355*    MOVE '&4         G          &   #00016507' TO DFHEIV0
 19356     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19357     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19358     MOVE X'2020233030303136353037' TO DFHEIV0(25:11)
 19359     CALL 'kxdfhei1' USING DFHEIV0,
 19360           FILE-ID-ERPNDB2,
 19361           ERPNDB-ALT-KEY,
 19362           DFHEIV99,
 19363           DFHEIV11,
 19364           DFHEIV99
 19365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19366
 19367
 19368
 19369* EXEC CICS READNEXT
 19370*         DATASET    (FILE-ID-ERPNDB2)
 19371*         SET        (ADDRESS OF PENDING-BUSINESS)
 19372*         RIDFLD     (ERPNDB-ALT-KEY)
 19373*    END-EXEC.
 19374     MOVE 0
 19375       TO DFHEIV11
 19376*    MOVE '&.S                   )   #00016512' TO DFHEIV0
 19377     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19378     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19379     MOVE X'2020233030303136353132' TO DFHEIV0(25:11)
 19380     CALL 'kxdfhei1' USING DFHEIV0,
 19381           FILE-ID-ERPNDB2,
 19382           DFHEIV20,
 19383           DFHEIV99,
 19384           ERPNDB-ALT-KEY,
 19385           DFHEIV99,
 19386           DFHEIV11,
 19387           DFHEIV99,
 19388           DFHEIV99
 19389     SET ADDRESS OF PENDING-BUSINESS TO
 19390         DFHEIV20
 19391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19392
 19393
 19394
 19395* EXEC CICS READPREV
 19396*         DATASET    (FILE-ID-ERPNDB2)
 19397*         SET        (ADDRESS OF PENDING-BUSINESS)
 19398*         RIDFLD     (ERPNDB-ALT-KEY)
 19399*    END-EXEC.
 19400     MOVE 0
 19401       TO DFHEIV11
 19402*    MOVE '&0S                   )   #00016518' TO DFHEIV0
 19403     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19404     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 360
* EL6311.cbl
 19405     MOVE X'2020233030303136353138' TO DFHEIV0(25:11)
 19406     CALL 'kxdfhei1' USING DFHEIV0,
 19407           FILE-ID-ERPNDB2,
 19408           DFHEIV20,
 19409           DFHEIV99,
 19410           ERPNDB-ALT-KEY,
 19411           DFHEIV99,
 19412           DFHEIV11,
 19413           DFHEIV99,
 19414           DFHEIV99
 19415     SET ADDRESS OF PENDING-BUSINESS TO
 19416         DFHEIV20
 19417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19418
 19419
 19420 4580-READ-PREV-RECORD.
 19421
 19422* EXEC CICS READPREV
 19423*         DATASET    (FILE-ID-ERPNDB2)
 19424*         SET        (ADDRESS OF PENDING-BUSINESS)
 19425*         RIDFLD     (ERPNDB-ALT-KEY)
 19426*    END-EXEC.
 19427     MOVE 0
 19428       TO DFHEIV11
 19429*    MOVE '&0S                   )   #00016525' TO DFHEIV0
 19430     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19431     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19432     MOVE X'2020233030303136353235' TO DFHEIV0(25:11)
 19433     CALL 'kxdfhei1' USING DFHEIV0,
 19434           FILE-ID-ERPNDB2,
 19435           DFHEIV20,
 19436           DFHEIV99,
 19437           ERPNDB-ALT-KEY,
 19438           DFHEIV99,
 19439           DFHEIV11,
 19440           DFHEIV99,
 19441           DFHEIV99
 19442     SET ADDRESS OF PENDING-BUSINESS TO
 19443         DFHEIV20
 19444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19445
 19446
 19447     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19448
 19449     IF WS-BATCH-PREFIX = '#CL'
 19450        GO TO 4580-READ-PREV-RECORD.
 19451
 19452     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19453     GO TO 4505-READ-PREV-RECORD.
 19454
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 361
* EL6311.cbl
 19456
 19457******************************************************************
 19458*                                                                *
 19459*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19460*                                                                *
 19461******************************************************************
 19462
 19463 4600-BROWSE-PRIMARY-BACKWARD.
 19464        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19465
 19466     IF ERPNDB-BATCH-SEQ-NO = +9999
 19467        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19468
 19469        IF ERPNDB-BATCH-SEQ-NO = +0000
 19470           GO TO 4650-END-BATCH
 19471        ELSE
 19472           IF PI-MAP-NAME NOT = EL631D
 19473              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19474                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19475              ELSE
 19476                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19477                 IF DISPLAY-CHANGE-RECORDS
 19478                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19479                 ELSE
 19480                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19481
 19482
 19483* EXEC CICS HANDLE CONDITION
 19484*         NOTFND    (4680-NOT-FOUND)
 19485*         ENDFILE   (4680-NOT-FOUND)
 19486*    END-EXEC.
 19487*    MOVE '"$I''                  ! O #00016566' TO DFHEIV0
 19488     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19489     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19490     MOVE X'4F20233030303136353636' TO DFHEIV0(25:11)
 19491     CALL 'kxdfhei1' USING DFHEIV0
 19492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19493
 19494
 19495 4605-READ-NEXT.
 19496     IF ERPNDB-BATCH-SEQ-NO = +0000
 19497        GO TO 4650-END-BATCH.
 19498
 19499     IF PI-DISPLAY-ORIGINAL-BATCH
 19500        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19501     ELSE
 19502        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19503
 19504
 19505* EXEC CICS READ
 19506*         DATASET   (FILE-ID)
 19507*         SET       (ADDRESS OF PENDING-BUSINESS)
 19508*         RIDFLD    (ERPNDB-KEY)
 19509*    END-EXEC.
 19510*    MOVE '&"S        E          (   #00016580' TO DFHEIV0
 19511     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19512     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19513     MOVE X'2020233030303136353830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 362
* EL6311.cbl
 19514     CALL 'kxdfhei1' USING DFHEIV0,
 19515           FILE-ID,
 19516           DFHEIV20,
 19517           DFHEIV99,
 19518           ERPNDB-KEY,
 19519           DFHEIV99,
 19520           DFHEIV99,
 19521           DFHEIV99
 19522     SET ADDRESS OF PENDING-BUSINESS TO
 19523         DFHEIV20
 19524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19525
 19526
 19527     IF NOT  PI-PRIMARY-WITH-SELECT
 19528        GO TO 4607-CHECK-REC-TYPE.
 19529
 19530     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19531
 19532     IF  WS-BATCH-PREFIX = '#CL'
 19533         GO TO 4610-BUMP-SEQ.
 19534
 19535     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19536        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19537           GO TO 4610-BUMP-SEQ
 19538        ELSE
 19539           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19540              GO TO 4607-CHECK-REC-TYPE
 19541           ELSE
 19542              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19543                 GO TO 4607-CHECK-REC-TYPE
 19544              ELSE
 19545                 GO TO 4610-BUMP-SEQ.
 19546
 19547     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19548        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19549           GO TO 4610-BUMP-SEQ.
 19550
 19551 4607-CHECK-REC-TYPE.
 19552     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19553         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19554             NEXT SENTENCE
 19555         ELSE
 19556             GO TO 4610-BUMP-SEQ.
 19557
 19558     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19559         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19560             NEXT SENTENCE
 19561        ELSE
 19562             GO TO 4610-BUMP-SEQ.
 19563
 19564     IF NOT DISPLAY-CHANGE-RECORDS AND
 19565            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19566        GO TO 4610-BUMP-SEQ.
 19567
 19568     IF DISPLAY-HOLD-RECORDS AND
 19569        NOT PB-RECORD-ON-HOLD
 19570          GO TO 4610-BUMP-SEQ.
 19571
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 363
* EL6311.cbl
 19572     IF PB-ISSUE
 19573        IF DISPLAY-CHK-REQ-RECORDS
 19574           GO TO 4610-BUMP-SEQ.
 19575
 19576     IF PB-ISSUE
 19577        IF ISSUE-WITH-WARNING
 19578           IF PB-WARNING-ERRORS
 19579              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19580                  GO TO 4610-BUMP-SEQ
 19581              ELSE
 19582                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19583                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19584                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19585                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19586                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19587                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19588                 GO TO 7000-DISPLAY-ISSUES
 19589           ELSE
 19590              GO TO 4610-BUMP-SEQ.
 19591
 19592     IF PB-ISSUE
 19593        IF (ISSUES-IN-ERROR AND
 19594            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19595            ALL-ISSUES
 19596            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19597            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19598            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19599            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19600            MOVE PB-SV-STATE            TO PI-SV-STATE
 19601            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19602            GO TO 7000-DISPLAY-ISSUES
 19603        ELSE
 19604            GO TO 4610-BUMP-SEQ.
 19605
 19606     IF PB-CANCELLATION
 19607        IF DISPLAY-CHK-REQ-RECORDS
 19608           IF PB-C-REFUND-REQUESTED
 19609              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19610              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19611              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19612              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19613              MOVE PB-SV-STATE            TO PI-SV-STATE
 19614              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19615              GO TO 7100-DISPLAY-CANCELS
 19616           ELSE
 19617              GO TO 4610-BUMP-SEQ.
 19618
 19619     IF PB-CANCELLATION
 19620        IF CANCEL-WITH-WARNING
 19621           IF PB-WARNING-ERRORS
 19622              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19623                  GO TO 4610-BUMP-SEQ
 19624              ELSE
 19625                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19626                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19627                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19628                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19629                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 364
* EL6311.cbl
 19630                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19631                 GO TO 7100-DISPLAY-CANCELS
 19632           ELSE
 19633              GO TO 4610-BUMP-SEQ.
 19634
 19635     IF PB-CANCELLATION
 19636        IF (CANCEL-IN-ERROR  AND
 19637            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19638            ALL-CANCELS
 19639            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19640            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19641            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19642            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19643            MOVE PB-SV-STATE            TO PI-SV-STATE
 19644            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19645            GO TO 7100-DISPLAY-CANCELS.
 19646
 19647 4610-BUMP-SEQ.
 19648     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 19649        GO TO 4650-END-BATCH.
 19650
 19651     IF DISPLAY-CHANGE-RECORDS
 19652        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19653           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 19654        ELSE
 19655           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19656           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19657        ELSE
 19658           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19659           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 19660
 19661        GO TO 4605-READ-NEXT.
 19662
 19663 4650-END-BATCH.
 19664     IF PI-MAP-NAME = EL631B
 19665        MOVE -1                  TO BMAINTL
 19666     ELSE
 19667        IF PI-MAP-NAME = EL631C
 19668           MOVE -1               TO CMAINTL
 19669        ELSE
 19670           MOVE -1               TO DPFENTRL.
 19671
 19672     MOVE ER-2252               TO EMI-ERROR.
 19673     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19674     GO TO 8200-SEND-DATAONLY.
 19675
 19676 4680-NOT-FOUND.
 19677     IF DISPLAY-CHANGE-RECORDS
 19678        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19679           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19680        ELSE
 19681           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19682           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19683     ELSE
 19684        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 19685
 19686     GO TO 4605-READ-NEXT.
 19687
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 365
* EL6311.cbl
 19689
 19690******************************************************************
 19691*                                                                *
 19692*        B R O W S E   F I L E   B A C K W A R D S               *
 19693*                                                                *
 19694******************************************************************
 19695
 19696 4800-BROWSE-FILE-BACKWARD.
 19697
 19698* EXEC CICS HANDLE CONDITION
 19699*         NOTFND   (4860-NOT-FOUND)
 19700*         ENDFILE  (4850-END-RECORDS)
 19701*    END-EXEC.
 19702*    MOVE '"$I''                  ! P #00016756' TO DFHEIV0
 19703     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19704     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19705     MOVE X'5020233030303136373536' TO DFHEIV0(25:11)
 19706     CALL 'kxdfhei1' USING DFHEIV0
 19707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19708
 19709
 19710     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 19711
 19712     IF PI-DISPLAY-ORIGINAL-BATCH
 19713        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19714     ELSE
 19715        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19716
 19717
 19718* EXEC CICS STARTBR
 19719*         DATASET   (FILE-ID)
 19720*         RIDFLD    (ERPNDB-KEY)
 19721*    END-EXEC.
 19722     MOVE 0
 19723       TO DFHEIV11
 19724*    MOVE '&,         G          &   #00016768' TO DFHEIV0
 19725     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19726     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19727     MOVE X'2020233030303136373638' TO DFHEIV0(25:11)
 19728     CALL 'kxdfhei1' USING DFHEIV0,
 19729           FILE-ID,
 19730           ERPNDB-KEY,
 19731           DFHEIV99,
 19732           DFHEIV11,
 19733           DFHEIV99
 19734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19735
 19736
 19737     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19738
 19739
 19740* EXEC CICS READPREV
 19741*         DATASET    (FILE-ID-ERPNDB)
 19742*         SET        (ADDRESS OF PENDING-BUSINESS)
 19743*         RIDFLD     (ERPNDB-KEY)
 19744*    END-EXEC.
 19745     MOVE 0
 19746       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 366
* EL6311.cbl
 19747*    MOVE '&0S                   )   #00016775' TO DFHEIV0
 19748     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19749     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19750     MOVE X'2020233030303136373735' TO DFHEIV0(25:11)
 19751     CALL 'kxdfhei1' USING DFHEIV0,
 19752           FILE-ID-ERPNDB,
 19753           DFHEIV20,
 19754           DFHEIV99,
 19755           ERPNDB-KEY,
 19756           DFHEIV99,
 19757           DFHEIV11,
 19758           DFHEIV99,
 19759           DFHEIV99
 19760     SET ADDRESS OF PENDING-BUSINESS TO
 19761         DFHEIV20
 19762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19763
 19764
 19765 4810-READ-PREV-RECORD.
 19766
 19767* EXEC CICS READPREV
 19768*         DATASET    (FILE-ID-ERPNDB)
 19769*         SET        (ADDRESS OF PENDING-BUSINESS)
 19770*         RIDFLD     (ERPNDB-KEY)
 19771*    END-EXEC.
 19772     MOVE 0
 19773       TO DFHEIV11
 19774*    MOVE '&0S                   )   #00016782' TO DFHEIV0
 19775     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19776     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19777     MOVE X'2020233030303136373832' TO DFHEIV0(25:11)
 19778     CALL 'kxdfhei1' USING DFHEIV0,
 19779           FILE-ID-ERPNDB,
 19780           DFHEIV20,
 19781           DFHEIV99,
 19782           ERPNDB-KEY,
 19783           DFHEIV99,
 19784           DFHEIV11,
 19785           DFHEIV99,
 19786           DFHEIV99
 19787     SET ADDRESS OF PENDING-BUSINESS TO
 19788         DFHEIV20
 19789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19790
 19791
 19792     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 19793        GO TO 4850-END-RECORDS.
 19794
 19795     IF PB-BATCH-TRAILER
 19796        GO TO 4810-READ-PREV-RECORD.
 19797
 19798     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19799
 19800     IF  WS-BATCH-PREFIX = '#CL'
 19801         GO TO 4810-READ-PREV-RECORD.
 19802
 19803     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19804        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 367
* EL6311.cbl
 19805           GO TO 4810-READ-PREV-RECORD
 19806        ELSE
 19807           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19808              GO TO 4820-CHECK-REC-TYPE
 19809           ELSE
 19810              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19811                 GO TO 4820-CHECK-REC-TYPE
 19812              ELSE
 19813                 GO TO 4810-READ-PREV-RECORD.
 19814
 19815     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19816        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19817           GO TO 4810-READ-PREV-RECORD.
 19818
 19819 4820-CHECK-REC-TYPE.
 19820     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19821         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19822             NEXT SENTENCE
 19823         ELSE
 19824             GO TO 4810-READ-PREV-RECORD.
 19825
 19826     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19827         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19828             NEXT SENTENCE
 19829        ELSE
 19830             GO TO 4810-READ-PREV-RECORD.
 19831
 19832     IF NOT DISPLAY-CHANGE-RECORDS AND
 19833            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19834        GO TO 4810-READ-PREV-RECORD.
 19835
 19836     IF DISPLAY-HOLD-RECORDS AND
 19837        NOT PB-RECORD-ON-HOLD
 19838          GO TO 4810-READ-PREV-RECORD.
 19839
 19840     IF PB-ISSUE
 19841        IF DISPLAY-CHK-REQ-RECORDS
 19842           GO TO 4810-READ-PREV-RECORD.
 19843
 19844     IF PB-ISSUE
 19845        IF ISSUE-WITH-WARNING
 19846           IF PB-WARNING-ERRORS
 19847              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19848                  GO TO 4810-READ-PREV-RECORD
 19849              ELSE
 19850                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19851                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19852                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19853                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19854                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19855                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19856                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19857                 GO TO 7000-DISPLAY-ISSUES
 19858           ELSE
 19859              GO TO 4810-READ-PREV-RECORD.
 19860
 19861     IF PB-ISSUE
 19862        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 368
* EL6311.cbl
 19863            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19864            ALL-ISSUES
 19865            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19866            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19867            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19868            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19869            MOVE PB-SV-STATE            TO PI-SV-STATE
 19870            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19871            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19872            GO TO 7000-DISPLAY-ISSUES
 19873        ELSE
 19874            GO TO 4810-READ-PREV-RECORD.
 19875
 19876     IF PB-CANCELLATION
 19877        IF DISPLAY-CHK-REQ-RECORDS
 19878           IF PB-C-REFUND-REQUESTED
 19879              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19880              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19881              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19882              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19883              MOVE PB-SV-STATE            TO PI-SV-STATE
 19884              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19885              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19886              GO TO 7100-DISPLAY-CANCELS
 19887           ELSE
 19888              GO TO 4810-READ-PREV-RECORD.
 19889
 19890     IF PB-CANCELLATION
 19891        IF CANCEL-WITH-WARNING
 19892           IF PB-WARNING-ERRORS
 19893              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19894                  GO TO 4810-READ-PREV-RECORD
 19895              ELSE
 19896                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19897                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19898                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19899                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19900                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19901                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19902                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19903                 GO TO 7100-DISPLAY-CANCELS
 19904           ELSE
 19905              GO TO 4810-READ-PREV-RECORD.
 19906
 19907     IF PB-CANCELLATION
 19908        IF (CANCEL-IN-ERROR  AND
 19909            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19910            ALL-CANCELS
 19911            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19912            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19913            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19914            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19915            MOVE PB-SV-STATE            TO PI-SV-STATE
 19916            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19917            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19918            GO TO 7100-DISPLAY-CANCELS.
 19919
 19920     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 369
* EL6311.cbl
 19921
 19922 4850-END-RECORDS.
 19923     MOVE ER-2252                TO EMI-ERROR.
 19924     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19925
 19926     IF PI-MAP-NAME = EL631B
 19927        MOVE -1                  TO BPFENTRL
 19928     ELSE
 19929        MOVE -1                  TO CPFENTRL.
 19930
 19931     GO TO 8200-SEND-DATAONLY.
 19932
 19933 4860-NOT-FOUND.
 19934
 19935******************************************************************
 19936*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 19937******************************************************************
 19938
 19939
 19940* EXEC CICS RESETBR
 19941*         DATASET    (FILE-ID-ERPNDB)
 19942*         RIDFLD     (ERPNDB-KEY)
 19943*     END-EXEC.
 19944     MOVE 0
 19945       TO DFHEIV11
 19946*    MOVE '&4         G          &   #00016935' TO DFHEIV0
 19947     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19948     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19949     MOVE X'2020233030303136393335' TO DFHEIV0(25:11)
 19950     CALL 'kxdfhei1' USING DFHEIV0,
 19951           FILE-ID-ERPNDB,
 19952           ERPNDB-KEY,
 19953           DFHEIV99,
 19954           DFHEIV11,
 19955           DFHEIV99
 19956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19957
 19958
 19959
 19960* EXEC CICS READNEXT
 19961*         DATASET    (FILE-ID-ERPNDB)
 19962*         SET        (ADDRESS OF PENDING-BUSINESS)
 19963*         RIDFLD     (ERPNDB-KEY)
 19964*    END-EXEC.
 19965     MOVE 0
 19966       TO DFHEIV11
 19967*    MOVE '&.S                   )   #00016940' TO DFHEIV0
 19968     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19969     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19970     MOVE X'2020233030303136393430' TO DFHEIV0(25:11)
 19971     CALL 'kxdfhei1' USING DFHEIV0,
 19972           FILE-ID-ERPNDB,
 19973           DFHEIV20,
 19974           DFHEIV99,
 19975           ERPNDB-KEY,
 19976           DFHEIV99,
 19977           DFHEIV11,
 19978           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 370
* EL6311.cbl
 19979           DFHEIV99
 19980     SET ADDRESS OF PENDING-BUSINESS TO
 19981         DFHEIV20
 19982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19983
 19984
 19985
 19986* EXEC CICS READPREV
 19987*         DATASET    (FILE-ID-ERPNDB)
 19988*         SET        (ADDRESS OF PENDING-BUSINESS)
 19989*         RIDFLD     (ERPNDB-KEY)
 19990*    END-EXEC.
 19991     MOVE 0
 19992       TO DFHEIV11
 19993*    MOVE '&0S                   )   #00016946' TO DFHEIV0
 19994     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19995     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19996     MOVE X'2020233030303136393436' TO DFHEIV0(25:11)
 19997     CALL 'kxdfhei1' USING DFHEIV0,
 19998           FILE-ID-ERPNDB,
 19999           DFHEIV20,
 20000           DFHEIV99,
 20001           ERPNDB-KEY,
 20002           DFHEIV99,
 20003           DFHEIV11,
 20004           DFHEIV99,
 20005           DFHEIV99
 20006     SET ADDRESS OF PENDING-BUSINESS TO
 20007         DFHEIV20
 20008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20009
 20010
 20011     GO TO 4810-READ-PREV-RECORD.
 20012
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 371
* EL6311.cbl
 20014
 20015******************************************************************
 20016*                                                                *
 20017*           B R O W S E   C S R   B A C K W A R D                *
 20018*                                                                *
 20019******************************************************************
 20020
 20021 4900-BROWSE-CSR-BACKWARD.
 20022
 20023     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20024
 20025
 20026* EXEC CICS HANDLE CONDITION
 20027*         NOTFND   (4970-NOT-FOUND)
 20028*         ENDFILE  (4950-END-RECORDS)
 20029*    END-EXEC
 20030*    MOVE '"$I''                  ! Q #00016966' TO DFHEIV0
 20031     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20032     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20033     MOVE X'5120233030303136393636' TO DFHEIV0(25:11)
 20034     CALL 'kxdfhei1' USING DFHEIV0
 20035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20036
 20037
 20038* EXEC CICS STARTBR
 20039*         DATASET   (FILE-ID-ERPNDB4)
 20040*         RIDFLD    (ERPNDB-CSR-KEY)
 20041*    END-EXEC.
 20042     MOVE 0
 20043       TO DFHEIV11
 20044*    MOVE '&,         G          &   #00016971' TO DFHEIV0
 20045     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20046     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20047     MOVE X'2020233030303136393731' TO DFHEIV0(25:11)
 20048     CALL 'kxdfhei1' USING DFHEIV0,
 20049           FILE-ID-ERPNDB4,
 20050           ERPNDB-CSR-KEY,
 20051           DFHEIV99,
 20052           DFHEIV11,
 20053           DFHEIV99
 20054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20055
 20056
 20057     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20058                                    WS-FIRST-TIME-SW.
 20059
 20060 4905-READ-PREV-RECORD.
 20061
 20062* EXEC CICS READPREV
 20063*         DATASET    (FILE-ID-ERPNDB4)
 20064*         SET        (ADDRESS OF PENDING-BUSINESS)
 20065*         RIDFLD     (ERPNDB-CSR-KEY)
 20066*    END-EXEC.
 20067     MOVE 0
 20068       TO DFHEIV11
 20069*    MOVE '&0S                   )   #00016980' TO DFHEIV0
 20070     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20071     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 372
* EL6311.cbl
 20072     MOVE X'2020233030303136393830' TO DFHEIV0(25:11)
 20073     CALL 'kxdfhei1' USING DFHEIV0,
 20074           FILE-ID-ERPNDB4,
 20075           DFHEIV20,
 20076           DFHEIV99,
 20077           ERPNDB-CSR-KEY,
 20078           DFHEIV99,
 20079           DFHEIV11,
 20080           DFHEIV99,
 20081           DFHEIV99
 20082     SET ADDRESS OF PENDING-BUSINESS TO
 20083         DFHEIV20
 20084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20085
 20086
 20087     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20088
 20089     IF WS-BATCH-PREFIX = '#CL'
 20090         GO TO 4905-READ-PREV-RECORD.
 20091
 20092     IF FIRST-TIME
 20093         MOVE SPACE               TO WS-FIRST-TIME-SW
 20094         GO TO 4905-READ-PREV-RECORD.
 20095
 20096     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20097        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20098        GO TO 4950-END-RECORDS.
 20099
 20100     IF PB-BATCH-TRAILER
 20101        GO TO 4905-READ-PREV-RECORD.
 20102
 20103     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20104
 20105     IF  WS-BATCH-PREFIX = '#CL'
 20106         GO TO 4905-READ-PREV-RECORD.
 20107
 20108     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20109        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20110           GO TO 4905-READ-PREV-RECORD
 20111        ELSE
 20112           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20113              GO TO 4910-CHECK-REC-TYPE
 20114           ELSE
 20115              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20116                 GO TO 4910-CHECK-REC-TYPE
 20117              ELSE
 20118                 GO TO 4905-READ-PREV-RECORD.
 20119
 20120     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20121        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20122           GO TO 4905-READ-PREV-RECORD.
 20123
 20124 4910-CHECK-REC-TYPE.
 20125     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20126         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20127             NEXT SENTENCE
 20128         ELSE
 20129             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 373
* EL6311.cbl
 20130
 20131     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20132         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20133             NEXT SENTENCE
 20134        ELSE
 20135             GO TO 4905-READ-PREV-RECORD.
 20136
 20137     IF NOT DISPLAY-CHANGE-RECORDS AND
 20138            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20139        GO TO 4905-READ-PREV-RECORD.
 20140
 20141     IF DISPLAY-HOLD-RECORDS AND
 20142        NOT PB-RECORD-ON-HOLD
 20143          GO TO 4905-READ-PREV-RECORD.
 20144
 20145     IF PB-ISSUE
 20146        IF DISPLAY-CHK-REQ-RECORDS
 20147           GO TO 4905-READ-PREV-RECORD.
 20148
 20149     IF PB-ISSUE
 20150        IF ISSUE-WITH-WARNING
 20151           IF PB-WARNING-ERRORS
 20152              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20153                  GO TO 4505-READ-PREV-RECORD
 20154              ELSE
 20155                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20156                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20157                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20158                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20159                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20160                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20161                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20162                 GO TO 7000-DISPLAY-ISSUES
 20163           ELSE
 20164              GO TO 4905-READ-PREV-RECORD.
 20165
 20166     IF PB-ISSUE
 20167        IF (ISSUES-IN-ERROR AND
 20168            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20169            ALL-ISSUES
 20170            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20171            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20172            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20173            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20174            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20175            MOVE PB-SV-STATE            TO PI-SV-STATE
 20176            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20177            GO TO 7000-DISPLAY-ISSUES
 20178        ELSE
 20179            GO TO 4905-READ-PREV-RECORD.
 20180
 20181     IF PB-CANCELLATION
 20182        IF DISPLAY-CHK-REQ-RECORDS
 20183           IF PB-C-REFUND-REQUESTED
 20184              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20185              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20186              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20187              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 374
* EL6311.cbl
 20188              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20189              MOVE PB-SV-STATE            TO PI-SV-STATE
 20190              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20191              GO TO 7100-DISPLAY-CANCELS
 20192           ELSE
 20193              GO TO 4905-READ-PREV-RECORD.
 20194
 20195     IF PB-CANCELLATION
 20196        IF CANCEL-WITH-WARNING
 20197           IF PB-WARNING-ERRORS
 20198              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20199                  GO TO 4505-READ-PREV-RECORD
 20200              ELSE
 20201                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20202                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20203                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20204                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20205                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20206                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20207                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20208                 GO TO 7100-DISPLAY-CANCELS
 20209           ELSE
 20210              GO TO 4905-READ-PREV-RECORD.
 20211
 20212     IF PB-CANCELLATION
 20213        IF (CANCEL-IN-ERROR  AND
 20214            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20215            ALL-CANCELS
 20216            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20217            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20218            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20219            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20220            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20221            MOVE PB-SV-STATE            TO PI-SV-STATE
 20222            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20223            GO TO 7100-DISPLAY-CANCELS.
 20224
 20225     GO TO 4905-READ-PREV-RECORD.
 20226
 20227 4950-END-RECORDS.
 20228     IF PI-MAP-NAME = EL631B
 20229        MOVE -1                  TO BMAINTL
 20230     ELSE
 20231        IF PI-MAP-NAME = EL631C
 20232           MOVE -1               TO CMAINTL
 20233        ELSE
 20234           MOVE -1               TO DPFENTRL.
 20235
 20236     MOVE ER-2255               TO EMI-ERROR.
 20237     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20238     GO TO 8200-SEND-DATAONLY.
 20239
 20240 4970-NOT-FOUND.
 20241
 20242******************************************************************
 20243*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20244******************************************************************
 20245
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 375
* EL6311.cbl
 20246
 20247* EXEC CICS RESETBR
 20248*         DATASET    (FILE-ID-ERPNDB4)
 20249*         RIDFLD     (ERPNDB-CSR-KEY)
 20250*    END-EXEC.
 20251     MOVE 0
 20252       TO DFHEIV11
 20253*    MOVE '&4         G          &   #00017145' TO DFHEIV0
 20254     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20255     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20256     MOVE X'2020233030303137313435' TO DFHEIV0(25:11)
 20257     CALL 'kxdfhei1' USING DFHEIV0,
 20258           FILE-ID-ERPNDB4,
 20259           ERPNDB-CSR-KEY,
 20260           DFHEIV99,
 20261           DFHEIV11,
 20262           DFHEIV99
 20263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20264
 20265
 20266
 20267* EXEC CICS READNEXT
 20268*         DATASET    (FILE-ID-ERPNDB4)
 20269*         SET        (ADDRESS OF PENDING-BUSINESS)
 20270*         RIDFLD     (ERPNDB-CSR-KEY)
 20271*    END-EXEC.
 20272     MOVE 0
 20273       TO DFHEIV11
 20274*    MOVE '&.S                   )   #00017150' TO DFHEIV0
 20275     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20276     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20277     MOVE X'2020233030303137313530' TO DFHEIV0(25:11)
 20278     CALL 'kxdfhei1' USING DFHEIV0,
 20279           FILE-ID-ERPNDB4,
 20280           DFHEIV20,
 20281           DFHEIV99,
 20282           ERPNDB-CSR-KEY,
 20283           DFHEIV99,
 20284           DFHEIV11,
 20285           DFHEIV99,
 20286           DFHEIV99
 20287     SET ADDRESS OF PENDING-BUSINESS TO
 20288         DFHEIV20
 20289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20290
 20291
 20292
 20293* EXEC CICS READPREV
 20294*         DATASET    (FILE-ID-ERPNDB4)
 20295*         SET        (ADDRESS OF PENDING-BUSINESS)
 20296*         RIDFLD     (ERPNDB-CSR-KEY)
 20297*    END-EXEC.
 20298     MOVE 0
 20299       TO DFHEIV11
 20300*    MOVE '&0S                   )   #00017156' TO DFHEIV0
 20301     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20302     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20303     MOVE X'2020233030303137313536' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 376
* EL6311.cbl
 20304     CALL 'kxdfhei1' USING DFHEIV0,
 20305           FILE-ID-ERPNDB4,
 20306           DFHEIV20,
 20307           DFHEIV99,
 20308           ERPNDB-CSR-KEY,
 20309           DFHEIV99,
 20310           DFHEIV11,
 20311           DFHEIV99,
 20312           DFHEIV99
 20313     SET ADDRESS OF PENDING-BUSINESS TO
 20314         DFHEIV20
 20315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20316
 20317
 20318 4980-READ-PREV-RECORD.
 20319
 20320* EXEC CICS READPREV
 20321*         DATASET    (FILE-ID-ERPNDB4)
 20322*         SET        (ADDRESS OF PENDING-BUSINESS)
 20323*         RIDFLD     (ERPNDB-CSR-KEY)
 20324*    END-EXEC.
 20325     MOVE 0
 20326       TO DFHEIV11
 20327*    MOVE '&0S                   )   #00017163' TO DFHEIV0
 20328     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20329     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20330     MOVE X'2020233030303137313633' TO DFHEIV0(25:11)
 20331     CALL 'kxdfhei1' USING DFHEIV0,
 20332           FILE-ID-ERPNDB4,
 20333           DFHEIV20,
 20334           DFHEIV99,
 20335           ERPNDB-CSR-KEY,
 20336           DFHEIV99,
 20337           DFHEIV11,
 20338           DFHEIV99,
 20339           DFHEIV99
 20340     SET ADDRESS OF PENDING-BUSINESS TO
 20341         DFHEIV20
 20342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20343
 20344
 20345     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20346
 20347     IF WS-BATCH-PREFIX = '#CL'
 20348        GO TO 4980-READ-PREV-RECORD.
 20349
 20350     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20351     GO TO 4905-READ-PREV-RECORD.
 20352
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 377
* EL6311.cbl
 20354
 20355
 20356******************************************************************
 20357*                                                                *
 20358*        B R O W S E   B A T C H   H E A D E R S                 *
 20359*                                                                *
 20360******************************************************************
 20361
 20362 5000-BROWSE-BATCH-HEADERS.
 20363
 20364     IF EIBTRNID NOT = TRANS-EXB1
 20365        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20366        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20367        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20368        GO TO 5010-READ-NEXT-RECORD.
 20369
 20370     IF EIBAID = DFHPF4
 20371        MOVE '0'                TO PI-EDIT-SW
 20372        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20373        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20374        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20375        GO TO 5010-READ-NEXT-RECORD.
 20376
 20377     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20378     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20379     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20380
 20381
 20382* EXEC CICS HANDLE CONDITION
 20383*         ENDFILE  (5050-NOT-FOUND)
 20384*    END-EXEC.
 20385*    MOVE '"$''                   ! R #00017205' TO DFHEIV0
 20386     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20388     MOVE X'5220233030303137323035' TO DFHEIV0(25:11)
 20389     CALL 'kxdfhei1' USING DFHEIV0
 20390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20391
 20392
 20393 5010-READ-NEXT-RECORD.
 20394
 20395* EXEC CICS HANDLE CONDITION
 20396*         NOTFND    (5050-NOT-FOUND)
 20397*    END-EXEC.
 20398*    MOVE '"$I                   ! S #00017210' TO DFHEIV0
 20399     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20401     MOVE X'5320233030303137323130' TO DFHEIV0(25:11)
 20402     CALL 'kxdfhei1' USING DFHEIV0
 20403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20404
 20405
 20406
 20407* EXEC CICS READ
 20408*         DATASET   (FILE-ID-ERPNDB)
 20409*         SET       (ADDRESS OF PENDING-BUSINESS)
 20410*         RIDFLD    (ERPNDB-KEY)
 20411*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 378
* EL6311.cbl
 20412*    END-EXEC.
 20413*    MOVE '&"S        G          (   #00017214' TO DFHEIV0
 20414     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20416     MOVE X'2020233030303137323134' TO DFHEIV0(25:11)
 20417     CALL 'kxdfhei1' USING DFHEIV0,
 20418           FILE-ID-ERPNDB,
 20419           DFHEIV20,
 20420           DFHEIV99,
 20421           ERPNDB-KEY,
 20422           DFHEIV99,
 20423           DFHEIV99,
 20424           DFHEIV99
 20425     SET ADDRESS OF PENDING-BUSINESS TO
 20426         DFHEIV20
 20427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20428
 20429
 20430     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20431         GO TO 5050-NOT-FOUND.
 20432
 20433     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20434
 20435     IF WS-BATCH-PREFIX = '#CL'
 20436         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20437         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20438         GO TO 5010-READ-NEXT-RECORD.
 20439
 20440     IF NOT PB-BATCH-TRAILER
 20441         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20442         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20443         GO TO 5010-READ-NEXT-RECORD.
 20444
 20445     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20446         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20447             NEXT SENTENCE
 20448         ELSE
 20449             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20450             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20451             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20452             GO TO 5010-READ-NEXT-RECORD.
 20453
 20454     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20455         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20456             NEXT SENTENCE
 20457        ELSE
 20458             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20459             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20460             GO TO 5010-READ-NEXT-RECORD.
 20461
 20462     IF EIBAID = DFHPF4
 20463        MOVE '0'                TO PI-EDIT-SW
 20464        GO TO 7200-DISPLAY-BATCHES.
 20465
 20466     IF PI-CSR-BROWSE
 20467        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20468           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20469           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 379
* EL6311.cbl
 20470           GO TO 5010-READ-NEXT-RECORD.
 20471
 20472     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20473       IF PI-PB-CARRIER    = SPACES AND
 20474          PI-PB-GROUPING   = SPACES AND
 20475          PI-PB-STATE      = SPACES AND
 20476          PI-PB-ACCOUNT    = SPACES
 20477            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20478            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20479            GO TO 7200-DISPLAY-BATCHES
 20480         ELSE
 20481           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20482              PI-PB-GROUPING   = PB-GROUPING AND
 20483              PI-PB-STATE      = PB-STATE    AND
 20484              PI-PB-ACCOUNT    = PB-ACCOUNT
 20485              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20486              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20487              GO TO 7200-DISPLAY-BATCHES.
 20488
 20489     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20490     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20491
 20492
 20493* EXEC CICS HANDLE CONDITION
 20494*         NOTFND    (5050-NOT-FOUND)
 20495*    END-EXEC.
 20496*    MOVE '"$I                   ! T #00017283' TO DFHEIV0
 20497     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20498     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20499     MOVE X'5420233030303137323833' TO DFHEIV0(25:11)
 20500     CALL 'kxdfhei1' USING DFHEIV0
 20501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20502
 20503
 20504
 20505* EXEC CICS READ
 20506*         DATASET   (FILE-ID-ERPNDB)
 20507*         SET       (ADDRESS OF PENDING-BUSINESS)
 20508*         RIDFLD    (ERPNDB-KEY)
 20509*         GTEQ
 20510*    END-EXEC.
 20511*    MOVE '&"S        G          (   #00017287' TO DFHEIV0
 20512     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20514     MOVE X'2020233030303137323837' TO DFHEIV0(25:11)
 20515     CALL 'kxdfhei1' USING DFHEIV0,
 20516           FILE-ID-ERPNDB,
 20517           DFHEIV20,
 20518           DFHEIV99,
 20519           ERPNDB-KEY,
 20520           DFHEIV99,
 20521           DFHEIV99,
 20522           DFHEIV99
 20523     SET ADDRESS OF PENDING-BUSINESS TO
 20524         DFHEIV20
 20525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20526
 20527
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 380
* EL6311.cbl
 20528     GO TO 5010-READ-NEXT-RECORD.
 20529
 20530 5050-NOT-FOUND.
 20531
 20532******************************************************************
 20533*                                                                *
 20534*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20535*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 20536*         PROGRAM.                                               *
 20537*                                                                *
 20538******************************************************************
 20539
 20540     IF EIBTRNID NOT = TRANS-EXB1
 20541        IF PENDING-BUS-RECS-FOUND
 20542            NEXT SENTENCE
 20543          ELSE
 20544            MOVE '9'            TO PI-BROWSE-SW
 20545            GO TO 9400-CLEAR.
 20546
 20547     MOVE ER-2256                TO EMI-ERROR.
 20548     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20549
 20550     IF PI-MAP-NAME = SPACES
 20551        MOVE EL631D              TO PI-MAP-NAME
 20552        MOVE -1                  TO DPFENTRL
 20553        GO TO 8100-SEND-INITIAL-MAP.
 20554
 20555     IF PI-MAP-NAME = EL631B
 20556        MOVE -1                  TO BMAINTL
 20557     ELSE
 20558        IF PI-MAP-NAME = EL631C
 20559           MOVE -1               TO CMAINTL
 20560        ELSE
 20561           MOVE -1               TO DPFENTRL
 20562           GO TO 8200-SEND-DATAONLY.
 20563
 20564     GO TO 8100-SEND-INITIAL-MAP.
 20565
 20566     .
 20567 5100-PROCESS-POL-RESC.
 20568     MOVE ZEROS                  TO CG-LF-BENCD
 20569                                    CG-AH-BENCD
 20570                                    CG-LF-CAN-AMT
 20571                                    CG-AH-CAN-AMT
 20572     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20573                                    CG-AH-CAN-DT
 20574     MOVE SPACES                 TO CG-BATCH-NO
 20575     MOVE '4'                    TO CG-OPTION-CODE
 20576     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 20577     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 20578     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 20579     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 20580     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 20581     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 20582     MOVE PI-SV-STATE            TO CG-CERT-STATE
 20583     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 20584     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 20585     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 381
* EL6311.cbl
 20586     MOVE PI-PREV-ALT-KEY (1:33)
 20587                                 TO CG-CERT-KEY
 20588     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 20589     MOVE ZEROS                  TO CG-LF-CAN-AMT
 20590                                    CG-AH-CAN-AMT
 20591     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20592                                    CG-AH-CAN-DT
 20593     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 20594     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 20595      display 'about to cancel ' cg-cert-key
 20596
 20597* EXEC CICS LINK
 20598*        PROGRAM  ('ELCANC')
 20599*        COMMAREA (CANCEL-GEN-PASS-AREA)
 20600*    END-EXEC
 20601     MOVE LENGTH OF
 20602      CANCEL-GEN-PASS-AREA
 20603       TO DFHEIV11
 20604     MOVE 'ELCANC' TO DFHEIV1
 20605*    MOVE '."C                   (   #00017362' TO DFHEIV0
 20606     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20607     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20608     MOVE X'2020233030303137333632' TO DFHEIV0(25:11)
 20609     CALL 'kxdfhei1' USING DFHEIV0,
 20610           DFHEIV1,
 20611           CANCEL-GEN-PASS-AREA,
 20612           DFHEIV11,
 20613           DFHEIV99,
 20614           DFHEIV99,
 20615           DFHEIV99,
 20616           DFHEIV99
 20617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20618     IF CG-SUCCESS
 20619        CONTINUE
 20620     ELSE
 20621        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 20622        MOVE '3'                 TO EMI-SWITCH1
 20623        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 20624        EVALUATE TRUE
 20625           WHEN CG-DATE-ERROR
 20626             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20627           WHEN CG-CERT-NOT-FOUND
 20628             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20629           WHEN CG-AMOUNT-ERROR
 20630             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20631           WHEN CG-OPTION-ERROR
 20632             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20633           WHEN CG-PREV-CAN
 20634             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20635           WHEN CG-INVALID-DATA
 20636             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20637           WHEN CG-NO-ACCT-MSTR
 20638             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20639           WHEN CG-SFX-A-EXIST
 20640             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20641           WHEN CG-MISC-ERROR
 20642             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20643           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 382
* EL6311.cbl
 20644             MOVE ' ERROR - ELCANC - RETURN '
 20645                                 TO EMI-ERROR-TEXT (1) (12:25)
 20646        END-EVALUATE
 20647        GO TO 8200-SEND-DATAONLY
 20648     END-IF
 20649     .
 20650 5100-EXIT.
 20651     EXIT.
 20652
 20653******************************************************************
 20654*                                                                *
 20655*        B R O W S E   B A T C H   B A C K W A R D S             *
 20656*                                                                *
 20657******************************************************************
 20658
 20659 5500-BROWSE-BATCH-BACKWARD.
 20660
 20661* EXEC CICS HANDLE CONDITION
 20662*         NOTFND   (5550-END-RECORDS)
 20663*         ENDFILE  (5550-END-RECORDS)
 20664*    END-EXEC.
 20665*    MOVE '"$I''                  ! U #00017408' TO DFHEIV0
 20666     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20668     MOVE X'5520233030303137343038' TO DFHEIV0(25:11)
 20669     CALL 'kxdfhei1' USING DFHEIV0
 20670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20671
 20672
 20673 5505-START-BROWSE.
 20674     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20675     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 20676     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20677
 20678
 20679* EXEC CICS STARTBR
 20680*         DATASET   (FILE-ID-ERPNDB)
 20681*         RIDFLD    (ERPNDB-ALT-KEY)
 20682*    END-EXEC.
 20683     MOVE 0
 20684       TO DFHEIV11
 20685*    MOVE '&,         G          &   #00017418' TO DFHEIV0
 20686     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20687     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20688     MOVE X'2020233030303137343138' TO DFHEIV0(25:11)
 20689     CALL 'kxdfhei1' USING DFHEIV0,
 20690           FILE-ID-ERPNDB,
 20691           ERPNDB-ALT-KEY,
 20692           DFHEIV99,
 20693           DFHEIV11,
 20694           DFHEIV99
 20695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20696
 20697
 20698     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20699
 20700
 20701* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 383
* EL6311.cbl
 20702*         DATASET    (FILE-ID-ERPNDB)
 20703*         SET        (ADDRESS OF PENDING-BUSINESS)
 20704*         RIDFLD     (ERPNDB-KEY)
 20705*    END-EXEC.
 20706     MOVE 0
 20707       TO DFHEIV11
 20708*    MOVE '&.S                   )   #00017425' TO DFHEIV0
 20709     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20710     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20711     MOVE X'2020233030303137343235' TO DFHEIV0(25:11)
 20712     CALL 'kxdfhei1' USING DFHEIV0,
 20713           FILE-ID-ERPNDB,
 20714           DFHEIV20,
 20715           DFHEIV99,
 20716           ERPNDB-KEY,
 20717           DFHEIV99,
 20718           DFHEIV11,
 20719           DFHEIV99,
 20720           DFHEIV99
 20721     SET ADDRESS OF PENDING-BUSINESS TO
 20722         DFHEIV20
 20723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20724
 20725
 20726
 20727* EXEC CICS READPREV
 20728*         DATASET    (FILE-ID-ERPNDB)
 20729*         SET        (ADDRESS OF PENDING-BUSINESS)
 20730*         RIDFLD     (ERPNDB-KEY)
 20731*    END-EXEC.
 20732     MOVE 0
 20733       TO DFHEIV11
 20734*    MOVE '&0S                   )   #00017431' TO DFHEIV0
 20735     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20736     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20737     MOVE X'2020233030303137343331' TO DFHEIV0(25:11)
 20738     CALL 'kxdfhei1' USING DFHEIV0,
 20739           FILE-ID-ERPNDB,
 20740           DFHEIV20,
 20741           DFHEIV99,
 20742           ERPNDB-KEY,
 20743           DFHEIV99,
 20744           DFHEIV11,
 20745           DFHEIV99,
 20746           DFHEIV99
 20747     SET ADDRESS OF PENDING-BUSINESS TO
 20748         DFHEIV20
 20749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20750
 20751
 20752
 20753* EXEC CICS READPREV
 20754*         DATASET    (FILE-ID-ERPNDB)
 20755*         SET        (ADDRESS OF PENDING-BUSINESS)
 20756*         RIDFLD     (ERPNDB-KEY)
 20757*    END-EXEC.
 20758     MOVE 0
 20759       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 384
* EL6311.cbl
 20760*    MOVE '&0S                   )   #00017437' TO DFHEIV0
 20761     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20762     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20763     MOVE X'2020233030303137343337' TO DFHEIV0(25:11)
 20764     CALL 'kxdfhei1' USING DFHEIV0,
 20765           FILE-ID-ERPNDB,
 20766           DFHEIV20,
 20767           DFHEIV99,
 20768           ERPNDB-KEY,
 20769           DFHEIV99,
 20770           DFHEIV11,
 20771           DFHEIV99,
 20772           DFHEIV99
 20773     SET ADDRESS OF PENDING-BUSINESS TO
 20774         DFHEIV20
 20775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20776
 20777
 20778     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20779        GO TO 5550-END-RECORDS.
 20780
 20781     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20782
 20783     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20784
 20785     IF  WS-BATCH-PREFIX = '#CL'
 20786             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20787
 20788* EXEC CICS ENDBR
 20789*                 DATASET  (FILE-ID-ERPNDB)
 20790*            END-EXEC
 20791     MOVE 0
 20792       TO DFHEIV11
 20793*    MOVE '&2                    $   #00017452' TO DFHEIV0
 20794     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20795     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20796     MOVE X'2020233030303137343532' TO DFHEIV0(25:11)
 20797     CALL 'kxdfhei1' USING DFHEIV0,
 20798           FILE-ID-ERPNDB,
 20799           DFHEIV11,
 20800           DFHEIV99
 20801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20802         GO TO 5505-START-BROWSE.
 20803
 20804     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20805         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20806             NEXT SENTENCE
 20807         ELSE
 20808             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20809
 20810* EXEC CICS ENDBR
 20811*                 DATASET  (FILE-ID-ERPNDB)
 20812*            END-EXEC
 20813     MOVE 0
 20814       TO DFHEIV11
 20815*    MOVE '&2                    $   #00017462' TO DFHEIV0
 20816     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20817     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 385
* EL6311.cbl
 20818     MOVE X'2020233030303137343632' TO DFHEIV0(25:11)
 20819     CALL 'kxdfhei1' USING DFHEIV0,
 20820           FILE-ID-ERPNDB,
 20821           DFHEIV11,
 20822           DFHEIV99
 20823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20824             GO TO 5505-START-BROWSE.
 20825
 20826
 20827     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20828         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20829             NEXT SENTENCE
 20830        ELSE
 20831             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20832
 20833* EXEC CICS ENDBR
 20834*                 DATASET  (FILE-ID-ERPNDB)
 20835*            END-EXEC
 20836     MOVE 0
 20837       TO DFHEIV11
 20838*    MOVE '&2                    $   #00017473' TO DFHEIV0
 20839     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20840     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20841     MOVE X'2020233030303137343733' TO DFHEIV0(25:11)
 20842     CALL 'kxdfhei1' USING DFHEIV0,
 20843           FILE-ID-ERPNDB,
 20844           DFHEIV11,
 20845           DFHEIV99
 20846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20847             GO TO 5505-START-BROWSE.
 20848
 20849     IF NOT PB-BATCH-TRAILER
 20850        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20851
 20852* EXEC CICS ENDBR
 20853*            DATASET  (FILE-ID-ERPNDB)
 20854*       END-EXEC
 20855     MOVE 0
 20856       TO DFHEIV11
 20857*    MOVE '&2                    $   #00017480' TO DFHEIV0
 20858     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20859     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20860     MOVE X'2020233030303137343830' TO DFHEIV0(25:11)
 20861     CALL 'kxdfhei1' USING DFHEIV0,
 20862           FILE-ID-ERPNDB,
 20863           DFHEIV11,
 20864           DFHEIV99
 20865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20866        GO TO 5505-START-BROWSE.
 20867
 20868     IF PI-CSR-BROWSE
 20869        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20870           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 20871
 20872* EXEC CICS ENDBR
 20873*               DATASET  (FILE-ID-ERPNDB)
 20874*          END-EXEC
 20875     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 386
* EL6311.cbl
 20876       TO DFHEIV11
 20877*    MOVE '&2                    $   #00017488' TO DFHEIV0
 20878     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20879     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20880     MOVE X'2020233030303137343838' TO DFHEIV0(25:11)
 20881     CALL 'kxdfhei1' USING DFHEIV0,
 20882           FILE-ID-ERPNDB,
 20883           DFHEIV11,
 20884           DFHEIV99
 20885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20886           GO TO 5505-START-BROWSE.
 20887
 20888     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20889        IF PI-PB-CARRIER    = SPACES AND
 20890           PI-PB-GROUPING   = SPACES AND
 20891           PI-PB-STATE      = SPACES AND
 20892           PI-PB-ACCOUNT    = SPACES
 20893             GO TO 7200-DISPLAY-BATCHES
 20894          ELSE
 20895            IF PI-PB-CARRIER    = PB-CARRIER  AND
 20896               PI-PB-GROUPING   = PB-GROUPING AND
 20897               PI-PB-STATE      = PB-STATE    AND
 20898               PI-PB-ACCOUNT    = PB-ACCOUNT
 20899                 GO TO 7200-DISPLAY-BATCHES.
 20900
 20901     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 20902
 20903
 20904* EXEC CICS ENDBR
 20905*         DATASET  (FILE-ID-ERPNDB)
 20906*    END-EXEC.
 20907     MOVE 0
 20908       TO DFHEIV11
 20909*    MOVE '&2                    $   #00017508' TO DFHEIV0
 20910     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20911     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20912     MOVE X'2020233030303137353038' TO DFHEIV0(25:11)
 20913     CALL 'kxdfhei1' USING DFHEIV0,
 20914           FILE-ID-ERPNDB,
 20915           DFHEIV11,
 20916           DFHEIV99
 20917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20918
 20919
 20920     GO TO 5505-START-BROWSE.
 20921
 20922 5550-END-RECORDS.
 20923     MOVE ER-2257                TO EMI-ERROR.
 20924     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20925     MOVE -1                     TO DPFENTRL.
 20926
 20927     GO TO 8200-SEND-DATAONLY.
 20928
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 387
* EL6311.cbl
 20930
 20931******************************************************************
 20932*                                                                *
 20933*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 20934*                                                                *
 20935******************************************************************
 20936
 20937 6000-CREATE-TEMP-STORAGE.
 20938
 20939
 20940* EXEC CICS HANDLE CONDITION
 20941*        QIDERR  (6050-QID-ERROR)
 20942*    END-EXEC.
 20943*    MOVE '"$N                   ! V #00017531' TO DFHEIV0
 20944     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20945     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20946     MOVE X'5620233030303137353331' TO DFHEIV0(25:11)
 20947     CALL 'kxdfhei1' USING DFHEIV0
 20948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20949
 20950
 20951
 20952* EXEC CICS WRITEQ TS
 20953*        QUEUE    (QID)
 20954*        FROM     (PROGRAM-INTERFACE-BLOCK)
 20955*        LENGTH   (WS-COMM-LENGTH)
 20956*        ITEM     (W-ONE)
 20957*    END-EXEC.
 20958*    MOVE '*" I                  ''   #00017535' TO DFHEIV0
 20959     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 20960     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20961     MOVE X'2020233030303137353335' TO DFHEIV0(25:11)
 20962     CALL 'kxdfhei1' USING DFHEIV0,
 20963           QID,
 20964           PROGRAM-INTERFACE-BLOCK,
 20965           WS-COMM-LENGTH,
 20966           W-ONE,
 20967           DFHEIV99,
 20968           DFHEIV99
 20969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20970
 20971
 20972 6000-EXIT.
 20973      EXIT.
 20974
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 388
* EL6311.cbl
 20976
 20977******************************************************************
 20978*                                                                *
 20979*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 20980*                                                                *
 20981******************************************************************
 20982
 20983 6050-RECOVER-TEMP-STORAGE.
 20984     IF PGM-NAME = XCTL-EL6312
 20985        GO TO 6050-EXIT.
 20986
 20987     IF PGM-NAME = XCTL-EL6313
 20988        GO TO 6050-EXIT.
 20989
 20990     IF PGM-NAME = XCTL-EL6315
 20991         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 20992     END-IF
 20993
 20994     IF PGM-NAME = XCTL-EL6316
 20995         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 20996     END-IF
 20997
 20998
 20999* EXEC CICS HANDLE CONDITION
 21000*        QIDERR  (6050-QID-ERROR)
 21001*    END-EXEC.
 21002*    MOVE '"$N                   ! W #00017568' TO DFHEIV0
 21003     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21005     MOVE X'5720233030303137353638' TO DFHEIV0(25:11)
 21006     CALL 'kxdfhei1' USING DFHEIV0
 21007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21008
 21009
 21010
 21011* EXEC CICS READQ TS
 21012*         QUEUE   (QID)
 21013*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21014*         LENGTH  (WS-COMM-LENGTH)
 21015*         ITEM    (W-ONE)
 21016*     END-EXEC.
 21017*    MOVE '*$II   L              ''   #00017572' TO DFHEIV0
 21018     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21019     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21020     MOVE X'2020233030303137353732' TO DFHEIV0(25:11)
 21021     CALL 'kxdfhei1' USING DFHEIV0,
 21022           QID,
 21023           PROGRAM-INTERFACE-BLOCK,
 21024           WS-COMM-LENGTH,
 21025           W-ONE,
 21026           DFHEIV99,
 21027           DFHEIV99
 21028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21029
 21030
 21031 6050-DELETE-TEMP-STORAGE.
 21032
 21033
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 389
* EL6311.cbl
 21034* EXEC CICS DELETEQ TS
 21035*        QUEUE   (QID)
 21036*    END-EXEC.
 21037*    MOVE '*&                    #   #00017581' TO DFHEIV0
 21038     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21039     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21040     MOVE X'2020233030303137353831' TO DFHEIV0(25:11)
 21041     CALL 'kxdfhei1' USING DFHEIV0,
 21042           QID,
 21043           DFHEIV99
 21044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21045
 21046
 21047     GO TO 6050-EXIT.
 21048
 21049 6050-QID-ERROR.
 21050     MOVE ER-0033                TO EMI-ERROR
 21051     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21052
 21053 6050-EXIT.
 21054      EXIT.
 21055
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 390
* EL6311.cbl
 21057
 21058******************************************************************
 21059*                                                                *
 21060*            T E R M   C O N V E R S I O N                       *
 21061*                                                                *
 21062******************************************************************
 21063
 21064 6100-TERM-CONVERSION.
 21065
 21066     IF PI-BPMTS = ZERO
 21067         GO TO 6199-EXIT.
 21068
 21069     IF PI-BMODE = ' ' OR 'M'
 21070         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21071         GO TO 6105-ROUND-TERM.
 21072
 21073     IF PI-BMODE = 'S'
 21074         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21075         GO TO 6105-ROUND-TERM.
 21076
 21077     IF PI-BMODE = 'W'
 21078         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21079         GO TO 6105-ROUND-TERM.
 21080
 21081     IF PI-BMODE = 'B'
 21082         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21083         GO TO 6105-ROUND-TERM.
 21084
 21085     IF PI-BMODE = 'T'
 21086         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21087
 21088 6105-ROUND-TERM.
 21089
 21090     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21091         ADD +1                  TO WS-CALC-TERM-WHOLE
 21092         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21093
 21094     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21095         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21096
 21097     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21098         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21099                                      WS-BTERM    (WS-SUB1)
 21100         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21101
 21102     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21103         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21104             MOVE -1               TO BMODEL
 21105             MOVE ER-2593          TO EMI-ERROR
 21106             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21107             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21108
 21109 6124-CHECK-BENEFIT.
 21110
 21111     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21112        GO TO 6126-COMPUTE-BENEFIT.
 21113
 21114     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 391
* EL6311.cbl
 21115
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 392
* EL6311.cbl
 21117******************************************************************
 21118**         COMPUTE TERM AND BENEFIT
 21119******************************************************************
 21120 6125-COMPUTE-TERM-BENEFIT.
 21121
 21122     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21123        PI-BPMTAMT = ZERO
 21124         GO TO 6199-EXIT.
 21125
 21126     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21127                                     WS-BTERM  (WS-SUB1).
 21128     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21129
 21130 6126-COMPUTE-BENEFIT.
 21131
 21132     IF PI-BMODE = 'M' OR  ' '
 21133         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21134
 21135     IF PI-BMODE = 'W'
 21136         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21137
 21138     IF PI-BMODE = 'S'
 21139         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21140
 21141     IF PI-BMODE = 'B'
 21142         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21143
 21144     IF PI-BMODE = 'T'
 21145         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21146
 21147     IF WS-SUB1 = +1
 21148        COMPUTE WS-BBEN (WS-SUB1) =
 21149                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21150
 21151     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21152     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21153     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21154
 21155 6199-EXIT.
 21156     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 393
* EL6311.cbl
 21158
 21159******************************************************************
 21160*                                                                *
 21161*             D I S P L A Y   I S S U E S                        *
 21162*                                                                *
 21163******************************************************************
 21164
 21165 6200-CREATE-VADS.
 21166     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21167     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21168     MOVE SPACES                 TO WS-PASS-VADS-REC
 21169
 21170* EXEC CICS GETMAIN
 21171*       SET      (ADDRESS OF PENDING-BUSINESS)
 21172*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21173*       INITIMG  (GETMAIN-SPACE)
 21174*       RESP     (WS-RESPONSE)
 21175*    END-EXEC
 21176*    MOVE ',"IL                  $  N#00017707' TO DFHEIV0
 21177     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21178     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21179     MOVE X'204E233030303137373037' TO DFHEIV0(25:11)
 21180     CALL 'kxdfhei1' USING DFHEIV0,
 21181           DFHEIV20,
 21182           ERPNDB-RECORD-LENGTH,
 21183           GETMAIN-SPACE
 21184     SET ADDRESS OF PENDING-BUSINESS TO
 21185         DFHEIV20
 21186     MOVE EIBRESP  TO WS-RESPONSE
 21187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21188
 21189* EXEC CICS READ
 21190*       INTO    (PENDING-BUSINESS)
 21191*       DATASET (FILE-ID-ERPNDB)
 21192*       RIDFLD  (ERPNDB-KEY)
 21193*       RESP    (WS-RESPONSE)
 21194*    END-EXEC
 21195     MOVE LENGTH OF
 21196      PENDING-BUSINESS
 21197       TO DFHEIV11
 21198*    MOVE '&"IL       E          (  N#00017713' TO DFHEIV0
 21199     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21200     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21201     MOVE X'204E233030303137373133' TO DFHEIV0(25:11)
 21202     CALL 'kxdfhei1' USING DFHEIV0,
 21203           FILE-ID-ERPNDB,
 21204           PENDING-BUSINESS,
 21205           DFHEIV11,
 21206           ERPNDB-KEY,
 21207           DFHEIV99,
 21208           DFHEIV99,
 21209           DFHEIV99
 21210     MOVE EIBRESP  TO WS-RESPONSE
 21211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21212     IF RESP-NORMAL
 21213        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21214        IF (RESP-NORMAL)
 21215           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 394
* EL6311.cbl
 21216              AM-CONTROL-PRIMARY (1:20))
 21217           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21218        ELSE
 21219           MOVE 'ACCOUNT NOT FOUND'
 21220                                 TO VD-ACCOUNT-NAME
 21221        END-IF
 21222        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21223                                    TO M1
 21224        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21225        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21226           (A2 > M1)
 21227           OR (WS-WORK-FIELD (A2:1) = '*')
 21228           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21229           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21230        END-PERFORM
 21231        IF A2 > M1
 21232           CONTINUE
 21233        ELSE
 21234           MOVE WS-WORK-FIELD (1:A2 - 1)
 21235                                    TO VD-ACCOUNT-NAME
 21236        END-IF
 21237        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21238        MOVE PB-CARRIER          TO VD-CARRIER
 21239        MOVE PB-GROUPING         TO VD-GROUPING
 21240        MOVE PB-STATE            TO VD-STATE
 21241        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21242        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21243        MOVE PB-CERT-NO          TO VD-CERT-NO
 21244        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21245        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21246        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21247        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21248        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21249        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21250        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21251        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21252        MOVE PB-CSR-ID           TO VD-CSR-ID
 21253        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21254        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21255        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21256        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21257        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21258        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21259        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21260        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21261        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21262        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21263        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21264        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21265        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21266     END-IF
 21267     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21268
 21269
 21270* EXEC CICS GETMAIN
 21271*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21272*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21273*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 395
* EL6311.cbl
 21274*       RESP     (WS-RESPONSE)
 21275*    END-EXEC
 21276*    MOVE ',"IL                  $  N#00017776' TO DFHEIV0
 21277     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21278     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21279     MOVE X'204E233030303137373736' TO DFHEIV0(25:11)
 21280     CALL 'kxdfhei1' USING DFHEIV0,
 21281           DFHEIV20,
 21282           ERPNDM-RECORD-LENGTH,
 21283           GETMAIN-SPACE
 21284     SET ADDRESS OF PENDING-MAILING-DATA TO
 21285         DFHEIV20
 21286     MOVE EIBRESP  TO WS-RESPONSE
 21287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21288
 21289
 21290* EXEC CICS READ
 21291*       INTO    (PENDING-MAILING-DATA)
 21292*       DATASET (FILE-ID-ERPNDM)
 21293*       RIDFLD  (ERPNDM-KEY)
 21294*       RESP    (WS-RESPONSE)
 21295*    END-EXEC
 21296     MOVE LENGTH OF
 21297      PENDING-MAILING-DATA
 21298       TO DFHEIV11
 21299*    MOVE '&"IL       E          (  N#00017783' TO DFHEIV0
 21300     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21301     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21302     MOVE X'204E233030303137373833' TO DFHEIV0(25:11)
 21303     CALL 'kxdfhei1' USING DFHEIV0,
 21304           FILE-ID-ERPNDM,
 21305           PENDING-MAILING-DATA,
 21306           DFHEIV11,
 21307           ERPNDM-KEY,
 21308           DFHEIV99,
 21309           DFHEIV99,
 21310           DFHEIV99
 21311     MOVE EIBRESP  TO WS-RESPONSE
 21312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21313
 21314     IF RESP-NORMAL
 21315        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21316        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21317        MOVE PM-CITY              TO VD-INSURED-CITY
 21318        MOVE PM-STATE             TO VD-INSURED-STATE
 21319        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21320     END-IF
 21321
 21322     MOVE 'VAC1'                  TO VD-LETTER-ID
 21323     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21324     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21325     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21326     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21327     MOVE +0                      TO VD-ARCHIVE-NO
 21328     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21329     .
 21330 6200-EXIT.
 21331     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 396
* EL6311.cbl
 21332 6210-READ-ERACCT.
 21333     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21334     MOVE LOW-VALUES             TO ERACCT-FILL
 21335
 21336* EXEC CICS READ
 21337*         DATASET   ('ERACCT')
 21338*         INTO      (ACCOUNT-MASTER)
 21339*         RIDFLD    (ERACCT-KEY)
 21340*         GTEQ
 21341*         RESP      (WS-RESPONSE)
 21342*    END-EXEC
 21343     MOVE LENGTH OF
 21344      ACCOUNT-MASTER
 21345       TO DFHEIV11
 21346     MOVE 'ERACCT' TO DFHEIV1
 21347*    MOVE '&"IL       G          (  N#00017811' TO DFHEIV0
 21348     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21349     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21350     MOVE X'204E233030303137383131' TO DFHEIV0(25:11)
 21351     CALL 'kxdfhei1' USING DFHEIV0,
 21352           DFHEIV1,
 21353           ACCOUNT-MASTER,
 21354           DFHEIV11,
 21355           ERACCT-KEY,
 21356           DFHEIV99,
 21357           DFHEIV99,
 21358           DFHEIV99
 21359     MOVE EIBRESP  TO WS-RESPONSE
 21360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21361     .
 21362 6210-EXIT.
 21363     EXIT.
 21364
 21365 6220-READ-ERMAIL.
 21366
 21367     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21368     MOVE ' '                    TO WS-ERMAIL-SW
 21369
 21370
 21371* EXEC CICS READ
 21372*       DATASET   (FILE-ID-ERMAIL)
 21373*       SET       (ADDRESS OF MAILING-DATA)
 21374*       RIDFLD    (ERMAIL-KEY)
 21375*       RESP      (WS-RESPONSE)
 21376*    END-EXEC
 21377*    MOVE '&"S        E          (  N#00017827' TO DFHEIV0
 21378     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21379     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21380     MOVE X'204E233030303137383237' TO DFHEIV0(25:11)
 21381     CALL 'kxdfhei1' USING DFHEIV0,
 21382           FILE-ID-ERMAIL,
 21383           DFHEIV20,
 21384           DFHEIV99,
 21385           ERMAIL-KEY,
 21386           DFHEIV99,
 21387           DFHEIV99,
 21388           DFHEIV99
 21389     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 397
* EL6311.cbl
 21390         DFHEIV20
 21391     MOVE EIBRESP  TO WS-RESPONSE
 21392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21393
 21394     IF RESP-NORMAL
 21395        SET ERMAIL-FOUND TO TRUE
 21396     END-IF
 21397     .
 21398 6220-EXIT.
 21399     EXIT.
 21400
 21401 6400-CHECK-FOR-RES-REF-CLAIM.
 21402     display 'made it to 6400- for ' pi-cert-no
 21403     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21404
 21405     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21406                                    W-CL-COMP-CD.
 21407     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21408                                    W-CL-CERT-NO.
 21409     MOVE SPACES                 TO MSTR-CERT-SFX.
 21410
 21411
 21412* EXEC CICS HANDLE CONDITION
 21413*        NOTFND  (6400-CONTINUE)
 21414*        ENDFILE (6400-CONTINUE)
 21415*    END-EXEC.
 21416*    MOVE '"$I''                  ! X #00017851' TO DFHEIV0
 21417     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21419     MOVE X'5820233030303137383531' TO DFHEIV0(25:11)
 21420     CALL 'kxdfhei1' USING DFHEIV0
 21421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21422
 21423
 21424
 21425* EXEC CICS IGNORE CONDITION
 21426*        DUPKEY
 21427*    END-EXEC.
 21428*    MOVE '"*$                   !   #00017856' TO DFHEIV0
 21429     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21431     MOVE X'2020233030303137383536' TO DFHEIV0(25:11)
 21432     CALL 'kxdfhei1' USING DFHEIV0
 21433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21434
 21435
 21436
 21437* EXEC CICS STARTBR
 21438*        DATASET   (CLMS-ID)
 21439*        RIDFLD    (ELMSTR-KEY)
 21440*        GENERIC   EQUAL
 21441*        KEYLENGTH (ELMSTR-LENGTH)
 21442*    END-EXEC.
 21443     MOVE 0
 21444       TO DFHEIV11
 21445*    MOVE '&,   KG    E          &   #00017860' TO DFHEIV0
 21446     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21447     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 398
* EL6311.cbl
 21448     MOVE X'2020233030303137383630' TO DFHEIV0(25:11)
 21449     CALL 'kxdfhei1' USING DFHEIV0,
 21450           CLMS-ID,
 21451           ELMSTR-KEY,
 21452           ELMSTR-LENGTH,
 21453           DFHEIV11,
 21454           DFHEIV99
 21455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21456
 21457
 21458     display 'browse started'
 21459     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21460
 21461 6400-NEXT-CLAIM.
 21462
 21463
 21464* EXEC CICS READNEXT
 21465*        DATASET   (CLMS-ID)
 21466*        RIDFLD    (ELMSTR-KEY)
 21467*        SET       (ADDRESS OF CLAIM-MASTER)
 21468*    END-EXEC.
 21469     MOVE 0
 21470       TO DFHEIV11
 21471*    MOVE '&.S                   )   #00017872' TO DFHEIV0
 21472     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21473     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21474     MOVE X'2020233030303137383732' TO DFHEIV0(25:11)
 21475     CALL 'kxdfhei1' USING DFHEIV0,
 21476           CLMS-ID,
 21477           DFHEIV20,
 21478           DFHEIV99,
 21479           ELMSTR-KEY,
 21480           DFHEIV99,
 21481           DFHEIV11,
 21482           DFHEIV99,
 21483           DFHEIV99
 21484     SET ADDRESS OF CLAIM-MASTER TO
 21485         DFHEIV20
 21486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21487
 21488
 21489     display 'read claim for ' mstr-cert-no
 21490     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21491        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21492         GO TO 6400-CONTINUE
 21493     END-IF.
 21494
 21495     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21496        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21497        PI-STATE       NOT = CL-CERT-STATE     OR
 21498        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21499        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21500         GO TO 6400-NEXT-CLAIM
 21501     END-IF.
 21502
 21503     display 'found claim ' cl-claim-no
 21504        ' with denial type ' cl-denial-type
 21505     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 399
* EL6311.cbl
 21506         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21507         GO TO 6400-CONTINUE
 21508     END-IF.
 21509
 21510     GO TO 6400-NEXT-CLAIM.
 21511
 21512 6400-CONTINUE.
 21513
 21514     IF WS-BROWSE-STARTED-SW = 'Y'
 21515
 21516* EXEC CICS ENDBR
 21517*            DATASET   (CLMS-ID)
 21518*        END-EXEC
 21519     MOVE 0
 21520       TO DFHEIV11
 21521*    MOVE '&2                    $   #00017904' TO DFHEIV0
 21522     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21523     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21524     MOVE X'2020233030303137393034' TO DFHEIV0(25:11)
 21525     CALL 'kxdfhei1' USING DFHEIV0,
 21526           CLMS-ID,
 21527           DFHEIV11,
 21528           DFHEIV99
 21529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21530         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21531     END-IF.
 21532
 21533 6400-EXIT.
 21534     EXIT.
 21535
 21536 7000-DISPLAY-ISSUES.
 21537
 21538     IF PI-DISPLAY-ORIGINAL-BATCH
 21539        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21540        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21541     ELSE
 21542        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21543
 21544     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21545
 21546     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21547     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21548
 21549     MOVE LOW-VALUES                 TO EL631BI.
 21550     MOVE ZEROS                      TO PI-BPMTAMT
 21551                                        PI-BPMTS.
 21552     MOVE SPACE                      TO PI-BMODE
 21553                                        PI-BTYPE (1)
 21554                                        PI-BTYPE (2).
 21555     MOVE EL631B                     TO PI-MAP-NAME.
 21556     MOVE 'Y'                        TO PI-BROWSE-SW.
 21557     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 21558                                        PI-HIGH-SEQ-NO.
 21559
 21560     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21561        MOVE AL-SABOF                TO BCHGTA
 21562        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 21563        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 400
* EL6311.cbl
 21564     ELSE
 21565        MOVE AL-SADOF                TO BCHGTA
 21566                                        BCHGA
 21567        MOVE PB-CHG-COUNT            TO BCHGO.
 21568
 21569     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 21570     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21571     MOVE WS-HR-MINS                 TO BMANTATO.
 21572
 21573     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21574        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21575        MOVE SPACE                   TO DC-OPTION-CODE
 21576        PERFORM 9700-DATE-LINK
 21577        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21578        MOVE 'INACTIVE'              TO BMOENDTO
 21579     ELSE
 21580        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21581        MOVE SPACE                   TO DC-OPTION-CODE
 21582        PERFORM 9700-DATE-LINK
 21583        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21584        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21585        MOVE SPACE                   TO DC-OPTION-CODE
 21586        PERFORM 9700-DATE-LINK
 21587        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 21588
 21589*    MOVE PB-I-REFERENCE             TO BREFO.
 21590
 21591*    IF PI-COMPANY-ID EQUAL 'HER'
 21592*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 21593*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 21594*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 21595*                MOVE WS-MEMBER-NO-1-8
 21596*                                TO  BMICRNOO.
 21597
 21598*    IF PB-I-MICROFILM-NO  IS NUMERIC
 21599*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 21600*            MOVE PB-I-MICROFILM-NO
 21601*                                TO  BMICRNOO.
 21602     IF PB-I-VIN NOT = SPACES
 21603        MOVE PB-I-VIN            TO BVINO
 21604     END-IF
 21605
 21606     MOVE PB-CERT-PRIME              TO BCERTNOO.
 21607     MOVE PB-CERT-SFX                TO BSUFIXO.
 21608     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21609     MOVE SPACE                      TO DC-OPTION-CODE.
 21610     PERFORM 9700-DATE-LINK.
 21611     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 21612
 21613     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 21614     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 21615     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 21616     MOVE PB-I-INSURED-SEX           TO BSEXO
 21617
 21618     IF PB-I-AGE NOT = ZEROS
 21619         MOVE PB-I-AGE               TO BAGEO.
 21620
 21621     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 401
* EL6311.cbl
 21622                                 TO ELCERT-KEY
 21623     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 21624     IF NOT CERT-TRL-REC-NOT-FOUND
 21625         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 21626             MOVE 'AGE*'             TO BAGEDEFO
 21627         ELSE
 21628             MOVE 'AGE '             TO BAGEDEFO
 21629         END-IF
 21630     ELSE
 21631         MOVE 'AGE '             TO BAGEDEFO
 21632     END-IF
 21633
 21634     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 21635         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 21636         MOVE SPACE                  TO DC-OPTION-CODE
 21637         PERFORM 9700-DATE-LINK
 21638         IF NO-CONVERSION-ERROR
 21639            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 21640
 21641     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 21642         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 21643         MOVE SPACE                  TO DC-OPTION-CODE
 21644         PERFORM 9700-DATE-LINK
 21645         IF NO-CONVERSION-ERROR
 21646            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 21647
 21648     IF PB-I-EXTENTION-DAYS NUMERIC
 21649        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 21650           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 21651        ELSE
 21652           IF PB-I-TERM-IN-DAYS NUMERIC
 21653              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 21654                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 21655
 21656     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 21657        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 21658
 21659     MOVE PB-FORCE-CODE              TO BFORCEO.
 21660     MOVE PB-I-TERM-TYPE             TO BMODEO
 21661                                        PI-BMODE.
 21662
 21663     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 21664        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 21665
 21666     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 21667         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 21668                                        PI-BPMTS.
 21669
 21670     IF PB-I-PAYMENT-AMOUNT NUMERIC
 21671         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 21672           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 21673                                        PI-BPMTAMT.
 21674
 21675     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 21676     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 21677     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 21678     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 21679     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 402
* EL6311.cbl
 21680     MOVE PB-I-SIG-SW                TO BSIGO.
 21681     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 21682     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 21683     MOVE PB-RECORD-BILL             TO BBILCDO.
 21684     MOVE PB-FORCE-CODE              TO BFORCEO.
 21685
 21686     IF (PB-I-LIVES NUMERIC)
 21687        AND (PB-I-LIVES > ZEROS)
 21688        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21689        IF (RESP-NORMAL)
 21690           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 21691           CONTINUE
 21692        ELSE
 21693           MOVE PB-I-LIVES       TO BLIVESO
 21694        END-IF
 21695     END-IF
 21696
 21697     IF PB-I-NUM-BILLED NUMERIC AND
 21698        PB-I-NUM-BILLED GREATER THAN ZEROS
 21699        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 21700*    ELSE
 21701*       MOVE ZEROS                   TO BBILLEDO.
 21702
 21703     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 21704
 21705     IF PB-I-LOAN-APR NOT = +99.9999
 21706        MOVE PB-I-LOAN-APR           TO BAPRO.
 21707
 21708     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 21709        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 21710
 21711     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 21712        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 21713           MOVE AL-SANOF                TO BORIGHDA
 21714           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 21715           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 21716
 21717     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 21718
 21719     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 21720        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 21721
 21722     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 21723        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 21724                                        PI-BTYPE (1).
 21725
 21726     IF PB-I-LF-TERM     GREATER THAN ZEROS
 21727        MOVE PB-I-LF-TERM            TO BTERMO (1).
 21728
 21729     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 21730        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 21731
 21732     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 21733        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 21734
 21735     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 21736        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 21737
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 403
* EL6311.cbl
 21738     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21739        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 21740
 21741     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 21742         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 21743         MOVE SPACE                  TO DC-OPTION-CODE
 21744         PERFORM 9700-DATE-LINK
 21745         IF NO-CONVERSION-ERROR
 21746            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 21747
 21748     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21749        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 21750        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 21751        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 21752        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 21753                 GIVING BDIFFO (1)
 21754     ELSE
 21755        MOVE SPACES                  TO BBEN-CD     (1)
 21756                                        BBEN-ABBR   (1).
 21757
 21758     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21759        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 21760        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 21761                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 21762
 21763     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21764       IF PB-RECORD-ON-HOLD
 21765          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 21766
 21767     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21768       IF PB-RECORD-RETURNED
 21769          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 21770
 21771     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21772        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21773             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 21774
 21775     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 21776
 21777     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 21778        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 21779
 21780     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 21781        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 21782                                        PI-BTYPE (2).
 21783
 21784     IF PB-I-AH-TERM     GREATER THAN ZEROS
 21785        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 21786
 21787     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 21788        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 21789
 21790     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 21791        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 21792
 21793     IF PB-I-TOT-FEES NOT NUMERIC
 21794        MOVE ZEROS               TO PB-I-TOT-FEES
 21795     END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 404
* EL6311.cbl
 21796     IF PB-I-TOT-FEES > ZEROS
 21797        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 21798
 21799     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 21800         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 21801         MOVE SPACE                  TO DC-OPTION-CODE
 21802         PERFORM 9700-DATE-LINK
 21803         IF NO-CONVERSION-ERROR
 21804            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 21805
 21806     IF PB-I-TOT-FEES > ZEROS
 21807        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 21808        SUBTRACT PB-I-TOT-FEES FROM
 21809                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 21810
 21811     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21812        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 21813        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 21814        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 21815        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 21816                 GIVING BDIFFO (2)
 21817     ELSE
 21818        MOVE SPACES                  TO BBEN-CD     (2)
 21819                                        BBEN-ABBR   (2).
 21820
 21821     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21822       IF PB-RECORD-ON-HOLD
 21823          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 21824
 21825     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21826       IF PB-RECORD-RETURNED
 21827          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 21828
 21829     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21830        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21831             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 21832
 21833     MOVE PB-CSR-ID                  TO BCSRO.
 21834
 21835     IF PI-COMPANY-ID  =  'DMD'
 21836        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 21837            NEXT SENTENCE
 21838        ELSE
 21839            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 21840               MOVE 'NEW CERT'       TO BNCERTLI
 21841               MOVE EC-NEW-CERT      TO BNCERTO.
 21842
 21843     IF PI-COMPANY-ID  =  'DMD'
 21844        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 21845            NEXT SENTENCE
 21846        ELSE
 21847           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 21848               MOVE 'NEW STATE'      TO BNSTATLI
 21849               MOVE EC-NEW-STATE     TO BNSTATO.
 21850
 21851 7000-CONTINUE.
 21852     MOVE 'C'                        TO BMAINTI.
 21853     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 405
* EL6311.cbl
 21854
 21855     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 21856        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 21857
 21858     IF PI-6315-FINALIZED = 'Y'   AND
 21859        PB-UNFORCED-ERRORS
 21860          MOVE -1                TO BFORCEL
 21861          MOVE  1                TO SET-CURSOR-SW
 21862     END-IF
 21863
 21864     IF NO-CURSOR-SET
 21865        MOVE -1                      TO BMAINTL.
 21866
 21867     GO TO 8100-SEND-INITIAL-MAP.
 21868
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 406
* EL6311.cbl
 21870
 21871******************************************************************
 21872*                                                                *
 21873*             D I S P L A Y   C A N C E L S                      *
 21874*                                                                *
 21875******************************************************************
 21876
 21877 7100-DISPLAY-CANCELS.
 21878     IF PI-DISPLAY-ORIGINAL-BATCH
 21879        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21880        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21881     ELSE
 21882        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21883
 21884     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21885
 21886     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21887     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21888
 21889     MOVE LOW-VALUES                 TO EL631CI.
 21890     MOVE EL631C                     TO PI-MAP-NAME.
 21891     MOVE 'Y'                        TO PI-BROWSE-SW.
 21892     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 21893                                        PI-HIGH-SEQ-NO.
 21894
 21895     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21896        MOVE AL-SABOF                TO CCHGTA
 21897        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 21898        MOVE AL-SANON                TO CCHGA
 21899      ELSE
 21900        MOVE AL-SADOF                TO CCHGTA
 21901                                        CCHGA
 21902        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 21903
 21904*    MOVE PB-C-REFERENCE             TO CREFO.
 21905
 21906*    IF PB-C-MICROFILM-NO IS NUMERIC
 21907*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 21908*          MOVE PB-C-MICROFILM-NO
 21909*                                TO CMICRNOO
 21910*          MOVE AL-UNNON         TO CMICRNOA
 21911*       END-IF
 21912*    END-IF
 21913     IF PB-C-NH-INT-ON-REFS NUMERIC
 21914        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 21915           MOVE PB-C-NH-INT-ON-REFS
 21916                                 TO CNHINTO
 21917           MOVE AL-SANOF         TO CNHINTA
 21918        END-IF
 21919     END-IF
 21920     MOVE PB-CERT-PRIME              TO CCERTNOO.
 21921     MOVE PB-CERT-SFX                TO CSUFIXO.
 21922     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21923     MOVE SPACE                      TO DC-OPTION-CODE.
 21924     PERFORM 9700-DATE-LINK.
 21925     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 21926
 21927     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 407
* EL6311.cbl
 21928        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 21929        MOVE SPACE                   TO DC-OPTION-CODE
 21930        PERFORM 9700-DATE-LINK
 21931        IF NO-CONVERSION-ERROR
 21932           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 21933
 21934     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 21935        NEXT SENTENCE
 21936     ELSE
 21937        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 21938
 21939     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 21940        NEXT SENTENCE
 21941     ELSE
 21942        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 21943
 21944     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 21945        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 21946        MOVE SPACE                   TO DC-OPTION-CODE
 21947        PERFORM 9700-DATE-LINK
 21948        IF NO-CONVERSION-ERROR
 21949           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 21950
 21951     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21952         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 21953
 21954     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21955         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 21956
 21957     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 21958        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 21959        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 21960                 GIVING CDRFND1O.
 21961
 21962     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 21963        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 21964        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 21965                 GIVING CDRFND2O.
 21966
 21967     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21968       IF PB-RECORD-ON-HOLD
 21969          MOVE 'ON HOLD'             TO CBILIT1O.
 21970
 21971     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21972       IF PB-RECORD-RETURNED
 21973          MOVE 'RETURNED'            TO CBILIT1O.
 21974
 21975     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21976        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21977             MOVE 'OVERRIDE'         TO CBILIT1O.
 21978
 21979     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21980       IF PB-RECORD-ON-HOLD
 21981          MOVE 'ON HOLD'             TO CBILIT2O.
 21982
 21983     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21984       IF PB-RECORD-RETURNED
 21985          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 408
* EL6311.cbl
 21986
 21987     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21988        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21989             MOVE 'OVERRIDE'         TO CBILIT2O.
 21990
 21991     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 21992     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 21993     IF PB-C-POST-CARD-IND = 'Y'
 21994        MOVE 'Y'                     TO CPCYNO
 21995     ELSE
 21996        MOVE 'N'                     TO CPCYNO
 21997     END-IF
 21998     MOVE PB-FORCE-CODE              TO CFORCEO.
 21999     MOVE PB-RECORD-BILL             TO CBILCDO.
 22000     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22001     MOVE SPACES                     TO CINITSO.
 22002     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22003         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22004     ELSE
 22005         MOVE PB-CI-INITIALS         TO CINITSO
 22006     END-IF.
 22007
 22008     IF PB-CI-CANCEL-FEE NUMERIC
 22009        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22010        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22011     ELSE
 22012        MOVE ZEROES                  TO W-CANCEL-FEE.
 22013
 22014     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22015
 22016     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22017        ADD PB-CI-LF-PREMIUM-AMT
 22018             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22019
 22020     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22021        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22022
 22023     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22024     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22025     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22026     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22027
 22028     IF PB-C-LIVES NUMERIC
 22029        MOVE PB-C-LIVES              TO CLIVESO.
 22030
 22031     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22032        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22033
 22034     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22035        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22036        MOVE SPACE                   TO DC-OPTION-CODE
 22037        PERFORM 9700-DATE-LINK
 22038        IF NO-CONVERSION-ERROR
 22039           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22040
 22041     IF  PB-C-REFUND-CREATED
 22042         MOVE 'YES'                  TO CRFNDSWO
 22043     ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 409
* EL6311.cbl
 22044         IF PB-C-REFUND-REQUESTED
 22045            MOVE 'REQ'               TO CRFNDSWO
 22046         ELSE
 22047            MOVE 'NO'                TO CRFNDSWO.
 22048
 22049     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22050     MOVE SPACE                      TO DC-OPTION-CODE.
 22051     PERFORM 9700-DATE-LINK.
 22052     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22053     MOVE PB-INPUT-BY                TO CENTBYO.
 22054
 22055     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22056        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22057        MOVE SPACE                   TO DC-OPTION-CODE
 22058        PERFORM 9700-DATE-LINK
 22059        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22060        MOVE 'INACTIVE'              TO CMOENDTO
 22061     ELSE
 22062        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22063        MOVE SPACE                   TO DC-OPTION-CODE
 22064        PERFORM 9700-DATE-LINK
 22065        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22066        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22067        MOVE SPACE                   TO DC-OPTION-CODE
 22068        PERFORM 9700-DATE-LINK
 22069        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22070
 22071     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22072
 22073     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22074     MOVE WS-HR-MINS                 TO CMANTATO.
 22075
 22076     EVALUATE PB-LF-REFUND-TYPE
 22077        WHEN '1'
 22078           MOVE 'RULE78'            TO CLFREFNO
 22079        WHEN '2'
 22080           MOVE 'PRORAT'            TO CLFREFNO
 22081        WHEN '3'
 22082           MOVE 'CALIF'             TO CLFREFNO
 22083        WHEN '4'
 22084           MOVE 'IRREG'             TO CLFREFNO
 22085        WHEN '5'
 22086           MOVE 'NETPAY'            TO CLFREFNO
 22087        WHEN '6'
 22088           MOVE 'ATCP'              TO CLFREFNO
 22089        WHEN '7'
 22090           MOVE 'UTAH'              TO CLFREFNO
 22091        WHEN '8'
 22092           MOVE 'MEAN'              TO CLFREFNO
 22093        WHEN '9'
 22094           MOVE 'SUM '              TO CLFREFNO
 22095        WHEN 'B'
 22096           MOVE 'BALN'              TO CLFREFNO
 22097     END-EVALUATE.
 22098
 22099     EVALUATE TRUE
 22100        WHEN PB-AH-REFUND-TYPE =  '1'
 22101           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 410
* EL6311.cbl
 22102        WHEN PB-AH-REFUND-TYPE =  '2'
 22103           MOVE 'PRORAT'            TO CAHREFNO
 22104        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22105           MOVE 'CALIF'             TO CAHREFNO
 22106        WHEN PB-AH-REFUND-TYPE =  '4'
 22107           MOVE 'IRREG'             TO CAHREFNO
 22108        WHEN PB-AH-REFUND-TYPE =  '5'
 22109           MOVE 'NETPAY'            TO CAHREFNO
 22110        WHEN PB-AH-REFUND-TYPE =  '6'
 22111           MOVE 'ATCP'              TO CAHREFNO
 22112        WHEN PB-AH-REFUND-TYPE =  '7'
 22113           MOVE 'UTAH'              TO CAHREFNO
 22114        WHEN PB-AH-REFUND-TYPE =  '8'
 22115           MOVE 'MEAN'              TO CAHREFNO
 22116        WHEN PB-AH-REFUND-TYPE =  '9'
 22117           MOVE 'SUM '              TO CAHREFNO
 22118        WHEN PB-AH-REFUND-TYPE =  'B'
 22119           MOVE 'BALN'              TO CAHREFNO
 22120     END-EVALUATE.
 22121
 22122     MOVE PB-REIN-CD                 TO CREINCDO.
 22123
 22124     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22125        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22126        MOVE SPACE                   TO DC-OPTION-CODE
 22127        PERFORM 9700-DATE-LINK
 22128        IF NO-CONVERSION-ERROR
 22129           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22130
 22131     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22132        MOVE 999999                  TO WS-EXP-DT-EDIT
 22133        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22134        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22135     ELSE
 22136        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22137           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22138           MOVE SPACE                   TO DC-OPTION-CODE
 22139           PERFORM 9700-DATE-LINK
 22140           IF NO-CONVERSION-ERROR
 22141              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22142
 22143     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22144        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22145           MOVE AL-SANOF                TO CORIGHDA
 22146           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22147           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22148
 22149     MOVE PB-CSR-ID              TO CCSRO.
 22150
 22151     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22152     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22153
 22154     MOVE 'C'                    TO CMAINTI.
 22155     MOVE AL-UANON               TO CMAINTA.
 22156
 22157     IF PI-6316-FINALIZED = 'Y'  AND
 22158        PB-UNFORCED-ERRORS
 22159          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 411
* EL6311.cbl
 22160          MOVE  1                TO SET-CURSOR-SW
 22161     END-IF
 22162
 22163     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22164        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22165
 22166     IF NO-CURSOR-SET
 22167        MOVE -1                  TO CMAINTL.
 22168
 22169     GO TO 8100-SEND-INITIAL-MAP.
 22170
 22171
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 412
* EL6311.cbl
 22173***************************************************************
 22174*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22175*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22176***************************************************************
 22177
 22178 7200-DISPLAY-BATCHES.
 22179     MOVE EL631D                 TO PI-MAP-NAME.
 22180     MOVE LOW-VALUES             TO EL631DI.
 22181
 22182     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22183
 22184
 22185* EXEC CICS HANDLE CONDITION
 22186*         NOTFND   (3690-NOT-FOUND)
 22187*    END-EXEC.
 22188*    MOVE '"$I                   ! Y #00018561' TO DFHEIV0
 22189     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22191     MOVE X'5920233030303138353631' TO DFHEIV0(25:11)
 22192     CALL 'kxdfhei1' USING DFHEIV0
 22193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22194
 22195
 22196     IF PI-DISPLAY-SCREEN
 22197        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22198     ELSE
 22199        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22200
 22201     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22202     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22203
 22204
 22205* EXEC CICS READ
 22206*         DATASET   (FILE-ID-ERPNDB)
 22207*         RIDFLD    (ERPNDB-KEY)
 22208*         SET       (ADDRESS OF PENDING-BUSINESS)
 22209*    END-EXEC.
 22210*    MOVE '&"S        E          (   #00018573' TO DFHEIV0
 22211     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22212     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22213     MOVE X'2020233030303138353733' TO DFHEIV0(25:11)
 22214     CALL 'kxdfhei1' USING DFHEIV0,
 22215           FILE-ID-ERPNDB,
 22216           DFHEIV20,
 22217           DFHEIV99,
 22218           ERPNDB-KEY,
 22219           DFHEIV99,
 22220           DFHEIV99,
 22221           DFHEIV99
 22222     SET ADDRESS OF PENDING-BUSINESS TO
 22223         DFHEIV20
 22224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22225
 22226
 22227     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22228     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22229     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22230     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 413
* EL6311.cbl
 22231     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22232
 22233     MOVE EL631D                 TO PI-MAP-NAME.
 22234     MOVE LOW-VALUES             TO EL631DI.
 22235     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22236
 22237*    IF PI-AR-PROCESSING
 22238*       MOVE PB-REFERENCE        TO DREFO.
 22239
 22240     MOVE PB-CSR-ID              TO DCSRO.
 22241
 22242     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22243        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22244        MOVE SPACE               TO DC-OPTION-CODE
 22245        PERFORM 9700-DATE-LINK
 22246        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22247        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22248        MOVE 'INACTIVE'          TO DLDATEO
 22249     ELSE
 22250        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22251        MOVE SPACE               TO DC-OPTION-CODE
 22252        PERFORM 9700-DATE-LINK
 22253        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22254
 22255     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22256     MOVE SPACE                  TO DC-OPTION-CODE.
 22257     PERFORM 9700-DATE-LINK.
 22258     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22259
 22260     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22261        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22262     ELSE
 22263        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22264        MOVE SPACE               TO DC-OPTION-CODE
 22265        PERFORM 9700-DATE-LINK
 22266        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22267
 22268     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22269     MOVE SPACE                  TO DC-OPTION-CODE.
 22270     PERFORM 9700-DATE-LINK.
 22271     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22272
 22273     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22274     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22275
 22276     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22277        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22278                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22279
 22280     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22281     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22282     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22283
 22284     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22285        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22286                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22287
 22288     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 414
* EL6311.cbl
 22289     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22290     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22291
 22292     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22293        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22294                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22295
 22296     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22297     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22298
 22299     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22300        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22301                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22302
 22303     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22304     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22305     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22306
 22307     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22308        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22309                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22310
 22311     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22312     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22313     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22314
 22315     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22316        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22317                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22318
 22319     MOVE -1                     TO DPFENTRL.
 22320     GO TO 8100-SEND-INITIAL-MAP.
 22321
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 415
* EL6311.cbl
 22323
 22324***************************************************************
 22325*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22326*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22327*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22328*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22329*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22330*     ARE THEN SET ACCORDINGLY.                               *
 22331*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22332*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22333*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22334***************************************************************
 22335
 22336******************************************************************
 22337*                                                                *
 22338*            E R R O R   A N A L Y S I S                         *
 22339*                                                                *
 22340******************************************************************
 22341
 22342******************************************************************
 22343*                                                                *
 22344*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22345*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22346*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22347*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22348*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22349*                                                                *
 22350*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22351*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22352*                                                                *
 22353******************************************************************
 22354
 22355 7300-FORMAT-ERRORS.
 22356     MOVE ' '                    TO PI-ERRORS-SW
 22357     IF PB-COMMON-ERRORS = LOW-VALUES
 22358        IF PB-FATAL-ERRORS
 22359           MOVE ER-2695          TO EMI-ERROR
 22360           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22361           GO TO 7399-EXIT.
 22362
 22363     MOVE +0                     TO WS-SUB4.
 22364
 22365 7310-ERROR-LOOP.
 22366
 22367     ADD +1                      TO WS-SUB4.
 22368
 22369     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22370        GO TO 7350-SET-ERROR-FLAGS.
 22371
 22372     IF PI-COMPANY-ID = 'UCL'
 22373         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22374             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22375             MOVE ' '                   TO DC-OPTION-CODE
 22376             PERFORM 9700-DATE-LINK
 22377             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22378
 22379     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22380     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 416
* EL6311.cbl
 22381     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22382
 22383     GO TO 7310-ERROR-LOOP.
 22384
 22385
 22386 7350-SET-ERROR-FLAGS.
 22387
 22388     IF EMI-FATAL-CTR NOT = ZEROS
 22389        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22390        MOVE 'X'                 TO PB-FATAL-FLAG
 22391                                    PI-ERRORS-SW
 22392        GO TO 7355-SET-ERROR-FLAGS.
 22393
 22394     IF EMI-FORCABLE-CTR NOT = ZEROS
 22395        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22396        IF PB-ISSUE
 22397           IF PB-ISSUE-FORCE
 22398              MOVE 'F'           TO PB-FORCE-ER-CD
 22399              MOVE ER-2600       TO EMI-ERROR
 22400              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22401             ELSE
 22402              MOVE 'X'           TO PB-FORCE-ER-CD
 22403*                                   PI-ERRORS-SW
 22404          ELSE
 22405           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22406              MOVE 'F'           TO PB-FORCE-ER-CD
 22407              MOVE ER-2600       TO EMI-ERROR
 22408              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22409             ELSE
 22410              MOVE 'X'           TO PB-FORCE-ER-CD.
 22411*                                   PI-ERRORS-SW.
 22412
 22413     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22414     IF PB-ISSUE
 22415         MOVE 'I'                TO ENDT-RECORD-TYPE
 22416     ELSE
 22417         MOVE 'C'                TO ENDT-RECORD-TYPE
 22418     END-IF
 22419     MOVE +0                     TO ENDT-SEQ-NO
 22420
 22421
 22422* EXEC CICS READ
 22423*        DATASET   (FILE-ID-ERENDT)
 22424*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22425*        RIDFLD    (ERENDT-KEY)
 22426*        RESP      (WS-RESPONSE)
 22427*        GTEQ
 22428*    END-EXEC
 22429*    MOVE '&"S        G          (  N#00018773' TO DFHEIV0
 22430     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22432     MOVE X'204E233030303138373733' TO DFHEIV0(25:11)
 22433     CALL 'kxdfhei1' USING DFHEIV0,
 22434           FILE-ID-ERENDT,
 22435           DFHEIV20,
 22436           DFHEIV99,
 22437           ERENDT-KEY,
 22438           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 417
* EL6311.cbl
 22439           DFHEIV99,
 22440           DFHEIV99
 22441     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22442         DFHEIV20
 22443     MOVE EIBRESP  TO WS-RESPONSE
 22444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22445
 22446     IF RESP-NORMAL
 22447        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22448        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22449            MOVE ER-0280          TO EMI-ERROR
 22450            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22451            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22452            EVALUATE TRUE
 22453              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22454                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22455              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22456                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22457              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22458                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22459            END-EVALUATE
 22460        END-IF
 22461     END-IF
 22462
 22463
 22464
 22465     IF FIRST-ENTRY OR
 22466        EIBAID = DFHPF1 OR DFHPF2
 22467        MOVE '0'                TO PI-EDIT-SW
 22468        GO TO 7399-EXIT.
 22469
 22470 7355-SET-ERROR-FLAGS.
 22471
 22472     IF EMI-WARNING-CTR NOT = ZEROS
 22473        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22474        MOVE 'W'                 TO PB-WARN-ER-CD.
 22475
 22476     IF PB-UNFORCED-ERRORS OR
 22477        PB-FATAL-ERRORS    OR
 22478        PB-RECORD-ON-HOLD  OR
 22479        PB-RECORD-RETURNED OR
 22480        PB-CANCELLATION
 22481          NEXT SENTENCE
 22482        ELSE
 22483          GO TO 7399-EXIT.
 22484
 22485
 22486* EXEC CICS  HANDLE CONDITION
 22487*           NOTFND   (7399-EXIT)
 22488*    END-EXEC.
 22489*    MOVE '"$I                   ! Z #00018820' TO DFHEIV0
 22490     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22492     MOVE X'5A20233030303138383230' TO DFHEIV0(25:11)
 22493     CALL 'kxdfhei1' USING DFHEIV0
 22494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22495
 22496
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 418
* EL6311.cbl
 22497     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22498     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22499     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22500     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22501
 22502
 22503* EXEC CICS READ
 22504*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22505*        DATASET (FILE-ID-ELCERT)
 22506*        RIDFLD  (ELCERT-KEY)
 22507*        UPDATE
 22508*    END-EXEC.
 22509*    MOVE '&"S        EU         (   #00018829' TO DFHEIV0
 22510     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22511     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22512     MOVE X'2020233030303138383239' TO DFHEIV0(25:11)
 22513     CALL 'kxdfhei1' USING DFHEIV0,
 22514           FILE-ID-ELCERT,
 22515           DFHEIV20,
 22516           DFHEIV99,
 22517           ELCERT-KEY,
 22518           DFHEIV99,
 22519           DFHEIV99,
 22520           DFHEIV99
 22521     SET ADDRESS OF CERTIFICATE-MASTER TO
 22522         DFHEIV20
 22523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22524
 22525
 22526
 22527     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22528     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22529
 22530     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22531        GO TO 7360-REWRITE-CERT-MASTER.
 22532
 22533     IF PB-ISSUE
 22534        IF PB-RECORD-RETURNED
 22535            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22536            GO TO 7360-REWRITE-CERT-MASTER
 22537        ELSE
 22538            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22539            GO TO 7360-REWRITE-CERT-MASTER.
 22540
 22541     IF PB-RECORD-RETURNED
 22542         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22543         GO TO 7360-REWRITE-CERT-MASTER.
 22544
 22545     IF (PB-C-LF-CANCEL-VOIDED)
 22546        or (pb-c-ah-cancel-voided)
 22547        IF (PB-UNFORCED-ERRORS OR
 22548            PB-FATAL-ERRORS    OR
 22549            PB-RECORD-ON-HOLD)
 22550            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22551            GO TO 7360-REWRITE-CERT-MASTER
 22552        ELSE
 22553            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22554            GO TO 7360-REWRITE-CERT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 419
* EL6311.cbl
 22555
 22556     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22557                            OR PB-RECORD-ON-HOLD)
 22558        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22559     ELSE
 22560        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22561
 22562 7360-REWRITE-CERT-MASTER.
 22563
 22564     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22565        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22566
 22567* EXEC CICS UNLOCK
 22568*            DATASET    (FILE-ID-ELCERT)
 22569*       END-EXEC
 22570*    MOVE '&*                    #   #00018876' TO DFHEIV0
 22571     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22572     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22573     MOVE X'2020233030303138383736' TO DFHEIV0(25:11)
 22574     CALL 'kxdfhei1' USING DFHEIV0,
 22575           FILE-ID-ELCERT,
 22576           DFHEIV99
 22577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22578        GO TO 7399-EXIT.
 22579
 22580
 22581* EXEC CICS REWRITE
 22582*         DATASET    (FILE-ID-ELCERT)
 22583*         FROM       (CERTIFICATE-MASTER)
 22584*    END-EXEC.
 22585     MOVE LENGTH OF
 22586      CERTIFICATE-MASTER
 22587       TO DFHEIV11
 22588*    MOVE '&& L                  %   #00018881' TO DFHEIV0
 22589     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22590     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22591     MOVE X'2020233030303138383831' TO DFHEIV0(25:11)
 22592     CALL 'kxdfhei1' USING DFHEIV0,
 22593           FILE-ID-ELCERT,
 22594           CERTIFICATE-MASTER,
 22595           DFHEIV11,
 22596           DFHEIV99
 22597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22598
 22599
 22600 7399-EXIT.
 22601      EXIT.
 22602
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 420
* EL6311.cbl
 22604
 22605*************************************************************
 22606*                                                           *
 22607*              S E T   A T T R I B U T E S                  *
 22608*                                                           *
 22609*************************************************************
 22610
 22611 7400-SET-ATTRIBUTES.
 22612
 22613     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22614        GO TO 7499-EXIT.
 22615
 22616**2601**
 22617
 22618     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 22619        IF PB-ISSUE
 22620           MOVE AL-UABON         TO BEFFDTA
 22621           GO TO 7499-EXIT
 22622         ELSE
 22623           MOVE AL-UABON         TO CEFFDTA
 22624           GO TO 7499-EXIT.
 22625
 22626**2604**
 22627
 22628     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 22629        IF PB-ISSUE
 22630           MOVE AL-UABON         TO BTYPE1A
 22631           MOVE -1               TO BTYPE1L
 22632           MOVE  1               TO SET-CURSOR-SW
 22633           GO TO 7499-EXIT.
 22634
 22635**2605**
 22636
 22637     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 22638        IF PB-ISSUE
 22639           MOVE AL-UABON         TO BTYPE2A
 22640           MOVE -1               TO BTYPE2L
 22641           MOVE  1               TO SET-CURSOR-SW
 22642           GO TO 7499-EXIT.
 22643
 22644**2606**
 22645
 22646     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 22647        IF PB-ISSUE
 22648           MOVE AL-UABON         TO BSIGA
 22649           MOVE -1               TO BSIGL
 22650           MOVE  1               TO SET-CURSOR-SW
 22651           GO TO 7499-EXIT.
 22652
 22653**2607**
 22654
 22655     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22656        IF PB-ISSUE
 22657           MOVE AL-UABON         TO BSIGA
 22658           MOVE -1               TO BSIGL
 22659           MOVE  1               TO SET-CURSOR-SW
 22660           GO TO 7499-EXIT.
 22661
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 421
* EL6311.cbl
 22662**2615**
 22663
 22664     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22665        IF PB-ISSUE
 22666           MOVE AL-UABOF         TO BREINA
 22667           MOVE -1               TO BREINL
 22668           GO TO 7499-EXIT.
 22669
 22670**2622**
 22671
 22672     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 22673        IF PB-ISSUE
 22674           MOVE AL-UABON         TO BEFFDTA
 22675           GO TO 7499-EXIT
 22676        ELSE
 22677           MOVE AL-UABON         TO CEFFDTA
 22678           GO TO 7499-EXIT.
 22679
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 422
* EL6311.cbl
 22681
 22682*************************************************************
 22683*                                                           *
 22684*              I S S U E   E R R O R S                      *
 22685*                                                           *
 22686*************************************************************
 22687
 22688 7420-ISSUE-ERRORS.
 22689
 22690**2626**
 22691
 22692     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 22693        MOVE AL-UABON            TO BCERTNOA
 22694        GO TO 7499-EXIT.
 22695
 22696**2627**
 22697
 22698     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 22699        MOVE AL-UNBON            TO BAGEA
 22700        MOVE -1                  TO BAGEL
 22701        MOVE  1                  TO SET-CURSOR-SW
 22702        GO TO 7499-EXIT.
 22703
 22704**2628**
 22705
 22706     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 22707        MOVE AL-UNBON            TO BAGEA
 22708        MOVE -1                  TO BAGEL
 22709        MOVE  1                  TO SET-CURSOR-SW
 22710        GO TO 7499-EXIT.
 22711
 22712**2629**
 22713
 22714     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 22715        MOVE AL-UABON            TO BSEXA
 22716        MOVE -1                  TO BSEXL
 22717        MOVE  1                  TO SET-CURSOR-SW
 22718        GO TO 7499-EXIT.
 22719
 22720**2630**
 22721
 22722     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 22723        MOVE -1                  TO BTYPE1L
 22724        MOVE  1                  TO SET-CURSOR-SW
 22725        GO TO 7499-EXIT.
 22726
 22727**2631**
 22728
 22729     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 22730        MOVE -1                  TO BTYPE1L
 22731        MOVE  1                  TO SET-CURSOR-SW
 22732        GO TO 7499-EXIT.
 22733
 22734**2632**
 22735
 22736     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 22737        MOVE AL-UNBON            TO BBEN1A
 22738        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 423
* EL6311.cbl
 22739        MOVE  1                  TO SET-CURSOR-SW
 22740        GO TO 7499-EXIT.
 22741
 22742**2633**
 22743
 22744     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 22745        MOVE AL-UNBON            TO BPREM1A
 22746        MOVE -1                  TO BPREM1L
 22747        MOVE  1                  TO SET-CURSOR-SW
 22748        GO TO 7499-EXIT.
 22749
 22750**2634**
 22751
 22752     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 22753        MOVE -1                  TO BTYPE2L
 22754        MOVE  1                  TO SET-CURSOR-SW
 22755        GO TO 7499-EXIT.
 22756
 22757**2635**
 22758
 22759     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 22760        MOVE AL-UNBON            TO BBEN2A
 22761        MOVE -1                  TO BBEN2L
 22762        MOVE  1                  TO SET-CURSOR-SW
 22763        GO TO 7499-EXIT.
 22764
 22765**2636**
 22766
 22767     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 22768        MOVE AL-UNBON            TO BPREM2A
 22769        MOVE -1                  TO BPREM2L
 22770        MOVE  1                  TO SET-CURSOR-SW
 22771        GO TO 7499-EXIT.
 22772
 22773**2639**
 22774
 22775     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 22776        MOVE AL-UNBON            TO BBEN1A
 22777        MOVE -1                  TO BBEN1L
 22778        MOVE  1                  TO SET-CURSOR-SW
 22779        GO TO 7499-EXIT.
 22780
 22781**2640**
 22782
 22783     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 22784        MOVE AL-UNBON            TO BBEN2A
 22785        MOVE -1                  TO BBEN2L
 22786        MOVE  1                  TO SET-CURSOR-SW
 22787        GO TO 7499-EXIT.
 22788
 22789**2647**
 22790
 22791     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 22792        MOVE AL-UNBON            TO BTERM1A
 22793        MOVE -1                  TO BTERM1L
 22794        MOVE  1                  TO SET-CURSOR-SW
 22795        GO TO 7499-EXIT.
 22796
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 424
* EL6311.cbl
 22797**2648**
 22798
 22799     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 22800        MOVE AL-UNBON            TO BLNTRMA
 22801        MOVE -1                  TO BLNTRML
 22802        MOVE  1                  TO SET-CURSOR-SW
 22803        GO TO 7499-EXIT.
 22804
 22805**2649**
 22806
 22807     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22808        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22809            MOVE AL-UNBON            TO BPREM1A
 22810            MOVE -1                  TO BPREM1L
 22811            MOVE  1                  TO SET-CURSOR-SW
 22812            GO TO 7499-EXIT
 22813     ELSE
 22814        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22815           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22816            MOVE AL-UNBON            TO BPREM2A
 22817            MOVE -1                  TO BPREM2L
 22818            MOVE  1                  TO SET-CURSOR-SW
 22819            GO TO 7499-EXIT.
 22820
 22821**2650**
 22822
 22823     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22824        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22825            MOVE AL-UNBON        TO BPREM1A
 22826            MOVE -1              TO BPREM1L
 22827            MOVE  1              TO SET-CURSOR-SW
 22828            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22829                MOVE AL-UNBON        TO BPREM2A
 22830                MOVE -1              TO BPREM2L
 22831                MOVE  1              TO SET-CURSOR-SW
 22832                GO TO 7499-EXIT
 22833            ELSE
 22834                GO TO 7499-EXIT
 22835        ELSE
 22836            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22837                MOVE AL-UNBON        TO BPREM2A
 22838                MOVE -1              TO BPREM2L
 22839                MOVE  1              TO SET-CURSOR-SW
 22840                GO TO 7499-EXIT
 22841            ELSE
 22842                GO TO 7499-EXIT.
 22843
 22844**2651**
 22845
 22846     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22847        MOVE AL-UABON            TO BSIGA
 22848        MOVE -1                  TO BSIGL
 22849        MOVE  1                  TO SET-CURSOR-SW
 22850        GO TO 7499-EXIT.
 22851
 22852**2653**
 22853
 22854     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 425
* EL6311.cbl
 22855        MOVE AL-UABON            TO BFREQA
 22856        MOVE -1                  TO BFREQL
 22857        MOVE  1                  TO SET-CURSOR-SW
 22858        GO TO 7499-EXIT.
 22859
 22860**2654**
 22861
 22862     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 22863        MOVE AL-UABON            TO BFREQA
 22864        MOVE -1                  TO BFREQL
 22865        MOVE  1                  TO SET-CURSOR-SW
 22866        GO TO 7499-EXIT.
 22867
 22868**2655**
 22869
 22870     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 22871        MOVE AL-UABON            TO BFREQA
 22872        MOVE -1                  TO BFREQL
 22873        MOVE  1                  TO SET-CURSOR-SW
 22874        GO TO 7499-EXIT.
 22875
 22876**2656**
 22877
 22878     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 22879        MOVE AL-UNBON            TO BAPRA
 22880        MOVE -1                  TO BAPRL
 22881        MOVE  1                  TO SET-CURSOR-SW
 22882        GO TO 7499-EXIT.
 22883
 22884**2657**
 22885
 22886     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22887        MOVE AL-UNBON            TO BAPRA
 22888        MOVE -1                  TO BAPRL
 22889        MOVE  1                  TO SET-CURSOR-SW
 22890        GO TO 7499-EXIT.
 22891
 22892**2658**
 22893
 22894     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22895        MOVE AL-UNBON            TO BTERM2A
 22896        MOVE -1                  TO BTERM2L
 22897        MOVE  1                  TO SET-CURSOR-SW
 22898        GO TO 7499-EXIT.
 22899
 22900**2660**
 22901
 22902     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 22903        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 22904        MOVE -1                  TO BLSTNML
 22905        MOVE  1                  TO SET-CURSOR-SW
 22906        GO TO 7499-EXIT.
 22907
 22908
 22909**2662**
 22910
 22911     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 22912        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 426
* EL6311.cbl
 22913        MOVE -1                  TO BAGEL
 22914        MOVE  1                  TO SET-CURSOR-SW
 22915        GO TO 7499-EXIT.
 22916
 22917**2663**
 22918
 22919     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 22920        MOVE AL-UNBON            TO BAGEA
 22921        MOVE -1                  TO BAGEL
 22922        MOVE  1                  TO SET-CURSOR-SW
 22923        GO TO 7499-EXIT.
 22924
 22925**2664**
 22926
 22927     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 22928        MOVE AL-UABON            TO BREINA
 22929        MOVE -1                  TO BREINL
 22930        MOVE  1                  TO SET-CURSOR-SW
 22931        GO TO 7499-EXIT.
 22932
 22933**2667**
 22934
 22935     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 22936        MOVE AL-UNBON            TO BBEN2A
 22937        MOVE -1                  TO BBEN2L
 22938        MOVE  1                  TO SET-CURSOR-SW
 22939        GO TO 7499-EXIT.
 22940
 22941**2668**
 22942
 22943     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 22944        MOVE AL-UABON            TO BEFFDTA
 22945        GO TO 7499-EXIT.
 22946
 22947**2669**
 22948
 22949     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 22950       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 22951       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 22952        MOVE AL-UNBON            TO BAGEA
 22953        MOVE -1                  TO BAGEL
 22954        MOVE  1                  TO SET-CURSOR-SW
 22955        GO TO 7499-EXIT.
 22956
 22957**2670**
 22958
 22959     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 22960        MOVE AL-UABON            TO BFORCEA
 22961        MOVE -1                  TO BFORCEL
 22962        MOVE  1                  TO SET-CURSOR-SW
 22963        GO TO 7499-EXIT.
 22964
 22965**2671**
 22966
 22967     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 22968        MOVE AL-UABON            TO BEFFDTA
 22969        GO TO 7499-EXIT.
 22970
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 427
* EL6311.cbl
 22971**2672**
 22972
 22973     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 22974        MOVE AL-UABON            TO BEFFDTA
 22975        GO TO 7499-EXIT.
 22976
 22977**2673**
 22978
 22979     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22980        MOVE AL-UABON            TO BEFFDTA
 22981        GO TO 7499-EXIT.
 22982
 22983**2674**
 22984
 22985     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22986        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 22987        MOVE -1                  TO BTYPE1L
 22988        MOVE  1                  TO SET-CURSOR-SW
 22989        GO TO 7499-EXIT.
 22990
 22991**2677**
 22992
 22993     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 22994        MOVE AL-UNBON            TO BTERM1A
 22995        MOVE -1                  TO BTERM1L
 22996        MOVE  1                  TO SET-CURSOR-SW
 22997        GO TO 7499-EXIT.
 22998
 22999**2678**
 23000
 23001     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23002        MOVE AL-UNBON            TO BTERM2A
 23003        MOVE -1                  TO BTERM2L
 23004        MOVE  1                  TO SET-CURSOR-SW
 23005        GO TO 7499-EXIT.
 23006
 23007**2679**
 23008
 23009     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23010        MOVE AL-UABON            TO BTYPE1A
 23011        MOVE -1                  TO BTYPE1L
 23012        MOVE  1                  TO SET-CURSOR-SW
 23013        GO TO 7499-EXIT.
 23014
 23015**2680**
 23016
 23017     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23018        MOVE AL-UABOF            TO B1STPMTA
 23019        MOVE -1                  TO B1STPMTL
 23020        MOVE  1                  TO SET-CURSOR-SW
 23021        GO TO 7499-EXIT.
 23022
 23023**2681**
 23024
 23025     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23026        MOVE AL-UABON            TO BDAYSA
 23027        MOVE -1                  TO BDAYSL
 23028        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 428
* EL6311.cbl
 23029        GO TO 7499-EXIT.
 23030
 23031**2682**
 23032
 23033     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23034        MOVE AL-UABON            TO BTERM1A
 23035        MOVE -1                  TO BTERM1L
 23036        MOVE  1                  TO SET-CURSOR-SW
 23037        GO TO 7499-EXIT.
 23038
 23039**2683**
 23040
 23041     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23042        MOVE AL-UABON            TO BSKPCDA
 23043        MOVE -1                  TO BSKPCDL
 23044        MOVE  1                  TO SET-CURSOR-SW
 23045        GO TO 7499-EXIT.
 23046
 23047**2684**
 23048
 23049     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23050        MOVE AL-UABON            TO BTYPE2A
 23051        MOVE -1                  TO BTYPE2L
 23052        MOVE  1                  TO SET-CURSOR-SW
 23053        GO TO 7499-EXIT.
 23054
 23055**2686**
 23056
 23057     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23058        MOVE AL-UABON            TO BTYPE2A
 23059        MOVE -1                  TO BTYPE2L
 23060        MOVE  1                  TO SET-CURSOR-SW
 23061        GO TO 7499-EXIT.
 23062
 23063**2689**
 23064
 23065     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23066        MOVE AL-UABON            TO BSIGA
 23067        MOVE -1                  TO BSIGL
 23068        MOVE  1                  TO SET-CURSOR-SW
 23069        GO TO 7499-EXIT.
 23070
 23071**2690**
 23072
 23073     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23074        MOVE AL-UABOF            TO BLNOFCRA
 23075        MOVE -1                  TO BLNOFCRL
 23076        MOVE  1                  TO SET-CURSOR-SW
 23077        GO TO 7499-EXIT.
 23078
 23079**2693**
 23080
 23081     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23082        MOVE AL-UABOF            TO BLNOFCRA
 23083        MOVE AL-UNBON            TO BBEN1A
 23084        MOVE -1                  TO BBEN1L
 23085        MOVE  1                  TO SET-CURSOR-SW
 23086        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 429
* EL6311.cbl
 23087
 23088**2720**
 23089
 23090     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23091        MOVE AL-UNBON            TO BBEN1A
 23092        MOVE -1                  TO BBEN1L
 23093        MOVE  1                  TO SET-CURSOR-SW
 23094        GO TO 7499-EXIT.
 23095
 23096**2709**
 23097
 23098*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23099*       MOVE AL-UNBON            TO BBEN1A
 23100*       MOVE -1                  TO BBEN1L
 23101*       MOVE  1                  TO SET-CURSOR-SW
 23102*       GO TO 7499-EXIT.
 23103
 23104*************************************************************
 23105*                                                           *
 23106*            C A N C E L   E R R O R S                      *
 23107*                                                           *
 23108*************************************************************
 23109
 23110**2726**
 23111
 23112     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23113        MOVE AL-UABON            TO CCERTNOA
 23114        GO TO 7499-EXIT.
 23115
 23116**2728**
 23117
 23118     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23119        MOVE AL-UABON            TO CCERTNOA
 23120        GO TO 7499-EXIT.
 23121
 23122**2729**
 23123
 23124     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23125        MOVE AL-UABON            TO CCERTNOA
 23126        GO TO 7499-EXIT.
 23127
 23128**2730**
 23129
 23130     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23131        MOVE AL-UABON            TO CCERTNOA
 23132        GO TO 7499-EXIT.
 23133
 23134**2731**
 23135
 23136     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23137        MOVE AL-UABON            TO CCANDT1A
 23138        MOVE -1                  TO CCANDT1L
 23139        MOVE  1                  TO SET-CURSOR-SW
 23140        GO TO 7499-EXIT.
 23141
 23142**2732**
 23143
 23144     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 430
* EL6311.cbl
 23145        MOVE AL-UABON            TO CCANDT1A
 23146        MOVE -1                  TO CCANDT1L
 23147        MOVE  1                  TO SET-CURSOR-SW
 23148        GO TO 7499-EXIT.
 23149
 23150**2733**
 23151
 23152     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23153        MOVE AL-UABON            TO CCANDT1A
 23154        MOVE -1                  TO CCANDT1L
 23155        MOVE  1                  TO SET-CURSOR-SW
 23156        GO TO 7499-EXIT.
 23157
 23158**2734**
 23159
 23160     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23161        MOVE AL-UNBON            TO CREFND1A
 23162        MOVE -1                  TO CREFND1L
 23163        MOVE  1                  TO SET-CURSOR-SW
 23164        GO TO 7499-EXIT.
 23165
 23166**2735**
 23167
 23168     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23169        MOVE AL-UABON            TO CCANDT2A
 23170        MOVE -1                  TO CCANDT2L
 23171        MOVE  1                  TO SET-CURSOR-SW
 23172        GO TO 7499-EXIT.
 23173
 23174**2736**
 23175
 23176     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23177        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23178            MOVE AL-UNBON        TO CREFND1A
 23179            MOVE -1              TO CREFND1L
 23180            MOVE  1              TO SET-CURSOR-SW
 23181            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23182                MOVE AL-UNBON        TO CREFND2A
 23183                MOVE -1              TO CREFND2L
 23184                MOVE  1              TO SET-CURSOR-SW
 23185                GO TO 7499-EXIT
 23186            ELSE
 23187                GO TO 7499-EXIT
 23188        ELSE
 23189            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23190                MOVE AL-UNBON        TO CREFND2A
 23191                MOVE -1              TO CREFND2L
 23192                MOVE  1              TO SET-CURSOR-SW
 23193                GO TO 7499-EXIT
 23194            ELSE
 23195                GO TO 7499-EXIT.
 23196
 23197**2738**
 23198
 23199     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23200        MOVE -1                  TO CREFND2L
 23201        MOVE  1                  TO SET-CURSOR-SW
 23202        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 431
* EL6311.cbl
 23203
 23204**2739**
 23205
 23206     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23207        MOVE -1                  TO CREFND1L
 23208        MOVE  1                  TO SET-CURSOR-SW
 23209        GO TO 7499-EXIT.
 23210
 23211**2741**
 23212
 23213     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23214        MOVE -1                  TO CREFND1L
 23215        MOVE  1                  TO SET-CURSOR-SW
 23216        GO TO 7499-EXIT.
 23217
 23218**2743**
 23219
 23220     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23221        MOVE AL-UNBON            TO CCANDT1A
 23222        MOVE -1                  TO CCANDT1L
 23223        MOVE  1                  TO SET-CURSOR-SW
 23224        GO TO 7499-EXIT.
 23225
 23226**2744**
 23227
 23228     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23229        MOVE AL-UNBON            TO CCANDT2A
 23230        MOVE -1                  TO CCANDT2L
 23231        MOVE  1                  TO SET-CURSOR-SW
 23232        GO TO 7499-EXIT.
 23233
 23234**2747**
 23235
 23236     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23237        MOVE AL-UABON            TO CLSTNMA
 23238        MOVE -1                  TO CLSTNML
 23239        MOVE  1                  TO SET-CURSOR-SW
 23240        GO TO 7499-EXIT.
 23241
 23242**2749**
 23243
 23244     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23245        MOVE AL-UABON            TO CFORCEA
 23246        MOVE -1                  TO CFORCEL
 23247        MOVE  1                  TO SET-CURSOR-SW
 23248        GO TO 7499-EXIT.
 23249
 23250**2753**
 23251
 23252     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23253        MOVE AL-UNBON            TO CCANDT1A
 23254        MOVE -1                  TO CCANDT1L
 23255        MOVE  1                  TO SET-CURSOR-SW
 23256        GO TO 7499-EXIT.
 23257
 23258**2755**
 23259
 23260     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 432
* EL6311.cbl
 23261        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23262            MOVE AL-UNBON        TO CREFND1A
 23263            MOVE -1              TO CREFND1L
 23264            MOVE  1              TO SET-CURSOR-SW
 23265            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23266                MOVE AL-UNBON        TO CREFND2A
 23267                MOVE -1              TO CREFND2L
 23268                MOVE  1              TO SET-CURSOR-SW
 23269                GO TO 7499-EXIT
 23270            ELSE
 23271                GO TO 7499-EXIT
 23272        ELSE
 23273            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23274                MOVE AL-UNBON        TO CREFND2A
 23275                MOVE -1              TO CREFND2L
 23276                MOVE  1              TO SET-CURSOR-SW
 23277            ELSE
 23278                GO TO 7499-EXIT.
 23279
 23280**2757**
 23281
 23282     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23283        MOVE AL-UNBON            TO CLIVESA
 23284        MOVE -1                  TO CLIVESL
 23285        MOVE  1                  TO SET-CURSOR-SW
 23286        GO TO 7499-EXIT.
 23287
 23288**2771**
 23289
 23290     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23291        MOVE AL-UABON            TO CCANDT2A
 23292        MOVE -1                  TO CCANDT2L
 23293        MOVE  1                  TO SET-CURSOR-SW
 23294        GO TO 7499-EXIT.
 23295
 23296**2774**
 23297
 23298     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23299        MOVE AL-UABON            TO CCANDT1A
 23300        MOVE -1                  TO CCANDT1L
 23301        MOVE  1                  TO SET-CURSOR-SW
 23302        GO TO 7499-EXIT.
 23303
 23304**2775**
 23305
 23306     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23307        MOVE AL-UABON            TO CCANDT2A
 23308        MOVE -1                  TO CCANDT2L
 23309        MOVE  1                  TO SET-CURSOR-SW
 23310        GO TO 7499-EXIT.
 23311
 23312**2776**
 23313
 23314     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23315        MOVE AL-UABON            TO CCANDT1A
 23316        MOVE -1                  TO CCANDT1L
 23317        MOVE  1                  TO SET-CURSOR-SW
 23318        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 433
* EL6311.cbl
 23319
 23320
 23321**2777**
 23322
 23323     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23324        MOVE AL-UABON            TO CCANDT2A
 23325        MOVE -1                  TO CCANDT2L
 23326        MOVE  1                  TO SET-CURSOR-SW
 23327        GO TO 7499-EXIT.
 23328
 23329**2794**
 23330
 23331     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23332        MOVE AL-UABON            TO CFORCEA
 23333        MOVE -1                  TO CFORCEL
 23334        MOVE  1                  TO SET-CURSOR-SW
 23335        GO TO 7499-EXIT.
 23336
 23337**2799**
 23338
 23339     IF PI-COMPANY-ID = 'UCL'
 23340         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23341             MOVE AL-UNBON            TO BEFFDTA
 23342             MOVE -1                  TO BEFFDTL
 23343             MOVE  1                  TO SET-CURSOR-SW
 23344             GO TO 7499-EXIT.
 23345
 23346 7499-EXIT.
 23347      EXIT.
 23348
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 434
* EL6311.cbl
 23350
 23351 7500-READ-ERLOFC.
 23352     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23353                                     ERLOFC-KEY.
 23354
 23355     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23356
 23357     IF ST-ACCNT-CNTL
 23358         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23359
 23360     IF CARR-GROUP-ST-ACCNT-CNTL
 23361         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23362         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23363         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23364
 23365     IF CARR-ST-ACCNT-CNTL
 23366         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23367         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23368
 23369     IF CARR-ACCNT-CNTL
 23370         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23371
 23372     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23373
 23374     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23375
 23376
 23377* EXEC CICS HANDLE CONDITION
 23378*        NOTFND   (7550-OFFICER-NOTFND)
 23379*    END-EXEC.
 23380*    MOVE '"$I                   ! [ #00019662' TO DFHEIV0
 23381     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23383     MOVE X'5B20233030303139363632' TO DFHEIV0(25:11)
 23384     CALL 'kxdfhei1' USING DFHEIV0
 23385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23386
 23387
 23388
 23389* EXEC CICS READ
 23390*        DATASET   (FILE-ID-ERLOFC)
 23391*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23392*        RIDFLD    (ERLOFC-KEY)
 23393*        EQUAL
 23394*    END-EXEC.
 23395*    MOVE '&"S        E          (   #00019666' TO DFHEIV0
 23396     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23397     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23398     MOVE X'2020233030303139363636' TO DFHEIV0(25:11)
 23399     CALL 'kxdfhei1' USING DFHEIV0,
 23400           FILE-ID-ERLOFC,
 23401           DFHEIV20,
 23402           DFHEIV99,
 23403           ERLOFC-KEY,
 23404           DFHEIV99,
 23405           DFHEIV99,
 23406           DFHEIV99
 23407     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 435
* EL6311.cbl
 23408         DFHEIV20
 23409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23410
 23411
 23412     GO TO 7599-EXIT.
 23413
 23414 7550-OFFICER-NOTFND.
 23415     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23416
 23417 7599-EXIT.
 23418      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 436
* EL6311.cbl
 23420******************************************************************
 23421*                                                                *
 23422*            S  E N D    I N I T I A L   M A P                   *
 23423*                                                                *
 23424******************************************************************
 23425
 23426 8100-SEND-INITIAL-MAP.
 23427     MOVE EIBTIME                TO TIME-IN.
 23428
 23429     IF EIBAID = DFHPF11
 23430        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23431        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23432
 23433
 23434     IF PI-COMPANY-ID = CLIENT-GIC
 23435        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23436                                       BCPREM-ATTRB (2).
 23437
 23438     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23439                         CLIENT-PEM OR
 23440                         CLIENT-CSO)
 23441        AND PI-DISPLAY-ORIGINAL-BATCH
 23442          IF PI-MAP-NAME = EL631B
 23443             MOVE AL-SADOF               TO BPF5HDRA
 23444                                            BPF4HDRA
 23445          ELSE
 23446             IF PI-MAP-NAME = EL631C
 23447                MOVE AL-SADOF            TO CPF5HDRA
 23448                                            CPF4HDRA.
 23449
 23450     IF PI-MAP-NAME = EL631B
 23451        MOVE AL-SADOF               TO BPF5HDRA
 23452     ELSE
 23453        MOVE AL-SADOF               TO CPF5HDRA
 23454     END-IF
 23455
 23456*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23457     IF PI-MAP-NAME = EL631B
 23458          IF PI-COMPANY-ID NOT = 'DMD'
 23459             MOVE AL-SANOF            TO BBILLEDA
 23460             MOVE AL-SADOF            TO DMDBILA.
 23461*DMD CUSTOM CODING*************END
 23462
 23463     IF PI-PROCESSOR-ID = 'LGXX'
 23464        IF PI-MAP-NAME = EL631B
 23465           MOVE AL-SABOF                    TO BREFHDGA
 23466           MOVE AL-SANOF                    TO BREFA
 23467        ELSE
 23468           IF PI-MAP-NAME = EL631C
 23469              MOVE AL-SABOF                 TO CREFHDGA
 23470              MOVE AL-SANOF                 TO CREFA.
 23471
 23472*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23473     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23474        NEXT SENTENCE
 23475     ELSE
 23476        IF PI-MAP-NAME = EL631C
 23477           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 437
* EL6311.cbl
 23478                                       CCANFEEA.
 23479
 23480     IF PI-MAP-NAME = EL631D
 23481        IF PI-AR-PROCESSING
 23482           MOVE AL-SANOF            TO DREFHDGA
 23483        ELSE
 23484           MOVE AL-SADOF            TO DREFHDGA.
 23485
 23486     IF (PI-COMPANY-ID NOT = 'DCC')
 23487        AND (PI-MAP-NAME = EL631B)
 23488        MOVE AL-SADOF            TO BVINHA
 23489                                    BVINA
 23490     END-IF
 23491     IF PI-MAP-NAME = EL631B
 23492        IF CSR-EDIT-SESSION
 23493           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23494                                 TO BHEADO
 23495           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23496        ELSE
 23497           MOVE AL-SADOF         TO BF15HDRA
 23498           MOVE '4=B-HDR      '  TO BPF4HDRO
 23499        END-IF
 23500        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23501        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23502        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23503        MOVE WS-CURRENT-DT          TO BDATEO
 23504        MOVE TIME-OUT               TO BTIMEO
 23505        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23506        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23507        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23508        IF   WS-DISPLAY-SCREEN
 23509             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23510             MOVE PB-SV-CARRIER     TO BCARRO
 23511             MOVE PB-SV-GROUPING    TO BGROUPO
 23512             MOVE PB-SV-STATE       TO BSTATEO
 23513             MOVE PB-ACCOUNT        TO BACCTO
 23514        ELSE
 23515             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23516     ELSE
 23517        IF PI-MAP-NAME = EL631C
 23518           MOVE '4=B-HDR      '     TO CPF4HDRO
 23519           IF CSR-EDIT-SESSION
 23520              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23521                                 TO CHEADO
 23522           ELSE
 23523              MOVE AL-SADOF      TO CF15HDRA
 23524           END-IF
 23525           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23526           MOVE WS-CURRENT-DT          TO CDATEO
 23527           MOVE TIME-OUT               TO CTIMEO
 23528           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23529           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23530           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23531           MOVE WS-C-HDG               TO CLFHDGO
 23532           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23533           MOVE WS-C-HDG               TO CAHHDGO
 23534           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23535           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 438
* EL6311.cbl
 23536           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23537           IF   WS-DISPLAY-SCREEN
 23538                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23539                MOVE PB-SV-CARRIER     TO CCARRO
 23540                MOVE PB-SV-GROUPING    TO CGROUPO
 23541                MOVE PB-SV-STATE       TO CSTATEO
 23542                MOVE PB-ACCOUNT        TO CACCTO
 23543           ELSE
 23544                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23545        ELSE
 23546           MOVE WS-CURRENT-DT          TO DDATEO
 23547           MOVE TIME-OUT               TO DTIMEO
 23548           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23549                                          WS-REFUND-HDG-OVERRIDE
 23550           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23551           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23552           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23553                                          WS-REFUND-HDG-OVERRIDE
 23554           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23555           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23556           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23557           IF CSR-EDIT-SESSION
 23558              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23559                                 TO DHEADO
 23560           END-IF
 23561           IF  WS-DISPLAY-SCREEN
 23562               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23563               MOVE PB-CARRIER         TO DCARRO
 23564               MOVE PB-GROUPING        TO DGROUPO
 23565               MOVE PB-STATE           TO DSTATEO
 23566               MOVE PB-ACCOUNT         TO DACCTO
 23567               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23568           ELSE
 23569               MOVE EL631D             TO PI-MAP-NAME
 23570               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23571               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23572
 23573     MOVE SPACE                        TO WS-DISPLAY-SW.
 23574
 23575
 23576* EXEC CICS SEND
 23577*        MAP      (PI-MAP-NAME)
 23578*        MAPSET   (MAPSET-EL6311S)
 23579*        FROM     (EL631BI)
 23580*        ERASE
 23581*        CURSOR
 23582*    END-EXEC.
 23583     MOVE LENGTH OF
 23584      EL631BI
 23585       TO DFHEIV12
 23586     MOVE -1
 23587       TO DFHEIV11
 23588*    MOVE '8$     CT  E    H L F ,   #00019836' TO DFHEIV0
 23589     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23590     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23591     MOVE X'2020233030303139383336' TO DFHEIV0(25:11)
 23592     CALL 'kxdfhei1' USING DFHEIV0,
 23593           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 439
* EL6311.cbl
 23594           EL631BI,
 23595           DFHEIV12,
 23596           MAPSET-EL6311S,
 23597           DFHEIV99,
 23598           DFHEIV99,
 23599           DFHEIV99,
 23600           DFHEIV11,
 23601           DFHEIV99,
 23602           DFHEIV99,
 23603           DFHEIV99
 23604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23605
 23606
 23607     GO TO 9100-RETURN-TRAN.
 23608
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 440
* EL6311.cbl
 23610
 23611******************************************************************
 23612*                                                                *
 23613*              S E N D    D A T A O N L Y                        *
 23614*                                                                *
 23615******************************************************************
 23616
 23617 8200-SEND-DATAONLY.
 23618     MOVE EIBTIME                TO TIME-IN.
 23619
 23620     IF PI-COMPANY-ID = CLIENT-GIC
 23621        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23622                                       BCPREM-ATTRB (2).
 23623
 23624     IF PI-MAP-NAME = EL631B
 23625        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23626        MOVE WS-CURRENT-DT          TO BDATEO
 23627        MOVE TIME-OUT               TO BTIMEO
 23628        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23629        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23630        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23631        MOVE SPACES                 TO BPFENTRO
 23632        MOVE AL-UANOF               TO BPFENTRA
 23633
 23634*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23635        IF PI-COMPANY-ID NOT = 'DMD'
 23636             MOVE AL-SANOF            TO BBILLEDA
 23637             MOVE AL-SADOF            TO DMDBILA
 23638         ELSE
 23639            NEXT SENTENCE
 23640*DMD CUSTOM CODING*************END
 23641     ELSE
 23642        IF PI-MAP-NAME = EL631C
 23643           MOVE WS-CURRENT-DT          TO CDATEO
 23644           MOVE TIME-OUT               TO CTIMEO
 23645           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23646           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23647           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23648           MOVE SPACES                 TO CPFENTRO
 23649           MOVE AL-UANOF               TO CPFENTRA
 23650        ELSE
 23651           MOVE WS-CURRENT-DT          TO DDATEO
 23652           MOVE TIME-OUT               TO DTIMEO
 23653           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 23654
 23655
 23656* EXEC CICS SEND
 23657*        MAP      (PI-MAP-NAME)
 23658*        MAPSET   (MAPSET-EL6311S)
 23659*        FROM     (EL631BI)
 23660*        DATAONLY
 23661*        CURSOR
 23662*    END-EXEC.
 23663     MOVE LENGTH OF
 23664      EL631BI
 23665       TO DFHEIV12
 23666     MOVE -1
 23667       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 441
* EL6311.cbl
 23668*    MOVE '8$D    CT       H L F ,   #00019892' TO DFHEIV0
 23669     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 23670     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23671     MOVE X'2020233030303139383932' TO DFHEIV0(25:11)
 23672     CALL 'kxdfhei1' USING DFHEIV0,
 23673           PI-MAP-NAME,
 23674           EL631BI,
 23675           DFHEIV12,
 23676           MAPSET-EL6311S,
 23677           DFHEIV99,
 23678           DFHEIV99,
 23679           DFHEIV99,
 23680           DFHEIV11,
 23681           DFHEIV99,
 23682           DFHEIV99,
 23683           DFHEIV99
 23684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23685
 23686
 23687     GO TO 9100-RETURN-TRAN.
 23688
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 442
* EL6311.cbl
 23690
 23691******************************************************************
 23692*                                                                *
 23693*           U T I L I T Y   R O U T I N E S                      *
 23694*                                                                *
 23695******************************************************************
 23696
 23697 8300-SEND-TEXT.
 23698
 23699* EXEC CICS SEND TEXT
 23700*        FROM     (LOGOFF-TEXT)
 23701*        LENGTH   (LOGOFF-LENGTH)
 23702*        ERASE
 23703*        FREEKB
 23704*    END-EXEC.
 23705*    MOVE '8&      T  E F  H   F -   #00019911' TO DFHEIV0
 23706     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 23707     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 23708     MOVE X'2020233030303139393131' TO DFHEIV0(25:11)
 23709     CALL 'kxdfhei1' USING DFHEIV0,
 23710           LOGOFF-TEXT,
 23711           LOGOFF-LENGTH,
 23712           DFHEIV99,
 23713           DFHEIV99,
 23714           DFHEIV99,
 23715           DFHEIV99,
 23716           DFHEIV99,
 23717           DFHEIV99,
 23718           DFHEIV99,
 23719           DFHEIV99,
 23720           DFHEIV99,
 23721           DFHEIV99
 23722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23723
 23724
 23725
 23726* EXEC CICS RETURN
 23727*    END-EXEC.
 23728*    MOVE '.(                    ''   #00019918' TO DFHEIV0
 23729     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23730     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23731     MOVE X'2020233030303139393138' TO DFHEIV0(25:11)
 23732     CALL 'kxdfhei1' USING DFHEIV0,
 23733           DFHEIV99,
 23734           DFHEIV99,
 23735           DFHEIV99,
 23736           DFHEIV99,
 23737           DFHEIV99,
 23738           DFHEIV99
 23739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23740
 23741
 23742 8400-LOG-JOURNAL-RECORD.
 23743     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 23744     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 23745
 23746*    EXEC CICS JOURNAL
 23747*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 443
* EL6311.cbl
 23748*        JTYPEID     ('EL')
 23749*        FROM        (JOURNAL-RECORD)
 23750*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 23751*    END-EXEC.
 23752
 23753 8600-DEEDIT.
 23754
 23755* EXEC CICS BIF DEEDIT
 23756*         FIELD   (DEEDIT-FIELD)
 23757*         LENGTH  (15)
 23758*    END-EXEC.
 23759     MOVE 15
 23760       TO DFHEIV11
 23761*    MOVE '@"L                   #   #00019933' TO DFHEIV0
 23762     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 23763     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23764     MOVE X'2020233030303139393333' TO DFHEIV0(25:11)
 23765     CALL 'kxdfhei1' USING DFHEIV0,
 23766           DEEDIT-FIELD,
 23767           DFHEIV11
 23768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23769
 23770
 23771 8800-UNAUTHORIZED-ACCESS.
 23772     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 23773     GO TO 8300-SEND-TEXT.
 23774
 23775 8810-PF23.
 23776     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 23777     MOVE XCTL-EL005             TO PGM-NAME.
 23778     GO TO 9300-XCTL.
 23779
 23780 9100-RETURN-TRAN.
 23781     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 23782
 23783     IF  PI-MAP-NAME =  EL631B
 23784         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 23785
 23786     IF  PI-MAP-NAME =  EL631C
 23787         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 23788
 23789     IF  PI-MAP-NAME =  EL631D
 23790         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 23791
 23792
 23793* EXEC CICS RETURN
 23794*        TRANSID    (TRANS-EXB1)
 23795*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23796*        LENGTH     (1300)
 23797*    END-EXEC.
 23798     MOVE 1300
 23799       TO DFHEIV11
 23800*    MOVE '.(CT                  ''   #00019959' TO DFHEIV0
 23801     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 23802     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23803     MOVE X'2020233030303139393539' TO DFHEIV0(25:11)
 23804     CALL 'kxdfhei1' USING DFHEIV0,
 23805           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 444
* EL6311.cbl
 23806           PROGRAM-INTERFACE-BLOCK,
 23807           DFHEIV11,
 23808           DFHEIV99,
 23809           DFHEIV99,
 23810           DFHEIV99
 23811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23812
 23813
 23814 9200-RETURN-MAIN-MENU.
 23815     MOVE XCTL-EL626             TO PGM-NAME.
 23816     GO TO 9300-XCTL.
 23817
 23818 9300-XCTL.
 23819
 23820* EXEC CICS XCTL
 23821*        PROGRAM    (PGM-NAME)
 23822*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23823*        LENGTH     (PI-COMM-LENGTH)
 23824*    END-EXEC.
 23825*    MOVE '.$C                   %   #00019970' TO DFHEIV0
 23826     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 23827     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23828     MOVE X'2020233030303139393730' TO DFHEIV0(25:11)
 23829     CALL 'kxdfhei1' USING DFHEIV0,
 23830           PGM-NAME,
 23831           PROGRAM-INTERFACE-BLOCK,
 23832           PI-COMM-LENGTH,
 23833           DFHEIV99
 23834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23835
 23836
 23837 9400-CLEAR.
 23838     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 23839     GO TO 9300-XCTL.
 23840
 23841 9500-PF12.
 23842     MOVE XCTL-EL010             TO PGM-NAME.
 23843     GO TO 9300-XCTL.
 23844
 23845 9600-PGMID-ERROR.
 23846
 23847* EXEC CICS HANDLE CONDITION
 23848*        PGMIDERR    (8300-SEND-TEXT)
 23849*    END-EXEC.
 23850*    MOVE '"$L                   ! \ #00019985' TO DFHEIV0
 23851     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 23852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23853     MOVE X'5C20233030303139393835' TO DFHEIV0(25:11)
 23854     CALL 'kxdfhei1' USING DFHEIV0
 23855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23856
 23857
 23858     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 23859     MOVE ' '                    TO PI-ENTRY-CD-1.
 23860     MOVE XCTL-EL005             TO PGM-NAME.
 23861     MOVE PGM-NAME               TO LOGOFF-PGM.
 23862     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 23863     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 445
* EL6311.cbl
 23864
 23865 9700-DATE-LINK.
 23866     MOVE LINK-ELDATCV           TO PGM-NAME.
 23867
 23868* EXEC CICS LINK
 23869*        PROGRAM    (PGM-NAME)
 23870*        COMMAREA   (DATE-CONVERSION-DATA)
 23871*        LENGTH     (DC-COMM-LENGTH)
 23872*    END-EXEC.
 23873*    MOVE '."C                   (   #00019998' TO DFHEIV0
 23874     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23875     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23876     MOVE X'2020233030303139393938' TO DFHEIV0(25:11)
 23877     CALL 'kxdfhei1' USING DFHEIV0,
 23878           PGM-NAME,
 23879           DATE-CONVERSION-DATA,
 23880           DC-COMM-LENGTH,
 23881           DFHEIV99,
 23882           DFHEIV99,
 23883           DFHEIV99,
 23884           DFHEIV99
 23885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23886
 23887
 23888 9800-LINK-PENDING-EDIT.
 23889     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 23890     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 23891
 23892     MOVE LINK-EL050             TO PGM-NAME
 23893     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 23894     MOVE ZEROS                  TO WK-CO-MAX-CAP
 23895                                    WK-CO-TOL-CLAIM
 23896                                    WK-CO-TOL-PREM
 23897                                    WK-CO-TOL-REFUND
 23898                                    WK-CO-TOL-PREM-PCT
 23899                                    WK-CO-TOL-REFUND-PCT
 23900                                    WK-REFUND-OVS-AMT
 23901                                    WK-REFUND-OVS-PCT
 23902                                    WK-ACCT-ADDR
 23903                                    WK-LIFE-EDIT-ADDR
 23904                                    WK-AH-EDIT-ADDR
 23905                                    WK-LIFE-BEN-ADDR
 23906                                    WK-AH-BEN-ADDR
 23907                                    WK-STATE-ADDR
 23908                                    WK-PLAN-ADDR
 23909                                    WK-FORM-ADDR
 23910     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 23911
 23912     MOVE '6'                    TO WK-ENTRY-SW.
 23913
 23914     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 23915
 23916     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 23917                                    EC-AM-EXPIRATION-DT
 23918                                    EC-AM-EFFECTIVE-DT
 23919                                    EC-CM-LF-CANCEL-DT
 23920                                    EC-CM-AH-CANCEL-DT
 23921                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 446
* EL6311.cbl
 23922
 23923     MOVE ZEROS                  TO EC-CO-TOL-PREM
 23924                                    EC-CO-TOL-REFUND
 23925                                    EC-CO-MIN-AGE
 23926                                    EC-CO-MIN-PREMIUM
 23927                                    EC-CO-MIN-TERM
 23928                                    EC-CO-MAX-TERM
 23929                                    EC-ST-TOL-PREM
 23930                                    EC-ST-TOL-REFUND
 23931                                    EC-AM-LF-TOL-PREM
 23932                                    EC-AM-AH-TOL-PREM
 23933                                    EC-AM-LF-MAX-ATT-AGE
 23934                                    EC-AM-LF-MAX-AGE
 23935                                    EC-AM-LF-MAX-TERM
 23936                                    EC-AM-LF-MAX-TOT-BEN
 23937                                    EC-AM-AH-MAX-ATT-AGE
 23938                                    EC-AM-AH-MAX-AGE
 23939                                    EC-AM-AH-MAX-TERM
 23940                                    EC-AM-AH-MAX-TOT-BEN
 23941                                    EC-AM-AH-MAX-MON-BEN
 23942                                    EC-RT-LF-MAX-ATT-AGE
 23943                                    EC-RT-LF-MAX-AGE
 23944                                    EC-RT-LF-MAX-TERM
 23945                                    EC-RT-LF-MAX-TOT-BEN
 23946                                    EC-RT-AH-MAX-ATT-AGE
 23947                                    EC-RT-AH-MAX-AGE
 23948                                    EC-RT-AH-MAX-TERM
 23949                                    EC-RT-AH-MAX-TOT-BEN
 23950                                    EC-RT-AH-MAX-MON-BEN
 23951                                    EC-RT-AH-RATE
 23952                                    EC-RT-LF-RATE
 23953                                    EC-RT-LF-NSP-RATE
 23954                                    EC-RT-AH-NSP-RATE
 23955                                    EC-CM-LF-PRIOR-REFUND
 23956                                    EC-CM-AH-PRIOR-REFUND.
 23957
 23958     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 23959                                    EC-ST-TOL-PREM-PCT
 23960                                    EC-AM-LF-TOL-REFUND
 23961                                    EC-AM-LF-DEV-PERCENT
 23962                                    EC-CO-TOL-REFUND-PCT
 23963                                    EC-ST-TOL-REFUND-PCT
 23964                                    EC-AM-AH-TOL-REFUND
 23965                                    EC-AM-AH-DEV-PERCENT.
 23966
 23967
 23968* EXEC CICS LINK
 23969*         PROGRAM   (PGM-NAME)
 23970*         COMMAREA  (PASSED-RECORD)
 23971*         LENGTH    (WS-EDIT-PASS-LENGTH)
 23972*    END-EXEC.
 23973*    MOVE '."C                   (   #00020083' TO DFHEIV0
 23974     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23975     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23976     MOVE X'2020233030303230303833' TO DFHEIV0(25:11)
 23977     CALL 'kxdfhei1' USING DFHEIV0,
 23978           PGM-NAME,
 23979           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 447
* EL6311.cbl
 23980           WS-EDIT-PASS-LENGTH,
 23981           DFHEIV99,
 23982           DFHEIV99,
 23983           DFHEIV99,
 23984           DFHEIV99
 23985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23986
 23987
 23988     MOVE '1'                    TO PI-EDIT-SW.
 23989     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 23990
 23991     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 23992
 23993     IF PI-COMPANY-ID = 'UCL'
 23994         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 23995
 23996     IF VALID-PB-ID
 23997        GO TO 9800-EXIT.
 23998
 23999     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24000
 24001     IF PI-MAP-NAME = EL631B
 24002        MOVE -1                  TO BMAINTL
 24003       ELSE
 24004        MOVE -1                  TO CMAINTL.
 24005
 24006     GO TO 8200-SEND-DATAONLY.
 24007
 24008 9800-EXIT.
 24009      EXIT.
 24010
 24011 9900-ERROR-FORMAT.
 24012
 24013     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24014
 24015     IF NOT EMI-ERRORS-COMPLETE
 24016         MOVE LINK-EL001         TO PGM-NAME
 24017
 24018* EXEC CICS LINK
 24019*            PROGRAM    (PGM-NAME)
 24020*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24021*            LENGTH     (EMI-COMM-LENGTH)
 24022*        END-EXEC.
 24023*    MOVE '."C                   (   #00020118' TO DFHEIV0
 24024     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24025     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24026     MOVE X'2020233030303230313138' TO DFHEIV0(25:11)
 24027     CALL 'kxdfhei1' USING DFHEIV0,
 24028           PGM-NAME,
 24029           ERROR-MESSAGE-INTERFACE-BLOCK,
 24030           EMI-COMM-LENGTH,
 24031           DFHEIV99,
 24032           DFHEIV99,
 24033           DFHEIV99,
 24034           DFHEIV99
 24035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24036
 24037
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 448
* EL6311.cbl
 24038 9900-EXIT.
 24039     EXIT.
 24040
 24041 9990-ABEND.
 24042     MOVE LINK-EL004             TO PGM-NAME.
 24043     MOVE DFHEIBLK               TO EMI-LINE1.
 24044
 24045* EXEC CICS LINK
 24046*        PROGRAM   (PGM-NAME)
 24047*        COMMAREA  (EMI-LINE1)
 24048*        LENGTH    (72)
 24049*    END-EXEC.
 24050     MOVE 72
 24051       TO DFHEIV11
 24052*    MOVE '."C                   (   #00020130' TO DFHEIV0
 24053     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24055     MOVE X'2020233030303230313330' TO DFHEIV0(25:11)
 24056     CALL 'kxdfhei1' USING DFHEIV0,
 24057           PGM-NAME,
 24058           EMI-LINE1,
 24059           DFHEIV11,
 24060           DFHEIV99,
 24061           DFHEIV99,
 24062           DFHEIV99,
 24063           DFHEIV99
 24064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24065
 24066
 24067     IF PI-MAP-NAME = EL631B
 24068        MOVE -1                  TO BMAINTL
 24069       ELSE
 24070        MOVE -1                  TO CMAINTL.
 24071
 24072     IF EIBTRNID NOT = TRANS-EXB1
 24073        GO TO 8100-SEND-INITIAL-MAP
 24074       ELSE
 24075        GO TO 8200-SEND-DATAONLY.
 24076
 24077 9995-SECURITY-VIOLATION.
 24078*                            COPY ELCSCTP.
 24079******************************************************************
 24080*                                                                *
 24081*                            ELCSCTP                             *
 24082*                            VMOD=2.001                          *
 24083*                                                                *
 24084*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24085******************************************************************
 24086
 24087
 24088     MOVE EIBDATE          TO SM-JUL-DATE.
 24089     MOVE EIBTRMID         TO SM-TERMID.
 24090     MOVE THIS-PGM         TO SM-PGM.
 24091     MOVE EIBTIME          TO TIME-IN.
 24092     MOVE TIME-OUT         TO SM-TIME.
 24093     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24094
 24095
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 449
* EL6311.cbl
 24096* EXEC CICS LINK
 24097*         PROGRAM  ('EL003')
 24098*         COMMAREA (SECURITY-MESSAGE)
 24099*         LENGTH   (80)
 24100*    END-EXEC.
 24101     MOVE 'EL003' TO DFHEIV1
 24102     MOVE 80
 24103       TO DFHEIV11
 24104*    MOVE '."C                   (   #00020164' TO DFHEIV0
 24105     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24106     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24107     MOVE X'2020233030303230313634' TO DFHEIV0(25:11)
 24108     CALL 'kxdfhei1' USING DFHEIV0,
 24109           DFHEIV1,
 24110           SECURITY-MESSAGE,
 24111           DFHEIV11,
 24112           DFHEIV99,
 24113           DFHEIV99,
 24114           DFHEIV99,
 24115           DFHEIV99
 24116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24117
 24118
 24119******************************************************************
 24120
 24121
 24122 9999-DFHBACK SECTION.
 24123     MOVE '9%                    "   ' TO DFHEIV0
 24124     MOVE 'EL6311' TO DFHEIV1
 24125     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24126     GOBACK.
 24127 9999-DFHEXIT.
 24128     IF DFHEIGDJ EQUAL 0001
 24129         NEXT SENTENCE
 24130     ELSE IF DFHEIGDJ EQUAL 2
 24131         GO TO 9600-PGMID-ERROR,
 24132               9990-ABEND,
 24133               9990-ABEND,
 24134               0010-MAIN-LOGIC
 24135         DEPENDING ON DFHEIGDI
 24136     ELSE IF DFHEIGDJ EQUAL 3
 24137         GO TO 1280-BATCH-HDR-NOT-FOUND
 24138         DEPENDING ON DFHEIGDI
 24139     ELSE IF DFHEIGDJ EQUAL 4
 24140         GO TO 1290-DUPLICATE-ALT-INDEX
 24141         DEPENDING ON DFHEIGDI
 24142     ELSE IF DFHEIGDJ EQUAL 5
 24143         GO TO 1295-CERT-TRL-REC-NOTFND
 24144         DEPENDING ON DFHEIGDI
 24145     ELSE IF DFHEIGDJ EQUAL 6
 24146         GO TO 1380-BATCH-HDR-NOT-FOUND
 24147         DEPENDING ON DFHEIGDI
 24148     ELSE IF DFHEIGDJ EQUAL 7
 24149         GO TO 1385-REC-NOT-FOUND
 24150         DEPENDING ON DFHEIGDI
 24151     ELSE IF DFHEIGDJ EQUAL 8
 24152         GO TO 1386-NOTFND
 24153         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 450
* EL6311.cbl
 24154     ELSE IF DFHEIGDJ EQUAL 9
 24155         GO TO 1399-EXIT
 24156         DEPENDING ON DFHEIGDI
 24157     ELSE IF DFHEIGDJ EQUAL 10
 24158         GO TO 1480-BATCH-HDR-NOT-FOUND
 24159         DEPENDING ON DFHEIGDI
 24160     ELSE IF DFHEIGDJ EQUAL 11
 24161         GO TO 1490-RECORD-NOT-FOUND
 24162         DEPENDING ON DFHEIGDI
 24163     ELSE IF DFHEIGDJ EQUAL 12
 24164         GO TO 1405-DELETE-CERTIFICATE
 24165         DEPENDING ON DFHEIGDI
 24166     ELSE IF DFHEIGDJ EQUAL 13
 24167         GO TO 1420-CONTINUE-DELETE
 24168         DEPENDING ON DFHEIGDI
 24169     ELSE IF DFHEIGDJ EQUAL 14
 24170         GO TO 1406-DELETE-ERNOTE
 24171         DEPENDING ON DFHEIGDI
 24172     ELSE IF DFHEIGDJ EQUAL 15
 24173         GO TO 1407-DELETE-MAILING
 24174         DEPENDING ON DFHEIGDI
 24175     ELSE IF DFHEIGDJ EQUAL 16
 24176         GO TO 1420-CONTINUE-DELETE
 24177         DEPENDING ON DFHEIGDI
 24178     ELSE IF DFHEIGDJ EQUAL 17
 24179         GO TO 1480-BATCH-HDR-NOT-FOUND
 24180         DEPENDING ON DFHEIGDI
 24181     ELSE IF DFHEIGDJ EQUAL 18
 24182         GO TO 1475-DELETE-FINISHED
 24183         DEPENDING ON DFHEIGDI
 24184     ELSE IF DFHEIGDJ EQUAL 19
 24185         GO TO 2280-BATCH-HDR-NOT-FOUND
 24186         DEPENDING ON DFHEIGDI
 24187     ELSE IF DFHEIGDJ EQUAL 20
 24188         GO TO 2290-DUPLICATE-ALT-INDEX
 24189         DEPENDING ON DFHEIGDI
 24190     ELSE IF DFHEIGDJ EQUAL 21
 24191         GO TO 2380-BATCH-HDR-NOT-FOUND
 24192         DEPENDING ON DFHEIGDI
 24193     ELSE IF DFHEIGDJ EQUAL 22
 24194         GO TO 2385-REC-NOT-FOUND
 24195         DEPENDING ON DFHEIGDI
 24196     ELSE IF DFHEIGDJ EQUAL 23
 24197         GO TO 2380-BATCH-HDR-NOT-FOUND
 24198         DEPENDING ON DFHEIGDI
 24199     ELSE IF DFHEIGDJ EQUAL 24
 24200         GO TO 2485-BATCH-HDR-NOT-FOUND
 24201         DEPENDING ON DFHEIGDI
 24202     ELSE IF DFHEIGDJ EQUAL 25
 24203         GO TO 2490-RECORD-NOT-FOUND
 24204         DEPENDING ON DFHEIGDI
 24205     ELSE IF DFHEIGDJ EQUAL 26
 24206         GO TO 2475-CONTINUE-DELETE
 24207         DEPENDING ON DFHEIGDI
 24208     ELSE IF DFHEIGDJ EQUAL 27
 24209         GO TO 2485-BATCH-HDR-NOT-FOUND
 24210         DEPENDING ON DFHEIGDI
 24211     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 451
* EL6311.cbl
 24212         GO TO 2480-DELETE-FINISHED
 24213         DEPENDING ON DFHEIGDI
 24214     ELSE IF DFHEIGDJ EQUAL 29
 24215         GO TO 2820-PROCESS-REWRITE
 24216         DEPENDING ON DFHEIGDI
 24217     ELSE IF DFHEIGDJ EQUAL 30
 24218         GO TO 2885-RECORD-MISSING
 24219         DEPENDING ON DFHEIGDI
 24220     ELSE IF DFHEIGDJ EQUAL 31
 24221         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24222         DEPENDING ON DFHEIGDI
 24223     ELSE IF DFHEIGDJ EQUAL 32
 24224         GO TO 2827-DELETE-MAILING
 24225         DEPENDING ON DFHEIGDI
 24226     ELSE IF DFHEIGDJ EQUAL 33
 24227         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24228         DEPENDING ON DFHEIGDI
 24229     ELSE IF DFHEIGDJ EQUAL 34
 24230         GO TO 2920-PROCESS-REWRITE
 24231         DEPENDING ON DFHEIGDI
 24232     ELSE IF DFHEIGDJ EQUAL 35
 24233         GO TO 2985-RECORD-MISSING
 24234         DEPENDING ON DFHEIGDI
 24235     ELSE IF DFHEIGDJ EQUAL 36
 24236         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24237         DEPENDING ON DFHEIGDI
 24238     ELSE IF DFHEIGDJ EQUAL 37
 24239         GO TO 2990-DUPLICATE-RECORD
 24240         DEPENDING ON DFHEIGDI
 24241     ELSE IF DFHEIGDJ EQUAL 38
 24242         GO TO 3590-NOT-FOUND
 24243         DEPENDING ON DFHEIGDI
 24244     ELSE IF DFHEIGDJ EQUAL 39
 24245         GO TO 3690-NOT-FOUND
 24246         DEPENDING ON DFHEIGDI
 24247     ELSE IF DFHEIGDJ EQUAL 40
 24248         GO TO 3990-NOT-FOUND
 24249         DEPENDING ON DFHEIGDI
 24250     ELSE IF DFHEIGDJ EQUAL 41
 24251         GO TO 4050-END-RECORDS,
 24252               4050-END-RECORDS
 24253         DEPENDING ON DFHEIGDI
 24254     ELSE IF DFHEIGDJ EQUAL 42
 24255         GO TO 4150-END-BATCH
 24256         DEPENDING ON DFHEIGDI
 24257     ELSE IF DFHEIGDJ EQUAL 43
 24258         GO TO 4150-END-BATCH
 24259         DEPENDING ON DFHEIGDI
 24260     ELSE IF DFHEIGDJ EQUAL 44
 24261         GO TO 4250-END-RECORDS,
 24262               4250-END-RECORDS
 24263         DEPENDING ON DFHEIGDI
 24264     ELSE IF DFHEIGDJ EQUAL 45
 24265         GO TO 4350-END-BATCH,
 24266               4350-END-BATCH
 24267         DEPENDING ON DFHEIGDI
 24268     ELSE IF DFHEIGDJ EQUAL 46
 24269         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 452
* EL6311.cbl
 24270               4550-END-RECORDS
 24271         DEPENDING ON DFHEIGDI
 24272     ELSE IF DFHEIGDJ EQUAL 47
 24273         GO TO 4680-NOT-FOUND,
 24274               4680-NOT-FOUND
 24275         DEPENDING ON DFHEIGDI
 24276     ELSE IF DFHEIGDJ EQUAL 48
 24277         GO TO 4860-NOT-FOUND,
 24278               4850-END-RECORDS
 24279         DEPENDING ON DFHEIGDI
 24280     ELSE IF DFHEIGDJ EQUAL 49
 24281         GO TO 4970-NOT-FOUND,
 24282               4950-END-RECORDS
 24283         DEPENDING ON DFHEIGDI
 24284     ELSE IF DFHEIGDJ EQUAL 50
 24285         GO TO 5050-NOT-FOUND
 24286         DEPENDING ON DFHEIGDI
 24287     ELSE IF DFHEIGDJ EQUAL 51
 24288         GO TO 5050-NOT-FOUND
 24289         DEPENDING ON DFHEIGDI
 24290     ELSE IF DFHEIGDJ EQUAL 52
 24291         GO TO 5050-NOT-FOUND
 24292         DEPENDING ON DFHEIGDI
 24293     ELSE IF DFHEIGDJ EQUAL 53
 24294         GO TO 5550-END-RECORDS,
 24295               5550-END-RECORDS
 24296         DEPENDING ON DFHEIGDI
 24297     ELSE IF DFHEIGDJ EQUAL 54
 24298         GO TO 6050-QID-ERROR
 24299         DEPENDING ON DFHEIGDI
 24300     ELSE IF DFHEIGDJ EQUAL 55
 24301         GO TO 6050-QID-ERROR
 24302         DEPENDING ON DFHEIGDI
 24303     ELSE IF DFHEIGDJ EQUAL 56
 24304         GO TO 6400-CONTINUE,
 24305               6400-CONTINUE
 24306         DEPENDING ON DFHEIGDI
 24307     ELSE IF DFHEIGDJ EQUAL 57
 24308         GO TO 3690-NOT-FOUND
 24309         DEPENDING ON DFHEIGDI
 24310     ELSE IF DFHEIGDJ EQUAL 58
 24311         GO TO 7399-EXIT
 24312         DEPENDING ON DFHEIGDI
 24313     ELSE IF DFHEIGDJ EQUAL 59
 24314         GO TO 7550-OFFICER-NOTFND
 24315         DEPENDING ON DFHEIGDI
 24316     ELSE IF DFHEIGDJ EQUAL 60
 24317         GO TO 8300-SEND-TEXT
 24318         DEPENDING ON DFHEIGDI.
 24319     MOVE '9%                    "   ' TO DFHEIV0
 24320     MOVE 'EL6311' TO DFHEIV1
 24321     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24322     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14776     Code:       96619
