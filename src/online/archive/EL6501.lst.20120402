* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   1
* EL6501.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL6501.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6501.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6501.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/11/94 14:25:07.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.060.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   2
* EL6501.cbl
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC5 - ACCOUNT MAINT (GENERAL)
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    36*                                ADJUSTED MAP-R REDEFINES FILLER
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38*                          SMVA  ADD CLP TOL PCT CODE
    39* 102004                   PEMA  ADD STATUS OF CANCEL
    40* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    41* 021506  CR2006021400002  PEMA  DARKEN DCC FIELDS FOR CID
    42* 052306  CR2006050800002  PEMA  ADD COMM TYPE J
    43* 111606  CR2002061800017  PEMA  FIX ERCOMP UPDATE ROUTINE
    44* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    45* 031607                   PEMA  PER TRWA AND KLSC DEFAULT TO P
    46* 062707  CR2007010300002  PEMA  REMOVE LEV 5 RESTRICTION FOR DCC
    47* 071207                   PEMA  ADD NEW TYPE 'M'
    48* 080807  CR2006062900001  PEMA  AUTOMATE STEPS TO CANCEL ACCT
    49* 022808  CR2007083100002  PEMA  ADD 'F' ACCT STATUS
    50* 042809    2007070200004  PEMA  ADD EDIT FOR KY ACCOUNTS
    51* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    52* 020210  CR2020010400006  PEMA  REMOVE CHANGES MADE ON 09/09
    53******************************************************************
    54
    55 ENVIRONMENT DIVISION.
    56 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   3
* EL6501.cbl
    58 WORKING-STORAGE SECTION.
    59 01  DFH-START PIC X(04).
    60 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    61 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    62                                   USAGE POINTER.
    63 77  FILLER  PIC X(32)  VALUE '********************************'.
    64 77  FILLER  PIC X(32)  VALUE '*    EL6501 WORKING STORAGE    *'.
    65 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.060 ***********'.
    66 77  WS-LAST-DATE-RANGE-SW       PIC X    VALUE SPACES.
    67     88  ON-LAST-DATE-RANGE             VALUE 'Y'.
    68 77  WS-AUTO-CANCEL-SW           PIC X  VALUE ' '.
    69     88  AUTO-CANCEL-ACCOUNT            VALUE 'Y'.
    70 77  WS-DELAY-INT                PIC S9(7) VALUE +2.
    71 77  WS-CHANGE-ALL-CNT           PIC S999  VALUE +0.
    72 01  WS-DEGUG-AREA.
    73     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    74     05  FILLER PIC X(20) VALUE '  PAGE NUMBER HERE  '.
    75     05  WS-PAGE-NUMBER PIC 99 VALUE ZEROS.
    76     05  FILLER PIC X(20) VALUE '  TOTAL LINES HERE  '.
    77     05  WS-TOTAL-LINES PIC 99 VALUE ZEROS.
    78     05  FILLER PIC X(20) VALUE ' LINE SELECTED HERE '.
    79     05  WS-LINE-SELECTED PIC 99 VALUE ZEROS.
    80     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    81 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1500.
    82 01  WS-DATE-AREA.
    83     12  SAVE-DATE               PIC X(8)    VALUE SPACES.
    84     12  SAVE-BIN-DATE           PIC XX      VALUE SPACES.
    85
    86***DMD CUSTOM CODE *****START
    87     12  WS-DMD-EXPR-DATE        PIC 9(8) COMP-3.
    88     12  WS-DMD-AGENT            PIC X(10).
    89     12  WS-YYYYMMDD             PIC X(8).
    90     12  WS-COMP-DATE REDEFINES WS-YYYYMMDD
    91                                 PIC 9(8).
    92***DMD CUSTOM CODE *****END
    93
    94 01  WS-ACCOUNT-NUM-AREA.
    95     12  WS-ACCOUNT-FILLER       PIC X(06).
    96     12  WS-ACCT-BRANCH-CD       PIC X(04).
    97
    98 01  WS-NAME-AREA.
    99     12  WS-NAME-1-4             PIC X(04).
   100     12  WS-NAME-FILLER          PIC X(26).
   101
   102 01  STANDARD-AREAS.
   103     12  WS-STATE-MAX-SW         PIC X       VALUE ' '.
   104         88  EXCEEDS-STATE-MAX      VALUE 'Y'.
   105     12  WS-RESPONSE             PIC S9(8)   COMP.
   106         88  RESP-NORMAL                  VALUE +00.
   107         88  RESP-NOTFND                  VALUE +13.
   108         88  RESP-DUPREC                  VALUE +14.
   109         88  RESP-DUPKEY                  VALUE +15.
   110         88  RESP-NOTOPEN                 VALUE +19.
   111         88  RESP-ENDFILE                 VALUE +20.
   112
   113     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   114     12  MAP-NAME                PIC X(8)    VALUE 'EL6501A'.
   115     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6501S'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   4
* EL6501.cbl
   116     12  SCREEN-NUMBER           PIC X(4)    VALUE '650B'.
   117     12  TRANS-ID                PIC X(4)    VALUE 'EXC5'.
   118     12  THIS-PGM                PIC X(8)    VALUE 'EL6501'.
   119     12  PGM-NAME                PIC X(8).
   120     12  TIME-IN                 PIC S9(7).
   121     12  TIME-OUT-R REDEFINES TIME-IN.
   122         16  FILLER              PIC X.
   123         16  TIME-OUT            PIC 99V99.
   124         16  FILLER              PIC XX.
   125     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   126     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   127     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   128     12  XCTL-601                PIC X(8)    VALUE 'EL601'.
   129     12  XCTL-608                PIC X(8)    VALUE 'EL608'.
   130     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   131     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   132     12  XCTL-6502               PIC X(8)    VALUE 'EL6502'.
   133     12  XCTL-6503               PIC X(8)    VALUE 'EL6503'.
   134     12  XCTL-6504               PIC X(8)    VALUE 'EL6504'.
   135     12  XCTL-6505               PIC X(8)    VALUE 'EL6505'.
   136     12  XCTL-6506               PIC X(8)    VALUE 'EL6506'.
   137     12  XCTL-652                PIC X(8)    VALUE 'EL652'.
   138     12  XCTL-689                PIC X(8)    VALUE 'EL689'.
   139     12  XCTL-690                PIC X(8)    VALUE 'EL690'.
   140     12  XCTL-653                PIC X(8)    VALUE 'EL653'.
   141     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   142     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   143     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   144     12  FILE-ID                 PIC X(8).
   145     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   146     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   147     12  ERACNT-FILE-ID          PIC X(8)    VALUE 'ERACNT'.
   148     12  REIN-FILE-ID            PIC X(8)    VALUE 'ERREIN'.
   149     12  COMM-FILE-ID            PIC X(8)    VALUE 'ERCTBL'.
   150     12  COMP-FILE-ID            PIC X(8)    VALUE 'ERCOMP'.
   151     12  NAME-FILE-ID            PIC X(8)    VALUE 'ERNAME'.
   152     12  RQST-FILE-ID            PIC X(8)    VALUE 'ERRQST'.
   153     12  RQST3-FILE-ID           PIC X(8)    VALUE 'ERRQST3'.
   154     12  ERGXRF-FILE-ID          PIC X(8)    VALUE 'ERGXRF'.
   155     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   156     12  ERACNT-REC-LEN          PIC S9(4)   VALUE +120   COMP.
   157     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   158     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   159     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   160     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   161     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   162     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   163     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   164     12  CNTL-REC-LEN            PIC S9(4)   VALUE +750   COMP.
   165     12  JRNL-REC-LEN            PIC S9(4)   VALUE ZERO   COMP.
   166*                                copy ERCGXRF.
   167******************************************************************
   168*                                                                *
   169*                                                                *
   170*                            ERCGXRF                             *
   171*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   172*                            VMOD=2.002                          *
   173*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   5
* EL6501.cbl
   174*   ONLINE CREDIT SYSTEM                                         *
   175*                                                                *
   176*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   177*                                                                *
   178*   FILE TYPE = VSAM,KSDS                                        *
   179*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   180*                                                                *
   181*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   182*       ALTERNATE PATH = NONE                                    *
   183*                                                                *
   184*   LOG = NO                                                     *
   185*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   186*                                                                *
   187******************************************************************
   188
   189 01  AGENT-CROSS-REFERENCE.
   190     12  GX-RECORD-ID                PIC XX.
   191         88  VALID-GX-ID             VALUE 'GX'.
   192
   193     12  GX-CONTROL-PRIMARY.
   194         16  GX-COMPANY-CD           PIC X.
   195         16  GX-CARRIER              PIC X.
   196         16  GX-GROUPING             PIC X(6).
   197         16  GX-AGENT-NO             PIC X(10).
   198
   199     12  GX-MAINT-INFORMATION.
   200         16  GX-LAST-MAINT-DT        PIC XX.
   201         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   202         16  GX-LAST-MAINT-USER      PIC X(4).
   203         16  FILLER                  PIC X(9).
   204
   205     12  FILLER                      PIC X(37).
   206
   207     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   208
   209     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   210                            DEPENDING ON GX-AGENT-POINTER-CNT.
   211         16  GX-AM-CARRIER           PIC X.
   212         16  GX-AM-GROUPING          PIC X(6).
   213         16  GX-AM-STATE             PIC XX.
   214         16  GX-AM-ACCOUNT           PIC X(10).
   215         16  GX-AM-EXPIRATION-DT     PIC XX.
   216         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   217         16  GX-LAST-BILL-DT         PIC XX.
   218         16  GX-AM-EFF-DT            PIC XX.
   219         16  FILLER                  PIC X(4).
   220
   221******************************************************************
   222 01  WORK-AREAS-AND-SWITCHES.
   223     12  W-ONE                   PIC S9(04)  COMP   VALUE +1.
   224     12  WS-TABLE-MAX            PIC S9V9(4) COMP-3 VALUE +0.
   225     12  WS-ST-COMMISSION-CAPS.
   226         16  WS-ST-COMM-CAP-SL   PIC S9V9(4) COMP-3 VALUE +0.
   227         16  WS-ST-COMM-CAP-JL   PIC S9V9(4) COMP-3 VALUE +0.
   228         16  WS-ST-COMM-CAP-SA   PIC S9V9(4) COMP-3 VALUE +0.
   229         16  WS-ST-COMM-CAP-JA   PIC S9V9(4) COMP-3 VALUE +0.
   230     12  WS-COMM-CAP-LIMIT-TO    PIC X.
   231         88  WS-LIMIT-TO-ACCOUNT             VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   6
* EL6501.cbl
   232
   233     12  COMMISSION-ACCUMS.
   234         16  COMM-SL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   235         16  COMM-JL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   236         16  COMM-AH-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   237
   238     12  SAVE-FIN-RESP           PIC X(10)   VALUE SPACES.
   239     12  SAVE-ACCT-AGENT         PIC X(10)   VALUE SPACES.
   240     12  SAVE-NEW-ACCT-AGENT     PIC X(10)   VALUE SPACES.
   241     12  SUB1                    PIC S9(4)   VALUE +0 COMP.
   242     12  WS-NDX                  PIC S9(5)   VALUE +0 COMP-3.
   243     12  CURRENT-SAVE            PIC 9(8).
   244     12  BIN-CURRENT-SAVE        PIC XX.
   245     12  CYMD-CURRENT-SAVE       PIC 9(8).
   246     12  SUB                     PIC 99.
   247     12  AGT-SUB                 PIC 99      VALUE ZEROS.
   248     12  VALID-AGT-SW            PIC X       VALUE 'N'.
   249     12  CHANGE-WAS-MADE-SW      PIC X       VALUE 'N'.
   250         88  CHANGE-WAS-MADE                 VALUE 'Y'.
   251
   252     12  WS-EDIT-BEN-CODE        PIC XX.
   253         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   254                                          '90' THRU '99'.
   255
   256     12  WS-KEY-SAVE.
   257           18  WS-ACCT-CCGSA-KEY.
   258             20  WS-ACCT-CO             PIC X.
   259             20  WS-ACCT-CARRIER        PIC X.
   260             20  WS-ACCT-GROUPING       PIC X(6).
   261             20  WS-ACCT-STATE          PIC XX.
   262             20  WS-ACCT-ACCOUNT        PIC X(10).
   263           18  WS-ACCT-EXP-DT           PIC XX.
   264           18  WS-ACCT-REST-OF-EXP      PIC X(4).
   265
   266     12  DEEDIT-FIELD                   PIC X(15).
   267     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   268     12  DEEDIT-FIELD-V1 REDEFINES DEEDIT-FIELD   PIC S9(14)V9.
   269     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(13)V99.
   270     12  DEEDIT-FIELD-V5 REDEFINES DEEDIT-FIELD   PIC S9(10)V9(5).
   271     12  DEEDIT-FIELD-V6 REDEFINES DEEDIT-FIELD   PIC S9(9)V9(6).
   272
   273     12  ELCNTL-KEY.
   274         16  CNTL-COMP-ID        PIC XXX.
   275         16  CNTL-REC-TYPE       PIC X.
   276         16  CNTL-ACCESS.
   277             20  FILLER          PIC X(4).
   278         16  CNTL-BUS REDEFINES CNTL-ACCESS.
   279             20  FILLER          PIC XX.
   280             20  CNTL-BUS-TYPE   PIC XX.
   281         16  CNTL-BEN REDEFINES CNTL-ACCESS.
   282             20  FILLER          PIC XX.
   283             20  CNTL-BEN-TYPE   PIC XX.
   284         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   285
   286     12  REIN-KEY.
   287         16  REIN-COMP-CD        PIC X.
   288         16  REIN-CODE           PIC X.
   289         16  REIN-TABLE          PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   7
* EL6501.cbl
   290         16  FILLER              PIC X(3).
   291
   292     12  WS-HOLD-COMM-KEY        PIC X(7) VALUE LOW-VALUES.
   293     12  COMM-KEY.
   294         16  COMM-COMP-CD        PIC X.
   295         16  COMM-TABLE          PIC XXX.
   296         16  COMM-LF-AH          PIC X.
   297         16  COMM-FILLER         PIC XX    VALUE LOW-VALUES.
   298
   299     12  RQST-KEY.
   300         16  RQST-COMPANY-CD     PIC X     VALUE SPACES.
   301         16  RQST-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   302
   303     12  RQST3-KEY.
   304         16  RQST3-COMPANY-CD    PIC X     VALUE SPACES.
   305         16  RQST3-CARRIER       PIC X     VALUE SPACES.
   306         16  RQST3-GROUPING      PIC X(6)  VALUE SPACES.
   307         16  RQST3-FIN-RESP      PIC X(10) VALUE SPACES.
   308         16  RQST3-ACCT-AGENT    PIC X(10) VALUE SPACES.
   309         16  RQST3-REFERENCE     PIC X(12) VALUE SPACES.
   310         16  RQST3-BATCH         PIC X(6)  VALUE SPACES.
   311
   312     12  SAVE-RQST3-KEY.
   313         16  FILLER              PIC X     VALUE SPACES.
   314         16  FILLER              PIC X     VALUE SPACES.
   315         16  FILLER              PIC X(6)  VALUE SPACES.
   316         16  FILLER              PIC X(10) VALUE SPACES.
   317         16  FILLER              PIC X(10) VALUE SPACES.
   318         16  FILLER              PIC X(12) VALUE SPACES.
   319         16  FILLER              PIC X(6)  VALUE SPACES.
   320
   321     12  COMP-KEY.
   322         16  COMP-COMPANY-CD     PIC X.
   323         16  COMP-CARRIER        PIC X.
   324         16  COMP-GROUPING       PIC X(6).
   325         16  COMP-RESP-NO        PIC X(10).
   326         16  COMP-ACCOUNT        PIC X(10).
   327         16  COMP-TYPE           PIC X.
   328
   329     12  WS-AXRF-KEY.
   330         16  WS-AXRF-COMPANY-CD  PIC X.
   331         16  WS-AXRF-CARRIER     PIC X.
   332         16  WS-AXRF-GROUPING    PIC X(6).
   333         16  WS-AXRF-AGENT-NO    PIC X(10).
   334
   335     12  GX-AM-CONTROL-PRIMARY.
   336         16  GX-AM-COMPANY-CD    PIC X.
   337         16  GX-REST-OF-KEY      PIC X(20).
   338
   339     12  QID.
   340         16  QID-TERM            PIC X(4).
   341         16  FILLER              PIC X(4)    VALUE '6501'.
   342
   343     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   344         88  BROWSE-STARTED         VALUE 'Y'.
   345     12  FIRST-TIME-SW           PIC X       VALUE ' '.
   346         88  FIRST-TIME             VALUE 'Y'.
   347
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   8
* EL6501.cbl
   348     12  AXRF-SUB                PIC S9(4)  COMP VALUE ZEROS.
   349     12  GX-AGENT-SUB            PIC S9(4)  COMP VALUE ZEROS.
   350     12  COMM-WORK-SUB           PIC S9(4)  COMP VALUE ZEROS.
   351     12  FIND-AGENT-SUB1         PIC S9(4)  COMP VALUE ZEROS.
   352     12  FIND-AGENT-SUB2         PIC S9(4)  COMP VALUE ZEROS.
   353     12  FIND-AGENT-SUB3         PIC S9(4)  COMP VALUE ZEROS.
   354     12  GETMAIN-SW              PIC X       VALUE SPACES.
   355     12  COMMISSION-GETMAIN-SW   PIC X       VALUE SPACES.
   356         88  GETMAIN-ACQUIRED                VALUE 'X'.
   357
   358     12  ER-0000                 PIC X(4)    VALUE '0000'.
   359     12  ER-0002                 PIC X(4)    VALUE '0002'.
   360     12  ER-0004                 PIC X(4)    VALUE '0004'.
   361     12  ER-0008                 PIC X(4)    VALUE '0008'.
   362     12  ER-0023                 PIC X(4)    VALUE '0023'.
   363     12  ER-0029                 PIC X(4)    VALUE '0029'.
   364     12  ER-0033                 PIC X(4)    VALUE '0033'.
   365     12  ER-0070                 PIC X(4)    VALUE '0070'.
   366     12  ER-0144                 PIC X(4)    VALUE '0144'.
   367     12  ER-0250                 PIC X(4)    VALUE '0250'.
   368     12  ER-0348                 PIC X(4)    VALUE '0348'.
   369     12  ER-0454                 PIC X(4)    VALUE '0454'.
   370     12  ER-0625                 PIC X(4)    VALUE '0625'.
   371     12  ER-0759                 PIC X(4)    VALUE '0759'.
   372     12  ER-0788                 PIC X(4)    VALUE '0788'.
   373     12  ER-0852                 PIC X(4)    VALUE '0852'.
   374     12  ER-0899                 PIC X(4)    VALUE '0899'.
   375     12  ER-1778                 PIC X(4)    VALUE '1778'.
   376     12  ER-1883                 PIC X(4)    VALUE '1883'.
   377     12  ER-1884                 PIC X(4)    VALUE '1884'.
   378     12  ER-1885                 PIC X(4)    VALUE '1885'.
   379     12  ER-1886                 PIC X(4)    VALUE '1886'.
   380     12  ER-1887                 PIC X(4)    VALUE '1887'.
   381     12  ER-2045                 PIC X(4)    VALUE '2045'.
   382     12  ER-2071                 PIC X(4)    VALUE '2071'.
   383     12  ER-2131                 PIC X(4)    VALUE '2131'.
   384*    12  ER-3057                 PIC X(4)    VALUE '3057'.
   385     12  ER-2151                 PIC X(4)    VALUE '2151'.
   386     12  ER-2152                 PIC X(4)    VALUE '2152'.
   387     12  ER-2153                 PIC X(4)    VALUE '2153'.
   388     12  ER-2154                 PIC X(4)    VALUE '2154'.
   389     12  ER-2155                 PIC X(4)    VALUE '2155'.
   390     12  ER-2156                 PIC X(4)    VALUE '2156'.
   391     12  ER-2157                 PIC X(4)    VALUE '2157'.
   392     12  ER-2158                 PIC X(4)    VALUE '2158'.
   393     12  ER-2159                 PIC X(4)    VALUE '2159'.
   394     12  ER-2160                 PIC X(4)    VALUE '2160'.
   395     12  ER-2165                 PIC X(4)    VALUE '2165'.
   396     12  ER-2168                 PIC X(4)    VALUE '2168'.
   397     12  ER-2169                 PIC X(4)    VALUE '2169'.
   398     12  ER-2170                 PIC X(4)    VALUE '2170'.
   399     12  ER-2172                 PIC X(4)    VALUE '2172'.
   400     12  ER-2173                 PIC X(4)    VALUE '2173'.
   401     12  ER-2174                 PIC X(4)    VALUE '2174'.
   402     12  ER-2175                 PIC X(4)    VALUE '2175'.
   403     12  ER-2176                 PIC X(4)    VALUE '2176'.
   404     12  ER-2177                 PIC X(4)    VALUE '2177'.
   405     12  ER-2178                 PIC X(4)    VALUE '2178'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   9
* EL6501.cbl
   406     12  ER-2179                 PIC X(4)    VALUE '2179'.
   407     12  ER-2180                 PIC X(4)    VALUE '2180'.
   408     12  ER-2181                 PIC X(4)    VALUE '2181'.
   409     12  ER-2182                 PIC X(4)    VALUE '2182'.
   410     12  ER-2183                 PIC X(4)    VALUE '2183'.
   411     12  ER-2189                 PIC X(4)    VALUE '2189'.
   412     12  ER-2572                 PIC X(4)    VALUE '2572'.
   413     12  ER-2615                 PIC X(4)    VALUE '2615'.
   414     12  ER-2949                 PIC X(4)    VALUE '2949'.
   415     12  ER-2970                 PIC X(4)    VALUE '2970'.
   416     12  ER-4009                 PIC X(4)    VALUE '4009'.
   417     12  ER-4010                 PIC X(4)    VALUE '4010'.
   418     12  ER-4011                 PIC X(4)    VALUE '4011'.
   419     12  ER-4012                 PIC X(4)    VALUE '4012'.
   420     12  ER-9999                 PIC X(4)    VALUE '9999'.
   421     12  ER-XXXX                 PIC X(4)    VALUE 'XXXX'.
   422
   423     12  WSS-LINE-LIAB-LIMITS.
   424         16  WSS-LF-LIMITS.
   425             20  WSS-L-TYPE          PIC  XX    VALUE SPACES.
   426             20  WSS-LF-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   427             20  WSS-L-LIMITS        OCCURS 4 TIMES.
   428                 24  WSS-LF-LM-AGE   PIC S99     COMP-3.
   429                 24  WSS-LF-LM-DUR   PIC S999    COMP-3.
   430                 24  WSS-LF-LM-AMT   PIC S9(6)   COMP-3.
   431         16  WSS-AH-LIMITS.
   432             20  WSS-A-TYPE          PIC  XX    VALUE SPACES.
   433             20  WSS-AH-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   434             20  WSS-A-LIMITS        OCCURS 4 TIMES.
   435                 24  WSS-AH-LM-AGE   PIC S99     COMP-3.
   436                 24  WSS-AH-LM-DUR   PIC S999    COMP-3.
   437                 24  WSS-AH-LM-MOA   PIC S9(4)   COMP-3.
   438                 24  WSS-AH-LM-AMT   PIC S9(6)   COMP-3.
   439
   440     12  WSS-COMM-STRUCTURE.
   441         16  WSS-DEFN-1.
   442             20  WSS-AGT-COMMS.
   443                 24  WSS-AGT     PIC  X(10)   VALUE SPACES.
   444                 24  WSS-COM-TYP PIC  X       VALUE SPACES.
   445                 24  WSS-L-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   446                 24  WSS-J-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   447                 24  WSS-A-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   448                 24  FILLER      PIC X(6)     VALUE SPACES.
   449
   450     12  WS-PHONE.
   451         16  WS-PH1              PIC XXX.
   452         16  WS-PH2              PIC XXX.
   453         16  WS-PH3              PIC XXXX.
   454     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   455
   456     12  WS-LIFE-PSI             PIC S9V9(6)  VALUE +0    COMP-3.
   457     12  WS-AH-PSI               PIC S9V9(6)  VALUE +0    COMP-3.
   458     12  WS-ACCOUNT-CTR-C        PIC 99       VALUE ZEROS COMP-3.
   459     12  WS-ACCOUNT-CTR-R        PIC 99       VALUE ZEROS COMP-3.
   460     12  WS-ACCOUNT-CTR-D        PIC 99       VALUE ZEROS COMP-3.
   461     12  WS-BUS-TYPE             PIC 99.
   462     12  WS-BUS-ENTRY            PIC 99.
   463     12  WS-ANVR-DT              PIC 9(11)    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  10
* EL6501.cbl
   464     12  WS-PEFF-DT              PIC 9(11)    VALUE ZEROS.
   465     12  WS-PEXP-DT              PIC 9(11)    VALUE ZEROS.
   466     12  WS-TOL-PREM             PIC S999V99  VALUE ZEROS.
   467     12  WS-TOL-REF              PIC S999V99  VALUE ZEROS.
   468     12  WS-TOL-CLM              PIC S999V99  VALUE ZEROS.
   469     12  WS-COMM-ERROR-SW        PIC 9   COMP-3.
   470         88  COMMISSION-ERROR    VALUE 1.
   471     12  WS-JTYPEID              PIC XX       VALUE SPACES.
   472     12  AGENT-FIND              PIC X        VALUE SPACES.
   473         88  AGENT-RECORD-NOT-FOUND           VALUE 'X'.
   474         88  ACCT-RECORD-NOT-FOUND            VALUE 'Y'.
   475         88  ACCT-LEVEL-DIFFERENT             VALUE 'Z'.
   476
   477     12  WS-ZIP-CODE.
   478         16  WS-ZIP-1            PIC X.
   479             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   480         16  WS-ZIP-2-3          PIC XX.
   481         16  WS-ZIP-4            PIC X.
   482         16  WS-ZIP-5            PIC X.
   483         16  WS-ZIP-6            PIC X.
   484         16  FILLER              PIC X(4).
   485     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   486         16  WS-ZIP-AM-1-CODE    PIC X(5).
   487         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   488         16  FILLER              PIC X.
   489     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   490         16  WS-ZIP-AM-2-CODE    PIC X(5).
   491         16  WS-ZIP-AM-2-DASH    PIC X.
   492         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   493     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   494         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   495         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   496         16  FILLER              PIC X(4).
   497     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   498         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   499         16  FILLER              PIC X.
   500         16  WS-ZIP-CAN-2-POST2  PIC XXX.
   501         16  FILLER              PIC XXX.
   502     12  WS-SOC-SEC-WORK.
   503         16  WS-SS-TYPE          PIC X.
   504         16  WS-SOC-SEC          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  11
* EL6501.cbl
   506*    COPY ELCSCTM.
   507******************************************************************
   508*                                                                *
   509*                                                                *
   510*                            ELCSCTM                             *
   511*                            VMOD=2.001                          *
   512*                                                                *
   513*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   514*                                                                *
   515******************************************************************
   516 01  SECURITY-MESSAGE.
   517     12  FILLER                          PIC X(30)
   518            VALUE '** LOGIC SECURITY VIOLATION -'.
   519     12  SM-READ                         PIC X(6).
   520     12  FILLER                          PIC X(5)
   521            VALUE ' PGM='.
   522     12  SM-PGM                          PIC X(6).
   523     12  FILLER                          PIC X(5)
   524            VALUE ' OPR='.
   525     12  SM-PROCESSOR-ID                 PIC X(4).
   526     12  FILLER                          PIC X(6)
   527            VALUE ' TERM='.
   528     12  SM-TERMID                       PIC X(4).
   529     12  FILLER                          PIC XX   VALUE SPACE.
   530     12  SM-JUL-DATE                     PIC 9(5).
   531     12  FILLER                          PIC X    VALUE SPACE.
   532     12  SM-TIME                         PIC 99.99.
   533
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  12
* EL6501.cbl
   535*    COPY ELCSCRTY.
   536******************************************************************
   537*                                                                *
   538*                                                                *
   539*                            ELCSCRTY                            *
   540*                            VMOD=2.001                          *
   541*                                                                *
   542*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   543*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   544*        SAVED IN PI-SECURITY-ADDRESS.                           *
   545*                                                                *
   546******************************************************************
   547 01  SECURITY-CONTROL.
   548     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   549     12  FILLER                       PIC XX    VALUE 'SC'.
   550     12  SC-CREDIT-CODES.
   551         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   552             20  SC-CREDIT-DISPLAY    PIC X.
   553             20  SC-CREDIT-UPDATE     PIC X.
   554     12  SC-CLAIMS-CODES.
   555         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   556             20  SC-CLAIMS-DISPLAY    PIC X.
   557             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  13
* EL6501.cbl
   559*    COPY ELCLOGOF.
   560******************************************************************
   561*                                                                *
   562*                                                                *
   563*                            ELCLOGOF.                           *
   564*                            VMOD=2.001                          *
   565*                                                                *
   566*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   567*                                                                *
   568******************************************************************
   569 01  CLASIC-LOGOFF.
   570     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   571     12  LOGOFF-TEXT.
   572         16  FILLER          PIC X(5)    VALUE SPACES.
   573         16  LOGOFF-MSG.
   574             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   575             20  FILLER      PIC X       VALUE SPACES.
   576             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   577         16  FILLER          PIC X(80)
   578           VALUE '* YOU ARE NOW LOGGED OFF'.
   579         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   580         16  FILLER          PIC X       VALUE QUOTE.
   581         16  LOGOFF-SYS-MSG  PIC X(17)
   582           VALUE 'S CLAS-IC SYSTEM '.
   583     12  TEXT-MESSAGES.
   584         16  UNACCESS-MSG    PIC X(29)
   585             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   586         16  PGMIDERR-MSG    PIC X(17)
   587             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  14
* EL6501.cbl
   589*    COPY ELCDATE.
   590******************************************************************
   591*                                                                *
   592*                                                                *
   593*                            ELCDATE.                            *
   594*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   595*                            VMOD=2.003
   596*                                                                *
   597*                                                                *
   598*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   599*                 LENGTH = 200                                   *
   600******************************************************************
   601
   602 01  DATE-CONVERSION-DATA.
   603     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   604     12  DC-OPTION-CODE                PIC X.
   605         88  BIN-TO-GREG                VALUE ' '.
   606         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   607         88  EDIT-GREG-TO-BIN           VALUE '2'.
   608         88  YMD-GREG-TO-BIN            VALUE '3'.
   609         88  MDY-GREG-TO-BIN            VALUE '4'.
   610         88  JULIAN-TO-BIN              VALUE '5'.
   611         88  BIN-PLUS-ELAPSED           VALUE '6'.
   612         88  FIND-CENTURY               VALUE '7'.
   613         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   614         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   615         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   616         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   617         88  JULIAN-TO-BIN-3            VALUE 'C'.
   618         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   619         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   620         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   621         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   622         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   623         88  CHECK-LEAP-YEAR            VALUE 'H'.
   624         88  BIN-3-TO-GREG              VALUE 'I'.
   625         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   626         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   627         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   628         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   629         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   630         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   631         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   632         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   633         88  THREE-CHARACTER-BIN
   634                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   635         88  GREGORIAN-TO-BIN
   636                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   637         88  BIN-TO-GREGORIAN
   638                  VALUES ' ' '1' 'I' '8' 'G'.
   639         88  JULIAN-TO-BINARY
   640                  VALUES '5' 'C' 'E' 'F'.
   641     12  DC-ERROR-CODE                 PIC X.
   642         88  NO-CONVERSION-ERROR        VALUE ' '.
   643         88  DATE-CONVERSION-ERROR
   644                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   645         88  DATE-IS-ZERO               VALUE '1'.
   646         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  15
* EL6501.cbl
   647         88  DATE-IS-INVALID            VALUE '3'.
   648         88  DATE1-GREATER-DATE2        VALUE '4'.
   649         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   650         88  DATE-INVALID-OPTION        VALUE '9'.
   651         88  INVALID-CENTURY            VALUE 'A'.
   652         88  ONLY-CENTURY               VALUE 'B'.
   653         88  ONLY-LEAP-YEAR             VALUE 'C'.
   654         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   655     12  DC-END-OF-MONTH               PIC X.
   656         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   657     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   658         88  USE-NORMAL-PROCESS         VALUE ' '.
   659         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   660         88  ADJUST-UP-100-YRS          VALUE '2'.
   661     12  FILLER                        PIC X.
   662     12  DC-CONVERSION-DATES.
   663         16  DC-BIN-DATE-1             PIC XX.
   664         16  DC-BIN-DATE-2             PIC XX.
   665         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   666         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   667                       DC-GREG-DATE-1-EDIT.
   668             20  DC-EDIT1-MONTH        PIC 99.
   669             20  SLASH1-1              PIC X.
   670             20  DC-EDIT1-DAY          PIC 99.
   671             20  SLASH1-2              PIC X.
   672             20  DC-EDIT1-YEAR         PIC 99.
   673         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   674         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   675                     DC-GREG-DATE-2-EDIT.
   676             20  DC-EDIT2-MONTH        PIC 99.
   677             20  SLASH2-1              PIC X.
   678             20  DC-EDIT2-DAY          PIC 99.
   679             20  SLASH2-2              PIC X.
   680             20  DC-EDIT2-YEAR         PIC 99.
   681         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   682         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   683                     DC-GREG-DATE-1-YMD.
   684             20  DC-YMD-YEAR           PIC 99.
   685             20  DC-YMD-MONTH          PIC 99.
   686             20  DC-YMD-DAY            PIC 99.
   687         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   688         16  DC-GREG-DATE-1-MDY-R REDEFINES
   689                      DC-GREG-DATE-1-MDY.
   690             20  DC-MDY-MONTH          PIC 99.
   691             20  DC-MDY-DAY            PIC 99.
   692             20  DC-MDY-YEAR           PIC 99.
   693         16  DC-GREG-DATE-1-ALPHA.
   694             20  DC-ALPHA-MONTH        PIC X(10).
   695             20  DC-ALPHA-DAY          PIC 99.
   696             20  FILLER                PIC XX.
   697             20  DC-ALPHA-CENTURY.
   698                 24 DC-ALPHA-CEN-N     PIC 99.
   699             20  DC-ALPHA-YEAR         PIC 99.
   700         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   701         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   702         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   703         16  DC-JULIAN-DATE            PIC 9(05).
   704         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  16
* EL6501.cbl
   705                                       PIC 9(05).
   706         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   707             20  DC-JULIAN-YEAR        PIC 99.
   708             20  DC-JULIAN-DAYS        PIC 999.
   709         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   710         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   711         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   712     12  DATE-CONVERSION-VARIBLES.
   713         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   714         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   715             20  FILLER                PIC 9(3).
   716             20  HOLD-CEN-1-CCYY.
   717                 24  HOLD-CEN-1-CC     PIC 99.
   718                 24  HOLD-CEN-1-YY     PIC 99.
   719             20  HOLD-CEN-1-MO         PIC 99.
   720             20  HOLD-CEN-1-DA         PIC 99.
   721         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   722             20  HOLD-CEN-1-R-MO       PIC 99.
   723             20  HOLD-CEN-1-R-DA       PIC 99.
   724             20  HOLD-CEN-1-R-CCYY.
   725                 24  HOLD-CEN-1-R-CC   PIC 99.
   726                 24  HOLD-CEN-1-R-YY   PIC 99.
   727             20  FILLER                PIC 9(3).
   728         16  HOLD-CENTURY-1-X.
   729             20  FILLER                PIC X(3)  VALUE SPACES.
   730             20  HOLD-CEN-1-X-CCYY.
   731                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   732                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   733             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   734             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   735         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   736             20  HOLD-CEN-1-R-X-MO     PIC XX.
   737             20  HOLD-CEN-1-R-X-DA     PIC XX.
   738             20  HOLD-CEN-1-R-X-CCYY.
   739                 24  HOLD-CEN-1-R-X-CC PIC XX.
   740                 24  HOLD-CEN-1-R-X-YY PIC XX.
   741             20  FILLER                PIC XXX.
   742         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   743         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   744         16  DC-JULIAN-DATE-1          PIC 9(07).
   745         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   746             20  DC-JULIAN-1-CCYY.
   747                 24  DC-JULIAN-1-CC    PIC 99.
   748                 24  DC-JULIAN-1-YR    PIC 99.
   749             20  DC-JULIAN-DA-1        PIC 999.
   750         16  DC-JULIAN-DATE-2          PIC 9(07).
   751         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   752             20  DC-JULIAN-2-CCYY.
   753                 24  DC-JULIAN-2-CC    PIC 99.
   754                 24  DC-JULIAN-2-YR    PIC 99.
   755             20  DC-JULIAN-DA-2        PIC 999.
   756         16  DC-GREG-DATE-A-EDIT.
   757             20  DC-EDITA-MONTH        PIC 99.
   758             20  SLASHA-1              PIC X VALUE '/'.
   759             20  DC-EDITA-DAY          PIC 99.
   760             20  SLASHA-2              PIC X VALUE '/'.
   761             20  DC-EDITA-CCYY.
   762                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  17
* EL6501.cbl
   763                 24  DC-EDITA-YEAR     PIC 99.
   764         16  DC-GREG-DATE-B-EDIT.
   765             20  DC-EDITB-MONTH        PIC 99.
   766             20  SLASHB-1              PIC X VALUE '/'.
   767             20  DC-EDITB-DAY          PIC 99.
   768             20  SLASHB-2              PIC X VALUE '/'.
   769             20  DC-EDITB-CCYY.
   770                 24  DC-EDITB-CENT     PIC 99.
   771                 24  DC-EDITB-YEAR     PIC 99.
   772         16  DC-GREG-DATE-CYMD         PIC 9(08).
   773         16  DC-GREG-DATE-CYMD-R REDEFINES
   774                              DC-GREG-DATE-CYMD.
   775             20  DC-CYMD-CEN           PIC 99.
   776             20  DC-CYMD-YEAR          PIC 99.
   777             20  DC-CYMD-MONTH         PIC 99.
   778             20  DC-CYMD-DAY           PIC 99.
   779         16  DC-GREG-DATE-MDCY         PIC 9(08).
   780         16  DC-GREG-DATE-MDCY-R REDEFINES
   781                              DC-GREG-DATE-MDCY.
   782             20  DC-MDCY-MONTH         PIC 99.
   783             20  DC-MDCY-DAY           PIC 99.
   784             20  DC-MDCY-CEN           PIC 99.
   785             20  DC-MDCY-YEAR          PIC 99.
   786    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   787        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   788    12  DC-EL310-DATE                  PIC X(21).
   789    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  18
* EL6501.cbl
   791*    COPY ELCATTR.
   792******************************************************************
   793*                                                                *
   794*                            ELCATTR.                            *
   795*                            VMOD=2.001                          *
   796*                                                                *
   797*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   798*                                                                *
   799*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   800*                                                                *
   801*                   POS 1   P=PROTECTED                          *
   802*                           U=UNPROTECTED                        *
   803*                           S=ASKIP                              *
   804*                   POS 2   A=ALPHA/NUMERIC                      *
   805*                           N=NUMERIC                            *
   806*                   POS 3   N=NORMAL                             *
   807*                           B=BRIGHT                             *
   808*                           D=DARK                               *
   809*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   810*                           OF=MODIFIED DATA TAG OFF             *
   811*                                                                *
   812*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   813******************************************************************
   814 01  ATTRIBUTE-LIST.
   815     12  AL-PABOF            PIC X       VALUE 'Y'.
   816     12  AL-PABON            PIC X       VALUE 'Z'.
   817     12  AL-PADOF            PIC X       VALUE '%'.
   818     12  AL-PADON            PIC X       VALUE '_'.
   819     12  AL-PANOF            PIC X       VALUE '-'.
   820     12  AL-PANON            PIC X       VALUE '/'.
   821     12  AL-SABOF            PIC X       VALUE '8'.
   822     12  AL-SABON            PIC X       VALUE '9'.
   823     12  AL-SADOF            PIC X       VALUE '@'.
   824     12  AL-SADON            PIC X       VALUE QUOTE.
   825     12  AL-SANOF            PIC X       VALUE '0'.
   826     12  AL-SANON            PIC X       VALUE '1'.
   827     12  AL-UABOF            PIC X       VALUE 'H'.
   828     12  AL-UABON            PIC X       VALUE 'I'.
   829     12  AL-UADOF            PIC X       VALUE '<'.
   830     12  AL-UADON            PIC X       VALUE '('.
   831     12  AL-UANOF            PIC X       VALUE ' '.
   832     12  AL-UANON            PIC X       VALUE 'A'.
   833     12  AL-UNBOF            PIC X       VALUE 'Q'.
   834     12  AL-UNBON            PIC X       VALUE 'R'.
   835     12  AL-UNDOF            PIC X       VALUE '*'.
   836     12  AL-UNDON            PIC X       VALUE ')'.
   837     12  AL-UNNOF            PIC X       VALUE '&'.
   838     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  19
* EL6501.cbl
   840*    COPY ELCEMIB.
   841******************************************************************
   842*                                                                *
   843*                                                                *
   844*                            ELCEMIB.                            *
   845*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   846*                            VMOD=2.005                          *
   847*                                                                *
   848*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   849*                                                                *
   850******************************************************************
   851 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   852     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   853     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   854     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   855     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   856     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   857     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   858     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   859     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   860     12  EMI-SWITCH1             PIC X        VALUE '1'.
   861         88  EMI-NO-ERRORS                    VALUE '1'.
   862         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   863         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   864     12  EMI-SWITCH2             PIC X        VALUE '1'.
   865         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   866     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   867         88  EMI-AREA1-EMPTY                  VALUE '1'.
   868         88  EMI-AREA1-FULL                   VALUE '2'.
   869     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   870         88  EMI-AREA2-EMPTY                  VALUE '1'.
   871         88  EMI-AREA2-FULL                   VALUE '2'.
   872     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   873         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   874         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   875         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   876         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   877         88  EMI-BYPASS-FATALS                VALUE 'X'.
   878     12  EMI-ERROR-LINES.
   879         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   880         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   881         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   882         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   883             20  EMI-ERR-CODES OCCURS 10 TIMES.
   884                 24  EMI-ERR-NUM         PIC X(4).
   885                 24  EMI-FILLER          PIC X.
   886                 24  EMI-SEV             PIC X.
   887                 24  FILLER              PIC X.
   888             20  FILLER                  PIC X(02).
   889     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   890         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   891             20  EMI-ERROR-NUMBER    PIC X(4).
   892             20  EMI-FILL            PIC X.
   893             20  EMI-SEVERITY        PIC X.
   894             20  FILLER              PIC X.
   895             20  EMI-ERROR-TEXT.
   896                 24  EMI-TEXT-VARIABLE   PIC X(10).
   897                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  20
* EL6501.cbl
   898     12  EMI-SEVERITY-SAVE           PIC X.
   899         88  EMI-NOTE                    VALUE 'N'.
   900         88  EMI-WARNING                 VALUE 'W'.
   901         88  EMI-FORCABLE                VALUE 'F'.
   902         88  EMI-FATAL                   VALUE 'X'.
   903     12  EMI-MESSAGE-FLAG            PIC X.
   904         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   905         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   906     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   907     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   908         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   909         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   910         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   911     12  FILLER                      PIC X(137)  VALUE SPACES.
   912     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   913     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   914     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   915     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  21
* EL6501.cbl
   917*    COPY ELCINTF.
   918******************************************************************
   919*                                                                *
   920*                                                                *
   921*                            ELCINTF.                            *
   922*                            VMOD=2.017                          *
   923*                                                                *
   924*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   925*                                                                *
   926*       LENGTH = 1024                                            *
   927*                                                                *
   928******************************************************************
   929 01  PROGRAM-INTERFACE-BLOCK.
   930     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   931     12  PI-CALLING-PROGRAM              PIC X(8).
   932     12  PI-SAVED-PROGRAM-1              PIC X(8).
   933     12  PI-SAVED-PROGRAM-2              PIC X(8).
   934     12  PI-SAVED-PROGRAM-3              PIC X(8).
   935     12  PI-SAVED-PROGRAM-4              PIC X(8).
   936     12  PI-SAVED-PROGRAM-5              PIC X(8).
   937     12  PI-SAVED-PROGRAM-6              PIC X(8).
   938     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   939     12  PI-COMPANY-ID                   PIC XXX.
   940     12  PI-COMPANY-CD                   PIC X.
   941
   942     12  PI-COMPANY-PASSWORD             PIC X(8).
   943
   944     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   945
   946     12  PI-CONTROL-IN-PROGRESS.
   947         16  PI-CARRIER                  PIC X.
   948         16  PI-GROUPING                 PIC X(6).
   949         16  PI-STATE                    PIC XX.
   950         16  PI-ACCOUNT                  PIC X(10).
   951         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   952                                         PIC X(10).
   953         16  PI-CLAIM-CERT-GRP.
   954             20  PI-CLAIM-NO             PIC X(7).
   955             20  PI-CERT-NO.
   956                 25  PI-CERT-PRIME       PIC X(10).
   957                 25  PI-CERT-SFX         PIC X.
   958             20  PI-CERT-EFF-DT          PIC XX.
   959         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   960             20  PI-PLAN-CODE            PIC X(2).
   961             20  PI-REVISION-NUMBER      PIC X(3).
   962             20  PI-PLAN-EFF-DT          PIC X(2).
   963             20  PI-PLAN-EXP-DT          PIC X(2).
   964             20  FILLER                  PIC X(11).
   965         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   966             20  PI-OE-REFERENCE-1.
   967                 25  PI-OE-REF-1-PRIME   PIC X(18).
   968                 25  PI-OE-REF-1-SUFF    PIC XX.
   969
   970     12  PI-SESSION-IN-PROGRESS          PIC X.
   971         88  CLAIM-SESSION                   VALUE '1'.
   972         88  CREDIT-SESSION                  VALUE '2'.
   973         88  WARRANTY-SESSION                VALUE '3'.
   974         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  22
* EL6501.cbl
   975         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   976
   977
   978*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   979
   980     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   981     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   982
   983     12  PI-CREDIT-USER                  PIC X.
   984         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   985         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   986
   987     12  PI-CLAIM-USER                   PIC X.
   988         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   989         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   990
   991     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   992         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   993         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   994         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   995         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   996         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   997
   998     12  PI-PROCESSOR-ID                 PIC X(4).
   999
  1000     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1001
  1002     12  PI-MEMBER-CAPTION               PIC X(10).
  1003
  1004     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1005         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1006
  1007     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1008     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1009     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1010     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1011
  1012     12  PI-AH-OVERRIDE-L1               PIC X.
  1013     12  PI-AH-OVERRIDE-L2               PIC XX.
  1014     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1015     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1016
  1017     12  PI-NEW-SYSTEM                   PIC X(2).
  1018
  1019     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1020     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1021         88  PI-USES-PAID-TO                 VALUE '1'.
  1022     12  PI-CRDTCRD-SYSTEM.
  1023         16  PI-CRDTCRD-USER             PIC X.
  1024             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1025             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1026         16  PI-CC-MONTH-END-DT          PIC XX.
  1027     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1028
  1029     12  PI-OE-REFERENCE-2.
  1030         16  PI-OE-REF-2-PRIME           PIC X(10).
  1031         16  PI-OE-REF-2-SUFF            PIC X.
  1032
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  23
* EL6501.cbl
  1033     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1034
  1035     12  PI-LANGUAGE-TYPE                PIC X.
  1036             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1037             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1038             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1039
  1040     12  PI-POLICY-LINKAGE-IND           PIC X.
  1041         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1042         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1043                                                   LOW-VALUES.
  1044
  1045     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1046     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1047         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1048         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1049     12  FILLER                          PIC X(4).
  1050
  1051     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1052
  1053     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1054         PI-SYSTEM-LEVEL.
  1055
  1056         16  PI-ENTRY-CODES.
  1057             20  PI-ENTRY-CD-1           PIC X.
  1058             20  PI-ENTRY-CD-2           PIC X.
  1059
  1060         16  PI-RETURN-CODES.
  1061             20  PI-RETURN-CD-1          PIC X.
  1062             20  PI-RETURN-CD-2          PIC X.
  1063
  1064         16  PI-UPDATE-STATUS-SAVE.
  1065             20  PI-UPDATE-BY            PIC X(4).
  1066             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1067
  1068         16  PI-LOWER-CASE-LETTERS       PIC X.
  1069             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1070
  1071*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1072*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1073*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1074
  1075         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1076             88  ST-ACCNT-CNTL               VALUE ' '.
  1077             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1078             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1079             88  ACCNT-CNTL                  VALUE '3'.
  1080             88  CARR-ACCNT-CNTL             VALUE '4'.
  1081
  1082         16  PI-PROCESSOR-CAP-LIST.
  1083             20  PI-SYSTEM-CONTROLS.
  1084                24 PI-SYSTEM-DISPLAY     PIC X.
  1085                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1086                24 PI-SYSTEM-MODIFY      PIC X.
  1087                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1088             20  FILLER                  PIC XX.
  1089             20  PI-DISPLAY-CAP          PIC X.
  1090                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  24
* EL6501.cbl
  1091             20  PI-MODIFY-CAP           PIC X.
  1092                 88  MODIFY-CAP              VALUE 'Y'.
  1093             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1094                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1095             20  PI-FORCE-CAP            PIC X.
  1096                 88  FORCE-CAP               VALUE 'Y'.
  1097
  1098         16  PI-PROGRAM-CONTROLS.
  1099             20  PI-PGM-PRINT-OPT        PIC X.
  1100             20  PI-PGM-FORMAT-OPT       PIC X.
  1101             20  PI-PGM-PROCESS-OPT      PIC X.
  1102             20  PI-PGM-TOTALS-OPT       PIC X.
  1103
  1104         16  PI-HELP-INTERFACE.
  1105             20  PI-LAST-ERROR-NO        PIC X(4).
  1106             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1107
  1108         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1109             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1110
  1111         16  PI-CR-CONTROL-IN-PROGRESS.
  1112             20  PI-CR-CARRIER           PIC X.
  1113             20  PI-CR-GROUPING          PIC X(6).
  1114             20  PI-CR-STATE             PIC XX.
  1115             20  PI-CR-ACCOUNT           PIC X(10).
  1116             20  PI-CR-FIN-RESP          PIC X(10).
  1117             20  PI-CR-TYPE              PIC X.
  1118
  1119         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1120
  1121         16  PI-CR-MONTH-END-DT          PIC XX.
  1122
  1123         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1124             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1125             88  PI-ZERO-CARRIER             VALUE '1'.
  1126             88  PI-ZERO-GROUPING            VALUE '2'.
  1127             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1128
  1129         16  PI-CARRIER-SECURITY         PIC X.
  1130             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1131
  1132         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1133             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1134             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1135
  1136         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1137             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1138                                         INDEXED BY PI-ACCESS-NDX
  1139                                         PIC X.
  1140
  1141         16  PI-GA-BILLING-CONTROL       PIC X.
  1142             88  PI-GA-BILLING               VALUE '1'.
  1143
  1144         16  PI-MAIL-PROCESSING          PIC X.
  1145             88  PI-MAIL-YES                 VALUE 'Y'.
  1146
  1147         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1148
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  25
* EL6501.cbl
  1149         16  PI-AR-SYSTEM.
  1150             20  PI-AR-PROCESSING-CNTL   PIC X.
  1151                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1152             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1153             20  PI-AR-MONTH-END-DT      PIC XX.
  1154
  1155         16  PI-MP-SYSTEM.
  1156             20  PI-MORTGAGE-USER            PIC X.
  1157                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1158                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1159             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1160                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1161                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1162                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1163                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1164                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1165             20  PI-MP-MONTH-END-DT          PIC XX.
  1166             20  PI-MP-REFERENCE-NO.
  1167                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1168                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1169
  1170         16  PI-LABEL-CONTROL            PIC X(01).
  1171             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1172             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1173
  1174         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1175             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1176
  1177         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1178             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1179             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1180
  1181         16  FILLER                      PIC X(14).
  1182
  1183     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1184******************************************************************
  1185*    COPY ELC650PI.
  1186******************************************************************
  1187*
  1188*                            ELC650PI.
  1189*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1190*                            VMOD=2.007
  1191*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1192*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
  1193* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1194*
  1195******************************************************************
  1196
  1197     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1198         16  PI-MAINT                   PIC X.
  1199         16  PI-PREV-ACCOUNT            PIC X(20).
  1200         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1201         16  PI-ACCT-KEY.
  1202             20  PI-ACCT-CCGSA-KEY.
  1203                 24  PI-ACCT-CO             PIC X.
  1204                 24  PI-ACCT-CARRIER        PIC X.
  1205                 24  PI-ACCT-GROUPING       PIC X(6).
  1206                 24  PI-ACCT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  26
* EL6501.cbl
  1207                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1208             20  PI-ACCT-EXP-DT           PIC XX.
  1209             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1210         16  PI-ACCT-ID                 PIC X(8).
  1211         16  PI-PLAN-KEY.
  1212             20  PI-PLAN-ACCT-KEY.
  1213                 24  PI-PLAN-COMPANY-CD PIC X.
  1214                 24  PI-PLAN-CARRIER    PIC X.
  1215                 24  PI-PLAN-GROUP      PIC X(6).
  1216                 24  PI-PLAN-STATE      PIC X(2).
  1217                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1218             20  PI-PLAN-BEN-TYPE       PIC X.
  1219             20  PI-PLAN-BEN            PIC XX.
  1220             20  PI-PLAN-REVISION       PIC X(3).
  1221         16  PI-WS-STATE                PIC XX.
  1222         16  PI-WS-CLASS                PIC XX.
  1223         16  PI-WS-DEV                  PIC X(3).
  1224         16  PI-WS-TYPE                 PIC X.
  1225         16  PI-WS-PLAN                 PIC XX.
  1226
  1227         16  PI-ERPNDB-ALT-KEY.
  1228             20  PI-PB-COMPANY-CD-A1    PIC X.
  1229             20  PI-PB-CARRIER          PIC X.
  1230             20  PI-PB-GROUPING         PIC X(6).
  1231             20  PI-PB-STATE            PIC XX.
  1232             20  PI-PB-ACCOUNT          PIC X(10).
  1233             20  PI-PB-CERT-EFF-DT      PIC XX.
  1234             20  PI-PB-CERT-NO          PIC X(10).
  1235             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1236             20  PI-PB-RECORD-TYPE      PIC X.
  1237
  1238         16  PI-DATE-RANGE-TABLE.
  1239             20  PI-TABLE-ENT OCCURS 32 TIMES
  1240                            INDEXED BY T-INDEX.
  1241                 24  PI-BIN-EFF-DT          PIC XX.
  1242                 24  PI-BIN-EXP-DT          PIC XX.
  1243                 24  PI-BIN-MAINT-DT        PIC XX.
  1244                 24  PI-BIN-LO-CERT         PIC XX.
  1245                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1246                 24  PI-BIN-HI-CERT         PIC XX.
  1247         16  PI-PAGE-NUMBER             PIC S9.
  1248             88  PI-FST-PAGE               VALUE +1.
  1249             88  PI-2ND-PAGE               VALUE +2.
  1250             88  PI-3RD-PAGE               VALUE +3.
  1251             88  PI-LST-PAGE               VALUE +4.
  1252         16  PI-TOTAL-LINES             PIC S99.
  1253         16  PI-LINE-SELECTED    PIC S9.
  1254***  Y2K PROJ 7744
  1255         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1256         16  BIN-EFFCHG-SAVE     PIC XX.
  1257         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1258***  Y2K PROJ 7744
  1259         16  BIN-EXPCHG-SAVE     PIC XX.
  1260         16  PI-RECORD-ADDED-SW  PIC X.
  1261             88  PI-RECORD-ADDED            VALUE '1'.
  1262             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1263         16  PI-ACCNAME          PIC X(30).
  1264         16  PI-COMM-POINTER     PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  27
* EL6501.cbl
  1265         16  PI-SV-MAINT         PIC X.
  1266         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1267         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1268         16  PI-UPDATE-SW        PIC X.
  1269             88  PI-CHANGES-MADE             VALUE '1'.
  1270         16  PI-NOTE-TYPE        PIC X.
  1271             88  PI-ACCT-NOTE                VALUE '1'.
  1272         16  PI-DMD-FILE-SW      PIC X.
  1273             88  END-OF-FILE                 VALUE 'E'.
  1274             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1275             88  FIRST-OCCURS                VALUE 'F'.
  1276         16  PI-DMD-OCCURS       PIC S999.
  1277         16  PI-DMD-SCREEN       PIC X.
  1278             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1279             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1280             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1281         16  PI-NAMEFLG          PIC X.
  1282         16  PI-EL650-DEL-SW     PIC X.
  1283         16  FILLER              PIC X(41).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  28
* EL6501.cbl
  1285
  1286*    COPY ELCJPFX.
  1287******************************************************************
  1288*                                                                *
  1289*                                                                *
  1290*                            ELCJPFX.                            *
  1291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1292*                            VMOD=2.002                          *
  1293*                                                                *
  1294*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1295*                                                                *
  1296*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1297*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1298*        ELCNTL - CONTROL FILE                                   *
  1299*        ELMSTR - CLAIM MASTERS                                  *
  1300*        ELTRLR - ACTIVITY TRAILERS                              *
  1301*        ELCHKQ - CHECK QUE                                      *
  1302******************************************************************
  1303 01  JOURNAL-RECORD.
  1304     12  JP-USER-ID                  PIC X(4).
  1305     12  JP-FILE-ID                  PIC X(8).
  1306     12  JP-PROGRAM-ID               PIC X(8).
  1307     12  JP-RECORD-TYPE              PIC X.
  1308         88 JP-ADD              VALUE 'A'.
  1309         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1310         88 JP-AFTER-CHANGE     VALUE 'C'.
  1311         88 JP-DELETE           VALUE 'D'.
  1312         88 JP-GENERIC-DELETE   VALUE 'G'.
  1313         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1314         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1315     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1316     12  JP-RECORD-AREA
  1317
  1318
  1319         PIC X(2000).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  29
* EL6501.cbl
  1321*    COPY ELCAID.
  1322******************************************************************
  1323*                                                                *
  1324*                            ELCAID.                             *
  1325*                            VMOD=2.001                          *
  1326*                                                                *
  1327*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1328*                                                                *
  1329*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1330*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1331******************************************************************
  1332
  1333 01  DFHAID.
  1334   02  DFHNULL   PIC  X  VALUE  ' '.
  1335   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1336   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1337   02  DFHPEN    PIC  X  VALUE  '='.
  1338   02  DFHOPID   PIC  X  VALUE  'W'.
  1339   02  DFHPA1    PIC  X  VALUE  '%'.
  1340   02  DFHPA2    PIC  X  VALUE  '>'.
  1341   02  DFHPA3    PIC  X  VALUE  ','.
  1342   02  DFHPF1    PIC  X  VALUE  '1'.
  1343   02  DFHPF2    PIC  X  VALUE  '2'.
  1344   02  DFHPF3    PIC  X  VALUE  '3'.
  1345   02  DFHPF4    PIC  X  VALUE  '4'.
  1346   02  DFHPF5    PIC  X  VALUE  '5'.
  1347   02  DFHPF6    PIC  X  VALUE  '6'.
  1348   02  DFHPF7    PIC  X  VALUE  '7'.
  1349   02  DFHPF8    PIC  X  VALUE  '8'.
  1350   02  DFHPF9    PIC  X  VALUE  '9'.
  1351   02  DFHPF10   PIC  X  VALUE  ':'.
  1352   02  DFHPF11   PIC  X  VALUE  '#'.
  1353   02  DFHPF12   PIC  X  VALUE  '@'.
  1354   02  DFHPF13   PIC  X  VALUE  'A'.
  1355   02  DFHPF14   PIC  X  VALUE  'B'.
  1356   02  DFHPF15   PIC  X  VALUE  'C'.
  1357   02  DFHPF16   PIC  X  VALUE  'D'.
  1358   02  DFHPF17   PIC  X  VALUE  'E'.
  1359   02  DFHPF18   PIC  X  VALUE  'F'.
  1360   02  DFHPF19   PIC  X  VALUE  'G'.
  1361   02  DFHPF20   PIC  X  VALUE  'H'.
  1362   02  DFHPF21   PIC  X  VALUE  'I'.
  1363*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1364   02  DFHPF22   PIC  X  VALUE  '['.
  1365   02  DFHPF23   PIC  X  VALUE  '.'.
  1366   02  DFHPF24   PIC  X  VALUE  '<'.
  1367   02  DFHMSRE   PIC  X  VALUE  'X'.
  1368   02  DFHSTRF   PIC  X  VALUE  'h'.
  1369   02  DFHTRIG   PIC  X  VALUE  '"'.
  1370 01  FILLER    REDEFINES DFHAID.
  1371     12  FILLER                  PIC X(8).
  1372     12  PF-VALUES               PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  30
* EL6501.cbl
  1374*    COPY EL6501S.
  1375 01  EL6501AI.
  1376     05  FILLER            PIC  X(0012).
  1377*    -------------------------------
  1378     05  DATEL PIC S9(0004) COMP.
  1379     05  DATEF PIC  X(0001).
  1380     05  FILLER REDEFINES DATEF.
  1381         10  DATEA PIC  X(0001).
  1382     05  DATEI PIC  X(0008).
  1383*    -------------------------------
  1384     05  TIMEL PIC S9(0004) COMP.
  1385     05  TIMEF PIC  X(0001).
  1386     05  FILLER REDEFINES TIMEF.
  1387         10  TIMEA PIC  X(0001).
  1388     05  TIMEI PIC  X(0005).
  1389*    -------------------------------
  1390     05  CMPNYIDL PIC S9(0004) COMP.
  1391     05  CMPNYIDF PIC  X(0001).
  1392     05  FILLER REDEFINES CMPNYIDF.
  1393         10  CMPNYIDA PIC  X(0001).
  1394     05  CMPNYIDI PIC  X(0003).
  1395*    -------------------------------
  1396     05  USERIDL PIC S9(0004) COMP.
  1397     05  USERIDF PIC  X(0001).
  1398     05  FILLER REDEFINES USERIDF.
  1399         10  USERIDA PIC  X(0001).
  1400     05  USERIDI PIC  X(0004).
  1401*    -------------------------------
  1402     05  MAINTL PIC S9(0004) COMP.
  1403     05  MAINTF PIC  X(0001).
  1404     05  FILLER REDEFINES MAINTF.
  1405         10  MAINTA PIC  X(0001).
  1406     05  MAINTI PIC  X(0001).
  1407*    -------------------------------
  1408     05  CARRL PIC S9(0004) COMP.
  1409     05  CARRF PIC  X(0001).
  1410     05  FILLER REDEFINES CARRF.
  1411         10  CARRA PIC  X(0001).
  1412     05  CARRI PIC  X(0001).
  1413*    -------------------------------
  1414     05  GROUPINL PIC S9(0004) COMP.
  1415     05  GROUPINF PIC  X(0001).
  1416     05  FILLER REDEFINES GROUPINF.
  1417         10  GROUPINA PIC  X(0001).
  1418     05  GROUPINI PIC  X(0006).
  1419*    -------------------------------
  1420     05  STATEL PIC S9(0004) COMP.
  1421     05  STATEF PIC  X(0001).
  1422     05  FILLER REDEFINES STATEF.
  1423         10  STATEA PIC  X(0001).
  1424     05  STATEI PIC  X(0002).
  1425*    -------------------------------
  1426     05  ACCOUNTL PIC S9(0004) COMP.
  1427     05  ACCOUNTF PIC  X(0001).
  1428     05  FILLER REDEFINES ACCOUNTF.
  1429         10  ACCOUNTA PIC  X(0001).
  1430     05  ACCOUNTI PIC  X(0010).
  1431*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  31
* EL6501.cbl
  1432     05  EFFDTEL PIC S9(0004) COMP.
  1433     05  EFFDTEF PIC  X(0001).
  1434     05  FILLER REDEFINES EFFDTEF.
  1435         10  EFFDTEA PIC  X(0001).
  1436     05  EFFDTEI PIC  X(0008).
  1437*    -------------------------------
  1438     05  EXPDTEL PIC S9(0004) COMP.
  1439     05  EXPDTEF PIC  X(0001).
  1440     05  FILLER REDEFINES EXPDTEF.
  1441         10  EXPDTEA PIC  X(0001).
  1442     05  EXPDTEI PIC  X(0008).
  1443*    -------------------------------
  1444     05  MAINTBYL PIC S9(0004) COMP.
  1445     05  MAINTBYF PIC  X(0001).
  1446     05  FILLER REDEFINES MAINTBYF.
  1447         10  MAINTBYA PIC  X(0001).
  1448     05  MAINTBYI PIC  X(0004).
  1449*    -------------------------------
  1450     05  PCONTL PIC S9(0004) COMP.
  1451     05  PCONTF PIC  X(0001).
  1452     05  FILLER REDEFINES PCONTF.
  1453         10  PCONTA PIC  X(0001).
  1454     05  PCONTI PIC  X(0030).
  1455*    -------------------------------
  1456     05  CSRL PIC S9(0004) COMP.
  1457     05  CSRF PIC  X(0001).
  1458     05  FILLER REDEFINES CSRF.
  1459         10  CSRA PIC  X(0001).
  1460     05  CSRI PIC  X(0004).
  1461*    -------------------------------
  1462     05  PDSPLYL PIC S9(0004) COMP.
  1463     05  PDSPLYF PIC  X(0001).
  1464     05  FILLER REDEFINES PDSPLYF.
  1465         10  PDSPLYA PIC  X(0001).
  1466     05  PDSPLYI PIC  X(0006).
  1467*    -------------------------------
  1468     05  PEFFDTEL PIC S9(0004) COMP.
  1469     05  PEFFDTEF PIC  X(0001).
  1470     05  FILLER REDEFINES PEFFDTEF.
  1471         10  PEFFDTEA PIC  X(0001).
  1472     05  PEFFDTEI PIC  X(0008).
  1473*    -------------------------------
  1474     05  PEXPDTEL PIC S9(0004) COMP.
  1475     05  PEXPDTEF PIC  X(0001).
  1476     05  FILLER REDEFINES PEXPDTEF.
  1477         10  PEXPDTEA PIC  X(0001).
  1478     05  PEXPDTEI PIC  X(0008).
  1479*    -------------------------------
  1480     05  NAMEL PIC S9(0004) COMP.
  1481     05  NAMEF PIC  X(0001).
  1482     05  FILLER REDEFINES NAMEF.
  1483         10  NAMEA PIC  X(0001).
  1484     05  NAMEI PIC  X(0030).
  1485*    -------------------------------
  1486     05  TAXNOL PIC S9(0004) COMP.
  1487     05  TAXNOF PIC  X(0001).
  1488     05  FILLER REDEFINES TAXNOF.
  1489         10  TAXNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  32
* EL6501.cbl
  1490     05  TAXNOI PIC  X(0011).
  1491*    -------------------------------
  1492     05  STATUSL PIC S9(0004) COMP.
  1493     05  STATUSF PIC  X(0001).
  1494     05  FILLER REDEFINES STATUSF.
  1495         10  STATUSA PIC  X(0001).
  1496     05  STATUSI PIC  X(0001).
  1497*    -------------------------------
  1498     05  INCAREL PIC S9(0004) COMP.
  1499     05  INCAREF PIC  X(0001).
  1500     05  FILLER REDEFINES INCAREF.
  1501         10  INCAREA PIC  X(0001).
  1502     05  INCAREI PIC  X(0030).
  1503*    -------------------------------
  1504     05  PHONEL PIC S9(0004) COMP.
  1505     05  PHONEF PIC  X(0001).
  1506     05  FILLER REDEFINES PHONEF.
  1507         10  PHONEA PIC  X(0001).
  1508     05  PHONEI PIC  X(0012).
  1509*    -------------------------------
  1510     05  INDGRPL PIC S9(0004) COMP.
  1511     05  INDGRPF PIC  X(0001).
  1512     05  FILLER REDEFINES INDGRPF.
  1513         10  INDGRPA PIC  X(0001).
  1514     05  INDGRPI PIC  X(0001).
  1515*    -------------------------------
  1516     05  ADDR1L PIC S9(0004) COMP.
  1517     05  ADDR1F PIC  X(0001).
  1518     05  FILLER REDEFINES ADDR1F.
  1519         10  ADDR1A PIC  X(0001).
  1520     05  ADDR1I PIC  X(0030).
  1521*    -------------------------------
  1522     05  CONTRL PIC S9(0004) COMP.
  1523     05  CONTRF PIC  X(0001).
  1524     05  FILLER REDEFINES CONTRF.
  1525         10  CONTRA PIC  X(0001).
  1526     05  CONTRI PIC  X(0008).
  1527*    -------------------------------
  1528     05  TYPEL PIC S9(0004) COMP.
  1529     05  TYPEF PIC  X(0001).
  1530     05  FILLER REDEFINES TYPEF.
  1531         10  TYPEA PIC  X(0001).
  1532     05  TYPEI PIC  99.
  1533*    -------------------------------
  1534     05  ACITYL PIC S9(0004) COMP.
  1535     05  ACITYF PIC  X(0001).
  1536     05  FILLER REDEFINES ACITYF.
  1537         10  ACITYA PIC  X(0001).
  1538     05  ACITYI PIC  X(0028).
  1539*    -------------------------------
  1540     05  ASTATEL PIC S9(0004) COMP.
  1541     05  ASTATEF PIC  X(0001).
  1542     05  FILLER REDEFINES ASTATEF.
  1543         10  ASTATEA PIC  X(0001).
  1544     05  ASTATEI PIC  X(0002).
  1545*    -------------------------------
  1546     05  PRODATEL PIC S9(0004) COMP.
  1547     05  PRODATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  33
* EL6501.cbl
  1548     05  FILLER REDEFINES PRODATEF.
  1549         10  PRODATEA PIC  X(0001).
  1550     05  PRODATEI PIC  X(0008).
  1551*    -------------------------------
  1552     05  STDBENL PIC S9(0004) COMP.
  1553     05  STDBENF PIC  X(0001).
  1554     05  FILLER REDEFINES STDBENF.
  1555         10  STDBENA PIC  X(0001).
  1556     05  STDBENI PIC  X(0002).
  1557*    -------------------------------
  1558     05  ZIPL PIC S9(0004) COMP.
  1559     05  ZIPF PIC  X(0001).
  1560     05  FILLER REDEFINES ZIPF.
  1561         10  ZIPA PIC  X(0001).
  1562     05  ZIPI PIC  X(0010).
  1563*    -------------------------------
  1564     05  CTPLABLL PIC S9(0004) COMP.
  1565     05  CTPLABLF PIC  X(0001).
  1566     05  FILLER REDEFINES CTPLABLF.
  1567         10  CTPLABLA PIC  X(0001).
  1568     05  CTPLABLI PIC  X(0010).
  1569*    -------------------------------
  1570     05  CLPTOLPL PIC S9(0004) COMP.
  1571     05  CLPTOLPF PIC  X(0001).
  1572     05  FILLER REDEFINES CLPTOLPF.
  1573         10  CLPTOLPA PIC  X(0001).
  1574     05  CLPTOLPI PIC  S9(02)V9999.
  1575*    -------------------------------
  1576     05  RETROCDL PIC S9(0004) COMP.
  1577     05  RETROCDF PIC  X(0001).
  1578     05  FILLER REDEFINES RETROCDF.
  1579         10  RETROCDA PIC  X(0001).
  1580     05  RETROCDI PIC  X(0003).
  1581*    -------------------------------
  1582     05  BILLCDL PIC S9(0004) COMP.
  1583     05  BILLCDF PIC  X(0001).
  1584     05  FILLER REDEFINES BILLCDF.
  1585         10  BILLCDA PIC  X(0001).
  1586     05  BILLCDI PIC  X(0003).
  1587*    -------------------------------
  1588     05  LCLABLL PIC S9(0004) COMP.
  1589     05  LCLABLF PIC  X(0001).
  1590     05  FILLER REDEFINES LCLABLF.
  1591         10  LCLABLA PIC  X(0001).
  1592     05  LCLABLI PIC  X(0011).
  1593*    -------------------------------
  1594     05  LCOMML PIC S9(0004) COMP.
  1595     05  LCOMMF PIC  X(0001).
  1596     05  FILLER REDEFINES LCOMMF.
  1597         10  LCOMMA PIC  X(0001).
  1598     05  LCOMMI PIC  S9(6)V9(2).
  1599*    -------------------------------
  1600     05  PSIHEADL PIC S9(0004) COMP.
  1601     05  PSIHEADF PIC  X(0001).
  1602     05  FILLER REDEFINES PSIHEADF.
  1603         10  PSIHEADA PIC  X(0001).
  1604     05  PSIHEADI PIC  X(0014).
  1605*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  34
* EL6501.cbl
  1606     05  PSILFTL PIC S9(0004) COMP.
  1607     05  PSILFTF PIC  X(0001).
  1608     05  FILLER REDEFINES PSILFTF.
  1609         10  PSILFTA PIC  X(0001).
  1610     05  PSILFTI PIC  X(0006).
  1611*    -------------------------------
  1612     05  PSILFCL PIC S9(0004) COMP.
  1613     05  PSILFCF PIC  X(0001).
  1614     05  FILLER REDEFINES PSILFCF.
  1615         10  PSILFCA PIC  X(0001).
  1616     05  PSILFCI PIC  X(0001).
  1617*    -------------------------------
  1618     05  PSILFFL PIC S9(0004) COMP.
  1619     05  PSILFFF PIC  X(0001).
  1620     05  FILLER REDEFINES PSILFFF.
  1621         10  PSILFFA PIC  X(0001).
  1622     05  PSILFFI PIC  X(0007).
  1623*    -------------------------------
  1624     05  PSIAHTL PIC S9(0004) COMP.
  1625     05  PSIAHTF PIC  X(0001).
  1626     05  FILLER REDEFINES PSIAHTF.
  1627         10  PSIAHTA PIC  X(0001).
  1628     05  PSIAHTI PIC  X(0006).
  1629*    -------------------------------
  1630     05  PSIAHCL PIC S9(0004) COMP.
  1631     05  PSIAHCF PIC  X(0001).
  1632     05  FILLER REDEFINES PSIAHCF.
  1633         10  PSIAHCA PIC  X(0001).
  1634     05  PSIAHCI PIC  X(0001).
  1635*    -------------------------------
  1636     05  PSIAHFL PIC S9(0004) COMP.
  1637     05  PSIAHFF PIC  X(0001).
  1638     05  FILLER REDEFINES PSIAHFF.
  1639         10  PSIAHFA PIC  X(0001).
  1640     05  PSIAHFI PIC  X(0007).
  1641*    -------------------------------
  1642     05  REMITL PIC S9(0004) COMP.
  1643     05  REMITF PIC  X(0001).
  1644     05  FILLER REDEFINES REMITF.
  1645         10  REMITA PIC  X(0001).
  1646     05  REMITI PIC  99.
  1647*    -------------------------------
  1648     05  COMMCALL PIC S9(0004) COMP.
  1649     05  COMMCALF PIC  X(0001).
  1650     05  FILLER REDEFINES COMMCALF.
  1651         10  COMMCALA PIC  X(0001).
  1652     05  COMMCALI PIC  X(0001).
  1653*    -------------------------------
  1654     05  REINTABL PIC S9(0004) COMP.
  1655     05  REINTABF PIC  X(0001).
  1656     05  FILLER REDEFINES REINTABF.
  1657         10  REINTABA PIC  X(0001).
  1658     05  REINTABI PIC  X(0003).
  1659*    -------------------------------
  1660     05  REINCALL PIC S9(0004) COMP.
  1661     05  REINCALF PIC  X(0001).
  1662     05  FILLER REDEFINES REINCALF.
  1663         10  REINCALA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  35
* EL6501.cbl
  1664     05  REINCALI PIC  X(0001).
  1665*    -------------------------------
  1666     05  AHHEADL PIC S9(0004) COMP.
  1667     05  AHHEADF PIC  X(0001).
  1668     05  FILLER REDEFINES AHHEADF.
  1669         10  AHHEADA PIC  X(0001).
  1670     05  AHHEADI PIC  X(0006).
  1671*    -------------------------------
  1672     05  AGNT1L PIC S9(0004) COMP.
  1673     05  AGNT1F PIC  X(0001).
  1674     05  FILLER REDEFINES AGNT1F.
  1675         10  AGNT1A PIC  X(0001).
  1676     05  AGNT1I PIC  X(0010).
  1677*    -------------------------------
  1678     05  TYPE1L PIC S9(0004) COMP.
  1679     05  TYPE1F PIC  X(0001).
  1680     05  FILLER REDEFINES TYPE1F.
  1681         10  TYPE1A PIC  X(0001).
  1682     05  TYPE1I PIC  X(0001).
  1683*    -------------------------------
  1684     05  SINRT1L PIC S9(0004) COMP.
  1685     05  SINRT1F PIC  X(0001).
  1686     05  FILLER REDEFINES SINRT1F.
  1687         10  SINRT1A PIC  X(0001).
  1688     05  SINRT1I PIC  X(0006).
  1689*    -------------------------------
  1690     05  JNTRT1L PIC S9(0004) COMP.
  1691     05  JNTRT1F PIC  X(0001).
  1692     05  FILLER REDEFINES JNTRT1F.
  1693         10  JNTRT1A PIC  X(0001).
  1694     05  JNTRT1I PIC  X(0006).
  1695*    -------------------------------
  1696     05  AHRT1L PIC S9(0004) COMP.
  1697     05  AHRT1F PIC  X(0001).
  1698     05  FILLER REDEFINES AHRT1F.
  1699         10  AHRT1A PIC  X(0001).
  1700     05  AHRT1I PIC  X(0006).
  1701*    -------------------------------
  1702     05  RECAL1L PIC S9(0004) COMP.
  1703     05  RECAL1F PIC  X(0001).
  1704     05  FILLER REDEFINES RECAL1F.
  1705         10  RECAL1A PIC  X(0001).
  1706     05  RECAL1I PIC  X(0001).
  1707*    -------------------------------
  1708     05  COMM1L PIC S9(0004) COMP.
  1709     05  COMM1F PIC  X(0001).
  1710     05  FILLER REDEFINES COMM1F.
  1711         10  COMM1A PIC  X(0001).
  1712     05  COMM1I PIC  X(0001).
  1713*    -------------------------------
  1714     05  CHGBK1L PIC S9(0004) COMP.
  1715     05  CHGBK1F PIC  X(0001).
  1716     05  FILLER REDEFINES CHGBK1F.
  1717         10  CHGBK1A PIC  X(0001).
  1718     05  CHGBK1I PIC  X(0002).
  1719*    -------------------------------
  1720     05  GLCDE1L PIC S9(0004) COMP.
  1721     05  GLCDE1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  36
* EL6501.cbl
  1722     05  FILLER REDEFINES GLCDE1F.
  1723         10  GLCDE1A PIC  X(0001).
  1724     05  GLCDE1I PIC  X(0001).
  1725*    -------------------------------
  1726     05  AGNT2L PIC S9(0004) COMP.
  1727     05  AGNT2F PIC  X(0001).
  1728     05  FILLER REDEFINES AGNT2F.
  1729         10  AGNT2A PIC  X(0001).
  1730     05  AGNT2I PIC  X(0010).
  1731*    -------------------------------
  1732     05  TYPE2L PIC S9(0004) COMP.
  1733     05  TYPE2F PIC  X(0001).
  1734     05  FILLER REDEFINES TYPE2F.
  1735         10  TYPE2A PIC  X(0001).
  1736     05  TYPE2I PIC  X(0001).
  1737*    -------------------------------
  1738     05  SINRT2L PIC S9(0004) COMP.
  1739     05  SINRT2F PIC  X(0001).
  1740     05  FILLER REDEFINES SINRT2F.
  1741         10  SINRT2A PIC  X(0001).
  1742     05  SINRT2I PIC  X(0006).
  1743*    -------------------------------
  1744     05  JNTRT2L PIC S9(0004) COMP.
  1745     05  JNTRT2F PIC  X(0001).
  1746     05  FILLER REDEFINES JNTRT2F.
  1747         10  JNTRT2A PIC  X(0001).
  1748     05  JNTRT2I PIC  X(0006).
  1749*    -------------------------------
  1750     05  AHRT2L PIC S9(0004) COMP.
  1751     05  AHRT2F PIC  X(0001).
  1752     05  FILLER REDEFINES AHRT2F.
  1753         10  AHRT2A PIC  X(0001).
  1754     05  AHRT2I PIC  X(0006).
  1755*    -------------------------------
  1756     05  RECAL2L PIC S9(0004) COMP.
  1757     05  RECAL2F PIC  X(0001).
  1758     05  FILLER REDEFINES RECAL2F.
  1759         10  RECAL2A PIC  X(0001).
  1760     05  RECAL2I PIC  X(0001).
  1761*    -------------------------------
  1762     05  COMM2L PIC S9(0004) COMP.
  1763     05  COMM2F PIC  X(0001).
  1764     05  FILLER REDEFINES COMM2F.
  1765         10  COMM2A PIC  X(0001).
  1766     05  COMM2I PIC  X(0001).
  1767*    -------------------------------
  1768     05  CHGBK2L PIC S9(0004) COMP.
  1769     05  CHGBK2F PIC  X(0001).
  1770     05  FILLER REDEFINES CHGBK2F.
  1771         10  CHGBK2A PIC  X(0001).
  1772     05  CHGBK2I PIC  X(0002).
  1773*    -------------------------------
  1774     05  GLCDE2L PIC S9(0004) COMP.
  1775     05  GLCDE2F PIC  X(0001).
  1776     05  FILLER REDEFINES GLCDE2F.
  1777         10  GLCDE2A PIC  X(0001).
  1778     05  GLCDE2I PIC  X(0001).
  1779*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  37
* EL6501.cbl
  1780     05  AGNT3L PIC S9(0004) COMP.
  1781     05  AGNT3F PIC  X(0001).
  1782     05  FILLER REDEFINES AGNT3F.
  1783         10  AGNT3A PIC  X(0001).
  1784     05  AGNT3I PIC  X(0010).
  1785*    -------------------------------
  1786     05  TYPE3L PIC S9(0004) COMP.
  1787     05  TYPE3F PIC  X(0001).
  1788     05  FILLER REDEFINES TYPE3F.
  1789         10  TYPE3A PIC  X(0001).
  1790     05  TYPE3I PIC  X(0001).
  1791*    -------------------------------
  1792     05  SINRT3L PIC S9(0004) COMP.
  1793     05  SINRT3F PIC  X(0001).
  1794     05  FILLER REDEFINES SINRT3F.
  1795         10  SINRT3A PIC  X(0001).
  1796     05  SINRT3I PIC  X(0006).
  1797*    -------------------------------
  1798     05  JNTRT3L PIC S9(0004) COMP.
  1799     05  JNTRT3F PIC  X(0001).
  1800     05  FILLER REDEFINES JNTRT3F.
  1801         10  JNTRT3A PIC  X(0001).
  1802     05  JNTRT3I PIC  X(0006).
  1803*    -------------------------------
  1804     05  AHRT3L PIC S9(0004) COMP.
  1805     05  AHRT3F PIC  X(0001).
  1806     05  FILLER REDEFINES AHRT3F.
  1807         10  AHRT3A PIC  X(0001).
  1808     05  AHRT3I PIC  X(0006).
  1809*    -------------------------------
  1810     05  RECAL3L PIC S9(0004) COMP.
  1811     05  RECAL3F PIC  X(0001).
  1812     05  FILLER REDEFINES RECAL3F.
  1813         10  RECAL3A PIC  X(0001).
  1814     05  RECAL3I PIC  X(0001).
  1815*    -------------------------------
  1816     05  COMM3L PIC S9(0004) COMP.
  1817     05  COMM3F PIC  X(0001).
  1818     05  FILLER REDEFINES COMM3F.
  1819         10  COMM3A PIC  X(0001).
  1820     05  COMM3I PIC  X(0001).
  1821*    -------------------------------
  1822     05  CHGBK3L PIC S9(0004) COMP.
  1823     05  CHGBK3F PIC  X(0001).
  1824     05  FILLER REDEFINES CHGBK3F.
  1825         10  CHGBK3A PIC  X(0001).
  1826     05  CHGBK3I PIC  X(0002).
  1827*    -------------------------------
  1828     05  GLCDE3L PIC S9(0004) COMP.
  1829     05  GLCDE3F PIC  X(0001).
  1830     05  FILLER REDEFINES GLCDE3F.
  1831         10  GLCDE3A PIC  X(0001).
  1832     05  GLCDE3I PIC  X(0001).
  1833*    -------------------------------
  1834     05  AGNT4L PIC S9(0004) COMP.
  1835     05  AGNT4F PIC  X(0001).
  1836     05  FILLER REDEFINES AGNT4F.
  1837         10  AGNT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  38
* EL6501.cbl
  1838     05  AGNT4I PIC  X(0010).
  1839*    -------------------------------
  1840     05  TYPE4L PIC S9(0004) COMP.
  1841     05  TYPE4F PIC  X(0001).
  1842     05  FILLER REDEFINES TYPE4F.
  1843         10  TYPE4A PIC  X(0001).
  1844     05  TYPE4I PIC  X(0001).
  1845*    -------------------------------
  1846     05  SINRT4L PIC S9(0004) COMP.
  1847     05  SINRT4F PIC  X(0001).
  1848     05  FILLER REDEFINES SINRT4F.
  1849         10  SINRT4A PIC  X(0001).
  1850     05  SINRT4I PIC  X(0006).
  1851*    -------------------------------
  1852     05  JNTRT4L PIC S9(0004) COMP.
  1853     05  JNTRT4F PIC  X(0001).
  1854     05  FILLER REDEFINES JNTRT4F.
  1855         10  JNTRT4A PIC  X(0001).
  1856     05  JNTRT4I PIC  X(0006).
  1857*    -------------------------------
  1858     05  AHRT4L PIC S9(0004) COMP.
  1859     05  AHRT4F PIC  X(0001).
  1860     05  FILLER REDEFINES AHRT4F.
  1861         10  AHRT4A PIC  X(0001).
  1862     05  AHRT4I PIC  X(0006).
  1863*    -------------------------------
  1864     05  RECAL4L PIC S9(0004) COMP.
  1865     05  RECAL4F PIC  X(0001).
  1866     05  FILLER REDEFINES RECAL4F.
  1867         10  RECAL4A PIC  X(0001).
  1868     05  RECAL4I PIC  X(0001).
  1869*    -------------------------------
  1870     05  COMM4L PIC S9(0004) COMP.
  1871     05  COMM4F PIC  X(0001).
  1872     05  FILLER REDEFINES COMM4F.
  1873         10  COMM4A PIC  X(0001).
  1874     05  COMM4I PIC  X(0001).
  1875*    -------------------------------
  1876     05  CHGBK4L PIC S9(0004) COMP.
  1877     05  CHGBK4F PIC  X(0001).
  1878     05  FILLER REDEFINES CHGBK4F.
  1879         10  CHGBK4A PIC  X(0001).
  1880     05  CHGBK4I PIC  X(0002).
  1881*    -------------------------------
  1882     05  GLCDE4L PIC S9(0004) COMP.
  1883     05  GLCDE4F PIC  X(0001).
  1884     05  FILLER REDEFINES GLCDE4F.
  1885         10  GLCDE4A PIC  X(0001).
  1886     05  GLCDE4I PIC  X(0001).
  1887*    -------------------------------
  1888     05  AGNT5L PIC S9(0004) COMP.
  1889     05  AGNT5F PIC  X(0001).
  1890     05  FILLER REDEFINES AGNT5F.
  1891         10  AGNT5A PIC  X(0001).
  1892     05  AGNT5I PIC  X(0010).
  1893*    -------------------------------
  1894     05  TYPE5L PIC S9(0004) COMP.
  1895     05  TYPE5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  39
* EL6501.cbl
  1896     05  FILLER REDEFINES TYPE5F.
  1897         10  TYPE5A PIC  X(0001).
  1898     05  TYPE5I PIC  X(0001).
  1899*    -------------------------------
  1900     05  SINRT5L PIC S9(0004) COMP.
  1901     05  SINRT5F PIC  X(0001).
  1902     05  FILLER REDEFINES SINRT5F.
  1903         10  SINRT5A PIC  X(0001).
  1904     05  SINRT5I PIC  X(0006).
  1905*    -------------------------------
  1906     05  JNTRT5L PIC S9(0004) COMP.
  1907     05  JNTRT5F PIC  X(0001).
  1908     05  FILLER REDEFINES JNTRT5F.
  1909         10  JNTRT5A PIC  X(0001).
  1910     05  JNTRT5I PIC  X(0006).
  1911*    -------------------------------
  1912     05  AHRT5L PIC S9(0004) COMP.
  1913     05  AHRT5F PIC  X(0001).
  1914     05  FILLER REDEFINES AHRT5F.
  1915         10  AHRT5A PIC  X(0001).
  1916     05  AHRT5I PIC  X(0006).
  1917*    -------------------------------
  1918     05  RECAL5L PIC S9(0004) COMP.
  1919     05  RECAL5F PIC  X(0001).
  1920     05  FILLER REDEFINES RECAL5F.
  1921         10  RECAL5A PIC  X(0001).
  1922     05  RECAL5I PIC  X(0001).
  1923*    -------------------------------
  1924     05  COMM5L PIC S9(0004) COMP.
  1925     05  COMM5F PIC  X(0001).
  1926     05  FILLER REDEFINES COMM5F.
  1927         10  COMM5A PIC  X(0001).
  1928     05  COMM5I PIC  X(0001).
  1929*    -------------------------------
  1930     05  CHGBK5L PIC S9(0004) COMP.
  1931     05  CHGBK5F PIC  X(0001).
  1932     05  FILLER REDEFINES CHGBK5F.
  1933         10  CHGBK5A PIC  X(0001).
  1934     05  CHGBK5I PIC  X(0002).
  1935*    -------------------------------
  1936     05  GLCDE5L PIC S9(0004) COMP.
  1937     05  GLCDE5F PIC  X(0001).
  1938     05  FILLER REDEFINES GLCDE5F.
  1939         10  GLCDE5A PIC  X(0001).
  1940     05  GLCDE5I PIC  X(0001).
  1941*    -------------------------------
  1942     05  AGNT6L PIC S9(0004) COMP.
  1943     05  AGNT6F PIC  X(0001).
  1944     05  FILLER REDEFINES AGNT6F.
  1945         10  AGNT6A PIC  X(0001).
  1946     05  AGNT6I PIC  X(0010).
  1947*    -------------------------------
  1948     05  TYPE6L PIC S9(0004) COMP.
  1949     05  TYPE6F PIC  X(0001).
  1950     05  FILLER REDEFINES TYPE6F.
  1951         10  TYPE6A PIC  X(0001).
  1952     05  TYPE6I PIC  X(0001).
  1953*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  40
* EL6501.cbl
  1954     05  SINRT6L PIC S9(0004) COMP.
  1955     05  SINRT6F PIC  X(0001).
  1956     05  FILLER REDEFINES SINRT6F.
  1957         10  SINRT6A PIC  X(0001).
  1958     05  SINRT6I PIC  X(0006).
  1959*    -------------------------------
  1960     05  JNTRT6L PIC S9(0004) COMP.
  1961     05  JNTRT6F PIC  X(0001).
  1962     05  FILLER REDEFINES JNTRT6F.
  1963         10  JNTRT6A PIC  X(0001).
  1964     05  JNTRT6I PIC  X(0006).
  1965*    -------------------------------
  1966     05  AHRT6L PIC S9(0004) COMP.
  1967     05  AHRT6F PIC  X(0001).
  1968     05  FILLER REDEFINES AHRT6F.
  1969         10  AHRT6A PIC  X(0001).
  1970     05  AHRT6I PIC  X(0006).
  1971*    -------------------------------
  1972     05  RECAL6L PIC S9(0004) COMP.
  1973     05  RECAL6F PIC  X(0001).
  1974     05  FILLER REDEFINES RECAL6F.
  1975         10  RECAL6A PIC  X(0001).
  1976     05  RECAL6I PIC  X(0001).
  1977*    -------------------------------
  1978     05  COMM6L PIC S9(0004) COMP.
  1979     05  COMM6F PIC  X(0001).
  1980     05  FILLER REDEFINES COMM6F.
  1981         10  COMM6A PIC  X(0001).
  1982     05  COMM6I PIC  X(0001).
  1983*    -------------------------------
  1984     05  CHGBK6L PIC S9(0004) COMP.
  1985     05  CHGBK6F PIC  X(0001).
  1986     05  FILLER REDEFINES CHGBK6F.
  1987         10  CHGBK6A PIC  X(0001).
  1988     05  CHGBK6I PIC  X(0002).
  1989*    -------------------------------
  1990     05  GLCDE6L PIC S9(0004) COMP.
  1991     05  GLCDE6F PIC  X(0001).
  1992     05  FILLER REDEFINES GLCDE6F.
  1993         10  GLCDE6A PIC  X(0001).
  1994     05  GLCDE6I PIC  X(0001).
  1995*    -------------------------------
  1996     05  AGNT7L PIC S9(0004) COMP.
  1997     05  AGNT7F PIC  X(0001).
  1998     05  FILLER REDEFINES AGNT7F.
  1999         10  AGNT7A PIC  X(0001).
  2000     05  AGNT7I PIC  X(0010).
  2001*    -------------------------------
  2002     05  TYPE7L PIC S9(0004) COMP.
  2003     05  TYPE7F PIC  X(0001).
  2004     05  FILLER REDEFINES TYPE7F.
  2005         10  TYPE7A PIC  X(0001).
  2006     05  TYPE7I PIC  X(0001).
  2007*    -------------------------------
  2008     05  SINRT7L PIC S9(0004) COMP.
  2009     05  SINRT7F PIC  X(0001).
  2010     05  FILLER REDEFINES SINRT7F.
  2011         10  SINRT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  41
* EL6501.cbl
  2012     05  SINRT7I PIC  X(0006).
  2013*    -------------------------------
  2014     05  JNTRT7L PIC S9(0004) COMP.
  2015     05  JNTRT7F PIC  X(0001).
  2016     05  FILLER REDEFINES JNTRT7F.
  2017         10  JNTRT7A PIC  X(0001).
  2018     05  JNTRT7I PIC  X(0006).
  2019*    -------------------------------
  2020     05  AHRT7L PIC S9(0004) COMP.
  2021     05  AHRT7F PIC  X(0001).
  2022     05  FILLER REDEFINES AHRT7F.
  2023         10  AHRT7A PIC  X(0001).
  2024     05  AHRT7I PIC  X(0006).
  2025*    -------------------------------
  2026     05  RECAL7L PIC S9(0004) COMP.
  2027     05  RECAL7F PIC  X(0001).
  2028     05  FILLER REDEFINES RECAL7F.
  2029         10  RECAL7A PIC  X(0001).
  2030     05  RECAL7I PIC  X(0001).
  2031*    -------------------------------
  2032     05  COMM7L PIC S9(0004) COMP.
  2033     05  COMM7F PIC  X(0001).
  2034     05  FILLER REDEFINES COMM7F.
  2035         10  COMM7A PIC  X(0001).
  2036     05  COMM7I PIC  X(0001).
  2037*    -------------------------------
  2038     05  CHGBK7L PIC S9(0004) COMP.
  2039     05  CHGBK7F PIC  X(0001).
  2040     05  FILLER REDEFINES CHGBK7F.
  2041         10  CHGBK7A PIC  X(0001).
  2042     05  CHGBK7I PIC  X(0002).
  2043*    -------------------------------
  2044     05  GLCDE7L PIC S9(0004) COMP.
  2045     05  GLCDE7F PIC  X(0001).
  2046     05  FILLER REDEFINES GLCDE7F.
  2047         10  GLCDE7A PIC  X(0001).
  2048     05  GLCDE7I PIC  X(0001).
  2049*    -------------------------------
  2050     05  AGNT8L PIC S9(0004) COMP.
  2051     05  AGNT8F PIC  X(0001).
  2052     05  FILLER REDEFINES AGNT8F.
  2053         10  AGNT8A PIC  X(0001).
  2054     05  AGNT8I PIC  X(0010).
  2055*    -------------------------------
  2056     05  TYPE8L PIC S9(0004) COMP.
  2057     05  TYPE8F PIC  X(0001).
  2058     05  FILLER REDEFINES TYPE8F.
  2059         10  TYPE8A PIC  X(0001).
  2060     05  TYPE8I PIC  X(0001).
  2061*    -------------------------------
  2062     05  SINRT8L PIC S9(0004) COMP.
  2063     05  SINRT8F PIC  X(0001).
  2064     05  FILLER REDEFINES SINRT8F.
  2065         10  SINRT8A PIC  X(0001).
  2066     05  SINRT8I PIC  X(0006).
  2067*    -------------------------------
  2068     05  JNTRT8L PIC S9(0004) COMP.
  2069     05  JNTRT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  42
* EL6501.cbl
  2070     05  FILLER REDEFINES JNTRT8F.
  2071         10  JNTRT8A PIC  X(0001).
  2072     05  JNTRT8I PIC  X(0006).
  2073*    -------------------------------
  2074     05  AHRT8L PIC S9(0004) COMP.
  2075     05  AHRT8F PIC  X(0001).
  2076     05  FILLER REDEFINES AHRT8F.
  2077         10  AHRT8A PIC  X(0001).
  2078     05  AHRT8I PIC  X(0006).
  2079*    -------------------------------
  2080     05  RECAL8L PIC S9(0004) COMP.
  2081     05  RECAL8F PIC  X(0001).
  2082     05  FILLER REDEFINES RECAL8F.
  2083         10  RECAL8A PIC  X(0001).
  2084     05  RECAL8I PIC  X(0001).
  2085*    -------------------------------
  2086     05  COMM8L PIC S9(0004) COMP.
  2087     05  COMM8F PIC  X(0001).
  2088     05  FILLER REDEFINES COMM8F.
  2089         10  COMM8A PIC  X(0001).
  2090     05  COMM8I PIC  X(0001).
  2091*    -------------------------------
  2092     05  CHGBK8L PIC S9(0004) COMP.
  2093     05  CHGBK8F PIC  X(0001).
  2094     05  FILLER REDEFINES CHGBK8F.
  2095         10  CHGBK8A PIC  X(0001).
  2096     05  CHGBK8I PIC  X(0002).
  2097*    -------------------------------
  2098     05  GLCDE8L PIC S9(0004) COMP.
  2099     05  GLCDE8F PIC  X(0001).
  2100     05  FILLER REDEFINES GLCDE8F.
  2101         10  GLCDE8A PIC  X(0001).
  2102     05  GLCDE8I PIC  X(0001).
  2103*    -------------------------------
  2104     05  AGNT9L PIC S9(0004) COMP.
  2105     05  AGNT9F PIC  X(0001).
  2106     05  FILLER REDEFINES AGNT9F.
  2107         10  AGNT9A PIC  X(0001).
  2108     05  AGNT9I PIC  X(0010).
  2109*    -------------------------------
  2110     05  TYPE9L PIC S9(0004) COMP.
  2111     05  TYPE9F PIC  X(0001).
  2112     05  FILLER REDEFINES TYPE9F.
  2113         10  TYPE9A PIC  X(0001).
  2114     05  TYPE9I PIC  X(0001).
  2115*    -------------------------------
  2116     05  SINRT9L PIC S9(0004) COMP.
  2117     05  SINRT9F PIC  X(0001).
  2118     05  FILLER REDEFINES SINRT9F.
  2119         10  SINRT9A PIC  X(0001).
  2120     05  SINRT9I PIC  X(0006).
  2121*    -------------------------------
  2122     05  JNTRT9L PIC S9(0004) COMP.
  2123     05  JNTRT9F PIC  X(0001).
  2124     05  FILLER REDEFINES JNTRT9F.
  2125         10  JNTRT9A PIC  X(0001).
  2126     05  JNTRT9I PIC  X(0006).
  2127*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  43
* EL6501.cbl
  2128     05  AHRT9L PIC S9(0004) COMP.
  2129     05  AHRT9F PIC  X(0001).
  2130     05  FILLER REDEFINES AHRT9F.
  2131         10  AHRT9A PIC  X(0001).
  2132     05  AHRT9I PIC  X(0006).
  2133*    -------------------------------
  2134     05  RECAL9L PIC S9(0004) COMP.
  2135     05  RECAL9F PIC  X(0001).
  2136     05  FILLER REDEFINES RECAL9F.
  2137         10  RECAL9A PIC  X(0001).
  2138     05  RECAL9I PIC  X(0001).
  2139*    -------------------------------
  2140     05  COMM9L PIC S9(0004) COMP.
  2141     05  COMM9F PIC  X(0001).
  2142     05  FILLER REDEFINES COMM9F.
  2143         10  COMM9A PIC  X(0001).
  2144     05  COMM9I PIC  X(0001).
  2145*    -------------------------------
  2146     05  CHGBK9L PIC S9(0004) COMP.
  2147     05  CHGBK9F PIC  X(0001).
  2148     05  FILLER REDEFINES CHGBK9F.
  2149         10  CHGBK9A PIC  X(0001).
  2150     05  CHGBK9I PIC  X(0002).
  2151*    -------------------------------
  2152     05  GLCDE9L PIC S9(0004) COMP.
  2153     05  GLCDE9F PIC  X(0001).
  2154     05  FILLER REDEFINES GLCDE9F.
  2155         10  GLCDE9A PIC  X(0001).
  2156     05  GLCDE9I PIC  X(0001).
  2157*    -------------------------------
  2158     05  AGNT10L PIC S9(0004) COMP.
  2159     05  AGNT10F PIC  X(0001).
  2160     05  FILLER REDEFINES AGNT10F.
  2161         10  AGNT10A PIC  X(0001).
  2162     05  AGNT10I PIC  X(0010).
  2163*    -------------------------------
  2164     05  TYPE10L PIC S9(0004) COMP.
  2165     05  TYPE10F PIC  X(0001).
  2166     05  FILLER REDEFINES TYPE10F.
  2167         10  TYPE10A PIC  X(0001).
  2168     05  TYPE10I PIC  X(0001).
  2169*    -------------------------------
  2170     05  SINRT10L PIC S9(0004) COMP.
  2171     05  SINRT10F PIC  X(0001).
  2172     05  FILLER REDEFINES SINRT10F.
  2173         10  SINRT10A PIC  X(0001).
  2174     05  SINRT10I PIC  X(0006).
  2175*    -------------------------------
  2176     05  JNTRT10L PIC S9(0004) COMP.
  2177     05  JNTRT10F PIC  X(0001).
  2178     05  FILLER REDEFINES JNTRT10F.
  2179         10  JNTRT10A PIC  X(0001).
  2180     05  JNTRT10I PIC  X(0006).
  2181*    -------------------------------
  2182     05  AHRT10L PIC S9(0004) COMP.
  2183     05  AHRT10F PIC  X(0001).
  2184     05  FILLER REDEFINES AHRT10F.
  2185         10  AHRT10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  44
* EL6501.cbl
  2186     05  AHRT10I PIC  X(0006).
  2187*    -------------------------------
  2188     05  RECAL10L PIC S9(0004) COMP.
  2189     05  RECAL10F PIC  X(0001).
  2190     05  FILLER REDEFINES RECAL10F.
  2191         10  RECAL10A PIC  X(0001).
  2192     05  RECAL10I PIC  X(0001).
  2193*    -------------------------------
  2194     05  COMM10L PIC S9(0004) COMP.
  2195     05  COMM10F PIC  X(0001).
  2196     05  FILLER REDEFINES COMM10F.
  2197         10  COMM10A PIC  X(0001).
  2198     05  COMM10I PIC  X(0001).
  2199*    -------------------------------
  2200     05  CHGBK10L PIC S9(0004) COMP.
  2201     05  CHGBK10F PIC  X(0001).
  2202     05  FILLER REDEFINES CHGBK10F.
  2203         10  CHGBK10A PIC  X(0001).
  2204     05  CHGBK10I PIC  X(0002).
  2205*    -------------------------------
  2206     05  GLCDE10L PIC S9(0004) COMP.
  2207     05  GLCDE10F PIC  X(0001).
  2208     05  FILLER REDEFINES GLCDE10F.
  2209         10  GLCDE10A PIC  X(0001).
  2210     05  GLCDE10I PIC  X(0001).
  2211*    -------------------------------
  2212     05  ERRMSG1L PIC S9(0004) COMP.
  2213     05  ERRMSG1F PIC  X(0001).
  2214     05  FILLER REDEFINES ERRMSG1F.
  2215         10  ERRMSG1A PIC  X(0001).
  2216     05  ERRMSG1I PIC  X(0075).
  2217*    -------------------------------
  2218     05  PFENTERL PIC S9(0004) COMP.
  2219     05  PFENTERF PIC  X(0001).
  2220     05  FILLER REDEFINES PFENTERF.
  2221         10  PFENTERA PIC  X(0001).
  2222     05  PFENTERI PIC  9(2).
  2223*    -------------------------------
  2224     05  PF1PF2L PIC S9(0004) COMP.
  2225     05  PF1PF2F PIC  X(0001).
  2226     05  FILLER REDEFINES PF1PF2F.
  2227         10  PF1PF2A PIC  X(0001).
  2228     05  PF1PF2I PIC  X(0035).
  2229 01  EL6501AO REDEFINES EL6501AI.
  2230     05  FILLER            PIC  X(0012).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  DATEO PIC  X(0008).
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  TIMEO PIC  99.99.
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  CMPNYIDO PIC  X(0003).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  USERIDO PIC  X(0004).
  2243*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  45
* EL6501.cbl
  2244     05  FILLER            PIC  X(0003).
  2245     05  MAINTO PIC  X(0001).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  CARRO PIC  X(0001).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  GROUPINO PIC  X(0006).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  STATEO PIC  X(0002).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  ACCOUNTO PIC  X(0010).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  EFFDTEO PIC  X(0008).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  EXPDTEO PIC  99B99B99.
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  MAINTBYO PIC  X(0004).
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  PCONTO PIC  X(0030).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  CSRO PIC  X(0004).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  PDSPLYO PIC  X(0006).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  PEFFDTEO PIC  X(0008).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  PEXPDTEO PIC  X(0008).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  NAMEO PIC  X(0030).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  TAXNOO PIC  X(0011).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  STATUSO PIC  X(0001).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  INCAREO PIC  X(0030).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  PHONEO PIC  999B999B9999.
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  INDGRPO PIC  X(0001).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  46
* EL6501.cbl
  2302     05  ADDR1O PIC  X(0030).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  CONTRO PIC  X(0008).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  TYPEO PIC  X(0002).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  ACITYO PIC  X(0028).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  ASTATEO PIC  X(0002).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  PRODATEO PIC  X(0008).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  STDBENO PIC  X(0002).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  ZIPO PIC  X(0010).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  CTPLABLO PIC  X(0010).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  CLPTOLPO PIC  Z.9999.
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  RETROCDO PIC  X(0003).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  BILLCDO PIC  X(0003).
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  LCLABLO PIC  X(0011).
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  LCOMMO PIC  ZZ99.99-.
  2342*    -------------------------------
  2343     05  FILLER            PIC  X(0003).
  2344     05  PSIHEADO PIC  X(0014).
  2345*    -------------------------------
  2346     05  FILLER            PIC  X(0003).
  2347     05  PSILFTO PIC  X(0006).
  2348*    -------------------------------
  2349     05  FILLER            PIC  X(0003).
  2350     05  PSILFCO PIC  X(0001).
  2351*    -------------------------------
  2352     05  FILLER            PIC  X(0003).
  2353     05  PSILFFO PIC  9.99999.
  2354*    -------------------------------
  2355     05  FILLER            PIC  X(0003).
  2356     05  PSIAHTO PIC  X(0006).
  2357*    -------------------------------
  2358     05  FILLER            PIC  X(0003).
  2359     05  PSIAHCO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  47
* EL6501.cbl
  2360*    -------------------------------
  2361     05  FILLER            PIC  X(0003).
  2362     05  PSIAHFO PIC  9.99999.
  2363*    -------------------------------
  2364     05  FILLER            PIC  X(0003).
  2365     05  REMITO PIC  X(0002).
  2366*    -------------------------------
  2367     05  FILLER            PIC  X(0003).
  2368     05  COMMCALO PIC  X(0001).
  2369*    -------------------------------
  2370     05  FILLER            PIC  X(0003).
  2371     05  REINTABO PIC  X(0003).
  2372*    -------------------------------
  2373     05  FILLER            PIC  X(0003).
  2374     05  REINCALO PIC  X(0001).
  2375*    -------------------------------
  2376     05  FILLER            PIC  X(0003).
  2377     05  AHHEADO PIC  X(0006).
  2378*    -------------------------------
  2379     05  FILLER            PIC  X(0003).
  2380     05  AGNT1O PIC  X(0010).
  2381*    -------------------------------
  2382     05  FILLER            PIC  X(0003).
  2383     05  TYPE1O PIC  X(0001).
  2384*    -------------------------------
  2385     05  FILLER            PIC  X(0003).
  2386     05  SINRT1O PIC  X(0006).
  2387*    -------------------------------
  2388     05  FILLER            PIC  X(0003).
  2389     05  JNTRT1O PIC  X(0006).
  2390*    -------------------------------
  2391     05  FILLER            PIC  X(0003).
  2392     05  AHRT1O PIC  X(0006).
  2393*    -------------------------------
  2394     05  FILLER            PIC  X(0003).
  2395     05  RECAL1O PIC  X(0001).
  2396*    -------------------------------
  2397     05  FILLER            PIC  X(0003).
  2398     05  COMM1O PIC  X(0001).
  2399*    -------------------------------
  2400     05  FILLER            PIC  X(0003).
  2401     05  CHGBK1O PIC  X(0002).
  2402*    -------------------------------
  2403     05  FILLER            PIC  X(0003).
  2404     05  GLCDE1O PIC  X(0001).
  2405*    -------------------------------
  2406     05  FILLER            PIC  X(0003).
  2407     05  AGNT2O PIC  X(0010).
  2408*    -------------------------------
  2409     05  FILLER            PIC  X(0003).
  2410     05  TYPE2O PIC  X(0001).
  2411*    -------------------------------
  2412     05  FILLER            PIC  X(0003).
  2413     05  SINRT2O PIC  X(0006).
  2414*    -------------------------------
  2415     05  FILLER            PIC  X(0003).
  2416     05  JNTRT2O PIC  X(0006).
  2417*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  48
* EL6501.cbl
  2418     05  FILLER            PIC  X(0003).
  2419     05  AHRT2O PIC  X(0006).
  2420*    -------------------------------
  2421     05  FILLER            PIC  X(0003).
  2422     05  RECAL2O PIC  X(0001).
  2423*    -------------------------------
  2424     05  FILLER            PIC  X(0003).
  2425     05  COMM2O PIC  X(0001).
  2426*    -------------------------------
  2427     05  FILLER            PIC  X(0003).
  2428     05  CHGBK2O PIC  X(0002).
  2429*    -------------------------------
  2430     05  FILLER            PIC  X(0003).
  2431     05  GLCDE2O PIC  X(0001).
  2432*    -------------------------------
  2433     05  FILLER            PIC  X(0003).
  2434     05  AGNT3O PIC  X(0010).
  2435*    -------------------------------
  2436     05  FILLER            PIC  X(0003).
  2437     05  TYPE3O PIC  X(0001).
  2438*    -------------------------------
  2439     05  FILLER            PIC  X(0003).
  2440     05  SINRT3O PIC  X(0006).
  2441*    -------------------------------
  2442     05  FILLER            PIC  X(0003).
  2443     05  JNTRT3O PIC  X(0006).
  2444*    -------------------------------
  2445     05  FILLER            PIC  X(0003).
  2446     05  AHRT3O PIC  X(0006).
  2447*    -------------------------------
  2448     05  FILLER            PIC  X(0003).
  2449     05  RECAL3O PIC  X(0001).
  2450*    -------------------------------
  2451     05  FILLER            PIC  X(0003).
  2452     05  COMM3O PIC  X(0001).
  2453*    -------------------------------
  2454     05  FILLER            PIC  X(0003).
  2455     05  CHGBK3O PIC  X(0002).
  2456*    -------------------------------
  2457     05  FILLER            PIC  X(0003).
  2458     05  GLCDE3O PIC  X(0001).
  2459*    -------------------------------
  2460     05  FILLER            PIC  X(0003).
  2461     05  AGNT4O PIC  X(0010).
  2462*    -------------------------------
  2463     05  FILLER            PIC  X(0003).
  2464     05  TYPE4O PIC  X(0001).
  2465*    -------------------------------
  2466     05  FILLER            PIC  X(0003).
  2467     05  SINRT4O PIC  X(0006).
  2468*    -------------------------------
  2469     05  FILLER            PIC  X(0003).
  2470     05  JNTRT4O PIC  X(0006).
  2471*    -------------------------------
  2472     05  FILLER            PIC  X(0003).
  2473     05  AHRT4O PIC  X(0006).
  2474*    -------------------------------
  2475     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  49
* EL6501.cbl
  2476     05  RECAL4O PIC  X(0001).
  2477*    -------------------------------
  2478     05  FILLER            PIC  X(0003).
  2479     05  COMM4O PIC  X(0001).
  2480*    -------------------------------
  2481     05  FILLER            PIC  X(0003).
  2482     05  CHGBK4O PIC  X(0002).
  2483*    -------------------------------
  2484     05  FILLER            PIC  X(0003).
  2485     05  GLCDE4O PIC  X(0001).
  2486*    -------------------------------
  2487     05  FILLER            PIC  X(0003).
  2488     05  AGNT5O PIC  X(0010).
  2489*    -------------------------------
  2490     05  FILLER            PIC  X(0003).
  2491     05  TYPE5O PIC  X(0001).
  2492*    -------------------------------
  2493     05  FILLER            PIC  X(0003).
  2494     05  SINRT5O PIC  X(0006).
  2495*    -------------------------------
  2496     05  FILLER            PIC  X(0003).
  2497     05  JNTRT5O PIC  X(0006).
  2498*    -------------------------------
  2499     05  FILLER            PIC  X(0003).
  2500     05  AHRT5O PIC  X(0006).
  2501*    -------------------------------
  2502     05  FILLER            PIC  X(0003).
  2503     05  RECAL5O PIC  X(0001).
  2504*    -------------------------------
  2505     05  FILLER            PIC  X(0003).
  2506     05  COMM5O PIC  X(0001).
  2507*    -------------------------------
  2508     05  FILLER            PIC  X(0003).
  2509     05  CHGBK5O PIC  X(0002).
  2510*    -------------------------------
  2511     05  FILLER            PIC  X(0003).
  2512     05  GLCDE5O PIC  X(0001).
  2513*    -------------------------------
  2514     05  FILLER            PIC  X(0003).
  2515     05  AGNT6O PIC  X(0010).
  2516*    -------------------------------
  2517     05  FILLER            PIC  X(0003).
  2518     05  TYPE6O PIC  X(0001).
  2519*    -------------------------------
  2520     05  FILLER            PIC  X(0003).
  2521     05  SINRT6O PIC  X(0006).
  2522*    -------------------------------
  2523     05  FILLER            PIC  X(0003).
  2524     05  JNTRT6O PIC  X(0006).
  2525*    -------------------------------
  2526     05  FILLER            PIC  X(0003).
  2527     05  AHRT6O PIC  X(0006).
  2528*    -------------------------------
  2529     05  FILLER            PIC  X(0003).
  2530     05  RECAL6O PIC  X(0001).
  2531*    -------------------------------
  2532     05  FILLER            PIC  X(0003).
  2533     05  COMM6O PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  50
* EL6501.cbl
  2534*    -------------------------------
  2535     05  FILLER            PIC  X(0003).
  2536     05  CHGBK6O PIC  X(0002).
  2537*    -------------------------------
  2538     05  FILLER            PIC  X(0003).
  2539     05  GLCDE6O PIC  X(0001).
  2540*    -------------------------------
  2541     05  FILLER            PIC  X(0003).
  2542     05  AGNT7O PIC  X(0010).
  2543*    -------------------------------
  2544     05  FILLER            PIC  X(0003).
  2545     05  TYPE7O PIC  X(0001).
  2546*    -------------------------------
  2547     05  FILLER            PIC  X(0003).
  2548     05  SINRT7O PIC  X(0006).
  2549*    -------------------------------
  2550     05  FILLER            PIC  X(0003).
  2551     05  JNTRT7O PIC  X(0006).
  2552*    -------------------------------
  2553     05  FILLER            PIC  X(0003).
  2554     05  AHRT7O PIC  X(0006).
  2555*    -------------------------------
  2556     05  FILLER            PIC  X(0003).
  2557     05  RECAL7O PIC  X(0001).
  2558*    -------------------------------
  2559     05  FILLER            PIC  X(0003).
  2560     05  COMM7O PIC  X(0001).
  2561*    -------------------------------
  2562     05  FILLER            PIC  X(0003).
  2563     05  CHGBK7O PIC  X(0002).
  2564*    -------------------------------
  2565     05  FILLER            PIC  X(0003).
  2566     05  GLCDE7O PIC  X(0001).
  2567*    -------------------------------
  2568     05  FILLER            PIC  X(0003).
  2569     05  AGNT8O PIC  X(0010).
  2570*    -------------------------------
  2571     05  FILLER            PIC  X(0003).
  2572     05  TYPE8O PIC  X(0001).
  2573*    -------------------------------
  2574     05  FILLER            PIC  X(0003).
  2575     05  SINRT8O PIC  X(0006).
  2576*    -------------------------------
  2577     05  FILLER            PIC  X(0003).
  2578     05  JNTRT8O PIC  X(0006).
  2579*    -------------------------------
  2580     05  FILLER            PIC  X(0003).
  2581     05  AHRT8O PIC  X(0006).
  2582*    -------------------------------
  2583     05  FILLER            PIC  X(0003).
  2584     05  RECAL8O PIC  X(0001).
  2585*    -------------------------------
  2586     05  FILLER            PIC  X(0003).
  2587     05  COMM8O PIC  X(0001).
  2588*    -------------------------------
  2589     05  FILLER            PIC  X(0003).
  2590     05  CHGBK8O PIC  X(0002).
  2591*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  51
* EL6501.cbl
  2592     05  FILLER            PIC  X(0003).
  2593     05  GLCDE8O PIC  X(0001).
  2594*    -------------------------------
  2595     05  FILLER            PIC  X(0003).
  2596     05  AGNT9O PIC  X(0010).
  2597*    -------------------------------
  2598     05  FILLER            PIC  X(0003).
  2599     05  TYPE9O PIC  X(0001).
  2600*    -------------------------------
  2601     05  FILLER            PIC  X(0003).
  2602     05  SINRT9O PIC  X(0006).
  2603*    -------------------------------
  2604     05  FILLER            PIC  X(0003).
  2605     05  JNTRT9O PIC  X(0006).
  2606*    -------------------------------
  2607     05  FILLER            PIC  X(0003).
  2608     05  AHRT9O PIC  X(0006).
  2609*    -------------------------------
  2610     05  FILLER            PIC  X(0003).
  2611     05  RECAL9O PIC  X(0001).
  2612*    -------------------------------
  2613     05  FILLER            PIC  X(0003).
  2614     05  COMM9O PIC  X(0001).
  2615*    -------------------------------
  2616     05  FILLER            PIC  X(0003).
  2617     05  CHGBK9O PIC  X(0002).
  2618*    -------------------------------
  2619     05  FILLER            PIC  X(0003).
  2620     05  GLCDE9O PIC  X(0001).
  2621*    -------------------------------
  2622     05  FILLER            PIC  X(0003).
  2623     05  AGNT10O PIC  X(0010).
  2624*    -------------------------------
  2625     05  FILLER            PIC  X(0003).
  2626     05  TYPE10O PIC  X(0001).
  2627*    -------------------------------
  2628     05  FILLER            PIC  X(0003).
  2629     05  SINRT10O PIC  X(0006).
  2630*    -------------------------------
  2631     05  FILLER            PIC  X(0003).
  2632     05  JNTRT10O PIC  X(0006).
  2633*    -------------------------------
  2634     05  FILLER            PIC  X(0003).
  2635     05  AHRT10O PIC  X(0006).
  2636*    -------------------------------
  2637     05  FILLER            PIC  X(0003).
  2638     05  RECAL10O PIC  X(0001).
  2639*    -------------------------------
  2640     05  FILLER            PIC  X(0003).
  2641     05  COMM10O PIC  X(0001).
  2642*    -------------------------------
  2643     05  FILLER            PIC  X(0003).
  2644     05  CHGBK10O PIC  X(0002).
  2645*    -------------------------------
  2646     05  FILLER            PIC  X(0003).
  2647     05  GLCDE10O PIC  X(0001).
  2648*    -------------------------------
  2649     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  52
* EL6501.cbl
  2650     05  ERRMSG1O PIC  X(0075).
  2651*    -------------------------------
  2652     05  FILLER            PIC  X(0003).
  2653     05  PFENTERO PIC  X(0002).
  2654*    -------------------------------
  2655     05  FILLER            PIC  X(0003).
  2656     05  PF1PF2O PIC  X(0035).
  2657*    -------------------------------
  2658 01  MAP-R REDEFINES EL6501AI.
  2659*    12  FILLER                  PIC X(518).
  2660     12  FILLER                  PIC X(546).
  2661     12  MAP-AGENT-AREA.
  2662         16  AGENT-AREA OCCURS 10 TIMES INDEXED BY M-INDEX.
  2663             20  AGENTL          PIC S9(4) COMP.
  2664             20  AGENTA          PIC X.
  2665             20  AGENT           PIC X(10).
  2666             20  ATYPEL          PIC S9(4) COMP.
  2667             20  ATYPEA          PIC X.
  2668             20  ATYPE           PIC X.
  2669             20  SINGLEL         PIC S9(4) COMP.
  2670             20  SINGLEA         PIC X.
  2671             20  SINGLE-COMM-T   PIC X(6).
  2672             20  SINGLE-COMM-N REDEFINES SINGLE-COMM-T.
  2673                 24  SINGLE-COMM-R PIC V9(5).
  2674                 24  SINGLE-DASH   PIC X.
  2675             20  SINGLE-COMM-O REDEFINES SINGLE-COMM-T
  2676                                 PIC V9(5)-.
  2677             20  JOINTL          PIC S9(4) COMP.
  2678             20  JOINTA          PIC X.
  2679             20  JOINT-COMM-T    PIC X(6).
  2680             20  JOINT-COMM-N REDEFINES JOINT-COMM-T.
  2681                 24  JOINT-COMM-R PIC V9(5).
  2682                 24  JOINT-DASH   PIC X.
  2683             20  JOINT-COMM-O REDEFINES JOINT-COMM-T
  2684                                 PIC V9(5)-.
  2685             20  A-HL            PIC S9(4) COMP.
  2686             20  A-HA            PIC X.
  2687             20  A-H-COMM-T      PIC X(6).
  2688             20  A-H-COMM-N  REDEFINES A-H-COMM-T.
  2689                 24  A-H-COMM-R  PIC V9(5).
  2690                 24  A-H-DASH    PIC X.
  2691             20  A-H-COMM-O  REDEFINES A-H-COMM-T
  2692                                 PIC V9(5)-.
  2693             20  RECALL          PIC S9(4) COMP.
  2694             20  RECALA          PIC X.
  2695             20  RECAL           PIC X.
  2696             20  RCOMML          PIC S9(4) COMP.
  2697             20  RCOMMA          PIC X.
  2698             20  RCOMM           PIC X.
  2699             20  CHGBCKL         PIC S9(4) COMP.
  2700             20  CHGBCKA         PIC X.
  2701             20  CHGBCK          PIC X(02).
  2702             20  GLCODEL         PIC S9(4) COMP.
  2703             20  GLCODEA         PIC X.
  2704             20  GLCODE          PIC X.
  2705****************************************************************
  2706*
  2707* Copyright (c) 2007 by Clerity Solutions, Inc.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  53
* EL6501.cbl
  2708* All rights reserved.
  2709*
  2710****************************************************************
  2711 01  DFHEIV.
  2712   02  DFHEIV0               PIC X(35).
  2713   02  DFHEIV1               PIC X(08).
  2714   02  DFHEIV2               PIC X(08).
  2715   02  DFHEIV3               PIC X(08).
  2716   02  DFHEIV4               PIC X(06).
  2717   02  DFHEIV5               PIC X(04).
  2718   02  DFHEIV6               PIC X(04).
  2719   02  DFHEIV7               PIC X(02).
  2720   02  DFHEIV8               PIC X(02).
  2721   02  DFHEIV9               PIC X(01).
  2722   02  DFHEIV10              PIC S9(7) COMP-3.
  2723   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2724   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2725   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2726   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2727   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2728   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2729   02  DFHEIV17              PIC X(04).
  2730   02  DFHEIV18              PIC X(04).
  2731   02  DFHEIV19              PIC X(04).
  2732   02  DFHEIV20              USAGE IS POINTER.
  2733   02  DFHEIV21              USAGE IS POINTER.
  2734   02  DFHEIV22              USAGE IS POINTER.
  2735   02  DFHEIV23              USAGE IS POINTER.
  2736   02  DFHEIV24              USAGE IS POINTER.
  2737   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2738   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2739   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2740   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2741   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2742   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2743   02  FILLER                PIC X(02).
  2744   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2745   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2746   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2747   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2748   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2749 LINKAGE  SECTION.
  2750*****************************************************************
  2751*                                                               *
  2752* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2753* All rights reserved.                                          *
  2754*                                                               *
  2755*****************************************************************
  2756 01  dfheiblk.
  2757     02  eibtime          pic s9(7) comp-3.
  2758     02  eibdate          pic s9(7) comp-3.
  2759     02  eibtrnid         pic x(4).
  2760     02  eibtaskn         pic s9(7) comp-3.
  2761     02  eibtrmid         pic x(4).
  2762     02  dfheigdi         pic s9(4) comp.
  2763     02  eibcposn         pic s9(4) comp.
  2764     02  eibcalen         pic s9(4) comp.
  2765     02  eibaid           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  54
* EL6501.cbl
  2766     02  eibfiller1       pic x(1).
  2767     02  eibfn            pic x(2).
  2768     02  eibfiller2       pic x(2).
  2769     02  eibrcode         pic x(6).
  2770     02  eibfiller3       pic x(2).
  2771     02  eibds            pic x(8).
  2772     02  eibreqid         pic x(8).
  2773     02  eibrsrce         pic x(8).
  2774     02  eibsync          pic x(1).
  2775     02  eibfree          pic x(1).
  2776     02  eibrecv          pic x(1).
  2777     02  eibsend          pic x(1).
  2778     02  eibatt           pic x(1).
  2779     02  eibeoc           pic x(1).
  2780     02  eibfmh           pic x(1).
  2781     02  eibcompl         pic x(1).
  2782     02  eibsig           pic x(1).
  2783     02  eibconf          pic x(1).
  2784     02  eiberr           pic x(1).
  2785     02  eibrldbk         pic x(1).
  2786     02  eiberrcd         pic x(4).
  2787     02  eibsynrb         pic x(1).
  2788     02  eibnodat         pic x(1).
  2789     02  eibfiller5       pic x(2).
  2790     02  eibresp          pic 9(09) comp.
  2791     02  eibresp2         pic 9(09) comp.
  2792     02  dfheigdj         pic s9(4) comp.
  2793     02  dfheigdk         pic s9(4) comp.
  2794 01  DFHCOMMAREA                 PIC X(1500).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  55
* EL6501.cbl
  2796*01 PARMLIST .
  2797*    02  FILLER                  PIC S9(8)   COMP.
  2798*    02  ERACCT-POINTER          PIC S9(8)   COMP.
  2799*    02  ELCNTL-POINTER          PIC S9(8)   COMP.
  2800*    02  REIN-POINTER            PIC S9(8)   COMP.
  2801*    02  CTBL-POINTER            PIC S9(8)   COMP.
  2802*    02  COMM-POINTER            PIC S9(8)   COMP.
  2803*    02  COMP-POINTER            PIC S9(8)   COMP.
  2804*    02  NAME-POINTER            PIC S9(8)   COMP.
  2805*    02  RQST-POINTER            PIC S9(8)   COMP.
  2806*    02  AXRF-POINTER            PIC S9(8)   COMP.
  2807*    02  AXRF2-POINTER           PIC S9(8)   COMP.
  2808*    02  AXRF3-POINTER           PIC S9(8)   COMP.
  2809*    02  AXRF4-POINTER           PIC S9(8)   COMP.
  2810*    02  AXRF5-POINTER           PIC S9(8)   COMP.
  2811*    02  AXRF6-POINTER           PIC S9(8)   COMP.
  2812*    02  AXRF7-POINTER           PIC S9(8)   COMP.
  2813*    02  AXRF8-POINTER           PIC S9(8)   COMP.
  2814*    COPY ERCACCT.
  2815******************************************************************
  2816*                                                                *
  2817*                                                                *
  2818*                            ERCACCT                             *
  2819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2820*                            VMOD=2.031                          *
  2821*                                                                *
  2822*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2823*                                                                *
  2824*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2825*   VSAM ACCOUNT MASTER FILES.                                   *
  2826*                                                                *
  2827*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2828*                                                                *
  2829*   FILE TYPE = VSAM,KSDS                                        *
  2830*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2831*                                                                *
  2832*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2833*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2834*                                                                *
  2835*   LOG = NO                                                     *
  2836*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2837*                                                                *
  2838*                                                                *
  2839******************************************************************
  2840*                   C H A N G E   L O G
  2841*
  2842* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2843*-----------------------------------------------------------------
  2844*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2845* EFFECTIVE    NUMBER
  2846*-----------------------------------------------------------------
  2847* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2848* 092705    2005050300006  PEMA  ADD SPP LEASES
  2849* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2850* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2851******************************************************************
  2852
  2853 01  ACCOUNT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  56
* EL6501.cbl
  2854     12  AM-RECORD-ID                      PIC XX.
  2855         88  VALID-AM-ID                      VALUE 'AM'.
  2856
  2857     12  AM-CONTROL-PRIMARY.
  2858         16  AM-COMPANY-CD                 PIC X.
  2859         16  AM-MSTR-CNTRL.
  2860             20  AM-CONTROL-A.
  2861                 24  AM-CARRIER            PIC X.
  2862                 24  AM-GROUPING.
  2863                     28 AM-GROUPING-PREFIX PIC XXX.
  2864                     28 AM-GROUPING-PRIME  PIC XXX.
  2865                 24  AM-STATE              PIC XX.
  2866                 24  AM-ACCOUNT.
  2867                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2868                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2869             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2870                                           PIC X(19).
  2871             20  AM-CNTRL-B.
  2872                 24  AM-EXPIRATION-DT      PIC XX.
  2873                 24  FILLER                PIC X(4).
  2874             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2875                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2876
  2877     12  AM-CONTROL-BY-VAR-GRP.
  2878         16  AM-COMPANY-CD-A1              PIC X.
  2879         16  AM-VG-CARRIER                 PIC X.
  2880         16  AM-VG-GROUPING                PIC X(6).
  2881         16  AM-VG-STATE                   PIC XX.
  2882         16  AM-VG-ACCOUNT                 PIC X(10).
  2883         16  AM-VG-DATE.
  2884             20  AM-VG-EXPIRATION-DT       PIC XX.
  2885             20  FILLER                    PIC X(4).
  2886         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2887                                           PIC 9(11)      COMP-3.
  2888     12  AM-MAINT-INFORMATION.
  2889         16  AM-LAST-MAINT-DT              PIC XX.
  2890         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2891         16  AM-LAST-MAINT-USER            PIC X(4).
  2892         16  FILLER                        PIC XX.
  2893
  2894     12  AM-EFFECTIVE-DT                   PIC XX.
  2895     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2896
  2897     12  AM-PREV-DATES  COMP-3.
  2898         16  AM-PREV-EXP-DT                PIC 9(11).
  2899         16  AM-PREV-EFF-DT                PIC 9(11).
  2900
  2901     12  AM-REPORT-CODE-1                  PIC X(10).
  2902     12  AM-REPORT-CODE-2                  PIC X(10).
  2903
  2904     12  AM-CITY-CODE                      PIC X(4).
  2905     12  AM-COUNTY-PARISH                  PIC X(6).
  2906
  2907     12  AM-NAME                           PIC X(30).
  2908     12  AM-PERSON                         PIC X(30).
  2909     12  AM-ADDRS                          PIC X(30).
  2910     12  AM-CITY.
  2911         16  AM-ADDR-CITY                  PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  57
* EL6501.cbl
  2912         16  AM-ADDR-STATE                 PIC XX.
  2913     12  AM-ZIP.
  2914         16  AM-ZIP-PRIME.
  2915             20  AM-ZIP-PRI-1ST            PIC X.
  2916                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2917             20  FILLER                    PIC X(4).
  2918         16  AM-ZIP-PLUS4                  PIC X(4).
  2919     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2920         16  AM-CAN-POSTAL-1               PIC XXX.
  2921         16  AM-CAN-POSTAL-2               PIC XXX.
  2922         16  FILLER                        PIC XXX.
  2923     12  AM-TEL-NO.
  2924         16  AM-AREA-CODE                  PIC 999.
  2925         16  AM-TEL-PRE                    PIC 999.
  2926         16  AM-TEL-NBR                    PIC 9(4).
  2927     12  AM-TEL-LOC                        PIC X.
  2928         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2929         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2930
  2931     12  AM-COMM-STRUCTURE.
  2932         16  AM-DEFN-1.
  2933             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2934                 24  AM-AGT.
  2935                     28  AM-AGT-PREFIX     PIC X(4).
  2936                     28  AM-AGT-PRIME      PIC X(6).
  2937                 24  AM-COM-TYP            PIC X.
  2938                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2939                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2940                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2941                 24  AM-RECALC-LV-INDIC    PIC X.
  2942                 24  AM-RETRO-LV-INDIC     PIC X.
  2943                 24  AM-GL-CODES           PIC X.
  2944                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2945                 24  FILLER                PIC X(01).
  2946         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2947             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2948                 24  FILLER                PIC X(11).
  2949                 24  AM-L-COMA             PIC XXX.
  2950                 24  AM-J-COMA             PIC XXX.
  2951                 24  AM-A-COMA             PIC XXX.
  2952                 24  FILLER                PIC X(6).
  2953
  2954     12  AM-COMM-CHANGE-STATUS             PIC X.
  2955         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2956
  2957     12  AM-CSR-CODE                       PIC X(4).
  2958
  2959     12  AM-BILLING-STATUS                 PIC X.
  2960         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2961         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2962     12  AM-AUTO-REFUND-SW                 PIC X.
  2963         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2964         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2965     12  AM-GPCD                           PIC 99.
  2966     12  AM-IG                             PIC X.
  2967         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2968         88  AM-HAS-GROUP                     VALUE '2'.
  2969     12  AM-STATUS                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  58
* EL6501.cbl
  2970         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2971         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2972         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2973         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2974         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2975     12  AM-REMIT-TO                       PIC 99.
  2976     12  AM-ID-NO                          PIC X(11).
  2977
  2978     12  AM-CAL-TABLE                      PIC XX.
  2979     12  AM-LF-DEVIATION                   PIC XXX.
  2980     12  AM-AH-DEVIATION                   PIC XXX.
  2981     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2982     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2983     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2984     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2985     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2986     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2987
  2988     12  AM-USER-FIELDS.
  2989         16  AM-FLD-1                      PIC XX.
  2990         16  AM-FLD-2                      PIC XX.
  2991         16  AM-FLD-3                      PIC XX.
  2992         16  AM-FLD-4                      PIC XX.
  2993         16  AM-FLD-5                      PIC XX.
  2994
  2995     12  AM-1ST-PROD-DATE.
  2996         16  AM-1ST-PROD-YR                PIC XX.
  2997         16  AM-1ST-PROD-MO                PIC XX.
  2998         16  AM-1ST-PROD-DA                PIC XX.
  2999     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3000     12  AM-CERTS-PURGED-DATE.
  3001         16  AM-PUR-YR                     PIC XX.
  3002         16  AM-PUR-MO                     PIC XX.
  3003         16  AM-PUR-DA                     PIC XX.
  3004     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3005     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3006     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3007     12  AM-INACTIVE-DATE.
  3008         16  AM-INA-MO                     PIC 99.
  3009         16  AM-INA-DA                     PIC 99.
  3010         16  AM-INA-YR                     PIC 99.
  3011     12  AM-AR-HI-CERT-DATE                PIC XX.
  3012
  3013     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3014     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3015
  3016     12  AM-OB-PAYMENT-MODE                PIC X.
  3017         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3018         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3019         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3020         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3021
  3022     12  AM-AH-ONLY-INDICATOR              PIC X.
  3023         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3024         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3025
  3026     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3027
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  59
* EL6501.cbl
  3028     12  AM-OVER-SHORT.
  3029         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3030         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3031
  3032     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3033     12  AM-DCC-CLP-STATE                  PIC XX.
  3034
  3035     12  AM-RECALC-COMM                    PIC X.
  3036     12  AM-RECALC-REIN                    PIC X.
  3037
  3038     12  AM-REI-TABLE                      PIC XXX.
  3039     12  AM-REI-ET-LF                      PIC X.
  3040     12  AM-REI-ET-AH                      PIC X.
  3041     12  AM-REI-PE-LF                      PIC X.
  3042     12  AM-REI-PE-AH                      PIC X.
  3043     12  AM-REI-PRT-ST                     PIC X.
  3044     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3045     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3046     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3047     12  AM-REI-GROUP-A                    PIC X(6).
  3048     12  AM-REI-MORT                       PIC X(4).
  3049     12  AM-REI-PRT-OW                     PIC X.
  3050     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3051     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3052     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3053     12  AM-REI-GROUP-B                    PIC X(6).
  3054
  3055     12  AM-TRUST-TYPE                     PIC X(2).
  3056
  3057     12  AM-EMPLOYER-STMT-USED             PIC X.
  3058     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3059
  3060     12  AM-STD-AH-TYPE                    PIC XX.
  3061     12  AM-EARN-METHODS.
  3062         16  AM-EARN-METHOD-R              PIC X.
  3063             88 AM-REF-RL-R78                 VALUE 'R'.
  3064             88 AM-REF-RL-PR                  VALUE 'P'.
  3065             88 AM-REF-RL-MEAN                VALUE 'M'.
  3066             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3067         16  AM-EARN-METHOD-L              PIC X.
  3068             88 AM-REF-LL-R78                 VALUE 'R'.
  3069             88 AM-REF-LL-PR                  VALUE 'P'.
  3070             88 AM-REF-LL-MEAN                VALUE 'M'.
  3071             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3072         16  AM-EARN-METHOD-A              PIC X.
  3073             88 AM-REF-AH-R78                 VALUE 'R'.
  3074             88 AM-REF-AH-PR                  VALUE 'P'.
  3075             88 AM-REF-AH-MEAN                VALUE 'M'.
  3076             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3077             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3078             88 AM-REF-AH-NET                 VALUE 'N'.
  3079
  3080     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3081     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3082     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3083
  3084     12  AM-RET-Y-N                        PIC X.
  3085     12  AM-RET-P-E                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  60
* EL6501.cbl
  3086     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3087     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3088     12  AM-RET-GRP                        PIC X(6).
  3089     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3090         16  AM-POOL-PRIME                 PIC XXX.
  3091         16  AM-POOL-SUB                   PIC XXX.
  3092     12  AM-RETRO-EARNINGS.
  3093         16  AM-RET-EARN-R                 PIC X.
  3094         16  AM-RET-EARN-L                 PIC X.
  3095         16  AM-RET-EARN-A                 PIC X.
  3096     12  AM-RET-ST-TAX-USE                 PIC X.
  3097         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3098         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3099     12  AM-RETRO-BEG-EARNINGS.
  3100         16  AM-RET-BEG-EARN-R             PIC X.
  3101         16  AM-RET-BEG-EARN-L             PIC X.
  3102         16  AM-RET-BEG-EARN-A             PIC X.
  3103     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3104     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3105
  3106     12  AM-USER-SELECT-OPTIONS.
  3107         16  AM-USER-SELECT-1              PIC X(10).
  3108         16  AM-USER-SELECT-2              PIC X(10).
  3109         16  AM-USER-SELECT-3              PIC X(10).
  3110         16  AM-USER-SELECT-4              PIC X(10).
  3111         16  AM-USER-SELECT-5              PIC X(10).
  3112
  3113     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3114
  3115     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3116
  3117     12  AM-RPT045A-SWITCH                 PIC X.
  3118         88  RPT045A-OFF                   VALUE 'N'.
  3119
  3120     12  AM-INSURANCE-LIMITS.
  3121         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3122         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3123
  3124     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3125         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3126
  3127     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3128         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3129         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3130
  3131     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3132
  3133     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3134     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3135     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3136     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3137     12  FILLER                            PIC X(5).
  3138     12  AM-REPORT-CODE-3                  PIC X(10).
  3139*    12  FILLER                            PIC X(22).
  3140
  3141     12  AM-RESERVE-DATE.
  3142         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3143         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  61
* EL6501.cbl
  3144         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3145
  3146     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3147     12  AM-NOTIFICATION-TYPES.
  3148         16  AM-NOTIF-OF-LETTERS           PIC X.
  3149         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3150         16  AM-NOTIF-OF-REPORTS           PIC X.
  3151         16  AM-NOTIF-OF-STATUS            PIC X.
  3152
  3153     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3154         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3155         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3156         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3157         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3158
  3159     12  AM-BENEFIT-CONTROLS.
  3160         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3161             20  AM-BENEFIT-CODE           PIC XX.
  3162             20  AM-BENEFIT-TYPE           PIC X.
  3163             20  AM-BENEFIT-REVISION       PIC XXX.
  3164             20  AM-BENEFIT-REM-TERM       PIC X.
  3165             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3166             20  FILLER                    PIC XX.
  3167         16  FILLER                        PIC X(80).
  3168
  3169     12  AM-TRANSFER-DATA.
  3170         16  AM-TRANSFERRED-FROM.
  3171             20  AM-TRNFROM-CARRIER        PIC X.
  3172             20  AM-TRNFROM-GROUPING.
  3173                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3174                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3175             20  AM-TRNFROM-STATE          PIC XX.
  3176             20  AM-TRNFROM-ACCOUNT.
  3177                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3178                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3179             20  AM-TRNFROM-DTE            PIC XX.
  3180         16  AM-TRANSFERRED-TO.
  3181             20  AM-TRNTO-CARRIER          PIC X.
  3182             20  AM-TRNTO-GROUPING.
  3183                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3184                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3185             20  AM-TRNTO-STATE            PIC XX.
  3186             20  AM-TRNTO-ACCOUNT.
  3187                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3188                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3189             20  AM-TRNTO-DTE              PIC XX.
  3190         16  FILLER                        PIC X(10).
  3191
  3192     12  AM-SAVED-REMIT-TO                 PIC 99.
  3193
  3194     12  AM-COMM-STRUCTURE-SAVED.
  3195         16  AM-DEFN-1-SAVED.
  3196             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3197                 24  AM-AGT-SV             PIC X(10).
  3198                 24  AM-COM-TYP-SV         PIC X.
  3199                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3200                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3201                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  62
* EL6501.cbl
  3202                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3203                 24  FILLER                PIC X.
  3204                 24  AM-GL-CODES-SV        PIC X.
  3205                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3206                 24  FILLER                PIC X.
  3207         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3208             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3209                 24  FILLER                PIC X(11).
  3210                 24  AM-L-COMA-SV          PIC XXX.
  3211                 24  AM-J-COMA-SV          PIC XXX.
  3212                 24  AM-A-COMA-SV          PIC XXX.
  3213                 24  FILLER                PIC X(6).
  3214
  3215     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3216         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3217            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3218            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3219            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3220
  3221     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3222     12  FILLER                            PIC X(120).
  3223
  3224     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3225         16  AM-CONTROL-NAME               PIC X(30).
  3226         16  AM-EXECUTIVE-ONE.
  3227             20  AM-EXEC1-NAME             PIC X(15).
  3228             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3229                                                          COMP-3.
  3230             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3231                                                          COMP-3.
  3232         16  AM-EXECUTIVE-TWO.
  3233             20  AM-EXEC2-NAME             PIC X(15).
  3234             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3235                                                          COMP-3.
  3236             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3237                                                          COMP-3.
  3238
  3239     12  AM-RETRO-ADDITIONAL-DATA.
  3240         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3241         16  AM-RETRO-PREM-P-E             PIC X.
  3242         16  AM-RETRO-CLMS-P-I             PIC X.
  3243         16  AM-RETRO-RET-BRACKET-LF.
  3244             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3245                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3246                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3247             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3248                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3249                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3250             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3251                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3252                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3253         16  AM-RETRO-RET-BRACKET-AH.
  3254             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3255                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3256                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3257                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3258             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3259                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  63
* EL6501.cbl
  3260                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3261             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3262                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3263                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3264
  3265     12  AM-COMMENTS.
  3266         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3267
  3268     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3269         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3270         16  AM-FLI-BILLING-CODE           PIC X.
  3271         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3272         16  AM-FLI-UNITED-IDENT           PIC X.
  3273         16  AM-FLI-INTEREST-LOST-DATA.
  3274             20  AM-FLI-BANK-NO            PIC X(5).
  3275             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3276             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3277             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3278         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3279             20  AM-FLI-AGT                PIC X(9).
  3280             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3281             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3282         16  FILLER                        PIC X(102).
  3283
  3284     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3285         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3286             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3287             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3288             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3289             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3290             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3291         16  FILLER                          PIC X(10).
  3292******************************************************************
  3293*    COPY ELCCNTL.
  3294******************************************************************
  3295*                                                                *
  3296*                                                                *
  3297*                            ELCCNTL.                            *
  3298*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3299*                            VMOD=2.059                          *
  3300*                                                                *
  3301*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3302*                                                                *
  3303*   FILE TYPE = VSAM,KSDS                                        *
  3304*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3305*                                                                *
  3306*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3307*       ALTERNATE INDEX = NONE                                   *
  3308*                                                                *
  3309*   LOG = YES                                                    *
  3310*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3311******************************************************************
  3312*                   C H A N G E   L O G
  3313*
  3314* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3315*-----------------------------------------------------------------
  3316*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3317* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  64
* EL6501.cbl
  3318*-----------------------------------------------------------------
  3319* 082503                   PEMA  ADD BENEFIT GROUP
  3320* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3321* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3322* 092705    2005050300006  PEMA  ADD SPP LEASES
  3323* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3324* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3325* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3326* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3327******************************************************************
  3328*
  3329 01  CONTROL-FILE.
  3330     12  CF-RECORD-ID                       PIC XX.
  3331         88  VALID-CF-ID                        VALUE 'CF'.
  3332
  3333     12  CF-CONTROL-PRIMARY.
  3334         16  CF-COMPANY-ID                  PIC XXX.
  3335         16  CF-RECORD-TYPE                 PIC X.
  3336             88  CF-COMPANY-MASTER              VALUE '1'.
  3337             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3338             88  CF-STATE-MASTER                VALUE '3'.
  3339             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3340             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3341             88  CF-CARRIER-MASTER              VALUE '6'.
  3342             88  CF-MORTALITY-MASTER            VALUE '7'.
  3343             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3344             88  CF-TERMINAL-MASTER             VALUE '9'.
  3345             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3346             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3347             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3348             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3349             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3350             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3351             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3352             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3353             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3354         16  CF-ACCESS-CD-GENL              PIC X(4).
  3355         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3356             20  CF-PROCESSOR               PIC X(4).
  3357         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3358             20  CF-STATE-CODE              PIC XX.
  3359             20  FILLER                     PIC XX.
  3360         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3361             20  FILLER                     PIC XX.
  3362             20  CF-HI-BEN-IN-REC           PIC XX.
  3363         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3364             20  FILLER                     PIC XXX.
  3365             20  CF-CARRIER-CNTL            PIC X.
  3366         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3367             20  FILLER                     PIC XX.
  3368             20  CF-HI-TYPE-IN-REC          PIC 99.
  3369         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3370             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3371                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3372             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3373             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3374         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3375             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  65
* EL6501.cbl
  3376             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3377         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3378             20  FILLER                     PIC XX.
  3379             20  CF-MORTGAGE-PLAN           PIC XX.
  3380         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3381
  3382     12  CF-LAST-MAINT-DT                   PIC XX.
  3383     12  CF-LAST-MAINT-BY                   PIC X(4).
  3384     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3385
  3386     12  CF-RECORD-BODY                     PIC X(728).
  3387
  3388
  3389****************************************************************
  3390*             COMPANY MASTER RECORD                            *
  3391****************************************************************
  3392
  3393     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3394         16  CF-COMPANY-ADDRESS.
  3395             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3396             20  CF-CL-IN-CARE-OF           PIC X(30).
  3397             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3398             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3399             20  CF-CL-CITY-STATE           PIC X(30).
  3400             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3401             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3402         16  CF-COMPANY-CD                  PIC X.
  3403         16  CF-COMPANY-PASSWORD            PIC X(8).
  3404         16  CF-SECURITY-OPTION             PIC X.
  3405             88  ALL-SECURITY                   VALUE '1'.
  3406             88  COMPANY-VERIFY                 VALUE '2'.
  3407             88  PROCESSOR-VERIFY               VALUE '3'.
  3408             88  NO-SECURITY                    VALUE '4'.
  3409             88  ALL-BUT-TERM                   VALUE '5'.
  3410         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3411             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3412         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3413             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3414         16  CF-INFORCE-LOCATION            PIC X.
  3415             88  CERTS-ARE-ONLINE               VALUE '1'.
  3416             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3417             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3418         16  CF-LOWER-CASE-LETTERS          PIC X.
  3419         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3420             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3421             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3422             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3423             88  CF-ACCNT-CNTL                  VALUE '3'.
  3424             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3425
  3426         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3427         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3428
  3429         16  CF-LGX-CREDIT-USER             PIC X.
  3430             88  CO-IS-NOT-USER                 VALUE 'N'.
  3431             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3432
  3433         16 CF-CREDIT-CALC-CODES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  66
* EL6501.cbl
  3434             20  CF-CR-REM-TERM-CALC PIC X.
  3435               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3436               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3437               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3438               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3439               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3440               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3441               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3442             20  CF-CR-R78-METHOD           PIC X.
  3443               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3444               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3445
  3446         16  CF-CLAIM-CONTROL-COUNTS.
  3447             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3448                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3449
  3450             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3451                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3452
  3453             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3454                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3455
  3456             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3457                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3458
  3459         16  CF-CURRENT-MONTH-END           PIC XX.
  3460
  3461         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3462             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3463             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3464             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3465             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3466                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3467                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3468             20  CF-CO-PREM-REJECT-SW       PIC X.
  3469                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3470                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3471             20  CF-CO-REF-REJECT-SW        PIC X.
  3472                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3473                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3474
  3475         16  CF-CO-REPORTING-DT             PIC XX.
  3476         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3477         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3478           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3479           88  CF-CO-MONTH-END                  VALUE '1'.
  3480
  3481         16  CF-LGX-CLAIM-USER              PIC X.
  3482             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3483             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3484
  3485         16  CF-CREDIT-EDIT-CONTROLS.
  3486             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3487             20  CF-MIN-AGE                 PIC 99.
  3488             20  CF-DEFAULT-AGE             PIC 99.
  3489             20  CF-MIN-TERM                PIC S999      COMP-3.
  3490             20  CF-MAX-TERM                PIC S999      COMP-3.
  3491             20  CF-DEFAULT-SEX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  67
* EL6501.cbl
  3492             20  CF-JOINT-AGE-INPUT         PIC X.
  3493                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3494             20  CF-BIRTH-DATE-INPUT        PIC X.
  3495                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3496             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3497                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3498                 88  CF-ZERO-CARRIER            VALUE '1'.
  3499                 88  CF-ZERO-GROUPING           VALUE '2'.
  3500                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3501             20  CF-EDIT-SW                 PIC X.
  3502                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3503             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3504             20  CF-CR-PR-METHOD            PIC X.
  3505               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3506               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3507             20  FILLER                     PIC X.
  3508
  3509         16  CF-CREDIT-MISC-CONTROLS.
  3510             20  CF-REIN-TABLE-SW           PIC X.
  3511                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3512             20  CF-COMP-TABLE-SW           PIC X.
  3513                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3514             20  CF-EXPERIENCE-RETENTION-AGE
  3515                                            PIC S9        COMP-3.
  3516             20  CF-CONVERSION-DT           PIC XX.
  3517             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3518             20  CF-RUN-FREQUENCY-SW        PIC X.
  3519                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3520                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3521
  3522             20  CF-CR-CHECK-NO-CONTROL.
  3523                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3524                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3525                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3526                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3527                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3528                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3529
  3530                 24  CF-CR-CHECK-COUNT       REDEFINES
  3531                     CF-CR-CHECK-COUNTER      PIC X(4).
  3532
  3533                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3534                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3535
  3536                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3537                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3538                 24  CF-MAIL-PROCESSING       PIC X.
  3539                     88  MAIL-PROCESSING          VALUE 'Y'.
  3540
  3541         16  CF-MISC-SYSTEM-CONTROL.
  3542             20  CF-SYSTEM-C                 PIC X.
  3543                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3544             20  CF-SYSTEM-D                 PIC X.
  3545                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3546             20  CF-SOC-SEC-NO-SW            PIC X.
  3547                 88  SOC-SEC-NO-USED             VALUE '1'.
  3548             20  CF-MEMBER-NO-SW             PIC X.
  3549                 88  MEMBER-NO-USED              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  68
* EL6501.cbl
  3550             20  CF-TAX-ID-NUMBER            PIC X(11).
  3551             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3552             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3553                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3554                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3555                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3556                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3557             20  CF-SYSTEM-E                 PIC X.
  3558                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3559
  3560         16  CF-LGX-LIFE-USER               PIC X.
  3561             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3562             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3563
  3564         16  CF-CR-MONTH-END-DT             PIC XX.
  3565
  3566         16  CF-FILE-MAINT-DATES.
  3567             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3568                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3569             20  CF-LAST-BATCH       REDEFINES
  3570                 CF-LAST-BATCH-NO               PIC X(4).
  3571             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3572             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3573             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3574             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3575             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3576             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3577             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3578             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3579             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3580             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3581
  3582         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3583         16  FILLER                         PIC X.
  3584
  3585         16  CF-ALT-MORT-CODE               PIC X(4).
  3586         16  CF-MEMBER-CAPTION              PIC X(10).
  3587
  3588         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3589             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3590             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3591             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3592             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3593             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3594
  3595         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3596
  3597         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3598         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3599         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3600         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3601
  3602         16  CF-AH-OVERRIDE-L1              PIC X.
  3603         16  CF-AH-OVERRIDE-L2              PIC XX.
  3604         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3605         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3606
  3607         16  CF-REPORT-CD1-CAPTION          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  69
* EL6501.cbl
  3608         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3609
  3610         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3611         16  CF-AR-LAST-EL860-DT            PIC XX.
  3612         16  CF-MP-MONTH-END-DT             PIC XX.
  3613
  3614         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3615         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3616             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3617
  3618         16  CF-AR-MONTH-END-DT             PIC XX.
  3619
  3620         16  CF-CRDTCRD-USER                PIC X.
  3621             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3622             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3623
  3624         16  CF-CC-MONTH-END-DT             PIC XX.
  3625
  3626         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3627
  3628         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3629             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3630             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3631             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3632         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3633         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3634         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3635         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3636             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3637             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3638         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3639         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3640         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3641             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3642         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3643
  3644         16  CF-CL-ZIP-CODE.
  3645             20  CF-CL-ZIP-PRIME.
  3646                 24  CF-CL-ZIP-1ST          PIC X.
  3647                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3648                 24  FILLER                 PIC X(4).
  3649             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3650         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3651             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3652             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3653             20  FILLER                     PIC XXX.
  3654
  3655         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3656         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3657         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3658         16  CF-CO-OPTION-START-DATE        PIC XX.
  3659         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3660           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3661                                                      '3' '4'.
  3662           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3663           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3664           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3665           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  70
* EL6501.cbl
  3666           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3667           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3668
  3669         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3670
  3671         16  CF-PAYMENT-APPROVAL-LEVELS.
  3672             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3673             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3674             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3675             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3676             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3677             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3678
  3679         16  CF-END-USER-REPORTING-USER     PIC X.
  3680             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3681             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3682
  3683         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3684             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3685             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3686
  3687         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3688
  3689         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3690         16  FILLER                         PIC X.
  3691
  3692         16  CF-CREDIT-ARCHIVE-CNTL.
  3693             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3694             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3695             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3696
  3697         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3698
  3699         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3700             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3701             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3702
  3703         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3704             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3705             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3706
  3707         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3708
  3709         16  CF-CO-ACH-ID-CODE              PIC  X.
  3710             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3711             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3712             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3713         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3714         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3715         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3716         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3717         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3718         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3719         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3720         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3721         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3722                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3723         16  CF-CO-ACH-TRACE-SPACE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  71
* EL6501.cbl
  3724                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3725
  3726         16  CF-CO-OVER-SHORT.
  3727             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3728             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3729
  3730*         16  FILLER                         PIC X(102).
  3731         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3732             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3733             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3734
  3735         16  CF-AH-APPROVAL-DAYS.
  3736             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3737             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3738             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3739             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3740
  3741         16  FILLER                         PIC X(82).
  3742****************************************************************
  3743*             PROCESSOR/USER RECORD                            *
  3744****************************************************************
  3745
  3746     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3747         16  CF-PROCESSOR-NAME              PIC X(30).
  3748         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3749         16  CF-PROCESSOR-TITLE             PIC X(26).
  3750         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3751                 88  MESSAGE-YES                VALUE 'Y'.
  3752                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3753
  3754*****************************************************
  3755****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3756****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3757****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3758****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3759*****************************************************
  3760
  3761         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3762             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3763             20  CF-APPLICATION-FORCE       PIC X.
  3764             20  CF-INDIVIDUAL-APP.
  3765                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3766                     28  CF-BROWSE-APP      PIC X.
  3767                     28  CF-UPDATE-APP      PIC X.
  3768
  3769         16  CF-CURRENT-TERM-ON             PIC X(4).
  3770         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3771             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3772             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3773             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3774             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3775             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3776             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3777             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3778         16  CF-PROCESSOR-CARRIER           PIC X.
  3779             88  NO-CARRIER-SECURITY            VALUE ' '.
  3780         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3781             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  72
* EL6501.cbl
  3782         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3783             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3784         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3785             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3786
  3787         16  CF-PROC-SYS-ACCESS-SW.
  3788             20  CF-PROC-CREDIT-CLAIMS-SW.
  3789                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3790                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3791                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3792                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3793             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3794                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3795                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3796             20  CF-PROC-LIFE-GNRLDGR-SW.
  3797                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3798                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3799                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3800                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3801             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3802                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3803                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3804         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3805             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3806             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3807         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3808
  3809         16  CF-APPROVAL-LEVEL                  PIC X.
  3810             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3811             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3812             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3813             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3814
  3815         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3816
  3817         16  CF-LANGUAGE-TYPE                   PIC X.
  3818             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3819             88  CF-LANG-IS-FR                      VALUE 'F'.
  3820         16  FILLER                             PIC  X(240).
  3821
  3822****************************************************************
  3823*             PROCESSOR/REMINDERS RECORD                       *
  3824****************************************************************
  3825
  3826     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3827         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3828             20  CF-START-REMIND-DT         PIC XX.
  3829             20  CF-END-REMIND-DT           PIC XX.
  3830             20  CF-REMINDER-TEXT           PIC X(50).
  3831         16  FILLER                         PIC X(296).
  3832
  3833
  3834****************************************************************
  3835*             STATE MASTER RECORD                              *
  3836****************************************************************
  3837
  3838     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3839         16  CF-STATE-ABBREVIATION          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  73
* EL6501.cbl
  3840         16  CF-STATE-NAME                  PIC X(25).
  3841         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3842         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3843             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3844             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3845             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3846             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3847                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3848                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3849             20  CF-ST-PREM-REJECT-SW       PIC X.
  3850                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3851                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3852             20  CF-ST-REF-REJECT-SW        PIC X.
  3853                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3854                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3855         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3856         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3857         16  CF-ST-REFUND-RULES.
  3858             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3859             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3860             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3861         16  CF-ST-FST-PMT-EXTENSION.
  3862             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3863             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3864                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3865                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3866                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3867                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3868         16  CF-ST-STATE-CALL.
  3869             20  CF-ST-CALL-UNEARNED        PIC X.
  3870             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3871             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3872         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3873             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3874             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3875         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3876         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3877         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3878         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3879         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3880         16  FILLER                         PIC X.
  3881         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3882             20  CF-ST-BENEFIT-CD           PIC XX.
  3883             20  CF-ST-BENEFIT-KIND         PIC X.
  3884                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3885                 88  CF-ST-AH-KIND              VALUE 'A'.
  3886             20  CF-ST-REM-TERM-CALC        PIC X.
  3887                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3888                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3889                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3890                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3891                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3892                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3893                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3894                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3895
  3896             20  CF-ST-REFUND-CALC          PIC X.
  3897                 88  ST-REFUND-NOT-USED         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  74
* EL6501.cbl
  3898                 88  ST-REFD-BY-R78             VALUE '1'.
  3899                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3900                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3901                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3902                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3903                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3904                 88  ST-REFD-UTAH               VALUE '7'.
  3905                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3906                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3907                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3908
  3909             20  CF-ST-EARNING-CALC         PIC X.
  3910                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3911                 88  ST-EARN-BY-R78             VALUE '1'.
  3912                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3913                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3914                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3915                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3916                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3917                 88  ST-EARN-MEAN               VALUE '8'.
  3918                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3919
  3920             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3921                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3922                 88  ST-OVRD-BY-R78             VALUE '1'.
  3923                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3924                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3925                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3926                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3927                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3928                 88  ST-OVRD-MEAN               VALUE '8'.
  3929                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3930             20  FILLER                     PIC X.
  3931
  3932         16  CF-ST-COMMISSION-CAPS.
  3933             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3934             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3935             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3936             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3937         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3938                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3939
  3940         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3941
  3942         16  CF-ST-STATUTORY-INTEREST.
  3943             20  CF-ST-STAT-DATE-FROM       PIC X.
  3944                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3945                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3946             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3947             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3948             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3949             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3950             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3951
  3952         16  CF-ST-OVER-SHORT.
  3953             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3954             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3955
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  75
* EL6501.cbl
  3956         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3957
  3958         16  CF-ST-RT-CALC                  PIC X.
  3959
  3960         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3961         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3962         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3963         16  CF-ST-RF-LR-CALC               PIC X.
  3964         16  CF-ST-RF-LL-CALC               PIC X.
  3965         16  CF-ST-RF-LN-CALC               PIC X.
  3966         16  CF-ST-RF-AH-CALC               PIC X.
  3967         16  CF-ST-RF-CP-CALC               PIC X.
  3968*        16  FILLER                         PIC X(206).
  3969*CIDMOD         16  FILLER                         PIC X(192).
  3970         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3971             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3972         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3973         16  FILLER                         PIC X(187).
  3974
  3975****************************************************************
  3976*             BENEFIT MASTER RECORD                            *
  3977****************************************************************
  3978
  3979     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3980         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3981             20  CF-BENEFIT-CODE            PIC XX.
  3982             20  CF-BENEFIT-NUMERIC  REDEFINES
  3983                 CF-BENEFIT-CODE            PIC XX.
  3984             20  CF-BENEFIT-ALPHA           PIC XXX.
  3985             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3986             20  CF-BENEFIT-COMMENT         PIC X(10).
  3987
  3988             20  CF-LF-COVERAGE-TYPE        PIC X.
  3989                 88  CF-REDUCING                VALUE 'R'.
  3990                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3991
  3992             20  CF-SPECIAL-CALC-CD         PIC X.
  3993                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3994                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3995                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3996                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3997                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3998                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3999                 88  CF-FARM-PLAN               VALUE 'F'.
  4000                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4001                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4002                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4003                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4004                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4005                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4006                 88  CF-PRUDENTIAL              VALUE 'P'.
  4007                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4008                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4009                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4010                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4011                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4012                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4013
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  76
* EL6501.cbl
  4014             20  CF-JOINT-INDICATOR         PIC X.
  4015                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4016
  4017*            20  FILLER                     PIC X(12).
  4018             20  FILLER                     PIC X(11).
  4019             20  CF-BENEFIT-CATEGORY        PIC X.
  4020             20  CF-LOAN-TYPE               PIC X(8).
  4021
  4022             20  CF-CO-REM-TERM-CALC        PIC X.
  4023                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4024                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4025                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4026                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4027                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4028
  4029             20  CF-CO-EARNINGS-CALC        PIC X.
  4030                 88  CO-EARN-BY-R78             VALUE '1'.
  4031                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4032                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4033                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4034                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4035                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4036                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4037                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4038
  4039             20  CF-CO-REFUND-CALC          PIC X.
  4040                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4041                 88  CO-REFD-BY-R78             VALUE '1'.
  4042                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4043                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4044                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4045                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4046                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4047                 88  CO-REFD-MEAN               VALUE '8'.
  4048                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4049                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4050                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4051
  4052             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4053                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4054                 88  CO-OVRD-BY-R78             VALUE '1'.
  4055                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4056                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4057                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4058                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4059                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4060                 88  CO-OVRD-MEAN               VALUE '8'.
  4061                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4062
  4063             20  CF-CO-BEN-I-G-CD           PIC X.
  4064                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4065                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4066                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4067
  4068         16  FILLER                         PIC X(304).
  4069
  4070
  4071****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  77
* EL6501.cbl
  4072*             CARRIER MASTER RECORD                            *
  4073****************************************************************
  4074
  4075     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4076         16  CF-ADDRESS-DATA.
  4077             20  CF-MAIL-TO-NAME            PIC X(30).
  4078             20  CF-IN-CARE-OF              PIC X(30).
  4079             20  CF-ADDRESS-LINE-1          PIC X(30).
  4080             20  CF-ADDRESS-LINE-2          PIC X(30).
  4081             20  CF-CITY-STATE              PIC X(30).
  4082             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4083             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4084
  4085         16  CF-CLAIM-NO-CONTROL.
  4086             20  CF-CLAIM-NO-METHOD         PIC X.
  4087                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4088                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4089                 88  CLAIM-NO-SEQ               VALUE '3'.
  4090                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4091             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4092                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4093                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4094                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4095
  4096         16  CF-CHECK-NO-CONTROL.
  4097             20  CF-CHECK-NO-METHOD         PIC X.
  4098                 88  CHECK-NO-MANUAL            VALUE '1'.
  4099                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4100                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4101                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4102             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4103                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4104
  4105         16  CF-DOMICILE-STATE              PIC XX.
  4106
  4107         16  CF-EXPENSE-CONTROLS.
  4108             20  CF-EXPENSE-METHOD          PIC X.
  4109                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4110                 88  DOLLARS-PER-PMT            VALUE '2'.
  4111                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4112                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4113             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4114             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4115
  4116         16  CF-CORRESPONDENCE-CONTROL.
  4117             20  CF-LETTER-RESEND-OPT       PIC X.
  4118                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4119                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4120             20  FILLER                     PIC X(4).
  4121
  4122         16  CF-RESERVE-CONTROLS.
  4123             20  CF-MANUAL-SW               PIC X.
  4124                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4125             20  CF-FUTURE-SW               PIC X.
  4126                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4127             20  CF-PTC-SW                  PIC X.
  4128                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4129             20  CF-IBNR-SW                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  78
* EL6501.cbl
  4130                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4131             20  CF-PTC-LF-SW               PIC X.
  4132                 88  CF-LF-PTC-USED             VALUE '1'.
  4133             20  CF-CDT-ACCESS-METHOD       PIC X.
  4134                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4135                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4136                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4137             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4138
  4139         16  CF-CLAIM-CALC-METHOD           PIC X.
  4140             88  360-PLUS-MONTHS                VALUE '1'.
  4141             88  365-PLUS-MONTHS                VALUE '2'.
  4142             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4143             88  360-DAILY                      VALUE '4'.
  4144             88  365-DAILY                      VALUE '5'.
  4145
  4146         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4147         16  FILLER                         PIC X(11).
  4148
  4149         16  CF-LIMIT-AMOUNTS.
  4150             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4151             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4152             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4153             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4154             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4155             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4156             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4157             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4158             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4159             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4160
  4161         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4162         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4163         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4164
  4165         16  CF-ZIP-CODE.
  4166             20  CF-ZIP-PRIME.
  4167                 24  CF-ZIP-1ST             PIC X.
  4168                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4169                 24  FILLER                 PIC X(4).
  4170             20  CF-ZIP-PLUS4               PIC X(4).
  4171         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4172             20  CF-CAN-POSTAL-1            PIC XXX.
  4173             20  CF-CAN-POSTAL-2            PIC XXX.
  4174             20  FILLER                     PIC XXX.
  4175
  4176         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4177         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4178         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4179
  4180         16  CF-RATING-SWITCH               PIC X.
  4181             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4182             88  CF-NO-RATING                   VALUE 'N'.
  4183
  4184         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4185
  4186         16  CF-CARRIER-OVER-SHORT.
  4187             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  79
* EL6501.cbl
  4188             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4189
  4190         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4191         16  CF-SECPAY-SWITCH               PIC X.
  4192             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4193             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4194         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4195         16  FILLER                         PIC X(448).
  4196*        16  FILLER                         PIC X(452).
  4197
  4198
  4199****************************************************************
  4200*             MORTALITY MASTER RECORD                          *
  4201****************************************************************
  4202
  4203     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4204         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4205                                INDEXED BY CF-MORT-NDX.
  4206             20  CF-MORT-TABLE              PIC X(5).
  4207             20  CF-MORT-TABLE-TYPE         PIC X.
  4208                 88  CF-MORT-JOINT              VALUE 'J'.
  4209                 88  CF-MORT-SINGLE             VALUE 'S'.
  4210                 88  CF-MORT-COMBINED           VALUE 'C'.
  4211                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4212                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4213             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4214             20  CF-MORT-AGE-METHOD         PIC XX.
  4215                 88  CF-AGE-LAST                VALUE 'AL'.
  4216                 88  CF-AGE-NEAR                VALUE 'AN'.
  4217             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4218             20  CF-MORT-ADJUSTMENT-DIRECTION
  4219                                            PIC X.
  4220                 88  CF-MINUS                   VALUE '-'.
  4221                 88  CF-PLUS                    VALUE '+'.
  4222             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4223             20  CF-MORT-JOINT-CODE         PIC X.
  4224                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4225             20  CF-MORT-PC-Q               PIC X.
  4226                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4227             20  CF-MORT-TABLE-CODE         PIC X(4).
  4228             20  CF-MORT-COMMENTS           PIC X(15).
  4229             20  FILLER                     PIC X(14).
  4230
  4231         16  FILLER                         PIC X(251).
  4232
  4233
  4234****************************************************************
  4235*             BUSSINESS TYPE MASTER RECORD                     *
  4236****************************************************************
  4237
  4238     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4239* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4240* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4241* AND RECORD 05 IS TYPES 81-99
  4242         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4243             20  CF-BUSINESS-TITLE          PIC  X(19).
  4244             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4245                                            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  80
* EL6501.cbl
  4246             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4247             20  FILLER                     PIC  X.
  4248         16  FILLER                         PIC  X(248).
  4249
  4250
  4251****************************************************************
  4252*             TERMINAL MASTER RECORD                           *
  4253****************************************************************
  4254
  4255     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4256
  4257         16  CF-COMPANY-TERMINALS.
  4258             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4259                                  PIC X(4).
  4260         16  FILLER               PIC X(248).
  4261
  4262
  4263****************************************************************
  4264*             LIFE EDIT MASTER RECORD                          *
  4265****************************************************************
  4266
  4267     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4268         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4269             20  CF-LIFE-CODE-IN            PIC XX.
  4270             20  CF-LIFE-CODE-OUT           PIC XX.
  4271         16  FILLER                         PIC X(248).
  4272
  4273
  4274****************************************************************
  4275*             AH EDIT MASTER RECORD                            *
  4276****************************************************************
  4277
  4278     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4279         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4280             20  CF-AH-CODE-IN              PIC XXX.
  4281             20  CF-AH-CODE-OUT             PIC XX.
  4282         16  FILLER                         PIC X(248).
  4283
  4284
  4285****************************************************************
  4286*             CREDIBILITY TABLES                               *
  4287****************************************************************
  4288
  4289     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4290         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4291                             INDEXED BY CF-CRDB-NDX.
  4292             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4293             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4294             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4295         16  FILLER                         PIC  X(332).
  4296
  4297
  4298****************************************************************
  4299*             REPORT CUSTOMIZATION RECORD                      *
  4300****************************************************************
  4301
  4302     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4303         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  81
* EL6501.cbl
  4304             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4305             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4306             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4307**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4308****       A T-TRANSFER.                                   ****
  4309             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4310
  4311         16  FILLER                         PIC XX.
  4312
  4313         16  CF-CARRIER-CNTL-OPT.
  4314             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4315                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4316                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4317             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4318                                            PIC X.
  4319         16  CF-GROUP-CNTL-OPT.
  4320             20  CF-GROUP-OPT-SEQ           PIC 9.
  4321                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4322                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4323             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4324                                            PIC X(6).
  4325         16  CF-STATE-CNTL-OPT.
  4326             20  CF-STATE-OPT-SEQ           PIC 9.
  4327                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4328                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4329             20  CF-STATE-SELECT OCCURS 3 TIMES
  4330                                            PIC XX.
  4331         16  CF-ACCOUNT-CNTL-OPT.
  4332             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4333                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4334                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4335             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4336                                            PIC X(10).
  4337         16  CF-BUS-TYP-CNTL-OPT.
  4338             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4339                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4340                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4341             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4342                                            PIC XX.
  4343         16  CF-LF-TYP-CNTL-OPT.
  4344             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4345                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4346                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4347             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4348                                            PIC XX.
  4349         16  CF-AH-TYP-CNTL-OPT.
  4350             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4351                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4352                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4353             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4354                                            PIC XX.
  4355         16  CF-REPTCD1-CNTL-OPT.
  4356             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4357                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4358                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4359             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4360                                            PIC X(10).
  4361         16  CF-REPTCD2-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  82
* EL6501.cbl
  4362             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4363                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4364                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4365             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4366                                            PIC X(10).
  4367         16  CF-USER1-CNTL-OPT.
  4368             20  CF-USER1-OPT-SEQ           PIC 9.
  4369                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4370                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4371             20  CF-USER1-SELECT OCCURS 3 TIMES
  4372                                            PIC X(10).
  4373         16  CF-USER2-CNTL-OPT.
  4374             20  CF-USER2-OPT-SEQ           PIC 9.
  4375                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4376                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4377             20  CF-USER2-SELECT OCCURS 3 TIMES
  4378                                            PIC X(10).
  4379         16  CF-USER3-CNTL-OPT.
  4380             20  CF-USER3-OPT-SEQ           PIC 9.
  4381                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4382                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4383             20  CF-USER3-SELECT OCCURS 3 TIMES
  4384                                            PIC X(10).
  4385         16  CF-USER4-CNTL-OPT.
  4386             20  CF-USER4-OPT-SEQ           PIC 9.
  4387                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4388                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4389             20  CF-USER4-SELECT OCCURS 3 TIMES
  4390                                            PIC X(10).
  4391         16  CF-USER5-CNTL-OPT.
  4392             20  CF-USER5-OPT-SEQ           PIC 9.
  4393                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4394                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4395             20  CF-USER5-SELECT OCCURS 3 TIMES
  4396                                            PIC X(10).
  4397         16  CF-REINS-CNTL-OPT.
  4398             20  CF-REINS-OPT-SEQ           PIC 9.
  4399                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4400                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4401             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4402                 24  CF-REINS-PRIME         PIC XXX.
  4403                 24  CF-REINS-SUB           PIC XXX.
  4404
  4405         16  CF-AGENT-CNTL-OPT.
  4406             20  CF-AGENT-OPT-SEQ           PIC 9.
  4407                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4408                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4409             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4410                                            PIC X(10).
  4411
  4412         16  FILLER                         PIC X(43).
  4413
  4414         16  CF-LOSS-RATIO-SELECT.
  4415             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4416             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4417         16  CF-ENTRY-DATE-SELECT.
  4418             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4419             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  83
* EL6501.cbl
  4420         16  CF-EFFECTIVE-DATE-SELECT.
  4421             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4422             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4423
  4424         16  CF-EXCEPTION-LIST-IND          PIC X.
  4425             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4426
  4427         16  FILLER                         PIC X(318).
  4428
  4429****************************************************************
  4430*                  EXCEPTION REPORTING RECORD                  *
  4431****************************************************************
  4432
  4433     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4434         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4435             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4436
  4437         16  CF-COMBINED-LIFE-AH-OPT.
  4438             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4439             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4440             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4441             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4442
  4443         16  CF-LIFE-OPT.
  4444             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4445             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4446             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4447             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4448             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4449             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4450             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4451             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4452             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4453             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4454
  4455         16  CF-AH-OPT.
  4456             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4457             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4458             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4459             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4460             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4461             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4462             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4463             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4464             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4465             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4466
  4467         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4468             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4469             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4470             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4471
  4472         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4473
  4474         16  FILLER                         PIC X(673).
  4475
  4476
  4477****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  84
* EL6501.cbl
  4478*             MORTGAGE SYSTEM PLAN RECORD                      *
  4479****************************************************************
  4480
  4481     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4482         16  CF-PLAN-TYPE                   PIC X.
  4483             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4484             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4485             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4486         16  CF-PLAN-ABBREV                 PIC XXX.
  4487         16  CF-PLAN-DESCRIPT               PIC X(10).
  4488         16  CF-PLAN-NOTES                  PIC X(20).
  4489         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4490         16  CF-PLAN-UNDERWRITING.
  4491             20  CF-PLAN-TERM-DATA.
  4492                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4493                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4494             20  CF-PLAN-AGE-DATA.
  4495                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4496                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4497                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4498             20  CF-PLAN-BENEFIT-DATA.
  4499                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4500                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4501                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4502                                            PIC S9(7)V99  COMP-3.
  4503         16  CF-PLAN-POLICY-FORMS.
  4504             20  CF-POLICY-FORM             PIC X(12).
  4505             20  CF-MASTER-APPLICATION      PIC X(12).
  4506             20  CF-MASTER-POLICY           PIC X(12).
  4507         16  CF-PLAN-RATING.
  4508             20  CF-RATE-CODE               PIC X(5).
  4509             20  CF-SEX-RATING              PIC X.
  4510                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4511                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4512             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4513             20  CF-SUB-STD-TYPE            PIC X.
  4514                 88  CF-PCT-OF-PREM            VALUE '1'.
  4515                 88  CF-PCT-OF-BENE            VALUE '2'.
  4516         16  CF-PLAN-PREM-TOLERANCES.
  4517             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4518             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4519         16  CF-PLAN-PYMT-TOLERANCES.
  4520             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4521             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4522         16  CF-PLAN-MISC-DATA.
  4523             20  FILLER                     PIC X.
  4524             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4525             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4526         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4527         16  CF-PLAN-IND-GRP                PIC X.
  4528             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4529                                                     '1'.
  4530             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4531                                                     '2'.
  4532         16  CF-MIB-SEARCH-SW               PIC X.
  4533             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4534             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4535             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  85
* EL6501.cbl
  4536             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4537         16  CF-ALPHA-SEARCH-SW             PIC X.
  4538             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4539             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4540             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4541             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4542             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4543             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4544             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4545             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4546             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4547             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4548                                                     'A' 'B' 'C'
  4549                                                     'X' 'Y' 'Z'.
  4550         16  CF-EFF-DT-RULE-SW              PIC X.
  4551             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4552             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4553             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4554             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4555             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4556         16  FILLER                         PIC X(4).
  4557         16  CF-HEALTH-QUESTIONS            PIC X.
  4558             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4559         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4560         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4561         16  CF-PLAN-SNGL-JNT               PIC X.
  4562             88  CF-COMBINED-PLAN              VALUE 'C'.
  4563             88  CF-JNT-PLAN                   VALUE 'J'.
  4564             88  CF-SNGL-PLAN                  VALUE 'S'.
  4565         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4566         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4567         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4568         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4569         16  CF-RERATE-CNTL                 PIC  X.
  4570             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4571             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4572             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4573             88  CF-AUTO-RECALC                 VALUE '4'.
  4574         16  CF-BENEFIT-TYPE                PIC  X.
  4575             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4576             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4577         16  CF-POLICY-FEE                  PIC S999V99
  4578                                                    COMP-3.
  4579         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4580         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4581         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4582         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4583         16  FILLER                         PIC  X(32).
  4584         16  CF-TERMINATION-FORM            PIC  X(04).
  4585         16  FILLER                         PIC  X(08).
  4586         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4587                                                       COMP-3.
  4588         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4589         16  CF-ISSUE-LETTER                PIC  X(4).
  4590         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4591         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4592             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4593             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  86
* EL6501.cbl
  4594         16  CF-MP-REFUND-CALC              PIC X.
  4595             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4596             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4597             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4598             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4599             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4600             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4601             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4602             88  CF-MP-REFD-MEAN                VALUE '8'.
  4603         16  CF-ALT-RATE-CODE               PIC  X(5).
  4604
  4605
  4606         16  FILLER                         PIC X(498).
  4607****************************************************************
  4608*             MORTGAGE COMPANY MASTER RECORD                   *
  4609****************************************************************
  4610
  4611     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4612         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4613         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4614             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4615             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4616             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4617             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4618             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4619
  4620         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4621         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4622         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4623         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4624         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4625
  4626         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4627             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4628         16  CF-MP-RECON-USE-IND            PIC X(1).
  4629             88  CF-MP-USE-RECON             VALUE 'Y'.
  4630         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4631             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4632         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4633             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4634             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4635         16  FILLER                         PIC X(1).
  4636         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4637             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4638         16  CF-MORTG-MIB-VERSION           PIC X.
  4639             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4640             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4641             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4642         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4643             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4644                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4645             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4646                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4647             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4648                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4649             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4650                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4651             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  87
* EL6501.cbl
  4652                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4653             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4654                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4655         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4656         16  FILLER                         PIC X(7).
  4657         16  CF-MORTG-DESTINATION-SYMBOL.
  4658             20  CF-MORTG-MIB-COMM          PIC X(5).
  4659             20  CF-MORTG-MIB-TERM          PIC X(5).
  4660         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4661             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4662         16  FILLER                         PIC X(03).
  4663         16  CF-MP-CHECK-NO-CONTROL.
  4664             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4665                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4666                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4667                                                ' ' LOW-VALUES.
  4668                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4669                                               VALUE '3'.
  4670         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4671         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4672         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4673             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4674                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4675             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4676                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4677             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4678                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4679             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4680                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4681             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4682                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4683             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4684                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4685         16  CF-MORTG-BILLING-AREA.
  4686             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4687                                            PIC X.
  4688         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4689         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4690         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4691         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4692             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4693             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4694         16  FILLER                         PIC X.
  4695         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4696             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4697             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4698         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4699         16  FILLER                         PIC X(8).
  4700         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4701         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4702         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4703         16  CF-ACH-COMPANY-ID.
  4704             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4705                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4706                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4707                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4708             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4709         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  88
* EL6501.cbl
  4710             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4711         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4712             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4713             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4714         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4715         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4716         16  FILLER                         PIC X(536).
  4717
  4718****************************************************************
  4719*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4720****************************************************************
  4721
  4722     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4723         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4724             20  CF-FEMALE-HEIGHT.
  4725                 24  CF-FEMALE-FT           PIC 99.
  4726                 24  CF-FEMALE-IN           PIC 99.
  4727             20  CF-FEMALE-MIN-WT           PIC 999.
  4728             20  CF-FEMALE-MAX-WT           PIC 999.
  4729         16  FILLER                         PIC X(428).
  4730
  4731     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4732         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4733             20  CF-MALE-HEIGHT.
  4734                 24  CF-MALE-FT             PIC 99.
  4735                 24  CF-MALE-IN             PIC 99.
  4736             20  CF-MALE-MIN-WT             PIC 999.
  4737             20  CF-MALE-MAX-WT             PIC 999.
  4738         16  FILLER                         PIC X(428).
  4739******************************************************************
  4740*             AUTOMATIC ACTIVITY RECORD                          *
  4741******************************************************************
  4742     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4743         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4744             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4745             20  CF-SYS-LETTER-ID           PIC X(04).
  4746             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4747             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4748             20  CF-SYS-RESET-SW            PIC X(01).
  4749             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4750             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4751
  4752         16  FILLER                         PIC X(50).
  4753
  4754         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4755             20  CF-USER-ACTIVE-SW          PIC X(01).
  4756             20  CF-USER-LETTER-ID          PIC X(04).
  4757             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4758             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4759             20  CF-USER-RESET-SW           PIC X(01).
  4760             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4761             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4762             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4763
  4764         16  FILLER                         PIC X(246).
  4765*    COPY ERCREIN.
  4766******************************************************************
  4767*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  89
* EL6501.cbl
  4768*                            ERCREIN                             *
  4769*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4770*                            VMOD=2.010                          *
  4771*                                                                *
  4772*   ONLINE CREDIT SYSTEM                                         *
  4773*                                                                *
  4774*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  4775*                                                                *
  4776*   FILE TYPE = VSAM,KSDS                                        *
  4777*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  4778*                                                                *
  4779*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  4780*       ALTERNATE PATH = NONE                                    *
  4781*                                                                *
  4782*   LOG = NO                                                     *
  4783*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4784*                                                                *
  4785******************************************************************
  4786*                   C H A N G E   L O G
  4787*
  4788* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4789*-----------------------------------------------------------------
  4790*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4791* EFFECTIVE    NUMBER
  4792*-----------------------------------------------------------------
  4793* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  4794* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  4795******************************************************************
  4796 01  REINSURANCE-RECORD.
  4797     12  RE-RECORD-ID                      PIC XX.
  4798         88  VALID-RE-ID                      VALUE 'RE'.
  4799
  4800     12  RE-CONTROL-PRIMARY.
  4801         16  RE-COMPANY-CD                 PIC X.
  4802         16  RE-KEY.
  4803             20  RE-CODE                   PIC X.
  4804                 88  RE-TABLE-RECORD          VALUE 'A'.
  4805                 88  RE-COMPANY-RECORD        VALUE 'B'.
  4806             20  RE-TABLE                  PIC XXX.
  4807             20  FILLER                    PIC XXX.
  4808         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  4809             20  FILLER                    PIC X.
  4810             20  RE-COMPANY.
  4811                 24  RE-COMP-PRIME         PIC XXX.
  4812                 24  RE-COMP-SUB           PIC XXX.
  4813
  4814     12  RE-MAINT-INFORMATION.
  4815         16  RE-LAST-MAINT-DT              PIC XX.
  4816         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4817         16  RE-LAST-MAINT-USER            PIC X(4).
  4818         16  FILLER                        PIC X(10).
  4819
  4820     12  RE-TABLE-DATA.
  4821         16  RE-100-COMP                   PIC 99.
  4822
  4823         16  RE-COMP-INFO    OCCURS 30 TIMES.
  4824             20  RE-REI-COMP-NO.
  4825                 24  RE-REI-COMP           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  90
* EL6501.cbl
  4826                 24  RE-REI-COMP-SUB       PIC XXX.
  4827             20  RE-LF-QC                  PIC X.
  4828             20  RE-AH-QC                  PIC X.
  4829             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  4830             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  4831             20  RE-LFAGE-LO               PIC 99.
  4832             20  RE-LFAGE-HI               PIC 99.
  4833             20  RE-AHAGE-LO               PIC 99.
  4834             20  RE-AHAGE-HI               PIC 99.
  4835             20  RE-LFTRM-LO               PIC S999       COMP-3.
  4836             20  RE-LFTRM-HI               PIC S999       COMP-3.
  4837             20  RE-AHTRM-LO               PIC S999       COMP-3.
  4838             20  RE-AHTRM-HI               PIC S999       COMP-3.
  4839             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  4840             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  4841             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  4842             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  4843             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  4844             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  4845             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  4846             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  4847             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  4848             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  4849             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  4850             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  4851             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  4852             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  4853             20  RE-LF-BEN-CODE            PIC X.
  4854             20  RE-AH-BEN-CODE            PIC X.
  4855             20  RE-INTERACTIVE            PIC X.
  4856             20  RE-REMAINING              PIC X.
  4857             20  RE-LF-RUNOFF-SW           PIC X.
  4858             20  RE-AH-RUNOFF-SW           PIC X.
  4859             20  FILLER                    PIC X(19).
  4860
  4861         16  RE-COMP-INFO-END              PIC X(6).
  4862         16  RE-NSP-ST-CD-LF               PIC XX.
  4863         16  RE-NSP-ST-CD-AH               PIC XX.
  4864         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  4865             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  4866
  4867         16  FILLER                        PIC X(27).
  4868
  4869     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  4870         16  RE-NAME                       PIC X(30).
  4871         16  RE-LF-PE                      PIC X.
  4872         16  RE-AH-PE                      PIC X.
  4873         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  4874         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  4875         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  4876         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  4877         16  RE-PRT-ST                     PIC X.
  4878         16  RE-PRT-OW                     PIC X.
  4879         16  RE-MORT-CODE                  PIC X(4).
  4880         16  RE-CLAIM-CODE                 PIC X.
  4881         16  RE-ZERO-LF-FEE                PIC X.
  4882         16  RE-ZERO-AH-FEE                PIC X.
  4883         16  RE-CEDE-NAME                  PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  91
* EL6501.cbl
  4884         16  RE-LF-COMM                    PIC X.
  4885         16  RE-AH-COMM                    PIC X.
  4886         16  RE-LF-TAX                     PIC X.
  4887         16  RE-AH-TAX                     PIC X.
  4888         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  4889         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  4890         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  4891
  4892         16  RE-COMP-CARRIER-SECURITY      PIC X.
  4893             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  4894
  4895         16  RE-LF-CEDING-FEE-BRACKETS.
  4896             20  RE-LF-FEE-METHOD          PIC X.
  4897                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  4898                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  4899                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  4900                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  4901             20  RE-LF-FEE-BASIS           PIC X.
  4902                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  4903                 88  RE-LF-NET-CEDED               VALUE '2'.
  4904                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  4905                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  4906                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  4907                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  4908                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  4909                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  4910             20  FILLER                    PIC XXX.
  4911             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  4912                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  4913                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  4914
  4915         16  RE-AH-CEDING-FEE-BRACKETS.
  4916             20  RE-AH-FEE-METHOD          PIC X.
  4917                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  4918                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  4919                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  4920                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  4921             20  RE-AH-FEE-BASIS           PIC X.
  4922                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  4923                 88  RE-AH-NET-CEDED               VALUE '2'.
  4924                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  4925                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  4926                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  4927                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  4928                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  4929                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  4930             20  FILLER                    PIC XXX.
  4931             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  4932                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  4933                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  4934
  4935         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  4936
  4937         16  RE-OLD-CEDING-STMT            PIC X.
  4938
  4939         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  4940         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  4941         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  92
* EL6501.cbl
  4942         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  4943         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  4944         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  4945         16  RE-REINS-GROUPING-CODE        PIC X(6).
  4946         16  RE-MORT-SW                    PIC X.
  4947         16  RE-CEDING-TYPE-FLAG           PIC X.
  4948             88  RE-NO-CESSION-TYPE                VALUE ' '.
  4949             88  RE-CEDED                          VALUE 'C'.
  4950             88  RE-ASSUMED                        VALUE 'A'.
  4951             88  RE-PHANTOM                        VALUE 'P'.
  4952
  4953         16  RE-CEDING-STMT-OPT-A          PIC X.
  4954             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  4955         16  RE-CEDING-STMT-OPT-B          PIC X.
  4956             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  4957         16  RE-CEDING-STMT-OPT-C          PIC X.
  4958             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  4959         16  RE-CEDING-STMT-OPT-D          PIC X.
  4960             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  4961         16  RE-CEDING-STMT-OPT-E          PIC X.
  4962             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  4963
  4964         16  RE-PRT-CRSV                   PIC X.
  4965
  4966         16  RE-GL-CENTER                  PIC X(4).
  4967
  4968         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  4969
  4970         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  4971
  4972         16  RE-EARN-STOP-CODE             PIC X.
  4973             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  4974             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  4975
  4976         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  4977             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  4978
  4979         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  4980         16  FILLER                        PIC X(2281).
  4981
  4982         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  4983
  4984******************************************************************
  4985*    COPY ERCCTBL.
  4986******************************************************************
  4987*                                                                *
  4988*                                                                *
  4989*                            ERCCTBL                             *
  4990*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4991*                            VMOD=2.003
  4992*                                                                *
  4993*   ONLINE CREDIT SYSTEM                                         *
  4994*                                                                *
  4995*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  4996*                                                                *
  4997*   FILE TYPE = VSAM,KSDS                                        *
  4998*   RECORD SIZE = 200   RECFORM = FIXED                          *
  4999*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  93
* EL6501.cbl
  5000*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5001*       ALTERNATE PATH = NONE                                    *
  5002*                                                                *
  5003*   LOG = NO                                                     *
  5004*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5005*                                                                *
  5006*                                                                *
  5007******************************************************************
  5008
  5009 01  COMM-TABLE-RECORD.
  5010     12  CT-RECORD-ID                      PIC XX.
  5011         88  VALID-CT-ID                      VALUE 'CT'.
  5012
  5013     12  CT-CONTROL-PRIMARY.
  5014         16  CT-COMPANY-CD                 PIC X.
  5015         16  CT-TABLE                      PIC XXX.
  5016         16  CT-CNTRL-2.
  5017             20  CT-BEN-TYPE               PIC X.
  5018             20  CT-BEN-CODE               PIC XX.
  5019
  5020     12  CT-MAINT-INFORMATION.
  5021         16  CT-LAST-MAINT-DT              PIC XX.
  5022         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5023         16  CT-LAST-MAINT-USER            PIC X(4).
  5024         16  FILLER                        PIC X(31).
  5025
  5026     12  CT-LIMITS.
  5027         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5028
  5029         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5030
  5031         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5032
  5033     12  CT-RATES.
  5034         16  CT-RTX          OCCURS 27 TIMES.
  5035             20  CT-RT                     PIC SV9(5)     COMP-3.
  5036             20  CT-RT-R   REDEFINES
  5037                 CT-RT                     PIC XXX.
  5038
  5039     12  FILLER                            PIC  X(42).
  5040
  5041******************************************************************
  5042*                                COPY ERCACNT.
  5043******************************************************************
  5044*                                                                *
  5045*                                                                *
  5046*                            ERCACNT.                            *
  5047*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5048*                            VMOD=2.002                          *
  5049*                                                                *
  5050*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  5051*                                                                *
  5052*   FILE TYPE = VSAM,KSDS                                        *
  5053*   RECORD SIZE = 120   RECFORM = FIXED                          *
  5054*                                                                *
  5055*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  5056*       ALTERNATE INDEX = NONE                                   *
  5057*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  94
* EL6501.cbl
  5058*                                                                *
  5059*   LOG = YES                                                    *
  5060*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5061******************************************************************
  5062*                   C H A N G E   L O G
  5063*
  5064* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5065*-----------------------------------------------------------------
  5066*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5067* EFFECTIVE    NUMBER
  5068*-----------------------------------------------------------------
  5069* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  5070*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  5071******************************************************************
  5072 01  NOTE-FILE.
  5073     12  NT-FILE-ID                  PIC XX.
  5074         88  VALID-NOTE-ID              VALUE 'NT'.
  5075
  5076     12  NT-CONTROL-PRIMARY.
  5077         16  NT-COMPANY-CD           PIC X.
  5078         16  NT-ACCT-NOTE-KEY.
  5079             18  NT-CARRIER              PIC X.
  5080             18  NT-GROUPING             PIC X(06).
  5081             18  NT-STATE                PIC XX.
  5082             18  NT-ACCOUNT              PIC X(10).
  5083         16  NT-RECORD-TYPE          PIC X.
  5084              88  ACCT-NOTE          VALUE '1'.
  5085              88  ACCT-BRANCH-LOC    VALUE '2'.
  5086              88  ACCT-SHIPPING-ADDR VALUE '3'.
  5087         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  5088
  5089     12  NT-LAST-MAINT-DT            PIC XX.
  5090     12  NT-LAST-MAINT-BY            PIC X(4).
  5091     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  5092
  5093*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  5094*     SEQUENCE NUMBERS
  5095     12  NT-NOTE-INFORMATION.
  5096         16  NT-NOTE-LINE            PIC X(60).
  5097         16  FILLER                  PIC X(25).
  5098*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  5099     12  NT-LOCATION-INFORMATION REDEFINES
  5100                         NT-NOTE-INFORMATION.
  5101         16  NT-BRANCH-LOC-LINE      PIC X(60).
  5102         16  FILLER                  PIC X(25).
  5103*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  5104*     SEQUENCE NUMBER 1 IS NAME LINE 1
  5105*     SEQUENCE NUMBER 2 IS NAME LINE 2
  5106*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  5107*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  5108*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  5109*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  5110     12  NT-SHIPPING-INFORMATION REDEFINES
  5111                         NT-NOTE-INFORMATION.
  5112         16  NT-SHIPPING-LINE        PIC X(60).
  5113         16  NT-SHIP-STATE           PIC XX.
  5114         16  NT-SHIP-ZIP             PIC X(10).
  5115         16  FILLER                  PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  95
* EL6501.cbl
  5116*****************************************************************
  5117
  5118 01  COMMISSION-WORK-AREA.
  5119     05  WK-AGT-COMMS   OCCURS 10 TIMES.
  5120         10  WK-AM-AGT           PIC X(10).
  5121         10  WK-AM-TYPE          PIC X.
  5122         10  WK-FILLER           PIC X(13).
  5123         10  WK-GA-BILL-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  96
* EL6501.cbl
  5125*    COPY ERCCOMP.
  5126******************************************************************
  5127*                                                                *
  5128*                                                                *
  5129*                            ERCCOMP                             *
  5130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5131*                            VMOD=2.019                          *
  5132*                                                                *
  5133*   ONLINE CREDIT SYSTEM                                         *
  5134*                                                                *
  5135*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  5136*                                                                *
  5137*   FILE TYPE = VSAM,KSDS                                        *
  5138*   RECORD SIZE = 700   RECFORM = FIXED                          *
  5139*                                                                *
  5140*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  5141*       ALTERNATE PATH = NONE                                    *
  5142*                                                                *
  5143*   LOG = NO                                                     *
  5144*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5145*                                                                *
  5146******************************************************************
  5147*                   C H A N G E   L O G
  5148*
  5149* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5150*-----------------------------------------------------------------
  5151*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5152* EFFECTIVE    NUMBER
  5153*-----------------------------------------------------------------
  5154* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5155* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5156* 092205    2005050300006  PEMA  ADD LEASE FEE
  5157* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5158* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5159* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5160* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5161* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5162******************************************************************
  5163
  5164 01  COMPENSATION-MASTER.
  5165     12  CO-RECORD-ID                          PIC XX.
  5166         88  VALID-CO-ID                          VALUE 'CO'.
  5167
  5168     12  CO-CONTROL-PRIMARY.
  5169         16  CO-COMPANY-CD                     PIC X.
  5170         16  CO-CONTROL.
  5171             20  CO-CTL-1.
  5172                 24  CO-CARR-GROUP.
  5173                     28  CO-CARRIER            PIC X.
  5174                     28  CO-GROUPING.
  5175                         32  CO-GROUP-PREFIX   PIC XXX.
  5176                         32  CO-GROUP-PRIME    PIC XXX.
  5177                 24  CO-RESP-NO.
  5178                     28  CO-RESP-PREFIX        PIC X(4).
  5179                     28  CO-RESP-PRIME         PIC X(6).
  5180             20  CO-CTL-2.
  5181                 24  CO-ACCOUNT.
  5182                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  97
* EL6501.cbl
  5183                     28  CO-ACCT-PRIME         PIC X(6).
  5184         16  CO-TYPE                           PIC X.
  5185             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5186             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5187             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5188
  5189     12  CO-MAINT-INFORMATION.
  5190         16  CO-LAST-MAINT-DT                  PIC XX.
  5191         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5192         16  CO-LAST-MAINT-USER                PIC X(4).
  5193     12  FILLER                                PIC XX.
  5194     12  CO-STMT-TYPE                          PIC XXX.
  5195     12  CO-COMP-TYPE                          PIC X.
  5196         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5197     12  CO-STMT-OWNER                         PIC X(4).
  5198     12  CO-BALANCE-CONTROL                    PIC X.
  5199         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5200         88  CO-NO-BALANCE                        VALUE 'N'.
  5201
  5202     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5203         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5204         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5205         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5206
  5207     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5208         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5209         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5210
  5211     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5212     12  CO-GA-DIRECT-DEP                      PIC X.
  5213     12  CO-FUTURE-SPACE                       PIC X.
  5214         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5215
  5216     12  CO-ACCT-NAME                          PIC X(30).
  5217     12  CO-MAIL-NAME                          PIC X(30).
  5218     12  CO-ADDR-1                             PIC X(30).
  5219     12  CO-ADDR-2                             PIC X(30).
  5220     12  CO-ADDR-3.
  5221         16  CO-ADDR-CITY                      PIC X(27).
  5222         16  CO-ADDR-STATE                     PIC XX.
  5223     12  CO-CSO-1099                           PIC X.
  5224     12  CO-ZIP.
  5225         16  CO-ZIP-PRIME.
  5226             20  CO-ZIP-PRI-1ST                PIC X.
  5227                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5228             20  FILLER                        PIC X(4).
  5229         16  CO-ZIP-PLUS4                      PIC X(4).
  5230     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5231         16  CO-CAN-POSTAL-1                   PIC XXX.
  5232         16  CO-CAN-POSTAL-2                   PIC XXX.
  5233         16  FILLER                            PIC XXX.
  5234     12  CO-SOC-SEC                            PIC X(13).
  5235     12  CO-TELEPHONE.
  5236         16  CO-AREA-CODE                      PIC XXX.
  5237         16  CO-PREFIX                         PIC XXX.
  5238         16  CO-PHONE                          PIC X(4).
  5239
  5240     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  98
* EL6501.cbl
  5241
  5242     12  CO-AR-BAL-LEVEL                       PIC X.
  5243         88  CO-AR-REF-LVL                        VALUE '1'.
  5244         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5245         88  CO-AR-BILL-LVL                       VALUE '2'.
  5246         88  CO-AR-AGT-LVL                        VALUE '3'.
  5247         88  CO-AR-FR-LVL                         VALUE '4'.
  5248
  5249     12  CO-AR-NORMAL-PRINT                    PIC X.
  5250         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5251         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5252
  5253     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5254
  5255     12  CO-AR-REPORTING                       PIC X.
  5256         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5257         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5258
  5259     12  CO-AR-PULL-CHECK                      PIC X.
  5260         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5261         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5262
  5263     12  CO-AR-BALANCE-PRINT                   PIC X.
  5264         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5265
  5266     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5267         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5268         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5269         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5270
  5271     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5272
  5273     12  CO-USER-CODE                          PIC X.
  5274     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5275
  5276******************************************************************
  5277*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5278*    THE LAST MONTH END RUN.
  5279******************************************************************
  5280
  5281     12  CO-LAST-ACTIVITY-DATE.
  5282         16  CO-ACT-YEAR                       PIC 99.
  5283         16  CO-ACT-MONTH                      PIC 99.
  5284         16  CO-ACT-DAY                        PIC 99.
  5285
  5286     12  CO-LAST-STMT-DT.
  5287         16  CO-LAST-STMT-YEAR                 PIC 99.
  5288         16  CO-LAST-STMT-MONTH                PIC 99.
  5289         16  CO-LAST-STMT-DAY                  PIC 99.
  5290
  5291     12  CO-MO-END-TOTALS.
  5292         16  CO-MONTHLY-TOTALS.
  5293             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5294             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5295             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5296             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5297             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  5298
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  99
* EL6501.cbl
  5299         16  CO-AGING-TOTALS.
  5300             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5301             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5302             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5303             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5304
  5305         16  CO-YTD-TOTALS.
  5306             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5307             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5308
  5309         16  CO-OVER-UNDER-TOTALS.
  5310             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5311             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5312
  5313     12  CO-MISCELLANEOUS-TOTALS.
  5314         16  CO-FICA-TOTALS.
  5315             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5316             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5317
  5318         16  CO-CLAIM-TOTALS.
  5319             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5320             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5321
  5322******************************************************************
  5323*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5324*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5325******************************************************************
  5326
  5327     12  CO-CURRENT-TOTALS.
  5328         16  CO-CURRENT-LAST-STMT-DT.
  5329             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5330             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5331             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5332
  5333         16  CO-CURRENT-MONTHLY-TOTALS.
  5334             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5335             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5336             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5337             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5338             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5339
  5340         16  CO-CURRENT-AGING-TOTALS.
  5341             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5342             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5343             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5344             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5345
  5346         16  CO-CURRENT-YTD-TOTALS.
  5347             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5348             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5349
  5350     12  CO-PAID-COMM-TOTALS.
  5351         16  CO-YTD-PAID-COMMS.
  5352             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5353             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5354
  5355     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  5356         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 100
* EL6501.cbl
  5357         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5358
  5359     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5360         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5361         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5362         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5363         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5364         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5365         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5366         88  CO-FINAL-LETTER                  VALUE 'F'.
  5367         88  CO-RECONCILING                   VALUE 'R'.
  5368         88  CO-PHONE-CALL                    VALUE 'P'.
  5369         88  CO-LEGAL                         VALUE 'L'.
  5370         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5371         88  CO-WRITE-OFF                     VALUE 'W'.
  5372         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5373
  5374     12  CO-CSR-CODE                       PIC X(4).
  5375
  5376     12  CO-GA-STATUS-INFO.
  5377         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5378         16  CO-GA-TERMINATION-DT          PIC XX.
  5379         16  CO-GA-STATUS-CODE             PIC X.
  5380             88  CO-GA-ACTIVE                 VALUE 'A'.
  5381             88  CO-GA-INACTIVE               VALUE 'I'.
  5382             88  CO-GA-PENDING                VALUE 'P'.
  5383         16  CO-GA-COMMENTS.
  5384             20  CO-GA-COMMENT-1           PIC X(40).
  5385             20  CO-GA-COMMENT-2           PIC X(40).
  5386             20  CO-GA-COMMENT-3           PIC X(40).
  5387             20  CO-GA-COMMENT-4           PIC X(40).
  5388
  5389     12  CO-RPTCD2                         PIC X(10).
  5390
  5391     12  CO-TYPE-AGENT                     PIC X(01).
  5392         88  CO-CORPORATION                   VALUE 'C'.
  5393         88  CO-PARTNERSHIP                   VALUE 'P'.
  5394         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5395         88  CO-TRUST                         VALUE 'T'.
  5396         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5397
  5398     12  CO-FAXNO.
  5399         16  CO-FAX-AREA-CODE                  PIC XXX.
  5400         16  CO-FAX-PREFIX                     PIC XXX.
  5401         16  CO-FAX-PHONE                      PIC X(4).
  5402
  5403     12  CO-BANK-INFORMATION.
  5404         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5405         16  CO-BANK-TRANSIT-NON REDEFINES
  5406             CO-BANK-TRANSIT-NO                PIC 9(8).
  5407
  5408         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5409     12  CO-MISC-DEDUCT-INFO REDEFINES
  5410                  CO-BANK-INFORMATION.
  5411         16  CO-MD-GL-ACCT                     PIC X(10).
  5412         16  CO-MD-DIV                         PIC XX.
  5413         16  CO-MD-CENTER                      PIC X(4).
  5414         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 101
* EL6501.cbl
  5415         16  CO-CREATE-AP-CHECK                PIC X.
  5416         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5417         16  FILLER                            PIC XXX.
  5418     12  CO-ACH-STATUS                         PIC X.
  5419         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5420         88  CO-ACH-PENDING                        VALUE 'P'.
  5421
  5422     12  CO-BILL-SW                            PIC X.
  5423     12  CO-CONTROL-NAME                       PIC X(30).
  5424     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5425     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5426     12  CO-CLP-STATE                          PIC XX.
  5427     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5428     12  CO-SPP-REFUND-EDIT                    PIC X.
  5429
  5430******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 102
* EL6501.cbl
  5432*    COPY ERCNAME.
  5433******************************************************************
  5434*                                                                *
  5435*                                                                *
  5436*                            ERCNAME                             *
  5437*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5438*                            VMOD=2.003                          *
  5439*                                                                *
  5440*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  5441*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  5442*                                                                *
  5443*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  5444*                                                                *
  5445*   FILE TYPE = VSAM,KSDS                                        *
  5446*   RECORD SIZE = 160   RECFORM = FIX                            *
  5447*                                                                *
  5448*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  5449*                                                                *
  5450*   LOG = NO                                                     *
  5451*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5452*                                                                *
  5453*                                                                *
  5454******************************************************************
  5455
  5456 01  NAME-LOOKUP-MASTER.
  5457     12  NL-RECORD-ID                PIC  X(02).
  5458         88  VALID-NL-ID                         VALUE 'NL'.
  5459
  5460     12  NL-RECORD-KEY.
  5461         16  NL-CONTROL-PRIMARY.
  5462             20  NL-COMPANY-CD       PIC  X(01).
  5463             20  NL-NAME             PIC  X(30).
  5464             20  NL-RECORD-TYPE      PIC  X(01).
  5465                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  5466                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  5467                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  5468
  5469         16  NL-ACCOUNT-MASTER.
  5470             20  NL-AM-COMPANY-CD    PIC  X(01).
  5471             20  NL-AM-CARRIER       PIC  X(01).
  5472             20  NL-AM-GROUPING      PIC  X(06).
  5473             20  NL-AM-STATE         PIC  X(02).
  5474             20  NL-AM-ACCOUNT       PIC  X(10).
  5475             20  FILLER              PIC  X(09).
  5476
  5477         16  NL-COMPENSATION-MASTER
  5478                                 REDEFINES  NL-ACCOUNT-MASTER.
  5479             20  NL-CO-COMPANY-CD    PIC  X(01).
  5480             20  NL-CO-CARRIER       PIC  X(01).
  5481             20  NL-CO-GROUPING      PIC  X(06).
  5482             20  NL-CO-RESP-NO       PIC  X(10).
  5483             20  NL-CO-ACCOUNT       PIC  X(10).
  5484             20  NL-CO-TYPE          PIC  X(01).
  5485
  5486         16  NL-REINSURANCE-RECORD
  5487                                 REDEFINES  NL-ACCOUNT-MASTER.
  5488             20  NL-RE-COMPANY-CD    PIC  X(01).
  5489             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 103
* EL6501.cbl
  5490             20  NL-RE-COMPANY.
  5491                 24  NL-RE-COMP      PIC  X(03).
  5492                 24  NL-RE-CO-SUB    PIC  X(03).
  5493             20  NL-RE-TABLE         PIC  X(03).
  5494             20  FILLER              PIC  X(18).
  5495
  5496     12  NL-MAINT-INFORMATION.
  5497         16  NL-LAST-MAINT-DT        PIC  X(02).
  5498         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  5499         16  NL-LAST-MAINT-USER      PIC  X(04).
  5500         16  FILLER                  PIC  X(10).
  5501
  5502     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  5503         16  NL-RE-LEVEL             PIC  9(02).
  5504
  5505     12  NL-CITY                     PIC  X(15).
  5506     12  NL-ST                       PIC  XX.
  5507
  5508******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 104
* EL6501.cbl
  5510*    COPY ERCRQST.
  5511******************************************************************
  5512*                                                                *
  5513*                                                                *
  5514*                            ERCRQST.                            *
  5515*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5516*                            VMOD=2.002                          *
  5517*                                                                *
  5518*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5519*                                                                *
  5520*   FILE TYPE = VSAM,KSDS                                        *
  5521*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5522*                                                                *
  5523*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5524*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5525*                                   ACCOUNT, REF, BATCH)         *
  5526*                                                RKP=9, LEN=38   *
  5527*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5528*                                   ACCOUNT, REF, BATCH)         *
  5529*                                                RKP=47, LEN=46  *
  5530*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5531*                                   BATCH)                       *
  5532*                                                RKP=93, LEN=24  *
  5533*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5534*                                   REF, BATCH)                  *
  5535*                                                RKP=117, LEN=35 *
  5536*   LOG = NO                                                     *
  5537*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5538******************************************************************
  5539
  5540 01  AR-REQUEST-RECORD.
  5541     12  RQ-RECORD-ID                     PIC XX.
  5542         88  VALID-RQ-ID                        VALUE 'RQ'.
  5543
  5544     12  RQ-CONTROL-PRIMARY.
  5545         16  RQ-COMPANY-CD                PIC X.
  5546         16  RQ-ENTRY-BATCH               PIC X(6).
  5547
  5548     12  RQ-CONTROL-BY-ACCT-REF.
  5549         16  RQ-COMPANY-CD-A1             PIC X.
  5550         16  RQ-CARRIER-A1                PIC X.
  5551         16  RQ-GROUPING-A1               PIC X(6).
  5552         16  RQ-STATE-A1                  PIC XX.
  5553         16  RQ-ACCOUNT-A1                PIC X(10).
  5554         16  RQ-REFERENCE-A1              PIC X(12).
  5555         16  RQ-BATCH-A1                  PIC X(6).
  5556
  5557     12  RQ-CONTROL-BY-FIN-RESP.
  5558         16  RQ-COMPANY-CD-A2             PIC X.
  5559         16  RQ-CARRIER-A2                PIC X.
  5560         16  RQ-GROUPING-A2               PIC X(6).
  5561         16  RQ-FIN-RESP-A2               PIC X(10).
  5562         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5563         16  RQ-REFERENCE-A2              PIC X(12).
  5564         16  RQ-BATCH-A2                  PIC X(6).
  5565
  5566     12  RQ-CONTROL-BY-ACCT-AGENT.
  5567         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 105
* EL6501.cbl
  5568         16  RQ-CARRIER-A3                PIC X.
  5569         16  RQ-GROUPING-A3               PIC X(6).
  5570         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5571         16  RQ-BATCH-A3                  PIC X(6).
  5572
  5573     12  RQ-CONTROL-BY-SUMMARY.
  5574         16  RQ-COMPANY-CD-A4             PIC X.
  5575         16  RQ-SUMMARY-CODE              PIC X(6).
  5576         16  RQ-ACCOUNT-A4                PIC X(10).
  5577         16  RQ-REFERENCE-A4              PIC X(12).
  5578         16  RQ-BATCH-A4                  PIC X(6).
  5579
  5580     12  RQ-REQUEST-METHOD                PIC X.
  5581         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5582         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5583         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5584         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5585     12  FILLER                           PIC X.
  5586     12  RQ-STATUS                        PIC X.
  5587         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5588         88  RQ-RESUBMIT                      VALUE 'R'.
  5589     12  RQ-PROCESSOR-ID                  PIC X(4).
  5590     12  RQ-ENTRY-DT                      PIC XX.
  5591     12  RQ-MO-END-DT                     PIC XX.
  5592     12  RQ-REQUEST-DT                    PIC XX.
  5593     12  RQ-STMT-DT                       PIC XX.
  5594     12  RQ-REVERSAL-DT                   PIC XX.
  5595     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5596     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5597
  5598     12  FILLER                           PIC X(27).
  5599
  5600******************************************************************
  5601
  5602*EJECT
  5603*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 106
* EL6501.cbl
  5605 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  5606                          CONTROL-FILE REINSURANCE-RECORD
  5607                          COMM-TABLE-RECORD NOTE-FILE
  5608                          COMMISSION-WORK-AREA
  5609                          COMPENSATION-MASTER
  5610                          NAME-LOOKUP-MASTER AR-REQUEST-RECORD.
  5611 0000-DFHEXIT SECTION.
  5612     MOVE '9#                    $   ' TO DFHEIV0.
  5613     MOVE 'EL6501' TO DFHEIV1.
  5614     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5615     MOVE EIBTRMID              TO QID-TERM.
  5616
  5617     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  5618     MOVE '5'                   TO DC-OPTION-CODE.
  5619     PERFORM 9700-DATE-LINK.
  5620     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  5621     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  5622
  5623***  Y2K PROJ 7744
  5624     MOVE DC-GREG-DATE-1-YMD    TO  CYMD-CURRENT-SAVE
  5625                                    CURRENT-SAVE
  5626     MOVE DC-ALPHA-CENTURY      TO  CYMD-CURRENT-SAVE(1:2)
  5627                                    CURRENT-SAVE(1:2)
  5628***  Y2K PROJ 7744
  5629
  5630     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5631     IF EIBCALEN = 0
  5632         GO TO 8800-UNAUTHORIZED-ACCESS.
  5633
  5634     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  5635     MOVE LOW-VALUES             TO EL6501AI.
  5636
  5637
  5638* EXEC CICS HANDLE CONDITION
  5639*        PGMIDERR  (9600-PGMID-ERROR)
  5640*        ERROR     (9990-ABEND)
  5641*        QIDERR    (0500-CHECK-MAINT-TYPE)
  5642*    END-EXEC.
  5643*    MOVE '"$L.N                 ! " #00005633' TO DFHEIV0
  5644     MOVE X'22244C2E4E20202020202020' TO DFHEIV0(1:12)
  5645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5646     MOVE X'2220233030303035363333' TO DFHEIV0(25:11)
  5647     CALL 'kxdfhei1' USING DFHEIV0
  5648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5649
  5650
  5651     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5652         IF PI-CALLING-PROGRAM = XCTL-650
  5653             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5654             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5655             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5656             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5657             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5658             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5659             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5660             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5661             PERFORM 5200-DELETE-TS THRU 5299-EXIT
  5662             GO TO 0500-CHECK-MAINT-TYPE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 107
* EL6501.cbl
  5663         ELSE
  5664             PERFORM 5200-RECOVER-TS  THRU  5299-EXIT
  5665             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5666             GO TO 0600-DISPLAY-RECORD.
  5667
  5668     IF EIBAID = DFHCLEAR
  5669         GO TO 9400-CLEAR.
  5670
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 108
* EL6501.cbl
  5672 0200-RECEIVE.
  5673     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5674         MOVE ER-0008            TO EMI-ERROR
  5675         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5676         MOVE -1                 TO PFENTERL
  5677         GO TO 8200-SEND-DATAONLY.
  5678
  5679
  5680* EXEC CICS RECEIVE
  5681*        MAP      (MAP-NAME)
  5682*        MAPSET   (MAPSET-NAME)
  5683*        INTO     (EL6501AI)
  5684*    END-EXEC.
  5685     MOVE LENGTH OF
  5686      EL6501AI
  5687       TO DFHEIV11
  5688*    MOVE '8"T I  L              ''   #00005667' TO DFHEIV0
  5689     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5690     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5691     MOVE X'2020233030303035363637' TO DFHEIV0(25:11)
  5692     CALL 'kxdfhei1' USING DFHEIV0,
  5693           MAP-NAME,
  5694           EL6501AI,
  5695           DFHEIV11,
  5696           MAPSET-NAME,
  5697           DFHEIV99,
  5698           DFHEIV99
  5699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5700
  5701
  5702     IF PFENTERL = 0
  5703         GO TO 0300-CHECK-PFKEYS.
  5704     IF EIBAID NOT = DFHENTER
  5705         MOVE ER-0004            TO EMI-ERROR
  5706         GO TO 0320-INPUT-ERROR.
  5707     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  5708         MOVE PF-VALUES (PFENTERI) TO EIBAID
  5709     ELSE
  5710         MOVE ER-0029            TO EMI-ERROR
  5711         GO TO 0320-INPUT-ERROR.
  5712
  5713 0300-CHECK-PFKEYS.
  5714     IF EIBAID = DFHPF23
  5715         GO TO 8810-PF23.
  5716     IF EIBAID = DFHPF24
  5717         GO TO 9200-RETURN-MAIN-MENU.
  5718     IF EIBAID = DFHPF12
  5719         GO TO 9500-PF12.
  5720
  5721* CHECK PF10 KEY FOR A CALL TO EL608 TO BROWSE RESIDENT STATE TAX
  5722*             MASTER(ERRESC)
  5723*
  5724*    IF  EIBAID = DFHPF10
  5725*        IF PI-COMPANY-ID = 'DMD'
  5726*           PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5727*           MOVE LOW-VALUES TO WS-DMD-AGENT
  5728*           PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5729*           PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 109
* EL6501.cbl
  5730*           PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5731*           MOVE EIBAID       TO PI-ENTRY-CD-1
  5732*           MOVE WS-COMP-DATE TO PI-PREV-VG-ACCOUNT (11:5)
  5733*           MOVE WS-DMD-AGENT TO PI-PREV-VG-ACCOUNT (1:10)
  5734*           MOVE XCTL-608           TO PGM-NAME
  5735*                                      PI-RETURN-TO-PROGRAM
  5736*                                      PI-CALLING-PROGRAM
  5737*           MOVE '106E'             TO PI-CURRENT-SCREEN-NO
  5738*           GO TO 9300-XCTL.
  5739
  5740     IF (EIBAID = DFHPF1  OR  DFHPF2  OR DFHPF3 OR
  5741                  DFHPF4  OR  DFHPF5  OR DFHPF7 OR
  5742                  DFHPF8  OR  DFHPF9 OR DFHPF10)
  5743         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  5744             MOVE ER-0029        TO  EMI-ERROR
  5745             GO TO 0320-INPUT-ERROR
  5746         ELSE
  5747             GO TO 0800-CHECK-MAINT.
  5748
  5749     IF EIBAID = DFHENTER
  5750         GO TO 0330-EDIT-DATA.
  5751
  5752     MOVE ER-0029                TO EMI-ERROR.
  5753
  5754 0320-INPUT-ERROR.
  5755     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5756     MOVE AL-UNBON               TO PFENTERA.
  5757     MOVE -1                     TO PFENTERL.
  5758     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 110
* EL6501.cbl
  5760 0330-EDIT-DATA.
  5761     IF MAINTI  = 'S'
  5762        PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5763        PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5764        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5765        PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5766        MOVE -1                  TO MAINTL
  5767        GO TO 8100-SEND-INITIAL-MAP.
  5768
  5769     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  5770     PERFORM 6800-COMPANY-REC-READ THRU 6899-EXIT.
  5771
  5772     IF EMI-ERROR NOT = ZEROS
  5773         MOVE -1                 TO MAINTL
  5774         GO TO 8200-SEND-DATAONLY.
  5775
  5776     IF NOT MODIFY-CAP
  5777         MOVE 'UPDATE'           TO SM-READ
  5778         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5779         MOVE ER-0070            TO EMI-ERROR
  5780         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5781         GO TO 8100-SEND-INITIAL-MAP.
  5782
  5783     MOVE SAVE-BIN-DATE          TO BIN-CURRENT-SAVE.
  5784
  5785     IF MAINTI = 'A'
  5786        GO TO 1000-ADD-A-RECORD.
  5787
  5788     IF MAINTI = 'C'
  5789        IF PI-SV-MAINT  =  'L'
  5790            MOVE -1             TO MAINTL
  5791            MOVE AL-UABON       TO MAINTA
  5792            MOVE ER-0899        TO EMI-ERROR
  5793            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5794            GO TO 8200-SEND-DATAONLY
  5795        ELSE
  5796            GO TO 2000-CHANGE-A-RECORD.
  5797
  5798     IF MAINTI = 'L'
  5799        MOVE 'L'                TO PI-SV-MAINT
  5800        GO TO 3000-CHANGE-ALL-RECORDS.
  5801
  5802     MOVE ER-0023                TO EMI-ERROR.
  5803     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5804     MOVE -1                     TO MAINTL.
  5805     MOVE AL-UABON               TO MAINTA.
  5806     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 111
* EL6501.cbl
  5808 0500-CHECK-MAINT-TYPE.
  5809     IF PI-MAINT = 'A'
  5810        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5811        PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT
  5812        MOVE -1                  TO NAMEL
  5813        GO TO 8100-SEND-INITIAL-MAP.
  5814
  5815 0600-DISPLAY-RECORD.
  5816     PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT.
  5817     PERFORM 6500-READ-ACCT       THRU 6599-EXIT.
  5818     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  5819     PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT.
  5820
  5821     IF PI-MAINT = 'A'
  5822        MOVE -1                  TO NAMEL
  5823     ELSE
  5824        MOVE -1                  TO MAINTL.
  5825
  5826     GO TO 8100-SEND-INITIAL-MAP.
  5827
  5828 0700-FORMAT-KEYDATA.
  5829     MOVE PI-MAINT               TO MAINTI.
  5830
  5831     IF PI-MAINT = 'A'
  5832        MOVE AL-PANON            TO MAINTA
  5833        SET T-INDEX TO 1
  5834     ELSE
  5835        SET T-INDEX              TO PI-LINE-SELECTED
  5836        MOVE AL-UANON            TO MAINTA.
  5837
  5838     IF PI-2ND-PAGE
  5839         SET T-INDEX UP BY 8
  5840     ELSE
  5841     IF PI-3RD-PAGE
  5842         SET T-INDEX UP BY 16
  5843     ELSE
  5844     IF PI-LST-PAGE
  5845         SET T-INDEX UP BY 24.
  5846
  5847     MOVE PI-ACCT-CARRIER        TO CARRI.
  5848     MOVE PI-ACCT-GROUPING       TO GROUPINI.
  5849     MOVE PI-ACCT-STATE          TO STATEI.
  5850     MOVE PI-ACCT-ACCOUNT        TO ACCOUNTI.
  5851
  5852     IF PI-ACCT-EXP-DT = LOW-VALUES
  5853        MOVE SPACES              TO EXPDTEI
  5854     ELSE
  5855        IF PI-ACCT-EXP-DT NOT = HIGH-VALUES
  5856           MOVE PI-ACCT-EXP-DT      TO DC-BIN-DATE-1
  5857           MOVE SPACE               TO DC-OPTION-CODE
  5858           PERFORM 9700-DATE-LINK
  5859           MOVE DC-GREG-DATE-1-EDIT TO EXPDTEI
  5860        ELSE
  5861           MOVE 999999              TO EXPDTEO
  5862           INSPECT EXPDTEI CONVERTING SPACES TO '/'.
  5863
  5864***DMD CUSTOM CODE *****START
  5865     MOVE EXPDTEI (1:2)             TO WS-YYYYMMDD (5:2).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 112
* EL6501.cbl
  5866     MOVE EXPDTEI (4:2)             TO WS-YYYYMMDD (7:2).
  5867     MOVE EXPDTEI (6:2)             TO WS-YYYYMMDD (3:2).
  5868     IF EXPDTEI (7:1) IS NOT EQUAL TO '9'
  5869        MOVE '20'                 TO WS-YYYYMMDD (1:2)
  5870     ELSE
  5871        MOVE '19'                 TO WS-YYYYMMDD (1:2).
  5872***DMD CUSTOM CODE *****END
  5873
  5874     MOVE PI-BIN-EFF-DT (T-INDEX) TO DC-BIN-DATE-1.
  5875     MOVE SPACE                   TO DC-OPTION-CODE.
  5876     PERFORM 9700-DATE-LINK.
  5877     MOVE DC-GREG-DATE-1-EDIT     TO EFFDTEI.
  5878
  5879 0700-EXIT.
  5880      EXIT.
  5881
  5882 0800-CHECK-MAINT.
  5883     IF PI-MAINT = 'A'
  5884        IF PI-RECORD-NOT-CREATED
  5885           MOVE ER-2071          TO EMI-ERROR
  5886           MOVE  -1              TO NAMEL
  5887           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5888           GO TO 8200-SEND-DATAONLY.
  5889
  5890     IF  EIBAID = DFHPF1
  5891             AND
  5892         CREDIT-SESSION
  5893         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  5894         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  5895         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  5896         MOVE PI-ACCT-STATE      TO PI-STATE
  5897         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  5898         MOVE PI-ACCT-EXP-DT     TO PI-CERT-EFF-DT
  5899         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  5900         MOVE XCTL-689           TO PGM-NAME
  5901         GO TO 9300-XCTL.
  5902
  5903     IF  EIBAID = DFHPF2 AND CREDIT-SESSION
  5904         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  5905         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  5906         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  5907         MOVE PI-ACCT-STATE      TO PI-STATE
  5908         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  5909         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
  5910         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  5911         MOVE XCTL-690           TO PGM-NAME
  5912         GO TO 9300-XCTL
  5913     END-IF.
  5914
  5915     IF EIBAID = DFHPF3
  5916             AND
  5917         CREDIT-SESSION
  5918         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  5919         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  5920         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  5921         MOVE PI-ACCT-STATE      TO PI-STATE
  5922         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  5923         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 113
* EL6501.cbl
  5924         MOVE XCTL-653           TO PGM-NAME
  5925         GO TO 9300-XCTL.
  5926
  5927     IF EIBAID = DFHPF4
  5928         PERFORM 5100-WRITE-TS  THRU  5199-EXIT
  5929         MOVE XCTL-652           TO PGM-NAME
  5930         GO TO 9300-XCTL.
  5931
  5932     IF EIBAID = DFHPF5
  5933         MOVE XCTL-6502          TO PGM-NAME
  5934         GO TO 9300-XCTL.
  5935
  5936     IF EIBAID = DFHPF7
  5937         MOVE XCTL-6504          TO PGM-NAME
  5938         GO TO 9300-XCTL.
  5939
  5940     IF EIBAID = DFHPF8
  5941         MOVE XCTL-6506          TO PGM-NAME
  5942         GO TO 9300-XCTL.
  5943
  5944     IF EIBAID = DFHPF9
  5945        MOVE XCTL-6505           TO PGM-NAME
  5946        GO TO 9300-XCTL.
  5947
  5948     IF EIBAID = DFHPF10
  5949        IF PI-COMPANY-ID = 'DMD'
  5950           PERFORM 5100-WRITE-TS THRU 5199-EXIT
  5951           MOVE XCTL-608         TO PGM-NAME
  5952           GO TO 9300-XCTL.
  5953
  5954     MOVE ER-0029                TO EMI-ERROR.
  5955     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5956     MOVE AL-UNBON               TO PFENTERA.
  5957     MOVE -1                     TO PFENTERL.
  5958     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 114
* EL6501.cbl
  5960 1000-ADD-A-RECORD.
  5961     IF PI-MAINT = 'A'
  5962        PERFORM 4000-EDITS THRU 4900-EXIT
  5963     ELSE
  5964        MOVE ER-2180             TO EMI-ERROR
  5965        MOVE -1                  TO MAINTL
  5966        MOVE AL-UABON            TO MAINTA
  5967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5968
  5969     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  5970        EMI-FATAL-CTR    GREATER ZERO
  5971         GO TO 8200-SEND-DATAONLY.
  5972
  5973
  5974* EXEC CICS GETMAIN
  5975*         LENGTH   (ACCT-REC-LEN)
  5976*         SET      (ADDRESS OF ACCOUNT-MASTER)
  5977*         INITIMG  (GETMAIN-SPACE)
  5978*    END-EXEC.
  5979*    MOVE ',"IL                  $   #00005944' TO DFHEIV0
  5980     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5981     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5982     MOVE X'2020233030303035393434' TO DFHEIV0(25:11)
  5983     CALL 'kxdfhei1' USING DFHEIV0,
  5984           DFHEIV20,
  5985           ACCT-REC-LEN,
  5986           GETMAIN-SPACE
  5987     SET ADDRESS OF ACCOUNT-MASTER TO
  5988         DFHEIV20
  5989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5990
  5991
  5992     MOVE ZEROS          TO WSS-LF-LM-AGE (1) WSS-LF-LM-AGE (2)
  5993                            WSS-LF-LM-AGE (3) WSS-LF-LM-AGE (4)
  5994                            WSS-LF-LM-DUR (1) WSS-LF-LM-DUR (2)
  5995                            WSS-LF-LM-DUR (3) WSS-LF-LM-DUR (4)
  5996                            WSS-LF-LM-AMT (1) WSS-LF-LM-AMT (2)
  5997                            WSS-LF-LM-AMT (3) WSS-LF-LM-AMT (4).
  5998
  5999     MOVE ZEROS          TO WSS-AH-LM-AGE (1) WSS-LF-LM-AGE (2)
  6000                            WSS-AH-LM-AGE (3) WSS-LF-LM-AGE (4)
  6001                            WSS-AH-LM-DUR (1) WSS-LF-LM-DUR (2)
  6002                            WSS-AH-LM-DUR (3) WSS-LF-LM-DUR (4)
  6003                            WSS-AH-LM-AMT (1) WSS-LF-LM-AMT (2)
  6004                            WSS-AH-LM-AMT (3) WSS-LF-LM-AMT (4)
  6005                            WSS-AH-LM-MOA (1) WSS-AH-LM-MOA (2)
  6006                            WSS-AH-LM-MOA (3) WSS-AH-LM-MOA (4).
  6007
  6008     MOVE WSS-AGT-COMMS          TO AM-AGT-COMMS (1)
  6009                                    AM-AGT-COMMS (2)
  6010                                    AM-AGT-COMMS (3)
  6011                                    AM-AGT-COMMS (4)
  6012                                    AM-AGT-COMMS (5)
  6013                                    AM-AGT-COMMS (6)
  6014                                    AM-AGT-COMMS (7)
  6015                                    AM-AGT-COMMS (8)
  6016                                    AM-AGT-COMMS (9)
  6017                                    AM-AGT-COMMS (10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 115
* EL6501.cbl
  6018
  6019     IF PI-COMPANY-ID = 'FLI'
  6020         MOVE ZEROS              TO AM-FLI-BANK-BALANCE
  6021                                    AM-FLI-BANK-1ST-6-PREM
  6022                                    AM-FLI-BANK-CAP-AMT
  6023                                    AM-FLI-AGT-SHARE-PCT (1)
  6024                                    AM-FLI-AGT-SHARE-PCT (2)
  6025                                    AM-FLI-AGT-SHARE-PCT (3)
  6026                                    AM-FLI-AGT-SHARE-PCT (4)
  6027                                    AM-FLI-AGT-SHARE-PCT (5)
  6028                                    AM-FLI-AGT-SHARE-PCT (6)
  6029                                    AM-FLI-AGT-SHARE-PCT (7)
  6030                                    AM-FLI-AGT-SHARE-PCT (8)
  6031                                    AM-FLI-AGT-SHARE-PCT (9)
  6032                                    AM-FLI-AGT-SHARE-PCT (10).
  6033
  6034     MOVE ZEROS                  TO AM-GPCD
  6035                                    AM-LF-RET
  6036                                    AM-AH-RET
  6037                                    AM-LF-OB-RATE
  6038                                    AM-LF-OB-RATE-JNT
  6039                                    AM-AH-OB-RATE
  6040                                    AM-AH-OB-RATE-JNT
  6041                                    AM-REI-FEE-LF
  6042                                    AM-REI-FEE-AH
  6043                                    AM-REI-LF-TAX
  6044                                    AM-REI-PR-PCT
  6045                                    AM-REI-78-PCT
  6046                                    AM-REI-AH-TAX
  6047                                    AM-TOL-PREM
  6048                                    AM-TOL-REF
  6049                                    AM-CLP-TOL-PCT
  6050                                    AM-TOL-CLM
  6051                                    AM-CERTS-PURGED-DATE
  6052                                    AM-HI-CERT-DATE
  6053                                    AM-LO-CERT-DATE
  6054                                    AM-1ST-PROD-DATE
  6055                                    AM-GPCD
  6056                                    AM-CAL-TABLE
  6057                                    AM-LF-DEVIATION
  6058                                    AM-LF-DEVIATION-PCT
  6059                                    AM-AH-DEVIATION
  6060                                    AM-AH-DEVIATION-PCT
  6061                                    AM-ANNIVERSARY-DATE
  6062                                    AM-TEL-NO
  6063                                    AM-ENTRY-DATE
  6064                                    AM-INACTIVE-DATE
  6065                                    AM-RET-MIN-LOSS-L
  6066                                    AM-RET-MIN-LOSS-A
  6067                                    AM-LF-RPT021-EXP-PCT
  6068                                    AM-AH-RPT021-EXP-PCT
  6069                                    AM-MAX-MON-BEN
  6070                                    AM-MAX-TOT-BEN
  6071                                    AM-RETRO-QUALIFY-LIMIT
  6072                                    AM-RETRO-RET-PCT-LF (1)
  6073                                    AM-RETRO-RET-PCT-LF (2)
  6074                                    AM-RETRO-RET-PCT-LF (3)
  6075                                    AM-RETRO-RET-THRU-LF (1)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 116
* EL6501.cbl
  6076                                    AM-RETRO-RET-THRU-LF (2)
  6077                                    AM-RETRO-RET-THRU-LF (3)
  6078                                    AM-RETRO-RET-PCT-AH (1)
  6079                                    AM-RETRO-RET-PCT-AH (2)
  6080                                    AM-RETRO-RET-PCT-AH (3)
  6081                                    AM-RETRO-RET-THRU-AH (1)
  6082                                    AM-RETRO-RET-THRU-AH (2)
  6083                                    AM-RETRO-RET-THRU-AH (3).
  6084
  6085     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP
  6086                                    AM-AR-HI-CERT-DATE.
  6087
  6088     MOVE 'AM'                   TO AM-RECORD-ID.
  6089     MOVE PI-ACCT-KEY            TO AM-CONTROL-PRIMARY
  6090                                    AM-CONTROL-BY-VAR-GRP.
  6091
  6092     IF ST-ACCNT-CNTL
  6093        MOVE SPACES              TO AM-VG-CARRIER
  6094                                    AM-VG-GROUPING.
  6095     IF CARR-ST-ACCNT-CNTL
  6096        MOVE SPACES              TO AM-VG-GROUPING.
  6097
  6098     IF ACCNT-CNTL
  6099        MOVE SPACES              TO AM-VG-CARRIER
  6100                                    AM-VG-STATE
  6101                                    AM-VG-GROUPING.
  6102
  6103     IF CARR-ACCNT-CNTL
  6104        MOVE SPACES              TO AM-VG-STATE
  6105                                    AM-VG-GROUPING.
  6106
  6107     MOVE CURRENT-SAVE           TO AM-ENTRY-DATE.
  6108     MOVE BIN-EXPCHG-SAVE        TO AM-VG-EXPIRATION-DT.
  6109     MOVE PI-BIN-EFF-DT (1)      TO AM-EFFECTIVE-DT.
  6110
  6111     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6112     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6113     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6114
  6115     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6116
  6117     IF PI-COMPANY-ID = 'NCL'
  6118         MOVE 'N'                TO AM-AH-ONLY-INDICATOR.
  6119
  6120     MOVE AM-COMM-STRUCTURE      TO AM-COMM-STRUCTURE-SAVED.
  6121     MOVE SPACE                  TO AM-COMM-CHANGE-STATUS.
  6122
  6123     MOVE +1 TO AXRF-SUB
  6124                COMM-WORK-SUB.
  6125
  6126     PERFORM 6700-BUILD-COMM-WORK     THRU 6799-EXIT.
  6127     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6128
  6129     PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6130
  6131     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6132         NEXT SENTENCE
  6133     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 117
* EL6501.cbl
  6134         PERFORM 1500-ADD-COMP     THRU 1500-EXIT.
  6135
  6136
  6137* EXEC CICS WRITE
  6138*        FROM      (ACCOUNT-MASTER)
  6139*        RIDFLD    (AM-CONTROL-PRIMARY)
  6140*        DATASET   (ACCT-FILE-ID)
  6141*    END-EXEC.
  6142     MOVE LENGTH OF
  6143      ACCOUNT-MASTER
  6144       TO DFHEIV11
  6145*    MOVE '&$ L                  ''   #00006094' TO DFHEIV0
  6146     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6147     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6148     MOVE X'2020233030303036303934' TO DFHEIV0(25:11)
  6149     CALL 'kxdfhei1' USING DFHEIV0,
  6150           ACCT-FILE-ID,
  6151           ACCOUNT-MASTER,
  6152           DFHEIV11,
  6153           AM-CONTROL-PRIMARY,
  6154           DFHEIV99,
  6155           DFHEIV99
  6156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6157
  6158
  6159     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6160
  6161     MOVE PI-MAINT               TO PI-SV-MAINT.
  6162     MOVE 'C'                    TO PI-MAINT.
  6163     MOVE LOW-VALUES             TO EL6501AI.
  6164
  6165     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6166     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6167     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6168
  6169     IF PI-COMPANY-ID = 'NCL'
  6170         MOVE ER-4011            TO EMI-ERROR
  6171      ELSE
  6172         MOVE ER-0000            TO EMI-ERROR.
  6173
  6174     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6175
  6176     MOVE -1                     TO MAINTL.
  6177     MOVE AL-UANON               TO MAINTA.
  6178     MOVE '1'                    TO PI-RECORD-ADDED-SW.
  6179     GO TO 8100-SEND-INITIAL-MAP.
  6180
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 118
* EL6501.cbl
  6182 1500-ADD-COMP.
  6183
  6184* EXEC CICS GETMAIN
  6185*         LENGTH   (COMP-REC-LEN)
  6186*         SET      (ADDRESS OF COMPENSATION-MASTER)
  6187*         INITIMG  (GETMAIN-SPACE)
  6188*    END-EXEC.
  6189*    MOVE ',"IL                  $   #00006124' TO DFHEIV0
  6190     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6191     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6192     MOVE X'2020233030303036313234' TO DFHEIV0(25:11)
  6193     CALL 'kxdfhei1' USING DFHEIV0,
  6194           DFHEIV20,
  6195           COMP-REC-LEN,
  6196           GETMAIN-SPACE
  6197     SET ADDRESS OF COMPENSATION-MASTER TO
  6198         DFHEIV20
  6199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6200
  6201
  6202     MOVE SPACES                 TO COMPENSATION-MASTER.
  6203     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  6204                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  6205                   CO-OV30         CO-OV60      CO-OV90
  6206                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  6207                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  6208                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  6209                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  6210                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  6211                   CO-CURRENT-CUR     CO-CURRENT-OV30
  6212                   CO-CURRENT-OV60    CO-CURRENT-OV90
  6213                   CO-CURRENT-CUR-PMT
  6214                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  6215                   CO-ACT-YEAR        CO-ACT-MONTH
  6216                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  6217                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  6218                   CO-CURRENT-LAST-STMT-YEAR
  6219                   CO-CURRENT-LAST-STMT-MONTH
  6220                   CO-CURRENT-LAST-STMT-DAY
  6221                   CO-YTD-PAID-COM
  6222                   CO-YTD-PAID-OV.
  6223
  6224     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  6225     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  6226     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  6227     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  6228     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  6229
  6230     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  6231         MOVE ZEROS              TO CO-CARRIER
  6232     ELSE
  6233         MOVE AM-CARRIER         TO CO-CARRIER.
  6234
  6235     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  6236         MOVE ZEROS              TO CO-GROUPING
  6237     ELSE
  6238         MOVE AM-GROUPING        TO CO-GROUPING.
  6239
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 119
* EL6501.cbl
  6240     MOVE 'CO'                   TO CO-RECORD-ID
  6241     MOVE 'A'                    TO CO-TYPE.
  6242     MOVE AM-NAME                TO CO-ACCT-NAME.
  6243     MOVE AM-PERSON              TO CO-MAIL-NAME.
  6244     MOVE AM-ADDRS               TO CO-ADDR-1.
  6245*    MOVE AM-CITY                TO CO-ADDR-3.
  6246     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  6247     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  6248     MOVE AM-ZIP                 TO CO-ZIP.
  6249     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  6250     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  6251
  6252     IF PI-COMPANY-ID = 'NCL'
  6253         MOVE AM-ID-NO           TO  WS-SOC-SEC-WORK
  6254         IF WS-SS-TYPE = 'C' OR 'P' OR 'S' OR 'T' OR
  6255                         'X' OR 'I'
  6256             MOVE WS-SS-TYPE     TO  CO-TYPE-AGENT
  6257             MOVE WS-SOC-SEC     TO  CO-SOC-SEC
  6258         ELSE
  6259             MOVE SPACE          TO  CO-TYPE-AGENT
  6260             MOVE AM-ID-NO       TO  CO-SOC-SEC
  6261     ELSE
  6262         MOVE AM-ID-NO           TO CO-SOC-SEC.
  6263
  6264     IF AM-REMIT-TO NOT = ZERO
  6265         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  6266       ELSE
  6267         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  6268
  6269     MOVE +0                      TO AGT-SUB.
  6270
  6271     PERFORM 1600-FIND-C-AGT THRU 1600-EXIT.
  6272
  6273     IF VALID-AGT-SW = 'Y'
  6274         NEXT SENTENCE
  6275     ELSE
  6276         GO TO 1500-EXIT.
  6277
  6278     IF CO-RESP-NO = CO-ACCOUNT
  6279         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  6280     ELSE
  6281         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  6282
  6283     IF PI-AR-PROCESSING
  6284        MOVE 'G'                   TO CO-AR-REPORTING
  6285        MOVE '1'                   TO CO-AR-BAL-LEVEL
  6286        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  6287        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  6288
  6289     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  6290        MOVE 'N'                   TO CO-AR-REPORTING.
  6291
  6292     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  6293        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  6294
  6295     PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6296
  6297
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 120
* EL6501.cbl
  6298* EXEC CICS HANDLE CONDITION
  6299*         DUPREC   (1500-EXIT)
  6300*    END-EXEC.
  6301*    MOVE '"$%                   ! # #00006225' TO DFHEIV0
  6302     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6304     MOVE X'2320233030303036323235' TO DFHEIV0(25:11)
  6305     CALL 'kxdfhei1' USING DFHEIV0
  6306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6307
  6308
  6309
  6310* EXEC CICS WRITE
  6311*        FROM      (COMPENSATION-MASTER)
  6312*        RIDFLD    (CO-CONTROL-PRIMARY)
  6313*        DATASET   (COMP-FILE-ID)
  6314*    END-EXEC.
  6315     MOVE LENGTH OF
  6316      COMPENSATION-MASTER
  6317       TO DFHEIV11
  6318*    MOVE '&$ L                  ''   #00006229' TO DFHEIV0
  6319     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6320     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6321     MOVE X'2020233030303036323239' TO DFHEIV0(25:11)
  6322     CALL 'kxdfhei1' USING DFHEIV0,
  6323           COMP-FILE-ID,
  6324           COMPENSATION-MASTER,
  6325           DFHEIV11,
  6326           CO-CONTROL-PRIMARY,
  6327           DFHEIV99,
  6328           DFHEIV99
  6329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6330
  6331
  6332 1500-EXIT.
  6333      EXIT.
  6334
  6335 1600-FIND-C-AGT.
  6336     ADD 1 TO  AGT-SUB.
  6337     IF AGT-SUB GREATER 10
  6338         MOVE 'N'                TO  VALID-AGT-SW
  6339         GO TO 1600-EXIT.
  6340
  6341************************************************************
  6342**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6343************************************************************
  6344
  6345     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6346         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  6347         MOVE 'Y'                TO  VALID-AGT-SW
  6348         GO TO 1600-EXIT
  6349     ELSE
  6350         GO TO 1600-FIND-C-AGT.
  6351
  6352 1600-EXIT.
  6353     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 121
* EL6501.cbl
  6355 1700-CHANGE-COMP.
  6356     MOVE 'N'                    TO CHANGE-WAS-MADE-SW.
  6357     MOVE PI-COMPANY-CD          TO COMP-COMPANY-CD.
  6358
  6359     IF PI-ZERO-CARRIER
  6360       OR PI-ZERO-CAR-GROUP
  6361         MOVE ZEROS              TO COMP-CARRIER
  6362     ELSE
  6363         MOVE AM-CARRIER         TO COMP-CARRIER.
  6364
  6365     IF PI-ZERO-GROUPING
  6366       OR PI-ZERO-CAR-GROUP
  6367         MOVE ZEROS              TO COMP-GROUPING
  6368     ELSE
  6369         MOVE AM-GROUPING        TO COMP-GROUPING.
  6370
  6371     IF AM-REMIT-TO NOT = ZERO
  6372         MOVE AM-AGT (AM-REMIT-TO)
  6373                                 TO COMP-RESP-NO
  6374     ELSE
  6375         MOVE AM-ACCOUNT         TO COMP-RESP-NO.
  6376
  6377     MOVE ZERO                   TO AGT-SUB.
  6378
  6379     PERFORM 1800-FIND-C-AGT THRU 1899-EXIT.
  6380
  6381     IF VALID-AGT-SW = 'Y'
  6382         NEXT SENTENCE
  6383     ELSE
  6384         GO TO 1799-EXIT.
  6385
  6386     MOVE 'A'                    TO COMP-TYPE.
  6387
  6388
  6389* EXEC CICS HANDLE CONDITION
  6390*         ENDFILE     (1799-EXIT)
  6391*         NOTFND      (1799-EXIT)
  6392*    END-EXEC.
  6393*    MOVE '"$''I                  ! $ #00006291' TO DFHEIV0
  6394     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6396     MOVE X'2420233030303036323931' TO DFHEIV0(25:11)
  6397     CALL 'kxdfhei1' USING DFHEIV0
  6398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6399
  6400
  6401
  6402* EXEC CICS READ
  6403*        UPDATE
  6404*        DATASET   (COMP-FILE-ID)
  6405*        SET       (ADDRESS OF COMPENSATION-MASTER)
  6406*        RIDFLD    (COMP-KEY)
  6407*    END-EXEC.
  6408*    MOVE '&"S        EU         (   #00006296' TO DFHEIV0
  6409     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6410     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6411     MOVE X'2020233030303036323936' TO DFHEIV0(25:11)
  6412     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 122
* EL6501.cbl
  6413           COMP-FILE-ID,
  6414           DFHEIV20,
  6415           DFHEIV99,
  6416           COMP-KEY,
  6417           DFHEIV99,
  6418           DFHEIV99,
  6419           DFHEIV99
  6420     SET ADDRESS OF COMPENSATION-MASTER TO
  6421         DFHEIV20
  6422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6423
  6424
  6425     IF (ON-LAST-DATE-RANGE)
  6426        IF NAMEL GREATER ZEROS
  6427           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6428           MOVE AM-NAME          TO CO-ACCT-NAME
  6429        END-IF
  6430        IF INCAREL GREATER ZEROS
  6431           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6432           MOVE AM-PERSON        TO CO-MAIL-NAME
  6433        END-IF
  6434        IF ADDR1L GREATER ZEROS
  6435           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6436           MOVE AM-ADDRS         TO CO-ADDR-1
  6437        END-IF
  6438        IF ACITYL  GREATER ZEROS
  6439           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6440           MOVE AM-ADDR-CITY     TO CO-ADDR-CITY
  6441        END-IF
  6442        IF ASTATEL  GREATER ZEROS
  6443           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6444           MOVE AM-ADDR-STATE    TO CO-ADDR-STATE
  6445        END-IF
  6446        IF ZIPL GREATER ZEROS
  6447           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6448           MOVE AM-ZIP           TO CO-ZIP
  6449        END-IF
  6450        IF CSRL GREATER ZEROS
  6451           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6452           MOVE AM-CSR-CODE      TO CO-CSR-CODE
  6453        END-IF
  6454        IF PHONEL GREATER ZEROS
  6455           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6456           MOVE AM-TEL-NO        TO CO-TELEPHONE
  6457        END-IF
  6458        IF TAXNOL GREATER ZEROS
  6459           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6460           MOVE AM-ID-NO         TO CO-SOC-SEC
  6461        END-IF
  6462        IF AUTO-CANCEL-ACCOUNT
  6463           IF CO-BILL-SW = ' '
  6464              MOVE 'B'           TO CO-BILL-SW
  6465              MOVE 'Y'           TO CHANGE-WAS-MADE-SW
  6466           END-IF
  6467        END-IF
  6468     END-IF
  6469
  6470     IF PCONTL > 0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 123
* EL6501.cbl
  6471         MOVE 'Y'                TO CHANGE-WAS-MADE-SW
  6472         MOVE AM-CONTROL-NAME    TO CO-CONTROL-NAME
  6473     END-IF
  6474
  6475     IF CHANGE-WAS-MADE
  6476         MOVE BIN-CURRENT-SAVE   TO CO-LAST-MAINT-DT
  6477         MOVE PI-PROCESSOR-ID    TO CO-LAST-MAINT-USER
  6478         MOVE EIBTIME            TO CO-LAST-MAINT-HHMMSS.
  6479
  6480     IF NAMEL GREATER THAN ZERO
  6481         PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6482
  6483
  6484* EXEC CICS REWRITE
  6485*        FROM      (COMPENSATION-MASTER)
  6486*        DATASET   (COMP-FILE-ID)
  6487*    END-EXEC.
  6488     MOVE LENGTH OF
  6489      COMPENSATION-MASTER
  6490       TO DFHEIV11
  6491*    MOVE '&& L                  %   #00006361' TO DFHEIV0
  6492     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6493     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6494     MOVE X'2020233030303036333631' TO DFHEIV0(25:11)
  6495     CALL 'kxdfhei1' USING DFHEIV0,
  6496           COMP-FILE-ID,
  6497           COMPENSATION-MASTER,
  6498           DFHEIV11,
  6499           DFHEIV99
  6500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6501
  6502
  6503 1799-EXIT.
  6504     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 124
* EL6501.cbl
  6506 1800-FIND-C-AGT.
  6507     ADD 1                       TO  AGT-SUB.
  6508
  6509     IF AGT-SUB GREATER 10
  6510         MOVE 'N'                TO  VALID-AGT-SW
  6511         GO TO 1899-EXIT.
  6512
  6513************************************************************
  6514**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6515************************************************************
  6516
  6517     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6518         MOVE AM-AGT (AGT-SUB)   TO  COMP-ACCOUNT
  6519         MOVE 'Y'                TO  VALID-AGT-SW
  6520         GO TO 1899-EXIT
  6521     ELSE
  6522         GO TO 1800-FIND-C-AGT.
  6523
  6524 1899-EXIT.
  6525     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 125
* EL6501.cbl
  6527 2000-CHANGE-A-RECORD.
  6528     PERFORM 4000-EDITS THRU 4900-EXIT.
  6529
  6530     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6531        EMI-FATAL-CTR    GREATER ZERO
  6532         GO TO 8200-SEND-DATAONLY.
  6533
  6534
  6535* EXEC CICS READ
  6536*        UPDATE
  6537*        DATASET   (ACCT-FILE-ID)
  6538*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6539*        RIDFLD    (PI-ACCT-KEY)
  6540*    END-EXEC.
  6541*    MOVE '&"S        EU         (   #00006397' TO DFHEIV0
  6542     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6543     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6544     MOVE X'2020233030303036333937' TO DFHEIV0(25:11)
  6545     CALL 'kxdfhei1' USING DFHEIV0,
  6546           ACCT-FILE-ID,
  6547           DFHEIV20,
  6548           DFHEIV99,
  6549           PI-ACCT-KEY,
  6550           DFHEIV99,
  6551           DFHEIV99,
  6552           DFHEIV99
  6553     SET ADDRESS OF ACCOUNT-MASTER TO
  6554         DFHEIV20
  6555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6556
  6557
  6558     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6559
  6560     IF NOT PI-AR-PROCESSING
  6561        GO TO 2075-PROCESS-CHANGE.
  6562
  6563     MOVE AM-AGT (AM-REMIT-TO)   TO SAVE-FIN-RESP.
  6564     MOVE +0                     TO SUB1.
  6565
  6566 2075-PROCESS-CHANGE.
  6567     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6568
  6569     IF PI-AR-PROCESSING
  6570        PERFORM 5300-UPDATE-REQUEST-FILE THRU 5399-EXIT.
  6571
  6572     IF PI-COMPANY-ID = 'DMD'
  6573     IF AM-ANNIVERSARY-DATE = ZEROS
  6574           MOVE ER-0852             TO EMI-ERROR
  6575           MOVE -1                  TO CONTRL
  6576           MOVE AL-UABON            TO CONTRA
  6577           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6578
  6579     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6580        EMI-FATAL-CTR    GREATER ZERO
  6581         GO TO 8200-SEND-DATAONLY.
  6582
  6583     MOVE +1                     TO AXRF-SUB
  6584                                    COMM-WORK-SUB.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 126
* EL6501.cbl
  6585     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6586
  6587     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6588     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6589     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6590
  6591     IF ((PI-FST-PAGE)
  6592        AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  6593                      OR
  6594        ((PI-2ND-PAGE)
  6595        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  6596                      OR
  6597        ((PI-3RD-PAGE)
  6598        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  6599                      OR
  6600        ((PI-LST-PAGE)
  6601        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  6602        SET ON-LAST-DATE-RANGE   TO TRUE
  6603     END-IF
  6604     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6605         NEXT SENTENCE
  6606     ELSE
  6607         IF (ON-LAST-DATE-RANGE)
  6608                          OR
  6609            ((PI-COMPANY-ID = 'CID') AND
  6610             (PCONTL > ZERO))
  6611             PERFORM 1700-CHANGE-COMP THRU 1799-EXIT.
  6612
  6613     IF NAMEL GREATER THAN ZERO
  6614         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6615
  6616
  6617* EXEC CICS REWRITE
  6618*        FROM      (ACCOUNT-MASTER)
  6619*        DATASET   (ACCT-FILE-ID)
  6620*    END-EXEC.
  6621     MOVE LENGTH OF
  6622      ACCOUNT-MASTER
  6623       TO DFHEIV11
  6624*    MOVE '&& L                  %   #00006462' TO DFHEIV0
  6625     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6626     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6627     MOVE X'2020233030303036343632' TO DFHEIV0(25:11)
  6628     CALL 'kxdfhei1' USING DFHEIV0,
  6629           ACCT-FILE-ID,
  6630           ACCOUNT-MASTER,
  6631           DFHEIV11,
  6632           DFHEIV99
  6633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6634
  6635
  6636     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6637
  6638     IF CSRL GREATER ZEROS
  6639         GO TO 3500-CHANGE-ALL-CSR.
  6640
  6641     MOVE ER-0000                TO EMI-ERROR.
  6642     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 127
* EL6501.cbl
  6643     MOVE LOW-VALUES             TO EL6501AI.
  6644
  6645     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6646     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6647     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6648
  6649     MOVE ER-0000                TO EMI-ERROR.
  6650     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6651
  6652     MOVE -1                     TO MAINTL.
  6653     MOVE AL-UANON               TO MAINTA.
  6654     GO TO 8100-SEND-INITIAL-MAP.
  6655
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 128
* EL6501.cbl
  6657 2100-ADD-ACCOUNT-NAME.
  6658
  6659* EXEC CICS HANDLE CONDITION
  6660*         DUPREC   (2100-EXIT)
  6661*    END-EXEC.
  6662*    MOVE '"$%                   ! % #00006489' TO DFHEIV0
  6663     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6665     MOVE X'2520233030303036343839' TO DFHEIV0(25:11)
  6666     CALL 'kxdfhei1' USING DFHEIV0
  6667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6668
  6669
  6670
  6671* EXEC CICS GETMAIN
  6672*         LENGTH   (NAME-REC-LEN)
  6673*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6674*         INITIMG  (GETMAIN-SPACE)
  6675*    END-EXEC.
  6676*    MOVE ',"IL                  $   #00006493' TO DFHEIV0
  6677     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6678     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6679     MOVE X'2020233030303036343933' TO DFHEIV0(25:11)
  6680     CALL 'kxdfhei1' USING DFHEIV0,
  6681           DFHEIV20,
  6682           NAME-REC-LEN,
  6683           GETMAIN-SPACE
  6684     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6685         DFHEIV20
  6686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6687
  6688
  6689     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6690     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6691     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6692     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6693     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6694     MOVE AM-NAME                TO  NL-NAME.
  6695     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6696        MOVE NL-NAME (5:26)      TO NL-NAME
  6697     END-IF
  6698     MOVE AM-ADDR-CITY           TO  NL-CITY.
  6699     MOVE AM-ADDR-STATE          TO  NL-ST.
  6700     MOVE 'A'                    TO  NL-RECORD-TYPE.
  6701     MOVE PI-COMPANY-CD          TO  NL-AM-COMPANY-CD.
  6702     MOVE AM-CARRIER             TO  NL-AM-CARRIER.
  6703     MOVE AM-GROUPING            TO  NL-AM-GROUPING.
  6704     MOVE AM-STATE               TO  NL-AM-STATE.
  6705     MOVE AM-ACCOUNT             TO  NL-AM-ACCOUNT.
  6706
  6707
  6708* EXEC CICS WRITE
  6709*        FROM      (NAME-LOOKUP-MASTER)
  6710*        RIDFLD    (NL-CONTROL-PRIMARY)
  6711*        DATASET   (NAME-FILE-ID)
  6712*    END-EXEC.
  6713     MOVE LENGTH OF
  6714      NAME-LOOKUP-MASTER
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 129
* EL6501.cbl
  6715       TO DFHEIV11
  6716*    MOVE '&$ L                  ''   #00006517' TO DFHEIV0
  6717     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6719     MOVE X'2020233030303036353137' TO DFHEIV0(25:11)
  6720     CALL 'kxdfhei1' USING DFHEIV0,
  6721           NAME-FILE-ID,
  6722           NAME-LOOKUP-MASTER,
  6723           DFHEIV11,
  6724           NL-CONTROL-PRIMARY,
  6725           DFHEIV99,
  6726           DFHEIV99
  6727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6728
  6729
  6730 2100-EXIT.
  6731     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 130
* EL6501.cbl
  6733 2200-ADD-COMPENSATION-NAME.
  6734
  6735* EXEC CICS HANDLE CONDITION
  6736*         DUPREC   (2200-EXIT)
  6737*    END-EXEC.
  6738*    MOVE '"$%                   ! & #00006527' TO DFHEIV0
  6739     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6740     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6741     MOVE X'2620233030303036353237' TO DFHEIV0(25:11)
  6742     CALL 'kxdfhei1' USING DFHEIV0
  6743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6744
  6745
  6746
  6747* EXEC CICS GETMAIN
  6748*         LENGTH   (NAME-REC-LEN)
  6749*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6750*         INITIMG  (GETMAIN-SPACE)
  6751*    END-EXEC.
  6752*    MOVE ',"IL                  $   #00006531' TO DFHEIV0
  6753     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6754     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6755     MOVE X'2020233030303036353331' TO DFHEIV0(25:11)
  6756     CALL 'kxdfhei1' USING DFHEIV0,
  6757           DFHEIV20,
  6758           NAME-REC-LEN,
  6759           GETMAIN-SPACE
  6760     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6761         DFHEIV20
  6762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6763
  6764
  6765     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6766     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6767     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6768     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6769     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6770     MOVE CO-ACCT-NAME           TO  NL-NAME.
  6771     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6772        MOVE NL-NAME (5:26)      TO NL-NAME
  6773     END-IF
  6774     MOVE CO-ADDR-CITY           TO  NL-CITY.
  6775     MOVE CO-ADDR-STATE          TO  NL-ST
  6776     MOVE 'C'                    TO  NL-RECORD-TYPE.
  6777     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  6778     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  6779     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  6780     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  6781     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  6782     MOVE CO-TYPE                TO  NL-CO-TYPE.
  6783
  6784
  6785* EXEC CICS WRITE
  6786*        FROM      (NAME-LOOKUP-MASTER)
  6787*        RIDFLD    (NL-CONTROL-PRIMARY)
  6788*        DATASET   (NAME-FILE-ID)
  6789*    END-EXEC.
  6790     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 131
* EL6501.cbl
  6791      NAME-LOOKUP-MASTER
  6792       TO DFHEIV11
  6793*    MOVE '&$ L                  ''   #00006556' TO DFHEIV0
  6794     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6795     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6796     MOVE X'2020233030303036353536' TO DFHEIV0(25:11)
  6797     CALL 'kxdfhei1' USING DFHEIV0,
  6798           NAME-FILE-ID,
  6799           NAME-LOOKUP-MASTER,
  6800           DFHEIV11,
  6801           NL-CONTROL-PRIMARY,
  6802           DFHEIV99,
  6803           DFHEIV99
  6804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6805
  6806
  6807 2200-EXIT.
  6808     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 132
* EL6501.cbl
  6810 3000-CHANGE-ALL-RECORDS.
  6811     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP.
  6812     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  6813
  6814
  6815* EXEC CICS HANDLE CONDITION
  6816*         ENDFILE     (3030-END-FILE)
  6817*    END-EXEC.
  6818*    MOVE '"$''                   ! '' #00006569' TO DFHEIV0
  6819     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  6820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6821     MOVE X'2720233030303036353639' TO DFHEIV0(25:11)
  6822     CALL 'kxdfhei1' USING DFHEIV0
  6823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6824
  6825
  6826     PERFORM 6300-STARTBR THRU 6300-EXIT.
  6827
  6828 3010-READ-NEXT.
  6829     PERFORM 6310-READNEXT THRU 6310-EXIT.
  6830
  6831     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  6832        GO TO 3030-END-FILE.
  6833
  6834
  6835* EXEC CICS ENDBR
  6836*        DATASET   (ACCT-FILE-ID)
  6837*    END-EXEC.
  6838     MOVE 0
  6839       TO DFHEIV11
  6840*    MOVE '&2                    $   #00006581' TO DFHEIV0
  6841     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6842     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6843     MOVE X'2020233030303036353831' TO DFHEIV0(25:11)
  6844     CALL 'kxdfhei1' USING DFHEIV0,
  6845           ACCT-FILE-ID,
  6846           DFHEIV11,
  6847           DFHEIV99
  6848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6849
  6850     ADD +1                      TO WS-CHANGE-ALL-CNT
  6851
  6852* EXEC CICS READ
  6853*        UPDATE
  6854*        DATASET   (ACCT-FILE-ID)
  6855*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6856*        RIDFLD    (WS-KEY-SAVE)
  6857*    END-EXEC.
  6858*    MOVE '&"S        EU         (   #00006585' TO DFHEIV0
  6859     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6860     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6861     MOVE X'2020233030303036353835' TO DFHEIV0(25:11)
  6862     CALL 'kxdfhei1' USING DFHEIV0,
  6863           ACCT-FILE-ID,
  6864           DFHEIV20,
  6865           DFHEIV99,
  6866           WS-KEY-SAVE,
  6867           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 133
* EL6501.cbl
  6868           DFHEIV99,
  6869           DFHEIV99
  6870     SET ADDRESS OF ACCOUNT-MASTER TO
  6871         DFHEIV20
  6872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6873
  6874
  6875     IF NAMEL    GREATER THAN ZERO  OR
  6876        INCAREL  GREATER THAN ZERO  OR
  6877        ADDR1L   GREATER THAN ZERO  OR
  6878        ACITYL   GREATER THAN ZERO  OR
  6879        ASTATEL  GREATER THAN ZERO  OR
  6880        ZIPL     GREATER THAN ZERO  OR
  6881        CLPTOLPL GREATER THAN ZERO  OR
  6882        PHONEL   GREATER THAN ZERO
  6883         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  6884
  6885     IF STATUSL > ZERO
  6886        EVALUATE TRUE
  6887           WHEN STATUSI = 'A'
  6888              MOVE '0'           TO AM-STATUS
  6889           WHEN STATUSI = 'I'
  6890              MOVE '1'           TO AM-STATUS
  6891           WHEN (STATUSI = 'C')
  6892              AND (AM-STATUS NOT = '3' AND 'C')
  6893              MOVE '3'           TO AM-STATUS
  6894              SET AUTO-CANCEL-ACCOUNT
  6895                                 TO TRUE
  6896           WHEN (STATUSI = 'C')
  6897              MOVE '3'           TO AM-STATUS
  6898           WHEN STATUSI = 'F'
  6899              MOVE '4'           TO AM-STATUS
  6900           WHEN OTHER
  6901              MOVE -1            TO STATUSL
  6902              MOVE AL-UABON      TO STATUSA
  6903              MOVE ER-2153       TO EMI-ERROR
  6904              PERFORM 9900-ERROR-FORMAT
  6905                                 THRU 9900-EXIT
  6906        END-EVALUATE
  6907     END-IF
  6908*    IF STATUSL > ZERO
  6909*       IF STATUSI = 'A'
  6910*          MOVE '0'              TO AM-STATUS
  6911*       ELSE
  6912*          IF STATUSI = 'I'
  6913*             MOVE '1'           TO AM-STATUS
  6914*          ELSE
  6915*             IF STATUSI = 'C'
  6916*                IF AM-STATUS NOT = '3' AND 'C'
  6917*                   SET AUTO-CANCEL-ACCOUNT
  6918*                                TO TRUE
  6919*                END-IF
  6920*                MOVE '3'        TO AM-STATUS
  6921*             ELSE
  6922*                IF STATUSI = 'F'
  6923*                   MOVE '4'     TO AM-STATUS
  6924*                ELSE
  6925*                   MOVE -1         TO STATUSL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 134
* EL6501.cbl
  6926*                   MOVE AL-UABON   TO STATUSA
  6927*                   MOVE ER-2153    TO EMI-ERROR
  6928*                   PERFORM 9900-ERROR-FORMAT
  6929*                                THRU 9900-EXIT
  6930*                END-IF
  6931*             END-IF
  6932*          END-IF
  6933*       END-IF
  6934*    END-IF
  6935
  6936     IF CSRL GREATER ZERO
  6937        MOVE CSRI                TO AM-CSR-CODE.
  6938     IF NAMEL GREATER THAN ZERO
  6939        MOVE NAMEI               TO AM-NAME.
  6940     IF PCONTL GREATER THAN ZERO
  6941        MOVE PCONTI              TO AM-CONTROL-NAME
  6942     END-IF
  6943     IF INCAREL GREATER ZEROS
  6944        MOVE INCAREI             TO AM-PERSON.
  6945     IF ADDR1L GREATER ZEROS
  6946        MOVE ADDR1I              TO AM-ADDRS.
  6947     IF ACITYL GREATER ZEROS
  6948        MOVE ACITYI             TO AM-ADDR-CITY.
  6949     IF ASTATEL GREATER ZEROS
  6950        MOVE ASTATEI            TO AM-ADDR-STATE.
  6951     IF ZIPL NOT GREATER ZEROS
  6952         GO TO 3015-CONT-CHANGING.
  6953
  6954     MOVE ZIPI                   TO WS-ZIP-CODE.
  6955
  6956     IF WS-CANADIAN-ZIP
  6957         IF WS-ZIP-4 = SPACE  OR  '-'
  6958             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  6959             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  6960         ELSE
  6961             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  6962             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  6963     ELSE
  6964         IF WS-ZIP-6 = SPACE  OR  '-'
  6965             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  6966             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  6967         ELSE
  6968             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  6969             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  6970
  6971 3015-CONT-CHANGING.
  6972
  6973     IF CLPTOLPL GREATER ZEROS
  6974
  6975* EXEC CICS BIF
  6976*            DEEDIT
  6977*            FIELD    (CLPTOLPI)
  6978*            LENGTH   (6)
  6979*        END-EXEC
  6980     MOVE 6
  6981       TO DFHEIV11
  6982*    MOVE '@"L                   #   #00006691' TO DFHEIV0
  6983     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 135
* EL6501.cbl
  6984     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6985     MOVE X'2020233030303036363931' TO DFHEIV0(25:11)
  6986     CALL 'kxdfhei1' USING DFHEIV0,
  6987           CLPTOLPI,
  6988           DFHEIV11
  6989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6990         IF CLPTOLPI NUMERIC
  6991             MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  6992         ELSE
  6993             MOVE -1                  TO CLPTOLPL
  6994             MOVE AL-UNBON            TO CLPTOLPA
  6995             MOVE ER-1778             TO EMI-ERROR
  6996             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6997         END-IF
  6998     END-IF
  6999
  7000     IF LCOMML > ZEROS
  7001
  7002* EXEC CICS BIF
  7003*            DEEDIT
  7004*            FIELD    (LCOMMI)
  7005*            LENGTH   (8)
  7006*        END-EXEC
  7007     MOVE 8
  7008       TO DFHEIV11
  7009*    MOVE '@"L                   #   #00006707' TO DFHEIV0
  7010     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7011     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7012     MOVE X'2020233030303036373037' TO DFHEIV0(25:11)
  7013     CALL 'kxdfhei1' USING DFHEIV0,
  7014           LCOMMI,
  7015           DFHEIV11
  7016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7017         IF LCOMMI NUMERIC
  7018            MOVE LCOMMI          TO AM-SPP-LEASE-COMM
  7019         ELSE
  7020            MOVE -1              TO LCOMML
  7021            MOVE AL-UNBON        TO LCOMMA
  7022            MOVE ER-1778         TO EMI-ERROR
  7023            PERFORM 9900-ERROR-FORMAT
  7024                                 THRU 9900-EXIT
  7025         END-IF
  7026     END-IF
  7027
  7028     IF PHONEL GREATER ZEROS
  7029        MOVE PHONEI              TO DEEDIT-FIELD
  7030        PERFORM 8600-DEEDIT
  7031        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  7032        MOVE WS-PH1              TO AM-AREA-CODE
  7033        MOVE WS-PH2              TO AM-TEL-PRE
  7034        MOVE WS-PH3              TO AM-TEL-NBR.
  7035
  7036     IF PSILFFL GREATER +0
  7037        MOVE PSILFFI             TO DEEDIT-FIELD
  7038        PERFORM 8600-DEEDIT
  7039        IF DEEDIT-FIELD NUMERIC
  7040           MOVE DEEDIT-FIELD-V5  TO AM-LF-PSI-FACTOR.
  7041
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 136
* EL6501.cbl
  7042     IF PSIAHFL GREATER +0
  7043        MOVE PSIAHFI             TO DEEDIT-FIELD
  7044        PERFORM 8600-DEEDIT
  7045        IF DEEDIT-FIELD NUMERIC
  7046           MOVE DEEDIT-FIELD-V5  TO AM-AH-PSI-FACTOR.
  7047
  7048     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7049     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7050     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7051
  7052     IF ((PI-FST-PAGE)
  7053        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT))
  7054                      OR
  7055        ((PI-2ND-PAGE)
  7056        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 8))
  7057                      OR
  7058        ((PI-3RD-PAGE)
  7059        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 16))
  7060                      OR
  7061        ((PI-LST-PAGE)
  7062        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 24))
  7063        SET ON-LAST-DATE-RANGE   TO TRUE
  7064     END-IF
  7065*    IF ((PI-FST-PAGE)
  7066*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  7067*                     OR
  7068*       ((PI-2ND-PAGE)
  7069*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  7070*                     OR
  7071*       ((PI-3RD-PAGE)
  7072*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  7073*                     OR
  7074*       ((PI-LST-PAGE)
  7075*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  7076*       SET ON-LAST-DATE-RANGE   TO TRUE
  7077*    END-IF
  7078     MOVE PI-PAGE-NUMBER TO WS-PAGE-NUMBER
  7079     MOVE PI-TOTAL-LINES TO WS-TOTAL-LINES
  7080     MOVE PI-LINE-SELECTED TO WS-LINE-SELECTED
  7081*    EXEC CICS DELAY
  7082*       INTERVAL (WS-DELAY-INT)
  7083*    END-EXEC
  7084     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7085        CONTINUE
  7086     ELSE
  7087        IF (ON-LAST-DATE-RANGE)
  7088                   OR
  7089           ((PI-COMPANY-ID = 'CID') AND
  7090           (PCONTL > ZERO))
  7091           PERFORM 1700-CHANGE-COMP
  7092                                 THRU 1799-EXIT
  7093        END-IF
  7094     END-IF
  7095
  7096     IF NAMEL GREATER THAN ZERO
  7097         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  7098
  7099
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 137
* EL6501.cbl
  7100* EXEC CICS REWRITE
  7101*        FROM      (ACCOUNT-MASTER)
  7102*        DATASET   (ACCT-FILE-ID)
  7103*    END-EXEC.
  7104     MOVE LENGTH OF
  7105      ACCOUNT-MASTER
  7106       TO DFHEIV11
  7107*    MOVE '&& L                  %   #00006794' TO DFHEIV0
  7108     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7109     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7110     MOVE X'2020233030303036373934' TO DFHEIV0(25:11)
  7111     CALL 'kxdfhei1' USING DFHEIV0,
  7112           ACCT-FILE-ID,
  7113           ACCOUNT-MASTER,
  7114           DFHEIV11,
  7115           DFHEIV99
  7116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7117
  7118
  7119     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7120     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7121
  7122     GO TO 3010-READ-NEXT.
  7123
  7124 3030-END-FILE.
  7125     IF BROWSE-STARTED
  7126        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7127
  7128     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7129
  7130     IF AUTO-CANCEL-ACCOUNT
  7131
  7132* EXEC CICS GETMAIN
  7133*          LENGTH   (ERACNT-REC-LEN)
  7134*          SET      (ADDRESS OF NOTE-FILE)
  7135*          INITIMG  (GETMAIN-SPACE)
  7136*          RESP     (WS-RESPONSE)
  7137*       END-EXEC
  7138*    MOVE ',"IL                  $  N#00006811' TO DFHEIV0
  7139     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7140     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7141     MOVE X'204E233030303036383131' TO DFHEIV0(25:11)
  7142     CALL 'kxdfhei1' USING DFHEIV0,
  7143           DFHEIV20,
  7144           ERACNT-REC-LEN,
  7145           GETMAIN-SPACE
  7146     SET ADDRESS OF NOTE-FILE TO
  7147         DFHEIV20
  7148     MOVE EIBRESP  TO WS-RESPONSE
  7149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7150        MOVE PI-ACCT-CCGSA-KEY   TO NT-CONTROL-PRIMARY
  7151        MOVE '1'                 TO NT-RECORD-TYPE
  7152        MOVE +1                  TO NT-LINE-SEQUENCE
  7153        MOVE SAVE-BIN-DATE       TO NT-LAST-MAINT-DT
  7154        MOVE PI-PROCESSOR-ID     TO NT-LAST-MAINT-BY
  7155        MOVE EIBTIME             TO NT-LAST-MAINT-HHMMSS
  7156        MOVE 'CANCELLED DUE TO LOW PRODUCTION'
  7157                                 TO NT-NOTE-LINE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 138
* EL6501.cbl
  7158        PERFORM WITH TEST AFTER UNTIL
  7159           (NOT RESP-DUPKEY)
  7160           AND (NOT RESP-DUPREC)
  7161
  7162* EXEC CICS WRITE
  7163*             FROM      (NOTE-FILE)
  7164*             RIDFLD    (NT-CONTROL-PRIMARY)
  7165*             DATASET   (ERACNT-FILE-ID)
  7166*             RESP      (WS-RESPONSE)
  7167*          END-EXEC
  7168     MOVE LENGTH OF
  7169      NOTE-FILE
  7170       TO DFHEIV11
  7171*    MOVE '&$ L                  ''  N#00006828' TO DFHEIV0
  7172     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7173     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7174     MOVE X'204E233030303036383238' TO DFHEIV0(25:11)
  7175     CALL 'kxdfhei1' USING DFHEIV0,
  7176           ERACNT-FILE-ID,
  7177           NOTE-FILE,
  7178           DFHEIV11,
  7179           NT-CONTROL-PRIMARY,
  7180           DFHEIV99,
  7181           DFHEIV99
  7182     MOVE EIBRESP  TO WS-RESPONSE
  7183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7184           IF RESP-DUPKEY OR RESP-DUPREC
  7185              ADD +1             TO NT-LINE-SEQUENCE
  7186           END-IF
  7187        END-PERFORM
  7188     END-IF
  7189     IF NOT EMI-NO-ERRORS
  7190         GO TO 8200-SEND-DATAONLY.
  7191
  7192     MOVE -1                     TO NAMEL.
  7193     MOVE ER-0000                TO EMI-ERROR.
  7194     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7195     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 139
* EL6501.cbl
  7197 3500-CHANGE-ALL-CSR.
  7198     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7199     MOVE LOW-VALUES             TO WS-ACCT-EXP-DT
  7200                                    WS-ACCT-REST-OF-EXP.
  7201
  7202
  7203* EXEC CICS HANDLE CONDITION
  7204*         ENDFILE     (3530-END-FILE)
  7205*    END-EXEC.
  7206*    MOVE '"$''                   ! ( #00006852' TO DFHEIV0
  7207     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7209     MOVE X'2820233030303036383532' TO DFHEIV0(25:11)
  7210     CALL 'kxdfhei1' USING DFHEIV0
  7211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7212
  7213
  7214     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7215
  7216 3510-READ-NEXT.
  7217     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7218
  7219     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7220        GO TO 3530-END-FILE.
  7221
  7222
  7223* EXEC CICS ENDBR
  7224*        DATASET   (ACCT-FILE-ID)
  7225*    END-EXEC.
  7226     MOVE 0
  7227       TO DFHEIV11
  7228*    MOVE '&2                    $   #00006864' TO DFHEIV0
  7229     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7230     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7231     MOVE X'2020233030303036383634' TO DFHEIV0(25:11)
  7232     CALL 'kxdfhei1' USING DFHEIV0,
  7233           ACCT-FILE-ID,
  7234           DFHEIV11,
  7235           DFHEIV99
  7236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7237
  7238
  7239
  7240* EXEC CICS READ
  7241*        UPDATE
  7242*        DATASET   (ACCT-FILE-ID)
  7243*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7244*        RIDFLD    (WS-KEY-SAVE)
  7245*    END-EXEC.
  7246*    MOVE '&"S        EU         (   #00006868' TO DFHEIV0
  7247     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7248     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7249     MOVE X'2020233030303036383638' TO DFHEIV0(25:11)
  7250     CALL 'kxdfhei1' USING DFHEIV0,
  7251           ACCT-FILE-ID,
  7252           DFHEIV20,
  7253           DFHEIV99,
  7254           WS-KEY-SAVE,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 140
* EL6501.cbl
  7255           DFHEIV99,
  7256           DFHEIV99,
  7257           DFHEIV99
  7258     SET ADDRESS OF ACCOUNT-MASTER TO
  7259         DFHEIV20
  7260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7261
  7262
  7263     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7264     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7265     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7266
  7267     MOVE CSRI                   TO AM-CSR-CODE.
  7268
  7269
  7270* EXEC CICS REWRITE
  7271*        FROM      (ACCOUNT-MASTER)
  7272*        DATASET   (ACCT-FILE-ID)
  7273*    END-EXEC.
  7274     MOVE LENGTH OF
  7275      ACCOUNT-MASTER
  7276       TO DFHEIV11
  7277*    MOVE '&& L                  %   #00006881' TO DFHEIV0
  7278     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7279     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7280     MOVE X'2020233030303036383831' TO DFHEIV0(25:11)
  7281     CALL 'kxdfhei1' USING DFHEIV0,
  7282           ACCT-FILE-ID,
  7283           ACCOUNT-MASTER,
  7284           DFHEIV11,
  7285           DFHEIV99
  7286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7287
  7288
  7289     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7290     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7291
  7292     GO TO 3510-READ-NEXT.
  7293
  7294 3530-END-FILE.
  7295     IF BROWSE-STARTED
  7296        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7297
  7298     MOVE ER-4009                TO EMI-ERROR.
  7299     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7300     MOVE LOW-VALUES             TO EL6501AI.
  7301
  7302     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  7303     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  7304     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  7305
  7306     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7307
  7308     MOVE -1                     TO MAINTL.
  7309     MOVE AL-UANON               TO MAINTA.
  7310     GO TO 8100-SEND-INITIAL-MAP.
  7311
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 141
* EL6501.cbl
  7313 4000-EDITS.
  7314     IF PI-COMPANY-ID = 'NCL'
  7315      IF MAINTI = 'A' OR 'C'
  7316        IF CSRL GREATER ZEROS
  7317            PERFORM 8050-USER-REC-READ THRU 8060-EXIT
  7318          ELSE
  7319            IF MAINTI = 'A'
  7320                MOVE ER-1883         TO EMI-ERROR
  7321                MOVE -1              TO CSRL
  7322                MOVE AL-UABON        TO CSRA
  7323                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7324
  7325     IF PI-COMPANY-ID  =  'AIG' OR 'AUK'
  7326        IF NAMEL NOT GREATER ZEROS
  7327           IF MAINTI = 'C'
  7328              GO TO 4070-CHECK-STATUS
  7329           ELSE
  7330              MOVE -1               TO  NAMEL
  7331              MOVE AL-UABON         TO  NAMEA
  7332              MOVE ER-2045          TO  EMI-ERROR
  7333              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7334        ELSE
  7335            GO TO 4065-CHECK-ASSOCIATES.
  7336
  7337     IF TYPEL NOT GREATER ZEROS
  7338        IF MAINTI = 'C'
  7339           GO TO 4050-CONTINUE
  7340        ELSE
  7341           GO TO 4020-BUS-TYPE-ERROR.
  7342
  7343     IF TYPEI NOT NUMERIC
  7344        GO TO 4020-BUS-TYPE-ERROR
  7345     ELSE
  7346        IF TYPEI LESS 1 OR GREATER 99
  7347           GO TO 4020-BUS-TYPE-ERROR.
  7348
  7349     MOVE SPACES                 TO ELCNTL-KEY.
  7350
  7351     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7352     MOVE TYPEI                  TO CNTL-BUS-TYPE.
  7353     MOVE '8'                    TO CNTL-REC-TYPE.
  7354     MOVE +0                     TO CNTL-SEQ-NO.
  7355
  7356
  7357* EXEC CICS HANDLE CONDITION
  7358*        NOTFND   (4020-BUS-TYPE-ERROR)
  7359*    END-EXEC.
  7360*    MOVE '"$I                   ! ) #00006953' TO DFHEIV0
  7361     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7362     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7363     MOVE X'2920233030303036393533' TO DFHEIV0(25:11)
  7364     CALL 'kxdfhei1' USING DFHEIV0
  7365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7366
  7367
  7368
  7369* EXEC CICS READ
  7370*        GTEQ
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 142
* EL6501.cbl
  7371*        DATASET   (CNTL-FILE-ID)
  7372*        SET       (ADDRESS OF CONTROL-FILE)
  7373*        RIDFLD    (ELCNTL-KEY)
  7374*    END-EXEC.
  7375*    MOVE '&"S        G          (   #00006957' TO DFHEIV0
  7376     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7378     MOVE X'2020233030303036393537' TO DFHEIV0(25:11)
  7379     CALL 'kxdfhei1' USING DFHEIV0,
  7380           CNTL-FILE-ID,
  7381           DFHEIV20,
  7382           DFHEIV99,
  7383           ELCNTL-KEY,
  7384           DFHEIV99,
  7385           DFHEIV99,
  7386           DFHEIV99
  7387     SET ADDRESS OF CONTROL-FILE TO
  7388         DFHEIV20
  7389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7390
  7391
  7392     IF TYPEI LESS 21
  7393        MOVE TYPEI               TO WS-BUS-ENTRY
  7394     ELSE
  7395        DIVIDE TYPEI BY 20
  7396            GIVING WS-BUS-TYPE REMAINDER WS-BUS-ENTRY
  7397        IF WS-BUS-ENTRY = ZEROS
  7398           MOVE 20               TO WS-BUS-ENTRY.
  7399
  7400     IF CF-BUSINESS-TITLE (WS-BUS-ENTRY) NOT = SPACES
  7401        GO TO 4050-CONTINUE.
  7402
  7403 4020-BUS-TYPE-ERROR.
  7404     MOVE -1                     TO TYPEL.
  7405     MOVE AL-UNBON               TO TYPEA.
  7406     MOVE ER-2178                TO EMI-ERROR.
  7407     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7408
  7409 4050-CONTINUE.
  7410     IF ASTATEL > 0
  7411        MOVE SPACES                 TO  ELCNTL-KEY
  7412        MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
  7413        MOVE '3'                    TO  CNTL-REC-TYPE
  7414        MOVE ASTATEI                TO  CNTL-ACCESS (1:2)
  7415        MOVE +0                     TO  CNTL-SEQ-NO
  7416
  7417* EXEC CICS  READ
  7418*           DATASET  ('ELCNTL')
  7419*           SET      (ADDRESS OF CONTROL-FILE)
  7420*           RIDFLD   (ELCNTL-KEY)
  7421*           RESP     (WS-RESPONSE)
  7422*       END-EXEC
  7423     MOVE 'ELCNTL' TO DFHEIV1
  7424*    MOVE '&"S        E          (  N#00006988' TO DFHEIV0
  7425     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7426     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7427     MOVE X'204E233030303036393838' TO DFHEIV0(25:11)
  7428     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 143
* EL6501.cbl
  7429           DFHEIV1,
  7430           DFHEIV20,
  7431           DFHEIV99,
  7432           ELCNTL-KEY,
  7433           DFHEIV99,
  7434           DFHEIV99,
  7435           DFHEIV99
  7436     SET ADDRESS OF CONTROL-FILE TO
  7437         DFHEIV20
  7438     MOVE EIBRESP  TO WS-RESPONSE
  7439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7440        IF NOT RESP-NORMAL
  7441           MOVE ER-0144                TO  EMI-ERROR
  7442           MOVE -1                     TO  ASTATEL
  7443           MOVE AL-UABON               TO  ASTATEA
  7444           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7445        END-IF
  7446     ELSE
  7447        IF MAINTI = 'A'
  7448           MOVE ER-0144                TO  EMI-ERROR
  7449           MOVE -1                     TO  ASTATEL
  7450           MOVE AL-UABON               TO  ASTATEA
  7451           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7452        END-IF
  7453     END-IF
  7454     IF INDGRPL NOT GREATER ZEROS
  7455        IF MAINTI = 'C'
  7456           GO TO 4070-CHECK-STATUS
  7457        ELSE
  7458           GO TO 4060-IG-ERROR.
  7459
  7460     IF INDGRPI = 'I' OR 'G'
  7461        GO TO 4070-CHECK-STATUS.
  7462
  7463 4060-IG-ERROR.
  7464     MOVE -1                     TO INDGRPL.
  7465     MOVE AL-UABON               TO INDGRPA.
  7466     MOVE ER-2152                TO EMI-ERROR.
  7467     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7468
  7469 4065-CHECK-ASSOCIATES.
  7470     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7471        MOVE  PI-ACCT-ACCOUNT    TO  WS-ACCOUNT-NUM-AREA
  7472        MOVE  NAMEI              TO  WS-NAME-AREA
  7473     ELSE
  7474        GO TO 4070-CHECK-STATUS.
  7475
  7476     IF WS-NAME-1-4  =  WS-ACCT-BRANCH-CD
  7477        NEXT SENTENCE
  7478     ELSE
  7479        MOVE -1                  TO  NAMEL
  7480        MOVE AL-UABON            TO  NAMEA
  7481        MOVE ER-0788             TO  EMI-ERROR
  7482        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7483
  7484 4070-CHECK-STATUS.
  7485     IF STATUSL NOT GREATER ZEROS
  7486        IF MAINTI = 'C'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 144
* EL6501.cbl
  7487           GO TO 4090-CHECK-STD-AH-TYPE
  7488        ELSE
  7489           MOVE 'A'              TO STATUSI
  7490           MOVE AL-UANON         TO STATUSA
  7491           GO TO 4090-CHECK-STD-AH-TYPE.
  7492
  7493     IF STATUSI = 'A' OR 'I' OR 'C' OR 'F'
  7494        GO TO 4090-CHECK-STD-AH-TYPE.
  7495
  7496 4080-STATUS-ERROR.
  7497     MOVE -1                     TO STATUSL.
  7498     MOVE AL-UABON               TO STATUSA.
  7499     MOVE ER-2153                TO EMI-ERROR.
  7500     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7501
  7502 4090-CHECK-STD-AH-TYPE.
  7503
  7504     IF PI-COMPANY-ID  = 'AIG' OR 'AUK'
  7505         GO TO 4900-EXIT.
  7506
  7507     IF STDBENL NOT GREATER ZEROS
  7508        IF MAINTI = 'C'
  7509*          GO TO 4110-CHECK-REMIT
  7510           GO TO 4100-CHECK-CLPTOLP
  7511        ELSE
  7512           MOVE ZEROS            TO STDBENI
  7513           MOVE AL-UANON         TO STDBENA
  7514*          GO TO 4110-CHECK-REMIT.
  7515           GO TO 4100-CHECK-CLPTOLP.
  7516
  7517     IF STDBENI = SPACES
  7518         MOVE ZEROS               TO STDBENI.
  7519     IF STDBENI = ZEROS
  7520*        GO TO 4110-CHECK-REMIT.
  7521         GO TO 4100-CHECK-CLPTOLP.
  7522
  7523     MOVE STDBENI                TO WS-EDIT-BEN-CODE.
  7524     IF INVALID-BENEFIT-CODE
  7525        GO TO 4099-STD-BEN-ERROR.
  7526
  7527     MOVE SPACES                 TO ELCNTL-KEY.
  7528
  7529     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7530     MOVE STDBENI                TO CNTL-BEN-TYPE.
  7531     MOVE '5'                    TO CNTL-REC-TYPE.
  7532     MOVE +0                     TO CNTL-SEQ-NO.
  7533
  7534
  7535* EXEC CICS HANDLE CONDITION
  7536*        NOTFND   (4099-STD-BEN-ERROR)
  7537*    END-EXEC.
  7538*    MOVE '"$I                   ! * #00007088' TO DFHEIV0
  7539     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7540     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7541     MOVE X'2A20233030303037303838' TO DFHEIV0(25:11)
  7542     CALL 'kxdfhei1' USING DFHEIV0
  7543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7544
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 145
* EL6501.cbl
  7545
  7546
  7547* EXEC CICS READ
  7548*        GTEQ
  7549*        DATASET   (CNTL-FILE-ID)
  7550*        SET       (ADDRESS OF CONTROL-FILE)
  7551*        RIDFLD    (ELCNTL-KEY)
  7552*    END-EXEC.
  7553*    MOVE '&"S        G          (   #00007092' TO DFHEIV0
  7554     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7555     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7556     MOVE X'2020233030303037303932' TO DFHEIV0(25:11)
  7557     CALL 'kxdfhei1' USING DFHEIV0,
  7558           CNTL-FILE-ID,
  7559           DFHEIV20,
  7560           DFHEIV99,
  7561           ELCNTL-KEY,
  7562           DFHEIV99,
  7563           DFHEIV99,
  7564           DFHEIV99
  7565     SET ADDRESS OF CONTROL-FILE TO
  7566         DFHEIV20
  7567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7568
  7569
  7570     IF CNTL-COMP-ID  = CF-COMPANY-ID  AND
  7571        CNTL-REC-TYPE = CF-RECORD-TYPE
  7572         MOVE 1                  TO SUB
  7573     ELSE
  7574         GO TO 4099-STD-BEN-ERROR.
  7575
  7576 4095-CHECK-BEN-TYPE.
  7577     IF STDBENI = CF-BENEFIT-CODE (SUB)
  7578*       GO TO 4110-CHECK-REMIT.
  7579        GO TO 4100-CHECK-CLPTOLP.
  7580
  7581     IF SUB LESS 8
  7582         ADD 1 TO SUB
  7583         GO TO 4095-CHECK-BEN-TYPE.
  7584
  7585 4099-STD-BEN-ERROR.
  7586     MOVE -1                     TO STDBENL.
  7587     MOVE AL-UABON               TO STDBENA.
  7588     MOVE ER-0250                TO EMI-ERROR.
  7589     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7590
  7591 4100-CHECK-CLPTOLP.
  7592
  7593     IF CLPTOLPL > ZERO
  7594
  7595* EXEC CICS BIF
  7596*            DEEDIT
  7597*            FIELD    (CLPTOLPI)
  7598*            LENGTH   (6)
  7599*        END-EXEC
  7600     MOVE 6
  7601       TO DFHEIV11
  7602*    MOVE '@"L                   #   #00007123' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 146
* EL6501.cbl
  7603     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7604     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7605     MOVE X'2020233030303037313233' TO DFHEIV0(25:11)
  7606     CALL 'kxdfhei1' USING DFHEIV0,
  7607           CLPTOLPI,
  7608           DFHEIV11
  7609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7610         IF CLPTOLPI NOT NUMERIC
  7611             MOVE ER-1778        TO EMI-ERROR
  7612             MOVE -1             TO CLPTOLPL
  7613             MOVE AL-UNBON       TO CLPTOLPA
  7614             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7615         END-IF
  7616     END-IF.
  7617     IF LCOMML > ZERO
  7618
  7619* EXEC CICS BIF
  7620*            DEEDIT
  7621*            FIELD    (LCOMMI)
  7622*            LENGTH   (8)
  7623*        END-EXEC
  7624     MOVE 8
  7625       TO DFHEIV11
  7626*    MOVE '@"L                   #   #00007136' TO DFHEIV0
  7627     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7628     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7629     MOVE X'2020233030303037313336' TO DFHEIV0(25:11)
  7630     CALL 'kxdfhei1' USING DFHEIV0,
  7631           LCOMMI,
  7632           DFHEIV11
  7633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7634         IF LCOMMI NOT NUMERIC
  7635             MOVE ER-1778        TO EMI-ERROR
  7636             MOVE -1             TO LCOMML
  7637             MOVE AL-UNBON       TO LCOMMA
  7638             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7639         END-IF
  7640     END-IF
  7641     GO TO 4110-CHECK-REMIT.
  7642
  7643 4100-EXIT.
  7644     EXIT.
  7645
  7646 4110-CHECK-REMIT.
  7647     IF REMITL NOT GREATER ZEROS
  7648        MOVE 1                   TO REMITI
  7649        MOVE AL-UNNON            TO REMITA
  7650        GO TO 4120-REMIT-ERROR.
  7651
  7652     IF (REMITI NOT NUMERIC)  OR
  7653        (REMITI LESS 1 OR GREATER 10)
  7654           GO TO 4120-REMIT-ERROR.
  7655
  7656 4115-CHECK-AGENT.
  7657     SET M-INDEX                 TO REMITI.
  7658
  7659     IF AGENTL (M-INDEX)  NOT GREATER ZEROS
  7660        MOVE ER-2156             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 147
* EL6501.cbl
  7661        GO TO 4120-R-ERROR.
  7662
  7663     GO TO 4130-CHECK-CONTRACT.
  7664
  7665 4120-REMIT-ERROR.
  7666     MOVE ER-2155                TO EMI-ERROR.
  7667
  7668 4120-R-ERROR.
  7669     MOVE -1                     TO REMITL.
  7670     MOVE AL-UABON               TO REMITA.
  7671     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7672
  7673 4130-CHECK-CONTRACT.
  7674     IF CONTRL NOT = ZEROS AND CONTRI NOT = SPACES
  7675        MOVE CONTRI                TO DEEDIT-FIELD
  7676        PERFORM 8600-DEEDIT
  7677        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7678        MOVE '4'                    TO DC-OPTION-CODE
  7679        PERFORM 9700-DATE-LINK
  7680        IF DATE-CONVERSION-ERROR
  7681           MOVE ER-2157             TO EMI-ERROR
  7682           MOVE -1                  TO CONTRL
  7683           MOVE AL-UABON            TO CONTRA
  7684           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7685        ELSE
  7686***  Y2K PROJ 7744
  7687           MOVE DC-GREG-DATE-1-EDIT TO CONTRI
  7688           MOVE AL-UANON            TO CONTRA
  7689           MOVE DC-GREG-DATE-1-YMD  TO WS-ANVR-DT
  7690           MOVE DC-ALPHA-CENTURY    TO WS-ANVR-DT(4:2)
  7691        END-IF
  7692     END-IF.
  7693***  Y2K PROJ 7744
  7694
  7695     IF PI-COMPANY-ID = 'DMD'
  7696       IF PI-MAINT = 'A'
  7697        IF CONTRL = ZERO
  7698           MOVE ER-0852             TO EMI-ERROR
  7699           MOVE -1                  TO CONTRL
  7700           MOVE AL-UABON            TO CONTRA
  7701           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7702
  7703 4131-CHECK-PSI-FACTOR.
  7704     IF PSILFFL GREATER +0
  7705        MOVE PSILFFI             TO DEEDIT-FIELD
  7706        PERFORM 8600-DEEDIT
  7707        IF DEEDIT-FIELD NUMERIC
  7708           MOVE DEEDIT-FIELD-V5  TO WS-LIFE-PSI
  7709                                    PSILFFO
  7710        ELSE
  7711           MOVE ER-9999          TO EMI-ERROR
  7712           MOVE -1               TO PSILFFL
  7713           MOVE AL-UABON         TO PSILFFA
  7714           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7715
  7716     IF PSIAHFL GREATER +0
  7717        MOVE PSIAHFI             TO DEEDIT-FIELD
  7718        PERFORM 8600-DEEDIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 148
* EL6501.cbl
  7719        IF DEEDIT-FIELD NUMERIC
  7720           MOVE DEEDIT-FIELD-V5  TO WS-AH-PSI
  7721                                    PSIAHFO
  7722        ELSE
  7723           MOVE ER-9999          TO EMI-ERROR
  7724           MOVE -1               TO PSIAHFL
  7725           MOVE AL-UABON         TO PSIAHFA
  7726           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7727
  7728 4135-CHECK-PREVIOUS-DATES.
  7729     IF PEFFDTEL NOT = ZEROS AND PEFFDTEI NOT = SPACES
  7730        MOVE PEFFDTEI              TO DEEDIT-FIELD
  7731        PERFORM 8600-DEEDIT
  7732        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7733        MOVE '4'                    TO DC-OPTION-CODE
  7734        PERFORM 9700-DATE-LINK
  7735        IF DATE-CONVERSION-ERROR
  7736           MOVE ER-0348             TO EMI-ERROR
  7737           MOVE -1                  TO PEFFDTEL
  7738           MOVE AL-UABON            TO PEFFDTEA
  7739           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7740        ELSE
  7741***  Y2K PROJ 7744
  7742           MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEI
  7743           MOVE AL-UANON            TO PEFFDTEA
  7744           MOVE DC-GREG-DATE-1-YMD  TO WS-PEFF-DT
  7745           MOVE DC-ALPHA-CENTURY    TO WS-PEFF-DT(4:2)
  7746        END-IF
  7747     END-IF.
  7748
  7749     IF PEXPDTEL NOT = ZEROS AND PEXPDTEI NOT = SPACES
  7750        MOVE PEXPDTEI              TO DEEDIT-FIELD
  7751        PERFORM 8600-DEEDIT
  7752        IF DEEDIT-FIELD-V0 NOT LESS 999999
  7753           MOVE '99/99/99'             TO PEXPDTEO
  7754           MOVE 99999999999            TO WS-PEXP-DT
  7755           MOVE AL-UANON               TO PEXPDTEA
  7756        ELSE
  7757           MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7758           MOVE '4'                    TO DC-OPTION-CODE
  7759           PERFORM 9700-DATE-LINK
  7760           IF DATE-CONVERSION-ERROR
  7761              MOVE ER-0454             TO EMI-ERROR
  7762              MOVE -1                  TO PEXPDTEL
  7763              MOVE AL-UABON            TO PEXPDTEA
  7764              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7765           ELSE
  7766              MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEI
  7767              MOVE AL-UANON            TO PEXPDTEA
  7768              MOVE DC-GREG-DATE-1-YMD  TO WS-PEXP-DT
  7769              MOVE DC-ALPHA-CENTURY    TO WS-PEXP-DT(4:2)
  7770           END-IF
  7771        END-IF
  7772     END-IF.
  7773***  Y2K PROJ 7744
  7774
  7775     IF COMMCALL NOT GREATER ZEROS
  7776         GO TO 4150-CHECK-REINCAL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 149
* EL6501.cbl
  7777
  7778     IF (PI-COMPANY-ID = 'ADL' OR 'DEF') AND
  7779         (EFFCHG-SAVE LESS 841101)       AND
  7780         (COMMCALI = 'Y' OR '1')         AND
  7781         (NOT MODIFY-CAP)
  7782           MOVE -1               TO COMMCALL
  7783           MOVE AL-UABON         TO COMMCALA
  7784           MOVE ER-2189          TO EMI-ERROR
  7785           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7786
  7787     IF COMMCALI = 'Y' OR 'N' OR '1' OR ' '
  7788         GO TO 4150-CHECK-REINCAL.
  7789
  7790 4140-COMMCAL-ERROR.
  7791     MOVE -1                     TO COMMCALL.
  7792     MOVE AL-UABON               TO COMMCALA.
  7793     MOVE ER-2158                TO EMI-ERROR.
  7794     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7795
  7796 4150-CHECK-REINCAL.
  7797     IF REINCALL NOT GREATER ZEROS
  7798         GO TO 4170-CHECK-REINTAB.
  7799
  7800     IF REINCALI = 'Y' OR 'N'
  7801        GO TO 4170-CHECK-REINTAB.
  7802
  7803 4160-REINCAL-ERROR.
  7804     MOVE -1                     TO REINCALL.
  7805     MOVE AL-UABON               TO REINCALA.
  7806     MOVE ER-2179                TO EMI-ERROR.
  7807     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7808
  7809 4170-CHECK-REINTAB.
  7810     IF REINTABL NOT GREATER ZEROS
  7811        IF PI-COMPANY-ID = 'NCL' AND
  7812           MAINTI = 'A'
  7813                MOVE ER-4010         TO EMI-ERROR
  7814                MOVE -1              TO REINTABL
  7815                MOVE AL-UABON        TO REINTABA
  7816                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7817
  7818     IF REINTABL NOT GREATER ZEROS OR REINTABI = SPACES
  7819         GO TO 4410-CHECK-AGENTS.
  7820     IF PI-COMPANY-ID = 'CID'
  7821        IF PI-ACCT-STATE = 'KY'
  7822           IF REINTABI NOT = 'K98' AND 'K99' AND 'KYA'
  7823              MOVE -1            TO REINTABL
  7824              MOVE AL-UABON      TO REINTABA
  7825              MOVE ER-2159       TO EMI-ERROR
  7826              PERFORM 9900-ERROR-FORMAT
  7827                                 THRU 9900-EXIT
  7828           END-IF
  7829        END-IF
  7830     END-IF
  7831     MOVE LOW-VALUES             TO REIN-KEY.
  7832
  7833     MOVE PI-COMPANY-CD          TO REIN-COMP-CD.
  7834     MOVE 'A'                    TO REIN-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 150
* EL6501.cbl
  7835     MOVE REINTABI               TO REIN-TABLE.
  7836
  7837
  7838* EXEC CICS HANDLE CONDITION
  7839*        NOTFND   (4180-REIN-ERROR)
  7840*    END-EXEC.
  7841*    MOVE '"$I                   ! + #00007344' TO DFHEIV0
  7842     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7844     MOVE X'2B20233030303037333434' TO DFHEIV0(25:11)
  7845     CALL 'kxdfhei1' USING DFHEIV0
  7846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7847
  7848
  7849
  7850* EXEC CICS READ
  7851*        DATASET   (REIN-FILE-ID)
  7852*        SET       (ADDRESS OF REINSURANCE-RECORD)
  7853*        RIDFLD    (REIN-KEY)
  7854*    END-EXEC.
  7855*    MOVE '&"S        E          (   #00007348' TO DFHEIV0
  7856     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7857     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7858     MOVE X'2020233030303037333438' TO DFHEIV0(25:11)
  7859     CALL 'kxdfhei1' USING DFHEIV0,
  7860           REIN-FILE-ID,
  7861           DFHEIV20,
  7862           DFHEIV99,
  7863           REIN-KEY,
  7864           DFHEIV99,
  7865           DFHEIV99,
  7866           DFHEIV99
  7867     SET ADDRESS OF REINSURANCE-RECORD TO
  7868         DFHEIV20
  7869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7870
  7871
  7872     GO TO 4410-CHECK-AGENTS.
  7873
  7874 4180-REIN-ERROR.
  7875     MOVE -1                     TO REINTABL.
  7876     MOVE AL-UABON               TO REINTABA.
  7877     MOVE ER-2615                TO EMI-ERROR.
  7878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7879
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 151
* EL6501.cbl
  7881 4410-CHECK-AGENTS.
  7882     MOVE PI-COMPANY-CD          TO COMM-COMP-CD.
  7883     SET M-INDEX TO 1.
  7884
  7885     IF PI-COMPANY-ID = 'NCL'
  7886       IF AGENTL (M-INDEX) GREATER ZEROS
  7887         MOVE PI-ACCT-ACCOUNT    TO AGENT  (M-INDEX).
  7888
  7889 4420-LOOP.
  7890     IF AGENTL (M-INDEX) NOT GREATER ZEROS
  7891        IF (ATYPEL (M-INDEX)  GREATER ZEROS AND
  7892            ATYPE  (M-INDEX) NOT = SPACES)  OR
  7893           SINGLEL (M-INDEX) GREATER ZEROS  OR
  7894           JOINTL  (M-INDEX) GREATER ZEROS  OR
  7895           A-HL    (M-INDEX) GREATER ZEROS  OR
  7896           RECALL  (M-INDEX) GREATER ZEROS  OR
  7897           RCOMML  (M-INDEX) GREATER ZEROS  OR
  7898           CHGBCKL (M-INDEX) GREATER ZEROS  OR
  7899           GLCODEL (M-INDEX) GREATER ZEROS
  7900           MOVE ER-2172          TO EMI-ERROR
  7901           MOVE -1               TO AGENTL (M-INDEX)
  7902           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7903           GO TO 4450-BUMP-INDEX
  7904        ELSE
  7905           GO TO 4450-BUMP-INDEX.
  7906
  7907     IF AGENT (M-INDEX) = ZEROS
  7908         MOVE ER-2970            TO  EMI-ERROR
  7909         MOVE -1                 TO  AGENTL (M-INDEX)
  7910         MOVE AL-UABON           TO  AGENTA (M-INDEX)
  7911         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7912         GO TO 4450-BUMP-INDEX.
  7913
  7914     IF ATYPEL (M-INDEX) = ZEROS
  7915        MOVE -1                  TO ATYPEL (M-INDEX)
  7916        MOVE ER-2173             TO EMI-ERROR
  7917        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7918        GO TO 4430-CHECK-SINGLE.
  7919
  7920     IF ATYPE (M-INDEX) = 'C'
  7921        ADD 1                    TO WS-ACCOUNT-CTR-C
  7922       ELSE
  7923        IF ATYPE (M-INDEX) = 'R'
  7924           ADD 1                 TO WS-ACCOUNT-CTR-R
  7925          ELSE
  7926           IF ATYPE (M-INDEX) = 'D'
  7927              ADD 1                 TO WS-ACCOUNT-CTR-D
  7928             ELSE
  7929              IF ATYPE (M-INDEX) = 'O' OR 'P' OR 'T' OR 'W'
  7930                                OR 'B' OR 'I' OR 'K' OR 'L'
  7931                                OR 'J' OR 'M' OR 'A'
  7932                 NEXT SENTENCE
  7933                ELSE
  7934                 IF ATYPE (M-INDEX) = SPACES
  7935                    NEXT SENTENCE
  7936                   ELSE
  7937                    MOVE ER-2175       TO EMI-ERROR
  7938                    MOVE -1            TO ATYPEL (M-INDEX)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 152
* EL6501.cbl
  7939                    MOVE AL-UABON      TO ATYPEA (M-INDEX)
  7940                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7941
  7942 4430-CHECK-SINGLE.
  7943     IF SINGLEL (M-INDEX) GREATER ZEROS
  7944        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  7945           MOVE SINGLE-COMM-T (M-INDEX)    TO COMM-TABLE
  7946           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  7947           MOVE LOW-VALUES                 TO COMM-FILLER
  7948           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  7949           IF COMMISSION-ERROR
  7950              MOVE AL-UABON      TO SINGLEA (M-INDEX)
  7951              MOVE -1            TO SINGLEL (M-INDEX)
  7952           ELSE
  7953            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  7954              MOVE -1            TO MAINTL
  7955              MOVE ER-1884       TO EMI-ERROR
  7956              PERFORM 9900-ERROR-FORMAT
  7957                                 THRU 9900-EXIT
  7958            END-IF
  7959           END-IF
  7960        END-IF
  7961     END-IF
  7962
  7963     IF JOINTL (M-INDEX) GREATER ZEROS
  7964        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  7965           MOVE JOINT-COMM-T (M-INDEX)     TO COMM-TABLE
  7966           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  7967           MOVE LOW-VALUES                 TO COMM-FILLER
  7968           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  7969           IF COMMISSION-ERROR
  7970              MOVE AL-UABON      TO JOINTA (M-INDEX)
  7971              MOVE -1            TO JOINTL (M-INDEX)
  7972           ELSE
  7973            IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  7974              MOVE -1            TO MAINTL
  7975              MOVE ER-1885       TO EMI-ERROR
  7976              PERFORM 9900-ERROR-FORMAT
  7977                                 THRU 9900-EXIT
  7978            END-IF
  7979           END-IF
  7980        END-IF
  7981     END-IF
  7982
  7983     IF A-HL (M-INDEX) GREATER ZEROS
  7984        IF A-H-COMM-R (M-INDEX)  NOT NUMERIC
  7985           MOVE A-H-COMM-T (M-INDEX)      TO COMM-TABLE
  7986           MOVE PI-AH-OVERRIDE-L1         TO COMM-LF-AH
  7987           MOVE LOW-VALUES                 TO COMM-FILLER
  7988           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  7989           IF COMMISSION-ERROR
  7990              MOVE AL-UABON      TO A-HA (M-INDEX)
  7991              MOVE -1            TO A-HL (M-INDEX)
  7992           ELSE
  7993            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  7994              MOVE -1            TO MAINTL
  7995              MOVE ER-1886       TO EMI-ERROR
  7996              PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 153
* EL6501.cbl
  7997                                 THRU 9900-EXIT
  7998            END-IF
  7999           END-IF
  8000        END-IF
  8001     END-IF
  8002
  8003     IF RECALL (M-INDEX) GREATER ZEROS
  8004         IF RECAL (M-INDEX) = 'Y' OR 'N' OR '1' OR SPACE
  8005             MOVE AL-UANON       TO RECALA (M-INDEX)
  8006         ELSE
  8007             MOVE -1             TO RECALL (M-INDEX)
  8008             MOVE AL-UABON       TO RECALA (M-INDEX)
  8009             MOVE ER-2158        TO EMI-ERROR
  8010             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8011
  8012     IF RCOMML (M-INDEX) GREATER ZEROS
  8013         IF RCOMM (M-INDEX) = 'Y' OR 'N' OR 'A' OR SPACE
  8014             MOVE AL-UANON       TO RCOMMA (M-INDEX)
  8015         ELSE
  8016             MOVE -1             TO RCOMML (M-INDEX)
  8017             MOVE AL-UABON       TO RCOMMA (M-INDEX)
  8018             MOVE ER-0625        TO EMI-ERROR
  8019             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8020
  8021     IF  CHGBCKL (M-INDEX)  GREATER THAN  ZEROS
  8022         IF  CHGBCK (M-INDEX)    NUMERIC
  8023             MOVE  AL-UNNON        TO  CHGBCKA (M-INDEX)
  8024         ELSE
  8025             MOVE  -1              TO  CHGBCKL (M-INDEX)
  8026             MOVE  AL-UNBON        TO  CHGBCKA (M-INDEX)
  8027             MOVE  ER-0759         TO  EMI-ERROR
  8028             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8029
  8030     IF  GLCODEL (M-INDEX)  GREATER THAN  ZEROS
  8031         IF  GLCODE (M-INDEX)    NUMERIC
  8032             MOVE  AL-UNNON        TO  GLCODEA (M-INDEX)
  8033         ELSE
  8034             MOVE  -1              TO  GLCODEL (M-INDEX)
  8035             MOVE  AL-UNBON        TO  GLCODEA (M-INDEX)
  8036             MOVE  ER-0759         TO  EMI-ERROR
  8037             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8038
  8039     IF ATYPE (M-INDEX) NOT = 'C' AND 'D' AND 'O' AND 'P'
  8040         GO TO 4450-BUMP-INDEX.
  8041
  8042     IF SINGLE-COMM-R (M-INDEX) NUMERIC
  8043         ADD SINGLE-COMM-R (M-INDEX) TO COMM-SL-ACCUM.
  8044
  8045     IF JOINT-COMM-R (M-INDEX) NUMERIC
  8046         ADD JOINT-COMM-R (M-INDEX)  TO COMM-JL-ACCUM.
  8047
  8048     IF A-H-COMM-R (M-INDEX) NUMERIC
  8049         ADD A-H-COMM-R (M-INDEX)    TO COMM-AH-ACCUM.
  8050
  8051 4450-BUMP-INDEX.
  8052     SET M-INDEX UP BY 1.
  8053
  8054     IF M-INDEX NOT = 11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 154
* EL6501.cbl
  8055        GO TO 4420-LOOP.
  8056
  8057     IF WS-ACCOUNT-CTR-C = ZEROS AND
  8058        WS-ACCOUNT-CTR-D = ZEROS AND
  8059        WS-ACCOUNT-CTR-R = ZEROS
  8060          MOVE ER-2177             TO EMI-ERROR
  8061          MOVE -1                  TO AGENTL (1)
  8062          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8063          GO TO 4900-EXIT.
  8064
  8065     IF (WS-ACCOUNT-CTR-C  GREATER 0 AND
  8066         WS-ACCOUNT-CTR-D  GREATER 0) OR
  8067        (WS-ACCOUNT-CTR-R  GREATER 0 AND
  8068         WS-ACCOUNT-CTR-D  GREATER 0)
  8069           MOVE ER-2174             TO EMI-ERROR
  8070           MOVE -1                  TO AGENTL (1)
  8071           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8072           GO TO 4900-EXIT.
  8073
  8074     IF WS-ACCOUNT-CTR-C GREATER 1 OR
  8075        WS-ACCOUNT-CTR-R GREATER 1 OR
  8076        WS-ACCOUNT-CTR-D GREATER 1
  8077          MOVE ER-2182             TO EMI-ERROR
  8078          MOVE -1                  TO AGENTL (1)
  8079          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8080          GO TO 4900-EXIT.
  8081
  8082
  8083     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  8084         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  8085
  8086     IF WS-ST-COMM-CAP-SL = ZEROS
  8087        CONTINUE
  8088     ELSE
  8089      IF SINGLE-COMM-R (1) NUMERIC
  8090        IF (WS-LIMIT-TO-ACCOUNT AND
  8091           SINGLE-COMM-R (1) > WS-ST-COMM-CAP-SL)
  8092                       OR
  8093           (NOT WS-LIMIT-TO-ACCOUNT AND
  8094           COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  8095           MOVE -1               TO MAINTL
  8096           MOVE ER-1884          TO EMI-ERROR
  8097           PERFORM 9900-ERROR-FORMAT
  8098                                 THRU 9900-EXIT
  8099        END-IF
  8100*     ELSE
  8101*       MOVE PI-COMPANY-CD       TO COMM-COMP-CD
  8102*       MOVE SINGLE-COMM-T (1)   TO COMM-TABLE
  8103*       MOVE PI-LIFE-OVERRIDE-L1 TO COMM-LF-AH
  8104*       MOVE LOW-VALUES          TO COMM-FILLER
  8105*       PERFORM 6400-READ-COMMISSION
  8106*                                THRU 6459-EXIT
  8107*       IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8108*          MOVE -1               TO MAINTL
  8109*          MOVE ER-1884          TO EMI-ERROR
  8110*          PERFORM 9900-ERROR-FORMAT
  8111*                                THRU 9900-EXIT
  8112*       END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 155
* EL6501.cbl
  8113      END-IF
  8114     END-IF
  8115
  8116     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  8117        MOVE ZEROS               TO WS-ST-COMM-CAP-JL
  8118     END-IF
  8119
  8120     IF WS-ST-COMM-CAP-JL = ZEROS
  8121        CONTINUE
  8122     ELSE
  8123        IF JOINT-COMM-R (1) NUMERIC
  8124           IF (WS-LIMIT-TO-ACCOUNT AND
  8125              JOINT-COMM-R (1) > WS-ST-COMM-CAP-JL)
  8126                       OR
  8127              (NOT WS-LIMIT-TO-ACCOUNT AND
  8128               COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  8129               MOVE -1           TO MAINTL
  8130               MOVE ER-1885      TO EMI-ERROR
  8131               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8132           END-IF
  8133*       ELSE
  8134*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8135*          MOVE JOINT-COMM-T (1) TO COMM-TABLE
  8136*          MOVE PI-LIFE-OVERRIDE-L1
  8137*                                TO COMM-LF-AH
  8138*          MOVE LOW-VALUES       TO COMM-FILLER
  8139*          PERFORM 6400-READ-COMMISSION
  8140*                                THRU 6459-EXIT
  8141*          IF EXCEEDS-STATE-MAX
  8142*             MOVE ER-1885       TO EMI-ERROR
  8143*             PERFORM 9900-ERROR-FORMAT
  8144*                                THRU 9900-EXIT
  8145*          END-IF
  8146        END-IF
  8147     END-IF
  8148
  8149     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  8150        MOVE ZEROS               TO WS-ST-COMM-CAP-SA
  8151     END-IF
  8152
  8153     IF WS-ST-COMM-CAP-SA = ZEROS
  8154        CONTINUE
  8155     ELSE
  8156        IF A-H-COMM-R (1) NUMERIC
  8157           IF (WS-LIMIT-TO-ACCOUNT AND
  8158              A-H-COMM-R (1) > WS-ST-COMM-CAP-SA)
  8159                           OR
  8160              (NOT WS-LIMIT-TO-ACCOUNT AND
  8161              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  8162              MOVE -1            TO MAINTL
  8163              MOVE ER-1886       TO EMI-ERROR
  8164              PERFORM 9900-ERROR-FORMAT
  8165                                 THRU 9900-EXIT
  8166           END-IF
  8167*       ELSE
  8168*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8169*          MOVE A-H-COMM-T (1)   TO COMM-TABLE
  8170*          MOVE PI-AH-OVERRIDE-L1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 156
* EL6501.cbl
  8171*                                TO COMM-LF-AH
  8172*          MOVE LOW-VALUES       TO COMM-FILLER
  8173*          PERFORM 6400-READ-COMMISSION
  8174*                                THRU 6459-EXIT
  8175*          IF EXCEEDS-STATE-MAX
  8176*             MOVE ER-1886       TO EMI-ERROR
  8177*             PERFORM 9900-ERROR-FORMAT
  8178*                                THRU 9900-EXIT
  8179*          END-IF
  8180        END-IF
  8181     END-IF
  8182
  8183     IF MAINTI NOT = 'C'
  8184        GO TO 4900-EXIT.
  8185
  8186     IF NOT PI-GA-BILLING
  8187        GO TO 4900-EXIT.
  8188
  8189 4460-CHECK-IF-GA-BILLED.
  8190     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  8191
  8192     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  8193     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  8194     SET M-INDEX TO +1.
  8195     MOVE +1 TO AXRF-SUB.
  8196
  8197 4470-GA-LOOP.
  8198     IF ((AGENT (M-INDEX) NOT = WK-AM-AGT (AXRF-SUB)  OR
  8199        ATYPE  (M-INDEX) NOT = WK-AM-TYPE (AXRF-SUB)) OR
  8200        SINGLEL (M-INDEX) GREATER ZERO                OR
  8201        JOINTL  (M-INDEX) GREATER ZERO                OR
  8202        A-HL    (M-INDEX) GREATER ZERO                OR
  8203        RCOMML  (M-INDEX) GREATER ZERO                OR
  8204        CHGBCKL (M-INDEX) GREATER ZERO                OR
  8205        GLCODEL (M-INDEX) GREATER ZERO)               AND
  8206        (WK-GA-BILL-DT (AXRF-SUB) NOT = LOW-VALUES AND SPACES)
  8207           MOVE ER-2131   TO EMI-ERROR
  8208           MOVE -1        TO AGENTL (M-INDEX)
  8209           MOVE AL-UABON  TO AGENTA (M-INDEX)
  8210           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8211
  8212     ADD +1 TO AXRF-SUB.
  8213     SET M-INDEX UP BY +1.
  8214
  8215     IF AXRF-SUB NOT = +11
  8216        GO TO 4470-GA-LOOP.
  8217
  8218 4900-EXIT.
  8219      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 157
* EL6501.cbl
  8221 5000-MOVE-TO-RECORD.
  8222
  8223     IF NAMEL   GREATER THAN ZERO  OR
  8224        INCAREL GREATER THAN ZERO  OR
  8225        ADDR1L  GREATER THAN ZERO  OR
  8226        ACITYL  GREATER THAN ZERO  OR
  8227        ASTATEL GREATER THAN ZERO  OR
  8228        ZIPL    GREATER THAN ZERO  OR
  8229        PHONEL  GREATER THAN ZERO  OR
  8230        TAXNOL  GREATER THAN ZERO
  8231         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  8232
  8233     IF CSRL GREATER ZEROS
  8234        MOVE CSRI                TO AM-CSR-CODE.
  8235     IF NAMEL GREATER ZEROS
  8236        MOVE NAMEI               TO AM-NAME.
  8237     IF PCONTL GREATER ZEROS
  8238        MOVE PCONTI              TO AM-CONTROL-NAME
  8239     END-IF
  8240     IF INCAREL GREATER ZEROS
  8241        MOVE INCAREI             TO AM-PERSON.
  8242     IF ADDR1L GREATER ZEROS
  8243        MOVE ADDR1I              TO AM-ADDRS.
  8244     IF TAXNOL GREATER ZEROS
  8245        MOVE TAXNOI              TO AM-ID-NO.
  8246     IF PHONEL GREATER ZEROS
  8247        MOVE PHONEI              TO DEEDIT-FIELD
  8248        PERFORM 8600-DEEDIT
  8249        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  8250        MOVE WS-PH1              TO AM-AREA-CODE
  8251        MOVE WS-PH2              TO AM-TEL-PRE
  8252        MOVE WS-PH3              TO AM-TEL-NBR.
  8253
  8254     IF ACITYL GREATER ZEROS
  8255        MOVE ACITYI             TO AM-ADDR-CITY.
  8256     IF ASTATEL GREATER ZEROS
  8257        MOVE ASTATEI            TO AM-ADDR-STATE.
  8258
  8259     IF ZIPL NOT GREATER ZEROS
  8260         GO TO 5010-CONT-MOVING.
  8261
  8262     MOVE ZIPI                   TO WS-ZIP-CODE.
  8263
  8264     IF WS-CANADIAN-ZIP
  8265         IF WS-ZIP-4 = SPACE  OR  '-'
  8266             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  8267             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  8268         ELSE
  8269             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  8270             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  8271     ELSE
  8272         IF WS-ZIP-6 = SPACE  OR  '-'
  8273             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  8274             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  8275         ELSE
  8276             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  8277             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  8278
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 158
* EL6501.cbl
  8279 5010-CONT-MOVING.
  8280     IF TYPEL GREATER ZEROS
  8281        MOVE TYPEI               TO AM-GPCD.
  8282
  8283     IF STDBENL GREATER ZEROS
  8284        MOVE STDBENI             TO AM-STD-AH-TYPE.
  8285
  8286     IF INDGRPL GREATER ZEROS
  8287        MOVE INDGRPI             TO AM-IG
  8288        INSPECT AM-IG CONVERTING 'IG' TO '12'.
  8289
  8290     IF STATUSL GREATER ZEROS
  8291        MOVE STATUSI             TO AM-STATUS
  8292        INSPECT AM-STATUS CONVERTING 'FCTIA' TO '43210'
  8293     END-IF
  8294
  8295     IF CLPTOLPL GREATER ZEROS
  8296        MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  8297     END-IF.
  8298
  8299     IF LCOMML > ZEROS
  8300        MOVE LCOMMI              TO AM-SPP-LEASE-COMM
  8301     END-IF
  8302
  8303     IF REMITL GREATER ZEROS
  8304        MOVE REMITI              TO AM-REMIT-TO.
  8305     IF CONTRL GREATER ZEROS
  8306        MOVE WS-ANVR-DT          TO AM-ANNIVERSARY-DATE.
  8307     IF PSILFFL GREATER +0
  8308        MOVE WS-LIFE-PSI         TO AM-LF-PSI-FACTOR.
  8309     IF PSIAHFL GREATER +0
  8310        MOVE WS-AH-PSI           TO AM-AH-PSI-FACTOR.
  8311     IF PEFFDTEL GREATER ZEROS
  8312        MOVE WS-PEFF-DT          TO AM-PREV-EFF-DT.
  8313     IF PEXPDTEL GREATER ZEROS
  8314        MOVE WS-PEXP-DT          TO AM-PREV-EXP-DT.
  8315     IF COMMCALL GREATER ZEROS
  8316        MOVE COMMCALI            TO AM-RECALC-COMM
  8317        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8318     ELSE
  8319         IF MAINTI = 'A'
  8320             MOVE 'N'            TO AM-RECALC-COMM.
  8321
  8322     IF REINCALL GREATER ZEROS
  8323        MOVE REINCALI            TO AM-RECALC-REIN
  8324     ELSE
  8325         IF MAINTI = 'A'
  8326             MOVE 'N'            TO AM-RECALC-REIN.
  8327
  8328     IF REINTABL GREATER ZEROS
  8329        MOVE REINTABI            TO AM-REI-TABLE.
  8330
  8331     IF PI-MAINT = 'A'
  8332        MOVE 'P'                 TO AM-RET-ST-TAX-USE
  8333     END-IF
  8334
  8335     MOVE 1                      TO SUB.
  8336     SET M-INDEX                 TO 1.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 159
* EL6501.cbl
  8337
  8338
  8339* EXEC CICS
  8340*         ASKTIME
  8341*    END-EXEC.
  8342*    MOVE '0"                    "   #00007820' TO DFHEIV0
  8343     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  8344     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  8345     MOVE X'2020233030303037383230' TO DFHEIV0(25:11)
  8346     CALL 'kxdfhei1' USING DFHEIV0,
  8347           DFHEIV99
  8348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8349
  8350
  8351 5000-LOOP.
  8352*    IF PI-COMPANY-ID = 'DCC'
  8353*       IF (M-INDEX = +5)
  8354*          AND ((AGENTL (5) > ZEROS)
  8355*              OR (ATYPEL (5) > ZEROS))
  8356*             MOVE ER-3057         TO EMI-ERROR
  8357*             MOVE -1              TO AGENTL (5)
  8358*             MOVE AL-UABON        TO AGENTA (5)
  8359*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8360*             GO TO 5000-EXIT
  8361*       END-IF
  8362*    END-IF
  8363     IF MAINTI = 'C'
  8364        IF ((AM-AGT (SUB) NOT = ZEROS AND AGENT (M-INDEX)) AND
  8365           (COMMCALI NOT = 'Y' AND '1')                    AND
  8366            AM-HI-CERT-DATE NOT = ZEROS)                    OR
  8367           ((AM-AGT (SUB) = ZEROS AND
  8368             (AGENT (M-INDEX)) NOT = LOW-VALUES AND SPACES AND
  8369                                     ZEROS) AND
  8370           (COMMCALI NOT = 'Y' AND '1')  AND
  8371            AM-HI-CERT-DATE NOT = ZEROS)
  8372              MOVE ER-2181         TO EMI-ERROR
  8373              MOVE -1              TO COMMCALL
  8374              MOVE AL-UABON        TO COMMCALA
  8375              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8376              GO TO 5000-EXIT.
  8377
  8378     IF MAINTI = 'C'
  8379        IF ((AM-COM-TYP (SUB) NOT = SPACES AND
  8380             ATYPE (M-INDEX)) AND
  8381           (COMMCALI NOT = 'Y' AND '1') AND
  8382            AM-HI-CERT-DATE NOT = ZEROS)
  8383            OR
  8384           ((AM-COM-TYP (SUB) = SPACES AND
  8385             (ATYPE (M-INDEX)) NOT = LOW-VALUES AND SPACES) AND
  8386           (COMMCALI NOT = 'Y' AND '1')  AND
  8387            AM-HI-CERT-DATE NOT = ZEROS)
  8388              MOVE ER-2181         TO EMI-ERROR
  8389              MOVE -1              TO COMMCALL
  8390              MOVE AL-UABON        TO COMMCALA
  8391              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8392              GO TO 5000-EXIT.
  8393
  8394     IF AM-ACCOUNT-BILLED
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 160
* EL6501.cbl
  8395        IF COMMCALI = 'Y' OR '1'
  8396            MOVE ER-2183         TO EMI-ERROR
  8397            MOVE -1              TO COMMCALL
  8398            MOVE AL-UABON        TO COMMCALA
  8399            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8400            GO TO 5000-EXIT.
  8401
  8402     IF (AGENTL (M-INDEX) NOT GREATER ZEROS AND
  8403        ATYPEL  (M-INDEX) NOT GREATER ZEROS)
  8404        OR
  8405        ((AGENT (M-INDEX) = ZEROS OR SPACES) AND
  8406         ATYPE  (M-INDEX) = SPACES)
  8407           MOVE ZEROS              TO AM-AGT   (SUB)
  8408                                      AM-L-COM (SUB)
  8409                                      AM-J-COM (SUB)
  8410                                      AM-A-COM (SUB)
  8411           MOVE SPACE TO AM-COM-TYP (SUB)
  8412           SET M-INDEX UP BY 1
  8413           ADD 1 TO SUB
  8414           IF SUB = 11
  8415              GO TO 5000-EXIT
  8416            ELSE
  8417              GO TO 5000-LOOP.
  8418
  8419     MOVE AGENT (M-INDEX)        TO AM-AGT (SUB).
  8420     MOVE ATYPE (M-INDEX)        TO AM-COM-TYP (SUB).
  8421
  8422     IF SINGLEL (M-INDEX) GREATER ZEROS
  8423        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8424        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8425           MOVE SINGLE-COMM-T (M-INDEX) TO AM-L-COMA (SUB)
  8426          ELSE
  8427           MOVE SINGLE-COMM-R (M-INDEX) TO AM-L-COM  (SUB)
  8428           IF SINGLE-DASH (M-INDEX) = '-'
  8429               MULTIPLY AM-L-COM (SUB) BY -1
  8430                     GIVING AM-L-COM (SUB).
  8431
  8432     IF JOINTL (M-INDEX) GREATER ZEROS
  8433        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8434        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8435           MOVE JOINT-COMM-T (M-INDEX)  TO AM-J-COMA (SUB)
  8436          ELSE
  8437           MOVE JOINT-COMM-R (M-INDEX)  TO AM-J-COM (SUB)
  8438           IF JOINT-DASH (M-INDEX) = '-'
  8439               MULTIPLY AM-J-COM (SUB) BY -1
  8440                     GIVING AM-J-COM (SUB).
  8441
  8442     IF A-HL (M-INDEX) GREATER ZEROS
  8443        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8444        IF A-H-COMM-R (M-INDEX) NOT NUMERIC
  8445           MOVE A-H-COMM-T (M-INDEX)  TO AM-A-COMA (SUB)
  8446          ELSE
  8447           MOVE A-H-COMM-R (M-INDEX)  TO AM-A-COM (SUB)
  8448           IF A-H-DASH (M-INDEX) = '-'
  8449               MULTIPLY AM-A-COM (SUB) BY -1
  8450                     GIVING AM-A-COM (SUB).
  8451
  8452     IF RECALL (M-INDEX) GREATER ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 161
* EL6501.cbl
  8453         MOVE RECAL  (M-INDEX)   TO AM-RECALC-LV-INDIC (SUB).
  8454
  8455     IF RCOMML (M-INDEX) GREATER ZEROS
  8456         MOVE RCOMM  (M-INDEX)   TO AM-RETRO-LV-INDIC (SUB).
  8457
  8458     IF CHGBCKL (M-INDEX) GREATER ZEROS
  8459         MOVE CHGBCK (M-INDEX)   TO AM-COMM-CHARGEBACK (SUB).
  8460
  8461     IF GLCODEL (M-INDEX) GREATER ZEROS
  8462         MOVE GLCODE (M-INDEX)   TO AM-GL-CODES (SUB).
  8463
  8464     SET M-INDEX UP BY 1.
  8465     ADD 1 TO SUB.
  8466     IF M-INDEX NOT = 11
  8467        GO TO 5000-LOOP.
  8468
  8469 5000-EXIT.
  8470      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 162
* EL6501.cbl
  8472
  8473 5100-WRITE-TS.
  8474     PERFORM 6500-READ-ACCT THRU 6599-EXIT.
  8475
  8476     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  8477         MOVE ZEROS              TO PI-CR-CARRIER
  8478     ELSE
  8479         MOVE AM-CARRIER         TO PI-CR-CARRIER.
  8480
  8481     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  8482         MOVE ZEROS              TO PI-CR-GROUPING
  8483     ELSE
  8484         MOVE AM-GROUPING        TO PI-CR-GROUPING.
  8485
  8486     IF AM-REMIT-TO NOT = ZERO
  8487         MOVE AM-AGT (AM-REMIT-TO)
  8488                                 TO PI-CR-FIN-RESP
  8489       ELSE
  8490         MOVE AM-ACCOUNT         TO PI-CR-FIN-RESP.
  8491
  8492     MOVE 'A'                    TO PI-CR-TYPE.
  8493 5110-AGT-LOOP.
  8494     ADD 1                       TO  AGT-SUB.
  8495     IF AGT-SUB GREATER 10
  8496         MOVE LOW-VALUES         TO PI-CR-CONTROL-IN-PROGRESS
  8497         GO TO 5120-WRITE.
  8498
  8499************************************************************
  8500**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8501************************************************************
  8502
  8503     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'R'
  8504                  OR 'F' OR 'S' OR 'U'
  8505         MOVE AM-AGT (AGT-SUB)   TO  PI-CR-ACCOUNT
  8506         GO TO 5120-WRITE
  8507     ELSE
  8508         GO TO 5110-AGT-LOOP.
  8509
  8510 5120-WRITE.
  8511
  8512* EXEC CICS WRITEQ TS
  8513*         QUEUE    (QID)
  8514*         FROM     (PROGRAM-INTERFACE-BLOCK)
  8515*         LENGTH   (WS-COMM-LENGTH)
  8516*         ITEM     (W-ONE)
  8517*    END-EXEC.
  8518*    MOVE '*" I                  ''   #00007984' TO DFHEIV0
  8519     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  8520     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8521     MOVE X'2020233030303037393834' TO DFHEIV0(25:11)
  8522     CALL 'kxdfhei1' USING DFHEIV0,
  8523           QID,
  8524           PROGRAM-INTERFACE-BLOCK,
  8525           WS-COMM-LENGTH,
  8526           W-ONE,
  8527           DFHEIV99,
  8528           DFHEIV99
  8529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 163
* EL6501.cbl
  8530
  8531
  8532 5199-EXIT.
  8533     EXIT.
  8534
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 164
* EL6501.cbl
  8536
  8537 5200-RECOVER-TS.
  8538
  8539     IF PI-CALLING-PROGRAM NOT = XCTL-652 AND
  8540                                 XCTL-653 AND
  8541                                 XCTL-689 AND
  8542                                 XCTL-608 AND
  8543                                 XCTL-690
  8544         GO TO 5299-EXIT.
  8545
  8546
  8547* EXEC CICS HANDLE CONDITION
  8548*        QIDERR  (5250-QID-ERROR)
  8549*    END-EXEC.
  8550*    MOVE '"$N                   ! , #00008005' TO DFHEIV0
  8551     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8553     MOVE X'2C20233030303038303035' TO DFHEIV0(25:11)
  8554     CALL 'kxdfhei1' USING DFHEIV0
  8555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8556
  8557
  8558
  8559* EXEC CICS READQ TS
  8560*        QUEUE    (QID)
  8561*        INTO     (PROGRAM-INTERFACE-BLOCK)
  8562*        LENGTH   (WS-COMM-LENGTH)
  8563*        ITEM     (W-ONE)
  8564*    END-EXEC.
  8565*    MOVE '*$II   L              ''   #00008009' TO DFHEIV0
  8566     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8567     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8568     MOVE X'2020233030303038303039' TO DFHEIV0(25:11)
  8569     CALL 'kxdfhei1' USING DFHEIV0,
  8570           QID,
  8571           PROGRAM-INTERFACE-BLOCK,
  8572           WS-COMM-LENGTH,
  8573           W-ONE,
  8574           DFHEIV99,
  8575           DFHEIV99
  8576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8577
  8578
  8579 5200-DELETE-TS.
  8580
  8581
  8582* EXEC CICS DELETEQ TS
  8583*        QUEUE    (QID)
  8584*    END-EXEC.
  8585*    MOVE '*&                    #   #00008018' TO DFHEIV0
  8586     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8587     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8588     MOVE X'2020233030303038303138' TO DFHEIV0(25:11)
  8589     CALL 'kxdfhei1' USING DFHEIV0,
  8590           QID,
  8591           DFHEIV99
  8592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8593
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 165
* EL6501.cbl
  8594
  8595     GO TO 5299-EXIT.
  8596
  8597 5250-QID-ERROR.
  8598     MOVE ER-0033                TO  EMI-ERROR.
  8599     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8600
  8601 5299-EXIT.
  8602     EXIT.
  8603
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 166
* EL6501.cbl
  8605
  8606 5300-UPDATE-REQUEST-FILE.
  8607     MOVE +0                     TO SUB1.
  8608
  8609 5300-FIND-ACCOUNT-AGENT.
  8610     ADD +1                      TO SUB1.
  8611
  8612     IF SUB1 GREATER THAN +10
  8613        MOVE ER-2949             TO EMI-ERROR
  8614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8615        MOVE -1                  TO AGENTL (1)
  8616
  8617* EXEC CICS SYNCPOINT ROLLBACK
  8618*       END-EXEC
  8619*    MOVE '6"R                   !   #00008043' TO DFHEIV0
  8620     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  8621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8622     MOVE X'2020233030303038303433' TO DFHEIV0(25:11)
  8623     CALL 'kxdfhei1' USING DFHEIV0
  8624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8625        GO TO 8200-SEND-DATAONLY.
  8626
  8627     MOVE SAVE-ACCT-AGENT      TO SAVE-NEW-ACCT-AGENT.
  8628
  8629************************************************************
  8630**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8631************************************************************
  8632
  8633     IF AM-COM-TYP  (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
  8634        IF AM-AGT   (SUB1) NOT = SAVE-ACCT-AGENT
  8635           MOVE AM-AGT (SUB1)  TO SAVE-NEW-ACCT-AGENT.
  8636
  8637     IF AM-AGT (AM-REMIT-TO) NOT = SAVE-FIN-RESP
  8638        GO TO 5325-PROCESS-RQST-FILE.
  8639
  8640     IF SAVE-ACCT-AGENT NOT = SAVE-NEW-ACCT-AGENT
  8641        GO TO 5325-PROCESS-RQST-FILE.
  8642
  8643     GO TO 5399-EXIT.
  8644
  8645 5325-PROCESS-RQST-FILE.
  8646     MOVE LOW-VALUES             TO RQST3-KEY.
  8647     MOVE AM-COMPANY-CD          TO RQST3-COMPANY-CD.
  8648     MOVE AM-CARRIER             TO RQST3-CARRIER.
  8649     MOVE AM-GROUPING            TO RQST3-GROUPING.
  8650     MOVE SAVE-FIN-RESP          TO RQST3-FIN-RESP.
  8651     MOVE SAVE-ACCT-AGENT        TO RQST3-ACCT-AGENT.
  8652
  8653
  8654* EXEC CICS HANDLE CONDITION
  8655*        NOTFND(5399-EXIT)
  8656*        ENDFILE(5399-EXIT)
  8657*    END-EXEC.
  8658*    MOVE '"$I''                  ! - #00008073' TO DFHEIV0
  8659     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8660     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8661     MOVE X'2D20233030303038303733' TO DFHEIV0(25:11)
  8662     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 167
* EL6501.cbl
  8663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8664
  8665
  8666 5325-PROCESS-REQUEST-FILE.
  8667
  8668* EXEC CICS STARTBR
  8669*         DATASET   (RQST3-FILE-ID)
  8670*         RIDFLD    (RQST3-KEY)
  8671*    END-EXEC.
  8672     MOVE 0
  8673       TO DFHEIV11
  8674*    MOVE '&,         G          &   #00008079' TO DFHEIV0
  8675     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8676     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8677     MOVE X'2020233030303038303739' TO DFHEIV0(25:11)
  8678     CALL 'kxdfhei1' USING DFHEIV0,
  8679           RQST3-FILE-ID,
  8680           RQST3-KEY,
  8681           DFHEIV99,
  8682           DFHEIV11,
  8683           DFHEIV99
  8684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8685
  8686
  8687 5330-READNEXT-REQUEST.
  8688
  8689* EXEC CICS READNEXT
  8690*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  8691*        DATASET(RQST3-FILE-ID)
  8692*        RIDFLD (RQST3-KEY)
  8693*    END-EXEC.
  8694     MOVE 0
  8695       TO DFHEIV11
  8696*    MOVE '&.S                   )   #00008085' TO DFHEIV0
  8697     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8698     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8699     MOVE X'2020233030303038303835' TO DFHEIV0(25:11)
  8700     CALL 'kxdfhei1' USING DFHEIV0,
  8701           RQST3-FILE-ID,
  8702           DFHEIV20,
  8703           DFHEIV99,
  8704           RQST3-KEY,
  8705           DFHEIV99,
  8706           DFHEIV11,
  8707           DFHEIV99,
  8708           DFHEIV99
  8709     SET ADDRESS OF AR-REQUEST-RECORD TO
  8710         DFHEIV20
  8711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8712
  8713
  8714     IF RQST3-KEY = SAVE-RQST3-KEY
  8715        GO TO 5330-READNEXT-REQUEST.
  8716
  8717     MOVE RQST3-KEY              TO SAVE-RQST3-KEY.
  8718
  8719     IF RQ-COMPANY-CD-A2 NOT = PI-COMPANY-CD
  8720        GO TO 5350-REQUESTS-FINISHED.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 168
* EL6501.cbl
  8721
  8722     IF RQ-FIN-RESP-A2 NOT = SAVE-FIN-RESP
  8723        GO TO 5350-REQUESTS-FINISHED.
  8724
  8725     IF RQ-ACCT-AGENT-A2 NOT = SAVE-ACCT-AGENT
  8726        GO TO 5350-REQUESTS-FINISHED.
  8727
  8728     MOVE RQ-CONTROL-PRIMARY     TO RQST-KEY.
  8729
  8730
  8731* EXEC CICS ENDBR
  8732*        DATASET(RQST3-FILE-ID)
  8733*    END-EXEC.
  8734     MOVE 0
  8735       TO DFHEIV11
  8736*    MOVE '&2                    $   #00008107' TO DFHEIV0
  8737     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8738     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8739     MOVE X'2020233030303038313037' TO DFHEIV0(25:11)
  8740     CALL 'kxdfhei1' USING DFHEIV0,
  8741           RQST3-FILE-ID,
  8742           DFHEIV11,
  8743           DFHEIV99
  8744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8745
  8746
  8747
  8748* EXEC CICS READ
  8749*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  8750*        DATASET(RQST-FILE-ID)
  8751*        RIDFLD (RQST-KEY)
  8752*        UPDATE
  8753*    END-EXEC.
  8754*    MOVE '&"S        EU         (   #00008111' TO DFHEIV0
  8755     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8756     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8757     MOVE X'2020233030303038313131' TO DFHEIV0(25:11)
  8758     CALL 'kxdfhei1' USING DFHEIV0,
  8759           RQST-FILE-ID,
  8760           DFHEIV20,
  8761           DFHEIV99,
  8762           RQST-KEY,
  8763           DFHEIV99,
  8764           DFHEIV99,
  8765           DFHEIV99
  8766     SET ADDRESS OF AR-REQUEST-RECORD TO
  8767         DFHEIV20
  8768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8769
  8770
  8771     MOVE AM-AGT (AM-REMIT-TO)   TO RQ-FIN-RESP-A2.
  8772     MOVE SAVE-NEW-ACCT-AGENT    TO RQ-ACCT-AGENT-A2.
  8773
  8774
  8775* EXEC CICS REWRITE
  8776*        DATASET   (RQST-FILE-ID)
  8777*        FROM      (AR-REQUEST-RECORD)
  8778*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 169
* EL6501.cbl
  8779     MOVE LENGTH OF
  8780      AR-REQUEST-RECORD
  8781       TO DFHEIV11
  8782*    MOVE '&& L                  %   #00008121' TO DFHEIV0
  8783     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8784     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8785     MOVE X'2020233030303038313231' TO DFHEIV0(25:11)
  8786     CALL 'kxdfhei1' USING DFHEIV0,
  8787           RQST-FILE-ID,
  8788           AR-REQUEST-RECORD,
  8789           DFHEIV11,
  8790           DFHEIV99
  8791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8792
  8793
  8794     GO TO  5325-PROCESS-REQUEST-FILE.
  8795
  8796 5350-REQUESTS-FINISHED.
  8797
  8798* EXEC CICS ENDBR
  8799*        DATASET(RQST3-FILE-ID)
  8800*    END-EXEC.
  8801     MOVE 0
  8802       TO DFHEIV11
  8803*    MOVE '&2                    $   #00008129' TO DFHEIV0
  8804     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8805     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8806     MOVE X'2020233030303038313239' TO DFHEIV0(25:11)
  8807     CALL 'kxdfhei1' USING DFHEIV0,
  8808           RQST3-FILE-ID,
  8809           DFHEIV11,
  8810           DFHEIV99
  8811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8812
  8813
  8814 5399-EXIT.
  8815     EXIT.
  8816
  8817
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 170
* EL6501.cbl
  8819
  8820 6000-MOVE-TO-SCREEN.
  8821     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  8822
  8823     MOVE AM-LAST-MAINT-USER     TO MAINTBYO.
  8824     MOVE AM-NAME                TO NAMEO.
  8825     MOVE AM-CONTROL-NAME        TO PCONTO.
  8826     MOVE AM-CSR-CODE            TO CSRO.
  8827     MOVE AM-PERSON              TO INCAREO.
  8828     MOVE AM-ADDRS               TO ADDR1O.
  8829     MOVE AM-ID-NO               TO TAXNOO.
  8830     MOVE AM-TEL-NO              TO WS-PHONE.
  8831     MOVE WS-PHONE-NUM           TO PHONEO.
  8832     INSPECT PHONEI CONVERTING SPACES TO '-'.
  8833     MOVE AM-ADDR-CITY           TO ACITYO
  8834     MOVE AM-ADDR-STATE          TO ASTATEO
  8835
  8836     MOVE SPACES                 TO WS-ZIP-CODE.
  8837     IF AM-CANADIAN-POST-CODE
  8838         MOVE AM-CAN-POSTAL-1    TO WS-ZIP-CAN-2-POST1
  8839         MOVE AM-CAN-POSTAL-2    TO WS-ZIP-CAN-2-POST2
  8840     ELSE
  8841         MOVE AM-ZIP-PRIME       TO WS-ZIP-AM-2-CODE
  8842         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  8843             MOVE '-'            TO WS-ZIP-AM-2-DASH
  8844             MOVE AM-ZIP-PLUS4   TO WS-ZIP-AM-2-PLUS4.
  8845
  8846     MOVE WS-ZIP-CODE            TO ZIPO.
  8847
  8848     MOVE AM-GPCD                TO TYPEO.
  8849     MOVE AM-STD-AH-TYPE         TO STDBENO.
  8850
  8851     MOVE AM-IG                  TO INDGRPO.
  8852     INSPECT INDGRPO CONVERTING '12' TO 'IG'.
  8853
  8854     MOVE AM-STATUS              TO STATUSO.
  8855     INSPECT STATUSO CONVERTING '43210' TO 'FCTIA'
  8856
  8857     MOVE AM-REMIT-TO            TO REMITO.
  8858
  8859     IF PI-AR-PROCESSING
  8860        IF AM-AR-HI-CERT-DATE = LOW-VALUES
  8861           MOVE AL-UNNON         TO REMITA
  8862        ELSE
  8863           MOVE AL-SANON         TO REMITA
  8864     ELSE
  8865        MOVE AL-UNNON            TO REMITA.
  8866
  8867***  Y2K PROJ 7744
  8868     MOVE AM-ANNIVERSARY-DATE    TO DC-GREG-DATE-1-YMD.
  8869     MOVE '3'                    TO DC-OPTION-CODE.
  8870     PERFORM 9700-DATE-LINK.
  8871     IF DATE-CONVERSION-ERROR
  8872        MOVE SPACES              TO CONTRO
  8873     ELSE
  8874        MOVE DC-GREG-DATE-1-EDIT TO CONTRO
  8875     END-IF.
  8876***  Y2K PROJ 7744
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 171
* EL6501.cbl
  8877
  8878     MOVE PI-LIFE-OVERRIDE-L6    TO PSILFTO
  8879     MOVE PI-AH-OVERRIDE-L6      TO PSIAHTO.
  8880
  8881     IF AM-LF-PSI-FACTOR NUMERIC
  8882        MOVE AM-LF-PSI-FACTOR    TO PSILFFO.
  8883
  8884     IF AM-AH-PSI-FACTOR NUMERIC
  8885        MOVE AM-AH-PSI-FACTOR    TO PSIAHFO.
  8886
  8887     MOVE AM-RECALC-COMM         TO COMMCALO.
  8888     MOVE AL-UANON               TO COMMCALA.
  8889     MOVE AM-RECALC-REIN         TO REINCALO.
  8890     MOVE AM-REI-TABLE           TO REINTABO.
  8891     MOVE AM-1ST-PROD-DATE       TO DC-GREG-DATE-1-YMD.
  8892     MOVE '3'                    TO DC-OPTION-CODE.
  8893     PERFORM 9700-DATE-LINK.
  8894     IF DATE-CONVERSION-ERROR
  8895        MOVE SPACES              TO PRODATEO
  8896     ELSE
  8897        MOVE DC-GREG-DATE-1-EDIT TO PRODATEO.
  8898
  8899     IF PI-COMPANY-ID = 'DCC'
  8900        IF AM-CLP-TOL-PCT NOT NUMERIC
  8901           MOVE ZEROS            TO AM-CLP-TOL-PCT
  8902        END-IF
  8903        IF AM-SPP-LEASE-COMM NOT NUMERIC
  8904           MOVE ZEROS            TO AM-SPP-LEASE-COMM
  8905        END-IF
  8906        MOVE AM-CLP-TOL-PCT      TO CLPTOLPO
  8907        MOVE AM-SPP-LEASE-COMM   TO LCOMMO
  8908     ELSE
  8909        MOVE AL-SADOF            TO CTPLABLA
  8910                                    CLPTOLPA
  8911                                    LCLABLA
  8912                                    LCOMMA
  8913     END-IF
  8914
  8915     IF AM-RET-Y-N = ' '  OR  'N'
  8916         MOVE 'NO '              TO RETROCDO
  8917     ELSE
  8918         MOVE 'YES'              TO RETROCDO.
  8919
  8920     IF AM-ACCOUNT-BILLED
  8921         MOVE 'YES'              TO BILLCDO
  8922     ELSE
  8923         MOVE 'NO '              TO BILLCDO.
  8924
  8925     MOVE AL-UANON               TO RETROCDA.
  8926     MOVE AL-SANON               TO PRODATEA
  8927                                    BILLCDA.
  8928     MOVE AM-PREV-EFF-DT TO DC-GREG-DATE-1-YMD.
  8929     MOVE '3' TO DC-OPTION-CODE.
  8930     PERFORM 9700-DATE-LINK.
  8931     IF DATE-CONVERSION-ERROR
  8932        MOVE SPACES TO PEFFDTEO
  8933     ELSE
  8934        MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 172
* EL6501.cbl
  8935
  8936     IF AM-PREV-EXP-DT NOT = 99999999999
  8937        MOVE AM-PREV-EXP-DT TO DC-GREG-DATE-1-YMD
  8938        MOVE '3' TO DC-OPTION-CODE
  8939        PERFORM 9700-DATE-LINK
  8940        IF DATE-CONVERSION-ERROR
  8941           MOVE SPACES TO PEXPDTEO
  8942        ELSE
  8943           MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEO
  8944     ELSE
  8945        MOVE '99/99/99' TO PEXPDTEO.
  8946
  8947     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  8948        MOVE AL-UANON            TO PEXPDTEA
  8949                                    PEFFDTEA
  8950        MOVE AL-SANOF TO            PDSPLYA.
  8951
  8952     MOVE LOW-VALUES             TO MAP-AGENT-AREA.
  8953     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  8954     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  8955
  8956     MOVE 1  TO SUB.
  8957     SET M-INDEX TO 1.
  8958
  8959 6005-LOOP.
  8960     IF AM-AGT (SUB) = SPACES  OR ZEROS
  8961        IF PI-AR-PROCESSING
  8962           IF AM-AR-HI-CERT-DATE GREATER THAN LOW-VALUES
  8963              MOVE AL-SANOF     TO AGENTA  (M-INDEX)
  8964                                   ATYPEA (M-INDEX)
  8965                                   SINGLEA (M-INDEX)
  8966                                   JOINTA (M-INDEX)
  8967                                   A-HA    (M-INDEX)
  8968              GO TO 6010-BUMP-SUB
  8969           ELSE
  8970              GO TO 6010-BUMP-SUB
  8971        ELSE
  8972           GO TO 6010-BUMP-SUB.
  8973
  8974     MOVE AM-AGT (SUB)           TO AGENT (M-INDEX).
  8975
  8976***DMD CUSTOM CODE - CAPTURE THE FIRST AGENT TO BE DISPLAYED
  8977     IF WS-DMD-AGENT = LOW-VALUES
  8978        MOVE AM-AGT (SUB)        TO WS-DMD-AGENT.
  8979***DMD ******************************************************
  8980
  8981     IF PI-GA-BILLING
  8982        MOVE AM-AGT (SUB)        TO WK-AM-AGT (SUB).
  8983     MOVE AL-UANON               TO AGENTA (M-INDEX).
  8984
  8985     MOVE AM-COM-TYP (SUB)       TO ATYPE (M-INDEX).
  8986     IF PI-GA-BILLING
  8987        MOVE AM-COM-TYP (SUB)    TO WK-AM-TYPE (SUB).
  8988     MOVE AL-UANON               TO ATYPEA (M-INDEX).
  8989
  8990     IF (AM-L-COM (SUB) NOT NUMERIC)
  8991        OR (AM-L-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  8992        MOVE AM-L-COMA (SUB)     TO SINGLE-COMM-T (M-INDEX)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 173
* EL6501.cbl
  8993     ELSE
  8994        IF AM-L-COM (SUB) NOT = ZEROS
  8995           MOVE AM-L-COM  (SUB)  TO SINGLE-COMM-O (M-INDEX).
  8996
  8997     IF (AM-J-COM (SUB) NOT NUMERIC)
  8998        OR (AM-J-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  8999        MOVE AM-J-COMA (SUB)     TO JOINT-COMM-T (M-INDEX)
  9000     ELSE
  9001        IF AM-J-COM (SUB) NOT = ZEROS
  9002           MOVE AM-J-COM  (SUB)  TO JOINT-COMM-O (M-INDEX).
  9003
  9004     IF (AM-A-COM (SUB) NOT NUMERIC)
  9005        OR (AM-A-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9006        MOVE AM-A-COMA (SUB)     TO A-H-COMM-T (M-INDEX)
  9007     ELSE
  9008        IF AM-A-COM (SUB) NOT = ZEROS
  9009           MOVE AM-A-COM  (SUB)  TO A-H-COMM-O (M-INDEX).
  9010
  9011************************************************************
  9012**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9013************************************************************
  9014
  9015     IF (AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'O' AND 'P'
  9016            AND 'F' AND 'S' AND 'G' AND 'B' AND 'I'
  9017            AND 'K' AND 'L' AND 'J' AND 'M' AND 'A')
  9018         GO TO 6006-CONTINUE.
  9019
  9020     IF (AM-L-COM (SUB) NUMERIC)
  9021        AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9022         ADD AM-L-COM (SUB) TO COMM-SL-ACCUM.
  9023
  9024     IF (AM-J-COM (SUB) NUMERIC)
  9025        AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9026         ADD AM-J-COM (SUB) TO COMM-JL-ACCUM.
  9027
  9028     IF (AM-A-COM (SUB) NUMERIC)
  9029        AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9030         ADD AM-A-COM (SUB) TO COMM-AH-ACCUM.
  9031
  9032 6006-CONTINUE.
  9033     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  9034         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  9035
  9036     IF WS-ST-COMM-CAP-SL = ZEROS
  9037        CONTINUE
  9038     ELSE
  9039        IF (AM-L-COM (SUB) NUMERIC)
  9040           AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9041           IF (WS-LIMIT-TO-ACCOUNT AND
  9042              AM-L-COM (SUB) > WS-ST-COMM-CAP-SL)
  9043                       OR
  9044              (NOT WS-LIMIT-TO-ACCOUNT AND
  9045              COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  9046              MOVE -1            TO MAINTL
  9047              MOVE ER-1884       TO EMI-ERROR
  9048              PERFORM 9900-ERROR-FORMAT
  9049                                 THRU 9900-EXIT
  9050           END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 174
* EL6501.cbl
  9051        ELSE
  9052           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9053           MOVE AM-L-COMA (SUB)  TO COMM-TABLE
  9054           MOVE PI-LIFE-OVERRIDE-L1
  9055                                 TO COMM-LF-AH
  9056           MOVE LOW-VALUES       TO COMM-FILLER
  9057           PERFORM 6400-READ-COMMISSION
  9058                                 THRU 6459-EXIT
  9059           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  9060              MOVE -1            TO MAINTL
  9061              MOVE ER-1884       TO EMI-ERROR
  9062              PERFORM 9900-ERROR-FORMAT
  9063                                 THRU 9900-EXIT
  9064           END-IF
  9065        END-IF
  9066     END-IF
  9067
  9068     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  9069         MOVE ZEROS        TO WS-ST-COMM-CAP-JL.
  9070
  9071     IF WS-ST-COMM-CAP-JL = ZEROS
  9072        CONTINUE
  9073     ELSE
  9074        IF (AM-J-COM (SUB) NUMERIC)
  9075           AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9076           IF (WS-LIMIT-TO-ACCOUNT AND
  9077              AM-J-COM (SUB) > WS-ST-COMM-CAP-JL)
  9078                       OR
  9079              (NOT WS-LIMIT-TO-ACCOUNT AND
  9080              COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  9081              MOVE -1            TO MAINTL
  9082              MOVE ER-1885       TO EMI-ERROR
  9083              PERFORM 9900-ERROR-FORMAT
  9084                                 THRU 9900-EXIT
  9085           END-IF
  9086        ELSE
  9087           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9088           MOVE AM-J-COMA (SUB)  TO COMM-TABLE
  9089           MOVE PI-LIFE-OVERRIDE-L1
  9090                                 TO COMM-LF-AH
  9091           MOVE LOW-VALUES       TO COMM-FILLER
  9092           PERFORM 6400-READ-COMMISSION
  9093                                 THRU 6459-EXIT
  9094           IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  9095              MOVE -1            TO MAINTL
  9096              MOVE ER-1885       TO EMI-ERROR
  9097              PERFORM 9900-ERROR-FORMAT
  9098                                 THRU 9900-EXIT
  9099           END-IF
  9100        END-IF
  9101     END-IF
  9102
  9103     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  9104         MOVE ZEROS        TO WS-ST-COMM-CAP-SA.
  9105
  9106     IF WS-ST-COMM-CAP-SA = ZEROS
  9107        CONTINUE
  9108     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 175
* EL6501.cbl
  9109        IF (AM-A-COM (SUB) NUMERIC)
  9110           AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9111           IF (WS-LIMIT-TO-ACCOUNT AND
  9112              AM-A-COM (SUB) > WS-ST-COMM-CAP-SA)
  9113                       OR
  9114              (NOT WS-LIMIT-TO-ACCOUNT AND
  9115              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  9116              MOVE -1            TO MAINTL
  9117              MOVE ER-1886       TO EMI-ERROR
  9118              PERFORM 9900-ERROR-FORMAT
  9119                                 THRU 9900-EXIT
  9120           END-IF
  9121        ELSE
  9122           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9123           MOVE AM-A-COMA (SUB)  TO COMM-TABLE
  9124           MOVE PI-AH-OVERRIDE-L1
  9125                                 TO COMM-LF-AH
  9126           MOVE LOW-VALUES       TO COMM-FILLER
  9127           PERFORM 6400-READ-COMMISSION
  9128                                 THRU 6459-EXIT
  9129           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  9130              MOVE -1            TO MAINTL
  9131              MOVE ER-1886       TO EMI-ERROR
  9132              PERFORM 9900-ERROR-FORMAT
  9133                                 THRU 9900-EXIT
  9134           END-IF
  9135        END-IF
  9136     END-IF
  9137
  9138
  9139     IF AM-RECALC-LV-INDIC (SUB) NOT = SPACE
  9140         MOVE AM-RECALC-LV-INDIC (SUB) TO RECAL (M-INDEX).
  9141
  9142     IF AM-RETRO-LV-INDIC (SUB) NOT = SPACE
  9143         MOVE AM-RETRO-LV-INDIC (SUB) TO RCOMM (M-INDEX).
  9144
  9145     IF AM-COMM-CHARGEBACK (SUB)  NUMERIC
  9146        NEXT SENTENCE
  9147     ELSE
  9148        MOVE ZEROS              TO  AM-COMM-CHARGEBACK (SUB).
  9149
  9150     IF AM-COMM-CHARGEBACK (SUB)   NOT  =    ZEROS
  9151         MOVE AM-COMM-CHARGEBACK (SUB) TO CHGBCK (M-INDEX).
  9152
  9153     IF AM-GL-CODES (SUB)   NOT  =    ZEROS
  9154         MOVE AM-GL-CODES (SUB)  TO  GLCODE (M-INDEX).
  9155
  9156     IF NOT PI-AR-PROCESSING
  9157        GO TO 6010-BUMP-SUB.
  9158
  9159     IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9160        GO TO 6010-BUMP-SUB.
  9161
  9162     MOVE AL-SANON              TO AGENTA  (M-INDEX)
  9163                                   ATYPEA  (M-INDEX)
  9164                                   SINGLEA (M-INDEX)
  9165                                   JOINTA  (M-INDEX)
  9166                                   A-HA    (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 176
* EL6501.cbl
  9167
  9168 6010-BUMP-SUB.
  9169     ADD 1  TO SUB.
  9170     SET M-INDEX UP BY 1.
  9171     IF SUB LESS 11
  9172        GO TO 6005-LOOP.
  9173
  9174 6099-EXIT.
  9175      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 177
* EL6501.cbl
  9177 6300-STARTBR.
  9178
  9179* EXEC CICS STARTBR
  9180*         DATASET   (ACCT-FILE-ID)
  9181*         RIDFLD    (WS-KEY-SAVE)
  9182*    END-EXEC.
  9183     MOVE 0
  9184       TO DFHEIV11
  9185*    MOVE '&,         G          &   #00008497' TO DFHEIV0
  9186     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9187     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9188     MOVE X'2020233030303038343937' TO DFHEIV0(25:11)
  9189     CALL 'kxdfhei1' USING DFHEIV0,
  9190           ACCT-FILE-ID,
  9191           WS-KEY-SAVE,
  9192           DFHEIV99,
  9193           DFHEIV11,
  9194           DFHEIV99
  9195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9196
  9197
  9198     MOVE 'Y'                    TO BROWSE-STARTED-SW.
  9199
  9200 6300-EXIT.
  9201      EXIT.
  9202
  9203 6310-READNEXT.
  9204
  9205* EXEC CICS READNEXT
  9206*         DATASET    (ACCT-FILE-ID)
  9207*         SET        (ADDRESS OF ACCOUNT-MASTER)
  9208*         RIDFLD     (WS-KEY-SAVE)
  9209*    END-EXEC.
  9210     MOVE 0
  9211       TO DFHEIV11
  9212*    MOVE '&.S                   )   #00008508' TO DFHEIV0
  9213     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9214     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9215     MOVE X'2020233030303038353038' TO DFHEIV0(25:11)
  9216     CALL 'kxdfhei1' USING DFHEIV0,
  9217           ACCT-FILE-ID,
  9218           DFHEIV20,
  9219           DFHEIV99,
  9220           WS-KEY-SAVE,
  9221           DFHEIV99,
  9222           DFHEIV11,
  9223           DFHEIV99,
  9224           DFHEIV99
  9225     SET ADDRESS OF ACCOUNT-MASTER TO
  9226         DFHEIV20
  9227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9228
  9229
  9230 6310-EXIT.
  9231      EXIT.
  9232
  9233 6320-ENDBR.
  9234     MOVE SPACE               TO BROWSE-STARTED-SW.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 178
* EL6501.cbl
  9235
  9236* EXEC CICS ENDBR
  9237*        DATASET(ACCT-FILE-ID)
  9238*    END-EXEC.
  9239     MOVE 0
  9240       TO DFHEIV11
  9241*    MOVE '&2                    $   #00008519' TO DFHEIV0
  9242     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9243     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9244     MOVE X'2020233030303038353139' TO DFHEIV0(25:11)
  9245     CALL 'kxdfhei1' USING DFHEIV0,
  9246           ACCT-FILE-ID,
  9247           DFHEIV11,
  9248           DFHEIV99
  9249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9250
  9251
  9252 6320-EXIT.
  9253      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 179
* EL6501.cbl
  9255 6400-READ-COMMISSION.
  9256     MOVE ZEROS                  TO WS-COMM-ERROR-SW
  9257
  9258* EXEC CICS HANDLE CONDITION
  9259*         NOTFND   (6450-NOT-FOUND)
  9260*    END-EXEC
  9261*    MOVE '"$I                   ! . #00008528' TO DFHEIV0
  9262     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9264     MOVE X'2E20233030303038353238' TO DFHEIV0(25:11)
  9265     CALL 'kxdfhei1' USING DFHEIV0
  9266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9267
  9268
  9269* EXEC CICS READ
  9270*        GTEQ
  9271*        DATASET   (COMM-FILE-ID)
  9272*        SET       (ADDRESS OF COMM-TABLE-RECORD)
  9273*        RIDFLD    (COMM-KEY)
  9274*    END-EXEC
  9275*    MOVE '&"S        G          (   #00008532' TO DFHEIV0
  9276     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9277     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9278     MOVE X'2020233030303038353332' TO DFHEIV0(25:11)
  9279     CALL 'kxdfhei1' USING DFHEIV0,
  9280           COMM-FILE-ID,
  9281           DFHEIV20,
  9282           DFHEIV99,
  9283           COMM-KEY,
  9284           DFHEIV99,
  9285           DFHEIV99,
  9286           DFHEIV99
  9287     SET ADDRESS OF COMM-TABLE-RECORD TO
  9288         DFHEIV20
  9289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9290
  9291     IF CT-COMPANY-CD = PI-COMPANY-CD AND
  9292        CT-TABLE      = COMM-TABLE    AND
  9293        CT-BEN-TYPE   = COMM-LF-AH
  9294        PERFORM 6460-CHECK-MAX THRU 6460-EXIT
  9295        GO TO 6459-EXIT
  9296     END-IF
  9297     .
  9298 6450-NOT-FOUND.
  9299     MOVE ER-2176                TO EMI-ERROR.
  9300     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9301     MOVE 1  TO WS-COMM-ERROR-SW.
  9302
  9303 6459-EXIT.
  9304      EXIT.
  9305
  9306 6460-CHECK-MAX.
  9307
  9308
  9309* EXEC CICS STARTBR
  9310*         DATASET   (COMM-FILE-ID)
  9311*         RIDFLD    (COMM-KEY)
  9312*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 180
* EL6501.cbl
  9313*    END-EXEC
  9314     MOVE 0
  9315       TO DFHEIV11
  9316*    MOVE '&,         G          &  N#00008556' TO DFHEIV0
  9317     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9318     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9319     MOVE X'204E233030303038353536' TO DFHEIV0(25:11)
  9320     CALL 'kxdfhei1' USING DFHEIV0,
  9321           COMM-FILE-ID,
  9322           COMM-KEY,
  9323           DFHEIV99,
  9324           DFHEIV11,
  9325           DFHEIV99
  9326     MOVE EIBRESP  TO WS-RESPONSE
  9327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9328
  9329     MOVE SPACES          TO WS-STATE-MAX-SW
  9330
  9331     IF RESP-NORMAL
  9332        MOVE LOW-VALUES          TO COMM-FILLER
  9333        MOVE COMM-KEY            TO WS-HOLD-COMM-KEY
  9334        MOVE ZEROS               TO WS-TABLE-MAX
  9335        PERFORM UNTIL
  9336              (NOT RESP-NORMAL) OR
  9337              (COMM-KEY (1:5) NOT = WS-HOLD-COMM-KEY (1:5))
  9338
  9339* EXEC CICS READNEXT
  9340*             DATASET   (COMM-FILE-ID)
  9341*             SET       (ADDRESS OF COMM-TABLE-RECORD)
  9342*             RIDFLD    (COMM-KEY)
  9343*             RESP      (WS-RESPONSE)
  9344*           END-EXEC
  9345     MOVE 0
  9346       TO DFHEIV11
  9347*    MOVE '&.S                   )  N#00008571' TO DFHEIV0
  9348     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9349     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9350     MOVE X'204E233030303038353731' TO DFHEIV0(25:11)
  9351     CALL 'kxdfhei1' USING DFHEIV0,
  9352           COMM-FILE-ID,
  9353           DFHEIV20,
  9354           DFHEIV99,
  9355           COMM-KEY,
  9356           DFHEIV99,
  9357           DFHEIV11,
  9358           DFHEIV99,
  9359           DFHEIV99
  9360     SET ADDRESS OF COMM-TABLE-RECORD TO
  9361         DFHEIV20
  9362     MOVE EIBRESP  TO WS-RESPONSE
  9363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9364            IF (RESP-NORMAL) AND
  9365               (COMM-KEY (1:5) = WS-HOLD-COMM-KEY (1:5))
  9366               PERFORM VARYING WS-NDX FROM +1 BY +1 UNTIL
  9367                   (WS-NDX > +27)
  9368                   IF CT-RT (WS-NDX) > WS-TABLE-MAX
  9369                      MOVE CT-RT (WS-NDX)
  9370                                 TO WS-TABLE-MAX
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 181
* EL6501.cbl
  9371                   END-IF
  9372               END-PERFORM
  9373            END-IF
  9374        END-PERFORM
  9375
  9376* EXEC CICS ENDBR
  9377*            DATASET   (COMM-FILE-ID)
  9378*       END-EXEC
  9379     MOVE 0
  9380       TO DFHEIV11
  9381*    MOVE '&2                    $   #00008588' TO DFHEIV0
  9382     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9383     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9384     MOVE X'2020233030303038353838' TO DFHEIV0(25:11)
  9385     CALL 'kxdfhei1' USING DFHEIV0,
  9386           COMM-FILE-ID,
  9387           DFHEIV11,
  9388           DFHEIV99
  9389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9390     END-IF
  9391
  9392     .
  9393 6460-EXIT.
  9394      EXIT.
  9395
  9396
  9397 6500-READ-ACCT.
  9398
  9399* EXEC CICS READ
  9400*        GTEQ
  9401*        DATASET   (ACCT-FILE-ID)
  9402*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9403*        RIDFLD    (PI-ACCT-KEY)
  9404*    END-EXEC.
  9405*    MOVE '&"S        G          (   #00008599' TO DFHEIV0
  9406     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9407     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9408     MOVE X'2020233030303038353939' TO DFHEIV0(25:11)
  9409     CALL 'kxdfhei1' USING DFHEIV0,
  9410           ACCT-FILE-ID,
  9411           DFHEIV20,
  9412           DFHEIV99,
  9413           PI-ACCT-KEY,
  9414           DFHEIV99,
  9415           DFHEIV99,
  9416           DFHEIV99
  9417     SET ADDRESS OF ACCOUNT-MASTER TO
  9418         DFHEIV20
  9419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9420
  9421
  9422 6599-EXIT.
  9423      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 182
* EL6501.cbl
  9425 6600-UPDATE-MAINT-DT.
  9426     MOVE SPACES                 TO ELCNTL-KEY.
  9427
  9428     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9429     MOVE '1'                    TO CNTL-REC-TYPE.
  9430     MOVE +0                     TO CNTL-SEQ-NO.
  9431
  9432
  9433* EXEC CICS HANDLE CONDITION
  9434*        NOTFND   (6699-EXIT)
  9435*    END-EXEC.
  9436*    MOVE '"$I                   ! / #00008616' TO DFHEIV0
  9437     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9439     MOVE X'2F20233030303038363136' TO DFHEIV0(25:11)
  9440     CALL 'kxdfhei1' USING DFHEIV0
  9441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9442
  9443
  9444
  9445* EXEC CICS READ
  9446*        UPDATE
  9447*        DATASET   (CNTL-FILE-ID)
  9448*        SET       (ADDRESS OF CONTROL-FILE)
  9449*        RIDFLD    (ELCNTL-KEY)
  9450*    END-EXEC.
  9451*    MOVE '&"S        EU         (   #00008620' TO DFHEIV0
  9452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9453     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9454     MOVE X'2020233030303038363230' TO DFHEIV0(25:11)
  9455     CALL 'kxdfhei1' USING DFHEIV0,
  9456           CNTL-FILE-ID,
  9457           DFHEIV20,
  9458           DFHEIV99,
  9459           ELCNTL-KEY,
  9460           DFHEIV99,
  9461           DFHEIV99,
  9462           DFHEIV99
  9463     SET ADDRESS OF CONTROL-FILE TO
  9464         DFHEIV20
  9465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9466
  9467
  9468     MOVE BIN-CURRENT-SAVE       TO CF-ACCOUNT-MSTR-MAINT-DT.
  9469
  9470
  9471* EXEC CICS REWRITE
  9472*        DATASET   (CNTL-FILE-ID)
  9473*        FROM      (CONTROL-FILE)
  9474*    END-EXEC.
  9475     MOVE LENGTH OF
  9476      CONTROL-FILE
  9477       TO DFHEIV11
  9478*    MOVE '&& L                  %   #00008629' TO DFHEIV0
  9479     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9480     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9481     MOVE X'2020233030303038363239' TO DFHEIV0(25:11)
  9482     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 183
* EL6501.cbl
  9483           CNTL-FILE-ID,
  9484           CONTROL-FILE,
  9485           DFHEIV11,
  9486           DFHEIV99
  9487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9488
  9489
  9490 6699-EXIT.
  9491      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 184
* EL6501.cbl
  9493 6700-BUILD-COMM-WORK.
  9494     IF NOT PI-GA-BILLING
  9495         GO TO 6799-EXIT.
  9496
  9497
  9498* EXEC CICS GETMAIN
  9499*         LENGTH   (260)
  9500*         SET      (ADDRESS OF COMMISSION-WORK-AREA)
  9501*         INITIMG  (GETMAIN-SPACE)
  9502*     END-EXEC.
  9503     MOVE 260
  9504       TO DFHEIV11
  9505*    MOVE ',"IL                  $   #00008641' TO DFHEIV0
  9506     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9507     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9508     MOVE X'2020233030303038363431' TO DFHEIV0(25:11)
  9509     CALL 'kxdfhei1' USING DFHEIV0,
  9510           DFHEIV20,
  9511           DFHEIV11,
  9512           GETMAIN-SPACE
  9513     SET ADDRESS OF COMMISSION-WORK-AREA TO
  9514         DFHEIV20
  9515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9516
  9517     SET LCP-WS-ADDR-PNTR TO ADDRESS OF COMMISSION-WORK-AREA
  9518
  9519     MOVE LCP-WS-ADDR-COMP TO PI-COMM-POINTER.
  9520     MOVE SPACES             TO COMMISSION-WORK-AREA.
  9521     MOVE 'X'                TO COMMISSION-GETMAIN-SW.
  9522
  9523     IF PI-MAINT = 'A'
  9524         GO TO 6799-EXIT.
  9525
  9526     MOVE AM-COMM-STRUCTURE TO COMMISSION-WORK-AREA.
  9527     MOVE +1                TO AXRF-SUB.
  9528
  9529 6710-AXRF-LOOP.
  9530     MOVE SPACES         TO AGENT-FIND.
  9531     MOVE ERGXRF-MAX-LEN TO ERGXRF-REC-LEN.
  9532
  9533     PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT.
  9534
  9535     IF AGENT-FIND = SPACES
  9536        MOVE GX-LAST-BILL-DT (GX-AGENT-SUB) TO
  9537             WK-GA-BILL-DT (AXRF-SUB)
  9538     ELSE
  9539        MOVE LOW-VALUES TO WK-GA-BILL-DT (AXRF-SUB).
  9540
  9541     ADD +1 TO AXRF-SUB.
  9542
  9543     IF AXRF-SUB NOT = +11
  9544        GO TO 6710-AXRF-LOOP.
  9545
  9546 6799-EXIT.
  9547     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 185
* EL6501.cbl
  9549 6800-COMPANY-REC-READ.
  9550     MOVE SPACES                 TO ELCNTL-KEY.
  9551     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9552     MOVE '1'                    TO CNTL-REC-TYPE.
  9553     MOVE +0                     TO CNTL-SEQ-NO.
  9554
  9555* EXEC CICS HANDLE CONDITION
  9556*        NOTFND   (6880-NO-COMP)
  9557*    END-EXEC.
  9558*    MOVE '"$I                   ! 0 #00008683' TO DFHEIV0
  9559     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9561     MOVE X'3020233030303038363833' TO DFHEIV0(25:11)
  9562     CALL 'kxdfhei1' USING DFHEIV0
  9563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9564
  9565
  9566
  9567* EXEC CICS READ
  9568*        DATASET   (CNTL-FILE-ID)
  9569*        SET       (ADDRESS OF CONTROL-FILE)
  9570*        RIDFLD    (ELCNTL-KEY)
  9571*    END-EXEC.
  9572*    MOVE '&"S        E          (   #00008687' TO DFHEIV0
  9573     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9574     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9575     MOVE X'2020233030303038363837' TO DFHEIV0(25:11)
  9576     CALL 'kxdfhei1' USING DFHEIV0,
  9577           CNTL-FILE-ID,
  9578           DFHEIV20,
  9579           DFHEIV99,
  9580           ELCNTL-KEY,
  9581           DFHEIV99,
  9582           DFHEIV99,
  9583           DFHEIV99
  9584     SET ADDRESS OF CONTROL-FILE TO
  9585         DFHEIV20
  9586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9587
  9588
  9589     IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES
  9590         MOVE ER-2572               TO EMI-ERROR
  9591         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9592
  9593     GO TO 6899-EXIT.
  9594
  9595 6880-NO-COMP.
  9596     MOVE ER-0002                TO EMI-ERROR.
  9597     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9598
  9599 6899-EXIT.
  9600     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 186
* EL6501.cbl
  9602 6900-READ-AND-CHECK-AXRF.
  9603     IF NOT PI-GA-BILLING
  9604        GO TO 6999-EXIT.
  9605
  9606     MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
  9607     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9608
  9609 6905-AGENT-LEVEL-LOOP.
  9610     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  9611     MOVE SPACES TO AGENT-FIND.
  9612     IF ((AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB))
  9613      OR
  9614        (AM-COM-TYP (AXRF-SUB) NOT = WK-AM-TYPE (AXRF-SUB)))
  9615      AND
  9616        ((AM-COM-TYP (AXRF-SUB) = 'O' OR 'P' OR 'G'
  9617                             OR 'B' OR 'I'
  9618                             OR 'K' OR 'L' OR 'J' OR 'M' OR 'A')
  9619                            OR
  9620        (WK-AM-TYPE (AXRF-SUB) = 'O' OR 'P' OR 'G' OR
  9621                'B' OR 'I' OR 'K' OR 'L' OR 'J' OR 'M' OR 'A'))
  9622            PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT
  9623            IF AGENT-RECORD-NOT-FOUND
  9624               PERFORM 6950-ADD-AGENT-RECORD THRU 6959-EXIT
  9625           ELSE
  9626            IF ACCT-RECORD-NOT-FOUND OR ACCT-LEVEL-DIFFERENT
  9627               PERFORM 6970-REWRITE-AGENT-RECORD THRU 6979-EXIT
  9628           ELSE
  9629        IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'G'
  9630              AND 'B' AND 'I'
  9631              AND 'K' AND 'L' AND 'J' AND 'M' AND 'A') OR
  9632           (AM-AGT (AXRF-SUB) NOT =
  9633                   WK-AM-AGT (AXRF-SUB))
  9634           PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT
  9635           GO TO 6910-INC-SUB.
  9636
  9637     MOVE SPACES TO AGENT-FIND.
  9638     IF (AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB)) AND
  9639        (WK-AM-AGT (AXRF-SUB) NOT = LOW-VALUES AND
  9640                               SPACES AND ZEROS)
  9641          MOVE WK-AM-AGT (AXRF-SUB)   TO WS-AXRF-AGENT-NO
  9642          MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN
  9643          PERFORM 6921-READ-AXRF THRU 6929-EXIT
  9644          IF AGENT-FIND = SPACES
  9645              PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT.
  9646
  9647 6910-INC-SUB.
  9648     ADD +1                      TO AXRF-SUB.
  9649     IF AXRF-SUB NOT = +11
  9650        GO TO 6905-AGENT-LEVEL-LOOP.
  9651
  9652     GO TO 6999-EXIT.
  9653
  9654 6920-READ-AXRF-FILE.
  9655*    IF GETMAIN-SW = 'X'
  9656*       GO TO 6920-BUILD-KEY.
  9657*
  9658*    EXEC CICS GETMAIN
  9659*         LENGTH   (ERGXRF-REC-LEN)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 187
* EL6501.cbl
  9660*         SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  9661*         INITIMG  (GETMAIN-SPACE)
  9662*    END-EXEC.
  9663*
  9664*    MOVE 'X' TO GETMAIN-SW.
  9665
  9666 6920-BUILD-KEY.
  9667     MOVE PI-COMPANY-CD          TO WS-AXRF-COMPANY-CD.
  9668
  9669     IF PI-ZERO-CARRIER
  9670       OR PI-ZERO-CAR-GROUP
  9671         MOVE ZERO               TO WS-AXRF-CARRIER
  9672     ELSE
  9673         MOVE AM-CARRIER         TO WS-AXRF-CARRIER.
  9674
  9675     IF PI-ZERO-GROUPING
  9676       OR PI-ZERO-CAR-GROUP
  9677         MOVE ZEROS              TO WS-AXRF-GROUPING
  9678     ELSE
  9679         MOVE AM-GROUPING        TO WS-AXRF-GROUPING.
  9680
  9681     IF AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
  9682                                              LOW-VALUES
  9683        MOVE AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
  9684     ELSE
  9685     IF WK-AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
  9686                                              LOW-VALUES
  9687        MOVE WK-AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
  9688     ELSE
  9689        MOVE 'X' TO AGENT-FIND
  9690        GO TO 6929-EXIT.
  9691
  9692     MOVE +1 TO GX-AGENT-SUB.
  9693
  9694 6921-READ-AXRF.
  9695
  9696* EXEC CICS HANDLE CONDITION
  9697*         ENDFILE     (6925-NOT-FIND)
  9698*         NOTFND      (6925-NOT-FIND)
  9699*    END-EXEC.
  9700*    MOVE '"$''I                  ! 1 #00008799' TO DFHEIV0
  9701     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9703     MOVE X'3120233030303038373939' TO DFHEIV0(25:11)
  9704     CALL 'kxdfhei1' USING DFHEIV0
  9705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9706
  9707
  9708
  9709* EXEC CICS READ
  9710*        DATASET   (ERGXRF-FILE-ID)
  9711*        LENGTH    (ERGXRF-REC-LEN)
  9712*        INTO      (AGENT-CROSS-REFERENCE)
  9713*        RIDFLD    (WS-AXRF-KEY)
  9714*        EQUAL
  9715*    END-EXEC.
  9716*    MOVE '&"IL       E          (   #00008804' TO DFHEIV0
  9717     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 188
* EL6501.cbl
  9718     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9719     MOVE X'2020233030303038383034' TO DFHEIV0(25:11)
  9720     CALL 'kxdfhei1' USING DFHEIV0,
  9721           ERGXRF-FILE-ID,
  9722           AGENT-CROSS-REFERENCE,
  9723           ERGXRF-REC-LEN,
  9724           WS-AXRF-KEY,
  9725           DFHEIV99,
  9726           DFHEIV99,
  9727           DFHEIV99
  9728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9729
  9730
  9731     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
  9732
  9733     PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
  9734             FROM +1 BY +1 UNTIL
  9735         (GX-AGENT-SUB GREATER THAN GX-AGENT-POINTER-CNT) OR
  9736         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT      AND
  9737         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
  9738         AND
  9739         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
  9740         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
  9741         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
  9742         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
  9743
  9744     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
  9745        MOVE 'Y' TO AGENT-FIND
  9746        GO TO 6929-EXIT.
  9747
  9748     IF GX-AM-LEVEL-NO (GX-AGENT-SUB) NOT = AXRF-SUB
  9749        MOVE 'Z' TO AGENT-FIND.
  9750
  9751     GO TO 6929-EXIT.
  9752
  9753 6921-FIND-ACCT-LOOP.
  9754***  DUMMY PARAGRAPH  ***
  9755
  9756 6925-NOT-FIND.
  9757     MOVE 'X' TO AGENT-FIND.
  9758
  9759 6929-EXIT.
  9760     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 189
* EL6501.cbl
  9762 6950-ADD-AGENT-RECORD.
  9763     IF AM-AGT (AXRF-SUB) = SPACES OR ZEROS
  9764        GO TO 6959-EXIT.
  9765
  9766     MOVE +109                   TO ERGXRF-REC-LEN.
  9767
  9768     MOVE +1                     TO GX-AGENT-POINTER-CNT.
  9769     MOVE 'GX'                   TO GX-RECORD-ID.
  9770     MOVE AM-COMPANY-CD          TO GX-COMPANY-CD.
  9771
  9772     IF PI-ZERO-CARRIER
  9773       OR PI-ZERO-CAR-GROUP
  9774         MOVE ZERO               TO GX-CARRIER
  9775     ELSE
  9776         MOVE AM-CARRIER         TO GX-CARRIER.
  9777
  9778     IF PI-ZERO-GROUPING
  9779       OR PI-ZERO-CAR-GROUP
  9780         MOVE ZERO               TO GX-GROUPING
  9781     ELSE
  9782         MOVE AM-GROUPING        TO GX-GROUPING.
  9783
  9784     MOVE AM-AGT (AXRF-SUB)      TO GX-AGENT-NO.
  9785
  9786     MOVE AM-CARRIER             TO GX-AM-CARRIER (1).
  9787     MOVE AM-GROUPING            TO GX-AM-GROUPING (1).
  9788     MOVE AM-STATE               TO GX-AM-STATE (1).
  9789     MOVE AM-ACCOUNT             TO GX-AM-ACCOUNT (1).
  9790     MOVE AM-EXPIRATION-DT       TO GX-AM-EXPIRATION-DT (1).
  9791     MOVE AM-EFFECTIVE-DT        TO GX-AM-EFF-DT (1).
  9792     MOVE AXRF-SUB               TO GX-AM-LEVEL-NO (1).
  9793     MOVE LOW-VALUES             TO GX-LAST-BILL-DT (1).
  9794
  9795     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
  9796     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
  9797     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
  9798
  9799
  9800* EXEC CICS WRITE
  9801*        FROM      (AGENT-CROSS-REFERENCE)
  9802*        LENGTH    (ERGXRF-REC-LEN)
  9803*        RIDFLD    (GX-CONTROL-PRIMARY)
  9804*        DATASET   (ERGXRF-FILE-ID)
  9805*    END-EXEC.
  9806*    MOVE '&$ L                  ''   #00008880' TO DFHEIV0
  9807     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9808     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9809     MOVE X'2020233030303038383830' TO DFHEIV0(25:11)
  9810     CALL 'kxdfhei1' USING DFHEIV0,
  9811           ERGXRF-FILE-ID,
  9812           AGENT-CROSS-REFERENCE,
  9813           ERGXRF-REC-LEN,
  9814           GX-CONTROL-PRIMARY,
  9815           DFHEIV99,
  9816           DFHEIV99
  9817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9818
  9819
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 190
* EL6501.cbl
  9820 6959-EXIT.
  9821      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 191
* EL6501.cbl
  9823 6970-REWRITE-AGENT-RECORD.
  9824     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  9825
  9826
  9827* EXEC CICS READ
  9828*        DATASET   (ERGXRF-FILE-ID)
  9829*        INTO      (AGENT-CROSS-REFERENCE)
  9830*        LENGTH    (ERGXRF-REC-LEN)
  9831*        RIDFLD    (WS-AXRF-KEY)
  9832*        EQUAL
  9833*        UPDATE
  9834*    END-EXEC.
  9835*    MOVE '&"IL       EU         (   #00008893' TO DFHEIV0
  9836     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9837     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9838     MOVE X'2020233030303038383933' TO DFHEIV0(25:11)
  9839     CALL 'kxdfhei1' USING DFHEIV0,
  9840           ERGXRF-FILE-ID,
  9841           AGENT-CROSS-REFERENCE,
  9842           ERGXRF-REC-LEN,
  9843           WS-AXRF-KEY,
  9844           DFHEIV99,
  9845           DFHEIV99,
  9846           DFHEIV99
  9847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9848
  9849
  9850     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
  9851
  9852     IF ACCT-LEVEL-DIFFERENT
  9853        GO TO 6975-UPDATE-LEVEL-NO.
  9854
  9855     IF GX-AGENT-POINTER-CNT = +1006
  9856         GO TO 6979-EXIT.
  9857
  9858     MOVE +1 TO FIND-AGENT-SUB1.
  9859
  9860 6972-FIND-REC-LOCATION.
  9861     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO GX-REST-OF-KEY.
  9862     MOVE AM-COMPANY-CD TO GX-AM-COMPANY-CD.
  9863
  9864     IF (GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY)  OR
  9865        (FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT)
  9866        NEXT SENTENCE
  9867     ELSE
  9868        ADD +1 TO FIND-AGENT-SUB1
  9869        GO TO 6972-FIND-REC-LOCATION.
  9870
  9871     MOVE GX-AGENT-POINTER-CNT TO FIND-AGENT-SUB2
  9872                                  FIND-AGENT-SUB3.
  9873     ADD +1 TO FIND-AGENT-SUB3.
  9874
  9875     IF FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT
  9876        NEXT SENTENCE
  9877     ELSE
  9878        PERFORM 6977-BUMP-AXRF-REC VARYING FIND-AGENT-SUB2
  9879        FROM FIND-AGENT-SUB2 BY -1 UNTIL
  9880        FIND-AGENT-SUB3 = FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 192
* EL6501.cbl
  9881
  9882     ADD ERGXRF-INC-LEN          TO ERGXRF-REC-LEN.
  9883     ADD  +1                     TO GX-AGENT-POINTER-CNT.
  9884
  9885     MOVE AM-CARRIER  TO GX-AM-CARRIER (FIND-AGENT-SUB3).
  9886     MOVE AM-GROUPING TO GX-AM-GROUPING (FIND-AGENT-SUB3).
  9887
  9888     MOVE AM-STATE    TO GX-AM-STATE (FIND-AGENT-SUB3).
  9889     MOVE AM-ACCOUNT  TO GX-AM-ACCOUNT (FIND-AGENT-SUB3).
  9890     MOVE AM-EXPIRATION-DT TO
  9891                  GX-AM-EXPIRATION-DT (FIND-AGENT-SUB3).
  9892     MOVE AM-EFFECTIVE-DT  TO
  9893                  GX-AM-EFF-DT (FIND-AGENT-SUB3).
  9894     MOVE AXRF-SUB    TO GX-AM-LEVEL-NO (FIND-AGENT-SUB3).
  9895     MOVE LOW-VALUES  TO GX-LAST-BILL-DT (FIND-AGENT-SUB3).
  9896
  9897 6975-UPDATE-LEVEL-NO.
  9898     MOVE AXRF-SUB TO GX-AM-LEVEL-NO (GX-AGENT-SUB).
  9899     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
  9900     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
  9901     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
  9902     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
  9903     if ergxrf-rec-len > +31264
  9904        move +31264               to ergxrf-rec-len
  9905        move +1006                to gx-agent-pointer-cnt
  9906     end-if
  9907
  9908
  9909* EXEC CICS REWRITE
  9910*        FROM      (AGENT-CROSS-REFERENCE)
  9911*        LENGTH    (ERGXRF-REC-LEN)
  9912*        DATASET   (ERGXRF-FILE-ID)
  9913*    END-EXEC.
  9914*    MOVE '&& L                  %   #00008960' TO DFHEIV0
  9915     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9916     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9917     MOVE X'2020233030303038393630' TO DFHEIV0(25:11)
  9918     CALL 'kxdfhei1' USING DFHEIV0,
  9919           ERGXRF-FILE-ID,
  9920           AGENT-CROSS-REFERENCE,
  9921           ERGXRF-REC-LEN,
  9922           DFHEIV99
  9923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9924
  9925
  9926     GO TO 6979-EXIT.
  9927
  9928 6977-BUMP-AXRF-REC.
  9929     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB2) TO
  9930          GX-AGENT-POINTER (FIND-AGENT-SUB3).
  9931
  9932     SUBTRACT +1 FROM FIND-AGENT-SUB3.
  9933
  9934 6979-EXIT.
  9935     EXIT.
  9936
  9937 6999-EXIT.
  9938     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 193
* EL6501.cbl
  9940 7000-DELETE-AXRF-REC.
  9941     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  9942
  9943
  9944* EXEC CICS HANDLE CONDITION
  9945*         ENDFILE     (7999-EXIT)
  9946*         NOTFND      (7999-EXIT)
  9947*    END-EXEC.
  9948*    MOVE '"$''I                  ! 2 #00008983' TO DFHEIV0
  9949     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9950     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9951     MOVE X'3220233030303038393833' TO DFHEIV0(25:11)
  9952     CALL 'kxdfhei1' USING DFHEIV0
  9953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9954
  9955
  9956
  9957* EXEC CICS READ
  9958*        DATASET   (ERGXRF-FILE-ID)
  9959*        INTO      (AGENT-CROSS-REFERENCE)
  9960*        LENGTH    (ERGXRF-REC-LEN)
  9961*        RIDFLD    (WS-AXRF-KEY)
  9962*        EQUAL
  9963*        UPDATE
  9964*    END-EXEC.
  9965*    MOVE '&"IL       EU         (   #00008988' TO DFHEIV0
  9966     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9967     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9968     MOVE X'2020233030303038393838' TO DFHEIV0(25:11)
  9969     CALL 'kxdfhei1' USING DFHEIV0,
  9970           ERGXRF-FILE-ID,
  9971           AGENT-CROSS-REFERENCE,
  9972           ERGXRF-REC-LEN,
  9973           WS-AXRF-KEY,
  9974           DFHEIV99,
  9975           DFHEIV99,
  9976           DFHEIV99
  9977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9978
  9979
  9980     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
  9981
  9982     IF GX-AGENT-SUB = +0
  9983        PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
  9984        FROM +1 BY +1 UNTIL
  9985         (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT) OR
  9986         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT  AND
  9987         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
  9988         AND
  9989         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
  9990         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
  9991         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
  9992         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
  9993
  9994     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
  9995        GO TO 7999-EXIT.
  9996
  9997     MOVE GX-AGENT-SUB TO FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 194
* EL6501.cbl
  9998     PERFORM 7010-BUMP-RECORDS VARYING GX-AGENT-SUB
  9999                                  FROM GX-AGENT-SUB BY +1 UNTIL
 10000                            GX-AGENT-SUB = GX-AGENT-POINTER-CNT.
 10001     SUBTRACT ERGXRF-INC-LEN FROM ERGXRF-REC-LEN.
 10002     SUBTRACT +1             FROM GX-AGENT-POINTER-CNT.
 10003     GO TO 7020-REWRITE-AXRF-RECORD.
 10004
 10005 7010-BUMP-RECORDS.
 10006     ADD +1 TO FIND-AGENT-SUB1.
 10007     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO
 10008          GX-AGENT-POINTER (GX-AGENT-SUB).
 10009
 10010 7020-REWRITE-AXRF-RECORD.
 10011     IF GX-AGENT-POINTER-CNT = +0
 10012
 10013* EXEC CICS DELETE
 10014*            DATASET   (ERGXRF-FILE-ID)
 10015*       END-EXEC
 10016*    MOVE '&(                    &   #00009029' TO DFHEIV0
 10017     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10018     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10019     MOVE X'2020233030303039303239' TO DFHEIV0(25:11)
 10020     CALL 'kxdfhei1' USING DFHEIV0,
 10021           ERGXRF-FILE-ID,
 10022           DFHEIV99,
 10023           DFHEIV99,
 10024           DFHEIV99,
 10025           DFHEIV99
 10026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10027     ELSE
 10028        MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT
 10029        MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS
 10030        MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER
 10031        compute ergxrf-rec-len =
 10032            (gx-agent-pointer-cnt * +31) + +78
 10033        if ergxrf-rec-len > +31264
 10034           move +31264               to ergxrf-rec-len
 10035           move +1006                to gx-agent-pointer-cnt
 10036        end-if
 10037
 10038* EXEC CICS REWRITE
 10039*            FROM      (AGENT-CROSS-REFERENCE)
 10040*            LENGTH    (ERGXRF-REC-LEN)
 10041*            DATASET   (ERGXRF-FILE-ID)
 10042*       END-EXEC.
 10043*    MOVE '&& L                  %   #00009042' TO DFHEIV0
 10044     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10045     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10046     MOVE X'2020233030303039303432' TO DFHEIV0(25:11)
 10047     CALL 'kxdfhei1' USING DFHEIV0,
 10048           ERGXRF-FILE-ID,
 10049           AGENT-CROSS-REFERENCE,
 10050           ERGXRF-REC-LEN,
 10051           DFHEIV99
 10052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10053
 10054
 10055 7999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 195
* EL6501.cbl
 10056     EXIT.
 10057
 10058*************************************
 10059 8000-STATE-REC-READ.
 10060     MOVE SPACES                 TO ELCNTL-KEY.
 10061     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10062     MOVE '3'                    TO CNTL-REC-TYPE.
 10063     MOVE PI-ACCT-STATE          TO CNTL-ACCESS.
 10064     MOVE +0                     TO CNTL-SEQ-NO.
 10065
 10066* EXEC CICS HANDLE CONDITION
 10067*        NOTFND  (8010-EXIT)
 10068*    END-EXEC.
 10069*    MOVE '"$I                   ! 3 #00009058' TO DFHEIV0
 10070     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10071     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10072     MOVE X'3320233030303039303538' TO DFHEIV0(25:11)
 10073     CALL 'kxdfhei1' USING DFHEIV0
 10074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10075
 10076
 10077
 10078* EXEC CICS READ
 10079*        DATASET   (CNTL-FILE-ID)
 10080*        SET       (ADDRESS OF CONTROL-FILE)
 10081*        RIDFLD    (ELCNTL-KEY)
 10082*    END-EXEC.
 10083*    MOVE '&"S        E          (   #00009062' TO DFHEIV0
 10084     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10085     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10086     MOVE X'2020233030303039303632' TO DFHEIV0(25:11)
 10087     CALL 'kxdfhei1' USING DFHEIV0,
 10088           CNTL-FILE-ID,
 10089           DFHEIV20,
 10090           DFHEIV99,
 10091           ELCNTL-KEY,
 10092           DFHEIV99,
 10093           DFHEIV99,
 10094           DFHEIV99
 10095     SET ADDRESS OF CONTROL-FILE TO
 10096         DFHEIV20
 10097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10098
 10099
 10100     MOVE CF-ST-COMMISSION-CAPS   TO WS-ST-COMMISSION-CAPS.
 10101     MOVE CF-COMM-CAP-LIMIT-TO    TO WS-COMM-CAP-LIMIT-TO.
 10102
 10103 8010-EXIT.
 10104      EXIT.
 10105
 10106 8050-USER-REC-READ.
 10107     MOVE SPACES                 TO ELCNTL-KEY.
 10108     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10109     MOVE '2'                    TO CNTL-REC-TYPE.
 10110     MOVE CSRI                   TO CNTL-ACCESS.
 10111     MOVE +0                     TO CNTL-SEQ-NO.
 10112
 10113* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 196
* EL6501.cbl
 10114*        NOTFND  (8055-NOTFND)
 10115*    END-EXEC.
 10116*    MOVE '"$I                   ! 4 #00009080' TO DFHEIV0
 10117     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10118     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10119     MOVE X'3420233030303039303830' TO DFHEIV0(25:11)
 10120     CALL 'kxdfhei1' USING DFHEIV0
 10121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10122
 10123
 10124
 10125* EXEC CICS READ
 10126*        DATASET   (CNTL-FILE-ID)
 10127*        SET       (ADDRESS OF CONTROL-FILE)
 10128*        RIDFLD    (ELCNTL-KEY)
 10129*    END-EXEC.
 10130*    MOVE '&"S        E          (   #00009084' TO DFHEIV0
 10131     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10132     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10133     MOVE X'2020233030303039303834' TO DFHEIV0(25:11)
 10134     CALL 'kxdfhei1' USING DFHEIV0,
 10135           CNTL-FILE-ID,
 10136           DFHEIV20,
 10137           DFHEIV99,
 10138           ELCNTL-KEY,
 10139           DFHEIV99,
 10140           DFHEIV99,
 10141           DFHEIV99
 10142     SET ADDRESS OF CONTROL-FILE TO
 10143         DFHEIV20
 10144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10145
 10146
 10147     GO TO 8060-EXIT.
 10148
 10149 8055-NOTFND.
 10150     MOVE ER-1883             TO EMI-ERROR.
 10151     MOVE -1                  TO CSRL.
 10152     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10153
 10154 8060-EXIT.
 10155      EXIT.
 10156
 10157*************************************
 10158
 10159 8100-SEND-INITIAL-MAP.
 10160     MOVE SAVE-DATE              TO DATEO.
 10161     MOVE EIBTIME                TO TIME-IN.
 10162     MOVE TIME-OUT               TO TIMEO.
 10163     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10164     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10165     MOVE -1                     TO PFENTERL.
 10166     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10167
 10168     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10169
 10170     IF PI-COMPANY-ID = 'HAN' OR 'LGX' OR 'BNE'
 10171        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 197
* EL6501.cbl
 10172     ELSE
 10173        MOVE AL-SADOF            TO PSIHEADA
 10174                                    PSILFTA
 10175                                    PSILFCA
 10176                                    PSIAHTA
 10177                                    PSIAHCA
 10178                                    PSILFFA
 10179                                    PSIAHFA.
 10180
 10181     IF PI-COMPANY-ID = 'DCC'
 10182        CONTINUE
 10183     ELSE
 10184        MOVE AL-SADOF            TO CTPLABLA
 10185                                    CLPTOLPA
 10186                                    LCLABLA
 10187                                    LCOMMA
 10188     END-IF
 10189     IF PI-COMPANY-ID = 'NCL' OR 'LGX'
 10190        MOVE -1                  TO CSRL.
 10191
 10192     IF  CLAIM-SESSION
 10193         MOVE SPACES             TO PF1PF2O
 10194         MOVE AL-SANOF           TO PF1PF2A.
 10195
 10196
 10197* EXEC CICS SEND
 10198*        MAP      (MAP-NAME)
 10199*        MAPSET   (MAPSET-NAME)
 10200*        FROM     (EL6501AO)
 10201*        ERASE
 10202*        CURSOR
 10203*    END-EXEC.
 10204     MOVE LENGTH OF
 10205      EL6501AO
 10206       TO DFHEIV12
 10207     MOVE -1
 10208       TO DFHEIV11
 10209*    MOVE '8$     CT  E    H L F ,   #00009139' TO DFHEIV0
 10210     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10211     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10212     MOVE X'2020233030303039313339' TO DFHEIV0(25:11)
 10213     CALL 'kxdfhei1' USING DFHEIV0,
 10214           MAP-NAME,
 10215           EL6501AO,
 10216           DFHEIV12,
 10217           MAPSET-NAME,
 10218           DFHEIV99,
 10219           DFHEIV99,
 10220           DFHEIV99,
 10221           DFHEIV11,
 10222           DFHEIV99,
 10223           DFHEIV99,
 10224           DFHEIV99
 10225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10226
 10227
 10228     GO TO 9100-RETURN-TRAN.
 10229
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 198
* EL6501.cbl
 10230 8200-SEND-DATAONLY.
 10231     MOVE SAVE-DATE              TO DATEO.
 10232     MOVE EIBTIME                TO TIME-IN.
 10233     MOVE TIME-OUT               TO TIMEO.
 10234     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10235     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10236     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10237
 10238     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10239
 10240     IF PI-COMPANY-ID = 'DCC'
 10241        CONTINUE
 10242     ELSE
 10243        MOVE AL-SADOF            TO CTPLABLA
 10244                                    CLPTOLPA
 10245                                    LCLABLA
 10246                                    LCOMMA
 10247     END-IF
 10248     IF  CLAIM-SESSION
 10249         MOVE SPACES             TO PF1PF2O
 10250         MOVE AL-SANOF           TO PF1PF2A.
 10251
 10252
 10253* EXEC CICS SEND
 10254*        MAP      (MAP-NAME)
 10255*        MAPSET   (MAPSET-NAME)
 10256*        FROM     (EL6501AO)
 10257*        DATAONLY
 10258*        CURSOR
 10259*    END-EXEC.
 10260     MOVE LENGTH OF
 10261      EL6501AO
 10262       TO DFHEIV12
 10263     MOVE -1
 10264       TO DFHEIV11
 10265*    MOVE '8$D    CT       H L F ,   #00009171' TO DFHEIV0
 10266     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10267     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10268     MOVE X'2020233030303039313731' TO DFHEIV0(25:11)
 10269     CALL 'kxdfhei1' USING DFHEIV0,
 10270           MAP-NAME,
 10271           EL6501AO,
 10272           DFHEIV12,
 10273           MAPSET-NAME,
 10274           DFHEIV99,
 10275           DFHEIV99,
 10276           DFHEIV99,
 10277           DFHEIV11,
 10278           DFHEIV99,
 10279           DFHEIV99,
 10280           DFHEIV99
 10281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10282
 10283
 10284     GO TO 9100-RETURN-TRAN.
 10285
 10286 8300-SEND-TEXT.
 10287
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 199
* EL6501.cbl
 10288* EXEC CICS SEND TEXT
 10289*        FROM     (LOGOFF-TEXT)
 10290*        LENGTH   (LOGOFF-LENGTH)
 10291*        ERASE
 10292*        FREEKB
 10293*    END-EXEC.
 10294*    MOVE '8&      T  E F  H   F -   #00009182' TO DFHEIV0
 10295     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10296     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10297     MOVE X'2020233030303039313832' TO DFHEIV0(25:11)
 10298     CALL 'kxdfhei1' USING DFHEIV0,
 10299           LOGOFF-TEXT,
 10300           LOGOFF-LENGTH,
 10301           DFHEIV99,
 10302           DFHEIV99,
 10303           DFHEIV99,
 10304           DFHEIV99,
 10305           DFHEIV99,
 10306           DFHEIV99,
 10307           DFHEIV99,
 10308           DFHEIV99,
 10309           DFHEIV99,
 10310           DFHEIV99
 10311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10312
 10313
 10314
 10315* EXEC CICS RETURN
 10316*    END-EXEC.
 10317*    MOVE '.(                    &   #00009189' TO DFHEIV0
 10318     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10319     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10320     MOVE X'2020233030303039313839' TO DFHEIV0(25:11)
 10321     CALL 'kxdfhei1' USING DFHEIV0,
 10322           DFHEIV99,
 10323           DFHEIV99,
 10324           DFHEIV99,
 10325           DFHEIV99,
 10326           DFHEIV99
 10327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10328
 10329
 10330 8600-DEEDIT.
 10331
 10332* EXEC CICS BIF DEEDIT
 10333*         FIELD(DEEDIT-FIELD)
 10334*         LENGTH(15)
 10335*     END-EXEC.
 10336     MOVE 15
 10337       TO DFHEIV11
 10338*    MOVE '@"L                   #   #00009193' TO DFHEIV0
 10339     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10340     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10341     MOVE X'2020233030303039313933' TO DFHEIV0(25:11)
 10342     CALL 'kxdfhei1' USING DFHEIV0,
 10343           DEEDIT-FIELD,
 10344           DFHEIV11
 10345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 200
* EL6501.cbl
 10346
 10347
 10348 8800-UNAUTHORIZED-ACCESS.
 10349     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10350     GO TO 8300-SEND-TEXT.
 10351
 10352 8810-PF23.
 10353     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10354     MOVE XCTL-005               TO PGM-NAME.
 10355     GO TO 9300-XCTL.
 10356
 10357 9100-RETURN-TRAN.
 10358     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10359     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10360
 10361* EXEC CICS RETURN
 10362*        TRANSID    (TRANS-ID)
 10363*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10364*        LENGTH     (WS-COMM-LENGTH)
 10365*    END-EXEC.
 10366*    MOVE '.(CT                  &   #00009210' TO DFHEIV0
 10367     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10368     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10369     MOVE X'2020233030303039323130' TO DFHEIV0(25:11)
 10370     CALL 'kxdfhei1' USING DFHEIV0,
 10371           TRANS-ID,
 10372           PROGRAM-INTERFACE-BLOCK,
 10373           WS-COMM-LENGTH,
 10374           DFHEIV99,
 10375           DFHEIV99
 10376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10377
 10378
 10379 9200-RETURN-MAIN-MENU.
 10380     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10381         MOVE XCTL-126           TO  PGM-NAME
 10382     ELSE
 10383         MOVE XCTL-626           TO  PGM-NAME.
 10384
 10385     GO TO 9300-XCTL.
 10386
 10387 9300-XCTL.
 10388
 10389* EXEC CICS XCTL
 10390*        PROGRAM    (PGM-NAME)
 10391*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10392*        LENGTH     (WS-COMM-LENGTH)
 10393*    END-EXEC.
 10394*    MOVE '.$C                   $   #00009225' TO DFHEIV0
 10395     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10396     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10397     MOVE X'2020233030303039323235' TO DFHEIV0(25:11)
 10398     CALL 'kxdfhei1' USING DFHEIV0,
 10399           PGM-NAME,
 10400           PROGRAM-INTERFACE-BLOCK,
 10401           WS-COMM-LENGTH
 10402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10403
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 201
* EL6501.cbl
 10404
 10405 9400-CLEAR.
 10406     IF PI-GA-BILLING
 10407        IF GETMAIN-ACQUIRED
 10408           MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
 10409           SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR
 10410
 10411* EXEC CICS FREEMAIN
 10412*               DATA     (COMMISSION-WORK-AREA)
 10413*          END-EXEC.
 10414*    MOVE ',$D                   "   #00009236' TO DFHEIV0
 10415     MOVE X'2C2444202020202020202020' TO DFHEIV0(1:12)
 10416     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 10417     MOVE X'2020233030303039323336' TO DFHEIV0(25:11)
 10418     CALL 'kxdfhei1' USING DFHEIV0,
 10419           COMMISSION-WORK-AREA
 10420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10421
 10422
 10423     MOVE SPACES                 TO PI-SV-MAINT.
 10424     MOVE XCTL-650               TO PGM-NAME.
 10425     MOVE XCTL-650               TO PI-RETURN-TO-PROGRAM.
 10426     GO TO 9300-XCTL.
 10427
 10428 9500-PF12.
 10429     MOVE XCTL-010               TO PGM-NAME.
 10430     GO TO 9300-XCTL.
 10431
 10432 9600-PGMID-ERROR.
 10433
 10434* EXEC CICS HANDLE CONDITION
 10435*        PGMIDERR    (8300-SEND-TEXT)
 10436*    END-EXEC.
 10437*    MOVE '"$L                   ! 5 #00009250' TO DFHEIV0
 10438     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10439     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10440     MOVE X'3520233030303039323530' TO DFHEIV0(25:11)
 10441     CALL 'kxdfhei1' USING DFHEIV0
 10442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10443
 10444
 10445     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10446     MOVE ' '                    TO PI-ENTRY-CD-1.
 10447     MOVE XCTL-005               TO PGM-NAME.
 10448     MOVE PGM-NAME               TO LOGOFF-PGM.
 10449     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10450     GO TO 9300-XCTL.
 10451
 10452 9700-DATE-LINK.
 10453     MOVE LINK-ELDATCV           TO PGM-NAME.
 10454
 10455* EXEC CICS LINK
 10456*        PROGRAM    (PGM-NAME)
 10457*        COMMAREA   (DATE-CONVERSION-DATA)
 10458*        LENGTH     (DC-COMM-LENGTH)
 10459*    END-EXEC.
 10460*    MOVE '."C                   ''   #00009263' TO DFHEIV0
 10461     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 202
* EL6501.cbl
 10462     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10463     MOVE X'2020233030303039323633' TO DFHEIV0(25:11)
 10464     CALL 'kxdfhei1' USING DFHEIV0,
 10465           PGM-NAME,
 10466           DATE-CONVERSION-DATA,
 10467           DC-COMM-LENGTH,
 10468           DFHEIV99,
 10469           DFHEIV99,
 10470           DFHEIV99
 10471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10472
 10473
 10474 9900-ERROR-FORMAT.
 10475     IF NOT EMI-ERRORS-COMPLETE
 10476         MOVE LINK-001           TO PGM-NAME
 10477
 10478* EXEC CICS LINK
 10479*            PROGRAM    (PGM-NAME)
 10480*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10481*            LENGTH     (EMI-COMM-LENGTH)
 10482*        END-EXEC.
 10483*    MOVE '."C                   ''   #00009272' TO DFHEIV0
 10484     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10485     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10486     MOVE X'2020233030303039323732' TO DFHEIV0(25:11)
 10487     CALL 'kxdfhei1' USING DFHEIV0,
 10488           PGM-NAME,
 10489           ERROR-MESSAGE-INTERFACE-BLOCK,
 10490           EMI-COMM-LENGTH,
 10491           DFHEIV99,
 10492           DFHEIV99,
 10493           DFHEIV99
 10494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10495
 10496
 10497 9900-EXIT.
 10498     EXIT.
 10499
 10500 9990-ABEND.
 10501     MOVE LINK-004               TO PGM-NAME.
 10502     MOVE DFHEIBLK               TO EMI-LINE1.
 10503
 10504* EXEC CICS LINK
 10505*        PROGRAM   (PGM-NAME)
 10506*        COMMAREA  (EMI-LINE1)
 10507*        LENGTH    (72)
 10508*    END-EXEC.
 10509     MOVE 72
 10510       TO DFHEIV11
 10511*    MOVE '."C                   ''   #00009284' TO DFHEIV0
 10512     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10513     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10514     MOVE X'2020233030303039323834' TO DFHEIV0(25:11)
 10515     CALL 'kxdfhei1' USING DFHEIV0,
 10516           PGM-NAME,
 10517           EMI-LINE1,
 10518           DFHEIV11,
 10519           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 203
* EL6501.cbl
 10520           DFHEIV99,
 10521           DFHEIV99
 10522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10523
 10524
 10525     MOVE -1                     TO PFENTERL.
 10526     GO TO 8200-SEND-DATAONLY.
 10527
 10528
 10529* GOBACK.
 10530     MOVE '9%                    "   ' TO DFHEIV0
 10531     MOVE 'EL6501' TO DFHEIV1
 10532     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10533     GOBACK.
 10534
 10535 9995-SECURITY-VIOLATION.
 10536*                            COPY ELCSCTP.
 10537******************************************************************
 10538*                                                                *
 10539*                            ELCSCTP                             *
 10540*                            VMOD=2.001                          *
 10541*                                                                *
 10542*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10543******************************************************************
 10544
 10545
 10546     MOVE EIBDATE          TO SM-JUL-DATE.
 10547     MOVE EIBTRMID         TO SM-TERMID.
 10548     MOVE THIS-PGM         TO SM-PGM.
 10549     MOVE EIBTIME          TO TIME-IN.
 10550     MOVE TIME-OUT         TO SM-TIME.
 10551     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10552
 10553
 10554* EXEC CICS LINK
 10555*         PROGRAM  ('EL003')
 10556*         COMMAREA (SECURITY-MESSAGE)
 10557*         LENGTH   (80)
 10558*    END-EXEC.
 10559     MOVE 'EL003' TO DFHEIV1
 10560     MOVE 80
 10561       TO DFHEIV11
 10562*    MOVE '."C                   ''   #00009313' TO DFHEIV0
 10563     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10564     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10565     MOVE X'2020233030303039333133' TO DFHEIV0(25:11)
 10566     CALL 'kxdfhei1' USING DFHEIV0,
 10567           DFHEIV1,
 10568           SECURITY-MESSAGE,
 10569           DFHEIV11,
 10570           DFHEIV99,
 10571           DFHEIV99,
 10572           DFHEIV99
 10573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10574
 10575
 10576******************************************************************
 10577
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 204
* EL6501.cbl
 10578
 10579 9995-EXIT.
 10580     EXIT.
 10581
 10582 9999-DFHBACK SECTION.
 10583     MOVE '9%                    "   ' TO DFHEIV0
 10584     MOVE 'EL6501' TO DFHEIV1
 10585     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10586     GOBACK.
 10587 9999-DFHEXIT.
 10588     IF DFHEIGDJ EQUAL 0001
 10589         NEXT SENTENCE
 10590     ELSE IF DFHEIGDJ EQUAL 2
 10591         GO TO 9600-PGMID-ERROR,
 10592               9990-ABEND,
 10593               0500-CHECK-MAINT-TYPE
 10594         DEPENDING ON DFHEIGDI
 10595     ELSE IF DFHEIGDJ EQUAL 3
 10596         GO TO 1500-EXIT
 10597         DEPENDING ON DFHEIGDI
 10598     ELSE IF DFHEIGDJ EQUAL 4
 10599         GO TO 1799-EXIT,
 10600               1799-EXIT
 10601         DEPENDING ON DFHEIGDI
 10602     ELSE IF DFHEIGDJ EQUAL 5
 10603         GO TO 2100-EXIT
 10604         DEPENDING ON DFHEIGDI
 10605     ELSE IF DFHEIGDJ EQUAL 6
 10606         GO TO 2200-EXIT
 10607         DEPENDING ON DFHEIGDI
 10608     ELSE IF DFHEIGDJ EQUAL 7
 10609         GO TO 3030-END-FILE
 10610         DEPENDING ON DFHEIGDI
 10611     ELSE IF DFHEIGDJ EQUAL 8
 10612         GO TO 3530-END-FILE
 10613         DEPENDING ON DFHEIGDI
 10614     ELSE IF DFHEIGDJ EQUAL 9
 10615         GO TO 4020-BUS-TYPE-ERROR
 10616         DEPENDING ON DFHEIGDI
 10617     ELSE IF DFHEIGDJ EQUAL 10
 10618         GO TO 4099-STD-BEN-ERROR
 10619         DEPENDING ON DFHEIGDI
 10620     ELSE IF DFHEIGDJ EQUAL 11
 10621         GO TO 4180-REIN-ERROR
 10622         DEPENDING ON DFHEIGDI
 10623     ELSE IF DFHEIGDJ EQUAL 12
 10624         GO TO 5250-QID-ERROR
 10625         DEPENDING ON DFHEIGDI
 10626     ELSE IF DFHEIGDJ EQUAL 13
 10627         GO TO 5399-EXIT,
 10628               5399-EXIT
 10629         DEPENDING ON DFHEIGDI
 10630     ELSE IF DFHEIGDJ EQUAL 14
 10631         GO TO 6450-NOT-FOUND
 10632         DEPENDING ON DFHEIGDI
 10633     ELSE IF DFHEIGDJ EQUAL 15
 10634         GO TO 6699-EXIT
 10635         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 205
* EL6501.cbl
 10636     ELSE IF DFHEIGDJ EQUAL 16
 10637         GO TO 6880-NO-COMP
 10638         DEPENDING ON DFHEIGDI
 10639     ELSE IF DFHEIGDJ EQUAL 17
 10640         GO TO 6925-NOT-FIND,
 10641               6925-NOT-FIND
 10642         DEPENDING ON DFHEIGDI
 10643     ELSE IF DFHEIGDJ EQUAL 18
 10644         GO TO 7999-EXIT,
 10645               7999-EXIT
 10646         DEPENDING ON DFHEIGDI
 10647     ELSE IF DFHEIGDJ EQUAL 19
 10648         GO TO 8010-EXIT
 10649         DEPENDING ON DFHEIGDI
 10650     ELSE IF DFHEIGDJ EQUAL 20
 10651         GO TO 8055-NOTFND
 10652         DEPENDING ON DFHEIGDI
 10653     ELSE IF DFHEIGDJ EQUAL 21
 10654         GO TO 8300-SEND-TEXT
 10655         DEPENDING ON DFHEIGDI.
 10656     MOVE '9%                    "   ' TO DFHEIV0
 10657     MOVE 'EL6501' TO DFHEIV1
 10658     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10659     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       39248     Code:       34534
