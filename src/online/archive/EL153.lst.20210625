* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page   1
* EL153.cbl
* Options: int("EL153.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL153.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL153.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL153.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL153 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/20/94 09:17:09.
     7*                            VMOD=2.019
     8*
     9*
    10*AUTHOR.    LOGIC, INC.
    11*           DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page   2
* EL153.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*    SCREENS     - EL153S - NOTES AND REMINDERS
    27
    28*    ENTERED BY  - EL150 - STATUS AND DISPOSITION
    29
    30*    EXIT TO     - EL150 - CALLING PROGRAM
    31
    32*    INPUT FILE  - ELMSTR - CLAIM MASTER
    33*                - ELTRLR - ACTIVITY TRAILERS
    34
    35*    OUTPUT FILE - ELMSTR - CLAIM MASTER
    36*                - ELTRLR - ACTIVITY TRAILERS
    37
    38*    COMMAREA    - PASSED CLAIM NUMBER FROM PROG INTERFACE BLK
    39
    40*    ERROR-CODES ACCESSED - 132, 314, 133, 137, 29, 50, 315,
    41*                            316, 317, 08
    42*    NARRATIVE   - PROVIDE CREATION OF AUTO-PROMPT-TRAILER
    43*                  AND GENERAL-INFO-TRAILER
    44*                  IF THE AUTO PROMPT DATE GIVEN  IS LOWER
    45*                  THAN THE NEXT-REMINDER DATE OF THE CLAIM MASTER
    46*                  THIS FIELD IS UPDATED IN THE CLAIM MASTER
    47
    48******************************************************************
    49*                   C H A N G E   L O G
    50*
    51* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    52*-----------------------------------------------------------------
    53*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    54* EFFECTIVE    NUMBER
    55*-----------------------------------------------------------------
    56* 031102    2002022100003  SMVA  ADD CERT# TO EL153A SCREEN HEADER
    57* 062602    2002030700006  PEMA  Add note type of 'S'
    58*                                  (special review)
    59* 080106    2006052500001  AJRA  ADD NOTE TYPE 'N'(NOTE AND FILE)
    60* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    61* 102418  CR2018083000001  TANA  ADD NEW CALL TYPE
    62******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page   3
* EL153.cbl
    64 ENVIRONMENT DIVISION.
    65
    66 DATA DIVISION.
    67
    68 WORKING-STORAGE SECTION.
    69 01  DFH-START PIC X(04).
    70
    71 77  FILLER  PIC X(32)  VALUE '********************************'.
    72 77  FILLER  PIC X(32)  VALUE '*   EL153  WORKING STORAGE     *'.
    73 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.019 *********'.
    74
    75*                                    COPY ELCSCTM.
    76******************************************************************
    77*                                                                *
    78*                                                                *
    79*                            ELCSCTM                             *
    80*                            VMOD=2.001                          *
    81*                                                                *
    82*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    83*                                                                *
    84******************************************************************
    85 01  SECURITY-MESSAGE.
    86     12  FILLER                          PIC X(30)
    87            VALUE '** LOGIC SECURITY VIOLATION -'.
    88     12  SM-READ                         PIC X(6).
    89     12  FILLER                          PIC X(5)
    90            VALUE ' PGM='.
    91     12  SM-PGM                          PIC X(6).
    92     12  FILLER                          PIC X(5)
    93            VALUE ' OPR='.
    94     12  SM-PROCESSOR-ID                 PIC X(4).
    95     12  FILLER                          PIC X(6)
    96            VALUE ' TERM='.
    97     12  SM-TERMID                       PIC X(4).
    98     12  FILLER                          PIC XX   VALUE SPACE.
    99     12  SM-JUL-DATE                     PIC 9(5).
   100     12  FILLER                          PIC X    VALUE SPACE.
   101     12  SM-TIME                         PIC 99.99.
   102
   103
   104*                                    COPY ELCSCRTY.
   105******************************************************************
   106*                                                                *
   107*                                                                *
   108*                            ELCSCRTY                            *
   109*                            VMOD=2.001                          *
   110*                                                                *
   111*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   112*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   113*        SAVED IN PI-SECURITY-ADDRESS.                           *
   114*                                                                *
   115******************************************************************
   116 01  SECURITY-CONTROL.
   117     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   118     12  FILLER                       PIC XX    VALUE 'SC'.
   119     12  SC-CREDIT-CODES.
   120         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   121             20  SC-CREDIT-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page   4
* EL153.cbl
   122             20  SC-CREDIT-UPDATE     PIC X.
   123     12  SC-CLAIMS-CODES.
   124         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   125             20  SC-CLAIMS-DISPLAY    PIC X.
   126             20  SC-CLAIMS-UPDATE     PIC X.
   127
   128 01  WS-DATE-AREA.
   129     12  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   130     12  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   131     12  CURRENT-PLUS3-SAVE          PIC XX      VALUE SPACES.
   132
   133 01  WS-SCRATCH-AREA.
   134     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   135     12  WS-TRLR-LENGTH              PIC S9(4)   VALUE +200  COMP.
   136     12  SC-ITEM                     PIC S9(4)   VALUE +0001 COMP.
   137
   138     12  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   139
   140     12  WS-CURSOR                   PIC S9(4)   VALUE -1    COMP.
   141
   142     12  WS-MAP-NAME                 PIC X(8)    VALUE 'EL153A'.
   143     12  WS-MAPSET-NAME              PIC X(8)    VALUE 'EL153S'.
   144
   145     12  WS-TRANS-ID                 PIC X(4)    VALUE 'EX26'.
   146     12  THIS-PGM                    PIC X(8)    VALUE  'EL153'.
   147
   148     12  TIME-OUT.
   149         16  WS-TRANS-HOUR           PIC XX      VALUE SPACE.
   150         16  FILLER                  PIC X       VALUE '.'.
   151         16  WS-TRANS-MINUTE         PIC XX      VALUE SPACE.
   152
   153     12  WS-DATE-UNEDIT.
   154         16  FILLER                  PIC XX.
   155         16  WS-DATE-MDY.
   156             20  WS-DATE-MM          PIC XX.
   157             20  WS-DATE-DD          PIC XX.
   158             20  WS-DATE-YY          PIC XX.
   159
   160     12  WS-STR-DATE-BIN             PIC XX      VALUE LOW-VALUES.
   161     12  WS-END-DATE-BIN             PIC XX      VALUE LOW-VALUES.
   162
   163     12  SUB                         PIC S99     VALUE ZEROS.
   164     12  SUB-1                       PIC S99     VALUE ZEROS.
   165
   166     12  WS-FIRST-TIME-SW            PIC X       VALUE 'Y'.
   167
   168     12  WS-EDIT-NOTE.
   169         16  WS-EDIT-NOTE-1-4.
   170             20  WS-EDIT-NOTE-1-3    PIC X(3).
   171             20  FILLER              PIC X.
   172         16  FILLER                  PIC X(56).
   173
   174     12  WS-DATE-ERROR-SW            PIC X       VALUE SPACE.
   175         88  DATE-ERROR                          VALUE 'X'.
   176
   177     12  W-NOTE-TYPE                 PIC X       VALUE SPACE.
   178     12  W-CALL-TYPE                 PIC X       VALUE SPACE.
   179     12  W-NOTE-TYPE-IND             PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page   5
* EL153.cbl
   180
   181     12  TIME-IN                     PIC S9(7).
   182     12  WS-TIME  REDEFINES TIME-IN.
   183         16  FILLER                  PIC 9.
   184         16  WS-HOUR                 PIC 99.
   185         16  WS-MINUTE               PIC 99.
   186         16  FILLER                  PIC 99.
   187
   188     12  WS-TRAILER-KEY.
   189         16  WS-CLAIM-KEY.
   190             20  WS-KEY-COMPANY-CD       PIC X.
   191             20  WS-KEY-CARRIER          PIC X.
   192             20  WS-KEY-CLAIM-NO         PIC X(7).
   193             20  WS-KEY-CERT-NO.
   194                 24  WS-KEY-CERT-PRIME   PIC X(10).
   195                 24  WS-KEY-CERT-SFX     PIC X.
   196         16  WS-KEY-SEQUENCE-NO          PIC S9(4) COMP.
   197
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page   6
* EL153.cbl
   199 01  ERROR-MESSAGES.
   200     12  ER-0000                     PIC X(4)    VALUE '0000'.
   201     12  ER-0004                     PIC X(4)    VALUE '0004'.
   202     12  ER-0008                     PIC X(4)    VALUE '0008'.
   203     12  ER-0029                     PIC X(4)    VALUE '0029'.
   204     12  ER-0050                     PIC X(4)    VALUE '0050'.
   205     12  ER-0070                     PIC X(4)    VALUE '0070'.
   206     12  ER-0132                     PIC X(4)    VALUE '0132'.
   207     12  ER-0133                     PIC X(4)    VALUE '0133'.
   208     12  ER-0137                     PIC X(4)    VALUE '0137'.
   209     12  ER-0154                     PIC X(4)    VALUE '0154'.
   210     12  ER-0172                     PIC X(4)    VALUE '0172'.
   211     12  ER-0314                     PIC X(4)    VALUE '0314'.
   212     12  ER-0316                     PIC X(4)    VALUE '0316'.
   213     12  ER-0317                     PIC X(4)    VALUE '0317'.
   214     12  ER-0483                     PIC X(4)    VALUE '0483'.
   215     12  ER-0694                     PIC X(4)    VALUE '0694'.
   216     12  ER-0914                     PIC X(4)    VALUE '0914'.
   217     12  ER-0915                     PIC X(4)    VALUE '0915'.
   218     12  ER-0916                     PIC X(4)    VALUE '0916'.
   219     12  ER-0917                     PIC X(4)    VALUE '0917'.
   220     12  ER-0924                     PIC X(4)    VALUE '0924'.
   221     12  ER-7840                     PIC X(4)    VALUE '7840'.
   222     12  ER-7846                     PIC X(4)    VALUE '7846'.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page   7
* EL153.cbl
   224*                                    COPY ELCAID.
   225******************************************************************
   226*                                                                *
   227*                            ELCAID.                             *
   228*                            VMOD=2.001                          *
   229*                                                                *
   230*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   231*                                                                *
   232*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   233*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   234******************************************************************
   235
   236 01  DFHAID.
   237   02  DFHNULL   PIC  X  VALUE  ' '.
   238   02  DFHENTER  PIC  X  VALUE  QUOTE.
   239   02  DFHCLEAR  PIC  X  VALUE  '_'.
   240   02  DFHPEN    PIC  X  VALUE  '='.
   241   02  DFHOPID   PIC  X  VALUE  'W'.
   242   02  DFHPA1    PIC  X  VALUE  '%'.
   243   02  DFHPA2    PIC  X  VALUE  '>'.
   244   02  DFHPA3    PIC  X  VALUE  ','.
   245   02  DFHPF1    PIC  X  VALUE  '1'.
   246   02  DFHPF2    PIC  X  VALUE  '2'.
   247   02  DFHPF3    PIC  X  VALUE  '3'.
   248   02  DFHPF4    PIC  X  VALUE  '4'.
   249   02  DFHPF5    PIC  X  VALUE  '5'.
   250   02  DFHPF6    PIC  X  VALUE  '6'.
   251   02  DFHPF7    PIC  X  VALUE  '7'.
   252   02  DFHPF8    PIC  X  VALUE  '8'.
   253   02  DFHPF9    PIC  X  VALUE  '9'.
   254   02  DFHPF10   PIC  X  VALUE  ':'.
   255   02  DFHPF11   PIC  X  VALUE  '#'.
   256   02  DFHPF12   PIC  X  VALUE  '@'.
   257   02  DFHPF13   PIC  X  VALUE  'A'.
   258   02  DFHPF14   PIC  X  VALUE  'B'.
   259   02  DFHPF15   PIC  X  VALUE  'C'.
   260   02  DFHPF16   PIC  X  VALUE  'D'.
   261   02  DFHPF17   PIC  X  VALUE  'E'.
   262   02  DFHPF18   PIC  X  VALUE  'F'.
   263   02  DFHPF19   PIC  X  VALUE  'G'.
   264   02  DFHPF20   PIC  X  VALUE  'H'.
   265   02  DFHPF21   PIC  X  VALUE  'I'.
   266*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   267   02  DFHPF22   PIC  X  VALUE  '['.
   268   02  DFHPF23   PIC  X  VALUE  '.'.
   269   02  DFHPF24   PIC  X  VALUE  '<'.
   270   02  DFHMSRE   PIC  X  VALUE  'X'.
   271   02  DFHSTRF   PIC  X  VALUE  'h'.
   272   02  DFHTRIG   PIC  X  VALUE  '"'.
   273 01  PF-AID REDEFINES DFHAID.
   274     05  FILLER                      PIC X(8).
   275     05  PF-VALUES  OCCURS 24        PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page   8
* EL153.cbl
   277*                                    COPY ELCINTF.
   278******************************************************************
   279*                                                                *
   280*                                                                *
   281*                            ELCINTF.                            *
   282*                            VMOD=2.017                          *
   283*                                                                *
   284*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   285*                                                                *
   286*       LENGTH = 1024                                            *
   287*                                                                *
   288******************************************************************
   289*                   C H A N G E   L O G
   290*
   291* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   292*-----------------------------------------------------------------
   293*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   294* EFFECTIVE    NUMBER
   295*-----------------------------------------------------------------
   296* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   297******************************************************************
   298 01  PROGRAM-INTERFACE-BLOCK.
   299     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   300     12  PI-CALLING-PROGRAM              PIC X(8).
   301     12  PI-SAVED-PROGRAM-1              PIC X(8).
   302     12  PI-SAVED-PROGRAM-2              PIC X(8).
   303     12  PI-SAVED-PROGRAM-3              PIC X(8).
   304     12  PI-SAVED-PROGRAM-4              PIC X(8).
   305     12  PI-SAVED-PROGRAM-5              PIC X(8).
   306     12  PI-SAVED-PROGRAM-6              PIC X(8).
   307     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   308     12  PI-COMPANY-ID                   PIC XXX.
   309     12  PI-COMPANY-CD                   PIC X.
   310
   311     12  PI-COMPANY-PASSWORD             PIC X(8).
   312
   313     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   314
   315     12  PI-CONTROL-IN-PROGRESS.
   316         16  PI-CARRIER                  PIC X.
   317         16  PI-GROUPING                 PIC X(6).
   318         16  PI-STATE                    PIC XX.
   319         16  PI-ACCOUNT                  PIC X(10).
   320         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   321                                         PIC X(10).
   322         16  PI-CLAIM-CERT-GRP.
   323             20  PI-CLAIM-NO             PIC X(7).
   324             20  PI-CERT-NO.
   325                 25  PI-CERT-PRIME       PIC X(10).
   326                 25  PI-CERT-SFX         PIC X.
   327             20  PI-CERT-EFF-DT          PIC XX.
   328         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   329             20  PI-PLAN-CODE            PIC X(2).
   330             20  PI-REVISION-NUMBER      PIC X(3).
   331             20  PI-PLAN-EFF-DT          PIC X(2).
   332             20  PI-PLAN-EXP-DT          PIC X(2).
   333             20  FILLER                  PIC X(11).
   334         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page   9
* EL153.cbl
   335             20  PI-OE-REFERENCE-1.
   336                 25  PI-OE-REF-1-PRIME   PIC X(18).
   337                 25  PI-OE-REF-1-SUFF    PIC XX.
   338
   339     12  PI-SESSION-IN-PROGRESS          PIC X.
   340         88  CLAIM-SESSION                   VALUE '1'.
   341         88  CREDIT-SESSION                  VALUE '2'.
   342         88  WARRANTY-SESSION                VALUE '3'.
   343         88  MORTGAGE-SESSION                VALUE '4'.
   344         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   345
   346
   347*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   348
   349     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   350     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   351
   352     12  PI-CREDIT-USER                  PIC X.
   353         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   354         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   355
   356     12  PI-CLAIM-USER                   PIC X.
   357         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   358         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   359
   360     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   361         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   362         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   363         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   364         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   365         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   366
   367     12  PI-PROCESSOR-ID                 PIC X(4).
   368
   369     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   370
   371     12  PI-MEMBER-CAPTION               PIC X(10).
   372
   373     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   374         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   375
   376     12  PI-LIFE-OVERRIDE-L1             PIC X.
   377     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   378     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   379     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   380
   381     12  PI-AH-OVERRIDE-L1               PIC X.
   382     12  PI-AH-OVERRIDE-L2               PIC XX.
   383     12  PI-AH-OVERRIDE-L6               PIC X(6).
   384     12  PI-AH-OVERRIDE-L12              PIC X(12).
   385
   386     12  PI-NEW-SYSTEM                   PIC X(2).
   387
   388     12  PI-PRIMARY-CERT-NO              PIC X(11).
   389     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   390         88  PI-USES-PAID-TO                 VALUE '1'.
   391     12  PI-CRDTCRD-SYSTEM.
   392         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  10
* EL153.cbl
   393             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   394             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   395         16  PI-CC-MONTH-END-DT          PIC XX.
   396     12  PI-PROCESSOR-PRINTER            PIC X(4).
   397
   398     12  PI-OE-REFERENCE-2.
   399         16  PI-OE-REF-2-PRIME           PIC X(10).
   400         16  PI-OE-REF-2-SUFF            PIC X.
   401
   402     12  PI-REM-TRM-CALC-OPTION          PIC X.
   403
   404     12  PI-LANGUAGE-TYPE                PIC X.
   405             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   406             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   407             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   408
   409     12  PI-POLICY-LINKAGE-IND           PIC X.
   410         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   411         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   412                                                   LOW-VALUES.
   413
   414     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   415     12  PI-CLAIM-PW-SESSION             PIC X(1).
   416         88  PI-CLAIM-CREDIT                 VALUE '1'.
   417         88  PI-CLAIM-CONVEN                 VALUE '2'.
   418
   419     12  PI-PROCESSOR-CSR-IND            PIC X.
   420         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   421         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   422
   423     12  FILLER                          PIC X(3).
   424
   425     12  PI-SYSTEM-LEVEL                 PIC X(145).
   426
   427     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   428         PI-SYSTEM-LEVEL.
   429
   430         16  PI-ENTRY-CODES.
   431             20  PI-ENTRY-CD-1           PIC X.
   432             20  PI-ENTRY-CD-2           PIC X.
   433
   434         16  PI-RETURN-CODES.
   435             20  PI-RETURN-CD-1          PIC X.
   436             20  PI-RETURN-CD-2          PIC X.
   437
   438         16  PI-UPDATE-STATUS-SAVE.
   439             20  PI-UPDATE-BY            PIC X(4).
   440             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   441
   442         16  PI-LOWER-CASE-LETTERS       PIC X.
   443             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   444
   445*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   446*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   447*            88  CARRIER-CLM-CNTL            VALUE '2'.
   448
   449         16  PI-CERT-ACCESS-CONTROL      PIC X.
   450             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  11
* EL153.cbl
   451             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   452             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   453             88  ACCNT-CNTL                  VALUE '3'.
   454             88  CARR-ACCNT-CNTL             VALUE '4'.
   455
   456         16  PI-PROCESSOR-CAP-LIST.
   457             20  PI-SYSTEM-CONTROLS.
   458                24 PI-SYSTEM-DISPLAY     PIC X.
   459                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   460                24 PI-SYSTEM-MODIFY      PIC X.
   461                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   462             20  FILLER                  PIC XX.
   463             20  PI-DISPLAY-CAP          PIC X.
   464                 88  DISPLAY-CAP             VALUE 'Y'.
   465             20  PI-MODIFY-CAP           PIC X.
   466                 88  MODIFY-CAP              VALUE 'Y'.
   467             20  PI-MSG-AT-LOGON-CAP     PIC X.
   468                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   469             20  PI-FORCE-CAP            PIC X.
   470                 88  FORCE-CAP               VALUE 'Y'.
   471
   472         16  PI-PROGRAM-CONTROLS.
   473             20  PI-PGM-PRINT-OPT        PIC X.
   474             20  PI-PGM-FORMAT-OPT       PIC X.
   475             20  PI-PGM-PROCESS-OPT      PIC X.
   476             20  PI-PGM-TOTALS-OPT       PIC X.
   477
   478         16  PI-HELP-INTERFACE.
   479             20  PI-LAST-ERROR-NO        PIC X(4).
   480             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   481
   482         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   483             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   484
   485         16  PI-CR-CONTROL-IN-PROGRESS.
   486             20  PI-CR-CARRIER           PIC X.
   487             20  PI-CR-GROUPING          PIC X(6).
   488             20  PI-CR-STATE             PIC XX.
   489             20  PI-CR-ACCOUNT           PIC X(10).
   490             20  PI-CR-FIN-RESP          PIC X(10).
   491             20  PI-CR-TYPE              PIC X.
   492
   493         16  PI-CR-BATCH-NUMBER          PIC X(6).
   494
   495         16  PI-CR-MONTH-END-DT          PIC XX.
   496
   497         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   498             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   499             88  PI-ZERO-CARRIER             VALUE '1'.
   500             88  PI-ZERO-GROUPING            VALUE '2'.
   501             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   502
   503         16  PI-CARRIER-SECURITY         PIC X.
   504             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   505
   506         16  PI-ACCOUNT-SECURITY         PIC X(10).
   507             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   508             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  12
* EL153.cbl
   509
   510         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   511             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   512                                         INDEXED BY PI-ACCESS-NDX
   513                                         PIC X.
   514
   515         16  PI-GA-BILLING-CONTROL       PIC X.
   516             88  PI-GA-BILLING               VALUE '1'.
   517
   518         16  PI-MAIL-PROCESSING          PIC X.
   519             88  PI-MAIL-YES                 VALUE 'Y'.
   520
   521         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   522
   523         16  PI-AR-SYSTEM.
   524             20  PI-AR-PROCESSING-CNTL   PIC X.
   525                 88  PI-AR-PROCESSING        VALUE 'Y'.
   526             20  PI-AR-SUMMARY-CODE      PIC X(6).
   527             20  PI-AR-MONTH-END-DT      PIC XX.
   528
   529         16  PI-MP-SYSTEM.
   530             20  PI-MORTGAGE-USER            PIC X.
   531                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   532                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   533             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   534                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   535                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   536                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   537                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   538                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   539             20  PI-MP-MONTH-END-DT          PIC XX.
   540             20  PI-MP-REFERENCE-NO.
   541                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   542                 24  PI-MP-REFERENCE-SFX     PIC XX.
   543
   544         16  PI-LABEL-CONTROL            PIC X(01).
   545             88  PI-CREATE-LABELS                    VALUE 'Y'.
   546             88  PI-BYPASS-LABELS                    VALUE 'N'.
   547
   548         16  PI-BILL-GROUPING-CODE       PIC X(01).
   549             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   550
   551         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   552             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   553             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   554
   555         16  FILLER                      PIC X(14).
   556
   557     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   558******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  13
* EL153.cbl
   560*                                    COPY ELCATTR.
   561******************************************************************
   562*                                                                *
   563*                            ELCATTR.                            *
   564*                            VMOD=2.001                          *
   565*                                                                *
   566*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   567*                                                                *
   568*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   569*                                                                *
   570*                   POS 1   P=PROTECTED                          *
   571*                           U=UNPROTECTED                        *
   572*                           S=ASKIP                              *
   573*                   POS 2   A=ALPHA/NUMERIC                      *
   574*                           N=NUMERIC                            *
   575*                   POS 3   N=NORMAL                             *
   576*                           B=BRIGHT                             *
   577*                           D=DARK                               *
   578*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   579*                           OF=MODIFIED DATA TAG OFF             *
   580*                                                                *
   581*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   582******************************************************************
   583 01  ATTRIBUTE-LIST.
   584     12  AL-PABOF            PIC X       VALUE 'Y'.
   585     12  AL-PABON            PIC X       VALUE 'Z'.
   586     12  AL-PADOF            PIC X       VALUE '%'.
   587     12  AL-PADON            PIC X       VALUE '_'.
   588     12  AL-PANOF            PIC X       VALUE '-'.
   589     12  AL-PANON            PIC X       VALUE '/'.
   590     12  AL-SABOF            PIC X       VALUE '8'.
   591     12  AL-SABON            PIC X       VALUE '9'.
   592     12  AL-SADOF            PIC X       VALUE '@'.
   593     12  AL-SADON            PIC X       VALUE QUOTE.
   594     12  AL-SANOF            PIC X       VALUE '0'.
   595     12  AL-SANON            PIC X       VALUE '1'.
   596     12  AL-UABOF            PIC X       VALUE 'H'.
   597     12  AL-UABON            PIC X       VALUE 'I'.
   598     12  AL-UADOF            PIC X       VALUE '<'.
   599     12  AL-UADON            PIC X       VALUE '('.
   600     12  AL-UANOF            PIC X       VALUE ' '.
   601     12  AL-UANON            PIC X       VALUE 'A'.
   602     12  AL-UNBOF            PIC X       VALUE 'Q'.
   603     12  AL-UNBON            PIC X       VALUE 'R'.
   604     12  AL-UNDOF            PIC X       VALUE '*'.
   605     12  AL-UNDON            PIC X       VALUE ')'.
   606     12  AL-UNNOF            PIC X       VALUE '&'.
   607     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  14
* EL153.cbl
   609*                                    COPY ELCLOGOF.
   610******************************************************************
   611*                                                                *
   612*                                                                *
   613*                            ELCLOGOF.                           *
   614*                            VMOD=2.001                          *
   615*                                                                *
   616*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   617*                                                                *
   618******************************************************************
   619 01  CLASIC-LOGOFF.
   620     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   621     12  LOGOFF-TEXT.
   622         16  FILLER          PIC X(5)    VALUE SPACES.
   623         16  LOGOFF-MSG.
   624             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   625             20  FILLER      PIC X       VALUE SPACES.
   626             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   627         16  FILLER          PIC X(80)
   628           VALUE '* YOU ARE NOW LOGGED OFF'.
   629         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   630         16  FILLER          PIC X       VALUE QUOTE.
   631         16  LOGOFF-SYS-MSG  PIC X(17)
   632           VALUE 'S CLAS-IC SYSTEM '.
   633     12  TEXT-MESSAGES.
   634         16  UNACCESS-MSG    PIC X(29)
   635             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   636         16  PGMIDERR-MSG    PIC X(17)
   637             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  15
* EL153.cbl
   639*                                    COPY ELCDATE.
   640******************************************************************
   641*                                                                *
   642*                                                                *
   643*                            ELCDATE.                            *
   644*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   645*                            VMOD=2.003
   646*                                                                *
   647*                                                                *
   648*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   649*                 LENGTH = 200                                   *
   650******************************************************************
   651
   652 01  DATE-CONVERSION-DATA.
   653     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   654     12  DC-OPTION-CODE                PIC X.
   655         88  BIN-TO-GREG                VALUE ' '.
   656         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   657         88  EDIT-GREG-TO-BIN           VALUE '2'.
   658         88  YMD-GREG-TO-BIN            VALUE '3'.
   659         88  MDY-GREG-TO-BIN            VALUE '4'.
   660         88  JULIAN-TO-BIN              VALUE '5'.
   661         88  BIN-PLUS-ELAPSED           VALUE '6'.
   662         88  FIND-CENTURY               VALUE '7'.
   663         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   664         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   665         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   666         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   667         88  JULIAN-TO-BIN-3            VALUE 'C'.
   668         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   669         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   670         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   671         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   672         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   673         88  CHECK-LEAP-YEAR            VALUE 'H'.
   674         88  BIN-3-TO-GREG              VALUE 'I'.
   675         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   676         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   677         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   678         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   679         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   680         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   681         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   682         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   683         88  THREE-CHARACTER-BIN
   684                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   685         88  GREGORIAN-TO-BIN
   686                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   687         88  BIN-TO-GREGORIAN
   688                  VALUES ' ' '1' 'I' '8' 'G'.
   689         88  JULIAN-TO-BINARY
   690                  VALUES '5' 'C' 'E' 'F'.
   691     12  DC-ERROR-CODE                 PIC X.
   692         88  NO-CONVERSION-ERROR        VALUE ' '.
   693         88  DATE-CONVERSION-ERROR
   694                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   695         88  DATE-IS-ZERO               VALUE '1'.
   696         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  16
* EL153.cbl
   697         88  DATE-IS-INVALID            VALUE '3'.
   698         88  DATE1-GREATER-DATE2        VALUE '4'.
   699         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   700         88  DATE-INVALID-OPTION        VALUE '9'.
   701         88  INVALID-CENTURY            VALUE 'A'.
   702         88  ONLY-CENTURY               VALUE 'B'.
   703         88  ONLY-LEAP-YEAR             VALUE 'C'.
   704         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   705     12  DC-END-OF-MONTH               PIC X.
   706         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   707     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   708         88  USE-NORMAL-PROCESS         VALUE ' '.
   709         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   710         88  ADJUST-UP-100-YRS          VALUE '2'.
   711     12  FILLER                        PIC X.
   712     12  DC-CONVERSION-DATES.
   713         16  DC-BIN-DATE-1             PIC XX.
   714         16  DC-BIN-DATE-2             PIC XX.
   715         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   716         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   717                       DC-GREG-DATE-1-EDIT.
   718             20  DC-EDIT1-MONTH        PIC 99.
   719             20  SLASH1-1              PIC X.
   720             20  DC-EDIT1-DAY          PIC 99.
   721             20  SLASH1-2              PIC X.
   722             20  DC-EDIT1-YEAR         PIC 99.
   723         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   724         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   725                     DC-GREG-DATE-2-EDIT.
   726             20  DC-EDIT2-MONTH        PIC 99.
   727             20  SLASH2-1              PIC X.
   728             20  DC-EDIT2-DAY          PIC 99.
   729             20  SLASH2-2              PIC X.
   730             20  DC-EDIT2-YEAR         PIC 99.
   731         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   732         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   733                     DC-GREG-DATE-1-YMD.
   734             20  DC-YMD-YEAR           PIC 99.
   735             20  DC-YMD-MONTH          PIC 99.
   736             20  DC-YMD-DAY            PIC 99.
   737         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   738         16  DC-GREG-DATE-1-MDY-R REDEFINES
   739                      DC-GREG-DATE-1-MDY.
   740             20  DC-MDY-MONTH          PIC 99.
   741             20  DC-MDY-DAY            PIC 99.
   742             20  DC-MDY-YEAR           PIC 99.
   743         16  DC-GREG-DATE-1-ALPHA.
   744             20  DC-ALPHA-MONTH        PIC X(10).
   745             20  DC-ALPHA-DAY          PIC 99.
   746             20  FILLER                PIC XX.
   747             20  DC-ALPHA-CENTURY.
   748                 24 DC-ALPHA-CEN-N     PIC 99.
   749             20  DC-ALPHA-YEAR         PIC 99.
   750         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   751         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   752         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   753         16  DC-JULIAN-DATE            PIC 9(05).
   754         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  17
* EL153.cbl
   755                                       PIC 9(05).
   756         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   757             20  DC-JULIAN-YEAR        PIC 99.
   758             20  DC-JULIAN-DAYS        PIC 999.
   759         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   760         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   761         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   762     12  DATE-CONVERSION-VARIBLES.
   763         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   764         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   765             20  FILLER                PIC 9(3).
   766             20  HOLD-CEN-1-CCYY.
   767                 24  HOLD-CEN-1-CC     PIC 99.
   768                 24  HOLD-CEN-1-YY     PIC 99.
   769             20  HOLD-CEN-1-MO         PIC 99.
   770             20  HOLD-CEN-1-DA         PIC 99.
   771         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   772             20  HOLD-CEN-1-R-MO       PIC 99.
   773             20  HOLD-CEN-1-R-DA       PIC 99.
   774             20  HOLD-CEN-1-R-CCYY.
   775                 24  HOLD-CEN-1-R-CC   PIC 99.
   776                 24  HOLD-CEN-1-R-YY   PIC 99.
   777             20  FILLER                PIC 9(3).
   778         16  HOLD-CENTURY-1-X.
   779             20  FILLER                PIC X(3)  VALUE SPACES.
   780             20  HOLD-CEN-1-X-CCYY.
   781                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   782                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   783             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   784             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   785         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   786             20  HOLD-CEN-1-R-X-MO     PIC XX.
   787             20  HOLD-CEN-1-R-X-DA     PIC XX.
   788             20  HOLD-CEN-1-R-X-CCYY.
   789                 24  HOLD-CEN-1-R-X-CC PIC XX.
   790                 24  HOLD-CEN-1-R-X-YY PIC XX.
   791             20  FILLER                PIC XXX.
   792         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   793         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   794         16  DC-JULIAN-DATE-1          PIC 9(07).
   795         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   796             20  DC-JULIAN-1-CCYY.
   797                 24  DC-JULIAN-1-CC    PIC 99.
   798                 24  DC-JULIAN-1-YR    PIC 99.
   799             20  DC-JULIAN-DA-1        PIC 999.
   800         16  DC-JULIAN-DATE-2          PIC 9(07).
   801         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   802             20  DC-JULIAN-2-CCYY.
   803                 24  DC-JULIAN-2-CC    PIC 99.
   804                 24  DC-JULIAN-2-YR    PIC 99.
   805             20  DC-JULIAN-DA-2        PIC 999.
   806         16  DC-GREG-DATE-A-EDIT.
   807             20  DC-EDITA-MONTH        PIC 99.
   808             20  SLASHA-1              PIC X VALUE '/'.
   809             20  DC-EDITA-DAY          PIC 99.
   810             20  SLASHA-2              PIC X VALUE '/'.
   811             20  DC-EDITA-CCYY.
   812                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  18
* EL153.cbl
   813                 24  DC-EDITA-YEAR     PIC 99.
   814         16  DC-GREG-DATE-B-EDIT.
   815             20  DC-EDITB-MONTH        PIC 99.
   816             20  SLASHB-1              PIC X VALUE '/'.
   817             20  DC-EDITB-DAY          PIC 99.
   818             20  SLASHB-2              PIC X VALUE '/'.
   819             20  DC-EDITB-CCYY.
   820                 24  DC-EDITB-CENT     PIC 99.
   821                 24  DC-EDITB-YEAR     PIC 99.
   822         16  DC-GREG-DATE-CYMD         PIC 9(08).
   823         16  DC-GREG-DATE-CYMD-R REDEFINES
   824                              DC-GREG-DATE-CYMD.
   825             20  DC-CYMD-CEN           PIC 99.
   826             20  DC-CYMD-YEAR          PIC 99.
   827             20  DC-CYMD-MONTH         PIC 99.
   828             20  DC-CYMD-DAY           PIC 99.
   829         16  DC-GREG-DATE-MDCY         PIC 9(08).
   830         16  DC-GREG-DATE-MDCY-R REDEFINES
   831                              DC-GREG-DATE-MDCY.
   832             20  DC-MDCY-MONTH         PIC 99.
   833             20  DC-MDCY-DAY           PIC 99.
   834             20  DC-MDCY-CEN           PIC 99.
   835             20  DC-MDCY-YEAR          PIC 99.
   836    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   837        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   838    12  DC-EL310-DATE                  PIC X(21).
   839    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  19
* EL153.cbl
   841*                                    COPY ELCEMIB.
   842******************************************************************
   843*                                                                *
   844*                                                                *
   845*                            ELCEMIB.                            *
   846*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   847*                            VMOD=2.005                          *
   848*                                                                *
   849*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   850*                                                                *
   851******************************************************************
   852 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   853     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   854     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   855     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   856     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   857     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   858     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   859     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   860     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   861     12  EMI-SWITCH1             PIC X        VALUE '1'.
   862         88  EMI-NO-ERRORS                    VALUE '1'.
   863         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   864         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   865     12  EMI-SWITCH2             PIC X        VALUE '1'.
   866         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   867     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   868         88  EMI-AREA1-EMPTY                  VALUE '1'.
   869         88  EMI-AREA1-FULL                   VALUE '2'.
   870     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   871         88  EMI-AREA2-EMPTY                  VALUE '1'.
   872         88  EMI-AREA2-FULL                   VALUE '2'.
   873     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   874         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   875         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   876         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   877         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   878         88  EMI-BYPASS-FATALS                VALUE 'X'.
   879     12  EMI-ERROR-LINES.
   880         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   881         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   882         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   883         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   884             20  EMI-ERR-CODES OCCURS 10 TIMES.
   885                 24  EMI-ERR-NUM         PIC X(4).
   886                 24  EMI-FILLER          PIC X.
   887                 24  EMI-SEV             PIC X.
   888                 24  FILLER              PIC X.
   889             20  FILLER                  PIC X(02).
   890     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   891         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   892             20  EMI-ERROR-NUMBER    PIC X(4).
   893             20  EMI-FILL            PIC X.
   894             20  EMI-SEVERITY        PIC X.
   895             20  FILLER              PIC X.
   896             20  EMI-ERROR-TEXT.
   897                 24  EMI-TEXT-VARIABLE   PIC X(10).
   898                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  20
* EL153.cbl
   899     12  EMI-SEVERITY-SAVE           PIC X.
   900         88  EMI-NOTE                    VALUE 'N'.
   901         88  EMI-WARNING                 VALUE 'W'.
   902         88  EMI-FORCABLE                VALUE 'F'.
   903         88  EMI-FATAL                   VALUE 'X'.
   904     12  EMI-MESSAGE-FLAG            PIC X.
   905         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   906         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   907     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   908     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   909         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   910         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   911         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   912     12  emi-claim-no                pic x(7).
   913     12  emi-claim-type              pic x(6).
   914     12  FILLER                      PIC X(124)  VALUE SPACES.
   915     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   916     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   917     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   918     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  21
* EL153.cbl
   920*                                    COPY EL153S.
   921 01  EL153AI.
   922     05  FILLER            PIC  X(0012).
   923*    -------------------------------
   924     05  MRNDATEL PIC S9(0004) COMP.
   925     05  MRNDATEF PIC  X(0001).
   926     05  FILLER REDEFINES MRNDATEF.
   927         10  MRNDATEA PIC  X(0001).
   928     05  MRNDATEI PIC  X(0008).
   929*    -------------------------------
   930     05  MRNTIMEL PIC S9(0004) COMP.
   931     05  MRNTIMEF PIC  X(0001).
   932     05  FILLER REDEFINES MRNTIMEF.
   933         10  MRNTIMEA PIC  X(0001).
   934     05  MRNTIMEI PIC  X(0005).
   935*    -------------------------------
   936     05  MCERTL PIC S9(0004) COMP.
   937     05  MCERTF PIC  X(0001).
   938     05  FILLER REDEFINES MCERTF.
   939         10  MCERTA PIC  X(0001).
   940     05  MCERTI PIC  X(0010).
   941*    -------------------------------
   942     05  MSTRDTL PIC S9(0004) COMP.
   943     05  MSTRDTF PIC  X(0001).
   944     05  FILLER REDEFINES MSTRDTF.
   945         10  MSTRDTA PIC  X(0001).
   946     05  MSTRDTI PIC  X(0008).
   947*    -------------------------------
   948     05  MENDDTL PIC S9(0004) COMP.
   949     05  MENDDTF PIC  X(0001).
   950     05  FILLER REDEFINES MENDDTF.
   951         10  MENDDTA PIC  X(0001).
   952     05  MENDDTI PIC  X(0008).
   953*    -------------------------------
   954     05  CALLTPL PIC S9(0004) COMP.
   955     05  CALLTPF PIC  X(0001).
   956     05  FILLER REDEFINES CALLTPF.
   957         10  CALLTPA PIC  X(0001).
   958     05  CALLTPI PIC  X(0001).
   959*    -------------------------------
   960     05  NOTETPL PIC S9(0004) COMP.
   961     05  NOTETPF PIC  X(0001).
   962     05  FILLER REDEFINES NOTETPF.
   963         10  NOTETPA PIC  X(0001).
   964     05  NOTETPI PIC  X(0001).
   965*    -------------------------------
   966     05  MLINE1L PIC S9(0004) COMP.
   967     05  MLINE1F PIC  X(0001).
   968     05  FILLER REDEFINES MLINE1F.
   969         10  MLINE1A PIC  X(0001).
   970     05  MLINE1I PIC  X(0060).
   971*    -------------------------------
   972     05  MLINE2L PIC S9(0004) COMP.
   973     05  MLINE2F PIC  X(0001).
   974     05  FILLER REDEFINES MLINE2F.
   975         10  MLINE2A PIC  X(0001).
   976     05  MLINE2I PIC  X(0060).
   977*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  22
* EL153.cbl
   978     05  MLINE3L PIC S9(0004) COMP.
   979     05  MLINE3F PIC  X(0001).
   980     05  FILLER REDEFINES MLINE3F.
   981         10  MLINE3A PIC  X(0001).
   982     05  MLINE3I PIC  X(0060).
   983*    -------------------------------
   984     05  MLINE4L PIC S9(0004) COMP.
   985     05  MLINE4F PIC  X(0001).
   986     05  FILLER REDEFINES MLINE4F.
   987         10  MLINE4A PIC  X(0001).
   988     05  MLINE4I PIC  X(0060).
   989*    -------------------------------
   990     05  MLINE5L PIC S9(0004) COMP.
   991     05  MLINE5F PIC  X(0001).
   992     05  FILLER REDEFINES MLINE5F.
   993         10  MLINE5A PIC  X(0001).
   994     05  MLINE5I PIC  X(0060).
   995*    -------------------------------
   996     05  MLINE6L PIC S9(0004) COMP.
   997     05  MLINE6F PIC  X(0001).
   998     05  FILLER REDEFINES MLINE6F.
   999         10  MLINE6A PIC  X(0001).
  1000     05  MLINE6I PIC  X(0060).
  1001*    -------------------------------
  1002     05  MLINE7L PIC S9(0004) COMP.
  1003     05  MLINE7F PIC  X(0001).
  1004     05  FILLER REDEFINES MLINE7F.
  1005         10  MLINE7A PIC  X(0001).
  1006     05  MLINE7I PIC  X(0060).
  1007*    -------------------------------
  1008     05  MLINE8L PIC S9(0004) COMP.
  1009     05  MLINE8F PIC  X(0001).
  1010     05  FILLER REDEFINES MLINE8F.
  1011         10  MLINE8A PIC  X(0001).
  1012     05  MLINE8I PIC  X(0060).
  1013*    -------------------------------
  1014     05  MLINE9L PIC S9(0004) COMP.
  1015     05  MLINE9F PIC  X(0001).
  1016     05  FILLER REDEFINES MLINE9F.
  1017         10  MLINE9A PIC  X(0001).
  1018     05  MLINE9I PIC  X(0060).
  1019*    -------------------------------
  1020     05  MLINE10L PIC S9(0004) COMP.
  1021     05  MLINE10F PIC  X(0001).
  1022     05  FILLER REDEFINES MLINE10F.
  1023         10  MLINE10A PIC  X(0001).
  1024     05  MLINE10I PIC  X(0060).
  1025*    -------------------------------
  1026     05  MLINE11L PIC S9(0004) COMP.
  1027     05  MLINE11F PIC  X(0001).
  1028     05  FILLER REDEFINES MLINE11F.
  1029         10  MLINE11A PIC  X(0001).
  1030     05  MLINE11I PIC  X(0060).
  1031*    -------------------------------
  1032     05  MLINE12L PIC S9(0004) COMP.
  1033     05  MLINE12F PIC  X(0001).
  1034     05  FILLER REDEFINES MLINE12F.
  1035         10  MLINE12A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  23
* EL153.cbl
  1036     05  MLINE12I PIC  X(0060).
  1037*    -------------------------------
  1038     05  MLINE13L PIC S9(0004) COMP.
  1039     05  MLINE13F PIC  X(0001).
  1040     05  FILLER REDEFINES MLINE13F.
  1041         10  MLINE13A PIC  X(0001).
  1042     05  MLINE13I PIC  X(0060).
  1043*    -------------------------------
  1044     05  MLINE14L PIC S9(0004) COMP.
  1045     05  MLINE14F PIC  X(0001).
  1046     05  FILLER REDEFINES MLINE14F.
  1047         10  MLINE14A PIC  X(0001).
  1048     05  MLINE14I PIC  X(0060).
  1049*    -------------------------------
  1050     05  MERMSG1L PIC S9(0004) COMP.
  1051     05  MERMSG1F PIC  X(0001).
  1052     05  FILLER REDEFINES MERMSG1F.
  1053         10  MERMSG1A PIC  X(0001).
  1054     05  MERMSG1I PIC  X(0079).
  1055*    -------------------------------
  1056     05  MERMSG2L PIC S9(0004) COMP.
  1057     05  MERMSG2F PIC  X(0001).
  1058     05  FILLER REDEFINES MERMSG2F.
  1059         10  MERMSG2A PIC  X(0001).
  1060     05  MERMSG2I PIC  X(0079).
  1061*    -------------------------------
  1062     05  MPFNUMBL PIC S9(0004) COMP.
  1063     05  MPFNUMBF PIC  X(0001).
  1064     05  FILLER REDEFINES MPFNUMBF.
  1065         10  MPFNUMBA PIC  X(0001).
  1066     05  MPFNUMBI PIC  99.
  1067*    -------------------------------
  1068     05  PFKEY4L PIC S9(0004) COMP.
  1069     05  PFKEY4F PIC  X(0001).
  1070     05  FILLER REDEFINES PFKEY4F.
  1071         10  PFKEY4A PIC  X(0001).
  1072     05  PFKEY4I PIC  X(0014).
  1073 01  EL153AO REDEFINES EL153AI.
  1074     05  FILLER            PIC  X(0012).
  1075*    -------------------------------
  1076     05  FILLER            PIC  X(0003).
  1077     05  MRNDATEO PIC  X(0008).
  1078*    -------------------------------
  1079     05  FILLER            PIC  X(0003).
  1080     05  MRNTIMEO PIC  99.99.
  1081*    -------------------------------
  1082     05  FILLER            PIC  X(0003).
  1083     05  MCERTO PIC  X(0010).
  1084*    -------------------------------
  1085     05  FILLER            PIC  X(0003).
  1086     05  MSTRDTO PIC  X(0008).
  1087*    -------------------------------
  1088     05  FILLER            PIC  X(0003).
  1089     05  MENDDTO PIC  X(0008).
  1090*    -------------------------------
  1091     05  FILLER            PIC  X(0003).
  1092     05  CALLTPO PIC  X(0001).
  1093*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  24
* EL153.cbl
  1094     05  FILLER            PIC  X(0003).
  1095     05  NOTETPO PIC  X(0001).
  1096*    -------------------------------
  1097     05  FILLER            PIC  X(0003).
  1098     05  MLINE1O PIC  X(0060).
  1099*    -------------------------------
  1100     05  FILLER            PIC  X(0003).
  1101     05  MLINE2O PIC  X(0060).
  1102*    -------------------------------
  1103     05  FILLER            PIC  X(0003).
  1104     05  MLINE3O PIC  X(0060).
  1105*    -------------------------------
  1106     05  FILLER            PIC  X(0003).
  1107     05  MLINE4O PIC  X(0060).
  1108*    -------------------------------
  1109     05  FILLER            PIC  X(0003).
  1110     05  MLINE5O PIC  X(0060).
  1111*    -------------------------------
  1112     05  FILLER            PIC  X(0003).
  1113     05  MLINE6O PIC  X(0060).
  1114*    -------------------------------
  1115     05  FILLER            PIC  X(0003).
  1116     05  MLINE7O PIC  X(0060).
  1117*    -------------------------------
  1118     05  FILLER            PIC  X(0003).
  1119     05  MLINE8O PIC  X(0060).
  1120*    -------------------------------
  1121     05  FILLER            PIC  X(0003).
  1122     05  MLINE9O PIC  X(0060).
  1123*    -------------------------------
  1124     05  FILLER            PIC  X(0003).
  1125     05  MLINE10O PIC  X(0060).
  1126*    -------------------------------
  1127     05  FILLER            PIC  X(0003).
  1128     05  MLINE11O PIC  X(0060).
  1129*    -------------------------------
  1130     05  FILLER            PIC  X(0003).
  1131     05  MLINE12O PIC  X(0060).
  1132*    -------------------------------
  1133     05  FILLER            PIC  X(0003).
  1134     05  MLINE13O PIC  X(0060).
  1135*    -------------------------------
  1136     05  FILLER            PIC  X(0003).
  1137     05  MLINE14O PIC  X(0060).
  1138*    -------------------------------
  1139     05  FILLER            PIC  X(0003).
  1140     05  MERMSG1O PIC  X(0079).
  1141*    -------------------------------
  1142     05  FILLER            PIC  X(0003).
  1143     05  MERMSG2O PIC  X(0079).
  1144*    -------------------------------
  1145     05  FILLER            PIC  X(0003).
  1146     05  MPFNUMBO PIC  X(0002).
  1147*    -------------------------------
  1148     05  FILLER            PIC  X(0003).
  1149     05  PFKEY4O PIC  X(0014).
  1150*    -------------------------------
  1151 01  EL153AI-R REDEFINES EL153AI.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  25
* EL153.cbl
  1152*    12  FILLER                      PIC X(70).
  1153     12  FILLER                      PIC X(74).
  1154     12  EL153AI-OCCURS OCCURS 14 TIMES.
  1155         16  EL153A-NOTE-LENGTH      PIC S9(4)     COMP.
  1156         16  EL153A-NOTE-ATTRB       PIC X.
  1157         16  EL153A-NOTE             PIC X(60).
  1158
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  26
* EL153.cbl
  1160****************************************************************
  1161*
  1162* Copyright (c) 2007-2013 Dell Inc.
  1163* All rights reserved.
  1164*
  1165****************************************************************
  1166 01  DFHEIV.
  1167   02  DFHEIV0               PIC X(35).
  1168   02  DFHEIV1               PIC X(08).
  1169   02  DFHEIV2               PIC X(08).
  1170   02  DFHEIV3               PIC X(08).
  1171   02  DFHEIV4               PIC X(06).
  1172   02  DFHEIV5               PIC X(04).
  1173   02  DFHEIV6               PIC X(04).
  1174   02  DFHEIV7               PIC X(02).
  1175   02  DFHEIV8               PIC X(02).
  1176   02  DFHEIV9               PIC X(01).
  1177   02  DFHEIV10              PIC S9(7) COMP-3.
  1178   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1179   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1180   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1181   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1182   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1183   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1184   02  DFHEIV17              PIC X(04).
  1185   02  DFHEIV18              PIC X(04).
  1186   02  DFHEIV19              PIC X(04).
  1187   02  DFHEIV20              USAGE IS POINTER.
  1188   02  DFHEIV21              USAGE IS POINTER.
  1189   02  DFHEIV22              USAGE IS POINTER.
  1190   02  DFHEIV23              USAGE IS POINTER.
  1191   02  DFHEIV24              USAGE IS POINTER.
  1192   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1193   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1194   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1195   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1196   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1197   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1198   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1199   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1200   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1201   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1202   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1203   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1204   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1205   02  FILLER                PIC X(02).
  1206   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1207   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1208   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1209   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1210   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1211   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1212   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1213 LINKAGE  SECTION.
  1214*****************************************************************
  1215*                                                               *
  1216* Copyright (c) 2007-2013 Dell Inc.                             *
  1217* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  27
* EL153.cbl
  1218*                                                               *
  1219*****************************************************************
  1220 01  dfheiblk.
  1221     02  eibtime          pic s9(7) comp-3.
  1222     02  eibdate          pic s9(7) comp-3.
  1223     02  eibtrnid         pic x(4).
  1224     02  eibtaskn         pic s9(7) comp-3.
  1225     02  eibtrmid         pic x(4).
  1226     02  dfheigdi         pic s9(4) comp.
  1227     02  eibcposn         pic s9(4) comp.
  1228     02  eibcalen         pic s9(4) comp.
  1229     02  eibaid           pic x(1).
  1230     02  eibfiller1       pic x(1).
  1231     02  eibfn            pic x(2).
  1232     02  eibfiller2       pic x(2).
  1233     02  eibrcode         pic x(6).
  1234     02  eibfiller3       pic x(2).
  1235     02  eibds            pic x(8).
  1236     02  eibreqid         pic x(8).
  1237     02  eibrsrce         pic x(8).
  1238     02  eibsync          pic x(1).
  1239     02  eibfree          pic x(1).
  1240     02  eibrecv          pic x(1).
  1241     02  eibsend          pic x(1).
  1242     02  eibatt           pic x(1).
  1243     02  eibeoc           pic x(1).
  1244     02  eibfmh           pic x(1).
  1245     02  eibcompl         pic x(1).
  1246     02  eibsig           pic x(1).
  1247     02  eibconf          pic x(1).
  1248     02  eiberr           pic x(1).
  1249     02  eibrldbk         pic x(1).
  1250     02  eiberrcd         pic x(4).
  1251     02  eibsynrb         pic x(1).
  1252     02  eibnodat         pic x(1).
  1253     02  eibfiller5       pic x(2).
  1254     02  eibresp          pic s9(8) comp.
  1255     02  eibresp2         pic s9(8) comp.
  1256     02  dfheigdj         pic s9(4) comp.
  1257     02  dfheigdk         pic s9(4) comp.
  1258
  1259 01  DFHCOMMAREA                     PIC X(1024).
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  28
* EL153.cbl
  1261*                                    COPY ELCMSTR.
  1262******************************************************************
  1263*                                                                *
  1264*                            ELCMSTR.                            *
  1265*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1266*                            VMOD=2.012                          *
  1267*                                                                *
  1268*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1269*                                                                *
  1270*   FILE TYPE = VSAM,KSDS                                        *
  1271*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1272*                                                                *
  1273*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1274*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1275*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1276*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1277*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1278*                                                 RKP=75,LEN=21  *
  1279*                                                                *
  1280*   **** NOTE ****                                               *
  1281*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1282*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1283*                                                                *
  1284*   LOG = YES                                                    *
  1285*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1286******************************************************************
  1287*                   C H A N G E   L O G
  1288*
  1289* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1290*-----------------------------------------------------------------
  1291*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1292* EFFECTIVE    NUMBER
  1293*-----------------------------------------------------------------
  1294* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1295* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1296* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1297* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1298* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1299* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  1300* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1301******************************************************************
  1302 01  CLAIM-MASTER.
  1303     12  CL-RECORD-ID                PIC XX.
  1304         88  VALID-CL-ID         VALUE 'CL'.
  1305
  1306     12  CL-CONTROL-PRIMARY.
  1307         16  CL-COMPANY-CD           PIC X.
  1308         16  CL-CARRIER              PIC X.
  1309         16  CL-CLAIM-NO             PIC X(7).
  1310         16  CL-CERT-NO.
  1311             20  CL-CERT-PRIME       PIC X(10).
  1312             20  CL-CERT-SFX         PIC X.
  1313
  1314     12  CL-CONTROL-BY-NAME.
  1315         16  CL-COMPANY-CD-A1        PIC X.
  1316         16  CL-INSURED-LAST-NAME    PIC X(15).
  1317         16  CL-INSURED-NAME.
  1318             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  29
* EL153.cbl
  1319             20  CL-INSURED-MID-INIT PIC X.
  1320
  1321     12  CL-CONTROL-BY-SSN.
  1322         16  CL-COMPANY-CD-A2        PIC X.
  1323         16  CL-SOC-SEC-NO.
  1324             20  CL-SSN-STATE        PIC XX.
  1325             20  CL-SSN-ACCOUNT      PIC X(6).
  1326             20  CL-SSN-LN3          PIC X(3).
  1327
  1328     12  CL-CONTROL-BY-CERT-NO.
  1329         16  CL-COMPANY-CD-A4        PIC X.
  1330         16  CL-CERT-NO-A4.
  1331             20  CL-CERT-A4-PRIME    PIC X(10).
  1332             20  CL-CERT-A4-SFX      PIC X.
  1333
  1334     12  CL-CONTROL-BY-CCN.
  1335         16  CL-COMPANY-CD-A5        PIC X.
  1336         16  CL-CCN-A5.
  1337             20  CL-CCN.
  1338                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1339                 24  CL-CCN-PRIME-A5 PIC X(12).
  1340             20  CL-CCN-FILLER-A5    PIC X(4).
  1341
  1342     12  CL-INSURED-PROFILE-DATA.
  1343         16  CL-INSURED-BIRTH-DT     PIC XX.
  1344         16  CL-INSURED-SEX-CD       PIC X.
  1345             88  INSURED-IS-MALE        VALUE 'M'.
  1346             88  INSURED-IS-FEMALE      VALUE 'F'.
  1347             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1348         16  CL-INSURED-OCC-CD       PIC X(6).
  1349         16  FILLER                  PIC X(5).
  1350
  1351     12  CL-PROCESSING-INFO.
  1352         16  CL-PROCESSOR-ID         PIC X(4).
  1353         16  CL-CLAIM-STATUS         PIC X.
  1354             88  CLAIM-IS-OPEN          VALUE 'O'.
  1355             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1356         16  CL-CLAIM-TYPE           PIC X.
  1357*            88  AH-CLAIM               VALUE 'A'.
  1358*            88  LIFE-CLAIM             VALUE 'L'.
  1359*            88  PROPERTY-CLAIM         VALUE 'P'.
  1360*            88  IUI-CLAIM              VALUE 'I'.
  1361*            88  GAP-CLAIM              VALUE 'G'.
  1362*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1363*            88  OTHER-CLAIM            VALUE 'O'.
  1364         16  CL-CLAIM-PREM-TYPE      PIC X.
  1365             88  SINGLE-PREMIUM         VALUE '1'.
  1366             88  O-B-COVERAGE           VALUE '2'.
  1367             88  OPEN-END-COVERAGE      VALUE '3'.
  1368         16  CL-INCURRED-DT          PIC XX.
  1369         16  CL-REPORTED-DT          PIC XX.
  1370         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1371         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1372         16  CL-LAST-PMT-DT          PIC XX.
  1373         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1374         16  CL-PAID-THRU-DT         PIC XX.
  1375         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1376         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  30
* EL153.cbl
  1377         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1378         16  CL-PMT-CALC-METHOD      PIC X.
  1379             88  CL-360-DAY-YR          VALUE '1'.
  1380             88  CL-365-DAY-YR          VALUE '2'.
  1381             88  CL-FULL-MONTHS         VALUE '3'.
  1382         16  CL-CAUSE-CD             PIC X(6).
  1383
  1384         16  CL-PRIME-CERT-NO.
  1385             20  CL-PRIME-CERT-PRIME PIC X(10).
  1386             20  CL-PRIME-CERT-SFX   PIC X.
  1387
  1388         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1389             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1390             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1391
  1392         16  CL-MICROFILM-NO         PIC X(10).
  1393         16  FILLER REDEFINES CL-MICROFILM-NO.
  1394             20  CL-BENEFIT-PERIOD   PIC 99.
  1395             20  FILLER              PIC X(8).
  1396         16  CL-PROG-FORM-TYPE       PIC X.
  1397         16  CL-LAST-ADD-ON-DT       PIC XX.
  1398
  1399         16  CL-LAST-REOPEN-DT       PIC XX.
  1400         16  CL-LAST-CLOSE-DT        PIC XX.
  1401         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1402             88  FINAL-PAID             VALUE '1'.
  1403             88  CLAIM-DENIED           VALUE '2'.
  1404             88  AUTO-CLOSE             VALUE '3'.
  1405             88  MANUAL-CLOSE           VALUE '4'.
  1406             88  BENEFITS-CHANGED       VALUE 'C'.
  1407             88  SETUP-ERRORS           VALUE 'E'.
  1408         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1409         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1410         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1411             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1412         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1413         16  FILLER                  PIC X.
  1414
  1415     12  CL-CERTIFICATE-DATA.
  1416         16  CL-CERT-ORIGIN          PIC X.
  1417             88  CERT-WAS-ONLINE        VALUE '1'.
  1418             88  CERT-WAS-CREATED       VALUE '2'.
  1419             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1420         16  CL-CERT-KEY-DATA.
  1421             20  CL-CERT-CARRIER     PIC X.
  1422             20  CL-CERT-GROUPING    PIC X(6).
  1423             20  CL-CERT-STATE       PIC XX.
  1424             20  CL-CERT-ACCOUNT.
  1425                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1426                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1427             20  CL-CERT-EFF-DT      PIC XX.
  1428
  1429     12  CL-STATUS-CONTROLS.
  1430         16  CL-PRIORITY-CD          PIC X.
  1431             88  CONFIDENTIAL-DATA      VALUE '8'.
  1432             88  HIGHEST-PRIORITY       VALUE '9'.
  1433         16  CL-SUPV-ATTN-CD         PIC X.
  1434             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  31
* EL153.cbl
  1435             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1436         16  CL-PURGED-DT            PIC XX.
  1437         16  CL-RESTORED-DT          PIC XX.
  1438         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1439         16  CL-NEXT-RESEND-DT       PIC XX.
  1440         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1441         16  CL-CRITICAL-PERIOD      PIC 99.
  1442*        16  FILLER                  PIC XX.
  1443         16  CL-LAST-MAINT-DT        PIC XX.
  1444         16  CL-LAST-MAINT-USER      PIC X(4).
  1445         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1446         16  CL-LAST-MAINT-TYPE      PIC X.
  1447             88  CLAIM-SET-UP           VALUE ' '.
  1448             88  PAYMENT-MADE           VALUE '1'.
  1449             88  LETTER-SENT            VALUE '2'.
  1450             88  MASTER-WAS-ALTERED     VALUE '3'.
  1451             88  MASTER-WAS-RESTORED    VALUE '4'.
  1452             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1453             88  FILE-CONVERTED         VALUE '6'.
  1454             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1455             88  ERROR-CORRECTION       VALUE 'E'.
  1456         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1457         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1458         16  CL-BENEFICIARY          PIC X(10).
  1459         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1460         16  CL-DENIAL-TYPE          PIC X.
  1461             88  CL-TYPE-DENIAL          VALUE '1'.
  1462             88  CL-TYPE-RESCISSION      VALUE '2'.
  1463             88  CL-TYPE-REFORMATION     VALUE '3'.
  1464             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1465             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1466         16  CL-NO-OF-EXTENSIONS     PIC 99.
  1467         16  filler                  pic x(3).
  1468*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1469*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1470*        16  CL-RTW-DT               PIC XX.
  1471
  1472     12  CL-TRAILER-CONTROLS.
  1473         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1474             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1475             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1476             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1477         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1478         16  FILLER                  PIC XX.
  1479         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1480         16  CL-ADDRESS-TRAILER-CNT.
  1481             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1482                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1483             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1484                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1485             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1486                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1487             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1488                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1489             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1490                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1491             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1492                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  32
* EL153.cbl
  1493             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1494                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1495
  1496     12  CL-CV-REFERENCE-NO.
  1497         16  CL-CV-REFNO-PRIME       PIC X(18).
  1498         16  CL-CV-REFNO-SFX         PIC XX.
  1499
  1500     12  CL-FILE-LOCATION            PIC X(4).
  1501
  1502     12  CL-PROCESS-ERRORS.
  1503         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1504             88  NO-FATAL-ERRORS        VALUE ZERO.
  1505         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1506             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1507
  1508     12  CL-PRODUCT-CD               PIC X.
  1509
  1510     12  CL-CURRENT-KEY-DATA.
  1511         16  CL-CURRENT-CARRIER      PIC X.
  1512         16  CL-CURRENT-GROUPING     PIC X(6).
  1513         16  CL-CURRENT-STATE        PIC XX.
  1514         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1515
  1516     12  CL-ASSOCIATES               PIC X.
  1517         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1518         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1519         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1520         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1521
  1522     12  CL-ACTIVITY-CODE            PIC 99.
  1523     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1524     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1525
  1526     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1527     12  CL-LAG-REPORT-CODE          PIC 9.
  1528     12  CL-LOAN-TYPE                PIC XX.
  1529     12  CL-LEGAL-STATE              PIC XX.
  1530
  1531     12  CL-YESNOSW                  PIC X.
  1532     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1533         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1534         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1535         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1536     12  cl-insured-type             pic x.
  1537         88  cl-claim-on-primary         value 'P'.
  1538         88  cl-claim-on-co-borrower     value 'C'.
  1539     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  33
* EL153.cbl
  1541*                                    COPY ELCTRLR.
  1542******************************************************************
  1543*                                                                *
  1544*                            ELCTRLR.                            *
  1545*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1546*                            VMOD=2.014                          *
  1547*                                                                *
  1548*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  1549*                                                                *
  1550*   FILE TYPE = VSAM,KSDS                                        *
  1551*   RECORD SIZE = 200    RECFORM = FIXED                         *
  1552*                                                                *
  1553*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  1554*       ALTERNATE INDEX = NONE                                   *
  1555*                                                                *
  1556*   LOG = YES                                                    *
  1557*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1558******************************************************************
  1559*                   C H A N G E   L O G
  1560*
  1561* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1562*-----------------------------------------------------------------
  1563*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1564* EFFECTIVE    NUMBER
  1565*-----------------------------------------------------------------
  1566* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1567* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  1568* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  1569* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  1570* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  1571* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  1572* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  1573* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  1574* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  1575* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  1576* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  1577* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  1578* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  1579* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  1580* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  1581* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1582* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  1583* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  1584* 040814    2014030500002  AJRA  ADD ICD CODES
  1585* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1586* 013017  CR2016053100001  PEMA  ACH PROCESSING
  1587* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  1588* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1589* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  1590******************************************************************
  1591 01  ACTIVITY-TRAILERS.
  1592     12  AT-RECORD-ID                    PIC XX.
  1593         88  VALID-AT-ID                       VALUE 'AT'.
  1594
  1595     12  AT-CONTROL-PRIMARY.
  1596         16  AT-COMPANY-CD               PIC X.
  1597         16  AT-CARRIER                  PIC X.
  1598         16  AT-CLAIM-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  34
* EL153.cbl
  1599         16  AT-CERT-NO.
  1600             20  AT-CERT-PRIME           PIC X(10).
  1601             20  AT-CERT-SFX             PIC X.
  1602         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  1603             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  1604             88  AT-LAST-TRL-AVAIL            VALUE +100.
  1605             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  1606             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  1607             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  1608             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  1609             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  1610             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  1611             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  1612             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  1613             88  AT-DIAGNOSIS-TRL             VALUE +90.
  1614             88  AT-BENEFICIARY-TRL           VALUE +91.
  1615             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  1616             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  1617             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  1618             88  AT-ERROR-MSGS-TRL            VALUE +95.
  1619
  1620     12  AT-TRAILER-TYPE                 PIC X.
  1621         88  RESERVE-EXPENSE-TR               VALUE '1'.
  1622         88  PAYMENT-TR                       VALUE '2'.
  1623         88  AUTO-PAY-TR                      VALUE '3'.
  1624         88  CORRESPONDENCE-TR                VALUE '4'.
  1625         88  ADDRESS-TR                       VALUE '5'.
  1626         88  GENERAL-INFO-TR                  VALUE '6'.
  1627         88  AUTO-PROMPT-TR                   VALUE '7'.
  1628         88  DENIAL-TR                        VALUE '8'.
  1629         88  INCURRED-CHG-TR                  VALUE '9'.
  1630         88  FORM-CONTROL-TR                  VALUE 'A'.
  1631
  1632     12  AT-RECORDED-DT                  PIC XX.
  1633     12  AT-RECORDED-BY                  PIC X(4).
  1634     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  1635
  1636     12  AT-TRAILER-BODY                 PIC X(165).
  1637
  1638     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  1639         16  AT-RESERVE-CONTROLS.
  1640             20  AT-MANUAL-SW            PIC X.
  1641                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  1642             20  AT-FUTURE-SW            PIC X.
  1643                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  1644             20  AT-PTC-SW               PIC X.
  1645                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  1646             20  AT-IBNR-SW              PIC X.
  1647                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  1648             20  AT-PTC-LF-SW            PIC X.
  1649                 88  AT-LF-PTC-USED          VALUE '1'.
  1650             20  AT-CDT-ACCESS-METHOD    PIC X.
  1651                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  1652                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  1653                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  1654             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  1655         16  AT-LAST-COMPUTED-DT         PIC XX.
  1656         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  35
* EL153.cbl
  1657         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  1658         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  1659         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1660         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1661         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  1662         16  AT-EXPENSE-CONTROLS.
  1663             20  AT-EXPENSE-METHOD       PIC X.
  1664                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  1665                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  1666                 88  PERCENT-OF-PMT           VALUE '3'.
  1667                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  1668             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  1669             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  1670         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  1671         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  1672
  1673         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  1674         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  1675
  1676*        16  FILLER                      PIC X(53).
  1677         16  FILLER                      PIC X(47).
  1678
  1679         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  1680         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  1681
  1682         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  1683             20  AT-OPEN-CLOSE-DATE      PIC XX.
  1684             20  AT-OPEN-CLOSE-TYPE      PIC X.
  1685*                    C = CLOSED
  1686*                    O = OPEN
  1687             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  1688*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  1689
  1690     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  1691         16  AT-PAYMENT-TYPE             PIC X.
  1692             88  PARTIAL-PAYMENT                VALUE '1'.
  1693             88  FINAL-PAYMENT                  VALUE '2'.
  1694             88  LUMP-SUM-PAYMENT               VALUE '3'.
  1695             88  ADDITIONAL-PAYMENT             VALUE '4'.
  1696             88  CHARGEABLE-EXPENSE             VALUE '5'.
  1697             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  1698             88  VOIDED-PAYMENT                 VALUE '9'.
  1699             88  TRANSFER                       VALUE 'T'.
  1700             88  LIFE-INTEREST                  VALUE 'I'.
  1701
  1702         16  AT-CLAIM-TYPE               PIC X.
  1703             88  PAID-FOR-AH                    VALUE 'A'.
  1704             88  PAID-FOR-LIFE                  VALUE 'L'.
  1705             88  PAID-FOR-IUI                   VALUE 'I'.
  1706             88  PAID-FOR-GAP                   VALUE 'G'.
  1707             88  PAID-FOR-FAM                   VALUE 'F'.
  1708             88  PAID-FOR-OTH                   VALUE 'O'.
  1709         16  AT-CLAIM-PREM-TYPE          PIC X.
  1710             88  AT-SINGLE-PREMIUM              VALUE '1'.
  1711             88  AT-O-B-COVERAGE                VALUE '2'.
  1712             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  1713         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  1714         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  36
* EL153.cbl
  1715         16  AT-PAID-FROM-DT             PIC XX.
  1716         16  AT-PAID-THRU-DT             PIC XX.
  1717         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  1718         16  AT-ACH-PAYMENT              PIC X.
  1719*        16  FILLER                      PIC X.
  1720         16  AT-PAYEES-NAME              PIC X(30).
  1721         16  AT-PAYMENT-ORIGIN           PIC X.
  1722             88  ONLINE-MANUAL-PMT              VALUE '1'.
  1723             88  ONLINE-AUTO-PMT                VALUE '2'.
  1724             88  OFFLINE-PMT                    VALUE '3'.
  1725         16  AT-CHECK-WRITTEN-DT         PIC XX.
  1726         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  1727         16  AT-VOID-DATA.
  1728             20  AT-VOID-DT              PIC XX.
  1729*00144       20  AT-VOID-REASON          PIC X(30).
  1730             20  AT-VOID-REASON          PIC X(26).
  1731         16  AT-PMT-APPROVED-BY          PIC X(04).
  1732         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  1733         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  1734         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  1735                                         PIC S99V9(5)  COMP-3.
  1736         16  AT-CREDIT-INTERFACE.
  1737             20  AT-PMT-SELECT-DT        PIC XX.
  1738                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  1739             20  AT-PMT-ACCEPT-DT        PIC XX.
  1740                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  1741             20  AT-VOID-SELECT-DT       PIC XX.
  1742                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  1743             20  AT-VOID-ACCEPT-DT       PIC XX.
  1744                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  1745
  1746         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  1747                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  1748                 88  CONVERSION-PAYMENT           VALUE +99999999.
  1749         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  1750
  1751         16  AT-FORCE-CONTROL            PIC X.
  1752             88  PAYMENT-WAS-FORCED           VALUE '1'.
  1753         16  AT-PREV-LAST-PMT-DT         PIC XX.
  1754         16  AT-PREV-PAID-THRU-DT        PIC XX.
  1755         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1756         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  1757         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  1758         16  AT-BENEFIT-TYPE             PIC X.
  1759
  1760         16  AT-EXPENSE-TYPE             PIC X.
  1761         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  1762
  1763         16  AT-PAYEE-TYPE-CD.
  1764             20  AT-PAYEE-TYPE           PIC X.
  1765                 88  INSURED-PAID           VALUE 'I'.
  1766                 88  BENEFICIARY-PAID       VALUE 'B'.
  1767                 88  ACCOUNT-PAID           VALUE 'A'.
  1768                 88  OTHER-1-PAID           VALUE 'O'.
  1769                 88  OTHER-2-PAID           VALUE 'Q'.
  1770                 88  DOCTOR-PAID            VALUE 'P'.
  1771                 88  EMPLOYER-PAID          VALUE 'E'.
  1772             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  37
* EL153.cbl
  1773
  1774         16  AT-CASH-PAYMENT             PIC X.
  1775         16  AT-GROUPED-PAYMENT          PIC X.
  1776         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  1777         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  1778         16  AT-APPROVED-LEVEL           PIC X.
  1779         16  AT-VOID-TYPE                PIC X.
  1780             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  1781             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  1782         16  AT-AIG-UNEMP-IND            PIC X.
  1783             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  1784         16  AT-ASSOCIATES               PIC X.
  1785             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  1786             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  1787
  1788         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  1789         16  AT-CV-PMT-CODE              PIC X.
  1790             88  FULL-DEATH-PAYMENT         VALUE '1'.
  1791             88  HALF-DEATH-PAYMENT         VALUE '2'.
  1792             88  FULL-ADD-PAYMENT           VALUE '3'.
  1793             88  HALF-ADD-PAYMENT           VALUE '4'.
  1794             88  FULL-RIDER-PAYMENT         VALUE '5'.
  1795             88  HALF-RIDER-PAYMENT         VALUE '6'.
  1796             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  1797             88  ADDL-PAYMENT               VALUE '8'.
  1798
  1799         16  AT-EOB-CODE1                PIC XXX.
  1800         16  AT-EOB-CODE2                PIC XXX.
  1801         16  AT-EOB-CODE3                PIC XXX.
  1802         16  FILLER REDEFINES AT-EOB-CODE3.
  1803             20  AT-PRINT-CLM-FORM       PIC X.
  1804             20  AT-PRINT-SURVEY         PIC X.
  1805             20  AT-SPECIAL-RELEASE      PIC X.
  1806         16  AT-EOB-CODE4                PIC XXX.
  1807         16  FILLER REDEFINES AT-EOB-CODE4.
  1808             20  AT-INT-PMT-SELECT-DT    PIC XX.
  1809             20  FILLER                  PIC X.
  1810         16  AT-EOB-CODE5                PIC XXX.
  1811         16  FILLER REDEFINES AT-EOB-CODE5.
  1812             20  AT-PMT-PROOF-DT         PIC XX.
  1813             20  FILLER                  PIC X.
  1814
  1815         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  1816             88  AT-PRINT-EOB            VALUE 'Y'.
  1817
  1818         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  1819         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  1820
  1821     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  1822         16  AT-SCHEDULE-START-DT        PIC XX.
  1823         16  AT-SCHEDULE-END-DT          PIC XX.
  1824         16  AT-TERMINATED-DT            PIC XX.
  1825         16  AT-LAST-PMT-TYPE            PIC X.
  1826             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  1827             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  1828         16  AT-FIRST-PMT-DATA.
  1829             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1830             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  38
* EL153.cbl
  1831             20  AT-1ST-PAY-THRU-DT      PIC XX.
  1832         16  AT-REGULAR-PMT-DATA.
  1833             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  1834             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  1835             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  1836         16  AT-AUTO-PAYEE-CD.
  1837             20  AT-AUTO-PAYEE-TYPE      PIC X.
  1838                 88  INSURED-PAID-AUTO      VALUE 'I'.
  1839                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  1840                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  1841                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  1842                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  1843             20  AT-AUTO-PAYEE-SEQ       PIC X.
  1844         16  AT-AUTO-PAY-DAY             PIC 99.
  1845         16  AT-AUTO-CASH                PIC X.
  1846             88  AT-CASH                      VALUE 'Y'.
  1847             88  AT-NON-CASH                  VALUE 'N'.
  1848*        16  FILLER                      PIC X(129).
  1849         16  AT-AUTO-END-LETTER          PIC X(4).
  1850         16  FILLER                      PIC X(125).
  1851
  1852         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  1853         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1854
  1855     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1856         16  AT-LETTER-SENT-DT           PIC XX.
  1857         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1858         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1859         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1860         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1861         16  AT-LETTER-ORIGIN            PIC X.
  1862             88  ONLINE-CREATION              VALUE '1' '3'.
  1863             88  OFFLINE-CREATION             VALUE '2' '4'.
  1864             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1865             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1866         16  AT-STD-LETTER-FORM          PIC X(4).
  1867         16  AT-REASON-TEXT              PIC X(70).
  1868         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1869         16  AT-ADDRESEE-TYPE            PIC X.
  1870              88  INSURED-ADDRESEE            VALUE 'I'.
  1871              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1872              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1873              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1874              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1875              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1876              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1877         16  AT-ADDRESSEE-NAME           PIC X(30).
  1878         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1879         16  AT-RESEND-PRINT-DATE        PIC XX.
  1880         16  AT-CORR-SOL-UNSOL           PIC X.
  1881         16  AT-LETTER-PURGED-DT         PIC XX.
  1882*
  1883*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1884*
  1885         16  AT-CSO-REDEFINITION.
  1886             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1887             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1888             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  39
* EL153.cbl
  1889             20  AT-STOP-LETTER-DT       PIC X(2).
  1890             20  AT-AUTH-RCVD            PIC X(1).
  1891             20  FILLER                  PIC X(18).
  1892*             20  FILLER                  PIC X(27).
  1893             20  AT-CSO-LETTER-STATUS    PIC X.
  1894                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1895                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1896                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1897             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1898             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1899*
  1900*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1901*
  1902*        16  FILLER                      PIC X(26).
  1903*
  1904*        16  AT-DMD-BSR-CODE             PIC X.
  1905*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1906*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1907*
  1908*        16  AT-DMD-LETTER-STATUS        PIC X.
  1909*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  1910*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  1911*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  1912*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  1913*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  1914
  1915         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  1916         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  1917
  1918     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  1919         16  AT-ADDRESS-TYPE             PIC X.
  1920             88  INSURED-ADDRESS               VALUE 'I'.
  1921             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  1922             88  ACCOUNT-ADDRESS               VALUE 'A'.
  1923             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  1924             88  EMPLOYER-ADDRESS              VALUE 'E'.
  1925             88  OTHER-ADDRESS-1               VALUE 'O'.
  1926             88  OTHER-ADDRESS-2               VALUE 'Q'.
  1927         16  AT-MAIL-TO-NAME             PIC X(30).
  1928         16  AT-ADDRESS-LINE-1           PIC X(30).
  1929         16  AT-ADDRESS-LINE-2           PIC X(30).
  1930         16  AT-CITY-STATE.
  1931             20  AT-CITY                 PIC X(28).
  1932             20  AT-STATE                PIC XX.
  1933         16  AT-ZIP.
  1934             20  AT-ZIP-CODE.
  1935                 24  AT-ZIP-1ST          PIC X.
  1936                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1937                 24  FILLER              PIC X(4).
  1938             20  AT-ZIP-PLUS4            PIC X(4).
  1939         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  1940             20  AT-CAN-POSTAL-1         PIC XXX.
  1941             20  AT-CAN-POSTAL-2         PIC XXX.
  1942             20  FILLER                  PIC XXX.
  1943         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  1944*         16  FILLER                      PIC X(23).
  1945         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  1946         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  40
* EL153.cbl
  1947         16  FILLER                      PIC X(13).
  1948         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  1949         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  1950
  1951     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1952         16  AT-INFO-LINE-1              PIC X(60).
  1953         16  FILLER REDEFINES AT-INFO-LINE-1.
  1954             20  AT-NOTE-ERROR-NO OCCURS 15
  1955                                         PIC X(4).
  1956         16  AT-INFO-LINE-2              PIC X(60).
  1957         16  FILLER REDEFINES AT-INFO-LINE-2.
  1958             20  AT-ICD-CODE-1           PIC X(8).
  1959             20  AT-ICD-CODE-2           PIC X(8).
  1960             20  FILLER                  PIC X(44).
  1961         16  AT-INFO-TRAILER-TYPE        PIC X.
  1962             88  AT-ERRORS-NOTE          VALUE 'E'.
  1963             88  AT-PAYMENT-NOTE         VALUE 'P'.
  1964             88  AT-CALL-NOTE            VALUE 'C'.
  1965             88  AT-MAINT-NOTE           VALUE 'M'.
  1966             88  AT-CERT-CHANGE          VALUE 'X'.
  1967             88  AT-APPROVAL-NOTE        VALUE 'R'.
  1968             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  1969             88  AT-CERT-CANCELLED       VALUE 'T'.
  1970         16  AT-CALL-TYPE                PIC X.
  1971             88  AT-PHONE-CALL-IN        VALUE 'I'.
  1972             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  1973             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  1974         16  AT-NOTE-CONTINUATION        PIC X.
  1975             88  AT-CONTINUED-NOTE       VALUE 'X'.
  1976         16  AT-EOB-CODES-EXIST          PIC X.
  1977             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  1978         16  FILLER                      PIC X(35).
  1979         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  1980         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  1981
  1982     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  1983         16  AT-PROMPT-LINE-1            PIC X(60).
  1984         16  AT-PROMPT-LINE-2            PIC X(60).
  1985         16  AT-PROMPT-START-DT          PIC XX.
  1986         16  AT-PROMPT-END-DT            PIC XX.
  1987         16  FILLER                      PIC X(35).
  1988         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  1989         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  1990
  1991     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1992         16  AT-DENIAL-INFO-1            PIC X(60).
  1993         16  AT-DENIAL-INFO-2            PIC X(60).
  1994         16  AT-DENIAL-DT                PIC XX.
  1995         16  AT-RETRACTION-DT            PIC XX.
  1996         16  AT-DENIAL-REASON-CODE       PIC X(4).
  1997*         16  FILLER                      PIC X(31).
  1998         16  AT-DENIAL-PROOF-DT          PIC XX.
  1999         16  FILLER                      PIC X(29).
  2000         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  2001         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  2002
  2003     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  2004         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  41
* EL153.cbl
  2005         16  AT-OLD-REPORTED-DT          PIC XX.
  2006         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  2007         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  2008         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  2009         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  2010         16  AT-OLD-PAID-THRU-DT         PIC XX.
  2011         16  AT-LAST-PMT-MADE-DT         PIC XX.
  2012         16  FILLER                      PIC X(26).
  2013         16  AT-OLD-DIAG-CODE            PIC X(6).
  2014         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  2015         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  2016         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  2017         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  2018         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  2019         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  2020         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  2021         16  AT-OLD-ICD-CODE-1           PIC X(8).
  2022         16  AT-OLD-ICD-CODE-2           PIC X(8).
  2023         16  FILLER                      PIC X(9).
  2024         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  2025
  2026     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  2027         16  AT-FORM-SEND-ON-DT          PIC XX.
  2028         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  2029         16  AT-FORM-RE-SEND-DT          PIC XX.
  2030         16  AT-FORM-ANSWERED-DT         PIC XX.
  2031         16  AT-FORM-PRINTED-DT          PIC XX.
  2032         16  AT-FORM-REPRINT-DT          PIC XX.
  2033         16  AT-FORM-TYPE                PIC X.
  2034             88  INITIAL-FORM                  VALUE '1'.
  2035             88  PROGRESS-FORM                 VALUE '2'.
  2036         16  AT-INSTRUCT-LN-1            PIC X(28).
  2037         16  AT-INSTRUCT-LN-2            PIC X(28).
  2038         16  AT-INSTRUCT-LN-3            PIC X(28).
  2039         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  2040         16  AT-FORM-ADDRESS             PIC X.
  2041             88  FORM-TO-INSURED              VALUE 'I'.
  2042             88  FORM-TO-ACCOUNT              VALUE 'A'.
  2043             88  FORM-TO-OTHER-1              VALUE 'O'.
  2044             88  FORM-TO-OTHER-2              VALUE 'Q'.
  2045         16  AT-RELATED-1.
  2046             20 AT-REL-CARR-1            PIC X.
  2047             20 AT-REL-CLAIM-1           PIC X(7).
  2048             20 AT-REL-CERT-1            PIC X(11).
  2049         16  AT-RELATED-2.
  2050             20 AT-REL-CARR-2            PIC X.
  2051             20 AT-REL-CLAIM-2           PIC X(7).
  2052             20 AT-REL-CERT-2            PIC X(11).
  2053         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  2054         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  2055         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  2056         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  2057         16  AT-FORM-REM-PRINT-DT        PIC XX.
  2058         16  AT-STOP-FORM-DT             PIC X(2).
  2059
  2060         16  FILLER                      PIC X(09).
  2061         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  2062         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  42
* EL153.cbl
  2063******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  43
* EL153.cbl
  2065 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  2066                          ACTIVITY-TRAILERS.
  2067 0000-DFHEXIT SECTION.
  2068     MOVE '9#                    $   ' TO DFHEIV0.
  2069     MOVE 'EL153' TO DFHEIV1.
  2070     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2071
  2072     MOVE EIBDATE               TO  DC-JULIAN-YYDDD.
  2073     MOVE '5'                   TO  DC-OPTION-CODE.
  2074     PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT.
  2075     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  2076     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  2077
  2078     MOVE DFHCOMMAREA           TO  PROGRAM-INTERFACE-BLOCK.
  2079
  2080     IF EIBCALEN NOT GREATER THAN ZEROS
  2081       GO TO 9000-UNAUTHERR.
  2082
  2083     IF PI-COMPANY-ID = 'DMD'
  2084         MOVE +3                TO  DC-ELAPSED-MONTHS
  2085         MOVE +0                TO  DC-ELAPSED-DAYS
  2086         MOVE '6'               TO  DC-OPTION-CODE
  2087         PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
  2088         MOVE DC-BIN-DATE-2     TO  CURRENT-PLUS3-SAVE.
  2089
  2090
  2091* EXEC CICS  HANDLE CONDITION
  2092*           ERROR    (9990-ERROR)
  2093*           PGMIDERR (9600-PGMIDERR)
  2094*    END-EXEC.
  2095*    MOVE '"$.L                  ! " #00002086' TO DFHEIV0
  2096     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  2097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2098     MOVE X'2220233030303032303836' TO DFHEIV0(25:11)
  2099     CALL 'kxdfhei1' USING DFHEIV0
  2100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2101
  2102
  2103     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2104         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2105             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2106             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2107             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2108             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2109             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2110             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2111             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2112             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  2113         ELSE
  2114             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2115             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2116             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2117             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2118             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2119             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2120             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2121             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  2122     ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  44
* EL153.cbl
  2123         GO TO 0100-RECEIVE.
  2124
  2125     MOVE LOW-VALUES             TO  EL153AO.
  2126
  2127     IF PI-COMPANY-ID = 'DMD' or 'CID' OR 'AHL'
  2128        MOVE -1                  TO CALLTPL
  2129     ELSE
  2130*       IF PI-COMPANY-ID = 'CID'
  2131*          MOVE -1               TO MLINE1L
  2132*       ELSE
  2133           MOVE -1               TO MSTRDTL
  2134*       END-IF
  2135     END-IF
  2136
  2137     MOVE +2                     TO  EMI-NUMBER-OF-LINES.
  2138     MOVE SPACES                 TO  MERMSG1O
  2139                                     MERMSG2O.
  2140     MOVE '153A'                 TO  PI-CURRENT-SCREEN-NO.
  2141     MOVE ER-0694                TO  EMI-ERROR.
  2142     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2143     GO TO 8100-SEND-INITIAL-MAP.
  2144
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  45
* EL153.cbl
  2146 0100-RECEIVE.
  2147
  2148     IF EIBAID = DFHCLEAR
  2149         GO TO 9400-CLEAR.
  2150
  2151     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2152         MOVE LOW-VALUES         TO  EL153AO
  2153         MOVE ER-0008            TO  EMI-ERROR
  2154         MOVE -1                 TO  MLINE1L
  2155         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2156         GO TO 8200-SEND-DATAONLY.
  2157
  2158     IF PI-PROCESSOR-ID = 'LGXX'
  2159         NEXT SENTENCE
  2160     ELSE
  2161
  2162* EXEC CICS READQ TS
  2163*            QUEUE    (PI-SECURITY-TEMP-STORE-ID)
  2164*            INTO     (SECURITY-CONTROL)
  2165*            LENGTH   (SC-COMM-LENGTH)
  2166*            ITEM     (SC-ITEM)
  2167*        END-EXEC
  2168*    MOVE '*$II   L              ''   #00002149' TO DFHEIV0
  2169     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2170     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2171     MOVE X'2020233030303032313439' TO DFHEIV0(25:11)
  2172     CALL 'kxdfhei1' USING DFHEIV0,
  2173           PI-SECURITY-TEMP-STORE-ID,
  2174           SECURITY-CONTROL,
  2175           SC-COMM-LENGTH,
  2176           SC-ITEM,
  2177           DFHEIV99,
  2178           DFHEIV99
  2179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2180         MOVE SC-CLAIMS-DISPLAY (8)  TO  PI-DISPLAY-CAP
  2181         MOVE SC-CLAIMS-UPDATE  (8)  TO  PI-MODIFY-CAP.
  2182
  2183
  2184* EXEC CICS RECEIVE
  2185*        MAP      (WS-MAP-NAME)
  2186*        MAPSET   (WS-MAPSET-NAME)
  2187*        INTO     (EL153AI)
  2188*    END-EXEC.
  2189     MOVE LENGTH OF
  2190      EL153AI
  2191       TO DFHEIV11
  2192*    MOVE '8"T I  L              ''   #00002158' TO DFHEIV0
  2193     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2194     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2195     MOVE X'2020233030303032313538' TO DFHEIV0(25:11)
  2196     CALL 'kxdfhei1' USING DFHEIV0,
  2197           WS-MAP-NAME,
  2198           EL153AI,
  2199           DFHEIV11,
  2200           WS-MAPSET-NAME,
  2201           DFHEIV99,
  2202           DFHEIV99
  2203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  46
* EL153.cbl
  2204
  2205
  2206     IF MPFNUMBL > +0
  2207         IF EIBAID NOT = DFHENTER
  2208             MOVE ER-0004        TO  EMI-ERROR
  2209             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2210             MOVE AL-UNBOF       TO  MPFNUMBA
  2211             MOVE -1             TO  MPFNUMBL
  2212             GO TO 8200-SEND-DATAONLY.
  2213
  2214     IF MPFNUMBI IS NUMERIC
  2215         IF MPFNUMBO > ZERO AND
  2216            MPFNUMBO < 25
  2217             MOVE PF-VALUES (MPFNUMBI)   TO  EIBAID
  2218         ELSE
  2219             MOVE ER-0029                TO  EMI-ERROR
  2220             MOVE AL-UNBOF               TO  MPFNUMBA
  2221             MOVE -1                     TO  MPFNUMBL
  2222             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2223             GO TO 8200-SEND-DATAONLY.
  2224
  2225     IF EIBAID = DFHPF12
  2226         MOVE 'EL010   '         TO  THIS-PGM
  2227         GO TO 9300-XCTL.
  2228
  2229     IF EIBAID = DFHPF23
  2230         MOVE EIBAID             TO  PI-ENTRY-CD-1
  2231         MOVE 'EL005   '         TO  THIS-PGM
  2232         GO TO 9300-XCTL.
  2233
  2234     IF EIBAID = DFHPF24
  2235         MOVE 'EL126   '         TO  THIS-PGM
  2236         GO TO 9300-XCTL.
  2237
  2238     IF (EIBAID = DFHENTER)
  2239               OR
  2240        (EIBAID = DFHPF4 AND
  2241         PI-COMPANY-ID = 'DMD')
  2242         NEXT SENTENCE
  2243     ELSE
  2244         MOVE ER-0008            TO  EMI-ERROR
  2245         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2246         MOVE -1                 TO  MPFNUMBL
  2247         MOVE AL-UNBON           TO  MPFNUMBA
  2248         GO TO 8200-SEND-DATAONLY.
  2249
  2250 0200-PROCESSING-MAINLINE.
  2251
  2252     IF NOT MODIFY-CAP
  2253         MOVE 'UPDATE'           TO  SM-READ
  2254         PERFORM 9995-SECURITY-VIOLATION
  2255         MOVE ER-0070            TO  EMI-ERROR
  2256         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2257         MOVE -1                 TO  MPFNUMBL
  2258         GO TO 8100-SEND-INITIAL-MAP.
  2259
  2260     MOVE +0                     TO  SUB.
  2261     PERFORM 4000-CHECK-INPUT-LOOP THRU 4000-CHECK-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  47
* EL153.cbl
  2262
  2263     IF NOT EMI-NO-ERRORS
  2264         GO TO 8200-SEND-DATAONLY.
  2265
  2266     MOVE PI-COMPANY-CD          TO  WS-KEY-COMPANY-CD.
  2267     MOVE PI-CARRIER             TO  WS-KEY-CARRIER.
  2268     MOVE PI-CLAIM-NO            TO  WS-KEY-CLAIM-NO.
  2269     MOVE PI-CERT-NO             TO  WS-KEY-CERT-NO.
  2270
  2271     IF (NOTETPL > +0)
  2272*       AND (NOTETPI = 'S')
  2273        IF (NOTETPI = 'S')
  2274          GO TO 1200-BUILD-SPEC-REVIEW
  2275        ELSE
  2276          GO TO 1000-BUILD-NOTES
  2277        END-IF
  2278     ELSE
  2279       IF MSTRDTI = (LOW-VALUES OR SPACES) AND
  2280         MENDDTI = (LOW-VALUES OR SPACES)
  2281         GO TO 1000-BUILD-NOTES
  2282       ELSE
  2283          GO TO 1500-BUILD-REMINDERS
  2284       END-IF
  2285     END-IF
  2286     .
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  48
* EL153.cbl
  2288 1000-BUILD-NOTES.
  2289
  2290     MOVE SPACES TO W-CALL-TYPE W-NOTE-TYPE-IND W-NOTE-TYPE.
  2291
  2292     IF CALLTPI NOT = SPACES AND LOW-VALUES
  2293         IF CALLTPI = 'I' OR 'O' OR 'N'
  2294             MOVE CALLTPI    TO W-CALL-TYPE
  2295             MOVE 'C'        TO W-NOTE-TYPE-IND
  2296         ELSE
  2297             MOVE ER-0915    TO EMI-ERROR
  2298             MOVE AL-UABON   TO CALLTPA
  2299             MOVE -1         TO CALLTPL
  2300             MOVE 'X'        TO WS-DATE-ERROR-SW
  2301             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2302             GO TO 8200-SEND-DATAONLY.
  2303
  2304     IF NOTETPI NOT = SPACES AND LOW-VALUES
  2305         IF NOTETPI = 'N'
  2306             MOVE NOTETPI    TO W-NOTE-TYPE
  2307             MOVE 'N'        TO W-NOTE-TYPE-IND
  2308         ELSE
  2309             MOVE ER-7846    TO EMI-ERROR
  2310             MOVE AL-UABON   TO NOTETPA
  2311             MOVE -1         TO NOTETPL
  2312             MOVE 'X'        TO WS-DATE-ERROR-SW
  2313             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2314             GO TO 8200-SEND-DATAONLY
  2315         END-IF
  2316     END-IF.
  2317
  2318     MOVE +1                     TO  SUB   SUB-1.
  2319     PERFORM 4100-SQUASH-SCREEN THRU 4100-EXIT.
  2320
  2321     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  2322         MOVE +0                 TO  SUB
  2323         PERFORM 6000-EXPAND-AIG-NOTES THRU 6000-EXIT.
  2324
  2325     PERFORM 7000-READ-UP-CLAIM THRU 7050-EXIT.
  2326     PERFORM 7100-GETMAIN-TRLR  THRU 7100-EXIT.
  2327
  2328     MOVE +15                    TO  SUB.
  2329     PERFORM 3200-BUILD-GI-TRLR-LOOP THRU 3200-EXIT.
  2330     MOVE +0                     TO  SUB   SUB-1.
  2331
  2332     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
  2333     MOVE SAVE-BIN-DATE          TO  CL-LAST-MAINT-DT.
  2334     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
  2335     MOVE '3'                    TO  CL-LAST-MAINT-TYPE.
  2336
  2337     PERFORM 7055-REWRITE-CLAIM THRU 7055-EXIT.
  2338
  2339     MOVE ER-0000                TO  EMI-ERROR.
  2340     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2341     MOVE -1                     TO  EL153A-NOTE-LENGTH (1).
  2342
  2343     IF PI-COMPANY-ID = 'DMD' or 'CID' OR 'AHL'
  2344         MOVE -1                 TO  CALLTPL.
  2345
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  49
* EL153.cbl
  2346     GO TO 8200-SEND-DATAONLY.
  2347
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  50
* EL153.cbl
  2349 1200-BUILD-SPEC-REVIEW.
  2350
  2351     IF NOTETPI NOT = SPACES AND LOW-VALUES
  2352         IF NOTETPI = 'S'
  2353             MOVE NOTETPI    TO W-NOTE-TYPE
  2354             MOVE 'S'        TO W-NOTE-TYPE-IND
  2355         ELSE
  2356             MOVE ER-7846    TO EMI-ERROR
  2357             MOVE AL-UABON   TO NOTETPA
  2358             MOVE -1         TO NOTETPL
  2359             MOVE 'X'        TO WS-DATE-ERROR-SW
  2360             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2361             GO TO 8200-SEND-DATAONLY.
  2362
  2363     MOVE +1                     TO  SUB   SUB-1.
  2364     PERFORM 4100-SQUASH-SCREEN THRU 4100-EXIT.
  2365
  2366     PERFORM 7000-READ-UP-CLAIM THRU 7050-EXIT.
  2367     PERFORM 7100-GETMAIN-TRLR     THRU 7100-EXIT.
  2368     PERFORM 3150-BUILD-TRAILER-SR THRU 3150-EXIT.
  2369
  2370     PERFORM 7150-WRITE-TRAILER THRU 7199-EXIT.
  2371
  2372     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
  2373     MOVE SAVE-BIN-DATE          TO  CL-LAST-MAINT-DT.
  2374     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
  2375     MOVE '3'                    TO  CL-LAST-MAINT-TYPE.
  2376
  2377     PERFORM 7055-REWRITE-CLAIM THRU 7055-EXIT.
  2378
  2379     MOVE ER-0000                TO  EMI-ERROR.
  2380     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2381     MOVE -1                     TO  EL153A-NOTE-LENGTH (1).
  2382
  2383     IF PI-COMPANY-ID = 'DMD' or 'CID' OR 'AHL'
  2384         MOVE -1                 TO  CALLTPL.
  2385
  2386     GO TO 8200-SEND-DATAONLY.
  2387
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  51
* EL153.cbl
  2389 1500-BUILD-REMINDERS.
  2390
  2391     PERFORM 2000-EDIT-SCREEN THRU 2000-EXIT.
  2392
  2393     IF NOT EMI-NO-ERRORS
  2394         GO TO 8200-SEND-DATAONLY.
  2395
  2396     PERFORM 7000-READ-UP-CLAIM    THRU 7050-EXIT.
  2397     PERFORM 2200-CHECK-DATES      THRU 2200-EXIT.
  2398     PERFORM 7100-GETMAIN-TRLR     THRU 7100-EXIT.
  2399     PERFORM 3000-REDUCE-SEQ       THRU 3000-EXIT.
  2400     PERFORM 3100-BUILD-TRAILER-AP THRU 3100-EXIT.
  2401
  2402     PERFORM 7150-WRITE-TRAILER THRU 7199-EXIT.
  2403
  2404     IF CL-NEXT-FOLLOWUP-DT = LOW-VALUES
  2405         MOVE WS-STR-DATE-BIN        TO  CL-NEXT-FOLLOWUP-DT
  2406     ELSE
  2407         IF WS-STR-DATE-BIN < CL-NEXT-FOLLOWUP-DT AND
  2408            WS-STR-DATE-BIN NOT = LOW-VALUES
  2409             MOVE WS-STR-DATE-BIN    TO  CL-NEXT-FOLLOWUP-DT.
  2410
  2411     PERFORM 7055-REWRITE-CLAIM THRU 7055-EXIT.
  2412
  2413     MOVE ER-0000                TO  EMI-ERROR.
  2414     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2415     MOVE -1                     TO  EL153A-NOTE-LENGTH (1).
  2416
  2417     IF PI-COMPANY-ID = 'DMD' or 'CID' OR 'AHL'
  2418         MOVE -1                 TO  CALLTPL.
  2419
  2420     GO TO 8200-SEND-DATAONLY.
  2421
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  52
* EL153.cbl
  2423 2000-EDIT-SCREEN.
  2424     MOVE SPACES                 TO  WS-DATE-ERROR-SW.
  2425
  2426     IF MSTRDTI = SPACES OR LOW-VALUES
  2427         MOVE LOW-VALUES         TO  WS-STR-DATE-BIN
  2428     ELSE
  2429         MOVE MSTRDTI            TO  WS-DATE-UNEDIT
  2430
  2431* EXEC CICS  BIF  DEEDIT
  2432*            FIELD (WS-DATE-UNEDIT)
  2433*            LENGTH (8)
  2434*        END-EXEC
  2435     MOVE 8
  2436       TO DFHEIV11
  2437*    MOVE '@"L                   #   #00002388' TO DFHEIV0
  2438     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2439     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2440     MOVE X'2020233030303032333838' TO DFHEIV0(25:11)
  2441     CALL 'kxdfhei1' USING DFHEIV0,
  2442           WS-DATE-UNEDIT,
  2443           DFHEIV11
  2444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2445         MOVE '4'                TO  DC-OPTION-CODE
  2446         MOVE WS-DATE-MDY        TO  DC-GREG-DATE-1-MDY
  2447         PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
  2448         IF DATE-CONVERSION-ERROR
  2449             MOVE ER-0314        TO  EMI-ERROR
  2450             MOVE AL-UABON       TO  MSTRDTA
  2451             MOVE -1             TO  MSTRDTL
  2452             MOVE 'X'            TO  WS-DATE-ERROR-SW
  2453             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2454         ELSE
  2455             IF (PI-COMPANY-ID = 'DMD') AND
  2456                (EIBAID NOT = DFHPF4)   AND
  2457                (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  2458                 MOVE 'PF4=FORCE 7840' TO PFKEY4O
  2459                 MOVE AL-SABON         TO PFKEY4A
  2460                 MOVE ER-7840          TO EMI-ERROR
  2461                 MOVE AL-UABON         TO MSTRDTA
  2462                 MOVE -1               TO MSTRDTL
  2463                 MOVE 'X'              TO WS-DATE-ERROR-SW
  2464                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2465             ELSE
  2466               MOVE SPACES               TO PFKEY4O
  2467               MOVE AL-SADON             TO PFKEY4A
  2468               MOVE AL-UANON             TO MSTRDTA
  2469               MOVE DC-BIN-DATE-1        TO WS-STR-DATE-BIN
  2470               MOVE DC-GREG-DATE-1-EDIT  TO MSTRDTI.
  2471
  2472     IF MENDDTI = SPACES OR = LOW-VALUES
  2473         MOVE LOW-VALUES         TO  WS-END-DATE-BIN
  2474     ELSE
  2475         MOVE MENDDTI            TO  WS-DATE-UNEDIT
  2476
  2477* EXEC CICS  BIF  DEEDIT
  2478*            FIELD (WS-DATE-UNEDIT)
  2479*            LENGTH (8)
  2480*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  53
* EL153.cbl
  2481     MOVE 8
  2482       TO DFHEIV11
  2483*    MOVE '@"L                   #   #00002423' TO DFHEIV0
  2484     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2485     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2486     MOVE X'2020233030303032343233' TO DFHEIV0(25:11)
  2487     CALL 'kxdfhei1' USING DFHEIV0,
  2488           WS-DATE-UNEDIT,
  2489           DFHEIV11
  2490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2491         MOVE '4'                TO  DC-OPTION-CODE
  2492         MOVE WS-DATE-MDY        TO  DC-GREG-DATE-1-MDY
  2493         PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
  2494         IF  DATE-CONVERSION-ERROR
  2495             MOVE ER-0314        TO  EMI-ERROR
  2496             MOVE AL-UABON       TO  MENDDTA
  2497             MOVE -1             TO  MENDDTL
  2498             MOVE 'X'            TO  WS-DATE-ERROR-SW
  2499             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2500         ELSE
  2501             MOVE AL-UANON             TO  MENDDTA
  2502             MOVE DC-BIN-DATE-1        TO  WS-END-DATE-BIN
  2503             MOVE DC-GREG-DATE-1-EDIT  TO  MENDDTI.
  2504 2000-EXIT.
  2505      EXIT.
  2506
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  54
* EL153.cbl
  2508 2200-CHECK-DATES.
  2509     IF WS-STR-DATE-BIN  LESS THAN SAVE-BIN-DATE AND
  2510        WS-END-DATE-BIN  LESS THAN SAVE-BIN-DATE
  2511         MOVE ER-0316            TO  EMI-ERROR
  2512         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2513         MOVE -1                 TO  MSTRDTL
  2514         GO TO 8100-SEND-INITIAL-MAP.
  2515
  2516     IF WS-STR-DATE-BIN  GREATER THAN WS-END-DATE-BIN
  2517         MOVE ER-0317            TO  EMI-ERROR
  2518         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2519         MOVE -1                 TO  MSTRDTL
  2520         GO TO 8100-SEND-INITIAL-MAP.
  2521
  2522 2200-EXIT.
  2523      EXIT.
  2524
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  55
* EL153.cbl
  2526 3000-REDUCE-SEQ.
  2527     IF CL-LAST-TRL-AVAIL
  2528         MOVE ER-0137            TO  EMI-ERROR
  2529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2530         MOVE -1                 TO  EL153A-NOTE-LENGTH (1)
  2531         GO TO 8100-SEND-INITIAL-MAP.
  2532
  2533     SUBTRACT  1 FROM CL-TRAILER-SEQ-CNT.
  2534     MOVE CL-TRAILER-SEQ-CNT     TO  WS-KEY-SEQUENCE-NO
  2535                                     AT-SEQUENCE-NO.
  2536
  2537 3000-EXIT.
  2538      EXIT.
  2539
  2540 3100-BUILD-TRAILER-AP.
  2541     MOVE 'AT'                   TO  AT-RECORD-ID.
  2542     MOVE '7'                    TO  AT-TRAILER-TYPE.
  2543
  2544     IF EL153A-NOTE-LENGTH (1) NOT > +0
  2545         MOVE SPACES             TO  AT-PROMPT-LINE-1
  2546     ELSE
  2547         MOVE EL153A-NOTE  (1)   TO  AT-PROMPT-LINE-1.
  2548
  2549     IF EL153A-NOTE-LENGTH (2) NOT > +0
  2550         MOVE SPACES             TO  AT-PROMPT-LINE-2
  2551     ELSE
  2552         MOVE EL153A-NOTE  (2)   TO  AT-PROMPT-LINE-2.
  2553
  2554     MOVE WS-STR-DATE-BIN        TO  AT-PROMPT-START-DT.
  2555     MOVE WS-END-DATE-BIN        TO  AT-PROMPT-END-DT.
  2556     MOVE WS-TRAILER-KEY         TO  AT-CONTROL-PRIMARY.
  2557     MOVE PI-PROCESSOR-ID        TO  AT-RECORDED-BY
  2558                                     AT-PROMPT-LAST-UPDATED-BY.
  2559     MOVE EIBTIME                TO  AT-LAST-MAINT-HHMMSS.
  2560     MOVE SAVE-BIN-DATE          TO  AT-RECORDED-DT
  2561                                     AT-PROMPT-LAST-MAINT-DT.
  2562
  2563 3100-EXIT.
  2564      EXIT.
  2565
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  56
* EL153.cbl
  2567 3150-BUILD-TRAILER-SR.
  2568     MOVE 'AT'                   TO  AT-RECORD-ID.
  2569     MOVE '6'                    TO  AT-TRAILER-TYPE.
  2570
  2571     IF EL153A-NOTE-LENGTH (1) NOT > +0
  2572         MOVE SPACES             TO  AT-info-line-1
  2573     ELSE
  2574         MOVE EL153A-NOTE  (1)   TO  AT-info-line-1.
  2575
  2576     IF EL153A-NOTE-LENGTH (2) NOT > +0
  2577         MOVE SPACES             TO  AT-info-line-2
  2578     ELSE
  2579         MOVE EL153A-NOTE  (2)   TO  AT-info-line-2.
  2580
  2581     MOVE W-NOTE-TYPE-IND        TO  AT-INFO-TRAILER-TYPE.
  2582     move +92                    to  ws-key-sequence-no
  2583     MOVE WS-TRAILER-KEY         TO  AT-CONTROL-PRIMARY.
  2584     MOVE PI-PROCESSOR-ID        TO  AT-RECORDED-BY
  2585                                     AT-GEN-INFO-LAST-UPDATED-BY.
  2586     MOVE EIBTIME                TO  AT-LAST-MAINT-HHMMSS.
  2587     MOVE SAVE-BIN-DATE          TO  AT-RECORDED-DT
  2588                                     AT-GEN-INFO-LAST-MAINT-DT
  2589     .
  2590 3150-EXIT.
  2591      EXIT.
  2592
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  57
* EL153.cbl
  2594 3200-BUILD-GI-TRLR-LOOP.
  2595
  2596     SUBTRACT +1 FROM SUB.
  2597
  2598     IF SUB < +1
  2599         GO TO 3200-EXIT.
  2600
  2601     IF EL153A-NOTE-LENGTH (SUB) = +0
  2602         GO TO 3200-BUILD-GI-TRLR-LOOP.
  2603
  2604     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  2605     MOVE 'AT'                   TO  AT-RECORD-ID.
  2606     MOVE '6'                    TO  AT-TRAILER-TYPE.
  2607
  2608     MOVE WS-TRAILER-KEY         TO  AT-CONTROL-PRIMARY.
  2609     MOVE PI-PROCESSOR-ID        TO  AT-RECORDED-BY
  2610                                     AT-GEN-INFO-LAST-UPDATED-BY.
  2611     MOVE W-NOTE-TYPE-IND        TO  AT-INFO-TRAILER-TYPE.
  2612     MOVE W-CALL-TYPE            TO  AT-CALL-TYPE.
  2613     MOVE EIBTIME                TO  AT-LAST-MAINT-HHMMSS.
  2614     MOVE SAVE-BIN-DATE          TO  AT-RECORDED-DT
  2615                                     AT-GEN-INFO-LAST-MAINT-DT.
  2616
  2617     IF WS-FIRST-TIME-SW = 'Y'
  2618         MOVE 'N'                TO  WS-FIRST-TIME-SW
  2619         IF SUB NOT = 1 AND 2
  2620             MOVE 'X'            TO AT-NOTE-CONTINUATION
  2621         END-IF
  2622         IF SUB = 1 OR 3 OR 5 OR 7 OR 9 OR 11 OR 13
  2623             MOVE EL153A-NOTE (SUB)  TO  AT-INFO-LINE-1
  2624             PERFORM 3000-REDUCE-SEQ THRU 3000-EXIT
  2625             MOVE CL-TRAILER-SEQ-CNT TO  AT-SEQUENCE-NO
  2626             PERFORM 7150-WRITE-TRAILER THRU 7199-EXIT
  2627             GO TO 3200-BUILD-GI-TRLR-LOOP
  2628         ELSE
  2629             MOVE EL153A-NOTE (SUB)  TO  AT-INFO-LINE-2
  2630             SUBTRACT +1             FROM SUB
  2631             MOVE EL153A-NOTE (SUB)  TO  AT-INFO-LINE-1
  2632             PERFORM 3000-REDUCE-SEQ THRU 3000-EXIT
  2633             MOVE CL-TRAILER-SEQ-CNT TO  AT-SEQUENCE-NO
  2634             PERFORM 7150-WRITE-TRAILER THRU 7199-EXIT
  2635             GO TO 3200-BUILD-GI-TRLR-LOOP.
  2636
  2637     MOVE EL153A-NOTE (SUB)      TO  AT-INFO-LINE-2.
  2638     SUBTRACT +1 FROM SUB.
  2639     MOVE EL153A-NOTE (SUB)      TO  AT-INFO-LINE-1.
  2640
  2641     IF SUB NOT = 1
  2642         MOVE 'X'                TO AT-NOTE-CONTINUATION.
  2643
  2644     PERFORM 3000-REDUCE-SEQ THRU 3000-EXIT.
  2645     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
  2646     PERFORM 7150-WRITE-TRAILER THRU 7199-EXIT.
  2647
  2648     GO TO 3200-BUILD-GI-TRLR-LOOP.
  2649
  2650 3200-EXIT.
  2651      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  58
* EL153.cbl
  2652
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  59
* EL153.cbl
  2654 4000-CHECK-INPUT-LOOP.
  2655
  2656      ADD +1 TO SUB.
  2657
  2658      IF SUB > +14
  2659          MOVE ER-0483           TO  EMI-ERROR
  2660          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2661          MOVE -1                TO  EL153A-NOTE-LENGTH (1)
  2662          GO TO 4000-CHECK-EXIT.
  2663
  2664      IF EL153A-NOTE-LENGTH (SUB) NOT > +0
  2665          GO TO 4000-CHECK-INPUT-LOOP.
  2666
  2667 4000-CHECK-EXIT.
  2668     EXIT.
  2669
  2670 4100-SQUASH-SCREEN.
  2671
  2672     IF SUB > +14
  2673         GO TO 4100-EXIT.
  2674
  2675     IF EL153A-NOTE-LENGTH (SUB) > +0
  2676         IF SUB = SUB-1
  2677             ADD +1              TO  SUB   SUB-1
  2678             GO TO 4100-SQUASH-SCREEN.
  2679
  2680     IF EL153A-NOTE-LENGTH (SUB) > +0
  2681         MOVE EL153A-NOTE-LENGTH (SUB)   TO
  2682                                      EL153A-NOTE-LENGTH (SUB-1)
  2683         MOVE EL153A-NOTE-ATTRB  (SUB)   TO
  2684                                      EL153A-NOTE-ATTRB  (SUB-1)
  2685         MOVE EL153A-NOTE        (SUB)   TO  EL153A-NOTE (SUB-1)
  2686         MOVE +0                         TO
  2687                                      EL153A-NOTE-LENGTH (SUB)
  2688         MOVE LOW-VALUES                 TO  EL153A-NOTE (SUB)
  2689         MOVE AL-UANOF                   TO
  2690                                      EL153A-NOTE-ATTRB  (SUB)
  2691         ADD +1                          TO  SUB   SUB-1
  2692     ELSE
  2693         ADD +1                          TO  SUB.
  2694
  2695     GO TO 4100-SQUASH-SCREEN.
  2696
  2697 4100-EXIT.
  2698     EXIT.
  2699
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  60
* EL153.cbl
  2701 6000-EXPAND-AIG-NOTES.
  2702
  2703     ADD +1 TO SUB.
  2704
  2705     IF SUB > +14
  2706         GO TO 6000-EXIT.
  2707
  2708     IF EL153A-NOTE-LENGTH (SUB) > +0
  2709         MOVE EL153A-NOTE (SUB)          TO  WS-EDIT-NOTE
  2710         INSPECT WS-EDIT-NOTE REPLACING ALL LOW-VALUES BY SPACES
  2711         IF WS-EDIT-NOTE-1-4 = 'APC '
  2712             MOVE 'AUTO-PAY CLAIM'       TO  EL153A-NOTE (SUB)
  2713         ELSE
  2714         IF WS-EDIT-NOTE-1-4 = 'MGR '
  2715             MOVE 'MANAGEMENT REVIEW'    TO  EL153A-NOTE (SUB)
  2716         ELSE
  2717         IF WS-EDIT-NOTE-1-4 = 'SVR '
  2718             MOVE 'SUPERVISOR REVIEW'    TO  EL153A-NOTE (SUB)
  2719         ELSE
  2720         IF WS-EDIT-NOTE-1-4 = 'OIO '
  2721             MOVE 'OUTSIDE INVESTIGATION ORDERED'
  2722                                         TO  EL153A-NOTE (SUB)
  2723         ELSE
  2724         IF WS-EDIT-NOTE-1-4 = 'LGR '
  2725             MOVE 'LEGAL REVIEW'         TO  EL153A-NOTE (SUB)
  2726         ELSE
  2727         IF WS-EDIT-NOTE-1-4 = 'FRN '
  2728             MOVE 'FORM REVIEWED/NO ADDITIONAL PAYMENT DUE AT THIS
  2729-                 ' TIME'                TO  EL153A-NOTE (SUB)
  2730         ELSE
  2731         IF WS-EDIT-NOTE-1-4 = 'PRB '
  2732             MOVE 'PHONE CALL RECEIVED--BRANCH'
  2733                                         TO  EL153A-NOTE (SUB)
  2734         ELSE
  2735         IF WS-EDIT-NOTE-1-4 = 'PRG '
  2736             MOVE 'PHONE CALL RECEIVED--GROUP'
  2737                                         TO  EL153A-NOTE (SUB)
  2738         ELSE
  2739         IF WS-EDIT-NOTE-1-4 = 'PRH '
  2740             MOVE 'PHONE CALL RECEIVED--HOSPITAL'
  2741                                         TO  EL153A-NOTE (SUB)
  2742         ELSE
  2743         IF WS-EDIT-NOTE-1-4 = 'PRI '
  2744             MOVE 'PHONE CALL RECEIVED--INSURED'
  2745                                         TO  EL153A-NOTE (SUB)
  2746         ELSE
  2747         IF WS-EDIT-NOTE-1-4 = 'PRO '
  2748             MOVE 'PHONE CALL RECEIVED--OTHER'
  2749                                         TO  EL153A-NOTE (SUB)
  2750         ELSE
  2751         IF WS-EDIT-NOTE-1-4 = 'PRP '
  2752             MOVE 'PHONE CALL RECEIVED--PHYSICIAN'
  2753                                         TO  EL153A-NOTE (SUB)
  2754         ELSE
  2755         IF WS-EDIT-NOTE-1-4 = 'PMB '
  2756             MOVE 'PHONE CALL MADE--BRANCH'
  2757                                         TO  EL153A-NOTE (SUB)
  2758         ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  61
* EL153.cbl
  2759         IF WS-EDIT-NOTE-1-4 = 'PMG '
  2760             MOVE 'PHONE CALL MADE--GROUP'
  2761                                         TO  EL153A-NOTE (SUB)
  2762         ELSE
  2763         IF WS-EDIT-NOTE-1-4 = 'PMH '
  2764             MOVE 'PHONE CALL MADE--HOSPITAL'
  2765                                         TO  EL153A-NOTE (SUB)
  2766         ELSE
  2767         IF WS-EDIT-NOTE-1-4 = 'PMI '
  2768             MOVE 'PHONE CALL MADE--INSURED'
  2769                                         TO  EL153A-NOTE (SUB)
  2770         ELSE
  2771         IF WS-EDIT-NOTE-1-4 = 'PMO '
  2772             MOVE 'PHONE CALL MADE--OTHER'
  2773                                         TO  EL153A-NOTE (SUB)
  2774         ELSE
  2775         IF WS-EDIT-NOTE-1-4 = 'PMP '
  2776             MOVE 'PHONE CALL MADE--PHYSICIAN'
  2777                                         TO  EL153A-NOTE (SUB)
  2778         ELSE
  2779         IF WS-EDIT-NOTE-1-3 = '01 '
  2780             MOVE 'CONTINUING CLAIM FORM RCVD'
  2781                                         TO  EL153A-NOTE (SUB)
  2782         ELSE
  2783         IF WS-EDIT-NOTE-1-3 = '02 '
  2784             MOVE 'ACCOUNT INFORMATION RCVD'
  2785                                         TO  EL153A-NOTE (SUB)
  2786         ELSE
  2787         IF WS-EDIT-NOTE-1-3 = '03 '
  2788             MOVE 'MEDICAL HISTORY RCVD'
  2789                                         TO  EL153A-NOTE (SUB)
  2790         ELSE
  2791         IF WS-EDIT-NOTE-1-3 = '04 '
  2792             MOVE 'INSURED INFO RCVD'
  2793                                         TO  EL153A-NOTE (SUB)
  2794         ELSE
  2795         IF WS-EDIT-NOTE-1-3 = '05 '
  2796             MOVE 'EMPLOYER INFO RCVD'
  2797                                         TO  EL153A-NOTE (SUB)
  2798         ELSE
  2799         IF WS-EDIT-NOTE-1-3 = '06 '
  2800             MOVE 'PARTIAL INVESTIGATION RCVD.  CLAIM IS STILL PEN
  2801-                 'DING'                 TO  EL153A-NOTE (SUB)
  2802         ELSE
  2803         IF WS-EDIT-NOTE-1-3 = '07 '
  2804             MOVE 'DEATH CERTIFICATE RCVD'
  2805                                         TO  EL153A-NOTE (SUB)
  2806         ELSE
  2807         IF WS-EDIT-NOTE-1-3 = '08 '
  2808             MOVE 'ATTORNEY LTR RCVD'
  2809                                         TO  EL153A-NOTE (SUB)
  2810         ELSE
  2811         IF WS-EDIT-NOTE-1-3 = '09 '
  2812             MOVE 'EXAM RESULTS RCVD'
  2813                                         TO  EL153A-NOTE (SUB)
  2814         ELSE
  2815         IF WS-EDIT-NOTE-1-3 = '10 '
  2816             MOVE 'INS DEPT INQUIRY RCVD'
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  62
* EL153.cbl
  2817                                         TO  EL153A-NOTE (SUB)
  2818         ELSE
  2819         IF WS-EDIT-NOTE-1-3 = '11 '
  2820             MOVE 'RETURNED MAIL RCVD'
  2821                                         TO  EL153A-NOTE (SUB)
  2822         ELSE
  2823         IF WS-EDIT-NOTE-1-3 = '12 '
  2824             MOVE 'INITIAL CLAIM RCVD'
  2825                                         TO  EL153A-NOTE (SUB).
  2826
  2827     GO TO 6000-EXPAND-AIG-NOTES.
  2828
  2829 6000-EXIT.
  2830     EXIT.
  2831
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  63
* EL153.cbl
  2833 7000-READ-UP-CLAIM.
  2834
  2835
  2836* EXEC CICS HANDLE CONDITION
  2837*        NOTFND    (7040-NOTFND)
  2838*        NOTOPEN   (9981-NOTOPEN-MSTR)
  2839*    END-EXEC.
  2840*    MOVE '"$IJ                  ! # #00002771' TO DFHEIV0
  2841     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  2842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2843     MOVE X'2320233030303032373731' TO DFHEIV0(25:11)
  2844     CALL 'kxdfhei1' USING DFHEIV0
  2845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2846
  2847
  2848
  2849* EXEC CICS READ
  2850*        DATASET   ('ELMSTR')
  2851*        RIDFLD    (WS-CLAIM-KEY)
  2852*        SET       (ADDRESS OF CLAIM-MASTER)
  2853*        UPDATE
  2854*    END-EXEC.
  2855     MOVE 'ELMSTR' TO DFHEIV1
  2856*    MOVE '&"S        EU         (   #00002776' TO DFHEIV0
  2857     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2858     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2859     MOVE X'2020233030303032373736' TO DFHEIV0(25:11)
  2860     CALL 'kxdfhei1' USING DFHEIV0,
  2861           DFHEIV1,
  2862           DFHEIV20,
  2863           DFHEIV99,
  2864           WS-CLAIM-KEY,
  2865           DFHEIV99,
  2866           DFHEIV99,
  2867           DFHEIV99
  2868     SET ADDRESS OF CLAIM-MASTER TO
  2869         DFHEIV20
  2870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2871
  2872
  2873     GO TO 7050-EXIT.
  2874
  2875 7040-NOTFND.
  2876
  2877     MOVE ER-0133                TO  EMI-ERROR.
  2878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2879     MOVE -1                     TO  EL153A-NOTE-LENGTH (1).
  2880     GO TO 8100-SEND-INITIAL-MAP.
  2881
  2882 7050-EXIT.
  2883     EXIT.
  2884
  2885 7055-REWRITE-CLAIM.
  2886
  2887
  2888* EXEC CICS HANDLE CONDITION
  2889*        DUPKEY   (7055-EXIT)
  2890*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  64
* EL153.cbl
  2891*    MOVE '"$$                   ! $ #00002797' TO DFHEIV0
  2892     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  2893     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2894     MOVE X'2420233030303032373937' TO DFHEIV0(25:11)
  2895     CALL 'kxdfhei1' USING DFHEIV0
  2896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2897
  2898
  2899
  2900* EXEC CICS REWRITE
  2901*        DATASET   ('ELMSTR')
  2902*        FROM      (CLAIM-MASTER)
  2903*    END-EXEC.
  2904     MOVE LENGTH OF
  2905      CLAIM-MASTER
  2906       TO DFHEIV11
  2907     MOVE 'ELMSTR' TO DFHEIV1
  2908*    MOVE '&& L                  %   #00002801' TO DFHEIV0
  2909     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2910     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2911     MOVE X'2020233030303032383031' TO DFHEIV0(25:11)
  2912     CALL 'kxdfhei1' USING DFHEIV0,
  2913           DFHEIV1,
  2914           CLAIM-MASTER,
  2915           DFHEIV11,
  2916           DFHEIV99
  2917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2918
  2919
  2920 7055-EXIT.
  2921     EXIT.
  2922
  2923 7100-GETMAIN-TRLR.
  2924
  2925* EXEC CICS GETMAIN
  2926*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  2927*        INITIMG  (GETMAIN-SPACE)
  2928*        LENGTH   (WS-TRLR-LENGTH)
  2929*    END-EXEC.
  2930*    MOVE ',"IL                  $   #00002810' TO DFHEIV0
  2931     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  2932     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2933     MOVE X'2020233030303032383130' TO DFHEIV0(25:11)
  2934     CALL 'kxdfhei1' USING DFHEIV0,
  2935           DFHEIV20,
  2936           WS-TRLR-LENGTH,
  2937           GETMAIN-SPACE
  2938     SET ADDRESS OF ACTIVITY-TRAILERS TO
  2939         DFHEIV20
  2940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2941
  2942
  2943 7100-EXIT.
  2944      EXIT.
  2945
  2946 7150-WRITE-TRAILER.
  2947
  2948
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  65
* EL153.cbl
  2949* EXEC CICS HANDLE CONDITION
  2950*        DUPREC    (7190-DUPREC)
  2951*        NOTOPEN   (9982-NOTOPEN-TRLR)
  2952*    END-EXEC.
  2953*    MOVE '"$%J                  ! % #00002821' TO DFHEIV0
  2954     MOVE X'2224254A2020202020202020' TO DFHEIV0(1:12)
  2955     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2956     MOVE X'2520233030303032383231' TO DFHEIV0(25:11)
  2957     CALL 'kxdfhei1' USING DFHEIV0
  2958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2959
  2960
  2961
  2962* EXEC CICS WRITE
  2963*        DATASET   ('ELTRLR')
  2964*        RIDFLD    (WS-TRAILER-KEY)
  2965*        FROM      (ACTIVITY-TRAILERS)
  2966*    END-EXEC.
  2967     MOVE LENGTH OF
  2968      ACTIVITY-TRAILERS
  2969       TO DFHEIV11
  2970     MOVE 'ELTRLR' TO DFHEIV1
  2971*    MOVE '&$ L                  ''   #00002826' TO DFHEIV0
  2972     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2973     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2974     MOVE X'2020233030303032383236' TO DFHEIV0(25:11)
  2975     CALL 'kxdfhei1' USING DFHEIV0,
  2976           DFHEIV1,
  2977           ACTIVITY-TRAILERS,
  2978           DFHEIV11,
  2979           WS-TRAILER-KEY,
  2980           DFHEIV99,
  2981           DFHEIV99
  2982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2983
  2984
  2985     GO TO 7199-EXIT.
  2986
  2987 7190-DUPREC.
  2988
  2989     if w-note-type = 'S'
  2990        MOVE ER-7846             TO EMI-ERROR
  2991        MOVE -1                  TO notetpl
  2992        PERFORM 9900-ERROR-FORMAT
  2993                                 THRU 9900-EXIT
  2994        GO TO 8200-SEND-DATAONLY
  2995     else
  2996        PERFORM 3000-REDUCE-SEQ  THRU 3000-EXIT
  2997        GO TO 7150-WRITE-TRAILER
  2998     end-if
  2999     .
  3000 7199-EXIT.
  3001     EXIT.
  3002
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  66
* EL153.cbl
  3004 8100-SEND-INITIAL-MAP.
  3005     MOVE EIBTIME                TO  TIME-IN.
  3006     MOVE WS-HOUR                TO  WS-TRANS-HOUR.
  3007     MOVE WS-MINUTE              TO  WS-TRANS-MINUTE.
  3008     MOVE TIME-OUT               TO  MRNTIMEO.
  3009     MOVE SAVE-DATE              TO  MRNDATEO.
  3010     MOVE PI-CERT-NO             TO  MCERTO.
  3011
  3012
  3013* EXEC CICS SEND
  3014*        MAP      (WS-MAP-NAME)
  3015*        MAPSET   (WS-MAPSET-NAME)
  3016*        FROM     (EL153AI)
  3017*        FREEKB
  3018*        ERASE
  3019*        CURSOR
  3020*    END-EXEC.
  3021     MOVE LENGTH OF
  3022      EL153AI
  3023       TO DFHEIV12
  3024     MOVE -1
  3025       TO DFHEIV11
  3026*    MOVE '8$     CT  E F  H L F ,   #00002859' TO DFHEIV0
  3027     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3028     MOVE X'2046202048204C2046202C20' TO DFHEIV0(13:12)
  3029     MOVE X'2020233030303032383539' TO DFHEIV0(25:11)
  3030     CALL 'kxdfhei1' USING DFHEIV0,
  3031           WS-MAP-NAME,
  3032           EL153AI,
  3033           DFHEIV12,
  3034           WS-MAPSET-NAME,
  3035           DFHEIV99,
  3036           DFHEIV99,
  3037           DFHEIV99,
  3038           DFHEIV11,
  3039           DFHEIV99,
  3040           DFHEIV99,
  3041           DFHEIV99
  3042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3043
  3044
  3045     GO TO 9100-RETURN-TRANS.
  3046 8100-EXIT.
  3047     EXIT.
  3048
  3049 8200-SEND-DATAONLY.
  3050     MOVE EIBTIME                TO  TIME-IN.
  3051     MOVE WS-HOUR                TO  WS-TRANS-HOUR.
  3052     MOVE WS-MINUTE              TO  WS-TRANS-MINUTE.
  3053     MOVE TIME-OUT               TO  MRNTIMEO.
  3054     MOVE SAVE-DATE              TO  MRNDATEO.
  3055     MOVE PI-CERT-NO             TO  MCERTO.
  3056
  3057
  3058* EXEC CICS SEND
  3059*        MAP      (WS-MAP-NAME)
  3060*        MAPSET   (WS-MAPSET-NAME)
  3061*        FROM     (EL153AI)
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  67
* EL153.cbl
  3062*        FREEKB
  3063*        DATAONLY
  3064*        CURSOR
  3065*    END-EXEC.
  3066     MOVE LENGTH OF
  3067      EL153AI
  3068       TO DFHEIV12
  3069     MOVE -1
  3070       TO DFHEIV11
  3071*    MOVE '8$D    CT    F  H L F ,   #00002880' TO DFHEIV0
  3072     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3073     MOVE X'2046202048204C2046202C20' TO DFHEIV0(13:12)
  3074     MOVE X'2020233030303032383830' TO DFHEIV0(25:11)
  3075     CALL 'kxdfhei1' USING DFHEIV0,
  3076           WS-MAP-NAME,
  3077           EL153AI,
  3078           DFHEIV12,
  3079           WS-MAPSET-NAME,
  3080           DFHEIV99,
  3081           DFHEIV99,
  3082           DFHEIV99,
  3083           DFHEIV11,
  3084           DFHEIV99,
  3085           DFHEIV99,
  3086           DFHEIV99
  3087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3088
  3089
  3090     GO TO 9100-RETURN-TRANS.
  3091
  3092 8200-EXIT.
  3093     EXIT.
  3094
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  68
* EL153.cbl
  3096 8300-SEND-TEXT.
  3097
  3098* EXEC CICS SEND TEXT
  3099*        FROM     (LOGOFF-TEXT)
  3100*        ERASE
  3101*        FREEKB
  3102*        LENGTH   (LOGOFF-LENGTH)
  3103*    END-EXEC.
  3104*    MOVE '8&      T  E F  H   F -   #00002896' TO DFHEIV0
  3105     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3106     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3107     MOVE X'2020233030303032383936' TO DFHEIV0(25:11)
  3108     CALL 'kxdfhei1' USING DFHEIV0,
  3109           LOGOFF-TEXT,
  3110           LOGOFF-LENGTH,
  3111           DFHEIV99,
  3112           DFHEIV99,
  3113           DFHEIV99,
  3114           DFHEIV99,
  3115           DFHEIV99,
  3116           DFHEIV99,
  3117           DFHEIV99,
  3118           DFHEIV99,
  3119           DFHEIV99,
  3120           DFHEIV99
  3121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3122
  3123
  3124
  3125* EXEC CICS RETURN
  3126*    END-EXEC.
  3127*    MOVE '.(                    ''   #00002903' TO DFHEIV0
  3128     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3129     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3130     MOVE X'2020233030303032393033' TO DFHEIV0(25:11)
  3131     CALL 'kxdfhei1' USING DFHEIV0,
  3132           DFHEIV99,
  3133           DFHEIV99,
  3134           DFHEIV99,
  3135           DFHEIV99,
  3136           DFHEIV99,
  3137           DFHEIV99
  3138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3139
  3140
  3141 8300-EXIT.
  3142      EXIT.
  3143
  3144 8500-DATE-CONVERSION.
  3145
  3146* EXEC CICS LINK
  3147*           PROGRAM  ('ELDATCV')
  3148*           COMMAREA (DATE-CONVERSION-DATA)
  3149*           LENGTH   (DC-COMM-LENGTH)
  3150*    END-EXEC.
  3151     MOVE 'ELDATCV' TO DFHEIV1
  3152*    MOVE '."C                   (   #00002910' TO DFHEIV0
  3153     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  69
* EL153.cbl
  3154     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3155     MOVE X'2020233030303032393130' TO DFHEIV0(25:11)
  3156     CALL 'kxdfhei1' USING DFHEIV0,
  3157           DFHEIV1,
  3158           DATE-CONVERSION-DATA,
  3159           DC-COMM-LENGTH,
  3160           DFHEIV99,
  3161           DFHEIV99,
  3162           DFHEIV99,
  3163           DFHEIV99
  3164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3165
  3166
  3167 8500-EXIT.
  3168      EXIT.
  3169
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  70
* EL153.cbl
  3171 9000-UNAUTHERR.
  3172     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3173     GO TO 8300-SEND-TEXT.
  3174
  3175 9100-RETURN-TRANS.
  3176
  3177* EXEC CICS RETURN
  3178*        TRANSID  (WS-TRANS-ID)
  3179*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3180*        LENGTH   (PI-COMM-LENGTH)
  3181*    END-EXEC.
  3182*    MOVE '.(CT                  ''   #00002925' TO DFHEIV0
  3183     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3184     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3185     MOVE X'2020233030303032393235' TO DFHEIV0(25:11)
  3186     CALL 'kxdfhei1' USING DFHEIV0,
  3187           WS-TRANS-ID,
  3188           PROGRAM-INTERFACE-BLOCK,
  3189           PI-COMM-LENGTH,
  3190           DFHEIV99,
  3191           DFHEIV99,
  3192           DFHEIV99
  3193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3194
  3195
  3196 9100-EXIT.
  3197      EXIT.
  3198
  3199 9300-XCTL.
  3200
  3201* EXEC CICS XCTL
  3202*        PROGRAM  (THIS-PGM)
  3203*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3204*        LENGTH   (PI-COMM-LENGTH)
  3205*    END-EXEC.
  3206*    MOVE '.$C                   %   #00002935' TO DFHEIV0
  3207     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3208     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3209     MOVE X'2020233030303032393335' TO DFHEIV0(25:11)
  3210     CALL 'kxdfhei1' USING DFHEIV0,
  3211           THIS-PGM,
  3212           PROGRAM-INTERFACE-BLOCK,
  3213           PI-COMM-LENGTH,
  3214           DFHEIV99
  3215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3216
  3217
  3218 9300-EXIT.
  3219      EXIT.
  3220
  3221 9400-CLEAR.
  3222     MOVE DFHENTER              TO  EIBAID.
  3223     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM.
  3224     GO TO 9300-XCTL.
  3225
  3226 9400-EXIT.
  3227     EXIT.
  3228
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  71
* EL153.cbl
  3230 9600-PGMIDERR.
  3231
  3232* EXEC CICS HANDLE CONDITION
  3233*        PGMIDERR (8300-SEND-TEXT)
  3234*    END-EXEC.
  3235*    MOVE '"$L                   ! & #00002954' TO DFHEIV0
  3236     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3238     MOVE X'2620233030303032393534' TO DFHEIV0(25:11)
  3239     CALL 'kxdfhei1' USING DFHEIV0
  3240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3241
  3242
  3243     MOVE THIS-PGM               TO  LOGOFF-PGM
  3244                                     PI-CALLING-PROGRAM.
  3245     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  3246     MOVE 'EL005'                TO  THIS-PGM.
  3247     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  3248     GO TO 9300-XCTL.
  3249
  3250 9600-EXIT.
  3251      EXIT.
  3252
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  72
* EL153.cbl
  3254 9900-ERROR-FORMAT.
  3255
  3256* EXEC CICS LINK
  3257*        PROGRAM  ('EL001')
  3258*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  3259*        LENGTH   (EMI-COMM-LENGTH)
  3260*    END-EXEC.
  3261     MOVE 'EL001' TO DFHEIV1
  3262*    MOVE '."C                   (   #00002970' TO DFHEIV0
  3263     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3264     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3265     MOVE X'2020233030303032393730' TO DFHEIV0(25:11)
  3266     CALL 'kxdfhei1' USING DFHEIV0,
  3267           DFHEIV1,
  3268           ERROR-MESSAGE-INTERFACE-BLOCK,
  3269           EMI-COMM-LENGTH,
  3270           DFHEIV99,
  3271           DFHEIV99,
  3272           DFHEIV99,
  3273           DFHEIV99
  3274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3275
  3276
  3277     MOVE EMI-LINE1          TO MERMSG1O.
  3278     MOVE EMI-LINE2          TO MERMSG2O.
  3279
  3280 9900-EXIT.
  3281      EXIT.
  3282
  3283 9981-NOTOPEN-MSTR.
  3284     MOVE ER-0154                TO  EMI-ERROR.
  3285     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3286     MOVE -1                     TO  MPFNUMBL.
  3287     GO TO 8100-SEND-INITIAL-MAP.
  3288
  3289 9981-EXIT.
  3290      EXIT.
  3291
  3292 9982-NOTOPEN-TRLR.
  3293     MOVE ER-0172                TO  EMI-ERROR.
  3294     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3295     MOVE -1                     TO  MPFNUMBL.
  3296     GO TO 8100-SEND-INITIAL-MAP.
  3297
  3298 9990-ERROR.
  3299
  3300* EXEC CICS LINK
  3301*        PROGRAM  ('EL004')
  3302*        COMMAREA (DFHEIBLK)
  3303*        LENGTH   (64)
  3304*    END-EXEC.
  3305     MOVE 'EL004' TO DFHEIV1
  3306     MOVE 64
  3307       TO DFHEIV11
  3308*    MOVE '."C                   (   #00002998' TO DFHEIV0
  3309     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3310     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3311     MOVE X'2020233030303032393938' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  73
* EL153.cbl
  3312     CALL 'kxdfhei1' USING DFHEIV0,
  3313           DFHEIV1,
  3314           DFHEIBLK,
  3315           DFHEIV11,
  3316           DFHEIV99,
  3317           DFHEIV99,
  3318           DFHEIV99,
  3319           DFHEIV99
  3320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3321
  3322
  3323     GO TO 8200-SEND-DATAONLY.
  3324
  3325 9995-SECURITY-VIOLATION.
  3326*                            COPY ELCSCTP SUPPRESS.
  3327******************************************************************
  3328*                                                                *
  3329*                            ELCSCTP                             *
  3330*                            VMOD=2.001                          *
  3331*                                                                *
  3332*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3333******************************************************************
  3334
  3335
  3336     MOVE EIBDATE          TO SM-JUL-DATE.
  3337     MOVE EIBTRMID         TO SM-TERMID.
  3338     MOVE THIS-PGM         TO SM-PGM.
  3339     MOVE EIBTIME          TO TIME-IN.
  3340     MOVE TIME-OUT         TO SM-TIME.
  3341     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3342
  3343
  3344* EXEC CICS LINK
  3345*         PROGRAM  ('EL003')
  3346*         COMMAREA (SECURITY-MESSAGE)
  3347*         LENGTH   (80)
  3348*    END-EXEC.
  3349     MOVE 'EL003' TO DFHEIV1
  3350     MOVE 80
  3351       TO DFHEIV11
  3352*    MOVE '."C                   (   #00003024' TO DFHEIV0
  3353     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3354     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3355     MOVE X'2020233030303033303234' TO DFHEIV0(25:11)
  3356     CALL 'kxdfhei1' USING DFHEIV0,
  3357           DFHEIV1,
  3358           SECURITY-MESSAGE,
  3359           DFHEIV11,
  3360           DFHEIV99,
  3361           DFHEIV99,
  3362           DFHEIV99,
  3363           DFHEIV99
  3364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3365
  3366
  3367******************************************************************
  3368
  3369
* Micro Focus Server Express         V5.1 revision 000 24-Oct-18 10:43 Page  74
* EL153.cbl
  3370
  3371 9999-DFHBACK SECTION.
  3372     MOVE '9%                    "   ' TO DFHEIV0
  3373     MOVE 'EL153' TO DFHEIV1
  3374     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3375     GOBACK.
  3376 9999-DFHEXIT.
  3377     IF DFHEIGDJ EQUAL 0001
  3378         NEXT SENTENCE
  3379     ELSE IF DFHEIGDJ EQUAL 2
  3380         GO TO 9990-ERROR,
  3381               9600-PGMIDERR
  3382         DEPENDING ON DFHEIGDI
  3383     ELSE IF DFHEIGDJ EQUAL 3
  3384         GO TO 7040-NOTFND,
  3385               9981-NOTOPEN-MSTR
  3386         DEPENDING ON DFHEIGDI
  3387     ELSE IF DFHEIGDJ EQUAL 4
  3388         GO TO 7055-EXIT
  3389         DEPENDING ON DFHEIGDI
  3390     ELSE IF DFHEIGDJ EQUAL 5
  3391         GO TO 7190-DUPREC,
  3392               9982-NOTOPEN-TRLR
  3393         DEPENDING ON DFHEIGDI
  3394     ELSE IF DFHEIGDJ EQUAL 6
  3395         GO TO 8300-SEND-TEXT
  3396         DEPENDING ON DFHEIGDI.
  3397     MOVE '9%                    "   ' TO DFHEIV0
  3398     MOVE 'EL153' TO DFHEIV1
  3399     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3400     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5164     Code:        8648
