* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33******************************************************************
    34 ENVIRONMENT DIVISION.
    35
    36 DATA DIVISION.
    37 WORKING-STORAGE SECTION.
    38 01  DFH-START PIC X(04).
    39 77  FILLER  PIC X(32)  VALUE '********************************'.
    40 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    41 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    42 77  s1                          pic s999 comp-3 value +0.
    43 77  s2                          pic s999 comp-3 value +0.
    44 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    45 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    46 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    47 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    48 77  ws-browse-sw                pic x value spaces.
    49     88  i-say-when                 value 'Y'.
    50 77  ws-delete-sw                pic x value ' '.
    51     88  row-deleted                 value 'Y'.
    52 77  ws-sql-code                 pic s9(7) value zeros.
    53 77  ws-dis-sql-code             pic -9999999 value zeros.
    54 77  ws-match-sw                 pic x  value ' '.
    55     88  found-a-match             value 'Y'.
    56 77  ws-commit-sw                pic x value ' '.
    57     88  tbl-commited                value 'Y'.
    58 01  P pointer.
    59 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    60 01  var-ptr pointer.
    61 01  env-var-len                 pic 9(4)  binary.
    62 01  rc                          pic 9(9)  binary.
    63
    64 01  WS-KIXSYS.
    65     05  WS-KIX-FIL1             PIC X(10).
    66     05  WS-KIX-APPS             PIC X(10).
    67     05  WS-KIX-ENV              PIC X(10).
    68     05  WS-KIX-MYENV            PIC X(10).
    69     05  WS-KIX-SYS              PIC X(10).
*   70 EXEC SQL
*   71    INCLUDE SQLDA
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page   3
* EL677.cbl
*   72 END-EXEC
    73 01 SQLDA sync.
    74    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    75    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    76    05 SQLN                  PIC S9(4) COMP-5 value 0.
    77    05 SQLD                  PIC S9(4) COMP-5 value 0.
    78    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    79       10 SQLTYPE            PIC S9(4) COMP-5.
    80       10 SQLLEN             PIC S9(4) COMP-5.
    81$IF P64 SET
    82X      *> For 64-bit environments, ensure that SQLDATA is
    83X      *> aligned on an 8-byte boundary.
    84X      10 FILLER             PIC S9(9) COMP-5.
    85$END
    86       10 SQLDATA            USAGE POINTER.
    87       10 SQLIND             USAGE POINTER.
    88       10 SQLNAME.
    89          15 SQLNAMEL        PIC S9(4) COMP-5.
    90          15 SQLNAMEC        PIC X(30).
    91
    92* Values for SQLTYPE
    93
    94 78  ESQL-DATE-CHAR              VALUE 384.
    95 78  ESQL-DATE-CHAR-NULL         VALUE 385.
    96 78  ESQL-DATE-REC               VALUE 386.
    97 78  ESQL-DATE-REC-NULL          VALUE 387.
    98 78  ESQL-TIME-CHAR              VALUE 388.
    99 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   100 78  ESQL-TIME-REC               VALUE 390.
   101 78  ESQL-TIME-REC-NULL          VALUE 391.
   102 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   103 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   104 78  ESQL-TIMESTAMP-REC          VALUE 394.
   105 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   106 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   107 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   108 78  ESQL-TS-OFFSET-REC          VALUE 398.
   109 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   110 78  ESQL-LONGVARBINARY          VALUE 404.
   111 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   112 78  ESQL-LONGVARCHAR            VALUE 408.
   113 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   114 78  ESQL-BINARY                 VALUE 444.
   115 78  ESQL-BINARY-NULL            VALUE 445.
   116 78  ESQL-VARBINARY              VALUE 446.
   117 78  ESQL-VARBINARY-NULL         VALUE 447.
   118 78  ESQL-VARCHAR                VALUE 448.
   119 78  ESQL-VARCHAR-NULL           VALUE 449.
   120
   121 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   122 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   123
   124 78  ESQL-CHAR                   VALUE 452.
   125 78  ESQL-CHAR-NULL              VALUE 453.
   126
   127 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   128 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   129
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-DOUBLE                 VALUE 480.
   131 78  ESQL-DOUBLE-NULL            VALUE 481.
   132 78  ESQL-REAL                   VALUE 482.
   133 78  ESQL-REAL-NULL              VALUE 483.
   134 78  ESQL-DECIMAL                VALUE 484.
   135 78  ESQL-DECIMAL-NULL           VALUE 485.
   136 78  ESQL-INTEGER                VALUE 496.
   137 78  ESQL-INTEGER-NULL           VALUE 497.
   138 78  ESQL-SMALLINT               VALUE 500.
   139 78  ESQL-SMALLINT-NULL          VALUE 501.
   140 78  ESQL-TINYINT                VALUE 502.
   141 78  ESQL-TINYINT-NULL           VALUE 503.
*  142 EXEC SQL
*  143    INCLUDE SQLCA
*  144 END-EXEC
   145 01 SQLCA.
   146     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   147     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   148     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   149     05  SQLERRM.
   150         49  SQLERRML    PIC S9(4) COMP-5.
   151         49  SQLERRMC    PIC X(70).
   152     05  SQLERRP         PIC X(8).
   153     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   154     05  SQLWARN.
   155         10  SQLWARN0    PIC X.
   156         10  SQLWARN1    PIC X.
   157         10  SQLWARN2    PIC X.
   158         10  SQLWARN3    PIC X.
   159         10  SQLWARN4    PIC X.
   160         10  SQLWARN5    PIC X.
   161         10  SQLWARN6    PIC X.
   162         10  SQLWARN7    PIC X.
   163     05  SQLEXT.
   164         10  SQLWARN8    PIC X.
   165         10  SQLWARN9    PIC X.
   166         10  SQLWARN10   PIC X.
   167         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   168     05  SQLSTATE    PIC X(5).
   169 EXEC SQL
   170    BEGIN DECLARE SECTION
   171 END-EXEC
   172 01  ws-paid-bank-work-area.
   173     05  ws-pb-compid            pic x(9).
   174     05  ws-pb-check-no          pic x(10).
   175     05  ws-pb-bad-check-no      pic x(10).
   176     05  ws-check-amount         pic x(10).
   177 01  Paid-Bank-Info.
   178     05  pb-check-no             pic 9(10).
   179     05  pb-tran-type            pic x.
   180     05  pb-bank-acct-desc       pic x(50).
   181     05  pb-amount               pic x(12).
   182     05  pb-paid-date            pic x(25).
   183 01  ws-key-stuff.
   184     05  ws-compid               pic xxx.
   185     05  ws-carrier              pic x.
   186     05  ws-grouping             pic x(6).
   187     05  ws-state                pic xx.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page   5
* EL677.cbl
   188     05  ws-account              pic x(10).
   189     05  ws-eff-date             pic x(10).
   190     05  ws-certificate          pic x(10).
   191     05  ws-cert-sfx             pic x.
   192     05  ws-seq-no               pic 999.
   193     05  ws-type                 pic x.
   194 01  sqlcmd                      pic x(1024).
   195 01  WS-MOE-DATE                 pic x(10).
   196 01  svr                         pic x(32).
   197 01  usr                         pic x(32).
   198 01  pass                        pic x(32).
   199 01  usr-pass                    pic x(64).
   200 01  ws-disp-code                pic s9(11).
   201***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   202***                                                            ***
   203***  These indicators are used to determine if a variable      ***
   204***  is passed nulls from sql. The indicator will be -1        ***
   205***  if the value on sql is nulls and +0 if the value is       ***
   206***  something other than nulls. Here is an example on how     ***
   207***  to use the indicator variables.                           ***
   208***                                                            ***
   209***     EXEC SQL                                               ***
   210***        fetch checkapp into                                 ***
   211***           :db-app-status :nu-app-status,                   ***
   212***           :db-app-by     :nu-app-by,                       ***
   213***           :db-app-date   :nu-app-date,                     ***
   214***           :db-app-batch  :nu-app-batch                     ***
   215***     END-EXEC                                               ***
   216***                                                            ***
   217***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   218 01  indicator-vaiables-for-nulls.
   219     05  nu-app-status           pic s9(4) comp value +0.
   220     05  nu-app-by               pic s9(4) comp value +0.
   221     05  nu-app-date             pic s9(4) comp value +0.
   222     05  nu-app-batch            pic s9(4) comp value +0.
   223     05  nu-fincar               pic s9(4) comp value +0.
   224 01  daily-check-request-rec.
   225     05  db-compid               pic xxx.
   226     05  db-carrier              pic x.
   227     05  db-grouping             pic x(6).
   228     05  db-state                pic xx.
   229     05  db-account              pic x(10).
   230     05  db-effdate              pic x(10).
   231     05  db-certificate          pic x(10).
   232     05  db-cert-sfx             pic x.
   233     05  db-seq-no               pic 999.
   234     05  db-type                 pic x.
   235     05  db-amount-n             pic 9(7).99.
   236     05  db-amount redefines db-amount-n
   237                                 pic x(10).
   238     05  db-checkno              pic x(15).
   239     05  db-checkdate            pic x(10).
   240     05  db-checkstatus          pic 9(5).
   241     05  db-releasebatch         pic 9(5).
   242     05  db-releasedt            pic x(10).
   243     05  db-releaseby            pic x(4).
   244     05  db-payeename1           pic x(30).
   245     05  db-payeename2           pic x(30).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page   6
* EL677.cbl
   246     05  db-payeeaddr1           pic x(30).
   247     05  db-payeeaddr2           pic x(30).
   248     05  db-payeecity            pic x(30).
   249     05  db-payeest              pic xx.
   250     05  db-payeezip             pic x(10).
   251     05  db-fincar               pic x.
   252     05  db-fingrp               pic x(6).
   253     05  db-finresp              pic x(10).
   254     05  db-finacct              pic x(10).
   255     05  db-preparer             pic x(4).
   256     05  db-app-status           pic x(9).
   257     05  dp-app-status-n redefines db-app-status
   258                                 pic 9(9).
   259     05  db-app-by               pic x(20).
   260     05  db-app-date             pic x(30).
   261     05  db-app-batch            pic x(10).
   262     05  db-return-to            pic x(30).
   263     05  db-insured-name         pic x(30).
   264 EXEC SQL
   265    END DECLARE SECTION
   266 END-EXEC
   267*                            COPY ELCSCTM.
   268******************************************************************
   269*                                                                *
   270*                                                                *
   271*                            ELCSCTM                             *
   272*                            VMOD=2.001                          *
   273*                                                                *
   274*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   275*                                                                *
   276******************************************************************
   277 01  SECURITY-MESSAGE.
   278     12  FILLER                          PIC X(30)
   279            VALUE '** LOGIC SECURITY VIOLATION -'.
   280     12  SM-READ                         PIC X(6).
   281     12  FILLER                          PIC X(5)
   282            VALUE ' PGM='.
   283     12  SM-PGM                          PIC X(6).
   284     12  FILLER                          PIC X(5)
   285            VALUE ' OPR='.
   286     12  SM-PROCESSOR-ID                 PIC X(4).
   287     12  FILLER                          PIC X(6)
   288            VALUE ' TERM='.
   289     12  SM-TERMID                       PIC X(4).
   290     12  FILLER                          PIC XX   VALUE SPACE.
   291     12  SM-JUL-DATE                     PIC 9(5).
   292     12  FILLER                          PIC X    VALUE SPACE.
   293     12  SM-TIME                         PIC 99.99.
   294
   295*                            COPY ELCSCRTY.
   296******************************************************************
   297*                                                                *
   298*                                                                *
   299*                            ELCSCRTY                            *
   300*                            VMOD=2.001                          *
   301*                                                                *
   302*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   303*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page   7
* EL677.cbl
   304*        SAVED IN PI-SECURITY-ADDRESS.                           *
   305*                                                                *
   306******************************************************************
   307 01  SECURITY-CONTROL.
   308     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   309     12  FILLER                       PIC XX    VALUE 'SC'.
   310     12  SC-CREDIT-CODES.
   311         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   312             20  SC-CREDIT-DISPLAY    PIC X.
   313             20  SC-CREDIT-UPDATE     PIC X.
   314     12  SC-CLAIMS-CODES.
   315         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   316             20  SC-CLAIMS-DISPLAY    PIC X.
   317             20  SC-CLAIMS-UPDATE     PIC X.
   318 01  ws-dummy-erchek             pic x(600).
   319 01  filler.
   320     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   321     05  WS-CHECK-AMT-TMPX REDEFINES
   322         WS-CHECK-AMT-TMP        PIC X(10).
   323     05  ws-ind                     pic s9(4) comp value +0.
   324     05  ws-ind-red redefines ws-ind pic xx.
   325     05  ws-display-ind             pic s9(7) value zeros.
   326 01  ws-compare-erchek-key          pic x(33) value low-values.
   327 01  ws-eracct-sw                   pic x value ' '.
   328     88  eracct-found                 value 'Y'.
   329 01  ws-eracct-start-sw             pic x value ' '.
   330     88  eracct-start                 value 'Y'.
   331 01  WS-DATE-AREA.
   332     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   333     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   334     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   335
   336 01  ws-work-amt-alpha           pic x(10).
   337 01  ws-work-amt-num redefines ws-work-amt-alpha
   338                                 pic 9(8)v99.
   339 01  ws-user-defined.
   340     05  ws-user-reason         pic xxx.
   341     05  ws-user-cert-no        pic x(11).
   342     05  ws-user-name           pic x(28).
   343 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   344 01  STANDARD-AREAS.
   345     12  ws-connect-sw               pic x  value ' '.
   346         88  connected-to-db             value 'Y'.
   347     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   348     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   349     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   350     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   351     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   352     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   353     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   354     12  EL1273-TRANS-ID             PIC X(4)    VALUE 'EXX3'.
   355     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   356     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   357     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   358     12  TIME-OUT-R  REDEFINES TIME-IN.
   359         16  FILLER                  PIC X.
   360         16  TIME-OUT                PIC 99V99.
   361         16  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page   8
* EL677.cbl
   362     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   363     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   364     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   365     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   366     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   367     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   368     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   369     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   370     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   371     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   372     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   373     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   374     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   375     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   376     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   377     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   378     12  ERPNDM-FILE-ID              PIC X(8)    VALUE 'ERPNDM'.
   379     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   380     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   381     12  WS-KEY-LENGTH               PIC S9(4)   VALUE +28   COMP.
   382     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   383     12  QID.
   384         16  QID-TERM                PIC X(4)    VALUE SPACES.
   385         16  FILLER                  PIC X(4)    VALUE '677A'.
   386
   387 01  WORK-AREAS.
   388     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   389     12  WS-AM-WK REDEFINES WS-AM-WORK.
   390         16  WS-AM-NUM               PIC S9(7)V99.
   391         16  WS-AM-SIGN              PIC X.
   392     12  WS-CHECK-WORK.
   393         16  FILLER                  PIC X        VALUE SPACE.
   394         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   395     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   396     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   397     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   398     12  WS-AMT-PAID                 PIC S9(7)V99 VALUE +0.
   399     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   400     12  WS-SV-CARRIER               PIC X       VALUE SPACES.
   401     12  WS-SV-GROUPING              PIC X(6)    VALUE SPACES.
   402     12  WS-SV-STATE                 PIC XX      VALUE SPACES.
   403     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   404     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   405     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   406         WS-DT-DEEDIT-FIELD.
   407         16  FILLER                  PIC X(4).
   408         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   409     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   410     12  WS-DEEDIT-FIELD-V0          REDEFINES
   411         WS-DEEDIT-FIELD-A           PIC S9(15).
   412
   413     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   414     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   415         88 WS-CERT-FOUND                        VALUE 'Y'.
   416         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   417     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   418         88 WS-PNDB-FOUND                        VALUE 'Y'.
   419         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page   9
* EL677.cbl
   420     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   421         88  WS-PROCESS-CERT                     VALUE 'Y'.
   422     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   423         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   424     12  WS-PY-ENTRY-COMMENT.
   425         16  WS-PY-CURRENT-DATE      PIC X(6)    VALUE SPACES.
   426         16  FILLER                  PIC X(13)   VALUE
   427            ' MISC. CHECK '.
   428         16  WS-PY-CURRENT-CERT      PIC X(10)   VALUE SPACES.
   429         16  WS-PY-CURRENT-SUFFIX    PIC X       VALUE SPACE.
   430     12  WS-PY-REF-COMMENT.
   431         16  WS-PY-REF-DATE          PIC X(6)    VALUE SPACES.
   432         16  FILLER                  PIC X(13)   VALUE
   433            ' REFUND PYMT '.
   434         16  WS-PY-REF-CERT          PIC X(10)   VALUE SPACES.
   435         16  WS-PY-REF-SUFFIX        PIC X       VALUE SPACE.
   436     12  WS-PY-END-COMMENT.
   437         16  WS-PY-END-DATE          PIC X(6)    VALUE SPACES.
   438         16  FILLER                  PIC X(13)   VALUE
   439            ' ENDORSEMENT '.
   440         16  WS-PY-END-CERT          PIC X(10)   VALUE SPACES.
   441         16  WS-PY-END-SUFFIX        PIC X       VALUE SPACE.
   442     12  WS-PY-DED-COMMENT.
   443         16  WS-PY-DED-DATE          PIC X(6)    VALUE SPACES.
   444         16  FILLER                  PIC X(13)   VALUE
   445            ' STAT DEDUCT '.
   446         16  WS-PY-DED-CERT          PIC X(10)   VALUE SPACES.
   447         16  WS-PY-DED-SUFFIX        PIC X       VALUE SPACE.
   448     12  WS-PY-ADDL-COMMENT.
   449         16  WS-PY-ADDL-DATE         PIC X(6)    VALUE SPACES.
   450         16  FILLER                  PIC X(13)   VALUE
   451            ' ADDL CHARGE '.
   452         16  WS-PY-ADDL-CERT         PIC X(10)   VALUE SPACES.
   453         16  WS-PY-ADDL-SUFFIX       PIC X       VALUE SPACE.
   454     12  WS-PY-REVERSAL-COMMENT.
   455         16  WS-PY-REVERSAL-DATE     PIC X(6)    VALUE SPACES.
   456         16  WS-PY-REVERSAL-TYPE     PIC X(13)   VALUE
   457            ' VOID REFUND '.
   458         16  WS-PY-REVERSAL-CERT     PIC X(10)   VALUE SPACES.
   459         16  WS-PY-REVERSAL-SUFFIX   PIC X       VALUE SPACE.
   460     12  WS-TMS-ENTRY-COMMENT.
   461         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   462         16  FILLER                  PIC XX      VALUE SPACES.
   463         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   464     12  WS-ZIP-CODE.
   465         16  WS-ZIP-PRIME.
   466             20  WS-ZIP-PRI-1ST      PIC X.
   467                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   468             20  FILLER              PIC X(4).
   469         16  WS-ZIP-PLUS4            PIC X(4).
   470     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   471         16  WS-CAN-POST1-1          PIC XXX.
   472         16  WS-CAN-POST1-2.
   473             20  WS-CAN-POST-4TH     PIC X.
   474             20  FILLER              PIC XX.
   475         16  FILLER                  PIC XXX.
   476     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   477         16  WS-CAN-POST2-1          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  10
* EL677.cbl
   478         16  FILLER                  PIC X.
   479         16  WS-CAN-POST2-2          PIC XXX.
   480         16  FILLER                  PIC XX.
   481
   482*                                    COPY ELCNWA.
   483*****************************************************************
   484*                                                               *
   485*                                                               *
   486*                            ELCNWA.                            *
   487*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   488*                            VMOD=2.003                         *
   489*                                                               *
   490*            M O V E   N A M E   W O R K   A R E A.             *
   491*                                                               *
   492*****************************************************************.
   493
   494 01  WS-NAME-WORK-AREA.
   495     05  WS-INSURED-LAST-NAME        PIC X(15).
   496     05  WS-INSURED-1ST-NAME         PIC X(12).
   497     05  WS-INSURED-MID-INIT         PIC X.
   498
   499     05  WS-NAME-WORK.
   500         10  WS-NW                   PIC X
   501             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   502
   503     05  WS-NAME-WORK2.
   504         10  WS-NW2                  PIC X
   505             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   506                                        NWA-INDEX0.
   507
   508     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   509                                     COMP-3.
   510
   511 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   512     88  RESP-NORMAL                    VALUE +0.
   513     88  resp-file-notfnd               value +12.
   514     88  RESP-NOTFND                    VALUE +13.
   515     88  resp-duprec                    value +14.
   516     88  resp-dupkey                    value +15.
   517     88  resp-invreq                    value +16.
   518     88  RESP-NOTOPEN                   VALUE +19.
   519     88  RESP-ENDFILE                   VALUE +20.
   520     88  resp-lengtherr                 value +22.
   521 01  ACCESS-KEYS.
   522     12  ELCNTL-KEY.
   523         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   524         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   525         16 ELCNTL-ACCESS.
   526             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   527             20  FILLER              PIC X       VALUE SPACES.
   528             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   529         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   530
   531     12  ELCNTL-RECORD-LENGTH        PIC S9(4)   VALUE +750  COMP.
   532
   533     12  ERACCT-KEY.
   534         16  ERACCT-CO               PIC X       VALUE SPACES.
   535         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  11
* EL677.cbl
   536         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   537         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   538         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   539         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   540         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   541
   542     12  SAVE-ERACCT-KEY.
   543         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   544         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   545         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   546         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   547         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   548         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   549         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   550
   551     12  ERACCT-RECORD-LENGTH        PIC S9(4)   VALUE +2000 COMP.
   552
   553     12  ERCOMP-KEY.
   554         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   555         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   556         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   557         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   558         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   559         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   560
   561     12  ERCOMP-LENGTH               PIC S9(4)   VALUE +700  COMP.
   562
   563     12  ELCERT-KEY.
   564         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   565         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   566         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   567         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   568         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   569         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   570         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   571         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   572
   573     12  ELCERT-RECORD-LENGTH        PIC S9(4)   VALUE +450  COMP.
   574
   575     12  ERPNDB-PRIMARY-KEY.
   576         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   577         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   578         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   579         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   580
   581     12  ERPNDB-ALT-KEY.
   582         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   583         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   584         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
   585         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   586         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   587         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   588         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   589         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   590         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   591         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   592
   593     12  ERPNDB-RECORD-LENGTH        PIC S9(4)   VALUE +585  COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  12
* EL677.cbl
   594
   595     12  ERPNDM-PRIMARY-KEY.
   596         16 ERPNDM-COMPANY-CD        PIC X       VALUE SPACES.
   597         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   598         16 ERPNDM-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   599         16 ERPNDM-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   600
   601     12  ERPNDM-RECORD-LENGTH        PIC S9(4)   VALUE +250  COMP.
   602
   603     12  ERCHEK-KEY.
   604         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   605         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   606         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   607         16  CHEK-STATE              PIC XX      VALUE SPACES.
   608         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   609         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   610         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   611         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   612         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   613
   614     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   615     12  ERPYAJ-KEY.
   616         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   617         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   618         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   619         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   620         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   621         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   622         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   623
   624     12  ERPYAJ-RECORD-LENGTH        PIC S9(4)   VALUE +200  COMP.
   625
   626 01  ERROR-NUMBERS.
   627     12  ER-0000                     PIC X(4)    VALUE '0000'.
   628     12  ER-0004                     PIC X(4)    VALUE '0004'.
   629     12  ER-0008                     PIC X(4)    VALUE '0008'.
   630     12  ER-0013                     PIC X(4)    VALUE '0013'.
   631     12  ER-0022                     PIC X(4)    VALUE '0022'.
   632     12  ER-0023                     PIC X(4)    VALUE '0023'.
   633     12  ER-0026                     PIC X(4)    VALUE '0026'.
   634     12  ER-0029                     PIC X(4)    VALUE '0029'.
   635     12  ER-0070                     PIC X(4)    VALUE '0070'.
   636     12  ER-0194                     PIC X(4)    VALUE '0194'.
   637     12  ER-0195                     PIC X(4)    VALUE '0195'.
   638     12  ER-0196                     PIC X(4)    VALUE '0196'.
   639     12  ER-0197                     PIC X(4)    VALUE '0197'.
   640     12  ER-0203                     PIC X(4)    VALUE '0203'.
   641     12  ER-0215                     PIC X(4)    VALUE '0215'.
   642     12  ER-0216                     PIC X(4)    VALUE '0216'.
   643     12  ER-0433                     PIC X(4)    VALUE '0433'.
   644     12  ER-0565                     PIC X(4)    VALUE '0565'.
   645     12  ER-1159                     PIC X(4)    VALUE '1159'.
   646     12  ER-1162                     PIC X(4)    VALUE '1162'.
   647     12  ER-2056                     PIC X(4)    VALUE '2056'.
   648     12  ER-2208                     PIC X(4)    VALUE '2208'.
   649     12  ER-2209                     PIC X(4)    VALUE '2209'.
   650     12  ER-2210                     PIC X(4)    VALUE '2210'.
   651     12  ER-2230                     PIC X(4)    VALUE '2230'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  13
* EL677.cbl
   652     12  ER-2237                     PIC X(4)    VALUE '2237'.
   653     12  ER-2238                     PIC X(4)    VALUE '2238'.
   654     12  ER-2294                     PIC X(4)    VALUE '2294'.
   655     12  ER-2394                     PIC X(4)    VALUE '2394'.
   656     12  ER-2438                     PIC X(4)    VALUE '2438'.
   657     12  ER-2439                     PIC X(4)    VALUE '2439'.
   658     12  ER-2583                     PIC X(4)    VALUE '2583'.
   659     12  ER-2600                     PIC X(4)    VALUE '2600'.
   660     12  ER-2726                     PIC X(4)    VALUE '2726'.
   661     12  ER-2905                     PIC X(4)    VALUE '2905'.
   662     12  ER-2906                     PIC X(4)    VALUE '2906'.
   663     12  ER-2907                     PIC X(4)    VALUE '2907'.
   664     12  ER-2908                     PIC X(4)    VALUE '2908'.
   665     12  ER-2909                     PIC X(4)    VALUE '2909'.
   666     12  ER-3044                     PIC X(4)    VALUE '3044'.
   667     12  ER-3046                     PIC X(4)    VALUE '3046'.
   668     12  ER-3047                     PIC X(4)    VALUE '3047'.
   669     12  ER-3445                     PIC X(4)    VALUE '3445'.
   670     12  er-3450                     pic x(4)    value '3450'.
   671     12  er-3451                     pic x(4)    value '3451'.
   672     12  er-3452                     pic x(4)    value '3452'.
   673     12  er-3453                     pic x(4)    value '3453'.
   674     12  er-3454                     pic x(4)    value '3454'.
   675     12  er-3455                     pic x(4)    value '3455'.
   676     12  ER-7389                     PIC X(4)    VALUE '7389'.
   677*                                    COPY ELCLOGOF.
   678******************************************************************
   679*                                                                *
   680*                                                                *
   681*                            ELCLOGOF.                           *
   682*                            VMOD=2.001                          *
   683*                                                                *
   684*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   685*                                                                *
   686******************************************************************
   687 01  CLASIC-LOGOFF.
   688     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   689     12  LOGOFF-TEXT.
   690         16  FILLER          PIC X(5)    VALUE SPACES.
   691         16  LOGOFF-MSG.
   692             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   693             20  FILLER      PIC X       VALUE SPACES.
   694             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   695         16  FILLER          PIC X(80)
   696           VALUE '* YOU ARE NOW LOGGED OFF'.
   697         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   698         16  FILLER          PIC X       VALUE QUOTE.
   699         16  LOGOFF-SYS-MSG  PIC X(17)
   700           VALUE 'S CLAS-IC SYSTEM '.
   701     12  TEXT-MESSAGES.
   702         16  UNACCESS-MSG    PIC X(29)
   703             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   704         16  PGMIDERR-MSG    PIC X(17)
   705             VALUE 'PROGRAM NOT FOUND'.
   706*                                    COPY ELCDATE.
   707******************************************************************
   708*                                                                *
   709*                                                                *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  14
* EL677.cbl
   710*                            ELCDATE.                            *
   711*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   712*                            VMOD=2.003
   713*                                                                *
   714*                                                                *
   715*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   716*                 LENGTH = 200                                   *
   717******************************************************************
   718
   719 01  DATE-CONVERSION-DATA.
   720     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   721     12  DC-OPTION-CODE                PIC X.
   722         88  BIN-TO-GREG                VALUE ' '.
   723         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   724         88  EDIT-GREG-TO-BIN           VALUE '2'.
   725         88  YMD-GREG-TO-BIN            VALUE '3'.
   726         88  MDY-GREG-TO-BIN            VALUE '4'.
   727         88  JULIAN-TO-BIN              VALUE '5'.
   728         88  BIN-PLUS-ELAPSED           VALUE '6'.
   729         88  FIND-CENTURY               VALUE '7'.
   730         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   731         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   732         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   733         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   734         88  JULIAN-TO-BIN-3            VALUE 'C'.
   735         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   736         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   737         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   738         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   739         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   740         88  CHECK-LEAP-YEAR            VALUE 'H'.
   741         88  BIN-3-TO-GREG              VALUE 'I'.
   742         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   743         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   744         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   745         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   746         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   747         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   748         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   749         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   750         88  THREE-CHARACTER-BIN
   751                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   752         88  GREGORIAN-TO-BIN
   753                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   754         88  BIN-TO-GREGORIAN
   755                  VALUES ' ' '1' 'I' '8' 'G'.
   756         88  JULIAN-TO-BINARY
   757                  VALUES '5' 'C' 'E' 'F'.
   758     12  DC-ERROR-CODE                 PIC X.
   759         88  NO-CONVERSION-ERROR        VALUE ' '.
   760         88  DATE-CONVERSION-ERROR
   761                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   762         88  DATE-IS-ZERO               VALUE '1'.
   763         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   764         88  DATE-IS-INVALID            VALUE '3'.
   765         88  DATE1-GREATER-DATE2        VALUE '4'.
   766         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   767         88  DATE-INVALID-OPTION        VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  15
* EL677.cbl
   768         88  INVALID-CENTURY            VALUE 'A'.
   769         88  ONLY-CENTURY               VALUE 'B'.
   770         88  ONLY-LEAP-YEAR             VALUE 'C'.
   771         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   772     12  DC-END-OF-MONTH               PIC X.
   773         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   774     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   775         88  USE-NORMAL-PROCESS         VALUE ' '.
   776         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   777         88  ADJUST-UP-100-YRS          VALUE '2'.
   778     12  FILLER                        PIC X.
   779     12  DC-CONVERSION-DATES.
   780         16  DC-BIN-DATE-1             PIC XX.
   781         16  DC-BIN-DATE-2             PIC XX.
   782         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   783         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   784                       DC-GREG-DATE-1-EDIT.
   785             20  DC-EDIT1-MONTH        PIC 99.
   786             20  SLASH1-1              PIC X.
   787             20  DC-EDIT1-DAY          PIC 99.
   788             20  SLASH1-2              PIC X.
   789             20  DC-EDIT1-YEAR         PIC 99.
   790         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   791         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   792                     DC-GREG-DATE-2-EDIT.
   793             20  DC-EDIT2-MONTH        PIC 99.
   794             20  SLASH2-1              PIC X.
   795             20  DC-EDIT2-DAY          PIC 99.
   796             20  SLASH2-2              PIC X.
   797             20  DC-EDIT2-YEAR         PIC 99.
   798         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   799         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   800                     DC-GREG-DATE-1-YMD.
   801             20  DC-YMD-YEAR           PIC 99.
   802             20  DC-YMD-MONTH          PIC 99.
   803             20  DC-YMD-DAY            PIC 99.
   804         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   805         16  DC-GREG-DATE-1-MDY-R REDEFINES
   806                      DC-GREG-DATE-1-MDY.
   807             20  DC-MDY-MONTH          PIC 99.
   808             20  DC-MDY-DAY            PIC 99.
   809             20  DC-MDY-YEAR           PIC 99.
   810         16  DC-GREG-DATE-1-ALPHA.
   811             20  DC-ALPHA-MONTH        PIC X(10).
   812             20  DC-ALPHA-DAY          PIC 99.
   813             20  FILLER                PIC XX.
   814             20  DC-ALPHA-CENTURY.
   815                 24 DC-ALPHA-CEN-N     PIC 99.
   816             20  DC-ALPHA-YEAR         PIC 99.
   817         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   818         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   819         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   820         16  DC-JULIAN-DATE            PIC 9(05).
   821         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   822                                       PIC 9(05).
   823         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   824             20  DC-JULIAN-YEAR        PIC 99.
   825             20  DC-JULIAN-DAYS        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  16
* EL677.cbl
   826         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   827         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   828         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   829     12  DATE-CONVERSION-VARIBLES.
   830         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   831         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   832             20  FILLER                PIC 9(3).
   833             20  HOLD-CEN-1-CCYY.
   834                 24  HOLD-CEN-1-CC     PIC 99.
   835                 24  HOLD-CEN-1-YY     PIC 99.
   836             20  HOLD-CEN-1-MO         PIC 99.
   837             20  HOLD-CEN-1-DA         PIC 99.
   838         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   839             20  HOLD-CEN-1-R-MO       PIC 99.
   840             20  HOLD-CEN-1-R-DA       PIC 99.
   841             20  HOLD-CEN-1-R-CCYY.
   842                 24  HOLD-CEN-1-R-CC   PIC 99.
   843                 24  HOLD-CEN-1-R-YY   PIC 99.
   844             20  FILLER                PIC 9(3).
   845         16  HOLD-CENTURY-1-X.
   846             20  FILLER                PIC X(3)  VALUE SPACES.
   847             20  HOLD-CEN-1-X-CCYY.
   848                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   849                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   850             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   851             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   852         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   853             20  HOLD-CEN-1-R-X-MO     PIC XX.
   854             20  HOLD-CEN-1-R-X-DA     PIC XX.
   855             20  HOLD-CEN-1-R-X-CCYY.
   856                 24  HOLD-CEN-1-R-X-CC PIC XX.
   857                 24  HOLD-CEN-1-R-X-YY PIC XX.
   858             20  FILLER                PIC XXX.
   859         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   860         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   861         16  DC-JULIAN-DATE-1          PIC 9(07).
   862         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   863             20  DC-JULIAN-1-CCYY.
   864                 24  DC-JULIAN-1-CC    PIC 99.
   865                 24  DC-JULIAN-1-YR    PIC 99.
   866             20  DC-JULIAN-DA-1        PIC 999.
   867         16  DC-JULIAN-DATE-2          PIC 9(07).
   868         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   869             20  DC-JULIAN-2-CCYY.
   870                 24  DC-JULIAN-2-CC    PIC 99.
   871                 24  DC-JULIAN-2-YR    PIC 99.
   872             20  DC-JULIAN-DA-2        PIC 999.
   873         16  DC-GREG-DATE-A-EDIT.
   874             20  DC-EDITA-MONTH        PIC 99.
   875             20  SLASHA-1              PIC X VALUE '/'.
   876             20  DC-EDITA-DAY          PIC 99.
   877             20  SLASHA-2              PIC X VALUE '/'.
   878             20  DC-EDITA-CCYY.
   879                 24  DC-EDITA-CENT     PIC 99.
   880                 24  DC-EDITA-YEAR     PIC 99.
   881         16  DC-GREG-DATE-B-EDIT.
   882             20  DC-EDITB-MONTH        PIC 99.
   883             20  SLASHB-1              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  17
* EL677.cbl
   884             20  DC-EDITB-DAY          PIC 99.
   885             20  SLASHB-2              PIC X VALUE '/'.
   886             20  DC-EDITB-CCYY.
   887                 24  DC-EDITB-CENT     PIC 99.
   888                 24  DC-EDITB-YEAR     PIC 99.
   889         16  DC-GREG-DATE-CYMD         PIC 9(08).
   890         16  DC-GREG-DATE-CYMD-R REDEFINES
   891                              DC-GREG-DATE-CYMD.
   892             20  DC-CYMD-CEN           PIC 99.
   893             20  DC-CYMD-YEAR          PIC 99.
   894             20  DC-CYMD-MONTH         PIC 99.
   895             20  DC-CYMD-DAY           PIC 99.
   896         16  DC-GREG-DATE-MDCY         PIC 9(08).
   897         16  DC-GREG-DATE-MDCY-R REDEFINES
   898                              DC-GREG-DATE-MDCY.
   899             20  DC-MDCY-MONTH         PIC 99.
   900             20  DC-MDCY-DAY           PIC 99.
   901             20  DC-MDCY-CEN           PIC 99.
   902             20  DC-MDCY-YEAR          PIC 99.
   903    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   904        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   905    12  DC-EL310-DATE                  PIC X(21).
   906    12  FILLER                         PIC X(28).
   907*                                    COPY ELCATTR.
   908******************************************************************
   909*                                                                *
   910*                            ELCATTR.                            *
   911*                            VMOD=2.001                          *
   912*                                                                *
   913*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   914*                                                                *
   915*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   916*                                                                *
   917*                   POS 1   P=PROTECTED                          *
   918*                           U=UNPROTECTED                        *
   919*                           S=ASKIP                              *
   920*                   POS 2   A=ALPHA/NUMERIC                      *
   921*                           N=NUMERIC                            *
   922*                   POS 3   N=NORMAL                             *
   923*                           B=BRIGHT                             *
   924*                           D=DARK                               *
   925*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   926*                           OF=MODIFIED DATA TAG OFF             *
   927*                                                                *
   928*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   929******************************************************************
   930 01  ATTRIBUTE-LIST.
   931     12  AL-PABOF            PIC X       VALUE 'Y'.
   932     12  AL-PABON            PIC X       VALUE 'Z'.
   933     12  AL-PADOF            PIC X       VALUE '%'.
   934     12  AL-PADON            PIC X       VALUE '_'.
   935     12  AL-PANOF            PIC X       VALUE '-'.
   936     12  AL-PANON            PIC X       VALUE '/'.
   937     12  AL-SABOF            PIC X       VALUE '8'.
   938     12  AL-SABON            PIC X       VALUE '9'.
   939     12  AL-SADOF            PIC X       VALUE '@'.
   940     12  AL-SADON            PIC X       VALUE QUOTE.
   941     12  AL-SANOF            PIC X       VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  18
* EL677.cbl
   942     12  AL-SANON            PIC X       VALUE '1'.
   943     12  AL-UABOF            PIC X       VALUE 'H'.
   944     12  AL-UABON            PIC X       VALUE 'I'.
   945     12  AL-UADOF            PIC X       VALUE '<'.
   946     12  AL-UADON            PIC X       VALUE '('.
   947     12  AL-UANOF            PIC X       VALUE ' '.
   948     12  AL-UANON            PIC X       VALUE 'A'.
   949     12  AL-UNBOF            PIC X       VALUE 'Q'.
   950     12  AL-UNBON            PIC X       VALUE 'R'.
   951     12  AL-UNDOF            PIC X       VALUE '*'.
   952     12  AL-UNDON            PIC X       VALUE ')'.
   953     12  AL-UNNOF            PIC X       VALUE '&'.
   954     12  AL-UNNON            PIC X       VALUE 'J'.
   955*                                    COPY ELCEMIB.
   956******************************************************************
   957*                                                                *
   958*                                                                *
   959*                            ELCEMIB.                            *
   960*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   961*                            VMOD=2.005                          *
   962*                                                                *
   963*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   964*                                                                *
   965******************************************************************
   966 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   967     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   968     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   969     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   970     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   971     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   972     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   973     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   974     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   975     12  EMI-SWITCH1             PIC X        VALUE '1'.
   976         88  EMI-NO-ERRORS                    VALUE '1'.
   977         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   978         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   979     12  EMI-SWITCH2             PIC X        VALUE '1'.
   980         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   981     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   982         88  EMI-AREA1-EMPTY                  VALUE '1'.
   983         88  EMI-AREA1-FULL                   VALUE '2'.
   984     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   985         88  EMI-AREA2-EMPTY                  VALUE '1'.
   986         88  EMI-AREA2-FULL                   VALUE '2'.
   987     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   988         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   989         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   990         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   991         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   992         88  EMI-BYPASS-FATALS                VALUE 'X'.
   993     12  EMI-ERROR-LINES.
   994         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   995         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   996         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   997         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   998             20  EMI-ERR-CODES OCCURS 10 TIMES.
   999                 24  EMI-ERR-NUM         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  19
* EL677.cbl
  1000                 24  EMI-FILLER          PIC X.
  1001                 24  EMI-SEV             PIC X.
  1002                 24  FILLER              PIC X.
  1003             20  FILLER                  PIC X(02).
  1004     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1005         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1006             20  EMI-ERROR-NUMBER    PIC X(4).
  1007             20  EMI-FILL            PIC X.
  1008             20  EMI-SEVERITY        PIC X.
  1009             20  FILLER              PIC X.
  1010             20  EMI-ERROR-TEXT.
  1011                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1012                 24  FILLER          PIC X(55).
  1013     12  EMI-SEVERITY-SAVE           PIC X.
  1014         88  EMI-NOTE                    VALUE 'N'.
  1015         88  EMI-WARNING                 VALUE 'W'.
  1016         88  EMI-FORCABLE                VALUE 'F'.
  1017         88  EMI-FATAL                   VALUE 'X'.
  1018     12  EMI-MESSAGE-FLAG            PIC X.
  1019         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1020         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1021     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1022     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1023         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1024         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1025         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1026     12  emi-claim-no                pic x(7).
  1027     12  emi-claim-type              pic x(6).
  1028     12  FILLER                      PIC X(124)  VALUE SPACES.
  1029     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1030     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1031     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1032     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1033*                                    COPY ELCINTF.
  1034******************************************************************
  1035*                                                                *
  1036*                                                                *
  1037*                            ELCINTF.                            *
  1038*                            VMOD=2.017                          *
  1039*                                                                *
  1040*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1041*                                                                *
  1042*       LENGTH = 1024                                            *
  1043*                                                                *
  1044******************************************************************
  1045*                   C H A N G E   L O G
  1046*
  1047* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1048*-----------------------------------------------------------------
  1049*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1050* EFFECTIVE    NUMBER
  1051*-----------------------------------------------------------------
  1052* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1053******************************************************************
  1054 01  PROGRAM-INTERFACE-BLOCK.
  1055     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1056     12  PI-CALLING-PROGRAM              PIC X(8).
  1057     12  PI-SAVED-PROGRAM-1              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  20
* EL677.cbl
  1058     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1059     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1060     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1061     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1062     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1063     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1064     12  PI-COMPANY-ID                   PIC XXX.
  1065     12  PI-COMPANY-CD                   PIC X.
  1066
  1067     12  PI-COMPANY-PASSWORD             PIC X(8).
  1068
  1069     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1070
  1071     12  PI-CONTROL-IN-PROGRESS.
  1072         16  PI-CARRIER                  PIC X.
  1073         16  PI-GROUPING                 PIC X(6).
  1074         16  PI-STATE                    PIC XX.
  1075         16  PI-ACCOUNT                  PIC X(10).
  1076         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1077                                         PIC X(10).
  1078         16  PI-CLAIM-CERT-GRP.
  1079             20  PI-CLAIM-NO             PIC X(7).
  1080             20  PI-CERT-NO.
  1081                 25  PI-CERT-PRIME       PIC X(10).
  1082                 25  PI-CERT-SFX         PIC X.
  1083             20  PI-CERT-EFF-DT          PIC XX.
  1084         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1085             20  PI-PLAN-CODE            PIC X(2).
  1086             20  PI-REVISION-NUMBER      PIC X(3).
  1087             20  PI-PLAN-EFF-DT          PIC X(2).
  1088             20  PI-PLAN-EXP-DT          PIC X(2).
  1089             20  FILLER                  PIC X(11).
  1090         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1091             20  PI-OE-REFERENCE-1.
  1092                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1093                 25  PI-OE-REF-1-SUFF    PIC XX.
  1094
  1095     12  PI-SESSION-IN-PROGRESS          PIC X.
  1096         88  CLAIM-SESSION                   VALUE '1'.
  1097         88  CREDIT-SESSION                  VALUE '2'.
  1098         88  WARRANTY-SESSION                VALUE '3'.
  1099         88  MORTGAGE-SESSION                VALUE '4'.
  1100         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1101
  1102
  1103*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1104
  1105     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1106     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1107
  1108     12  PI-CREDIT-USER                  PIC X.
  1109         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1110         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1111
  1112     12  PI-CLAIM-USER                   PIC X.
  1113         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1114         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1115
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  21
* EL677.cbl
  1116     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1117         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1118         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1119         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1120         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1121         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1122
  1123     12  PI-PROCESSOR-ID                 PIC X(4).
  1124
  1125     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1126
  1127     12  PI-MEMBER-CAPTION               PIC X(10).
  1128
  1129     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1130         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1131
  1132     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1133     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1134     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1135     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1136
  1137     12  PI-AH-OVERRIDE-L1               PIC X.
  1138     12  PI-AH-OVERRIDE-L2               PIC XX.
  1139     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1140     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1141
  1142     12  PI-NEW-SYSTEM                   PIC X(2).
  1143
  1144     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1145     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1146         88  PI-USES-PAID-TO                 VALUE '1'.
  1147     12  PI-CRDTCRD-SYSTEM.
  1148         16  PI-CRDTCRD-USER             PIC X.
  1149             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1150             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1151         16  PI-CC-MONTH-END-DT          PIC XX.
  1152     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1153
  1154     12  PI-OE-REFERENCE-2.
  1155         16  PI-OE-REF-2-PRIME           PIC X(10).
  1156         16  PI-OE-REF-2-SUFF            PIC X.
  1157
  1158     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1159
  1160     12  PI-LANGUAGE-TYPE                PIC X.
  1161             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1162             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1163             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1164
  1165     12  PI-POLICY-LINKAGE-IND           PIC X.
  1166         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1167         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1168                                                   LOW-VALUES.
  1169
  1170     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1171     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1172         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1173         88  PI-CLAIM-CONVEN                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  22
* EL677.cbl
  1174
  1175     12  PI-PROCESSOR-CSR-IND            PIC X.
  1176         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1177         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1178
  1179     12  FILLER                          PIC X(3).
  1180
  1181     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1182
  1183     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1184         PI-SYSTEM-LEVEL.
  1185
  1186         16  PI-ENTRY-CODES.
  1187             20  PI-ENTRY-CD-1           PIC X.
  1188             20  PI-ENTRY-CD-2           PIC X.
  1189
  1190         16  PI-RETURN-CODES.
  1191             20  PI-RETURN-CD-1          PIC X.
  1192             20  PI-RETURN-CD-2          PIC X.
  1193
  1194         16  PI-UPDATE-STATUS-SAVE.
  1195             20  PI-UPDATE-BY            PIC X(4).
  1196             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1197
  1198         16  PI-LOWER-CASE-LETTERS       PIC X.
  1199             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1200
  1201*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1202*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1203*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1204
  1205         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1206             88  ST-ACCNT-CNTL               VALUE ' '.
  1207             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1208             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1209             88  ACCNT-CNTL                  VALUE '3'.
  1210             88  CARR-ACCNT-CNTL             VALUE '4'.
  1211
  1212         16  PI-PROCESSOR-CAP-LIST.
  1213             20  PI-SYSTEM-CONTROLS.
  1214                24 PI-SYSTEM-DISPLAY     PIC X.
  1215                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1216                24 PI-SYSTEM-MODIFY      PIC X.
  1217                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1218             20  FILLER                  PIC XX.
  1219             20  PI-DISPLAY-CAP          PIC X.
  1220                 88  DISPLAY-CAP             VALUE 'Y'.
  1221             20  PI-MODIFY-CAP           PIC X.
  1222                 88  MODIFY-CAP              VALUE 'Y'.
  1223             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1224                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1225             20  PI-FORCE-CAP            PIC X.
  1226                 88  FORCE-CAP               VALUE 'Y'.
  1227
  1228         16  PI-PROGRAM-CONTROLS.
  1229             20  PI-PGM-PRINT-OPT        PIC X.
  1230             20  PI-PGM-FORMAT-OPT       PIC X.
  1231             20  PI-PGM-PROCESS-OPT      PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  23
* EL677.cbl
  1232             20  PI-PGM-TOTALS-OPT       PIC X.
  1233
  1234         16  PI-HELP-INTERFACE.
  1235             20  PI-LAST-ERROR-NO        PIC X(4).
  1236             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1237
  1238         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1239             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1240
  1241         16  PI-CR-CONTROL-IN-PROGRESS.
  1242             20  PI-CR-CARRIER           PIC X.
  1243             20  PI-CR-GROUPING          PIC X(6).
  1244             20  PI-CR-STATE             PIC XX.
  1245             20  PI-CR-ACCOUNT           PIC X(10).
  1246             20  PI-CR-FIN-RESP          PIC X(10).
  1247             20  PI-CR-TYPE              PIC X.
  1248
  1249         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1250
  1251         16  PI-CR-MONTH-END-DT          PIC XX.
  1252
  1253         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1254             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1255             88  PI-ZERO-CARRIER             VALUE '1'.
  1256             88  PI-ZERO-GROUPING            VALUE '2'.
  1257             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1258
  1259         16  PI-CARRIER-SECURITY         PIC X.
  1260             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1261
  1262         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1263             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1264             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1265
  1266         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1267             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1268                                         INDEXED BY PI-ACCESS-NDX
  1269                                         PIC X.
  1270
  1271         16  PI-GA-BILLING-CONTROL       PIC X.
  1272             88  PI-GA-BILLING               VALUE '1'.
  1273
  1274         16  PI-MAIL-PROCESSING          PIC X.
  1275             88  PI-MAIL-YES                 VALUE 'Y'.
  1276
  1277         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1278
  1279         16  PI-AR-SYSTEM.
  1280             20  PI-AR-PROCESSING-CNTL   PIC X.
  1281                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1282             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1283             20  PI-AR-MONTH-END-DT      PIC XX.
  1284
  1285         16  PI-MP-SYSTEM.
  1286             20  PI-MORTGAGE-USER            PIC X.
  1287                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1288                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1289             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  24
* EL677.cbl
  1290                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1291                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1292                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1293                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1294                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1295             20  PI-MP-MONTH-END-DT          PIC XX.
  1296             20  PI-MP-REFERENCE-NO.
  1297                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1298                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1299
  1300         16  PI-LABEL-CONTROL            PIC X(01).
  1301             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1302             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1303
  1304         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1305             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1306
  1307         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1308             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1309             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1310
  1311         16  FILLER                      PIC X(14).
  1312
  1313     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1314******************************************************************
  1315     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1316         16  PI-EOF-SW               PIC X.
  1317             88  PI-FILE-EOF                     VALUE 'Y'.
  1318         16  PI-PREV-MAINT           PIC X.
  1319         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1320         16  PI-ERCHEK-KEY.
  1321             20  PI-CHEK-COMP-CD     PIC X.
  1322             20  PI-CHEK-CARRIER     PIC X.
  1323             20  PI-CHEK-GROUPING    PIC X(6).
  1324             20  PI-CHEK-STATE       PIC XX.
  1325             20  PI-CHEK-ACCOUNT     PIC X(10).
  1326             20  PI-CHEK-EFF-DT      PIC XX.
  1327             20  PI-CHEK-CERT-NO     PIC X(10).
  1328             20  PI-CHEK-SUF-NO      PIC X.
  1329             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1330         16  PI-ACCOUNT-ADDRESS.
  1331             20  PI-AM-NAME          PIC X(30).
  1332             20  PI-AM-ADDRS         PIC X(30).
  1333             20  PI-AM-CITY-st.
  1334                 24  pi-am-city      PIC X(28).
  1335                 24  pi-am-st        pic xx.
  1336             20  PI-AM-ZIP-CODE.
  1337                 24  PI-AM-ZIP-PRIME PIC X(5).
  1338                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1339         16  PI-PROCESS-CERT-SW          PIC X.
  1340             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1341         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1342             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1343         16  PI-PAYTO1                   PIC X(30).
  1344         16  PI-REFERENCE                PIC X(12).
  1345         16  PI-CANC-DT                  PIC XX.
  1346         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1347         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  25
* EL677.cbl
  1348         16  PI-INSURED-NAME             PIC X(28).
  1349         16  PI-PFKEY                    PIC XXX.
  1350             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1351             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1352         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1353         16  PI-TYPE                     PIC X.
  1354         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1355         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1356         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1357         16  pi-chek-rec-cnt             pic s999 comp-3.
  1358         16  pi-am-csr                   pic x(4).
  1359         16  pi-return-to                pic x(30).
  1360         16  pi-prev-ded-comm            pic x.
  1361         16  pi-table-name               pic x(30).
  1362         16  FILLER                      PIC X(354).
  1363*                                    COPY ELCAID.
  1364******************************************************************
  1365*                                                                *
  1366*                            ELCAID.                             *
  1367*                            VMOD=2.001                          *
  1368*                                                                *
  1369*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1370*                                                                *
  1371*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1372*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1373******************************************************************
  1374
  1375 01  DFHAID.
  1376   02  DFHNULL   PIC  X  VALUE  ' '.
  1377   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1378   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1379   02  DFHPEN    PIC  X  VALUE  '='.
  1380   02  DFHOPID   PIC  X  VALUE  'W'.
  1381   02  DFHPA1    PIC  X  VALUE  '%'.
  1382   02  DFHPA2    PIC  X  VALUE  '>'.
  1383   02  DFHPA3    PIC  X  VALUE  ','.
  1384   02  DFHPF1    PIC  X  VALUE  '1'.
  1385   02  DFHPF2    PIC  X  VALUE  '2'.
  1386   02  DFHPF3    PIC  X  VALUE  '3'.
  1387   02  DFHPF4    PIC  X  VALUE  '4'.
  1388   02  DFHPF5    PIC  X  VALUE  '5'.
  1389   02  DFHPF6    PIC  X  VALUE  '6'.
  1390   02  DFHPF7    PIC  X  VALUE  '7'.
  1391   02  DFHPF8    PIC  X  VALUE  '8'.
  1392   02  DFHPF9    PIC  X  VALUE  '9'.
  1393   02  DFHPF10   PIC  X  VALUE  ':'.
  1394   02  DFHPF11   PIC  X  VALUE  '#'.
  1395   02  DFHPF12   PIC  X  VALUE  '@'.
  1396   02  DFHPF13   PIC  X  VALUE  'A'.
  1397   02  DFHPF14   PIC  X  VALUE  'B'.
  1398   02  DFHPF15   PIC  X  VALUE  'C'.
  1399   02  DFHPF16   PIC  X  VALUE  'D'.
  1400   02  DFHPF17   PIC  X  VALUE  'E'.
  1401   02  DFHPF18   PIC  X  VALUE  'F'.
  1402   02  DFHPF19   PIC  X  VALUE  'G'.
  1403   02  DFHPF20   PIC  X  VALUE  'H'.
  1404   02  DFHPF21   PIC  X  VALUE  'I'.
  1405*00039    02  DFHPF22   PIC  X  VALUE  ''.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  26
* EL677.cbl
  1406   02  DFHPF22   PIC  X  VALUE  '['.
  1407   02  DFHPF23   PIC  X  VALUE  '.'.
  1408   02  DFHPF24   PIC  X  VALUE  '<'.
  1409   02  DFHMSRE   PIC  X  VALUE  'X'.
  1410   02  DFHSTRF   PIC  X  VALUE  'h'.
  1411   02  DFHTRIG   PIC  X  VALUE  '"'.
  1412 01  FILLER    REDEFINES DFHAID.
  1413     12  FILLER                      PIC X(8).
  1414     12  PF-VALUES                   PIC X       OCCURS 24.
  1415     12  FILLER                      PIC X(3).
  1416*                                    COPY EL677S.
  1417 01  EL677AI.
  1418     05  FILLER            PIC  X(0012).
  1419*    -------------------------------
  1420     05  DATEL PIC S9(0004) COMP.
  1421     05  DATEF PIC  X(0001).
  1422     05  FILLER REDEFINES DATEF.
  1423         10  DATEA PIC  X(0001).
  1424     05  DATEI PIC  X(0008).
  1425*    -------------------------------
  1426     05  TIMEL PIC S9(0004) COMP.
  1427     05  TIMEF PIC  X(0001).
  1428     05  FILLER REDEFINES TIMEF.
  1429         10  TIMEA PIC  X(0001).
  1430     05  TIMEI PIC  X(0005).
  1431*    -------------------------------
  1432     05  MAINTL PIC S9(0004) COMP.
  1433     05  MAINTF PIC  X(0001).
  1434     05  FILLER REDEFINES MAINTF.
  1435         10  MAINTA PIC  X(0001).
  1436     05  MAINTI PIC  X(0001).
  1437*    -------------------------------
  1438     05  DMAINT1L PIC S9(0004) COMP.
  1439     05  DMAINT1F PIC  X(0001).
  1440     05  FILLER REDEFINES DMAINT1F.
  1441         10  DMAINT1A PIC  X(0001).
  1442     05  DMAINT1I PIC  X(0009).
  1443*    -------------------------------
  1444     05  DMAINT2L PIC S9(0004) COMP.
  1445     05  DMAINT2F PIC  X(0001).
  1446     05  FILLER REDEFINES DMAINT2F.
  1447         10  DMAINT2A PIC  X(0001).
  1448     05  DMAINT2I PIC  X(0029).
  1449*    -------------------------------
  1450     05  CARRIERL PIC S9(0004) COMP.
  1451     05  CARRIERF PIC  X(0001).
  1452     05  FILLER REDEFINES CARRIERF.
  1453         10  CARRIERA PIC  X(0001).
  1454     05  CARRIERI PIC  X(0001).
  1455*    -------------------------------
  1456     05  GROUPL PIC S9(0004) COMP.
  1457     05  GROUPF PIC  X(0001).
  1458     05  FILLER REDEFINES GROUPF.
  1459         10  GROUPA PIC  X(0001).
  1460     05  GROUPI PIC  X(0006).
  1461*    -------------------------------
  1462     05  STATEL PIC S9(0004) COMP.
  1463     05  STATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  27
* EL677.cbl
  1464     05  FILLER REDEFINES STATEF.
  1465         10  STATEA PIC  X(0001).
  1466     05  STATEI PIC  X(0002).
  1467*    -------------------------------
  1468     05  ACCTL PIC S9(0004) COMP.
  1469     05  ACCTF PIC  X(0001).
  1470     05  FILLER REDEFINES ACCTF.
  1471         10  ACCTA PIC  X(0001).
  1472     05  ACCTI PIC  X(0010).
  1473*    -------------------------------
  1474     05  EFFDTL PIC S9(0004) COMP.
  1475     05  EFFDTF PIC  X(0001).
  1476     05  FILLER REDEFINES EFFDTF.
  1477         10  EFFDTA PIC  X(0001).
  1478     05  EFFDTI PIC  X(0008).
  1479*    -------------------------------
  1480     05  CERTNOL PIC S9(0004) COMP.
  1481     05  CERTNOF PIC  X(0001).
  1482     05  FILLER REDEFINES CERTNOF.
  1483         10  CERTNOA PIC  X(0001).
  1484     05  CERTNOI PIC  X(0010).
  1485*    -------------------------------
  1486     05  SFXL PIC S9(0004) COMP.
  1487     05  SFXF PIC  X(0001).
  1488     05  FILLER REDEFINES SFXF.
  1489         10  SFXA PIC  X(0001).
  1490     05  SFXI PIC  X(0001).
  1491*    -------------------------------
  1492     05  SEQL PIC S9(0004) COMP.
  1493     05  SEQF PIC  X(0001).
  1494     05  FILLER REDEFINES SEQF.
  1495         10  SEQA PIC  X(0001).
  1496     05  SEQI PIC  99.
  1497*    -------------------------------
  1498     05  PAYTO1L PIC S9(0004) COMP.
  1499     05  PAYTO1F PIC  X(0001).
  1500     05  FILLER REDEFINES PAYTO1F.
  1501         10  PAYTO1A PIC  X(0001).
  1502     05  PAYTO1I PIC  X(0030).
  1503*    -------------------------------
  1504     05  CREATEDL PIC S9(0004) COMP.
  1505     05  CREATEDF PIC  X(0001).
  1506     05  FILLER REDEFINES CREATEDF.
  1507         10  CREATEDA PIC  X(0001).
  1508     05  CREATEDI PIC  X(0008).
  1509*    -------------------------------
  1510     05  CBYL PIC S9(0004) COMP.
  1511     05  CBYF PIC  X(0001).
  1512     05  FILLER REDEFINES CBYF.
  1513         10  CBYA PIC  X(0001).
  1514     05  CBYI PIC  X(0004).
  1515*    -------------------------------
  1516     05  PAYTO2L PIC S9(0004) COMP.
  1517     05  PAYTO2F PIC  X(0001).
  1518     05  FILLER REDEFINES PAYTO2F.
  1519         10  PAYTO2A PIC  X(0001).
  1520     05  PAYTO2I PIC  X(0030).
  1521*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  28
* EL677.cbl
  1522     05  PAYEEL PIC S9(0004) COMP.
  1523     05  PAYEEF PIC  X(0001).
  1524     05  FILLER REDEFINES PAYEEF.
  1525         10  PAYEEA PIC  X(0001).
  1526     05  PAYEEI PIC  X(0006).
  1527*    -------------------------------
  1528     05  APVSTATL PIC S9(0004) COMP.
  1529     05  APVSTATF PIC  X(0001).
  1530     05  FILLER REDEFINES APVSTATF.
  1531         10  APVSTATA PIC  X(0001).
  1532     05  APVSTATI PIC  X(0009).
  1533*    -------------------------------
  1534     05  PAYAD1L PIC S9(0004) COMP.
  1535     05  PAYAD1F PIC  X(0001).
  1536     05  FILLER REDEFINES PAYAD1F.
  1537         10  PAYAD1A PIC  X(0001).
  1538     05  PAYAD1I PIC  X(0030).
  1539*    -------------------------------
  1540     05  APVDTL PIC S9(0004) COMP.
  1541     05  APVDTF PIC  X(0001).
  1542     05  FILLER REDEFINES APVDTF.
  1543         10  APVDTA PIC  X(0001).
  1544     05  APVDTI PIC  X(0008).
  1545*    -------------------------------
  1546     05  APVBYL PIC S9(0004) COMP.
  1547     05  APVBYF PIC  X(0001).
  1548     05  FILLER REDEFINES APVBYF.
  1549         10  APVBYA PIC  X(0001).
  1550     05  APVBYI PIC  X(0004).
  1551*    -------------------------------
  1552     05  PAYAD2L PIC S9(0004) COMP.
  1553     05  PAYAD2F PIC  X(0001).
  1554     05  FILLER REDEFINES PAYAD2F.
  1555         10  PAYAD2A PIC  X(0001).
  1556     05  PAYAD2I PIC  X(0030).
  1557*    -------------------------------
  1558     05  VOIDEDL PIC S9(0004) COMP.
  1559     05  VOIDEDF PIC  X(0001).
  1560     05  FILLER REDEFINES VOIDEDF.
  1561         10  VOIDEDA PIC  X(0001).
  1562     05  VOIDEDI PIC  X(0008).
  1563*    -------------------------------
  1564     05  VBYL PIC S9(0004) COMP.
  1565     05  VBYF PIC  X(0001).
  1566     05  FILLER REDEFINES VBYF.
  1567         10  VBYA PIC  X(0001).
  1568     05  VBYI PIC  X(0004).
  1569*    -------------------------------
  1570     05  PAYCTYL PIC S9(0004) COMP.
  1571     05  PAYCTYF PIC  X(0001).
  1572     05  FILLER REDEFINES PAYCTYF.
  1573         10  PAYCTYA PIC  X(0001).
  1574     05  PAYCTYI PIC  X(0028).
  1575*    -------------------------------
  1576     05  PAYSTL PIC S9(0004) COMP.
  1577     05  PAYSTF PIC  X(0001).
  1578     05  FILLER REDEFINES PAYSTF.
  1579         10  PAYSTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  29
* EL677.cbl
  1580     05  PAYSTI PIC  X(0002).
  1581*    -------------------------------
  1582     05  PRINTEDL PIC S9(0004) COMP.
  1583     05  PRINTEDF PIC  X(0001).
  1584     05  FILLER REDEFINES PRINTEDF.
  1585         10  PRINTEDA PIC  X(0001).
  1586     05  PRINTEDI PIC  X(0008).
  1587*    -------------------------------
  1588     05  PTOZIPL PIC S9(0004) COMP.
  1589     05  PTOZIPF PIC  X(0001).
  1590     05  FILLER REDEFINES PTOZIPF.
  1591         10  PTOZIPA PIC  X(0001).
  1592     05  PTOZIPI PIC  X(0009).
  1593*    -------------------------------
  1594     05  DEDCYNL PIC S9(0004) COMP.
  1595     05  DEDCYNF PIC  X(0001).
  1596     05  FILLER REDEFINES DEDCYNF.
  1597         10  DEDCYNA PIC  X(0001).
  1598     05  DEDCYNI PIC  X(0001).
  1599*    -------------------------------
  1600     05  CASHEDL PIC S9(0004) COMP.
  1601     05  CASHEDF PIC  X(0001).
  1602     05  FILLER REDEFINES CASHEDF.
  1603         10  CASHEDA PIC  X(0001).
  1604     05  CASHEDI PIC  X(0008).
  1605*    -------------------------------
  1606     05  RETTOL PIC S9(0004) COMP.
  1607     05  RETTOF PIC  X(0001).
  1608     05  FILLER REDEFINES RETTOF.
  1609         10  RETTOA PIC  X(0001).
  1610     05  RETTOI PIC  X(0030).
  1611*    -------------------------------
  1612     05  DPREML PIC S9(0004) COMP.
  1613     05  DPREMF PIC  X(0001).
  1614     05  FILLER REDEFINES DPREMF.
  1615         10  DPREMA PIC  X(0001).
  1616     05  DPREMI PIC  X(0005).
  1617*    -------------------------------
  1618     05  PREML PIC S9(0004) COMP.
  1619     05  PREMF PIC  X(0001).
  1620     05  FILLER REDEFINES PREMF.
  1621         10  PREMA PIC  X(0001).
  1622     05  PREMI PIC  X(0008).
  1623*    -------------------------------
  1624     05  DCOMML PIC S9(0004) COMP.
  1625     05  DCOMMF PIC  X(0001).
  1626     05  FILLER REDEFINES DCOMMF.
  1627         10  DCOMMA PIC  X(0001).
  1628     05  DCOMMI PIC  X(0005).
  1629*    -------------------------------
  1630     05  ISSCOMML PIC S9(0004) COMP.
  1631     05  ISSCOMMF PIC  X(0001).
  1632     05  FILLER REDEFINES ISSCOMMF.
  1633         10  ISSCOMMA PIC  X(0001).
  1634     05  ISSCOMMI PIC  X(0008).
  1635*    -------------------------------
  1636     05  DREFL PIC S9(0004) COMP.
  1637     05  DREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  30
* EL677.cbl
  1638     05  FILLER REDEFINES DREFF.
  1639         10  DREFA PIC  X(0001).
  1640     05  DREFI PIC  X(0004).
  1641*    -------------------------------
  1642     05  REFL PIC S9(0004) COMP.
  1643     05  REFF PIC  X(0001).
  1644     05  FILLER REDEFINES REFF.
  1645         10  REFA PIC  X(0001).
  1646     05  REFI PIC  X(0008).
  1647*    -------------------------------
  1648     05  DUECOMML PIC S9(0004) COMP.
  1649     05  DUECOMMF PIC  X(0001).
  1650     05  FILLER REDEFINES DUECOMMF.
  1651         10  DUECOMMA PIC  X(0001).
  1652     05  DUECOMMI PIC  X(0007).
  1653*    -------------------------------
  1654     05  UECOMML PIC S9(0004) COMP.
  1655     05  UECOMMF PIC  X(0001).
  1656     05  FILLER REDEFINES UECOMMF.
  1657         10  UECOMMA PIC  X(0001).
  1658     05  UECOMMI PIC  X(0008).
  1659*    -------------------------------
  1660     05  DPREPDL PIC S9(0004) COMP.
  1661     05  DPREPDF PIC  X(0001).
  1662     05  FILLER REDEFINES DPREPDF.
  1663         10  DPREPDA PIC  X(0001).
  1664     05  DPREPDI PIC  X(0006).
  1665*    -------------------------------
  1666     05  PREPDL PIC S9(0004) COMP.
  1667     05  PREPDF PIC  X(0001).
  1668     05  FILLER REDEFINES PREPDF.
  1669         10  PREPDA PIC  X(0001).
  1670     05  PREPDI PIC  X(0008).
  1671*    -------------------------------
  1672     05  AMOUNTL PIC S9(0004) COMP.
  1673     05  AMOUNTF PIC  X(0001).
  1674     05  FILLER REDEFINES AMOUNTF.
  1675         10  AMOUNTA PIC  X(0001).
  1676     05  AMOUNTI PIC  S9(9)V99.
  1677*    -------------------------------
  1678     05  CHECKL PIC S9(0004) COMP.
  1679     05  CHECKF PIC  X(0001).
  1680     05  FILLER REDEFINES CHECKF.
  1681         10  CHECKA PIC  X(0001).
  1682     05  CHECKI PIC  X(0007).
  1683*    -------------------------------
  1684     05  TYPEL PIC S9(0004) COMP.
  1685     05  TYPEF PIC  X(0001).
  1686     05  FILLER REDEFINES TYPEF.
  1687         10  TYPEA PIC  X(0001).
  1688     05  TYPEI PIC  X(0001).
  1689*    -------------------------------
  1690     05  REASONL PIC S9(0004) COMP.
  1691     05  REASONF PIC  X(0001).
  1692     05  FILLER REDEFINES REASONF.
  1693         10  REASONA PIC  X(0001).
  1694     05  REASONI PIC  X(0025).
  1695*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  31
* EL677.cbl
  1696     05  VREASONL PIC S9(0004) COMP.
  1697     05  VREASONF PIC  X(0001).
  1698     05  FILLER REDEFINES VREASONF.
  1699         10  VREASONA PIC  X(0001).
  1700     05  VREASONI PIC  X(0024).
  1701*    -------------------------------
  1702     05  STUBL PIC S9(0004) COMP.
  1703     05  STUBF PIC  X(0001).
  1704     05  FILLER REDEFINES STUBF.
  1705         10  STUBA PIC  X(0001).
  1706     05  STUBI PIC  X(0030).
  1707*    -------------------------------
  1708     05  TEXT1L PIC S9(0004) COMP.
  1709     05  TEXT1F PIC  X(0001).
  1710     05  FILLER REDEFINES TEXT1F.
  1711         10  TEXT1A PIC  X(0001).
  1712     05  TEXT1I PIC  X(0050).
  1713*    -------------------------------
  1714     05  TEXT2L PIC S9(0004) COMP.
  1715     05  TEXT2F PIC  X(0001).
  1716     05  FILLER REDEFINES TEXT2F.
  1717         10  TEXT2A PIC  X(0001).
  1718     05  TEXT2I PIC  X(0050).
  1719*    -------------------------------
  1720     05  TEXT3L PIC S9(0004) COMP.
  1721     05  TEXT3F PIC  X(0001).
  1722     05  FILLER REDEFINES TEXT3F.
  1723         10  TEXT3A PIC  X(0001).
  1724     05  TEXT3I PIC  X(0040).
  1725*    -------------------------------
  1726     05  ERRMSG1L PIC S9(0004) COMP.
  1727     05  ERRMSG1F PIC  X(0001).
  1728     05  FILLER REDEFINES ERRMSG1F.
  1729         10  ERRMSG1A PIC  X(0001).
  1730     05  ERRMSG1I PIC  X(0079).
  1731*    -------------------------------
  1732     05  ERRMSG2L PIC S9(0004) COMP.
  1733     05  ERRMSG2F PIC  X(0001).
  1734     05  FILLER REDEFINES ERRMSG2F.
  1735         10  ERRMSG2A PIC  X(0001).
  1736     05  ERRMSG2I PIC  X(0079).
  1737*    -------------------------------
  1738     05  PFENTERL PIC S9(0004) COMP.
  1739     05  PFENTERF PIC  X(0001).
  1740     05  FILLER REDEFINES PFENTERF.
  1741         10  PFENTERA PIC  X(0001).
  1742     05  PFENTERI PIC  9(2).
  1743*    -------------------------------
  1744     05  PF357L PIC S9(0004) COMP.
  1745     05  PF357F PIC  X(0001).
  1746     05  FILLER REDEFINES PF357F.
  1747         10  PF357A PIC  X(0001).
  1748     05  PF357I PIC  X(0050).
  1749*    -------------------------------
  1750     05  PF46L PIC S9(0004) COMP.
  1751     05  PF46F PIC  X(0001).
  1752     05  FILLER REDEFINES PF46F.
  1753         10  PF46A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  32
* EL677.cbl
  1754     05  PF46I PIC  X(0033).
  1755 01  EL677AO REDEFINES EL677AI.
  1756     05  FILLER            PIC  X(0012).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  DATEO PIC  X(0008).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  TIMEO PIC  99.99.
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  MAINTO PIC  X(0001).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  DMAINT1O PIC  X(0009).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  DMAINT2O PIC  X(0029).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  CARRIERO PIC  X(0001).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  GROUPO PIC  X(0006).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  STATEO PIC  X(0002).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  ACCTO PIC  X(0010).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  EFFDTO PIC  99B99B99.
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  CERTNOO PIC  X(0010).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  SFXO PIC  X(0001).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  SEQO PIC  99.
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  PAYTO1O PIC  X(0030).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  CREATEDO PIC  X(0008).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  CBYO PIC  X(0004).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  PAYTO2O PIC  X(0030).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  PAYEEO PIC  X(0006).
  1811*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  33
* EL677.cbl
  1812     05  FILLER            PIC  X(0003).
  1813     05  APVSTATO PIC  X(0009).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  PAYAD1O PIC  X(0030).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  APVDTO PIC  X(0008).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  APVBYO PIC  X(0004).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  PAYAD2O PIC  X(0030).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  VOIDEDO PIC  X(0008).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  VBYO PIC  X(0004).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  PAYCTYO PIC  X(0028).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  PAYSTO PIC  X(0002).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  PRINTEDO PIC  99B99B99.
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  PTOZIPO PIC  X(0009).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  DEDCYNO PIC  X(0001).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  CASHEDO PIC  X(0008).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  RETTOO PIC  X(0030).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  DPREMO PIC  X(0005).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  PREMO PIC  Z(5).99.
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  DCOMMO PIC  X(0005).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  ISSCOMMO PIC  Z(5).99.
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  DREFO PIC  X(0004).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  34
* EL677.cbl
  1870     05  REFO PIC  Z(5).99.
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  DUECOMMO PIC  X(0007).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  UECOMMO PIC  Z(5).99.
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  DPREPDO PIC  X(0006).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  PREPDO PIC  Z(5).99.
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  AMOUNTO PIC  Z(7).ZZ-.
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  CHECKO PIC  X(0007).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  TYPEO PIC  X(0001).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  REASONO PIC  X(0025).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  VREASONO PIC  X(0024).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  STUBO PIC  X(0030).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  TEXT1O PIC  X(0050).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  TEXT2O PIC  X(0050).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  TEXT3O PIC  X(0040).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  ERRMSG1O PIC  X(0079).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  ERRMSG2O PIC  X(0079).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  PFENTERO PIC  99.
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  PF357O PIC  X(0050).
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  PF46O PIC  X(0033).
  1925*    -------------------------------
  1926****************************************************************
  1927*
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  35
* EL677.cbl
  1928* Copyright (c) 2007 by Clerity Solutions, Inc.
  1929* All rights reserved.
  1930*
  1931****************************************************************
  1932 01  DFHEIV.
  1933   02  DFHEIV0               PIC X(35).
  1934   02  DFHEIV1               PIC X(08).
  1935   02  DFHEIV2               PIC X(08).
  1936   02  DFHEIV3               PIC X(08).
  1937   02  DFHEIV4               PIC X(06).
  1938   02  DFHEIV5               PIC X(04).
  1939   02  DFHEIV6               PIC X(04).
  1940   02  DFHEIV7               PIC X(02).
  1941   02  DFHEIV8               PIC X(02).
  1942   02  DFHEIV9               PIC X(01).
  1943   02  DFHEIV10              PIC S9(7) COMP-3.
  1944   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1945   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1946   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1947   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1948   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1949   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1950   02  DFHEIV17              PIC X(04).
  1951   02  DFHEIV18              PIC X(04).
  1952   02  DFHEIV19              PIC X(04).
  1953   02  DFHEIV20              USAGE IS POINTER.
  1954   02  DFHEIV21              USAGE IS POINTER.
  1955   02  DFHEIV22              USAGE IS POINTER.
  1956   02  DFHEIV23              USAGE IS POINTER.
  1957   02  DFHEIV24              USAGE IS POINTER.
  1958   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1959   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1960   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1961   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1962   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1963   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1964   02  FILLER                PIC X(02).
  1965   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1966   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1967   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1968   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1969   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1970 LINKAGE  SECTION.
  1971*****************************************************************
  1972*                                                               *
  1973* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1974* All rights reserved.                                          *
  1975*                                                               *
  1976*****************************************************************
  1977 01  dfheiblk.
  1978     02  eibtime          pic s9(7) comp-3.
  1979     02  eibdate          pic s9(7) comp-3.
  1980     02  eibtrnid         pic x(4).
  1981     02  eibtaskn         pic s9(7) comp-3.
  1982     02  eibtrmid         pic x(4).
  1983     02  dfheigdi         pic s9(4) comp.
  1984     02  eibcposn         pic s9(4) comp.
  1985     02  eibcalen         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  36
* EL677.cbl
  1986     02  eibaid           pic x(1).
  1987     02  eibfiller1       pic x(1).
  1988     02  eibfn            pic x(2).
  1989     02  eibfiller2       pic x(2).
  1990     02  eibrcode         pic x(6).
  1991     02  eibfiller3       pic x(2).
  1992     02  eibds            pic x(8).
  1993     02  eibreqid         pic x(8).
  1994     02  eibrsrce         pic x(8).
  1995     02  eibsync          pic x(1).
  1996     02  eibfree          pic x(1).
  1997     02  eibrecv          pic x(1).
  1998     02  eibsend          pic x(1).
  1999     02  eibatt           pic x(1).
  2000     02  eibeoc           pic x(1).
  2001     02  eibfmh           pic x(1).
  2002     02  eibcompl         pic x(1).
  2003     02  eibsig           pic x(1).
  2004     02  eibconf          pic x(1).
  2005     02  eiberr           pic x(1).
  2006     02  eibrldbk         pic x(1).
  2007     02  eiberrcd         pic x(4).
  2008     02  eibsynrb         pic x(1).
  2009     02  eibnodat         pic x(1).
  2010     02  eibfiller5       pic x(2).
  2011     02  eibresp          pic 9(09) comp.
  2012     02  eibresp2         pic 9(09) comp.
  2013     02  dfheigdj         pic s9(4) comp.
  2014     02  dfheigdk         pic s9(4) comp.
  2015 01  DFHCOMMAREA                     PIC X(1024).
  2016 01  var  pic x(30).
  2017*                                    COPY ELCCNTL.
  2018******************************************************************
  2019*                                                                *
  2020*                                                                *
  2021*                            ELCCNTL.                            *
  2022*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2023*                            VMOD=2.059                          *
  2024*                                                                *
  2025*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2026*                                                                *
  2027*   FILE TYPE = VSAM,KSDS                                        *
  2028*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2029*                                                                *
  2030*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2031*       ALTERNATE INDEX = NONE                                   *
  2032*                                                                *
  2033*   LOG = YES                                                    *
  2034*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2035******************************************************************
  2036*                   C H A N G E   L O G
  2037*
  2038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2039*-----------------------------------------------------------------
  2040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2041* EFFECTIVE    NUMBER
  2042*-----------------------------------------------------------------
  2043* 082503                   PEMA  ADD BENEFIT GROUP
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  37
* EL677.cbl
  2044* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2045* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2046* 092705    2005050300006  PEMA  ADD SPP LEASES
  2047* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2048* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2049* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2050* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2051* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2052* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2053* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2054* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2055* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2056******************************************************************
  2057*
  2058 01  CONTROL-FILE.
  2059     12  CF-RECORD-ID                       PIC XX.
  2060         88  VALID-CF-ID                        VALUE 'CF'.
  2061
  2062     12  CF-CONTROL-PRIMARY.
  2063         16  CF-COMPANY-ID                  PIC XXX.
  2064         16  CF-RECORD-TYPE                 PIC X.
  2065             88  CF-COMPANY-MASTER              VALUE '1'.
  2066             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2067             88  CF-STATE-MASTER                VALUE '3'.
  2068             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2069             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2070             88  CF-CARRIER-MASTER              VALUE '6'.
  2071             88  CF-MORTALITY-MASTER            VALUE '7'.
  2072             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2073             88  CF-TERMINAL-MASTER             VALUE '9'.
  2074             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2075             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2076             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2077             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2078             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2079             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2080             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2081             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2082             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2083         16  CF-ACCESS-CD-GENL              PIC X(4).
  2084         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2085             20  CF-PROCESSOR               PIC X(4).
  2086         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2087             20  CF-STATE-CODE              PIC XX.
  2088             20  FILLER                     PIC XX.
  2089         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2090             20  FILLER                     PIC XX.
  2091             20  CF-HI-BEN-IN-REC           PIC XX.
  2092         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2093             20  FILLER                     PIC XXX.
  2094             20  CF-CARRIER-CNTL            PIC X.
  2095         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2096             20  FILLER                     PIC XX.
  2097             20  CF-HI-TYPE-IN-REC          PIC 99.
  2098         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2099             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2100                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2101             20  CF-CRDB-BENEFIT-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  38
* EL677.cbl
  2102             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2103         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2104             20  FILLER                     PIC X.
  2105             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2106         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2107             20  FILLER                     PIC XX.
  2108             20  CF-MORTGAGE-PLAN           PIC XX.
  2109         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2110
  2111     12  CF-LAST-MAINT-DT                   PIC XX.
  2112     12  CF-LAST-MAINT-BY                   PIC X(4).
  2113     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2114
  2115     12  CF-RECORD-BODY                     PIC X(728).
  2116
  2117
  2118****************************************************************
  2119*             COMPANY MASTER RECORD                            *
  2120****************************************************************
  2121
  2122     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2123         16  CF-COMPANY-ADDRESS.
  2124             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2125             20  CF-CL-IN-CARE-OF           PIC X(30).
  2126             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2127             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2128             20  CF-CL-CITY-STATE           PIC X(30).
  2129             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2130             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2131         16  CF-COMPANY-CD                  PIC X.
  2132         16  CF-COMPANY-PASSWORD            PIC X(8).
  2133         16  CF-SECURITY-OPTION             PIC X.
  2134             88  ALL-SECURITY                   VALUE '1'.
  2135             88  COMPANY-VERIFY                 VALUE '2'.
  2136             88  PROCESSOR-VERIFY               VALUE '3'.
  2137             88  NO-SECURITY                    VALUE '4'.
  2138             88  ALL-BUT-TERM                   VALUE '5'.
  2139         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2140             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2141         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2142             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2143         16  CF-INFORCE-LOCATION            PIC X.
  2144             88  CERTS-ARE-ONLINE               VALUE '1'.
  2145             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2146             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2147         16  CF-LOWER-CASE-LETTERS          PIC X.
  2148         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2149             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2150             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2151             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2152             88  CF-ACCNT-CNTL                  VALUE '3'.
  2153             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2154
  2155         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2156         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2157
  2158         16  CF-LGX-CREDIT-USER             PIC X.
  2159             88  CO-IS-NOT-USER                 VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  39
* EL677.cbl
  2160             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2161
  2162         16 CF-CREDIT-CALC-CODES.
  2163             20  CF-CR-REM-TERM-CALC PIC X.
  2164               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2165               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2166               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2167               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2168               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2169               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2170               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2171             20  CF-CR-R78-METHOD           PIC X.
  2172               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2173               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2174
  2175         16  CF-CLAIM-CONTROL-COUNTS.
  2176             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2177                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2178
  2179             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2180                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2181
  2182             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2183                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2184
  2185             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2186                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2187
  2188         16  CF-CURRENT-MONTH-END           PIC XX.
  2189
  2190         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2191             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2192             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2193             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2194             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2195                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2196                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2197             20  CF-CO-PREM-REJECT-SW       PIC X.
  2198                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2199                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2200             20  CF-CO-REF-REJECT-SW        PIC X.
  2201                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2202                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2203
  2204         16  CF-CO-REPORTING-DT             PIC XX.
  2205         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2206         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2207           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2208           88  CF-CO-MONTH-END                  VALUE '1'.
  2209
  2210         16  CF-LGX-CLAIM-USER              PIC X.
  2211             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2212             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2213
  2214         16  CF-CREDIT-EDIT-CONTROLS.
  2215             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2216             20  CF-MIN-AGE                 PIC 99.
  2217             20  CF-DEFAULT-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  40
* EL677.cbl
  2218             20  CF-MIN-TERM                PIC S999      COMP-3.
  2219             20  CF-MAX-TERM                PIC S999      COMP-3.
  2220             20  CF-DEFAULT-SEX             PIC X.
  2221             20  CF-JOINT-AGE-INPUT         PIC X.
  2222                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2223             20  CF-BIRTH-DATE-INPUT        PIC X.
  2224                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2225             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2226                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2227                 88  CF-ZERO-CARRIER            VALUE '1'.
  2228                 88  CF-ZERO-GROUPING           VALUE '2'.
  2229                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2230             20  CF-EDIT-SW                 PIC X.
  2231                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2232             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2233             20  CF-CR-PR-METHOD            PIC X.
  2234               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2235               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2236             20  FILLER                     PIC X.
  2237
  2238         16  CF-CREDIT-MISC-CONTROLS.
  2239             20  CF-REIN-TABLE-SW           PIC X.
  2240                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2241             20  CF-COMP-TABLE-SW           PIC X.
  2242                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2243             20  CF-EXPERIENCE-RETENTION-AGE
  2244                                            PIC S9        COMP-3.
  2245             20  CF-CONVERSION-DT           PIC XX.
  2246             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2247             20  CF-RUN-FREQUENCY-SW        PIC X.
  2248                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2249                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2250
  2251             20  CF-CR-CHECK-NO-CONTROL.
  2252                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2253                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2254                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2255                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2256                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2257                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2258
  2259                 24  CF-CR-CHECK-COUNT       REDEFINES
  2260                     CF-CR-CHECK-COUNTER      PIC X(4).
  2261
  2262                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2263                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2264
  2265                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2266                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2267                 24  CF-MAIL-PROCESSING       PIC X.
  2268                     88  MAIL-PROCESSING          VALUE 'Y'.
  2269
  2270         16  CF-MISC-SYSTEM-CONTROL.
  2271             20  CF-SYSTEM-C                 PIC X.
  2272                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2273             20  CF-SYSTEM-D                 PIC X.
  2274                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2275             20  CF-SOC-SEC-NO-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  41
* EL677.cbl
  2276                 88  SOC-SEC-NO-USED             VALUE '1'.
  2277             20  CF-MEMBER-NO-SW             PIC X.
  2278                 88  MEMBER-NO-USED              VALUE '1'.
  2279             20  CF-TAX-ID-NUMBER            PIC X(11).
  2280             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2281             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2282                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2283                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2284                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2285                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2286             20  CF-SYSTEM-E                 PIC X.
  2287                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2288
  2289         16  CF-LGX-LIFE-USER               PIC X.
  2290             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2291             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2292
  2293         16  CF-CR-MONTH-END-DT             PIC XX.
  2294
  2295         16  CF-FILE-MAINT-DATES.
  2296             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2297                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2298             20  CF-LAST-BATCH       REDEFINES
  2299                 CF-LAST-BATCH-NO               PIC X(4).
  2300             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2301             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2302             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2303             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2304             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2305             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2306             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2307             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2308             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2309             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2310
  2311         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2312         16  FILLER                         PIC X.
  2313
  2314         16  CF-ALT-MORT-CODE               PIC X(4).
  2315         16  CF-MEMBER-CAPTION              PIC X(10).
  2316
  2317         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2318             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2319             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2320             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2321             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2322             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2323
  2324         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2325
  2326         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2327         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2328         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2329         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2330
  2331         16  CF-AH-OVERRIDE-L1              PIC X.
  2332         16  CF-AH-OVERRIDE-L2              PIC XX.
  2333         16  CF-AH-OVERRIDE-L6              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  42
* EL677.cbl
  2334         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2335
  2336         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2337         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2338
  2339         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2340         16  CF-AR-LAST-EL860-DT            PIC XX.
  2341         16  CF-MP-MONTH-END-DT             PIC XX.
  2342
  2343         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2344         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2345             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2346
  2347         16  CF-AR-MONTH-END-DT             PIC XX.
  2348
  2349         16  CF-CRDTCRD-USER                PIC X.
  2350             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2351             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2352
  2353         16  CF-CC-MONTH-END-DT             PIC XX.
  2354
  2355         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2356
  2357         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2358             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2359             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2360             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2361         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2362         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2363         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2364         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2365             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2366             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2367         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2368         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2369         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2370             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2371         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2372
  2373         16  CF-CL-ZIP-CODE.
  2374             20  CF-CL-ZIP-PRIME.
  2375                 24  CF-CL-ZIP-1ST          PIC X.
  2376                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2377                 24  FILLER                 PIC X(4).
  2378             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2379         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2380             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2381             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2382             20  FILLER                     PIC XXX.
  2383
  2384         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2385         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2386         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2387         16  CF-CO-OPTION-START-DATE        PIC XX.
  2388         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2389           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2390                                                      '3' '4'.
  2391           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  43
* EL677.cbl
  2392           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2393           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2394           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2395           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2396           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2397
  2398         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2399
  2400         16  CF-PAYMENT-APPROVAL-LEVELS.
  2401             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2402             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2403             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2404             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2405             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2406             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2407
  2408         16  CF-END-USER-REPORTING-USER     PIC X.
  2409             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2410             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2411
  2412         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2413             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2414             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2415
  2416         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2417
  2418         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2419         16  FILLER                         PIC X.
  2420
  2421         16  CF-CREDIT-ARCHIVE-CNTL.
  2422             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2423             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2424             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2425
  2426         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2427
  2428         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2429             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2430             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2431
  2432         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2433             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2434             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2435
  2436         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2437
  2438         16  CF-CO-ACH-ID-CODE              PIC  X.
  2439             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2440             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2441             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2442         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2443         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2444         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2445         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2446         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2447         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2448         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2449         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  44
* EL677.cbl
  2450         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2451                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2452         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2453                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2454
  2455         16  CF-CO-OVER-SHORT.
  2456             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2457             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2458
  2459*         16  FILLER                         PIC X(102).
  2460         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2461             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2462             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2463
  2464         16  CF-AH-APPROVAL-DAYS.
  2465             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2466             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2467             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2468             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2469
  2470         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2471
  2472         16  CF-APPROV-LEV-5.
  2473             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2474             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2475             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2476
  2477         16  FILLER                         PIC X(68).
  2478****************************************************************
  2479*             PROCESSOR/USER RECORD                            *
  2480****************************************************************
  2481
  2482     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2483         16  CF-PROCESSOR-NAME              PIC X(30).
  2484         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2485         16  CF-PROCESSOR-TITLE             PIC X(26).
  2486         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2487                 88  MESSAGE-YES                VALUE 'Y'.
  2488                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2489
  2490*****************************************************
  2491****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2492****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2493****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2494****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2495*****************************************************
  2496
  2497         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2498             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2499             20  CF-APPLICATION-FORCE       PIC X.
  2500             20  CF-INDIVIDUAL-APP.
  2501                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2502                     28  CF-BROWSE-APP      PIC X.
  2503                     28  CF-UPDATE-APP      PIC X.
  2504
  2505         16  CF-CURRENT-TERM-ON             PIC X(4).
  2506         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2507             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  45
* EL677.cbl
  2508             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2509             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2510             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2511             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2512             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2513             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2514         16  CF-PROCESSOR-CARRIER           PIC X.
  2515             88  NO-CARRIER-SECURITY            VALUE ' '.
  2516         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2517             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2518         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2519             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2520         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2521             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2522
  2523         16  CF-PROC-SYS-ACCESS-SW.
  2524             20  CF-PROC-CREDIT-CLAIMS-SW.
  2525                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2526                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2527                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2528                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2529             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2530                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2531                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2532             20  CF-PROC-LIFE-GNRLDGR-SW.
  2533                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2534                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2535                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2536                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2537             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2538                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2539                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2540         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2541             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2542             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2543         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2544
  2545         16  CF-APPROVAL-LEVEL                  PIC X.
  2546             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2547             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2548             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2549             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2550             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2551
  2552         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2553
  2554         16  CF-LANGUAGE-TYPE                   PIC X.
  2555             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2556             88  CF-LANG-IS-FR                      VALUE 'F'.
  2557
  2558         16  CF-CSR-IND                         PIC X.
  2559         16  FILLER                             PIC X(239).
  2560
  2561****************************************************************
  2562*             PROCESSOR/REMINDERS RECORD                       *
  2563****************************************************************
  2564
  2565     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  46
* EL677.cbl
  2566         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2567             20  CF-START-REMIND-DT         PIC XX.
  2568             20  CF-END-REMIND-DT           PIC XX.
  2569             20  CF-REMINDER-TEXT           PIC X(50).
  2570         16  FILLER                         PIC X(296).
  2571
  2572
  2573****************************************************************
  2574*             STATE MASTER RECORD                              *
  2575****************************************************************
  2576
  2577     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2578         16  CF-STATE-ABBREVIATION          PIC XX.
  2579         16  CF-STATE-NAME                  PIC X(25).
  2580         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2581         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2582             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2583             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2584             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2585             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2586                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2587                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2588             20  CF-ST-PREM-REJECT-SW       PIC X.
  2589                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2590                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2591             20  CF-ST-REF-REJECT-SW        PIC X.
  2592                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2593                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2594         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2595         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2596         16  CF-ST-REFUND-RULES.
  2597             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2598             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2599             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2600         16  CF-ST-FST-PMT-EXTENSION.
  2601             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2602             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2603                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2604                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2605                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2606                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2607         16  CF-ST-STATE-CALL.
  2608             20  CF-ST-CALL-UNEARNED        PIC X.
  2609             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2610             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2611         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2612             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2613             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2614         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2615         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2616         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2617         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2618         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2619         16  FILLER                         PIC X.
  2620         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2621             20  CF-ST-BENEFIT-CD           PIC XX.
  2622             20  CF-ST-BENEFIT-KIND         PIC X.
  2623                 88  CF-ST-LIFE-KIND            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  47
* EL677.cbl
  2624                 88  CF-ST-AH-KIND              VALUE 'A'.
  2625             20  CF-ST-REM-TERM-CALC        PIC X.
  2626                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2627                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2628                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2629                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2630                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2631                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2632                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2633                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2634
  2635             20  CF-ST-REFUND-CALC          PIC X.
  2636                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2637                 88  ST-REFD-BY-R78             VALUE '1'.
  2638                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2639                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2640                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2641                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2642                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2643                 88  ST-REFD-UTAH               VALUE '7'.
  2644                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2645                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2646                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2647
  2648             20  CF-ST-EARNING-CALC         PIC X.
  2649                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2650                 88  ST-EARN-BY-R78             VALUE '1'.
  2651                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2652                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2653                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2654                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2655                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2656                 88  ST-EARN-MEAN               VALUE '8'.
  2657                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2658
  2659             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2660                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2661                 88  ST-OVRD-BY-R78             VALUE '1'.
  2662                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2663                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2664                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2665                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2666                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2667                 88  ST-OVRD-MEAN               VALUE '8'.
  2668                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2669             20  FILLER                     PIC X.
  2670
  2671         16  CF-ST-COMMISSION-CAPS.
  2672             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2673             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2674             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2675             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2676         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2677                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2678
  2679         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2680
  2681         16  CF-ST-STATUTORY-INTEREST.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  48
* EL677.cbl
  2682             20  CF-ST-STAT-DATE-FROM       PIC X.
  2683                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2684                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2685             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2686             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2687             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2688             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2689             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2690
  2691         16  CF-ST-OVER-SHORT.
  2692             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2693             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2694
  2695         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2696
  2697         16  CF-ST-RT-CALC                  PIC X.
  2698
  2699         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2700         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2701         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2702         16  CF-ST-RF-LR-CALC               PIC X.
  2703         16  CF-ST-RF-LL-CALC               PIC X.
  2704         16  CF-ST-RF-LN-CALC               PIC X.
  2705         16  CF-ST-RF-AH-CALC               PIC X.
  2706         16  CF-ST-RF-CP-CALC               PIC X.
  2707*        16  FILLER                         PIC X(206).
  2708*CIDMOD         16  FILLER                         PIC X(192).
  2709         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2710             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2711         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2712         16  CF-ST-VFY-2ND-BENE             PIC X.
  2713         16  CF-ST-CAUSAL-STATE             PIC X.
  2714         16  FILLER                         PIC X(185).
  2715
  2716****************************************************************
  2717*             BENEFIT MASTER RECORD                            *
  2718****************************************************************
  2719
  2720     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2721         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2722             20  CF-BENEFIT-CODE            PIC XX.
  2723             20  CF-BENEFIT-NUMERIC  REDEFINES
  2724                 CF-BENEFIT-CODE            PIC XX.
  2725             20  CF-BENEFIT-ALPHA           PIC XXX.
  2726             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2727             20  CF-BENEFIT-COMMENT         PIC X(10).
  2728
  2729             20  CF-LF-COVERAGE-TYPE        PIC X.
  2730                 88  CF-REDUCING                VALUE 'R'.
  2731                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2732
  2733             20  CF-SPECIAL-CALC-CD         PIC X.
  2734                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2735                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2736                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2737                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2738                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2739                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  49
* EL677.cbl
  2740                 88  CF-FARM-PLAN               VALUE 'F'.
  2741                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2742                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2743                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2744                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2745                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2746                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2747                 88  CF-PRUDENTIAL              VALUE 'P'.
  2748                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2749                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2750                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2751                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2752                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2753                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2754
  2755             20  CF-JOINT-INDICATOR         PIC X.
  2756                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2757
  2758*            20  FILLER                     PIC X(12).
  2759             20  FILLER                     PIC X(11).
  2760             20  CF-BENEFIT-CATEGORY        PIC X.
  2761             20  CF-LOAN-TYPE               PIC X(8).
  2762
  2763             20  CF-CO-REM-TERM-CALC        PIC X.
  2764                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2765                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2766                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2767                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2768                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2769
  2770             20  CF-CO-EARNINGS-CALC        PIC X.
  2771                 88  CO-EARN-BY-R78             VALUE '1'.
  2772                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2773                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2774                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2775                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2776                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2777                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2778                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2779
  2780             20  CF-CO-REFUND-CALC          PIC X.
  2781                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2782                 88  CO-REFD-BY-R78             VALUE '1'.
  2783                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2784                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2785                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2786                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2787                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2788                 88  CO-REFD-MEAN               VALUE '8'.
  2789                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2790                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2791                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2792
  2793             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2794                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2795                 88  CO-OVRD-BY-R78             VALUE '1'.
  2796                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2797                 88  CO-OVRD-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  50
* EL677.cbl
  2798                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2799                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2800                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2801                 88  CO-OVRD-MEAN               VALUE '8'.
  2802                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2803
  2804             20  CF-CO-BEN-I-G-CD           PIC X.
  2805                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2806                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2807                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2808
  2809         16  FILLER                         PIC X(304).
  2810
  2811
  2812****************************************************************
  2813*             CARRIER MASTER RECORD                            *
  2814****************************************************************
  2815
  2816     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2817         16  CF-ADDRESS-DATA.
  2818             20  CF-MAIL-TO-NAME            PIC X(30).
  2819             20  CF-IN-CARE-OF              PIC X(30).
  2820             20  CF-ADDRESS-LINE-1          PIC X(30).
  2821             20  CF-ADDRESS-LINE-2          PIC X(30).
  2822             20  CF-CITY-STATE              PIC X(30).
  2823             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2824             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2825
  2826         16  CF-CLAIM-NO-CONTROL.
  2827             20  CF-CLAIM-NO-METHOD         PIC X.
  2828                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2829                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2830                 88  CLAIM-NO-SEQ               VALUE '3'.
  2831                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2832             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2833                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2834                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2835                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2836
  2837         16  CF-CHECK-NO-CONTROL.
  2838             20  CF-CHECK-NO-METHOD         PIC X.
  2839                 88  CHECK-NO-MANUAL            VALUE '1'.
  2840                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2841                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2842                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2843             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2844                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2845
  2846         16  CF-DOMICILE-STATE              PIC XX.
  2847
  2848         16  CF-EXPENSE-CONTROLS.
  2849             20  CF-EXPENSE-METHOD          PIC X.
  2850                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2851                 88  DOLLARS-PER-PMT            VALUE '2'.
  2852                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2853                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2854             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2855             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  51
* EL677.cbl
  2856
  2857         16  CF-CORRESPONDENCE-CONTROL.
  2858             20  CF-LETTER-RESEND-OPT       PIC X.
  2859                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2860                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2861             20  FILLER                     PIC X(4).
  2862
  2863         16  CF-RESERVE-CONTROLS.
  2864             20  CF-MANUAL-SW               PIC X.
  2865                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2866             20  CF-FUTURE-SW               PIC X.
  2867                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2868             20  CF-PTC-SW                  PIC X.
  2869                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2870             20  CF-IBNR-SW                 PIC X.
  2871                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2872             20  CF-PTC-LF-SW               PIC X.
  2873                 88  CF-LF-PTC-USED             VALUE '1'.
  2874             20  CF-CDT-ACCESS-METHOD       PIC X.
  2875                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2876                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2877                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2878             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2879
  2880         16  CF-CLAIM-CALC-METHOD           PIC X.
  2881             88  360-PLUS-MONTHS                VALUE '1'.
  2882             88  365-PLUS-MONTHS                VALUE '2'.
  2883             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2884             88  360-DAILY                      VALUE '4'.
  2885             88  365-DAILY                      VALUE '5'.
  2886
  2887         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2888         16  FILLER                         PIC X(11).
  2889
  2890         16  CF-LIMIT-AMOUNTS.
  2891             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2892             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2893             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2894             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2895             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2896             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2897             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2898             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2899             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2900             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2901
  2902         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2903         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2904         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2905
  2906         16  CF-ZIP-CODE.
  2907             20  CF-ZIP-PRIME.
  2908                 24  CF-ZIP-1ST             PIC X.
  2909                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2910                 24  FILLER                 PIC X(4).
  2911             20  CF-ZIP-PLUS4               PIC X(4).
  2912         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2913             20  CF-CAN-POSTAL-1            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  52
* EL677.cbl
  2914             20  CF-CAN-POSTAL-2            PIC XXX.
  2915             20  FILLER                     PIC XXX.
  2916
  2917         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2918         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2919         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2920
  2921         16  CF-RATING-SWITCH               PIC X.
  2922             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2923             88  CF-NO-RATING                   VALUE 'N'.
  2924
  2925         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2926
  2927         16  CF-CARRIER-OVER-SHORT.
  2928             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2929             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2930
  2931         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2932         16  CF-SECPAY-SWITCH               PIC X.
  2933             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2934             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2935         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2936         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2937         16  FILLER                         PIC X(444).
  2938*        16  FILLER                         PIC X(452).
  2939
  2940
  2941****************************************************************
  2942*             MORTALITY MASTER RECORD                          *
  2943****************************************************************
  2944
  2945     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2946         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2947                                INDEXED BY CF-MORT-NDX.
  2948             20  CF-MORT-TABLE              PIC X(5).
  2949             20  CF-MORT-TABLE-TYPE         PIC X.
  2950                 88  CF-MORT-JOINT              VALUE 'J'.
  2951                 88  CF-MORT-SINGLE             VALUE 'S'.
  2952                 88  CF-MORT-COMBINED           VALUE 'C'.
  2953                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2954                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2955             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2956             20  CF-MORT-AGE-METHOD         PIC XX.
  2957                 88  CF-AGE-LAST                VALUE 'AL'.
  2958                 88  CF-AGE-NEAR                VALUE 'AN'.
  2959             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2960             20  CF-MORT-ADJUSTMENT-DIRECTION
  2961                                            PIC X.
  2962                 88  CF-MINUS                   VALUE '-'.
  2963                 88  CF-PLUS                    VALUE '+'.
  2964             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2965             20  CF-MORT-JOINT-CODE         PIC X.
  2966                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2967             20  CF-MORT-PC-Q               PIC X.
  2968                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2969             20  CF-MORT-TABLE-CODE         PIC X(4).
  2970             20  CF-MORT-COMMENTS           PIC X(15).
  2971             20  FILLER                     PIC X(14).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  53
* EL677.cbl
  2972
  2973         16  FILLER                         PIC X(251).
  2974
  2975
  2976****************************************************************
  2977*             BUSSINESS TYPE MASTER RECORD                     *
  2978****************************************************************
  2979
  2980     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2981* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2982* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2983* AND RECORD 05 IS TYPES 81-99
  2984         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2985             20  CF-BUSINESS-TITLE          PIC  X(19).
  2986             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2987                                            PIC S9V9(4) COMP-3.
  2988             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2989             20  FILLER                     PIC  X.
  2990         16  FILLER                         PIC  X(248).
  2991
  2992
  2993****************************************************************
  2994*             TERMINAL MASTER RECORD                           *
  2995****************************************************************
  2996
  2997     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2998
  2999         16  CF-COMPANY-TERMINALS.
  3000             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3001                                  PIC X(4).
  3002         16  FILLER               PIC X(248).
  3003
  3004
  3005****************************************************************
  3006*             LIFE EDIT MASTER RECORD                          *
  3007****************************************************************
  3008
  3009     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3010         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3011             20  CF-LIFE-CODE-IN            PIC XX.
  3012             20  CF-LIFE-CODE-OUT           PIC XX.
  3013         16  FILLER                         PIC X(248).
  3014
  3015
  3016****************************************************************
  3017*             AH EDIT MASTER RECORD                            *
  3018****************************************************************
  3019
  3020     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3021         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3022             20  CF-AH-CODE-IN              PIC XXX.
  3023             20  CF-AH-CODE-OUT             PIC XX.
  3024         16  FILLER                         PIC X(248).
  3025
  3026
  3027****************************************************************
  3028*             CREDIBILITY TABLES                               *
  3029****************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  54
* EL677.cbl
  3030
  3031     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3032         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3033                             INDEXED BY CF-CRDB-NDX.
  3034             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3035             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3036             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3037         16  FILLER                         PIC  X(332).
  3038
  3039
  3040****************************************************************
  3041*             REPORT CUSTOMIZATION RECORD                      *
  3042****************************************************************
  3043
  3044     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3045         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3046             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3047             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3048             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3049**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3050****       A T-TRANSFER.                                   ****
  3051             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3052
  3053         16  FILLER                         PIC XX.
  3054
  3055         16  CF-CARRIER-CNTL-OPT.
  3056             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3057                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3058                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3059             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3060                                            PIC X.
  3061         16  CF-GROUP-CNTL-OPT.
  3062             20  CF-GROUP-OPT-SEQ           PIC 9.
  3063                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3064                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3065             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3066                                            PIC X(6).
  3067         16  CF-STATE-CNTL-OPT.
  3068             20  CF-STATE-OPT-SEQ           PIC 9.
  3069                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3070                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3071             20  CF-STATE-SELECT OCCURS 3 TIMES
  3072                                            PIC XX.
  3073         16  CF-ACCOUNT-CNTL-OPT.
  3074             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3075                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3076                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3077             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3078                                            PIC X(10).
  3079         16  CF-BUS-TYP-CNTL-OPT.
  3080             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3081                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3082                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3083             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3084                                            PIC XX.
  3085         16  CF-LF-TYP-CNTL-OPT.
  3086             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3087                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  55
* EL677.cbl
  3088                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3089             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3090                                            PIC XX.
  3091         16  CF-AH-TYP-CNTL-OPT.
  3092             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3093                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3094                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3095             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3096                                            PIC XX.
  3097         16  CF-REPTCD1-CNTL-OPT.
  3098             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3099                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3100                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3101             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3102                                            PIC X(10).
  3103         16  CF-REPTCD2-CNTL-OPT.
  3104             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3105                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3106                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3107             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3108                                            PIC X(10).
  3109         16  CF-USER1-CNTL-OPT.
  3110             20  CF-USER1-OPT-SEQ           PIC 9.
  3111                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3112                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3113             20  CF-USER1-SELECT OCCURS 3 TIMES
  3114                                            PIC X(10).
  3115         16  CF-USER2-CNTL-OPT.
  3116             20  CF-USER2-OPT-SEQ           PIC 9.
  3117                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3118                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3119             20  CF-USER2-SELECT OCCURS 3 TIMES
  3120                                            PIC X(10).
  3121         16  CF-USER3-CNTL-OPT.
  3122             20  CF-USER3-OPT-SEQ           PIC 9.
  3123                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3124                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3125             20  CF-USER3-SELECT OCCURS 3 TIMES
  3126                                            PIC X(10).
  3127         16  CF-USER4-CNTL-OPT.
  3128             20  CF-USER4-OPT-SEQ           PIC 9.
  3129                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3130                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3131             20  CF-USER4-SELECT OCCURS 3 TIMES
  3132                                            PIC X(10).
  3133         16  CF-USER5-CNTL-OPT.
  3134             20  CF-USER5-OPT-SEQ           PIC 9.
  3135                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3136                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3137             20  CF-USER5-SELECT OCCURS 3 TIMES
  3138                                            PIC X(10).
  3139         16  CF-REINS-CNTL-OPT.
  3140             20  CF-REINS-OPT-SEQ           PIC 9.
  3141                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3142                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3143             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3144                 24  CF-REINS-PRIME         PIC XXX.
  3145                 24  CF-REINS-SUB           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  56
* EL677.cbl
  3146
  3147         16  CF-AGENT-CNTL-OPT.
  3148             20  CF-AGENT-OPT-SEQ           PIC 9.
  3149                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3150                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3151             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3152                                            PIC X(10).
  3153
  3154         16  FILLER                         PIC X(43).
  3155
  3156         16  CF-LOSS-RATIO-SELECT.
  3157             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3158             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3159         16  CF-ENTRY-DATE-SELECT.
  3160             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3161             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3162         16  CF-EFFECTIVE-DATE-SELECT.
  3163             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3164             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3165
  3166         16  CF-EXCEPTION-LIST-IND          PIC X.
  3167             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3168
  3169         16  FILLER                         PIC X(318).
  3170
  3171****************************************************************
  3172*                  EXCEPTION REPORTING RECORD                  *
  3173****************************************************************
  3174
  3175     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3176         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3177             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3178
  3179         16  CF-COMBINED-LIFE-AH-OPT.
  3180             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3181             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3182             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3183             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3184
  3185         16  CF-LIFE-OPT.
  3186             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3187             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3188             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3189             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3190             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3191             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3192             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3193             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3194             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3195             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3196
  3197         16  CF-AH-OPT.
  3198             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3199             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3200             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3201             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3202             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3203             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  57
* EL677.cbl
  3204             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3205             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3206             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3207             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3208
  3209         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3210             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3211             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3212             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3213
  3214         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3215
  3216         16  FILLER                         PIC X(673).
  3217
  3218
  3219****************************************************************
  3220*             MORTGAGE SYSTEM PLAN RECORD                      *
  3221****************************************************************
  3222
  3223     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3224         16  CF-PLAN-TYPE                   PIC X.
  3225             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3226             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3227             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3228         16  CF-PLAN-ABBREV                 PIC XXX.
  3229         16  CF-PLAN-DESCRIPT               PIC X(10).
  3230         16  CF-PLAN-NOTES                  PIC X(20).
  3231         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3232         16  CF-PLAN-UNDERWRITING.
  3233             20  CF-PLAN-TERM-DATA.
  3234                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3235                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3236             20  CF-PLAN-AGE-DATA.
  3237                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3238                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3239                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3240             20  CF-PLAN-BENEFIT-DATA.
  3241                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3242                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3243                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3244                                            PIC S9(7)V99  COMP-3.
  3245         16  CF-PLAN-POLICY-FORMS.
  3246             20  CF-POLICY-FORM             PIC X(12).
  3247             20  CF-MASTER-APPLICATION      PIC X(12).
  3248             20  CF-MASTER-POLICY           PIC X(12).
  3249         16  CF-PLAN-RATING.
  3250             20  CF-RATE-CODE               PIC X(5).
  3251             20  CF-SEX-RATING              PIC X.
  3252                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3253                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3254             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3255             20  CF-SUB-STD-TYPE            PIC X.
  3256                 88  CF-PCT-OF-PREM            VALUE '1'.
  3257                 88  CF-PCT-OF-BENE            VALUE '2'.
  3258         16  CF-PLAN-PREM-TOLERANCES.
  3259             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3260             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3261         16  CF-PLAN-PYMT-TOLERANCES.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  58
* EL677.cbl
  3262             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3263             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3264         16  CF-PLAN-MISC-DATA.
  3265             20  FILLER                     PIC X.
  3266             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3267             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3268         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3269         16  CF-PLAN-IND-GRP                PIC X.
  3270             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3271                                                     '1'.
  3272             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3273                                                     '2'.
  3274         16  CF-MIB-SEARCH-SW               PIC X.
  3275             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3276             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3277             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3278             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3279         16  CF-ALPHA-SEARCH-SW             PIC X.
  3280             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3281             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3282             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3283             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3284             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3285             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3286             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3287             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3288             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3289             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3290                                                     'A' 'B' 'C'
  3291                                                     'X' 'Y' 'Z'.
  3292         16  CF-EFF-DT-RULE-SW              PIC X.
  3293             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3294             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3295             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3296             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3297             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3298         16  FILLER                         PIC X(4).
  3299         16  CF-HEALTH-QUESTIONS            PIC X.
  3300             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3301         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3302         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3303         16  CF-PLAN-SNGL-JNT               PIC X.
  3304             88  CF-COMBINED-PLAN              VALUE 'C'.
  3305             88  CF-JNT-PLAN                   VALUE 'J'.
  3306             88  CF-SNGL-PLAN                  VALUE 'S'.
  3307         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3308         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3309         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3310         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3311         16  CF-RERATE-CNTL                 PIC  X.
  3312             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3313             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3314             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3315             88  CF-AUTO-RECALC                 VALUE '4'.
  3316         16  CF-BENEFIT-TYPE                PIC  X.
  3317             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3318             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3319         16  CF-POLICY-FEE                  PIC S999V99
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  59
* EL677.cbl
  3320                                                    COMP-3.
  3321         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3322         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3323         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3324         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3325         16  FILLER                         PIC  X(32).
  3326         16  CF-TERMINATION-FORM            PIC  X(04).
  3327         16  FILLER                         PIC  X(08).
  3328         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3329                                                       COMP-3.
  3330         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3331         16  CF-ISSUE-LETTER                PIC  X(4).
  3332         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3333         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3334             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3335             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3336         16  CF-MP-REFUND-CALC              PIC X.
  3337             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3338             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3339             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3340             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3341             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3342             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3343             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3344             88  CF-MP-REFD-MEAN                VALUE '8'.
  3345         16  CF-ALT-RATE-CODE               PIC  X(5).
  3346
  3347
  3348         16  FILLER                         PIC X(498).
  3349****************************************************************
  3350*             MORTGAGE COMPANY MASTER RECORD                   *
  3351****************************************************************
  3352
  3353     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3354         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3355         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3356             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3357             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3358             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3359             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3360             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3361
  3362         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3363         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3364         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3365         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3366         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3367
  3368         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3369             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3370         16  CF-MP-RECON-USE-IND            PIC X(1).
  3371             88  CF-MP-USE-RECON             VALUE 'Y'.
  3372         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3373             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3374         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3375             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3376             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3377         16  FILLER                         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  60
* EL677.cbl
  3378         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3379             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3380         16  CF-MORTG-MIB-VERSION           PIC X.
  3381             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3382             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3383             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3384         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3385             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3386                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3387             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3388                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3389             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3390                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3391             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3392                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3393             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3394                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3395             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3396                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3397         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3398         16  FILLER                         PIC X(7).
  3399         16  CF-MORTG-DESTINATION-SYMBOL.
  3400             20  CF-MORTG-MIB-COMM          PIC X(5).
  3401             20  CF-MORTG-MIB-TERM          PIC X(5).
  3402         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3403             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3404         16  FILLER                         PIC X(03).
  3405         16  CF-MP-CHECK-NO-CONTROL.
  3406             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3407                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3408                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3409                                                ' ' LOW-VALUES.
  3410                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3411                                               VALUE '3'.
  3412         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3413         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3414         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3415             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3416                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3417             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3418                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3419             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3420                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3421             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3422                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3423             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3424                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3425             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3426                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3427         16  CF-MORTG-BILLING-AREA.
  3428             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3429                                            PIC X.
  3430         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3431         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3432         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3433         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3434             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3435             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  61
* EL677.cbl
  3436         16  FILLER                         PIC X.
  3437         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3438             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3439             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3440         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3441         16  FILLER                         PIC X(8).
  3442         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3443         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3444         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3445         16  CF-ACH-COMPANY-ID.
  3446             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3447                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3448                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3449                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3450             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3451         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3452             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3453         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3454             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3455             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3456         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3457         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3458         16  FILLER                         PIC X(536).
  3459
  3460****************************************************************
  3461*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3462****************************************************************
  3463
  3464     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3465         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3466             20  CF-FEMALE-HEIGHT.
  3467                 24  CF-FEMALE-FT           PIC 99.
  3468                 24  CF-FEMALE-IN           PIC 99.
  3469             20  CF-FEMALE-MIN-WT           PIC 999.
  3470             20  CF-FEMALE-MAX-WT           PIC 999.
  3471         16  FILLER                         PIC X(428).
  3472
  3473     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3474         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3475             20  CF-MALE-HEIGHT.
  3476                 24  CF-MALE-FT             PIC 99.
  3477                 24  CF-MALE-IN             PIC 99.
  3478             20  CF-MALE-MIN-WT             PIC 999.
  3479             20  CF-MALE-MAX-WT             PIC 999.
  3480         16  FILLER                         PIC X(428).
  3481******************************************************************
  3482*             AUTOMATIC ACTIVITY RECORD                          *
  3483******************************************************************
  3484     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3485         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3486             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3487             20  CF-SYS-LETTER-ID           PIC X(04).
  3488             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3489             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3490             20  CF-SYS-RESET-SW            PIC X(01).
  3491             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3492             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3493
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  62
* EL677.cbl
  3494         16  FILLER                         PIC X(50).
  3495
  3496         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3497             20  CF-USER-ACTIVE-SW          PIC X(01).
  3498             20  CF-USER-LETTER-ID          PIC X(04).
  3499             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3500             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3501             20  CF-USER-RESET-SW           PIC X(01).
  3502             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3503             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3504             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3505
  3506         16  FILLER                         PIC X(246).
  3507*                                    COPY ERCCHEK.
  3508******************************************************************
  3509*                                                                *
  3510*                                                                *
  3511*                            ERCCHEK                             *
  3512*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3513*                            VMOD=2.008                          *
  3514*                                                                *
  3515*   FILE DESCRIPTION = CHECK RECORDS                             *
  3516*                                                                *
  3517*   FILE TYPE = VSAM,KSDS                                        *
  3518*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3519*                                                                *
  3520*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3521*       ALTERNATE INDEX = NONE                                   *
  3522*                                                                *
  3523*   LOG = YES                                                    *
  3524*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3525******************************************************************
  3526*                   C H A N G E   L O G
  3527*
  3528* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3529*-----------------------------------------------------------------
  3530*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3531* EFFECTIVE    NUMBER
  3532*-----------------------------------------------------------------
  3533* 021414    2003053000001  PEMA  changes for auto chk request
  3534******************************************************************
  3535 01  CHECK-RECORDS.
  3536     12  CH-RECORD-ID                      PIC XX.
  3537         88  VALID-CH-ID                      VALUE 'CH'.
  3538
  3539     12  CH-CONTROL-PRIMARY.
  3540         16  CH-COMPANY-CD                 PIC X.
  3541         16  CH-CARRIER                    PIC X.
  3542         16  CH-GROUPING                   PIC X(6).
  3543         16  CH-STATE                      PIC XX.
  3544         16  CH-ACCOUNT                    PIC X(10).
  3545         16  CH-CERT-EFF-DT                PIC XX.
  3546         16  CH-CERT-NO.
  3547             20  CH-CERT-PRIME             PIC X(10).
  3548             20  CH-CERT-SFX               PIC X.
  3549         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3550
  3551     12  CH-RECORDED-DT                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  63
* EL677.cbl
  3552     12  CH-RECORDED-BY                    PIC X(4).
  3553     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3554
  3555     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3556     12  CH-CHECK-NO                       PIC X(7).
  3557     12  CH-REASON-FOR-CHECK               PIC X(25).
  3558     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3559     12  FILLER                            PIC X.
  3560
  3561     12  CH-PAYEE-INFO.
  3562         16  CH-PAYEE-NAME-1               PIC X(30).
  3563         16  CH-PAYEE-NAME-2               PIC X(30).
  3564         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3565         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3566         16  CH-PAYEE-CITY-ST.
  3567             20  CH-PAYEE-CITY             PIC X(28).
  3568             20  CH-PAYEE-STATE            PIC XX.
  3569         16  CH-PAYEE-ZIP-CODE.
  3570             20  CH-PAYEE-ZIP.
  3571                 24  CH-ZIP-PRI-1ST        PIC X.
  3572                     88  CH-CANADIAN-POST-CODE
  3573                                           VALUES 'A' THRU 'Z'.
  3574                 24  FILLER                PIC X(4).
  3575             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3576         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3577             20  CH-CAN-POSTAL-1           PIC XXX.
  3578             20  CH-CAN-POSTAL-2           PIC XXX.
  3579             20  FILLER                    PIC XXX.
  3580
  3581     12  CH-CHECK-STUB-TEXT.
  3582         16  CH-STUB-LINE-1                PIC X(30).
  3583         16  CH-TEXT-LINE-1                PIC X(50).
  3584         16  CH-TEXT-LINE-2                PIC X(50).
  3585         16  CH-TEXT-LINE-3                PIC X(40).
  3586     12  CH-RETURN-TO                      PIC X(30).
  3587
  3588     12  CH-COMPENSATION-CONTROL.
  3589         16  CH-COMP-CARRIER               PIC X.
  3590         16  CH-COMP-GROUPING              PIC X(6).
  3591         16  CH-COMP-FIN-RESP              PIC X(10).
  3592         16  CH-COMP-ACCOUNT               PIC X(10).
  3593
  3594     12  CH-CREDIT-SELECT-DT               PIC XX.
  3595     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3596     12  CH-PAYEE-CODE                     PIC X(6).
  3597
  3598     12  CH-VOID-DATA.
  3599         20  CH-VOID-DT                    PIC XX.
  3600         20  CH-VOID-BY                    PIC X(4).
  3601         20  CH-VOID-REASON                PIC X(25).
  3602
  3603     12  CH-APPROVAL-DATA.
  3604         20  CH-APPROVAL-DT                PIC XX.
  3605         20  CH-APPROVAL-STATUS            PIC X.
  3606             88  CH-IN-LIMBO                  VALUE ' '.
  3607             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3608             88  CH-APPROVED                  VALUE 'A'.
  3609             88  CH-DENIED                    VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  64
* EL677.cbl
  3610         20  CH-APPROVED-BY                PIC XXXX.
  3611     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3612             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3613     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3614
  3615     12  ch-released-dt                    pic xx.
  3616     12  ch-check-cashed-dt                pic xx.
  3617     12  FILLER                            PIC X.
  3618*    12  CH-CHECK-REFERENCE                PIC X(12).
  3619     12  CH-CHECK-ORIGIN-SW                PIC X.
  3620             88  CH-REFUND-CHECK              VALUE 'R'.
  3621             88  CH-MAINT-CHECK               VALUE 'M'.
  3622
  3623     12  CH-CANC-DT                        PIC XX.
  3624     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3625     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3626
  3627     12  CH-INSURED-NAME                   PIC X(28).
  3628
  3629     12  ch-released-by                    pic x(4).
  3630     12  ch-csr                            pic x(4).
  3631     12  ch-deduct-commission              pic x.
  3632         88  ch-deduct-comm                  value 'Y'.
  3633         88  ch-do-not-deduct-comm           value 'N'.
  3634
  3635     12  FILLER                            PIC X(11).
  3636*    12  CH-LETTER-TABLE.
  3637*        16  CH-LETTERS OCCURS 3 TIMES
  3638*                       INDEXED BY CH-LT-NDX
  3639*                                          PIC X(04).
  3640
  3641     12  FILLER                            PIC X(07).
  3642
  3643*                                    COPY ERCACCT.
  3644******************************************************************
  3645*                                                                *
  3646*                                                                *
  3647*                            ERCACCT                             *
  3648*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3649*                            VMOD=2.031                          *
  3650*                                                                *
  3651*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3652*                                                                *
  3653*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3654*   VSAM ACCOUNT MASTER FILES.                                   *
  3655*                                                                *
  3656*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3657*                                                                *
  3658*   FILE TYPE = VSAM,KSDS                                        *
  3659*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3660*                                                                *
  3661*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3662*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3663*                                                                *
  3664*   LOG = NO                                                     *
  3665*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3666*                                                                *
  3667*                                                                *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  65
* EL677.cbl
  3668******************************************************************
  3669*                   C H A N G E   L O G
  3670*
  3671* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3672*-----------------------------------------------------------------
  3673*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3674* EFFECTIVE    NUMBER
  3675*-----------------------------------------------------------------
  3676* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3677* 092705    2005050300006  PEMA  ADD SPP LEASES
  3678* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3679* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3680* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3681* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3682* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3683******************************************************************
  3684
  3685 01  ACCOUNT-MASTER.
  3686     12  AM-RECORD-ID                      PIC XX.
  3687         88  VALID-AM-ID                      VALUE 'AM'.
  3688
  3689     12  AM-CONTROL-PRIMARY.
  3690         16  AM-COMPANY-CD                 PIC X.
  3691         16  AM-MSTR-CNTRL.
  3692             20  AM-CONTROL-A.
  3693                 24  AM-CARRIER            PIC X.
  3694                 24  AM-GROUPING.
  3695                     28 AM-GROUPING-PREFIX PIC XXX.
  3696                     28 AM-GROUPING-PRIME  PIC XXX.
  3697                 24  AM-STATE              PIC XX.
  3698                 24  AM-ACCOUNT.
  3699                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3700                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3701             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3702                                           PIC X(19).
  3703             20  AM-CNTRL-B.
  3704                 24  AM-EXPIRATION-DT      PIC XX.
  3705                 24  FILLER                PIC X(4).
  3706             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3707                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3708
  3709     12  AM-CONTROL-BY-VAR-GRP.
  3710         16  AM-COMPANY-CD-A1              PIC X.
  3711         16  AM-VG-CARRIER                 PIC X.
  3712         16  AM-VG-GROUPING                PIC X(6).
  3713         16  AM-VG-STATE                   PIC XX.
  3714         16  AM-VG-ACCOUNT                 PIC X(10).
  3715         16  AM-VG-DATE.
  3716             20  AM-VG-EXPIRATION-DT       PIC XX.
  3717             20  FILLER                    PIC X(4).
  3718         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3719                                           PIC 9(11)      COMP-3.
  3720     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3721         16  FILLER                        PIC X(10).
  3722         16  AM-VG-KEY3.
  3723             20  AM-VG3-ACCOUNT            PIC X(10).
  3724             20  AM-VG3-EXP-DT             PIC XX.
  3725         16  FILLER                        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  66
* EL677.cbl
  3726     12  AM-MAINT-INFORMATION.
  3727         16  AM-LAST-MAINT-DT              PIC XX.
  3728         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3729         16  AM-LAST-MAINT-USER            PIC X(4).
  3730         16  FILLER                        PIC XX.
  3731
  3732     12  AM-EFFECTIVE-DT                   PIC XX.
  3733     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3734
  3735     12  AM-PREV-DATES  COMP-3.
  3736         16  AM-PREV-EXP-DT                PIC 9(11).
  3737         16  AM-PREV-EFF-DT                PIC 9(11).
  3738
  3739     12  AM-REPORT-CODE-1                  PIC X(10).
  3740     12  AM-REPORT-CODE-2                  PIC X(10).
  3741
  3742     12  AM-CITY-CODE                      PIC X(4).
  3743     12  AM-COUNTY-PARISH                  PIC X(6).
  3744
  3745     12  AM-NAME                           PIC X(30).
  3746     12  AM-PERSON                         PIC X(30).
  3747     12  AM-ADDRS                          PIC X(30).
  3748     12  AM-CITY.
  3749         16  AM-ADDR-CITY                  PIC X(28).
  3750         16  AM-ADDR-STATE                 PIC XX.
  3751     12  AM-ZIP.
  3752         16  AM-ZIP-PRIME.
  3753             20  AM-ZIP-PRI-1ST            PIC X.
  3754                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3755             20  FILLER                    PIC X(4).
  3756         16  AM-ZIP-PLUS4                  PIC X(4).
  3757     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3758         16  AM-CAN-POSTAL-1               PIC XXX.
  3759         16  AM-CAN-POSTAL-2               PIC XXX.
  3760         16  FILLER                        PIC XXX.
  3761     12  AM-TEL-NO.
  3762         16  AM-AREA-CODE                  PIC 999.
  3763         16  AM-TEL-PRE                    PIC 999.
  3764         16  AM-TEL-NBR                    PIC 9(4).
  3765     12  AM-TEL-LOC                        PIC X.
  3766         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3767         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3768
  3769     12  AM-COMM-STRUCTURE.
  3770         16  AM-DEFN-1.
  3771             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3772                 24  AM-AGT.
  3773                     28  AM-AGT-PREFIX     PIC X(4).
  3774                     28  AM-AGT-PRIME      PIC X(6).
  3775                 24  AM-COM-TYP            PIC X.
  3776                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3777                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3778                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3779                 24  AM-RECALC-LV-INDIC    PIC X.
  3780                 24  AM-RETRO-LV-INDIC     PIC X.
  3781                 24  AM-GL-CODES           PIC X.
  3782                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3783                 24  FILLER                PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  67
* EL677.cbl
  3784         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3785             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3786                 24  FILLER                PIC X(11).
  3787                 24  AM-L-COMA             PIC XXX.
  3788                 24  AM-J-COMA             PIC XXX.
  3789                 24  AM-A-COMA             PIC XXX.
  3790                 24  FILLER                PIC X(6).
  3791
  3792     12  AM-COMM-CHANGE-STATUS             PIC X.
  3793         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3794
  3795     12  AM-CSR-CODE                       PIC X(4).
  3796
  3797     12  AM-BILLING-STATUS                 PIC X.
  3798         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3799         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3800     12  AM-AUTO-REFUND-SW                 PIC X.
  3801         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3802         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3803     12  AM-GPCD                           PIC 99.
  3804     12  AM-IG                             PIC X.
  3805         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3806         88  AM-HAS-GROUP                     VALUE '2'.
  3807     12  AM-STATUS                         PIC X.
  3808         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3809         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3810         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3811         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3812         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3813         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3814     12  AM-REMIT-TO                       PIC 99.
  3815     12  AM-ID-NO                          PIC X(11).
  3816
  3817     12  AM-CAL-TABLE                      PIC XX.
  3818     12  AM-LF-DEVIATION                   PIC XXX.
  3819     12  AM-AH-DEVIATION                   PIC XXX.
  3820     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3821     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3822     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3823     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3824     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3825     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3826
  3827     12  AM-USER-FIELDS.
  3828         16  AM-FLD-1                      PIC XX.
  3829         16  AM-FLD-2                      PIC XX.
  3830         16  AM-FLD-3                      PIC XX.
  3831         16  AM-FLD-4                      PIC XX.
  3832         16  AM-FLD-5                      PIC XX.
  3833
  3834     12  AM-1ST-PROD-DATE.
  3835         16  AM-1ST-PROD-YR                PIC XX.
  3836         16  AM-1ST-PROD-MO                PIC XX.
  3837         16  AM-1ST-PROD-DA                PIC XX.
  3838     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3839     12  AM-CERTS-PURGED-DATE.
  3840         16  AM-PUR-YR                     PIC XX.
  3841         16  AM-PUR-MO                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  68
* EL677.cbl
  3842         16  AM-PUR-DA                     PIC XX.
  3843     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3844     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3845     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3846     12  AM-INACTIVE-DATE.
  3847         16  AM-INA-MO                     PIC 99.
  3848         16  AM-INA-DA                     PIC 99.
  3849         16  AM-INA-YR                     PIC 99.
  3850     12  AM-AR-HI-CERT-DATE                PIC XX.
  3851
  3852     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3853     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3854
  3855     12  AM-OB-PAYMENT-MODE                PIC X.
  3856         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3857         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3858         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3859         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3860
  3861     12  AM-AH-ONLY-INDICATOR              PIC X.
  3862         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3863         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3864
  3865     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3866
  3867     12  AM-OVER-SHORT.
  3868         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3869         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3870
  3871     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3872     12  AM-DCC-CLP-STATE                  PIC XX.
  3873
  3874     12  AM-RECALC-COMM                    PIC X.
  3875     12  AM-RECALC-REIN                    PIC X.
  3876
  3877     12  AM-REI-TABLE                      PIC XXX.
  3878     12  AM-REI-ET-LF                      PIC X.
  3879     12  AM-REI-ET-AH                      PIC X.
  3880     12  AM-REI-PE-LF                      PIC X.
  3881     12  AM-REI-PE-AH                      PIC X.
  3882     12  AM-REI-PRT-ST                     PIC X.
  3883     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3884     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3885     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3886     12  AM-REI-GROUP-A                    PIC X(6).
  3887     12  AM-REI-MORT                       PIC X(4).
  3888     12  AM-REI-PRT-OW                     PIC X.
  3889     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3890     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3891     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3892     12  AM-REI-GROUP-B                    PIC X(6).
  3893
  3894     12  AM-TRUST-TYPE                     PIC X(2).
  3895
  3896     12  AM-EMPLOYER-STMT-USED             PIC X.
  3897     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3898
  3899     12  AM-STD-AH-TYPE                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  69
* EL677.cbl
  3900     12  AM-EARN-METHODS.
  3901         16  AM-EARN-METHOD-R              PIC X.
  3902             88 AM-REF-RL-R78                 VALUE 'R'.
  3903             88 AM-REF-RL-PR                  VALUE 'P'.
  3904             88 AM-REF-RL-MEAN                VALUE 'M'.
  3905             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3906         16  AM-EARN-METHOD-L              PIC X.
  3907             88 AM-REF-LL-R78                 VALUE 'R'.
  3908             88 AM-REF-LL-PR                  VALUE 'P'.
  3909             88 AM-REF-LL-MEAN                VALUE 'M'.
  3910             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3911         16  AM-EARN-METHOD-A              PIC X.
  3912             88 AM-REF-AH-R78                 VALUE 'R'.
  3913             88 AM-REF-AH-PR                  VALUE 'P'.
  3914             88 AM-REF-AH-MEAN                VALUE 'M'.
  3915             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3916             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3917             88 AM-REF-AH-NET                 VALUE 'N'.
  3918
  3919     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3920     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3921     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3922
  3923     12  AM-RET-Y-N                        PIC X.
  3924     12  AM-RET-P-E                        PIC X.
  3925     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3926     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3927     12  AM-RET-GRP                        PIC X(6).
  3928     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3929         16  AM-POOL-PRIME                 PIC XXX.
  3930         16  AM-POOL-SUB                   PIC XXX.
  3931     12  AM-RETRO-EARNINGS.
  3932         16  AM-RET-EARN-R                 PIC X.
  3933         16  AM-RET-EARN-L                 PIC X.
  3934         16  AM-RET-EARN-A                 PIC X.
  3935     12  AM-RET-ST-TAX-USE                 PIC X.
  3936         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3937         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3938     12  AM-RETRO-BEG-EARNINGS.
  3939         16  AM-RET-BEG-EARN-R             PIC X.
  3940         16  AM-RET-BEG-EARN-L             PIC X.
  3941         16  AM-RET-BEG-EARN-A             PIC X.
  3942     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3943     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3944
  3945     12  AM-USER-SELECT-OPTIONS.
  3946         16  AM-USER-SELECT-1              PIC X(10).
  3947         16  AM-USER-SELECT-2              PIC X(10).
  3948         16  AM-USER-SELECT-3              PIC X(10).
  3949         16  AM-USER-SELECT-4              PIC X(10).
  3950         16  AM-USER-SELECT-5              PIC X(10).
  3951
  3952     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3953
  3954     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3955
  3956     12  AM-RPT045A-SWITCH                 PIC X.
  3957         88  RPT045A-OFF                   VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  70
* EL677.cbl
  3958
  3959     12  AM-INSURANCE-LIMITS.
  3960         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3961         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3962
  3963     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3964         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3965
  3966     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3967         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3968         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3969
  3970     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3971
  3972     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3973     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3974     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3975     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3976     12  AM-DCC-UEF-STATE                  PIC XX.
  3977     12  FILLER                            PIC XXX.
  3978     12  AM-REPORT-CODE-3                  PIC X(10).
  3979*    12  FILLER                            PIC X(22).
  3980
  3981     12  AM-RESERVE-DATE.
  3982         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3983         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3984         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3985
  3986     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3987     12  AM-NOTIFICATION-TYPES.
  3988         16  AM-NOTIF-OF-LETTERS           PIC X.
  3989         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3990         16  AM-NOTIF-OF-REPORTS           PIC X.
  3991         16  AM-NOTIF-OF-STATUS            PIC X.
  3992
  3993     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3994         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3995         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3996         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3997         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3998
  3999     12  AM-BENEFIT-CONTROLS.
  4000         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4001             20  AM-BENEFIT-CODE           PIC XX.
  4002             20  AM-BENEFIT-TYPE           PIC X.
  4003             20  AM-BENEFIT-REVISION       PIC XXX.
  4004             20  AM-BENEFIT-REM-TERM       PIC X.
  4005             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4006             20  FILLER                    PIC XX.
  4007         16  FILLER                        PIC X(80).
  4008
  4009     12  AM-TRANSFER-DATA.
  4010         16  AM-TRANSFERRED-FROM.
  4011             20  AM-TRNFROM-CARRIER        PIC X.
  4012             20  AM-TRNFROM-GROUPING.
  4013                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4014                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4015             20  AM-TRNFROM-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  71
* EL677.cbl
  4016             20  AM-TRNFROM-ACCOUNT.
  4017                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4018                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4019             20  AM-TRNFROM-DTE            PIC XX.
  4020         16  AM-TRANSFERRED-TO.
  4021             20  AM-TRNTO-CARRIER          PIC X.
  4022             20  AM-TRNTO-GROUPING.
  4023                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4024                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4025             20  AM-TRNTO-STATE            PIC XX.
  4026             20  AM-TRNTO-ACCOUNT.
  4027                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4028                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4029             20  AM-TRNTO-DTE              PIC XX.
  4030         16  FILLER                        PIC X(10).
  4031
  4032     12  AM-SAVED-REMIT-TO                 PIC 99.
  4033
  4034     12  AM-COMM-STRUCTURE-SAVED.
  4035         16  AM-DEFN-1-SAVED.
  4036             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4037                 24  AM-AGT-SV             PIC X(10).
  4038                 24  AM-COM-TYP-SV         PIC X.
  4039                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4040                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4041                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4042                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4043                 24  FILLER                PIC X.
  4044                 24  AM-GL-CODES-SV        PIC X.
  4045                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4046                 24  FILLER                PIC X.
  4047         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4048             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4049                 24  FILLER                PIC X(11).
  4050                 24  AM-L-COMA-SV          PIC XXX.
  4051                 24  AM-J-COMA-SV          PIC XXX.
  4052                 24  AM-A-COMA-SV          PIC XXX.
  4053                 24  FILLER                PIC X(6).
  4054
  4055     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4056         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4057            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4058            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4059            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4060
  4061     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4062     12  FILLER                            PIC X(120).
  4063
  4064     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4065         16  AM-CONTROL-NAME               PIC X(30).
  4066         16  AM-EXECUTIVE-ONE.
  4067             20  AM-EXEC1-NAME             PIC X(15).
  4068             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4069                                                          COMP-3.
  4070             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4071                                                          COMP-3.
  4072         16  AM-EXECUTIVE-TWO.
  4073             20  AM-EXEC2-NAME             PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  72
* EL677.cbl
  4074             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4075                                                          COMP-3.
  4076             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4077                                                          COMP-3.
  4078
  4079     12  AM-RETRO-ADDITIONAL-DATA.
  4080         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4081         16  AM-RETRO-PREM-P-E             PIC X.
  4082         16  AM-RETRO-CLMS-P-I             PIC X.
  4083         16  AM-RETRO-RET-BRACKET-LF.
  4084             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4085                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4086                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4087             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4088                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4089                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4090             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4091                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4092                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4093         16  AM-RETRO-RET-BRACKET-AH.
  4094             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4095                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4096                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4097                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4098             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4099                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4100                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4101             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4102                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4103                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4104
  4105     12  AM-COMMENTS.
  4106         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4107
  4108     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4109         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4110         16  AM-FLI-BILLING-CODE           PIC X.
  4111         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4112         16  AM-FLI-UNITED-IDENT           PIC X.
  4113         16  AM-FLI-INTEREST-LOST-DATA.
  4114             20  AM-FLI-BANK-NO            PIC X(5).
  4115             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4116             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4117             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4118         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4119             20  AM-FLI-AGT                PIC X(9).
  4120             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4121             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4122         16  FILLER                        PIC X(102).
  4123
  4124     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4125         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4126             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4127             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4128             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4129             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4130             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4131         16  FILLER                          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  73
* EL677.cbl
  4132******************************************************************
  4133*                                    COPY ERCCOMP.
  4134******************************************************************
  4135*                                                                *
  4136*                                                                *
  4137*                            ERCCOMP                             *
  4138*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4139*                            VMOD=2.019                          *
  4140*                                                                *
  4141*   ONLINE CREDIT SYSTEM                                         *
  4142*                                                                *
  4143*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4144*                                                                *
  4145*   FILE TYPE = VSAM,KSDS                                        *
  4146*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4147*                                                                *
  4148*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4149*       ALTERNATE PATH = NONE                                    *
  4150*                                                                *
  4151*   LOG = NO                                                     *
  4152*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4153*                                                                *
  4154******************************************************************
  4155*                   C H A N G E   L O G
  4156*
  4157* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4158*-----------------------------------------------------------------
  4159*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4160* EFFECTIVE    NUMBER
  4161*-----------------------------------------------------------------
  4162* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4163* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4164* 092205    2005050300006  PEMA  ADD LEASE FEE
  4165* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4166* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4167* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4168* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4169* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4170* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4171******************************************************************
  4172
  4173 01  COMPENSATION-MASTER.
  4174     12  CO-RECORD-ID                          PIC XX.
  4175         88  VALID-CO-ID                          VALUE 'CO'.
  4176
  4177     12  CO-CONTROL-PRIMARY.
  4178         16  CO-COMPANY-CD                     PIC X.
  4179         16  CO-CONTROL.
  4180             20  CO-CTL-1.
  4181                 24  CO-CARR-GROUP.
  4182                     28  CO-CARRIER            PIC X.
  4183                     28  CO-GROUPING.
  4184                         32  CO-GROUP-PREFIX   PIC XXX.
  4185                         32  CO-GROUP-PRIME    PIC XXX.
  4186                 24  CO-RESP-NO.
  4187                     28  CO-RESP-PREFIX        PIC X(4).
  4188                     28  CO-RESP-PRIME         PIC X(6).
  4189             20  CO-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  74
* EL677.cbl
  4190                 24  CO-ACCOUNT.
  4191                     28  CO-ACCT-PREFIX        PIC X(4).
  4192                     28  CO-ACCT-PRIME         PIC X(6).
  4193         16  CO-TYPE                           PIC X.
  4194             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4195             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4196             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4197
  4198     12  CO-MAINT-INFORMATION.
  4199         16  CO-LAST-MAINT-DT                  PIC XX.
  4200         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4201         16  CO-LAST-MAINT-USER                PIC X(4).
  4202     12  FILLER                                PIC XX.
  4203     12  CO-STMT-TYPE                          PIC XXX.
  4204     12  CO-COMP-TYPE                          PIC X.
  4205         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4206     12  CO-STMT-OWNER                         PIC X(4).
  4207     12  CO-BALANCE-CONTROL                    PIC X.
  4208         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4209         88  CO-NO-BALANCE                        VALUE 'N'.
  4210
  4211     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4212         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4213         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4214         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4215
  4216     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4217         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4218         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4219
  4220     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4221     12  CO-GA-DIRECT-DEP                      PIC X.
  4222     12  CO-FUTURE-SPACE                       PIC X.
  4223         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4224
  4225     12  CO-ACCT-NAME                          PIC X(30).
  4226     12  CO-MAIL-NAME                          PIC X(30).
  4227     12  CO-ADDR-1                             PIC X(30).
  4228     12  CO-ADDR-2                             PIC X(30).
  4229     12  CO-ADDR-3.
  4230         16  CO-ADDR-CITY                      PIC X(27).
  4231         16  CO-ADDR-STATE                     PIC XX.
  4232     12  CO-CSO-1099                           PIC X.
  4233     12  CO-ZIP.
  4234         16  CO-ZIP-PRIME.
  4235             20  CO-ZIP-PRI-1ST                PIC X.
  4236                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4237             20  FILLER                        PIC X(4).
  4238         16  CO-ZIP-PLUS4                      PIC X(4).
  4239     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4240         16  CO-CAN-POSTAL-1                   PIC XXX.
  4241         16  CO-CAN-POSTAL-2                   PIC XXX.
  4242         16  FILLER                            PIC XXX.
  4243     12  CO-SOC-SEC                            PIC X(13).
  4244     12  CO-TELEPHONE.
  4245         16  CO-AREA-CODE                      PIC XXX.
  4246         16  CO-PREFIX                         PIC XXX.
  4247         16  CO-PHONE                          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  75
* EL677.cbl
  4248
  4249     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4250
  4251     12  CO-AR-BAL-LEVEL                       PIC X.
  4252         88  CO-AR-REF-LVL                        VALUE '1'.
  4253         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4254         88  CO-AR-BILL-LVL                       VALUE '2'.
  4255         88  CO-AR-AGT-LVL                        VALUE '3'.
  4256         88  CO-AR-FR-LVL                         VALUE '4'.
  4257
  4258     12  CO-AR-NORMAL-PRINT                    PIC X.
  4259         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4260         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4261
  4262     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4263
  4264     12  CO-AR-REPORTING                       PIC X.
  4265         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4266         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4267
  4268     12  CO-AR-PULL-CHECK                      PIC X.
  4269         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4270         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4271
  4272     12  CO-AR-BALANCE-PRINT                   PIC X.
  4273         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4274
  4275     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4276         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4277         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4278         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4279
  4280     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4281
  4282     12  CO-USER-CODE                          PIC X.
  4283     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4284
  4285******************************************************************
  4286*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4287*    THE LAST MONTH END RUN.
  4288******************************************************************
  4289
  4290     12  CO-LAST-ACTIVITY-DATE.
  4291         16  CO-ACT-YEAR                       PIC 99.
  4292         16  CO-ACT-MONTH                      PIC 99.
  4293         16  CO-ACT-DAY                        PIC 99.
  4294
  4295     12  CO-LAST-STMT-DT.
  4296         16  CO-LAST-STMT-YEAR                 PIC 99.
  4297         16  CO-LAST-STMT-MONTH                PIC 99.
  4298         16  CO-LAST-STMT-DAY                  PIC 99.
  4299
  4300     12  CO-MO-END-TOTALS.
  4301         16  CO-MONTHLY-TOTALS.
  4302             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4303             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4304             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4305             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  76
* EL677.cbl
  4306             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4307
  4308         16  CO-AGING-TOTALS.
  4309             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4310             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4311             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4312             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4313
  4314         16  CO-YTD-TOTALS.
  4315             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4316             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4317
  4318         16  CO-OVER-UNDER-TOTALS.
  4319             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4320             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4321
  4322     12  CO-MISCELLANEOUS-TOTALS.
  4323         16  CO-FICA-TOTALS.
  4324             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4325             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4326
  4327         16  CO-CLAIM-TOTALS.
  4328             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4329             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4330
  4331******************************************************************
  4332*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4333*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4334******************************************************************
  4335
  4336     12  CO-CURRENT-TOTALS.
  4337         16  CO-CURRENT-LAST-STMT-DT.
  4338             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4339             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4340             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4341
  4342         16  CO-CURRENT-MONTHLY-TOTALS.
  4343             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4344             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4345             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4346             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4347             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4348
  4349         16  CO-CURRENT-AGING-TOTALS.
  4350             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4351             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4352             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4353             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4354
  4355         16  CO-CURRENT-YTD-TOTALS.
  4356             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4357             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4358
  4359     12  CO-PAID-COMM-TOTALS.
  4360         16  CO-YTD-PAID-COMMS.
  4361             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4362             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4363
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  77
* EL677.cbl
  4364     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4365         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4366         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4367
  4368     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4369         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4370         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4371         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4372         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4373         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4374         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4375         88  CO-FINAL-LETTER                  VALUE 'F'.
  4376         88  CO-RECONCILING                   VALUE 'R'.
  4377         88  CO-PHONE-CALL                    VALUE 'P'.
  4378         88  CO-LEGAL                         VALUE 'L'.
  4379         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4380         88  CO-WRITE-OFF                     VALUE 'W'.
  4381         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4382
  4383     12  CO-CSR-CODE                       PIC X(4).
  4384
  4385     12  CO-GA-STATUS-INFO.
  4386         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4387         16  CO-GA-TERMINATION-DT          PIC XX.
  4388         16  CO-GA-STATUS-CODE             PIC X.
  4389             88  CO-GA-ACTIVE                 VALUE 'A'.
  4390             88  CO-GA-INACTIVE               VALUE 'I'.
  4391             88  CO-GA-PENDING                VALUE 'P'.
  4392         16  CO-GA-COMMENTS.
  4393             20  CO-GA-COMMENT-1           PIC X(40).
  4394             20  CO-GA-COMMENT-2           PIC X(40).
  4395             20  CO-GA-COMMENT-3           PIC X(40).
  4396             20  CO-GA-COMMENT-4           PIC X(40).
  4397
  4398     12  CO-RPTCD2                         PIC X(10).
  4399     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4400         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4401         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4402
  4403     12  CO-TYPE-AGENT                     PIC X(01).
  4404         88  CO-CORPORATION                   VALUE 'C'.
  4405         88  CO-PARTNERSHIP                   VALUE 'P'.
  4406         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4407         88  CO-TRUST                         VALUE 'T'.
  4408         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4409
  4410     12  CO-FAXNO.
  4411         16  CO-FAX-AREA-CODE                  PIC XXX.
  4412         16  CO-FAX-PREFIX                     PIC XXX.
  4413         16  CO-FAX-PHONE                      PIC X(4).
  4414
  4415     12  CO-BANK-INFORMATION.
  4416         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4417         16  CO-BANK-TRANSIT-NON REDEFINES
  4418             CO-BANK-TRANSIT-NO                PIC 9(8).
  4419
  4420         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4421     12  CO-MISC-DEDUCT-INFO REDEFINES
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  78
* EL677.cbl
  4422                  CO-BANK-INFORMATION.
  4423         16  CO-MD-GL-ACCT                     PIC X(10).
  4424         16  CO-MD-DIV                         PIC XX.
  4425         16  CO-MD-CENTER                      PIC X(4).
  4426         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4427         16  CO-CREATE-AP-CHECK                PIC X.
  4428         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4429         16  FILLER                            PIC XXX.
  4430     12  CO-ACH-STATUS                         PIC X.
  4431         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4432         88  CO-ACH-PENDING                        VALUE 'P'.
  4433
  4434     12  CO-BILL-SW                            PIC X.
  4435     12  CO-CONTROL-NAME                       PIC X(30).
  4436     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4437     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4438     12  CO-CLP-STATE                          PIC XX.
  4439     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4440     12  CO-SPP-REFUND-EDIT                    PIC X.
  4441
  4442******************************************************************
  4443*                                    COPY ELCCERT.
  4444******************************************************************
  4445*                                                                *
  4446*                            ELCCERT.                            *
  4447*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4448*                            VMOD=2.013                          *
  4449*                                                                *
  4450*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4451*                                                                *
  4452*   FILE TYPE = VSAM,KSDS                                        *
  4453*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4454*                                                                *
  4455*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4456*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4457*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4458*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4459*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4460*                                                                *
  4461*   LOG = YES                                                    *
  4462*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4463******************************************************************
  4464*                   C H A N G E   L O G
  4465*
  4466* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4467*-----------------------------------------------------------------
  4468*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4469* EFFECTIVE    NUMBER
  4470*-----------------------------------------------------------------
  4471* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4472* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4473* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4474* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4475* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4476* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4477* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4478* 032612  CR2011110200001  PEMA  AHL CHANGES
  4479******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  79
* EL677.cbl
  4480
  4481 01  CERTIFICATE-MASTER.
  4482     12  CM-RECORD-ID                      PIC XX.
  4483         88  VALID-CM-ID                      VALUE 'CM'.
  4484
  4485     12  CM-CONTROL-PRIMARY.
  4486         16  CM-COMPANY-CD                 PIC X.
  4487         16  CM-CARRIER                    PIC X.
  4488         16  CM-GROUPING.
  4489             20  CM-GROUPING-PREFIX        PIC X(3).
  4490             20  CM-GROUPING-PRIME         PIC X(3).
  4491         16  CM-STATE                      PIC XX.
  4492         16  CM-ACCOUNT.
  4493             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4494             20  CM-ACCOUNT-PRIME          PIC X(6).
  4495         16  CM-CERT-EFF-DT                PIC XX.
  4496         16  CM-CERT-NO.
  4497             20  CM-CERT-PRIME             PIC X(10).
  4498             20  CM-CERT-SFX               PIC X.
  4499
  4500     12  CM-CONTROL-BY-NAME.
  4501         16  CM-COMPANY-CD-A1              PIC X.
  4502         16  CM-INSURED-LAST-NAME          PIC X(15).
  4503         16  CM-INSURED-INITIALS.
  4504             20  CM-INSURED-INITIAL1       PIC X.
  4505             20  CM-INSURED-INITIAL2       PIC X.
  4506
  4507     12  CM-CONTROL-BY-SSN.
  4508         16  CM-COMPANY-CD-A2              PIC X.
  4509         16  CM-SOC-SEC-NO.
  4510             20  CM-SSN-STATE              PIC XX.
  4511             20  CM-SSN-ACCOUNT            PIC X(6).
  4512             20  CM-SSN-LN3.
  4513                 25  CM-INSURED-INITIALS-A2.
  4514                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4515                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4516                 25 CM-PART-LAST-NAME-A2         PIC X.
  4517
  4518     12  CM-CONTROL-BY-CERT-NO.
  4519         16  CM-COMPANY-CD-A4              PIC X.
  4520         16  CM-CERT-NO-A4                 PIC X(11).
  4521
  4522     12  CM-CONTROL-BY-MEMB.
  4523         16  CM-COMPANY-CD-A5              PIC X.
  4524         16  CM-MEMBER-NO.
  4525             20  CM-MEMB-STATE             PIC XX.
  4526             20  CM-MEMB-ACCOUNT           PIC X(6).
  4527             20  CM-MEMB-LN4.
  4528                 25  CM-INSURED-INITIALS-A5.
  4529                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4530                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4531                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4532
  4533     12  CM-INSURED-PROFILE-DATA.
  4534         16  CM-INSURED-FIRST-NAME.
  4535             20  CM-INSURED-1ST-INIT       PIC X.
  4536             20  FILLER                    PIC X(9).
  4537         16  CM-INSURED-ISSUE-AGE          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  80
* EL677.cbl
  4538         16  CM-INSURED-SEX                PIC X.
  4539             88  CM-SEX-MALE                  VALUE 'M'.
  4540             88  CM-SEX-FEMAL                 VALUE 'F'.
  4541         16  CM-INSURED-JOINT-AGE          PIC 99.
  4542         16  CM-JOINT-INSURED-NAME.
  4543             20  CM-JT-LAST-NAME           PIC X(15).
  4544             20  CM-JT-FIRST-NAME.
  4545                 24  CM-JT-1ST-INIT        PIC X.
  4546                 24  FILLER                PIC X(9).
  4547             20  CM-JT-INITIAL             PIC X.
  4548
  4549     12  CM-LIFE-DATA.
  4550         16  CM-LF-BENEFIT-CD              PIC XX.
  4551         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4552         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4553         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4554         16  CM-LF-DEV-CODE                PIC XXX.
  4555         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4556         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4557         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4558         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4559         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4560         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4561         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4562         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4563         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4564         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4565         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4566         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4567         16  FILLER                        PIC XX.
  4568
  4569     12  CM-AH-DATA.
  4570         16  CM-AH-BENEFIT-CD              PIC XX.
  4571         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4572         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4573         16  CM-AH-DEV-CODE                PIC XXX.
  4574         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4575         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4576         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4577         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4578         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4579         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4580         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4581         16  CM-AH-PAID-THRU-DT            PIC XX.
  4582             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4583         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4584         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4585         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4586         16  FILLER                        PIC X.
  4587
  4588     12  CM-LOAN-INFORMATION.
  4589         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4590         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4591                                           PIC S9(5)V99  COMP-3.
  4592         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4593         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4594         16  CM-PAY-FREQUENCY              PIC S99.
  4595         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  81
* EL677.cbl
  4596         16  CM-RATE-CLASS                 PIC XX.
  4597         16  CM-BENEFICIARY                PIC X(25).
  4598         16  CM-POLICY-FORM-NO             PIC X(12).
  4599         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4600         16  CM-LAST-ADD-ON-DT             PIC XX.
  4601         16  CM-DEDUCTIBLE-AMOUNTS.
  4602             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4603             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4604         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4605             20  CM-RESIDENT-STATE         PIC XX.
  4606             20  CM-RATE-CODE              PIC X(4).
  4607             20  FILLER                    PIC XX.
  4608         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4609             20  CM-LOAN-OFFICER           PIC X(5).
  4610             20  FILLER                    PIC XXX.
  4611         16  CM-CSR-CODE                   PIC XXX.
  4612         16  CM-UNDERWRITING-CODE          PIC X.
  4613             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4614         16  CM-POST-CARD-IND              PIC X.
  4615         16  CM-NH-INTERFACE-SW            PIC X.
  4616         16  CM-PREMIUM-TYPE               PIC X.
  4617             88  CM-SING-PRM                  VALUE '1'.
  4618             88  CM-O-B-COVERAGE              VALUE '2'.
  4619             88  CM-OPEN-END                  VALUE '3'.
  4620         16  CM-IND-GRP-TYPE               PIC X.
  4621             88  CM-INDIVIDUAL                VALUE 'I'.
  4622             88  CM-GROUP                     VALUE 'G'.
  4623         16  CM-SKIP-CODE                  PIC X.
  4624             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4625             88  SKIP-JULY                    VALUE '1'.
  4626             88  SKIP-AUGUST                  VALUE '2'.
  4627             88  SKIP-SEPTEMBER               VALUE '3'.
  4628             88  SKIP-JULY-AUG                VALUE '4'.
  4629             88  SKIP-AUG-SEPT                VALUE '5'.
  4630             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4631             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4632             88  SKIP-JUNE                    VALUE '8'.
  4633             88  SKIP-JUNE-JULY               VALUE '9'.
  4634             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4635             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4636         16  CM-PAYMENT-MODE               PIC X.
  4637             88  PAY-MONTHLY                  VALUE SPACE.
  4638             88  PAY-WEEKLY                   VALUE '1'.
  4639             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4640             88  PAY-BI-WEEKLY                VALUE '3'.
  4641             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4642         16  CM-LOAN-NUMBER                PIC X(8).
  4643         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4644         16  CM-OLD-LOF                    PIC XXX.
  4645*        16  CM-LOAN-OFFICER               PIC XXX.
  4646         16  CM-REIN-TABLE                 PIC XXX.
  4647         16  CM-SPECIAL-REIN-CODE          PIC X.
  4648         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4649         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4650         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4651
  4652     12  CM-STATUS-DATA.
  4653         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  82
* EL677.cbl
  4654         16  CM-ENTRY-DT                   PIC XX.
  4655
  4656         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4657         16  CM-LF-CANCEL-DT               PIC XX.
  4658         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4659
  4660         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4661         16  CM-LF-DEATH-DT                PIC XX.
  4662         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4663
  4664         16  CM-LF-CURRENT-STATUS          PIC X.
  4665             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4666                                                'M' '4' '5' '9'.
  4667             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4668             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4669             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4670             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4671             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4672             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4673             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4674             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4675             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4676             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4677             88  CM-LF-DECLINED               VALUE 'D'.
  4678             88  CM-LF-VOIDED                 VALUE 'V'.
  4679
  4680         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4681         16  CM-AH-CANCEL-DT               PIC XX.
  4682         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4683
  4684         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4685         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4686         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4687
  4688         16  CM-AH-CURRENT-STATUS          PIC X.
  4689             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4690                                                'M' '4' '5' '9'.
  4691             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4692             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4693             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4694             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4695             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4696             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4697             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4698             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4699             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4700             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4701             88  CM-AH-DECLINED               VALUE 'D'.
  4702             88  CM-AH-VOIDED                 VALUE 'V'.
  4703
  4704         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4705             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4706             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4707             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4708         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4709
  4710         16  CM-ENTRY-BATCH                PIC X(6).
  4711         16  CM-LF-EXIT-BATCH              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  83
* EL677.cbl
  4712         16  CM-AH-EXIT-BATCH              PIC X(6).
  4713         16  CM-LAST-MONTH-END             PIC XX.
  4714
  4715     12  CM-NOTE-SW                        PIC X.
  4716         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4717         88  CERT-NOTES-PRESENT               VALUE '1'.
  4718         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4719         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4720         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4721         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4722         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4723         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4724     12  CM-COMP-EXCP-SW                   PIC X.
  4725         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4726         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4727     12  CM-INSURED-ADDRESS-SW             PIC X.
  4728         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4729         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4730
  4731*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4732     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4733     12  FILLER                            PIC X.
  4734
  4735*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4736     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4737     12  FILLER                            PIC X.
  4738*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4739     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4740
  4741     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4742         88  CERT-ADDED-BATCH                 VALUE ' '.
  4743         88  CERT-ADDED-ONLINE                VALUE '1'.
  4744         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4745         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4746         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4747     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4748         88  CERT-AS-LOADED                   VALUE ' '.
  4749         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4750         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4751         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4752         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4753         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4754         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4755         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4756
  4757     12  CM-ACCOUNT-COMM-PCTS.
  4758         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4759         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4760
  4761     12  CM-USER-FIELD                     PIC X.
  4762     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4763     12  CM-CLP-STATE                      PIC XX.
  4764     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4765     12  CM-USER-RESERVED                  PIC XXX.
  4766     12  FILLER REDEFINES CM-USER-RESERVED.
  4767         16  CM-AH-CLASS-CD                PIC XX.
  4768         16  F                             PIC X.
  4769******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  84
* EL677.cbl
  4770*                                    COPY ERCPNDB.
  4771******************************************************************
  4772*                                                                *
  4773*                                                                *
  4774*                            ERCPNDB.                            *
  4775*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4776*                            VMOD=2.025                          *
  4777*                                                                *
  4778*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4779*                                                                *
  4780******************************************************************
  4781*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4782*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4783******************************************************************
  4784*                                                                *
  4785*                                                                *
  4786*   FILE TYPE = VSAM,KSDS                                        *
  4787*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4788*                                                                *
  4789*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4790*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4791*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4792*                                                 RKP=13,LEN=36  *
  4793*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4794*                                      AND CHG-SEQ.)             *
  4795*                                                RKP=49,LEN=11   *
  4796*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4797*                                      AND CHG-SEQ.)             *
  4798*                                                RKP=60,LEN=15   *
  4799*                                                                *
  4800*   LOG = NO                                                     *
  4801*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4802******************************************************************
  4803******************************************************************
  4804*                   C H A N G E   L O G
  4805*
  4806* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4807*-----------------------------------------------------------------
  4808*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4809* EFFECTIVE    NUMBER
  4810*-----------------------------------------------------------------
  4811* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4812* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4813* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4814* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4815* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4816* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4817* 032306                   PEMA  ADD BOW LOAN NUMBER
  4818* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4819* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4820* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4821* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4822* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4823* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4824* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4825* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4826******************************************************************
  4827
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  85
* EL677.cbl
  4828 01  PENDING-BUSINESS.
  4829     12  PB-RECORD-ID                     PIC XX.
  4830         88  VALID-PB-ID                        VALUE 'PB'.
  4831
  4832     12  PB-CONTROL-PRIMARY.
  4833         16  PB-COMPANY-CD                PIC X.
  4834         16  PB-ENTRY-BATCH               PIC X(6).
  4835         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4836         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4837
  4838     12  PB-CONTROL-BY-ACCOUNT.
  4839         16  PB-COMPANY-CD-A1             PIC X.
  4840         16  PB-CARRIER                   PIC X.
  4841         16  PB-GROUPING.
  4842             20  PB-GROUPING-PREFIX       PIC XXX.
  4843             20  PB-GROUPING-PRIME        PIC XXX.
  4844         16  PB-STATE                     PIC XX.
  4845         16  PB-ACCOUNT.
  4846             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4847             20  PB-ACCOUNT-PRIME         PIC X(6).
  4848         16  PB-CERT-EFF-DT               PIC XX.
  4849         16  PB-CERT-NO.
  4850             20  PB-CERT-PRIME            PIC X(10).
  4851             20  PB-CERT-SFX              PIC X.
  4852         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4853
  4854         16  PB-RECORD-TYPE               PIC X.
  4855             88  PB-MAILING-DATA                VALUE '0'.
  4856             88  PB-ISSUE                       VALUE '1'.
  4857             88  PB-CANCELLATION                VALUE '2'.
  4858             88  PB-BATCH-TRAILER               VALUE '9'.
  4859
  4860     12  PB-CONTROL-BY-ORIG-BATCH.
  4861         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4862         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4863         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4864         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4865
  4866     12  PB-CONTROL-BY-CSR.
  4867         16  PB-CSR-COMPANY-CD            PIC X.
  4868         16  PB-CSR-ID                    PIC X(4).
  4869         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4870         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4871         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4872******************************************************************
  4873*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4874******************************************************************
  4875
  4876     12  PB-LAST-MAINT-DT                 PIC XX.
  4877     12  PB-LAST-MAINT-BY                 PIC X(4).
  4878     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4879
  4880     12  PB-RECORD-BODY                   PIC X(375).
  4881
  4882     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4883         16  PB-CERT-ORIGIN               PIC X.
  4884             88  CLASIC-CREATED-CERT         VALUE '1'.
  4885         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  86
* EL677.cbl
  4886             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4887             20  PB-I-INSURED-FIRST-NAME.
  4888                 24  PB-I-INSURED-1ST-INIT PIC X.
  4889                 24  FILLER                PIC X(9).
  4890             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4891         16  PB-I-AGE                     PIC S99   COMP-3.
  4892         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4893         16  PB-I-BIRTHDAY                PIC XX.
  4894         16  PB-I-INSURED-SEX             PIC X.
  4895             88  PB-SEX-MALE     VALUE 'M'.
  4896             88  PB-SEX-FEMALE   VALUE 'F'.
  4897
  4898         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4899         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4900         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4901         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4902         16  PB-I-SKIP-CODE               PIC X.
  4903             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4904             88  PB-SKIP-JULY              VALUE '1'.
  4905             88  PB-SKIP-AUGUST            VALUE '2'.
  4906             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4907             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4908             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4909             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4910             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4911             88  PB-SKIP-JUNE              VALUE '8'.
  4912             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4913             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4914             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4915         16  PB-I-TERM-TYPE               PIC X.
  4916             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4917             88  PB-PAID-WEEKLY            VALUE 'W'.
  4918             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4919             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4920             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4921         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4922         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4923         16  PB-I-DATA-ENTRY-SW           PIC X.
  4924             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4925             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4926             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4927             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4928         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4929         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4930*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4931         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4932         16  FILLER                       PIC X.
  4933
  4934         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4935             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4936             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4937                                                   '90' THRU '99'.
  4938         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4939                                          PIC XX.
  4940         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4941         16  PB-I-AMOUNT-FINANCED REDEFINES
  4942                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4943         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  87
* EL677.cbl
  4944         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4945                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4946         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4947         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4948         16  PB-I-CLP-AMOUNT REDEFINES
  4949                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4950         16  PB-I-LF-CALC-FLAG            PIC X.
  4951             88 PB-COMP-LF-PREM               VALUE '?'.
  4952         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4953         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4954         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4955         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4956         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4957         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4958         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4959         16  PB-I-LF-ABBR                 PIC XXX.
  4960         16  PB-I-LF-INPUT-CD             PIC XX.
  4961
  4962         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4963             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4964             88  PB-INVALID-AH               VALUE '  ' '00'
  4965                                                   '90' THRU '99'.
  4966         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4967         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4968         16  PB-I-AH-CALC-FLAG            PIC X.
  4969             88 PB-COMP-AH-PREM                  VALUE '?'.
  4970         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4971         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4972         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4973         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4974         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4975         16  PB-I-AH-ABBR                 PIC XXX.
  4976         16  PB-I-AH-INPUT-CD             PIC XXX.
  4977
  4978         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4979         16  PB-I-REIN-TABLE              PIC XXX.
  4980         16  PB-I-BUSINESS-TYPE           PIC 99.
  4981         16  PB-I-INDV-GRP-CD             PIC X.
  4982         16  PB-I-MORT-CODE.
  4983             20  PB-I-TABLE               PIC X.
  4984             20  PB-I-INTEREST            PIC XX.
  4985             20  PB-I-MORT-TYP            PIC X.
  4986         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4987         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4988         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4989         16  PB-I-INDV-GRP-OVRD           PIC X.
  4990         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4991         16  PB-I-SIG-SW                  PIC X.
  4992             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4993         16  PB-I-RATE-CLASS              PIC XX.
  4994         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4995         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4996         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4997         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4998         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4999         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5000         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5001         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  88
* EL677.cbl
  5002         16  PB-I-OB-FLAG                 PIC X.
  5003             88  PB-I-OB                      VALUE 'B'.
  5004             88  PB-I-SUMMARY                 VALUE 'Z'.
  5005         16  PB-I-ENTRY-STATUS            PIC X.
  5006             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5007                                              'M' '5' '9' '2'.
  5008             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5009             88  PB-I-POLICY-PENDING          VALUE '2'.
  5010             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5011             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5012             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5013             88  PB-I-REIN-ONLY               VALUE '9'.
  5014             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5015             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5016             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5017             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5018         16  PB-I-INT-CODE                PIC X.
  5019             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5020             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5021         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5022         16  PB-I-SOC-SEC-NO              PIC X(11).
  5023         16  PB-I-MEMBER-NO               PIC X(12).
  5024         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5025*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5026         16  PB-I-OLD-LOF                 PIC XXX.
  5027         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5028         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5029         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5030         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5031         16  PB-I-LIFE-INDICATOR          PIC X.
  5032             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5033         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5034         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5035                                          PIC S9(5)V99    COMP-3.
  5036         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5037             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5038             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5039         16  PB-I-1ST-PMT-DT              PIC XX.
  5040         16  PB-I-JOINT-INSURED.
  5041             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5042             20 PB-I-JOINT-FIRST-NAME.
  5043                24  PB-I-JOINT-FIRST-INIT PIC X.
  5044                24  FILLER                PIC X(9).
  5045             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5046*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5047         16  PB-I-BENEFICIARY-NAME.
  5048             20  PB-I-BANK-NUMBER         PIC X(10).
  5049             20  FILLER                   PIC X(15).
  5050         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5051         16  PB-I-REFERENCE               PIC X(12).
  5052         16  FILLER REDEFINES PB-I-REFERENCE.
  5053             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5054             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5055             20  PB-I-CLP-STATE           PIC XX.
  5056         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5057             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5058             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5059             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  89
* EL677.cbl
  5060         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5061         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5062         16  PB-I-RESIDENT-STATE          PIC XX.
  5063         16  PB-I-RATE-CODE               PIC X(4).
  5064         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5065         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5066         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5067         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5068         16  PB-I-BANK-NOCHRGB            PIC 99.
  5069         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5070         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5071
  5072     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5073         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5074             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5075         16  PB-C-CANCEL-ORIGIN           PIC X.
  5076             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5077         16  PB-C-LF-CANCEL-DT            PIC XX.
  5078         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5079         16  PB-C-LF-CALC-REQ             PIC X.
  5080             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5081         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5082         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5083         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5084             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5085         16  PB-C-AH-CANCEL-DT            PIC XX.
  5086         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5087         16  PB-C-AH-CALC-REQ             PIC X.
  5088             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5089         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5090         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5091         16  PB-C-LAST-NAME               PIC X(15).
  5092         16  PB-C-REFUND-SW               PIC X.
  5093             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5094             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5095         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5096         16  PB-C-PAYEE-CODE              PIC X(6).
  5097         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5098         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5099         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5100         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5101         16  PB-C-REFERENCE               PIC X(12).
  5102         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5103         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5104         16  PB-C-POST-CARD-IND           PIC X.
  5105         16  PB-C-CANCEL-REASON           PIC X.
  5106         16  PB-C-REF-INTERFACE-SW        PIC X.
  5107         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5108         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5109         16  FILLER                       PIC X(01).
  5110*        16  FILLER                       PIC X(18).
  5111         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5112*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5113         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  5114         16  PB-CANCELED-CERT-DATA.
  5115             20  PB-CI-INSURED-NAME.
  5116                 24  PB-CI-LAST-NAME      PIC X(15).
  5117                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  90
* EL677.cbl
  5118             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5119             20  PB-CI-INSURED-SEX        PIC X.
  5120             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5121             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5122             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5123             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5124             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5125             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5126             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5127             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5128             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5129             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5130             20  PB-CI-RATE-CLASS         PIC XX.
  5131             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5132             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5133             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5134             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5135             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5136             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5137             20  PB-CI-LF-ABBR            PIC X(3).
  5138             20  PB-CI-AH-ABBR            PIC X(3).
  5139             20  PB-CI-OB-FLAG            PIC X.
  5140                 88  PB-CI-OB                VALUE 'B'.
  5141             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5142                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5143                                           'M' '4' '5' '9' '2'.
  5144                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5145                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5146                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5147                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5148                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5149                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5150                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5151                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5152                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5153                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5154                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5155                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5156             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5157                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5158                                           'M' '4' '5' '9' '2'.
  5159                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5160                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5161                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5162                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5163                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5164                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5165                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5166                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5167                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5168                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5169                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5170                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5171             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5172             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5173             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5174             20  PB-CI-MEMBER-NO          PIC X(12).
  5175             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  91
* EL677.cbl
  5176                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5177                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5178             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5179             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5180             20  PB-CI-COMP-EXCP-SW       PIC X.
  5181                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5182                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5183             20  PB-CI-ENTRY-STATUS       PIC X.
  5184             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5185             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5186             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5187             20  PB-CI-DEATH-DT           PIC XX.
  5188             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5189             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5190             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5191             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5192             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5193             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5194             20  PB-CI-ENTRY-DT              PIC XX.
  5195             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5196             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5197             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5198             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5199             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5200             20  PB-CI-OLD-LOF               PIC XXX.
  5201*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5202             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5203             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5204             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5205             20  PB-CI-INDV-GRP-CD           PIC X.
  5206             20  PB-CI-BENEFICIARY-NAME.
  5207                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5208                 24  FILLER                  PIC X(15).
  5209             20  PB-CI-NOTE-SW               PIC X.
  5210             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5211             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5212             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5213             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5214             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5215             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5216             20  PB-CI-FIRST-NAME            PIC X(10).
  5217             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5218
  5219         16  FILLER                       PIC X(13).
  5220*032306  16  FILLER                       PIC X(27).
  5221*        16  FILLER                       PIC X(46).
  5222
  5223     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5224         16  FILLER                       PIC X(10).
  5225         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5226         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5227         16  PB-M-INSURED-MID-INIT        PIC X.
  5228         16  PB-M-INSURED-AGE             PIC 99.
  5229         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5230         16  PB-M-INSURED-SEX             PIC X.
  5231         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5232         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5233         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  92
* EL677.cbl
  5234         16  PB-M-INSURED-CITY-STATE.
  5235             20  PB-M-INSURED-CITY        PIC X(28).
  5236             20  PB-M-INSURED-STATE       PIC XX.
  5237         16  PB-M-INSURED-ZIP-CODE.
  5238             20  PB-M-INSURED-ZIP-PRIME.
  5239                 24  PB-M-INSURED-ZIP-1   PIC X.
  5240                     88  PB-M-CANADIAN-POST-CODE
  5241                                             VALUE 'A' THRU 'Z'.
  5242                 24  FILLER               PIC X(4).
  5243             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5244         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5245                                        PB-M-INSURED-ZIP-CODE.
  5246             20  PM-M-INS-CAN-POST1       PIC XXX.
  5247             20  PM-M-INS-CAN-POST2       PIC XXX.
  5248             20  FILLER                   PIC XXX.
  5249         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5250         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5251         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5252         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5253         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5254         16  PB-M-CRED-BENE-CITYST.
  5255             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5256             20  PB-M-CRED-BENE-STATE     PIC XX.
  5257         16  FILLER                       PIC X(92).
  5258
  5259     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5260         16  FILLER                       PIC X(10).
  5261         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5262         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5263         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5264         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5265         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5266         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5267         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5268         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5269         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5270         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5271         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5272         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5273         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5274         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5275         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5276         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5277         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5278         16  PB-ACCOUNT-NAME              PIC X(30).
  5279         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5280         16  PB-REFERENCE                 PIC X(12).
  5281         16  PB-B-RECEIVED-DT             PIC XX.
  5282         16  FILLER                       PIC X(234).
  5283
  5284     12  PB-RECORD-STATUS.
  5285         16  PB-CREDIT-SELECT-DT          PIC XX.
  5286         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5287         16  PB-BILLED-DT                 PIC XX.
  5288         16  PB-BILLING-STATUS            PIC X.
  5289             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5290             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5291             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  93
* EL677.cbl
  5292         16  PB-RECORD-BILL               PIC X.
  5293             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5294             88  PB-RECORD-RETURNED           VALUE 'R'.
  5295             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5296             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5297             88  PB-OVERRIDE-AH               VALUE 'A'.
  5298             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5299         16  PB-BATCH-ENTRY               PIC X.
  5300             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5301             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5302             88  PB-REISSUED-CERT             VALUE 'E'.
  5303             88  PB-MONTHLY-CERT              VALUE 'M'.
  5304             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5305             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5306             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5307         16  PB-FORCE-CODE                PIC X.
  5308             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5309             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5310             88  PB-CANCEL-FORCE              VALUE '8'.
  5311             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5312             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5313             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5314             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5315             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5316             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5317             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5318         16  PB-FATAL-FLAG                PIC X.
  5319             88  PB-FATAL-ERRORS              VALUE 'X'.
  5320         16  PB-FORCE-ER-CD               PIC X.
  5321             88  PB-FORCE-ERRORS              VALUE 'F'.
  5322             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5323         16  PB-WARN-ER-CD                PIC X.
  5324             88  PB-WARNING-ERRORS            VALUE 'W'.
  5325         16  FILLER                       PIC X.
  5326         16  PB-OUT-BAL-CD                PIC X.
  5327             88  PB-OUT-OF-BAL                VALUE 'O'.
  5328         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5329         16  PB-AH-OVERRIDE-L1            PIC X.
  5330         16  PB-INPUT-DT                  PIC XX.
  5331         16  PB-INPUT-BY                  PIC X(4).
  5332         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5333         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5334         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5335         16  PB-LF-EARNING-METHOD         PIC X.
  5336         16  PB-AH-EARNING-METHOD         PIC X.
  5337         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5338         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5339         16  PB-REIN-CD                   PIC XXX.
  5340         16  PB-LF-REFUND-TYPE            PIC X.
  5341         16  PB-AH-REFUND-TYPE            PIC X.
  5342         16  PB-ACCT-EFF-DT               PIC XX.
  5343         16  PB-ACCT-EXP-DT               PIC XX.
  5344         16  PB-COMPANY-ID                PIC X(3).
  5345         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5346         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5347         16  PB-SV-CARRIER                PIC X.
  5348         16  PB-SV-GROUPING               PIC X(6).
  5349         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  94
* EL677.cbl
  5350         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5351         16  PB-GA-BILLING-INFO.
  5352             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5353                                          PIC XX.
  5354         16  PB-SV-REMIT-TO  REDEFINES
  5355             PB-GA-BILLING-INFO           PIC X(10).
  5356         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5357         16  PB-I-LOAN-OFFICER            PIC X(5).
  5358         16  PB-I-VIN                     PIC X(17).
  5359
  5360         16  FILLER                       PIC X(04).
  5361         16  IMNET-BYPASS-SW              PIC X.
  5362
  5363******************************************************************
  5364*                COMMON EDIT ERRORS                              *
  5365******************************************************************
  5366
  5367     12  PB-COMMON-ERRORS.
  5368         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5369                                           PIC S9(4)     COMP.
  5370
  5371******************************************************************
  5372*                                    COPY ERCPNDM.
  5373******************************************************************
  5374*                                                                *
  5375*                                                                *
  5376*                            ERCPNDM                             *
  5377*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5378*                            VMOD=2.003                          *
  5379*                                                                *
  5380*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5381*                                                                *
  5382*   FILE TYPE = VSAM,KSDS                                        *
  5383*   RECORD SIZE = 374   RECFORM = FIX                            *
  5384*                                                                *
  5385*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5386*   ALTERNATE PATH    = NOT USED                                 *
  5387*                                                                *
  5388*   LOG = YES                                                    *
  5389*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5390******************************************************************
  5391*                   C H A N G E   L O G
  5392*
  5393* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5394*-----------------------------------------------------------------
  5395*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5396* EFFECTIVE    NUMBER
  5397*-----------------------------------------------------------------
  5398* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5399* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5400* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5401******************************************************************
  5402
  5403 01  PENDING-MAILING-DATA.
  5404     12  PM-RECORD-ID                      PIC XX.
  5405         88  VALID-MA-ID                       VALUE 'PM'.
  5406
  5407     12  PM-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  95
* EL677.cbl
  5408         16  PM-COMPANY-CD                 PIC X.
  5409         16  PM-ENTRY-BATCH                PIC X(6).
  5410         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5411         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5412
  5413     12  FILLER                            PIC X(14).
  5414
  5415     12  PM-ACCESS-CONTROL.
  5416         16  PM-SOURCE-SYSTEM              PIC XX.
  5417             88  PM-FROM-CREDIT                VALUE 'CR'.
  5418             88  PM-FROM-VSI                   VALUE 'VS'.
  5419             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5420             88  PM-FROM-OTHER                 VALUE 'OT'.
  5421         16  PM-RECORD-ADD-DT              PIC XX.
  5422         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5423         16  PM-LAST-MAINT-DT              PIC XX.
  5424         16  PM-LAST-MAINT-BY              PIC XXXX.
  5425         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5426
  5427     12  PM-PROFILE-INFO.
  5428         16  PM-QUALIFY-CODE-1             PIC XX.
  5429         16  PM-QUALIFY-CODE-2             PIC XX.
  5430         16  PM-QUALIFY-CODE-3             PIC XX.
  5431         16  PM-QUALIFY-CODE-4             PIC XX.
  5432         16  PM-QUALIFY-CODE-5             PIC XX.
  5433
  5434         16  PM-INSURED-LAST-NAME          PIC X(15).
  5435         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5436         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5437         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5438         16  PM-INSURED-BIRTH-DT           PIC XX.
  5439         16  PM-INSURED-SEX                PIC X.
  5440             88  PM-SEX-MALE                   VALUE 'M'.
  5441             88  PM-SEX-FEMALE                 VALUE 'F'.
  5442         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5443
  5444         16  PM-ADDRESS-CORRECTED          PIC X.
  5445         16  PM-JOINT-BIRTH-DT             PIC XX.
  5446*        16  FILLER                        PIC X(12).
  5447
  5448         16  PM-ADDRESS-LINE-1             PIC X(30).
  5449         16  PM-ADDRESS-LINE-2             PIC X(30).
  5450         16  PM-CITY-STATE.
  5451             20  PM-CITY                   PIC X(28).
  5452             20  PM-STATE                  PIC XX.
  5453         16  PM-ZIP.
  5454             20  PM-ZIP-CODE.
  5455                 24  PM-ZIP-1              PIC X.
  5456                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5457                 24  FILLER                PIC X(4).
  5458             20  PM-ZIP-PLUS4              PIC X(4).
  5459         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5460             20  PM-CAN-POST1              PIC XXX.
  5461             20  PM-CAN-POST2              PIC XXX.
  5462             20  FILLER                    PIC XXX.
  5463
  5464         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5465
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  96
* EL677.cbl
  5466         16  FILLER                        PIC X(03).
  5467
  5468     12  PM-CRED-BENE-INFO.
  5469         16  PM-CRED-BENE-NAME             PIC X(25).
  5470         16  PM-CRED-BENE-ADDR             PIC X(30).
  5471         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5472         16  PM-CRED-BENE-CTYST.
  5473             20  PM-CRED-BENE-CITY         PIC X(28).
  5474             20  PM-CRED-BENE-STATE        PIC XX.
  5475         16  PM-CRED-BENE-ZIP.
  5476             20  PM-CB-ZIP-CODE.
  5477                 24  PM-CB-ZIP-1           PIC X.
  5478                     88  PM-CB-CANADIAN-POST-CODE
  5479                                  VALUE 'A' THRU 'Z'.
  5480                 24  FILLER                PIC X(4).
  5481             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5482         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5483             20  PM-CB-CAN-POST1           PIC XXX.
  5484             20  PM-CB-CAN-POST2           PIC XXX.
  5485             20  FILLER                    PIC XXX.
  5486     12  PM-POST-CARD-MAIL-DATA.
  5487         16  PM-MAIL-DATA OCCURS 7.
  5488             20  PM-MAIL-TYPE              PIC X.
  5489                 88  PM-12MO-MAILING           VALUE '1'.
  5490                 88  PM-EXP-MAILING            VALUE '2'.
  5491             20  PM-MAIL-STATUS            PIC X.
  5492                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5493                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5494                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5495             20  PM-MAIL-DATE              PIC XX.
  5496     12  FILLER                            PIC XX.
  5497     12  FILLER                            PIC X(12).
  5498*    12  FILLER                            PIC X(30).
  5499
  5500******************************************************************
  5501*                                    COPY ERCMAIL.
  5502******************************************************************
  5503*                                                                *
  5504*                                                                *
  5505*                            ERCMAIL                             *
  5506*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5507*                            VMOD=2.003                          *
  5508*                                                                *
  5509*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5510*                                                                *
  5511*   FILE TYPE = VSAM,KSDS                                        *
  5512*   RECORD SIZE = 374   RECFORM = FIX                            *
  5513*                                                                *
  5514*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5515*   ALTERNATE PATH    = NOT USED                                 *
  5516*                                                                *
  5517*   LOG = YES                                                    *
  5518*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5519******************************************************************
  5520*                   C H A N G E   L O G
  5521*
  5522* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5523*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  97
* EL677.cbl
  5524*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5525* EFFECTIVE    NUMBER
  5526*-----------------------------------------------------------------
  5527* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5528* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5529* 111108                   PEMA  ADD CRED BENE ADDR2
  5530******************************************************************
  5531
  5532 01  MAILING-DATA.
  5533     12  MA-RECORD-ID                      PIC XX.
  5534         88  VALID-MA-ID                       VALUE 'MA'.
  5535
  5536     12  MA-CONTROL-PRIMARY.
  5537         16  MA-COMPANY-CD                 PIC X.
  5538         16  MA-CARRIER                    PIC X.
  5539         16  MA-GROUPING.
  5540             20  MA-GROUPING-PREFIX        PIC XXX.
  5541             20  MA-GROUPING-PRIME         PIC XXX.
  5542         16  MA-STATE                      PIC XX.
  5543         16  MA-ACCOUNT.
  5544             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5545             20  MA-ACCOUNT-PRIME          PIC X(6).
  5546         16  MA-CERT-EFF-DT                PIC XX.
  5547         16  MA-CERT-NO.
  5548             20  MA-CERT-PRIME             PIC X(10).
  5549             20  MA-CERT-SFX               PIC X.
  5550
  5551     12  FILLER                            PIC XX.
  5552
  5553     12  MA-ACCESS-CONTROL.
  5554         16  MA-SOURCE-SYSTEM              PIC XX.
  5555             88  MA-FROM-CREDIT                VALUE 'CR'.
  5556             88  MA-FROM-VSI                   VALUE 'VS'.
  5557             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5558             88  MA-FROM-OTHER                 VALUE 'OT'.
  5559         16  MA-RECORD-ADD-DT              PIC XX.
  5560         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5561         16  MA-LAST-MAINT-DT              PIC XX.
  5562         16  MA-LAST-MAINT-BY              PIC XXXX.
  5563         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5564
  5565     12  MA-PROFILE-INFO.
  5566         16  MA-QUALIFY-CODE-1             PIC XX.
  5567         16  MA-QUALIFY-CODE-2             PIC XX.
  5568         16  MA-QUALIFY-CODE-3             PIC XX.
  5569         16  MA-QUALIFY-CODE-4             PIC XX.
  5570         16  MA-QUALIFY-CODE-5             PIC XX.
  5571
  5572         16  MA-INSURED-LAST-NAME          PIC X(15).
  5573         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5574         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5575         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5576         16  MA-INSURED-BIRTH-DT           PIC XX.
  5577         16  MA-INSURED-SEX                PIC X.
  5578             88  MA-SEX-MALE                   VALUE 'M'.
  5579             88  MA-SEX-FEMALE                 VALUE 'F'.
  5580         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5581
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  98
* EL677.cbl
  5582         16  MA-ADDRESS-CORRECTED          PIC X.
  5583         16  MA-JOINT-BIRTH-DT             PIC XX.
  5584*        16  FILLER                        PIC X(12).
  5585
  5586         16  MA-ADDRESS-LINE-1             PIC X(30).
  5587         16  MA-ADDRESS-LINE-2             PIC X(30).
  5588         16  MA-CITY-STATE.
  5589             20  MA-CITY                   PIC X(28).
  5590             20  MA-ADDR-STATE             PIC XX.
  5591         16  MA-ZIP.
  5592             20  MA-ZIP-CODE.
  5593                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5594                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5595                 24  FILLER                PIC X(4).
  5596             20  MA-ZIP-PLUS4              PIC X(4).
  5597         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5598             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5599             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5600             20  FILLER                    PIC X(3).
  5601
  5602         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5603
  5604         16  FILLER                        PIC XXX.
  5605*        16  FILLER                        PIC X(10).
  5606
  5607     12  MA-CRED-BENE-INFO.
  5608         16  MA-CRED-BENE-NAME                 PIC X(25).
  5609         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5610         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5611         16  MA-CRED-BENE-CTYST.
  5612             20  MA-CRED-BENE-CITY             PIC X(28).
  5613             20  MA-CRED-BENE-STATE            PIC XX.
  5614         16  MA-CRED-BENE-ZIP.
  5615             20  MA-CB-ZIP-CODE.
  5616                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5617                     88  MA-CB-CANADIAN-POST-CODE
  5618                                           VALUE 'A' THRU 'Z'.
  5619                 24  FILLER                    PIC X(4).
  5620             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5621         16  MA-CB-CANADIAN-POSTAL-CODE
  5622                            REDEFINES MA-CRED-BENE-ZIP.
  5623             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5624             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5625             20  FILLER                        PIC X(3).
  5626     12  MA-POST-CARD-MAIL-DATA.
  5627         16  MA-MAIL-DATA OCCURS 7.
  5628             20  MA-MAIL-TYPE              PIC X.
  5629                 88  MA-12MO-MAILING           VALUE '1'.
  5630                 88  MA-EXP-MAILING            VALUE '2'.
  5631             20  MA-MAIL-STATUS            PIC X.
  5632                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5633                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5634                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5635             20  MA-MAIL-DATE              PIC XX.
  5636     12  FILLER                            PIC XX.
  5637     12  FILLER                            PIC XX.
  5638*    12  FILLER                            PIC X(30).
  5639******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page  99
* EL677.cbl
  5640*                                    COPY ERCPYAJ.
  5641******************************************************************
  5642*                                                                *
  5643*                            ERCPYAJ                             *
  5644*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5645*                            VMOD=2.015                          *
  5646*                                                                *
  5647*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5648*                                                                *
  5649*                                                                *
  5650*   FILE TYPE = VSAM,KSDS                                        *
  5651*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5652*                                                                *
  5653*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5654*       ALTERNATE PATHS = NONE                                   *
  5655*                                                                *
  5656*   LOG = YES                                                    *
  5657*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5658******************************************************************
  5659******************************************************************
  5660*                   C H A N G E   L O G
  5661*
  5662* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5663*-----------------------------------------------------------------
  5664*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5665* EFFECTIVE    NUMBER
  5666*-----------------------------------------------------------------
  5667* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5668* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5669******************************************************************
  5670
  5671 01  PENDING-PAY-ADJ.
  5672     12  PY-RECORD-ID                     PIC XX.
  5673         88  VALID-PY-ID                        VALUE 'PY'.
  5674
  5675     12  PY-CONTROL-PRIMARY.
  5676         16  PY-COMPANY-CD                PIC X.
  5677         16  PY-CARRIER                   PIC X.
  5678         16  PY-GROUPING                  PIC X(6).
  5679         16  PY-FIN-RESP                  PIC X(10).
  5680         16  PY-ACCOUNT                   PIC X(10).
  5681         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5682                                          PIC X(10).
  5683         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5684         16  PY-RECORD-TYPE               PIC X.
  5685             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5686             88  PY-DEPOSIT                   VALUE 'D'.
  5687             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5688             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5689             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5690             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5691             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5692             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5693             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5694             88  PY-FICA-ENTRY                VALUE 'F'.
  5695             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5696             88  PY-POLICY-FEE                VALUE 'W'.
  5697             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 100
* EL677.cbl
  5698
  5699     12  PY-PYMT-TYPE                     PIC X.
  5700             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5701             88  PY-REINS-PYMT                VALUE 'R'.
  5702             88  PY-EXP-PYMT                  VALUE 'E'.
  5703
  5704     12  PY-BIL-INV                       PIC X(6).
  5705     12  PY-REF-NO                        PIC X(12).
  5706
  5707     12  PY-LAST-MAINT-DT                 PIC XX.
  5708     12  PY-LAST-MAINT-BY                 PIC X(4).
  5709     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5710
  5711     12  PY-PYADJ-RECORD.
  5712         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5713         16  PY-ENTRY-COMMENT             PIC X(30).
  5714         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5715             20  PY-GL-ACCOUNT            PIC X(10).
  5716             20  PY-GL-STATE              PIC X(02).
  5717             20  PY-GL-CANC-SW            PIC X(01).
  5718                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5719                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5720             20  PY-GL-COMMENT            PIC X(10).
  5721             20  FILLER      REDEFINES PY-GL-COMMENT.
  5722                 24  PY-GL-CHECK-NO       PIC 9(06).
  5723                 24  FILLER               PIC X(04).
  5724             20  FILLER                   PIC X(07).
  5725         16  PY-SAVE-ACCOUNT              PIC X(10).
  5726         16  PY-SAVE-TYPE                 PIC X(01).
  5727
  5728         16  PY-LETTERS.
  5729             20  PY-LETTER OCCURS 3 TIMES
  5730                           INDEXED BY PY-LET-NDX
  5731                                          PIC X(04).
  5732
  5733         16  PY-ERCOMP-TYPE               PIC X.
  5734             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5735             88  PY-GA-TYPE                   VALUE 'G'.
  5736             88  PY-BANK-TYPE                 VALUE 'B'.
  5737         16  FILLER                       PIC X(05).
  5738
  5739     12  PY-RECORD-STATUS.
  5740         16  PY-CREDIT-SELECT-DT          PIC XX.
  5741         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5742         16  PY-BILLED-DATE               PIC XX.
  5743         16  PY-REPORTED-DT               PIC XX.
  5744         16  PY-PMT-APPLIED               PIC X.
  5745             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5746             88  PY-GA-PMT                    VALUE 'G'.
  5747             88  PY-OVWRITE-PMT               VALUE 'O'.
  5748             88  PY-NON-AR-PMT                VALUE 'N'.
  5749         16  FILLER                       PIC X(5).
  5750         16  PY-INPUT-DT                  PIC XX.
  5751         16  PY-CHECK-NUMBER              PIC X(6).
  5752         16  PY-VOID-SW                   PIC X.
  5753             88  PY-CHECK-VOIDED              VALUE 'V'.
  5754         16  PY-CHECK-ORIGIN-SW           PIC X.
  5755             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 101
* EL677.cbl
  5756             88  PY-REFUND-CHECK              VALUE 'R'.
  5757             88  PY-GA-CHECK                  VALUE 'G'.
  5758             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5759             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5760         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5761         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5762         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5763         16  PY-BILL-FLAG                 PIC X.
  5764             88  PY-BILLED                    VALUE 'B'.
  5765         16  PY-AR-FLAG                   PIC X.
  5766             88  PY-AR-CYCLE                  VALUE 'C'.
  5767             88  PY-AR-MONTH-END              VALUE 'M'.
  5768         16  PY-AR-DATE                   PIC XX.
  5769
  5770     12  PY-GL-CODES.
  5771         16  PY-GL-DB                     PIC X(14).
  5772         16  PY-GL-CR                     PIC X(14).
  5773         16  PY-GL-FLAG                   PIC X.
  5774         16  PY-GL-DATE                   PIC XX.
  5775
  5776     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5777     12  FILLER                           PIC X(3).
  5778******************************************************************
  5779 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
  5780                          CHECK-RECORDS ACCOUNT-MASTER
  5781                          COMPENSATION-MASTER
  5782                          CERTIFICATE-MASTER PENDING-BUSINESS
  5783                          PENDING-MAILING-DATA MAILING-DATA
  5784                          PENDING-PAY-ADJ.
  5785 0000-DFHEXIT SECTION.
  5786     MOVE '9#                    $   ' TO DFHEIV0.
  5787     MOVE 'EL677' TO DFHEIV1.
  5788     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5789
  5790     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5791     MOVE '5'                    TO  DC-OPTION-CODE.
  5792     PERFORM 8500-DATE-CONVERT.
  5793     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5794     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5795     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5796
  5797     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5798
  5799     IF PI-AMOUNT NOT NUMERIC
  5800         MOVE ZEROS              TO  PI-AMOUNT.
  5801
  5802     IF EIBCALEN = 0
  5803         GO TO 8800-UNAUTHORIZED-ACCESS.
  5804     set P to address of KIXSYS
  5805     CALL "getenv" using by value P returning var-ptr
  5806     if var-ptr = null then
  5807        display ' kixsys not set '
  5808     else
  5809        set address of var to var-ptr
  5810        move 0 to env-var-len
  5811        inspect var tallying env-var-len
  5812          for characters before X'00'
  5813        unstring var (1:env-var-len) delimited by '/'
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 102
* EL677.cbl
  5814           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5815              WS-KIX-SYS
  5816        end-unstring
  5817     end-if
  5818     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5819     MOVE 2                      TO  EMI-SWITCH2.
  5820     MOVE EIBTRMID               TO  QID-TERM.
  5821
  5822     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5823         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5824
  5825     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5826         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5827             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5828             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5829             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5830             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5831             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5832             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5833             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5834             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5835         ELSE
  5836             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5837             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5838             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5839             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5840             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5841             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5842             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5843             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5844
  5845     MOVE LOW-VALUES             TO  EL677AI.
  5846
  5847     IF EIBTRNID NOT = TRANS-ID
  5848         move pi-processor-id    to pi-return-to
  5849         move 'N'                to dedcyno
  5850         move al-uanon           to dedcyna
  5851         perform 6800-browse-previous-chek-recs
  5852                                 thru 6800-exit
  5853         perform 5600-get-erpndb thru 5600-exit
  5854         IF PI-TO-EL677-FROM-EL1273
  5855             MOVE 'S'            TO MAINTI
  5856             MOVE 1              TO MAINTL
  5857             MOVE AL-UABON       TO MAINTA
  5858             MOVE DFHENTER       TO EIBAID
  5859             GO TO 5000-BROWSE-FILE.
  5860
  5861     IF EIBTRNID NOT = TRANS-ID
  5862        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5863           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5864           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5865           IF PI-PROCESS-BENEFICIARY
  5866              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5867           ELSE
  5868              GO TO 6300-BUILD-CERT-SCREEN
  5869           end-if
  5870        ELSE
  5871           IF EIBTRNID NOT = EL6311-TRANS-ID
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 103
* EL677.cbl
  5872              GO TO 8100-SEND-INITIAL-MAP
  5873           ELSE
  5874              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5875              IF PI-PROCESS-BENEFICIARY
  5876                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5877              ELSE
  5878                 GO TO 6300-BUILD-CERT-SCREEN
  5879              end-if
  5880           end-if
  5881        end-if
  5882      end-if
  5883
  5884     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5885                                     PI-CHEK-COMP-CD.
  5886
  5887
  5888* EXEC CICS HANDLE CONDITION
  5889*        PGMIDERR  (9600-PGMID-ERROR)
  5890*        ERROR     (9990-ABEND)
  5891*    END-EXEC.
  5892*    MOVE '"$L.                  ! " #00005790' TO DFHEIV0
  5893     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5894     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5895     MOVE X'2220233030303035373930' TO DFHEIV0(25:11)
  5896     CALL 'kxdfhei1' USING DFHEIV0
  5897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5898
  5899
  5900     IF EIBAID = DFHCLEAR
  5901         GO TO 9400-CLEAR.
  5902
  5903     IF PI-PROCESSOR-ID = 'LGXX'
  5904         GO TO 0200-RECEIVE.
  5905
  5906
  5907* EXEC CICS READQ TS
  5908*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5909*        INTO   (SECURITY-CONTROL)
  5910*        LENGTH (SC-COMM-LENGTH)
  5911*        ITEM   (SC-ITEM)
  5912*    END-EXEC.
  5913*    MOVE '*$II   L              ''   #00005801' TO DFHEIV0
  5914     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5915     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5916     MOVE X'2020233030303035383031' TO DFHEIV0(25:11)
  5917     CALL 'kxdfhei1' USING DFHEIV0,
  5918           PI-SECURITY-TEMP-STORE-ID,
  5919           SECURITY-CONTROL,
  5920           SC-COMM-LENGTH,
  5921           SC-ITEM,
  5922           DFHEIV99,
  5923           DFHEIV99
  5924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5925
  5926
  5927     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  5928     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  5929
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 104
* EL677.cbl
  5930     IF NOT DISPLAY-CAP
  5931         MOVE 'READ'          TO SM-READ
  5932         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5933         MOVE ER-0070         TO  EMI-ERROR
  5934         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5935         GO TO 8100-SEND-INITIAL-MAP.
  5936
  5937 0200-RECEIVE.
  5938     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5939         MOVE ER-1159            TO  EMI-ERROR
  5940         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5941         MOVE -1                 TO  PFENTERL
  5942         GO TO 8200-SEND-DATAONLY.
  5943
  5944
  5945* EXEC CICS HANDLE CONDITION
  5946*        MAPFAIL (8100-SEND-INITIAL-MAP)
  5947*    END-EXEC.
  5948*    MOVE '"$?                   ! # #00005825' TO DFHEIV0
  5949     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  5950     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5951     MOVE X'2320233030303035383235' TO DFHEIV0(25:11)
  5952     CALL 'kxdfhei1' USING DFHEIV0
  5953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5954
  5955
  5956
  5957* EXEC CICS RECEIVE
  5958*        MAP      (EL677A)
  5959*        MAPSET   (MAPSET-NAME)
  5960*        INTO     (EL677AI)
  5961*    END-EXEC.
  5962     MOVE LENGTH OF
  5963      EL677AI
  5964       TO DFHEIV11
  5965*    MOVE '8"T I  L              ''   #00005829' TO DFHEIV0
  5966     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5967     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5968     MOVE X'2020233030303035383239' TO DFHEIV0(25:11)
  5969     CALL 'kxdfhei1' USING DFHEIV0,
  5970           EL677A,
  5971           EL677AI,
  5972           DFHEIV11,
  5973           MAPSET-NAME,
  5974           DFHEIV99,
  5975           DFHEIV99
  5976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5977
  5978
  5979     IF PFENTERL GREATER ZERO
  5980         IF EIBAID NOT = DFHENTER
  5981             MOVE ER-0004        TO  EMI-ERROR
  5982             MOVE AL-UNBOF       TO  PFENTERA
  5983             MOVE -1             TO  PFENTERL
  5984             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5985             GO TO 8200-SEND-DATAONLY
  5986         ELSE
  5987             IF (PFENTERI NUMERIC) AND
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 105
* EL677.cbl
  5988                (PFENTERI GREATER 0 AND LESS 25)
  5989                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  5990             ELSE
  5991                 MOVE ER-0029    TO  EMI-ERROR
  5992                 MOVE AL-UNBOF   TO  PFENTERA
  5993                 MOVE -1         TO  PFENTERL
  5994                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5995                 GO TO 8200-SEND-DATAONLY.
  5996 0300-CHECK-PFKEYS.
  5997     IF EIBAID = DFHPF23
  5998         GO TO 8810-PF23.
  5999
  6000     IF EIBAID = DFHPF24
  6001         GO TO 9200-RETURN-MAIN-MENU.
  6002
  6003     IF EIBAID = DFHPF12
  6004         GO TO 9500-PF12.
  6005
  6006     IF EIBAID = DFHPF1 OR DFHPF2
  6007         GO TO 5000-BROWSE-FILE.
  6008
  6009     if PI-TO-EL677-FROM-EL1273
  6010        and (eibaid not = dfhenter)
  6011        go to 0320-input-error
  6012     end-if
  6013     IF EIBAID = DFHPF3
  6014         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6015         MOVE 'PF3'              TO  PI-PFKEY
  6016         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6017         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6018             GO TO 9400-CLEAR
  6019         ELSE
  6020             MOVE XCTL-1273      TO  PGM-NAME
  6021             GO TO 9300-XCTL.
  6022
  6023     IF EIBAID = DFHPF4
  6024         IF NOT FORCE-CAP
  6025             MOVE ER-0433        TO EMI-ERROR
  6026             MOVE -1             TO PFENTERL
  6027             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6028             GO TO 8200-SEND-DATAONLY.
  6029
  6030     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6031                             DFHPF5 OR DFHPF6 or dfhpf7
  6032         GO TO 1000-EDIT-DATA.
  6033
  6034*    IF EIBAID = DFHPF7
  6035*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6036*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6037*        MOVE XCTL-114           TO  PGM-NAME
  6038*        GO TO 9300-XCTL.
  6039
  6040 0320-INPUT-ERROR.
  6041     MOVE ER-0029                TO  EMI-ERROR.
  6042     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6043     MOVE -1                     TO  PFENTERL.
  6044     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 106
* EL677.cbl
  6046
  6047 1000-EDIT-DATA.
  6048     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D'
  6049         MOVE AL-UANON           TO MAINTA
  6050         IF MAINTI = 'C' OR 'V'
  6051             IF PI-PREV-MAINT = 'S'  OR  'C'
  6052                 NEXT SENTENCE
  6053             ELSE
  6054                 MOVE ER-2056    TO  EMI-ERROR
  6055                 MOVE -1         TO  MAINTL
  6056                 MOVE AL-UABON   TO  MAINTA
  6057                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6058                 GO TO 1100-EDIT-COMPLETE
  6059         ELSE
  6060             NEXT SENTENCE
  6061     ELSE
  6062         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6063            NEXT SENTENCE
  6064         ELSE
  6065            MOVE ER-0023            TO  EMI-ERROR
  6066            MOVE -1                 TO  MAINTL
  6067            MOVE AL-UABON           TO  MAINTA
  6068            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6069
  6070     IF MODIFY-CAP
  6071         NEXT SENTENCE
  6072       ELSE
  6073         IF MAINTI NOT = 'S'
  6074            MOVE 'UPDATE'       TO SM-READ
  6075            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6076            MOVE ER-0070        TO EMI-ERROR
  6077            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6078            GO TO 8100-SEND-INITIAL-MAP.
  6079
  6080     if (pi-return-to-program = 'EL1273')
  6081        and (MAINTI not = 'S' and 'V')
  6082        move 'S'                 to mainti
  6083        move +1                  to maintl
  6084        move al-uanon            to mainta
  6085     end-if
  6086     IF CARRIERI NOT = LOW-VALUES
  6087         MOVE AL-UANON           TO  CARRIERA
  6088         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6089         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6090                                     PI-CARRIER
  6091     ELSE
  6092         MOVE -1                 TO  CARRIERL
  6093         MOVE AL-UABON           TO  CARRIERA
  6094         MOVE ER-0194            TO  EMI-ERROR
  6095         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6096
  6097     IF GROUPI NOT = LOW-VALUES
  6098         MOVE AL-UANON           TO  GROUPA
  6099         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6100                                     PI-GROUPING
  6101     ELSE
  6102         MOVE -1                 TO  GROUPL
  6103         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 107
* EL677.cbl
  6104         MOVE ER-0195            TO  EMI-ERROR
  6105         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6106
  6107     IF STATEI NOT = LOW-VALUES
  6108         MOVE AL-UANON           TO  STATEA
  6109         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6110         MOVE STATEI             TO  PI-CHEK-STATE
  6111                                     PI-STATE
  6112     ELSE
  6113         MOVE -1                 TO  STATEL
  6114         MOVE AL-UABON           TO  STATEA
  6115         MOVE ER-0196            TO  EMI-ERROR
  6116         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6117
  6118     IF EFFDTL GREATER ZERO
  6119         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6120         PERFORM 8700-DEEDIT
  6121         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6122             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6123             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6124             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6125             MOVE '4'                TO  DC-OPTION-CODE
  6126             PERFORM 8500-DATE-CONVERT
  6127             IF DC-ERROR-CODE NOT = SPACES
  6128                 MOVE ER-0215        TO  EMI-ERROR
  6129                 PERFORM 9900-ERROR-FORMAT
  6130                 MOVE -1             TO  EFFDTL
  6131                 MOVE AL-UABON       TO  EFFDTA
  6132               ELSE
  6133                 MOVE AL-UANON       TO  EFFDTA
  6134                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6135                                         PI-CERT-EFF-DT
  6136           ELSE
  6137             MOVE ER-0215        TO  EMI-ERROR
  6138             PERFORM 9900-ERROR-FORMAT
  6139             MOVE -1             TO  EFFDTL
  6140             MOVE AL-UABON       TO  EFFDTA
  6141       ELSE
  6142         MOVE ER-0216            TO  EMI-ERROR
  6143         PERFORM 9900-ERROR-FORMAT
  6144         MOVE -1                 TO  EFFDTL
  6145         MOVE AL-UABOF           TO  EFFDTA.
  6146
  6147     IF ACCTI NOT = LOW-VALUES
  6148         MOVE AL-UANON           TO  ACCTA
  6149         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6150         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6151                                     PI-ACCOUNT
  6152     ELSE
  6153         MOVE -1                 TO  ACCTL
  6154         MOVE AL-UABON           TO  ACCTA
  6155         MOVE ER-0197            TO  EMI-ERROR
  6156         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6157
  6158     IF CERTNOI NOT = LOW-VALUES
  6159         MOVE AL-UANON           TO  CERTNOA
  6160         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6161                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 108
* EL677.cbl
  6162     ELSE
  6163         MOVE -1                 TO  CERTNOL
  6164         MOVE AL-UABON           TO  CERTNOA
  6165         MOVE ER-0203            TO  EMI-ERROR
  6166         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6167
  6168     IF SFXI  = LOW-VALUES
  6169         MOVE SPACE              TO  SFXI.
  6170
  6171     MOVE AL-UANON               TO  SFXA.
  6172
  6173     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6174                                     PI-CERT-SFX.
  6175     IF SEQI = LOW-VALUES
  6176         MOVE +1                 TO  SEQI.
  6177
  6178     MOVE AL-UNNON               TO  SEQA.
  6179     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6180
  6181     IF PAYTO1L > 0
  6182         MOVE PAYTO1I            TO  PI-PAYTO1
  6183     ELSE
  6184         MOVE SPACES             TO  PI-PAYTO1.
  6185
  6186     IF AMOUNTL > 0
  6187
  6188* EXEC CICS BIF DEEDIT
  6189*            FIELD   (AMOUNTI)
  6190*            LENGTH  (11)
  6191*        END-EXEC
  6192     MOVE 11
  6193       TO DFHEIV11
  6194*    MOVE '@"L                   #   #00006043' TO DFHEIV0
  6195     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6196     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6197     MOVE X'2020233030303036303433' TO DFHEIV0(25:11)
  6198     CALL 'kxdfhei1' USING DFHEIV0,
  6199           AMOUNTI,
  6200           DFHEIV11
  6201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6202         MOVE AMOUNTI            TO  PI-AMOUNT
  6203     ELSE
  6204         MOVE ZEROS              TO  PI-AMOUNT.
  6205
  6206     IF TYPEL > 0
  6207         MOVE TYPEI              TO  PI-TYPE
  6208     ELSE
  6209         MOVE SPACE              TO  PI-TYPE.
  6210
  6211*    IF REFL > 0
  6212*        MOVE REFI               TO  PI-REFERENCE
  6213*    ELSE
  6214*        MOVE SPACES             TO  PI-REFERENCE.
  6215     if rettol not = zeros
  6216        move rettoi              to pi-return-to
  6217        MOVE AL-UANON            TO  RETTOA
  6218     end-if
  6219     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 109
* EL677.cbl
  6220        if dedcyni = 'Y' OR 'N'
  6221           continue
  6222        else
  6223           move er-3451          to emi-error
  6224           move -1               to dedcynl
  6225           move al-uabon         to dedcyna
  6226           perform 9900-error-format
  6227                                 thru 9900-exit
  6228        end-if
  6229     end-if
  6230
  6231     if mainti = 'V'
  6232        if (vreasonl > zeros)
  6233           and (vreasoni (1:2) not = spaces)
  6234           continue
  6235        else
  6236           move er-3454          to emi-error
  6237           move -1               to vreasonl
  6238           move al-uabon         to vreasona
  6239           perform 9900-error-format
  6240                                 thru 9900-exit
  6241        end-if
  6242     end-if
  6243     if mainti = 'A'
  6244        continue
  6245     else
  6246        IF MAINTI = 'S'
  6247           or pi-prev-maint = 'S'
  6248           GO TO 1100-EDIT-COMPLETE
  6249        end-if
  6250     end-if
  6251     IF EIBAID = DFHPF5
  6252        IF EMI-ERROR = ZEROS
  6253          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6254        ELSE
  6255          GO TO 1100-EDIT-COMPLETE.
  6256
  6257     IF EIBAID = DFHPF6
  6258        IF EMI-ERROR = ZEROS
  6259           GO TO 6300-BUILD-CERT-SCREEN
  6260         ELSE
  6261           GO TO 1100-EDIT-COMPLETE.
  6262
  6263     IF EIBAID = DFHPF7
  6264        IF EMI-ERROR = ZEROS
  6265           GO TO 6600-build-beneficiary-screen
  6266         ELSE
  6267           GO TO 1100-EDIT-COMPLETE.
  6268
  6269*    if mainti = 'V'
  6270*       if (vreasonl > zeros)
  6271*          and (vreasoni (1:2) not = spaces)
  6272*          continue
  6273*       else
  6274*          move er-3454          to emi-error
  6275*          move -1               to vreasonl
  6276*          move al-uabon         to vreasona
  6277*          perform 9900-error-format
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 110
* EL677.cbl
  6278*                                thru 9900-exit
  6279*       end-if
  6280*    end-if
  6281     IF MAINTI = 'A'
  6282        if (payto1i not = spaces and low-values)
  6283           and (payad1i not = spaces and low-values)
  6284           and (payctyi not = spaces and low-values)
  6285           and (paysti not = spaces and low-values)
  6286           and (ptozipi not = spaces and low-values)
  6287           continue
  6288        else
  6289           MOVE -1               TO PAYTO1L
  6290           MOVE ER-2907          TO EMI-ERROR
  6291           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6292        end-if
  6293     end-if
  6294
  6295     IF MAINTI = 'A'
  6296         IF EIBAID NOT = DFHPF4
  6297             MOVE DFHENTER       TO  EIBAID
  6298             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6299
  6300     IF MAINTI = 'S' OR 'V'
  6301         GO TO 1100-EDIT-COMPLETE.
  6302
  6303     IF PRINTEDL GREATER THAN +0
  6304         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6305         PERFORM 8700-DEEDIT
  6306         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6307             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6308             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6309             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6310             MOVE '4'                TO  DC-OPTION-CODE
  6311             PERFORM 8500-DATE-CONVERT
  6312             IF DC-ERROR-CODE NOT = SPACES
  6313                 MOVE ER-3046        TO  EMI-ERROR
  6314                 PERFORM 9900-ERROR-FORMAT
  6315                 MOVE -1             TO  PRINTEDL
  6316                 MOVE AL-UABON       TO  PRINTEDA
  6317                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6318             ELSE
  6319                 MOVE AL-UANON       TO  PRINTEDA
  6320                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6321         ELSE
  6322             MOVE ER-3046        TO  EMI-ERROR
  6323             PERFORM 9900-ERROR-FORMAT
  6324             MOVE -1             TO  PRINTEDL
  6325             MOVE AL-UABON       TO  PRINTEDA
  6326             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
  6327
  6328     IF AMOUNTL = ZEROS
  6329         GO TO 1050-CK-AMT.
  6330
  6331
  6332* EXEC CICS BIF DEEDIT
  6333*        FIELD   (AMOUNTI)
  6334*        LENGTH  (11)
  6335*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 111
* EL677.cbl
  6336     MOVE 11
  6337       TO DFHEIV11
  6338*    MOVE '@"L                   #   #00006176' TO DFHEIV0
  6339     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6340     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6341     MOVE X'2020233030303036313736' TO DFHEIV0(25:11)
  6342     CALL 'kxdfhei1' USING DFHEIV0,
  6343           AMOUNTI,
  6344           DFHEIV11
  6345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6346
  6347
  6348     IF AMOUNTI NOT NUMERIC     OR
  6349        AMOUNTI LESS THAN ZERO  OR
  6350       (AMOUNTI = ZEROS  AND
  6351               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6352          MOVE ER-1159            TO  EMI-ERROR
  6353          MOVE -1                 TO  AMOUNTL
  6354          MOVE AL-UNBON           TO  AMOUNTA
  6355          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6356          GO TO 1100-EDIT-COMPLETE.
  6357
  6358     MOVE AMOUNTI                TO  WS-AM-WORK.
  6359
  6360     IF WS-AM-SIGN = SPACES
  6361         MOVE WS-AM-NUM          TO  WS-AMT
  6362         ADD 0                   TO  WS-AMT
  6363       ELSE
  6364         MOVE AMOUNTI            TO  WS-AMT
  6365         ADD 0                   TO  WS-AMT.
  6366
  6367      MOVE WS-AMT                TO  AMOUNTO.
  6368      MOVE AL-UNNON              TO  AMOUNTA.
  6369
  6370 1050-CK-AMT.
  6371     IF AMOUNTL = ZEROS AND
  6372        MAINTI  = 'A'
  6373         MOVE ER-1159            TO  EMI-ERROR
  6374         MOVE -1                 TO  AMOUNTL
  6375         MOVE AL-UNBON           TO  AMOUNTA
  6376         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6377
  6378     MOVE AL-UANON              TO  TYPEA.
  6379
  6380     IF TYPEL GREATER THAN ZEROS
  6381         IF TYPEI = 'R' OR 'M' OR 'E'
  6382             NEXT SENTENCE
  6383         ELSE
  6384             MOVE ER-3044    TO  EMI-ERROR
  6385             MOVE -1         TO  TYPEL
  6386             MOVE AL-UABON   TO  TYPEA
  6387             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6388     ELSE
  6389         IF MAINTI  = 'A'
  6390             MOVE ER-3044    TO  EMI-ERROR
  6391             MOVE -1         TO  TYPEL
  6392             MOVE AL-UABON   TO  TYPEA
  6393             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 112
* EL677.cbl
  6394
  6395
  6396 1100-EDIT-COMPLETE.
  6397
  6398     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6399       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6400        EIBAID NOT = DFHPF4)
  6401         GO TO 8200-SEND-DATAONLY.
  6402
  6403     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6404
  6405     IF MAINTI = 'A'
  6406         GO TO 2000-ADD-RECORD.
  6407
  6408*    IF MAINTI = 'C' OR 'V'
  6409     IF MAINTI = 'V'
  6410         GO TO 3000-CHANGE-RECORD.
  6411
  6412     IF MAINTI = 'S' or 'C'
  6413         GO TO 5000-BROWSE-FILE.
  6414
  6415     if mainti = 'D'
  6416        go to 3400-delete-record
  6417     end-if
  6418     .
  6419 1200-VERIFY-CARRIER-ID.
  6420     MOVE SPACES                 TO ELCNTL-KEY.
  6421     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6422     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6423     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6424     MOVE +0                     TO ELCNTL-SEQ.
  6425
  6426
  6427* EXEC CICS HANDLE CONDITION
  6428*        NOTFND   (1290-NO-CARRIER)
  6429*    END-EXEC.
  6430*    MOVE '"$I                   ! $ #00006259' TO DFHEIV0
  6431     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6433     MOVE X'2420233030303036323539' TO DFHEIV0(25:11)
  6434     CALL 'kxdfhei1' USING DFHEIV0
  6435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6436
  6437
  6438
  6439* EXEC CICS READ
  6440*        DATASET   (ELCNTL-FILE-ID)
  6441*        SET       (ADDRESS OF CONTROL-FILE)
  6442*        RIDFLD    (ELCNTL-KEY)
  6443*    END-EXEC.
  6444*    MOVE '&"S        E          (   #00006263' TO DFHEIV0
  6445     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6446     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6447     MOVE X'2020233030303036323633' TO DFHEIV0(25:11)
  6448     CALL 'kxdfhei1' USING DFHEIV0,
  6449           ELCNTL-FILE-ID,
  6450           DFHEIV20,
  6451           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 113
* EL677.cbl
  6452           ELCNTL-KEY,
  6453           DFHEIV99,
  6454           DFHEIV99,
  6455           DFHEIV99
  6456     SET ADDRESS OF CONTROL-FILE TO
  6457         DFHEIV20
  6458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6459
  6460
  6461     GO TO 1200-EXIT.
  6462
  6463 1290-NO-CARRIER.
  6464     MOVE ER-2208                TO EMI-ERROR.
  6465     MOVE -1                     TO CARRIERL.
  6466     MOVE AL-UABON               TO CARRIERA.
  6467     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6468
  6469 1200-EXIT.
  6470      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 114
* EL677.cbl
  6472 1300-VERIFY-STATE-ID.
  6473     MOVE SPACES                 TO ELCNTL-KEY.
  6474     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6475     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6476     MOVE STATEI                 TO ELCNTL-STATE.
  6477     MOVE +0                     TO ELCNTL-SEQ.
  6478
  6479
  6480* EXEC CICS HANDLE CONDITION
  6481*        NOTFND   (1380-NO-STATE)
  6482*    END-EXEC.
  6483*    MOVE '"$I                   ! % #00006287' TO DFHEIV0
  6484     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6485     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6486     MOVE X'2520233030303036323837' TO DFHEIV0(25:11)
  6487     CALL 'kxdfhei1' USING DFHEIV0
  6488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6489
  6490
  6491
  6492* EXEC CICS READ
  6493*        DATASET   (ELCNTL-FILE-ID)
  6494*        SET       (ADDRESS OF CONTROL-FILE)
  6495*        RIDFLD    (ELCNTL-KEY)
  6496*    END-EXEC.
  6497*    MOVE '&"S        E          (   #00006291' TO DFHEIV0
  6498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6500     MOVE X'2020233030303036323931' TO DFHEIV0(25:11)
  6501     CALL 'kxdfhei1' USING DFHEIV0,
  6502           ELCNTL-FILE-ID,
  6503           DFHEIV20,
  6504           DFHEIV99,
  6505           ELCNTL-KEY,
  6506           DFHEIV99,
  6507           DFHEIV99,
  6508           DFHEIV99
  6509     SET ADDRESS OF CONTROL-FILE TO
  6510         DFHEIV20
  6511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6512
  6513
  6514     GO TO 1390-EXIT.
  6515
  6516 1380-NO-STATE.
  6517     MOVE ER-2209                TO EMI-ERROR.
  6518     MOVE -1                     TO STATEL.
  6519     MOVE AL-UABON               TO STATEA.
  6520     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6521
  6522 1390-EXIT.
  6523      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 115
* EL677.cbl
  6525
  6526 1400-VERIFY-ACCOUNT.
  6527     IF EIBAID = DFHPF5
  6528         GO TO 1410-BUILD-ACCOUNT-KEY.
  6529
  6530     IF MAINTL GREATER +0
  6531         NEXT SENTENCE
  6532       ELSE
  6533         GO TO 1490-EXIT.
  6534
  6535*    IF MAINTI = 'A' OR 'C' OR 'V'
  6536     IF MAINTI = 'A' OR 'V'
  6537         NEXT SENTENCE
  6538       ELSE
  6539         GO TO 1490-EXIT.
  6540
  6541 1410-BUILD-ACCOUNT-KEY.
  6542     MOVE CARRIERI               TO ERACCT-CARRIER.
  6543     MOVE GROUPI                 TO ERACCT-GROUPING
  6544     MOVE STATEI                 TO ERACCT-STATE.
  6545     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6546     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6547
  6548     MOVE '2'                    TO DC-OPTION-CODE.
  6549     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6550
  6551     PERFORM 8500-DATE-CONVERT.
  6552     IF DATE-CONVERSION-ERROR
  6553        GO TO 1480-ACCOUNT-INVALID.
  6554
  6555     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6556    .
  6557 1420-get-eracct.
  6558     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6559
  6560
  6561* EXEC CICS HANDLE CONDITION
  6562*        NOTFND   (1480-ACCOUNT-INVALID)
  6563*        ENDFILE  (1480-ACCOUNT-INVALID)
  6564*    END-EXEC.
  6565*    MOVE '"$I''                  ! & #00006343' TO DFHEIV0
  6566     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6568     MOVE X'2620233030303036333433' TO DFHEIV0(25:11)
  6569     CALL 'kxdfhei1' USING DFHEIV0
  6570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6571
  6572
  6573
  6574* EXEC CICS STARTBR
  6575*        DATASET   (ERACCT-FILE-ID)
  6576*        RIDFLD    (ERACCT-KEY)
  6577*    END-EXEC.
  6578     MOVE 0
  6579       TO DFHEIV11
  6580*    MOVE '&,         G          &   #00006348' TO DFHEIV0
  6581     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6582     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 116
* EL677.cbl
  6583     MOVE X'2020233030303036333438' TO DFHEIV0(25:11)
  6584     CALL 'kxdfhei1' USING DFHEIV0,
  6585           ERACCT-FILE-ID,
  6586           ERACCT-KEY,
  6587           DFHEIV99,
  6588           DFHEIV11,
  6589           DFHEIV99
  6590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6591
  6592
  6593     set eracct-start to true
  6594     .
  6595 1420-READNEXT-ACCOUNT-MASTER.
  6596
  6597* EXEC CICS READNEXT
  6598*        DATASET   (ERACCT-FILE-ID)
  6599*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6600*        RIDFLD    (ERACCT-KEY)
  6601*    END-EXEC.
  6602     MOVE 0
  6603       TO DFHEIV11
  6604*    MOVE '&.S                   )   #00006356' TO DFHEIV0
  6605     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6606     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6607     MOVE X'2020233030303036333536' TO DFHEIV0(25:11)
  6608     CALL 'kxdfhei1' USING DFHEIV0,
  6609           ERACCT-FILE-ID,
  6610           DFHEIV20,
  6611           DFHEIV99,
  6612           ERACCT-KEY,
  6613           DFHEIV99,
  6614           DFHEIV11,
  6615           DFHEIV99,
  6616           DFHEIV99
  6617     SET ADDRESS OF ACCOUNT-MASTER TO
  6618         DFHEIV20
  6619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6620
  6621
  6622*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6623*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6624*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6625*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6626*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6627*         GO TO 1480-ACCOUNT-INVALID.
  6628*
  6629*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6630*        GO TO 1480-ACCOUNT-INVALID.
  6631*
  6632*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6633*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6634
  6635     evaluate true
  6636        when (save-eracct-key (1:20) not =
  6637           am-control-primary (1:20))
  6638           and (not eracct-found)
  6639           go to 1480-account-invalid
  6640        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 117
* EL677.cbl
  6641           am-control-primary (1:20))
  6642           and (eracct-found)
  6643           move ws-hold-eracct-record
  6644                                 to account-master
  6645        when (sv-acct-exp-date < am-effective-dt)
  6646           and (not eracct-found)
  6647           go to 1480-account-invalid
  6648        when sv-acct-exp-date >= am-expiration-dt
  6649           go to 1420-readnext-account-master
  6650        when am-expiration-dt = high-values
  6651           continue
  6652        when other
  6653           set eracct-found to true
  6654           move account-master   to ws-hold-eracct-record
  6655           go to 1420-readnext-account-master
  6656     end-evaluate
  6657     if eracct-start
  6658
  6659* exec cics endbr
  6660*          dataset  (eracct-file-id)
  6661*       end-exec
  6662     MOVE 0
  6663       TO DFHEIV11
  6664*    MOVE '&2                    $   #00006398' TO DFHEIV0
  6665     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6666     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6667     MOVE X'2020233030303036333938' TO DFHEIV0(25:11)
  6668     CALL 'kxdfhei1' USING DFHEIV0,
  6669           eracct-file-id,
  6670           DFHEIV11,
  6671           DFHEIV99
  6672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6673     end-if
  6674*    if am-expiration-dt = high-values
  6675*       continue
  6676*    else
  6677*       move account-master      to ws-hold-eracct-record
  6678*       go to 1420-readnext-account-master
  6679*    end-if
  6680     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6681     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6682     MOVE AM-STATE               TO PI-CR-STATE.
  6683     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6684
  6685     MOVE AM-NAME                TO PI-AM-NAME.
  6686     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6687     MOVE AM-CITY                TO PI-AM-CITY-st
  6688     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6689     move am-csr-code            to pi-am-csr
  6690
  6691     MOVE +0                     TO WS-SUB.
  6692
  6693 1430-FIND-ACC-AGT.
  6694     ADD +1                      TO WS-SUB.
  6695
  6696     IF  WS-SUB GREATER +10
  6697         GO TO 1480-ACCOUNT-INVALID.
  6698
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 118
* EL677.cbl
  6699     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F' OR 'S')
  6700         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6701       ELSE
  6702         GO TO 1430-FIND-ACC-AGT.
  6703
  6704     MOVE AL-UANON               TO CARRIERA
  6705                                    GROUPA
  6706                                    STATEA.
  6707
  6708     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6709
  6710     GO TO 1490-EXIT.
  6711
  6712 1480-ACCOUNT-INVALID.
  6713     MOVE -1                     TO CARRIERL
  6714     MOVE AL-UANON               TO CARRIERA
  6715                                    GROUPA
  6716                                    STATEA
  6717                                    ACCTA.
  6718     MOVE ER-2210                TO EMI-ERROR.
  6719     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6720     GO TO 8200-SEND-DATAONLY.
  6721
  6722 1490-EXIT.
  6723      EXIT.
  6724
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 119
* EL677.cbl
  6726 1500-VERIFY-PENDING-BUS-REC.
  6727
  6728* EXEC CICS HANDLE CONDITION
  6729*        NOTFND   (1590-EXIT)
  6730*    END-EXEC.
  6731*    MOVE '"$I                   ! '' #00006455' TO DFHEIV0
  6732     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6734     MOVE X'2720233030303036343535' TO DFHEIV0(25:11)
  6735     CALL 'kxdfhei1' USING DFHEIV0
  6736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6737
  6738
  6739     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6740
  6741     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6742     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6743     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6744     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6745     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6746     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6747     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6748     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6749     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6750     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6751
  6752     IF ST-ACCNT-CNTL  OR
  6753        ACCNT-CNTL
  6754          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6755
  6756     IF ST-ACCNT-CNTL      OR
  6757        CARR-ST-ACCNT-CNTL OR
  6758        ACCNT-CNTL         OR
  6759        CARR-ACCNT-CNTL
  6760          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6761
  6762     IF ACCNT-CNTL OR
  6763        CARR-ACCNT-CNTL
  6764          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6765
  6766
  6767* EXEC CICS READ
  6768*         DATASET   (ERPNDB-ALT-FILE-ID)
  6769*         SET       (ADDRESS OF PENDING-BUSINESS)
  6770*         RIDFLD    (ERPNDB-ALT-KEY)
  6771*     END-EXEC.
  6772*    MOVE '&"S        E          (   #00006486' TO DFHEIV0
  6773     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6774     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6775     MOVE X'2020233030303036343836' TO DFHEIV0(25:11)
  6776     CALL 'kxdfhei1' USING DFHEIV0,
  6777           ERPNDB-ALT-FILE-ID,
  6778           DFHEIV20,
  6779           DFHEIV99,
  6780           ERPNDB-ALT-KEY,
  6781           DFHEIV99,
  6782           DFHEIV99,
  6783           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 120
* EL677.cbl
  6784     SET ADDRESS OF PENDING-BUSINESS TO
  6785         DFHEIV20
  6786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6787
  6788
  6789     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6790
  6791     IF PB-C-PAYEE-CODE GREATER SPACES
  6792        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6793
  6794     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6795*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6796
  6797     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6798     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6799
  6800     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6801         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6802     ELSE
  6803         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6804
  6805     IF MAINTI = 'A' OR 'C'
  6806       IF PB-C-REFUND-CREATED
  6807           MOVE -1               TO  MAINTL
  6808           MOVE ER-3445          TO  EMI-ERROR
  6809           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6810
  6811 1590-EXIT.
  6812      EXIT.
  6813
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 121
* EL677.cbl
  6815 2000-ADD-RECORD.
  6816
  6817* EXEC CICS GETMAIN
  6818*        SET      (ADDRESS OF CHECK-RECORDS)
  6819*        LENGTH   (600)
  6820*        INITIMG  (GETMAIN-SPACE)
  6821*    END-EXEC.
  6822     MOVE 600
  6823       TO DFHEIV11
  6824*    MOVE ',"IL                  $   #00006519' TO DFHEIV0
  6825     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6826     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6827     MOVE X'2020233030303036353139' TO DFHEIV0(25:11)
  6828     CALL 'kxdfhei1' USING DFHEIV0,
  6829           DFHEIV20,
  6830           DFHEIV11,
  6831           GETMAIN-SPACE
  6832     SET ADDRESS OF CHECK-RECORDS TO
  6833         DFHEIV20
  6834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6835
  6836
  6837     MOVE 'CH'                   TO CH-RECORD-ID.
  6838     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6839     MOVE CARRIERI               TO CH-CARRIER.
  6840     MOVE GROUPI                 TO CH-GROUPING.
  6841     MOVE STATEI                 TO CH-STATE.
  6842     MOVE ACCTI                  TO CH-ACCOUNT.
  6843
  6844     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6845     MOVE '2'                    TO DC-OPTION-CODE.
  6846     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6847     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6848
  6849     MOVE CERTNOI                TO CH-CERT-PRIME.
  6850     MOVE SFXI                   TO CH-CERT-SFX.
  6851
  6852     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6853
  6854     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6855                                    ch-released-by
  6856     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6857
  6858     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6859     MOVE '5'                    TO DC-OPTION-CODE.
  6860     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6861     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6862                                    ch-released-dt
  6863
  6864     move 'P'                    to ch-approval-status
  6865
  6866     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6867                                    CH-VOID-DT
  6868                                    CH-CREDIT-ACCEPT-DT
  6869                                    CH-CANC-DT
  6870                                    ch-approval-dt
  6871                                    ch-check-cashed-dt
  6872     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 122
* EL677.cbl
  6873                                    CH-AH-REFUND
  6874*                                   CH-DEDUCT-WITHHELD
  6875*                                   CH-ADDITIONAL-CHARGE.
  6876
  6877     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  6878
  6879     if pi-prev-paid not numeric
  6880        move zeros               to pi-prev-paid
  6881     end-if
  6882     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6883       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6884        EIBAID NOT = DFHPF4)
  6885         GO TO 8200-SEND-DATAONLY.
  6886
  6887     add ch-amount-paid to pi-prev-paid
  6888     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  6889     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  6890     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  6891     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  6892     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  6893     move pi-am-csr              to ch-csr
  6894     .
  6895 2100-WRITE-RECORD.
  6896
  6897* exec cics read
  6898*       dataset    (erchek-file-id)
  6899*       into       (ws-dummy-erchek)
  6900*       ridfld     (ch-control-primary)
  6901*       resp       (ws-response)
  6902*    end-exec
  6903     MOVE LENGTH OF
  6904      ws-dummy-erchek
  6905       TO DFHEIV11
  6906*    MOVE '&"IL       E          (  N#00006584' TO DFHEIV0
  6907     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6908     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6909     MOVE X'204E233030303036353834' TO DFHEIV0(25:11)
  6910     CALL 'kxdfhei1' USING DFHEIV0,
  6911           erchek-file-id,
  6912           ws-dummy-erchek,
  6913           DFHEIV11,
  6914           ch-control-primary,
  6915           DFHEIV99,
  6916           DFHEIV99,
  6917           DFHEIV99
  6918     MOVE EIBRESP  TO ws-response
  6919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6920     if RESP-NOTFND
  6921        continue
  6922     else
  6923        add +1 to ch-sequence-no
  6924        add 1 to seqi
  6925        go to 2100-write-record
  6926     end-if
  6927     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
  6928
  6929* EXEC CICS HANDLE CONDITION
  6930*        DUPREC (2200-DUPREC)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 123
* EL677.cbl
  6931*    END-EXEC.
  6932*    MOVE '"$%                   ! ( #00006598' TO DFHEIV0
  6933     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6935     MOVE X'2820233030303036353938' TO DFHEIV0(25:11)
  6936     CALL 'kxdfhei1' USING DFHEIV0
  6937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6938
  6939
  6940     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  6941     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  6942                                    CH-CHECK-QUE-SEQUENCE
  6943
  6944
  6945* EXEC CICS WRITE
  6946*        DATASET  (ERCHEK-FILE-ID)
  6947*        FROM     (CHECK-RECORDS)
  6948*        RIDFLD   (CH-CONTROL-PRIMARY)
  6949*    END-EXEC.
  6950     MOVE LENGTH OF
  6951      CHECK-RECORDS
  6952       TO DFHEIV11
  6953*    MOVE '&$ L                  ''   #00006606' TO DFHEIV0
  6954     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6955     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6956     MOVE X'2020233030303036363036' TO DFHEIV0(25:11)
  6957     CALL 'kxdfhei1' USING DFHEIV0,
  6958           ERCHEK-FILE-ID,
  6959           CHECK-RECORDS,
  6960           DFHEIV11,
  6961           CH-CONTROL-PRIMARY,
  6962           DFHEIV99,
  6963           DFHEIV99
  6964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6965
  6966
  6967     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  6968             ERCHEK-RECORD-LENGTH + 23.
  6969
  6970     PERFORM 6200-UPDATE-PENDING-BUS-REC THRU 6200-EXIT.
  6971     if resp-normal
  6972        MOVE 'Y'                 TO PB-C-REFUND-SW
  6973        add +1 to pi-chek-rec-cnt
  6974        perform 6210-rewrite-pndb thru 6210-exit
  6975*       PERFORM 2700-WRITE-SQL   THRU 2700-EXIT
  6976     end-if
  6977*    PERFORM 2500-WRITE-PAY-ADJ  THRU  2590-EXIT.
  6978
  6979     IF EMI-NO-ERRORS
  6980         MOVE ER-0000            TO EMI-ERROR
  6981     ELSE
  6982         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  6983            EIBAID = DFHPF4
  6984             MOVE ER-2600        TO EMI-ERROR.
  6985
  6986     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6987
  6988     MOVE LOW-VALUES             TO EL677AI.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 124
* EL677.cbl
  6989
  6990     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  6991     MOVE PI-CHEK-GROUPING       TO GROUPO.
  6992     MOVE PI-CHEK-STATE          TO STATEO.
  6993     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  6994
  6995     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  6996     MOVE SPACE                  TO DC-OPTION-CODE.
  6997     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6998     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  6999
  7000     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7001     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7002     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7003
  7004     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7005                                    ACCTA     EFFDTA  CERTNOA
  7006                                    SFXA.
  7007     MOVE AL-UNNON               TO SEQA.
  7008     go to 5000-browse-file
  7009     GO TO 8100-SEND-INITIAL-MAP.
  7010
  7011 2200-DUPREC.
  7012     ADD +1 TO CH-SEQUENCE-NO.
  7013     MOVE CH-SEQUENCE-NO         TO SEQO
  7014                                    PI-CHEK-SEQUENCE
  7015                                    CHEK-RECORD-SEQ.
  7016     GO TO 2100-WRITE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 125
* EL677.cbl
  7018
  7019 2500-WRITE-PAY-ADJ.
  7020
  7021     PERFORM 2600-READ-CONTROL-FILE THRU 2600-EXIT.
  7022
  7023     IF CH-AMOUNT-PAID = ZEROS
  7024         GO TO 2510-CONTINUE.
  7025     PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT.
  7026     PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.
  7027
  7028 2510-CONTINUE.
  7029
  7030     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  7031         GO TO 2580-HANDLE-ELCNTL-FILE.
  7032
  7033 2550-BUILD-ERPYAJ-RECORD.
  7034
  7035
  7036* EXEC CICS GETMAIN
  7037*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7038*        LENGTH  (200)
  7039*        INITIMG (GETMAIN-SPACE)
  7040*    END-EXEC.
  7041     MOVE 200
  7042       TO DFHEIV11
  7043*    MOVE ',"IL                  $   #00006680' TO DFHEIV0
  7044     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7045     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7046     MOVE X'2020233030303036363830' TO DFHEIV0(25:11)
  7047     CALL 'kxdfhei1' USING DFHEIV0,
  7048           DFHEIV20,
  7049           DFHEIV11,
  7050           GETMAIN-SPACE
  7051     SET ADDRESS OF PENDING-PAY-ADJ TO
  7052         DFHEIV20
  7053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7054
  7055
  7056     MOVE SPACES                 TO PENDING-PAY-ADJ.
  7057     MOVE 'PY'                   TO PY-RECORD-ID.
  7058     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7059
  7060     MOVE CARRIERI               TO PY-CARRIER.
  7061     IF PI-ZERO-CARRIER  OR
  7062        PI-ZERO-CAR-GROUP
  7063         MOVE ZERO               TO PY-CARRIER.
  7064
  7065     MOVE GROUPI                 TO PY-GROUPING.
  7066     IF PI-ZERO-GROUPING  OR
  7067        PI-ZERO-CAR-GROUP
  7068         MOVE ZERO               TO PY-GROUPING.
  7069
  7070     MOVE PI-CR-FIN-RESP         TO PY-FIN-RESP.
  7071     MOVE PI-CR-ACCOUNT          TO PY-ACCOUNT.
  7072     MOVE 'C'                    TO PY-RECORD-TYPE.
  7073     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7074
  7075     MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-CURRENT-DATE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 126
* EL677.cbl
  7076                                    WS-PY-REF-DATE
  7077                                    WS-PY-END-DATE
  7078                                    WS-PY-DED-DATE
  7079                                    WS-PY-ADDL-DATE.
  7080     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7081     MOVE CERTNOI                TO WS-PY-CURRENT-CERT
  7082                                    WS-PY-REF-CERT
  7083                                    WS-PY-END-CERT
  7084                                    WS-PY-DED-CERT
  7085                                    WS-PY-ADDL-CERT
  7086                                    WS-TMS-PY-CERT.
  7087     IF SFXI NOT = LOW-VALUES
  7088         MOVE SFXI               TO WS-PY-CURRENT-SUFFIX
  7089                                    WS-PY-REF-SUFFIX
  7090                                    WS-PY-END-SUFFIX
  7091                                    WS-PY-DED-SUFFIX
  7092                                    WS-PY-ADDL-SUFFIX
  7093     ELSE
  7094         MOVE SPACE              TO WS-PY-CURRENT-SUFFIX
  7095                                    WS-PY-REF-SUFFIX
  7096                                    WS-PY-END-SUFFIX
  7097                                    WS-PY-DED-SUFFIX
  7098                                    WS-PY-ADDL-SUFFIX.
  7099
  7100     IF PI-COMPANY-ID EQUAL 'TMS' OR 'LGX'
  7101         MOVE WS-TMS-ENTRY-COMMENT
  7102                                 TO PY-ENTRY-COMMENT
  7103     ELSE
  7104         IF TYPEI EQUAL 'R'
  7105             MOVE WS-PY-REF-COMMENT
  7106                                 TO PY-ENTRY-COMMENT
  7107         ELSE
  7108             IF TYPEI EQUAL 'E'
  7109                 MOVE WS-PY-END-COMMENT
  7110                                 TO PY-ENTRY-COMMENT
  7111             ELSE
  7112                 MOVE WS-PY-ENTRY-COMMENT
  7113                                 TO PY-ENTRY-COMMENT.
  7114
  7115     MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT.
  7116
  7117     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7118     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7119     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7120                                    PY-INPUT-DT.
  7121*    MOVE +0                     TO PY-CHECK-QUE-CONTROL
  7122*                                   PY-CHECK-QUE-SEQUENCE.
  7123     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7124                                    PY-REPORTED-DT
  7125                                    PY-CHECK-WRITTEN-DT
  7126                                    PY-BILLED-DATE
  7127                                    PY-AR-DATE
  7128                                    PY-GL-DATE.
  7129     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7130     MOVE TYPEI                  TO PY-CHECK-ORIGIN-SW.
  7131*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7132
  7133     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 127
* EL677.cbl
  7134         MOVE 'B'                TO PY-PYMT-TYPE
  7135         MOVE 'A'                TO PY-PMT-APPLIED.
  7136
  7137 2559-BUILD-EXIT.
  7138     EXIT.
  7139
  7140 2570-WRITE-ERPYAJ-RECORD.
  7141
  7142
  7143* EXEC CICS HANDLE CONDITION
  7144*        DUPREC (2577-DUPREC)
  7145*    END-EXEC.
  7146*    MOVE '"$%                   ! ) #00006772' TO DFHEIV0
  7147     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7148     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7149     MOVE X'2920233030303036373732' TO DFHEIV0(25:11)
  7150     CALL 'kxdfhei1' USING DFHEIV0
  7151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7152
  7153
  7154
  7155* EXEC CICS WRITE
  7156*        DATASET (ERPYAJ-FILE-ID)
  7157*        FROM    (PENDING-PAY-ADJ)
  7158*        RIDFLD  (PY-CONTROL-PRIMARY)
  7159*    END-EXEC.
  7160     MOVE LENGTH OF
  7161      PENDING-PAY-ADJ
  7162       TO DFHEIV11
  7163*    MOVE '&$ L                  ''   #00006776' TO DFHEIV0
  7164     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7165     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7166     MOVE X'2020233030303036373736' TO DFHEIV0(25:11)
  7167     CALL 'kxdfhei1' USING DFHEIV0,
  7168           ERPYAJ-FILE-ID,
  7169           PENDING-PAY-ADJ,
  7170           DFHEIV11,
  7171           PY-CONTROL-PRIMARY,
  7172           DFHEIV99,
  7173           DFHEIV99
  7174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7175
  7176
  7177     GO TO 2579-WRITE-EXIT.
  7178
  7179 2577-DUPREC.
  7180     ADD +1 TO PY-FILE-SEQ-NO.
  7181
  7182     GO TO 2570-WRITE-ERPYAJ-RECORD.
  7183
  7184 2579-WRITE-EXIT.
  7185     EXIT.
  7186
  7187 2580-HANDLE-ELCNTL-FILE.
  7188
  7189     IF CR-CHECK-NO-AUTO-SEQ
  7190         PERFORM 2650-REWRITE-CONTROL-FILE THRU 2650-EXIT
  7191     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 128
* EL677.cbl
  7192
  7193* EXEC CICS UNLOCK
  7194*            DATASET (ELCNTL-FILE-ID)
  7195*        END-EXEC.
  7196*    MOVE '&*                    #   #00006797' TO DFHEIV0
  7197     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7198     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7199     MOVE X'2020233030303036373937' TO DFHEIV0(25:11)
  7200     CALL 'kxdfhei1' USING DFHEIV0,
  7201           ELCNTL-FILE-ID,
  7202           DFHEIV99
  7203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7204
  7205
  7206 2590-EXIT.
  7207      EXIT.
  7208
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 129
* EL677.cbl
  7210
  7211 2600-READ-CONTROL-FILE.
  7212     MOVE SPACES                 TO ELCNTL-KEY.
  7213     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  7214     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7215     MOVE +0                     TO ELCNTL-SEQ.
  7216
  7217
  7218* EXEC CICS HANDLE CONDITION
  7219*        NOTFND   (2600-NO-CO-MASTER)
  7220*    END-EXEC.
  7221*    MOVE '"$I                   ! * #00006812' TO DFHEIV0
  7222     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7224     MOVE X'2A20233030303036383132' TO DFHEIV0(25:11)
  7225     CALL 'kxdfhei1' USING DFHEIV0
  7226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7227
  7228
  7229
  7230* EXEC CICS READ
  7231*        DATASET   (ELCNTL-FILE-ID)
  7232*        SET       (ADDRESS OF CONTROL-FILE)
  7233*        RIDFLD    (ELCNTL-KEY)
  7234*    END-EXEC.
  7235*    MOVE '&"S        E          (   #00006816' TO DFHEIV0
  7236     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7237     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7238     MOVE X'2020233030303036383136' TO DFHEIV0(25:11)
  7239     CALL 'kxdfhei1' USING DFHEIV0,
  7240           ELCNTL-FILE-ID,
  7241           DFHEIV20,
  7242           DFHEIV99,
  7243           ELCNTL-KEY,
  7244           DFHEIV99,
  7245           DFHEIV99,
  7246           DFHEIV99
  7247     SET ADDRESS OF CONTROL-FILE TO
  7248         DFHEIV20
  7249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7250
  7251
  7252     GO TO 2600-EXIT
  7253
  7254     .
  7255 2600-NO-CO-MASTER.
  7256     MOVE ER-0022                TO  EMI-ERROR.
  7257     MOVE -1                     TO  CARRIERL.
  7258     MOVE AL-UABON               TO  CARRIERA.
  7259     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7260
  7261 2600-EXIT.
  7262      EXIT.
  7263
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 130
* EL677.cbl
  7265 2650-REWRITE-CONTROL-FILE.
  7266
  7267* EXEC CICS READ
  7268*        DATASET   (ELCNTL-FILE-ID)
  7269*        SET       (ADDRESS OF CONTROL-FILE)
  7270*        RIDFLD    (ELCNTL-KEY)
  7271*        UPDATE
  7272*    END-EXEC.
  7273*    MOVE '&"S        EU         (   #00006836' TO DFHEIV0
  7274     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7275     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7276     MOVE X'2020233030303036383336' TO DFHEIV0(25:11)
  7277     CALL 'kxdfhei1' USING DFHEIV0,
  7278           ELCNTL-FILE-ID,
  7279           DFHEIV20,
  7280           DFHEIV99,
  7281           ELCNTL-KEY,
  7282           DFHEIV99,
  7283           DFHEIV99,
  7284           DFHEIV99
  7285     SET ADDRESS OF CONTROL-FILE TO
  7286         DFHEIV20
  7287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7288
  7289
  7290
  7291* EXEC CICS REWRITE
  7292*         DATASET (ELCNTL-FILE-ID)
  7293*         FROM    (CONTROL-FILE)
  7294*     END-EXEC.
  7295     MOVE LENGTH OF
  7296      CONTROL-FILE
  7297       TO DFHEIV11
  7298*    MOVE '&& L                  %   #00006843' TO DFHEIV0
  7299     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7300     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7301     MOVE X'2020233030303036383433' TO DFHEIV0(25:11)
  7302     CALL 'kxdfhei1' USING DFHEIV0,
  7303           ELCNTL-FILE-ID,
  7304           CONTROL-FILE,
  7305           DFHEIV11,
  7306           DFHEIV99
  7307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7308
  7309
  7310 2650-EXIT.
  7311      EXIT.
  7312 2700-WRITE-SQL.
  7313     perform 2710-build-rec      thru 2710-exit
  7314     perform 2720-insert-row     thru 2720-exit
  7315     perform 4300-FINISH-UP-DB   thru 4300-exit
  7316     .
  7317 2700-EXIT.
  7318     EXIT.
  7319 2710-BUILD-REC.
  7320     move spaces                 to daily-check-request-rec
  7321     move pi-company-id          to db-compid
  7322     move ch-carrier             to db-carrier
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 131
* EL677.cbl
  7323                                    db-fincar
  7324     move ch-grouping            to db-grouping
  7325                                    db-fingrp
  7326     move ch-state               to db-state
  7327     move ch-account             to db-account
  7328     move ch-cert-eff-dt         to dc-bin-date-1
  7329     move ' '                    to dc-option-code
  7330     perform 8500-date-convert   thru 8500-exit
  7331     if no-conversion-error
  7332        move dc-greg-date-a-edit to db-effdate
  7333     else
  7334        move spaces              to db-effdate
  7335     end-if
  7336     move ch-cert-prime          to db-certificate
  7337     move ch-cert-sfx            to db-cert-sfx
  7338     move ch-sequence-no         to db-seq-no
  7339     move '1'                    to db-type
  7340     move ch-amount-paid         to db-amount-n
  7341     move zeros                  to db-checkstatus
  7342     move ch-check-que-control   to db-releasebatch
  7343     move save-bin-date          to dc-bin-date-1
  7344     move ' '                    to dc-option-code
  7345     perform 8500-date-convert   thru 8500-exit
  7346     if no-conversion-error
  7347        move dc-greg-date-a-edit to db-releasedt
  7348     else
  7349        move spaces              to db-releasedt
  7350     end-if
  7351     move pi-processor-id        to db-releaseby
  7352     move ch-payee-name-1        to db-payeename1
  7353     move ch-payee-name-2        to db-payeename2
  7354     move ch-payee-address-1     to db-payeeaddr1
  7355     move ch-payee-address-2     to db-payeeaddr2
  7356     move ch-payee-city          to db-payeecity
  7357     move ch-payee-state         to db-payeest
  7358     move ch-payee-zip-code      to db-payeezip
  7359     move ch-comp-fin-resp       to db-finresp
  7360     move ch-comp-account        to db-finacct
  7361     move ch-recorded-by         to db-preparer
  7362     move ch-return-to           to db-return-to
  7363     move pi-table-name          to db-insured-name
  7364     .
  7365 2710-EXIT.
  7366     EXIT.
  7367 2720-INSERT-ROW.
  7368     if not connected-to-db
  7369        perform 4100-CONNECT-TO-DB
  7370                                 thru 4100-exit
  7371     end-if
  7372     EXEC SQL
  7373        INSERT into ChkApp_Check (
  7374           Company,
  7375           CertCarrier,
  7376           CertGroup,
  7377           CertState,
  7378           CertAccount,
  7379           CertEffDate,
  7380           CertNumber,
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 132
* EL677.cbl
  7381           CertNumberSuf,
  7382           CheckSeqNbr,
  7383           CheckType,
  7384           CheckAmount,
  7385           ReleaseBatchNbr,
  7386           ReleaseDate,
  7387           ReleasedBy,
  7388           PayeeName1,
  7389           PayeeName2,
  7390           PayeeAddress1,
  7391           PayeeAddress2,
  7392           PayeeCity,
  7393           PayeeState,
  7394           PayeeZip,
  7395           CompCarrier,
  7396           CompGroup,
  7397           CompFinResp,
  7398           CompAccount,
  7399           Preparer,
  7400           ReturnTo,
  7401           InsuredName)
  7402         VALUES (
  7403           :DB-CompId,
  7404           :DB-Carrier,
  7405           :DB-Grouping,
  7406           :DB-State,
  7407           :DB-Account,
  7408           :DB-EffDate,
  7409           :DB-Certificate,
  7410           :db-cert-sfx,
  7411           :DB-Seq-No,
  7412           :DB-Type,
  7413           :db-amount,
  7414           :db-releasebatch,
  7415           :db-releasedt,
  7416           :db-releaseby,
  7417           :db-payeename1,
  7418           :db-payeename2,
  7419           :db-payeeaddr1,
  7420           :db-payeeaddr2,
  7421           :db-payeecity,
  7422           :db-payeest,
  7423           :db-payeezip,
  7424           :db-fincar,
  7425           :db-fingrp,
  7426           :db-finresp,
  7427           :db-finacct,
  7428           :db-preparer,
  7429           :db-return-to,
  7430           :db-insured-name)
  7431     END-EXEC
  7432     if sqlcode = -2601
  7433        add +1                   to ch-sequence-no
  7434        move ch-sequence-no      to DB-Seq-No
  7435        go to 2720-insert-row
  7436     end-if
  7437     if sqlcode not = 0
  7438        display "Error: cannot insert row "
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 133
* EL677.cbl
  7439        display ' sql return code ' sqlcode
  7440        move sqlcode to ws-sql-code
  7441        move ws-sql-code to ws-dis-sql-code
  7442        display ' dis sql code ' ws-dis-sql-code
  7443        display ' sql err mess    ' sqlerrmc
  7444        move sqlcode to ws-sql-code
  7445        move ws-sql-code to ws-dis-sql-code
  7446        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7447           into EMI-MESSAGE-AREA (1)
  7448        end-string
  7449        display ' msga1 ' emi-message-area (1)
  7450        perform 4300-FINISH-UP-DB thru 4300-exit
  7451        go to 8200-send-dataonly
  7452*       goback
  7453     end-if
  7454     .
  7455 2720-EXIT.
  7456     EXIT.
  7457 3000-CHANGE-RECORD.
  7458
  7459* EXEC CICS HANDLE CONDITION
  7460*        NOTFND (3900-RECORD-NOTFND)
  7461*    END-EXEC.
  7462*    MOVE '"$I                   ! + #00006996' TO DFHEIV0
  7463     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7465     MOVE X'2B20233030303036393936' TO DFHEIV0(25:11)
  7466     CALL 'kxdfhei1' USING DFHEIV0
  7467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7468
  7469
  7470
  7471* EXEC CICS READ
  7472*        DATASET  (ERCHEK-FILE-ID)
  7473*        SET      (ADDRESS OF CHECK-RECORDS)
  7474*        RIDFLD   (PI-ERCHEK-KEY)
  7475*        UPDATE
  7476*    END-EXEC.
  7477*    MOVE '&"S        EU         (   #00007000' TO DFHEIV0
  7478     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7479     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7480     MOVE X'2020233030303037303030' TO DFHEIV0(25:11)
  7481     CALL 'kxdfhei1' USING DFHEIV0,
  7482           ERCHEK-FILE-ID,
  7483           DFHEIV20,
  7484           DFHEIV99,
  7485           PI-ERCHEK-KEY,
  7486           DFHEIV99,
  7487           DFHEIV99,
  7488           DFHEIV99
  7489     SET ADDRESS OF CHECK-RECORDS TO
  7490         DFHEIV20
  7491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7492
  7493
  7494     IF CH-LF-REFUND NOT NUMERIC
  7495         MOVE ZEROS              TO CH-LF-REFUND.
  7496     IF CH-AH-REFUND NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 134
* EL677.cbl
  7497         MOVE ZEROS              TO CH-AH-REFUND.
  7498*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7499*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7500*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7501*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7502
  7503     IF VREASONL NOT = ZEROS
  7504         MOVE VREASONI           TO  CH-VOID-REASON.
  7505
  7506     IF MAINTI = 'V'
  7507        GO TO 3050-void-processing
  7508     end-if
  7509
  7510     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7511
  7512     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7513
  7514     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7515       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7516        EIBAID NOT = DFHPF4)
  7517         GO TO 8200-SEND-DATAONLY.
  7518     go to 3100-rewrite-record
  7519     .
  7520 3050-void-processing.
  7521     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7522     if sqlcode = 0
  7523        perform 4200-get-tbl-row thru 4200-exit
  7524        if sqlcode = 0
  7525           if nu-app-date = -1
  7526              move -1            to maintl
  7527              move er-3453       to emi-error
  7528              move al-uabon      to mainta
  7529              perform 9900-error-format
  7530                                 thru 9900-exit
  7531              perform 4300-FINISH-UP-DB thru 4300-exit
  7532              go to 8200-send-dataonly
  7533           end-if
  7534        end-if
  7535        if connected-to-db
  7536           perform 4300-FINISH-UP-DB thru 4300-exit
  7537        end-if
  7538     end-if
  7539     if (ch-check-written-dt = low-values)
  7540        or (ch-check-no = spaces)
  7541        move -1                  to maintl
  7542        move er-3455             to emi-error
  7543        move al-uabon            to mainta
  7544        perform 9900-error-format
  7545                                 thru 9900-exit
  7546        perform 4300-FINISH-UP-DB thru 4300-exit
  7547        go to 8200-send-dataonly
  7548     .
  7549 3100-REWRITE-RECORD.
  7550     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7551
  7552     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7553     MOVE '5'                    TO DC-OPTION-CODE.
  7554     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 135
* EL677.cbl
  7555
  7556     IF MAINTI = 'C'
  7557       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7558     end-if
  7559*      IF MANUAL-CHECK-WRITTEN
  7560*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT.
  7561
  7562     IF MAINTI = 'V'
  7563        IF CH-VOID-DT = LOW-VALUES
  7564           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7565           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7566*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT
  7567           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7568           if pi-chek-rec-cnt = +1
  7569              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7570                                 THRU 6200-EXIT
  7571              if resp-normal
  7572                 MOVE ' '        TO PB-C-REFUND-SW
  7573                 perform 6210-rewrite-pndb
  7574                                 thru 6210-exit
  7575              end-if
  7576           end-if
  7577        ELSE
  7578           MOVE -1               TO MAINTL
  7579           MOVE ER-2583          TO EMI-ERROR
  7580           MOVE AL-UABON         TO MAINTA
  7581           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7582           GO TO 8200-SEND-DATAONLY
  7583        end-if
  7584     end-if
  7585
  7586     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7587
  7588
  7589* EXEC CICS REWRITE
  7590*        DATASET  (ERCHEK-FILE-ID)
  7591*        FROM     (CHECK-RECORDS)
  7592*    END-EXEC.
  7593     MOVE LENGTH OF
  7594      CHECK-RECORDS
  7595       TO DFHEIV11
  7596*    MOVE '&& L                  %   #00007101' TO DFHEIV0
  7597     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7598     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7599     MOVE X'2020233030303037313031' TO DFHEIV0(25:11)
  7600     CALL 'kxdfhei1' USING DFHEIV0,
  7601           ERCHEK-FILE-ID,
  7602           CHECK-RECORDS,
  7603           DFHEIV11,
  7604           DFHEIV99
  7605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7606
  7607
  7608     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7609        (MAINTI EQUAL 'C')          AND
  7610        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7611            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7612
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 136
* EL677.cbl
  7613     IF EMI-NO-ERRORS
  7614         MOVE ER-0000            TO EMI-ERROR
  7615     ELSE
  7616         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7617            EIBAID = DFHPF4
  7618             MOVE ER-2600        TO EMI-ERROR.
  7619
  7620     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7621
  7622     MOVE LOW-VALUES             TO EL677AI.
  7623
  7624     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7625     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7626     MOVE PI-CHEK-STATE          TO STATEO.
  7627     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7628
  7629     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7630     MOVE SPACE                  TO DC-OPTION-CODE.
  7631     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7632     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7633
  7634     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7635     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7636     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7637
  7638     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7639                                     ACCTA   EFFDTA
  7640                                    CERTNOA   SFXA.
  7641
  7642     MOVE AL-UNNON               TO SEQA.
  7643     go to 5000-browse-file
  7644*    GO TO 8100-SEND-INITIAL-MAP.
  7645
  7646     .
  7647 3200-PAY-ADJS-REVERSAL.
  7648
  7649     IF CH-AMOUNT-PAID NOT = ZEROS
  7650         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7651         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7652
  7653     GO TO 3290-EXIT
  7654     .
  7655 3250-BUILD-ERPYAJ-REVERSAL.
  7656
  7657
  7658* EXEC CICS GETMAIN
  7659*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7660*        LENGTH  (200)
  7661*        INITIMG (GETMAIN-SPACE)
  7662*    END-EXEC.
  7663     MOVE 200
  7664       TO DFHEIV11
  7665*    MOVE ',"IL                  $   #00007155' TO DFHEIV0
  7666     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7667     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7668     MOVE X'2020233030303037313535' TO DFHEIV0(25:11)
  7669     CALL 'kxdfhei1' USING DFHEIV0,
  7670           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 137
* EL677.cbl
  7671           DFHEIV11,
  7672           GETMAIN-SPACE
  7673     SET ADDRESS OF PENDING-PAY-ADJ TO
  7674         DFHEIV20
  7675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7676
  7677
  7678     MOVE 'PY'                   TO PY-RECORD-ID.
  7679     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7680
  7681     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7682     IF PI-ZERO-CARRIER  OR
  7683        PI-ZERO-CAR-GROUP
  7684         MOVE ZERO               TO PY-CARRIER.
  7685
  7686     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7687     IF PI-ZERO-GROUPING  OR
  7688        PI-ZERO-CAR-GROUP
  7689         MOVE ZERO               TO PY-GROUPING.
  7690
  7691     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7692     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7693     MOVE 'C'                    TO PY-RECORD-TYPE.
  7694     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7695     move '1825011300'           to py-gl-account
  7696     move 'VOID REFCK'           TO py-gl-comment
  7697     COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7698
  7699     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7700     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7701
  7702     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7703     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7704     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7705                                    PY-INPUT-DT.
  7706*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7707*                                   PY-CHECK-QUE-SEQUENCE.
  7708     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7709                                    PY-BILLED-DATE
  7710                                    PY-REPORTED-DT
  7711                                    PY-CHECK-WRITTEN-DT
  7712                                    PY-AR-DATE
  7713                                    PY-GL-DATE.
  7714     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7715     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7716     MOVE 'V'                    TO PY-VOID-SW.
  7717*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7718
  7719     IF PI-AR-PROCESSING
  7720         MOVE 'B'                TO PY-PYMT-TYPE
  7721         MOVE 'A'                TO PY-PMT-APPLIED.
  7722
  7723 3259-BUILD-EXIT.
  7724     EXIT.
  7725
  7726 3280-WRITE-ERPYAJ-REVERSAL.
  7727
  7728
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 138
* EL677.cbl
  7729* EXEC CICS HANDLE CONDITION
  7730*        DUPREC (3287-DUPREC)
  7731*    END-EXEC.
  7732*    MOVE '"$%                   ! , #00007211' TO DFHEIV0
  7733     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7734     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7735     MOVE X'2C20233030303037323131' TO DFHEIV0(25:11)
  7736     CALL 'kxdfhei1' USING DFHEIV0
  7737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7738
  7739
  7740
  7741* EXEC CICS WRITE
  7742*        DATASET (ERPYAJ-FILE-ID)
  7743*        FROM    (PENDING-PAY-ADJ)
  7744*        RIDFLD  (PY-CONTROL-PRIMARY)
  7745*    END-EXEC.
  7746     MOVE LENGTH OF
  7747      PENDING-PAY-ADJ
  7748       TO DFHEIV11
  7749*    MOVE '&$ L                  ''   #00007215' TO DFHEIV0
  7750     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7751     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7752     MOVE X'2020233030303037323135' TO DFHEIV0(25:11)
  7753     CALL 'kxdfhei1' USING DFHEIV0,
  7754           ERPYAJ-FILE-ID,
  7755           PENDING-PAY-ADJ,
  7756           DFHEIV11,
  7757           PY-CONTROL-PRIMARY,
  7758           DFHEIV99,
  7759           DFHEIV99
  7760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7761
  7762
  7763     GO TO 3289-WRITE-EXIT.
  7764
  7765 3287-DUPREC.
  7766     ADD +1 TO PY-FILE-SEQ-NO.
  7767
  7768     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7769
  7770 3289-WRITE-EXIT.
  7771     EXIT.
  7772
  7773 3290-EXIT.
  7774      EXIT.
  7775
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 139
* EL677.cbl
  7777 3300-UPDATE-ERPYAJ.
  7778
  7779
  7780* EXEC CICS GETMAIN
  7781*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7782*        LENGTH  (200)
  7783*        INITIMG (GETMAIN-SPACE)
  7784*    END-EXEC.
  7785     MOVE 200
  7786       TO DFHEIV11
  7787*    MOVE ',"IL                  $   #00007237' TO DFHEIV0
  7788     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7789     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7790     MOVE X'2020233030303037323337' TO DFHEIV0(25:11)
  7791     CALL 'kxdfhei1' USING DFHEIV0,
  7792           DFHEIV20,
  7793           DFHEIV11,
  7794           GETMAIN-SPACE
  7795     SET ADDRESS OF PENDING-PAY-ADJ TO
  7796         DFHEIV20
  7797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7798
  7799
  7800     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7801     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7802     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7803     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7804     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7805     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7806     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7807
  7808
  7809* EXEC CICS HANDLE CONDITION
  7810*        NOTFND   (3390-EXIT)
  7811*        ENDFILE  (3390-EXIT)
  7812*    END-EXEC.
  7813*    MOVE '"$I''                  ! - #00007251' TO DFHEIV0
  7814     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7816     MOVE X'2D20233030303037323531' TO DFHEIV0(25:11)
  7817     CALL 'kxdfhei1' USING DFHEIV0
  7818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7819
  7820
  7821 3320-READNEXT-ERPYAJ.
  7822
  7823
  7824* EXEC CICS READ
  7825*        DATASET  (ERPYAJ-FILE-ID)
  7826*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7827*        RIDFLD   (ERPYAJ-KEY)
  7828*        GTEQ
  7829*    END-EXEC.
  7830*    MOVE '&"S        G          (   #00007258' TO DFHEIV0
  7831     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7832     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7833     MOVE X'2020233030303037323538' TO DFHEIV0(25:11)
  7834     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 140
* EL677.cbl
  7835           ERPYAJ-FILE-ID,
  7836           DFHEIV20,
  7837           DFHEIV99,
  7838           ERPYAJ-KEY,
  7839           DFHEIV99,
  7840           DFHEIV99,
  7841           DFHEIV99
  7842     SET ADDRESS OF PENDING-PAY-ADJ TO
  7843         DFHEIV20
  7844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7845
  7846
  7847     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7848
  7849     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7850        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7851        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7852        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7853        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7854        (PY-RECORD-TYPE   NOT = 'C')
  7855          GO TO 3390-EXIT.
  7856
  7857     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7858         ADD +1 TO PYAJ-FILE-SEQ-NO
  7859         GO TO 3320-READNEXT-ERPYAJ.
  7860
  7861
  7862* EXEC CICS READ UPDATE
  7863*        DATASET   (ERPYAJ-FILE-ID)
  7864*        RIDFLD    (ERPYAJ-KEY)
  7865*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7866*    END-EXEC.
  7867*    MOVE '&"S        EU         (   #00007279' TO DFHEIV0
  7868     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7869     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7870     MOVE X'2020233030303037323739' TO DFHEIV0(25:11)
  7871     CALL 'kxdfhei1' USING DFHEIV0,
  7872           ERPYAJ-FILE-ID,
  7873           DFHEIV20,
  7874           DFHEIV99,
  7875           ERPYAJ-KEY,
  7876           DFHEIV99,
  7877           DFHEIV99,
  7878           DFHEIV99
  7879     SET ADDRESS OF PENDING-PAY-ADJ TO
  7880         DFHEIV20
  7881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7882
  7883
  7884     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7885     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  7886
  7887     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  7888
  7889     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7890     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7891     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7892
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 141
* EL677.cbl
  7893
  7894* EXEC CICS REWRITE
  7895*        DATASET  (ERPYAJ-FILE-ID)
  7896*        FROM     (PENDING-PAY-ADJ)
  7897*    END-EXEC.
  7898     MOVE LENGTH OF
  7899      PENDING-PAY-ADJ
  7900       TO DFHEIV11
  7901*    MOVE '&& L                  %   #00007294' TO DFHEIV0
  7902     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7903     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7904     MOVE X'2020233030303037323934' TO DFHEIV0(25:11)
  7905     CALL 'kxdfhei1' USING DFHEIV0,
  7906           ERPYAJ-FILE-ID,
  7907           PENDING-PAY-ADJ,
  7908           DFHEIV11,
  7909           DFHEIV99
  7910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7911
  7912
  7913 3390-EXIT.
  7914      EXIT.
  7915
  7916 3400-delete-record.
  7917
  7918* EXEC CICS READ
  7919*        DATASET  (ERCHEK-FILE-ID)
  7920*        SET      (ADDRESS OF CHECK-RECORDS)
  7921*        RIDFLD   (PI-ERCHEK-KEY)
  7922*        UPDATE
  7923*        resp     (ws-response)
  7924*    END-EXEC
  7925*    MOVE '&"S        EU         (  N#00007303' TO DFHEIV0
  7926     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7927     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7928     MOVE X'204E233030303037333033' TO DFHEIV0(25:11)
  7929     CALL 'kxdfhei1' USING DFHEIV0,
  7930           ERCHEK-FILE-ID,
  7931           DFHEIV20,
  7932           DFHEIV99,
  7933           PI-ERCHEK-KEY,
  7934           DFHEIV99,
  7935           DFHEIV99,
  7936           DFHEIV99
  7937     SET ADDRESS OF CHECK-RECORDS TO
  7938         DFHEIV20
  7939     MOVE EIBRESP  TO ws-response
  7940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7941     if (ch-in-limbo or ch-approv-pending)
  7942        and (ch-void-dt = low-values)
  7943        and (ch-check-written-dt = low-values)
  7944        and (ch-credit-accept-dt = low-values)
  7945        perform 3500-check-tbl   thru 3500-exit
  7946        if (row-deleted and tbl-commited)
  7947           or (emi-error = er-3450)
  7948
  7949* exec cics delete
  7950*             dataset   (erchek-file-id)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 142
* EL677.cbl
  7951*          end-exec
  7952*    MOVE '&(                    &   #00007317' TO DFHEIV0
  7953     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7954     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7955     MOVE X'2020233030303037333137' TO DFHEIV0(25:11)
  7956     CALL 'kxdfhei1' USING DFHEIV0,
  7957           erchek-file-id,
  7958           DFHEIV99,
  7959           DFHEIV99,
  7960           DFHEIV99,
  7961           DFHEIV99
  7962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7963        end-if
  7964     else
  7965        move -1               to maintl
  7966        move er-3452          to emi-error
  7967        move al-uabon         to mainta
  7968        perform 9900-error-format
  7969                                 thru 9900-exit
  7970        go to 8200-send-dataonly
  7971     end-if
  7972     if pi-chek-rec-cnt = +1
  7973        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7974                                 THRU 6200-EXIT
  7975        if resp-normal
  7976           MOVE ' '              TO PB-C-REFUND-SW
  7977           perform 6210-rewrite-pndb
  7978                                 thru 6210-exit
  7979        end-if
  7980     end-if
  7981     MOVE ER-0000            TO EMI-ERROR
  7982     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7983     MOVE LOW-VALUES             TO EL677AI.
  7984     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7985     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7986     MOVE PI-CHEK-STATE          TO STATEO.
  7987     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7988     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7989     MOVE SPACE                  TO DC-OPTION-CODE.
  7990     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7991     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7992     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7993     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7994     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7995     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7996                                    ACCTA   EFFDTA
  7997                                    CERTNOA   SFXA.
  7998     MOVE AL-UNNON               TO SEQA.
  7999     GO TO 8100-SEND-INITIAL-MAP
  8000     .
  8001 3400-exit.
  8002     exit.
  8003 3500-check-tbl.
  8004     perform 4100-CONNECT-TO-DB  thru 4100-exit
  8005*    if sqlcode = 0
  8006*       perform 4150-open-cursor    thru 4150-exit
  8007*    end-if
  8008     if sqlcode = 0
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 143
* EL677.cbl
  8009        perform 4200-get-tbl-row thru 4200-exit
  8010     end-if
  8011      if sqlcode = 0
  8012         if (nu-app-date = -1)
  8013            or (db-app-status = '2')
  8014            perform 4250-delete-row thru 4250-exit
  8015         else
  8016           MOVE ER-3452            TO  EMI-ERROR
  8017           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8018           MOVE -1                 TO  PFENTERL
  8019           GO TO 8200-SEND-DATAONLY
  8020        end-if
  8021      else
  8022         MOVE ER-3450            TO  EMI-ERROR
  8023         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8024         MOVE -1                 TO  PFENTERL
  8025*        GO TO 8200-SEND-DATAONLY
  8026      end-if
  8027     if connected-to-db
  8028        perform 4300-FINISH-UP-DB thru 4300-exit
  8029     end-if
  8030     .
  8031 3500-exit.
  8032     exit.
  8033 3700-UPDATE-ERCHKQ.
  8034*    MOVE CH-COMPANY-CD          TO CHKQ-COMPANY-CD.
  8035*    MOVE CH-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NUMBER.
  8036*    MOVE CH-CHECK-QUE-SEQUENCE  TO CHKQ-SEQUENCE-NUMBER.
  8037*
  8038*    EXEC CICS HANDLE CONDITION
  8039*        NOTFND (3780-CHECK-NOTFND)
  8040*    END-EXEC.
  8041*
  8042*    EXEC CICS READ
  8043*        DATASET  (ERCHKQ-FILE-ID)
  8044*        SET      (ADDRESS OF CHECK-QUE)
  8045*        RIDFLD   (ERCHKQ-KEY)
  8046*        UPDATE
  8047*    END-EXEC.
  8048*
  8049*    IF MAINTI = 'C'
  8050*        IF MANUAL-CHECK-WRITTEN
  8051*            MOVE 'M'                 TO CQ-ENTRY-TYPE
  8052*            MOVE +1                  TO CQ-TIMES-PRINTED
  8053*            MOVE CH-CHECK-NO         TO CQ-CHECK-NUMBER
  8054*            MOVE CH-AMOUNT-PAID      TO CQ-CHECK-AMOUNT
  8055*            MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  8056*
  8057*    IF MAINTI = 'V'
  8058*        MOVE 'V'                TO CQ-ENTRY-TYPE
  8059*                                   CQ-VOID-INDICATOR
  8060*        MOVE CH-VOID-DT         TO CQ-CHECK-VOIDED-DT.
  8061*
  8062*    MOVE CH-CHECK-REFERENCE     TO PI-REFERENCE.
  8063*
  8064*    EXEC CICS REWRITE
  8065*        DATASET  (ERCHKQ-FILE-ID)
  8066*        FROM     (CHECK-QUE)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 144
* EL677.cbl
  8067*    END-EXEC.
  8068*
  8069*    GO TO 3790-EXIT.
  8070*
  8071*3780-CHECK-NOTFND.
  8072*    MOVE ER-2905                TO EMI-ERROR.
  8073*    MOVE -1                     TO CARRIERL
  8074*    MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8075*                                   ACCTA     EFFDTA  CERTNOA
  8076*                                   SFXA      SEQA.
  8077*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8078     .
  8079 3790-EXIT.
  8080      EXIT.
  8081
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 145
* EL677.cbl
  8083
  8084 3900-RECORD-NOTFND.
  8085     MOVE ER-2908                TO EMI-ERROR.
  8086     MOVE -1                     TO CARRIERL
  8087     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8088                                    ACCTA     EFFDTA  CERTNOA
  8089                                    SFXA      SEQA.
  8090     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8091     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 146
* EL677.cbl
  8093 4000-ADD-CHANGE.
  8094     IF PAYTO1L NOT = ZEROS
  8095        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  8096     END-IF
  8097
  8098     IF PAYTO2L NOT = ZEROS
  8099         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  8100
  8101     IF PAYAD1L NOT = ZEROS
  8102         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  8103
  8104     IF PAYAD2L NOT = ZEROS
  8105         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  8106
  8107     IF PAYctyL NOT = ZEROS
  8108         MOVE payctyi            TO CH-PAYEE-CITY.
  8109
  8110     IF PAYstL NOT = ZEROS
  8111         MOVE paysti            TO CH-PAYEE-state.
  8112
  8113     IF PAYEEI GREATER SPACES
  8114        MOVE PAYEEI              TO CH-PAYEE-CODE.
  8115
  8116     IF PTOZIPL  =  ZEROS
  8117         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  8118         GO TO 4000-CK-REST.
  8119
  8120     MOVE PTOZIPI                TO WS-ZIP-CODE.
  8121
  8122     IF NOT WS-CANADIAN-POST-CODE
  8123         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  8124         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  8125         GO TO 4000-CK-REST.
  8126
  8127     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  8128     IF WS-CAN-POST-4TH = SPACE OR '-'
  8129         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  8130         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  8131     ELSE
  8132         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  8133         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  8134
  8135 4000-CK-REST.
  8136
  8137     IF RETTOL NOT = ZEROS
  8138        MOVE RETTOI TO CH-RETURN-TO.
  8139     if dedcynl not = zeros
  8140        move dedcyni             to ch-deduct-commission
  8141     end-if
  8142     if dedcynl not = zeros
  8143        if (dedcyni = 'Y')
  8144           or (pi-prev-ded-comm = 'Y')
  8145           compute ws-amt =
  8146              pi-refund-on-pending-rec -
  8147                 pi-prev-paid - pi-ue-comm
  8148        else
  8149           if dedcyni = 'N'
  8150              compute ws-amt =
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 147
* EL677.cbl
  8151                 pi-refund-on-pending-rec -
  8152                    pi-prev-paid
  8153           end-if
  8154        end-if
  8155     end-if
  8156     IF AMOUNTL NOT = ZEROS
  8157         MOVE WS-AMT             TO CH-AMOUNT-PAID
  8158         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  8159
  8160     IF CHECKL NOT = ZEROS
  8161         MOVE CHECKI             TO CH-CHECK-NO.
  8162
  8163     IF REASONL NOT = ZEROS
  8164         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  8165
  8166*    IF DEDAMTL NOT = ZEROS
  8167*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  8168*                                   DEDAMTO.
  8169
  8170*    IF ADDLCHGL NOT = ZEROS
  8171*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  8172*                                   ADDLCHGO.
  8173
  8174     IF STUBL NOT = ZEROS
  8175         MOVE STUBI              TO CH-STUB-LINE-1.
  8176
  8177     IF TEXT1L NOT = ZEROS
  8178         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  8179
  8180     IF TEXT2L NOT = ZEROS
  8181         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  8182
  8183     IF TEXT3L NOT = ZEROS
  8184         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8185
  8186     IF TYPEL NOT = ZEROS
  8187         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8188
  8189*    MOVE LETTER1I               TO CH-LETTERS (1).
  8190*    MOVE LETTER2I               TO CH-LETTERS (2).
  8191*    MOVE LETTER3I               TO CH-LETTERS (3).
  8192
  8193*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8194     IF CH-CHECK-ORIGIN-SW = 'R'
  8195         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8196*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
  8197         MOVE PI-CANC-DT             TO CH-CANC-DT
  8198         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8199         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8200         MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8201
  8202*    IF PI-AR-PROCESSING AND
  8203*       REFL NOT = ZERO
  8204*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8205
  8206 4000-EXIT.
  8207      EXIT.
  8208 4100-CONNECT-TO-DB.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 148
* EL677.cbl
  8209     move 'NTSQLTST2_Logic'      to svr
  8210     move 'sa'                   to usr
  8211     move 'sql2008r2'            to pass
  8212
  8213     if ws-kix-myenv = 'cid1p'
  8214        move 'NTCSO2_ChkApprv'   to svr
  8215        move 'sa'                to usr
  8216        move 'ntcso2'            to pass
  8217     end-if
  8218     string
  8219         usr delimited space
  8220         "." delimited size
  8221         pass delimited space into usr-pass
  8222     end-string
  8223     EXEC SQL
  8224        CONNECT TO :svr USER :usr-pass
  8225     END-EXEC
  8226     if sqlcode not = 0
  8227        display "Error: cannot connect "
  8228        display sqlcode
  8229        display sqlerrmc
  8230     end-if
  8231     set connected-to-db to true
  8232     .
  8233 4100-EXIT.
  8234     EXIT.
  8235 4150-open-cursor.
  8236     move pi-company-id          to ws-compid
  8237     move ch-carrier             to ws-carrier
  8238     move ch-grouping            to ws-grouping
  8239     move ch-state               to ws-state
  8240     move ch-account             to ws-account
  8241     move ch-cert-eff-dt         to dc-bin-date-1
  8242     move ' '                    to dc-option-code
  8243     perform 8500-date-convert   thru 8500-exit
  8244     if no-conversion-error
  8245        move dc-greg-date-a-edit to ws-eff-date
  8246     end-if
  8247     move ch-cert-prime          to ws-certificate
  8248     move ch-cert-sfx            to ws-cert-sfx
  8249     move ch-sequence-no         to ws-seq-no
  8250     move '1'                    to ws-type
  8251     EXEC SQL
  8252        DECLARE
  8253           checkapp cursor for
  8254        SELECT
  8255           ApprovalStatus,
  8256           MaintainedBy,
  8257           MaintainedDate,
  8258           ApprovalBatch
  8259        FROM
  8260           ChkApp_Check
  8261        WHERE
  8262           Company           = :ws-compid
  8263           and CertCarrier   = :ws-carrier
  8264           and CertGroup     = :ws-grouping
  8265           and CertState     = :ws-state
  8266           and CertAccount   = :ws-account
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 149
* EL677.cbl
  8267           and CertEffDate   = :ws-eff-date
  8268           and CertNumber    = :ws-certificate
  8269           and CertNumberSuf = :ws-cert-sfx
  8270           and CheckSeqNbr   = :ws-seq-no
  8271           and CheckType     = :ws-type
  8272     END-EXEC
  8273     if sqlcode not = 0
  8274        display "Error: cannot declare cursor "
  8275        display ' sql retrun code ' sqlcode
  8276        display ' sql err mess    ' sqlerrmc
  8277        go to 4150-exit
  8278     end-if
  8279     EXEC SQL
  8280        open checkapp
  8281     END-EXEC
  8282     if sqlcode not = 0
  8283        display "Error: cannot open cursor "
  8284        display ' sql retrun code ' sqlcode
  8285        display ' sql err mess    ' sqlerrmc
  8286     end-if
  8287     .
  8288 4150-exit.
  8289     exit.
  8290 4200-get-tbl-row.
  8291***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8292***                                                            ***
  8293***  I'm only expecting one row so no cursor is declared       ***
  8294***                                                            ***
  8295***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8296     move pi-company-id          to ws-compid
  8297     move ch-carrier             to ws-carrier
  8298     move ch-grouping            to ws-grouping
  8299     move ch-state               to ws-state
  8300     move ch-account             to ws-account
  8301     move ch-cert-eff-dt         to dc-bin-date-1
  8302     move ' '                    to dc-option-code
  8303     perform 8500-date-convert   thru 8500-exit
  8304     if no-conversion-error
  8305        move dc-greg-date-a-edit to ws-eff-date
  8306     end-if
  8307     move ch-cert-prime          to ws-certificate
  8308     move ch-cert-sfx            to ws-cert-sfx
  8309     move ch-sequence-no         to ws-seq-no
  8310     move '1'                    to ws-type
  8311     exec sql
  8312        SELECT
  8313           ApprovalStatus,
  8314           MaintainedBy,
  8315           MaintainedDate,
  8316           ApprovalBatch
  8317        INTO
  8318           :db-app-status :nu-app-status,
  8319           :db-app-by :nu-app-by,
  8320           :db-app-date :nu-app-date,
  8321           :db-app-batch :nu-app-batch
  8322        FROM
  8323           ChkApp_Check
  8324        WHERE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 150
* EL677.cbl
  8325           Company           = :ws-compid
  8326           and CertCarrier   = :ws-carrier
  8327           and CertGroup     = :ws-grouping
  8328           and CertState     = :ws-state
  8329           and CertAccount   = :ws-account
  8330           and CertEffDate   = :ws-eff-date
  8331           and CertNumber    = :ws-certificate
  8332           and CertNumberSuf = :ws-cert-sfx
  8333           and CheckSeqNbr   = :ws-seq-no
  8334           and CheckType     = :ws-type
  8335     end-exec
  8336     if sqlcode not = 0
  8337        display "Error: cannot read row "
  8338        display ' sql return code ' sqlcode
  8339        display ' sql err mess    ' sqlerrmc
  8340        go to 4200-exit
  8341     end-if
  8342*    display ' status ' db-app-status
  8343*    display ' by     ' db-app-by
  8344*    display ' date   ' db-app-date
  8345*    display ' batch  ' db-app-batch
  8346*    if nu-app-date = -1
  8347*       display ' approval date is low-values '
  8348*    else
  8349*       display ' approval date is NOT low values '
  8350*    end-if
  8351     .
  8352 4200-exit.
  8353     exit.
  8354 4250-delete-row.
  8355     EXEC SQL
  8356        DELETE
  8357           from ChkApp_Check
  8358        WHERE
  8359           Company           = :ws-compid
  8360           and CertCarrier   = :ws-carrier
  8361           and CertGroup     = :ws-grouping
  8362           and CertState     = :ws-state
  8363           and CertAccount   = :ws-account
  8364           and CertEffDate   = :ws-eff-date
  8365           and CertNumber    = :ws-certificate
  8366           and CertNumberSuf = :ws-cert-sfx
  8367           and CheckSeqNbr   = :ws-seq-no
  8368           and CheckType     = :ws-type
  8369     END-EXEC
  8370     if sqlcode not = 0
  8371        display "Error: cannot delete row  "
  8372        display ' sql retrun code ' sqlcode
  8373        display ' sql err mess    ' sqlerrmc
  8374        go to 4250-exit
  8375     end-if
  8376     set row-deleted         to true
  8377     EXEC SQL
  8378         commit transaction
  8379     END-EXEC
  8380     if sqlcode not = 0
  8381        display "Error: commit "
  8382        display ' sql return code ' sqlcode
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 151
* EL677.cbl
  8383        display ' sql err mess    ' sqlerrmc
  8384        go to 4250-exit
  8385     end-if
  8386     set tbl-commited to true
  8387     .
  8388 4250-exit.
  8389     exit.
  8390 4300-FINISH-UP-DB.
  8391     EXEC SQL
  8392         commit work release
  8393     END-EXEC
  8394     if sqlcode not = 0
  8395        display "Error: commit release "
  8396        display ' sql return code ' sqlcode
  8397        display ' sql err mess    ' sqlerrmc
  8398     end-if
  8399     .
  8400 4300-EXIT.
  8401     EXIT.
  8402 5000-BROWSE-FILE.
  8403
  8404* EXEC CICS HANDLE CONDITION
  8405*        NOTFND   (5560-END-OF-FILE)
  8406*        ENDFILE  (5560-END-OF-FILE)
  8407*    END-EXEC.
  8408*    MOVE '"$I''                  ! . #00007760' TO DFHEIV0
  8409     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8410     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8411     MOVE X'2E20233030303037373630' TO DFHEIV0(25:11)
  8412     CALL 'kxdfhei1' USING DFHEIV0
  8413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8414
  8415
  8416     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8417
  8418     IF SEQI = LOW-VALUES
  8419         MOVE +1                 TO CHEK-RECORD-SEQ.
  8420
  8421     IF EIBAID = DFHPF2
  8422         GO TO 5100-BROWSE-BKWD.
  8423
  8424 5010-READ-LOOP.
  8425     IF EIBAID = DFHPF1
  8426         ADD +1                  TO CHEK-RECORD-SEQ.
  8427
  8428
  8429* EXEC CICS READ
  8430*        DATASET  (ERCHEK-FILE-ID)
  8431*        SET      (ADDRESS OF CHECK-RECORDS)
  8432*        RIDFLD   (ERCHEK-KEY)
  8433*        GTEQ
  8434*    END-EXEC.
  8435*    MOVE '&"S        G          (   #00007777' TO DFHEIV0
  8436     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8437     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8438     MOVE X'2020233030303037373737' TO DFHEIV0(25:11)
  8439     CALL 'kxdfhei1' USING DFHEIV0,
  8440           ERCHEK-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 152
* EL677.cbl
  8441           DFHEIV20,
  8442           DFHEIV99,
  8443           ERCHEK-KEY,
  8444           DFHEIV99,
  8445           DFHEIV99,
  8446           DFHEIV99
  8447     SET ADDRESS OF CHECK-RECORDS TO
  8448         DFHEIV20
  8449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8450
  8451
  8452     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8453         IF EIBAID = DFHENTER
  8454             GO TO 5550-NO-RECORD
  8455         ELSE
  8456             GO TO 5560-END-OF-FILE.
  8457
  8458        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8459           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8460           PI-CHEK-STATE      = CH-STATE       AND
  8461           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8462           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8463           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8464           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8465              GO TO 5500-FORMAT-SCREEN
  8466            ELSE
  8467              IF EIBAID = DFHPF1
  8468                  GO TO 5560-END-OF-FILE
  8469                ELSE
  8470                  GO TO 5550-NO-RECORD.
  8471
  8472     IF EIBAID = DFHENTER
  8473        IF CHEK-CARRIER    = CH-CARRIER     AND
  8474           CHEK-GROUPING   = CH-GROUPING    AND
  8475           CHEK-STATE      = CH-STATE       AND
  8476           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8477           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8478           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8479           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8480           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8481              GO TO 5500-FORMAT-SCREEN
  8482        ELSE
  8483              GO TO 5550-NO-RECORD.
  8484
  8485     GO TO 5500-FORMAT-SCREEN.
  8486
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 153
* EL677.cbl
  8488
  8489 5100-BROWSE-BKWD.
  8490
  8491* EXEC CICS STARTBR
  8492*        DATASET  (ERCHEK-FILE-ID)
  8493*        RIDFLD   (ERCHEK-KEY)
  8494*    END-EXEC.
  8495     MOVE 0
  8496       TO DFHEIV11
  8497*    MOVE '&,         G          &   #00007822' TO DFHEIV0
  8498     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8499     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8500     MOVE X'2020233030303037383232' TO DFHEIV0(25:11)
  8501     CALL 'kxdfhei1' USING DFHEIV0,
  8502           ERCHEK-FILE-ID,
  8503           ERCHEK-KEY,
  8504           DFHEIV99,
  8505           DFHEIV11,
  8506           DFHEIV99
  8507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8508
  8509
  8510
  8511* EXEC CICS READPREV
  8512*        DATASET  (ERCHEK-FILE-ID)
  8513*        SET      (ADDRESS OF CHECK-RECORDS)
  8514*        RIDFLD   (ERCHEK-KEY)
  8515*    END-EXEC.
  8516     MOVE 0
  8517       TO DFHEIV11
  8518*    MOVE '&0S                   )   #00007827' TO DFHEIV0
  8519     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8520     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8521     MOVE X'2020233030303037383237' TO DFHEIV0(25:11)
  8522     CALL 'kxdfhei1' USING DFHEIV0,
  8523           ERCHEK-FILE-ID,
  8524           DFHEIV20,
  8525           DFHEIV99,
  8526           ERCHEK-KEY,
  8527           DFHEIV99,
  8528           DFHEIV11,
  8529           DFHEIV99,
  8530           DFHEIV99
  8531     SET ADDRESS OF CHECK-RECORDS TO
  8532         DFHEIV20
  8533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8534
  8535
  8536 5110-READ-LOOP.
  8537     IF PI-FILE-EOF
  8538         MOVE SPACE              TO PI-EOF-SW
  8539     ELSE
  8540
  8541* EXEC CICS READPREV
  8542*            DATASET  (ERCHEK-FILE-ID)
  8543*            SET      (ADDRESS OF CHECK-RECORDS)
  8544*            RIDFLD   (ERCHEK-KEY)
  8545*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 154
* EL677.cbl
  8546     MOVE 0
  8547       TO DFHEIV11
  8548*    MOVE '&0S                   )   #00007837' TO DFHEIV0
  8549     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8550     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8551     MOVE X'2020233030303037383337' TO DFHEIV0(25:11)
  8552     CALL 'kxdfhei1' USING DFHEIV0,
  8553           ERCHEK-FILE-ID,
  8554           DFHEIV20,
  8555           DFHEIV99,
  8556           ERCHEK-KEY,
  8557           DFHEIV99,
  8558           DFHEIV11,
  8559           DFHEIV99,
  8560           DFHEIV99
  8561     SET ADDRESS OF CHECK-RECORDS TO
  8562         DFHEIV20
  8563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8564
  8565
  8566     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8567         GO TO 5560-END-OF-FILE.
  8568
  8569        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8570           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8571           PI-CHEK-STATE      = CH-STATE       AND
  8572           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8573           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8574           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8575           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8576              GO TO 5500-FORMAT-SCREEN
  8577            ELSE
  8578              GO TO 5560-END-OF-FILE.
  8579
  8580     GO TO 5500-FORMAT-SCREEN.
  8581
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 155
* EL677.cbl
  8583*                          COPY ELCNPD.
  8584*****************************************************************
  8585*                                                               *
  8586*                                                               *
  8587*                            ELCNPD                             *
  8588*                            VMOD=2.001                         *
  8589*****************************************************************
  8590
  8591 5200-MOVE-NAME.
  8592*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8593*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8594*            BLANKS.                                            *
  8595*                                                               *
  8596*                  FIELD               VALUE                    *
  8597*                                                               *
  8598*                LAST NAME (CL15)      SMITH                    *
  8599*                1ST NAME  (CL12)      JOHN                     *
  8600*                MID NAME  (CL1)       A                        *
  8601*                                                               *
  8602*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8603*         *                                                     *
  8604*         *              JOHN A. SMITH                          *
  8605*         *                                                     *
  8606*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8607*         *  STORAGE COPYBOOK:                                  *
  8608*         *                                                     *
  8609*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8610*         *******************************************************.
  8611
  8612     MOVE SPACES                 TO  WS-NAME-WORK
  8613                                     WS-NAME-WORK2.
  8614     MOVE ZERO                   TO  WS-NAME-SW.
  8615     SET NWA-INDEX TO +1.
  8616
  8617     IF WS-INSURED-1ST-NAME = SPACES  AND
  8618        WS-INSURED-MID-INIT = SPACES
  8619         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8620         GO TO 5200-EXIT.
  8621
  8622     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8623     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8624
  8625     SET NWA-INDEX UP BY +1
  8626     IF WS-INSURED-MID-INIT NOT = SPACES
  8627        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8628        SET NWA-INDEX UP BY +1
  8629        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8630        SET NWA-INDEX UP BY +2.
  8631
  8632     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8633     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8634
  8635
  8636 5200-EXIT.
  8637     EXIT.
  8638
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 156
* EL677.cbl
  8640 5300-MOVE-NAME SECTION.
  8641     IF WS-NAME-SW GREATER THAN +1
  8642         GO TO 5390-EXIT.
  8643
  8644     IF WS-NAME-WORK2 = SPACES
  8645         GO TO 5390-EXIT.
  8646
  8647     SET NWA-INDEX2 TO +1.
  8648     SET NWA-INDEX3 TO +2.
  8649
  8650 5310-MOVE-NAME.
  8651     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8652
  8653     IF NWA-INDEX LESS THAN +30
  8654        SET NWA-INDEX UP BY +1
  8655     ELSE
  8656        ADD +2  TO  WS-NAME-SW
  8657        GO TO 5390-EXIT.
  8658
  8659     IF NWA-INDEX2 LESS THAN +20
  8660         SET NWA-INDEX2 UP BY +1
  8661         SET NWA-INDEX3 UP BY +1.
  8662
  8663     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8664        WS-NW2 (NWA-INDEX3) = SPACES
  8665        GO TO 5390-EXIT.
  8666
  8667     GO TO 5310-MOVE-NAME.
  8668
  8669 5390-EXIT.
  8670     EXIT.
  8671
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 157
* EL677.cbl
  8674 5500-FORMAT-SCREEN.
  8675     MOVE LOW-VALUES             TO  EL677AI.
  8676     MOVE 'S'                    TO  MAINTI   PI-PREV-MAINT.
  8677     MOVE +1                     TO  MAINTL.
  8678     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8679     MOVE CH-CARRIER             TO  CARRIERO.
  8680     MOVE CH-GROUPING            TO  GROUPO.
  8681     MOVE CH-STATE               TO  STATEO.
  8682     MOVE CH-ACCOUNT             TO  ACCTO.
  8683
  8684     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8685     MOVE SPACE                  TO  DC-OPTION-CODE.
  8686     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8687     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8688
  8689     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8690     MOVE CH-CERT-SFX            TO  SFXO.
  8691     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8692
  8693     MOVE AL-UANON               TO  CARRIERA
  8694                                     GROUPA
  8695                                     STATEA
  8696                                     ACCTA
  8697                                     EFFDTA
  8698                                     CERTNOA
  8699                                     SFXA.
  8700     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8701
  8702     if ch-approval-dt not = low-values
  8703        move ch-approval-dt      to dc-bin-date-1
  8704        move ' '                 to dc-option-code
  8705        perform 8500-date-convert thru 8500-exit
  8706        move dc-greg-date-1-edit to apvdto
  8707     end-if
  8708     evaluate ch-approval-status
  8709        when '2'
  8710           move 'PENDING '       TO APVSTATO
  8711        when 'P'
  8712           move 'PENDING '       TO APVSTATO
  8713        when 'A'
  8714           move 'APPROVED'       to apvstato
  8715        when 'D'
  8716           move 'DENIED'         to apvstato
  8717     end-evaluate
  8718     move ch-approved-by         to apvbyo
  8719*    IF PI-COMPANY-ID = 'TMS'
  8720*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8721*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8722*    ELSE
  8723         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8724         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8725
  8726     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8727     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8728     move ch-payee-city          to payctyo
  8729     move ch-payee-state         to paysto
  8730     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8731
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 158
* EL677.cbl
  8732     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8733         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8734         MOVE AL-UANON           TO  PTOZIPA.
  8735
  8736     MOVE CH-RETURN-TO           TO  RETTOO
  8737*    if ch-check-cashed-dt not = spaces and low-values
  8738*       move ch-check-cashed-dt  to dc-bin-date-1
  8739*       MOVE SPACE               TO  DC-OPTION-CODE
  8740*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8741*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8742*    end-if
  8743     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8744     MOVE SPACE                  TO  DC-OPTION-CODE.
  8745     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8746     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8747
  8748     MOVE CH-RECORDED-BY         TO  CBYO.
  8749
  8750     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8751         NEXT SENTENCE
  8752     ELSE
  8753         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8754         MOVE SPACE                  TO  DC-OPTION-CODE
  8755         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8756         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8757         MOVE CH-VOID-BY             TO  VBYO.
  8758
  8759     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8760         NEXT SENTENCE
  8761     ELSE
  8762         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8763         MOVE SPACE                  TO  DC-OPTION-CODE
  8764         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8765         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8766
  8767     MOVE CH-AMOUNT-PAID         TO  AMOUNTO.
  8768     MOVE AL-SANOF               TO  AMOUNTA.
  8769     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8770     MOVE AL-SANOF               TO  TYPEA.
  8771     MOVE CH-CHECK-NO            TO  CHECKO.
  8772     move ch-deduct-commission   to dedcyno
  8773     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8774     MOVE CH-VOID-REASON         TO  VREASONO.
  8775
  8776     MOVE CH-STUB-LINE-1         TO  STUBO.
  8777     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8778     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8779     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8780     IF CH-LF-REFUND NOT NUMERIC
  8781         MOVE ZEROS              TO CH-LF-REFUND.
  8782     IF CH-AH-REFUND NOT NUMERIC
  8783         MOVE ZEROS              TO CH-AH-REFUND.
  8784     if (ch-check-no not = spaces and low-values)
  8785        and (ch-check-written-dt not = low-values)
  8786        perform 5800-fetch-check-cashed-dt
  8787                                 thru 5800-exit
  8788     end-if
  8789     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 159
* EL677.cbl
  8790        CH-VOID-DT          GREATER LOW-VALUES
  8791        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8792                                     STUBA     TEXT1A   TEXT2A
  8793                                     TEXT3A    PAYTO1A  SFXA
  8794                                     PAYTO2A   PAYAD1A  PAYctyA
  8795                                     paysta    RETTOA   PAYAD2A
  8796                                     PTOZIPA
  8797                                     PRINTEDA
  8798     ELSE
  8799        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8800                                     ACCTA     EFFDTA   CERTNOA
  8801                                     CHECKA    REASONA  VREASONA
  8802                                     STUBA     TEXT1A   TEXT2A
  8803                                     TEXT3A    PAYTO1A  SFXA
  8804                                     PAYTO2A   PAYAD1A  PAYctyA
  8805                                     paysta    RETTOA   PAYAD2A
  8806                                     PRINTEDA.
  8807
  8808     MOVE AL-UNNON               TO SEQA.
  8809     perform 5600-get-erpndb     thru 5600-exit
  8810     perform 5700-get-elcert     thru 5700-exit
  8811     move pi-prev-paid           to prepdo
  8812     if WS-PNDB-FOUND
  8813        compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8814     end-if
  8815     if WS-CERT-FOUND
  8816        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8817           cm-lf-alt-premium-amt
  8818        compute ws-tot-iss-prem  =
  8819           cm-ah-premium-amt + ws-tot-lf-prem
  8820        compute ws-tot-iss-comm =
  8821           (ws-tot-lf-prem * cm-life-comm-pct) +
  8822           (cm-ah-premium-amt * cm-ah-comm-pct)
  8823        compute ws-tot-ref-comm =
  8824           (pi-lf-refund * cm-life-comm-pct) +
  8825           (pi-ah-refund * cm-ah-comm-pct)
  8826        move ws-tot-iss-prem     to premo
  8827        move ws-tot-iss-comm     to isscommo
  8828        move ws-tot-ref-comm     to uecommo
  8829     end-if
  8830     if PI-TO-EL677-FROM-EL1273
  8831        move zeros               to premo
  8832                                    isscommo
  8833                                    uecommo
  8834                                    prepdo
  8835                                    refo
  8836     end-if
  8837     GO TO 8100-SEND-INITIAL-MAP
  8838     .
  8839 5550-NO-RECORD.
  8840     MOVE ER-1162                TO  EMI-ERROR.
  8841     MOVE -1                     TO  CARRIERL.
  8842     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8843                                     ACCTA     EFFDTA  CERTNOA
  8844                                     SFXA      SEQA.
  8845     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8846
  8847     IF NOT PI-TO-EL677-FROM-EL1273
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 160
* EL677.cbl
  8848         GO TO 8200-SEND-DATAONLY.
  8849
  8850     MOVE CHEK-CARRIER           TO  CARRIERO.
  8851     MOVE CHEK-GROUPING          TO  GROUPO.
  8852     MOVE CHEK-STATE             TO  STATEO.
  8853     MOVE CHEK-ACCOUNT           TO  ACCTO.
  8854
  8855     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  8856     MOVE SPACE                  TO  DC-OPTION-CODE.
  8857     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8858     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8859
  8860     MOVE CHEK-CERT-NO           TO  CERTNOO.
  8861     MOVE CHEK-SUF-NO            TO  SFXO.
  8862     GO TO 8100-SEND-INITIAL-MAP.
  8863
  8864 5560-END-OF-FILE.
  8865     IF EIBAID = DFHPF1
  8866         MOVE 'Y'                TO  PI-EOF-SW
  8867         MOVE ER-2237            TO  EMI-ERROR
  8868     ELSE
  8869     IF EIBAID = DFHENTER
  8870        GO TO 5550-NO-RECORD
  8871     ELSE
  8872*        MOVE SPACES             TO  PI-ERCHEK-KEY
  8873         MOVE ER-2238            TO  EMI-ERROR.
  8874
  8875     MOVE -1                     TO  MAINTL.
  8876     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8877     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 161
* EL677.cbl
  8879 5600-get-erpndb.
  8880     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  8881     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  8882     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  8883     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  8884     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  8885     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  8886     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  8887     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  8888     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  8889     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  8890     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  8891     IF ST-ACCNT-CNTL  OR
  8892        ACCNT-CNTL
  8893          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  8894     IF ST-ACCNT-CNTL      OR
  8895        CARR-ST-ACCNT-CNTL OR
  8896        ACCNT-CNTL         OR
  8897        CARR-ACCNT-CNTL
  8898          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  8899     IF ACCNT-CNTL OR
  8900        CARR-ACCNT-CNTL
  8901          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  8902
  8903* EXEC CICS READ
  8904*         DATASET   (ERPNDB-ALT-FILE-ID)
  8905*         SET       (ADDRESS OF PENDING-BUSINESS)
  8906*         RIDFLD    (ERPNDB-ALT-KEY)
  8907*         resp      (ws-response)
  8908*    END-EXEC
  8909*    MOVE '&"S        E          (  N#00008179' TO DFHEIV0
  8910     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8911     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8912     MOVE X'204E233030303038313739' TO DFHEIV0(25:11)
  8913     CALL 'kxdfhei1' USING DFHEIV0,
  8914           ERPNDB-ALT-FILE-ID,
  8915           DFHEIV20,
  8916           DFHEIV99,
  8917           ERPNDB-ALT-KEY,
  8918           DFHEIV99,
  8919           DFHEIV99,
  8920           DFHEIV99
  8921     SET ADDRESS OF PENDING-BUSINESS TO
  8922         DFHEIV20
  8923     MOVE EIBRESP  TO ws-response
  8924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8925     if resp-normal
  8926        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  8927        compute pi-refund-on-pending-rec =
  8928           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8929     end-if
  8930     .
  8931 5600-exit.
  8932     exit.
  8933 5700-get-elcert.
  8934     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  8935     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  8936     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 162
* EL677.cbl
  8937     MOVE PI-STATE               TO  ELCERT-STATE.
  8938     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  8939     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  8940     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  8941     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  8942     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  8943
  8944* EXEC CICS READ
  8945*         DATASET   (ELCERT-FILE-ID)
  8946*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  8947*         RIDFLD    (ELCERT-KEY)
  8948*         resp      (ws-response)
  8949*    END-EXEC
  8950*    MOVE '&"S        E          (  N#00008203' TO DFHEIV0
  8951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8953     MOVE X'204E233030303038323033' TO DFHEIV0(25:11)
  8954     CALL 'kxdfhei1' USING DFHEIV0,
  8955           ELCERT-FILE-ID,
  8956           DFHEIV20,
  8957           DFHEIV99,
  8958           ELCERT-KEY,
  8959           DFHEIV99,
  8960           DFHEIV99,
  8961           DFHEIV99
  8962     SET ADDRESS OF CERTIFICATE-MASTER TO
  8963         DFHEIV20
  8964     MOVE EIBRESP  TO ws-response
  8965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8966     if resp-normal
  8967        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  8968     end-if
  8969     .
  8970 5700-exit.
  8971     exit.
  8972 5800-fetch-check-cashed-dt.
  8973     move ' '                    to ws-connect-sw
  8974                                    ws-match-sw
  8975     move 'NTCSO2_PdBnkInfo'     to svr
  8976     move 'sa'                   to usr
  8977     move 'ntcso2'               to pass
  8978     string
  8979         usr delimited space
  8980         "." delimited size
  8981         pass delimited space into usr-pass
  8982     end-string
  8983     EXEC SQL
  8984        CONNECT TO :svr USER :usr-pass
  8985     END-EXEC
  8986     if sqlcode not = 0
  8987        display "Error: cannot connect to pdbnkinfo "
  8988        display sqlcode
  8989        display sqlerrmc
  8990        go to 5800-exit
  8991     end-if
  8992     set connected-to-db to true
  8993     if pi-company-id = 'CID'
  8994        move 'CSO - AP%'         to ws-pb-compid
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 163
* EL677.cbl
  8995     else
  8996        move 'AHL - AP%'         to ws-pb-compid
  8997     end-if
  8998     move '000'                  to ws-pb-check-no (1:3)
  8999     move ch-check-no            to ws-pb-check-no (4:7)
  9000     move spaces                 to ws-pb-bad-check-no
  9001     perform varying s1 from +1 by +1 until
  9002        (s1 > +10)
  9003        or (ws-pb-check-no (s1:1) not = '0')
  9004     end-perform
  9005     if s1 < +11
  9006        move ws-pb-check-no (s1:11 - s1)
  9007                            to ws-pb-bad-check-no (1: 11 - s1)
  9008     end-if
  9009*    display ' compid **' ws-pb-compid '**'
  9010*    display ' ckno  **' ws-pb-check-no '**'
  9011     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  9012     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  9013     MOVE SPACES              TO pb-paid-date
  9014
  9015     EXEC SQL
  9016        CALL pbi_GetCashDate_by_TransactionNbr
  9017           @compid          = :ws-pb-compid,
  9018           @checkno         = :ws-pb-check-no,
  9019           @badcheckno      = :ws-pb-bad-check-no,
  9020           @checkamount     = :ws-check-amount,
  9021           @checkcasheddate = :pb-paid-date OUT
  9022     END-EXEC
  9023     if sqlcode not = 0
  9024        display "Error: cannot run stor proc  "
  9025        move sqlcode            to ws-sql-code
  9026        move ws-sql-code to ws-dis-sql-code
  9027        display ' dis sql code ' ws-dis-sql-code
  9028        display ' sql return code ' sqlcode
  9029        display ' sql err mess    ' sqlerrmc
  9030        go to 5800-disconnect
  9031     end-if
  9032***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9033***                                                            ***
  9034***  The following code works just as well as the above        ***
  9035***  stored procedure and just as fast.                        ***
  9036***  Originally, I had declared a cursor and fetched through   ***
  9037***  the record set to find the correct check and that REALLY  ***
  9038***  slowed the response down to ~ 3/4 second.                 ***
  9039***                                                            ***
  9040***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9041*     EXEC SQL
  9042*        SELECT
  9043*           PaidDate
  9044*        INTO
  9045*           :pb-paid-date
  9046*        FROM
  9047*           dbo.cso_pbi_TransactionLookup
  9048*        WHERE
  9049*           (BankAcctDescr like :ws-pb-compid)
  9050*           and (Amount = :ws-check-amount)
  9051*           and ((transactionNbr = :ws-pb-check-no)
  9052*                  or
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 164
* EL677.cbl
  9053*               (transactionnbr = :ws-pb-bad-check-no))
  9054**          and (CAST(TransactionNbr AS INT) =
  9055**             :ws-pb-check-no-num)
  9056**          and (right('00000' + rtrim(TransactionNbr),10)
  9057**             = :ws-pb-check-no)
  9058**          and (TransactionNbr  = :ws-pb-check-no)
  9059*     END-EXEC
  9060*    display ' chkno  ' pb-check-no
  9061*    display ' desc   ' pb-bank-acct-desc
  9062*    display ' trn typ' pb-tran-type
  9063*    display ' amt   *' pb-amount '**'
  9064*    display ' pd dte ' pb-paid-date
  9065     string pb-paid-date (7:4)
  9066            pb-paid-date (1:2)
  9067            pb-paid-date (4:2)
  9068        delimited by size into dc-greg-date-cymd-r
  9069     end-string
  9070     move 'L'                    to dc-option-code
  9071     perform 8500-date-convert   thru 8500-exit
  9072     if no-conversion-error
  9073*       move dc-bin-date-1       to ws-bin-cashed-dt
  9074        move dc-greg-date-1-edit to cashedo
  9075     else
  9076        display ' error cvtdte cash dt ' pb-paid-date ' '
  9077           dc-error-code
  9078     end-if
  9079     .
  9080 5800-disconnect.
  9081     EXEC SQL
  9082        DISCONNECT ALL
  9083     END-EXEC
  9084     if sqlcode not = 0
  9085        display "Error: cannot disconnect pdbnk "
  9086        display ' sql return code ' sqlcode
  9087        display ' sql err mess    ' sqlerrmc
  9088     end-if
  9089     .
  9090 5800-exit.
  9091     exit.
  9092 6000-VERIFY-COMP-MASTER.
  9093
  9094* EXEC CICS HANDLE CONDITION
  9095*        NOTFND   (6070-NO-COMP-MSTR)
  9096*    END-EXEC.
  9097*    MOVE '"$I                   ! / #00008336' TO DFHEIV0
  9098     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9100     MOVE X'2F20233030303038333336' TO DFHEIV0(25:11)
  9101     CALL 'kxdfhei1' USING DFHEIV0
  9102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9103
  9104
  9105     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  9106
  9107     IF NOT PI-ZERO-CARRIER AND
  9108        NOT PI-ZERO-CAR-GROUP
  9109         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  9110     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 165
* EL677.cbl
  9111         MOVE ZEROS              TO  ERCOMP-CARRIER.
  9112
  9113     IF NOT PI-ZERO-GROUPING  AND
  9114        NOT PI-ZERO-CAR-GROUP
  9115         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  9116     ELSE
  9117         MOVE ZEROS              TO  ERCOMP-GROUPING.
  9118
  9119     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  9120     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  9121     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  9122
  9123
  9124* EXEC CICS READ
  9125*         DATASET   (ERCOMP-FILE-ID)
  9126*         SET       (ADDRESS OF COMPENSATION-MASTER)
  9127*         RIDFLD    (ERCOMP-KEY)
  9128*     END-EXEC.
  9129*    MOVE '&"S        E          (   #00008358' TO DFHEIV0
  9130     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9131     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9132     MOVE X'2020233030303038333538' TO DFHEIV0(25:11)
  9133     CALL 'kxdfhei1' USING DFHEIV0,
  9134           ERCOMP-FILE-ID,
  9135           DFHEIV20,
  9136           DFHEIV99,
  9137           ERCOMP-KEY,
  9138           DFHEIV99,
  9139           DFHEIV99,
  9140           DFHEIV99
  9141     SET ADDRESS OF COMPENSATION-MASTER TO
  9142         DFHEIV20
  9143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9144
  9145
  9146     GO TO 6090-EXIT.
  9147
  9148 6070-NO-COMP-MSTR.
  9149     MOVE -1                     TO  CARRIERL.
  9150     MOVE ER-2230                TO  EMI-ERROR.
  9151     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9152     GO TO 8200-SEND-DATAONLY.
  9153
  9154 6090-EXIT.
  9155      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 166
* EL677.cbl
  9157 6100-VERIFY-CERTIFICATE.
  9158
  9159* EXEC CICS HANDLE CONDITION
  9160*        NOTFND   (6170-NO-CERTIFICATE)
  9161*    END-EXEC.
  9162*    MOVE '"$I                   ! 0 #00008376' TO DFHEIV0
  9163     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9165     MOVE X'3020233030303038333736' TO DFHEIV0(25:11)
  9166     CALL 'kxdfhei1' USING DFHEIV0
  9167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9168
  9169
  9170     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9171     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9172     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  9173     MOVE PI-STATE               TO  ELCERT-STATE.
  9174     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9175     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9176     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9177     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9178
  9179     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9180
  9181     MOVE SPACES                 TO  PI-REFERENCE
  9182*                                    PI-INSURED-NAME.
  9183     MOVE LOW-VALUES             TO  PI-CANC-DT.
  9184     MOVE ZEROS                  TO  PI-LF-REFUND
  9185                                     PI-AH-REFUND.
  9186
  9187
  9188* EXEC CICS READ
  9189*         DATASET   (ELCERT-FILE-ID)
  9190*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9191*         RIDFLD    (ELCERT-KEY)
  9192*     END-EXEC.
  9193*    MOVE '&"S        E          (   #00008397' TO DFHEIV0
  9194     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9195     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9196     MOVE X'2020233030303038333937' TO DFHEIV0(25:11)
  9197     CALL 'kxdfhei1' USING DFHEIV0,
  9198           ELCERT-FILE-ID,
  9199           DFHEIV20,
  9200           DFHEIV99,
  9201           ELCERT-KEY,
  9202           DFHEIV99,
  9203           DFHEIV99,
  9204           DFHEIV99
  9205     SET ADDRESS OF CERTIFICATE-MASTER TO
  9206         DFHEIV20
  9207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9208
  9209
  9210     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  9211
  9212     MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  9213     MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  9214     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 167
* EL677.cbl
  9215         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  9216     ELSE
  9217         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9218             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  9219*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  9220
  9221     GO TO 6190-EXIT.
  9222
  9223 6170-NO-CERTIFICATE.
  9224     MOVE -1                     TO  CARRIERL.
  9225     MOVE ER-2726                TO  EMI-ERROR.
  9226     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9227
  9228 6190-EXIT.
  9229      EXIT.
  9230
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 168
* EL677.cbl
  9232 6200-UPDATE-PENDING-BUS-REC.
  9233     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9234     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9235     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9236     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9237     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9238     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9239     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9240     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9241     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9242     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9243
  9244     IF ST-ACCNT-CNTL  OR
  9245        ACCNT-CNTL
  9246          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9247
  9248     IF ST-ACCNT-CNTL      OR
  9249        CARR-ST-ACCNT-CNTL OR
  9250        ACCNT-CNTL         OR
  9251        CARR-ACCNT-CNTL
  9252          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9253
  9254     IF ACCNT-CNTL OR
  9255        CARR-ACCNT-CNTL
  9256          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9257
  9258
  9259* EXEC CICS READ
  9260*         DATASET   (ERPNDB-ALT-FILE-ID)
  9261*         SET       (ADDRESS OF PENDING-BUSINESS)
  9262*         RIDFLD    (ERPNDB-ALT-KEY)
  9263*         resp      (ws-response)
  9264*     END-EXEC.
  9265*    MOVE '&"S        E          (  N#00008451' TO DFHEIV0
  9266     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9268     MOVE X'204E233030303038343531' TO DFHEIV0(25:11)
  9269     CALL 'kxdfhei1' USING DFHEIV0,
  9270           ERPNDB-ALT-FILE-ID,
  9271           DFHEIV20,
  9272           DFHEIV99,
  9273           ERPNDB-ALT-KEY,
  9274           DFHEIV99,
  9275           DFHEIV99,
  9276           DFHEIV99
  9277     SET ADDRESS OF PENDING-BUSINESS TO
  9278         DFHEIV20
  9279     MOVE EIBRESP  TO ws-response
  9280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9281
  9282
  9283     if not resp-normal
  9284        go to 6200-exit
  9285     end-if
  9286     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9287
  9288
  9289* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 169
* EL677.cbl
  9290*         DATASET   (ERPNDB-FILE-ID)
  9291*         SET       (ADDRESS OF PENDING-BUSINESS)
  9292*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9293*         UPDATE
  9294*         resp      (ws-response)
  9295*     END-EXEC.
  9296*    MOVE '&"S        EU         (  N#00008463' TO DFHEIV0
  9297     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9298     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9299     MOVE X'204E233030303038343633' TO DFHEIV0(25:11)
  9300     CALL 'kxdfhei1' USING DFHEIV0,
  9301           ERPNDB-FILE-ID,
  9302           DFHEIV20,
  9303           DFHEIV99,
  9304           ERPNDB-PRIMARY-KEY,
  9305           DFHEIV99,
  9306           DFHEIV99,
  9307           DFHEIV99
  9308     SET ADDRESS OF PENDING-BUSINESS TO
  9309         DFHEIV20
  9310     MOVE EIBRESP  TO ws-response
  9311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9312
  9313
  9314 6200-EXIT.
  9315      EXIT.
  9316 6210-rewrite-pndb.
  9317
  9318* EXEC CICS REWRITE
  9319*        DATASET  (ERPNDB-FILE-ID)
  9320*        FROM     (PENDING-BUSINESS)
  9321*    END-EXEC
  9322     MOVE LENGTH OF
  9323      PENDING-BUSINESS
  9324       TO DFHEIV11
  9325*    MOVE '&& L                  %   #00008474' TO DFHEIV0
  9326     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9327     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9328     MOVE X'2020233030303038343734' TO DFHEIV0(25:11)
  9329     CALL 'kxdfhei1' USING DFHEIV0,
  9330           ERPNDB-FILE-ID,
  9331           PENDING-BUSINESS,
  9332           DFHEIV11,
  9333           DFHEIV99
  9334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9335     .
  9336 6210-exit.
  9337     exit.
  9338 6300-BUILD-CERT-SCREEN.
  9339     perform 6700-build-common   thru 6700-exit
  9340     if ws-refund-amount = zeros
  9341        move pi-company-cd       to pi-chek-comp-cd
  9342        move pi-carrier          to pi-chek-carrier
  9343        move pi-grouping         to pi-chek-grouping
  9344        move pi-state            to pi-chek-state
  9345        move pi-account          to pi-chek-account
  9346        move pi-cert-eff-dt      to pi-chek-eff-dt
  9347        move pi-cert-prime       to pi-chek-cert-no
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 170
* EL677.cbl
  9348        move pi-cert-sfx         to pi-chek-suf-no
  9349        move +1                  to pi-chek-sequence
  9350             MOVE 'S'            TO MAINTI
  9351             MOVE 1              TO MAINTL
  9352             MOVE AL-UABON       TO MAINTA
  9353             MOVE DFHENTER       TO EIBAID
  9354        go to 5000-browse-file
  9355     end-if
  9356     IF WS-CERT-NOT-FOUND
  9357         GO TO 8100-SEND-INITIAL-MAP.
  9358
  9359*    IF WS-PNDB-FOUND
  9360*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9361*                                   PB-C-AH-CANCEL-AMT
  9362*        MOVE 'R'                TO  TYPEO
  9363*        IF PI-AR-PROCESSING
  9364*            MOVE AL-UANON       TO  REFA
  9365*            MOVE PB-C-REFERENCE TO  REFO
  9366*        END-IF
  9367*    ELSE
  9368*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9369*                                   CM-AH-ITD-CANCEL-AMT.
  9370     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9371     MOVE 'R'                     TO TYPEO
  9372
  9373     IF PI-COMPANY-ID = 'TMS'
  9374         MOVE WS-NAME-WORK         TO PAYTO1I
  9375                                      PI-PAYTO1
  9376         MOVE AL-UANON             TO PAYTO1A
  9377     ELSE
  9378         MOVE WS-NAME-WORK         TO PAYTO1I
  9379                                      PI-PAYTO1
  9380         MOVE AL-UANON             TO PAYTO1A.
  9381
  9382*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9383*    MOVE AL-UANON                 TO PAYTO1AA.
  9384     move 'N'                    to dedcyni
  9385     move al-uanon               to dedcyna
  9386     move 'INS'                  to payeeo
  9387     move al-panon               to payeea
  9388     IF PI-MAIL-YES
  9389         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9390
  9391     GO TO 8100-SEND-INITIAL-MAP.
  9392
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 171
* EL677.cbl
  9394
  9395 6400-MAILING-ADDRESS.
  9396
  9397* EXEC CICS HANDLE CONDITION
  9398*        NOTFND   (6470-NO-ADDRESS)
  9399*    END-EXEC.
  9400*    MOVE '"$I                   ! 1 #00008539' TO DFHEIV0
  9401     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9402     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9403     MOVE X'3120233030303038353339' TO DFHEIV0(25:11)
  9404     CALL 'kxdfhei1' USING DFHEIV0
  9405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9406
  9407
  9408
  9409* EXEC CICS READ
  9410*        DATASET   (ERMAIL-FILE-ID)
  9411*        SET       (ADDRESS OF MAILING-DATA)
  9412*        RIDFLD    (ELCERT-KEY)
  9413*    END-EXEC.
  9414*    MOVE '&"S        E          (   #00008543' TO DFHEIV0
  9415     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9417     MOVE X'2020233030303038353433' TO DFHEIV0(25:11)
  9418     CALL 'kxdfhei1' USING DFHEIV0,
  9419           ERMAIL-FILE-ID,
  9420           DFHEIV20,
  9421           DFHEIV99,
  9422           ELCERT-KEY,
  9423           DFHEIV99,
  9424           DFHEIV99,
  9425           DFHEIV99
  9426     SET ADDRESS OF MAILING-DATA TO
  9427         DFHEIV20
  9428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9429
  9430
  9431     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9432     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9433     move ma-city                to payctyi
  9434     move ma-addr-state          to paysti
  9435     MOVE MA-ZIP                 TO PTOZIPI.
  9436     MOVE AL-UANON               TO PAYAD1A
  9437                                    PAYAD2A
  9438                                    PAYctyA
  9439                                    paysta
  9440                                    PTOZIPA.
  9441
  9442     GO TO 6490-EXIT.
  9443
  9444 6470-NO-ADDRESS.
  9445     MOVE -1                     TO  PAYAD1L.
  9446     MOVE ER-2394                TO  EMI-ERROR.
  9447     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9448
  9449 6490-EXIT.
  9450      EXIT.
  9451
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 172
* EL677.cbl
  9453
  9454 6500-BUILD-ACCOUNT-SCREEN.
  9455     perform 6700-build-common   thru 6700-exit
  9456     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9457     MOVE PI-AM-NAME             TO PAYTO1I
  9458     MOVE SPACES                 TO PAYTO2I
  9459     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9460     MOVE PI-AM-CITY             TO PAYCTYI
  9461     move pi-am-st               to paysti
  9462     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9463     move 'ACCT'                 to payeeo
  9464     move al-panon               to payeea
  9465     MOVE AL-UANON               TO PAYTO1A
  9466                                    PAYTO2A
  9467                                    PAYAD1A
  9468                                    PAYCTYA
  9469                                    paysta
  9470                                    PTOZIPA.
  9471     GO TO 8100-SEND-INITIAL-MAP
  9472     .
  9473 6600-BUILD-BENEFICIARY-SCREEN.
  9474     perform 6700-build-common   thru 6700-exit
  9475     IF WS-CERT-NOT-FOUND
  9476         GO TO 8100-SEND-INITIAL-MAP.
  9477
  9478*    IF WS-PNDB-FOUND
  9479*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9480*                                   PB-C-AH-CANCEL-AMT
  9481*        MOVE 'R'                TO  TYPEO
  9482*        IF PI-AR-PROCESSING
  9483*            MOVE AL-UANON       TO  REFA
  9484*            MOVE PB-C-REFERENCE TO  REFO
  9485*        END-IF
  9486*    ELSE
  9487*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9488*                                   CM-AH-ITD-CANCEL-AMT.
  9489
  9490     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9491     MOVE 'R'                     TO  TYPEO.
  9492
  9493     IF PI-COMPANY-ID = 'TMS'
  9494         MOVE WS-NAME-WORK         TO PAYTO1I
  9495                                      PI-PAYTO1
  9496         MOVE AL-UANON             TO PAYTO1A
  9497     ELSE
  9498         MOVE WS-NAME-WORK         TO PAYTO1I
  9499                                      PI-PAYTO1
  9500         MOVE AL-UANON             TO PAYTO1A.
  9501
  9502*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9503*    MOVE AL-UANON                 TO PAYTO1AA.
  9504
  9505     move 'N'                    to dedcyni
  9506     move al-uanon               to dedcyna
  9507     move 'BENE'                 to payeeo
  9508     move al-panon               to payeea
  9509     IF PI-MAIL-YES
  9510         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 173
* EL677.cbl
  9511
  9512     GO TO 8100-SEND-INITIAL-MAP.
  9513
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 174
* EL677.cbl
  9515
  9516 6620-MAILING-ADDRESS.
  9517
  9518* EXEC CICS HANDLE CONDITION
  9519*        NOTFND   (6670-NO-beneficiary)
  9520*    END-EXEC.
  9521*    MOVE '"$I                   ! 2 #00008635' TO DFHEIV0
  9522     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9523     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9524     MOVE X'3220233030303038363335' TO DFHEIV0(25:11)
  9525     CALL 'kxdfhei1' USING DFHEIV0
  9526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9527
  9528
  9529
  9530* EXEC CICS READ
  9531*        DATASET   (ERMAIL-FILE-ID)
  9532*        SET       (ADDRESS OF MAILING-DATA)
  9533*        RIDFLD    (ELCERT-KEY)
  9534*    END-EXEC.
  9535*    MOVE '&"S        E          (   #00008639' TO DFHEIV0
  9536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9538     MOVE X'2020233030303038363339' TO DFHEIV0(25:11)
  9539     CALL 'kxdfhei1' USING DFHEIV0,
  9540           ERMAIL-FILE-ID,
  9541           DFHEIV20,
  9542           DFHEIV99,
  9543           ELCERT-KEY,
  9544           DFHEIV99,
  9545           DFHEIV99,
  9546           DFHEIV99
  9547     SET ADDRESS OF MAILING-DATA TO
  9548         DFHEIV20
  9549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9550
  9551
  9552     move spaces                 to payto2i
  9553     move ma-cred-bene-name      to payto1i
  9554     MOVE MA-cred-bene-addr      TO PAYad1I.
  9555     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9556     move ma-cred-bene-city      to payctyi
  9557     move ma-cred-bene-state     to paysti
  9558     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9559     MOVE AL-UANON               TO payto1a
  9560                                    PAYTO2A
  9561                                    PAYad1A
  9562                                    payad2a
  9563                                    PAYctyA
  9564                                    paysta
  9565                                    PTOZIPA.
  9566
  9567     GO TO 6690-EXIT.
  9568
  9569 6670-NO-BENEFICIARY.
  9570     MOVE -1                     TO  PAYTO1L.
  9571     MOVE ER-2394                TO  EMI-ERROR.
  9572     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 175
* EL677.cbl
  9573
  9574 6690-EXIT.
  9575      EXIT.
  9576 6700-build-common.
  9577     if not eracct-found
  9578        move pi-company-cd       to eracct-co
  9579        move pi-carrier          to eracct-carrier
  9580        move pi-grouping         to eracct-grouping
  9581        move pi-state            to eracct-state
  9582        move pi-account          to eracct-account
  9583        move pi-cert-eff-dt      to eracct-exp-date
  9584        if not eracct-found
  9585           perform 1420-get-eracct  thru 1490-exit
  9586        end-if
  9587     end-if
  9588*    if WS-PNDB-NOT-FOUND
  9589*       perform 5600-get-erpndb thru 5600-exit
  9590*    end-if
  9591     MOVE LOW-VALUES             TO  EL677AI.
  9592     MOVE 'A'                    TO  MAINTI.
  9593     MOVE AL-UANON               TO  MAINTA.
  9594     MOVE +1                     TO  MAINTL.
  9595     MOVE PI-CARRIER             TO  CARRIERO.
  9596     MOVE PI-GROUPING            TO  GROUPO.
  9597     MOVE PI-STATE               TO  STATEO.
  9598     MOVE PI-ACCOUNT             TO  ACCTO.
  9599     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9600     MOVE PI-CERT-SFX            TO  SFXO.
  9601     MOVE PI-AMOUNT              TO  AMOUNTO.
  9602     MOVE PI-TYPE                TO  TYPEO.
  9603     move pi-return-to           to  rettoo
  9604*    MOVE PI-REFERENCE           TO  REFO.
  9605     MOVE PI-PAYTO1              TO  PAYTO1O.
  9606     MOVE AL-UANON               TO  CARRIERA
  9607                                     GROUPA
  9608                                     STATEA
  9609                                     ACCTA
  9610                                     CERTNOA
  9611                                     SFXA
  9612                                     PAYTO1A
  9613                                     PAYTO2A
  9614*                                    AMOUNTA
  9615                                     TYPEA
  9616                                     rettoa.
  9617     move al-panon               to amounta
  9618     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9619     MOVE ' '                    TO  DC-OPTION-CODE.
  9620     PERFORM 8500-DATE-CONVERT.
  9621     IF NO-CONVERSION-ERROR
  9622         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9623         MOVE AL-UANON            TO  EFFDTA
  9624         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9625         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9626     ELSE
  9627         GO TO 8200-SEND-DATAONLY.
  9628     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9629         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
  9630         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 176
* EL677.cbl
  9631     ELSE
  9632         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9633         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9634     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9635     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9636     move spaces to pi-insured-name
  9637     string cm-insured-last-name ' '
  9638            cm-insured-first-name delimited by '  '
  9639        into pi-insured-name
  9640     end-string
  9641     move spaces                 to pi-table-name
  9642     string cm-insured-last-name ', '
  9643            cm-insured-first-name ' '
  9644            cm-insured-initial2
  9645        delimited by '  '
  9646        into
  9647           pi-table-name
  9648     end-string
  9649*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9650     if eibaid = dfhpf5
  9651        move 'Y'                 to dedcyni
  9652        move al-uanon            to dedcyna
  9653     end-if
  9654    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9655       cm-lf-alt-premium-amt
  9656    compute ws-tot-iss-prem  =
  9657       cm-ah-premium-amt + ws-tot-lf-prem
  9658    compute ws-tot-iss-comm =
  9659       (ws-tot-lf-prem * cm-life-comm-pct) +
  9660       (cm-ah-premium-amt * cm-ah-comm-pct)
  9661    compute ws-tot-ref-comm =
  9662       (pi-lf-refund * cm-life-comm-pct) +
  9663       (pi-ah-refund * cm-ah-comm-pct)
  9664     move ws-tot-iss-prem         to premo
  9665     move ws-tot-iss-comm         to isscommo
  9666     compute refo = pi-lf-refund + pi-ah-refund
  9667     move ws-tot-ref-comm         to uecommo
  9668                                     pi-ue-comm
  9669     move pi-prev-paid            to prepdo
  9670     compute ws-refund-amount = pi-refund-on-pending-rec -
  9671        pi-prev-paid
  9672     if (dedcyni = 'Y')
  9673        or (pi-prev-ded-comm = 'Y')
  9674        compute ws-refund-amount = ws-refund-amount -
  9675           ws-tot-ref-comm
  9676     end-if
  9677     if not WS-CERT-NOT-FOUND
  9678        string
  9679           pi-cert-prime         ' : '
  9680           cm-insured-last-name  ', '
  9681           cm-insured-first-name ' : '
  9682           pi-account            ' : '
  9683           pi-am-csr delimited by '  ' into text1o
  9684        end-string
  9685        move al-uanon            to text1a
  9686        MOVE 'REF'               TO WS-USER-REASON
  9687        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9688        inspect ws-user-cert-no replacing leading zeros
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 177
* EL677.cbl
  9689           by spaces
  9690        move pi-insured-name     to ws-user-name
  9691        perform varying s1 from +1 by +1 until
  9692           (s1 > +11)
  9693           or (ws-user-cert-no (s1:1)) <> ' '
  9694        end-perform
  9695        string ws-user-reason  ' ' delimited by size
  9696               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9697                  delimited by size
  9698               cm-insured-last-name ' '
  9699               cm-insured-first-name delimited by '  '
  9700           into stubo
  9701        end-string
  9702        move al-uanon            to stuba
  9703     end-if
  9704     .
  9705 6700-exit.
  9706     exit.
  9707 6800-browse-previous-chek-recs.
  9708***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9709***                                                            ***
  9710**** this should be the first time through, we need to gather  ***
  9711**** all the erchek records for this pending record, add the   ***
  9712**** amounts and make sure this check request will not exceed  ***
  9713**** the collected premium                                     ***
  9714***                                                            ***
  9715***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9716     move zeros                  to pi-prev-paid
  9717                                    ws-browse-sw
  9718                                    pi-chek-rec-cnt
  9719     move spaces                 to pi-prev-ded-comm
  9720     move pi-company-cd          to chek-company-cd
  9721     move pi-carrier             to chek-carrier
  9722     move pi-grouping            to chek-grouping
  9723     move pi-state               to chek-state
  9724     move pi-account             to chek-account
  9725     move pi-cert-prime          to chek-cert-no
  9726     move pi-cert-sfx            to chek-suf-no
  9727     move pi-cert-eff-dt         to chek-eff-dt
  9728     move +0                     to chek-record-seq
  9729     move erchek-key             to ws-compare-erchek-key
  9730
  9731* EXEC CICS STARTBR
  9732*       DATASET  (ERCHEK-FILE-ID)
  9733*       RIDFLD   (ERCHEK-KEY)
  9734*       resp     (ws-response)
  9735*    END-EXEC
  9736     MOVE 0
  9737       TO DFHEIV11
  9738*    MOVE '&,         G          &  N#00008823' TO DFHEIV0
  9739     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9740     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9741     MOVE X'204E233030303038383233' TO DFHEIV0(25:11)
  9742     CALL 'kxdfhei1' USING DFHEIV0,
  9743           ERCHEK-FILE-ID,
  9744           ERCHEK-KEY,
  9745           DFHEIV99,
  9746           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 178
* EL677.cbl
  9747           DFHEIV99
  9748     MOVE EIBRESP  TO ws-response
  9749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9750     if not resp-normal
  9751        go to 6800-exit
  9752     end-if
  9753     perform until i-say-when
  9754
  9755* EXEC CICS READNEXT
  9756*          DATASET   (ERCHEK-FILE-ID)
  9757*          SET       (ADDRESS OF CHECK-RECORDS)
  9758*          RIDFLD    (ERCHEK-KEY)
  9759*          resp      (ws-response)
  9760*       END-EXEC
  9761     MOVE 0
  9762       TO DFHEIV11
  9763*    MOVE '&.S                   )  N#00008832' TO DFHEIV0
  9764     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9765     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9766     MOVE X'204E233030303038383332' TO DFHEIV0(25:11)
  9767     CALL 'kxdfhei1' USING DFHEIV0,
  9768           ERCHEK-FILE-ID,
  9769           DFHEIV20,
  9770           DFHEIV99,
  9771           ERCHEK-KEY,
  9772           DFHEIV99,
  9773           DFHEIV11,
  9774           DFHEIV99,
  9775           DFHEIV99
  9776     SET ADDRESS OF CHECK-RECORDS TO
  9777         DFHEIV20
  9778     MOVE EIBRESP  TO ws-response
  9779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9780        if resp-normal
  9781           and erchek-key (1:33) = ws-compare-erchek-key
  9782           if ch-void-dt = low-values
  9783              and not ch-denied
  9784              compute pi-prev-paid = pi-prev-paid +
  9785                 ch-amount-paid
  9786              add +1 to pi-chek-rec-cnt
  9787              move ch-deduct-commission
  9788                                 to pi-prev-ded-comm
  9789           end-if
  9790        else
  9791           set i-say-when to true
  9792        end-if
  9793     end-perform
  9794     .
  9795 6800-exit.
  9796     exit.
  9797 7000-SET-PI-AREA.
  9798     MOVE CARRIERI               TO  PI-CARRIER
  9799                                     PI-CHEK-CARRIER.
  9800     MOVE GROUPI                 TO  PI-GROUPING
  9801                                     PI-CHEK-GROUPING.
  9802     MOVE STATEI                 TO  PI-STATE
  9803                                     PI-CHEK-STATE.
  9804     MOVE ACCTI                  TO  PI-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 179
* EL677.cbl
  9805                                     PI-CHEK-ACCOUNT.
  9806     MOVE CERTNOI                TO  PI-CERT-PRIME
  9807                                     PI-CHEK-CERT-NO.
  9808     IF SFXI NOT = LOW-VALUES
  9809         MOVE SFXI               TO  PI-CERT-SFX
  9810                                     PI-CHEK-SUF-NO
  9811     ELSE
  9812         MOVE SPACE              TO  PI-CERT-SFX
  9813                                     PI-CHEK-SUF-NO.
  9814
  9815     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
  9816     MOVE '2'                    TO  DC-OPTION-CODE.
  9817     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9818     IF DATE-CONVERSION-ERROR
  9819         MOVE ER-0215            TO  EMI-ERROR
  9820         MOVE -1                 TO  EFFDTL
  9821         MOVE AL-UNBON           TO  EFFDTA
  9822         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9823         GO TO 8200-SEND-DATAONLY
  9824     ELSE
  9825         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
  9826                                     PI-CHEK-EFF-DT.
  9827
  9828 7090-EXIT.
  9829      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 180
* EL677.cbl
  9831 7100-CREATE-TEMP-STORAGE.
  9832     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9833
  9834
  9835* EXEC CICS WRITEQ TS
  9836*        QUEUE   (QID)
  9837*        FROM    (PROGRAM-INTERFACE-BLOCK)
  9838*        LENGTH  (PI-COMM-LENGTH)
  9839*    END-EXEC.
  9840*    MOVE '*"                    ''   #00008892' TO DFHEIV0
  9841     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  9842     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9843     MOVE X'2020233030303038383932' TO DFHEIV0(25:11)
  9844     CALL 'kxdfhei1' USING DFHEIV0,
  9845           QID,
  9846           PROGRAM-INTERFACE-BLOCK,
  9847           PI-COMM-LENGTH,
  9848           DFHEIV99,
  9849           DFHEIV99,
  9850           DFHEIV99
  9851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9852
  9853
  9854 7100-EXIT.
  9855      EXIT.
  9856
  9857 7200-RECOVER-TEMP-STORAGE.
  9858
  9859* EXEC CICS READQ TS
  9860*        QUEUE   (QID)
  9861*        INTO    (PROGRAM-INTERFACE-BLOCK)
  9862*        LENGTH  (PI-COMM-LENGTH)
  9863*    END-EXEC.
  9864*    MOVE '*$I    L              ''   #00008902' TO DFHEIV0
  9865     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9866     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9867     MOVE X'2020233030303038393032' TO DFHEIV0(25:11)
  9868     CALL 'kxdfhei1' USING DFHEIV0,
  9869           QID,
  9870           PROGRAM-INTERFACE-BLOCK,
  9871           PI-COMM-LENGTH,
  9872           DFHEIV99,
  9873           DFHEIV99,
  9874           DFHEIV99
  9875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9876
  9877
  9878     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9879
  9880 7200-EXIT.
  9881      EXIT.
  9882
  9883 7300-DELETE-TEMP-STORAGE.
  9884
  9885* EXEC CICS HANDLE CONDITION
  9886*        QIDERR  (7300-EXIT)
  9887*    END-EXEC.
  9888*    MOVE '"$N                   ! 3 #00008914' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 181
* EL677.cbl
  9889     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9891     MOVE X'3320233030303038393134' TO DFHEIV0(25:11)
  9892     CALL 'kxdfhei1' USING DFHEIV0
  9893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9894
  9895
  9896
  9897* EXEC CICS DELETEQ TS
  9898*        QUEUE  (QID)
  9899*    END-EXEC.
  9900*    MOVE '*&                    #   #00008918' TO DFHEIV0
  9901     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9902     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9903     MOVE X'2020233030303038393138' TO DFHEIV0(25:11)
  9904     CALL 'kxdfhei1' USING DFHEIV0,
  9905           QID,
  9906           DFHEIV99
  9907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9908
  9909
  9910 7300-EXIT.
  9911      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 182
* EL677.cbl
  9913 8035-LETR-NOT-OPEN.
  9914
  9915     MOVE ER-0013                TO EMI-ERROR.
  9916*    MOVE -1                     TO LETTER1L
  9917     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9918     GO TO 8200-SEND-DATAONLY.
  9919
  9920 8035-EXIT.
  9921     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 183
* EL677.cbl
  9923 8100-SEND-INITIAL-MAP.
  9924     MOVE SAVE-DATE              TO  DATEO.
  9925     MOVE EIBTIME                TO  TIME-IN.
  9926     MOVE TIME-OUT               TO  TIMEO.
  9927     MOVE -1                     TO  MAINTL
  9928     move al-uanon               to mainta
  9929     if PI-TO-EL677-FROM-EL1273
  9930        move al-sadof            to pf357a
  9931                                    pf46a
  9932                                    dprema
  9933                                    dcomma
  9934                                    drefa
  9935                                    duecomma
  9936                                    dprepda
  9937                                    prema
  9938                                    isscomma
  9939                                    refa
  9940                                    uecomma
  9941                                    prepda
  9942                                    dmaint2a
  9943        move ', VOID(V)'         to dmaint1o
  9944     end-if
  9945     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9946     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9947
  9948
  9949* EXEC CICS SEND
  9950*        MAP      (EL677A)
  9951*        MAPSET   (MAPSET-NAME)
  9952*        FROM     (EL677AO)
  9953*        ERASE
  9954*        CURSOR
  9955*    END-EXEC.
  9956     MOVE LENGTH OF
  9957      EL677AO
  9958       TO DFHEIV12
  9959     MOVE -1
  9960       TO DFHEIV11
  9961*    MOVE '8$     CT  E    H L F ,   #00008960' TO DFHEIV0
  9962     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9963     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9964     MOVE X'2020233030303038393630' TO DFHEIV0(25:11)
  9965     CALL 'kxdfhei1' USING DFHEIV0,
  9966           EL677A,
  9967           EL677AO,
  9968           DFHEIV12,
  9969           MAPSET-NAME,
  9970           DFHEIV99,
  9971           DFHEIV99,
  9972           DFHEIV99,
  9973           DFHEIV11,
  9974           DFHEIV99,
  9975           DFHEIV99,
  9976           DFHEIV99
  9977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9978
  9979
  9980     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 184
* EL677.cbl
  9982 8200-SEND-DATAONLY.
  9983     if connected-to-db
  9984        perform 4300-FINISH-UP-DB thru 4300-exit
  9985     end-if
  9986     MOVE SAVE-DATE              TO  DATEO.
  9987     MOVE EIBTIME                TO  TIME-IN.
  9988     MOVE TIME-OUT               TO  TIMEO.
  9989     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9990     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9991
  9992
  9993* EXEC CICS SEND
  9994*        MAP     (EL677A)
  9995*        MAPSET  (MAPSET-NAME)
  9996*        FROM    (EL677AO)
  9997*        DATAONLY
  9998*        CURSOR
  9999*    END-EXEC.
 10000     MOVE LENGTH OF
 10001      EL677AO
 10002       TO DFHEIV12
 10003     MOVE -1
 10004       TO DFHEIV11
 10005*    MOVE '8$D    CT       H L F ,   #00008980' TO DFHEIV0
 10006     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10007     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10008     MOVE X'2020233030303038393830' TO DFHEIV0(25:11)
 10009     CALL 'kxdfhei1' USING DFHEIV0,
 10010           EL677A,
 10011           EL677AO,
 10012           DFHEIV12,
 10013           MAPSET-NAME,
 10014           DFHEIV99,
 10015           DFHEIV99,
 10016           DFHEIV99,
 10017           DFHEIV11,
 10018           DFHEIV99,
 10019           DFHEIV99,
 10020           DFHEIV99
 10021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10022
 10023
 10024     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 185
* EL677.cbl
 10026 8300-SEND-TEXT.
 10027
 10028* EXEC CICS SEND TEXT
 10029*        FROM     (LOGOFF-TEXT)
 10030*        LENGTH   (LOGOFF-LENGTH)
 10031*        ERASE
 10032*        FREEKB
 10033*    END-EXEC.
 10034*    MOVE '8&      T  E F  H   F -   #00008991' TO DFHEIV0
 10035     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10036     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10037     MOVE X'2020233030303038393931' TO DFHEIV0(25:11)
 10038     CALL 'kxdfhei1' USING DFHEIV0,
 10039           LOGOFF-TEXT,
 10040           LOGOFF-LENGTH,
 10041           DFHEIV99,
 10042           DFHEIV99,
 10043           DFHEIV99,
 10044           DFHEIV99,
 10045           DFHEIV99,
 10046           DFHEIV99,
 10047           DFHEIV99,
 10048           DFHEIV99,
 10049           DFHEIV99,
 10050           DFHEIV99
 10051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10052
 10053
 10054
 10055* EXEC CICS RETURN
 10056*    END-EXEC.
 10057*    MOVE '.(                    ''   #00008998' TO DFHEIV0
 10058     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10059     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10060     MOVE X'2020233030303038393938' TO DFHEIV0(25:11)
 10061     CALL 'kxdfhei1' USING DFHEIV0,
 10062           DFHEIV99,
 10063           DFHEIV99,
 10064           DFHEIV99,
 10065           DFHEIV99,
 10066           DFHEIV99,
 10067           DFHEIV99
 10068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10069
 10070
 10071 8500-DATE-CONVERT.
 10072     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10073
 10074
 10075* EXEC CICS LINK
 10076*        PROGRAM    (PGM-NAME)
 10077*        COMMAREA   (DATE-CONVERSION-DATA)
 10078*        LENGTH     (DC-COMM-LENGTH)
 10079*    END-EXEC.
 10080*    MOVE '."C                   (   #00009004' TO DFHEIV0
 10081     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10082     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10083     MOVE X'2020233030303039303034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 186
* EL677.cbl
 10084     CALL 'kxdfhei1' USING DFHEIV0,
 10085           PGM-NAME,
 10086           DATE-CONVERSION-DATA,
 10087           DC-COMM-LENGTH,
 10088           DFHEIV99,
 10089           DFHEIV99,
 10090           DFHEIV99,
 10091           DFHEIV99
 10092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10093
 10094
 10095 8500-EXIT.
 10096      EXIT.
 10097
 10098 8600-DEEDIT.
 10099
 10100* EXEC CICS BIF DEEDIT
 10101*        FIELD   (WS-DEEDIT-FIELD)
 10102*        LENGTH  (10)
 10103*    END-EXEC.
 10104     MOVE 10
 10105       TO DFHEIV11
 10106*    MOVE '@"L                   #   #00009014' TO DFHEIV0
 10107     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10108     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10109     MOVE X'2020233030303039303134' TO DFHEIV0(25:11)
 10110     CALL 'kxdfhei1' USING DFHEIV0,
 10111           WS-DEEDIT-FIELD,
 10112           DFHEIV11
 10113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10114
 10115
 10116 8600-EXIT.
 10117      EXIT.
 10118
 10119 8700-DEEDIT.
 10120
 10121* EXEC CICS BIF DEEDIT
 10122*        FIELD   (WS-DT-DEEDIT-FIELD)
 10123*        LENGTH  (10)
 10124*    END-EXEC.
 10125     MOVE 10
 10126       TO DFHEIV11
 10127*    MOVE '@"L                   #   #00009023' TO DFHEIV0
 10128     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10129     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10130     MOVE X'2020233030303039303233' TO DFHEIV0(25:11)
 10131     CALL 'kxdfhei1' USING DFHEIV0,
 10132           WS-DT-DEEDIT-FIELD,
 10133           DFHEIV11
 10134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10135
 10136
 10137 8700-EXIT.
 10138      EXIT.
 10139
 10140 8800-UNAUTHORIZED-ACCESS.
 10141     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 187
* EL677.cbl
 10142     GO TO 8300-SEND-TEXT.
 10143
 10144 8810-PF23.
 10145     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10146     MOVE XCTL-005               TO  PGM-NAME.
 10147     GO TO 9300-XCTL.
 10148
 10149
 10150 9100-RETURN-TRAN.
 10151     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10152     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10153
 10154* EXEC CICS RETURN
 10155*        TRANSID  (TRANS-ID)
 10156*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10157*        LENGTH   (PI-COMM-LENGTH)
 10158*    END-EXEC.
 10159*    MOVE '.(CT                  ''   #00009044' TO DFHEIV0
 10160     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10161     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10162     MOVE X'2020233030303039303434' TO DFHEIV0(25:11)
 10163     CALL 'kxdfhei1' USING DFHEIV0,
 10164           TRANS-ID,
 10165           PROGRAM-INTERFACE-BLOCK,
 10166           PI-COMM-LENGTH,
 10167           DFHEIV99,
 10168           DFHEIV99,
 10169           DFHEIV99
 10170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10171
 10172
 10173
 10174* GOBACK.
 10175     MOVE '9%                    "   ' TO DFHEIV0
 10176     MOVE 'EL677' TO DFHEIV1
 10177     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10178     GOBACK.
 10179
 10180 9200-RETURN-MAIN-MENU.
 10181     MOVE XCTL-626               TO  PGM-NAME.
 10182     GO TO 9300-XCTL.
 10183
 10184 9300-XCTL.
 10185
 10186* EXEC CICS XCTL
 10187*        PROGRAM    (PGM-NAME)
 10188*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10189*        LENGTH     (PI-COMM-LENGTH)
 10190*    END-EXEC.
 10191*    MOVE '.$C                   %   #00009057' TO DFHEIV0
 10192     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10193     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10194     MOVE X'2020233030303039303537' TO DFHEIV0(25:11)
 10195     CALL 'kxdfhei1' USING DFHEIV0,
 10196           PGM-NAME,
 10197           PROGRAM-INTERFACE-BLOCK,
 10198           PI-COMM-LENGTH,
 10199           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 188
* EL677.cbl
 10200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10201
 10202
 10203 9400-CLEAR.
 10204     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10205     MOVE SPACES                 TO  PI-PFKEY.
 10206     GO TO 9300-XCTL.
 10207
 10208 9500-PF12.
 10209     MOVE XCTL-010               TO  PGM-NAME.
 10210     GO TO 9300-XCTL.
 10211
 10212 9600-PGMID-ERROR.
 10213
 10214* EXEC CICS HANDLE CONDITION
 10215*        PGMIDERR    (8300-SEND-TEXT)
 10216*    END-EXEC.
 10217*    MOVE '"$L                   ! 4 #00009073' TO DFHEIV0
 10218     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10220     MOVE X'3420233030303039303733' TO DFHEIV0(25:11)
 10221     CALL 'kxdfhei1' USING DFHEIV0
 10222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10223
 10224
 10225     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10226     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10227     MOVE XCTL-005               TO  PGM-NAME.
 10228     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10229     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10230
 10231     GO TO 9300-XCTL.
 10232
 10233 9900-ERROR-FORMAT.
 10234     IF NOT EMI-ERRORS-COMPLETE
 10235         MOVE LINK-001           TO  PGM-NAME
 10236
 10237* EXEC CICS LINK
 10238*            PROGRAM    (PGM-NAME)
 10239*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10240*            LENGTH     (EMI-COMM-LENGTH)
 10241*        END-EXEC.
 10242*    MOVE '."C                   (   #00009088' TO DFHEIV0
 10243     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10244     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10245     MOVE X'2020233030303039303838' TO DFHEIV0(25:11)
 10246     CALL 'kxdfhei1' USING DFHEIV0,
 10247           PGM-NAME,
 10248           ERROR-MESSAGE-INTERFACE-BLOCK,
 10249           EMI-COMM-LENGTH,
 10250           DFHEIV99,
 10251           DFHEIV99,
 10252           DFHEIV99,
 10253           DFHEIV99
 10254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10255
 10256
 10257 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 189
* EL677.cbl
 10258      EXIT.
 10259
 10260 9990-ABEND.
 10261     MOVE LINK-004               TO  PGM-NAME.
 10262     MOVE DFHEIBLK               TO  EMI-LINE1.
 10263
 10264* EXEC CICS LINK
 10265*        PROGRAM   (PGM-NAME)
 10266*        COMMAREA  (EMI-LINE1)
 10267*        LENGTH    (72)
 10268*    END-EXEC.
 10269     MOVE 72
 10270       TO DFHEIV11
 10271*    MOVE '."C                   (   #00009100' TO DFHEIV0
 10272     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10273     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10274     MOVE X'2020233030303039313030' TO DFHEIV0(25:11)
 10275     CALL 'kxdfhei1' USING DFHEIV0,
 10276           PGM-NAME,
 10277           EMI-LINE1,
 10278           DFHEIV11,
 10279           DFHEIV99,
 10280           DFHEIV99,
 10281           DFHEIV99,
 10282           DFHEIV99
 10283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10284
 10285
 10286     GO TO 8200-SEND-DATAONLY.
 10287
 10288 9995-SECURITY-VIOLATION.
 10289*                            COPY ELCSCTP.
 10290******************************************************************
 10291*                                                                *
 10292*                            ELCSCTP                             *
 10293*                            VMOD=2.001                          *
 10294*                                                                *
 10295*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10296******************************************************************
 10297
 10298
 10299     MOVE EIBDATE          TO SM-JUL-DATE.
 10300     MOVE EIBTRMID         TO SM-TERMID.
 10301     MOVE THIS-PGM         TO SM-PGM.
 10302     MOVE EIBTIME          TO TIME-IN.
 10303     MOVE TIME-OUT         TO SM-TIME.
 10304     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10305
 10306
 10307* EXEC CICS LINK
 10308*         PROGRAM  ('EL003')
 10309*         COMMAREA (SECURITY-MESSAGE)
 10310*         LENGTH   (80)
 10311*    END-EXEC.
 10312     MOVE 'EL003' TO DFHEIV1
 10313     MOVE 80
 10314       TO DFHEIV11
 10315*    MOVE '."C                   (   #00009126' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 190
* EL677.cbl
 10316     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10317     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10318     MOVE X'2020233030303039313236' TO DFHEIV0(25:11)
 10319     CALL 'kxdfhei1' USING DFHEIV0,
 10320           DFHEIV1,
 10321           SECURITY-MESSAGE,
 10322           DFHEIV11,
 10323           DFHEIV99,
 10324           DFHEIV99,
 10325           DFHEIV99,
 10326           DFHEIV99
 10327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10328
 10329
 10330******************************************************************
 10331
 10332
 10333 9995-EXIT.
 10334     EXIT.
 10335
 10336
 10337 9999-DFHBACK SECTION.
 10338     MOVE '9%                    "   ' TO DFHEIV0
 10339     MOVE 'EL677' TO DFHEIV1
 10340     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10341     GOBACK.
 10342 9999-DFHEXIT.
 10343     IF DFHEIGDJ EQUAL 0001
 10344         NEXT SENTENCE
 10345     ELSE IF DFHEIGDJ EQUAL 2
 10346         GO TO 9600-PGMID-ERROR,
 10347               9990-ABEND
 10348         DEPENDING ON DFHEIGDI
 10349     ELSE IF DFHEIGDJ EQUAL 3
 10350         GO TO 8100-SEND-INITIAL-MAP
 10351         DEPENDING ON DFHEIGDI
 10352     ELSE IF DFHEIGDJ EQUAL 4
 10353         GO TO 1290-NO-CARRIER
 10354         DEPENDING ON DFHEIGDI
 10355     ELSE IF DFHEIGDJ EQUAL 5
 10356         GO TO 1380-NO-STATE
 10357         DEPENDING ON DFHEIGDI
 10358     ELSE IF DFHEIGDJ EQUAL 6
 10359         GO TO 1480-ACCOUNT-INVALID,
 10360               1480-ACCOUNT-INVALID
 10361         DEPENDING ON DFHEIGDI
 10362     ELSE IF DFHEIGDJ EQUAL 7
 10363         GO TO 1590-EXIT
 10364         DEPENDING ON DFHEIGDI
 10365     ELSE IF DFHEIGDJ EQUAL 8
 10366         GO TO 2200-DUPREC
 10367         DEPENDING ON DFHEIGDI
 10368     ELSE IF DFHEIGDJ EQUAL 9
 10369         GO TO 2577-DUPREC
 10370         DEPENDING ON DFHEIGDI
 10371     ELSE IF DFHEIGDJ EQUAL 10
 10372         GO TO 2600-NO-CO-MASTER
 10373         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 12:00 Page 191
* EL677.cbl
 10374     ELSE IF DFHEIGDJ EQUAL 11
 10375         GO TO 3900-RECORD-NOTFND
 10376         DEPENDING ON DFHEIGDI
 10377     ELSE IF DFHEIGDJ EQUAL 12
 10378         GO TO 3287-DUPREC
 10379         DEPENDING ON DFHEIGDI
 10380     ELSE IF DFHEIGDJ EQUAL 13
 10381         GO TO 3390-EXIT,
 10382               3390-EXIT
 10383         DEPENDING ON DFHEIGDI
 10384     ELSE IF DFHEIGDJ EQUAL 14
 10385         GO TO 5560-END-OF-FILE,
 10386               5560-END-OF-FILE
 10387         DEPENDING ON DFHEIGDI
 10388     ELSE IF DFHEIGDJ EQUAL 15
 10389         GO TO 6070-NO-COMP-MSTR
 10390         DEPENDING ON DFHEIGDI
 10391     ELSE IF DFHEIGDJ EQUAL 16
 10392         GO TO 6170-NO-CERTIFICATE
 10393         DEPENDING ON DFHEIGDI
 10394     ELSE IF DFHEIGDJ EQUAL 17
 10395         GO TO 6470-NO-ADDRESS
 10396         DEPENDING ON DFHEIGDI
 10397     ELSE IF DFHEIGDJ EQUAL 18
 10398         GO TO 6670-NO-beneficiary
 10399         DEPENDING ON DFHEIGDI
 10400     ELSE IF DFHEIGDJ EQUAL 19
 10401         GO TO 7300-EXIT
 10402         DEPENDING ON DFHEIGDI
 10403     ELSE IF DFHEIGDJ EQUAL 20
 10404         GO TO 8300-SEND-TEXT
 10405         DEPENDING ON DFHEIGDI.
 10406     MOVE '9%                    "   ' TO DFHEIV0
 10407     MOVE 'EL677' TO DFHEIV1
 10408     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10409     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      142340     Code:       38518
