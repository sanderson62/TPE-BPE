* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   1
* EL6317.cbl
* Options: int("EL6317.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6317.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6317.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6317.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6317.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   2
* EL6317.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 071712 CR2011022800001  AJRA  NAPERSOFT CANCELS
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 100412   2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34* 121112   2012101700002  AJRA  CHANGE PF KEYS
    35* 121212   2012101700002  AJRA  ADD BILLING NOTE ENTRY
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    38* 120313   2013090300001  AJRA  NAPERSOFT PHASE 2
    39* 121713   2013090300001  AJRA  ADD ENCLOSURE CODE TO SCREEN
    40*-----------------------------------------------------------------
    41*REMARKS.
    42*        TRANSACTION - EXBD - CERTIFICATE VERIFICATION
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   3
* EL6317.cbl
    44 ENVIRONMENT DIVISION.
    45 DATA DIVISION.
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL6317 WORKING STORAGE    *'.
    50 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    51 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    52 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    53 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    54 77  s1                          pic s999 comp-3 value +0.
    55 77  s2                          pic s999 comp-3 value +0.
    56 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    57 77  WS-REASON-SW                PIC X  VALUE ' '.
    58     88  REASONS-FOUND                  VALUE 'Y'.
    59     88  REASONS-NOT-FOUND              VALUE 'N'.
    60 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    61     88  NO-CERT-RW                 VALUE 'N'.
    62     88  CERT-RW                    VALUE 'Y'.
    63 01  P pointer.
    64 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    65 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    66 01  var-ptr pointer.
    67 01  env-var-len                 pic 9(4)  binary.
    68 01  rc                          pic 9(9)  binary.
    69 01  WS-KIXHOST                  PIC X(10).
    70 01  WS-KIXSYS.
    71     05  WS-KIX-FIL1             PIC X(10).
    72     05  WS-KIX-APPS             PIC X(10).
    73     05  WS-KIX-ENV              PIC X(10).
    74     05  WS-KIX-MYENV            PIC X(10).
    75     05  WS-KIX-SYS              PIC X(10).
    76*                                COPY ELCSCTM.
    77******************************************************************
    78*                                                                *
    79*                                                                *
    80*                            ELCSCTM                             *
    81*                            VMOD=2.001                          *
    82*                                                                *
    83*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    84*                                                                *
    85******************************************************************
    86 01  SECURITY-MESSAGE.
    87     12  FILLER                          PIC X(30)
    88            VALUE '** LOGIC SECURITY VIOLATION -'.
    89     12  SM-READ                         PIC X(6).
    90     12  FILLER                          PIC X(5)
    91            VALUE ' PGM='.
    92     12  SM-PGM                          PIC X(6).
    93     12  FILLER                          PIC X(5)
    94            VALUE ' OPR='.
    95     12  SM-PROCESSOR-ID                 PIC X(4).
    96     12  FILLER                          PIC X(6)
    97            VALUE ' TERM='.
    98     12  SM-TERMID                       PIC X(4).
    99     12  FILLER                          PIC XX   VALUE SPACE.
   100     12  SM-JUL-DATE                     PIC 9(5).
   101     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   4
* EL6317.cbl
   102     12  SM-TIME                         PIC 99.99.
   103
   104*                                COPY ELCSCRTY.
   105******************************************************************
   106*                                                                *
   107*                                                                *
   108*                            ELCSCRTY                            *
   109*                            VMOD=2.001                          *
   110*                                                                *
   111*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   112*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   113*        SAVED IN PI-SECURITY-ADDRESS.                           *
   114*                                                                *
   115******************************************************************
   116 01  SECURITY-CONTROL.
   117     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   118     12  FILLER                       PIC XX    VALUE 'SC'.
   119     12  SC-CREDIT-CODES.
   120         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   121             20  SC-CREDIT-DISPLAY    PIC X.
   122             20  SC-CREDIT-UPDATE     PIC X.
   123     12  SC-CLAIMS-CODES.
   124         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   125             20  SC-CLAIMS-DISPLAY    PIC X.
   126             20  SC-CLAIMS-UPDATE     PIC X.
   127 01 srch-commarea.
   128*                                copy ELCADLTRSPI.
   129******************************************************************
   130*                   C H A N G E   L O G
   131*
   132* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   133*-----------------------------------------------------------------
   134*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   135* EFFECTIVE    NUMBER
   136*-----------------------------------------------------------------
   137* 060611    2011022800001  PEMA  NEW COPYBOOK
   138* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   139* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   140******************************************************************
   141****************************************
   142*  commarea for NaperSoft On Demand Admin services letters
   143*  (business logic input & output)
   144****************************************
   145     03  BL-INPUT.
   146         05  BL-DATA-SRCE        PIC X.
   147         05  BL-LETTER-ID        PIC XXXX.
   148         05  BL-CARRIER          PIC X.
   149         05  BL-GROUP            PIC X(6).
   150         05  BL-STATE            PIC XX.
   151         05  BL-ACCOUNT          PIC X(10).
   152         05  BL-EFF-DT           PIC X(10).
   153         05  BL-CERT-NO          PIC X(11).
   154         05  BL-BATCH-NO         PIC X(6).
   155         05  BL-BATCH-SEQ        PIC 9(8).
   156         05  BL-RESP-NO          PIC X(10).
   157         05  BL-NO-OF-COPIES     PIC 99.
   158         05  BL-PROC-ID          PIC XXXX.
   159         05  BL-COMP-ID          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   5
* EL6317.cbl
   160         05  BL-PRINT-NOW-SW     PIC X.
   161         05  BL-ENC-CD           PIC XXX.
   162         05  BL-RESEND-DT        PIC X(10).
   163         05  BL-FOLLOW-UP-DT     PIC X(10).
   164         05  BL-ARCHIVE-NO       PIC 9(8).
   165         05  BL-FUNC             PIC X(8).
   166         05  BL-COMMENTS         PIC X(100).
   167         05  FILLER REDEFINES BL-COMMENTS.
   168             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   169             10  BL-LETTER-TO-ACCT PIC X.
   170             10  BL-LETTER-TO-BENE PIC X.
   171             10  BL-WRITE-ERARCH   PIC X.
   172                 88  ERARCH-QWS      VALUE 'Q'.
   173                 88  ERARCH-BATCH    VALUE 'B'.
   174                 88  ERARCH-TEMP     VALUE 'T'.
   175             10  BL-PROCESS-TYPE PIC X(07).
   176             10  BL-CERT-FORM-ID PIC X(05).
   177             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   178             10  BL-SOURCE-SCREEN PIC X(8).
   179             10  FILLER          PIC X(25).
   180     03  BL-OUTPUT.
   181         05  BL-STATUS                   PIC X.
   182             88  BL-OK                      VALUE "P".
   183             88  BL-FAIL                  VALUE "F".
   184         05  BL-MESSAGE          PIC X(50).
   185     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   186     03  FILLER                  PIC X(31).
   187
   188*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   189*                                COPY ELCZREC.
   190******************************************************************
   191*                                                                *
   192*                                                                *
   193*                            ELCZREC.                            *
   194*                                                                *
   195*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   196*                                                                *
   197******************************************************************
   198*-----------------------------------------------------------------
   199*                   C H A N G E   L O G
   200*
   201* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   202*-----------------------------------------------------------------
   203*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   204* EFFECTIVE    NUMBER
   205*-----------------------------------------------------------------
   206* 122011    2011022800001  AJRA  NEW FILE
   207* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   208* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   209* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   210* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   211*-----------------------------------------------------------------
   212 01  W-Z-CONTROL-DATA.
   213     05  W-NUMBER-OF-COPIES      PIC  9.
   214     05  FILLER                  PIC  X.
   215     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   216     05  FILLER                  PIC  X.
   217     05  W-DAYS-TO-RESEND        PIC  999.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   6
* EL6317.cbl
   218     05  FILLER                  PIC  X.
   219     05  W-FORM-TO-RESEND        PIC  X(4).
   220     05  W-ADD-BAR-CODE          PIC  X.
   221     05  W-PROMPT-LETTER         PIC  X.
   222     05  W-HAS-RETURN-ENV        PIC  X.
   223     05  W-ENCLOSURE-CD          PIC  XXX.
   224     05  W-SIG-FLAG-DEFAULT      PIC  X.
   225     05  W-AUTO-CLOSE-IND        PIC  X.
   226     05  FILLER                  PIC  X.
   227     05  W-LETTER-TO-BENE        PIC  X.
   228     05  FILLER                  PIC  X.
   229     05  W-LETTER-TO-ACCT        PIC  X.
   230     05  FILLER                  PIC  X.
   231     05  W-LETTER-TYPE           PIC  X.
   232     05  FILLER                  PIC  X.
   233     05  W-PRINT-CERTIFICATE     PIC  X.
   234     05  FILLER                  PIC  X.
   235     05  W-REFUND-REQUIRED       PIC  X.
   236     05  FILLER                  PIC  X.
   237     05  W-ONBASE-CODE           PIC  XX.
   238     05  FILLER                  PIC  X.
   239     05  W-ACCT-SUMM             PIC  X.
   240     05  FILLER                  PIC  X.
   241     05  W-CSO-SUMM              PIC  X.
   242     05  FILLER                  PIC  X.
   243     05  W-REASONS-REQUIRED      PIC  X.
   244     05  FILLER                  PIC  X(29).
   245 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   246 01  STANDARD-AREAS.
   247     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   248     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   249                                 PIC  X(08).
   250     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   251     12  QID.
   252         16  QID-TERM        PIC X(4)    VALUE SPACES.
   253         16  FILLER          PIC X(4)    VALUE '631J'.
   254     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   255     12  TIME-MT                 PIC S9(7).
   256     12  TIME-MT-R  REDEFINES TIME-MT.
   257         16  FILLER              PIC X.
   258         16  TIME-LMT            PIC 99V99.
   259         16  FILLER              PIC X(2).
   260     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   261     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   262     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   263     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   264     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   265     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   266     12  ELENCC-LENGTH           PIC S9(04) VALUE +400 COMP.
   267     12  W-CNTL-KEY.
   268         16  W-CNTL-COMPANY-ID   PIC  X(03).
   269         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   270         16  W-CNTL-GENL.
   271             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   272             20  W-CNTL-GEN2.
   273                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   274                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   275         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   7
* EL6317.cbl
   276     12  WS-ELCERT-KEY.
   277         16  W-CERT-COMPANY-CD   PIC X.
   278         16  W-CERT-CARRIER      PIC X.
   279         16  W-CERT-GROUPING     PIC X(6).
   280         16  W-CERT-STATE        PIC XX.
   281         16  W-CERT-ACCOUNT      PIC X(10).
   282         16  W-CERT-CERT-EFF-DT  PIC XX.
   283         16  W-CERT-CERT-PRIME   PIC X(10).
   284         16  W-CERT-CERT-SFX     PIC X.
   285
   286     12  WS-ELCRTT-KEY.
   287         16  WS-ELCRTT-PRIMARY   PIC X(33).
   288         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   289     12  ELCRTT-RECORD-LENGTH    PIC S9(4) COMP VALUE +552.
   290     12  ELCRTT-JOURNAL-LENGTH   PIC S9(4) COMP VALUE +575.
   291
   292     12  WS-ELEOBC-KEY.
   293         16  WS-EOBC-COMPANY-CD  PIC X.
   294         16  WS-EOBC-REC-TYPE    PIC X.
   295         16  WS-EOBC-CODE        PIC X(4).
   296         16  FILLER              PIC X(9).
   297     12  WS-ERNOTE-KEY.
   298         16  W-NOTE-COMPANY-CD   PIC X.
   299         16  W-NOTE-CARRIER      PIC X.
   300         16  W-NOTE-GROUPING     PIC X(6).
   301         16  W-NOTE-STATE        PIC XX.
   302         16  W-NOTE-ACCOUNT      PIC X(10).
   303         16  W-NOTE-CERT-EFF-DT  PIC XX.
   304         16  W-NOTE-CERT-PRIME   PIC X(10).
   305         16  W-NOTE-CERT-SFX     PIC X.
   306     12  ELLETR-KEY.
   307         16  LETR-PART-KEY.
   308             20  LETR-COMPANY-CD PIC X.
   309             20  LETR-LETTER-ID  PIC X(4).
   310         16  LETR-FILLER         PIC X(8).
   311         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   312     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   313     12  ERPNDB2-KEY.
   314         16  PNDB2-COMPANY-CD    PIC X.
   315         16  PNDB2-CARRIER       PIC X.
   316         16  PNDB2-GROUPING      PIC X(6).
   317         16  PNDB2-STATE         PIC XX.
   318         16  PNDB2-ACCOUNT       PIC X(10).
   319         16  PNDB2-CERT-EFF-DT   PIC XX.
   320         16  PNDB2-CERT-PRIME    PIC X(10).
   321         16  PNDB2-CERT-SFX      PIC X.
   322         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   323         16  PNDB2-RECORD-TYPE   PIC X.
   324     12  ERPNDB-KEY.
   325         16  PNDB-COMPANY-CD     PIC X.
   326         16  PNDB-BATCH-NO       PIC X(6).
   327         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   328         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   329     12  ERENDT-KEY.
   330         16  ENDT-COMPANY-CD       PIC X.
   331         16  ENDT-CARRIER          PIC X.
   332         16  ENDT-GROUPING         PIC X(6).
   333         16  ENDT-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   8
* EL6317.cbl
   334         16  ENDT-ACCOUNT          PIC X(10).
   335         16  ENDT-CERT-EFF-DT      PIC XX.
   336         16  ENDT-CERT-PRIME       PIC X(10).
   337         16  ENDT-CERT-SFX         PIC X.
   338         16  ENDT-RECORD-TYPE      PIC X.
   339         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   340     12  ELCRTO-KEY.
   341         16  CRTO-COMPANY-CD     PIC X.
   342         16  CRTO-CARRIER        PIC X.
   343         16  CRTO-GROUPING       PIC X(6).
   344         16  CRTO-STATE          PIC XX.
   345         16  CRTO-ACCOUNT        PIC X(10).
   346         16  CRTO-CERT-EFF-DT    PIC XX.
   347         16  CRTO-CERT-PRIME     PIC X(10).
   348         16  CRTO-CERT-SFX       PIC X.
   349         16  CRTO-RECORD-TYPE    PIC X.
   350         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   351     12  WS-ERMAIL-KEY.
   352         16  MAIL-COMPANY-CD     PIC X.
   353         16  MAIL-CARRIER        PIC X.
   354         16  MAIL-GROUPING       PIC X(6).
   355         16  MAIL-STATE          PIC XX.
   356         16  MAIL-ACCOUNT        PIC X(10).
   357         16  MAIL-CERT-EFF-DT    PIC XX.
   358         16  MAIL-CERT-PRIME     PIC X(10).
   359         16  MAIL-CERT-SFX       PIC X.
   360
   361     12  WS-ELENCC-KEY.
   362         16  WS-ENCC-COMPANY-CD  PIC X.
   363         16  WS-ENCC-REC-TYPE    PIC X.
   364         16  WS-ENCC-ENC-CODE    PIC X(5).
   365         16  FILLER              PIC X(09).
   366
   367     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   368     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   369     12  WS-CURRENT-DT.
   370         16  FILLER              PIC X(6)    VALUE SPACES.
   371         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   372     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   373     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   374         88  CANCEL-REC            VALUE 'C'.
   375         88  ISSUE-REC             VALUE 'I'.
   376     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   377     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   378     12  ELCNTL-KEY.
   379         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   380         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   381         16  CNTL-ACCESS.
   382             20  CNTL-STATE      PIC XX    VALUE SPACES.
   383             20  FILLER          PIC X     VALUE SPACES.
   384             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   385         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   386     12  ERACCT-KEY.
   387         16  ERACCT-COMP-KEY.
   388             20  ACCT-CO         PIC X     VALUE SPACES.
   389             20  ACCT-CARRIER    PIC X     VALUE SPACES.
   390             20  ACCT-GROUPING   PIC X(6)  VALUE SPACES.
   391             20  ACCT-STATE      PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   9
* EL6317.cbl
   392             20  ACCT-ACCOUNT    PIC X(10) VALUE SPACES.
   393         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   394         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   395     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   396     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   397     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   398     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   399     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   400     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   401     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   402     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   403     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   404     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   405     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   406     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   407     12  WS-ELENCC-FILE-ID       PIC X(8) VALUE 'ELENCC'.
   408     12  WS-RESPONSE             PIC S9(8)   COMP.
   409         88  RESP-NORMAL                  VALUE +00.
   410         88  RESP-NOTFND                  VALUE +13.
   411         88  RESP-DUPREC                  VALUE +14.
   412         88  RESP-DUPKEY                  VALUE +15.
   413         88  RESP-NOTOPEN                 VALUE +19.
   414         88  RESP-ENDFILE                 VALUE +20.
   415     12  MAP-NAME            PIC X(8)    VALUE 'EL631J'.
   416     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6317S'.
   417     12  SCREEN-NUMBER       PIC X(4)    VALUE '631J'.
   418     12  TRANS-ID            PIC X(4)    VALUE 'EXBD'.
   419     12  THIS-PGM            PIC X(8)    VALUE 'EL6317'.
   420     12  PGM-NAME            PIC X(8).
   421     12  TIME-IN             PIC S9(7).
   422     12  TIME-OUT-R  REDEFINES TIME-IN.
   423         16  FILLER          PIC X.
   424         16  TIME-OUT        PIC 99V99.
   425         16  FILLER          PIC X(2).
   426     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   427     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   428     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   429     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   430     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   431     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   432     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   433     12  WS-PHONE.
   434         16  WS-PH1              PIC XXX.
   435         16  WS-PH2              PIC XXX.
   436         16  WS-PH3              PIC XXXX.
   437     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   438     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   439
   440     12  WS-BILLING-NOTE.
   441         16  WS-BN-NOTE          PIC X(25).
   442         16  WS-BN-LTRID         PIC X(4).
   443         16  FILLER              PIC X(3).
   444         16  WS-BN-DATE          PIC X(8).
   445         16  FILLER              PIC X(3).
   446         16  WS-BN-USERID        PIC X(4).
   447         16  FILLER              PIC X(30).
   448     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   449         16  WS-MAN-BN-NOTE      PIC X(63).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  10
* EL6317.cbl
   450         16  FILLER              PIC X(14).
   451     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   452
   453 01  NEW-ELCRTO-REC.
   454     12  NEW-ELCRTO-KEY.
   455         16  NCRTO-COMPANY-CD      PIC X.
   456         16  NCRTO-CARRIER         PIC X.
   457         16  NCRTO-GROUPING        PIC X(6).
   458         16  NCRTO-STATE           PIC XX.
   459         16  NCRTO-ACCOUNT         PIC X(10).
   460         16  NCRTO-CERT-EFF-DT     PIC XX.
   461         16  NCRTO-CERT-PRIME      PIC X(10).
   462         16  NCRTO-CERT-SFX        PIC X.
   463         16  NCRTO-RECORD-TYPE     PIC X.
   464         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   465     12  NEW-ORIG-REC.
   466         16  NCRTO-INS-LAST-NAME   PIC X(15).
   467         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   468         16  NCRTO-INS-MIDDLE-INIT PIC X.
   469         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   470         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   471         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   472         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   473         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   474         16  NCRTO-LF-BENCD        PIC XX.
   475         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   476         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   477         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   478         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   479         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   480         16  NCRTO-LF-EXP-DT       PIC XX.
   481         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   482         16  NCRTO-LF-CANCEL-DT    PIC XX.
   483         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   484         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   485         16  NCRTO-AH-BENCD        PIC XX.
   486         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   487         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   488         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   489         16  NCRTO-AH-EXP-DT       PIC XX.
   490         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   491         16  NCRTO-AH-CP           PIC 99.
   492         16  NCRTO-AH-CANCEL-DT    PIC XX.
   493         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   494         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   495         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   496         16  NCRTO-1ST-PMT-DT      PIC XX.
   497         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   498         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
   499         16  NCRTO-ISSUE-TRAN-IND  PIC X.
   500         16  NCRTO-CANCEL-TRAN-IND PIC X.
   501         16  FILLER                PIC X(235).
   502
   503 01  CERT-NOTE-ENTRIES.
   504     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   505         16  CERT-NT-TEXT                PIC X(63).
   506         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   507         16  CERT-NT-LAST-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  11
* EL6317.cbl
   508         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   509
   510 01  ERCNOT-AREA.
   511     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   512     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   513     12  ERCNOT-KEY.
   514         16  ERCNOT-PARTIAL-KEY.
   515             20 ERCNOT-COMPANY-CD    PIC X.
   516             20 ERCNOT-CARRIER       PIC X.
   517             20 ERCNOT-GROUPING      PIC X(06).
   518             20 ERCNOT-STATE         PIC XX.
   519             20 ERCNOT-ACCOUNT       PIC X(10).
   520             20 ERCNOT-EFF-DT        PIC XX.
   521             20 ERCNOT-CERT-NO.
   522                25 ERCNOT-CERT-PRIME PIC X(10).
   523                25 ERCNOT-CERT-SFX   PIC X.
   524             20 ERCNOT-REC-TYP       PIC X.
   525         16 ERCNOT-SEQ           PIC S9(4) COMP.
   526     12  SV-PARTIAL-KEY.
   527         20 SV-COMPANY-CD            PIC X.
   528         20 SV-CARRIER               PIC X.
   529         20 SV-GROUPING              PIC X(06).
   530         20 SV-STATE                 PIC XX.
   531         20 SV-ACCOUNT               PIC X(10).
   532         20 SV-EFF-DT                PIC XX.
   533         20 SV-CERT-NO.
   534            25 SV-CERT-PRIME         PIC X(10).
   535            25 SV-CERT-SFX           PIC X(1).
   536         20 SV-REC-TYP               PIC X.
   537 01  ERROR-MESSAGES.
   538     12  ER-0000                 PIC X(4)  VALUE '0000'.
   539     12  ER-0004                 PIC X(4)  VALUE '0004'.
   540     12  ER-0008                 PIC X(4)  VALUE '0008'.
   541     12  ER-0023                 PIC X(4)  VALUE '0023'.
   542     12  ER-0029                 PIC X(4)  VALUE '0029'.
   543     12  ER-0068                 PIC X(4)  VALUE '0068'.
   544     12  ER-0132                 PIC X(4)  VALUE '0132'.
   545     12  ER-0142                 PIC X(4)  VALUE '0142'.
   546     12  ER-0148                 PIC X(4)  VALUE '0148'.
   547     12  ER-0215                 PIC X(4)  VALUE '0215'.
   548     12  ER-0280                 PIC X(4)  VALUE '0280'.
   549     12  ER-0348                 PIC X(4)  VALUE '0348'.
   550     12  ER-0419                 PIC X(4)  VALUE '0419'.
   551     12  ER-0894                 PIC X(4)  VALUE '0894'.
   552     12  ER-1101                 PIC X(4)  VALUE '1101'.
   553     12  ER-1236                 PIC X(4)  VALUE '1236'.
   554     12  ER-1560                 PIC X(4)  VALUE '1560'.
   555     12  ER-1818                 PIC X(4)  VALUE '1818'.
   556     12  ER-1820                 PIC X(4)  VALUE '1820'.
   557     12  ER-2056                 PIC X(4)  VALUE '2056'.
   558     12  ER-2079                 PIC X(4)  VALUE '2079'.
   559     12  ER-2208                 PIC X(4)  VALUE '2208'.
   560     12  ER-2209                 PIC X(4)  VALUE '2209'.
   561     12  ER-2237                 PIC X(4)  VALUE '2237'.
   562     12  ER-2238                 PIC X(4)  VALUE '2238'.
   563     12  ER-2253                 PIC X(4)  VALUE '2253'.
   564     12  ER-2619                 PIC X(4)  VALUE '2619'.
   565     12  ER-2651                 PIC X(4)  VALUE '2651'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  12
* EL6317.cbl
   566     12  ER-2784                 PIC X(4)  VALUE '2784'.
   567     12  ER-2785                 PIC X(4)  VALUE '2785'.
   568     12  ER-2786                 PIC X(4)  VALUE '2786'.
   569     12  ER-2791                 PIC X(4)  VALUE '2791'.
   570     12  ER-2845                 PIC X(4)  VALUE '2845'.
   571     12  ER-2848                 PIC X(4)  VALUE '2848'.
   572     12  ER-2851                 PIC X(4)  VALUE '2851'.
   573     12  ER-3830                 PIC X(4)  VALUE '3830'.
   574     12  ER-3833                 PIC X(4)  VALUE '3833'.
   575     12  ER-7345                 PIC X(4)  VALUE '7345'.
   576     12  ER-7638                 PIC X(4)  VALUE '7638'.
   577     12  ER-8888                 PIC X(4)  VALUE '8888'.
   578     12  ER-9999                 PIC X(4)  VALUE '9999'.
   579*    COPY ELCDATE.
   580******************************************************************
   581*                                                                *
   582*                                                                *
   583*                            ELCDATE.                            *
   584*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   585*                            VMOD=2.003
   586*                                                                *
   587*                                                                *
   588*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   589*                 LENGTH = 200                                   *
   590******************************************************************
   591
   592 01  DATE-CONVERSION-DATA.
   593     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   594     12  DC-OPTION-CODE                PIC X.
   595         88  BIN-TO-GREG                VALUE ' '.
   596         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   597         88  EDIT-GREG-TO-BIN           VALUE '2'.
   598         88  YMD-GREG-TO-BIN            VALUE '3'.
   599         88  MDY-GREG-TO-BIN            VALUE '4'.
   600         88  JULIAN-TO-BIN              VALUE '5'.
   601         88  BIN-PLUS-ELAPSED           VALUE '6'.
   602         88  FIND-CENTURY               VALUE '7'.
   603         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   604         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   605         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   606         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   607         88  JULIAN-TO-BIN-3            VALUE 'C'.
   608         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   609         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   610         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   611         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   612         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   613         88  CHECK-LEAP-YEAR            VALUE 'H'.
   614         88  BIN-3-TO-GREG              VALUE 'I'.
   615         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   616         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   617         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   618         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   619         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   620         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   621         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   622         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   623         88  THREE-CHARACTER-BIN
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  13
* EL6317.cbl
   624                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   625         88  GREGORIAN-TO-BIN
   626                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   627         88  BIN-TO-GREGORIAN
   628                  VALUES ' ' '1' 'I' '8' 'G'.
   629         88  JULIAN-TO-BINARY
   630                  VALUES '5' 'C' 'E' 'F'.
   631     12  DC-ERROR-CODE                 PIC X.
   632         88  NO-CONVERSION-ERROR        VALUE ' '.
   633         88  DATE-CONVERSION-ERROR
   634                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   635         88  DATE-IS-ZERO               VALUE '1'.
   636         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   637         88  DATE-IS-INVALID            VALUE '3'.
   638         88  DATE1-GREATER-DATE2        VALUE '4'.
   639         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   640         88  DATE-INVALID-OPTION        VALUE '9'.
   641         88  INVALID-CENTURY            VALUE 'A'.
   642         88  ONLY-CENTURY               VALUE 'B'.
   643         88  ONLY-LEAP-YEAR             VALUE 'C'.
   644         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   645     12  DC-END-OF-MONTH               PIC X.
   646         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   647     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   648         88  USE-NORMAL-PROCESS         VALUE ' '.
   649         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   650         88  ADJUST-UP-100-YRS          VALUE '2'.
   651     12  FILLER                        PIC X.
   652     12  DC-CONVERSION-DATES.
   653         16  DC-BIN-DATE-1             PIC XX.
   654         16  DC-BIN-DATE-2             PIC XX.
   655         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   656         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   657                       DC-GREG-DATE-1-EDIT.
   658             20  DC-EDIT1-MONTH        PIC 99.
   659             20  SLASH1-1              PIC X.
   660             20  DC-EDIT1-DAY          PIC 99.
   661             20  SLASH1-2              PIC X.
   662             20  DC-EDIT1-YEAR         PIC 99.
   663         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   664         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   665                     DC-GREG-DATE-2-EDIT.
   666             20  DC-EDIT2-MONTH        PIC 99.
   667             20  SLASH2-1              PIC X.
   668             20  DC-EDIT2-DAY          PIC 99.
   669             20  SLASH2-2              PIC X.
   670             20  DC-EDIT2-YEAR         PIC 99.
   671         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   672         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   673                     DC-GREG-DATE-1-YMD.
   674             20  DC-YMD-YEAR           PIC 99.
   675             20  DC-YMD-MONTH          PIC 99.
   676             20  DC-YMD-DAY            PIC 99.
   677         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   678         16  DC-GREG-DATE-1-MDY-R REDEFINES
   679                      DC-GREG-DATE-1-MDY.
   680             20  DC-MDY-MONTH          PIC 99.
   681             20  DC-MDY-DAY            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  14
* EL6317.cbl
   682             20  DC-MDY-YEAR           PIC 99.
   683         16  DC-GREG-DATE-1-ALPHA.
   684             20  DC-ALPHA-MONTH        PIC X(10).
   685             20  DC-ALPHA-DAY          PIC 99.
   686             20  FILLER                PIC XX.
   687             20  DC-ALPHA-CENTURY.
   688                 24 DC-ALPHA-CEN-N     PIC 99.
   689             20  DC-ALPHA-YEAR         PIC 99.
   690         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   691         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   692         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   693         16  DC-JULIAN-DATE            PIC 9(05).
   694         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   695                                       PIC 9(05).
   696         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   697             20  DC-JULIAN-YEAR        PIC 99.
   698             20  DC-JULIAN-DAYS        PIC 999.
   699         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   700         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   701         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   702     12  DATE-CONVERSION-VARIBLES.
   703         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   704         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   705             20  FILLER                PIC 9(3).
   706             20  HOLD-CEN-1-CCYY.
   707                 24  HOLD-CEN-1-CC     PIC 99.
   708                 24  HOLD-CEN-1-YY     PIC 99.
   709             20  HOLD-CEN-1-MO         PIC 99.
   710             20  HOLD-CEN-1-DA         PIC 99.
   711         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   712             20  HOLD-CEN-1-R-MO       PIC 99.
   713             20  HOLD-CEN-1-R-DA       PIC 99.
   714             20  HOLD-CEN-1-R-CCYY.
   715                 24  HOLD-CEN-1-R-CC   PIC 99.
   716                 24  HOLD-CEN-1-R-YY   PIC 99.
   717             20  FILLER                PIC 9(3).
   718         16  HOLD-CENTURY-1-X.
   719             20  FILLER                PIC X(3)  VALUE SPACES.
   720             20  HOLD-CEN-1-X-CCYY.
   721                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   722                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   723             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   724             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   725         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   726             20  HOLD-CEN-1-R-X-MO     PIC XX.
   727             20  HOLD-CEN-1-R-X-DA     PIC XX.
   728             20  HOLD-CEN-1-R-X-CCYY.
   729                 24  HOLD-CEN-1-R-X-CC PIC XX.
   730                 24  HOLD-CEN-1-R-X-YY PIC XX.
   731             20  FILLER                PIC XXX.
   732         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   733         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   734         16  DC-JULIAN-DATE-1          PIC 9(07).
   735         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   736             20  DC-JULIAN-1-CCYY.
   737                 24  DC-JULIAN-1-CC    PIC 99.
   738                 24  DC-JULIAN-1-YR    PIC 99.
   739             20  DC-JULIAN-DA-1        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  15
* EL6317.cbl
   740         16  DC-JULIAN-DATE-2          PIC 9(07).
   741         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   742             20  DC-JULIAN-2-CCYY.
   743                 24  DC-JULIAN-2-CC    PIC 99.
   744                 24  DC-JULIAN-2-YR    PIC 99.
   745             20  DC-JULIAN-DA-2        PIC 999.
   746         16  DC-GREG-DATE-A-EDIT.
   747             20  DC-EDITA-MONTH        PIC 99.
   748             20  SLASHA-1              PIC X VALUE '/'.
   749             20  DC-EDITA-DAY          PIC 99.
   750             20  SLASHA-2              PIC X VALUE '/'.
   751             20  DC-EDITA-CCYY.
   752                 24  DC-EDITA-CENT     PIC 99.
   753                 24  DC-EDITA-YEAR     PIC 99.
   754         16  DC-GREG-DATE-B-EDIT.
   755             20  DC-EDITB-MONTH        PIC 99.
   756             20  SLASHB-1              PIC X VALUE '/'.
   757             20  DC-EDITB-DAY          PIC 99.
   758             20  SLASHB-2              PIC X VALUE '/'.
   759             20  DC-EDITB-CCYY.
   760                 24  DC-EDITB-CENT     PIC 99.
   761                 24  DC-EDITB-YEAR     PIC 99.
   762         16  DC-GREG-DATE-CYMD         PIC 9(08).
   763         16  DC-GREG-DATE-CYMD-R REDEFINES
   764                              DC-GREG-DATE-CYMD.
   765             20  DC-CYMD-CEN           PIC 99.
   766             20  DC-CYMD-YEAR          PIC 99.
   767             20  DC-CYMD-MONTH         PIC 99.
   768             20  DC-CYMD-DAY           PIC 99.
   769         16  DC-GREG-DATE-MDCY         PIC 9(08).
   770         16  DC-GREG-DATE-MDCY-R REDEFINES
   771                              DC-GREG-DATE-MDCY.
   772             20  DC-MDCY-MONTH         PIC 99.
   773             20  DC-MDCY-DAY           PIC 99.
   774             20  DC-MDCY-CEN           PIC 99.
   775             20  DC-MDCY-YEAR          PIC 99.
   776    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   777        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   778    12  DC-EL310-DATE                  PIC X(21).
   779    12  FILLER                         PIC X(28).
   780*    COPY ELCTEXT.
   781******************************************************************
   782*                                                                *
   783*                                                                *
   784*                            ELCTEXT.                            *
   785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   786*                            VMOD=2.008                          *
   787*                                                                *
   788*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   789*                                     FORM LETTERS,              *
   790*                                     CERT FORM DISPLAY.
   791*                                                                *
   792*   FILE TYPE = VSAM,KSDS                                        *
   793*   RECORD SIZE = 100   RECFORM = FIXED                          *
   794*                                                                *
   795*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   796*       ALTERNATE INDEX = NONE                                   *
   797*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  16
* EL6317.cbl
   798*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   799*       ALTERNATE INDEX = NONE                                   *
   800*                                                                *
   801*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   802*       ALTERNATE INDEX = NONE                                   *
   803*                                                                *
   804*   LOG = NO                                                     *
   805*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   806******************************************************************
   807 01  TEXT-FILES.
   808     12  TEXT-FILE-ID                PIC XX.
   809         88  FORMS-FILE-TEXT            VALUE 'TF'.
   810         88  LETTER-FILE-TEXT           VALUE 'TL'.
   811         88  HELP-FILE-TEXT             VALUE 'TH'.
   812
   813     12  TX-CONTROL-PRIMARY.
   814         16  TX-COMPANY-CD           PIC X.
   815             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   816         16  TX-ACCESS-CD-GENL       PIC X(12).
   817
   818         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   819             20  TX-LETTER-NO        PIC X(4).
   820             20  FILLER              PIC X(8).
   821
   822         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   823             20  TX-FORM-NO          PIC X(12).
   824
   825         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   826             20  TX-HELP-TYPE        PIC X.
   827                 88  HELP-FOR-GENERAL   VALUE ' '.
   828                 88  HELP-BY-SCREEN     VALUE 'S'.
   829                 88  HELP-BY-ERROR      VALUE 'E'.
   830             20  TX-SCREEN-OR-ERROR  PIC X(4).
   831                 88  GENERAL-INFO-HELP  VALUE '0000'.
   832             20  TX-HELP-FOR-COMPANY  PIC XXX.
   833                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   834             20  FILLER              PIC X(4).
   835
   836         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   837
   838     12  TX-PROCESS-CONTROL          PIC XX.
   839         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   840
   841     12  TX-TEXT-LINE                PIC X(70).
   842
   843     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   844         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   845         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   846         88  TX-VALID-FORM-SQUEEZE-VALUE
   847                                        VALUE 'Y' ' '.
   848
   849     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   850         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   851         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   852         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   853         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   854         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   855         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  17
* EL6317.cbl
   856         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   857                                              'K' 'N' ' '
   858                                              'Z'.
   859
   860     12  TX-ARCHIVE-SW               PIC X.
   861         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   862         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   863         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   864
   865     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   866     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   867
   868     12  TX-BSR-CODE                 PIC X.
   869         88  TX-BSR-LETTER              VALUE 'B'.
   870         88  TX-NON-BSR-LETTER          VALUE ' '.
   871
   872     12  FILLER                      PIC X.
   873*****************************************************************
   874*    COPY ELCLOGOF.
   875******************************************************************
   876*                                                                *
   877*                                                                *
   878*                            ELCLOGOF.                           *
   879*                            VMOD=2.001                          *
   880*                                                                *
   881*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   882*                                                                *
   883******************************************************************
   884 01  CLASIC-LOGOFF.
   885     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   886     12  LOGOFF-TEXT.
   887         16  FILLER          PIC X(5)    VALUE SPACES.
   888         16  LOGOFF-MSG.
   889             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   890             20  FILLER      PIC X       VALUE SPACES.
   891             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   892         16  FILLER          PIC X(80)
   893           VALUE '* YOU ARE NOW LOGGED OFF'.
   894         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   895         16  FILLER          PIC X       VALUE QUOTE.
   896         16  LOGOFF-SYS-MSG  PIC X(17)
   897           VALUE 'S CLAS-IC SYSTEM '.
   898     12  TEXT-MESSAGES.
   899         16  UNACCESS-MSG    PIC X(29)
   900             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   901         16  PGMIDERR-MSG    PIC X(17)
   902             VALUE 'PROGRAM NOT FOUND'.
   903*    COPY ELCATTR.
   904******************************************************************
   905*                                                                *
   906*                            ELCATTR.                            *
   907*                            VMOD=2.001                          *
   908*                                                                *
   909*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   910*                                                                *
   911*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   912*                                                                *
   913*                   POS 1   P=PROTECTED                          *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  18
* EL6317.cbl
   914*                           U=UNPROTECTED                        *
   915*                           S=ASKIP                              *
   916*                   POS 2   A=ALPHA/NUMERIC                      *
   917*                           N=NUMERIC                            *
   918*                   POS 3   N=NORMAL                             *
   919*                           B=BRIGHT                             *
   920*                           D=DARK                               *
   921*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   922*                           OF=MODIFIED DATA TAG OFF             *
   923*                                                                *
   924*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   925******************************************************************
   926 01  ATTRIBUTE-LIST.
   927     12  AL-PABOF            PIC X       VALUE 'Y'.
   928     12  AL-PABON            PIC X       VALUE 'Z'.
   929     12  AL-PADOF            PIC X       VALUE '%'.
   930     12  AL-PADON            PIC X       VALUE '_'.
   931     12  AL-PANOF            PIC X       VALUE '-'.
   932     12  AL-PANON            PIC X       VALUE '/'.
   933     12  AL-SABOF            PIC X       VALUE '8'.
   934     12  AL-SABON            PIC X       VALUE '9'.
   935     12  AL-SADOF            PIC X       VALUE '@'.
   936     12  AL-SADON            PIC X       VALUE QUOTE.
   937     12  AL-SANOF            PIC X       VALUE '0'.
   938     12  AL-SANON            PIC X       VALUE '1'.
   939     12  AL-UABOF            PIC X       VALUE 'H'.
   940     12  AL-UABON            PIC X       VALUE 'I'.
   941     12  AL-UADOF            PIC X       VALUE '<'.
   942     12  AL-UADON            PIC X       VALUE '('.
   943     12  AL-UANOF            PIC X       VALUE ' '.
   944     12  AL-UANON            PIC X       VALUE 'A'.
   945     12  AL-UNBOF            PIC X       VALUE 'Q'.
   946     12  AL-UNBON            PIC X       VALUE 'R'.
   947     12  AL-UNDOF            PIC X       VALUE '*'.
   948     12  AL-UNDON            PIC X       VALUE ')'.
   949     12  AL-UNNOF            PIC X       VALUE '&'.
   950     12  AL-UNNON            PIC X       VALUE 'J'.
   951*    COPY ELCEMIB.
   952******************************************************************
   953*                                                                *
   954*                                                                *
   955*                            ELCEMIB.                            *
   956*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   957*                            VMOD=2.005                          *
   958*                                                                *
   959*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   960*                                                                *
   961******************************************************************
   962 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   963     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   964     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   965     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   966     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   967     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   968     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   969     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   970     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   971     12  EMI-SWITCH1             PIC X        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  19
* EL6317.cbl
   972         88  EMI-NO-ERRORS                    VALUE '1'.
   973         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   974         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   975     12  EMI-SWITCH2             PIC X        VALUE '1'.
   976         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   977     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   978         88  EMI-AREA1-EMPTY                  VALUE '1'.
   979         88  EMI-AREA1-FULL                   VALUE '2'.
   980     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   981         88  EMI-AREA2-EMPTY                  VALUE '1'.
   982         88  EMI-AREA2-FULL                   VALUE '2'.
   983     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   984         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   985         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   986         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   987         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   988         88  EMI-BYPASS-FATALS                VALUE 'X'.
   989     12  EMI-ERROR-LINES.
   990         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   991         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   992         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   993         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   994             20  EMI-ERR-CODES OCCURS 10 TIMES.
   995                 24  EMI-ERR-NUM         PIC X(4).
   996                 24  EMI-FILLER          PIC X.
   997                 24  EMI-SEV             PIC X.
   998                 24  FILLER              PIC X.
   999             20  FILLER                  PIC X(02).
  1000     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1001         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1002             20  EMI-ERROR-NUMBER    PIC X(4).
  1003             20  EMI-FILL            PIC X.
  1004             20  EMI-SEVERITY        PIC X.
  1005             20  FILLER              PIC X.
  1006             20  EMI-ERROR-TEXT.
  1007                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1008                 24  FILLER          PIC X(55).
  1009     12  EMI-SEVERITY-SAVE           PIC X.
  1010         88  EMI-NOTE                    VALUE 'N'.
  1011         88  EMI-WARNING                 VALUE 'W'.
  1012         88  EMI-FORCABLE                VALUE 'F'.
  1013         88  EMI-FATAL                   VALUE 'X'.
  1014     12  EMI-MESSAGE-FLAG            PIC X.
  1015         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1016         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1017     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1018     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1019         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1020         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1021         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1022     12  emi-claim-no                pic x(7).
  1023     12  emi-claim-type              pic x(6).
  1024     12  FILLER                      PIC X(124)  VALUE SPACES.
  1025     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1026     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1027     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1028     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1029*    COPY ELCINTF.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  20
* EL6317.cbl
  1030******************************************************************
  1031*                                                                *
  1032*                                                                *
  1033*                            ELCINTF.                            *
  1034*                            VMOD=2.017                          *
  1035*                                                                *
  1036*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1037*                                                                *
  1038*       LENGTH = 1024                                            *
  1039*                                                                *
  1040******************************************************************
  1041*                   C H A N G E   L O G
  1042*
  1043* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1044*-----------------------------------------------------------------
  1045*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1046* EFFECTIVE    NUMBER
  1047*-----------------------------------------------------------------
  1048* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1049******************************************************************
  1050 01  PROGRAM-INTERFACE-BLOCK.
  1051     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1052     12  PI-CALLING-PROGRAM              PIC X(8).
  1053     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1054     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1055     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1056     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1057     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1058     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1059     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1060     12  PI-COMPANY-ID                   PIC XXX.
  1061     12  PI-COMPANY-CD                   PIC X.
  1062
  1063     12  PI-COMPANY-PASSWORD             PIC X(8).
  1064
  1065     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1066
  1067     12  PI-CONTROL-IN-PROGRESS.
  1068         16  PI-CARRIER                  PIC X.
  1069         16  PI-GROUPING                 PIC X(6).
  1070         16  PI-STATE                    PIC XX.
  1071         16  PI-ACCOUNT                  PIC X(10).
  1072         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1073                                         PIC X(10).
  1074         16  PI-CLAIM-CERT-GRP.
  1075             20  PI-CLAIM-NO             PIC X(7).
  1076             20  PI-CERT-NO.
  1077                 25  PI-CERT-PRIME       PIC X(10).
  1078                 25  PI-CERT-SFX         PIC X.
  1079             20  PI-CERT-EFF-DT          PIC XX.
  1080         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1081             20  PI-PLAN-CODE            PIC X(2).
  1082             20  PI-REVISION-NUMBER      PIC X(3).
  1083             20  PI-PLAN-EFF-DT          PIC X(2).
  1084             20  PI-PLAN-EXP-DT          PIC X(2).
  1085             20  FILLER                  PIC X(11).
  1086         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1087             20  PI-OE-REFERENCE-1.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  21
* EL6317.cbl
  1088                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1089                 25  PI-OE-REF-1-SUFF    PIC XX.
  1090
  1091     12  PI-SESSION-IN-PROGRESS          PIC X.
  1092         88  CLAIM-SESSION                   VALUE '1'.
  1093         88  CREDIT-SESSION                  VALUE '2'.
  1094         88  WARRANTY-SESSION                VALUE '3'.
  1095         88  MORTGAGE-SESSION                VALUE '4'.
  1096         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1097
  1098
  1099*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1100
  1101     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1102     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1103
  1104     12  PI-CREDIT-USER                  PIC X.
  1105         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1106         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1107
  1108     12  PI-CLAIM-USER                   PIC X.
  1109         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1110         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1111
  1112     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1113         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1114         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1115         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1116         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1117         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1118
  1119     12  PI-PROCESSOR-ID                 PIC X(4).
  1120
  1121     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1122
  1123     12  PI-MEMBER-CAPTION               PIC X(10).
  1124
  1125     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1126         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1127
  1128     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1129     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1130     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1131     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1132
  1133     12  PI-AH-OVERRIDE-L1               PIC X.
  1134     12  PI-AH-OVERRIDE-L2               PIC XX.
  1135     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1136     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1137
  1138     12  PI-NEW-SYSTEM                   PIC X(2).
  1139
  1140     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1141     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1142         88  PI-USES-PAID-TO                 VALUE '1'.
  1143     12  PI-CRDTCRD-SYSTEM.
  1144         16  PI-CRDTCRD-USER             PIC X.
  1145             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  22
* EL6317.cbl
  1146             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1147         16  PI-CC-MONTH-END-DT          PIC XX.
  1148     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1149
  1150     12  PI-OE-REFERENCE-2.
  1151         16  PI-OE-REF-2-PRIME           PIC X(10).
  1152         16  PI-OE-REF-2-SUFF            PIC X.
  1153
  1154     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1155
  1156     12  PI-LANGUAGE-TYPE                PIC X.
  1157             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1158             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1159             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1160
  1161     12  PI-POLICY-LINKAGE-IND           PIC X.
  1162         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1163         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1164                                                   LOW-VALUES.
  1165
  1166     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1167     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1168         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1169         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1170
  1171     12  PI-PROCESSOR-CSR-IND            PIC X.
  1172         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1173         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1174
  1175     12  FILLER                          PIC X(3).
  1176
  1177     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1178
  1179     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1180         PI-SYSTEM-LEVEL.
  1181
  1182         16  PI-ENTRY-CODES.
  1183             20  PI-ENTRY-CD-1           PIC X.
  1184             20  PI-ENTRY-CD-2           PIC X.
  1185
  1186         16  PI-RETURN-CODES.
  1187             20  PI-RETURN-CD-1          PIC X.
  1188             20  PI-RETURN-CD-2          PIC X.
  1189
  1190         16  PI-UPDATE-STATUS-SAVE.
  1191             20  PI-UPDATE-BY            PIC X(4).
  1192             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1193
  1194         16  PI-LOWER-CASE-LETTERS       PIC X.
  1195             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1196
  1197*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1198*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1199*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1200
  1201         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1202             88  ST-ACCNT-CNTL               VALUE ' '.
  1203             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  23
* EL6317.cbl
  1204             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1205             88  ACCNT-CNTL                  VALUE '3'.
  1206             88  CARR-ACCNT-CNTL             VALUE '4'.
  1207
  1208         16  PI-PROCESSOR-CAP-LIST.
  1209             20  PI-SYSTEM-CONTROLS.
  1210                24 PI-SYSTEM-DISPLAY     PIC X.
  1211                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1212                24 PI-SYSTEM-MODIFY      PIC X.
  1213                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1214             20  FILLER                  PIC XX.
  1215             20  PI-DISPLAY-CAP          PIC X.
  1216                 88  DISPLAY-CAP             VALUE 'Y'.
  1217             20  PI-MODIFY-CAP           PIC X.
  1218                 88  MODIFY-CAP              VALUE 'Y'.
  1219             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1220                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1221             20  PI-FORCE-CAP            PIC X.
  1222                 88  FORCE-CAP               VALUE 'Y'.
  1223
  1224         16  PI-PROGRAM-CONTROLS.
  1225             20  PI-PGM-PRINT-OPT        PIC X.
  1226             20  PI-PGM-FORMAT-OPT       PIC X.
  1227             20  PI-PGM-PROCESS-OPT      PIC X.
  1228             20  PI-PGM-TOTALS-OPT       PIC X.
  1229
  1230         16  PI-HELP-INTERFACE.
  1231             20  PI-LAST-ERROR-NO        PIC X(4).
  1232             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1233
  1234         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1235             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1236
  1237         16  PI-CR-CONTROL-IN-PROGRESS.
  1238             20  PI-CR-CARRIER           PIC X.
  1239             20  PI-CR-GROUPING          PIC X(6).
  1240             20  PI-CR-STATE             PIC XX.
  1241             20  PI-CR-ACCOUNT           PIC X(10).
  1242             20  PI-CR-FIN-RESP          PIC X(10).
  1243             20  PI-CR-TYPE              PIC X.
  1244
  1245         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1246
  1247         16  PI-CR-MONTH-END-DT          PIC XX.
  1248
  1249         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1250             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1251             88  PI-ZERO-CARRIER             VALUE '1'.
  1252             88  PI-ZERO-GROUPING            VALUE '2'.
  1253             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1254
  1255         16  PI-CARRIER-SECURITY         PIC X.
  1256             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1257
  1258         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1259             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1260             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1261
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  24
* EL6317.cbl
  1262         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1263             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1264                                         INDEXED BY PI-ACCESS-NDX
  1265                                         PIC X.
  1266
  1267         16  PI-GA-BILLING-CONTROL       PIC X.
  1268             88  PI-GA-BILLING               VALUE '1'.
  1269
  1270         16  PI-MAIL-PROCESSING          PIC X.
  1271             88  PI-MAIL-YES                 VALUE 'Y'.
  1272
  1273         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1274
  1275         16  PI-AR-SYSTEM.
  1276             20  PI-AR-PROCESSING-CNTL   PIC X.
  1277                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1278             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1279             20  PI-AR-MONTH-END-DT      PIC XX.
  1280
  1281         16  PI-MP-SYSTEM.
  1282             20  PI-MORTGAGE-USER            PIC X.
  1283                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1284                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1285             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1286                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1287                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1288                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1289                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1290                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1291             20  PI-MP-MONTH-END-DT          PIC XX.
  1292             20  PI-MP-REFERENCE-NO.
  1293                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1294                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1295
  1296         16  PI-LABEL-CONTROL            PIC X(01).
  1297             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1298             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1299
  1300         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1301             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1302
  1303         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1304             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1305             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1306
  1307         16  FILLER                      PIC X(14).
  1308
  1309     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1310******************************************************************
  1311     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1312        16  PI-ISS-CAN-SW           PIC X.
  1313        16  PI-ERENDT-KEY.
  1314            20  PI-ENDT-COMPANY-CD  PIC X.
  1315            20  PI-ENDT-CARRIER     PIC X.
  1316            20  PI-ENDT-GROUPING    PIC X(6).
  1317            20  PI-ENDT-STATE       PIC XX.
  1318            20  PI-ENDT-ACCOUNT     PIC X(10).
  1319            20  PI-ENDT-CERT-EFF-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  25
* EL6317.cbl
  1320            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1321            20  PI-ENDT-CERT-SFX    PIC X.
  1322            20  PI-ENDT-RECORD-TYPE PIC X.
  1323            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1324        16  PI-ELCRTO-KEY.
  1325            20  PI-CRTO-COMPANY-CD  PIC X.
  1326            20  PI-CRTO-CARRIER     PIC X.
  1327            20  PI-CRTO-GROUPING    PIC X(6).
  1328            20  PI-CRTO-STATE       PIC XX.
  1329            20  PI-CRTO-ACCOUNT     PIC X(10).
  1330            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1331            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1332            20  PI-CRTO-CERT-SFX    PIC X.
  1333            20  PI-CRTO-RECORD-TYPE PIC X.
  1334            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1335        16  PI-ERPNDB-KEY           PIC X(11).
  1336        16  PI-DOCUMENT-PROCESSED   PIC X.
  1337            88  PI-VERI-PROCESSED      VALUE 'V'.
  1338            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1339        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1340        16  PI-RES-REF-CLM-TYPE     PIC X.
  1341        16  PI-CLM-REFORM-IND       PIC X.
  1342        16  PI-CLEAR-ERROR-SW       PIC X.
  1343            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1344        16  PI-PRINT-CERTIFICATE    PIC X.
  1345        16  PI-ENTERED.
  1346            20  PI-PRTSW-ENTERED    PIC X.
  1347            20  PI-SIGREQ-ENTERED   PIC X.
  1348            20  PI-MONEY-ENTERED    PIC X.
  1349            20  PI-LTRID-ENTERED    PIC X(4).
  1350            20  PI-REASONS-ENTERED  PIC X(84).
  1351            20  PI-CERTNT1-ENTERED  PIC X(63).
  1352            20  PI-CERTNT2-ENTERED  PIC X(63).
  1353        16  FILLER                  PIC X(17).
  1354        16  PI-FINALIZED-IND        PIC X.
  1355        16  PI-BILLNT1-ENTERED      PIC X(63).
  1356        16  PI-BILLNT2-ENTERED      PIC X(63).
  1357        16  PI-ENCCODE              PIC X(3).
  1358        16  FILLER                  PIC X(151).
  1359    12  FILLER                      PIC X(276).
  1360*    COPY ELCAID.
  1361******************************************************************
  1362*                                                                *
  1363*                            ELCAID.                             *
  1364*                            VMOD=2.001                          *
  1365*                                                                *
  1366*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1367*                                                                *
  1368*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1369*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1370******************************************************************
  1371
  1372 01  DFHAID.
  1373   02  DFHNULL   PIC  X  VALUE  ' '.
  1374   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1375   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1376   02  DFHPEN    PIC  X  VALUE  '='.
  1377   02  DFHOPID   PIC  X  VALUE  'W'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  26
* EL6317.cbl
  1378   02  DFHPA1    PIC  X  VALUE  '%'.
  1379   02  DFHPA2    PIC  X  VALUE  '>'.
  1380   02  DFHPA3    PIC  X  VALUE  ','.
  1381   02  DFHPF1    PIC  X  VALUE  '1'.
  1382   02  DFHPF2    PIC  X  VALUE  '2'.
  1383   02  DFHPF3    PIC  X  VALUE  '3'.
  1384   02  DFHPF4    PIC  X  VALUE  '4'.
  1385   02  DFHPF5    PIC  X  VALUE  '5'.
  1386   02  DFHPF6    PIC  X  VALUE  '6'.
  1387   02  DFHPF7    PIC  X  VALUE  '7'.
  1388   02  DFHPF8    PIC  X  VALUE  '8'.
  1389   02  DFHPF9    PIC  X  VALUE  '9'.
  1390   02  DFHPF10   PIC  X  VALUE  ':'.
  1391   02  DFHPF11   PIC  X  VALUE  '#'.
  1392   02  DFHPF12   PIC  X  VALUE  '@'.
  1393   02  DFHPF13   PIC  X  VALUE  'A'.
  1394   02  DFHPF14   PIC  X  VALUE  'B'.
  1395   02  DFHPF15   PIC  X  VALUE  'C'.
  1396   02  DFHPF16   PIC  X  VALUE  'D'.
  1397   02  DFHPF17   PIC  X  VALUE  'E'.
  1398   02  DFHPF18   PIC  X  VALUE  'F'.
  1399   02  DFHPF19   PIC  X  VALUE  'G'.
  1400   02  DFHPF20   PIC  X  VALUE  'H'.
  1401   02  DFHPF21   PIC  X  VALUE  'I'.
  1402*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1403   02  DFHPF22   PIC  X  VALUE  '['.
  1404   02  DFHPF23   PIC  X  VALUE  '.'.
  1405   02  DFHPF24   PIC  X  VALUE  '<'.
  1406   02  DFHMSRE   PIC  X  VALUE  'X'.
  1407   02  DFHSTRF   PIC  X  VALUE  'h'.
  1408   02  DFHTRIG   PIC  X  VALUE  '"'.
  1409 01  FILLER    REDEFINES DFHAID.
  1410     12  FILLER              PIC X(8).
  1411     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1412*   COPY EL6317S.
  1413 01  EL631JI.
  1414     05  FILLER            PIC  X(0012).
  1415*    -------------------------------
  1416     05  DATEL PIC S9(0004) COMP.
  1417     05  DATEF PIC  X(0001).
  1418     05  FILLER REDEFINES DATEF.
  1419         10  DATEA PIC  X(0001).
  1420     05  DATEI PIC  X(0008).
  1421*    -------------------------------
  1422     05  TIMEL PIC S9(0004) COMP.
  1423     05  TIMEF PIC  X(0001).
  1424     05  FILLER REDEFINES TIMEF.
  1425         10  TIMEA PIC  X(0001).
  1426     05  TIMEI PIC  X(0005).
  1427*    -------------------------------
  1428     05  PROCIDL PIC S9(0004) COMP.
  1429     05  PROCIDF PIC  X(0001).
  1430     05  FILLER REDEFINES PROCIDF.
  1431         10  PROCIDA PIC  X(0001).
  1432     05  PROCIDI PIC  X(0004).
  1433*    -------------------------------
  1434     05  HOSTL PIC S9(0004) COMP.
  1435     05  HOSTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  27
* EL6317.cbl
  1436     05  FILLER REDEFINES HOSTF.
  1437         10  HOSTA PIC  X(0001).
  1438     05  HOSTI PIC  X(0009).
  1439*    -------------------------------
  1440     05  SYSL PIC S9(0004) COMP.
  1441     05  SYSF PIC  X(0001).
  1442     05  FILLER REDEFINES SYSF.
  1443         10  SYSA PIC  X(0001).
  1444     05  SYSI PIC  X(0005).
  1445*    -------------------------------
  1446     05  COMPANYL PIC S9(0004) COMP.
  1447     05  COMPANYF PIC  X(0001).
  1448     05  FILLER REDEFINES COMPANYF.
  1449         10  COMPANYA PIC  X(0001).
  1450     05  COMPANYI PIC  X(0003).
  1451*    -------------------------------
  1452     05  DATASORL PIC S9(0004) COMP.
  1453     05  DATASORF PIC  X(0001).
  1454     05  FILLER REDEFINES DATASORF.
  1455         10  DATASORA PIC  X(0001).
  1456     05  DATASORI PIC  X(0001).
  1457*    -------------------------------
  1458     05  BATCHNOL PIC S9(0004) COMP.
  1459     05  BATCHNOF PIC  X(0001).
  1460     05  FILLER REDEFINES BATCHNOF.
  1461         10  BATCHNOA PIC  X(0001).
  1462     05  BATCHNOI PIC  X(0006).
  1463*    -------------------------------
  1464     05  BSEQNOL PIC S9(0004) COMP.
  1465     05  BSEQNOF PIC  X(0001).
  1466     05  FILLER REDEFINES BSEQNOF.
  1467         10  BSEQNOA PIC  X(0001).
  1468     05  BSEQNOI PIC  X(0008).
  1469*    -------------------------------
  1470     05  ARCHNOL PIC S9(0004) COMP.
  1471     05  ARCHNOF PIC  X(0001).
  1472     05  FILLER REDEFINES ARCHNOF.
  1473         10  ARCHNOA PIC  X(0001).
  1474     05  ARCHNOI PIC  X(0008).
  1475*    -------------------------------
  1476     05  PRTSWL PIC S9(0004) COMP.
  1477     05  PRTSWF PIC  X(0001).
  1478     05  FILLER REDEFINES PRTSWF.
  1479         10  PRTSWA PIC  X(0001).
  1480     05  PRTSWI PIC  X(0001).
  1481*    -------------------------------
  1482     05  CARRL PIC S9(0004) COMP.
  1483     05  CARRF PIC  X(0001).
  1484     05  FILLER REDEFINES CARRF.
  1485         10  CARRA PIC  X(0001).
  1486     05  CARRI PIC  X(0001).
  1487*    -------------------------------
  1488     05  GROUPL PIC S9(0004) COMP.
  1489     05  GROUPF PIC  X(0001).
  1490     05  FILLER REDEFINES GROUPF.
  1491         10  GROUPA PIC  X(0001).
  1492     05  GROUPI PIC  X(0006).
  1493*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  28
* EL6317.cbl
  1494     05  STATEL PIC S9(0004) COMP.
  1495     05  STATEF PIC  X(0001).
  1496     05  FILLER REDEFINES STATEF.
  1497         10  STATEA PIC  X(0001).
  1498     05  STATEI PIC  X(0002).
  1499*    -------------------------------
  1500     05  ACCTL PIC S9(0004) COMP.
  1501     05  ACCTF PIC  X(0001).
  1502     05  FILLER REDEFINES ACCTF.
  1503         10  ACCTA PIC  X(0001).
  1504     05  ACCTI PIC  X(0010).
  1505*    -------------------------------
  1506     05  EFFDTL PIC S9(0004) COMP.
  1507     05  EFFDTF PIC  X(0001).
  1508     05  FILLER REDEFINES EFFDTF.
  1509         10  EFFDTA PIC  X(0001).
  1510     05  EFFDTI PIC  X(0008).
  1511*    -------------------------------
  1512     05  CERTNOL PIC S9(0004) COMP.
  1513     05  CERTNOF PIC  X(0001).
  1514     05  FILLER REDEFINES CERTNOF.
  1515         10  CERTNOA PIC  X(0001).
  1516     05  CERTNOI PIC  X(0010).
  1517*    -------------------------------
  1518     05  CRTSFXL PIC S9(0004) COMP.
  1519     05  CRTSFXF PIC  X(0001).
  1520     05  FILLER REDEFINES CRTSFXF.
  1521         10  CRTSFXA PIC  X(0001).
  1522     05  CRTSFXI PIC  X(0001).
  1523*    -------------------------------
  1524     05  SEQNOL PIC S9(0004) COMP.
  1525     05  SEQNOF PIC  X(0001).
  1526     05  FILLER REDEFINES SEQNOF.
  1527         10  SEQNOA PIC  X(0001).
  1528     05  SEQNOI PIC  X(0006).
  1529*    -------------------------------
  1530     05  SIGREQL PIC S9(0004) COMP.
  1531     05  SIGREQF PIC  X(0001).
  1532     05  FILLER REDEFINES SIGREQF.
  1533         10  SIGREQA PIC  X(0001).
  1534     05  SIGREQI PIC  X(0001).
  1535*    -------------------------------
  1536     05  LTRIDL PIC S9(0004) COMP.
  1537     05  LTRIDF PIC  X(0001).
  1538     05  FILLER REDEFINES LTRIDF.
  1539         10  LTRIDA PIC  X(0001).
  1540     05  LTRIDI PIC  X(0004).
  1541*    -------------------------------
  1542     05  ENCCODEL PIC S9(0004) COMP.
  1543     05  ENCCODEF PIC  X(0001).
  1544     05  FILLER REDEFINES ENCCODEF.
  1545         10  ENCCODEA PIC  X(0001).
  1546     05  ENCCODEI PIC  X(0003).
  1547*    -------------------------------
  1548     05  RCD01L PIC S9(0004) COMP.
  1549     05  RCD01F PIC  X(0001).
  1550     05  FILLER REDEFINES RCD01F.
  1551         10  RCD01A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  29
* EL6317.cbl
  1552     05  RCD01I PIC  X(0004).
  1553*    -------------------------------
  1554     05  RCD02L PIC S9(0004) COMP.
  1555     05  RCD02F PIC  X(0001).
  1556     05  FILLER REDEFINES RCD02F.
  1557         10  RCD02A PIC  X(0001).
  1558     05  RCD02I PIC  X(0004).
  1559*    -------------------------------
  1560     05  RCD03L PIC S9(0004) COMP.
  1561     05  RCD03F PIC  X(0001).
  1562     05  FILLER REDEFINES RCD03F.
  1563         10  RCD03A PIC  X(0001).
  1564     05  RCD03I PIC  X(0004).
  1565*    -------------------------------
  1566     05  RCD04L PIC S9(0004) COMP.
  1567     05  RCD04F PIC  X(0001).
  1568     05  FILLER REDEFINES RCD04F.
  1569         10  RCD04A PIC  X(0001).
  1570     05  RCD04I PIC  X(0004).
  1571*    -------------------------------
  1572     05  RCD05L PIC S9(0004) COMP.
  1573     05  RCD05F PIC  X(0001).
  1574     05  FILLER REDEFINES RCD05F.
  1575         10  RCD05A PIC  X(0001).
  1576     05  RCD05I PIC  X(0004).
  1577*    -------------------------------
  1578     05  RCD06L PIC S9(0004) COMP.
  1579     05  RCD06F PIC  X(0001).
  1580     05  FILLER REDEFINES RCD06F.
  1581         10  RCD06A PIC  X(0001).
  1582     05  RCD06I PIC  X(0004).
  1583*    -------------------------------
  1584     05  RCD07L PIC S9(0004) COMP.
  1585     05  RCD07F PIC  X(0001).
  1586     05  FILLER REDEFINES RCD07F.
  1587         10  RCD07A PIC  X(0001).
  1588     05  RCD07I PIC  X(0004).
  1589*    -------------------------------
  1590     05  RCD08L PIC S9(0004) COMP.
  1591     05  RCD08F PIC  X(0001).
  1592     05  FILLER REDEFINES RCD08F.
  1593         10  RCD08A PIC  X(0001).
  1594     05  RCD08I PIC  X(0004).
  1595*    -------------------------------
  1596     05  RCD09L PIC S9(0004) COMP.
  1597     05  RCD09F PIC  X(0001).
  1598     05  FILLER REDEFINES RCD09F.
  1599         10  RCD09A PIC  X(0001).
  1600     05  RCD09I PIC  X(0004).
  1601*    -------------------------------
  1602     05  RCD10L PIC S9(0004) COMP.
  1603     05  RCD10F PIC  X(0001).
  1604     05  FILLER REDEFINES RCD10F.
  1605         10  RCD10A PIC  X(0001).
  1606     05  RCD10I PIC  X(0004).
  1607*    -------------------------------
  1608     05  RCD11L PIC S9(0004) COMP.
  1609     05  RCD11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  30
* EL6317.cbl
  1610     05  FILLER REDEFINES RCD11F.
  1611         10  RCD11A PIC  X(0001).
  1612     05  RCD11I PIC  X(0004).
  1613*    -------------------------------
  1614     05  RCD12L PIC S9(0004) COMP.
  1615     05  RCD12F PIC  X(0001).
  1616     05  FILLER REDEFINES RCD12F.
  1617         10  RCD12A PIC  X(0001).
  1618     05  RCD12I PIC  X(0004).
  1619*    -------------------------------
  1620     05  CRTNT1L PIC S9(0004) COMP.
  1621     05  CRTNT1F PIC  X(0001).
  1622     05  FILLER REDEFINES CRTNT1F.
  1623         10  CRTNT1A PIC  X(0001).
  1624     05  CRTNT1I PIC  X(0063).
  1625*    -------------------------------
  1626     05  CRTNT2L PIC S9(0004) COMP.
  1627     05  CRTNT2F PIC  X(0001).
  1628     05  FILLER REDEFINES CRTNT2F.
  1629         10  CRTNT2A PIC  X(0001).
  1630     05  CRTNT2I PIC  X(0063).
  1631*    -------------------------------
  1632     05  BILNT1L PIC S9(0004) COMP.
  1633     05  BILNT1F PIC  X(0001).
  1634     05  FILLER REDEFINES BILNT1F.
  1635         10  BILNT1A PIC  X(0001).
  1636     05  BILNT1I PIC  X(0063).
  1637*    -------------------------------
  1638     05  BILNT2L PIC S9(0004) COMP.
  1639     05  BILNT2F PIC  X(0001).
  1640     05  FILLER REDEFINES BILNT2F.
  1641         10  BILNT2A PIC  X(0001).
  1642     05  BILNT2I PIC  X(0063).
  1643*    -------------------------------
  1644     05  ERRMSG1L PIC S9(0004) COMP.
  1645     05  ERRMSG1F PIC  X(0001).
  1646     05  FILLER REDEFINES ERRMSG1F.
  1647         10  ERRMSG1A PIC  X(0001).
  1648     05  ERRMSG1I PIC  X(0075).
  1649*    -------------------------------
  1650     05  ERRMSG2L PIC S9(0004) COMP.
  1651     05  ERRMSG2F PIC  X(0001).
  1652     05  FILLER REDEFINES ERRMSG2F.
  1653         10  ERRMSG2A PIC  X(0001).
  1654     05  ERRMSG2I PIC  X(0075).
  1655*    -------------------------------
  1656     05  PFENTRL PIC S9(0004) COMP.
  1657     05  PFENTRF PIC  X(0001).
  1658     05  FILLER REDEFINES PFENTRF.
  1659         10  PFENTRA PIC  X(0001).
  1660     05  PFENTRI PIC  9(2).
  1661 01  EL631JO REDEFINES EL631JI.
  1662     05  FILLER            PIC  X(0012).
  1663*    -------------------------------
  1664     05  FILLER            PIC  X(0003).
  1665     05  DATEO PIC  X(0008).
  1666*    -------------------------------
  1667     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  31
* EL6317.cbl
  1668     05  TIMEO PIC  99.99.
  1669*    -------------------------------
  1670     05  FILLER            PIC  X(0003).
  1671     05  PROCIDO PIC  X(0004).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  HOSTO PIC  X(0009).
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  SYSO PIC  X(0005).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  COMPANYO PIC  X(0003).
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  DATASORO PIC  X(0001).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  BATCHNOO PIC  X(0006).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  BSEQNOO PIC  X(0008).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  ARCHNOO PIC  X(0008).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  PRTSWO PIC  X(0001).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  CARRO PIC  X(0001).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  GROUPO PIC  X(0006).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  STATEO PIC  X(0002).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  ACCTO PIC  X(0010).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  EFFDTO PIC  X(0008).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  CERTNOO PIC  X(0010).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  CRTSFXO PIC  X(0001).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  SEQNOO PIC  999999.
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  SIGREQO PIC  X(0001).
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  LTRIDO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  32
* EL6317.cbl
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  ENCCODEO PIC  X(0003).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  RCD01O PIC  X(0004).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  RCD02O PIC  X(0004).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  RCD03O PIC  X(0004).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  RCD04O PIC  X(0004).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  RCD05O PIC  X(0004).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  RCD06O PIC  X(0004).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  RCD07O PIC  X(0004).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  RCD08O PIC  X(0004).
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  RCD09O PIC  X(0004).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  RCD10O PIC  X(0004).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  RCD11O PIC  X(0004).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  RCD12O PIC  X(0004).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  CRTNT1O PIC  X(0063).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  CRTNT2O PIC  X(0063).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  BILNT1O PIC  X(0063).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  BILNT2O PIC  X(0063).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  ERRMSG1O PIC  X(0075).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  ERRMSG2O PIC  X(0075).
  1783*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  33
* EL6317.cbl
  1784     05  FILLER            PIC  X(0003).
  1785     05  PFENTRO PIC  X(0002).
  1786*    -------------------------------
  1787 01  filler redefines el631ji.
  1788     12  filler                   pic x(188).
  1789     12  REASONCDS.
  1790         16  filler occurs 12.
  1791             20  reacdl       pic s9(4) comp.
  1792             20  reacda       pic x.
  1793             20  reacd-in     pic x(4).
  1794    12  FILLER                   PIC X(293).
  1795****************************************************************
  1796*
  1797* Copyright (c) 2007 by Clerity Solutions, Inc.
  1798* All rights reserved.
  1799*
  1800****************************************************************
  1801 01  DFHEIV.
  1802   02  DFHEIV0               PIC X(35).
  1803   02  DFHEIV1               PIC X(08).
  1804   02  DFHEIV2               PIC X(08).
  1805   02  DFHEIV3               PIC X(08).
  1806   02  DFHEIV4               PIC X(06).
  1807   02  DFHEIV5               PIC X(04).
  1808   02  DFHEIV6               PIC X(04).
  1809   02  DFHEIV7               PIC X(02).
  1810   02  DFHEIV8               PIC X(02).
  1811   02  DFHEIV9               PIC X(01).
  1812   02  DFHEIV10              PIC S9(7) COMP-3.
  1813   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1814   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1815   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1816   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1817   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1818   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1819   02  DFHEIV17              PIC X(04).
  1820   02  DFHEIV18              PIC X(04).
  1821   02  DFHEIV19              PIC X(04).
  1822   02  DFHEIV20              USAGE IS POINTER.
  1823   02  DFHEIV21              USAGE IS POINTER.
  1824   02  DFHEIV22              USAGE IS POINTER.
  1825   02  DFHEIV23              USAGE IS POINTER.
  1826   02  DFHEIV24              USAGE IS POINTER.
  1827   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1828   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1829   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1830   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1831   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1832   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1833   02  FILLER                PIC X(02).
  1834   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1835   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1836   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1837   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1838   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1839 LINKAGE  SECTION.
  1840*****************************************************************
  1841*                                                               *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  34
* EL6317.cbl
  1842* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1843* All rights reserved.                                          *
  1844*                                                               *
  1845*****************************************************************
  1846 01  dfheiblk.
  1847     02  eibtime          pic s9(7) comp-3.
  1848     02  eibdate          pic s9(7) comp-3.
  1849     02  eibtrnid         pic x(4).
  1850     02  eibtaskn         pic s9(7) comp-3.
  1851     02  eibtrmid         pic x(4).
  1852     02  dfheigdi         pic s9(4) comp.
  1853     02  eibcposn         pic s9(4) comp.
  1854     02  eibcalen         pic s9(4) comp.
  1855     02  eibaid           pic x(1).
  1856     02  eibfiller1       pic x(1).
  1857     02  eibfn            pic x(2).
  1858     02  eibfiller2       pic x(2).
  1859     02  eibrcode         pic x(6).
  1860     02  eibfiller3       pic x(2).
  1861     02  eibds            pic x(8).
  1862     02  eibreqid         pic x(8).
  1863     02  eibrsrce         pic x(8).
  1864     02  eibsync          pic x(1).
  1865     02  eibfree          pic x(1).
  1866     02  eibrecv          pic x(1).
  1867     02  eibsend          pic x(1).
  1868     02  eibatt           pic x(1).
  1869     02  eibeoc           pic x(1).
  1870     02  eibfmh           pic x(1).
  1871     02  eibcompl         pic x(1).
  1872     02  eibsig           pic x(1).
  1873     02  eibconf          pic x(1).
  1874     02  eiberr           pic x(1).
  1875     02  eibrldbk         pic x(1).
  1876     02  eiberrcd         pic x(4).
  1877     02  eibsynrb         pic x(1).
  1878     02  eibnodat         pic x(1).
  1879     02  eibfiller5       pic x(2).
  1880     02  eibresp          pic 9(09) comp.
  1881     02  eibresp2         pic 9(09) comp.
  1882     02  dfheigdj         pic s9(4) comp.
  1883     02  dfheigdk         pic s9(4) comp.
  1884 01  DFHCOMMAREA                 PIC X(1300).
  1885 01  var  pic x(30).
  1886*                                COPY ERCACCT.
  1887******************************************************************
  1888*                                                                *
  1889*                                                                *
  1890*                            ERCACCT                             *
  1891*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1892*                            VMOD=2.031                          *
  1893*                                                                *
  1894*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1895*                                                                *
  1896*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1897*   VSAM ACCOUNT MASTER FILES.                                   *
  1898*                                                                *
  1899*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  35
* EL6317.cbl
  1900*                                                                *
  1901*   FILE TYPE = VSAM,KSDS                                        *
  1902*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1903*                                                                *
  1904*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1905*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1906*                                                                *
  1907*   LOG = NO                                                     *
  1908*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1909*                                                                *
  1910*                                                                *
  1911******************************************************************
  1912*                   C H A N G E   L O G
  1913*
  1914* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1915*-----------------------------------------------------------------
  1916*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1917* EFFECTIVE    NUMBER
  1918*-----------------------------------------------------------------
  1919* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1920* 092705    2005050300006  PEMA  ADD SPP LEASES
  1921* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1922* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1923* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1924* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1925* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1926******************************************************************
  1927
  1928 01  ACCOUNT-MASTER.
  1929     12  AM-RECORD-ID                      PIC XX.
  1930         88  VALID-AM-ID                      VALUE 'AM'.
  1931
  1932     12  AM-CONTROL-PRIMARY.
  1933         16  AM-COMPANY-CD                 PIC X.
  1934         16  AM-MSTR-CNTRL.
  1935             20  AM-CONTROL-A.
  1936                 24  AM-CARRIER            PIC X.
  1937                 24  AM-GROUPING.
  1938                     28 AM-GROUPING-PREFIX PIC XXX.
  1939                     28 AM-GROUPING-PRIME  PIC XXX.
  1940                 24  AM-STATE              PIC XX.
  1941                 24  AM-ACCOUNT.
  1942                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1943                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1944             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1945                                           PIC X(19).
  1946             20  AM-CNTRL-B.
  1947                 24  AM-EXPIRATION-DT      PIC XX.
  1948                 24  FILLER                PIC X(4).
  1949             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1950                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1951
  1952     12  AM-CONTROL-BY-VAR-GRP.
  1953         16  AM-COMPANY-CD-A1              PIC X.
  1954         16  AM-VG-CARRIER                 PIC X.
  1955         16  AM-VG-GROUPING                PIC X(6).
  1956         16  AM-VG-STATE                   PIC XX.
  1957         16  AM-VG-ACCOUNT                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  36
* EL6317.cbl
  1958         16  AM-VG-DATE.
  1959             20  AM-VG-EXPIRATION-DT       PIC XX.
  1960             20  FILLER                    PIC X(4).
  1961         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1962                                           PIC 9(11)      COMP-3.
  1963     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1964         16  FILLER                        PIC X(10).
  1965         16  AM-VG-KEY3.
  1966             20  AM-VG3-ACCOUNT            PIC X(10).
  1967             20  AM-VG3-EXP-DT             PIC XX.
  1968         16  FILLER                        PIC X(4).
  1969     12  AM-MAINT-INFORMATION.
  1970         16  AM-LAST-MAINT-DT              PIC XX.
  1971         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1972         16  AM-LAST-MAINT-USER            PIC X(4).
  1973         16  FILLER                        PIC XX.
  1974
  1975     12  AM-EFFECTIVE-DT                   PIC XX.
  1976     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1977
  1978     12  AM-PREV-DATES  COMP-3.
  1979         16  AM-PREV-EXP-DT                PIC 9(11).
  1980         16  AM-PREV-EFF-DT                PIC 9(11).
  1981
  1982     12  AM-REPORT-CODE-1                  PIC X(10).
  1983     12  AM-REPORT-CODE-2                  PIC X(10).
  1984
  1985     12  AM-CITY-CODE                      PIC X(4).
  1986     12  AM-COUNTY-PARISH                  PIC X(6).
  1987
  1988     12  AM-NAME                           PIC X(30).
  1989     12  AM-PERSON                         PIC X(30).
  1990     12  AM-ADDRS                          PIC X(30).
  1991     12  AM-CITY.
  1992         16  AM-ADDR-CITY                  PIC X(28).
  1993         16  AM-ADDR-STATE                 PIC XX.
  1994     12  AM-ZIP.
  1995         16  AM-ZIP-PRIME.
  1996             20  AM-ZIP-PRI-1ST            PIC X.
  1997                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1998             20  FILLER                    PIC X(4).
  1999         16  AM-ZIP-PLUS4                  PIC X(4).
  2000     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2001         16  AM-CAN-POSTAL-1               PIC XXX.
  2002         16  AM-CAN-POSTAL-2               PIC XXX.
  2003         16  FILLER                        PIC XXX.
  2004     12  AM-TEL-NO.
  2005         16  AM-AREA-CODE                  PIC 999.
  2006         16  AM-TEL-PRE                    PIC 999.
  2007         16  AM-TEL-NBR                    PIC 9(4).
  2008     12  AM-TEL-LOC                        PIC X.
  2009         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2010         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2011
  2012     12  AM-COMM-STRUCTURE.
  2013         16  AM-DEFN-1.
  2014             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2015                 24  AM-AGT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  37
* EL6317.cbl
  2016                     28  AM-AGT-PREFIX     PIC X(4).
  2017                     28  AM-AGT-PRIME      PIC X(6).
  2018                 24  AM-COM-TYP            PIC X.
  2019                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2020                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2021                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2022                 24  AM-RECALC-LV-INDIC    PIC X.
  2023                 24  AM-RETRO-LV-INDIC     PIC X.
  2024                 24  AM-GL-CODES           PIC X.
  2025                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2026                 24  FILLER                PIC X(01).
  2027         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2028             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2029                 24  FILLER                PIC X(11).
  2030                 24  AM-L-COMA             PIC XXX.
  2031                 24  AM-J-COMA             PIC XXX.
  2032                 24  AM-A-COMA             PIC XXX.
  2033                 24  FILLER                PIC X(6).
  2034
  2035     12  AM-COMM-CHANGE-STATUS             PIC X.
  2036         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2037
  2038     12  AM-CSR-CODE                       PIC X(4).
  2039
  2040     12  AM-BILLING-STATUS                 PIC X.
  2041         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2042         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2043     12  AM-AUTO-REFUND-SW                 PIC X.
  2044         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2045         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2046     12  AM-GPCD                           PIC 99.
  2047     12  AM-IG                             PIC X.
  2048         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2049         88  AM-HAS-GROUP                     VALUE '2'.
  2050     12  AM-STATUS                         PIC X.
  2051         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2052         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2053         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2054         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2055         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2056         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2057     12  AM-REMIT-TO                       PIC 99.
  2058     12  AM-ID-NO                          PIC X(11).
  2059
  2060     12  AM-CAL-TABLE                      PIC XX.
  2061     12  AM-LF-DEVIATION                   PIC XXX.
  2062     12  AM-AH-DEVIATION                   PIC XXX.
  2063     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2064     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2065     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2066     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2067     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2068     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2069
  2070     12  AM-USER-FIELDS.
  2071         16  AM-FLD-1                      PIC XX.
  2072         16  AM-FLD-2                      PIC XX.
  2073         16  AM-FLD-3                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  38
* EL6317.cbl
  2074         16  AM-FLD-4                      PIC XX.
  2075         16  AM-FLD-5                      PIC XX.
  2076
  2077     12  AM-1ST-PROD-DATE.
  2078         16  AM-1ST-PROD-YR                PIC XX.
  2079         16  AM-1ST-PROD-MO                PIC XX.
  2080         16  AM-1ST-PROD-DA                PIC XX.
  2081     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2082     12  AM-CERTS-PURGED-DATE.
  2083         16  AM-PUR-YR                     PIC XX.
  2084         16  AM-PUR-MO                     PIC XX.
  2085         16  AM-PUR-DA                     PIC XX.
  2086     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2087     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2088     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2089     12  AM-INACTIVE-DATE.
  2090         16  AM-INA-MO                     PIC 99.
  2091         16  AM-INA-DA                     PIC 99.
  2092         16  AM-INA-YR                     PIC 99.
  2093     12  AM-AR-HI-CERT-DATE                PIC XX.
  2094
  2095     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2096     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2097
  2098     12  AM-OB-PAYMENT-MODE                PIC X.
  2099         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2100         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2101         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2102         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2103
  2104     12  AM-AH-ONLY-INDICATOR              PIC X.
  2105         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2106         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2107
  2108     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2109
  2110     12  AM-OVER-SHORT.
  2111         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2112         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2113
  2114     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2115     12  AM-DCC-CLP-STATE                  PIC XX.
  2116
  2117     12  AM-RECALC-COMM                    PIC X.
  2118     12  AM-RECALC-REIN                    PIC X.
  2119
  2120     12  AM-REI-TABLE                      PIC XXX.
  2121     12  AM-REI-ET-LF                      PIC X.
  2122     12  AM-REI-ET-AH                      PIC X.
  2123     12  AM-REI-PE-LF                      PIC X.
  2124     12  AM-REI-PE-AH                      PIC X.
  2125     12  AM-REI-PRT-ST                     PIC X.
  2126     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2127     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2128     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2129     12  AM-REI-GROUP-A                    PIC X(6).
  2130     12  AM-REI-MORT                       PIC X(4).
  2131     12  AM-REI-PRT-OW                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  39
* EL6317.cbl
  2132     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2133     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2134     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2135     12  AM-REI-GROUP-B                    PIC X(6).
  2136
  2137     12  AM-TRUST-TYPE                     PIC X(2).
  2138
  2139     12  AM-EMPLOYER-STMT-USED             PIC X.
  2140     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2141
  2142     12  AM-STD-AH-TYPE                    PIC XX.
  2143     12  AM-EARN-METHODS.
  2144         16  AM-EARN-METHOD-R              PIC X.
  2145             88 AM-REF-RL-R78                 VALUE 'R'.
  2146             88 AM-REF-RL-PR                  VALUE 'P'.
  2147             88 AM-REF-RL-MEAN                VALUE 'M'.
  2148             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2149         16  AM-EARN-METHOD-L              PIC X.
  2150             88 AM-REF-LL-R78                 VALUE 'R'.
  2151             88 AM-REF-LL-PR                  VALUE 'P'.
  2152             88 AM-REF-LL-MEAN                VALUE 'M'.
  2153             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2154         16  AM-EARN-METHOD-A              PIC X.
  2155             88 AM-REF-AH-R78                 VALUE 'R'.
  2156             88 AM-REF-AH-PR                  VALUE 'P'.
  2157             88 AM-REF-AH-MEAN                VALUE 'M'.
  2158             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2159             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2160             88 AM-REF-AH-NET                 VALUE 'N'.
  2161
  2162     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2163     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2164     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2165
  2166     12  AM-RET-Y-N                        PIC X.
  2167     12  AM-RET-P-E                        PIC X.
  2168     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2169     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2170     12  AM-RET-GRP                        PIC X(6).
  2171     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2172         16  AM-POOL-PRIME                 PIC XXX.
  2173         16  AM-POOL-SUB                   PIC XXX.
  2174     12  AM-RETRO-EARNINGS.
  2175         16  AM-RET-EARN-R                 PIC X.
  2176         16  AM-RET-EARN-L                 PIC X.
  2177         16  AM-RET-EARN-A                 PIC X.
  2178     12  AM-RET-ST-TAX-USE                 PIC X.
  2179         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2180         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2181     12  AM-RETRO-BEG-EARNINGS.
  2182         16  AM-RET-BEG-EARN-R             PIC X.
  2183         16  AM-RET-BEG-EARN-L             PIC X.
  2184         16  AM-RET-BEG-EARN-A             PIC X.
  2185     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2186     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2187
  2188     12  AM-USER-SELECT-OPTIONS.
  2189         16  AM-USER-SELECT-1              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  40
* EL6317.cbl
  2190         16  AM-USER-SELECT-2              PIC X(10).
  2191         16  AM-USER-SELECT-3              PIC X(10).
  2192         16  AM-USER-SELECT-4              PIC X(10).
  2193         16  AM-USER-SELECT-5              PIC X(10).
  2194
  2195     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2196
  2197     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2198
  2199     12  AM-RPT045A-SWITCH                 PIC X.
  2200         88  RPT045A-OFF                   VALUE 'N'.
  2201
  2202     12  AM-INSURANCE-LIMITS.
  2203         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2204         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2205
  2206     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2207         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2208
  2209     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2210         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2211         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2212
  2213     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2214
  2215     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2216     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2217     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2218     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2219     12  AM-DCC-UEF-STATE                  PIC XX.
  2220     12  FILLER                            PIC XXX.
  2221     12  AM-REPORT-CODE-3                  PIC X(10).
  2222*    12  FILLER                            PIC X(22).
  2223
  2224     12  AM-RESERVE-DATE.
  2225         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2226         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2227         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2228
  2229     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2230     12  AM-NOTIFICATION-TYPES.
  2231         16  AM-NOTIF-OF-LETTERS           PIC X.
  2232         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2233         16  AM-NOTIF-OF-REPORTS           PIC X.
  2234         16  AM-NOTIF-OF-STATUS            PIC X.
  2235
  2236     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2237         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2238         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2239         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2240         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2241
  2242     12  AM-BENEFIT-CONTROLS.
  2243         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2244             20  AM-BENEFIT-CODE           PIC XX.
  2245             20  AM-BENEFIT-TYPE           PIC X.
  2246             20  AM-BENEFIT-REVISION       PIC XXX.
  2247             20  AM-BENEFIT-REM-TERM       PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  41
* EL6317.cbl
  2248             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2249             20  FILLER                    PIC XX.
  2250         16  FILLER                        PIC X(80).
  2251
  2252     12  AM-TRANSFER-DATA.
  2253         16  AM-TRANSFERRED-FROM.
  2254             20  AM-TRNFROM-CARRIER        PIC X.
  2255             20  AM-TRNFROM-GROUPING.
  2256                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2257                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2258             20  AM-TRNFROM-STATE          PIC XX.
  2259             20  AM-TRNFROM-ACCOUNT.
  2260                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2261                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2262             20  AM-TRNFROM-DTE            PIC XX.
  2263         16  AM-TRANSFERRED-TO.
  2264             20  AM-TRNTO-CARRIER          PIC X.
  2265             20  AM-TRNTO-GROUPING.
  2266                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2267                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2268             20  AM-TRNTO-STATE            PIC XX.
  2269             20  AM-TRNTO-ACCOUNT.
  2270                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2271                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2272             20  AM-TRNTO-DTE              PIC XX.
  2273         16  FILLER                        PIC X(10).
  2274
  2275     12  AM-SAVED-REMIT-TO                 PIC 99.
  2276
  2277     12  AM-COMM-STRUCTURE-SAVED.
  2278         16  AM-DEFN-1-SAVED.
  2279             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2280                 24  AM-AGT-SV             PIC X(10).
  2281                 24  AM-COM-TYP-SV         PIC X.
  2282                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2283                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2284                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2285                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2286                 24  FILLER                PIC X.
  2287                 24  AM-GL-CODES-SV        PIC X.
  2288                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2289                 24  FILLER                PIC X.
  2290         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2291             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2292                 24  FILLER                PIC X(11).
  2293                 24  AM-L-COMA-SV          PIC XXX.
  2294                 24  AM-J-COMA-SV          PIC XXX.
  2295                 24  AM-A-COMA-SV          PIC XXX.
  2296                 24  FILLER                PIC X(6).
  2297
  2298     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2299         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2300            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2301            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2302            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2303
  2304     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2305     12  FILLER                            PIC X(120).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  42
* EL6317.cbl
  2306
  2307     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2308         16  AM-CONTROL-NAME               PIC X(30).
  2309         16  AM-EXECUTIVE-ONE.
  2310             20  AM-EXEC1-NAME             PIC X(15).
  2311             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2312                                                          COMP-3.
  2313             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2314                                                          COMP-3.
  2315         16  AM-EXECUTIVE-TWO.
  2316             20  AM-EXEC2-NAME             PIC X(15).
  2317             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2318                                                          COMP-3.
  2319             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2320                                                          COMP-3.
  2321
  2322     12  AM-RETRO-ADDITIONAL-DATA.
  2323         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2324         16  AM-RETRO-PREM-P-E             PIC X.
  2325         16  AM-RETRO-CLMS-P-I             PIC X.
  2326         16  AM-RETRO-RET-BRACKET-LF.
  2327             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2328                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2329                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2330             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2331                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2332                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2333             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2334                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2335                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2336         16  AM-RETRO-RET-BRACKET-AH.
  2337             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2338                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2339                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2340                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2341             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2342                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2343                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2344             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2345                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2346                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2347
  2348     12  AM-COMMENTS.
  2349         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2350
  2351     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2352         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2353         16  AM-FLI-BILLING-CODE           PIC X.
  2354         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2355         16  AM-FLI-UNITED-IDENT           PIC X.
  2356         16  AM-FLI-INTEREST-LOST-DATA.
  2357             20  AM-FLI-BANK-NO            PIC X(5).
  2358             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2359             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2360             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2361         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2362             20  AM-FLI-AGT                PIC X(9).
  2363             20  AM-FLI-AGT-COMM-ACC       PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  43
* EL6317.cbl
  2364             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2365         16  FILLER                        PIC X(102).
  2366
  2367     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2368         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2369             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2370             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2371             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2372             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2373             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2374         16  FILLER                          PIC X(10).
  2375******************************************************************
  2376*                                COPY ELCCNTL.
  2377******************************************************************
  2378*                                                                *
  2379*                                                                *
  2380*                            ELCCNTL.                            *
  2381*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2382*                            VMOD=2.059                          *
  2383*                                                                *
  2384*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2385*                                                                *
  2386*   FILE TYPE = VSAM,KSDS                                        *
  2387*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2388*                                                                *
  2389*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2390*       ALTERNATE INDEX = NONE                                   *
  2391*                                                                *
  2392*   LOG = YES                                                    *
  2393*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2394******************************************************************
  2395*                   C H A N G E   L O G
  2396*
  2397* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2398*-----------------------------------------------------------------
  2399*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2400* EFFECTIVE    NUMBER
  2401*-----------------------------------------------------------------
  2402* 082503                   PEMA  ADD BENEFIT GROUP
  2403* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2404* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2405* 092705    2005050300006  PEMA  ADD SPP LEASES
  2406* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2407* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2408* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2409* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2410* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2411* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2412* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2413* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2414* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2415******************************************************************
  2416*
  2417 01  CONTROL-FILE.
  2418     12  CF-RECORD-ID                       PIC XX.
  2419         88  VALID-CF-ID                        VALUE 'CF'.
  2420
  2421     12  CF-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  44
* EL6317.cbl
  2422         16  CF-COMPANY-ID                  PIC XXX.
  2423         16  CF-RECORD-TYPE                 PIC X.
  2424             88  CF-COMPANY-MASTER              VALUE '1'.
  2425             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2426             88  CF-STATE-MASTER                VALUE '3'.
  2427             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2428             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2429             88  CF-CARRIER-MASTER              VALUE '6'.
  2430             88  CF-MORTALITY-MASTER            VALUE '7'.
  2431             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2432             88  CF-TERMINAL-MASTER             VALUE '9'.
  2433             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2434             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2435             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2436             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2437             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2438             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2439             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2440             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2441             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2442         16  CF-ACCESS-CD-GENL              PIC X(4).
  2443         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2444             20  CF-PROCESSOR               PIC X(4).
  2445         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2446             20  CF-STATE-CODE              PIC XX.
  2447             20  FILLER                     PIC XX.
  2448         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2449             20  FILLER                     PIC XX.
  2450             20  CF-HI-BEN-IN-REC           PIC XX.
  2451         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2452             20  FILLER                     PIC XXX.
  2453             20  CF-CARRIER-CNTL            PIC X.
  2454         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2455             20  FILLER                     PIC XX.
  2456             20  CF-HI-TYPE-IN-REC          PIC 99.
  2457         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2458             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2459                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2460             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2461             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2462         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2463             20  FILLER                     PIC X.
  2464             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2465         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2466             20  FILLER                     PIC XX.
  2467             20  CF-MORTGAGE-PLAN           PIC XX.
  2468         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2469
  2470     12  CF-LAST-MAINT-DT                   PIC XX.
  2471     12  CF-LAST-MAINT-BY                   PIC X(4).
  2472     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2473
  2474     12  CF-RECORD-BODY                     PIC X(728).
  2475
  2476
  2477****************************************************************
  2478*             COMPANY MASTER RECORD                            *
  2479****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  45
* EL6317.cbl
  2480
  2481     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2482         16  CF-COMPANY-ADDRESS.
  2483             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2484             20  CF-CL-IN-CARE-OF           PIC X(30).
  2485             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2486             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2487             20  CF-CL-CITY-STATE           PIC X(30).
  2488             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2489             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2490         16  CF-COMPANY-CD                  PIC X.
  2491         16  CF-COMPANY-PASSWORD            PIC X(8).
  2492         16  CF-SECURITY-OPTION             PIC X.
  2493             88  ALL-SECURITY                   VALUE '1'.
  2494             88  COMPANY-VERIFY                 VALUE '2'.
  2495             88  PROCESSOR-VERIFY               VALUE '3'.
  2496             88  NO-SECURITY                    VALUE '4'.
  2497             88  ALL-BUT-TERM                   VALUE '5'.
  2498         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2499             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2500         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2501             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2502         16  CF-INFORCE-LOCATION            PIC X.
  2503             88  CERTS-ARE-ONLINE               VALUE '1'.
  2504             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2505             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2506         16  CF-LOWER-CASE-LETTERS          PIC X.
  2507         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2508             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2509             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2510             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2511             88  CF-ACCNT-CNTL                  VALUE '3'.
  2512             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2513
  2514         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2515         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2516
  2517         16  CF-LGX-CREDIT-USER             PIC X.
  2518             88  CO-IS-NOT-USER                 VALUE 'N'.
  2519             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2520
  2521         16 CF-CREDIT-CALC-CODES.
  2522             20  CF-CR-REM-TERM-CALC PIC X.
  2523               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2524               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2525               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2526               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2527               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2528               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2529               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2530             20  CF-CR-R78-METHOD           PIC X.
  2531               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2532               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2533
  2534         16  CF-CLAIM-CONTROL-COUNTS.
  2535             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2536                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2537
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  46
* EL6317.cbl
  2538             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2539                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2540
  2541             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2542                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2543
  2544             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2545                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2546
  2547         16  CF-CURRENT-MONTH-END           PIC XX.
  2548
  2549         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2550             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2551             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2552             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2553             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2554                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2555                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2556             20  CF-CO-PREM-REJECT-SW       PIC X.
  2557                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2558                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2559             20  CF-CO-REF-REJECT-SW        PIC X.
  2560                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2561                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2562
  2563         16  CF-CO-REPORTING-DT             PIC XX.
  2564         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2565         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2566           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2567           88  CF-CO-MONTH-END                  VALUE '1'.
  2568
  2569         16  CF-LGX-CLAIM-USER              PIC X.
  2570             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2571             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2572
  2573         16  CF-CREDIT-EDIT-CONTROLS.
  2574             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2575             20  CF-MIN-AGE                 PIC 99.
  2576             20  CF-DEFAULT-AGE             PIC 99.
  2577             20  CF-MIN-TERM                PIC S999      COMP-3.
  2578             20  CF-MAX-TERM                PIC S999      COMP-3.
  2579             20  CF-DEFAULT-SEX             PIC X.
  2580             20  CF-JOINT-AGE-INPUT         PIC X.
  2581                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2582             20  CF-BIRTH-DATE-INPUT        PIC X.
  2583                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2584             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2585                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2586                 88  CF-ZERO-CARRIER            VALUE '1'.
  2587                 88  CF-ZERO-GROUPING           VALUE '2'.
  2588                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2589             20  CF-EDIT-SW                 PIC X.
  2590                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2591             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2592             20  CF-CR-PR-METHOD            PIC X.
  2593               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2594               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2595             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  47
* EL6317.cbl
  2596
  2597         16  CF-CREDIT-MISC-CONTROLS.
  2598             20  CF-REIN-TABLE-SW           PIC X.
  2599                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2600             20  CF-COMP-TABLE-SW           PIC X.
  2601                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2602             20  CF-EXPERIENCE-RETENTION-AGE
  2603                                            PIC S9        COMP-3.
  2604             20  CF-CONVERSION-DT           PIC XX.
  2605             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2606             20  CF-RUN-FREQUENCY-SW        PIC X.
  2607                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2608                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2609
  2610             20  CF-CR-CHECK-NO-CONTROL.
  2611                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2612                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2613                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2614                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2615                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2616                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2617
  2618                 24  CF-CR-CHECK-COUNT       REDEFINES
  2619                     CF-CR-CHECK-COUNTER      PIC X(4).
  2620
  2621                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2622                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2623
  2624                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2625                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2626                 24  CF-MAIL-PROCESSING       PIC X.
  2627                     88  MAIL-PROCESSING          VALUE 'Y'.
  2628
  2629         16  CF-MISC-SYSTEM-CONTROL.
  2630             20  CF-SYSTEM-C                 PIC X.
  2631                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2632             20  CF-SYSTEM-D                 PIC X.
  2633                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2634             20  CF-SOC-SEC-NO-SW            PIC X.
  2635                 88  SOC-SEC-NO-USED             VALUE '1'.
  2636             20  CF-MEMBER-NO-SW             PIC X.
  2637                 88  MEMBER-NO-USED              VALUE '1'.
  2638             20  CF-TAX-ID-NUMBER            PIC X(11).
  2639             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2640             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2641                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2642                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2643                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2644                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2645             20  CF-SYSTEM-E                 PIC X.
  2646                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2647
  2648         16  CF-LGX-LIFE-USER               PIC X.
  2649             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2650             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2651
  2652         16  CF-CR-MONTH-END-DT             PIC XX.
  2653
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  48
* EL6317.cbl
  2654         16  CF-FILE-MAINT-DATES.
  2655             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2656                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2657             20  CF-LAST-BATCH       REDEFINES
  2658                 CF-LAST-BATCH-NO               PIC X(4).
  2659             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2660             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2661             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2662             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2663             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2664             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2665             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2666             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2667             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2668             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2669
  2670         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2671         16  FILLER                         PIC X.
  2672
  2673         16  CF-ALT-MORT-CODE               PIC X(4).
  2674         16  CF-MEMBER-CAPTION              PIC X(10).
  2675
  2676         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2677             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2678             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2679             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2680             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2681             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2682
  2683         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2684
  2685         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2686         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2687         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2688         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2689
  2690         16  CF-AH-OVERRIDE-L1              PIC X.
  2691         16  CF-AH-OVERRIDE-L2              PIC XX.
  2692         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2693         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2694
  2695         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2696         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2697
  2698         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2699         16  CF-AR-LAST-EL860-DT            PIC XX.
  2700         16  CF-MP-MONTH-END-DT             PIC XX.
  2701
  2702         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2703         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2704             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2705
  2706         16  CF-AR-MONTH-END-DT             PIC XX.
  2707
  2708         16  CF-CRDTCRD-USER                PIC X.
  2709             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2710             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2711
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  49
* EL6317.cbl
  2712         16  CF-CC-MONTH-END-DT             PIC XX.
  2713
  2714         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2715
  2716         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2717             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2718             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2719             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2720         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2721         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2722         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2723         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2724             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2725             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2726         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2727         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2728         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2729             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2730         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2731
  2732         16  CF-CL-ZIP-CODE.
  2733             20  CF-CL-ZIP-PRIME.
  2734                 24  CF-CL-ZIP-1ST          PIC X.
  2735                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2736                 24  FILLER                 PIC X(4).
  2737             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2738         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2739             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2740             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2741             20  FILLER                     PIC XXX.
  2742
  2743         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2744         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2745         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2746         16  CF-CO-OPTION-START-DATE        PIC XX.
  2747         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2748           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2749                                                      '3' '4'.
  2750           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2751           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2752           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2753           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2754           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2755           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2756
  2757         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2758
  2759         16  CF-PAYMENT-APPROVAL-LEVELS.
  2760             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2761             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2762             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2763             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2764             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2765             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2766
  2767         16  CF-END-USER-REPORTING-USER     PIC X.
  2768             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2769             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  50
* EL6317.cbl
  2770
  2771         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2772             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2773             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2774
  2775         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2776
  2777         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2778         16  FILLER                         PIC X.
  2779
  2780         16  CF-CREDIT-ARCHIVE-CNTL.
  2781             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2782             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2783             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2784
  2785         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2786
  2787         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2788             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2789             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2790
  2791         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2792             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2793             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2794
  2795         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2796
  2797         16  CF-CO-ACH-ID-CODE              PIC  X.
  2798             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2799             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2800             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2801         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2802         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2803         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2804         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2805         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2806         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2807         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2808         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2809         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2810                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2811         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2812                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2813
  2814         16  CF-CO-OVER-SHORT.
  2815             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2816             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2817
  2818*         16  FILLER                         PIC X(102).
  2819         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2820             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2821             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2822
  2823         16  CF-AH-APPROVAL-DAYS.
  2824             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2825             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2826             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2827             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  51
* EL6317.cbl
  2828
  2829         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2830
  2831         16  CF-APPROV-LEV-5.
  2832             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2833             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2834             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2835
  2836         16  FILLER                         PIC X(68).
  2837****************************************************************
  2838*             PROCESSOR/USER RECORD                            *
  2839****************************************************************
  2840
  2841     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2842         16  CF-PROCESSOR-NAME              PIC X(30).
  2843         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2844         16  CF-PROCESSOR-TITLE             PIC X(26).
  2845         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2846                 88  MESSAGE-YES                VALUE 'Y'.
  2847                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2848
  2849*****************************************************
  2850****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2851****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2852****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2853****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2854*****************************************************
  2855
  2856         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2857             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2858             20  CF-APPLICATION-FORCE       PIC X.
  2859             20  CF-INDIVIDUAL-APP.
  2860                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2861                     28  CF-BROWSE-APP      PIC X.
  2862                     28  CF-UPDATE-APP      PIC X.
  2863
  2864         16  CF-CURRENT-TERM-ON             PIC X(4).
  2865         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2866             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2867             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2868             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2869             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2870             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2871             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2872             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2873         16  CF-PROCESSOR-CARRIER           PIC X.
  2874             88  NO-CARRIER-SECURITY            VALUE ' '.
  2875         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2876             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2877         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2878             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2879         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2880             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2881
  2882         16  CF-PROC-SYS-ACCESS-SW.
  2883             20  CF-PROC-CREDIT-CLAIMS-SW.
  2884                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2885                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  52
* EL6317.cbl
  2886                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2887                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2888             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2889                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2890                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2891             20  CF-PROC-LIFE-GNRLDGR-SW.
  2892                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2893                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2894                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2895                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2896             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2897                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2898                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2899         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2900             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2901             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2902         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2903
  2904         16  CF-APPROVAL-LEVEL                  PIC X.
  2905             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2906             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2907             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2908             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2909             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2910
  2911         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2912
  2913         16  CF-LANGUAGE-TYPE                   PIC X.
  2914             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2915             88  CF-LANG-IS-FR                      VALUE 'F'.
  2916
  2917         16  CF-CSR-IND                         PIC X.
  2918         16  FILLER                             PIC X(239).
  2919
  2920****************************************************************
  2921*             PROCESSOR/REMINDERS RECORD                       *
  2922****************************************************************
  2923
  2924     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2925         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2926             20  CF-START-REMIND-DT         PIC XX.
  2927             20  CF-END-REMIND-DT           PIC XX.
  2928             20  CF-REMINDER-TEXT           PIC X(50).
  2929         16  FILLER                         PIC X(296).
  2930
  2931
  2932****************************************************************
  2933*             STATE MASTER RECORD                              *
  2934****************************************************************
  2935
  2936     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2937         16  CF-STATE-ABBREVIATION          PIC XX.
  2938         16  CF-STATE-NAME                  PIC X(25).
  2939         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2940         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2941             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2942             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2943             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  53
* EL6317.cbl
  2944             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2945                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2946                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2947             20  CF-ST-PREM-REJECT-SW       PIC X.
  2948                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2949                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2950             20  CF-ST-REF-REJECT-SW        PIC X.
  2951                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2952                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2953         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2954         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2955         16  CF-ST-REFUND-RULES.
  2956             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2957             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2958             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2959         16  CF-ST-FST-PMT-EXTENSION.
  2960             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2961             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2962                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2963                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2964                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2965                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2966         16  CF-ST-STATE-CALL.
  2967             20  CF-ST-CALL-UNEARNED        PIC X.
  2968             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2969             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2970         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2971             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2972             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2973         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2974         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2975         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2976         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2977         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2978         16  FILLER                         PIC X.
  2979         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2980             20  CF-ST-BENEFIT-CD           PIC XX.
  2981             20  CF-ST-BENEFIT-KIND         PIC X.
  2982                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2983                 88  CF-ST-AH-KIND              VALUE 'A'.
  2984             20  CF-ST-REM-TERM-CALC        PIC X.
  2985                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2986                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2987                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2988                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2989                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2990                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2991                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2992                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2993
  2994             20  CF-ST-REFUND-CALC          PIC X.
  2995                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2996                 88  ST-REFD-BY-R78             VALUE '1'.
  2997                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2998                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2999                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3000                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3001                 88  ST-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  54
* EL6317.cbl
  3002                 88  ST-REFD-UTAH               VALUE '7'.
  3003                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3004                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3005                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3006
  3007             20  CF-ST-EARNING-CALC         PIC X.
  3008                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3009                 88  ST-EARN-BY-R78             VALUE '1'.
  3010                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3011                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3012                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3013                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3014                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3015                 88  ST-EARN-MEAN               VALUE '8'.
  3016                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3017
  3018             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3019                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3020                 88  ST-OVRD-BY-R78             VALUE '1'.
  3021                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3022                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3023                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3024                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3025                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3026                 88  ST-OVRD-MEAN               VALUE '8'.
  3027                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3028             20  FILLER                     PIC X.
  3029
  3030         16  CF-ST-COMMISSION-CAPS.
  3031             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3032             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3033             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3034             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3035         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3036                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3037
  3038         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3039
  3040         16  CF-ST-STATUTORY-INTEREST.
  3041             20  CF-ST-STAT-DATE-FROM       PIC X.
  3042                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3043                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3044             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3045             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3046             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3047             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3048             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3049
  3050         16  CF-ST-OVER-SHORT.
  3051             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3052             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3053
  3054         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3055
  3056         16  CF-ST-RT-CALC                  PIC X.
  3057
  3058         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3059         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  55
* EL6317.cbl
  3060         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3061         16  CF-ST-RF-LR-CALC               PIC X.
  3062         16  CF-ST-RF-LL-CALC               PIC X.
  3063         16  CF-ST-RF-LN-CALC               PIC X.
  3064         16  CF-ST-RF-AH-CALC               PIC X.
  3065         16  CF-ST-RF-CP-CALC               PIC X.
  3066*        16  FILLER                         PIC X(206).
  3067*CIDMOD         16  FILLER                         PIC X(192).
  3068         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3069             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3070         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3071         16  CF-ST-VFY-2ND-BENE             PIC X.
  3072         16  CF-ST-CAUSAL-STATE             PIC X.
  3073         16  FILLER                         PIC X(185).
  3074
  3075****************************************************************
  3076*             BENEFIT MASTER RECORD                            *
  3077****************************************************************
  3078
  3079     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3080         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3081             20  CF-BENEFIT-CODE            PIC XX.
  3082             20  CF-BENEFIT-NUMERIC  REDEFINES
  3083                 CF-BENEFIT-CODE            PIC XX.
  3084             20  CF-BENEFIT-ALPHA           PIC XXX.
  3085             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3086             20  CF-BENEFIT-COMMENT         PIC X(10).
  3087
  3088             20  CF-LF-COVERAGE-TYPE        PIC X.
  3089                 88  CF-REDUCING                VALUE 'R'.
  3090                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3091
  3092             20  CF-SPECIAL-CALC-CD         PIC X.
  3093                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3094                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3095                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3096                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3097                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3098                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3099                 88  CF-FARM-PLAN               VALUE 'F'.
  3100                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3101                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3102                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3103                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3104                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3105                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3106                 88  CF-PRUDENTIAL              VALUE 'P'.
  3107                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3108                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3109                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3110                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3111                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3112                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3113
  3114             20  CF-JOINT-INDICATOR         PIC X.
  3115                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3116
  3117*            20  FILLER                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  56
* EL6317.cbl
  3118             20  FILLER                     PIC X(11).
  3119             20  CF-BENEFIT-CATEGORY        PIC X.
  3120             20  CF-LOAN-TYPE               PIC X(8).
  3121
  3122             20  CF-CO-REM-TERM-CALC        PIC X.
  3123                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3124                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3125                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3126                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3127                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3128
  3129             20  CF-CO-EARNINGS-CALC        PIC X.
  3130                 88  CO-EARN-BY-R78             VALUE '1'.
  3131                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3132                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3133                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3134                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3135                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3136                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3137                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3138
  3139             20  CF-CO-REFUND-CALC          PIC X.
  3140                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3141                 88  CO-REFD-BY-R78             VALUE '1'.
  3142                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3143                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3144                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3145                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3146                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3147                 88  CO-REFD-MEAN               VALUE '8'.
  3148                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3149                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3150                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3151
  3152             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3153                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3154                 88  CO-OVRD-BY-R78             VALUE '1'.
  3155                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3156                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3157                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3158                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3159                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3160                 88  CO-OVRD-MEAN               VALUE '8'.
  3161                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3162
  3163             20  CF-CO-BEN-I-G-CD           PIC X.
  3164                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3165                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3166                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3167
  3168         16  FILLER                         PIC X(304).
  3169
  3170
  3171****************************************************************
  3172*             CARRIER MASTER RECORD                            *
  3173****************************************************************
  3174
  3175     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  57
* EL6317.cbl
  3176         16  CF-ADDRESS-DATA.
  3177             20  CF-MAIL-TO-NAME            PIC X(30).
  3178             20  CF-IN-CARE-OF              PIC X(30).
  3179             20  CF-ADDRESS-LINE-1          PIC X(30).
  3180             20  CF-ADDRESS-LINE-2          PIC X(30).
  3181             20  CF-CITY-STATE              PIC X(30).
  3182             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3183             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3184
  3185         16  CF-CLAIM-NO-CONTROL.
  3186             20  CF-CLAIM-NO-METHOD         PIC X.
  3187                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3188                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3189                 88  CLAIM-NO-SEQ               VALUE '3'.
  3190                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3191             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3192                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3193                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3194                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3195
  3196         16  CF-CHECK-NO-CONTROL.
  3197             20  CF-CHECK-NO-METHOD         PIC X.
  3198                 88  CHECK-NO-MANUAL            VALUE '1'.
  3199                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3200                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3201                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3202             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3203                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3204
  3205         16  CF-DOMICILE-STATE              PIC XX.
  3206
  3207         16  CF-EXPENSE-CONTROLS.
  3208             20  CF-EXPENSE-METHOD          PIC X.
  3209                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3210                 88  DOLLARS-PER-PMT            VALUE '2'.
  3211                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3212                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3213             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3214             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3215
  3216         16  CF-CORRESPONDENCE-CONTROL.
  3217             20  CF-LETTER-RESEND-OPT       PIC X.
  3218                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3219                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3220             20  FILLER                     PIC X(4).
  3221
  3222         16  CF-RESERVE-CONTROLS.
  3223             20  CF-MANUAL-SW               PIC X.
  3224                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3225             20  CF-FUTURE-SW               PIC X.
  3226                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3227             20  CF-PTC-SW                  PIC X.
  3228                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3229             20  CF-IBNR-SW                 PIC X.
  3230                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3231             20  CF-PTC-LF-SW               PIC X.
  3232                 88  CF-LF-PTC-USED             VALUE '1'.
  3233             20  CF-CDT-ACCESS-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  58
* EL6317.cbl
  3234                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3235                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3236                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3237             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3238
  3239         16  CF-CLAIM-CALC-METHOD           PIC X.
  3240             88  360-PLUS-MONTHS                VALUE '1'.
  3241             88  365-PLUS-MONTHS                VALUE '2'.
  3242             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3243             88  360-DAILY                      VALUE '4'.
  3244             88  365-DAILY                      VALUE '5'.
  3245
  3246         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3247         16  FILLER                         PIC X(11).
  3248
  3249         16  CF-LIMIT-AMOUNTS.
  3250             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3251             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3252             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3253             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3254             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3255             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3256             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3257             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3258             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3259             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3260
  3261         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3262         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3263         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3264
  3265         16  CF-ZIP-CODE.
  3266             20  CF-ZIP-PRIME.
  3267                 24  CF-ZIP-1ST             PIC X.
  3268                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3269                 24  FILLER                 PIC X(4).
  3270             20  CF-ZIP-PLUS4               PIC X(4).
  3271         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3272             20  CF-CAN-POSTAL-1            PIC XXX.
  3273             20  CF-CAN-POSTAL-2            PIC XXX.
  3274             20  FILLER                     PIC XXX.
  3275
  3276         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3277         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3278         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3279
  3280         16  CF-RATING-SWITCH               PIC X.
  3281             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3282             88  CF-NO-RATING                   VALUE 'N'.
  3283
  3284         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3285
  3286         16  CF-CARRIER-OVER-SHORT.
  3287             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3288             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3289
  3290         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3291         16  CF-SECPAY-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  59
* EL6317.cbl
  3292             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3293             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3294         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3295         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3296         16  FILLER                         PIC X(444).
  3297*        16  FILLER                         PIC X(452).
  3298
  3299
  3300****************************************************************
  3301*             MORTALITY MASTER RECORD                          *
  3302****************************************************************
  3303
  3304     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3305         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3306                                INDEXED BY CF-MORT-NDX.
  3307             20  CF-MORT-TABLE              PIC X(5).
  3308             20  CF-MORT-TABLE-TYPE         PIC X.
  3309                 88  CF-MORT-JOINT              VALUE 'J'.
  3310                 88  CF-MORT-SINGLE             VALUE 'S'.
  3311                 88  CF-MORT-COMBINED           VALUE 'C'.
  3312                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3313                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3314             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3315             20  CF-MORT-AGE-METHOD         PIC XX.
  3316                 88  CF-AGE-LAST                VALUE 'AL'.
  3317                 88  CF-AGE-NEAR                VALUE 'AN'.
  3318             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3319             20  CF-MORT-ADJUSTMENT-DIRECTION
  3320                                            PIC X.
  3321                 88  CF-MINUS                   VALUE '-'.
  3322                 88  CF-PLUS                    VALUE '+'.
  3323             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3324             20  CF-MORT-JOINT-CODE         PIC X.
  3325                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3326             20  CF-MORT-PC-Q               PIC X.
  3327                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3328             20  CF-MORT-TABLE-CODE         PIC X(4).
  3329             20  CF-MORT-COMMENTS           PIC X(15).
  3330             20  FILLER                     PIC X(14).
  3331
  3332         16  FILLER                         PIC X(251).
  3333
  3334
  3335****************************************************************
  3336*             BUSSINESS TYPE MASTER RECORD                     *
  3337****************************************************************
  3338
  3339     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3340* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3341* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3342* AND RECORD 05 IS TYPES 81-99
  3343         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3344             20  CF-BUSINESS-TITLE          PIC  X(19).
  3345             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3346                                            PIC S9V9(4) COMP-3.
  3347             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3348             20  FILLER                     PIC  X.
  3349         16  FILLER                         PIC  X(248).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  60
* EL6317.cbl
  3350
  3351
  3352****************************************************************
  3353*             TERMINAL MASTER RECORD                           *
  3354****************************************************************
  3355
  3356     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3357
  3358         16  CF-COMPANY-TERMINALS.
  3359             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3360                                  PIC X(4).
  3361         16  FILLER               PIC X(248).
  3362
  3363
  3364****************************************************************
  3365*             LIFE EDIT MASTER RECORD                          *
  3366****************************************************************
  3367
  3368     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3369         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3370             20  CF-LIFE-CODE-IN            PIC XX.
  3371             20  CF-LIFE-CODE-OUT           PIC XX.
  3372         16  FILLER                         PIC X(248).
  3373
  3374
  3375****************************************************************
  3376*             AH EDIT MASTER RECORD                            *
  3377****************************************************************
  3378
  3379     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3380         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3381             20  CF-AH-CODE-IN              PIC XXX.
  3382             20  CF-AH-CODE-OUT             PIC XX.
  3383         16  FILLER                         PIC X(248).
  3384
  3385
  3386****************************************************************
  3387*             CREDIBILITY TABLES                               *
  3388****************************************************************
  3389
  3390     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3391         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3392                             INDEXED BY CF-CRDB-NDX.
  3393             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3394             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3395             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3396         16  FILLER                         PIC  X(332).
  3397
  3398
  3399****************************************************************
  3400*             REPORT CUSTOMIZATION RECORD                      *
  3401****************************************************************
  3402
  3403     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3404         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3405             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3406             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3407             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  61
* EL6317.cbl
  3408**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3409****       A T-TRANSFER.                                   ****
  3410             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3411
  3412         16  FILLER                         PIC XX.
  3413
  3414         16  CF-CARRIER-CNTL-OPT.
  3415             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3416                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3417                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3418             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3419                                            PIC X.
  3420         16  CF-GROUP-CNTL-OPT.
  3421             20  CF-GROUP-OPT-SEQ           PIC 9.
  3422                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3423                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3424             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3425                                            PIC X(6).
  3426         16  CF-STATE-CNTL-OPT.
  3427             20  CF-STATE-OPT-SEQ           PIC 9.
  3428                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3429                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3430             20  CF-STATE-SELECT OCCURS 3 TIMES
  3431                                            PIC XX.
  3432         16  CF-ACCOUNT-CNTL-OPT.
  3433             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3434                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3435                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3436             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3437                                            PIC X(10).
  3438         16  CF-BUS-TYP-CNTL-OPT.
  3439             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3440                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3441                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3442             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3443                                            PIC XX.
  3444         16  CF-LF-TYP-CNTL-OPT.
  3445             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3446                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3447                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3448             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3449                                            PIC XX.
  3450         16  CF-AH-TYP-CNTL-OPT.
  3451             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3452                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3453                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3454             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3455                                            PIC XX.
  3456         16  CF-REPTCD1-CNTL-OPT.
  3457             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3458                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3459                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3460             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3461                                            PIC X(10).
  3462         16  CF-REPTCD2-CNTL-OPT.
  3463             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3464                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3465                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  62
* EL6317.cbl
  3466             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3467                                            PIC X(10).
  3468         16  CF-USER1-CNTL-OPT.
  3469             20  CF-USER1-OPT-SEQ           PIC 9.
  3470                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3471                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3472             20  CF-USER1-SELECT OCCURS 3 TIMES
  3473                                            PIC X(10).
  3474         16  CF-USER2-CNTL-OPT.
  3475             20  CF-USER2-OPT-SEQ           PIC 9.
  3476                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3477                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3478             20  CF-USER2-SELECT OCCURS 3 TIMES
  3479                                            PIC X(10).
  3480         16  CF-USER3-CNTL-OPT.
  3481             20  CF-USER3-OPT-SEQ           PIC 9.
  3482                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3483                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3484             20  CF-USER3-SELECT OCCURS 3 TIMES
  3485                                            PIC X(10).
  3486         16  CF-USER4-CNTL-OPT.
  3487             20  CF-USER4-OPT-SEQ           PIC 9.
  3488                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3489                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3490             20  CF-USER4-SELECT OCCURS 3 TIMES
  3491                                            PIC X(10).
  3492         16  CF-USER5-CNTL-OPT.
  3493             20  CF-USER5-OPT-SEQ           PIC 9.
  3494                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3495                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3496             20  CF-USER5-SELECT OCCURS 3 TIMES
  3497                                            PIC X(10).
  3498         16  CF-REINS-CNTL-OPT.
  3499             20  CF-REINS-OPT-SEQ           PIC 9.
  3500                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3501                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3502             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3503                 24  CF-REINS-PRIME         PIC XXX.
  3504                 24  CF-REINS-SUB           PIC XXX.
  3505
  3506         16  CF-AGENT-CNTL-OPT.
  3507             20  CF-AGENT-OPT-SEQ           PIC 9.
  3508                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3509                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3510             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3511                                            PIC X(10).
  3512
  3513         16  FILLER                         PIC X(43).
  3514
  3515         16  CF-LOSS-RATIO-SELECT.
  3516             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3517             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3518         16  CF-ENTRY-DATE-SELECT.
  3519             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3520             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3521         16  CF-EFFECTIVE-DATE-SELECT.
  3522             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3523             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  63
* EL6317.cbl
  3524
  3525         16  CF-EXCEPTION-LIST-IND          PIC X.
  3526             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3527
  3528         16  FILLER                         PIC X(318).
  3529
  3530****************************************************************
  3531*                  EXCEPTION REPORTING RECORD                  *
  3532****************************************************************
  3533
  3534     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3535         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3536             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3537
  3538         16  CF-COMBINED-LIFE-AH-OPT.
  3539             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3540             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3541             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3542             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3543
  3544         16  CF-LIFE-OPT.
  3545             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3546             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3547             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3548             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3549             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3550             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3551             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3552             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3553             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3554             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3555
  3556         16  CF-AH-OPT.
  3557             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3558             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3559             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3560             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3561             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3562             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3563             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3564             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3565             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3566             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3567
  3568         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3569             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3570             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3571             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3572
  3573         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3574
  3575         16  FILLER                         PIC X(673).
  3576
  3577
  3578****************************************************************
  3579*             MORTGAGE SYSTEM PLAN RECORD                      *
  3580****************************************************************
  3581
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  64
* EL6317.cbl
  3582     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3583         16  CF-PLAN-TYPE                   PIC X.
  3584             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3585             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3586             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3587         16  CF-PLAN-ABBREV                 PIC XXX.
  3588         16  CF-PLAN-DESCRIPT               PIC X(10).
  3589         16  CF-PLAN-NOTES                  PIC X(20).
  3590         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3591         16  CF-PLAN-UNDERWRITING.
  3592             20  CF-PLAN-TERM-DATA.
  3593                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3594                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3595             20  CF-PLAN-AGE-DATA.
  3596                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3597                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3598                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3599             20  CF-PLAN-BENEFIT-DATA.
  3600                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3601                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3602                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3603                                            PIC S9(7)V99  COMP-3.
  3604         16  CF-PLAN-POLICY-FORMS.
  3605             20  CF-POLICY-FORM             PIC X(12).
  3606             20  CF-MASTER-APPLICATION      PIC X(12).
  3607             20  CF-MASTER-POLICY           PIC X(12).
  3608         16  CF-PLAN-RATING.
  3609             20  CF-RATE-CODE               PIC X(5).
  3610             20  CF-SEX-RATING              PIC X.
  3611                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3612                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3613             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3614             20  CF-SUB-STD-TYPE            PIC X.
  3615                 88  CF-PCT-OF-PREM            VALUE '1'.
  3616                 88  CF-PCT-OF-BENE            VALUE '2'.
  3617         16  CF-PLAN-PREM-TOLERANCES.
  3618             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3619             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3620         16  CF-PLAN-PYMT-TOLERANCES.
  3621             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3622             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3623         16  CF-PLAN-MISC-DATA.
  3624             20  FILLER                     PIC X.
  3625             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3626             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3627         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3628         16  CF-PLAN-IND-GRP                PIC X.
  3629             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3630                                                     '1'.
  3631             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3632                                                     '2'.
  3633         16  CF-MIB-SEARCH-SW               PIC X.
  3634             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3635             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3636             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3637             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3638         16  CF-ALPHA-SEARCH-SW             PIC X.
  3639             88  CF-MIB-ALPHA-ALL              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  65
* EL6317.cbl
  3640             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3641             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3642             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3643             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3644             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3645             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3646             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3647             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3648             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3649                                                     'A' 'B' 'C'
  3650                                                     'X' 'Y' 'Z'.
  3651         16  CF-EFF-DT-RULE-SW              PIC X.
  3652             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3653             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3654             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3655             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3656             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3657         16  FILLER                         PIC X(4).
  3658         16  CF-HEALTH-QUESTIONS            PIC X.
  3659             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3660         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3661         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3662         16  CF-PLAN-SNGL-JNT               PIC X.
  3663             88  CF-COMBINED-PLAN              VALUE 'C'.
  3664             88  CF-JNT-PLAN                   VALUE 'J'.
  3665             88  CF-SNGL-PLAN                  VALUE 'S'.
  3666         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3667         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3668         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3669         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3670         16  CF-RERATE-CNTL                 PIC  X.
  3671             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3672             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3673             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3674             88  CF-AUTO-RECALC                 VALUE '4'.
  3675         16  CF-BENEFIT-TYPE                PIC  X.
  3676             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3677             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3678         16  CF-POLICY-FEE                  PIC S999V99
  3679                                                    COMP-3.
  3680         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3681         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3682         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3683         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3684         16  FILLER                         PIC  X(32).
  3685         16  CF-TERMINATION-FORM            PIC  X(04).
  3686         16  FILLER                         PIC  X(08).
  3687         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3688                                                       COMP-3.
  3689         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3690         16  CF-ISSUE-LETTER                PIC  X(4).
  3691         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3692         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3693             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3694             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3695         16  CF-MP-REFUND-CALC              PIC X.
  3696             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3697             88  CF-MP-REFD-BY-R78              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  66
* EL6317.cbl
  3698             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3699             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3700             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3701             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3702             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3703             88  CF-MP-REFD-MEAN                VALUE '8'.
  3704         16  CF-ALT-RATE-CODE               PIC  X(5).
  3705
  3706
  3707         16  FILLER                         PIC X(498).
  3708****************************************************************
  3709*             MORTGAGE COMPANY MASTER RECORD                   *
  3710****************************************************************
  3711
  3712     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3713         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3714         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3715             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3716             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3717             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3718             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3719             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3720
  3721         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3722         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3723         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3724         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3725         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3726
  3727         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3728             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3729         16  CF-MP-RECON-USE-IND            PIC X(1).
  3730             88  CF-MP-USE-RECON             VALUE 'Y'.
  3731         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3732             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3733         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3734             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3735             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3736         16  FILLER                         PIC X(1).
  3737         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3738             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3739         16  CF-MORTG-MIB-VERSION           PIC X.
  3740             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3741             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3742             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3743         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3744             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3745                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3746             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3747                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3748             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3749                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3750             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3751                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3752             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3753                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3754             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3755                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  67
* EL6317.cbl
  3756         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3757         16  FILLER                         PIC X(7).
  3758         16  CF-MORTG-DESTINATION-SYMBOL.
  3759             20  CF-MORTG-MIB-COMM          PIC X(5).
  3760             20  CF-MORTG-MIB-TERM          PIC X(5).
  3761         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3762             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3763         16  FILLER                         PIC X(03).
  3764         16  CF-MP-CHECK-NO-CONTROL.
  3765             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3766                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3767                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3768                                                ' ' LOW-VALUES.
  3769                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3770                                               VALUE '3'.
  3771         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3772         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3773         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3774             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3775                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3776             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3777                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3778             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3779                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3780             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3781                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3782             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3783                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3784             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3785                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3786         16  CF-MORTG-BILLING-AREA.
  3787             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3788                                            PIC X.
  3789         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3790         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3791         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3792         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3793             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3794             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3795         16  FILLER                         PIC X.
  3796         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3797             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3798             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3799         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3800         16  FILLER                         PIC X(8).
  3801         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3802         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3803         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3804         16  CF-ACH-COMPANY-ID.
  3805             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3806                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3807                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3808                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3809             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3810         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3811             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3812         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3813             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  68
* EL6317.cbl
  3814             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3815         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3816         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3817         16  FILLER                         PIC X(536).
  3818
  3819****************************************************************
  3820*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3821****************************************************************
  3822
  3823     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3824         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3825             20  CF-FEMALE-HEIGHT.
  3826                 24  CF-FEMALE-FT           PIC 99.
  3827                 24  CF-FEMALE-IN           PIC 99.
  3828             20  CF-FEMALE-MIN-WT           PIC 999.
  3829             20  CF-FEMALE-MAX-WT           PIC 999.
  3830         16  FILLER                         PIC X(428).
  3831
  3832     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3833         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3834             20  CF-MALE-HEIGHT.
  3835                 24  CF-MALE-FT             PIC 99.
  3836                 24  CF-MALE-IN             PIC 99.
  3837             20  CF-MALE-MIN-WT             PIC 999.
  3838             20  CF-MALE-MAX-WT             PIC 999.
  3839         16  FILLER                         PIC X(428).
  3840******************************************************************
  3841*             AUTOMATIC ACTIVITY RECORD                          *
  3842******************************************************************
  3843     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3844         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3845             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3846             20  CF-SYS-LETTER-ID           PIC X(04).
  3847             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3848             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3849             20  CF-SYS-RESET-SW            PIC X(01).
  3850             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3851             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3852
  3853         16  FILLER                         PIC X(50).
  3854
  3855         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3856             20  CF-USER-ACTIVE-SW          PIC X(01).
  3857             20  CF-USER-LETTER-ID          PIC X(04).
  3858             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3859             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3860             20  CF-USER-RESET-SW           PIC X(01).
  3861             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3862             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3863             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3864
  3865         16  FILLER                         PIC X(246).
  3866*                                COPY ERCPNDB.
  3867******************************************************************
  3868*                                                                *
  3869*                                                                *
  3870*                            ERCPNDB.                            *
  3871*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  69
* EL6317.cbl
  3872*                            VMOD=2.025                          *
  3873*                                                                *
  3874*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3875*                                                                *
  3876******************************************************************
  3877*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3878*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3879******************************************************************
  3880*                                                                *
  3881*                                                                *
  3882*   FILE TYPE = VSAM,KSDS                                        *
  3883*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3884*                                                                *
  3885*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3886*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3887*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3888*                                                 RKP=13,LEN=36  *
  3889*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3890*                                      AND CHG-SEQ.)             *
  3891*                                                RKP=49,LEN=11   *
  3892*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3893*                                      AND CHG-SEQ.)             *
  3894*                                                RKP=60,LEN=15   *
  3895*                                                                *
  3896*   LOG = NO                                                     *
  3897*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3898******************************************************************
  3899******************************************************************
  3900*                   C H A N G E   L O G
  3901*
  3902* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3903*-----------------------------------------------------------------
  3904*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3905* EFFECTIVE    NUMBER
  3906*-----------------------------------------------------------------
  3907* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3908* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3909* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3910* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3911* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3912* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3913* 032306                   PEMA  ADD BOW LOAN NUMBER
  3914* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3915* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3916* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3917* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3918* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3919* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3920* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3921* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3922******************************************************************
  3923
  3924 01  PENDING-BUSINESS.
  3925     12  PB-RECORD-ID                     PIC XX.
  3926         88  VALID-PB-ID                        VALUE 'PB'.
  3927
  3928     12  PB-CONTROL-PRIMARY.
  3929         16  PB-COMPANY-CD                PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  70
* EL6317.cbl
  3930         16  PB-ENTRY-BATCH               PIC X(6).
  3931         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3932         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3933
  3934     12  PB-CONTROL-BY-ACCOUNT.
  3935         16  PB-COMPANY-CD-A1             PIC X.
  3936         16  PB-CARRIER                   PIC X.
  3937         16  PB-GROUPING.
  3938             20  PB-GROUPING-PREFIX       PIC XXX.
  3939             20  PB-GROUPING-PRIME        PIC XXX.
  3940         16  PB-STATE                     PIC XX.
  3941         16  PB-ACCOUNT.
  3942             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3943             20  PB-ACCOUNT-PRIME         PIC X(6).
  3944         16  PB-CERT-EFF-DT               PIC XX.
  3945         16  PB-CERT-NO.
  3946             20  PB-CERT-PRIME            PIC X(10).
  3947             20  PB-CERT-SFX              PIC X.
  3948         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3949
  3950         16  PB-RECORD-TYPE               PIC X.
  3951             88  PB-MAILING-DATA                VALUE '0'.
  3952             88  PB-ISSUE                       VALUE '1'.
  3953             88  PB-CANCELLATION                VALUE '2'.
  3954             88  PB-BATCH-TRAILER               VALUE '9'.
  3955
  3956     12  PB-CONTROL-BY-ORIG-BATCH.
  3957         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3958         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3959         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3960         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3961
  3962     12  PB-CONTROL-BY-CSR.
  3963         16  PB-CSR-COMPANY-CD            PIC X.
  3964         16  PB-CSR-ID                    PIC X(4).
  3965         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3966         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3967         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3968******************************************************************
  3969*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3970******************************************************************
  3971
  3972     12  PB-LAST-MAINT-DT                 PIC XX.
  3973     12  PB-LAST-MAINT-BY                 PIC X(4).
  3974     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3975
  3976     12  PB-RECORD-BODY                   PIC X(375).
  3977
  3978     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3979         16  PB-CERT-ORIGIN               PIC X.
  3980             88  CLASIC-CREATED-CERT         VALUE '1'.
  3981         16  PB-I-NAME.
  3982             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3983             20  PB-I-INSURED-FIRST-NAME.
  3984                 24  PB-I-INSURED-1ST-INIT PIC X.
  3985                 24  FILLER                PIC X(9).
  3986             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3987         16  PB-I-AGE                     PIC S99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  71
* EL6317.cbl
  3988         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3989         16  PB-I-BIRTHDAY                PIC XX.
  3990         16  PB-I-INSURED-SEX             PIC X.
  3991             88  PB-SEX-MALE     VALUE 'M'.
  3992             88  PB-SEX-FEMALE   VALUE 'F'.
  3993
  3994         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3995         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3996         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3997         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3998         16  PB-I-SKIP-CODE               PIC X.
  3999             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4000             88  PB-SKIP-JULY              VALUE '1'.
  4001             88  PB-SKIP-AUGUST            VALUE '2'.
  4002             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4003             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4004             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4005             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4006             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4007             88  PB-SKIP-JUNE              VALUE '8'.
  4008             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4009             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4010             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4011         16  PB-I-TERM-TYPE               PIC X.
  4012             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4013             88  PB-PAID-WEEKLY            VALUE 'W'.
  4014             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4015             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4016             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4017         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4018         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4019         16  PB-I-DATA-ENTRY-SW           PIC X.
  4020             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4021             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4022             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4023             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4024         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4025         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4026*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4027         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4028         16  FILLER                       PIC X.
  4029
  4030         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4031             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4032             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4033                                                   '90' THRU '99'.
  4034         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4035                                          PIC XX.
  4036         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4037         16  PB-I-AMOUNT-FINANCED REDEFINES
  4038                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4039         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4040         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4041                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4042         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4043         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4044         16  PB-I-CLP-AMOUNT REDEFINES
  4045                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  72
* EL6317.cbl
  4046         16  PB-I-LF-CALC-FLAG            PIC X.
  4047             88 PB-COMP-LF-PREM               VALUE '?'.
  4048         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4049         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4050         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4051         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4052         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4053         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4054         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4055         16  PB-I-LF-ABBR                 PIC XXX.
  4056         16  PB-I-LF-INPUT-CD             PIC XX.
  4057
  4058         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4059             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4060             88  PB-INVALID-AH               VALUE '  ' '00'
  4061                                                   '90' THRU '99'.
  4062         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4063         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4064         16  PB-I-AH-CALC-FLAG            PIC X.
  4065             88 PB-COMP-AH-PREM                  VALUE '?'.
  4066         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4067         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4068         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4069         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4070         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4071         16  PB-I-AH-ABBR                 PIC XXX.
  4072         16  PB-I-AH-INPUT-CD             PIC XXX.
  4073
  4074         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4075         16  PB-I-REIN-TABLE              PIC XXX.
  4076         16  PB-I-BUSINESS-TYPE           PIC 99.
  4077         16  PB-I-INDV-GRP-CD             PIC X.
  4078         16  PB-I-MORT-CODE.
  4079             20  PB-I-TABLE               PIC X.
  4080             20  PB-I-INTEREST            PIC XX.
  4081             20  PB-I-MORT-TYP            PIC X.
  4082         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4083         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4084         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4085         16  PB-I-INDV-GRP-OVRD           PIC X.
  4086         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4087         16  PB-I-SIG-SW                  PIC X.
  4088             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4089         16  PB-I-RATE-CLASS              PIC XX.
  4090         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4091         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4092         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4093         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4094         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4095         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4096         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4097         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4098         16  PB-I-OB-FLAG                 PIC X.
  4099             88  PB-I-OB                      VALUE 'B'.
  4100             88  PB-I-SUMMARY                 VALUE 'Z'.
  4101         16  PB-I-ENTRY-STATUS            PIC X.
  4102             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4103                                              'M' '5' '9' '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  73
* EL6317.cbl
  4104             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4105             88  PB-I-POLICY-PENDING          VALUE '2'.
  4106             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4107             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4108             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4109             88  PB-I-REIN-ONLY               VALUE '9'.
  4110             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4111             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4112             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4113             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4114         16  PB-I-INT-CODE                PIC X.
  4115             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4116             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4117         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4118         16  PB-I-SOC-SEC-NO              PIC X(11).
  4119         16  PB-I-MEMBER-NO               PIC X(12).
  4120         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4121*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4122         16  PB-I-OLD-LOF                 PIC XXX.
  4123         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4124         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4125         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4126         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4127         16  PB-I-LIFE-INDICATOR          PIC X.
  4128             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4129         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4130         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4131                                          PIC S9(5)V99    COMP-3.
  4132         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4133             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4134             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4135         16  PB-I-1ST-PMT-DT              PIC XX.
  4136         16  PB-I-JOINT-INSURED.
  4137             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4138             20 PB-I-JOINT-FIRST-NAME.
  4139                24  PB-I-JOINT-FIRST-INIT PIC X.
  4140                24  FILLER                PIC X(9).
  4141             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4142*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4143         16  PB-I-BENEFICIARY-NAME.
  4144             20  PB-I-BANK-NUMBER         PIC X(10).
  4145             20  FILLER                   PIC X(15).
  4146         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4147         16  PB-I-REFERENCE               PIC X(12).
  4148         16  FILLER REDEFINES PB-I-REFERENCE.
  4149             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4150             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4151             20  PB-I-CLP-STATE           PIC XX.
  4152         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4153             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4154             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4155             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4156         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4157         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4158         16  PB-I-RESIDENT-STATE          PIC XX.
  4159         16  PB-I-RATE-CODE               PIC X(4).
  4160         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4161         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  74
* EL6317.cbl
  4162         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4163         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4164         16  PB-I-BANK-NOCHRGB            PIC 99.
  4165         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4166         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4167
  4168     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4169         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4170             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4171         16  PB-C-CANCEL-ORIGIN           PIC X.
  4172             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4173         16  PB-C-LF-CANCEL-DT            PIC XX.
  4174         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4175         16  PB-C-LF-CALC-REQ             PIC X.
  4176             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4177         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4178         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4179         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4180             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4181         16  PB-C-AH-CANCEL-DT            PIC XX.
  4182         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4183         16  PB-C-AH-CALC-REQ             PIC X.
  4184             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4185         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4186         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4187         16  PB-C-LAST-NAME               PIC X(15).
  4188         16  PB-C-REFUND-SW               PIC X.
  4189             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4190             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4191         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4192         16  PB-C-PAYEE-CODE              PIC X(6).
  4193         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4194         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4195         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4196         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4197         16  PB-C-REFERENCE               PIC X(12).
  4198         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4199         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4200         16  PB-C-POST-CARD-IND           PIC X.
  4201         16  PB-C-CANCEL-REASON           PIC X.
  4202         16  PB-C-REF-INTERFACE-SW        PIC X.
  4203         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4204         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4205         16  FILLER                       PIC X(01).
  4206*        16  FILLER                       PIC X(18).
  4207         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4208*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4209         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4210         16  PB-CANCELED-CERT-DATA.
  4211             20  PB-CI-INSURED-NAME.
  4212                 24  PB-CI-LAST-NAME      PIC X(15).
  4213                 24  PB-CI-INITIALS       PIC XX.
  4214             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4215             20  PB-CI-INSURED-SEX        PIC X.
  4216             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4217             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4218             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4219             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  75
* EL6317.cbl
  4220             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4221             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4222             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4223             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4224             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4225             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4226             20  PB-CI-RATE-CLASS         PIC XX.
  4227             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4228             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4229             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4230             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4231             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4232             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4233             20  PB-CI-LF-ABBR            PIC X(3).
  4234             20  PB-CI-AH-ABBR            PIC X(3).
  4235             20  PB-CI-OB-FLAG            PIC X.
  4236                 88  PB-CI-OB                VALUE 'B'.
  4237             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4238                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4239                                           'M' '4' '5' '9' '2'.
  4240                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4241                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4242                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4243                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4244                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4245                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4246                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4247                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4248                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4249                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4250                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4251                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4252             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4253                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4254                                           'M' '4' '5' '9' '2'.
  4255                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4256                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4257                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4258                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4259                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4260                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4261                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4262                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4263                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4264                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4265                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4266                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4267             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4268             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4269             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4270             20  PB-CI-MEMBER-NO          PIC X(12).
  4271             20  PB-CI-INT-CODE           PIC X.
  4272                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4273                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4274             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4275             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4276             20  PB-CI-COMP-EXCP-SW       PIC X.
  4277                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  76
* EL6317.cbl
  4278                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4279             20  PB-CI-ENTRY-STATUS       PIC X.
  4280             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4281             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4282             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4283             20  PB-CI-DEATH-DT           PIC XX.
  4284             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4285             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4286             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4287             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4288             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4289             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4290             20  PB-CI-ENTRY-DT              PIC XX.
  4291             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4292             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4293             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4294             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4295             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4296             20  PB-CI-OLD-LOF               PIC XXX.
  4297*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4298             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4299             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4300             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4301             20  PB-CI-INDV-GRP-CD           PIC X.
  4302             20  PB-CI-BENEFICIARY-NAME.
  4303                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4304                 24  FILLER                  PIC X(15).
  4305             20  PB-CI-NOTE-SW               PIC X.
  4306             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4307             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4308             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4309             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4310             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4311             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4312             20  PB-CI-FIRST-NAME            PIC X(10).
  4313             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4314
  4315         16  FILLER                       PIC X(13).
  4316*032306  16  FILLER                       PIC X(27).
  4317*        16  FILLER                       PIC X(46).
  4318
  4319     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4320         16  FILLER                       PIC X(10).
  4321         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4322         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4323         16  PB-M-INSURED-MID-INIT        PIC X.
  4324         16  PB-M-INSURED-AGE             PIC 99.
  4325         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4326         16  PB-M-INSURED-SEX             PIC X.
  4327         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4328         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4329         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4330         16  PB-M-INSURED-CITY-STATE.
  4331             20  PB-M-INSURED-CITY        PIC X(28).
  4332             20  PB-M-INSURED-STATE       PIC XX.
  4333         16  PB-M-INSURED-ZIP-CODE.
  4334             20  PB-M-INSURED-ZIP-PRIME.
  4335                 24  PB-M-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  77
* EL6317.cbl
  4336                     88  PB-M-CANADIAN-POST-CODE
  4337                                             VALUE 'A' THRU 'Z'.
  4338                 24  FILLER               PIC X(4).
  4339             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4340         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4341                                        PB-M-INSURED-ZIP-CODE.
  4342             20  PM-M-INS-CAN-POST1       PIC XXX.
  4343             20  PM-M-INS-CAN-POST2       PIC XXX.
  4344             20  FILLER                   PIC XXX.
  4345         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4346         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4347         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4348         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4349         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4350         16  PB-M-CRED-BENE-CITYST.
  4351             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4352             20  PB-M-CRED-BENE-STATE     PIC XX.
  4353         16  FILLER                       PIC X(92).
  4354
  4355     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4356         16  FILLER                       PIC X(10).
  4357         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4358         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4359         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4360         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4361         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4362         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4363         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4364         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4365         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4366         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4367         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4368         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4369         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4370         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4371         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4372         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4373         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4374         16  PB-ACCOUNT-NAME              PIC X(30).
  4375         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4376         16  PB-REFERENCE                 PIC X(12).
  4377         16  PB-B-RECEIVED-DT             PIC XX.
  4378         16  FILLER                       PIC X(234).
  4379
  4380     12  PB-RECORD-STATUS.
  4381         16  PB-CREDIT-SELECT-DT          PIC XX.
  4382         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4383         16  PB-BILLED-DT                 PIC XX.
  4384         16  PB-BILLING-STATUS            PIC X.
  4385             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4386             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4387             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4388         16  PB-RECORD-BILL               PIC X.
  4389             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4390             88  PB-RECORD-RETURNED           VALUE 'R'.
  4391             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4392             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4393             88  PB-OVERRIDE-AH               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  78
* EL6317.cbl
  4394             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4395         16  PB-BATCH-ENTRY               PIC X.
  4396             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4397             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4398             88  PB-REISSUED-CERT             VALUE 'E'.
  4399             88  PB-MONTHLY-CERT              VALUE 'M'.
  4400             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4401             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4402             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4403         16  PB-FORCE-CODE                PIC X.
  4404             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4405             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4406             88  PB-CANCEL-FORCE              VALUE '8'.
  4407             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4408             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4409             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4410             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4411             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4412             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4413             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4414         16  PB-FATAL-FLAG                PIC X.
  4415             88  PB-FATAL-ERRORS              VALUE 'X'.
  4416         16  PB-FORCE-ER-CD               PIC X.
  4417             88  PB-FORCE-ERRORS              VALUE 'F'.
  4418             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4419         16  PB-WARN-ER-CD                PIC X.
  4420             88  PB-WARNING-ERRORS            VALUE 'W'.
  4421         16  FILLER                       PIC X.
  4422         16  PB-OUT-BAL-CD                PIC X.
  4423             88  PB-OUT-OF-BAL                VALUE 'O'.
  4424         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4425         16  PB-AH-OVERRIDE-L1            PIC X.
  4426         16  PB-INPUT-DT                  PIC XX.
  4427         16  PB-INPUT-BY                  PIC X(4).
  4428         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4429         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4430         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4431         16  PB-LF-EARNING-METHOD         PIC X.
  4432         16  PB-AH-EARNING-METHOD         PIC X.
  4433         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4434         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4435         16  PB-REIN-CD                   PIC XXX.
  4436         16  PB-LF-REFUND-TYPE            PIC X.
  4437         16  PB-AH-REFUND-TYPE            PIC X.
  4438         16  PB-ACCT-EFF-DT               PIC XX.
  4439         16  PB-ACCT-EXP-DT               PIC XX.
  4440         16  PB-COMPANY-ID                PIC X(3).
  4441         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4442         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4443         16  PB-SV-CARRIER                PIC X.
  4444         16  PB-SV-GROUPING               PIC X(6).
  4445         16  PB-SV-STATE                  PIC XX.
  4446         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4447         16  PB-GA-BILLING-INFO.
  4448             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4449                                          PIC XX.
  4450         16  PB-SV-REMIT-TO  REDEFINES
  4451             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  79
* EL6317.cbl
  4452         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4453         16  PB-I-LOAN-OFFICER            PIC X(5).
  4454         16  PB-I-VIN                     PIC X(17).
  4455
  4456         16  FILLER                       PIC X(04).
  4457         16  IMNET-BYPASS-SW              PIC X.
  4458
  4459******************************************************************
  4460*                COMMON EDIT ERRORS                              *
  4461******************************************************************
  4462
  4463     12  PB-COMMON-ERRORS.
  4464         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4465                                           PIC S9(4)     COMP.
  4466
  4467******************************************************************
  4468*                                COPY ELCCERT.
  4469******************************************************************
  4470*                                                                *
  4471*                            ELCCERT.                            *
  4472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4473*                            VMOD=2.013                          *
  4474*                                                                *
  4475*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4476*                                                                *
  4477*   FILE TYPE = VSAM,KSDS                                        *
  4478*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4479*                                                                *
  4480*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4481*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4482*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4483*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4484*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4485*                                                                *
  4486*   LOG = YES                                                    *
  4487*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4488******************************************************************
  4489*                   C H A N G E   L O G
  4490*
  4491* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4492*-----------------------------------------------------------------
  4493*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4494* EFFECTIVE    NUMBER
  4495*-----------------------------------------------------------------
  4496* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4497* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4498* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4499* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4500* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4501* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4502* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4503* 032612  CR2011110200001  PEMA  AHL CHANGES
  4504******************************************************************
  4505
  4506 01  CERTIFICATE-MASTER.
  4507     12  CM-RECORD-ID                      PIC XX.
  4508         88  VALID-CM-ID                      VALUE 'CM'.
  4509
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  80
* EL6317.cbl
  4510     12  CM-CONTROL-PRIMARY.
  4511         16  CM-COMPANY-CD                 PIC X.
  4512         16  CM-CARRIER                    PIC X.
  4513         16  CM-GROUPING.
  4514             20  CM-GROUPING-PREFIX        PIC X(3).
  4515             20  CM-GROUPING-PRIME         PIC X(3).
  4516         16  CM-STATE                      PIC XX.
  4517         16  CM-ACCOUNT.
  4518             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4519             20  CM-ACCOUNT-PRIME          PIC X(6).
  4520         16  CM-CERT-EFF-DT                PIC XX.
  4521         16  CM-CERT-NO.
  4522             20  CM-CERT-PRIME             PIC X(10).
  4523             20  CM-CERT-SFX               PIC X.
  4524
  4525     12  CM-CONTROL-BY-NAME.
  4526         16  CM-COMPANY-CD-A1              PIC X.
  4527         16  CM-INSURED-LAST-NAME          PIC X(15).
  4528         16  CM-INSURED-INITIALS.
  4529             20  CM-INSURED-INITIAL1       PIC X.
  4530             20  CM-INSURED-INITIAL2       PIC X.
  4531
  4532     12  CM-CONTROL-BY-SSN.
  4533         16  CM-COMPANY-CD-A2              PIC X.
  4534         16  CM-SOC-SEC-NO.
  4535             20  CM-SSN-STATE              PIC XX.
  4536             20  CM-SSN-ACCOUNT            PIC X(6).
  4537             20  CM-SSN-LN3.
  4538                 25  CM-INSURED-INITIALS-A2.
  4539                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4540                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4541                 25 CM-PART-LAST-NAME-A2         PIC X.
  4542
  4543     12  CM-CONTROL-BY-CERT-NO.
  4544         16  CM-COMPANY-CD-A4              PIC X.
  4545         16  CM-CERT-NO-A4                 PIC X(11).
  4546
  4547     12  CM-CONTROL-BY-MEMB.
  4548         16  CM-COMPANY-CD-A5              PIC X.
  4549         16  CM-MEMBER-NO.
  4550             20  CM-MEMB-STATE             PIC XX.
  4551             20  CM-MEMB-ACCOUNT           PIC X(6).
  4552             20  CM-MEMB-LN4.
  4553                 25  CM-INSURED-INITIALS-A5.
  4554                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4555                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4556                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4557
  4558     12  CM-INSURED-PROFILE-DATA.
  4559         16  CM-INSURED-FIRST-NAME.
  4560             20  CM-INSURED-1ST-INIT       PIC X.
  4561             20  FILLER                    PIC X(9).
  4562         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4563         16  CM-INSURED-SEX                PIC X.
  4564             88  CM-SEX-MALE                  VALUE 'M'.
  4565             88  CM-SEX-FEMAL                 VALUE 'F'.
  4566         16  CM-INSURED-JOINT-AGE          PIC 99.
  4567         16  CM-JOINT-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  81
* EL6317.cbl
  4568             20  CM-JT-LAST-NAME           PIC X(15).
  4569             20  CM-JT-FIRST-NAME.
  4570                 24  CM-JT-1ST-INIT        PIC X.
  4571                 24  FILLER                PIC X(9).
  4572             20  CM-JT-INITIAL             PIC X.
  4573
  4574     12  CM-LIFE-DATA.
  4575         16  CM-LF-BENEFIT-CD              PIC XX.
  4576         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4577         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4578         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4579         16  CM-LF-DEV-CODE                PIC XXX.
  4580         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4581         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4582         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4583         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4584         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4585         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4586         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4587         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4588         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4589         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4590         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4591         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4592         16  FILLER                        PIC XX.
  4593
  4594     12  CM-AH-DATA.
  4595         16  CM-AH-BENEFIT-CD              PIC XX.
  4596         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4597         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4598         16  CM-AH-DEV-CODE                PIC XXX.
  4599         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4600         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4601         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4602         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4603         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4604         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4605         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4606         16  CM-AH-PAID-THRU-DT            PIC XX.
  4607             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4608         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4609         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4610         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4611         16  FILLER                        PIC X.
  4612
  4613     12  CM-LOAN-INFORMATION.
  4614         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4615         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4616                                           PIC S9(5)V99  COMP-3.
  4617         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4618         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4619         16  CM-PAY-FREQUENCY              PIC S99.
  4620         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4621         16  CM-RATE-CLASS                 PIC XX.
  4622         16  CM-BENEFICIARY                PIC X(25).
  4623         16  CM-POLICY-FORM-NO             PIC X(12).
  4624         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4625         16  CM-LAST-ADD-ON-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  82
* EL6317.cbl
  4626         16  CM-DEDUCTIBLE-AMOUNTS.
  4627             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4628             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4629         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4630             20  CM-RESIDENT-STATE         PIC XX.
  4631             20  CM-RATE-CODE              PIC X(4).
  4632             20  FILLER                    PIC XX.
  4633         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4634             20  CM-LOAN-OFFICER           PIC X(5).
  4635             20  FILLER                    PIC XXX.
  4636         16  CM-CSR-CODE                   PIC XXX.
  4637         16  CM-UNDERWRITING-CODE          PIC X.
  4638             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4639         16  CM-POST-CARD-IND              PIC X.
  4640         16  CM-NH-INTERFACE-SW            PIC X.
  4641         16  CM-PREMIUM-TYPE               PIC X.
  4642             88  CM-SING-PRM                  VALUE '1'.
  4643             88  CM-O-B-COVERAGE              VALUE '2'.
  4644             88  CM-OPEN-END                  VALUE '3'.
  4645         16  CM-IND-GRP-TYPE               PIC X.
  4646             88  CM-INDIVIDUAL                VALUE 'I'.
  4647             88  CM-GROUP                     VALUE 'G'.
  4648         16  CM-SKIP-CODE                  PIC X.
  4649             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4650             88  SKIP-JULY                    VALUE '1'.
  4651             88  SKIP-AUGUST                  VALUE '2'.
  4652             88  SKIP-SEPTEMBER               VALUE '3'.
  4653             88  SKIP-JULY-AUG                VALUE '4'.
  4654             88  SKIP-AUG-SEPT                VALUE '5'.
  4655             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4656             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4657             88  SKIP-JUNE                    VALUE '8'.
  4658             88  SKIP-JUNE-JULY               VALUE '9'.
  4659             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4660             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4661         16  CM-PAYMENT-MODE               PIC X.
  4662             88  PAY-MONTHLY                  VALUE SPACE.
  4663             88  PAY-WEEKLY                   VALUE '1'.
  4664             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4665             88  PAY-BI-WEEKLY                VALUE '3'.
  4666             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4667         16  CM-LOAN-NUMBER                PIC X(8).
  4668         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4669         16  CM-OLD-LOF                    PIC XXX.
  4670*        16  CM-LOAN-OFFICER               PIC XXX.
  4671         16  CM-REIN-TABLE                 PIC XXX.
  4672         16  CM-SPECIAL-REIN-CODE          PIC X.
  4673         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4674         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4675         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4676
  4677     12  CM-STATUS-DATA.
  4678         16  CM-ENTRY-STATUS               PIC X.
  4679         16  CM-ENTRY-DT                   PIC XX.
  4680
  4681         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4682         16  CM-LF-CANCEL-DT               PIC XX.
  4683         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  83
* EL6317.cbl
  4684
  4685         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4686         16  CM-LF-DEATH-DT                PIC XX.
  4687         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4688
  4689         16  CM-LF-CURRENT-STATUS          PIC X.
  4690             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4691                                                'M' '4' '5' '9'.
  4692             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4693             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4694             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4695             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4696             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4697             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4698             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4699             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4700             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4701             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4702             88  CM-LF-DECLINED               VALUE 'D'.
  4703             88  CM-LF-VOIDED                 VALUE 'V'.
  4704
  4705         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4706         16  CM-AH-CANCEL-DT               PIC XX.
  4707         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4708
  4709         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4710         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4711         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4712
  4713         16  CM-AH-CURRENT-STATUS          PIC X.
  4714             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4715                                                'M' '4' '5' '9'.
  4716             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4717             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4718             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4719             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4720             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4721             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4722             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4723             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4724             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4725             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4726             88  CM-AH-DECLINED               VALUE 'D'.
  4727             88  CM-AH-VOIDED                 VALUE 'V'.
  4728
  4729         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4730             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4731             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4732             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4733         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4734
  4735         16  CM-ENTRY-BATCH                PIC X(6).
  4736         16  CM-LF-EXIT-BATCH              PIC X(6).
  4737         16  CM-AH-EXIT-BATCH              PIC X(6).
  4738         16  CM-LAST-MONTH-END             PIC XX.
  4739
  4740     12  CM-NOTE-SW                        PIC X.
  4741         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  84
* EL6317.cbl
  4742         88  CERT-NOTES-PRESENT               VALUE '1'.
  4743         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4744         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4745         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4746         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4747         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4748         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4749     12  CM-COMP-EXCP-SW                   PIC X.
  4750         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4751         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4752     12  CM-INSURED-ADDRESS-SW             PIC X.
  4753         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4754         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4755
  4756*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4757     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4758     12  FILLER                            PIC X.
  4759
  4760*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4761     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4762     12  FILLER                            PIC X.
  4763*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4764     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4765
  4766     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4767         88  CERT-ADDED-BATCH                 VALUE ' '.
  4768         88  CERT-ADDED-ONLINE                VALUE '1'.
  4769         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4770         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4771         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4772     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4773         88  CERT-AS-LOADED                   VALUE ' '.
  4774         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4775         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4776         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4777         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4778         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4779         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4780         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4781
  4782     12  CM-ACCOUNT-COMM-PCTS.
  4783         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4784         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4785
  4786     12  CM-USER-FIELD                     PIC X.
  4787     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4788     12  CM-CLP-STATE                      PIC XX.
  4789     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4790     12  CM-USER-RESERVED                  PIC XXX.
  4791     12  FILLER REDEFINES CM-USER-RESERVED.
  4792         16  CM-AH-CLASS-CD                PIC XX.
  4793         16  F                             PIC X.
  4794******************************************************************
  4795*                                COPY ELCCRTO.
  4796******************************************************************
  4797*                                                                *
  4798*                            ELCCRTO.                            *
  4799*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  85
* EL6317.cbl
  4800*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4801*                                                                *
  4802*   FILE TYPE = VSAM,KSDS                                        *
  4803*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4804*                                                                *
  4805*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4806*                                                                *
  4807*   LOG = YES                                                    *
  4808*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4809******************************************************************
  4810*                   C H A N G E   L O G
  4811*
  4812* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4813*-----------------------------------------------------------------
  4814*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4815* EFFECTIVE    NUMBER
  4816*-----------------------------------------------------------------
  4817* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4818* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4819* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4820* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4821* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4822******************************************************************
  4823 01  ORIGINAL-CERTIFICATE.
  4824     12  OC-RECORD-ID                      PIC XX.
  4825         88  VALID-OC-ID                      VALUE 'OC'.
  4826     12  OC-CONTROL-PRIMARY.
  4827         16  OC-COMPANY-CD                 PIC X.
  4828         16  OC-CARRIER                    PIC X.
  4829         16  OC-GROUPING                   PIC X(6).
  4830         16  OC-STATE                      PIC XX.
  4831         16  OC-ACCOUNT                    PIC X(10).
  4832         16  OC-CERT-EFF-DT                PIC XX.
  4833         16  OC-CERT-NO.
  4834             20  OC-CERT-PRIME             PIC X(10).
  4835             20  OC-CERT-SFX               PIC X.
  4836         16  OC-RECORD-TYPE                PIC X.
  4837         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4838     12  OC-LAST-MAINT-DT                  PIC XX.
  4839     12  OC-LAST-MAINT-BY                  PIC X(4).
  4840     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4841     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4842     12  FILLER                            PIC X(49).
  4843     12  OC-ORIG-REC.
  4844         16  OC-INS-LAST-NAME              PIC X(15).
  4845         16  OC-INS-FIRST-NAME             PIC X(10).
  4846         16  OC-INS-MIDDLE-INIT            PIC X.
  4847         16  OC-INS-AGE                    PIC S999     COMP-3.
  4848         16  OC-JNT-LAST-NAME              PIC X(15).
  4849         16  OC-JNT-FIRST-NAME             PIC X(10).
  4850         16  OC-JNT-MIDDLE-INIT            PIC X.
  4851         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4852         16  OC-LF-BENCD                   PIC XX.
  4853         16  OC-LF-TERM                    PIC S999      COMP-3.
  4854         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4855         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4856         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4857         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  86
* EL6317.cbl
  4858         16  OC-LF-EXP-DT                  PIC XX.
  4859         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4860         16  OC-LF-CANCEL-DT               PIC XX.
  4861         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4862         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4863         16  OC-AH-BENCD                   PIC XX.
  4864         16  OC-AH-TERM                    PIC S999      COMP-3.
  4865         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4866         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4867         16  OC-AH-EXP-DT                  PIC XX.
  4868         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4869         16  OC-AH-CP                      PIC 99.
  4870         16  OC-AH-CANCEL-DT               PIC XX.
  4871         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4872         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4873         16  OC-CRED-BENE-NAME             PIC X(25).
  4874         16  OC-1ST-PMT-DT                 PIC XX.
  4875         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4876         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4877         16  OC-ISSUE-TRAN-IND             PIC X.
  4878         16  OC-CANCEL-TRAN-IND            PIC X.
  4879         16  FILLER                        PIC X(211).
  4880
  4881     12  FILLER                            PIC X(50).
  4882******************************************************************
  4883*                                COPY ERCENDT.
  4884******************************************************************
  4885*                                                                *
  4886*                                                                *
  4887*                            ERCENDT.                            *
  4888*                            VMOD=2.001                          *
  4889*                                                                *
  4890*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4891*                                                                *
  4892*   FILE TYPE = VSAM,KSDS                                        *
  4893*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4894*                                                                *
  4895*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4896*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4897*                                                                *
  4898*   LOG = NO                                                     *
  4899*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4900******************************************************************
  4901*-----------------------------------------------------------------
  4902*                   C H A N G E   L O G
  4903*
  4904* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4905*-----------------------------------------------------------------
  4906*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4907* EFFECTIVE    NUMBER
  4908*-----------------------------------------------------------------
  4909* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4910*                                WITH OPEN CLAIMS
  4911* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4912* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4913* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4914*-----------------------------------------------------------------
  4915 01  ENDORSEMENT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  87
* EL6317.cbl
  4916     12  EN-RECORD-ID                PIC XX.
  4917         88  VALID-EN-ID                VALUE 'EN'.
  4918     12  EN-CONTROL-PRIMARY.
  4919         16  EN-COMPANY-CD           PIC X.
  4920         16  EN-CARRIER              PIC X.
  4921         16  EN-GROUPING             PIC X(6).
  4922         16  EN-STATE                PIC XX.
  4923         16  EN-ACCOUNT              PIC X(10).
  4924         16  EN-CERT-EFF-DT          PIC XX.
  4925         16  EN-CERT-NO.
  4926             20  EN-CERT-PRIME       PIC X(10).
  4927             20  EN-CERT-SFX         PIC X.
  4928         16  EN-REC-TYPE             PIC X.
  4929             88  EN-ISSUE               VALUE 'I'.
  4930             88  EN-CANCELLATION        VALUE 'C'.
  4931         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4932     12  EN-CONTROL-BY-ARCH-NO.
  4933         16  EN-COMPANY-CD-A1              PIC X.
  4934         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4935     12  EN-LAST-MAINT-DT            PIC XX.
  4936     12  EN-LAST-MAINT-BY            PIC X(4).
  4937     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4938     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4939     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4940         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4941         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4942         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4943         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4944         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4945         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4946         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4947         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4948         16  EN-LF-ORIG-BENCD        PIC XX.
  4949         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4950         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4951         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4952         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4953         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4954         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4955*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4956         16  EN-ORIG-CRED-BENE       PIC X(25).
  4957         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4958         16  FILLER                  PIC X.
  4959         16  EN-AH-ORIG-BENCD        PIC XX.
  4960         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4961         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4962         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4963         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4964*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4965*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4966         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4967         16  F                       PIC X(09).
  4968         16  EN-AH-ORIG-CP           PIC 99.
  4969         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4970         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4971         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4972         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  4973         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  88
* EL6317.cbl
  4974         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  4975         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  4976         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  4977         16  EN-LF-NEW-BENCD         PIC XX.
  4978         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  4979         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4980         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4981         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  4982         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  4983         16  EN-LF-NEW-EXP-DT        PIC XX.
  4984         16  EN-NEW-CRED-BENE        PIC X(25).
  4985         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4986         16  FILLER                  PIC X.
  4987         16  EN-AH-NEW-BENCD         PIC XX.
  4988         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  4989         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4990         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4991         16  EN-AH-NEW-EXP-DT        PIC XX.
  4992*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  4993*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  4994*        16  F                       PIC X(12).
  4995         16  EN-AH-NEW-CP            PIC 99.
  4996         16  EN-SIG-SW               PIC X.
  4997         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4998         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  4999         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5000         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5001         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5002         16  FILLER                  PIC X(33).
  5003     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5004         16  EN-LF-ORIG-REF-DT       PIC XX.
  5005         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5006         16  EN-AH-ORIG-REF-DT       PIC XX.
  5007         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5008         16  EN-LF-NEW-REF-DT        PIC XX.
  5009         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5010         16  EN-AH-NEW-REF-DT        PIC XX.
  5011         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5012         16  EN-FLAG-CERT            PIC X.
  5013         16  EN-INS-LAST-NAME        PIC X(15).
  5014         16  EN-INS-FIRST-NAME       PIC X(10).
  5015         16  EN-INS-MIDDLE-INIT      PIC X.
  5016         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5017         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5018         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5019         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5020         16  FILLER                  PIC X(262).
  5021     12  EN-MONEY-SW             PIC X.
  5022     12  EN-HEALTH-APP           PIC X.
  5023     12  EN-VOUCHER-SW           PIC X.
  5024     12  EN-PAYEE                PIC X(14).
  5025     12  EN-INPUT-DT             PIC XX.
  5026     12  EN-PROCESS-DT           PIC XX.
  5027     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5028     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5029     12  EN-REASON-CODES.
  5030         16  F OCCURS 12.
  5031             20  EN-REASON-CODE  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  89
* EL6317.cbl
  5032     12  EN-TEMPLATE-USED        PIC X(8).
  5033     12  EN-DOCU-TYPE            PIC X.
  5034         88  EN-VERI-DOCU          VALUE 'V'.
  5035         88  EN-GCE-DOCU           VALUE 'G'.
  5036         88  EN-CANC-DOCU          VALUE 'C'.
  5037     12  EN-COMMENTS1            PIC X(13).
  5038     12  EN-COMMENTS2            PIC X(70).
  5039     12  EN-COMM-CHGBK           PIC X.
  5040         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5041         88  EN-CHG-ACCT           VALUE 'Y'.
  5042     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5043     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5044     12  EN-BATCH-NUMBER         PIC X(6).
  5045     12  EN-ACCT-SUMM            PIC X.
  5046     12  EN-CSO-SUMM             PIC X.
  5047     12  FILLER                  PIC X(13).
  5048******************************************************************
  5049*                                COPY ERCNOTE.
  5050******************************************************************
  5051*                                                                *
  5052*                                                                *
  5053*                            ERCNOTE                             *
  5054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5055*                            VMOD=2.003                          *
  5056*                                                                *
  5057*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5058*                                                                *
  5059*        FILE TYPE= VSAM,KSDS                                    *
  5060*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5061*                                                                *
  5062*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5063*                                                                *
  5064*        LOG = YES                                               *
  5065*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5066*                                                                *
  5067******************************************************************
  5068*                   C H A N G E   L O G
  5069*
  5070* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5071*-----------------------------------------------------------------
  5072*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5073* EFFECTIVE    NUMBER
  5074*-----------------------------------------------------------------
  5075* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5076*                                FILE WILL CONTAIN BILLING NOTES O
  5077******************************************************************
  5078
  5079 01  CERTIFICATE-NOTE.
  5080     12  CN-RECORD-ID                PIC  XX.
  5081         88  VALID-CN-ID                  VALUE 'CN'.
  5082
  5083     12  CN-CONTROL-PRIMARY.
  5084         16  CN-COMPANY-CD           PIC X.
  5085         16  CN-CARRIER              PIC X.
  5086         16  CN-GROUPING.
  5087             20 CN-GROUPING-PREFIX   PIC XXX.
  5088             20 CN-GROUPING-PRIME    PIC XXX.
  5089         16  CN-STATE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  90
* EL6317.cbl
  5090         16  CN-ACCOUNT.
  5091             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5092             20 CN-ACCOUNT-PRIME     PIC X(6).
  5093         16  CN-CERT-EFF-DT          PIC XX.
  5094         16  CN-CERT-NO.
  5095             20  CN-CERT-PRIME       PIC X(10).
  5096             20  CN-CERT-SFX         PIC X.
  5097
  5098     12  CN-BILLING-START-LINE-NO    PIC 99.
  5099     12  CN-BILLING-END-LINE-NO      PIC 99.
  5100
  5101     12  CN-LINES.
  5102         16  CN-LINE OCCURS 10       PIC X(77).
  5103
  5104     12  CN-LAST-MAINT-DT            PIC XX.
  5105     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5106     12  CN-LAST-MAINT-USER          PIC X(4).
  5107     12  FILLER                      PIC X(6).
  5108******************************************************************
  5109*                                COPY ERCMAIL.
  5110******************************************************************
  5111*                                                                *
  5112*                                                                *
  5113*                            ERCMAIL                             *
  5114*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5115*                            VMOD=2.003                          *
  5116*                                                                *
  5117*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5118*                                                                *
  5119*   FILE TYPE = VSAM,KSDS                                        *
  5120*   RECORD SIZE = 374   RECFORM = FIX                            *
  5121*                                                                *
  5122*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5123*   ALTERNATE PATH    = NOT USED                                 *
  5124*                                                                *
  5125*   LOG = YES                                                    *
  5126*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5127******************************************************************
  5128*                   C H A N G E   L O G
  5129*
  5130* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5131*-----------------------------------------------------------------
  5132*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5133* EFFECTIVE    NUMBER
  5134*-----------------------------------------------------------------
  5135* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5136* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5137* 111108                   PEMA  ADD CRED BENE ADDR2
  5138******************************************************************
  5139
  5140 01  MAILING-DATA.
  5141     12  MA-RECORD-ID                      PIC XX.
  5142         88  VALID-MA-ID                       VALUE 'MA'.
  5143
  5144     12  MA-CONTROL-PRIMARY.
  5145         16  MA-COMPANY-CD                 PIC X.
  5146         16  MA-CARRIER                    PIC X.
  5147         16  MA-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  91
* EL6317.cbl
  5148             20  MA-GROUPING-PREFIX        PIC XXX.
  5149             20  MA-GROUPING-PRIME         PIC XXX.
  5150         16  MA-STATE                      PIC XX.
  5151         16  MA-ACCOUNT.
  5152             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5153             20  MA-ACCOUNT-PRIME          PIC X(6).
  5154         16  MA-CERT-EFF-DT                PIC XX.
  5155         16  MA-CERT-NO.
  5156             20  MA-CERT-PRIME             PIC X(10).
  5157             20  MA-CERT-SFX               PIC X.
  5158
  5159     12  FILLER                            PIC XX.
  5160
  5161     12  MA-ACCESS-CONTROL.
  5162         16  MA-SOURCE-SYSTEM              PIC XX.
  5163             88  MA-FROM-CREDIT                VALUE 'CR'.
  5164             88  MA-FROM-VSI                   VALUE 'VS'.
  5165             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5166             88  MA-FROM-OTHER                 VALUE 'OT'.
  5167         16  MA-RECORD-ADD-DT              PIC XX.
  5168         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5169         16  MA-LAST-MAINT-DT              PIC XX.
  5170         16  MA-LAST-MAINT-BY              PIC XXXX.
  5171         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5172
  5173     12  MA-PROFILE-INFO.
  5174         16  MA-QUALIFY-CODE-1             PIC XX.
  5175         16  MA-QUALIFY-CODE-2             PIC XX.
  5176         16  MA-QUALIFY-CODE-3             PIC XX.
  5177         16  MA-QUALIFY-CODE-4             PIC XX.
  5178         16  MA-QUALIFY-CODE-5             PIC XX.
  5179
  5180         16  MA-INSURED-LAST-NAME          PIC X(15).
  5181         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5182         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5183         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5184         16  MA-INSURED-BIRTH-DT           PIC XX.
  5185         16  MA-INSURED-SEX                PIC X.
  5186             88  MA-SEX-MALE                   VALUE 'M'.
  5187             88  MA-SEX-FEMALE                 VALUE 'F'.
  5188         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5189
  5190         16  MA-ADDRESS-CORRECTED          PIC X.
  5191         16  MA-JOINT-BIRTH-DT             PIC XX.
  5192*        16  FILLER                        PIC X(12).
  5193
  5194         16  MA-ADDRESS-LINE-1             PIC X(30).
  5195         16  MA-ADDRESS-LINE-2             PIC X(30).
  5196         16  MA-CITY-STATE.
  5197             20  MA-CITY                   PIC X(28).
  5198             20  MA-ADDR-STATE             PIC XX.
  5199         16  MA-ZIP.
  5200             20  MA-ZIP-CODE.
  5201                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5202                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5203                 24  FILLER                PIC X(4).
  5204             20  MA-ZIP-PLUS4              PIC X(4).
  5205         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  92
* EL6317.cbl
  5206             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5207             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5208             20  FILLER                    PIC X(3).
  5209
  5210         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5211
  5212         16  FILLER                        PIC XXX.
  5213*        16  FILLER                        PIC X(10).
  5214
  5215     12  MA-CRED-BENE-INFO.
  5216         16  MA-CRED-BENE-NAME                 PIC X(25).
  5217         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5218         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5219         16  MA-CRED-BENE-CTYST.
  5220             20  MA-CRED-BENE-CITY             PIC X(28).
  5221             20  MA-CRED-BENE-STATE            PIC XX.
  5222         16  MA-CRED-BENE-ZIP.
  5223             20  MA-CB-ZIP-CODE.
  5224                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5225                     88  MA-CB-CANADIAN-POST-CODE
  5226                                           VALUE 'A' THRU 'Z'.
  5227                 24  FILLER                    PIC X(4).
  5228             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5229         16  MA-CB-CANADIAN-POSTAL-CODE
  5230                            REDEFINES MA-CRED-BENE-ZIP.
  5231             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5232             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5233             20  FILLER                        PIC X(3).
  5234     12  MA-POST-CARD-MAIL-DATA.
  5235         16  MA-MAIL-DATA OCCURS 7.
  5236             20  MA-MAIL-TYPE              PIC X.
  5237                 88  MA-12MO-MAILING           VALUE '1'.
  5238                 88  MA-EXP-MAILING            VALUE '2'.
  5239             20  MA-MAIL-STATUS            PIC X.
  5240                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5241                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5242                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5243             20  MA-MAIL-DATE              PIC XX.
  5244     12  FILLER                            PIC XX.
  5245     12  FILLER                            PIC XX.
  5246*    12  FILLER                            PIC X(30).
  5247******************************************************************
  5248*                                COPY ERCARCH.
  5249******************************************************************
  5250*                                                                *
  5251*                            ERCARCH.                            *
  5252*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5253*                            VMOD=2.002                          *
  5254*                                                                *
  5255*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5256*                                                                *
  5257*   FILE TYPE = VSAM,KSDS                                        *
  5258*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5259*                                                                *
  5260*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5261*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5262*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5263*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  93
* EL6317.cbl
  5264*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5265*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5266*                                                                *
  5267*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5268******************************************************************
  5269*                   C H A N G E   L O G
  5270*
  5271* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5272*-----------------------------------------------------------------
  5273*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5274* EFFECTIVE    NUMBER
  5275*-----------------------------------------------------------------
  5276* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5277* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5278* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5279******************************************************************
  5280 01  LETTER-ARCHIVE.
  5281     12  LA-RECORD-ID                PIC  X(02).
  5282         88  LA-VALID-ID                VALUE 'LA'.
  5283
  5284     12  LA-CONTROL-PRIMARY.
  5285         16  LA-COMPANY-CD           PIC  X(01).
  5286         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5287
  5288     12  LA-CONTROL-BY-CERT-RESP.
  5289         16  LA-COMPANY-CD-A2        PIC  X(01).
  5290         16  LA-CERT-NO-A2.
  5291             20  LA-CERT-PRIME-A2    PIC  X(10).
  5292             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5293         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5294             20  LA-RESP-PERSON-A2   PIC  X(10).
  5295             20  LA-TYPE-A2          PIC  X(01).
  5296         16  LA-CARRIER-A2           PIC  X(01).
  5297         16  LA-GROUPING-A2          PIC  X(06).
  5298         16  LA-STATE-A2             PIC  X(02).
  5299         16  LA-ACCOUNT-A2           PIC  X(10).
  5300         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5301         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5302
  5303     12  LA-CONTROL-BY-FORM.
  5304         16  LA-COMPANY-CD-A3        PIC  X(01).
  5305         16  LA-FORM-A3              PIC  X(04).
  5306         16  LA-CARRIER-A3           PIC  X(01).
  5307         16  LA-GROUPING-A3          PIC  X(06).
  5308         16  LA-STATE-A3             PIC  X(02).
  5309         16  LA-ACCOUNT-A3           PIC  X(10).
  5310         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5311
  5312     12  LA-CONTROL-BY-PROCESSOR.
  5313         16  LA-COMPANY-CD-A4        PIC  X(01).
  5314         16  LA-PROCESSOR-CD         PIC  X(04).
  5315         16  LA-CARRIER-A4           PIC  X(01).
  5316         16  LA-GROUPING-A4          PIC  X(06).
  5317         16  LA-STATE-A4             PIC  X(02).
  5318         16  LA-ACCOUNT-A4           PIC  X(10).
  5319         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5320
  5321     12  LA-CONTROL-BY-KEY-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  94
* EL6317.cbl
  5322         16  LA-COMPANY-CD-A5        PIC  X(01).
  5323         16  LA-CARRIER-A5           PIC  X(01).
  5324         16  LA-GROUPING-A5          PIC  X(06).
  5325         16  LA-STATE-A5             PIC  X(02).
  5326         16  LA-ACCOUNT-A5           PIC  X(10).
  5327         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5328
  5329     12  LA-CONTROL-BY-GROUP-CODE.
  5330         16  LA-COMPANY-CD-A6        PIC  X(01).
  5331         16  LA-ENTRY-A6.
  5332             20  LA-FILLER           PIC  X(02).
  5333             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5334         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5335
  5336     12  FILLER                      PIC  X(09).
  5337
  5338     12  LA-HEADER-RECORD.
  5339         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5340         16  LA-CREATION-DATE        PIC  X(02).
  5341         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5342         16  LA-FINAL-ACT-DATE       REDEFINES
  5343               LA-FOLLOW-UP-DATE     PIC  X(02).
  5344         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5345         16  LA-NO-OF-COPIES         PIC S9(01).
  5346         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5347         16  LA-REPLY-DATE           PIC  X(02).
  5348         16  LA-RESEND-DATES.
  5349             20  LA-RESEND-DATE      PIC  X(02).
  5350             20  LA-SENT-DATE        PIC  X(02).
  5351             20  FILLER              PIC  X(08).
  5352         16  LA-SOURCE-INFORMATION.
  5353             20  LA-DATA-SOURCE      PIC  X(01).
  5354             20  LA-ADDR-SOURCE      PIC  X(01).
  5355         16  LA-STATUS               PIC  X(01).
  5356             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5357             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5358             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5359             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5360             88  LA-STATUS-PURGED         VALUE 'P'.
  5361             88  LA-STATUS-VOIDED         VALUE 'V'.
  5362         16  LA-LAST-RESENT-PRINT-DATE
  5363                                     PIC  X(02).
  5364         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5365             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5366                                          VALUE 'C'.
  5367             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5368                                          VALUE 'F'.
  5369             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5370                                          VALUE 'P'.
  5371         16  LA-PURGED-DATE          PIC  X(02).
  5372         16  LA-VOIDED-DATE          PIC  X(02).
  5373         16  LA-RESEND-LETR          PIC  X(4).
  5374         16  FILLER                  PIC  X(08).
  5375*        16  LA-RESEND-LETR-2        PIC  X(4).
  5376*        16  LA-RESEND-LETR-3        PIC  X(4).
  5377*        16  FILLER                  PIC  X(59).
  5378         16  LA-ARCHIVE-STATUS       PIC  X.
  5379             88  LA-TEMP                VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  95
* EL6317.cbl
  5380             88  LA-QWS                 VALUE 'Q'.
  5381             88  LA-BATCH               VALUE 'B'.
  5382         16  LA-FINAL-ACT-IND        PIC  X(1).
  5383         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5384         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5385         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5386                                     PIC X(4).
  5387         16  FILLER                  PIC  X(42).
  5388*        16  FILLER                  PIC  X(71).
  5389         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5390         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5391         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5392                                     PIC  X(4).
  5393         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5394
  5395******************************************************************
  5396*                                COPY ERCCNOT.
  5397******************************************************************
  5398*                                                                *
  5399*                            ERCCNOT                             *
  5400*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5401*                            VMOD=2.003                          *
  5402*                                                                *
  5403*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5404*                                                                *
  5405*        FILE TYPE= VSAM,KSDS                                    *
  5406*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5407*                                                                *
  5408*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5409*                                                                *
  5410*        LOG = YES                                               *
  5411*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5412*                                                                *
  5413******************************************************************
  5414*                   C H A N G E   L O G
  5415*
  5416* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5417*-----------------------------------------------------------------
  5418*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5419* EFFECTIVE    NUMBER
  5420*-----------------------------------------------------------------
  5421* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5422******************************************************************
  5423
  5424 01  CERT-NOTE-FILE.
  5425     12  CZ-RECORD-ID                PIC  XX.
  5426         88  VALID-CZ-ID                  VALUE 'CZ'.
  5427
  5428     12  CZ-CONTROL-PRIMARY.
  5429         16  CZ-COMPANY-CD           PIC X.
  5430         16  CZ-CARRIER              PIC X.
  5431         16  CZ-GROUPING.
  5432             20 CZ-GROUPING-PREFIX   PIC XXX.
  5433             20 CZ-GROUPING-PRIME    PIC XXX.
  5434         16  CZ-STATE                PIC XX.
  5435         16  CZ-ACCOUNT.
  5436             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5437             20 CZ-ACCOUNT-PRIME     PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  96
* EL6317.cbl
  5438         16  CZ-CERT-EFF-DT          PIC XX.
  5439         16  CZ-CERT-NO.
  5440             20  CZ-CERT-PRIME       PIC X(10).
  5441             20  CZ-CERT-SFX         PIC X.
  5442         16  CZ-RECORD-TYPE          PIC X.
  5443             88  CERT-NOTE           VALUE '1'.
  5444             88  CLAIM-CERT-NOTE     VALUE '2'.
  5445         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5446
  5447     12  CZ-LAST-MAINT-DT            PIC XX.
  5448     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5449     12  CZ-LAST-MAINT-USER          PIC X(4).
  5450
  5451     12  CZ-NOTE-INFORMATION.
  5452         16  CZ-NOTE                 PIC X(63).
  5453         16  FILLER                  PIC X(39).
  5454******************************************************************
  5455*                                COPY ELCEOBC.
  5456******************************************************************
  5457*                                                                *
  5458*                                                                *
  5459*                            ELCEOBC                             *
  5460*                            VMOD=2.001                          *
  5461*                                                                *
  5462*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5463*                                                                *
  5464*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5465*   VSAM EOB CODE TABLE                                          *
  5466*                                                                *
  5467*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5468*                                                                *
  5469*   FILE TYPE = VSAM,KSDS                                        *
  5470*   RECORD SIZE = 350   RECFORM = FIX                            *
  5471*                                                                *
  5472*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5473*                                                                *
  5474*   LOG = NO                                                     *
  5475*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5476*                                                                *
  5477*                                                                *
  5478******************************************************************
  5479*                   C H A N G E   L O G
  5480*
  5481* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5482*-----------------------------------------------------------------
  5483*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5484* EFFECTIVE    NUMBER
  5485*-----------------------------------------------------------------
  5486* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5487* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5488* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  5489******************************************************************
  5490 01  EOB-CODES.
  5491     12  EO-RECORD-ID                      PIC XX.
  5492         88  VALID-DN-ID                      VALUE 'EO'.
  5493     12  EO-CONTROL-PRIMARY.
  5494         16  EO-COMPANY-CD                 PIC X.
  5495         16  EO-RECORD-TYPE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  97
* EL6317.cbl
  5496             88  EO-EOB-RECS                  VALUE '1'.
  5497             88  EO-VERIF-RECS                VALUE '2'.
  5498             88  EO-GCE-RECS                  VALUE '3'.
  5499             88  EO-CANC-RECS                 VALUE '4'.
  5500             88  EO-BILL-NOTE-RECS            VALUE '5'.
  5501         16  EO-EOB-CODE                   PIC X(4).
  5502         16  FILLER                        PIC X(9).
  5503     12  EO-MAINT-INFORMATION.
  5504         16  EO-LAST-MAINT-DT              PIC XX.
  5505         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5506         16  EO-LAST-MAINT-USER            PIC X(4).
  5507         16  FILLER                        PIC XX.
  5508     12  EO-DESCRIPTION                    PIC X(275).
  5509     12  FILLER                            PIC X(46).
  5510******************************************************************
  5511*                                COPY ELCCRTT.
  5512******************************************************************
  5513*                                                                *
  5514*                            ELCCRTT.                            *
  5515*                                                                *
  5516*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5517*                                                                *
  5518*   FILE TYPE = VSAM,KSDS                                        *
  5519*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5520*                                                                *
  5521*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5522*                                                                *
  5523*   LOG = YES                                                    *
  5524*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5525******************************************************************
  5526*                   C H A N G E   L O G
  5527*
  5528* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5529*-----------------------------------------------------------------
  5530*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5531* EFFECTIVE    NUMBER
  5532*-----------------------------------------------------------------
  5533* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5534* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5535* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5536* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5537* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5538******************************************************************
  5539
  5540 01  CERTIFICATE-TRAILERS.
  5541     12  CS-RECORD-ID                      PIC XX.
  5542         88  VALID-CS-ID                      VALUE 'CS'.
  5543
  5544     12  CS-CONTROL-PRIMARY.
  5545         16  CS-COMPANY-CD                 PIC X.
  5546         16  CS-CARRIER                    PIC X.
  5547         16  CS-GROUPING                   PIC X(6).
  5548         16  CS-STATE                      PIC XX.
  5549         16  CS-ACCOUNT                    PIC X(10).
  5550         16  CS-CERT-EFF-DT                PIC XX.
  5551         16  CS-CERT-NO.
  5552             20  CS-CERT-PRIME             PIC X(10).
  5553             20  CS-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  98
* EL6317.cbl
  5554         16  CS-TRAILER-TYPE               PIC X.
  5555             88  COMM-TRLR           VALUE 'A'.
  5556             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5557             88  CERT-DATA-TRLR      VALUE 'C'.
  5558
  5559     12  CS-DATA-AREA                      PIC X(516).
  5560
  5561     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5562         16  CS-BANK-COMMISSION-AREA.
  5563             20  CS-BANK-COMMS       OCCURS 10.
  5564                 24  CS-AGT                PIC X(10).
  5565                 24  CS-COM-TYP            PIC X.
  5566                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5567                 24  CS-RECALC-LV-INDIC    PIC X.
  5568                 24  FILLER                PIC X(10).
  5569         16  FILLER                        PIC X(256).
  5570
  5571     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5572****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5573****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5574         16  CS-MB-CLAIM-DATA OCCURS 2.
  5575             20  FILLER OCCURS 10.
  5576                 24  CS-CLAIM-TYPE         PIC X.
  5577                     88  CS-AH-CLM           VALUE 'A'.
  5578                     88  CS-IU-CLM           VALUE 'I'.
  5579                     88  CS-GP-CLM           VALUE 'G'.
  5580                     88  CS-LF-CLM           VALUE 'L'.
  5581                     88  CS-PR-CLM           VALUE 'P'.
  5582                 24  CS-BANK               PIC S999 COMP-3.
  5583                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5584                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5585                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5586         16  FILLER                        PIC X(216).
  5587     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5588         16  CS-VIN-NUMBER                 PIC X(17).
  5589         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5590         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5591         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5592         16  FILLER                        PIC X(496).
  5593******************************************************************
  5594*                                COPY ELCENCC.
  5595******************************************************************
  5596*                                                                *
  5597*                                                                *
  5598*                            ELCENCC                             *
  5599*                            VMOD=2.001                          *
  5600*                                                                *
  5601*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5602*                                                                *
  5603*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5604*   A NAPERSOFT DOCUMENT                                         *
  5605*                                                                *
  5606*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5607*                                                                *
  5608*   FILE TYPE = VSAM,KSDS                                        *
  5609*   RECORD SIZE = 400   RECFORM = FIX                            *
  5610*                                                                *
  5611*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  99
* EL6317.cbl
  5612*                                                                *
  5613*   LOG = NO                                                     *
  5614*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5615*                                                                *
  5616*                                                                *
  5617******************************************************************
  5618*                   C H A N G E   L O G
  5619*
  5620* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5621*-----------------------------------------------------------------
  5622*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5623* EFFECTIVE    NUMBER
  5624*-----------------------------------------------------------------
  5625* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5626******************************************************************
  5627 01  ENCLOSURE-CODES.
  5628     12  NC-RECORD-ID                      PIC XX.
  5629         88  VALID-NC-ID                      VALUE 'NC'.
  5630     12  NC-CONTROL-PRIMARY.
  5631         16  NC-COMPANY-CD                 PIC X.
  5632         16  NC-REC-TYPE                   PIC X.
  5633             88  NC-CLAIMS                   VALUE '1'.
  5634             88  NC-ADMIN                    VALUE '2'.
  5635         16  NC-ENC-CODE                   PIC X(5).
  5636         16  FILLER                        PIC X(09).
  5637     12  NC-MAINT-INFORMATION.
  5638         16  NC-LAST-MAINT-DT              PIC XX.
  5639         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5640         16  NC-LAST-MAINT-USER            PIC X(4).
  5641         16  FILLER                        PIC XX.
  5642     12  NC-OUTPUT-STACK                   PIC XXX.
  5643     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5644     12  NC-ATTACHMENTS                    PIC X(100).
  5645     12  NC-FUTURE                         PIC X(50).
  5646     12  FILLER                            PIC X(117).
  5647******************************************************************
  5648 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5649                          ACCOUNT-MASTER CONTROL-FILE
  5650                          PENDING-BUSINESS CERTIFICATE-MASTER
  5651                          ORIGINAL-CERTIFICATE
  5652                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5653                          MAILING-DATA LETTER-ARCHIVE
  5654                          CERT-NOTE-FILE EOB-CODES
  5655                          CERTIFICATE-TRAILERS ENCLOSURE-CODES.
  5656 0000-DFHEXIT SECTION.
  5657     MOVE '9#                    $   ' TO DFHEIV0.
  5658     MOVE 'EL6317' TO DFHEIV1.
  5659     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5660     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5661     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5662     MOVE '5'                    TO DC-OPTION-CODE
  5663     PERFORM 9700-DATE-LINK
  5664     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5665     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5666     MOVE EIBTRMID               TO QID-TERM
  5667     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5668     IF EIBCALEN = 0
  5669        GO TO 8800-UNAUTHORIZED-ACCESS
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 100
* EL6317.cbl
  5670     END-IF
  5671     MOVE FUNCTION LENGTH(EL631JI) TO MAP-LENGTH
  5672     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5673        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5674           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5675           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5676           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5677           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5678           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5679           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5680           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5681           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5682           MOVE LOW-VALUES           TO EL631JI
  5683           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5684           GO TO 0350-BUILD-INIT-MAP
  5685        END-IF
  5686     END-IF
  5687     IF PI-CALLING-PROGRAM = 'EL614'
  5688        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5689                                 TO WS-PASSED-REASON-CODES
  5690        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5691        IF WS-PASSED-REASON-CODES NOT = SPACES
  5692           MOVE 'Y'              TO WS-SET-CODES-MDT
  5693        ELSE
  5694           MOVE 'N'              TO WS-SET-CODES-MDT
  5695        END-IF
  5696        PERFORM 0600-RECOVER-TEMP-STORAGE
  5697                                 THRU 0600-EXIT
  5698        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5699        GO TO 0350-BUILD-INIT-MAP
  5700     END-IF
  5701     IF EIBAID = DFHCLEAR
  5702        IF PI-CLEAR-ERROR
  5703           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5704           MOVE ER-3833           TO EMI-ERROR
  5705           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5706           GO TO 0350-BUILD-INIT-MAP
  5707        ELSE
  5708           GO TO 9400-CLEAR
  5709        END-IF
  5710     END-IF
  5711     .
  5712 0200-RECEIVE.
  5713     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5714        MOVE ER-0008             TO EMI-ERROR
  5715        PERFORM 9900-ERROR-FORMAT
  5716                                 THRU 9900-EXIT
  5717        MOVE -1                  TO PFENTRL
  5718        GO TO 8100-SEND-INITIAL-MAP
  5719     END-IF
  5720
  5721* EXEC CICS RECEIVE
  5722*        MAP      (MAP-NAME)
  5723*        MAPSET   (MAPSET-NAME)
  5724*        INTO     (EL631JI)
  5725*    END-EXEC
  5726     MOVE LENGTH OF
  5727      EL631JI
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 101
* EL6317.cbl
  5728       TO DFHEIV11
  5729*    MOVE '8"T I  L              ''   #00005716' TO DFHEIV0
  5730     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5731     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5732     MOVE X'2020233030303035373136' TO DFHEIV0(25:11)
  5733     CALL 'kxdfhei1' USING DFHEIV0,
  5734           MAP-NAME,
  5735           EL631JI,
  5736           DFHEIV11,
  5737           MAPSET-NAME,
  5738           DFHEIV99,
  5739           DFHEIV99
  5740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5741     IF PFENTRL = 0
  5742         GO TO 0300-CHECK-PFKEYS
  5743     END-IF
  5744     IF EIBAID NOT = DFHENTER
  5745         MOVE ER-0004            TO EMI-ERROR
  5746         GO TO 0320-INPUT-ERROR
  5747     END-IF
  5748     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5749        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5750     ELSE
  5751        MOVE ER-0029            TO EMI-ERROR
  5752        GO TO 0320-INPUT-ERROR
  5753     END-IF
  5754     .
  5755 0300-CHECK-PFKEYS.
  5756     IF EIBAID = DFHPF3
  5757        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5758        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5759        MOVE 'EL614'             TO PGM-NAME
  5760        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5761        move +1                  to s2
  5762        perform varying s1 from +1 by +1 until s1 > +12
  5763           if reacd-in (s1) not = spaces and low-values
  5764              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5765              add +5 to s2
  5766           end-if
  5767        END-perform
  5768        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5769        GO TO 9300-XCTL
  5770     END-IF
  5771     IF EIBAID = DFHPF4 OR DFHPF8
  5772        GO TO 0360-FINALIZE
  5773     END-IF
  5774     IF EIBAID = DFHPF23
  5775        IF PI-CLEAR-ERROR
  5776           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5777           MOVE ER-3833           TO EMI-ERROR
  5778           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5779           GO TO 0350-BUILD-INIT-MAP
  5780        ELSE
  5781           GO TO 8810-PF23
  5782        END-IF
  5783     END-IF
  5784     IF EIBAID = DFHPF24
  5785        IF PI-CLEAR-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 102
* EL6317.cbl
  5786           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5787           MOVE ER-3833           TO EMI-ERROR
  5788           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5789           GO TO 0350-BUILD-INIT-MAP
  5790        ELSE
  5791           GO TO 9200-RETURN-MAIN-MENU
  5792        END-IF
  5793     END-IF
  5794     IF EIBAID = DFHPF12
  5795        GO TO 9500-PF12
  5796     END-IF
  5797     IF EIBAID = DFHENTER
  5798        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5799        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5800        GO TO 0330-CHECK-ERRORS
  5801     END-IF
  5802     MOVE ER-0029                TO EMI-ERROR
  5803     .
  5804 0320-INPUT-ERROR.
  5805     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5806     MOVE AL-UNBON               TO PFENTRA
  5807     MOVE -1                     TO PFENTRL
  5808     GO TO 8200-SEND-DATAONLY
  5809     .
  5810 0325-EDIT-SCREEN.
  5811     if prtswl > zeros
  5812        if prtswi = 'Y' OR 'N' OR 'P' OR ' '
  5813*          MOVE AL-UANON       TO PRTSWA
  5814*          IF PRTSWI = ' '
  5815              MOVE 'P'         TO PRTSWI
  5816*          END-IF
  5817*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5818        END-IF
  5819     END-IF
  5820     IF (SIGREQL > ZEROS)
  5821        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5822        MOVE AL-UANON         TO SIGREQA
  5823        IF SIGREQI = ' '
  5824           MOVE 'N'           TO SIGREQI
  5825        END-IF
  5826        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5827     ELSE
  5828        MOVE ER-2651          TO EMI-ERROR
  5829        MOVE -1               TO SIGREQL
  5830        MOVE AL-UABON         TO SIGREQA
  5831        PERFORM 9900-ERROR-FORMAT
  5832                                 THRU 9900-EXIT
  5833     END-IF
  5834     IF LTRIDL > ZEROS
  5835        AND LTRIDI > SPACES
  5836        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5837        MOVE LTRIDI              TO LETR-LETTER-ID
  5838                                    PI-LTRID-ENTERED
  5839        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5840        MOVE SPACES              TO LETR-FILLER
  5841        MOVE 0                   TO LETR-SEQ-NO
  5842        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5843     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 103
* EL6317.cbl
  5844        MOVE ER-1236          TO EMI-ERROR
  5845        MOVE -1               TO LTRIDL
  5846        MOVE AL-UABON         TO LTRIDA
  5847        PERFORM 9900-ERROR-FORMAT
  5848                                 THRU 9900-EXIT
  5849     END-IF
  5850
  5851     IF W-PROMPT-LETTER EQUAL 'Y'
  5852         MOVE ER-0894            TO EMI-ERROR
  5853         MOVE -1                 TO LTRIDL
  5854         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5855     END-IF
  5856
  5857     IF ENCCODEL > ZEROS
  5858        MOVE FUNCTION UPPER-CASE(ENCCODEI) TO ENCCODEI
  5859                                              PI-ENCCODE
  5860        MOVE SPACES             TO WS-ELENCC-KEY
  5861        MOVE PI-COMPANY-CD      TO WS-ENCC-COMPANY-CD
  5862        MOVE '2'                TO WS-ENCC-REC-TYPE
  5863        MOVE ENCCODEI           TO WS-ENCC-ENC-CODE
  5864
  5865
  5866* EXEC CICS READ
  5867*           DATASET    (WS-ELENCC-FILE-ID)
  5868*           SET        (ADDRESS OF ENCLOSURE-CODES)
  5869*           RIDFLD     (WS-ELENCC-KEY)
  5870*           RESP       (WS-RESPONSE)
  5871*       END-EXEC
  5872*    MOVE '&"S        E          (  N#00005845' TO DFHEIV0
  5873     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5874     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5875     MOVE X'204E233030303035383435' TO DFHEIV0(25:11)
  5876     CALL 'kxdfhei1' USING DFHEIV0,
  5877           WS-ELENCC-FILE-ID,
  5878           DFHEIV20,
  5879           DFHEIV99,
  5880           WS-ELENCC-KEY,
  5881           DFHEIV99,
  5882           DFHEIV99,
  5883           DFHEIV99
  5884     SET ADDRESS OF ENCLOSURE-CODES TO
  5885         DFHEIV20
  5886     MOVE EIBRESP  TO WS-RESPONSE
  5887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5888
  5889        IF RESP-NORMAL
  5890           MOVE ENCCODEI         TO PI-ENCCODE
  5891                                    W-ENCLOSURE-CD
  5892           MOVE AL-UANON         TO ENCCODEA
  5893        ELSE
  5894           MOVE ER-1560          TO EMI-ERROR
  5895           MOVE -1               TO ENCCODEL
  5896           MOVE AL-UABON         TO ENCCODEA
  5897           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5898        END-IF
  5899     END-IF
  5900
  5901     SET REASONS-NOT-FOUND TO TRUE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 104
* EL6317.cbl
  5902     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5903        IF REACDL (S1) = +4 OR
  5904          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5905              MOVE AL-SANON     TO REACDA (S1)
  5906              SET REASONS-FOUND TO TRUE
  5907        END-IF
  5908     END-PERFORM
  5909
  5910     IF REASONS-NOT-FOUND
  5911        MOVE ER-1820             TO EMI-ERROR
  5912        MOVE -1                  TO PFENTRL
  5913        PERFORM 9900-ERROR-FORMAT
  5914                                 THRU 9900-EXIT
  5915     ELSE
  5916        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5917     END-IF
  5918
  5919     IF CRTNT1L > ZEROS
  5920        IF CRTNT1I > SPACES
  5921           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5922        END-IF
  5923     END-IF
  5924
  5925     IF CRTNT2L > ZEROS
  5926        IF CRTNT2I > SPACES
  5927           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5928        END-IF
  5929     END-IF
  5930
  5931     IF BILNT1L > ZEROS
  5932        IF BILNT1I > SPACES
  5933           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5934        END-IF
  5935     END-IF
  5936
  5937     IF BILNT2L > ZEROS
  5938        IF BILNT2I > SPACES
  5939           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  5940        END-IF
  5941     END-IF
  5942
  5943     .
  5944 0325-EXIT.
  5945     EXIT.
  5946
  5947 0326-GET-Z-RECORD.
  5948
  5949     MOVE SPACES  TO W-Z-CONTROL-DATA
  5950
  5951
  5952* EXEC CICS STARTBR
  5953*         DATASET    ('ELLETR')
  5954*         RIDFLD     (ELLETR-KEY)
  5955*         GTEQ
  5956*         RESP      (WS-RESPONSE)
  5957*    END-EXEC.
  5958     MOVE 'ELLETR' TO DFHEIV1
  5959     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 105
* EL6317.cbl
  5960       TO DFHEIV11
  5961*    MOVE '&,         G          &  N#00005914' TO DFHEIV0
  5962     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5963     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5964     MOVE X'204E233030303035393134' TO DFHEIV0(25:11)
  5965     CALL 'kxdfhei1' USING DFHEIV0,
  5966           DFHEIV1,
  5967           ELLETR-KEY,
  5968           DFHEIV99,
  5969           DFHEIV11,
  5970           DFHEIV99
  5971     MOVE EIBRESP  TO WS-RESPONSE
  5972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5973
  5974     IF NOT RESP-NORMAL
  5975         MOVE ER-1236          TO EMI-ERROR
  5976         MOVE -1               TO LTRIDL
  5977         MOVE AL-UABON         TO LTRIDA
  5978         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5979         GO TO 0326-ENDBR
  5980     END-IF.
  5981
  5982 0326-READNEXT.
  5983
  5984
  5985* EXEC CICS READNEXT
  5986*        DATASET   ('ELLETR')
  5987*        INTO      (TEXT-FILES)
  5988*        RIDFLD    (ELLETR-KEY)
  5989*        RESP      (WS-RESPONSE)
  5990*    END-EXEC
  5991     MOVE LENGTH OF
  5992      TEXT-FILES
  5993       TO DFHEIV12
  5994     MOVE 'ELLETR' TO DFHEIV1
  5995     MOVE 0
  5996       TO DFHEIV11
  5997*    MOVE '&.IL                  )  N#00005930' TO DFHEIV0
  5998     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5999     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6000     MOVE X'204E233030303035393330' TO DFHEIV0(25:11)
  6001     CALL 'kxdfhei1' USING DFHEIV0,
  6002           DFHEIV1,
  6003           TEXT-FILES,
  6004           DFHEIV12,
  6005           ELLETR-KEY,
  6006           DFHEIV99,
  6007           DFHEIV11,
  6008           DFHEIV99,
  6009           DFHEIV99
  6010     MOVE EIBRESP  TO WS-RESPONSE
  6011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6012     IF RESP-NORMAL
  6013        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  6014           MOVE ER-1236          TO EMI-ERROR
  6015           MOVE -1               TO LTRIDL
  6016           MOVE AL-UABON         TO LTRIDA
  6017           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 106
* EL6317.cbl
  6018           GO TO 0326-ENDBR
  6019        END-IF
  6020
  6021        MOVE AL-UANON         TO LTRIDA
  6022        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6023           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  6024        ELSE
  6025           GO TO 0326-READNEXT
  6026        END-IF
  6027     ELSE
  6028        MOVE ER-1236          TO EMI-ERROR
  6029        MOVE -1               TO LTRIDL
  6030        MOVE AL-UABON         TO LTRIDA
  6031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6032        GO TO 0326-ENDBR
  6033     END-IF.
  6034
  6035     IF PI-ENCCODE NOT GREATER THAN SPACES
  6036         MOVE W-ENCLOSURE-CD            TO PI-ENCCODE
  6037                                           ENCCODEO
  6038         MOVE AL-UANON                  TO ENCCODEA
  6039         MOVE +3                        TO ENCCODEL
  6040     END-IF.
  6041
  6042 0326-ENDBR.
  6043
  6044
  6045* EXEC CICS ENDBR
  6046*        DATASET     ('ELLETR')
  6047*    END-EXEC.
  6048     MOVE 'ELLETR' TO DFHEIV1
  6049     MOVE 0
  6050       TO DFHEIV11
  6051*    MOVE '&2                    $   #00005968' TO DFHEIV0
  6052     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6053     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6054     MOVE X'2020233030303035393638' TO DFHEIV0(25:11)
  6055     CALL 'kxdfhei1' USING DFHEIV0,
  6056           DFHEIV1,
  6057           DFHEIV11,
  6058           DFHEIV99
  6059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6060
  6061
  6062 0326-EXIT.
  6063      EXIT.
  6064 0330-CHECK-ERRORS.
  6065     IF EMI-NO-ERRORS
  6066        GO TO 0350-BUILD-INIT-MAP
  6067     ELSE
  6068        GO TO 8200-SEND-DATAONLY
  6069     END-IF
  6070     .
  6071 0330-EXIT.
  6072     EXIT.
  6073 0350-BUILD-INIT-MAP.
  6074
  6075     IF PI-RETURN-TO-PROGRAM = 'EL1273'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 107
* EL6317.cbl
  6076      OR 'EL6314'
  6077        display 'coming from ' PI-RETURN-TO-PROGRAM
  6078        MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  6079        MOVE PI-CARRIER             TO CRTO-CARRIER
  6080        MOVE PI-GROUPING            TO CRTO-GROUPING
  6081        MOVE PI-STATE               TO CRTO-STATE
  6082        MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  6083        MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  6084        MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  6085        MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  6086        MOVE 'I'                    TO CRTO-RECORD-TYPE
  6087        MOVE ZEROS                  TO CRTO-SEQ-NO
  6088        MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  6089                                       PI-ERENDT-KEY
  6090     END-IF
  6091     MOVE PI-CRTO-CARRIER        TO CARRO
  6092     MOVE PI-CRTO-GROUPING       TO GROUPO
  6093     MOVE PI-CRTO-STATE          TO STATEO
  6094     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  6095     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  6096     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  6097     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  6098     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  6099     MOVE ' '                    TO DC-OPTION-CODE
  6100     PERFORM 9700-DATE-LINK
  6101     IF NO-CONVERSION-ERROR
  6102        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6103     END-IF
  6104
  6105*    IF PI-PRTSW-ENTERED > SPACES
  6106*       MOVE PI-PRTSW-ENTERED    TO PRTSWI
  6107*       MOVE AL-UANON            TO PRTSWA
  6108*       MOVE +1                  TO PRTSWL
  6109*    END-IF
  6110
  6111     IF PI-SIGREQ-ENTERED > SPACES
  6112        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  6113        MOVE AL-UANON            TO SIGREQA
  6114        MOVE +1                  TO SIGREQL
  6115     END-IF
  6116
  6117     IF PI-LTRID-ENTERED > SPACES
  6118        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6119        MOVE AL-UANON            TO LTRIDA
  6120        MOVE +4                  TO LTRIDL
  6121     END-IF
  6122
  6123     IF PI-ENCCODE > SPACES
  6124        MOVE PI-ENCCODE          TO ENCCODEI
  6125        MOVE AL-UANON            TO ENCCODEA
  6126        MOVE +3                  TO ENCCODEL
  6127     END-IF
  6128
  6129     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6130     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6131        IF REACDL (S1) = +4 OR
  6132          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6133              MOVE AL-SANON      TO REACDA (S1)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 108
* EL6317.cbl
  6134              MOVE +4            TO REACDL (S1)
  6135              SET REASONS-FOUND  TO TRUE
  6136        END-IF
  6137     END-PERFORM
  6138
  6139     IF PI-CERTNT1-ENTERED > SPACES
  6140        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6141        MOVE AL-UANON            TO CRTNT1A
  6142        MOVE +63                 TO CRTNT1L
  6143     END-IF
  6144
  6145     IF PI-CERTNT2-ENTERED > SPACES
  6146        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6147        MOVE AL-UANON            TO CRTNT2A
  6148        MOVE +63                 TO CRTNT2L
  6149     END-IF
  6150
  6151     IF PI-BILLNT1-ENTERED > SPACES
  6152        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6153        MOVE AL-UANON            TO BILNT1A
  6154        MOVE +63                 TO BILNT1L
  6155     END-IF
  6156
  6157     IF PI-BILLNT2-ENTERED > SPACES
  6158        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6159        MOVE AL-UANON            TO BILNT2A
  6160        MOVE +63                 TO BILNT2L
  6161     END-IF
  6162
  6163     GO TO 8100-SEND-INITIAL-MAP
  6164     .
  6165 0360-FINALIZE.
  6166     display ' made it to 0360 '
  6167     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6168     IF NOT EMI-NO-ERRORS
  6169       AND EIBAID = DFHPF4
  6170        GO TO 8200-SEND-DATAONLY
  6171     END-IF
  6172     set P to address of KIXSYS
  6173     CALL "getenv" using by value P returning var-ptr
  6174     if var-ptr = null then
  6175        display ' kixsys not set '
  6176     else
  6177        set address of var to var-ptr
  6178        move 0 to env-var-len
  6179        inspect var tallying env-var-len
  6180          for characters before X'00'
  6181*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6182        unstring var (1:env-var-len) delimited by '/'
  6183           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6184              WS-KIX-SYS
  6185        end-unstring
  6186*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6187*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6188     end-if
  6189     set P to address of KIXHOST
  6190     CALL "getenv" using by value P returning var-ptr
  6191     if var-ptr = null then
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 109
* EL6317.cbl
  6192        display ' kixhost not set '
  6193     else
  6194        set address of var to var-ptr
  6195        move 0 to env-var-len
  6196        inspect var tallying env-var-len
  6197          for characters before X'00'
  6198*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6199        MOVE var(1:env-var-len)  to ws-kixhost
  6200        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6201     end-if
  6202     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6203     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6204     IF RESP-NORMAL
  6205        AND (PI-ELCRTO-KEY (1:33) = OC-CONTROL-PRIMARY (1:33))
  6206        DISPLAY ' RESP NORMAL AND = '
  6207        MOVE OC-KEY-SEQ-NO  TO CRTO-SEQ-NO
  6208                               PI-CRTO-SEQ-NO
  6209        MOVE LOW-VALUES     TO NEW-ELCRTO-REC
  6210        MOVE PI-ELCRTO-KEY  TO NEW-ELCRTO-KEY
  6211        SUBTRACT +1         FROM NCRTO-SEQ-NO
  6212        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6213*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6214        PERFORM 1100-CALL-NS-BUS-LOGIC
  6215                                 THRU 1100-EXIT
  6216        IF BL-OK
  6217           CONTINUE
  6218        ELSE
  6219           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6220           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6221           MOVE -1               TO CARRL
  6222        END-IF
  6223     ELSE
  6224        MOVE ER-9999             TO EMI-ERROR
  6225        PERFORM 9900-ERROR-FORMAT
  6226                                 THRU 9900-EXIT
  6227        MOVE -1                  TO CARRL
  6228        GO TO 8100-SEND-INITIAL-MAP
  6229     END-IF
  6230     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6231                                 TO SYSO
  6232     MOVE WS-KIXHOST             TO HOSTO
  6233     MOVE PI-COMPANY-ID          TO COMPANYO
  6234     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6235       OR 'EL6314'
  6236         MOVE '2'                TO DATASORO
  6237     ELSE
  6238         MOVE '4'                TO DATASORO
  6239     END-IF
  6240     MOVE BL-BATCH-NO            TO BATCHNOO
  6241     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6242     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6243     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6244*    MOVE -1                     TO PRTSWL
  6245*    MOVE AL-UANON               TO PRTSWA
  6246     MOVE -1                     TO SIGREQL
  6247     MOVE AL-UANON               TO SIGREQA
  6248     IF EIBAID = DFHPF4
  6249        MOVE SPACES              TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 110
* EL6317.cbl
  6250        MOVE ER-0280             TO EMI-ERROR
  6251        PERFORM 9900-ERROR-FORMAT
  6252                                 THRU 9900-EXIT
  6253        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6254        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6255        MOVE 'Y'                 TO PI-FINALIZED-IND
  6256        GO TO 9400-CLEAR
  6257     ELSE
  6258        MOVE ER-1818             TO EMI-ERROR
  6259        PERFORM 9900-ERROR-FORMAT
  6260                                 THRU 9900-EXIT
  6261     END-IF
  6262     GO TO 0350-BUILD-INIT-MAP
  6263     .
  6264 0360-EXIT.
  6265     EXIT.
  6266 0362-READ-ELCRTO.
  6267     display ' made it to 0362 '
  6268
  6269* EXEC CICS READ
  6270*        DATASET   (WS-ELCRTO-FILE-ID)
  6271*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6272*        RIDFLD    (ELCRTO-KEY)
  6273*        GTEQ
  6274*        RESP      (WS-RESPONSE)
  6275*    END-EXEC
  6276*    MOVE '&"S        G          (  N#00006178' TO DFHEIV0
  6277     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6278     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6279     MOVE X'204E233030303036313738' TO DFHEIV0(25:11)
  6280     CALL 'kxdfhei1' USING DFHEIV0,
  6281           WS-ELCRTO-FILE-ID,
  6282           DFHEIV20,
  6283           DFHEIV99,
  6284           ELCRTO-KEY,
  6285           DFHEIV99,
  6286           DFHEIV99,
  6287           DFHEIV99
  6288     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6289         DFHEIV20
  6290     MOVE EIBRESP  TO WS-RESPONSE
  6291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6292     .
  6293 0362-EXIT.
  6294     EXIT.
  6295 0363-READ-ELCRTO-UPD.
  6296     display ' made it to 0363 '
  6297
  6298* EXEC CICS READ
  6299*        DATASET   (WS-ELCRTO-FILE-ID)
  6300*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6301*        RIDFLD    (ELCRTO-KEY)
  6302*        UPDATE
  6303*        RESP      (WS-RESPONSE)
  6304*    END-EXEC
  6305*    MOVE '&"S        EU         (  N#00006190' TO DFHEIV0
  6306     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6307     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 111
* EL6317.cbl
  6308     MOVE X'204E233030303036313930' TO DFHEIV0(25:11)
  6309     CALL 'kxdfhei1' USING DFHEIV0,
  6310           WS-ELCRTO-FILE-ID,
  6311           DFHEIV20,
  6312           DFHEIV99,
  6313           ELCRTO-KEY,
  6314           DFHEIV99,
  6315           DFHEIV99,
  6316           DFHEIV99
  6317     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6318         DFHEIV20
  6319     MOVE EIBRESP  TO WS-RESPONSE
  6320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6321     .
  6322 0363-EXIT.
  6323     EXIT.
  6324 0365-READ-ERENDT.
  6325
  6326* EXEC CICS READ
  6327*        DATASET   (WS-ERENDT-FILE-ID)
  6328*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6329*        RIDFLD    (ERENDT-KEY)
  6330*        RESP      (WS-RESPONSE)
  6331*    END-EXEC
  6332*    MOVE '&"S        E          (  N#00006201' TO DFHEIV0
  6333     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6335     MOVE X'204E233030303036323031' TO DFHEIV0(25:11)
  6336     CALL 'kxdfhei1' USING DFHEIV0,
  6337           WS-ERENDT-FILE-ID,
  6338           DFHEIV20,
  6339           DFHEIV99,
  6340           ERENDT-KEY,
  6341           DFHEIV99,
  6342           DFHEIV99,
  6343           DFHEIV99
  6344     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6345         DFHEIV20
  6346     MOVE EIBRESP  TO WS-RESPONSE
  6347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6348     .
  6349 0365-EXIT.
  6350     EXIT.
  6351 0400-ADD-ERENDT.
  6352     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6353     display ' made it to 0400 '
  6354
  6355* EXEC CICS GETMAIN
  6356*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6357*         LENGTH   (ERENDT-LENGTH)
  6358*         INITIMG  (GETMAIN-SPACE)
  6359*    END-EXEC
  6360*    MOVE ',"IL                  $   #00006213' TO DFHEIV0
  6361     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6362     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6363     MOVE X'2020233030303036323133' TO DFHEIV0(25:11)
  6364     CALL 'kxdfhei1' USING DFHEIV0,
  6365           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 112
* EL6317.cbl
  6366           ERENDT-LENGTH,
  6367           GETMAIN-SPACE
  6368     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6369         DFHEIV20
  6370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6371     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6372     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6373     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6374     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6375                                    EN-INPUT-DT
  6376                                    EN-PROCESS-DT
  6377
  6378     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6379     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6380     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6381     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6382     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6383     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6384     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6385     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6386     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6387     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6388     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6389     IF OC-LF-BENCD NOT = '00' AND '  '
  6390        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6391        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6392        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6393        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6394        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6395        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6396        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6397     END-IF
  6398     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6399     IF OC-AH-BENCD NOT = '00' AND '  '
  6400        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6401        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6402        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6403        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6404        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6405        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6406     END-IF
  6407     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6408
  6409     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6410       OR 'EL6314'
  6411         display 'from ' PI-RETURN-TO-PROGRAM
  6412                 ', using crto for new crto'
  6413
  6414        MOVE OC-INS-FIRST-NAME    TO EN-INS-NEW-FIRST-NAME
  6415                                     NCRTO-INS-FIRST-NAME
  6416        MOVE OC-INS-MIDDLE-INIT   TO EN-INS-NEW-MIDDLE-INIT
  6417                                     NCRTO-INS-MIDDLE-INIT
  6418        MOVE OC-INS-LAST-NAME     TO EN-INS-NEW-LAST-NAME
  6419                                     NCRTO-INS-LAST-NAME
  6420        MOVE OC-INS-AGE           TO EN-INS-NEW-AGE
  6421                                     NCRTO-INS-AGE
  6422        MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6423                                     NCRTO-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 113
* EL6317.cbl
  6424        MOVE OC-JNT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6425                                     NCRTO-JNT-FIRST-NAME
  6426        MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6427                                     NCRTO-JNT-MIDDLE-INIT
  6428        MOVE OC-JNT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6429                                     NCRTO-JNT-LAST-NAME
  6430        MOVE OC-JNT-AGE           TO EN-JNT-NEW-AGE
  6431                                     NCRTO-JNT-AGE
  6432        MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  6433                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6434        MOVE OC-LF-BENCD          TO EN-LF-NEW-BENCD
  6435                                     NCRTO-LF-BENCD
  6436        IF OC-LF-BENCD NOT = '00' AND '  '
  6437           MOVE OC-LF-BEN-AMT       TO EN-LF-NEW-BEN-AMT
  6438                                       NCRTO-LF-BEN-AMT
  6439           MOVE OC-LF-PRM-AMT       TO EN-LF-NEW-PRM-AMT
  6440                                       NCRTO-LF-PRM-AMT
  6441           MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-NEW-ALT-BEN-AMT
  6442                                       NCRTO-LF-ALT-BEN-AMT
  6443           MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-NEW-ALT-PRM-AMT
  6444                                       NCRTO-LF-ALT-PRM-AMT
  6445           MOVE OC-LF-TERM          TO EN-LF-NEW-TERM
  6446                                       NCRTO-LF-TERM
  6447           MOVE OC-LF-EXP-DT        TO EN-LF-NEW-EXP-DT
  6448                                       NCRTO-LF-EXP-DT
  6449           MOVE OC-LF-COMM-PCT      TO EN-LF-NEW-COMM-PCT
  6450                                       NCRTO-LF-COMM-PCT
  6451           MOVE OC-LF-CANCEL-DT     TO NCRTO-LF-CANCEL-DT
  6452           MOVE OC-LF-CANCEL-AMT    TO NCRTO-LF-CANCEL-AMT
  6453           MOVE OC-LF-ITD-CANCEL-AMT TO NCRTO-LF-ITD-CANCEL-AMT
  6454        END-IF
  6455        MOVE OC-AH-BENCD          TO EN-AH-NEW-BENCD
  6456                                     NCRTO-AH-BENCD
  6457        IF OC-AH-BENCD NOT = '00' AND '  '
  6458           MOVE OC-AH-BEN-AMT       TO EN-AH-NEW-BEN-AMT
  6459                                       NCRTO-AH-BEN-AMT
  6460           MOVE OC-AH-PRM-AMT       TO EN-AH-NEW-PRM-AMT
  6461                                       NCRTO-AH-PRM-AMT
  6462           MOVE OC-AH-TERM          TO EN-AH-NEW-TERM
  6463                                       NCRTO-AH-TERM
  6464           MOVE OC-AH-EXP-DT        TO EN-AH-NEW-EXP-DT
  6465                                       NCRTO-AH-EXP-DT
  6466           MOVE OC-AH-CP            TO EN-AH-NEW-CP
  6467                                       NCRTO-AH-CP
  6468           MOVE OC-AH-COMM-PCT      TO EN-AH-NEW-COMM-PCT
  6469                                       NCRTO-AH-COMM-PCT
  6470           MOVE OC-AH-CANCEL-DT     TO NCRTO-AH-CANCEL-DT
  6471           MOVE OC-AH-CANCEL-AMT    TO NCRTO-AH-CANCEL-AMT
  6472           MOVE OC-AH-ITD-CANCEL-AMT TO NCRTO-AH-ITD-CANCEL-AMT
  6473        END-IF
  6474        MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6475                                       NCRTO-CRED-BENE-NAME
  6476
  6477        GO TO 0400-WRITE-ENDT
  6478     END-IF
  6479
  6480* EXEC CICS GETMAIN
  6481*         SET      (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 114
* EL6317.cbl
  6482*         LENGTH   (ERPNDB-LENGTH)
  6483*         INITIMG  (GETMAIN-SPACE)
  6484*    END-EXEC
  6485*    MOVE ',"IL                  $   #00006326' TO DFHEIV0
  6486     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6487     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6488     MOVE X'2020233030303036333236' TO DFHEIV0(25:11)
  6489     CALL 'kxdfhei1' USING DFHEIV0,
  6490           DFHEIV20,
  6491           ERPNDB-LENGTH,
  6492           GETMAIN-SPACE
  6493     SET ADDRESS OF PENDING-BUSINESS TO
  6494         DFHEIV20
  6495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6496     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6497     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6498
  6499* EXEC CICS READ
  6500*        DATASET   (WS-ERPNDB-FILE-ID)
  6501*        INTO      (PENDING-BUSINESS)
  6502*        RIDFLD    (ERPNDB-KEY)
  6503*        RESP      (WS-RESPONSE)
  6504*    END-EXEC
  6505     MOVE LENGTH OF
  6506      PENDING-BUSINESS
  6507       TO DFHEIV11
  6508*    MOVE '&"IL       E          (  N#00006333' TO DFHEIV0
  6509     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6510     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6511     MOVE X'204E233030303036333333' TO DFHEIV0(25:11)
  6512     CALL 'kxdfhei1' USING DFHEIV0,
  6513           WS-ERPNDB-FILE-ID,
  6514           PENDING-BUSINESS,
  6515           DFHEIV11,
  6516           ERPNDB-KEY,
  6517           DFHEIV99,
  6518           DFHEIV99,
  6519           DFHEIV99
  6520     MOVE EIBRESP  TO WS-RESPONSE
  6521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6522     IF NOT RESP-NORMAL
  6523        GO TO 0400-EXIT
  6524     END-IF
  6525*    set found-pndb to true
  6526     display ' good read on erpndb '
  6527     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6528                                      NCRTO-INS-FIRST-NAME
  6529     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6530                                      NCRTO-INS-MIDDLE-INIT
  6531     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6532                                      NCRTO-INS-LAST-NAME
  6533     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6534                                      NCRTO-INS-AGE
  6535     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6536                                      NCRTO-JNT-FIRST-NAME
  6537     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6538                                      NCRTO-JNT-MIDDLE-INIT
  6539     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 115
* EL6317.cbl
  6540                                      NCRTO-JNT-LAST-NAME
  6541     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6542                                      NCRTO-JNT-AGE
  6543     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6544                                      NCRTO-LF-BENCD
  6545     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6546        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6547                                      NCRTO-LF-BEN-AMT
  6548        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6549                                      NCRTO-LF-PRM-AMT
  6550        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6551                                      NCRTO-LF-ALT-BEN-AMT
  6552        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6553                                      NCRTO-LF-ALT-PRM-AMT
  6554        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6555                                      NCRTO-LF-TERM
  6556        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6557                                      NCRTO-LF-EXP-DT
  6558        IF PB-I-JOINT-COMMISSION > +0
  6559           MOVE PB-I-JOINT-COMMISSION
  6560                                   TO EN-LF-NEW-COMM-PCT
  6561                                      NCRTO-LF-COMM-PCT
  6562        ELSE
  6563           MOVE PB-I-LIFE-COMMISSION
  6564                                   TO EN-LF-NEW-COMM-PCT
  6565                                      NCRTO-LF-COMM-PCT
  6566        MOVE LOW-VALUES            TO NCRTO-LF-CANCEL-DT
  6567        MOVE +0                    TO NCRTO-LF-CANCEL-AMT
  6568                                      NCRTO-LF-ITD-CANCEL-AMT
  6569        END-IF
  6570     END-IF
  6571     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6572                                      NCRTO-AH-BENCD
  6573     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6574        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6575                                      NCRTO-AH-BEN-AMT
  6576        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6577                                      NCRTO-AH-PRM-AMT
  6578        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6579                                      NCRTO-AH-TERM
  6580        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6581                                      NCRTO-AH-EXP-DT
  6582        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6583                                      NCRTO-AH-CP
  6584        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6585                                      NCRTO-AH-COMM-PCT
  6586        MOVE LOW-VALUES            TO NCRTO-AH-CANCEL-DT
  6587        MOVE +0                    TO NCRTO-AH-CANCEL-AMT
  6588                                      NCRTO-AH-ITD-CANCEL-AMT
  6589     END-IF
  6590     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6591     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6592     move pb-control-by-account (1:33)
  6593                                 to ws-ermail-key
  6594
  6595* EXEC CICS READ
  6596*        DATASET   ('ERMAIL')
  6597*        SET       (ADDRESS OF MAILING-DATA)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 116
* EL6317.cbl
  6598*        RIDFLD    (WS-ERMAIL-KEY)
  6599*        RESP      (WS-RESPONSE)
  6600*    END-EXEC
  6601     MOVE 'ERMAIL' TO DFHEIV1
  6602*    MOVE '&"S        E          (  N#00006411' TO DFHEIV0
  6603     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6604     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6605     MOVE X'204E233030303036343131' TO DFHEIV0(25:11)
  6606     CALL 'kxdfhei1' USING DFHEIV0,
  6607           DFHEIV1,
  6608           DFHEIV20,
  6609           DFHEIV99,
  6610           WS-ERMAIL-KEY,
  6611           DFHEIV99,
  6612           DFHEIV99,
  6613           DFHEIV99
  6614     SET ADDRESS OF MAILING-DATA TO
  6615         DFHEIV20
  6616     MOVE EIBRESP  TO WS-RESPONSE
  6617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6618     IF RESP-NORMAL
  6619        DISPLAY ' FOUND ERMAIL '
  6620        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6621                                    NCRTO-CRED-BENE-NAME
  6622     ELSE
  6623        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6624     END-IF
  6625
  6626     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  6627     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  6628
  6629
  6630* EXEC CICS READ
  6631*         DATASET  (WS-ELCRTT-FILE-ID)
  6632*         RIDFLD   (WS-ELCRTT-KEY)
  6633*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  6634*         RESP     (WS-RESPONSE)
  6635*    END-EXEC
  6636*    MOVE '&"S        E          (  N#00006428' TO DFHEIV0
  6637     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6638     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6639     MOVE X'204E233030303036343238' TO DFHEIV0(25:11)
  6640     CALL 'kxdfhei1' USING DFHEIV0,
  6641           WS-ELCRTT-FILE-ID,
  6642           DFHEIV20,
  6643           DFHEIV99,
  6644           WS-ELCRTT-KEY,
  6645           DFHEIV99,
  6646           DFHEIV99,
  6647           DFHEIV99
  6648     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  6649         DFHEIV20
  6650     MOVE EIBRESP  TO WS-RESPONSE
  6651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6652
  6653     IF RESP-NORMAL
  6654        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6655                                     NCRTO-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 117
* EL6317.cbl
  6656        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  6657                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6658     END-IF.
  6659      .
  6660 0400-WRITE-ENDT.
  6661
  6662     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6663        IF REACD-IN (S1) NOT = LOW-VALUES
  6664           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6665        END-IF
  6666     END-PERFORM
  6667     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6668     MOVE 'V'                    TO EN-DOCU-TYPE
  6669     MOVE ' '                    TO EN-MONEY-SW
  6670     MOVE SIGREQI                TO EN-SIG-SW
  6671     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6672     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6673     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6674*    IF NOT EMI-NO-ERRORS
  6675*       DISPLAY ' GOING TO 8200 FROM 0400 '
  6676*       GO TO 8200-SEND-DATAONLY
  6677*    END-IF
  6678     DISPLAY ' 0400 EXIT '
  6679     .
  6680 0400-EXIT.
  6681     EXIT.
  6682 0410-INIT-ERENDT.
  6683     display ' made it to 0410 '
  6684     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6685     MOVE ZEROS                  TO ENDT-SEQ-NO
  6686
  6687* EXEC CICS READ
  6688*        DATASET    (WS-ERENDT-FILE-ID)
  6689*        RIDFLD     (ERENDT-KEY)
  6690*        INTO       (ENDORSEMENT-RECORD)
  6691*        RESP       (WS-RESPONSE)
  6692*        GTEQ
  6693*    END-EXEC
  6694     MOVE LENGTH OF
  6695      ENDORSEMENT-RECORD
  6696       TO DFHEIV11
  6697*    MOVE '&"IL       G          (  N#00006468' TO DFHEIV0
  6698     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6699     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6700     MOVE X'204E233030303036343638' TO DFHEIV0(25:11)
  6701     CALL 'kxdfhei1' USING DFHEIV0,
  6702           WS-ERENDT-FILE-ID,
  6703           ENDORSEMENT-RECORD,
  6704           DFHEIV11,
  6705           ERENDT-KEY,
  6706           DFHEIV99,
  6707           DFHEIV99,
  6708           DFHEIV99
  6709     MOVE EIBRESP  TO WS-RESPONSE
  6710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6711     IF RESP-NORMAL
  6712        AND (EN-CONTROL-PRIMARY (1:34) =
  6713           OC-CONTROL-PRIMARY (1:34))
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 118
* EL6317.cbl
  6714        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6715     ELSE
  6716        MOVE +4096               TO WS-SEQ-NO
  6717     END-IF
  6718     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6719     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6720     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6721     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6722     INITIALIZE EN-ISSUE-RECORD
  6723     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6724                                    EN-AH-ORIG-EXP-DT
  6725                                    EN-LF-NEW-EXP-DT
  6726                                    EN-AH-NEW-EXP-DT
  6727                                    EN-PROCESS-DT
  6728     .
  6729 0410-EXIT.
  6730     EXIT.
  6731 0420-UPDATE-ELCRTO.
  6732     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6733     IF RESP-NORMAL
  6734        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6735                                    OC-LAST-MAINT-DT
  6736        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6737        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6738
  6739* EXEC CICS REWRITE
  6740*          FROM     (ORIGINAL-CERTIFICATE)
  6741*          DATASET  ('ELCRTO')
  6742*       END-EXEC
  6743     MOVE LENGTH OF
  6744      ORIGINAL-CERTIFICATE
  6745       TO DFHEIV11
  6746     MOVE 'ELCRTO' TO DFHEIV1
  6747*    MOVE '&& L                  %   #00006502' TO DFHEIV0
  6748     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6749     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6750     MOVE X'2020233030303036353032' TO DFHEIV0(25:11)
  6751     CALL 'kxdfhei1' USING DFHEIV0,
  6752           DFHEIV1,
  6753           ORIGINAL-CERTIFICATE,
  6754           DFHEIV11,
  6755           DFHEIV99
  6756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6757     END-IF
  6758     .
  6759 0420-EXIT.
  6760     EXIT.
  6761
  6762 0425-ADD-NEW-ELCRTO.
  6763     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6764     MOVE 'OC'                   TO OC-RECORD-ID
  6765     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6766     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6767     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6768     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6769     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6770     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6771     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 119
* EL6317.cbl
  6772     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6773     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6774     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6775     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6776     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6777     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  6778     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6779     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6780     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6781     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6782     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6783     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6784     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6785     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6786     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6787     MOVE NCRTO-LF-CANCEL-DT     TO OC-LF-CANCEL-DT
  6788     MOVE NCRTO-LF-CANCEL-AMT    TO OC-LF-CANCEL-AMT
  6789     MOVE NCRTO-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
  6790     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6791     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6792     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6793     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6794     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6795     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6796     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6797     MOVE NCRTO-AH-CANCEL-DT     TO OC-AH-CANCEL-DT
  6798     MOVE NCRTO-AH-CANCEL-AMT    TO OC-AH-CANCEL-AMT
  6799     MOVE NCRTO-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
  6800     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6801     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6802     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
  6803     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  6804     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6805     .
  6806 0425-WRITE-ELCRTO.
  6807
  6808
  6809* EXEC CICS WRITE
  6810*       DATASET   ('ELCRTO')
  6811*       FROM      (ORIGINAL-CERTIFICATE)
  6812*       RIDFLD    (OC-CONTROL-PRIMARY)
  6813*       RESP      (WS-RESPONSE)
  6814*    END-EXEC
  6815     MOVE LENGTH OF
  6816      ORIGINAL-CERTIFICATE
  6817       TO DFHEIV11
  6818     MOVE 'ELCRTO' TO DFHEIV1
  6819*    MOVE '&$ L                  ''  N#00006557' TO DFHEIV0
  6820     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6821     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6822     MOVE X'204E233030303036353537' TO DFHEIV0(25:11)
  6823     CALL 'kxdfhei1' USING DFHEIV0,
  6824           DFHEIV1,
  6825           ORIGINAL-CERTIFICATE,
  6826           DFHEIV11,
  6827           OC-CONTROL-PRIMARY,
  6828           DFHEIV99,
  6829           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 120
* EL6317.cbl
  6830     MOVE EIBRESP  TO WS-RESPONSE
  6831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6832
  6833     display ' just wrote new crto ' ws-response
  6834                           ' ' oc-key-seq-no
  6835     IF RESP-DUPKEY
  6836        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6837        GO TO 0425-WRITE-ELCRTO
  6838     ELSE
  6839        IF NOT RESP-NORMAL
  6840           MOVE -1               TO SIGREQL
  6841           MOVE ER-3830          TO EMI-ERROR
  6842           PERFORM 9900-ERROR-FORMAT
  6843                                 THRU 9900-EXIT
  6844        ELSE
  6845           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6846        END-IF
  6847     END-IF
  6848
  6849     .
  6850 0425-EXIT.
  6851     EXIT.
  6852
  6853 0426-ADD-CERT-NOTES.
  6854
  6855     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6856     SET TB-INDX TO 1
  6857
  6858     IF PI-CERTNT1-ENTERED > SPACES
  6859         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6860         MOVE PI-PROCESSOR-ID    TO
  6861                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6862         MOVE EIBTIME            TO
  6863                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6864         MOVE WS-CURRENT-BIN-DT  TO
  6865                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6866         SET TB-INDX UP BY +1
  6867     END-IF
  6868
  6869     IF PI-CERTNT2-ENTERED > SPACES
  6870         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6871         MOVE PI-PROCESSOR-ID    TO
  6872                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6873         MOVE EIBTIME            TO
  6874                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6875         MOVE WS-CURRENT-BIN-DT  TO
  6876                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6877         SET TB-INDX UP BY +1
  6878     END-IF
  6879
  6880     IF CERT-NOTE-ENTRIES > SPACES
  6881         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6882         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6883     END-IF
  6884
  6885     IF PI-BILLNT1-ENTERED > SPACES
  6886         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6887         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 121
* EL6317.cbl
  6888         MOVE +63 TO WS-LEN
  6889         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6890     END-IF
  6891
  6892     IF PI-BILLNT2-ENTERED > SPACES
  6893         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6894         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  6895         MOVE +63 TO WS-LEN
  6896         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6897     END-IF
  6898
  6899     .
  6900 0426-EXIT.
  6901     EXIT.
  6902
  6903 0427-LOAD-CURRENT-CERT-NOTES.
  6904
  6905     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6906     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6907     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6908     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6909     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6910     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6911     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6912     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6913     MOVE '1'                 TO ERCNOT-REC-TYP
  6914     MOVE +0                  TO ERCNOT-SEQ
  6915     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6916
  6917
  6918* EXEC CICS STARTBR
  6919*         DATASET(WS-ERCNOT-FILE-ID)
  6920*         RIDFLD(ERCNOT-KEY)
  6921*         KEYLENGTH(ERCNOT-START-LENGTH)
  6922*         RESP      (WS-RESPONSE)
  6923*         GENERIC
  6924*         GTEQ
  6925*    END-EXEC.
  6926     MOVE 0
  6927       TO DFHEIV11
  6928*    MOVE '&,   KG    G          &  N#00006648' TO DFHEIV0
  6929     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6930     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6931     MOVE X'204E233030303036363438' TO DFHEIV0(25:11)
  6932     CALL 'kxdfhei1' USING DFHEIV0,
  6933           WS-ERCNOT-FILE-ID,
  6934           ERCNOT-KEY,
  6935           ERCNOT-START-LENGTH,
  6936           DFHEIV11,
  6937           DFHEIV99
  6938     MOVE EIBRESP  TO WS-RESPONSE
  6939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6940
  6941
  6942     IF NOT RESP-NORMAL
  6943        GO TO 0427-ENDBR
  6944     END-IF.
  6945
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 122
* EL6317.cbl
  6946 0427-LOOP.
  6947
  6948* EXEC CICS READNEXT
  6949*         SET(ADDRESS OF CERT-NOTE-FILE)
  6950*         DATASET(WS-ERCNOT-FILE-ID)
  6951*         RIDFLD(ERCNOT-KEY)
  6952*    END-EXEC.
  6953     MOVE 0
  6954       TO DFHEIV11
  6955*    MOVE '&.S                   )   #00006662' TO DFHEIV0
  6956     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6957     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6958     MOVE X'2020233030303036363632' TO DFHEIV0(25:11)
  6959     CALL 'kxdfhei1' USING DFHEIV0,
  6960           WS-ERCNOT-FILE-ID,
  6961           DFHEIV20,
  6962           DFHEIV99,
  6963           ERCNOT-KEY,
  6964           DFHEIV99,
  6965           DFHEIV11,
  6966           DFHEIV99,
  6967           DFHEIV99
  6968     SET ADDRESS OF CERT-NOTE-FILE TO
  6969         DFHEIV20
  6970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6971
  6972
  6973     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6974         GO TO 0427-ENDBR
  6975     END-IF.
  6976
  6977     IF (CZ-CARRIER = SV-CARRIER)
  6978        AND (CZ-GROUPING = SV-GROUPING)
  6979        AND (CZ-STATE = SV-STATE)
  6980        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6981        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6982        AND (CZ-CERT-NO = SV-CERT-NO)
  6983        AND (CZ-RECORD-TYPE = '1')
  6984          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6985          MOVE CZ-LAST-MAINT-USER TO
  6986                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6987          MOVE CZ-LAST-MAINT-DT TO
  6988                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6989          MOVE CZ-LAST-MAINT-HHMMSS TO
  6990                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6991          SET TB-INDX UP BY 1
  6992          GO TO 0427-LOOP
  6993     END-IF.
  6994
  6995 0427-ENDBR.
  6996
  6997
  6998* EXEC CICS ENDBR
  6999*         DATASET(WS-ERCNOT-FILE-ID)
  7000*    END-EXEC.
  7001     MOVE 0
  7002       TO DFHEIV11
  7003*    MOVE '&2                    $   #00006692' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 123
* EL6317.cbl
  7004     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7005     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7006     MOVE X'2020233030303036363932' TO DFHEIV0(25:11)
  7007     CALL 'kxdfhei1' USING DFHEIV0,
  7008           WS-ERCNOT-FILE-ID,
  7009           DFHEIV11,
  7010           DFHEIV99
  7011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7012
  7013
  7014     .
  7015 0427-EXIT.
  7016     EXIT.
  7017
  7018 0430-WRITE-ERENDT.
  7019     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  7020     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  7021     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  7022
  7023* EXEC CICS WRITE
  7024*         DATASET   (WS-ERENDT-FILE-ID)
  7025*         FROM      (ENDORSEMENT-RECORD)
  7026*         RIDFLD    (EN-CONTROL-PRIMARY)
  7027*         RESP      (WS-RESPONSE)
  7028*    END-EXEC
  7029     MOVE LENGTH OF
  7030      ENDORSEMENT-RECORD
  7031       TO DFHEIV11
  7032*    MOVE '&$ L                  ''  N#00006704' TO DFHEIV0
  7033     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7034     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7035     MOVE X'204E233030303036373034' TO DFHEIV0(25:11)
  7036     CALL 'kxdfhei1' USING DFHEIV0,
  7037           WS-ERENDT-FILE-ID,
  7038           ENDORSEMENT-RECORD,
  7039           DFHEIV11,
  7040           EN-CONTROL-PRIMARY,
  7041           DFHEIV99,
  7042           DFHEIV99
  7043     MOVE EIBRESP  TO WS-RESPONSE
  7044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7045     IF RESP-NORMAL
  7046        MOVE 'V'                 TO PI-DOCUMENT-PROCESSED
  7047        display ' good write erendt '
  7048        IF EIBAID = DFHPF4
  7049           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7050           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7051           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7052           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7053        END-IF
  7054     ELSE
  7055        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7056        MOVE -1                  TO CARRL
  7057        MOVE ER-0132             TO EMI-ERROR
  7058        MOVE AL-UABON            TO CARRA
  7059        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7060     END-IF
  7061     .
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 124
* EL6317.cbl
  7062 0430-EXIT.
  7063     EXIT.
  7064 0440-ADD-BILLING-NOTE.
  7065
  7066* EXEC CICS GETMAIN
  7067*         SET      (ADDRESS OF EOB-CODES)
  7068*         LENGTH   (ELEOBC-LENGTH)
  7069*         INITIMG  (GETMAIN-SPACE)
  7070*    END-EXEC
  7071*    MOVE ',"IL                  $   #00006730' TO DFHEIV0
  7072     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7073     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7074     MOVE X'2020233030303036373330' TO DFHEIV0(25:11)
  7075     CALL 'kxdfhei1' USING DFHEIV0,
  7076           DFHEIV20,
  7077           ELEOBC-LENGTH,
  7078           GETMAIN-SPACE
  7079     SET ADDRESS OF EOB-CODES TO
  7080         DFHEIV20
  7081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7082
  7083     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7084     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7085     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7086
  7087
  7088* EXEC CICS STARTBR
  7089*        DATASET   ('ELEOBC')
  7090*        RIDFLD    (WS-ELEOBC-KEY)
  7091*        GTEQ
  7092*        RESP      (WS-RESPONSE)
  7093*    END-EXEC
  7094     MOVE 'ELEOBC' TO DFHEIV1
  7095     MOVE 0
  7096       TO DFHEIV11
  7097*    MOVE '&,         G          &  N#00006740' TO DFHEIV0
  7098     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7099     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7100     MOVE X'204E233030303036373430' TO DFHEIV0(25:11)
  7101     CALL 'kxdfhei1' USING DFHEIV0,
  7102           DFHEIV1,
  7103           WS-ELEOBC-KEY,
  7104           DFHEIV99,
  7105           DFHEIV11,
  7106           DFHEIV99
  7107     MOVE EIBRESP  TO WS-RESPONSE
  7108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7109
  7110     IF NOT RESP-NORMAL
  7111        GO TO 0440-EXIT
  7112     END-IF
  7113      .
  7114 0440-READNEXT-ELEOBC.
  7115
  7116
  7117* EXEC CICS READNEXT
  7118*       INTO    (EOB-CODES)
  7119*       DATASET ('ELEOBC')
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 125
* EL6317.cbl
  7120*       RIDFLD  (WS-ELEOBC-KEY)
  7121*       RESP    (WS-RESPONSE)
  7122*    END-EXEC
  7123     MOVE LENGTH OF
  7124      EOB-CODES
  7125       TO DFHEIV12
  7126     MOVE 'ELEOBC' TO DFHEIV1
  7127     MOVE 0
  7128       TO DFHEIV11
  7129*    MOVE '&.IL                  )  N#00006753' TO DFHEIV0
  7130     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7131     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7132     MOVE X'204E233030303036373533' TO DFHEIV0(25:11)
  7133     CALL 'kxdfhei1' USING DFHEIV0,
  7134           DFHEIV1,
  7135           EOB-CODES,
  7136           DFHEIV12,
  7137           WS-ELEOBC-KEY,
  7138           DFHEIV99,
  7139           DFHEIV11,
  7140           DFHEIV99,
  7141           DFHEIV99
  7142     MOVE EIBRESP  TO WS-RESPONSE
  7143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7144
  7145     IF RESP-NORMAL
  7146         IF EO-RECORD-TYPE NOT = '5'
  7147             GO TO 0440-EXIT
  7148         END-IF
  7149     ELSE
  7150         GO TO 0440-EXIT
  7151     END-IF
  7152
  7153     IF EO-RECORD-TYPE = '5' AND
  7154        EO-EOB-CODE = PI-LTRID-ENTERED
  7155           CONTINUE
  7156     ELSE
  7157         GO TO 0440-READNEXT-ELEOBC
  7158     END-IF
  7159
  7160     MOVE SPACES TO WS-BILLING-NOTE
  7161     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7162     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  7163     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7164     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7165     MOVE +25 TO WS-LEN
  7166
  7167     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7168     .
  7169 0440-EXIT.
  7170     EXIT.
  7171
  7172 0441-UPDATE-BILLING-NOTE.
  7173
  7174
  7175* EXEC CICS GETMAIN
  7176*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7177*         LENGTH   (ERNOTE-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 126
* EL6317.cbl
  7178*         INITIMG  (GETMAIN-SPACE)
  7179*    END-EXEC
  7180*    MOVE ',"IL                  $   #00006789' TO DFHEIV0
  7181     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7182     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7183     MOVE X'2020233030303036373839' TO DFHEIV0(25:11)
  7184     CALL 'kxdfhei1' USING DFHEIV0,
  7185           DFHEIV20,
  7186           ERNOTE-LENGTH,
  7187           GETMAIN-SPACE
  7188     SET ADDRESS OF CERTIFICATE-NOTE TO
  7189         DFHEIV20
  7190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7191
  7192     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7193
  7194
  7195* EXEC CICS READ
  7196*       DATASET    (WS-ERNOTE-FILE-ID)
  7197*       RIDFLD     (WS-ERNOTE-KEY)
  7198*       INTO       (CERTIFICATE-NOTE)
  7199*       RESP       (WS-RESPONSE)
  7200*       UPDATE
  7201*    END-EXEC
  7202     MOVE LENGTH OF
  7203      CERTIFICATE-NOTE
  7204       TO DFHEIV11
  7205*    MOVE '&"IL       EU         (  N#00006797' TO DFHEIV0
  7206     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7207     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7208     MOVE X'204E233030303036373937' TO DFHEIV0(25:11)
  7209     CALL 'kxdfhei1' USING DFHEIV0,
  7210           WS-ERNOTE-FILE-ID,
  7211           CERTIFICATE-NOTE,
  7212           DFHEIV11,
  7213           WS-ERNOTE-KEY,
  7214           DFHEIV99,
  7215           DFHEIV99,
  7216           DFHEIV99
  7217     MOVE EIBRESP  TO WS-RESPONSE
  7218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7219
  7220     IF RESP-NORMAL
  7221       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7222          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7223       END-IF
  7224       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7225          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7226       END-IF
  7227       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7228           (NOTE-SUB > +10) OR
  7229           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7230                             WS-BILLING-NOTE (1:WS-LEN))
  7231       END-PERFORM
  7232       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7233                              WS-BILLING-NOTE (1:WS-LEN)
  7234
  7235* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 127
* EL6317.cbl
  7236*           DATASET    (WS-ERNOTE-FILE-ID)
  7237*        END-EXEC
  7238*    MOVE '&*                    #   #00006819' TO DFHEIV0
  7239     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7240     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7241     MOVE X'2020233030303036383139' TO DFHEIV0(25:11)
  7242     CALL 'kxdfhei1' USING DFHEIV0,
  7243           WS-ERNOTE-FILE-ID,
  7244           DFHEIV99
  7245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7246       ELSE
  7247         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7248           (NOTE-SUB > +10) OR
  7249           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7250         END-PERFORM
  7251         IF (NOTE-SUB < +11)
  7252           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7253              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7254                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7255           ELSE
  7256             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7257              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7258                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7259                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7260             ELSE
  7261               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7262                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7263                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7264                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7265               ELSE
  7266                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7267                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7268                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7269                                       CN-BILLING-START-LINE-NO
  7270                 ELSE
  7271                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7272                 END-IF
  7273               END-IF
  7274             END-IF
  7275           END-IF
  7276           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7277           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7278           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7279
  7280* EXEC CICS REWRITE
  7281*             DATASET    (WS-ERNOTE-FILE-ID)
  7282*             FROM       (CERTIFICATE-NOTE)
  7283*             RESP       (WS-RESPONSE)
  7284*          END-EXEC
  7285     MOVE LENGTH OF
  7286      CERTIFICATE-NOTE
  7287       TO DFHEIV11
  7288*    MOVE '&& L                  %  N#00006855' TO DFHEIV0
  7289     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7290     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7291     MOVE X'204E233030303036383535' TO DFHEIV0(25:11)
  7292     CALL 'kxdfhei1' USING DFHEIV0,
  7293           WS-ERNOTE-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 128
* EL6317.cbl
  7294           CERTIFICATE-NOTE,
  7295           DFHEIV11,
  7296           DFHEIV99
  7297     MOVE EIBRESP  TO WS-RESPONSE
  7298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7299           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7300         END-IF
  7301       END-IF
  7302     ELSE
  7303        MOVE SPACES              TO CERTIFICATE-NOTE
  7304        MOVE 'CN'                TO CN-RECORD-ID
  7305        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7306                                     WS-ERNOTE-KEY
  7307        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7308                                    CN-BILLING-END-LINE-NO
  7309        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7310        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7311        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7312        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7313
  7314* EXEC CICS WRITE
  7315*          DATASET    (WS-ERNOTE-FILE-ID)
  7316*          FROM       (CERTIFICATE-NOTE)
  7317*          RIDFLD     (WS-ERNOTE-KEY)
  7318*          RESP       (WS-RESPONSE)
  7319*       END-EXEC
  7320     MOVE LENGTH OF
  7321      CERTIFICATE-NOTE
  7322       TO DFHEIV11
  7323*    MOVE '&$ L                  ''  N#00006874' TO DFHEIV0
  7324     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7325     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7326     MOVE X'204E233030303036383734' TO DFHEIV0(25:11)
  7327     CALL 'kxdfhei1' USING DFHEIV0,
  7328           WS-ERNOTE-FILE-ID,
  7329           CERTIFICATE-NOTE,
  7330           DFHEIV11,
  7331           WS-ERNOTE-KEY,
  7332           DFHEIV99,
  7333           DFHEIV99
  7334     MOVE EIBRESP  TO WS-RESPONSE
  7335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7336
  7337        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7338     END-IF
  7339
  7340     .
  7341 0441-EXIT.
  7342     EXIT.
  7343
  7344
  7345 0442-SQUEEZE-IT-IN.
  7346
  7347     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7348        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7349           NOTE-SUB = +10
  7350           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7351           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 129
* EL6317.cbl
  7352             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7353             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7354             MOVE +9 TO NOTE-SUB
  7355           END-IF
  7356        END-PERFORM
  7357     ELSE
  7358        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7359           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7360             UNTIL NOTE-SUB = +1
  7361             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7362             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7363                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7364                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7365                MOVE +2          TO NOTE-SUB
  7366             END-IF
  7367           END-PERFORM
  7368        END-IF
  7369     END-IF
  7370
  7371     .
  7372 0442-EXIT.
  7373     EXIT.
  7374
  7375 0445-CERTIFICATE-UPDATE.
  7376    display 'billing note written, updating cert'
  7377     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7378     IF RESP-NORMAL
  7379        EVALUATE CM-NOTE-SW
  7380           WHEN '2'
  7381           WHEN '3'
  7382           WHEN '6'
  7383           WHEN '7'
  7384              SET NO-CERT-RW     TO TRUE
  7385           WHEN ' '
  7386              MOVE '2'           TO CM-NOTE-SW
  7387           WHEN '1'
  7388              MOVE '3'           TO CM-NOTE-SW
  7389           WHEN '4'
  7390              MOVE '6'           TO CM-NOTE-SW
  7391           WHEN '5'
  7392              MOVE '7'           TO CM-NOTE-SW
  7393        END-EVALUATE
  7394     END-IF
  7395     IF NOT NO-CERT-RW
  7396        PERFORM 1810-REWRITE-ELCERT
  7397                                 THRU 1810-EXIT
  7398     ELSE
  7399
  7400* EXEC CICS UNLOCK
  7401*          DATASET    (WS-ELCERT-FILE-ID)
  7402*       END-EXEC
  7403*    MOVE '&*                    #   #00006943' TO DFHEIV0
  7404     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7405     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7406     MOVE X'2020233030303036393433' TO DFHEIV0(25:11)
  7407     CALL 'kxdfhei1' USING DFHEIV0,
  7408           WS-ELCERT-FILE-ID,
  7409           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 130
* EL6317.cbl
  7410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7411     END-IF
  7412
  7413     .
  7414 0445-EXIT.
  7415     EXIT.
  7416
  7417 0500-CREATE-TEMP-STORAGE.
  7418     display ' about to write pi ' program-interface-block
  7419
  7420* EXEC CICS WRITEQ TS
  7421*        QUEUE (QID)
  7422*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7423*        LENGTH(PI-COMM-LENGTH)
  7424*    END-EXEC
  7425*    MOVE '*"                    ''   #00006954' TO DFHEIV0
  7426     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7427     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7428     MOVE X'2020233030303036393534' TO DFHEIV0(25:11)
  7429     CALL 'kxdfhei1' USING DFHEIV0,
  7430           QID,
  7431           PROGRAM-INTERFACE-BLOCK,
  7432           PI-COMM-LENGTH,
  7433           DFHEIV99,
  7434           DFHEIV99,
  7435           DFHEIV99
  7436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7437     display ' about to write map ' el631ji
  7438
  7439* EXEC CICS WRITEQ TS
  7440*        QUEUE (QID)
  7441*        FROM  (EL631JI)
  7442*        LENGTH(MAP-LENGTH)
  7443*    END-EXEC.
  7444*    MOVE '*"                    ''   #00006960' TO DFHEIV0
  7445     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7446     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7447     MOVE X'2020233030303036393630' TO DFHEIV0(25:11)
  7448     CALL 'kxdfhei1' USING DFHEIV0,
  7449           QID,
  7450           EL631JI,
  7451           MAP-LENGTH,
  7452           DFHEIV99,
  7453           DFHEIV99,
  7454           DFHEIV99
  7455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7456
  7457 0500-EXIT.
  7458      EXIT.
  7459 0600-RECOVER-TEMP-STORAGE.
  7460     display ' about to recover pi '
  7461
  7462* EXEC CICS READQ TS
  7463*        QUEUE (QID)
  7464*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7465*        LENGTH(PI-COMM-LENGTH)
  7466*    END-EXEC
  7467*    MOVE '*$I    L              ''   #00006969' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 131
* EL6317.cbl
  7468     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7469     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7470     MOVE X'2020233030303036393639' TO DFHEIV0(25:11)
  7471     CALL 'kxdfhei1' USING DFHEIV0,
  7472           QID,
  7473           PROGRAM-INTERFACE-BLOCK,
  7474           PI-COMM-LENGTH,
  7475           DFHEIV99,
  7476           DFHEIV99,
  7477           DFHEIV99
  7478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7479     display ' pi ' pi-program-work-area
  7480     display ' about to recover map '
  7481
  7482* EXEC CICS READQ TS
  7483*        QUEUE (QID)
  7484*        INTO  (EL631JI)
  7485*        LENGTH(MAP-LENGTH)
  7486*    END-EXEC
  7487*    MOVE '*$I    L              ''   #00006976' TO DFHEIV0
  7488     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7489     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7490     MOVE X'2020233030303036393736' TO DFHEIV0(25:11)
  7491     CALL 'kxdfhei1' USING DFHEIV0,
  7492           QID,
  7493           EL631JI,
  7494           MAP-LENGTH,
  7495           DFHEIV99,
  7496           DFHEIV99,
  7497           DFHEIV99
  7498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7499     display ' map ' el631ji
  7500     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7501     MOVE AL-UANON            TO SIGREQA
  7502     MOVE AL-UANON            TO LTRIDA
  7503     IF WS-SET-CODES-MDT = 'Y'
  7504        move +1                  to s2
  7505        perform varying s1 from +1 by +5 until s1 > +60
  7506           MOVE WS-PASSED-REASON-CODES (s1:4)
  7507                                 TO reacd-in (s2)
  7508           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7509               MOVE AL-SANON     TO REACDA (S2)
  7510               MOVE +4           TO REACDL (S2)
  7511           END-IF
  7512           add +1                to s2
  7513        end-perform
  7514        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7515     END-IF
  7516
  7517     IF ENCCODEI > SPACES
  7518         MOVE AL-UANON       TO ENCCODEA
  7519     END-IF
  7520
  7521     IF CRTNT1I > SPACES
  7522         MOVE AL-UANON       TO CRTNT1A
  7523     END-IF
  7524
  7525     IF CRTNT2I > SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 132
* EL6317.cbl
  7526         MOVE AL-UANON       TO CRTNT2A
  7527     END-IF
  7528
  7529     IF BILNT1I > SPACES
  7530         MOVE AL-UANON       TO BILNT1A
  7531     END-IF
  7532     .
  7533 0600-EXIT.
  7534      EXIT.
  7535 0800-DELETE-TS.
  7536
  7537* EXEC CICS DELETEQ TS
  7538*        QUEUE(QID)
  7539*    END-EXEC
  7540*    MOVE '*&                    #   #00007018' TO DFHEIV0
  7541     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7542     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7543     MOVE X'2020233030303037303138' TO DFHEIV0(25:11)
  7544     CALL 'kxdfhei1' USING DFHEIV0,
  7545           QID,
  7546           DFHEIV99
  7547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7548     .
  7549 0800-EXIT.
  7550      EXIT.
  7551 1000-BUILD-ERARCH.
  7552     display ' made it to 1000 '
  7553     MOVE SPACES                 TO W-CNTL-KEY
  7554     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7555     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7556     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7557
  7558* EXEC CICS READ
  7559*         DATASET    (WS-ELCNTL-FILE-ID)
  7560*         SET        (ADDRESS OF CONTROL-FILE)
  7561*         RIDFLD     (W-CNTL-KEY)
  7562*         UPDATE
  7563*         RESP       (WS-RESPONSE)
  7564*    END-EXEC
  7565*    MOVE '&"S        EU         (  N#00007030' TO DFHEIV0
  7566     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7567     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7568     MOVE X'204E233030303037303330' TO DFHEIV0(25:11)
  7569     CALL 'kxdfhei1' USING DFHEIV0,
  7570           WS-ELCNTL-FILE-ID,
  7571           DFHEIV20,
  7572           DFHEIV99,
  7573           W-CNTL-KEY,
  7574           DFHEIV99,
  7575           DFHEIV99,
  7576           DFHEIV99
  7577     SET ADDRESS OF CONTROL-FILE TO
  7578         DFHEIV20
  7579     MOVE EIBRESP  TO WS-RESPONSE
  7580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7581     IF RESP-NORMAL
  7582        display ' good read elcntl '
  7583        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 133
* EL6317.cbl
  7584           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7585        END-IF
  7586        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7587        MOVE CF-CREDIT-LAST-ARCH-NUM
  7588                                 TO W-ARCH-NUMBER
  7589
  7590* EXEC CICS REWRITE
  7591*          FROM      (CONTROL-FILE)
  7592*          DATASET   (WS-ELCNTL-FILE-ID)
  7593*       END-EXEC
  7594     MOVE LENGTH OF
  7595      CONTROL-FILE
  7596       TO DFHEIV11
  7597*    MOVE '&& L                  %   #00007045' TO DFHEIV0
  7598     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7599     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7600     MOVE X'2020233030303037303435' TO DFHEIV0(25:11)
  7601     CALL 'kxdfhei1' USING DFHEIV0,
  7602           WS-ELCNTL-FILE-ID,
  7603           CONTROL-FILE,
  7604           DFHEIV11,
  7605           DFHEIV99
  7606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7607     END-IF
  7608
  7609* EXEC CICS GETMAIN
  7610*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7611*       LENGTH   (W-ARCH-LENGTH)
  7612*    END-EXEC
  7613*    MOVE '," L                  $   #00007050' TO DFHEIV0
  7614     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7615     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7616     MOVE X'2020233030303037303530' TO DFHEIV0(25:11)
  7617     CALL 'kxdfhei1' USING DFHEIV0,
  7618           DFHEIV20,
  7619           W-ARCH-LENGTH,
  7620           DFHEIV99
  7621     SET ADDRESS OF LETTER-ARCHIVE TO
  7622         DFHEIV20
  7623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7624     MOVE 'LA'                   TO LETTER-ARCHIVE
  7625     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7626                                    LA-ARCHIVE-NO-A2
  7627                                    LA-ARCHIVE-NO-A3
  7628                                    LA-ARCHIVE-NO-A4
  7629                                    LA-ARCHIVE-NO-A5
  7630                                    LA-ARCHIVE-NO-A6
  7631     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7632                                    LA-COMPANY-CD-A2
  7633                                    LA-COMPANY-CD-A3
  7634                                    LA-COMPANY-CD-A4
  7635                                    LA-COMPANY-CD-A5
  7636                                    LA-COMPANY-CD-A6
  7637     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7638                                    LA-CARRIER-A3
  7639                                    LA-CARRIER-A4
  7640                                    LA-CARRIER-A5
  7641     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 134
* EL6317.cbl
  7642     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7643                                    LA-GROUPING-A3
  7644                                    LA-GROUPING-A4
  7645                                    LA-GROUPING-A5
  7646     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7647                                    LA-ACCOUNT-A3
  7648                                    LA-ACCOUNT-A4
  7649                                    LA-ACCOUNT-A5
  7650     MOVE PB-STATE               TO LA-STATE-A2
  7651                                    LA-STATE-A3
  7652                                    LA-STATE-A4
  7653                                    LA-STATE-A5
  7654     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7655     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7656     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7657     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7658     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7659                                    LA-INITIAL-PRINT-DATE
  7660                                    LA-SENT-DATE
  7661                                    LA-REPLY-DATE
  7662                                    LA-RESEND-DATE
  7663                                    LA-FOLLOW-UP-DATE
  7664     MOVE 'A'                    TO LA-STATUS
  7665     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7666     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7667     MOVE LTRIDI                 TO LA-FORM-A3
  7668     MOVE '4'                    TO LA-DATA-SOURCE
  7669     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7670     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7671                                    LA-NO-OF-TEXT-RECORDS
  7672
  7673* EXEC CICS WRITE
  7674*         DATASET   ('ERARCH')
  7675*         FROM      (LETTER-ARCHIVE)
  7676*         RIDFLD    (LA-CONTROL-PRIMARY)
  7677*         RESP      (WS-RESPONSE)
  7678*    END-EXEC
  7679     MOVE LENGTH OF
  7680      LETTER-ARCHIVE
  7681       TO DFHEIV11
  7682     MOVE 'ERARCH' TO DFHEIV1
  7683*    MOVE '&$ L                  ''  N#00007102' TO DFHEIV0
  7684     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7685     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7686     MOVE X'204E233030303037313032' TO DFHEIV0(25:11)
  7687     CALL 'kxdfhei1' USING DFHEIV0,
  7688           DFHEIV1,
  7689           LETTER-ARCHIVE,
  7690           DFHEIV11,
  7691           LA-CONTROL-PRIMARY,
  7692           DFHEIV99,
  7693           DFHEIV99
  7694     MOVE EIBRESP  TO WS-RESPONSE
  7695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7696     IF RESP-NORMAL
  7697        display ' good write erarch '
  7698        MOVE ER-0280             TO EMI-ERROR
  7699        MOVE -1                  TO SIGREQL
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 135
* EL6317.cbl
  7700        PERFORM 9900-ERROR-FORMAT
  7701                                 THRU 9900-EXIT
  7702        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  7703        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7704     ELSE
  7705        MOVE ER-7345             TO EMI-ERROR
  7706        MOVE -1                  TO SIGREQL
  7707        PERFORM 9900-ERROR-FORMAT
  7708                                 THRU 9900-EXIT
  7709     END-IF
  7710     .
  7711 1000-EXIT.
  7712     EXIT.
  7713 1100-CALL-NS-BUS-LOGIC.
  7714     DISPLAY ' MADE IT TO 1100 '
  7715     MOVE SPACES                 TO BL-INPUT
  7716     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7717     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  7718       OR 'EL6314'
  7719         MOVE '2'                TO BL-DATA-SRCE
  7720         MOVE SPACES             TO BL-BATCH-NO
  7721         MOVE ZEROS              TO BL-BATCH-SEQ
  7722     ELSE
  7723         MOVE '4'                TO BL-DATA-SRCE
  7724         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  7725         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  7726     END-IF
  7727     MOVE PI-CARRIER             TO BL-CARRIER
  7728     MOVE PI-GROUPING            TO BL-GROUP
  7729     MOVE PI-STATE               TO BL-STATE
  7730     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  7731     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  7732        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  7733        MOVE ' '                 TO DC-OPTION-CODE
  7734        PERFORM 9700-date-link
  7735        IF NO-CONVERSION-ERROR
  7736           MOVE DC-GREG-DATE-1-EDIT
  7737                                 TO BL-EFF-DT
  7738        END-IF
  7739     END-IF
  7740     MOVE PI-CERT-NO             TO BL-CERT-NO
  7741     MOVE SPACES                 TO BL-RESP-NO
  7742     MOVE LTRIDI                 TO BL-LETTER-ID
  7743     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7744     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7745     MOVE 'CrtVerif'               TO BL-FUNC
  7746*    MOVE 'ALWA'                 TO BL-PROC-ID
  7747     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7748*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7749*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7750     MOVE PI-ENCCODE             TO BL-ENC-CD
  7751     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7752     MOVE 'VERIFY  '             TO BL-SOURCE-SCREEN
  7753     IF EIBAID = DFHPF4
  7754        MOVE 'B'                 TO BL-WRITE-ERARCH
  7755     ELSE
  7756        MOVE 'T'                 TO BL-WRITE-ERARCH
  7757     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 136
* EL6317.cbl
  7758     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7759        MOVE REACD-IN (S1)       TO BL-REASON-CODE (S1)
  7760     END-PERFORM
  7761    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7762*****************************************
  7763* Invoke the LETTER business logic
  7764*****************************************
  7765
  7766* exec cics link
  7767*       program('NSRASBL')
  7768*       commarea(srch-commarea)
  7769*    end-exec.
  7770     MOVE LENGTH OF
  7771      srch-commarea
  7772       TO DFHEIV11
  7773     MOVE 'NSRASBL' TO DFHEIV1
  7774*    MOVE '."C                   (   #00007177' TO DFHEIV0
  7775     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7776     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7777     MOVE X'2020233030303037313737' TO DFHEIV0(25:11)
  7778     CALL 'kxdfhei1' USING DFHEIV0,
  7779           DFHEIV1,
  7780           srch-commarea,
  7781           DFHEIV11,
  7782           DFHEIV99,
  7783           DFHEIV99,
  7784           DFHEIV99,
  7785           DFHEIV99
  7786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7787
  7788     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7789        BL-MESSAGE
  7790     .
  7791 1100-EXIT.
  7792     EXIT.
  7793 1500-GET-ARCH-NO.
  7794     display ' made it to 1500 '
  7795     MOVE SPACES                 TO ELCNTL-KEY
  7796     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7797     MOVE '1'                    TO CNTL-REC-TYPE
  7798     MOVE ZEROS                  TO CNTL-SEQ
  7799
  7800* EXEC CICS READ
  7801*         DATASET    (WS-ELCNTL-FILE-ID)
  7802*         SET        (ADDRESS OF CONTROL-FILE)
  7803*         RIDFLD     (ELCNTL-KEY)
  7804*         UPDATE
  7805*         RESP       (WS-RESPONSE)
  7806*    END-EXEC
  7807*    MOVE '&"S        EU         (  N#00007192' TO DFHEIV0
  7808     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7809     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7810     MOVE X'204E233030303037313932' TO DFHEIV0(25:11)
  7811     CALL 'kxdfhei1' USING DFHEIV0,
  7812           WS-ELCNTL-FILE-ID,
  7813           DFHEIV20,
  7814           DFHEIV99,
  7815           ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 137
* EL6317.cbl
  7816           DFHEIV99,
  7817           DFHEIV99,
  7818           DFHEIV99
  7819     SET ADDRESS OF CONTROL-FILE TO
  7820         DFHEIV20
  7821     MOVE EIBRESP  TO WS-RESPONSE
  7822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7823     IF RESP-NORMAL
  7824        display ' good read elcntl '
  7825        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7826           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7827        END-IF
  7828        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7829        MOVE CF-CREDIT-LAST-ARCH-NUM
  7830                                 TO W-ARCH-NUMBER
  7831        display ' new arch number ' w-arch-number
  7832
  7833* EXEC CICS REWRITE
  7834*          FROM      (CONTROL-FILE)
  7835*          DATASET   (WS-ELCNTL-FILE-ID)
  7836*       END-EXEC
  7837     MOVE LENGTH OF
  7838      CONTROL-FILE
  7839       TO DFHEIV11
  7840*    MOVE '&& L                  %   #00007208' TO DFHEIV0
  7841     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7842     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7843     MOVE X'2020233030303037323038' TO DFHEIV0(25:11)
  7844     CALL 'kxdfhei1' USING DFHEIV0,
  7845           WS-ELCNTL-FILE-ID,
  7846           CONTROL-FILE,
  7847           DFHEIV11,
  7848           DFHEIV99
  7849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7850     END-IF
  7851     .
  7852 1500-EXIT.
  7853     EXIT.
  7854
  7855
  7856 1700-WRITE-CERT-NOTE      SECTION.
  7857
  7858
  7859     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7860     MOVE ZERO           TO ERCNOT-SEQ.
  7861     SET TB-INDX         DOWN BY 1.
  7862     SET TB-INDX1        TO TB-INDX.
  7863
  7864****DELETE CURRENT CERT NOTES
  7865 1700-LOOP.
  7866
  7867* EXEC CICS READ
  7868*        DATASET (WS-ERCNOT-FILE-ID)
  7869*        RIDFLD  (ERCNOT-KEY)
  7870*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7871*        RESP    (WS-RESPONSE)
  7872*        GTEQ
  7873*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 138
* EL6317.cbl
  7874*    MOVE '&"S        G          (  N#00007228' TO DFHEIV0
  7875     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7877     MOVE X'204E233030303037323238' TO DFHEIV0(25:11)
  7878     CALL 'kxdfhei1' USING DFHEIV0,
  7879           WS-ERCNOT-FILE-ID,
  7880           DFHEIV20,
  7881           DFHEIV99,
  7882           ERCNOT-KEY,
  7883           DFHEIV99,
  7884           DFHEIV99,
  7885           DFHEIV99
  7886     SET ADDRESS OF CERT-NOTE-FILE TO
  7887         DFHEIV20
  7888     MOVE EIBRESP  TO WS-RESPONSE
  7889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7890
  7891
  7892     IF NOT RESP-NORMAL
  7893        GO TO 1700-ENDDEL
  7894     END-IF
  7895
  7896     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7897
  7898     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7899         GO TO 1700-ENDDEL
  7900     END-IF.
  7901
  7902
  7903* EXEC CICS DELETE
  7904*        DATASET (WS-ERCNOT-FILE-ID)
  7905*        RIDFLD  (ERCNOT-KEY)
  7906*    END-EXEC.
  7907*    MOVE '&(  R                 &   #00007246' TO DFHEIV0
  7908     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7909     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7910     MOVE X'2020233030303037323436' TO DFHEIV0(25:11)
  7911     CALL 'kxdfhei1' USING DFHEIV0,
  7912           WS-ERCNOT-FILE-ID,
  7913           ERCNOT-KEY,
  7914           DFHEIV99,
  7915           DFHEIV99,
  7916           DFHEIV99
  7917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7918
  7919
  7920     GO TO 1700-LOOP.
  7921
  7922 1700-ENDDEL.
  7923
  7924
  7925* EXEC CICS GETMAIN
  7926*         LENGTH(ERCNOT-LENGTH)
  7927*         SET(ADDRESS OF CERT-NOTE-FILE)
  7928*         INITIMG(GETMAIN-SPACE)
  7929*    END-EXEC.
  7930*    MOVE ',"IL                  $   #00007255' TO DFHEIV0
  7931     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 139
* EL6317.cbl
  7932     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7933     MOVE X'2020233030303037323535' TO DFHEIV0(25:11)
  7934     CALL 'kxdfhei1' USING DFHEIV0,
  7935           DFHEIV20,
  7936           ERCNOT-LENGTH,
  7937           GETMAIN-SPACE
  7938     SET ADDRESS OF CERT-NOTE-FILE TO
  7939         DFHEIV20
  7940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7941
  7942
  7943     SET TB-INDX TO 1.
  7944     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  7945     MOVE +0             TO ERCNOT-SEQ
  7946
  7947     PERFORM VARYING TB-INDX FROM 1 BY 1
  7948             UNTIL TB-INDX > TB-INDX1
  7949        MOVE SPACES                 TO  CERT-NOTE-FILE
  7950        ADD 1                       TO  ERCNOT-SEQ
  7951        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  7952        MOVE  'CZ'                  TO  CZ-RECORD-ID
  7953        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  7954        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  7955                                    TO  CZ-LAST-MAINT-USER
  7956        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7957                                    TO  CZ-LAST-MAINT-HHMMSS
  7958        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  7959                                    TO  CZ-LAST-MAINT-DT
  7960
  7961
  7962* EXEC CICS WRITE
  7963*            DATASET(WS-ERCNOT-FILE-ID)
  7964*            FROM(CERT-NOTE-FILE)
  7965*            RIDFLD(ERCNOT-KEY)
  7966*       END-EXEC
  7967     MOVE LENGTH OF
  7968      CERT-NOTE-FILE
  7969       TO DFHEIV11
  7970*    MOVE '&$ L                  ''   #00007279' TO DFHEIV0
  7971     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7972     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7973     MOVE X'2020233030303037323739' TO DFHEIV0(25:11)
  7974     CALL 'kxdfhei1' USING DFHEIV0,
  7975           WS-ERCNOT-FILE-ID,
  7976           CERT-NOTE-FILE,
  7977           DFHEIV11,
  7978           ERCNOT-KEY,
  7979           DFHEIV99,
  7980           DFHEIV99
  7981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7982     END-PERFORM
  7983
  7984     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7985     IF RESP-NORMAL
  7986        EVALUATE CM-NOTE-SW
  7987           WHEN '1'
  7988           WHEN '3'
  7989           WHEN '5'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 140
* EL6317.cbl
  7990           WHEN '7'
  7991              SET NO-CERT-RW     TO TRUE
  7992           WHEN ' '
  7993              MOVE '1'           TO CM-NOTE-SW
  7994           WHEN '2'
  7995              MOVE '3'           TO CM-NOTE-SW
  7996           WHEN '4'
  7997              MOVE '5'           TO CM-NOTE-SW
  7998           WHEN '6'
  7999              MOVE '7'           TO CM-NOTE-SW
  8000        END-EVALUATE
  8001     END-IF
  8002     IF NOT NO-CERT-RW
  8003        PERFORM 1810-REWRITE-ELCERT
  8004                                 THRU 1810-EXIT
  8005     ELSE
  8006
  8007* EXEC CICS UNLOCK
  8008*          DATASET    (WS-ELCERT-FILE-ID)
  8009*       END-EXEC
  8010*    MOVE '&*                    #   #00007308' TO DFHEIV0
  8011     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8012     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8013     MOVE X'2020233030303037333038' TO DFHEIV0(25:11)
  8014     CALL 'kxdfhei1' USING DFHEIV0,
  8015           WS-ELCERT-FILE-ID,
  8016           DFHEIV99
  8017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8018     END-IF
  8019
  8020     .
  8021 1799-EXIT.
  8022     EXIT.
  8023
  8024 1800-READ-ELCERT-UPDATE.
  8025
  8026     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8027     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8028     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8029     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8030     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8031     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8032     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8033     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8034
  8035
  8036* EXEC CICS READ
  8037*        UPDATE
  8038*        DATASET  (WS-ELCERT-FILE-ID)
  8039*        RIDFLD   (WS-ELCERT-KEY)
  8040*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8041*        RESP     (WS-RESPONSE)
  8042*    END-EXEC
  8043*    MOVE '&"S        EU         (  N#00007328' TO DFHEIV0
  8044     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8045     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8046     MOVE X'204E233030303037333238' TO DFHEIV0(25:11)
  8047     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 141
* EL6317.cbl
  8048           WS-ELCERT-FILE-ID,
  8049           DFHEIV20,
  8050           DFHEIV99,
  8051           WS-ELCERT-KEY,
  8052           DFHEIV99,
  8053           DFHEIV99,
  8054           DFHEIV99
  8055     SET ADDRESS OF CERTIFICATE-MASTER TO
  8056         DFHEIV20
  8057     MOVE EIBRESP  TO WS-RESPONSE
  8058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8059
  8060     .
  8061 1800-EXIT.
  8062     EXIT.
  8063
  8064 1810-REWRITE-ELCERT.
  8065
  8066
  8067* EXEC CICS REWRITE
  8068*        FROM     (CERTIFICATE-MASTER)
  8069*        DATASET  (WS-ELCERT-FILE-ID)
  8070*        RESP     (WS-RESPONSE)
  8071*    END-EXEC.
  8072     MOVE LENGTH OF
  8073      CERTIFICATE-MASTER
  8074       TO DFHEIV11
  8075*    MOVE '&& L                  %  N#00007342' TO DFHEIV0
  8076     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8077     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8078     MOVE X'204E233030303037333432' TO DFHEIV0(25:11)
  8079     CALL 'kxdfhei1' USING DFHEIV0,
  8080           WS-ELCERT-FILE-ID,
  8081           CERTIFICATE-MASTER,
  8082           DFHEIV11,
  8083           DFHEIV99
  8084     MOVE EIBRESP  TO WS-RESPONSE
  8085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8086
  8087
  8088     .
  8089 1810-EXIT.
  8090     EXIT.
  8091
  8092 8100-SEND-INITIAL-MAP.
  8093     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8094     MOVE '5'                    TO DC-OPTION-CODE.
  8095     PERFORM 9700-DATE-LINK.
  8096     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8097     MOVE EIBTIME                TO TIME-IN.
  8098     MOVE TIME-OUT               TO TIMEO.
  8099     MOVE -1                     TO SIGREQL.
  8100     IF PI-PROCESSOR-IS-CSR-SUPER
  8101        perform varying s1 from +1 by +1 until
  8102           s1 > +12
  8103           MOVE AL-UANON            TO reacda (s1)
  8104        end-perform
  8105     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 142
* EL6317.cbl
  8106     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8107     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8108
  8109* EXEC CICS SEND
  8110*        MAP      (MAP-NAME)
  8111*        MAPSET   (MAPSET-NAME)
  8112*        FROM     (EL631JO)
  8113*        ERASE
  8114*        CURSOR
  8115*    END-EXEC.
  8116     MOVE LENGTH OF
  8117      EL631JO
  8118       TO DFHEIV12
  8119     MOVE -1
  8120       TO DFHEIV11
  8121*    MOVE '8$     CT  E    H L F ,   #00007368' TO DFHEIV0
  8122     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8123     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8124     MOVE X'2020233030303037333638' TO DFHEIV0(25:11)
  8125     CALL 'kxdfhei1' USING DFHEIV0,
  8126           MAP-NAME,
  8127           EL631JO,
  8128           DFHEIV12,
  8129           MAPSET-NAME,
  8130           DFHEIV99,
  8131           DFHEIV99,
  8132           DFHEIV99,
  8133           DFHEIV11,
  8134           DFHEIV99,
  8135           DFHEIV99,
  8136           DFHEIV99
  8137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8138
  8139     GO TO 9100-RETURN-TRAN.
  8140 8200-SEND-DATAONLY.
  8141     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8142     MOVE '5'                    TO DC-OPTION-CODE.
  8143     PERFORM 9700-DATE-LINK.
  8144     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8145     MOVE EIBTIME                TO TIME-IN.
  8146     MOVE TIME-OUT               TO TIMEO.
  8147     MOVE -1                     TO PFENTRL
  8148     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8149     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8150
  8151* EXEC CICS SEND
  8152*        MAP      (MAP-NAME)
  8153*        MAPSET   (MAPSET-NAME)
  8154*        FROM     (EL631JO)
  8155*        DATAONLY
  8156*        ERASEAUP
  8157*        CURSOR
  8158*    END-EXEC.
  8159     MOVE LENGTH OF
  8160      EL631JO
  8161       TO DFHEIV12
  8162     MOVE -1
  8163       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 143
* EL6317.cbl
  8164*    MOVE '8$D    CT  A    H L F ,   #00007386' TO DFHEIV0
  8165     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8166     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8167     MOVE X'2020233030303037333836' TO DFHEIV0(25:11)
  8168     CALL 'kxdfhei1' USING DFHEIV0,
  8169           MAP-NAME,
  8170           EL631JO,
  8171           DFHEIV12,
  8172           MAPSET-NAME,
  8173           DFHEIV99,
  8174           DFHEIV99,
  8175           DFHEIV99,
  8176           DFHEIV11,
  8177           DFHEIV99,
  8178           DFHEIV99,
  8179           DFHEIV99
  8180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8181
  8182     GO TO 9100-RETURN-TRAN.
  8183 8300-SEND-TEXT.
  8184
  8185* EXEC CICS SEND TEXT
  8186*        FROM     (LOGOFF-TEXT)
  8187*        LENGTH   (LOGOFF-LENGTH)
  8188*        ERASE
  8189*        FREEKB
  8190*    END-EXEC.
  8191*    MOVE '8&      T  E F  H   F -   #00007396' TO DFHEIV0
  8192     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8193     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8194     MOVE X'2020233030303037333936' TO DFHEIV0(25:11)
  8195     CALL 'kxdfhei1' USING DFHEIV0,
  8196           LOGOFF-TEXT,
  8197           LOGOFF-LENGTH,
  8198           DFHEIV99,
  8199           DFHEIV99,
  8200           DFHEIV99,
  8201           DFHEIV99,
  8202           DFHEIV99,
  8203           DFHEIV99,
  8204           DFHEIV99,
  8205           DFHEIV99,
  8206           DFHEIV99,
  8207           DFHEIV99
  8208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8209
  8210
  8211* EXEC CICS RETURN
  8212*    END-EXEC.
  8213*    MOVE '.(                    ''   #00007402' TO DFHEIV0
  8214     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8215     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8216     MOVE X'2020233030303037343032' TO DFHEIV0(25:11)
  8217     CALL 'kxdfhei1' USING DFHEIV0,
  8218           DFHEIV99,
  8219           DFHEIV99,
  8220           DFHEIV99,
  8221           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 144
* EL6317.cbl
  8222           DFHEIV99,
  8223           DFHEIV99
  8224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8225
  8226 8800-UNAUTHORIZED-ACCESS.
  8227     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8228     GO TO 8300-SEND-TEXT.
  8229 8810-PF23.
  8230     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8231     MOVE XCTL-005               TO PGM-NAME.
  8232     GO TO 9300-XCTL.
  8233 9000-RETURN-CICS.
  8234
  8235* EXEC CICS RETURN
  8236*    END-EXEC.
  8237*    MOVE '.(                    ''   #00007412' TO DFHEIV0
  8238     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8239     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8240     MOVE X'2020233030303037343132' TO DFHEIV0(25:11)
  8241     CALL 'kxdfhei1' USING DFHEIV0,
  8242           DFHEIV99,
  8243           DFHEIV99,
  8244           DFHEIV99,
  8245           DFHEIV99,
  8246           DFHEIV99,
  8247           DFHEIV99
  8248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8249
  8250 9100-RETURN-TRAN.
  8251     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8252     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8253
  8254* EXEC CICS RETURN
  8255*        TRANSID    (TRANS-ID)
  8256*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8257*        LENGTH     (PI-COMM-LENGTH)
  8258*    END-EXEC.
  8259*    MOVE '.(CT                  ''   #00007417' TO DFHEIV0
  8260     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8261     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8262     MOVE X'2020233030303037343137' TO DFHEIV0(25:11)
  8263     CALL 'kxdfhei1' USING DFHEIV0,
  8264           TRANS-ID,
  8265           PROGRAM-INTERFACE-BLOCK,
  8266           PI-COMM-LENGTH,
  8267           DFHEIV99,
  8268           DFHEIV99,
  8269           DFHEIV99
  8270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8271
  8272 9200-RETURN-MAIN-MENU.
  8273     MOVE XCTL-626               TO PGM-NAME.
  8274     GO TO 9300-XCTL.
  8275 9300-XCTL.
  8276
  8277* EXEC CICS XCTL
  8278*        PROGRAM    (PGM-NAME)
  8279*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 145
* EL6317.cbl
  8280*        LENGTH     (PI-COMM-LENGTH)
  8281*    END-EXEC.
  8282*    MOVE '.$C                   %   #00007426' TO DFHEIV0
  8283     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8284     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8285     MOVE X'2020233030303037343236' TO DFHEIV0(25:11)
  8286     CALL 'kxdfhei1' USING DFHEIV0,
  8287           PGM-NAME,
  8288           PROGRAM-INTERFACE-BLOCK,
  8289           PI-COMM-LENGTH,
  8290           DFHEIV99
  8291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8292
  8293 9400-CLEAR.
  8294     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8295
  8296* EXEC CICS XCTL
  8297*        PROGRAM    (PGM-NAME)
  8298*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8299*        LENGTH     (PI-COMM-LENGTH)
  8300*    END-EXEC.
  8301*    MOVE '.$C                   %   #00007433' TO DFHEIV0
  8302     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8303     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8304     MOVE X'2020233030303037343333' TO DFHEIV0(25:11)
  8305     CALL 'kxdfhei1' USING DFHEIV0,
  8306           PGM-NAME,
  8307           PROGRAM-INTERFACE-BLOCK,
  8308           PI-COMM-LENGTH,
  8309           DFHEIV99
  8310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8311
  8312 9500-PF12.
  8313     MOVE XCTL-010               TO PGM-NAME.
  8314     GO TO 9300-XCTL.
  8315 9600-PGMID-ERROR.
  8316
  8317* EXEC CICS HANDLE CONDITION
  8318*        PGMIDERR    (8300-SEND-TEXT)
  8319*    END-EXEC.
  8320*    MOVE '"$L                   ! " #00007442' TO DFHEIV0
  8321     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8323     MOVE X'2220233030303037343432' TO DFHEIV0(25:11)
  8324     CALL 'kxdfhei1' USING DFHEIV0
  8325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8326
  8327     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8328     MOVE ' '                    TO PI-ENTRY-CD-1.
  8329     MOVE XCTL-005               TO PGM-NAME.
  8330     MOVE PGM-NAME               TO LOGOFF-PGM.
  8331     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8332     GO TO 9300-XCTL.
  8333 9700-DATE-LINK.
  8334     MOVE LINK-ELDATCV           TO PGM-NAME.
  8335
  8336* EXEC CICS LINK
  8337*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 146
* EL6317.cbl
  8338*        COMMAREA   (DATE-CONVERSION-DATA)
  8339*        LENGTH     (DC-COMM-LENGTH)
  8340*    END-EXEC.
  8341*    MOVE '."C                   (   #00007453' TO DFHEIV0
  8342     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8343     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8344     MOVE X'2020233030303037343533' TO DFHEIV0(25:11)
  8345     CALL 'kxdfhei1' USING DFHEIV0,
  8346           PGM-NAME,
  8347           DATE-CONVERSION-DATA,
  8348           DC-COMM-LENGTH,
  8349           DFHEIV99,
  8350           DFHEIV99,
  8351           DFHEIV99,
  8352           DFHEIV99
  8353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8354
  8355 9900-ERROR-FORMAT.
  8356     IF NOT EMI-ERRORS-COMPLETE
  8357        MOVE LINK-001            TO PGM-NAME
  8358
  8359* EXEC CICS LINK
  8360*           PROGRAM    (PGM-NAME)
  8361*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8362*           LENGTH     (EMI-COMM-LENGTH)
  8363*       END-EXEC
  8364*    MOVE '."C                   (   #00007461' TO DFHEIV0
  8365     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8366     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8367     MOVE X'2020233030303037343631' TO DFHEIV0(25:11)
  8368     CALL 'kxdfhei1' USING DFHEIV0,
  8369           PGM-NAME,
  8370           ERROR-MESSAGE-INTERFACE-BLOCK,
  8371           EMI-COMM-LENGTH,
  8372           DFHEIV99,
  8373           DFHEIV99,
  8374           DFHEIV99,
  8375           DFHEIV99
  8376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8377     END-IF
  8378     .
  8379 9900-EXIT.
  8380     EXIT.
  8381 9990-ABEND.
  8382     MOVE LINK-004               TO PGM-NAME.
  8383     MOVE DFHEIBLK               TO EMI-LINE1.
  8384
  8385* EXEC CICS LINK
  8386*        PROGRAM   (PGM-NAME)
  8387*        COMMAREA  (EMI-LINE1)
  8388*        LENGTH    (72)
  8389*    END-EXEC.
  8390     MOVE 72
  8391       TO DFHEIV11
  8392*    MOVE '."C                   (   #00007473' TO DFHEIV0
  8393     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8394     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8395     MOVE X'2020233030303037343733' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 147
* EL6317.cbl
  8396     CALL 'kxdfhei1' USING DFHEIV0,
  8397           PGM-NAME,
  8398           EMI-LINE1,
  8399           DFHEIV11,
  8400           DFHEIV99,
  8401           DFHEIV99,
  8402           DFHEIV99,
  8403           DFHEIV99
  8404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8405
  8406     GO TO 8200-SEND-DATAONLY.
  8407
  8408* GOBACK.
  8409     MOVE '9%                    "   ' TO DFHEIV0
  8410     MOVE 'EL6317' TO DFHEIV1
  8411     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8412     GOBACK.
  8413 9995-SECURITY-VIOLATION.
  8414*                            COPY ELCSCTP.
  8415******************************************************************
  8416*                                                                *
  8417*                            ELCSCTP                             *
  8418*                            VMOD=2.001                          *
  8419*                                                                *
  8420*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8421******************************************************************
  8422
  8423
  8424     MOVE EIBDATE          TO SM-JUL-DATE.
  8425     MOVE EIBTRMID         TO SM-TERMID.
  8426     MOVE THIS-PGM         TO SM-PGM.
  8427     MOVE EIBTIME          TO TIME-IN.
  8428     MOVE TIME-OUT         TO SM-TIME.
  8429     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8430
  8431
  8432* EXEC CICS LINK
  8433*         PROGRAM  ('EL003')
  8434*         COMMAREA (SECURITY-MESSAGE)
  8435*         LENGTH   (80)
  8436*    END-EXEC.
  8437     MOVE 'EL003' TO DFHEIV1
  8438     MOVE 80
  8439       TO DFHEIV11
  8440*    MOVE '."C                   (   #00007498' TO DFHEIV0
  8441     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8442     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8443     MOVE X'2020233030303037343938' TO DFHEIV0(25:11)
  8444     CALL 'kxdfhei1' USING DFHEIV0,
  8445           DFHEIV1,
  8446           SECURITY-MESSAGE,
  8447           DFHEIV11,
  8448           DFHEIV99,
  8449           DFHEIV99,
  8450           DFHEIV99,
  8451           DFHEIV99
  8452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8453
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 148
* EL6317.cbl
  8454
  8455******************************************************************
  8456
  8457 9995-EXIT.
  8458     EXIT.
  8459
  8460 9999-DFHBACK SECTION.
  8461     MOVE '9%                    "   ' TO DFHEIV0
  8462     MOVE 'EL6317' TO DFHEIV1
  8463     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8464     GOBACK.
  8465 9999-DFHEXIT.
  8466     IF DFHEIGDJ EQUAL 0001
  8467         NEXT SENTENCE
  8468     ELSE IF DFHEIGDJ EQUAL 2
  8469         GO TO 8300-SEND-TEXT
  8470         DEPENDING ON DFHEIGDI.
  8471     MOVE '9%                    "   ' TO DFHEIV0
  8472     MOVE 'EL6317' TO DFHEIV1
  8473     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8474     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34580     Code:       19011
