* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL001.cbl
* Options: int("EL001.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL001.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL001.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL001.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL001 .
     4*                            VMOD=2.017.
     5
     6*AUTHOR.           LOGIC,INC.
     7*                  DALLAS,TEXAS.
     8*
     9*
    10 DATE-COMPILED. 02-Nov-12 23:15.
    11 SECURITY.   *****************************************************
    12             *                                                   *
    13             *    THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.    *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL001.cbl
    14             *                                                   *
    15             *  USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES  *
    16             *  OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT   *
    17             *  THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.      *
    18             *                                                   *
    19             *****************************************************
    20
    21*REMARKS. ERROR TEXT PROCESSOR.
    22*         THIS IS A LINKED TO SUBROUTINE FOR HANDLING THE ERROR
    23*         LOOKUP AND TEXT FORMATTING OF THE ERROR LINES.
    24*
    25*
    26*         ANY PROGRAM CHANGES TO THIS MODULE SHOULD ALSO BE
    27*         APPLIED TO LGX001 WHEN CHANGES EFFECT LOGIC PROCESSING
    28*         CLIENTS.
    29
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL001.cbl
    31 ENVIRONMENT DIVISION.
    32 DATA DIVISION.
    33 WORKING-STORAGE SECTION.
    34 01  DFH-START PIC X(04).
    35 77  FILLER  PIC X(32)  VALUE '********************************'.
    36 77  FILLER  PIC X(32)  VALUE '*    EL001 WORKING STORAGE     *'.
    37 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.017 ************'.
    38
    39 01  WS-DATE-AREA.
    40     05  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
    41     05  TRANS-MXB1              PIC X(4)    VALUE 'MXB1'.
    42     05  TRANS-MXA5              PIC X(4)    VALUE 'MXA5'.
    43     05  TRANS-MXA6              PIC X(4)    VALUE 'MXA6'.
    44     05  TRANS-MXB2              PIC X(4)    VALUE 'MXB2'.
    45     05  TRANS-MXB3              PIC X(4)    VALUE 'MXB3'.
    46     05  SAVE-DATE               PIC X(8)    VALUE SPACES.
    47
    48 01  WORK-AREA.
    49     12  MAP-LENGTH              PIC S9(4)  COMP.
    50     12  WCC-CNTL                PIC X      VALUE ' '.
    51     12  EM-KEY                  PIC 9(4).
    52     12  EM-FILE-ID              PIC X(8)    VALUE 'ELERRS'.
    53     12  EM-FILE-ID-FR           PIC X(8)    VALUE 'MPFERR'.
    54     12  FOUND-SWITCH            PIC 9       VALUE 0.
    55         88  REC-NOT-FOUND           VALUE 1.
    56     12  TIME-IN                 PIC S9(7).
    57     12  TIME-OUT REDEFINES TIME-IN.
    58         16  FILLER              PIC X.
    59         16  TIME-O              PIC 99V99.
    60         16  FILLER              PIC XX.
    61     12  ER-NUM                  PIC 99      VALUE 1.
    62     12  ER-SUB                  PIC 99      VALUE 0.
    63     12  WCC-CTL                 PIC X       VALUE ' '.
    64     12  WS-ERROR-LINE.
    65         16  WS-ERROR-NUMBER     PIC 9999.
    66         16  WS-FILL             PIC X.
    67         16  WS-ERROR-SEVERITY   PIC X.
    68         16  FILLER              PIC X.
    69         16  WS-ERROR-TEXT.
    70             20  WS-PREFIX       PIC X(06).
    71             20  FILLER          PIC X(59).
    72     12  TEMP-ID.
    73         16  TEMP-TERM           PIC X(4).
    74         16  FILLER              PIC X(4)    VALUE '001A'.
    75
    76*            COPY EL001S.
    77 01  EL001AI.
    78     05  FILLER            PIC  X(0012).
    79*    -------------------------------
    80     05  RUNDTEL PIC S9(0004) COMP.
    81     05  RUNDTEF PIC  X(0001).
    82     05  FILLER REDEFINES RUNDTEF.
    83         10  RUNDTEA PIC  X(0001).
    84     05  RUNDTEI PIC  X(0008).
    85*    -------------------------------
    86     05  RUNTIML PIC S9(0004) COMP.
    87     05  RUNTIMF PIC  X(0001).
    88     05  FILLER REDEFINES RUNTIMF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL001.cbl
    89         10  RUNTIMA PIC  X(0001).
    90     05  RUNTIMI PIC  X(0005).
    91*    -------------------------------
    92     05  L1L PIC S9(0004) COMP.
    93     05  L1F PIC  X(0001).
    94     05  FILLER REDEFINES L1F.
    95         10  L1A PIC  X(0001).
    96     05  L1I PIC  X(0072).
    97*    -------------------------------
    98     05  L2L PIC S9(0004) COMP.
    99     05  L2F PIC  X(0001).
   100     05  FILLER REDEFINES L2F.
   101         10  L2A PIC  X(0001).
   102     05  L2I PIC  X(0072).
   103*    -------------------------------
   104     05  L3L PIC S9(0004) COMP.
   105     05  L3F PIC  X(0001).
   106     05  FILLER REDEFINES L3F.
   107         10  L3A PIC  X(0001).
   108     05  L3I PIC  X(0072).
   109*    -------------------------------
   110     05  L4L PIC S9(0004) COMP.
   111     05  L4F PIC  X(0001).
   112     05  FILLER REDEFINES L4F.
   113         10  L4A PIC  X(0001).
   114     05  L4I PIC  X(0072).
   115*    -------------------------------
   116     05  L5L PIC S9(0004) COMP.
   117     05  L5F PIC  X(0001).
   118     05  FILLER REDEFINES L5F.
   119         10  L5A PIC  X(0001).
   120     05  L5I PIC  X(0072).
   121*    -------------------------------
   122     05  L6L PIC S9(0004) COMP.
   123     05  L6F PIC  X(0001).
   124     05  FILLER REDEFINES L6F.
   125         10  L6A PIC  X(0001).
   126     05  L6I PIC  X(0072).
   127*    -------------------------------
   128     05  L7L PIC S9(0004) COMP.
   129     05  L7F PIC  X(0001).
   130     05  FILLER REDEFINES L7F.
   131         10  L7A PIC  X(0001).
   132     05  L7I PIC  X(0072).
   133*    -------------------------------
   134     05  L8L PIC S9(0004) COMP.
   135     05  L8F PIC  X(0001).
   136     05  FILLER REDEFINES L8F.
   137         10  L8A PIC  X(0001).
   138     05  L8I PIC  X(0072).
   139*    -------------------------------
   140     05  L9L PIC S9(0004) COMP.
   141     05  L9F PIC  X(0001).
   142     05  FILLER REDEFINES L9F.
   143         10  L9A PIC  X(0001).
   144     05  L9I PIC  X(0072).
   145*    -------------------------------
   146     05  L10L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL001.cbl
   147     05  L10F PIC  X(0001).
   148     05  FILLER REDEFINES L10F.
   149         10  L10A PIC  X(0001).
   150     05  L10I PIC  X(0072).
   151*    -------------------------------
   152     05  L11L PIC S9(0004) COMP.
   153     05  L11F PIC  X(0001).
   154     05  FILLER REDEFINES L11F.
   155         10  L11A PIC  X(0001).
   156     05  L11I PIC  X(0072).
   157*    -------------------------------
   158     05  L12L PIC S9(0004) COMP.
   159     05  L12F PIC  X(0001).
   160     05  FILLER REDEFINES L12F.
   161         10  L12A PIC  X(0001).
   162     05  L12I PIC  X(0072).
   163 01  EL001AO REDEFINES EL001AI.
   164     05  FILLER            PIC  X(0012).
   165*    -------------------------------
   166     05  FILLER            PIC  X(0003).
   167     05  RUNDTEO PIC  X(0008).
   168*    -------------------------------
   169     05  FILLER            PIC  X(0003).
   170     05  RUNTIMO PIC  99.99.
   171*    -------------------------------
   172     05  FILLER            PIC  X(0003).
   173     05  L1O PIC  X(0072).
   174*    -------------------------------
   175     05  FILLER            PIC  X(0003).
   176     05  L2O PIC  X(0072).
   177*    -------------------------------
   178     05  FILLER            PIC  X(0003).
   179     05  L3O PIC  X(0072).
   180*    -------------------------------
   181     05  FILLER            PIC  X(0003).
   182     05  L4O PIC  X(0072).
   183*    -------------------------------
   184     05  FILLER            PIC  X(0003).
   185     05  L5O PIC  X(0072).
   186*    -------------------------------
   187     05  FILLER            PIC  X(0003).
   188     05  L6O PIC  X(0072).
   189*    -------------------------------
   190     05  FILLER            PIC  X(0003).
   191     05  L7O PIC  X(0072).
   192*    -------------------------------
   193     05  FILLER            PIC  X(0003).
   194     05  L8O PIC  X(0072).
   195*    -------------------------------
   196     05  FILLER            PIC  X(0003).
   197     05  L9O PIC  X(0072).
   198*    -------------------------------
   199     05  FILLER            PIC  X(0003).
   200     05  L10O PIC  X(0072).
   201*    -------------------------------
   202     05  FILLER            PIC  X(0003).
   203     05  L11O PIC  X(0072).
   204*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL001.cbl
   205     05  FILLER            PIC  X(0003).
   206     05  L12O PIC  X(0072).
   207*    -------------------------------
   208 01  MAP-AREA REDEFINES EL001AI.
   209     12  FILLER                  PIC X(31).
   210     12  ERROR-LINES-FOR-MAP OCCURS 12 TIMES.
   211         16  FILLER              PIC X(3).
   212         16  ER-LINE             PIC X(72).
   213
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL001.cbl
   215*            COPY ELCEMIB.
   216******************************************************************
   217*                                                                *
   218*                                                                *
   219*                            ELCEMIB.                            *
   220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   221*                            VMOD=2.005                          *
   222*                                                                *
   223*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   224*                                                                *
   225******************************************************************
   226 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   227     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   228     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   229     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   230     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   231     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   232     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   233     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   234     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   235     12  EMI-SWITCH1             PIC X        VALUE '1'.
   236         88  EMI-NO-ERRORS                    VALUE '1'.
   237         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   238         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   239     12  EMI-SWITCH2             PIC X        VALUE '1'.
   240         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   241     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   242         88  EMI-AREA1-EMPTY                  VALUE '1'.
   243         88  EMI-AREA1-FULL                   VALUE '2'.
   244     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   245         88  EMI-AREA2-EMPTY                  VALUE '1'.
   246         88  EMI-AREA2-FULL                   VALUE '2'.
   247     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   248         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   249         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   250         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   251         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   252         88  EMI-BYPASS-FATALS                VALUE 'X'.
   253     12  EMI-ERROR-LINES.
   254         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   255         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   256         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   257         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   258             20  EMI-ERR-CODES OCCURS 10 TIMES.
   259                 24  EMI-ERR-NUM         PIC X(4).
   260                 24  EMI-FILLER          PIC X.
   261                 24  EMI-SEV             PIC X.
   262                 24  FILLER              PIC X.
   263             20  FILLER                  PIC X(02).
   264     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   265         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   266             20  EMI-ERROR-NUMBER    PIC X(4).
   267             20  EMI-FILL            PIC X.
   268             20  EMI-SEVERITY        PIC X.
   269             20  FILLER              PIC X.
   270             20  EMI-ERROR-TEXT.
   271                 24  EMI-TEXT-VARIABLE   PIC X(10).
   272                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL001.cbl
   273     12  EMI-SEVERITY-SAVE           PIC X.
   274         88  EMI-NOTE                    VALUE 'N'.
   275         88  EMI-WARNING                 VALUE 'W'.
   276         88  EMI-FORCABLE                VALUE 'F'.
   277         88  EMI-FATAL                   VALUE 'X'.
   278     12  EMI-MESSAGE-FLAG            PIC X.
   279         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   280         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   281     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   282     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   283         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   284         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   285         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   286     12  FILLER                      PIC X(137)  VALUE SPACES.
   287     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   288     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   289     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   290     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL001.cbl
   292*            COPY ELCDATE.
   293******************************************************************
   294*                                                                *
   295*                                                                *
   296*                            ELCDATE.                            *
   297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   298*                            VMOD=2.003
   299*                                                                *
   300*                                                                *
   301*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   302*                 LENGTH = 200                                   *
   303******************************************************************
   304
   305 01  DATE-CONVERSION-DATA.
   306     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   307     12  DC-OPTION-CODE                PIC X.
   308         88  BIN-TO-GREG                VALUE ' '.
   309         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   310         88  EDIT-GREG-TO-BIN           VALUE '2'.
   311         88  YMD-GREG-TO-BIN            VALUE '3'.
   312         88  MDY-GREG-TO-BIN            VALUE '4'.
   313         88  JULIAN-TO-BIN              VALUE '5'.
   314         88  BIN-PLUS-ELAPSED           VALUE '6'.
   315         88  FIND-CENTURY               VALUE '7'.
   316         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   317         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   318         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   319         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   320         88  JULIAN-TO-BIN-3            VALUE 'C'.
   321         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   322         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   323         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   324         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   325         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   326         88  CHECK-LEAP-YEAR            VALUE 'H'.
   327         88  BIN-3-TO-GREG              VALUE 'I'.
   328         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   329         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   330         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   331         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   332         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   333         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   334         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   335         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   336         88  THREE-CHARACTER-BIN
   337                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   338         88  GREGORIAN-TO-BIN
   339                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   340         88  BIN-TO-GREGORIAN
   341                  VALUES ' ' '1' 'I' '8' 'G'.
   342         88  JULIAN-TO-BINARY
   343                  VALUES '5' 'C' 'E' 'F'.
   344     12  DC-ERROR-CODE                 PIC X.
   345         88  NO-CONVERSION-ERROR        VALUE ' '.
   346         88  DATE-CONVERSION-ERROR
   347                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   348         88  DATE-IS-ZERO               VALUE '1'.
   349         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL001.cbl
   350         88  DATE-IS-INVALID            VALUE '3'.
   351         88  DATE1-GREATER-DATE2        VALUE '4'.
   352         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   353         88  DATE-INVALID-OPTION        VALUE '9'.
   354         88  INVALID-CENTURY            VALUE 'A'.
   355         88  ONLY-CENTURY               VALUE 'B'.
   356         88  ONLY-LEAP-YEAR             VALUE 'C'.
   357         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   358     12  DC-END-OF-MONTH               PIC X.
   359         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   360     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   361         88  USE-NORMAL-PROCESS         VALUE ' '.
   362         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   363         88  ADJUST-UP-100-YRS          VALUE '2'.
   364     12  FILLER                        PIC X.
   365     12  DC-CONVERSION-DATES.
   366         16  DC-BIN-DATE-1             PIC XX.
   367         16  DC-BIN-DATE-2             PIC XX.
   368         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   369         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   370                       DC-GREG-DATE-1-EDIT.
   371             20  DC-EDIT1-MONTH        PIC 99.
   372             20  SLASH1-1              PIC X.
   373             20  DC-EDIT1-DAY          PIC 99.
   374             20  SLASH1-2              PIC X.
   375             20  DC-EDIT1-YEAR         PIC 99.
   376         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   377         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   378                     DC-GREG-DATE-2-EDIT.
   379             20  DC-EDIT2-MONTH        PIC 99.
   380             20  SLASH2-1              PIC X.
   381             20  DC-EDIT2-DAY          PIC 99.
   382             20  SLASH2-2              PIC X.
   383             20  DC-EDIT2-YEAR         PIC 99.
   384         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   385         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   386                     DC-GREG-DATE-1-YMD.
   387             20  DC-YMD-YEAR           PIC 99.
   388             20  DC-YMD-MONTH          PIC 99.
   389             20  DC-YMD-DAY            PIC 99.
   390         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   391         16  DC-GREG-DATE-1-MDY-R REDEFINES
   392                      DC-GREG-DATE-1-MDY.
   393             20  DC-MDY-MONTH          PIC 99.
   394             20  DC-MDY-DAY            PIC 99.
   395             20  DC-MDY-YEAR           PIC 99.
   396         16  DC-GREG-DATE-1-ALPHA.
   397             20  DC-ALPHA-MONTH        PIC X(10).
   398             20  DC-ALPHA-DAY          PIC 99.
   399             20  FILLER                PIC XX.
   400             20  DC-ALPHA-CENTURY.
   401                 24 DC-ALPHA-CEN-N     PIC 99.
   402             20  DC-ALPHA-YEAR         PIC 99.
   403         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   404         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   405         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   406         16  DC-JULIAN-DATE            PIC 9(05).
   407         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL001.cbl
   408                                       PIC 9(05).
   409         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   410             20  DC-JULIAN-YEAR        PIC 99.
   411             20  DC-JULIAN-DAYS        PIC 999.
   412         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   413         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   414         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   415     12  DATE-CONVERSION-VARIBLES.
   416         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   417         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   418             20  FILLER                PIC 9(3).
   419             20  HOLD-CEN-1-CCYY.
   420                 24  HOLD-CEN-1-CC     PIC 99.
   421                 24  HOLD-CEN-1-YY     PIC 99.
   422             20  HOLD-CEN-1-MO         PIC 99.
   423             20  HOLD-CEN-1-DA         PIC 99.
   424         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   425             20  HOLD-CEN-1-R-MO       PIC 99.
   426             20  HOLD-CEN-1-R-DA       PIC 99.
   427             20  HOLD-CEN-1-R-CCYY.
   428                 24  HOLD-CEN-1-R-CC   PIC 99.
   429                 24  HOLD-CEN-1-R-YY   PIC 99.
   430             20  FILLER                PIC 9(3).
   431         16  HOLD-CENTURY-1-X.
   432             20  FILLER                PIC X(3)  VALUE SPACES.
   433             20  HOLD-CEN-1-X-CCYY.
   434                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   435                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   436             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   437             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   438         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   439             20  HOLD-CEN-1-R-X-MO     PIC XX.
   440             20  HOLD-CEN-1-R-X-DA     PIC XX.
   441             20  HOLD-CEN-1-R-X-CCYY.
   442                 24  HOLD-CEN-1-R-X-CC PIC XX.
   443                 24  HOLD-CEN-1-R-X-YY PIC XX.
   444             20  FILLER                PIC XXX.
   445         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   446         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   447         16  DC-JULIAN-DATE-1          PIC 9(07).
   448         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   449             20  DC-JULIAN-1-CCYY.
   450                 24  DC-JULIAN-1-CC    PIC 99.
   451                 24  DC-JULIAN-1-YR    PIC 99.
   452             20  DC-JULIAN-DA-1        PIC 999.
   453         16  DC-JULIAN-DATE-2          PIC 9(07).
   454         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   455             20  DC-JULIAN-2-CCYY.
   456                 24  DC-JULIAN-2-CC    PIC 99.
   457                 24  DC-JULIAN-2-YR    PIC 99.
   458             20  DC-JULIAN-DA-2        PIC 999.
   459         16  DC-GREG-DATE-A-EDIT.
   460             20  DC-EDITA-MONTH        PIC 99.
   461             20  SLASHA-1              PIC X VALUE '/'.
   462             20  DC-EDITA-DAY          PIC 99.
   463             20  SLASHA-2              PIC X VALUE '/'.
   464             20  DC-EDITA-CCYY.
   465                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL001.cbl
   466                 24  DC-EDITA-YEAR     PIC 99.
   467         16  DC-GREG-DATE-B-EDIT.
   468             20  DC-EDITB-MONTH        PIC 99.
   469             20  SLASHB-1              PIC X VALUE '/'.
   470             20  DC-EDITB-DAY          PIC 99.
   471             20  SLASHB-2              PIC X VALUE '/'.
   472             20  DC-EDITB-CCYY.
   473                 24  DC-EDITB-CENT     PIC 99.
   474                 24  DC-EDITB-YEAR     PIC 99.
   475         16  DC-GREG-DATE-CYMD         PIC 9(08).
   476         16  DC-GREG-DATE-CYMD-R REDEFINES
   477                              DC-GREG-DATE-CYMD.
   478             20  DC-CYMD-CEN           PIC 99.
   479             20  DC-CYMD-YEAR          PIC 99.
   480             20  DC-CYMD-MONTH         PIC 99.
   481             20  DC-CYMD-DAY           PIC 99.
   482         16  DC-GREG-DATE-MDCY         PIC 9(08).
   483         16  DC-GREG-DATE-MDCY-R REDEFINES
   484                              DC-GREG-DATE-MDCY.
   485             20  DC-MDCY-MONTH         PIC 99.
   486             20  DC-MDCY-DAY           PIC 99.
   487             20  DC-MDCY-CEN           PIC 99.
   488             20  DC-MDCY-YEAR          PIC 99.
   489    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   490        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   491    12  DC-EL310-DATE                  PIC X(21).
   492    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL001.cbl
   494*            COPY ELCERRWS.
   495******************************************************************
   496*                                                                *
   497*                                                                *
   498*                            ELCERRWS                            *
   499*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   500*                            VMOD=2.005                          *
   501*                                                                *
   502*                                                                *
   503*    WORKING STORAGE FOR ERROR MESSAGES ROUTINE ELCERRPD         *
   504*                                                                *
   505******************************************************************
   506
   507 01  W-ERROR-WORK.
   508     12  E-CLIENT-ID             PIC X(03)   VALUE SPACES.
   509     12  CLIENT-ABL              PIC X(03)   VALUE 'ABL'.
   510     12  CLIENT-AIG              PIC X(03)   VALUE 'AIG'.
   511     12  CLIENT-AUK              PIC X(03)   VALUE 'AUK'.
   512     12  CLIENT-CIG              PIC X(03)   VALUE 'CIG'.
   513     12  CLIENT-CUK              PIC X(03)   VALUE 'CUK'.
   514     12  CLIENT-LAP              PIC X(03)   VALUE 'LAP'.
   515     12  CLIENT-NCB              PIC X(03)   VALUE 'NCB'.
   516     12  CLIENT-TIC              PIC X(03)   VALUE 'TIC'.
   517     12  CLIENT-TMS              PIC X(03)   VALUE 'TMS'.
   518     12  CLIENT-LBL              PIC X(03)   VALUE 'LBL'.
   519     12  CLIENT-HAN              PIC X(03)   VALUE 'HAN'.
   520     12  CLIENT-JHL              PIC X(03)   VALUE 'JHL'.
   521     12  CLIENT-HER              PIC X(03)   VALUE 'HER'.
   522     12  CLIENT-NCX              PIC X(03)   VALUE 'NCX'.
   523     12  CLIENT-DCC              PIC X(03)   VALUE 'DCC'.
   524     12  CLIENT-CID              PIC X(03)   VALUE 'CID'.
   525
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL001.cbl
   527*            COPY ELCERRS.
   528******************************************************************
   529*                                                                *
   530*                                                                *
   531*                            ELCERRS.                            *
   532*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   533*                            VMOD 2.002                          *
   534*                                                                *
   535*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *
   536*                                                                *
   537*   FILE TYPE = VSAM,KSDS                                        *
   538*   RECORD SIZE = 72    RECFORM = FIX                            *
   539*                                                                *
   540*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *
   541*       ALTERNATE PATH  = NOT USED                               *
   542*                                                                *
   543*   LOG = NO                                                     *
   544*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   545******************************************************************
   546 01  ERROR-MESSAGE-FILE.
   547     12  EM-RECORD-ID                PIC XX.
   548         88  VALID-EM-ID                VALUE 'EM'.
   549
   550     12  EM-CONTROL-PRIMARY.
   551         16  EM-MESSAGE-NUMBER       PIC 9(4).
   552
   553     12  EM-ERROR-TEXT.
   554         16  EM-ERROR-TEXT-PREFIX    PIC X(6).
   555         16  FILLER                  PIC X(59).
   556
   557     12  EM-ERROR-SEVERITY           PIC X.
   558         88  ERROR-IS-NOTE              VALUE 'N'.
   559         88  ERROR-IS-WARNING           VALUE 'W'.
   560         88  ERROR-IS-FORCABLE          VALUE 'F'.
   561         88  ERROR-IS-FATAL             VALUE 'X'.
   562
   563******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL001.cbl
   565****************************************************************
   566*
   567* Copyright (c) 2007 by Clerity Solutions, Inc.
   568* All rights reserved.
   569*
   570****************************************************************
   571 01  DFHEIV.
   572   02  DFHEIV0               PIC X(35).
   573   02  DFHEIV1               PIC X(08).
   574   02  DFHEIV2               PIC X(08).
   575   02  DFHEIV3               PIC X(08).
   576   02  DFHEIV4               PIC X(06).
   577   02  DFHEIV5               PIC X(04).
   578   02  DFHEIV6               PIC X(04).
   579   02  DFHEIV7               PIC X(02).
   580   02  DFHEIV8               PIC X(02).
   581   02  DFHEIV9               PIC X(01).
   582   02  DFHEIV10              PIC S9(7) COMP-3.
   583   02  DFHEIV11              PIC S9(4) COMP SYNC.
   584   02  DFHEIV12              PIC S9(4) COMP SYNC.
   585   02  DFHEIV13              PIC S9(4) COMP SYNC.
   586   02  DFHEIV14              PIC S9(4) COMP SYNC.
   587   02  DFHEIV15              PIC S9(4) COMP SYNC.
   588   02  DFHEIV16              PIC S9(9) COMP SYNC.
   589   02  DFHEIV17              PIC X(04).
   590   02  DFHEIV18              PIC X(04).
   591   02  DFHEIV19              PIC X(04).
   592   02  DFHEIV20              USAGE IS POINTER.
   593   02  DFHEIV21              USAGE IS POINTER.
   594   02  DFHEIV22              USAGE IS POINTER.
   595   02  DFHEIV23              USAGE IS POINTER.
   596   02  DFHEIV24              USAGE IS POINTER.
   597   02  DFHEIV25              PIC S9(9) COMP SYNC.
   598   02  DFHEIV26              PIC S9(9) COMP SYNC.
   599   02  DFHEIV27              PIC S9(9) COMP SYNC.
   600   02  DFHEIV28              PIC S9(9) COMP SYNC.
   601   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   602   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   603   02  FILLER                PIC X(02).
   604   02  DFHEIV99              PIC X(08) VALUE SPACE.
   605   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   606   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   607   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   608   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   609 LINKAGE  SECTION.
   610*****************************************************************
   611*                                                               *
   612* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   613* All rights reserved.                                          *
   614*                                                               *
   615*****************************************************************
   616 01  dfheiblk.
   617     02  eibtime          pic s9(7) comp-3.
   618     02  eibdate          pic s9(7) comp-3.
   619     02  eibtrnid         pic x(4).
   620     02  eibtaskn         pic s9(7) comp-3.
   621     02  eibtrmid         pic x(4).
   622     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL001.cbl
   623     02  eibcposn         pic s9(4) comp.
   624     02  eibcalen         pic s9(4) comp.
   625     02  eibaid           pic x(1).
   626     02  eibfiller1       pic x(1).
   627     02  eibfn            pic x(2).
   628     02  eibfiller2       pic x(2).
   629     02  eibrcode         pic x(6).
   630     02  eibfiller3       pic x(2).
   631     02  eibds            pic x(8).
   632     02  eibreqid         pic x(8).
   633     02  eibrsrce         pic x(8).
   634     02  eibsync          pic x(1).
   635     02  eibfree          pic x(1).
   636     02  eibrecv          pic x(1).
   637     02  eibsend          pic x(1).
   638     02  eibatt           pic x(1).
   639     02  eibeoc           pic x(1).
   640     02  eibfmh           pic x(1).
   641     02  eibcompl         pic x(1).
   642     02  eibsig           pic x(1).
   643     02  eibconf          pic x(1).
   644     02  eiberr           pic x(1).
   645     02  eibrldbk         pic x(1).
   646     02  eiberrcd         pic x(4).
   647     02  eibsynrb         pic x(1).
   648     02  eibnodat         pic x(1).
   649     02  eibfiller5       pic x(2).
   650     02  eibresp          pic 9(09) comp.
   651     02  eibresp2         pic 9(09) comp.
   652     02  dfheigdj         pic s9(4) comp.
   653     02  dfheigdk         pic s9(4) comp.
   654
   655 01  DFHCOMMAREA                 PIC X(400).
   656
   657 01  PARMLIST.
   658     12  FILLER                  PIC S9(8) COMP.
   659     12  ERROR-POINTER           PIC S9(8) COMP.
   660     12  ERROR-POINTER-FR        PIC S9(8) COMP.
   661     12  MAP-POINTER             PIC S9(8) COMP.
   662
   663 01  ERROR-MESSAGE-FILE-REST     PIC X(72).
   664 01  ERROR-MESSAGE-FILE-FR       PIC X(72).
   665
   666 01  MAP-BUFFER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL001.cbl
   668 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PARMLIST
   669                          ERROR-MESSAGE-FILE-REST
   670                          ERROR-MESSAGE-FILE-FR MAP-BUFFER.
   671 0000-DFHEXIT SECTION.
   672     MOVE '9#                    $   ' TO DFHEIV0.
   673     MOVE 'EL001' TO DFHEIV1.
   674     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   675     SERVICE RELOAD PARMLIST.
   676
   677     MOVE DFHCOMMAREA  TO  ERROR-MESSAGE-INTERFACE-BLOCK.
   678
   679     IF EMI-ROLL-SWITCH = 'Y'
   680        GO TO 3000-ROLL-CODES.
   681
   682     MOVE EMI-ERROR              TO EM-KEY.
   683
   684 0100-READ-ERRORS.
   685
   686     IF  EMI-LANGUAGE-IS-FR
   687
   688* EXEC CICS HANDLE CONDITION
   689*             NOTFND   (2150-NOT-FOUND-FR)
   690*             NOTOPEN  (2250-NOT-OPEN-FR)
   691*        END-EXEC
   692*    MOVE '"$IJ                  ! " #00000683' TO DFHEIV0
   693     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
   694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   695     MOVE X'2220233030303030363833' TO DFHEIV0(25:11)
   696     CALL 'kxdfhei1' USING DFHEIV0
   697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   698
   699
   700* EXEC CICS READ
   701*             DATASET  (EM-FILE-ID-FR)
   702*             RIDFLD   (EM-KEY)
   703*             INTO     (ERROR-MESSAGE-FILE)
   704*        END-EXEC
   705     MOVE LENGTH OF
   706      ERROR-MESSAGE-FILE
   707       TO DFHEIV11
   708*    MOVE '&"IL       E          (   #00000688' TO DFHEIV0
   709     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
   710     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
   711     MOVE X'2020233030303030363838' TO DFHEIV0(25:11)
   712     CALL 'kxdfhei1' USING DFHEIV0,
   713           EM-FILE-ID-FR,
   714           ERROR-MESSAGE-FILE,
   715           DFHEIV11,
   716           EM-KEY,
   717           DFHEIV99,
   718           DFHEIV99,
   719           DFHEIV99
   720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   721
   722*        SERVICE RELOAD ERROR-MESSAGE-FILE-FR
   723
   724     ELSE
   725
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL001.cbl
   726* EXEC CICS HANDLE CONDITION
   727*             NOTFND   (2100-NOT-FOUND)
   728*             NOTOPEN  (2200-NOT-OPEN)
   729*        END-EXEC
   730*    MOVE '"$IJ                  ! # #00000697' TO DFHEIV0
   731     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
   732     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   733     MOVE X'2320233030303030363937' TO DFHEIV0(25:11)
   734     CALL 'kxdfhei1' USING DFHEIV0
   735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   736
   737
   738* EXEC CICS READ
   739*             DATASET  (EM-FILE-ID)
   740*             RIDFLD   (EM-KEY)
   741*             INTO     (ERROR-MESSAGE-FILE)
   742*        END-EXEC.
   743     MOVE LENGTH OF
   744      ERROR-MESSAGE-FILE
   745       TO DFHEIV11
   746*    MOVE '&"IL       E          (   #00000702' TO DFHEIV0
   747     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
   748     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
   749     MOVE X'2020233030303030373032' TO DFHEIV0(25:11)
   750     CALL 'kxdfhei1' USING DFHEIV0,
   751           EM-FILE-ID,
   752           ERROR-MESSAGE-FILE,
   753           DFHEIV11,
   754           EM-KEY,
   755           DFHEIV99,
   756           DFHEIV99,
   757           DFHEIV99
   758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   759
   760
   761*        SERVICE RELOAD ERROR-MESSAGE-FILE-REST.
   762
   763     MOVE EMI-CLIENT-ID TO E-CLIENT-ID.
   764
   765*                                COPY ELCERRPD.
   766******************************************************************
   767*                                                                *
   768*                                                                *
   769*                            ELCERRPD                            *
   770*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   771*                            VMOD=2.005                          *
   772*                                                                *
   773*    CLIENT CODED ERROR MESSAGES                                 *
   774*                                                                *
   775******************************************************************
   776
   777     IF EM-MESSAGE-NUMBER NOT NUMERIC
   778         MOVE ZEROS TO EM-MESSAGE-NUMBER.
   779
   780     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK
   781                         OR CLIENT-CIG OR CLIENT-CUK
   782        IF EM-MESSAGE-NUMBER EQUAL 0541
   783            MOVE 'X' TO EM-ERROR-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL001.cbl
   784
   785     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER
   786        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909
   787            MOVE 'F'             TO  EM-ERROR-SEVERITY.
   788
   789     IF E-CLIENT-ID EQUAL CLIENT-LAP
   790        IF EM-MESSAGE-NUMBER EQUAL 2656
   791            MOVE 'F' TO EM-ERROR-SEVERITY.
   792
   793     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB
   794        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671
   795            MOVE 'F'             TO  EM-ERROR-SEVERITY.
   796
   797     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC
   798        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672
   799            MOVE 'W'             TO  EM-ERROR-SEVERITY.
   800
   801     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER
   802        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693
   803            MOVE 'W'             TO  EM-ERROR-SEVERITY.
   804
   805     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS
   806        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696
   807            MOVE 'F'             TO  EM-ERROR-SEVERITY.
   808
   809     IF E-CLIENT-ID EQUAL CLIENT-LBL
   810        IF EM-MESSAGE-NUMBER EQUAL 2738
   811            MOVE 'W' TO EM-ERROR-SEVERITY.
   812
   813     IF E-CLIENT-ID EQUAL CLIENT-LBL
   814        IF EM-MESSAGE-NUMBER EQUAL 2739
   815            MOVE 'W' TO EM-ERROR-SEVERITY.
   816
   817     IF E-CLIENT-ID EQUAL CLIENT-LBL
   818        IF EM-MESSAGE-NUMBER EQUAL 2741
   819            MOVE 'W' TO EM-ERROR-SEVERITY.
   820
   821     IF  E-CLIENT-ID EQUAL CLIENT-HAN
   822             OR
   823         E-CLIENT-ID EQUAL CLIENT-JHL
   824
   825         IF  EM-MESSAGE-NUMBER EQUAL 2756
   826             MOVE 'F'            TO EM-ERROR-SEVERITY.
   827
   828     IF E-CLIENT-ID = CLIENT-NCX
   829         IF EM-MESSAGE-NUMBER = 9895
   830             MOVE 'F'            TO EM-ERROR-SEVERITY.
   831     IF E-CLIENT-ID = CLIENT-DCC
   832        IF EM-MESSAGE-NUMBER = 2719
   833           MOVE 'W'              TO EM-ERROR-SEVERITY
   834        END-IF
   835     END-IF
   836     .
   837
   838     IF EM-ERROR-TEXT-PREFIX = 'LLLLLL'
   839        MOVE EMI-LIFE-OVERRIDE-L6  TO EM-ERROR-TEXT-PREFIX.
   840
   841     IF EM-ERROR-TEXT-PREFIX = 'AAAAAA'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL001.cbl
   842        MOVE EMI-AH-OVERRIDE-L6    TO EM-ERROR-TEXT-PREFIX.
   843
   844     IF EM-ERROR-TEXT-PREFIX = 'DDDDDD'
   845        MOVE EMI-DATE-FIELD        TO EM-ERROR-TEXT-PREFIX.
   846
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL001.cbl
   848 2000-PROCESS-ERRORS.
   849**********************************************************
   850*       THIS ROUTINE WILL CHECK THE SEVERITY OF THE      *
   851*       ERROR AND DETERMINE IF IT IS TO BE PROCESSED     *
   852*       OR NOT                                           *
   853**********************************************************
   854     IF REC-NOT-FOUND
   855*        MOVE 'N'                TO  EMI-MESSAGE-FLAG
   856         GO TO 2000-CONT-PROCESS-ERRORS.
   857
   858     MOVE EM-ERROR-SEVERITY      TO EMI-SEVERITY-SAVE.
   859     MOVE 'N'                    TO EMI-MESSAGE-FLAG.
   860
   861     IF EM-ERROR-SEVERITY = 'N'
   862        ADD 1 TO EMI-NOTE-CTR
   863        IF NOT EMI-PROCESS-ALL-ERRORS
   864           GO TO 2300-RETURN.
   865
   866     IF EM-ERROR-SEVERITY = 'W'
   867        ADD 1 TO EMI-WARNING-CTR
   868        IF EMI-BYPASS-WARNINGS  OR
   869           EMI-BYPASS-FORCABLES OR
   870           EMI-BYPASS-FATALS
   871             GO TO 2300-RETURN.
   872
   873     IF EM-ERROR-SEVERITY = 'F'
   874        ADD 1 TO EMI-FORCABLE-CTR
   875        IF EMI-BYPASS-FORCABLES OR
   876           EMI-BYPASS-FATALS
   877             GO TO 2300-RETURN.
   878
   879     IF EM-ERROR-SEVERITY = 'X'
   880        ADD 1 TO EMI-FATAL-CTR
   881        IF EMI-BYPASS-FATALS
   882           GO TO 2300-RETURN.
   883
   884 2000-CONT-PROCESS-ERRORS.
   885
   886     MOVE 'Y'                    TO EMI-MESSAGE-FLAG.
   887
   888     IF EMI-ERRORS-COMPLETE
   889        GO TO 2300-RETURN.
   890
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL001.cbl
   892**********************************************************
   893*       THIS ROUTINE WILL CHECK TO SEE IF THE ERROR      *
   894*       HAS ALREADY BEEN PROCESSED. IF IT HAS, THEN      *
   895*       PROCESSING WILL BE TERMINATED FOR THIS ERROR.    *
   896**********************************************************
   897     IF EMI-FORMAT-CODES-ONLY
   898        IF EMI-ERROR  =  EMI-ERR-NUM (1) OR
   899                         EMI-ERR-NUM (2) OR
   900                         EMI-ERR-NUM (3) OR
   901                         EMI-ERR-NUM (4) OR
   902                         EMI-ERR-NUM (5) OR
   903                         EMI-ERR-NUM (6) OR
   904                         EMI-ERR-NUM (7) OR
   905                         EMI-ERR-NUM (8) OR
   906                         EMI-ERR-NUM (9) OR
   907                         EMI-ERR-NUM (10)
   908           GO TO 2300-RETURN.
   909
   910
   911     IF EMI-NUMBER-OF-LINES = 2
   912        IF EMI-ERROR  =  EMI-ERROR-NUMBER (1)  OR
   913                         EMI-ERROR-NUMBER (2)
   914           GO TO 2300-RETURN
   915        ELSE
   916           GO TO 2050-CHECK-LINE.
   917
   918     IF EMI-NUMBER-OF-LINES = 3
   919        IF EMI-ERROR  =  EMI-ERROR-NUMBER (1)  OR
   920                         EMI-ERROR-NUMBER (2)  OR
   921                         EMI-ERROR-NUMBER (3)
   922           GO TO 2300-RETURN.
   923
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL001.cbl
   925 2050-CHECK-LINE.
   926**********************************************************
   927*       THIS ROUTINE WILL DETERMINE WHICH ERROR LINE     *
   928*       THE MESSAGE WILL FORMATTED INTO AND SET THE      *
   929*       NECESSARY SWITCHES AND SUBSCRIPTS.               *
   930**********************************************************
   931     MOVE '2' TO EMI-SWITCH1.
   932
   933     IF EMI-NUMBER-OF-LINES = 1
   934        SET EMI-INDX TO 1
   935        PERFORM 2490-FORMAT-LINE
   936        MOVE '2'                 TO EMI-SWITCH-AREA-1
   937        MOVE '3'                 TO EMI-SWITCH1
   938        GO TO 2300-RETURN.
   939
   940     IF EMI-NUMBER-OF-LINES = 2
   941        IF EMI-AREA1-EMPTY
   942           SET EMI-INDX TO 1
   943           MOVE '2'              TO EMI-SWITCH-AREA-1
   944           PERFORM 2490-FORMAT-LINE
   945           GO TO 2300-RETURN
   946        ELSE
   947           SET EMI-INDX TO 2
   948           IF EMI-FORMAT-CODES-ONLY
   949              PERFORM 2500-FORMAT-CODES-ONLY THRU 2500-EXIT
   950              GO TO 2300-RETURN
   951           ELSE
   952              MOVE '3'           TO EMI-SWITCH1
   953              MOVE '2'           TO EMI-SWITCH-AREA-2
   954              PERFORM 2490-FORMAT-LINE
   955              GO TO 2300-RETURN.
   956
   957        IF EMI-AREA1-EMPTY
   958           SET EMI-INDX TO 1
   959           MOVE '2'              TO EMI-SWITCH-AREA-1
   960           PERFORM 2490-FORMAT-LINE
   961           GO TO 2300-RETURN.
   962
   963        IF EMI-AREA2-EMPTY
   964           SET EMI-INDX TO 2
   965           MOVE '2'              TO EMI-SWITCH-AREA-2
   966           PERFORM 2490-FORMAT-LINE
   967           GO TO 2300-RETURN.
   968
   969        SET EMI-INDX TO 3.
   970
   971        IF EMI-FORMAT-CODES-ONLY
   972           PERFORM 2500-FORMAT-CODES-ONLY THRU 2500-EXIT
   973           GO TO 2300-RETURN
   974        ELSE
   975           MOVE '3'              TO EMI-SWITCH1
   976           PERFORM 2490-FORMAT-LINE
   977           GO TO 2300-RETURN.
   978
   979 2100-NOT-FOUND.
   980     MOVE 1                      TO FOUND-SWITCH.
   981     GO TO 2000-PROCESS-ERRORS.
   982
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL001.cbl
   983 2150-NOT-FOUND-FR.
   984     MOVE 'E'                    TO EMI-LANGUAGE-IND.
   985     GO TO 0100-READ-ERRORS.
   986
   987 2200-NOT-OPEN.
   988     SET EMI-INDX TO 1.
   989     MOVE 'ELERRS FILE NOT OPEN' TO EMI-ERROR-TEXT (EMI-INDX).
   990     MOVE '3'                    TO EMI-SWITCH1.
   991
   992 2250-NOT-OPEN-FR.
   993     SET EMI-INDX TO 1.
   994     MOVE 'MPERRS FILE NOT OPEN' TO EMI-ERROR-TEXT (EMI-INDX).
   995     MOVE '3'                    TO EMI-SWITCH1.
   996
   997 2300-RETURN.
   998     MOVE ERROR-MESSAGE-INTERFACE-BLOCK  TO  DFHCOMMAREA.
   999
  1000
  1001* EXEC CICS RETURN
  1002*    END-EXEC.
  1003*    MOVE '.(                    &   #00000947' TO DFHEIV0
  1004     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1005     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1006     MOVE X'2020233030303030393437' TO DFHEIV0(25:11)
  1007     CALL 'kxdfhei1' USING DFHEIV0,
  1008           DFHEIV99,
  1009           DFHEIV99,
  1010           DFHEIV99,
  1011           DFHEIV99,
  1012           DFHEIV99
  1013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1014
  1015
  1016
  1017* GOBACK.
  1018     MOVE '9%                    "   ' TO DFHEIV0
  1019     MOVE 'EL001' TO DFHEIV1
  1020     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1021     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL001.cbl
  1023 2490-FORMAT-LINE.
  1024     IF REC-NOT-FOUND
  1025        MOVE 'NO TEXT RECORD FOUND FOR THIS ERROR' TO
  1026              EMI-ERROR-TEXT (EMI-INDX)
  1027        MOVE 'X'                 TO EMI-SEVERITY (EMI-INDX)
  1028     ELSE
  1029        MOVE EM-ERROR-SEVERITY   TO EMI-SEVERITY (EMI-INDX)
  1030        MOVE '-'                 TO EMI-FILL (EMI-INDX)
  1031        MOVE EM-ERROR-TEXT       TO EMI-ERROR-TEXT (EMI-INDX).
  1032
  1033     MOVE EMI-ERROR              TO EMI-ERROR-NUMBER (EMI-INDX).
  1034
  1035 2500-FORMAT-CODES-ONLY.
  1036     IF EMI-SUB = 2
  1037        MOVE SPACES              TO EMI-ERROR-TEXT (3).
  1038
  1039     MOVE EMI-ERROR              TO EMI-ERR-NUM (EMI-SUB).
  1040     MOVE '-'                    TO EMI-FILLER (EMI-SUB).
  1041
  1042     IF REC-NOT-FOUND
  1043        MOVE 'X'                 TO EMI-SEV (EMI-SUB)
  1044     ELSE
  1045        MOVE EM-ERROR-SEVERITY   TO EMI-SEV (EMI-SUB).
  1046
  1047     IF EMI-SUB = 1
  1048        ADD 1 TO EMI-SUB
  1049        PERFORM 2490-FORMAT-LINE
  1050        GO TO 2500-EXIT.
  1051
  1052     IF EMI-INDX = 2
  1053        MOVE EMI-MESSAGE-AREA (3)
  1054                                 TO EMI-MESSAGE-AREA (2).
  1055
  1056     IF EMI-SUB = 10
  1057        MOVE '3'                 TO EMI-SWITCH1
  1058     ELSE
  1059        ADD 1 TO EMI-SUB.
  1060
  1061 2500-EXIT.
  1062      EXIT.
  1063
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL001.cbl
  1065 3000-ROLL-CODES.
  1066     MOVE LOW-VALUES             TO EL001AI.
  1067*
  1068*    EXEC CICS HANDLE CONDITION
  1069*         NOTFND    (4080-NOT-FOUND)
  1070*         NOTOPEN   (2200-NOT-OPEN)
  1071*    END-EXEC.
  1072
  1073     IF EMI-NUMBER-OF-LINES = 1
  1074        IF EMI-FORMAT-CODES-ONLY
  1075           MOVE EMI-LINE1        TO EMI-LINE3
  1076           MOVE 1                TO ER-SUB
  1077           PERFORM 4000-READ-ERRORS THRU 4099-EXIT
  1078                   UNTIL ER-NUM GREATER THAN EMI-SUB
  1079           GO TO 3500-SEND-ERROR-SCREEN.
  1080
  1081     IF EMI-NUMBER-OF-LINES = 2
  1082        IF EMI-FORMAT-CODES-ONLY
  1083           MOVE EMI-LINE1        TO ER-LINE (1)
  1084           MOVE EMI-LINE2        TO EMI-LINE3
  1085           MOVE 2                TO ER-SUB
  1086           PERFORM 4000-READ-ERRORS THRU 4099-EXIT
  1087                   UNTIL ER-NUM GREATER THAN EMI-SUB
  1088           GO TO 3500-SEND-ERROR-SCREEN.
  1089
  1090     IF EMI-NUMBER-OF-LINES = 3
  1091        IF EMI-FORMAT-CODES-ONLY
  1092           MOVE EMI-LINE1        TO ER-LINE (1)
  1093           MOVE EMI-LINE2        TO ER-LINE (2)
  1094           MOVE 3                TO ER-SUB
  1095           PERFORM 4000-READ-ERRORS THRU 4099-EXIT
  1096                   UNTIL ER-NUM GREATER THAN EMI-SUB
  1097           GO TO 3500-SEND-ERROR-SCREEN.
  1098
  1099     GO TO 2300-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL001.cbl
  1101 3500-SEND-ERROR-SCREEN.
  1102
  1103     IF EIBTRNID = TRANS-EXB1 OR
  1104                   TRANS-MXB1 OR
  1105                   TRANS-MXA6 OR
  1106                   TRANS-MXB2 OR
  1107                   TRANS-MXB3 OR
  1108                   TRANS-MXA5
  1109        GO TO 3515-SEND-ERRORS.
  1110
  1111
  1112* EXEC CICS RECEIVE
  1113*         SET    (MAP-POINTER)
  1114*         LENGTH (MAP-LENGTH)
  1115*         BUFFER
  1116*    END-EXEC.
  1117*    MOVE '$"S B  L              ''   #00001040' TO DFHEIV0
  1118     MOVE X'242253204220204C20202020' TO DFHEIV0(1:12)
  1119     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1120     MOVE X'2020233030303031303430' TO DFHEIV0(25:11)
  1121     CALL 'kxdfhei1' USING DFHEIV0,
  1122           MAP-POINTER,
  1123           MAP-LENGTH,
  1124           DFHEIV99,
  1125           DFHEIV99,
  1126           DFHEIV99,
  1127           DFHEIV99
  1128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1129
  1130
  1131     SERVICE RELOAD MAP-BUFFER.
  1132
  1133     MOVE EIBTRMID               TO TEMP-TERM.
  1134
  1135
  1136* EXEC CICS HANDLE CONDITION
  1137*         QIDERR  (3510-WRITE-TS)
  1138*    END-EXEC.
  1139*    MOVE '"$N                   ! $ #00001050' TO DFHEIV0
  1140     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  1141     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1142     MOVE X'2420233030303031303530' TO DFHEIV0(25:11)
  1143     CALL 'kxdfhei1' USING DFHEIV0
  1144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1145
  1146
  1147
  1148* EXEC CICS DELETEQ TS
  1149*         QUEUE  (TEMP-ID)
  1150*    END-EXEC.
  1151*    MOVE '*&                    #   #00001054' TO DFHEIV0
  1152     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  1153     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1154     MOVE X'2020233030303031303534' TO DFHEIV0(25:11)
  1155     CALL 'kxdfhei1' USING DFHEIV0,
  1156           TEMP-ID,
  1157           DFHEIV99
  1158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL001.cbl
  1159
  1160
  1161 3510-WRITE-TS.
  1162
  1163
  1164* EXEC CICS WRITEQ TS
  1165*         QUEUE  (TEMP-ID)
  1166*         LENGTH (MAP-LENGTH)
  1167*         FROM   (MAP-BUFFER)
  1168*    END-EXEC.
  1169*    MOVE '*"                    ''   #00001060' TO DFHEIV0
  1170     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  1171     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1172     MOVE X'2020233030303031303630' TO DFHEIV0(25:11)
  1173     CALL 'kxdfhei1' USING DFHEIV0,
  1174           TEMP-ID,
  1175           MAP-BUFFER,
  1176           MAP-LENGTH,
  1177           DFHEIV99,
  1178           DFHEIV99,
  1179           DFHEIV99
  1180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1181
  1182
  1183 3515-SEND-ERRORS.
  1184
  1185     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1186     MOVE '5'                    TO DC-OPTION-CODE.
  1187     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  1188     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1189
  1190     MOVE SAVE-DATE              TO RUNDTEI.
  1191     MOVE EIBTIME                TO TIME-IN.
  1192     MOVE TIME-O                 TO RUNTIMO.
  1193
  1194
  1195* EXEC CICS SEND
  1196*         MAPSET  ('EL001S')
  1197*         MAP     ('EL001A')
  1198*         FROM    (EL001AI)
  1199*         ERASE   WAIT
  1200*    END-EXEC.
  1201     MOVE LENGTH OF
  1202      EL001AI
  1203       TO DFHEIV11
  1204     MOVE 'EL001A' TO DFHEIV1
  1205     MOVE 'EL001S' TO DFHEIV2
  1206*    MOVE '8$      TW E    H L F ,   #00001077' TO DFHEIV0
  1207     MOVE X'382420202020202054572045' TO DFHEIV0(1:12)
  1208     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1209     MOVE X'2020233030303031303737' TO DFHEIV0(25:11)
  1210     CALL 'kxdfhei1' USING DFHEIV0,
  1211           DFHEIV1,
  1212           EL001AI,
  1213           DFHEIV11,
  1214           DFHEIV2,
  1215           DFHEIV99,
  1216           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL001.cbl
  1217           DFHEIV99,
  1218           DFHEIV99,
  1219           DFHEIV99,
  1220           DFHEIV99,
  1221           DFHEIV99
  1222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1223
  1224
  1225
  1226* EXEC CICS HANDLE AID
  1227*         ANYKEY(3520-SEND-MAP)
  1228*    END-EXEC.
  1229*    MOVE '"&@                  V! % #00001084' TO DFHEIV0
  1230     MOVE X'222640202020202020202020' TO DFHEIV0(1:12)
  1231     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  1232     MOVE X'2520233030303031303834' TO DFHEIV0(25:11)
  1233     CALL 'kxdfhei1' USING DFHEIV0
  1234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1235
  1236
  1237
  1238* EXEC CICS RECEIVE
  1239*         MAPSET  ('EL001S')
  1240*         MAP     ('EL001A')
  1241*         INTO    (EL001AI)
  1242*    END-EXEC.
  1243     MOVE LENGTH OF
  1244      EL001AI
  1245       TO DFHEIV11
  1246     MOVE 'EL001A' TO DFHEIV1
  1247     MOVE 'EL001S' TO DFHEIV2
  1248*    MOVE '8"T I  L              ''   #00001088' TO DFHEIV0
  1249     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1250     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1251     MOVE X'2020233030303031303838' TO DFHEIV0(25:11)
  1252     CALL 'kxdfhei1' USING DFHEIV0,
  1253           DFHEIV1,
  1254           EL001AI,
  1255           DFHEIV11,
  1256           DFHEIV2,
  1257           DFHEIV99,
  1258           DFHEIV99
  1259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1260
  1261
  1262 3520-SEND-MAP.
  1263
  1264     IF EIBTRNID = TRANS-EXB1 OR
  1265                   TRANS-MXB1 OR
  1266                   TRANS-MXA6 OR
  1267                   TRANS-MXB2 OR
  1268                   TRANS-MXB3 OR
  1269                   TRANS-MXA5
  1270        GO TO 2300-RETURN.
  1271
  1272
  1273* EXEC CICS READQ TS
  1274*         QUEUE  (TEMP-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL001.cbl
  1275*         LENGTH (MAP-LENGTH)
  1276*         SET    (MAP-POINTER)
  1277*    END-EXEC
  1278*    MOVE '*$S    L              ''   #00001104' TO DFHEIV0
  1279     MOVE X'2A2453202020204C20202020' TO DFHEIV0(1:12)
  1280     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1281     MOVE X'2020233030303031313034' TO DFHEIV0(25:11)
  1282     CALL 'kxdfhei1' USING DFHEIV0,
  1283           TEMP-ID,
  1284           MAP-POINTER,
  1285           MAP-LENGTH,
  1286           DFHEIV99,
  1287           DFHEIV99,
  1288           DFHEIV99
  1289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1290
  1291     SERVICE RELOAD MAP-BUFFER.
  1292
  1293
  1294* EXEC CICS SEND
  1295*         FROM    (MAP-BUFFER)
  1296*         LENGTH  (MAP-LENGTH)
  1297*         CTLCHAR (WCC-CTL)
  1298*    END-EXEC.
  1299*    MOVE '$$    C           L F ,   #00001112' TO DFHEIV0
  1300     MOVE X'242420202020432020202020' TO DFHEIV0(1:12)
  1301     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  1302     MOVE X'2020233030303031313132' TO DFHEIV0(25:11)
  1303     CALL 'kxdfhei1' USING DFHEIV0,
  1304           MAP-BUFFER,
  1305           MAP-LENGTH,
  1306           DFHEIV99,
  1307           DFHEIV99,
  1308           WCC-CTL,
  1309           DFHEIV99,
  1310           DFHEIV99,
  1311           DFHEIV99,
  1312           DFHEIV99,
  1313           DFHEIV99,
  1314           DFHEIV99
  1315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1316
  1317
  1318     GO TO 2300-RETURN.
  1319
  1320 4000-READ-ERRORS.
  1321     IF EMI-ERR-NUM (ER-NUM) NOT NUMERIC
  1322        MOVE 99                  TO ER-NUM
  1323        GO TO 4099-EXIT.
  1324
  1325     MOVE EMI-ERR-NUM (ER-NUM)   TO EM-KEY.
  1326     MOVE SPACES                 TO WS-ERROR-LINE.
  1327
  1328     IF  EMI-LANGUAGE-IS-FR
  1329
  1330* EXEC CICS HANDLE CONDITION
  1331*             NOTFND   (4090-NOT-FOUND-FR)
  1332*             NOTOPEN  (2250-NOT-OPEN-FR)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL001.cbl
  1333*        END-EXEC
  1334*    MOVE '"$IJ                  ! & #00001129' TO DFHEIV0
  1335     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  1336     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1337     MOVE X'2620233030303031313239' TO DFHEIV0(25:11)
  1338     CALL 'kxdfhei1' USING DFHEIV0
  1339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1340
  1341
  1342* EXEC CICS READ
  1343*             DATASET (EM-FILE-ID)
  1344*             RIDFLD  (EM-KEY)
  1345*             INTO    (ERROR-MESSAGE-FILE)
  1346*        END-EXEC
  1347     MOVE LENGTH OF
  1348      ERROR-MESSAGE-FILE
  1349       TO DFHEIV11
  1350*    MOVE '&"IL       E          (   #00001134' TO DFHEIV0
  1351     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1352     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1353     MOVE X'2020233030303031313334' TO DFHEIV0(25:11)
  1354     CALL 'kxdfhei1' USING DFHEIV0,
  1355           EM-FILE-ID,
  1356           ERROR-MESSAGE-FILE,
  1357           DFHEIV11,
  1358           EM-KEY,
  1359           DFHEIV99,
  1360           DFHEIV99,
  1361           DFHEIV99
  1362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1363
  1364*        SERVICE RELOAD ERROR-MESSAGE-FILE-FR
  1365
  1366     ELSE
  1367
  1368* EXEC CICS HANDLE CONDITION
  1369*             NOTFND   (4080-NOT-FOUND)
  1370*             NOTOPEN  (2200-NOT-OPEN)
  1371*        END-EXEC
  1372*    MOVE '"$IJ                  ! '' #00001143' TO DFHEIV0
  1373     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  1374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1375     MOVE X'2720233030303031313433' TO DFHEIV0(25:11)
  1376     CALL 'kxdfhei1' USING DFHEIV0
  1377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1378
  1379
  1380* EXEC CICS READ
  1381*             DATASET (EM-FILE-ID)
  1382*             RIDFLD  (EM-KEY)
  1383*             INTO    (ERROR-MESSAGE-FILE)
  1384*        END-EXEC.
  1385     MOVE LENGTH OF
  1386      ERROR-MESSAGE-FILE
  1387       TO DFHEIV11
  1388*    MOVE '&"IL       E          (   #00001148' TO DFHEIV0
  1389     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1390     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL001.cbl
  1391     MOVE X'2020233030303031313438' TO DFHEIV0(25:11)
  1392     CALL 'kxdfhei1' USING DFHEIV0,
  1393           EM-FILE-ID,
  1394           ERROR-MESSAGE-FILE,
  1395           DFHEIV11,
  1396           EM-KEY,
  1397           DFHEIV99,
  1398           DFHEIV99,
  1399           DFHEIV99
  1400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1401
  1402
  1403*        SERVICE RELOAD ERROR-MESSAGE-FILE-REST.
  1404
  1405     MOVE EMI-CLIENT-ID TO E-CLIENT-ID.
  1406
  1407*                                COPY ELCERRPD.
  1408******************************************************************
  1409*                                                                *
  1410*                                                                *
  1411*                            ELCERRPD                            *
  1412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1413*                            VMOD=2.005                          *
  1414*                                                                *
  1415*    CLIENT CODED ERROR MESSAGES                                 *
  1416*                                                                *
  1417******************************************************************
  1418
  1419     IF EM-MESSAGE-NUMBER NOT NUMERIC
  1420         MOVE ZEROS TO EM-MESSAGE-NUMBER.
  1421
  1422     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK
  1423                         OR CLIENT-CIG OR CLIENT-CUK
  1424        IF EM-MESSAGE-NUMBER EQUAL 0541
  1425            MOVE 'X' TO EM-ERROR-SEVERITY.
  1426
  1427     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER
  1428        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909
  1429            MOVE 'F'             TO  EM-ERROR-SEVERITY.
  1430
  1431     IF E-CLIENT-ID EQUAL CLIENT-LAP
  1432        IF EM-MESSAGE-NUMBER EQUAL 2656
  1433            MOVE 'F' TO EM-ERROR-SEVERITY.
  1434
  1435     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB
  1436        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671
  1437            MOVE 'F'             TO  EM-ERROR-SEVERITY.
  1438
  1439     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC
  1440        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672
  1441            MOVE 'W'             TO  EM-ERROR-SEVERITY.
  1442
  1443     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER
  1444        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693
  1445            MOVE 'W'             TO  EM-ERROR-SEVERITY.
  1446
  1447     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS
  1448        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL001.cbl
  1449            MOVE 'F'             TO  EM-ERROR-SEVERITY.
  1450
  1451     IF E-CLIENT-ID EQUAL CLIENT-LBL
  1452        IF EM-MESSAGE-NUMBER EQUAL 2738
  1453            MOVE 'W' TO EM-ERROR-SEVERITY.
  1454
  1455     IF E-CLIENT-ID EQUAL CLIENT-LBL
  1456        IF EM-MESSAGE-NUMBER EQUAL 2739
  1457            MOVE 'W' TO EM-ERROR-SEVERITY.
  1458
  1459     IF E-CLIENT-ID EQUAL CLIENT-LBL
  1460        IF EM-MESSAGE-NUMBER EQUAL 2741
  1461            MOVE 'W' TO EM-ERROR-SEVERITY.
  1462
  1463     IF  E-CLIENT-ID EQUAL CLIENT-HAN
  1464             OR
  1465         E-CLIENT-ID EQUAL CLIENT-JHL
  1466
  1467         IF  EM-MESSAGE-NUMBER EQUAL 2756
  1468             MOVE 'F'            TO EM-ERROR-SEVERITY.
  1469
  1470     IF E-CLIENT-ID = CLIENT-NCX
  1471         IF EM-MESSAGE-NUMBER = 9895
  1472             MOVE 'F'            TO EM-ERROR-SEVERITY.
  1473     IF E-CLIENT-ID = CLIENT-DCC
  1474        IF EM-MESSAGE-NUMBER = 2719
  1475           MOVE 'W'              TO EM-ERROR-SEVERITY
  1476        END-IF
  1477     END-IF
  1478     .
  1479
  1480     MOVE '-'                    TO WS-FILL.
  1481     MOVE EM-ERROR-SEVERITY      TO WS-ERROR-SEVERITY.
  1482     MOVE EM-ERROR-TEXT          TO WS-ERROR-TEXT.
  1483
  1484 4050-MOVE-NUMBER.
  1485     MOVE EM-MESSAGE-NUMBER      TO WS-ERROR-NUMBER.
  1486
  1487     IF WS-PREFIX = 'LLLLLL'
  1488        MOVE EMI-LIFE-OVERRIDE-L6  TO WS-PREFIX.
  1489
  1490     IF WS-PREFIX = 'AAAAAA'
  1491        MOVE EMI-AH-OVERRIDE-L6    TO WS-PREFIX.
  1492
  1493     MOVE WS-ERROR-LINE          TO ER-LINE (ER-SUB).
  1494
  1495     ADD 1   TO ER-SUB
  1496                ER-NUM.
  1497
  1498     GO TO 4099-EXIT.
  1499
  1500 4080-NOT-FOUND.
  1501     MOVE SPACES                 TO ER-LINE (ER-SUB).
  1502     MOVE 'NO TEXT RECORD FOUND FOR THIS ERROR'  TO WS-ERROR-TEXT.
  1503     MOVE WS-ERROR-LINE          TO ER-LINE (ER-SUB).
  1504     ADD 1                       TO ER-SUB
  1505                                    ER-NUM.
  1506     GO TO 4099-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL001.cbl
  1507
  1508 4090-NOT-FOUND-FR.
  1509
  1510     MOVE 'E'                    TO EMI-LANGUAGE-IND.
  1511     GO TO 4000-READ-ERRORS.
  1512
  1513 4099-EXIT.
  1514      EXIT.
  1515
  1516 9700-LINK-DATE-CONVERT.
  1517
  1518* EXEC CICS LINK
  1519*        PROGRAM    ('ELDATCV')
  1520*        COMMAREA   (DATE-CONVERSION-DATA)
  1521*        LENGTH     (DC-COMM-LENGTH)
  1522*    END-EXEC.
  1523     MOVE 'ELDATCV' TO DFHEIV1
  1524*    MOVE '."C                   ''   #00001268' TO DFHEIV0
  1525     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1526     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1527     MOVE X'2020233030303031323638' TO DFHEIV0(25:11)
  1528     CALL 'kxdfhei1' USING DFHEIV0,
  1529           DFHEIV1,
  1530           DATE-CONVERSION-DATA,
  1531           DC-COMM-LENGTH,
  1532           DFHEIV99,
  1533           DFHEIV99,
  1534           DFHEIV99
  1535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1536
  1537
  1538 9700-EXIT.
  1539     EXIT.
  1540
  1541
  1542 9999-DFHBACK SECTION.
  1543     MOVE '9%                    "   ' TO DFHEIV0
  1544     MOVE 'EL001' TO DFHEIV1
  1545     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1546     GOBACK.
  1547 9999-DFHEXIT.
  1548     IF DFHEIGDJ EQUAL 0001
  1549         NEXT SENTENCE
  1550     ELSE IF DFHEIGDJ EQUAL 2
  1551         GO TO 2150-NOT-FOUND-FR,
  1552               2250-NOT-OPEN-FR
  1553         DEPENDING ON DFHEIGDI
  1554     ELSE IF DFHEIGDJ EQUAL 3
  1555         GO TO 2100-NOT-FOUND,
  1556               2200-NOT-OPEN
  1557         DEPENDING ON DFHEIGDI
  1558     ELSE IF DFHEIGDJ EQUAL 4
  1559         GO TO 3510-WRITE-TS
  1560         DEPENDING ON DFHEIGDI
  1561     ELSE IF DFHEIGDJ EQUAL 5
  1562         GO TO 3520-SEND-MAP
  1563         DEPENDING ON DFHEIGDI
  1564     ELSE IF DFHEIGDJ EQUAL 6
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL001.cbl
  1565         GO TO 4090-NOT-FOUND-FR,
  1566               2250-NOT-OPEN-FR
  1567         DEPENDING ON DFHEIGDI
  1568     ELSE IF DFHEIGDJ EQUAL 7
  1569         GO TO 4080-NOT-FOUND,
  1570               2200-NOT-OPEN
  1571         DEPENDING ON DFHEIGDI.
  1572     MOVE '9%                    "   ' TO DFHEIV0
  1573     MOVE 'EL001' TO DFHEIV1
  1574     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1575     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2916     Code:        5339
